var wacBoot=function(t){var e={};function n(i){if(e[i])return e[i].exports;var r=e[i]={i:i,l:!1,exports:{}};return t[i].call(r.exports,r,r.exports,n),r.l=!0,r.exports}return n.m=t,n.c=e,n.d=function(t,e,i){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)n.d(i,r,function(e){return t[e]}.bind(null,r));return i},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=13)}({0:function(t,e,n){"use strict";n.r(e);var i=window.__foldables_env_vars__,r=function(){function t(t,e,n,i,r){void 0===r&&(r=!1),this.left=t,this.right=t+n,this.top=e,this.bottom=e+i,this.x=t,this.y=e,this.width=n,this.height=i,this.pixelDepth=0,this.devicePixelRatio=0,this.isOccluded=r}return t.prototype.toJSON=function(){return JSON.stringify(this)},t}();function o(){!function(){if("function"==typeof window.CustomEvent)return;window.CustomEvent=function(t,e){var n=e||{bubbles:!1,cancelable:!1,detail:null},i=document.createEvent("CustomEvent");return i.initCustomEvent(t,n.bubbles,n.cancelable,n.detail),i}}(),function(){if("function"==typeof window.DOMRect)return;window.DOMRect=function(t){return{x:0,y:0,width:window.innerWidth,height:window.innerHeight}}}(),function(){if("object"==typeof window.onBoundingWindowRectsChange)return;window.onBoundingWindowRectsChange=new CustomEvent("onBoundingWindowRectsChange",{bubbles:!1,cancelable:!1}),window.addEventListener("resize",a)}(),function(){if("function"==typeof window.getWindowSegments)return;window.getWindowSegments=function(){var t=window.innerWidth,e=window.innerHeight;try{if(window.external&&window.external.getHostEnvironmentValue&&'{"os-sku":"189"}'===window.external.getHostEnvironmentValue("os-sku")){if(window.matchMedia&&window.matchMedia("(orientation: portrait)").matches&&e>=1300&&964===t)return i&&i.update({spanning:"single-fold-horizontal"}),[new r(0,0,t,e/2),new r(0,e/2,t,e/2)];if(window.matchMedia&&window.matchMedia("(orientation: landscape)").matches&&e>=820&&1440===t)return i&&i.update({spanning:"single-fold-vertical"}),[new r(0,0,t/2,e),new r(t/2,0,t/2,e)];i&&i.update({spanning:"none"})}}catch(t){}return[new r(0,0,t,e)]}}()}function a(){window.dispatchEvent(window.onBoundingWindowRectsChange)}function s(){Array.prototype.find||Object.defineProperty(Array.prototype,"find",{value:function(t){if(null==this)throw TypeError('"this" is null or not defined');var e=Object(this),n=e.length>>>0;if("function"!=typeof t)throw TypeError("predicate must be a function");for(var i=arguments[1],r=0;r<n;){var o=e[r];if(t.call(i,o,r,e))return o;r+=1}},configurable:!0,writable:!0})}function u(){"function"!=typeof Object.assign&&Object.defineProperty(Object,"assign",{value:function(t,e){if(null==t)throw new TypeError("Cannot convert undefined or null to object");for(var n=Object(t),i=1;i<arguments.length;i+=1){var r=arguments[i];if(null!=r)for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(n[o]=r[o])}return n},writable:!0,configurable:!0})}var c={},l={},d={},f={Small:{Portrait:720,Landscape:960,DP:1440,DL:1920},Large:{Portrait:721,Landscape:961,DP:1441,DL:1921}},h=[],v=void 0,p=-1,m="Undefined",b="Default",w=!1;function g(){var t;return null===(t=null===window||void 0===window?void 0:window.matchMedia)||void 0===t?void 0:t.call(window,"(prefers-reduced-motion: reduce)").matches}function S(){return"DP"===V()}function C(){return"DL"===V()}function R(t){return y(t,0)}function y(t,e){if(t&&h&&!(h.length<=0)){if(1===h.length)return x(h[0],e);var n;if("string"==typeof t){var i=document.querySelector(t);if(!i)return;n=i.getBoundingClientRect()}else if(void 0!==t.preventDefault){var o=t;n=new r(o.clientX,o.clientY,1,1)}else if(t.getBoundingClientRect)n=t.getBoundingClientRect();else if(t.current)n=t.current.getBoundingClientRect();else{if(!t)return;var a=t;n=new r(a.x,a.y,1,1)}var s=O(n);return s&&x(s,e)}}function k(t,e){return y(t,8)}function x(t,e){return u(),t&&Object.assign({},t,{top:t.top+e,left:t.left+e,right:t.right-e,bottom:t.bottom-e,width:t.width-2*e,height:t.height-2*e})}function O(t){return A(t)?h[0]:(s(),h.find((function(e){return P(t,e)})))}function P(t,e){return t.left>=e.left&&t.top>=e.top&&t.right<=e.left+e.width&&t.bottom<=e.top+e.height}function I(t){return void 0!==t&&("DL"===V()||"DP"===V())&&A(t.getBoundingClientRect())}function A(t){return!(h.length<=1)&&(t.right>h[0].left+h[0].width?t.left<h[1].left:t.bottom>h[0].top+h[0].height&&t.top<h[1].top)}function E(t,e){if(h.length<=1)return-1;if(e){if(t.left<h[1].left)return t.right-h[0].right;if(t.top<h[1].top)return t.bottom-h[0].bottom}else{if(t.right>h[0].left+h[0].width)return h[1].left-t.left;if(t.bottom>h[0].top+h[0].height)return h[1].top-t.top}return-1}function D(t,e){c[t]=e}function L(t){void 0!==c[t]&&delete c[t]}function W(t,e){l[t]=e}function N(t){void 0!==l[t]&&delete l[t]}function F(t,e){d[t]=e}function T(t){void 0!==d[t]&&delete d[t]}function M(){window.getWindowSegments||o();var t=window.getWindowSegments(),e=!1;if(t.length!==h.length&&(e=!0),1===(h=t).length){var n=h[0];m=n.width>n.height?"Landscape":"Portrait"}else h.length<=1||h[0].top!==h[1].top?h.length<=1||h[0].left!==h[1].left||(e=e||"DP"===m,m="DL"):(e=e||"DL"===m,m="DP");var i=b;"Landscape"===m||"DL"===m?b=h[0].width<=960?"Small":"Large":"Portrait"!==m&&"DP"!==m||(b=h[0].width<=720?"Small":"Large"),function(){var t=h;for(var e in v&&t.push(v),l)l[e](t,m)}(),e&&function(t){for(var e in c)c[e](t,m)}("DL"===m||"DP"===m),i!==b&&function(){for(var t in d)d[t](b)}()}function V(){if("Undefined"===m){var t=window.getWindowSegments?window.getWindowSegments():void 0;return!t||t.length<=1?window.innerWidth>window.innerHeight?"Landscape":"Portrait":window.innerWidth>window.innerHeight?"DP":"DL"}return m}function B(){return b}function _(){return v}function j(){return h}function U(){w||("undefined"!=typeof navigator&&navigator.virtualKeyboard&&void 0!==navigator.virtualKeyboard.overlaysContent&&(window===top&&(navigator.virtualKeyboard.overlaysContent=!0),navigator.virtualKeyboard.addEventListener("overlaygeometrychange",H)),o(),window.addEventListener("onBoundingWindowRectsChange",M),h&&0!==h.length||M(),w=!0)}function H(t){var e=t.boundingRect,n=e.width,i=e.height,r=e.left;0===n||0===i?(v=void 0,p=-1):((v=t.boundingRect).isOccluded=!0,p=r>0||"DL"===V()?1:0),M()}function J(){if(v)return h[p]}U(),n.d(e,"WindowSegment",(function(){return r})),n.d(e,"ensureWindowsAPIs",(function(){return o})),n.d(e,"arrayFindPolyfill",(function(){return s})),n.d(e,"objectAssignPolyfill",(function(){return u})),n.d(e,"LayoutBreakpointSizes",(function(){return f})),n.d(e,"isReducedAnimations",(function(){return g})),n.d(e,"isDPMode",(function(){return S})),n.d(e,"isDLMode",(function(){return C})),n.d(e,"getBoundingWindow",(function(){return R})),n.d(e,"getBoundingWindowWithPadding",(function(){return y})),n.d(e,"getBoundingWindowWithPaddingFabric",(function(){return k})),n.d(e,"getBoundingRect",(function(){return O})),n.d(e,"isRectWithin",(function(){return P})),n.d(e,"isElementSpanning",(function(){return I})),n.d(e,"isRectSpanning",(function(){return A})),n.d(e,"getRectSpanningOffset",(function(){return E})),n.d(e,"registerSpanningChanged",(function(){return D})),n.d(e,"unregisterSpanningChanged",(function(){return L})),n.d(e,"registerBoundingWindowRectsChanged",(function(){return W})),n.d(e,"unregisterBoundingWindowRectsChanged",(function(){return N})),n.d(e,"registerLayoutBreakpointChanged",(function(){return F})),n.d(e,"unregisterLayoutBreakpointChanged",(function(){return T})),n.d(e,"onWindowRectsChange",(function(){return M})),n.d(e,"getWindowMode",(function(){return V})),n.d(e,"getLayoutBreakpoint",(function(){return B})),n.d(e,"getKeyboardSegment",(function(){return _})),n.d(e,"getWindowRectsWithoutKeyboard",(function(){return j})),n.d(e,"initializeBaseWindowUtil",(function(){return U})),n.d(e,"getWindowRectForKeyboardSegment",(function(){return J}))},13:function(t,e,n){"use strict";n.r(e);var i=n(0),r=function(){function t(t){var e=this;this.accountForKeyboardRegionElements={Portrait:{Default:[],Small:[],Large:[]},Landscape:{Default:[],Small:[],Large:[]},DP:{Default:[],Small:[],Large:[]},DL:{Default:[],Small:[],Large:[]}},this.regionComposerRootId="regionComposerRoot",this.regionContainers={},this.setOffsetForActiveAccountForKeyboardRegions=function(t){var n=t?void 0:e.getWindowRectForKeyboardSegment(),i="Undefined"===e.windowMode?"Landscape":e.windowMode,r=e.getAffectedAccountForKeyboardRegions(n,i,e.layoutBreakpoint);if(r&&0!==r.length){var o=n?n.top+n.height:0;r.forEach((function(n){if(t)n.style.marginBottom="0px";else{var i=n.getBoundingClientRect(),r=Math.max(0,e.keyboardSegment.height-(o-i.bottom));n.style.marginBottom="".concat(r,"px")}}))}},this.boundingWindowRectsChanged=function(t,n){for(var i=void 0,r=t.length-1;r>=0;r-=1)if(t[r].isOccluded){i=t[r];break}var o=e.windowMode!==n||e.keyboardSegment!==i;e.setOffsetForActiveAccountForKeyboardRegions(!0),e.windowMode=n,e.keyboardSegment=i,e.render(o)},this.layoutBreakpointChanged=function(t){e.layoutBreakpoint=t,e.render(!0)},this.getWindowRectForKeyboardSegment=function(){if(e.keyboardSegment)return Object(i.getBoundingRect)(e.keyboardSegment)},this.props=t,this.windowMode=Object(i.getWindowMode)(),this.layoutBreakpoint=Object(i.getLayoutBreakpoint)(),this.keyboardSegment=Object(i.getKeyboardSegment)(),this.regionComposerRoot=this.getRegionComposer(),this.regionComposerRoot&&(t.container&&t.container.appendChild(this.regionComposerRoot),this.registerAccountForKeyboardRegionElements(),Object(i.registerBoundingWindowRectsChanged)("regionComposer",this.boundingWindowRectsChanged),Object(i.registerLayoutBreakpointChanged)("regionComposer",this.layoutBreakpointChanged),this.render())}return t.prototype.render=function(t){var e=this;t&&(this.keyboardSegment?(void 0!==this.setOffsetRafId&&cancelAnimationFrame(this.setOffsetRafId),this.setOffsetRafId=requestAnimationFrame((function(){e.setOffsetForActiveAccountForKeyboardRegions(),a()}))):(void 0!==this.setOffsetRafId&&(cancelAnimationFrame(this.setOffsetRafId),this.setOffsetRafId=void 0),a()))},t.prototype.dispose=function(){var t=this;Object.keys(this.regionContainers).forEach((function(e){var n=t.regionContainers[e];n&&document.removeChild(n),t.regionContainers[e]=void 0})),Object(i.unregisterBoundingWindowRectsChanged)("regionComposer"),Object(i.unregisterLayoutBreakpointChanged)("regionComposer"),this.regionContainers={}},t.prototype.getRegion=function(t){if(this.regionComposerRoot)return this.regionContainers[t]||(this.regionContainers[t]=this.regionComposerRoot.querySelector("[id=".concat(t,"Region]"))),this.regionContainers[t]},t.prototype.getRegionComposer=function(){return document.getElementById(this.regionComposerRootId)},t.prototype.registerAccountForKeyboardRegionElements=function(){var t=this,e=this.props.layoutCollection;Object.keys(e).forEach((function(n){var i=e[n];i&&t.registerAccountForKeyboardRegionElementsForRegionLayoutAndWindowMode(i,n)}))},t.prototype.registerAccountForKeyboardRegionElementsForRegionLayoutAndWindowMode=function(t,e){var n=this;Object.keys(t).forEach((function(i){var r;null===(r=t[i])||void 0===r||r.forEach((function(t){var r=n.getRegion(t.id);r&&n.accountForKeyboardRegionElements[e][i].push(r)}))}))},t.prototype.getAffectedAccountForKeyboardRegions=function(t,e,n){void 0===e&&(e="Landscape"),void 0===n&&(n="Default");var r=this.accountForKeyboardRegionElements[e][n]||this.accountForKeyboardRegionElements[e].Default||void 0;return t&&r&&0!==r.length?r.filter((function(e){return Object(i.isRectWithin)(e.getBoundingClientRect(),t)})):r},t}();var o={};function a(){for(var t in o)o[t]()}var s=void 0;function u(t){return s?s.getRegion(t):void 0}function c(){s&&(s.dispose(),s=void 0)}var l=function(){function t(){}return t.initialize=function(){t.ctrlWheelOccurred=!1,document.addEventListener("wheel",t.handleWheel)},t.stop=function(){document.removeEventListener("wheel",t.handleWheel)},t.handleWheel=function(e){e.ctrlKey&&(t.ctrlWheelOccurred=!0)},t}();l.initialize();var d,f={g_initialRequestMade:!1,g_initialRequestCompleted:!1,g_getCellsFromFrameRequest:void 0,g_getCellsUuid:void 0,g_initialRequestResponseObject:void 0,g_acquireLockStartTime:void 0,g_acquireLockEndTime:void 0,g_acquireLockRequestStatus:void 0,g_getDocumentStartTime:void 0,g_getDocumentEndTime:void 0,g_getDocumentRequestStatus:void 0,g_getCellsStartTime:void 0,g_getCellsEndTime:void 0,g_getInitializeLocalCobaltStartTime:void 0,g_getInitializeLocalCobaltEndTime:void 0,g_initialResponseTime:void 0,g_initialResponseReadyTime:void 0,g_fastViewOpenTime:void 0,g_initialRequestInvokedTime:void 0,g_onInitialResponseReady:void 0,g_isUserCreatingPersonalNotebookFirstTime:!1,g_networkType:void 0,g_bootSSRData:void 0,g_bootSSRHtmlStringLength:void 0},h={fastView:void 0,initialParaId:0,fastBootError:void 0},v=function(){function t(){}return t.getElement=function(t){if(this.DOMElements.hasOwnProperty(t))return this.DOMElements[t];var e=document.getElementById(t);return e?this.DOMElements[t]=e:null},t.removeElement=function(t){t&&this.DOMElements.hasOwnProperty(t.id)&&delete this.DOMElements[t.id],t&&t.parentNode&&t.parentNode.removeChild(t)},t.removeElementById=function(t){this.removeElement(this.getElement(t))},t.DOMElements={},t}(),p=function(){function t(){}return t.initialize=function(t,e,n,i,r,o,a,s,u,c,l,d,f,h,v,p,m){this.isViewMode=t&&!v,this.isEmbedMode=e,this.isInTouchMode="ontouchstart"in window,this.isSimplifiedReactRibbonInTreatment=n,this.isOldRibbonCollapsedCookieOn="false"!==C.getCookie(i).toLowerCase(),this.isSimplifiedRibbonCookieOn="false"!==C.getCookie(r).toLowerCase(),this.isNewHeaderShown=!this.isViewMode,this.isSimplifiedReactRibbonShown=this.isSimplifiedReactRibbonInTreatment&&this.isSimplifiedRibbonCookieOn&&!this.isViewMode,this.isOldRibbonExpandedAndShown=!this.isSimplifiedReactRibbonShown&&!this.isOldRibbonCollapsedCookieOn&&!this.isViewMode,this.isOldRibbonCollapsedAndShown=!this.isSimplifiedReactRibbonShown&&this.isOldRibbonCollapsedCookieOn&&!this.isViewMode,this.isViewModeAndRibbonPanelSmall=this.isViewMode&&this.isOldRibbonCollapsedCookieOn&&!this.isSimplifiedReactRibbonInTreatment,this.isViewModeAndRibbonPanelLarge=this.isViewMode&&(!this.isOldRibbonCollapsedCookieOn||this.isSimplifiedReactRibbonInTreatment),this.isSnackbarNavPaneEnabled=o,this.isTwoPaneNavEnabled=a,this.isCssPositionRewriteEnabled=s,this.hideSkeletalHeader=u,this.hideSkeletalRibbon=c,this.hideSkeletalNavPane=l,this.embedViewer=d,this.isHostRenderingEnabled=f,this.postMessageOrigin=h,this.isOneNoteNavPaneCollapseOnSmallScreenEnabled=p,this.regionComposerIsEnabled=m},t}();!function(t){t[t.HideAnimationTime=256]="HideAnimationTime",t[t.MinWidthToShowPageColumnPane=900]="MinWidthToShowPageColumnPane",t[t.MinWidthToShowNavpane=499]="MinWidthToShowNavpane",t[t.MinWidthToResizeTwoPaneNav=425]="MinWidthToResizeTwoPaneNav",t[t.MinWidthForTwoPaneNav=300]="MinWidthForTwoPaneNav"}(d||(d={}));var m=0,b=!1,w=!1,g=function(){function t(){}return t.clearAriaLoadingAttributes=function(){var t=document.getElementById("applicationOuterContainer");t&&(t.removeAttribute("aria-busy"),t.removeAttribute("aria-hidden"))},t.getFastViewSkeletalClass=function(){return p.isCssPositionRewriteEnabled?this.u():this.h()},t.updateRibbonPanel=function(){p.regionComposerIsEnabled||(p.isCssPositionRewriteEnabled&&p.isSimplifiedRibbonCookieOn?this.v():this.g())},t.updateWacDocumentPanel=function(){p.isCssPositionRewriteEnabled&&p.isSimplifiedRibbonCookieOn?this.S():this.C()},t.customizeSkeletalExperience=function(){m=document.body.clientWidth,p.isSimplifiedReactRibbonShown?v.removeElementById("SkeletalAdditionOldRibbon"):v.removeElementById("SkeletalNewRibbon"),p.isEmbedMode||p.embedViewer?(v.removeElementById("SkeletalHeader"),v.removeElementById("SkeletalNewHeader")):p.isNewHeaderShown?v.removeElementById("SkeletalHeader"):v.removeElementById("SkeletalNewHeader"),p.hideSkeletalRibbon&&v.removeElementById("SkeletalRibbon"),p.hideSkeletalNavPane&&v.removeElementById("SkeletalNavpane"),this.R()},t.bringFastViewToForegroundOfSkeletalCanvas=function(){var t=v.getElement("WACFastView");t&&(t.style.position="initial")},t.removeAllSubunitsFromSkeletalCanvas=function(){var t=v.getElement("SkeletalCanvas");if(t)for(var e=t.children.length-1;e>=0;e-=1){var n=t.children.item(e);n&&"WACFastView"!==n.id&&t.removeChild(n)}},t.fadeOutAndRemoveElement=function(t,e){var n=v.getElement(t);n&&(n.style.background="transparent",n.style.opacity="0",n.className+=" skeletalCover",window.setTimeout((function(){v.removeElement(n),e&&e()}),d.HideAnimationTime))},t.setMainContentEditable=function(){if(!b){b=!0,this.fadeOutAndRemoveElement("SkeletalNavpane"),this.fadeOutAndRemoveElement("SkeletalMainContent");var t=document.getElementById("load_back");t&&(t.style.height="auto")}},t.u=function(){return t.h()},t.h=function(){var t="";return S()?t="SkeletalFastViewRtl":(t="SkeletalFastView",p.isTwoPaneNavEnabled&&!p.isEmbedMode?t="SkeletalFastView":p.isEmbedMode||m<=d.MinWidthToShowNavpane?t="SkeletalFastViewNoNavpane":m<=d.MinWidthToShowPageColumnPane&&(t="SkeletalFastViewPageColumnNavpane")),p.isViewModeAndRibbonPanelLarge&&(t+=" SkeletalFastViewViewMode"),p.isEmbedMode&&(t+=" SkeletalFastViewEmbedMode"),t},t.k=function(){p.isCssPositionRewriteEnabled?t.O():t.P()},t.O=function(){t.P()},t.P=function(){var t=v.getElement("SkeletalMainContent");t&&!p.isCssPositionRewriteEnabled&&(t.className+=p.isEmbedMode?" collapsedRibbonEmbedMode":" collapsedRibbon"),v.removeElementById("SkeletalRibbonExtension")},t.v=function(){if(!w)if(p.isViewMode)w=!0;else{document.getElementById("WACRibbonPanel")&&(w=!0);var t=document.getElementsByClassName("WACReadingBarPanel").item(0);t&&(t.style.display="none")}},t.g=function(){if(!w){var t=document.getElementsByClassName("WACReadingBarPanel").item(0);if(p.isViewMode&&t)w=!0,p.isViewModeAndRibbonPanelLarge?t.className+=" RibbonPanelMaximizedViewMode":p.isViewModeAndRibbonPanelSmall&&(t.className+=" RibbonPanelMinimized");else{if(!p.regionComposerIsEnabled){var e=document.getElementById("WACRibbonPanel");null!=e&&(w=!0,p.isSimplifiedReactRibbonShown?(e.className+=" RibbonPanelSLRMode",e.className+=" RibbonPanelNewSLRMode"):p.isOldRibbonExpandedAndShown&&!p.isInTouchMode?e.className+=" RibbonPanelMaximized":p.isOldRibbonExpandedAndShown&&p.isInTouchMode?e.className+=" RibbonPanelMaximizedTouchMode":p.isOldRibbonCollapsedAndShown&&(e.className+=" RibbonPanelMinimized"))}t&&(t.style.display="none")}}},t.S=function(){var t=document.getElementById("WACDocumentPanelContent");null!=t&&(t.style.border="unset")},t.C=function(){var t=document.getElementById("WACDocumentPanel"),e=document.getElementById("WACDocumentPanelContent");null!=t&&(t.className+=" skeletalEnabled",p.isViewModeAndRibbonPanelLarge?t.style.top="40px":p.isViewModeAndRibbonPanelSmall?t.style.top="30px":p.isSimplifiedReactRibbonShown?t.style.top="77px":p.isOldRibbonCollapsedCookieOn||p.isInTouchMode||(t.style.top="124px"),S()?t.style.right="0px":p.isTwoPaneNavEnabled&&!p.isEmbedMode?m<d.MinWidthForTwoPaneNav?t.style.left=d.MinWidthToShowNavpane.toFixed()+"px":m<d.MinWidthToResizeTwoPaneNav?t.style.left=m.toFixed()+"px":t.style.left="426px":p.isEmbedMode||m<=d.MinWidthToShowNavpane?t.style.left="0px":m<=d.MinWidthToShowPageColumnPane?t.style.left="198px":p.isSnackbarNavPaneEnabled?t.style.left="426px":t.style.left="393px"),null!=e&&(e.style.border="unset")},t.R=function(){var e=v.getElement("SkeletalMainContent"),n=v.getElement("SkeletalExperience"),i=v.getElement("SkeletalRibbon");if(p.hideSkeletalHeader&&n&&(n.className+=" noHeader"),p.hideSkeletalRibbon&&n&&(n.className+=" noRibbon"),p.hideSkeletalNavPane&&n&&(n.className+=" noNavPane"),p.isViewMode?(n&&p.isCssPositionRewriteEnabled&&n.classList.remove("skeletalSLRGridRows"),i&&(i.innerHTML=""),p.isViewModeAndRibbonPanelSmall?(e&&!p.isCssPositionRewriteEnabled&&(e.style.top=p.isEmbedMode?"30px":"78px"),n&&p.isCssPositionRewriteEnabled&&(n.className+=" skeletalLegacyRibbonGridRows"),i&&!p.isCssPositionRewriteEnabled&&(i.className="skeletalRibbon skeletalRibbonCollapsedViewMode")):p.isViewModeAndRibbonPanelLarge?(i&&!p.isCssPositionRewriteEnabled&&(i.className="skeletalRibbon skeletalRibbonExpandedViewMode"),p.isCssPositionRewriteEnabled&&n?n.className+=" skeletalReadingRibbonGridRows":!p.isCssPositionRewriteEnabled&&e&&(e.style.top=p.isEmbedMode?"40px":"88px")):n&&p.isCssPositionRewriteEnabled&&(n.className+=" skeletalReadingRibbonGridRows")):n&&!p.isSimplifiedReactRibbonShown&&p.isCssPositionRewriteEnabled&&(p.isOldRibbonExpandedAndShown&&!p.isInTouchMode?n.className+=" skeletalLegacyRibbonMaximizedGridRows":p.isOldRibbonExpandedAndShown&&p.isInTouchMode?n.className+=" skeletalLegacyRibbonMaximizedTouchModeGridRows":p.isOldRibbonCollapsedAndShown&&(n.className+=" skeletalLegacyRibbonGridRows")),p.isSimplifiedReactRibbonShown?i&&(i.className=p.isCssPositionRewriteEnabled?"skeletalPositionRewriteRibbon":"skeletalSLRNewVisual"):i&&p.isCssPositionRewriteEnabled&&(i.className="skeletalPositionRewriteRibbon",p.isViewMode&&(i.className+=" viewMode")),p.isEmbedMode){i&&(p.isCssPositionRewriteEnabled||(i.style.top="0px"));var r=v.getElement("SkeletalAdditionOldRibbon");r&&!p.isCssPositionRewriteEnabled&&(r.style.top="0px")}if(S()&&t.I(),p.isOldRibbonCollapsedAndShown?t.k():p.isOldRibbonExpandedAndShown&&p.isEmbedMode&&e&&!p.isCssPositionRewriteEnabled&&(e.style.top="125px"),p.isTwoPaneNavEnabled&&!p.isEmbedMode&&(m>d.MinWidthToShowNavpane||!p.isOneNoteNavPaneCollapseOnSmallScreenEnabled)){var o=v.getElement("SkeletalNavpane"),a=v.getElement("SkeletalNavpaneSectionColumn"),s=v.getElement("SkeletalNavpanePageColumn"),u=v.getElement("SkeletalCanvas"),c=v.getElement("SkeletalExperience");if(null!=o&&null!=a&&null!=s&&null!=u&&null!=c)if(m<=d.MinWidthForTwoPaneNav)p.isCssPositionRewriteEnabled?c.className+=" skeletalOreoTwopaneShrunkGridColumns":(o.style.width="300px",u.style.left="299px"),a.style.width="124px",s.style.width="124px";else if(m<=d.MinWidthToResizeTwoPaneNav){p.isCssPositionRewriteEnabled?c.style.gridTemplateColumns=m.toFixed()+"px 100%":(o.style.width=m.toFixed()+"px",u.style.left=m-1+"px");var l=.5*m-24;a.style.width=l.toFixed()+"px",s.style.width=l.toFixed()+"px"}}else if(p.isEmbedMode||m<=d.MinWidthToShowNavpane){v.removeElementById("SkeletalNavpane");u=v.getElement("SkeletalCanvas");var f=v.getElement("SkeletalExperience");p.isCssPositionRewriteEnabled&&f&&!p.hideSkeletalNavPane?p.isTwoPaneNavEnabled?f.className+=" skeletalNoTwopaneGridColumns":f.className+=" skeletalNoNavpaneGridColumns":!p.isCssPositionRewriteEnabled&&u&&(u.style.left="0px")}else if(m<=d.MinWidthToShowPageColumnPane){o=v.getElement("SkeletalNavpane");var h=v.getElement("SkeletalNotebookName"),b=(u=v.getElement("SkeletalCanvas"),v.getElement("SkeletalExperience"));v.removeElementById("SkeletalNavpaneSectionColumn"),v.removeElementById("skeletalNavpaneTab"),p.isCssPositionRewriteEnabled&&b?b.className+=" skeletalLegacyNavpanePageOnlyGridColumns":p.isCssPositionRewriteEnabled&&null!=o&&null!=u&&(o.style.width="201px",u.style.left="200px"),h&&(h.style.right="42px")}if(p.isSimplifiedReactRibbonShown&&null!=e)p.isCssPositionRewriteEnabled||(e.style.paddingTop=p.isEmbedMode?"74px":"126px",e.style.top="0px");else if(p.isOldRibbonCollapsedAndShown){var w=document.getElementsByClassName("skeletalRibbonBoxContainer").item(0),g=v.getElement("SkeletalRibbonBar");null!=e&&null!=g&&null!=w&&(v.removeElement(w),g.style.height="29px",g.style.borderBottom="1px solid #d2d2d2",p.isCssPositionRewriteEnabled||(e.style.top="0px"))}else if(p.isOldRibbonExpandedAndShown&&p.isInTouchMode){var C=v.getElement("SkeletalRibbonExtension");null==e||null==C||p.isCssPositionRewriteEnabled||(C.style.height="108px",e.style.top="187px")}},t.I=function(){var t=["SkeletalHeader","SkeletalNewHeader","SkeletalRibbonAppTitle","SkeletalSLRAppTitle","SkeletalRibbon","SkeletalAdditionOldRibbon","SkeletalMainContent","SkeletalCanvas"];for(var e in t){var n=v.getElement(t[e]);n&&(n.className+=" skeletalRTL")}var i=v.getElement("SkeletalCanvas");i&&(i.className+=" skeletalCanvasRtl")},t}();function S(){var t=v.getElement("SkeletalExperience");return null!=t&&"rtl"===t.getAttribute("direction")}var C=function(){function t(){}return t.ensureCookieCompliance=function(t,e){if(t){var n=[];e&&(n=JSON.parse(e)),WacCookieCompliance.requestConsentWithSettings(new CookieComplianceSettings(n))}},t.getCookie=function(t){if(!t)return"";if(t.indexOf("=")>=0)throw new RangeError(" = is not found in the cookie");var e=""+document.cookie,n=new RegExp("(?:^|; )"+t+"=([^;]*)"),i=e.match(n);return!i||i.length<2?"":i[1]},t.isDocumentEmpty=function(t){function e(t,e){return-1===(" "+t.className+" ").indexOf(" "+e+" ")}var n=t.querySelectorAll(".Paragraph");return!(!n||1!==n.length)&&(2===n[0].childElementCount&&!e(n[0].children[0],"TextRun")&&!e(n[0].children[1],"EOP")&&""===n[0].children[0].innerText)},t}();function R(){function t(){return navigator.userAgent.indexOf("iPad")>=0||navigator.userAgent.indexOf("Macintosh")>=0&&e()&&!(navigator.userAgent.indexOf("iPhone")>=0)}function e(){return navigator.maxTouchPoints>0}return navigator.userAgent.indexOf("Android")>=0||t()||e()}var y;function k(t,e,n,i){var r;t.cssPositionRewriteIsEnabled&&!i?r="WACFastViewPositionRewrite":r=t.isRegionComposerShown&&!i?"".concat("WACFastView"," regionComposer"):"WACFastView";if(t.wordIsSkeletalDeepLinkOn&&t.isDeepLinkScenario&&(r+=" Deeplink"),t.showRibbon||(r+=" HideRibbon"),t.showNavPane||(r+=" HideNavPane"),t.isOneNoteMobileViewerNavigationEnabled&&(r+=" ShowMobileViewerNavigation"),t.positionAbsolute){if(r+=" WACFastViewAbsolute",t.showRibbon?t.showRibbonHeader||(r+=" HeaderHidden"):r+=" HeaderAndRibbonHidden",t.showNavPane?t.showNavSections||(r+=" SectionsHidden"):r+=" NavHidden",t.simplifiedReactRibbonUxIsEnabled)r+=" OneLineRibbon",r+=" OneLineRibbonWithTabHeaderRefresh";else{var o=e(t.ribbonPreferenceCookieName);(!t.ribbonExpandedByDefault&&"false"===o||t.ribbonExpandedByDefault&&"true"!==o)&&(r+=" RibbonPinned",n&&(r+=" Touch"))}t.skeletalBootUXIsEnabled&&(r+=" "+g.getFastViewSkeletalClass()),t.snackbarNavPaneIsEnabled&&(r+=" Snackbar"),t.twoPaneNavIsEnabled&&(r+=" TwoPaneNav")}return r}function x(){var t=document.getElementById("load_img");t&&(t.style.opacity="0",t.style.height="1px");var e=document.getElementById("load_back");e&&(e.style.opacity="0",e.style.height="1px")}function O(t,e){if(!(e.wordIsSkeletalDeepLinkOn&&e.isDeepLinkScenario||0===h.initialParaId)){var n=document.querySelector("p[paraid='"+h.initialParaId+"']");if(!n||!n.getBoundingClientRect)return;var i=n.getBoundingClientRect().bottom,r=t.getBoundingClientRect().bottom;t.firstElementChild&&(t.firstElementChild.scrollTop=i-r+70)}}function P(){var t=document.getElementById("application");t&&(t.style.top="0")}var I,A,E=function(t,e){return void 0===e&&(e=!1),y?y.getBooleanFeatureGate(t,e):e};function D(t){I=t;try{JSON.parse(L("DisabledChangeGates","{}"))}catch(t){({})}}function L(t,e){return I&&I[t]?I[t]:e}function W(t){var e,i,r=t;e="AppChromeOverrideEnabled",void 0===i&&(i=!1),((A?A(e):I&&I[e]&&"true"===I[e].toLowerCase())||E(e,i))&&(r=L("AppChromeBaseScriptUrlOverride","")),n.p=n.p||r}var N=function(){function t(){}return t.launchExperience=function(e){p.initialize("false"===e.IsEditMode,"true"===e.IsEmbedMode,"true"===e.SimplifiedReactRibbonUxIsEnabled,e.RibbonPreferenceCookieNameHint,e.IsSimplifiedRibbonOnCookieName,"true"===e.SnackbarNavPaneIsEnabled,"true"===e.OneNoteTwoPaneNavPaneIsEnabled,"true"===e.OneNoteCssPositionRewriteIsEnabled,"true"===e.HideHeaderEmbedded,"true"===e.HideRibbonEmbedded||"true"===e.IsQuickNote,"true"===e.ONHideNavEmbedded,"true"===e.MobileEmbedViewer,"true"===e.PageSSRHostRenderingIsEnabled,e.PostMessageOrigin,"true"===e.OneNoteModeSwitcherIsEnabled,"true"===e.OneNoteNavPaneCollapseOnSmallScreenIsEnabled,"true"===e.RegionComposerIsEnabled),g.customizeSkeletalExperience(),this.showSkeletalUx(),window.setTimeout((function(){t.dismissSkeletalBootUx(!0)}),this.FORCE_DISMISS_AFTER)},t.showSkeletalUx=function(){var t=v.getElement("SkeletalExperience");if(t){var e=v.getElement("SkeletalCanvas");"true"===L("MobileEmbedViewerIsEnabled","false")&&e&&(e.style.left="-28px"),t.style.opacity="1",t.className+=" skeletalShow"}},t.setRibbonReady=function(){this.A||(this.D=!0,!this.tryDismissSkeletalBootUxIfAllComponentsReady()&&this.L&&g.fadeOutAndRemoveElement("SkeletalRibbon",(function(){self.dispatchEvent(new CustomEvent("RibbonVisible"))})))},t.setPageReady=function(){this.A||(g.updateRibbonPanel(),g.updateWacDocumentPanel(),this.L=!0,this.tryDismissSkeletalBootUxIfAllComponentsReady()||this.dismissSkeletalCanvas())},t.setNavpaneReady=function(){this.A||(g.updateRibbonPanel(),this.W=!0,!this.tryDismissSkeletalBootUxIfAllComponentsReady()&&this.L&&g.fadeOutAndRemoveElement("SkeletalNavpane",(function(){g.setMainContentEditable()})))},t.sendPostMessageToHostWindowRendering=function(){var t=this;window.requestAnimationFrame((function(){window.requestAnimationFrame((function(){if(!t.N){var e=window.parent,n={MessageId:"App_SwitchToWacFrame",SendTime:(new Date).getTime(),CorrelationId:"",Values:{entryPoint:"FastView"}};""!==p.postMessageOrigin&&e.postMessage(JSON.stringify(n),p.postMessageOrigin),t.N=!0}}))}))},t.setFastViewReady=function(){this.A||(p.isHostRenderingEnabled?this.dismissSkeletalCanvas(this.sendPostMessageToHostWindowRendering.bind(this)):this.dismissSkeletalCanvas())},t.showFastViewOnSkeletalCanvas=function(){var t=this;if(g.bringFastViewToForegroundOfSkeletalCanvas(),g.removeAllSubunitsFromSkeletalCanvas(),p.isHostRenderingEnabled){var e=document.querySelector(".skeletalShow");e&&e.addEventListener("animationend",(function(){t.sendPostMessageToHostWindowRendering()})),window.setTimeout((function(){t.sendPostMessageToHostWindowRendering()}),this.POST_MESSAGE_FOR_HOST_RENDERING)}},t.tryDismissSkeletalBootUxIfAllComponentsReady=function(){return!!(this.L&&this.W&&this.D)&&this.dismissSkeletalBootUx()},t.dismissSkeletalBootUx=function(e){if(void 0===e&&(e=!1),this.A)return!1;var n=document.getElementById("load_back"),i=document.getElementById("WACDocumentPanel"),r=document.getElementById("WACRibbonPanel");return n&&i&&r?(t.removeSkeletalExperience(),t.adjustElementsAfterSkeletalDismissal(n,i,r),this.A=!0,!0):(e&&t.removeSkeletalExperience(),!1)},t.removeSkeletalExperience=function(){var t=v.getElement("SkeletalExperience");t&&v.removeElement(t)},t.adjustWacRibbonAfterDismissSkeletal=function(t){p.regionComposerIsEnabled?t.style.height="100%":p.isCssPositionRewriteEnabled?this.adjustPositionRewriteWacRibbonAfterDismissSkeletal(t):this.adjustAbsoluteWacRibbonAfterDismissSkeletal(t)},t.adjustPositionRewriteWacRibbonAfterDismissSkeletal=function(t){t.style.height="auto"},t.adjustAbsoluteWacRibbonAfterDismissSkeletal=function(t){p.isSimplifiedReactRibbonShown?t.style.height="77px":t.style.height="auto"},t.adjustWacCanvasAfterDismissSkeletal=function(t){p.isCssPositionRewriteEnabled&&p.isSimplifiedReactRibbonShown||this.adjustAbsoluteWacCanvasAfterDismissSkeletal(t)},t.adjustAbsoluteWacCanvasAfterDismissSkeletal=function(t){t.className="SkeletalWacDocumentPanel skeletalEnabled "+t.className},t.dismissSkeletalCanvas=function(t){var e=this,n=document.getElementById("WACFastView");if(!this.A||n&&n.parentElement&&"SkeletalCanvas"===n.parentElement.id){this.L=!0;var i=document.getElementById("load_back");null!=i&&(this.preDismissSkeletalCanvas(i),g.fadeOutAndRemoveElement("SkeletalCanvas",(function(){t&&t(),e.W&&g.setMainContentEditable()})))}},t.preDismissSkeletalCanvas=function(t){p.isCssPositionRewriteEnabled?this.preDismissPositionRewriteSkeletalCanvas(t):this.preDismissAbsoluteSkeletalCanvas(t)},t.preDismissPositionRewriteSkeletalCanvas=function(t){this.preDismissAbsoluteSkeletalCanvas(t)},t.preDismissAbsoluteSkeletalCanvas=function(t){var e=document.getElementById("WACRibbonPlaceholder"),n=v.getElement("SkeletalRibbonExtension");if(null!=e&&null!=n&&(e.style.height="124px"),t.style.background="transparent",S()){var i=document.getElementById("application");i&&(i.style.minWidth="0px")}if(!p.isEmbedMode){var r=document.getElementById("AppHeaderPanel");r&&(r.style.height="48px")}},t.adjustElementsAfterSkeletalDismissal=function(t,e,n){t&&(t.style.display="none",t.style.height="1px",t.style.opacity="0",t.setAttribute("aria-hidden","true"),g.clearAriaLoadingAttributes()),e&&this.adjustWacCanvasAfterDismissSkeletal(e),n&&this.adjustWacRibbonAfterDismissSkeletal(n)},t.D=!1,t.L=!1,t.W=!1,t.A=!1,t.N=!1,t.FORCE_DISMISS_AFTER=2e4,t.POST_MESSAGE_FOR_HOST_RENDERING=500,t}(),F=function(){function t(){}return t.getFloatingObjectsContainerWidth=function(){return this.canvasAndFcOuterSurfaceOffset+this.floatingContainersOuterSurfaceWidth},t.shouldShiftFastView=function(e,n,i){return t.shouldShiftBasedOnScreenSize(i)&&t.shouldShiftBasedOnNumSections(n)&&e},t.shouldShiftRealCanvas=function(e,n,i,r,o){if(!t.shouldShiftBasedOnScreenSize(e))return!1;var a=n(i);return!!t.shouldShiftBasedOnNumSections(a)&&r(o)},t.shouldShiftBasedOnScreenSize=function(t){return"Small"!==t},t.shouldShiftBasedOnNumSections=function(t){return 1===t},t.canvasAndFcOuterSurfaceOffset=30,t.floatingContainersOuterSurfaceWidth=240,t}();function T(t,e){window._bB&&window._bB.sendBeacon(t,e)}var M=function(){return!!window&&!!window.performance&&!!window.performance.mark};function V(){return"PerformanceObserver"in window&&"function"==typeof PerformanceObserver}function B(t){return V()&&PerformanceObserver.supportedEntryTypes&&-1!==PerformanceObserver.supportedEntryTypes.indexOf(t)}var _=function(t){if(M())try{window.performance.mark(t)}catch(t){}};function j(t,e,n){if(M()&&window.performance.measure)try{window.performance.measure(t,e,n)}catch(t){}}var U=function(t,e){this.eventName=t,this.timeStamp=(new Date).getTime()-e},H=function(){function t(t,e,n,i,r,o,a,s,u){void 0===r&&(r="Default"),void 0===o&&(o=C.getCookie),void 0===a&&(a=!1),void 0===s&&(s=!1),void 0===u&&(u=0);var c=this;this.getTopbarContainerFunc=t,this.getRibbonContainerFunc=e,this.getDocumentContainerFunc=n,this.appearance=i,this.entry=r,this.getCookieFunc=o,this.fastViewOnSkeletal=a,this.hasUnresolvedComments=s,this.numSections=u,this.F=R(),this.T=function(t){"Shift"!==t.key&&"Control"!==t.key&&"Alt"!==t.key&&c.M(t.type)},this.V=function(t){(13===t.keyCode||t.ctrlKey&&(66===t.keyCode||73===t.keyCode||85===t.keyCode))&&(t.preventDefault(),c.M(t.key))},this.B=function(t){if(void 0!==c.isEditable&&void 0!==c.htmlElement&&void 0!==c._&&c.isEditable&&c.appearance.pasteLoadingUI&&!c.isPasteLoading&&c.htmlElement.parentElement){c.isPasteLoading=!0;var e=function(t){var e=document.createElement("div");e.id="WACLoadingPasteUI";var n=document.createElement("div");n.className="WACFastLoadingBoxUI";var i,r=document.createElement("img");return r.src=t,r.className="WACProgressIcon",n.appendChild(r),e.appendChild(n),e.appendChild(((i=document.createElement("div")).className="WACFastLoadingOverlay WACDialogOverlay",i)),e.setAttribute("aria-busy","true"),e.setAttribute("role","progressbar"),e}(c.appearance.loadingUIGif);c.htmlElement.parentElement.appendChild(e),c.pasteData=function(t){var e={};if(null!=t&&null!=t.types){var n=t.types[0];e.type=n,e.data=t.getData(n)}else{var i=window.clipboardData,r=i.getData("text");null!==r?(e.type="text/plain",e.data=r):i.files.length>0&&(e.type="image/png",e.data=i.files[0])}return e}(t.clipboardData),c._.removeAttribute("contentEditable"),t.preventDefault()}else c.j(t)},this.j=function(t){c.M(t.type),t.preventDefault()},this.M=function(t){c.eventLogs&&c.openTime&&c.eventLogs.push(new U(t,c.openTime))},this.U=function(t){if(c.M(t.type),c._&&t.target!==c._){if(c._.focus(),window.getSelection){var e=window.getSelection();e&&e.collapseToEnd()}t.preventDefault()}},this.H=function(t){var e=t.querySelector(".PageContentContainer");e&&(e.className+=" WACFastViewEditor",e.addEventListener("mousedown",(function(t){c.U(t)}))),c._=t.querySelector(".NormalTextRun"),c._&&(c._.contentEditable="true",c._.style.outline="0px",c._.spellcheck=!1,c._.setAttribute("aria-hidden","true"),c._.focus(),c._.addEventListener("paste",(function(t){c.B(t)})),c._.addEventListener("keydown",(function(t){c.V(t)})))},this.J=function(t){T(t,"BootPhaseCompleted")},this.q=function(t){if(null!=t){var e=t.querySelector(".OutlineContainer"),n=t.querySelector(".PageContentContainer");if(null!=e&&null!=n){var i=document.createElement("div"),r=F.getFloatingObjectsContainerWidth()+"px";c.appearance.isRtl?i.style.paddingLeft=r:i.style.paddingRight=r,n.appendChild(i),i.appendChild(e)}}},this.G=function(){c.appearance.positionAbsolute&&c.appearance.showRibbon&&!c.X&&!c.appearance.skeletalBootUXIsEnabled&&(c.showRibbonPlaceholder(),c.X=!0)},this.eventLogs=[],this.openTime=0,this.hasShifted=!1}return t.prototype.removeKeypressEventListener=function(){this.appearance.fixRemoveKeypressEventListenerInFastView?document.removeEventListener("keydown",this.T):this.K&&document.removeEventListener("keydown",this.K)},t.prototype.showRibbonPlaceholder=function(){var t=this;function e(t,e){var n=document.createElement("div");return n.className="ribbonBar",n.setAttribute("unselectable","on"),n.appendChild(t),n.appendChild(e),n}if(!document.getElementById("ExternalHeaderFullTopBars")){var n=this.getTopbarContainerFunc(),i=this.appearance.showHeaderPlaceholder?document.getElementById("HeaderPlaceholder"):void 0;if(n&&this.appearance.showRibbonHeader)if(i)this.topbarPlaceholderElement=i;else{var r=document.createElement("div");r.className="cui-topBar2",this.appearance.darkModeEnabled?r.className+=" SharedUXDarkModeFastViewHeader":this.appearance.modernUXEnabled&&(r.className+=" ModernUXFastViewHeader"),r.setAttribute("unselectable","on");var o=document.createElement("div");o.id="WACTopbarPlaceholder";var a=function(){var e=document.createElement("div");e.className="cui-topBar1",t.appearance.reactSharedHeaderIsEnabled?e.className+=" cui-topBar1-transitionalReactHeaderUI":e.className+=" cui-topBar1-transistionalHeaderUI",t.appearance.darkModeEnabled?e.className+=" SharedUXDarkModeFastViewHeader":t.appearance.modernUXEnabled&&(e.className+=" ModernUXFastViewHeader"),e.setAttribute("unselectable","on");var n="",i="";t.appearance.headerBackgroundColorOverride&&(n="background-color:".concat(t.appearance.headerBackgroundColorOverride,";")),t.appearance.headerTextColorOverride&&(i="color:".concat(t.appearance.headerTextColorOverride,";")),t.appearance.reactSharedHeaderIsEnabled&&(n||i)&&e.setAttribute("style","".concat(n).concat(i));var r=document.createElement("span");r.className="cui-QATRowLeft BreadcrumbContainer";var o=document.createElement("span");o.className="AppAndBrandContainer",t.appearance.reactSharedHeaderIsEnabled&&n&&o.setAttribute("style",n);var a=document.createElement("div");a.className="WACFastBootLoader";var s=document.createElement("span");s.className="BreadcrumbItem";var u=t.appearance.reactSharedHeaderIsEnabled&&t.appearance.headerAppLauncherIsHidden;u?s.setAttribute("style","width:8px;height:48px;display:inline-block;"):s.setAttribute("style","width:48px;height:48px;display:inline-block;"),document.createElement("span").className="OfficeOnlineBrandSwitcherSeparator";var c=document.createElement("span");return c.className="headBrand",t.appearance.reactSharedHeaderIsEnabled?c.setAttribute("style","line-height:48px;margin-left:2px;"):c.setAttribute("style","line-height:48px;"),c.appendChild(document.createTextNode(t.appearance.appBrandedName)),o.appendChild(s),o.appendChild(c),u||o.appendChild(a),r.appendChild(o),e.appendChild(r),t.appearance.appColorUpdateIsEnabled&&(e.className+=" cui-color-update",o.className+=" cui-color-update"),e}();o.appendChild(a),o.appendChild(r),n.appendChild(o),this.topbarPlaceholderElement=o}var s=this.getRibbonContainerFunc();if(s&&0===s.children.length){var u=document.createElement("div");if(u.id="WACRibbonPlaceholder",u.className=u.id,this.appearance.showRibbon&&!this.appearance.skeletalBootUXIsEnabled)if(this.appearance.simplifiedReactRibbonUxIsEnabled)(c=function(n,i){var r=document.createElement("div");r.className=n?"oneLineRibbonUpperWithAnimation":"oneLineRibbonUpper",r.className+=" oneLineRibbonUpperWithTabHeaderRefresh";var o=document.createElement("div");return o.className=n?"oneLineRibbonLowerWithAnimation":"oneLineRibbonLower",t.appearance.darkModeEnabled?(r.className+=" SharedUXDarkModeFastViewRibbon",o.className+=" SharedUXDarkModeFastViewRibbon"):t.appearance.modernUXEnabled&&(r.className+=" ModernUXFastViewRibbon",o.className+=" ModernUXFastViewRibbon"),i&&(o.style.height="90px"),e(r,o)}(this.appearance.simplifiedReactRibbonAnimationIsEnabled,this.appearance.reactMultiLineRibbonIsVisible)).addEventListener("click",(function(){t.M("ribbonClick")})),u.appendChild(c);else if(this.appearance.showRibbonImage&&this.appearance.ribbonExpandedByDefault&&"true"!==this.getCookieFunc(this.appearance.ribbonPreferenceCookieName)){var c;(c=function(t,n){var i=document.createElement("div");i.className="ribbonUpper";var r=document.createElement("div");r.className="ribbonLower";var o=document.createElement("div");o.className="ribbonLeft";var a=function(t,e){var n=e;if(t){n=e.replace("bgapp_word_topleft","bgapp_word_topleft_touch")}return n}(t,n);return o.style.backgroundImage="url('".concat(a,"')"),t&&(r.className+=" ribbonTouch",o.className+=" ribbonTouch"),i.appendChild(o),e(i,r)}(this.F,this.appearance.ribbonImageBase)).addEventListener("click",(function(){t.M("ribbonClick")})),u.appendChild(c)}else u.style.height="30px";else u.className="cui-exth";s.appendChild(u),this.ribbonPlaceholderElement=u}}},t.prototype.open=function(t,e){var n=this;void 0===e&&(e=!1),this.appearance.showRibbonHeader||P(),this.G();var r=this.getDocumentContainerFunc();if(!r||!t)return!1;var o="canvasWrap"===r.id,a=document.createElement("div"),s=k(this.appearance,this.getCookieFunc,this.F,o);this.appearance.isRegionComposerShown&&(s+=" WACFastViewRegionComposer"),this.appearance.reactMultiLineRibbonIsVisible&&(s+=" WACFastViewMLRVisible"),a.className=s,a.id="WACFastView";var u=document.getElementById("CachedViewThemedCanvasBackgroundContainer");if(this.appearance.isBrowserSideCacheEnabled&&u?(r.removeChild(u),a.appendChild(u),u.innerHTML=t):a.innerHTML=t,this.appearance.isOneNoteCanvasZoomEnabled&&this.appearance.currentZoomLevel&&1!==this.appearance.currentZoomLevel){var c=a.querySelector(".PageContentOrigin");null!==c&&(c.style.transform="scale(".concat(this.appearance.currentZoomLevel,")"))}if(this.htmlElement=a,this.appearance.editable&&(this.isEditable=C.isDocumentEmpty(a)),e)a.style.visibility="hidden";else{this.appearance.fixRemoveKeypressEventListenerInFastView?document.addEventListener("keydown",this.T):(this.K=this.T,document.addEventListener("keydown",(function(t){n.K&&n.K(t)})));var l=function(t){n.M(t.type)};if(a.firstChild)if(a.firstChild.addEventListener("scroll",l),a.firstChild.addEventListener("click",l),a.firstChild.addEventListener("dblclick",l),a.firstChild.addEventListener("contextmenu",(function(t){n.j(t)})),o)a.firstChild.classList.add("WACFastViewNavOreoGrid");F.shouldShiftFastView(this.hasUnresolvedComments,this.numSections,i.getLayoutBreakpoint())?(this.M("Shifting Fast View"),this.appearance.isBrowserSideCacheEnabled||this.q(a),this.hasShifted=!0):this.M("Not shifting Fast View"),this.M("HasUnresolvedComments: "+this.hasUnresolvedComments+", NumSections == 1: "+(1===this.numSections)+", ScreenSize == Small: "+("Small"===i.getLayoutBreakpoint())),r.appendChild(a),navigator.userAgent.indexOf("Macintosh")>=0&&document.body.classList.add("Mac"),this.appearance.wordIsSkeletalDeepLinkOn&&this.appearance.isDeepLinkScenario&&document.body.classList.add("Deeplink"),this.fastViewOnSkeletal?N.showFastViewOnSkeletalCanvas():f.g_isUserCreatingPersonalNotebookFirstTime||(this.appearance.skeletalBootUXIsEnabled?N.setFastViewReady():x()),O(a,this.appearance),this.J("RecordContentDisplayed"),this.isEditable&&(a.className+=" WACFastViewEditable",this.H(a),this.J("RecordAppInteractive"))}return this.openTime=(new Date).getTime(),_("ViewableEnd"),j("Viewable","StartWacBoot","ViewableEnd"),!0},t.prototype.isOpen=function(){return!(!this.htmlElement||!this.htmlElement.parentNode)},t.cssClass="WACFastView",t.cssPositionRewriteClass="WACFastViewPositionRewrite",t.cssClassAbsolute="WACFastViewAbsolute",t}();Object(i.objectAssignPolyfill)();var J=function(){function t(){}return t.initialize=function(e){t.Y=e,t.Z||(t.Z=!0,t.$=document.createElement("div"),t.$.setAttribute("unselectable","on"),Object.assign(t.$.style,{pointerEvents:"none",width:"100%",height:"100%",zIndex:"1000",position:"absolute",visibility:"hidden",transition:"opacity "+t.tt+"ms"}),t.$.id=t.et,t.$.className=t.$.id)},t.launchExperience=function(e,n){var i="applicationOuterContainer";e&&(i=e),n&&(t.nt=n),document.getElementById(i).appendChild(t.$),t.it(),window.setTimeout((function(){return t.dismissSkeletalBootUx()}),t.nt)},t.setComponentReady=function(e){var n=t.rt(e);!t.A&&n&&(n.isReady=!0,t.ot()||t.fadeOutAndRemove(e))},t.dismissSkeletalBootUx=function(){if(t.A)return!1;for(var e in t.fadeOutAndRemove(t.et),t.st)t.fadeOutAndRemove(e);return t.st={},t.A=!0,self.dispatchEvent(new CustomEvent("RibbonVisible")),!0},t.getSkeletalComponentColor=function(e,n){return e?n?"#3D3D3D":"#323130":n?"#EBEBEB":t.ut},t.getSkeletalBackgroundColor=function(e,n){return e?n?"#141414":"#252423":n?"#F5F5F5":t.ct},t.addComponent=function(e){t.st[e.element.id]=e,e.element.style.transition="opacity "+t.tt+"ms",t.$.appendChild(e.element)},t.addComponentOutsideSkeletalContainer=function(e){t.st[e.element.id]=e,e.element.style.transition="opacity "+t.tt+"ms"},t.addShimmerToElement=function(t){if(!Object(i.isReducedAnimations)()){var e=document.getElementById(t);if(e){this.lt();var n=document.createElement("div");n.id=t+"_Shimmer",Object.assign(n.style,{height:"200px",top:"-200px",width:"100000%",left:"-99900%",backgroundColor:"linear-gradient(rgba(255,255,255, 0), rgba(255,255,255,.4), rgba(255,255,255,.8), rgba(255,255,255,.4), rgba(255,255,255,0))",position:"absolute",transformOrigin:"left",zIndex:"1000",animation:"SkeletalShimmer 3s infinite linear"}),e.appendChild(n)}}},t.fadeOutAndRemove=function(e,n){var i=void 0,r=void 0;e===t.et?i=t.$:(r=t.rt(e))&&(i=r.element),i&&(i.style.opacity="0",window.setTimeout((function(){t.dt(i),r&&(t.ft(e),r.onRemoval&&r.onRemoval()),n&&n()}),t.tt))},t.isSkeletalDeepLink=function(){return t.Y},t.Z=!1,t.A=!1,t.nt=3e4,t.et="SkeletalContainer",t.tt=Object(i.isReducedAnimations)()?.001:200,t.st={},t.ut="#EDEBE9",t.ct="#F3F2F1",t.Y=!1,t.ht=!1,t.it=function(){t.$&&(t.$.style.visibility="visible",t.$.style.opacity="1")},t.vt=function(){for(var e in t.st)if(!t.st[e].isReady)return!1;return!0},t.ot=function(){return!!t.vt()&&t.dismissSkeletalBootUx()},t.lt=function(){if(!t.ht){var e=document.createElement("style");e.type="text/css";e.appendChild(document.createTextNode("@keyframes SkeletalShimmer {       100% { -webkit-transform: rotate(0.06deg); transform: rotate(0.06deg); }      }")),document.getElementsByTagName("head")[0].appendChild(e),t.ht=!0}},t.rt=function(e){return t.st[e]},t.ft=function(e){delete t.st[e]},t.dt=function(t){t&&t.parentNode&&t.parentNode.removeChild(t)},t}(),q=function(){function t(){}return t.initialize=function(){this.metrics={initialVisibility:document.visibilityState,initializeTime:new Date,events:[]},document.addEventListener("visibilitychange",t.handleVisibilityChange)},t.stop=function(){document.removeEventListener("visibilitychange",this.handleVisibilityChange)},t.handleVisibilityChange=function(){var e={visibility:document.visibilityState,time:new Date};t.metrics.events.push(e)},t}();q.initialize();var z,G=function(){function t(){}return t.isDocumentCacheItemValid=function(e,n){if(!e)return T("DocumentCacheItem is null",t.LOG_CATEGORY),!1;var i=null,r=Date.now()-e.timeStamp;return r>=t.TIMEOUT_IN_MILLISECONDS&&(i={StaleItem:{timestamp:e.timeStamp,timeElapsed:r}}),e.schemaVersion!==n&&(i={VersionMismatch:{cacheSchemaVersion:e.schemaVersion,currentSchemaVersion:n}}),!i||(T(JSON.stringify(i),t.LOG_CATEGORY),!1)},t.isDocumentCacheItemViewModeValid=function(e,n,i){if(!e)return T("DocumentCacheItem is null",t.LOG_CATEGORY),!1;var r=null;return e.isPaginatedView!==n&&(r={MismatchViewMode:{isPaginatedCacheView:e.isPaginatedView,isPaginatedMode:n}}),e.isDarkCachedView!==i&&(r={MismatchCanvasColorMode:{isCacheDarkCanvas:e.isDarkCachedView,isDarkCanvas:i}}),!r||(T(JSON.stringify(r),t.LOG_CATEGORY),!1)},t.MILLISECONDS_IN_A_DAY=864e5,t.TIMEOUT_IN_DAYS=30,t.TIMEOUT_IN_MILLISECONDS=t.TIMEOUT_IN_DAYS*t.MILLISECONDS_IN_A_DAY,t.LOG_CATEGORY="DocumentCacheUtilsLogs",t}(),X=function(){function t(t,e,n,i,r,o){this.documentBrowserCache=t,this.documentId=e,this.currentSchemaVersion=n,this.isPaginatedMode=i,this.isDarkCanvasBackground=r,this.createDarkModeThemeContainer=o}return t.prototype.getDocumentBrowserCache=function(){return this.documentBrowserCache},t.prototype.loadDocumentCache=function(){var t=this.documentBrowserCache.getCacheKey(this.documentId),e=this.documentBrowserCache.getDocumentCacheItem(t);if(!(!!G.isDocumentCacheItemValid(e,this.currentSchemaVersion)&&G.isDocumentCacheItemViewModeValid(e,this.isPaginatedMode,this.isDarkCanvasBackground)))return!1;if((null==e?void 0:e.isDarkCachedView)&&!this.createDarkModeThemeContainer())throw"DarkModeThemeContainer creation failed";var n=window.self.g_instantApp;if(!n||!e)throw"Instant app is null";return n.launchFastView(e.documentViewport,!1,e.hasUnresolvedComments,e.numSections),!0},t.MILLISECONDS_IN_A_DAY=864e5,t.TIMEOUT_IN_DAYS=30,t.LOG_CATEGORY="CanvasLoaderLogs",t}(),K=function(){function t(t,e){this.documentBrowserCache=t,this.currentSchemaVersion=e}return t.prototype.evictInvalidCacheItems=function(){for(var t=this.documentBrowserCache.getKeysInCache(),e=0,n=0;n<t.length;n++){var i=t[n],r=this.documentBrowserCache.getDocumentCacheItem(i);G.isDocumentCacheItemValid(r,this.currentSchemaVersion)||(this.documentBrowserCache.removeDocumentCacheItem(i),e++)}return e},t.prototype.evictSpecifiedCacheItem=function(t){var e=this.documentBrowserCache.getCacheKey(t);return!!this.documentBrowserCache.getDocumentCacheItem(e)&&(this.documentBrowserCache.removeDocumentCacheItem(e),!0)},t.prototype.evictAllCacheItems=function(){return this.documentBrowserCache.clearBrowserCache()},t}(),Q=function(t,e,n,i,r,o,a,s){this.documentViewport=t,this.timeStamp=e,this.schemaVersion=n,this.isPaginatedView=i,this.documentItemSize=r,this.hasUnresolvedComments=o,this.numSections=a,this.isDarkCachedView=s},Y=function(){function t(){}return t.getAndLoadDocumentCache=function(e){if(e.getDocumentBrowserCache().isSupported())try{var n=e.loadDocumentCache();T("Is LoadDocumentCache sucessful: ".concat(n),t.LOAD_LOG_CATEGORY)}catch(e){T("Exception in DocumentCacheLoader: "+e.message,t.LOAD_LOG_CATEGORY)}else T("Cache is not supported",t.LOAD_LOG_CATEGORY)},t.saveDocument=function(e,n,i,r,o,a,s,u){if(void 0===i&&(i=!0),void 0===r&&(r=!1),void 0===o&&(o=!1),void 0===a&&(a=1),void 0===s&&(s=""),void 0===u&&(u=""),e.getDocumentBrowserCache().isSupported())try{var c=e.saveDocument(n,i,r,o,a,s,u);T("DocumentCacheSaver result: ".concat(c),t.SAVE_LOG_CATEGORY)}catch(e){T("Exception in DocumentCacheSaver: "+e.message,t.SAVE_LOG_CATEGORY)}else T("Cache is not supported",t.SAVE_LOG_CATEGORY)},t.evictInvalidCacheEntries=function(e){try{var n=e.evictInvalidCacheItems();T("DocumentCacheRemover.evictInvalidCacheEntries result: ".concat(n),t.REMOVE_LOG_CATEGORY)}catch(e){T("Exception in DocumentCacheRemover.evictInvalidCacheEntries: "+e.message,t.REMOVE_LOG_CATEGORY)}},t.evictSpecifiedCacheItem=function(e,n){try{var i=e.evictSpecifiedCacheItem(n);T("DocumentCacheRemover.evictSpecifiedCacheItem result: ".concat(i),t.REMOVE_LOG_CATEGORY)}catch(e){T("Exception in DocumentCacheRemover.evictSpecifiedCacheItem: "+e.message,t.REMOVE_LOG_CATEGORY)}},t.evictAllCacheItems=function(e){try{var n=e.evictAllCacheItems();T("DocumentCacheRemover.evcitAllCacheItem result: ".concat(n),t.REMOVE_LOG_CATEGORY)}catch(e){T("Exception in DocumentCacheRemover.evictAllCacheItems: "+e.message,t.REMOVE_LOG_CATEGORY)}},t.LOAD_LOG_CATEGORY="GetAndLoadDocumentCache",t.SAVE_LOG_CATEGORY="SaveDocument",t.REMOVE_LOG_CATEGORY="RemoveInvalidDocumentCacheItem",t}();!function(t){t[t.SuccessFirstTry=0]="SuccessFirstTry",t[t.SuccessSecondTry=1]="SuccessSecondTry",t[t.LocalStorageNotSupported=2]="LocalStorageNotSupported",t[t.FailedSaveDocument=3]="FailedSaveDocument"}(z||(z={}));var Z=function(){function t(){}return t.prototype.isSupported=function(){try{var t="__storage_test__";return localStorage.setItem(t,t),localStorage.removeItem(t),!0}catch(t){return t instanceof DOMException&&(22===t.code||1014===t.code||"QuotaExceededError"===t.name||"NS_ERROR_DOM_QUOTA_REACHED"===t.name)&&localStorage&&0!==localStorage.length}},t.prototype.getDocumentCacheItem=function(t){var e=localStorage.getItem(t);return e?JSON.parse(e):null},t.prototype.saveDocumentCacheItem=function(t,e){if(!e)return!1;var n=JSON.stringify(e);return localStorage.setItem(t,n),!0},t.prototype.removeDocumentCacheItem=function(t){localStorage.removeItem(t)},t.prototype.clearBrowserCache=function(){for(var e=0,n=Object.keys(localStorage),i=0;i<n.length;i++){var r=n[i];r.startsWith(t.KEY_PREFIX)&&(localStorage.removeItem(r),e++)}return e},t.prototype.getItemsInCache=function(){for(var e=[],n=Object.keys(localStorage),i=0;i<n.length;i++){var r=n[i];if(r.startsWith(t.KEY_PREFIX)){var o=this.getDocumentCacheItem(r);o&&e.push({key:r,item:o})}}return e},t.prototype.getKeysInCache=function(){for(var e=[],n=Object.keys(localStorage),i=0;i<n.length;i++){var r=n[i];r.startsWith(t.KEY_PREFIX)&&e.push(r)}return e},t.prototype.getCacheKey=function(e){if(!e)throw new Error("documentId is an empty string");return t.KEY_PREFIX+e},t.KEY_PREFIX="WordCachedDoc_",t}(),$=function(){function t(){}return t.prototype.isSupported=function(){return!0},t.prototype.getDocumentCacheItem=function(t){var e=localStorage.getItem(t);return JSON.parse(e)},t.prototype.saveDocumentCacheItem=function(t,e){var n=new Q("test",1633560587,"1.0",!1,5,!1,0,!1),i=JSON.stringify(n);return localStorage.setItem(t,i),!0},t.prototype.removeDocumentCacheItem=function(t){localStorage.removeItem(t)},t.prototype.clearBrowserCache=function(){return 0},t.prototype.getItemsInCache=function(){return[]},t.prototype.getKeysInCache=function(){return[]},t.prototype.getCacheKey=function(t){return"WordCachedDoc_"+t},t}(),tt=function(){function t(e,n,i,r,o,a){D(o),W(L("StaticContentUrl",""));var s=function(t){return"true"===o[t]};this.fastBootEnabled=s("FastBoot"),t.slice0Name=o.Slice0Name,this.appearance={positionAbsolute:!s("OneNoteCssPositionRewriteIsEnabled"),showRibbon:!s("HideRibbonEmbedded"),ribbonExpandedByDefault:e,ribbonPreferenceCookieName:o.RibbonPreferenceCookieNameHint,showRibbonImage:n,ribbonImageBase:o.RibbonImageBase,shouldStretchPageToBottom:i,appBrandedName:o.BrandedWebAppName,showRibbonHeader:!s("HideHeaderEmbedded"),showNavPane:r&&!s("ONHideNavEmbedded"),showNavSections:!s("ONHideSectionsEmbedded"),editable:!1,pasteLoadingUI:s("PasteInBootLoadingUIIsEnabled"),loadingUIGif:o.ProgressGifResource,simplifiedReactRibbonUxIsEnabled:!0,simplifiedReactRibbonAnimationIsEnabled:et(o),skeletalBootUXIsEnabled:s("OneNoteSkeletalBootUXIsEnabled"),snackbarNavPaneIsEnabled:s("SnackbarNavPaneIsEnabled"),twoPaneNavIsEnabled:s("OneNoteTwoPaneNavPaneIsEnabled"),reactSharedHeaderIsEnabled:s("ReactSharedHeaderIsEnabled"),headerAppLauncherIsHidden:s("AppLauncherIsHidden"),headerBackgroundColorOverride:decodeURIComponent(C.getCookie("ThemedHeaderBackgroundColor")),headerTextColorOverride:decodeURIComponent(C.getCookie("ThemedHeaderTextColor")),cssPositionRewriteIsEnabled:s("OneNoteCssPositionRewriteIsEnabled"),wordIsSkeletalDeepLinkOn:s("WordIsSkeletalDeepLinkOn"),isDeepLinkScenario:s("IsDeepLinkScenario"),reactMultiLineRibbonIsVisible:t.isReactMultilineRibbonVisible(o),renderFastViewOnSkeletalUXIsEnabled:s("OneNoteRenderFastViewOnSkeletalIsEnabled"),isRegionComposerShown:!!a,appColorUpdateIsEnabled:s("AppColorUpdateIsEnabled"),isRtl:s("Rtl"),showHeaderPlaceholder:s("ShowHeaderPlaceholder"),modernUXEnabled:s("Microsoft.Office.WordOnline.ModernUxExperimentOne")&&s("SharedUXThemingIsEnabled")&&nt(o),darkModeEnabled:t.isDarkModePreferenceOn(o),isOneNoteCanvasZoomEnabled:!1,currentZoomLevel:1,isOneNoteMobileViewerNavigationEnabled:s("OneNoteMobileViewerNavigationIsEnabled"),isBrowserSideCacheEnabled:s("IsBrowserSideCacheEnabled"),fixRemoveKeypressEventListenerInFastView:s("FixRemoveKeypressEventListenerInFastView"),fluent2StylesEnabled:s("Fluent2StyleIsEnabled")}}return t.prototype.launchFastView=function(t,e,n,i,r,o){if(void 0===n&&(n=!1),void 0===i&&(i=!1),void 0===r&&(r=!1),void 0===o&&(o=0),T("Launching FastView from entry point "+e,"BootLogs"),this.appearance.editable=n,this.fastBootEnabled&&!h.fastView&&!document.getElementById("PageContentContainer")){var a,s=document.getElementById("canvasWrap");if(null!=s&&this.appearance.cssPositionRewriteIsEnabled)a=s;else{var u=this.appearance.renderFastViewOnSkeletalUXIsEnabled&&i?"SkeletalCanvas":"WACInnerFrame";a=document.getElementById(u)}h.fastView=new H((function(){return document.getElementById("AppHeaderPanel")}),(function(){return document.getElementById("WACRibbonPanel")}),(function(){return a}),this.appearance,e,C.getCookie,i,r,o);try{return h.fastView.open(t)}catch(t){return h.fastBootError="FastView open failed: "+t.message+"\r\n"+t.stack,!1}}return!1},t.getSlice0=function(){if(null!=t.slice0Name&&t.slice0Name.length>0){var e=document.createElement("script");e.type="text/javascript",e.src=t.slice0Name,document.getElementsByTagName("head")[0].appendChild(e)}},t.isReactMultilineRibbonVisible=function(t){var e=function(t){return C.getCookie(t.ReactRibbonMLRPreferenceCookieName).toLowerCase()}(t);return"true"===t.ReactMultilineRibbonIsEnabled&&("true"===e||"false"===C.getCookie(t.IsSimplifiedRibbonOnCookieName).toLowerCase()||"undefined"===e&&E("Microsoft.Office.SharedOnline.DefaultToMLR",!1))},t.isDarkModePreferenceOn=function(t){return"true"===t.WordDarkModeIsEnabled&&"true"===t.DarkModeIsOn},t}();function et(t){return"true"===t.OneLineRibbonAnimationIsEnabled}function nt(t){var e=C.getCookie(t.ModernUxExperimentPreferenceCookieName).toLowerCase();return""===e?!("true"===t.ModernUxExperimentDefaultOffIsEnabled.toLowerCase()):"false"!==e}var it=function(t,e,n,i){void 0===n&&(n=!1),void 0===i&&(i=1),this.pageHtml=t,this.editable=e,this.hasUnresolvedComments=n,this.numSections=i};function rt(t,e,n,i){var r;return{baseDocId:t.BaseDocId,documentCacheItemSchemaVersion:t.DocumentCacheItemSchemaVersion,fastBootEnabled:"true"===t.FastBoot,getCachedSSR:"true"===t.GetCachedSSR,indexedDBPageTargetKey:"",initParagraphId:parseInt(t.InitialParaId,16),isIndexedDBEnabled:"true"===t.OneNoteIndexedDbCacheIsEnabled,isIndexedDBDefaultPageEnabled:"true"===t.OneNoteIndexedDBCacheDefaultPageIsEnabled,isOneNoteQuickloadCacheLocalStorageEnabled:"true"===t.OneNoteQuickloadCacheLocalStorageIsEnabled,isNewFile:"true"===t.CreateNew,isOneNoteHierarchySyncOnBootEnabled:"true"===t.OneNoteHierarchySyncIsEnabled,isOneNoteSyncConnectOnBootEnabled:"true"===t.OneNoteSyncConnectOnBootEnabled,isOneNoteSyncHeartBeatEnabled:"true"===t.OneNoteSyncHeartBeatIsEnabled,isOneNoteSyncHeartBeatNoShutdownEnabled:"true"===t.OneNoteSyncHeartBeatNoShutdownEnabled,isOneNoteAddUUIDForGetCellsEnabled:"true"===t.OneNoteAddUUIDForGetCellsIsEnabled,isUserCreatingPersonalNotebookFirstTime:"true"===t.IsUserCreatingPersonalNotebookFirstTime,isRemoveSsrEnabled:"true"===t.IsRemoveSsrEnabled,IsBrowserSideCacheEnabled:"true"===t.IsBrowserSideCacheEnabled,isRemoveSsrEnabledForDarkMode:tt.isDarkModePreferenceOn(t),oneNoteShouldSendQuerySignatureOnSocketSetup:"true"===t.OneNoteShouldSendQuerySignatureOnSocketSetup,contentSyncVersion:parseInt(t.OneNoteContentSyncVersion,10),optimizedForNewFile:n,pageTarget:t.PageTarget,pageTargetHtml:t.PageTargetHtml,requestOptions:ot(t,e,i),sessionStartJson:null!==(r=t.SessionStartInfoJson)&&void 0!==r?r:"UNKNOWN",skipPageHtmlInGetCellsResponse:"true"===t.SkipPageHtmlInGetCellsResponse,slice0Name:t.Slice0Name,syncHeartBeatSendInterval:parseInt(t.OneNoteSyncHeartBeatSendIntervalMs,10),syncHeartBeatWaitInterval:parseInt(t.OneNoteSyncHeartBeatWaitIntervalMs,10),channelOutboundTimeoutInterval:parseInt(t.OneNoteSyncChannelOutboundTimeoutIntervalMs,10),userId:t.UserId}}function ot(t,e,n){return{accessToken:n?n.AccessToken:t.AccessToken,accessTokenTtl:n?n.AccessTokenTtl:"",applicationModeExtended:t.SessionStartInfoJson?JSON.parse(t.SessionStartInfoJson).ApplicationModeExtended:"UNKNOWN",buildVersion:t.BuildVersion,canary:t.Canary,feMachineId:t.FEMachineId,logHostRequests:"true"===t.LogHostRequests?1:0,onenoteSyncEndpoint:t.ONOnlineSyncEndpoint,pageTarget:t.PageTarget,renderingMode:t.AddServerSideRenderingHeader,requestHeadMode:e,rootQuerySignature:t.RootQuerySignature,sessionOrigin:t.SessionOrigin?t.SessionOrigin:"UNKNOWN",url:t.WebServiceBase,userSessionId:t.SessionId,userType:t.UserType,wacCluster:t.WacCluster,wacUserAgent:t.WacUserAgent}}var at=function(){function t(t,e){var n=this;this.onGetCellsRequestCompleted=function(t){if(T("Get cells response received:"+t.status,"BootLogs"),!f.g_initialRequestCompleted){if(lt(t.responseText,!1),!h.fastView&&!n.shouldDisableSSR()){var e=function(t){if(t&&t.Responses[0]&&t.Responses[0][1]&&t.Responses[0][1].Cells)for(var e=t.Responses[0][1].Cells,n=0;n<e.length;n+=1){var i=e[n];if(i&&i.PageHtml)return new it(i.PageHtml,!!i.IsPageHtmlEditable,!!i.HasUnresolvedComments,i.NumSections)}}(f.g_initialRequestResponseObject);e&&e.pageHtml&&n.pt&&n.pt.launchFastView(e.pageHtml,"WacBootGetCells",e.editable,!1,e.hasUnresolvedComments,e.numSections)}f.g_fastViewOpenTime=new Date}},this.onInitialResponseReady=function(){f.g_onInitialResponseReady&&f.g_onInitialResponseReady()},this.bt=function(t){var e=t.responseText;if(!h.fastView){var i=function(t){var e=dt(t);if(e&&e.Responses[0]&&e.Responses[0][1]&&e.Responses[0][1].Html)return e.Responses[0][1].Html;return}(e);i&&n.pt&&n.pt.launchFastView(i,"WacBootRenderPage")}},this.pt=t,this.wt=e}return t.prototype.shouldDisableSSR=function(){return this.wt.isRemoveSsrEnabled||this.wt.isRemoveSsrEnabledForDarkMode||this.wt.IsBrowserSideCacheEnabled},t.prototype.makeGetCellsRequest=function(t,e){T("Making GetCells Request","BootLogs"),h.initialParaId=this.wt.initParagraphId||0;var n=JSON.stringify(window.location.href),i=',"SearchQuery":null,"IsNewFile":'+(this.wt.isNewFile&&this.wt.optimizedForNewFile).toString()+',"InitialParaId":'+h.initialParaId+',"RequestUrl":'+n+',"SkipPageHtmlInResponse":'+this.wt.skipPageHtmlInGetCellsResponse.toString();this.wt.sessionStartJson&&(i=i+',"SessionStartInfoJson":'+JSON.stringify(this.wt.sessionStartJson));var r=st(1,i,this.wt.requestOptions,{IsRemoveSsrEnabled:this.shouldDisableSSR()});return ut(this.wt.requestOptions.url+"OneNote.ashx"+(e?"?perfTag=GetCells_1&GetCellsBootstrapper=1":""),r,this.wt,t,ct)},t.prototype.makeRenderPageRequest=function(t){if(!this.wt.isNewFile||!this.wt.optimizedForNewFile){var e=st(46,"",this.wt.requestOptions,t);ut(this.wt.requestOptions.url+"OneNote.ashx?IsRenderPage=1",e,this.wt,this.bt,(function(){}))}},t.prototype.makeStartSessionRequest=function(t,e){ut(this.wt.requestOptions.url+t,"",this.wt,e,(function(){}))},t.getCellsFromFrameRequest=function(t){f.g_initialRequestCompleted||(lt(t,!0),f.g_fastViewOpenTime=new Date)},t}();function st(t,e,n,i){var r=JSON.stringify(n.rootQuerySignature);r&&(r=r.substring(1,r.length-1));var o=JSON.stringify(n.pageTarget);o&&(o=o.substring(1,o.length-1));var a='{"Mode":'+n.requestHeadMode+',"srs":[[',s=',{"FileId":"'+r+'","PageTarget":"'+o+'","OperationId":1';for(var u in i)s+=',"'+u+'":'+i[u];return a+t+s+e+"}]]}"}function ut(t,e,n,i,r){var o=new XMLHttpRequest,a={};for(var s in o.onreadystatechange=function(){if(o&&4===o.readyState){if(void 0===o.status||0===o.status)return;try{i&&i(o)}finally{null!=o&&(o.onreadystatechange=function(){},o=void 0)}}},o.open("Post",t,!0),function(t,e){var n=e.requestOptions;t["X-xhr"]="1",n.userSessionId&&(t["X-UserSessionId"]=n.userSessionId);n.buildVersion&&(t["X-OfficeVersion"]=n.buildVersion);t["Content-Type"]="application/json; charset=utf-8",n.canary&&(t["X-Key"]=n.canary);n.accessToken&&(t["X-AccessToken"]=n.accessToken);n.accessTokenTtl&&(t["X-AccessTokenTtl"]=n.accessTokenTtl);n.userType&&(t["X-UserType"]=n.userType);1===n.logHostRequests&&(t["X-LogHostRequests"]="1");n.wacCluster&&(t["X-WacCluster"]=n.wacCluster);n.wacUserAgent&&(t["X-WacUserAgent"]=n.wacUserAgent);n.renderingMode&&(t["X-ServerSideRendering"]=n.renderingMode);n.feMachineId&&(t["X-FEMachineId"]=n.feMachineId);e.sessionStartJson&&(t["X-SessionStartDimensions"]=function(t){if(!t||"UNKNOWN"===t)return t;var e={},n=JSON.parse(t);return e.Application=n.Application,e.ApplicationVersion=n.ApplicationVersion,e.Browser=n.Browser,e.BrowserMajorVersion=n.BrowserMajorVersion,e.BrowserVersion=n.BrowserVersion,e.Host=n.Host,e.IsSynthetic=n.IsSynthetic,e.Os=n.Os,e.Ring=n.Ring,e.RoutedVia=n.RoutedVia,e.SessionOrigin=n.SessionOrigin,e.UiHost=n.UiHost,e.UserSessionApplicationMode=n.UserSessionApplicationMode,e.WACDatacenter=n.WACDatacenter,JSON.stringify(e)}(e.sessionStartJson));if(e.isOneNoteAddUUIDForGetCellsEnabled){var i="".concat(1e7,"-").concat(1e3,"-").concat(4e3,"-").concat(8e3,"-").concat(1e11).replace(/[018]/g,(function(t){return(t^crypto.getRandomValues(new Uint8Array(1))[0]&15>>t/4).toString(16)}));f.g_getCellsUuid=i,t["X-GetCellsUUID"]=i}t["X-Requested-With"]="XMLHttpRequest"}(a,n),a)o.setRequestHeader(s,a[s]);var u=e;return e||(u=""),r(),o.send(u),o}function ct(){f.g_initialRequestInvokedTime=new Date,f.g_initialRequestMade=!0,_("InitialRequestStart")}function lt(t,e){f.g_getCellsFromFrameRequest=e,f.g_initialRequestCompleted=!0,f.g_initialResponseTime=new Date,_("InitialRequestEnd"),_("InitialResponseProcessStart"),j("InitialRequest","InitialRequestStart","InitialRequestEnd");var n=dt(t);if(f.g_initialRequestResponseObject=n,n&&n.Responses&&n.Responses[0]&&n.Responses[0][1]){var i=n.Responses[0][1];f.g_acquireLockStartTime=i.AcquireLockStartTime,f.g_acquireLockEndTime=i.AcquireLockEndTime,f.g_acquireLockRequestStatus=i.AcquireLockRequestStatus,f.g_getDocumentStartTime=i.GetDocumentStartTime,f.g_getDocumentEndTime=i.GetDocumentEndTime,f.g_getDocumentRequestStatus=i.GetDocumentrequestStatus,f.g_getCellsStartTime=i.GetCellsStartTime,f.g_getCellsEndTime=i.GetCellsEndTime,f.g_getInitializeLocalCobaltStartTime=i.InitializeLocalCobaltStartTime,f.g_getInitializeLocalCobaltEndTime=i.InitializeLocalCobaltEndTime}f.g_initialResponseReadyTime=new Date,_("InitialResponseProcessEnd"),j("InitialResponseProcess","InitialResponseProcessStart","InitialResponseProcessEnd")}function dt(t){try{return JSON.parse(t)}catch(t){h.fastBootError="JSON.parse failed: "+t.message+"\r\n"+t.stack}}function ft(){var t=window.performance;return t&&t.timeOrigin?t.timeOrigin:t&&t.timing&&t.timing.navigationStart?t.timing.navigationStart:0}function ht(){var t=window.performance;return t&&t.now?t.now():(new Date).getDate()-ft()}function vt(){var t=window.performance;return t&&t.now?ft()+t.now():(new Date).getDate()}function pt(t){return ft()+t}function mt(t,e){void 0===window.wacPerfObserver&&(window.wacPerfObserver={}),window.wacPerfObserver[t]=e}function bt(t){t.disconnect(),mt("timeOrigin",ft()),"function"==typeof window.CustomEvent&&window.dispatchEvent(new CustomEvent("WacStableInteractive",window.wacPerfObserver))}function wt(){V()&&-1!==PerformanceObserver.supportedEntryTypes.indexOf("paint")&&new PerformanceObserver((function(t){t.getEntries().forEach((function(t){"first-paint"===t.name?mt("firstPaint",t.startTime):"first-contentful-paint"===t.name&&mt("firstContentfulPaint",t.startTime)}))})).observe({type:"paint",buffered:!0}),V()&&-1!==PerformanceObserver.supportedEntryTypes.indexOf("largest-contentful-paint")&&new PerformanceObserver((function(t){var e=t.getEntries();mt("largestContentfulPaint",e[e.length-1].startTime)})).observe({type:"largest-contentful-paint",buffered:!0}),function(){if(V()&&-1!==PerformanceObserver.supportedEntryTypes.indexOf("element"))var t=new PerformanceObserver((function(e){e.getEntries().forEach((function(t){mt("elementPaint_".concat(t.id),t.startTime)})),t.observe({type:"element",buffered:!0})}))}()}var gt=function(){return(gt=Object.assign||function(t){for(var e,n=1,i=arguments.length;n<i;n++)for(var r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t}).apply(this,arguments)};Object.create;function St(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],i=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&i>=t.length&&(t=void 0),{value:t&&t[i++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Ct(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var i,r,o=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(i=o.next()).done;)a.push(i.value)}catch(t){r={error:t}}finally{try{i&&!i.done&&(n=o.return)&&n.call(o)}finally{if(r)throw r.error}}return a}function Rt(t,e,n){if(n||2===arguments.length)for(var i,r=0,o=e.length;r<o;r++)!i&&r in e||(i||(i=Array.prototype.slice.call(e,0,r)),i[r]=e[r]);return t.concat(i||Array.prototype.slice.call(e))}Object.create;function yt(t){return"visually-ready"===t||"functionally-ready"===t||"visually-perceived"===t}function kt(t,e){var n;for(var i in t)if(!(null===(n=t[i].states[e])||void 0===n?void 0:n.final))return!1;return!0}function xt(t,e){return e&&t&&yt(e)&&t.states[e]}function Ot(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];console.error.apply(console,Rt(["[RumShepherd]".concat(t)],Ct(e),!1))}function Pt(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];console.info.apply(console,Rt(["[RumShepherd]".concat(t)],Ct(e),!1))}function It(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];console.debug.apply(console,Rt(["[RumShepherd]".concat(t)],Ct(e),!1))}var At=function(t,e){try{var n=new CustomEvent(t,{detail:e});self.dispatchEvent(n)}catch(t){Ot("dispatchRumShepherdEvent failed with exception:",t)}},Et=[];function Dt(t,e,n,i){var r,o=Number(ht().toFixed()),a="[rum:".concat(o,"]").concat(e," ").concat(n?JSON.stringify(n):"");Et.push({level:t,message:a}),i&&(r={traces:Rt([],Ct(Et),!1)},Et=[],At("Wac-AppLoadTrace",r))}function Lt(t){return t?gt({},t):{}}function Wt(t){var e=[];for(var n in t){var i=t[n];e.push({id:i.id,rootElementId:i.rootElementId,subComponents:Ft(i.subComponents)})}return e}function Nt(t){var e=[];for(var n in t){var i=t[n];e.push({id:i.id,rootElementId:i.rootElementId,subComponents:Tt(i.subComponents)})}return e}function Ft(t){var e=[];for(var n in t){var i=t[n];i.nonReporting||e.push({id:i.id,initTime:pt(i.initTime),optional:i.optional,unused:i.unused,nonReporting:i.nonReporting,states:Mt(i.states)})}return e}function Tt(t){var e=[];for(var n in t){var i=t[n];i.nonReporting&&e.push({id:i.id,initTime:pt(i.initTime),optional:i.optional,unused:i.unused,nonReporting:i.nonReporting,states:Mt(i.states)})}return e}function Mt(t){var e={};for(var n in t){var i=t[n];(null==i?void 0:i.time)&&(e[n]=pt(i.time))}return e}function Vt(t,e){var n=t.subComponents;for(var i in n){var r=n[i];if(!(r.states[e]||r.unused||r.nonReporting))return!1}return!0}function Bt(t){var e=Number.POSITIVE_INFINITY;for(var n in t.subComponents){var i=t.subComponents[n];e=Math.min(e,i.initTime)}return e}function _t(t,e){if(!t)return!1;var n=t.states[e];return t.optional||(null==n?void 0:n.time)&&n.promotedFromPreviousState}function jt(t,e){return"visually-ready"===e&&xt(t,"visually-perceived")}function Ut(t,e){return{start:t.start,time:null!=e?e:t.time,error:t.error,monitor:t.monitor,measures:Lt(t.measures),data:Lt(t.data)}}function Ht(t,e,n,i){"then"in t?t.then((function(t){i(t)})).catch((function(t){var r="Error in invokeMonitor [".concat(n,"}]");Ot(r,t),i({start:e,time:e,monitor:"",error:"".concat(r,": ").concat(t)})})):i(t)}var Jt=function(){function t(t){this.gt=null!=t?t:{}}return t.prototype.getBooleanSetting=function(t,e){var n=this.gt[t];if(!n)return e;switch(n.trim().toLowerCase()){case"true":return!0;case"false":return!1;default:return e}},t.prototype.getStringSetting=function(t,e){var n=this.gt[t];return n||e},t}();function qt(t,e,n){if(e){var i=window.navigator;if(i&&i.sendBeacon)try{return void i.sendBeacon(e,t)}catch(t){}!function(t,e,n){var i=new XMLHttpRequest;i.readyState!==XMLHttpRequest.UNSENT&&i.readyState!==XMLHttpRequest.DONE||(i.open("POST",e,n),i.send(t))}(t,e,n)}}var zt,Gt=function(){function t(t){var e=this;this.timeoutInMs=t,this.St="",this.Ct=function(t){e.St||(e.St=t?"timeout":"cancelled",e.Rt&&e.Rt())},this.cancel=function(){e.Ct(!1)},t>0&&window.setTimeout((function(){return e.Ct(!0)}),t)}return Object.defineProperty(t.prototype,"timeout",{get:function(){return this.timeoutInMs},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"reason",{get:function(){return this.St},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"onCancelled",{set:function(t){this.Rt=t},enumerable:!1,configurable:!0}),t}();function Xt(t){return new Gt(null!=t?t:0)}!function(t){t[t.Error=10]="Error",t[t.Warning=15]="Warning",t[t.Info=50]="Info",t[t.Verbose=100]="Verbose",t[t.Spam=200]="Spam"}(zt||(zt={}));var Kt=function(){function t(t){var e=this;this.yt={},this.kt={},this.xt=0,this.Ot=t,function(t){var e="hidden"===document.visibilityState?0:1/0;t(e),document.addEventListener("visibilitychange",(function(n){e=Math.min(e,n.timeStamp),t(e)}),{once:!0})}((function(t){return e.xt=t}))}return Object.defineProperty(t.prototype,"tabHideTime",{get:function(){return this.xt},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"metrics",{get:function(){return this.yt},enumerable:!1,configurable:!0}),t.prototype.startMonitors=function(t,e){var n=this;Dt(zt.Verbose,"startMonitors",{appState:t});var i=function(t,i){if(Dt(zt.Verbose,"onCompleteWithInputCheck",{metric:t}),i){if(!i.error){var r=n.yt["first-input"]?n.yt["first-input"].time:0,o=n.yt["first-interaction"]?n.yt["first-interaction"].time:0;r>0&&r<i.time&&(0===o||r<=o)&&(i.error="first-input"),o>0&&o<i.time&&(i.error="first-interaction")}e(t,i)}};"visually-ready"===t&&(this.monitorMetric("first-input",e),this.monitorMetric("first-interaction",e),this.monitorMetric("first-idle",i),this.monitorMetric("stable-interactivity",i,12e4))},t.prototype.cancelMonitors=function(t){var e=this;if("visually-ready"===t){Dt(zt.Info,"cancelAppStateMonitors",t);var n=function(t){var n;null===(n=e.kt[t])||void 0===n||n.cancel(),e.kt[t]=void 0,e.yt[t]=void 0};n("stable-interactivity"),n("first-idle")}},t.prototype.monitorMetric=function(t,e,n){if(Dt(zt.Verbose,"monitorMetric",t),this.kt[t])Dt(zt.Verbose,"monitorMetric:already-running",t);else{var i=Xt(n);this.kt[t]=i;var r=ht();Ht((0,this.Ot.monitors[t])(r,i),r,t,(function(n){Dt(zt.Verbose,"monitorMetric:complete",t),e(t,n)}))}},t}();function Qt(t,e,n,i,r){r&&e.nonReporting||(t.states[n]={result:Ut(i),monitoring:void 0,final:Vt(t,n)})}var Yt=function(){function t(t){var e,n,i=this;this.Pt={},this.It={},this.At=function(t){if(i.It[t])return!1;var e=kt(i.Pt,t);return Dt(zt.Verbose,"canAppStateMetricBeReported:metric-final:",{metric:t,isFinal:e}),e},this.Et=function(t){if("stable-interactivity"===t||"first-idle"===t){var e=i.Dt.metrics[t],n=kt(i.Pt,"visually-ready");return Dt(zt.Verbose,"canMonitorMetricBeReported:si-error:",{metric:t,error:null==e?void 0:e.error,vrStateFinal:n}),!!e&&"cancelled"!==e.error&&n}return!0},this.Lt=function(t){var e=i.It[t],n=i.Et(t);!e&&n?i.Wt(t):Dt(zt.Info,"reportMonitorMetricIfReady:not-ready",{metric:t,isReported:e,canMetricBeReported:n})},this.Nt=function(t){i.At(t)&&i.Wt(t)},this.Wt=function(t){try{var e=i.Dt.metrics[t],n={metric:t,timeOrigin:i.Ft,time:e.time,error:e.error||(i.Dt.tabHideTime<e.time?"tab-switch":void 0),monitor:e.monitor,measures:Lt(e.measures),data:Lt(e.data),auxMetrics:[],componentsData:Wt(i.Pt),nonReportingComponentData:Nt(i.Pt)},r=n.measures;if(r.tabsSwitch=i.Dt.tabHideTime<e.time?i.Dt.tabHideTime:0,r.start=e.start,r.reportedTime=ht(),"stable-interactivity"===t){var o=i.Dt.metrics["visually-ready"];r["visually-ready"]=o?o.time:0;var a=i.Dt.metrics["functionally-ready"];r["functionally-ready"]=a?a.time:0}if(yt(t)){for(var s in i.Pt){var u=i.Pt[s];if(u){var c=u.states[t].result;if(c){r[s]=c.time,n.error=n.error||c.error;var l={metric:"".concat(t,"-").concat(s),time:c.time,monitor:c.monitor,error:c.error,measures:Lt(c.measures)};l.measures.start=c.start,l.measures.init=Bt(u),n.auxMetrics.push(l)}}}var d=i.Dt.metrics["stable-interactivity"];d&&d.error&&"cancelled"!==d.error&&!n.error&&(n.error="si-error")}i.Ot.appLoadMetricReportCallback&&(i.It[t]=!0,Dt(zt.Info,"reportMetric:reporting",t,!0),i.sendTraceViaRemoteTelemetry("Reporting app report with: ".concat(JSON.stringify(n))),i.Ot.appLoadMetricReportCallback(n))}catch(t){Dt(zt.Error,"reportMetric:error",t),Ot("_reportMetricIfReady:",t)}},this.Tt=function(){var t,e={time:vt(),allMetricsReported:(t=i.It,!!(t["visually-ready"]&&t["functionally-ready"]&&t["stable-interactivity"]&&t["first-input"]&&t["first-interaction"]&&t["first-idle"])),metrics:i.Dt.metrics,components:Wt(i.Pt),timeOrigin:ft()};i.sendTraceViaRemoteTelemetry("Reporting app load state with: ".concat(JSON.stringify(e))),i.Ot.appLoadStateLoggingCallback(e)},this.Mt=function(t,e,n,r,o){if(xt(e,o)){var a=e.states[o];e.states[n]={time:a.time,promotedFromPreviousState:!0}}else e.states[n]={time:r,promotedFromPreviousState:!1};if(Dt(zt.Verbose,"processSubComponentState",{component:t.id,subComponent:e.id,state:n}),function(t,e){var n=t.subComponents;for(var i in n){var r=n[i].states[e];if(!((null==r?void 0:r.time)||n[i].optional||jt(n[i],e)))return!1}return!0}(t,n)){var s=function(t,e){e&&(Dt(zt.Info,"processSubComponentState:complete-monitor-metric",t),i.metrics[t]=Ut(e),i.Lt(t))},u=function(t,e){var n=function(t,e){var n,i,r=0;for(var o in t){var a=null===(i=null===(n=t[o].states[e])||void 0===n?void 0:n.result)||void 0===i?void 0:i.time;if(!a)return;r=Math.max(r,a)}return r}(i.Pt,t);Dt(zt.Verbose,"processSubComponentState:appStateTime",{time:n,state:t}),n&&(!function(t,e,n){e&&(Dt(zt.Info,"processSubComponentState:complete-appstate-metric",t),i.metrics[t]=Ut(e,n),i.Nt(t))}(t,e,n),i.Dt.startMonitors(t,s))};i.Dt.cancelMonitors(n);var c=i.Vt.getBooleanSetting("RumShepherdNonReportingComponentsIsEnabled",!1);if(xt(e,o)&&function(t,e){if(e&&t&&t.states[e]){var n=t.states[e];return(null==n?void 0:n.result)&&(null==n?void 0:n.final)}return!1}(t,o)&&function(t,e){if(!t||!e)return!1;var n=t.subComponents;for(var i in n)if(!_t(n[i],e))return!1;return!0}(t,n)){var l=t.states[o];return Qt(t,e,n,l.result,c),void u(n,l.result)}var d=i.Ot.monitors[n];Dt(zt.Verbose,"processSubComponentState:start-monitor",{state:n}),function(t,e,n,i){var r=t.states[e];if(!(null==r?void 0:r.final)){(null==r?void 0:r.monitoring)&&(null==r||r.monitoring.cancel());var o=ht(),a=Xt(5e3);t.states[e]={monitoring:a,final:Vt(t,e)},Ht(n(o,a,t),o,e,i)}}(t,n,d,(function(i){Dt(zt.Verbose,"processSubComponentState:monitor-complete",{state:n}),Qt(t,e,n,i,c),u(n,i)}))}else Dt(zt.Verbose,"processSubComponentState:component-not-ready",{component:t.id,state:n})},this.Bt=function(t,e){Dt(zt.Verbose,"processSubComponentUnused",{subComponent:e.id}),e.unused=!0;var n=t.subComponents,r=!0;for(var o in n){n[o].unused||(r=!1)}r?(i.Mt(t,e,"visually-ready",ht()),Dt(zt.Verbose,"processSubComponentUnused:vr-final",{component:t.id,VISUALLY_READY:"visually-ready"}),t.states["visually-ready"].final=!0,i.Nt("visually-ready"),i.Mt(t,e,"functionally-ready",ht()),Dt(zt.Verbose,"processSubComponentUnused:fr-final",{component:t.id,FUNCTIONALLY_READY:"functionally-ready"}),t.states["functionally-ready"].final=!0,i.Nt("functionally-ready")):i.ProcessUnusedComponentFinal(t),i.Lt("stable-interactivity"),i.Lt("first-idle")},this._t=function(t,e,n,i,r){n?t.ignoredSubComponents[e]=!0:t.subComponents[e]||(t.subComponents[e]={id:e,initTime:ht(),optional:i,unused:!1,nonReporting:r,states:{}})},Dt(zt.Info,"initialize"),Pt("RumShepherd:initialize"),this.Ft=Number(ft().toFixed()),this.Ot=gt({},t),this.Dt=new Kt(this.Ot),this.Vt=new Jt(this.Ot.appSettings),this.sendTraceViaRemoteTelemetry("Initializing RumShepherd");try{for(var r=St(t.components),o=r.next();!o.done;o=r.next()){var a=o.value;this.Pt[a.id]={id:a.id,rootElementId:a.rootElementId,ignoreNewSubComponents:!1,subComponents:{},states:{},ignoredSubComponents:{}}}}catch(t){e={error:t}}finally{try{o&&!o.done&&(n=r.return)&&n.call(r)}finally{if(e)throw e.error}}window.setTimeout((function(){return i.Tt()}),12e4)}return t.prototype.sendTraceViaRemoteTelemetry=function(t){if(this.Vt.getBooleanSetting("RumShepherdRemoteTelemetryLoggingIsEnabled",!1)){var e=this.Vt.getStringSetting("RemoteTelemetryUrl","");!function(t,e){var n={type:"RUM_TRACE",payloadJson:JSON.stringify(t)};qt(JSON.stringify(n),e,!0)}({time:vt(),sessionId:this.Vt.getStringSetting("SessionId",""),message:t},e)}},t.prototype.ProcessUnusedComponentFinal=function(t){for(var e in t.states){var n=e,i=t.states[n];!i.final&&Vt(t,n)&&(Dt(zt.Verbose,"processSubComponentUnused:unused-final",{component:t.id,state:n}),It("Unused set final:",t.id,n),i.final=!0,this.Nt(n))}},t.prototype.addSubComponents=function(t){if(t&&t.component&&t.subComponents){var e=this.Pt[t.component];if(e){var n=e.ignoreNewSubComponents;if(function(t){for(var e in t.states)if(t.states[e].final)return!1;return!0}(e)||n){Dt(zt.Verbose,"addSubComponents",{ignore:n,data:t}),It("addSubComponents:",n,t);try{for(var i=Array.isArray(t.subComponents)?t.subComponents:[t.subComponents],r=0;r<i.length;r+=1)this._t(e,i[r],n,!1,!1);if(t.optionalSubComponents)for(r=0;r<t.optionalSubComponents.length;r+=1)this._t(e,t.optionalSubComponents[r],n,!0,!1);if(t.nonReportingSubComponents)for(r=0;r<t.nonReportingSubComponents.length;r+=1)this._t(e,t.nonReportingSubComponents[r],n,!0,!0)}catch(t){Ot("addSubComponents",t)}}else Ot("Component cannot be modified",t)}else Ot("Invalid component",t)}else Ot("Invalid data",t)},t.prototype.setSubComponentState=function(t){var e,n=ht();if(t&&t.subComponent&&t.component&&t.state){var i=this.Pt[t.component];if(i){if(!i.ignoredSubComponents[t.subComponent]){i.ignoreNewSubComponents=i.ignoreNewSubComponents||!!t.ignoreNewSubComponents;var r=i.subComponents[t.subComponent];if(r)if(It("setSubComponentState:",t),"unused"!==t.state){var o=t.state;if(yt(o))if(null===(e=i.states[o])||void 0===e?void 0:e.final)Ot("Component state final. Can't set",t);else if(r.unused||r.states[o])Ot("SubComponent unused or set",t);else{var a=t.promoteStateFrom;this.Vt.getBooleanSetting("RumShepherdStagePromotionIsEnabled",!1)&&a?this.Mt(i,r,o,n,a):this.Mt(i,r,o,n)}else Ot("Unknown state reported",t)}else this.Bt(i,r);else Ot("Unexpected sub-component",t)}}else Ot("Invalid component",t)}else Ot("Invalid data",t)},Object.defineProperty(t.prototype,"components",{get:function(){return this.Pt},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"metrics",{get:function(){return this.Dt.metrics},enumerable:!1,configurable:!0}),t}();function Zt(t,e,n,i){if(B("element")){var r="testimg-"+n,o=function(t){var e=document.createElement("img");if(t){if(!("elementTiming"in e))return;e.elementTiming=t}return e.style.position="absolute",e.src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",e.ariaHidden="true",e}(r);if(o){var a=null!=i?i:document.documentElement;return new Promise((function(n){var i=function(e,i){void 0===e&&(e=0),s&&s.disconnect(),n({start:t,time:e,monitor:"image-paint-api",error:i})},s=new PerformanceObserver((function(t){var e,n,s=t.getEntries();try{for(var u=St(s),c=u.next();!c.done;c=u.next()){var l=c.value;if(l.identifier===r){try{o.hidden=!0,a.removeChild(o)}catch(t){Ot("measureImagePaintTime",t)}return void i(l.renderTime)}}}catch(t){e={error:t}}finally{try{c&&!c.done&&(n=u.return)&&n.call(u)}finally{if(e)throw e.error}}}));e.onCancelled=function(){return i(0,e.reason)},s.observe({type:"element",buffered:!0}),a.appendChild(o)}))}}}function $t(t,e){return window.requestAnimationFrame?new Promise((function(n){var i,r=function(r){void 0===r&&(r=0),cancelAnimationFrame(i),n({start:t,time:r,monitor:"rAF",error:e.reason})};e.onCancelled=r,i=requestAnimationFrame((function(){r(ht())}))})):Promise.resolve({start:t,time:0,monitor:"",error:"rAF Unsupported"})}function te(t,e){return new Promise((function(n){var i,r,o=function(o){void 0===o&&(o=0),cancelAnimationFrame(i),clearTimeout(r),n({start:t,time:o,monitor:"rAF-setTimeout",error:e.reason})};e.onCancelled=function(){return o()},i=requestAnimationFrame((function(){r=window.setTimeout((function(){o(ht())}),0)}))}))}function ee(t,e,n){void 0===n&&(n=1e3);var i=e||Xt(12e3);if(!B("longtask"))return function(t,e){var n=ht();if(!window.requestAnimationFrame)return Promise.resolve({start:n,time:0,monitor:"",error:"rAF unsupported"});var i=ht(),r=0,o=i,a=0,s=0,u=i;return new Promise((function(i){var c,l=function(e){void 0===e&&(e=0),cancelAnimationFrame(c);var o={start:n,time:e,monitor:"long-frames",error:t.reason,measures:{longTasksCount:r,longestTaskDuration:s,longTasksDuration:a}};i(o)};t.onCancelled=l;var d=function(t){var n=t-o,i=t-u;if(u=t,i>=50&&(n=0,a+=i,r+=1,o=t,s=Math.max(s,i)),n>=e)return l(o),void ne();c=window.requestAnimationFrame(d)};c=window.requestAnimationFrame(d)}))}(i,n);var r=performance.now(),o=0,a=r,s=0,u=0;return new Promise((function(e){var r,c=function(){clearTimeout(r),l&&l.disconnect();var n=ht()-t,c={start:t,time:a,monitor:"longtask-api",error:i.reason,measures:{longTasksDuration:s,longTasksCount:o,longestTaskDuration:u,monitoredTime:n}};e(c)};i.onCancelled=c;var l=new PerformanceObserver((function(t){t.getEntries().forEach((function(t){o+=1,s+=t.duration;var e=t.startTime+t.duration;a=Math.max(e,a),u=Math.max(u,t.duration)}))}));l.observe({entryTypes:["longtask"]});var d=function(){var t=performance.now()-a;if(t>=n)c(),ne();else{var e=n-t;r=window.setTimeout(d,e)}};r=window.setTimeout(d,n)}))}function ne(){try{self.dispatchEvent(new CustomEvent("StableInteractivityDetected"))}catch(t){Ot("".concat("StableInteractivityDetected"," failed with exception: ").concat(t))}}function ie(t,e){return B("first-input")?new Promise((function(n){var i,r=function(e,r,o){i&&i.disconnect(),n({start:t,time:e,monitor:"first-input-api",error:o,measures:{fid:r}})};try{e.onCancelled=function(){return r(0,0,e.reason)};(i=new PerformanceObserver((function(t){t.getEntries().forEach((function(t){return function(t){var e=t.processingStart,n=e-t.startTime;r(e,n)}(t)}))}))).observe({type:"first-input",buffered:!0})}catch(t){r(0,0,"exception")}})):Promise.resolve({start:t,time:0,monitor:"",error:"FID unsupported"})}function re(t,e){var n=["click","mousedown","keydown","touchstart","pointerdown","wheel","select","contextmenu","scroll"],i={passive:!0,capture:!0},r=vt();return new Promise((function(o){var a=function(n,i,r){u(removeEventListener);var a={start:t,time:n,monitor:"first-interaction",error:e.reason,data:{eventName:i},measures:{delay:r}};o(a)};e.onCancelled=function(){return a(0,"",0)};var s=function(t){if(t.cancelable){var e=vt(),n=t.timeStamp>1e12,i=(n?vt():performance.now())-t.timeStamp;(i<0||i>e-r)&&(i=0),a(n?t.timeStamp-ft():t.timeStamp,t.type,i)}},u=function(t){n.forEach((function(e){t(e,s,i)}))};u(addEventListener)}))}function oe(t,e){return window.requestIdleCallback?new Promise((function(n){var i,r=function(e,r){window.cancelIdleCallback(i),n({start:t,time:e,monitor:"first-idle",error:r})};try{i=window.requestIdleCallback((function(t){return r(ht(),t.didTimeout?"timeout":"")}),{timeout:e.timeout}),e.onCancelled=function(){return r(0,e.reason)}}catch(t){r(0,"exception")}})):Promise.resolve({start:t,time:0,monitor:"",error:"requestIdleCallback unsupported"})}var ae=0,se=function(t){Pt("report ".concat(t.metric,":").concat(t.time,"ms"),t);var e=new CustomEvent("Wac-AppLoadMetricReport",{detail:t});self.dispatchEvent(e)},ue=function(t){Pt("reporting the application load state at epoch time: ".concat(t.time,"; with the status of all metrics reported as ").concat(t.allMetricsReported));var e=new CustomEvent("Wac-AppLoadStateReport",{detail:t});self.dispatchEvent(e)},ce=function(t,e,n){if(n){var i="vr-".concat(n.id,"-").concat(ae);ae+=1;var r=document.documentElement;return function(t,e,n,i){var r=i?Zt(t,e,n,i):void 0;return r||(r=$t(t,e)),r}(t,e,i,null!=r?r:void 0)}return $t(t,e)};function le(t,e){var n=new Yt({appLoadMetricReportCallback:se,appLoadStateLoggingCallback:ue,appSettings:e,monitors:{"visually-ready":ce,"visually-perceived":ce,"functionally-ready":te,"stable-interactivity":ee,"first-input":ie,"first-interaction":re,"first-idle":oe},components:t});window.addEventListener("Wac-SubComponentsInit",(function(t){var e=t.detail;n.addSubComponents(e)})),window.addEventListener("Wac-SubComponentSetLoadState",(function(t){var e=t.detail;n.setSubComponentState(e)}))}var de;function fe(t,e){if(e){"true"===t.WacPerfObserverEntriesIsEnabled&&(wt(),window.addEventListener("WacAppInteractive",(function(){!function(t,e){if(void 0===t&&(t=[5e3]),void 0===e&&(e=12e4),V()&&-1!==PerformanceObserver.supportedEntryTypes.indexOf("longtask")&&-1!==PerformanceObserver.supportedEntryTypes.indexOf("first-input")&&0!==t.length){var n=performance.now(),i=0,r=n,o=0,a=void 0,s=void 0,u=0,c=new PerformanceObserver((function(t){t.getEntries().forEach((function(t){if("longtask"===t.entryType){i+=1,o+=t.duration;var e=t.startTime+t.duration;r=e>r?e:r}else"first-input"===t.entryType&&(a=t.processingStart,s=a-t.startTime)}))}));c.observe({entryTypes:["longtask","first-input"]});var l=function(){var d=performance.now(),f=d-r;if(s)mt("firstInputProcessingStart",a),mt("FID",s),bt(c);else{for(;u<t.length;u+=1){var h=t[u];if(!(f>=h-10))break;mt("TTSI_".concat(h),r),mt("longTaskCount_".concat(h),i),mt("totalLongTasksDuration_".concat(h),o)}var v=d-n;if(u<t.length&&v<e){var p=t[u]-f;setTimeout(l,p)}else bt(c)}};t.sort((function(t,e){return t-e})),setTimeout(l,t[0])}}([500,1e3,2e3,3e3,5e3])})));var i="true"===t.HideHeaderEmbedded;if("true"===t.RumShepherdIsEnabled){var r=[{id:"ribbon",rootElementId:"WACRibbonPanel"},{id:"canvas"}];i||r.push({id:"header",rootElementId:"AppHeaderPanel"}),le(r,function(t){return{RumShepherdRemoteTelemetryLoggingIsEnabled:t.RumShepherdRemoteTelemetryLoggingIsEnabled,RumShepherdStagePromotionIsEnabled:t.RumShepherdStagePromotionIsEnabled,RemoteTelemetryUrl:t.RemoteTelemetryUrl,SessionId:t.SessionId}}(t))}var o="true"===t.IsRegionComposerEnabled;if(o){var a=n(6);a.initializeWindowUtil(o),o=a.shouldUseRegionComposer()}C.ensureCookieCompliance("true"===t.MSCCEnabled,t.MSCCCookies);var s=rt(t,2,!0),u=new tt("true"!==t.BootReadOnlyUx,!0,!0,!1,t,o),c=new at(u,s),l=c.makeGetCellsRequest((function(t){c.onGetCellsRequestCompleted(t),c.onInitialResponseReady()}),!0);s.getCachedSSR&&!c.shouldDisableSSR()&&c.makeRenderPageRequest({});var d="true"===t.WordSkeletalRibbonIsEnabled||"earlydismiss"===t.WordIsSkeletalRibbonOn||"latedismiss"===t.WordIsSkeletalRibbonOn,f="true"===t.WordIsSkeletalDeepLinkOn&&"true"===t.IsDeepLinkScenario;if((d||f)&&J.initialize(f),d&&!tt.isReactMultilineRibbonVisible(t))if("false"!==C.getCookie("WordIsSimplifiedRibbonOn")){var h=tt.isDarkModePreferenceOn(t),v="true"===t.Fluent2StyleIsEnabled;J.addComponent(function(t,e,n,i){var r=["40px","60px","60px","60px","60px","55px","90px","80px","100px","10%","17%","21%","21%","6%","6%"],o=document.createElement("div");o.id="SkeletalRibbon",o.className=o.id,o.style.marginTop=n?"0":"48px";var a=document.createElement("div");a.id="ribbonContent",a.className=a.id,a.style.backgroundColor=e,a.style.height="76px",a.style.transition="opacity 0.1s",a.style.borderBottom="none",a.style.width="100%",a.style.minWidth="640px",a.setAttribute("unselectable","on");var s=document.createElement("div");s.id="topbar",s.className="topbar",s.style.height="38px",s.style.width="100%",s.style.display="flex",s.style.alignItems="center",s.style.justifyContent="space-between";var u=document.createElement("div");u.style.height="16px",u.style.display="flex",u.style.justifyContent="flex-start";for(var c=[],l=0;l<=14;l+=1)c[l]=document.createElement("div"),c[l].style.backgroundColor=t,c[l].style.borderRadius="2px",c[l].style.height="100%",c[l].style.marginLeft="8px",c[l].style.marginRight="8px",c[l].style.outline="transparent",c[l].style.border="1px solid transparent",c[l].style.width=r[l];var d=document.createElement("div");d.style.height="24px",d.style.display="flex";var f=[];for(l=0;l<4;l+=1)f[l]=document.createElement("div"),f[l].style.width="24px",f[l].style.borderRadius="50%",f[l].style.backgroundColor=t,f[l].style.marginLeft="4px",f[l].style.marginRight="4px",f[l].style.outline="transparent",f[l].style.border="1px solid transparent",d.appendChild(f[l]);d.appendChild(c[7]),d.appendChild(c[8]);var h=document.createElement("div");h.id="bottombar",h.className="bottombar",h.style.height="38px",h.style.width="100%",h.style.display="flex",h.style.alignItems="center",i&&Object.keys(i).forEach((function(t){h.style.setProperty(t,i[t])}));var v=document.createElement("div");for(v.style.height="22px",v.style.display="flex",v.style.width="100%",l=0;l<=6;l+=1)u.appendChild(c[l]);for(l=9;l<=14;l+=1)v.appendChild(c[l]);var p=[window.matchMedia("(max-width: 700px)"),window.matchMedia("(max-width: 810px)"),window.matchMedia("(max-width: 1116px)")];for(m(),l=0;l<p.length;l+=1)p[l].addListener(m);function m(){p[0].matches?(c[7].style.width="32px",c[8].style.width="32px",c[6].style.display="none",c[5].style.display="none"):p[1].matches?(c[7].style.width="32px",c[8].style.width="32px",c[6].style.display="none"):p[2].matches&&(c[7].style.width="32px",c[8].style.width="32px")}var b=document.createElement("div");return b.id="highContrastCover",b.className=b.id,b.style.height="4px",b.style.backgroundColor="rgba(0, 0, 0, 0)",s.appendChild(u),s.appendChild(d),h.appendChild(v),a.appendChild(s),a.appendChild(h),o.appendChild(a),o.appendChild(b),{isReady:!1,element:o,onRemoval:function(){for(var t=0;t<p.length;t+=1)p[t].removeListener(m)}}}(J.getSkeletalComponentColor(h,v),J.getSkeletalBackgroundColor(h,v),i,v?{"background-color":h?"#292929":"#FFFFFF","border-radius":"8px",margin:"0 8px",width:"calc(100% - 16px)"}:void 0))}return(d||f)&&J.launchExperience(),l}}function he(t){var e=document.getElementById("WACFastView"),n=e.querySelector(".WACViewPanel"),i=e.querySelector(".OutlineContainer"),r=e.querySelector(".Outline"),o=e.querySelector(".PageContentOrigin");i&&(i.style.minHeight="0",i.style.left="-140px"),n&&(n.style.overflow="hidden"),o&&(o.style.top="-1px",o.style.width="calc(100% - "+function(){var t=document.createElement("div");t.style.visibility="hidden",t.style.overflow="scroll",t.style.msOverflowStyle="scrollbar",document.body.appendChild(t);var e=document.createElement("div");t.appendChild(e);var n=t.offsetWidth-e.offsetWidth;return t.parentNode.removeChild(t),n}()+"px)");var a=document.createElement("div");return a.id="SkeletalPage",a.className=a.id,a.style.position="absolute",a.style.width="100%",a.style.height="100%",a.style.left="0",a.style.right="0",a.style.top="0",a.style.zIndex="1",a.style.backgroundColor="window",a.appendChild(function(t){var e=document.createElement("div");e.id="SkeletalCanvas",e.className=e.id,e.style.width="100%",e.style.height="100%",e.style.overflow="hidden",e.style.position="relative";var n=document.getElementById("WACFastView").querySelector(".OutlineContent"),i=document.createElement("div");i.style.width="100%",i.style.height="100%",i.style.boxSizing="border-box",n&&(i.style.paddingLeft=n.style.paddingLeft,i.style.paddingRight=n.style.paddingRight,i.style.paddingTop=n.style.paddingTop);for(var r=[],o=0;o<2;o+=1)r[o]=document.createElement("div"),r[o].style.backgroundColor=t,r[o].style.height="18px",r[o].style.marginBottom="16px";r[0].style.width="150px",r[1].style.width="220px";var a=[];for(o=0;o<21;o+=1)a[o]=document.createElement("div"),a[o].style.backgroundColor=t,a[o].style.height="14px",a[o].style.marginBottom="6px";a[0].style.width="92%",a[1].style.width="100%",a[2].style.width="93%",a[3].style.width="80%",a[3].style.marginBottom="16px",a[4].style.width="92%",a[5].style.width="100%",a[6].style.width="55%",a[6].style.marginBottom="16px",a[7].style.width="95%",a[8].style.width="38%",a[8].style.marginBottom="26px",a[9].style.width="90%",a[10].style.width="100%",a[11].style.width="98%",a[12].style.width="100%",a[13].style.width="33%",a[13].style.marginBottom="16px",a[14].style.width="91%",a[15].style.width="90%",a[16].style.width="100%",a[17].style.width="85%",a[17].style.marginBottom="40px",a[18].style.width="92%",a[19].style.width="100%",a[20].style.width="93%",i.appendChild(r[0]);for(o=0;o<=17;o+=1)i.appendChild(a[o]);i.appendChild(r[1]);for(o=18;o<=19;o+=1)i.appendChild(a[o]);return e.appendChild(i),e}(t)),a.appendChild(function(t){var e=document.createElement("div");e.id="SkeletalFloaties",e.className=e.id,e.style.position="absolute",e.style.top="20px",e.style.right="-300px",e.style.width="270px";for(var n=[],i=0;i<3;i+=1){n[i]=document.createElement("div"),n[i].id="SkeletalFloatie",n[i].className=n[i].id,n[i].style.boxSizing="border-box",n[i].style.position="relative",n[i].style.width="100%",n[i].style.backgroundColor="window",n[i].style.padding="15px",n[i].style.paddingBottom="22px",n[i].style.marginBottom="14px";var r=document.createElement("div");r.id="SkeletalTitle",r.className=r.id,r.style.backgroundColor=t,r.style.width="42%",r.style.height="18px",r.style.borderRadius="2px",r.style.marginBottom="11px";for(var o=[],a=0;a<3;a+=1)o[a]=document.createElement("div"),o[a].id="SkeletalParagraph",o[a].className=o[a].id,o[a].style.marginTop="6px",o[a].style.backgroundColor=t,o[a].style.height="14px",o[a].style.borderRadius="2px",o[a].style.width="100%";o[0].style.width="100%",o[1].style.width="85%",o[2].style.width="70%",n[i].appendChild(r);for(var s=0;s<3;s+=1)n[i].appendChild(o[s]);e.appendChild(n[i])}return e}(t)),r&&(r.style.overflow="visible",r.appendChild(a)),{isReady:!1,element:a}}var ve=function(){function t(t,e,n){this.success=t,this.errorCode=e,this.extraErrorInfo=n}return t.createSuccess=function(){return new t(!0)},t.createFailure=function(e,n){return new t(!1,e,n)},t}(),pe=function(){function t(t){this.wacInitializeReadyRetryCount=0,this.wacInitializeReadyAckReceived=!1,this.wopiStartSessionCompleteReceived=!1,this.wopiPendingSessionCompleteReceived=!1,this.wopiStartSessionSentFromWacFrame=!1,this.instantBootPltDiagnostics={},this.instantAppSettings=t,this.logs=[],this.postMessageOrigin=this.instantAppSettings.PostMessageOrigin,this.acceptStartSessionComplete="true"===this.instantAppSettings.AcceptStartSessionComplete}return t.getWindow=function(){return window},t.prototype.launchFastView=function(e,i,r,o){void 0===r&&(r=!1),void 0===o&&(o=1),t.getWindow().g_liveBooksAppConstructed&&this.log("App constructed before launching FastView"),h.fastView&&h.fastView.isOpen()&&this.log("FastView was already opened");var a="true"===this.instantAppSettings.IsRegionComposerEnabled;a&&(a=n(6).shouldUseRegionComposer());var s=new tt(!0,!0,!0,!1,this.instantAppSettings,a).launchFastView(e,"WordEditorInstantApp",i,!1,r,o),u="true"===this.instantAppSettings.WordIsSkeletalDeepLinkOn&&"true"===this.instantAppSettings.IsDeepLinkScenario,c=tt.isDarkModePreferenceOn(this.instantAppSettings),l="true"===this.instantAppSettings.Fluent2StyleIsEnabled;if(u&&s)return J.addComponentOutsideSkeletalContainer(he(J.getSkeletalComponentColor(c,l))),void J.addShimmerToElement("SkeletalCanvas");"true"===this.instantAppSettings.SkeletalParagraphIsEnabled&&s&&this.addSkeletalParagraph(c,l)},t.prototype.trackOfficeServerDiagnostics=function(t){this.officeFrameDocumentFlushTime=Date.now(),this.serverDiagnostics=t},t.prototype.sendAppFailedMessage=function(e){this.sendPostMessageToParentWindow(t.toJsApiAppFailed,{Error:{errorType:e}},"*")},t.prototype.signalReady=function(){var t=this;window.addEventListener("message",(function(e){t.receivePostMessage(e)}),!1),this.sendReadyMessage();var e=Number(this.instantAppSettings.WopiPendingSessionMessageTimeoutInMs);e||(e=1e4),window.setTimeout((function(){return t.timeoutWopiPendingSessionMessage()}),e)},t.prototype.startWacBoot=function(t){var e=t||this.instantAppSettings;this.getCellsConnection=fe(e,!0)},t.prototype.abortGetCellsConnection=function(){this.getCellsConnection&&this.getCellsConnection.abort()},t.prototype.getCellsFromFrameRequest=function(t){at.getCellsFromFrameRequest(t),this.abortGetCellsConnection()},t.prototype.addSkeletalParagraph=function(t,e){try{var n=document.getElementById("WACFastView"),i=n.querySelectorAll(".Paragraph").length;if(20!==i&&60!==i)return!1;var r=n.querySelector(".Outline");if(r){var o=function(t,e){var n=document.createElement("div");n.id="SkeletalParagraph",n.style.width="100%",n.style.overflow="hidden",n.style.position="relative";var i=document.createElement("div");i.style.width="100%",i.style.boxSizing="border-box";var r=t.querySelectorAll(".OutlineElement");-1!==r[r.length-1].className.toLowerCase().indexOf("rtl")&&(i.style.direction="rtl");var o=t.querySelector(".OutlineContent");o&&(i.style.paddingLeft=o.style.paddingLeft,i.style.paddingRight=o.style.paddingRight);for(var a=["92%","100%","93%","80%"],s=0;s<a.length;s+=1){var u=document.createElement("div");u.style.backgroundColor=e,u.style.width=a[s],u.style.height="14px",u.style.marginBottom="6px",i.appendChild(u)}return n.appendChild(i),n}(n,J.getSkeletalComponentColor(t,e));r.appendChild(o),J.addShimmerToElement(o.id)}}catch(t){return this.log("failed to add skeletal paragraph: "+t.message+"\r\n"+t.stack),!1}return!0},t.prototype.sendPostMessageToParentWindow=function(t,e,n){var i={MessageId:t,SendTime:Date.now(),Values:e},r=this.postMessageOrigin;n&&(r=n),window.parent.postMessage(JSON.stringify(i),r),this.log("Sent ".concat(t))},t.prototype.receivePostMessage=function(e){if(e.origin===this.postMessageOrigin){var n;try{n=JSON.parse(e.data)}catch(t){return}switch(n.MessageId){case t.fromJsApiInitReadyAck:this.log("WacInitialize_Ready_Ack received"),this.wacInitializeReadyAckReceived=!0;break;case t.fromJsApiPendingSessionFail:if(this.log("WopiPendingSession_Fail received"),this.wopiPendingSessionCompleteReceived)return void this.log("WopiPendingSession_Fail received after a Complete/Fail was already received previously.");this.wopiPendingSessionCompleteReceived=!0,this.wopiStartSessionCompleteReceived=!0,this.initializeAppOnFailure("WopiPendingSession_Fail");break;case t.fromJsApiPendingSessionComplete:this.log("WopiPendingSession_Complete received"),this.sendPostMessageToParentWindow(t.toJsApiSessionCompleteAck,{}),this.wopiPendingSessionCompleteReceived&&this.log("WopiPendingSession_Complete received after a Complete/Fail was already received previously."),this.wopiPendingSessionCompleteReceived=!0;var i=n.Values.WopiDetails;this.instantBootPltDiagnostics=n.Values.Diagnostics||{},this.makeStartSessionRequest(i),this.beginStartSessionTimeout(!0);break;case t.fromJsApiStartSessionComplete:if(this.log("WopiStartSession_Complete received"),this.sendPostMessageToParentWindow(t.toJsApiSessionCompleteAck,{}),this.wopiStartSessionCompleteReceived)return void this.log("WopiStartSession_Complete received after a Complete/Fail was already received previously.");if(!this.acceptStartSessionComplete)return void this.log("WopiStartSession_Complete rejected");if(!n.Values.StartSessionResponse)return void this.log("WopiStartSession_Complete invalid content");this.wopiStartSessionCompleteReceived=!0,this.wopiPendingSessionCompleteReceived||(this.wopiPendingSessionCompleteReceived=!0);var r=n.Values.StartSessionResponse;this.instantBootPltDiagnostics=n.Values.Diagnostics||{},this.processStartSessionResponse(!1,r.RequestStatus,r.ResponseText);break;case t.fromJsApiPendingAppCompleteReceived:this.log("WopiPendingApplicationComplete_Received received on wac frame"),this.wopiPendingSessionCompleteReceived||(this.wopiPendingSessionCompleteReceived=!0),this.beginStartSessionTimeout(!1)}}},t.prototype.beginStartSessionTimeout=function(t){var e=this,n=Number(this.instantAppSettings.WopiStartSessionTimeoutInMs);n||(n=1e4),t?(this.wopiStartSessionSentFromWacFrame=!0,window.setTimeout((function(){return e.timeoutWopiStartSessionFromWacFrameMessage()}),n)):window.setTimeout((function(){return e.timeoutWopiStartSessionFromJsApiMessage()}),n)},t.prototype.sendReadyMessage=function(){var e=this;this.sendPostMessageToParentWindow(t.toJsApiInitReady,{CanAcceptStartSessionComplete:this.acceptStartSessionComplete,Diagnostics:{officeSessionId:this.instantAppSettings.SessionId}}),window.setTimeout((function(){return e.timeoutWacInitializeReadyAckMessage()}),t.wacInitializeReadyAckTimeoutInMs)},t.prototype.timeoutWacInitializeReadyAckMessage=function(){this.wacInitializeReadyAckReceived||this.wopiPendingSessionCompleteReceived||(this.wacInitializeReadyRetryCount+=1,this.wacInitializeReadyRetryCount<t.wacInitializeReadyMaxRetries?(this.sendReadyMessage(),this.log("WacInitializeReadyAckTimeout. [RetriesRemain:".concat(t.wacInitializeReadyMaxRetries-this.wacInitializeReadyRetryCount,"]"))):this.log("WacInitializeReadyAckTimeout. No retries remain"))},t.prototype.timeoutWopiPendingSessionMessage=function(){this.wopiPendingSessionCompleteReceived||this.initializeAppOnFailure("WopiPendingSession_Timeout")},t.prototype.timeoutWopiStartSessionFromJsApiMessage=function(){this.wopiStartSessionCompleteReceived||this.wopiStartSessionSentFromWacFrame||this.initializeAppOnFailure("StartSession_Fail")},t.prototype.timeoutWopiStartSessionFromWacFrameMessage=function(){this.wopiStartSessionCompleteReceived||this.initializeAppOnFailure("StartSession_Fail")},t.prototype.makeStartSessionRequest=function(t){var e=this,n=rt(this.instantAppSettings,0,!0,t),i=new at(null,n),r="WOPIsrc=".concat(encodeURIComponent(t.WopiSrc));window.location.search&&(r+="&".concat(window.location.search.substr(1))),"true"===this.instantAppSettings.FileGetUrlPresent&&(r+="&fileGetUrlPresent=1"),this.instantBootPltDiagnostics.startSessionStartTime=Date.now(),i.makeStartSessionRequest("WordEditorStartSession.ashx?".concat(r),(function(t){return e.processStartSessionResponse(!0,t.status,t.responseText)}))},t.prototype.getAppSettingsFromResponse=function(t){try{return{success:!0,appSettings:JSON.parse(t)}}catch(t){return{success:!1,errorInfo:t.message+"\r\n"+t.stack}}},t.prototype.processStartSessionResponse=function(e,n,i){var r=this,o=Date.now();if(this.wopiStartSessionCompleteReceived=!0,200===n){var a,s=this.getAppSettingsFromResponse(i);if(s.success)(a=s.appSettings)&&a.UrlToRedirect&&window.top&&window.top.location.replace(a.UrlToRedirect),this.instantBootPltDiagnostics.isStartSessionFromWac=e,e&&(this.instantBootPltDiagnostics.startSessionCompleteTime=o),this.instantBootPltDiagnostics.appSettingsFetchedTime=Date.now(),de=s.appSettings,t.instantAppSettingsToPreserve.forEach((function(t){de&&t in r.instantAppSettings&&(de[t]=r.instantAppSettings[t])})),t.getWindow().g_appSettings=de,t.getWindow().g_appSettingsDownloaded=!0,this.initializeApp(ve.createSuccess());else this.initializeAppOnFailure("StartSession_AppSettingsParseError",s.errorInfo)}else this.initializeAppOnFailure("StartSession_Fail","Status ".concat(n))},t.prototype.initializeAppOnFailure=function(e,n){de=this.instantAppSettings,t.getWindow().g_appSettings=de,t.getWindow().g_appSettingsDownloaded=!0,this.initializeApp(ve.createFailure(e,n))},t.prototype.initializeApp=function(e){e.success&&de?this.startWacBoot(de):(this.sendBeacon("WordEditorInstantAppBootError",{errorCode:e.errorCode,extraErrorInfo:e.extraErrorInfo}),de&&e.errorCode&&(de.InstantBoot_FailureCode=e.errorCode),e.errorCode&&e.extraErrorInfo&&de&&(de[e.errorCode]=e.extraErrorInfo)),this.sendBeacon("WordEditorInstantAppLogs",this.logs),t.getWindow().g_livebooksJsDownloaded&&(t.getWindow().Sys.Application.get_isInitialized()?t.getWindow().g_liveBooksAppConstructed||pageInit():(t.getWindow().Sys.Application.add_init(pageInit),t.getWindow().Sys.Application.initialize()))},t.prototype.log=function(t){this.logs.push({time:Date.now(),message:t})},t.prototype.sendBeacon=function(e,n){t.getWindow()._bB&&t.getWindow()._bB.sendBeacon(e,n)},t.fromJsApiInitReadyAck="WacInitialize_Ready_Ack",t.fromJsApiPendingSessionComplete="WopiPendingSession_Complete",t.fromJsApiPendingSessionFail="WopiPendingSession_Fail",t.fromJsApiPendingAppCompleteReceived="WopiPendingApplicationComplete_Received",t.fromJsApiStartSessionComplete="WopiStartSession_Complete",t.toJsApiInitReady="WacInitialize_Ready",t.toJsApiAppFailed="Wac_AppFailed",t.toJsApiSessionCompleteAck="WopiSession_Complete_Ack",t.wacInitializeReadyMaxRetries=3,t.wacInitializeReadyAckTimeoutInMs=1e3,t.instantAppSettingsToPreserve=["MSCCCookies","MSCCEnabled","MSCCMarkup","RibbonImageBase","SharedStaticContentHost","Slice1Name","StaticContentHost","WacRootDomain","WacBootNewJSIsEnabled","jQueryName","signalRName","CollabSliceName"],t}(),me=function(t){if(!s){s=new r({container:t,layoutCollection:{Landscape:{Default:[{id:"KeyboardRegion"}]},Portrait:{Default:[{id:"KeyboardRegion"}],Small:[{id:"KeyboardRegion"}]},DP:{Default:[{id:"FarPane"},{id:"KeyboardRegion"}]},DL:{Default:[{id:"KeyboardRegion"}]}}})}};n.d(e,"show",(function(){return me})),n.d(e,"dispose",(function(){return c})),n.d(e,"getRegion",(function(){return u})),n.d(e,"WindowUtil",(function(){return i})),n.d(e,"CtrlWheelMetrics",(function(){return l})),n.d(e,"FastViewLogEntry",(function(){return U})),n.d(e,"FastView",(function(){return H})),n.d(e,"FastViewUtils",(function(){return C})),n.d(e,"isTouchSupport",(function(){return R})),n.d(e,"cssClassAbsolute",(function(){return"WACFastViewAbsolute"})),n.d(e,"cssClass",(function(){return"WACFastView"})),n.d(e,"cssPositionRewriteClass",(function(){return"WACFastViewPositionRewrite"})),n.d(e,"getFastViewCssClasses",(function(){return k})),n.d(e,"removeSplashScreen",(function(){return x})),n.d(e,"setFastViewScrollTop",(function(){return O})),n.d(e,"makeStyleChangesToHideHeader",(function(){return P})),n.d(e,"sendWacBeacon",(function(){return T})),n.d(e,"ShiftUtils",(function(){return F})),n.d(e,"SkeletalBoot",(function(){return N})),n.d(e,"bootSettings",(function(){return f})),n.d(e,"FastViewSettings",(function(){return h})),n.d(e,"WacSkeletalBoot",(function(){return J})),n.d(e,"WindowVisibilityMetrics",(function(){return q})),n.d(e,"CanvasCacheLoader",(function(){return X})),n.d(e,"CanvasCacheRemover",(function(){return K})),n.d(e,"DocumentCacheItem",(function(){return Q})),n.d(e,"DocumentCacheManager",(function(){return Y})),n.d(e,"DocumentCacheSaverResult",(function(){return z})),n.d(e,"LocalStorageDocumentCache",(function(){return Z})),n.d(e,"LocalStorageDocumentCacheTest",(function(){return $})),n.d(e,"WordEditorInstantAppResult",(function(){return ve})),n.d(e,"WordEditorInstantApp",(function(){return pe})),n.d(e,"startWacBoot",(function(){return fe}))},6:function(t,e,n){"use strict";n.r(e);var i=function(){function t(t){this.regionComposerRootClassName="regionComposerRoot",this.regionElements={},this.positioningElements={Top:void 0,Left:void 0,Right:void 0,Bottom:void 0},this.positionCounts={Top:0,Left:0,Right:0,Bottom:0};var e=t.container,n=t.styleSheet;(this.containerElement=e,this.styleSheet=n,void 0===this.styleSheet.ownerRule&&0===this.styleSheet.cssRules.length&&this.styleSheet.parentStyleSheet&&!this.styleSheet.parentStyleSheet.parentStyleSheet&&1===this.styleSheet.parentStyleSheet.cssRules.length)?((this.styleSheet.parentStyleSheet||this.styleSheet).insertRule(".".concat(this.regionComposerRootClassName,"{display: grid; position: absolute; width: 100%; height: 100%; z-index: 1;}"),0),this.containerElement&&(this.dockPanel=document.createElement("div"),this.dockPanel.classList.add(this.regionComposerRootClassName),this.addPositioningElements(this.dockPanel),this.containerElement.appendChild(this.dockPanel))):this.containerElement&&(this.dockPanel=this.containerElement,this.getPositioningElements(this.dockPanel));this.styleSheet.insertRule(".".concat(this.regionComposerRootClassName,"{}"),0),this.regionComposerRootStyle=this.styleSheet.cssRules[0]}return t.prototype.dispose=function(){this.positionCounts={Top:0,Left:0,Right:0,Bottom:0},this.regionElements={},this.containerElement&&this.dockPanel&&this.containerElement.removeChild(this.dockPanel),this.dockPanel=void 0,this.containerElement=void 0},t.prototype.addRegion=function(t){if(this.dockPanel){var e,n=this.styleSheet.insertRule(".".concat(t.id,"{display:block;}"),this.styleSheet.cssRules.length),i=this.regionElements[t.id];this.containerElement&&((i=i||this.containerElement.querySelector(".".concat(t.id)))?e=i:(e=document.createElement("div")).classList.add(t.id));var r=this.getGridArea(t.position,!1);return this.updateTemplate(t.position),void 0!==this.lastChildIndex&&this.lastChildOriginalGridArea&&(this.styleSheet.cssRules[this.lastChildIndex].style.gridArea=this.lastChildOriginalGridArea),this.lastChildOriginalGridArea=r,r=this.getGridArea(t.position,!0),this.styleSheet.cssRules[n].style.gridArea=r,e&&!i&&(this.appendRegion(t.position,e),this.regionElements[t.id]=e),this.lastChildIndex=n,this.positionCounts[t.position]=this.positionCounts[t.position]+1,e}},t.prototype.updateTemplate=function(t){if(this.dockPanel)switch(t){case"Top":var e="repeat(".concat(this.positionCounts.Top+1,", min-content) 1fr repeat(").concat(Math.max(1,this.positionCounts.Bottom),", min-content)");return void(this.regionComposerRootStyle?this.regionComposerRootStyle.style.gridTemplateRows=e:this.styleSheet.insertRule(".".concat(this.regionComposerRootClassName,"{grid-template-rows: ").concat(e),this.styleSheet.cssRules.length));case"Left":e="repeat(".concat(this.positionCounts.Left+1,", min-content) 1fr repeat(").concat(Math.max(1,this.positionCounts.Right),", min-content)");return void(this.regionComposerRootStyle?this.regionComposerRootStyle.style.gridTemplateColumns=e:this.styleSheet.insertRule(".".concat(this.regionComposerRootClassName,"{grid-template-columns: ").concat(e),this.styleSheet.cssRules.length));case"Right":e="repeat(".concat(Math.max(1,this.positionCounts.Left),", min-content) 1fr repeat(").concat(this.positionCounts.Right+1,", min-content)");return void(this.regionComposerRootStyle?this.regionComposerRootStyle.style.gridTemplateColumns=e:this.styleSheet.insertRule(".".concat(this.regionComposerRootClassName,"{grid-template-columns: ").concat(e),this.styleSheet.cssRules.length));case"Bottom":e="repeat(".concat(Math.max(1,this.positionCounts.Top),", min-content) 1fr repeat(").concat(this.positionCounts.Bottom+1,", min-content)");return void(this.regionComposerRootStyle?this.regionComposerRootStyle.style.gridTemplateRows=e:this.styleSheet.insertRule(".".concat(this.regionComposerRootClassName,"{grid-template-rows: ").concat(e),this.styleSheet.cssRules.length))}},t.prototype.addPositioningElements=function(t){var e=this;Object.keys(this.positioningElements).forEach((function(n){var i=document.createElement("div");i.style.setProperty("display","none"),i.id=n,e.positioningElements[n]=i,t.appendChild(i)}))},t.prototype.getPositioningElements=function(t){var e=this;Object.keys(this.positioningElements).forEach((function(n){var i=t.querySelector("#".concat(n));i&&(e.positioningElements[n]=i)}))},t.prototype.appendRegion=function(t,e){var n=this.positioningElements[t];if(n){var i=n.parentNode;i&&!i.contains(e)&&(i.insertBefore(e,n.nextSibling),"Top"!==t&&"Left"!==t||(this.positioningElements[t]=e))}},t.prototype.getGridArea=function(t,e){if(!this.dockPanel)return"";switch(t){case"Top":return" ".concat(this.positionCounts.Top+1," / ").concat(this.positionCounts.Left+1," / ").concat(e?-1*(this.positionCounts.Bottom+1):this.positionCounts.Top+2," / ").concat(-1*(this.positionCounts.Right+1));case"Left":return" ".concat(this.positionCounts.Top+1," / ").concat(this.positionCounts.Left+1," / ").concat(-1*(this.positionCounts.Bottom+1)," / ").concat(e?-1*(this.positionCounts.Right+1):this.positionCounts.Left+2);case"Right":return"".concat(this.positionCounts.Top+1," / ").concat(-1*(this.positionCounts.Right+1)," / ").concat(-1*(this.positionCounts.Bottom+1)," / ").concat(e?this.positionCounts.Left+1:-1*(this.positionCounts.Right+2));case"Bottom":return" ".concat(-1*(this.positionCounts.Bottom+1)," / ").concat(this.positionCounts.Left+1," / ").concat(e?this.positionCounts.Top+1:-1*(this.positionCounts.Bottom+2)," / ").concat(-1*(this.positionCounts.Right+1))}},Object.defineProperty(t.prototype,"dockPanelRootElement",{get:function(){return this.dockPanel},enumerable:!1,configurable:!0}),t}(),r=n(0),o=function(){function t(t){var e=this;this.layoutRegions={Portrait:{Default:void 0,Small:void 0,Large:void 0},Landscape:{Default:void 0,Small:void 0,Large:void 0},DP:{Default:void 0,Small:void 0,Large:void 0},DL:{Default:void 0,Small:void 0,Large:void 0}},this.accountForKeyboardRegions={Portrait:{Default:void 0,Small:void 0,Large:void 0},Landscape:{Default:void 0,Small:void 0,Large:void 0},DP:{Default:void 0,Small:void 0,Large:void 0},DL:{Default:void 0,Small:void 0,Large:void 0}},this.regionContainers={},this.unsupportedRules=[],this.setOffsetForActiveAccountForKeyboardRegions=function(t){var n=t?void 0:e.getWindowRectForKeyboardSegment(),i="Undefined"===e.windowMode?"Landscape":e.windowMode,r=e.getAffectedAccountForKeyboardRegions(n,i,e.layoutBreakpoint);if(r){var o=n?n.top+n.height:0;r.forEach((function(n){if(t)n.style.marginBottom="0px";else{var i=n.getBoundingClientRect(),r=Math.max(0,e.keyboardSegment.height-(o-i.bottom));n.style.marginBottom="".concat(r,"px")}}))}},this.boundingWindowRectsChanged=function(t,n){var i=t.find((function(t){return!!t.isOccluded})),r=e.windowMode!==n||e.keyboardSegment!==i;e.setOffsetForActiveAccountForKeyboardRegions(!0),e.windowMode=n,e.keyboardSegment=i,e.render(r)},this.layoutBreakpointChanged=function(t){e.layoutBreakpoint=t,e.render(!0)},this.getWindowRectForKeyboardSegment=function(){if(e.keyboardSegment)return Object(r.getBoundingRect)(e.keyboardSegment)},this.props=t,this.windowMode=Object(r.getWindowMode)(),this.layoutBreakpoint=Object(r.getLayoutBreakpoint)(),this.keyboardSegment=Object(r.getKeyboardSegment)(),this.styleSheet=this.createStyleSheet(),this.createRegions(),Object(r.arrayFindPolyfill)(),Object(r.objectAssignPolyfill)(),Object(r.registerBoundingWindowRectsChanged)("regionComposer",this.boundingWindowRectsChanged),Object(r.registerLayoutBreakpointChanged)("regionComposer",this.layoutBreakpointChanged),this.render()}return t.prototype.render=function(t){var e=this;t&&(this.keyboardSegment?(void 0!==this.setOffsetRafId&&cancelAnimationFrame(this.setOffsetRafId),this.setOffsetRafId=requestAnimationFrame((function(){e.setOffsetForActiveAccountForKeyboardRegions(),f()}))):(void 0!==this.setOffsetRafId&&(cancelAnimationFrame(this.setOffsetRafId),this.setOffsetRafId=void 0),f()))},t.prototype.dispose=function(){var t=this;Object.keys(this.layoutRegions).forEach((function(e){Object.keys(t.layoutRegions[e]).forEach((function(n){var i=t.layoutRegions[e][n];i&&i.dispose()}))})),Object.keys(this.regionContainers).forEach((function(e){var n=t.regionContainers[e];n&&document.removeChild(n),t.regionContainers[e]=void 0})),Object(r.unregisterBoundingWindowRectsChanged)("regionComposer"),Object(r.unregisterLayoutBreakpointChanged)("regionComposer"),this.regionContainers={}},t.prototype.getRegion=function(t){return this.regionContainers[t]},t.prototype.createRegions=function(){var t=this,e=this.props.layoutCollection;Object.keys(e).forEach((function(n){var i=e[n];i&&t.createRegion(i,n)}));var n="";if(Object.keys(this.regionContainers).forEach((function(t){n+=".".concat(t,", ")})),n.length&&(n=n.substr(0,n.length-2),n+="{display: none; position: relative;}",this.styleSheet.insertRule(n,0)),this.styleElement){var i=this.styleSheet.cssRules;this.unsupportedRules=this.unsupportedRules.reverse();for(var r=0;r<i.length;r+=1){i[r].cssRules&&i[r].insertRule(n,0);var o="".concat(this.styleElement.innerHTML).concat(i[r].cssText);if(o.indexOf("@media not all")>=0&&this.unsupportedRules.length>0){o=o.replace("@media not all",this.unsupportedRules.pop());o.replace(new RegExp("and (spanning: single-fold-.*)","g"),"{.multipleWindowRects"),"}"}this.styleElement.innerHTML=o,this.styleElement.innerHTML="".concat(this.styleElement.innerHTML).concat("")}this.styleSheet=this.styleElement.sheet}},t.prototype.createRegionContainer=function(t){if(this.regionContainers[t.id])return this.regionContainers[t.id];var e=document.createElement("div");return e.setAttribute("style","width: ".concat("Header"===t.id?"100vw":"100%","; height: 100%; display: flex; flex: auto;")),this.regionContainers[t.id]=e,e},t.prototype.createRegion=function(t,e){var n=this;Object.keys(t).forEach((function(r){var o=t[r];n.addSelectorForLayoutDefinition(n.styleSheet,e,r);var a=n.rootDockPanel||(n.props.dockPanelProps?n.props.dockPanelProps.container:void 0),s=new i(Object.assign(n.props.dockPanelProps,{container:a,styleSheet:n.getLastChild(n.styleSheet)}));o.forEach((function(t){var i=n.createRegionContainer(t),o=s.addRegion(t);o&&i&&!o.contains(i)&&o.appendChild(i),t.accountForKeyboard&&o&&(n.accountForKeyboardRegions[e][r]||(n.accountForKeyboardRegions[e][r]=[]),n.accountForKeyboardRegions[e][r].push(o))})),!n.rootDockPanel&&s.dockPanelRootElement&&(n.rootDockPanel=s.dockPanelRootElement),n.layoutRegions[e][r]=s}))},t.prototype.getLastChild=function(t){for(var e=t.cssRules[t.cssRules.length-1];e.cssRules&&e.cssRules.length>0;)e=e.cssRules[e.cssRules.length-1];return e.cssRules?e:e.parentStyleSheet},t.prototype.getAffectedAccountForKeyboardRegions=function(t,e,n){if(void 0===e&&(e="Landscape"),void 0===n&&(n="Default"),this.accountForKeyboardRegions){var i=this.accountForKeyboardRegions[e][n]||this.accountForKeyboardRegions[e].Default||void 0;return t&&i?i.filter((function(e){return Object(r.isRectWithin)(e.getBoundingClientRect(),t)})):i}},t.prototype.createStyleSheet=function(){return this.styleElement=document.createElement("style"),document.head.appendChild(this.styleElement),this.styleElement.sheet},t.prototype.addSelectorForLayoutDefinition=function(t,e,n){var i,o,a="Small"===n?"max-width":"Large"===n?"min-width":void 0;if("Portrait"===e||"Landscape"===e)i="@media only screen and (orientation: ".concat(e.toLowerCase(),") ").concat(a&&"Default"!==n?"and (".concat(a,": ").concat(r.LayoutBreakpointSizes[n][e],"px ){"):"{","}");else{var s=void 0,u=void 0;"DP"===e?(s="landscape",u="single-fold-vertical"):(s="portrait",u="single-fold-horizontal"),o="@media only screen and (orientation: ".concat(s,") and (spanning: ").concat(u,")"),this.unsupportedRules.push(o),i="".concat(o," ").concat(a&&"Default"!==n?"and (".concat(a,": ").concat(r.LayoutBreakpointSizes[n][e],"px ){"):"{","}")}t.insertRule(i,t.cssRules.length)},t}(),a=!1;function s(){return a}function u(t){var e;a=t&&!("undefined"!=typeof navigator&&(e=navigator.userAgent,/rv:11.0/i.test(e)||/Edge\//i.test(e)||/Safari/i.test(e)&&!/Chrome/i.test(e)&&!/Version\/[1-9][1-9]\.[0-9].*Safari/i.test(navigator.userAgent))),Object(r.initializeBaseWindowUtil)()}var c={};function l(t,e){c[t]=e}function d(t){void 0!==c[t]&&delete c[t]}function f(){for(var t in c)c[t]()}n.d(e,"RegionComposer",(function(){return o})),n.d(e,"shouldUseRegionComposer",(function(){return s})),n.d(e,"initializeWindowUtil",(function(){return u})),n.d(e,"registerAfterRegionsRendered",(function(){return l})),n.d(e,"unregisterAfterRegionsRendered",(function(){return d}))}});
//# sourceMappingURL=wacBoot.min.js.map