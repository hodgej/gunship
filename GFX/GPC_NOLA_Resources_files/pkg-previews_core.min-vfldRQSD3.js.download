define("typescript/libraries/comments2/src/components/rich_facepile/avatars",["require","exports","tslib","typescript/libraries/comments2/src/components/rich_facepile/index.module.css","react","spectrum/avatar/index","spectrum/facepile/index","typescript/libraries/comments2/src/components/rich_facepile/spectrum_fork/facepile_members_avatar","spectrum/util/uuid_generator","typescript/libraries/comments2/src/components/rich_facepile/leave_active_mode_wrapper","typescript/libraries/comments2/src/components/rich_facepile/types"],(function(e,t,o,i,r,n,s,a,c,l,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Avatars=void 0,i=o.__importDefault(i),r=o.__importStar(r);const p=i.default.scRichFacepileOverflowTooltipContent;class u extends r.Component{constructor(){super(...arguments),this.state={},this.tooltipContentWrapperClassName=(0,c.generateUUID)("sc-rich-facepile-tooltip-content"),this.documentClickListener=e=>{const t=e.target;void 0===this.state.activeTooltipIndex||this.closest(t,this.tooltipContentWrapperClassName)||this.closest(t,"mc-facepile-container")||this.setActiveTooltipIndex(void 0)},this.leaveActiveMode=()=>{this.setActiveTooltipIndex(void 0)},this.bindN=e=>{const t=[];for(let o=0;o<d.MAX_FACES;o++)t.push(()=>e(o));return t},this.onTooltipShownForIndex=e=>{if(this.activeMode)return;const{onTooltipChange:t}=this.props,o=this.infoFromIndex(e);if(t&&null!==o){const i=this.avatarRectForIndex(e,o);t({activeMode:this.activeMode,displayInfo:null},{activeMode:this.activeMode,displayInfo:o,avatarRect:i})}},this.onTooltipHiddenForIndex=e=>{if(this.activeMode)return;const{onTooltipChange:t}=this.props,o=this.infoFromIndex(e);t&&null!==o&&t({activeMode:this.activeMode,displayInfo:o},{activeMode:this.activeMode,displayInfo:null})},this.onAvatarClickForIndex=e=>{const{becomePassiveOnOverflowAvatarClick:t,onAvatarClick:o}=this.props,i=this.infoFromIndex(e),r=t&&i===d.OVERFLOW;r||this.activeMode||this.setActiveTooltipIndex(e),r&&this.activeMode&&this.setActiveTooltipIndex(void 0),i&&o&&o(i)},this.onAvatarMouseOverForIndex=e=>{this.activeMode&&this.setActiveTooltipIndex(e)},this.onAvatarMouseEnterForIndex=e=>{if(this.props.onAvatarMouseEnter){const t=this.infoFromIndex(e),o=this.avatarRectForIndex(e,t);this.props.onAvatarMouseEnter({activeMode:this.activeMode,displayInfo:t,avatarRect:o})}},this.onAvatarFocusForIndex=e=>{this.onAvatarMouseEnterForIndex(e),this.onAvatarMouseOverForIndex(e)},this.onTooltipShown=this.bindN(this.onTooltipShownForIndex),this.onTooltipHidden=this.bindN(this.onTooltipHiddenForIndex),this.onAvatarClick=this.bindN(this.onAvatarClickForIndex),this.onAvatarMouseOver=this.bindN(this.onAvatarMouseOverForIndex),this.onAvatarMouseEnter=this.bindN(this.onAvatarMouseEnterForIndex),this.onAvatarFocus=this.bindN(this.onAvatarFocusForIndex),this.avatarDivRefs=Array(d.MAX_FACES).fill(0).map(e=>r.createRef())}componentDidMount(){document.addEventListener("click",this.documentClickListener,!0),window.addEventListener("resize",this.leaveActiveMode,!0)}componentWillUnmount(){document.removeEventListener("click",this.documentClickListener,!0),window.removeEventListener("resize",this.leaveActiveMode,!0)}closest(e,t){for(;e;e=e.parentElement)if(e.classList.contains(t))return e;return null}get activeMode(){return void 0!==this.state.activeTooltipIndex}setActiveTooltipIndex(e){const{activeTooltipIndex:t}=this.state,{onTooltipChange:o}=this.props;if(o&&t!==e){const{activeMode:i}=this,r=void 0!==e,n=r?this.infoFromIndex(e):null;o({activeMode:i,displayInfo:i?this.infoFromIndex(t):n},{activeMode:r,displayInfo:n,avatarRect:r?this.avatarRectForIndex(e,n):void 0})}this.setState({activeTooltipIndex:e})}displayModeForIndex(e){const{activeTooltipIndex:t}=this.state,o=this.props.passiveShowOnHover?d.DisplayMode.Hover:d.DisplayMode.Auto;return void 0===t?o:t===e?d.DisplayMode.ForceShow:d.DisplayMode.ForceHide}infoFromIndex(e){const{avatarInfoList:t,avatarInfoList:{length:o},overflowRemainderCount:i}=this.props;return i&&e===o?d.OVERFLOW:e>=o?null:t[e]}getBoundingClientRectForRef({current:e}){return e?e.getBoundingClientRect():{left:-1,top:-1,width:0,height:0,right:-1,bottom:-1}}avatarRectForIndex(e,t){if(void 0===t&&(t=this.infoFromIndex(e)),!t)return;const{left:o,top:i,width:r,height:n}=this.getBoundingClientRectForRef(this.avatarDivRefs[e]);return{origin:{x:o,y:i},size:{width:r,height:n}}}render(){const{avatarSize:e,avatarInfoList:t,overflowRemainderCount:o,tooltipComponent:i,renderFacepile:c,initialsToColorAssigner:u,source:m,intl:f}=this.props,h=t.map((t,o)=>{const{present:s,activeTooltipContent:c,avatarColorSeed:d,displayName:p,initials:f,memberKey:h,passiveTooltipContent:v,photoUrl:_}=t,g=d||p,y=r.createElement("div",{onFocusCapture:this.onAvatarFocus[o],ref:this.avatarDivRefs[o]},r.createElement(a.FacepileMembersAvatar,{active:s,"aria-label":p,avatarColorSeed:g,avatarSize:e,initials:f,onClick:this.onAvatarClick[o],onMouseEnter:this.onAvatarMouseEnter[o],onMouseOver:this.onAvatarMouseOver[o],photoUrl:_,initialsToColorAssigner:u||void 0}));let M;return this.activeMode?(M=void 0!==c?c:v,null!==M&&(M=r.createElement(l.LeaveActiveModeWrapperContext.Provider,{value:{signalClick:this.leaveActiveMode}},M))):M=v,r.createElement(i,{avatar:y,source:m,displayMode:this.displayModeForIndex(o),tooltipContent:M,avatarColor:u?u(g):(0,n.avatarColorForUserIdentifier)(g),onTooltipShown:this.onTooltipShown[o],onTooltipHidden:this.onTooltipHidden[o],tooltipContentWrapperClassName:this.tooltipContentWrapperClassName,key:h})});if(o){const n=f.formatMessage({id:"tkBGME",defaultMessage:"99+"}),a=o>=99?n:""+o,c=t.length,l=r.createElement("div",{onFocusCapture:this.onAvatarMouseOver[c],ref:this.avatarDivRefs[c]},r.createElement(s.FacepileMembersOverflowCircle,{avatarSize:e,backgroundColor:"#627283",textColor:"white",onClick:this.onAvatarClick[c],onMouseOver:this.onAvatarMouseOver[c],remainderCount:a})),u=f.formatMessage({id:"U34Aor",defaultMessage:"{count, plural, one {# other} other {# others}}"},{count:o});h.push(r.createElement(i,{source:m,avatar:l,displayMode:this.displayModeForIndex(c),tooltipContent:r.createElement("div",{className:p},u),avatarColor:"#627283",onTooltipShown:this.onTooltipShown[c],onTooltipHidden:this.onTooltipHidden[c],tooltipContentWrapperClassName:this.tooltipContentWrapperClassName,key:d.OVERFLOW}))}return c(h)}}t.Avatars=u,u.displayName="Avatars"})),define("typescript/libraries/comments2/src/components/rich_facepile/index",["require","exports","typescript/libraries/comments2/src/components/rich_facepile/util","typescript/libraries/comments2/src/components/rich_facepile/rich_facepile","typescript/libraries/comments2/src/components/rich_facepile/types"],(function(e,t,o,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RichFacepileProps=t.MAX_FACES=t.OVERFLOW=t.TooltipComponentProps=t.SizeClass=t.DisplayMode=t.AvatarInfo=t.RichFacepilePresentationInfo=t.RichFacepile=t.UtilTooltip=void 0,Object.defineProperty(t,"UtilTooltip",{enumerable:!0,get:function(){return o.UtilTooltip}}),Object.defineProperty(t,"RichFacepile",{enumerable:!0,get:function(){return i.RichFacepile}}),Object.defineProperty(t,"RichFacepilePresentationInfo",{enumerable:!0,get:function(){return i.RichFacepilePresentationInfo}}),Object.defineProperty(t,"AvatarInfo",{enumerable:!0,get:function(){return r.AvatarInfo}}),Object.defineProperty(t,"DisplayMode",{enumerable:!0,get:function(){return r.DisplayMode}}),Object.defineProperty(t,"SizeClass",{enumerable:!0,get:function(){return r.SizeClass}}),Object.defineProperty(t,"TooltipComponentProps",{enumerable:!0,get:function(){return r.TooltipComponentProps}}),Object.defineProperty(t,"OVERFLOW",{enumerable:!0,get:function(){return r.OVERFLOW}}),Object.defineProperty(t,"MAX_FACES",{enumerable:!0,get:function(){return r.MAX_FACES}}),Object.defineProperty(t,"RichFacepileProps",{enumerable:!0,get:function(){return r.RichFacepileProps}})})),define("typescript/libraries/comments2/src/components/rich_facepile/leave_active_mode_wrapper",["require","exports","tslib","react"],(function(e,t,o,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LeaveActiveModeWrapper=t.LeaveActiveModeWrapperContext=void 0,i=o.__importStar(i),t.LeaveActiveModeWrapperContext=i.createContext({signalClick:()=>{}});t.LeaveActiveModeWrapper=({children:e})=>i.createElement(t.LeaveActiveModeWrapperContext.Consumer,null,({signalClick:t})=>i.createElement("span",{onClick:t},e)),t.LeaveActiveModeWrapper.displayName="LeaveActiveModeWrapper"})),define("typescript/libraries/comments2/src/components/rich_facepile/rich_facepile",["require","exports","tslib","react","spectrum/facepile/index","typescript/libraries/comments2/src/components/rich_facepile/avatars","typescript/libraries/comments2/src/components/rich_facepile/types"],(function(e,t,o,i,r,n,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RichFacepile=void 0,i=o.__importStar(i);const a={[s.SizeClass.Small]:2,[s.SizeClass.Medium]:3,[s.SizeClass.Large]:s.MAX_FACES,[s.SizeClass.ExtraLarge]:s.MAX_FACES};t.RichFacepile=i.memo(e=>{const{avatarSize:t=32,avatarInfoList:o,becomePassiveOnOverflowAvatarClick:c,onAvatarClick:l,onTooltipChange:d,onAvatarMouseEnter:p,overflowBasis:u,shadowBackgroundColor:m,sizeClass:f,source:h,sizeClassToCircleCountOverrides:v,tooltipComponent:_,passiveShowOnHover:g,initialsToColorAssigner:y,intl:M}=e,b={...a,...v},C=Math.min(b[f],s.MAX_FACES);if(C<=0)return null;const I=Math.max(u,o.length);let T,E;return"fileViewer"===e.source&&window.innerWidth<768?(E=o.length-1,T=o):I<=C?(T=o,E=void 0):(T=o.slice(0,C-1),E=I-T.length),i.createElement(n.Avatars,{intl:M,avatarSize:t,onAvatarClick:l,onTooltipChange:d,onAvatarMouseEnter:p,avatarInfoList:T,becomePassiveOnOverflowAvatarClick:c,passiveShowOnHover:g,overflowRemainderCount:E,source:h,tooltipComponent:_,renderFacepile:e=>i.createElement(r.Facepile,{avatarSize:t,shadowBackgroundColor:m},e.reverse()),initialsToColorAssigner:y||void 0})}),t.RichFacepile.displayName="RichFacepile"})),define("typescript/libraries/comments2/src/components/rich_facepile/spectrum_fork/facepile_members_avatar",["require","exports","tslib","react","spectrum/avatar/index","spectrum/button/index"],(function(e,t,o,i,r,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FacepileMembersAvatar=void 0,i=o.__importStar(i);class s extends i.PureComponent{constructor(){super(...arguments),this.renderAvatarInitials=()=>{const{active:e,"aria-label":t,avatarColorSeed:o,avatarSize:n,initials:s,initialsToColorAssigner:a}=this.props;return i.createElement(r.AvatarInitials,{avatarSize:n,"aria-label":t,backgroundColor:a?a(o):(0,r.avatarColorForUserIdentifier)(o),variant:e?"normal":"inactive"},s)}}render(){const{active:e,"aria-label":t,"aria-describedby":o,avatarColorSeed:s,avatarSize:a,disabled:c,photoUrl:l,onClick:d,onMouseEnter:p,onMouseLeave:u,onMouseOver:m,tabIndex:f,initialsToColorAssigner:h}=this.props,v=h?h(s):(0,r.avatarColorForUserIdentifier)(s);return i.createElement(n.Button,{"aria-label":t,"aria-describedby":o,className:"mc-facepile-members-avatar",disabled:c,onClick:d,onMouseEnter:p,onMouseLeave:u,onMouseOver:m,tabIndex:f,variant:"circular"},l?i.createElement(r.Avatar,{renderFallback:this.renderAvatarInitials,size:a,src:l||void 0,variant:e?"normal":"inactive",style:{background:e?v:"#BFBFBF"}}):this.renderAvatarInitials())}}t.FacepileMembersAvatar=s,s.displayName="FacepileMembersAvatar"})),define("typescript/libraries/comments2/src/components/rich_facepile/types",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SizeClass=t.DisplayMode=t.MAX_FACES=t.OVERFLOW=void 0,t.OVERFLOW="overflow",t.MAX_FACES=5,(function(e){e[e.Auto=1]="Auto",e[e.ForceShow=2]="ForceShow",e[e.ForceHide=3]="ForceHide",e[e.Hover=4]="Hover"})(t.DisplayMode||(t.DisplayMode={})),(function(e){e[e.Small=0]="Small",e[e.Medium=1]="Medium",e[e.Large=2]="Large",e[e.ExtraLarge=3]="ExtraLarge"})(t.SizeClass||(t.SizeClass={}))})),define("typescript/libraries/comments2/src/components/rich_facepile/util",["require","exports","tslib","typescript/libraries/comments2/src/components/rich_facepile/index.module.css","react","classnames","spectrum/positioned_portal/index","spectrum/facepile_tooltip/facepile_tooltip_content","typescript/libraries/comments2/src/components/rich_facepile/types"],(function(e,t,o,i,r,n,s,a,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.UtilTooltip=void 0,i=o.__importDefault(i),r=o.__importStar(r),n=o.__importDefault(n);const l=i.default.scRichFacepileTooltipContentContainer,d=i.default.offsetFacepile;class p extends r.PureComponent{constructor(e){super(e),this.tooltipDirection="below",this.hidePortal=()=>{const e=this.portalRef.current;e&&e.hidePortal.call(e)},this.handlePortalMouseout=e=>{const{displayMode:t}=this.props;t===c.DisplayMode.Hover&&this.hasLeftIntoTooltip(e)&&e.stopPropagation()},this.onContentMouseLeave=()=>{this.props.displayMode===c.DisplayMode.Hover&&this.hidePortal()},this.renderContent=()=>{var e,t;const{avatarColor:o,tooltipContent:i,tooltipContentWrapperClassName:s,source:c}=this.props;return null===i?null:r.createElement(a.FacepileTooltipContent,{backgroundColor:o,className:(0,n.default)(l,s,{[d]:"fileViewer"===c&&(i.props.colorSeed||(null===(t=null===(e=i.props.children)||void 0===e?void 0:e.props)||void 0===t?void 0:t.colorSeed))}),tooltipContent:i,onMouseLeave:this.onContentMouseLeave})},this.portalRef=r.createRef()}componentDidUpdate({displayMode:e}){const{displayMode:t}=this.props,{current:o}=this.portalRef;o&&t!==e&&(t===c.DisplayMode.ForceShow?(this.hidePortal(),window.setTimeout(()=>o.showPortal.call(o),0)):o.state.isShown&&this.hidePortal())}hasLeftIntoTooltip(e){const t=e.target.getBoundingClientRect(),o=Math.abs(t.top-e.pageY),i=Math.abs(t.bottom-e.pageY),r=Math.abs(t.left-e.pageX),n=Math.abs(t.right-e.pageX);switch(Math.min(o,i,r,n)){case o:return"above"===this.tooltipDirection;case i:return"below"===this.tooltipDirection;case r:return"left"===this.tooltipDirection;case n:default:return"right"===this.tooltipDirection}}render(){const{avatar:e,onTooltipShown:t,onTooltipHidden:o,displayMode:i=c.DisplayMode.Auto}=this.props,n=i===c.DisplayMode.Hover?r.createElement("div",{onMouseLeave:this.handlePortalMouseout},e):e;return r.createElement(s.PositionedPortal,{renderContent:this.renderContent,onDidShow:t,onWillClose:o,isShowInitially:i===c.DisplayMode.ForceShow,positioning:this.tooltipDirection,ref:this.portalRef,showOnMouseMove:i===c.DisplayMode.Auto||i===c.DisplayMode.Hover,closeOnBlur:i===c.DisplayMode.Auto||i===c.DisplayMode.Hover},n)}}t.UtilTooltip=p,p.displayName="UtilTooltip"})),define("typescript/libraries/comments2/src/components/rich_facepile/index.module.css",["require","exports","css!typescript/libraries/comments2/src/components/rich_facepile/index.module.out.css"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.offsetFacepile=t.scRichFacepileOverflowTooltipContent=t.scRichFacepileTooltipContentContainer=void 0,t.scRichFacepileTooltipContentContainer="_sc-rich-facepile-tooltip-content-container_1qstf_3",t.scRichFacepileOverflowTooltipContent="_sc-rich-facepile-overflow-tooltip-content_1qstf_11",t.offsetFacepile="_offset-facepile_1qstf_16";t.default={scRichFacepileTooltipContentContainer:"_sc-rich-facepile-tooltip-content-container_1qstf_3",scRichFacepileOverflowTooltipContent:"_sc-rich-facepile-overflow-tooltip-content_1qstf_11",offsetFacepile:"_offset-facepile_1qstf_16"}})),define("typescript/libraries/comments2/src/components/utils/throttle-debounce",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.debounce=t.throttle=void 0,t.throttle=function(e,t){let o=!0,i=null;function r(){o=!0,null!==i&&(e(...i),i=null)}return function(...n){o?(o=!1,e(...n),setTimeout(r,t)):i=n}},t.debounce=function(e,t,o=!1){let i;return function(...r){const n=this,s=o&&void 0===i;void 0!==i&&window.clearTimeout(i),i=window.setTimeout((function(){i=void 0,o||e.apply(n,r)}),t),s&&e.apply(n,r)}}})),define("typescript/libraries/comments2/src/transforms/index",["require","exports","typescript/libraries/comments2/src/transforms/comments","typescript/libraries/comments2/src/transforms/threads","typescript/libraries/comments2/src/transforms/users","typescript/libraries/comments2/src/transforms/revisions","typescript/libraries/comments2/src/transforms/annotations","typescript/libraries/comments2/src/transforms/third_party_source"],(function(e,t,o,i,r,n,s,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.thirdPartySourceToIThirdPartySource=t.iInteractionAnnotationToNumberedAnnotation=t.numberedAnnotationToIInteractionAnnotation=t.streamToRevision=t.userToIUser=t.usersToIUserMap=t.threadToIThread=t.threadsToIThreadMap=t.iCommentContentToUserSubmittedComment=void 0,Object.defineProperty(t,"iCommentContentToUserSubmittedComment",{enumerable:!0,get:function(){return o.iCommentContentToUserSubmittedComment}}),Object.defineProperty(t,"threadsToIThreadMap",{enumerable:!0,get:function(){return i.threadsToIThreadMap}}),Object.defineProperty(t,"threadToIThread",{enumerable:!0,get:function(){return i.threadToIThread}}),Object.defineProperty(t,"usersToIUserMap",{enumerable:!0,get:function(){return r.usersToIUserMap}}),Object.defineProperty(t,"userToIUser",{enumerable:!0,get:function(){return r.userToIUser}}),Object.defineProperty(t,"streamToRevision",{enumerable:!0,get:function(){return n.streamToRevision}}),Object.defineProperty(t,"numberedAnnotationToIInteractionAnnotation",{enumerable:!0,get:function(){return s.numberedAnnotationToIInteractionAnnotation}}),Object.defineProperty(t,"iInteractionAnnotationToNumberedAnnotation",{enumerable:!0,get:function(){return s.iInteractionAnnotationToNumberedAnnotation}}),Object.defineProperty(t,"thirdPartySourceToIThirdPartySource",{enumerable:!0,get:function(){return a.thirdPartySourceToIThirdPartySource}})})),define("typescript/libraries/comments2/src/transforms/annotations",["require","exports"],(function(e,t){"use strict";function o(e,t){return e[".tag"]===t}Object.defineProperty(t,"__esModule",{value:!0}),t.iInteractionAnnotationToNumberedAnnotation=t.numberedAnnotationToIInteractionAnnotation=t.iAnnotationToAnnotation=t.annotationToIAnnotation=void 0,t.annotationToIAnnotation=function(e){if(o(e,"video"))return{type:"video",time:e.time||0,timeSec:e.time_sec||0};if(o(e,"audio"))return{type:"audio",time:e.time};if(o(e,"document"))return{type:"document",regionType:e.region_type[".tag"],label:e.label,regions:e.regions};if(o(e,"image"))return{type:"image",region:e.region,label:e.label};throw new Error("Attempted to convert an annotation type that does not yet exist.")},t.iAnnotationToAnnotation=function(e){return"video"===e.type?{".tag":"video",time:e.time,time_sec:e.timeSec}:"audio"===e.type?{".tag":"audio",time:e.time}:"document"===e.type?{".tag":"document",regions:e.regions,region_type:{".tag":e.regionType}}:{".tag":"image",region:{...e.region,page:1}}},t.numberedAnnotationToIInteractionAnnotation=function(e){return"image"===e.type?{type:"rnd",regions:[e.region]}:"highlight"===e.regionType?{type:"highlight",regions:e.regions}:{type:"rnd",regions:e.regions}},t.iInteractionAnnotationToNumberedAnnotation=function({type:e,regions:t},o){return void 0===o?{type:"image",region:t[0]}:{type:"document",regionType:"rnd"===e?"rectangle":"highlight",regions:t.map(e=>(function(e,t){return{...e,page:t}})(e,o))}}})),define("typescript/libraries/comments2/src/transforms/comments",["require","exports","typescript/libraries/comments2/src/transforms/annotations","typescript/libraries/comments2/src/transforms/metadata","typescript/libraries/comments2/src/transforms/revisions"],(function(e,t,o,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.iCommentContentToUserSubmittedComment=t.commentToIComment=void 0,t.commentToIComment=function(e,t,o,n){return{author:o[e.author_id],content:{metadata:(0,i.metadataToIMetadata)(e.metadata),text:e.content},deleted:e.deleted,id:e.id,threadId:t,timestamp:new Date(e.timestamp),revisionInfo:n&&e.revision?(0,r.revisionInfoToIRevisionInfo)(n,e.revision):{isCurrent:!0},userPermissions:{canDelete:e.permissions.can_delete,canEdit:e.permissions.can_edit}}},t.iCommentContentToUserSubmittedComment=function({annotation:e,content:t,stream:n}){return{annotation_data:e?(0,o.iAnnotationToAnnotation)(e):void 0,content:t.text,metadata:(0,i.iCommentMetadataToUserSubmittedMetadata)(t.metadata),revision:(0,r.streamToRevision)(n)}}})),define("typescript/libraries/comments2/src/transforms/metadata",["require","exports"],(function(e,t){"use strict";function o(e,t){return e.type===t}function i(e){return o(e,"mention")}function r(e){return o(e,"style")}function n(e){return o(e,"sticker")}function s(e){return o(e,"guest")}function a(e){return o(e,"reel")}function c(e){const t=e.format[".tag"];if("other"===t)throw new Error('"other" is not a valid format block');return{location:e.location,style:t,type:"style"}}function l(e){const t=e.user.type[".tag"];if("other"===t)throw new Error('"other" is not a valid user type');const o={identifier:e.user.identifier,type:t};return{location:e.location,type:"mention",user:o}}function d(e){var t,o,i;if(e.status&&e.approvers&&e.requester_email)return{type:"approval",status:e.status[".tag"],requester_email:e.requester_email,approval_type:null===(t=e.approval_type)||void 0===t?void 0:t[".tag"],actor:null===(o=e.actor)||void 0===o?void 0:o[".tag"],approvers:null===(i=e.approvers)||void 0===i?void 0:i.map(e=>{var t;return{email:e.email,display_name:e.display_name,overall_status:null===(t=e.overall_status)||void 0===t?void 0:t[".tag"]}}),requires_all:e.requires_all}}Object.defineProperty(t,"__esModule",{value:!0}),t.iCommentMetadataToUserSubmittedMetadata=t.metadataToIMetadata=t.approvalMetadataToIApprovalMetadata=t.isReelMetadata=t.isGuestMetadata=t.isStickerMetadata=t.isStyleMetadata=t.isMentionMetadata=void 0,t.isMentionMetadata=i,t.isStyleMetadata=r,t.isStickerMetadata=n,t.isGuestMetadata=s,t.isReelMetadata=a,t.approvalMetadataToIApprovalMetadata=d,t.metadataToIMetadata=function(e){const t=[...e.formatting.map(c),...e.mentions.map(l)];if(e.sticker){const o=(function(e){if(e.url&&e.name&&e.description)return{type:"sticker",id:e.id,url:e.url,name:e.name,description:e.description}})(e.sticker);o&&t.push(o)}if(e.guest){const o=(function(e){if(e.first_name||e.last_name)return{type:"guest",first_name:e.first_name,last_name:e.last_name}})(e.guest);o&&t.push(o)}if(e.reel){const o=(function(e){if(e.annotation_data)return{type:"reel",annotation_data:e.annotation_data}})(e.reel);o&&t.push(o)}if(e.approval){const o=d(e.approval);o&&t.push(o)}return t},t.iCommentMetadataToUserSubmittedMetadata=function(e){const t=e.filter(r).map(e=>({format:{".tag":e.style},location:e.location})),o=e.filter(i).map(e=>({user:{type:{".tag":e.user.type},identifier:e.user.identifier},location:e.location})),c=e.find(n),l=c?{id:c.id}:void 0,d=e.find(s),p=d?{first_name:d.first_name,last_name:d.last_name}:void 0,u=e.find(a);return{formatting:t,mentions:o,sticker:l,guest:p,reel:u?{annotation_data:u.annotation_data}:void 0}}})),define("typescript/libraries/comments2/src/transforms/revisions",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.streamToRevision=t.revisionInfoToIRevisionInfo=void 0,t.revisionInfoToIRevisionInfo=function(e,t){const o=t.timestamp?new Date(t.timestamp):void 0;return{isCurrent:e.ns_id===t.ns_id&&e.sjid===t.sjid,revision:{nsId:t.ns_id,sjId:t.sjid},timestamp:o}},t.streamToRevision=function(e){return e&&"file"===e.type?{ns_id:e.ns_id,sjid:e.sjid}:void 0}})),define("typescript/libraries/comments2/src/transforms/third_party_source",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.thirdPartySourceToIThirdPartySource=void 0,t.thirdPartySourceToIThirdPartySource=function(e){return e[".tag"]}})),define("typescript/libraries/comments2/src/transforms/threads",["require","exports","lodash","typescript/libraries/comments2/src/transforms/annotations","typescript/libraries/comments2/src/transforms/comments"],(function(e,t,o,i,r){"use strict";function n(e,t){if("resolved_no_details"===e[".tag"])return{type:"no_details"};if((function(e){return"resolved_with_details"===e[".tag"]})(e))return{type:"with_details",resolver:t[e.resolver_id],resolvedTimestamp:new Date(e.resolved_timestamp)};throw new Error("Not a valid type for ResolvedInfo.")}function s(e,t,o){const s=e.comments.map(i=>(0,r.commentToIComment)(i,e.id,t,o)),a=e.resolved_info?{resolved:!0,resolvedInfo:n(e.resolved_info,t)}:{resolved:!1};return{annotation:e.annotation_data?(0,i.annotationToIAnnotation)(e.annotation_data):void 0,comments:s,id:e.id,read:e.read,readonly:e.readonly,isThirdParty:e.is_third_party,...a,timestamp:s[0].timestamp}}Object.defineProperty(t,"__esModule",{value:!0}),t.threadsToIThreadMap=t.threadToIThread=t.resolvedInfoToIResolvedInfo=void 0,t.resolvedInfoToIResolvedInfo=n,t.threadToIThread=s,t.threadsToIThreadMap=function(e,t,i){const r=e.map(e=>s(e,t,i));return(0,o.keyBy)(r,"id")}})),define("typescript/libraries/comments2/src/transforms/users",["require","exports","lodash"],(function(e,t,o){"use strict";function i(e){return{id:e.id,name:{display:e.display_name,initials:e.initials,public:e.public_name},photoUrl:e.photo_url}}Object.defineProperty(t,"__esModule",{value:!0}),t.usersToIUserMap=t.userToIUser=void 0,t.userToIUser=i,t.usersToIUserMap=function(e){const t=e.map(i);return(0,o.keyBy)(t,"id")}})),define("metaserver/static/js/cloud_docs/shared_components/dynamic_routing_modal",["require","exports","tslib","metaserver/static/js/components/ui/modal","metaserver/static/js/cloud_docs/open_with_utils","metaserver/static/js/components/ui/css","metaserver/static/js/cloud_docs/constants","react","metaserver/static/js/core/i18n","spectrum/button/index","metaserver/static/js/cloud_docs/event_logging","metaserver/static/js/cloud_docs/types","metaserver/static/js/metrics/index","metaserver/static/js/dig-illustrations/spot/paper-airplane"],(function(e,t,o,i,r,n,s,a,c,l,d,p,u,m){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.showDynamicRoutingModal=t.DynamicRoutingModal=void 0,a=o.__importStar(a);class f extends a.Component{constructor(e){super(e),this.editorToString={preview:c.intl.formatMessage({id:"N5Byoz",defaultMessage:"Dropbox Preview"}),word:c.intl.formatMessage({id:"Y9FcUQ",defaultMessage:"Word for the web"}),excel:c.intl.formatMessage({id:"o3mRdr",defaultMessage:"Excel for the web"}),powerpoint:c.intl.formatMessage({id:"RTj2SO",defaultMessage:"PowerPoint for the web"}),gdoc:c.intl.formatMessage({id:"+HsOFj",defaultMessage:"Google Docs"}),gsheet:c.intl.formatMessage({id:"cpuRML",defaultMessage:"Google Sheets"}),gslides:c.intl.formatMessage({id:"PcJCVL",defaultMessage:"Google Slides"})},this.state={set_routing_dest:!1}}componentDidMount(){(0,d.logUserAction)({actionEvent:p.UserActionEventType.DYNAMIC_ROUTING_MODAL_IMPRESSION,userId:this.props.user.id,docPathOrId:this.props.file.file_id,data:{webOpenId:this.props.openId,origDest:this.props.currentEditor}})}componentWillUnmount(){if(!this.state.set_routing_dest){const e="Dismissed";(0,d.logUserAction)({actionEvent:p.UserActionEventType.DYNAMIC_ROUTING_MODAL_IMPRESSION,userId:this.props.user.id,docPathOrId:this.props.file.file_id,data:{webOpenId:this.props.openId,origDest:this.props.currentEditor,routingDest:e}});const t=(0,u.getMetricsReporter)(),o={origin:this.props.currentEditor,destination:e};t.createStats({ns:s.CLOUD_DOCS_AMP_NAMESPACE,name:"web/dynamicRoutingEvent"},o).record(1),this.setState({set_routing_dest:!1})}}render(){const e=this.editorToString[this.props.editorWithLock],t=this.editorToString[this.props.currentEditor];let o,n,f,h=c.intl.formatMessage({id:"ILSqGs",defaultMessage:"Want to see the latest version and edit?"});"preview"===this.props.currentEditor?(n=c.intl.formatMessage({id:"vX9MC5",defaultMessage:"Open in {editor_with_lock_string}"},{editor_with_lock_string:e}),o=c.intl.formatMessage({id:"MaUI+x",defaultMessage:"Right now people are working on this file in {editor_with_lock_string}. You can see updates and edit there."},{editor_with_lock_string:e})):this.props.isLockEditorEnabled?(n=c.intl.formatMessage({id:"jpCK4T",defaultMessage:"Edit in {editor_with_lock_string}"},{editor_with_lock_string:e}),o=c.intl.formatMessage({id:"1Y/1oL",defaultMessage:"Because this file is already open in {editor_with_lock_string}, you can only see updates and edit there."},{editor_with_lock_string:e})):(h=c.intl.formatMessage({id:"RtkW2p",defaultMessage:"You canâ€™t edit this file right now"}),o=c.intl.formatMessage({id:"yOUn8S",defaultMessage:"Someone is working on this file in {editor_with_lock_string}. However, your admin has disabled access to {editor_with_lock_string} in your organization."},{editor_with_lock_string:e}));const v=(e,t)=>{(0,d.logUserAction)({actionEvent:p.UserActionEventType.DYNAMIC_ROUTING_MODAL_IMPRESSION,userId:this.props.user.id,docPathOrId:this.props.file.file_id,data:{webOpenId:this.props.openId,origDest:this.props.currentEditor,routingDest:e}});const o=(0,u.getMetricsReporter)(),i={origin:this.props.currentEditor,destination:e};o.createStats({ns:s.CLOUD_DOCS_AMP_NAMESPACE,name:"web/dynamicRoutingEvent"},i).record(1),this.setState({set_routing_dest:!0});const n=window.self;(0,r.getCloudEditorUrl)(this.props.user.id,this.props.file.file_id).then(o=>{(0,r.openCloudEditorUrl)(o,n,this.props.file.file_id,this.props.user.id,e,t)}).catch(e=>{(0,r.handleError)(e)})},_=()=>{v(this.props.editorWithLock,!1)};if(this.props.showViewOnlyMode){const e=()=>{v(this.props.currentEditor,!0)},o=c.intl.formatMessage({id:"nLLL8d",defaultMessage:"View-Only in {current_editor}"},{current_editor:t});f=a.createElement("div",{className:"link-text"},a.createElement("span",{role:"link",className:"link-span",tabIndex:0,onClick:e},o))}else if(!this.props.isLockEditorEnabled){const e=c.intl.formatMessage({id:"DWwxhG",defaultMessage:"View-Only in Preview"});f=a.createElement("div",{className:"link-text"},a.createElement("span",{role:"link",className:"link-span",tabIndex:0,onClick:()=>i.Modal.close()},e))}let g;return g=this.props.isLockEditorEnabled?a.createElement("div",{className:"edit-buttons"},a.createElement(l.Button,{className:"main-button",onClick:_},n),f):a.createElement("div",{className:"edit-buttons"},f),a.createElement(i.Modal,{id:"dynamic-routing",className:"dynamic-routing-modal",buttonComponent:g,displayCloseButton:!0,style:"clean"},a.createElement("div",{className:"default-dyn-routing-modal"},a.createElement("div",{className:"modal-image"},a.createElement(m.PaperAirplaneSpot,null)),a.createElement("div",{className:"main-text"},h),a.createElement("div",{className:"sub-text"},o)))}}f.displayName="DynamicRoutingModalWithoutCss",t.DynamicRoutingModal=(0,n.requireCssWithComponent)(f,["/static/metaserver/static/css/cloud_docs/dynamic_routing-vfltbra9r.css"]),t.showDynamicRoutingModal=function(e){i.Modal.showInstance(a.createElement(t.DynamicRoutingModal,Object.assign({},e)))}})),define("metaserver/static/js/cloud_docs/shared_components/routing",["require","exports","tslib","metaserver/static/js/cloud_docs/constants","typescript/libraries/file-viewer/src/file_extension/extension_constants","metaserver/static/js/cloud_docs/shared_components/dynamic_routing_modal","metaserver/static/js/cloud_docs/cloud_doc_api_client","metaserver/static/js/file_store/utils","metaserver/static/js/core/browser","metaserver/static/js/cloud_docs/types"],(function(e,t,o,i,r,n,s,a,c,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getCloudEditorString=t.maybeShowDynamicRoutingModal=void 0,c=o.__importStar(c);const d={[i.MicrosoftEditors.WORD]:!0,[i.MicrosoftEditors.EXCEL]:!0,[i.MicrosoftEditors.POWERPOINT]:!1,[i.GoogleFileTypes.GOOGLE_DSS_SLIDES]:!1,[i.GoogleFileTypes.GOOGLE_DSS_DOC]:!1,[i.GoogleFileTypes.GOOGLE_DSS_SHEET]:!1,preview:!1};var p;(function(e){e.pptx="pptx",e.docx="docx",e.xlsx="xlsx"})(p||(p={}));const u={3503728:{[p.pptx]:i.GoogleFileTypes.GOOGLE_DSS_SLIDES,[p.docx]:i.GoogleFileTypes.GOOGLE_DSS_DOC,[p.xlsx]:i.GoogleFileTypes.GOOGLE_DSS_SHEET},661085:{[p.pptx]:i.MicrosoftEditors.POWERPOINT,[p.docx]:i.MicrosoftEditors.WORD,[p.xlsx]:i.MicrosoftEditors.EXCEL}},m={3503728:l.CloudDocProviderIntegration.GDD_INTEGRATION};function f(e,t){var o;if(e)switch(e.toLowerCase()){case"google_docs":case"gdoc":return i.GoogleFileTypes.GOOGLE_DSS_DOC;case"google_slides":case"gslides":return i.GoogleFileTypes.GOOGLE_DSS_SLIDES;case"google_sheets":case"gsheet":return i.GoogleFileTypes.GOOGLE_DSS_SHEET;case"wopi":return o=t,r.PRESENTATION_EXTS.map(e=>e.slice(1)).includes(o)?i.MicrosoftEditors.POWERPOINT:(function(e){return["doc","docm","docx"].includes(e)})(t)?i.MicrosoftEditors.WORD:i.MicrosoftEditors.EXCEL;case"paper":return t;case"word":case"excel":case"powerpoint":return e;default:return}}t.maybeShowDynamicRoutingModal=function(e,t,i){return o.__awaiter(this,void 0,void 0,(function*(){const o=i;(0,s.getLockProviderAsync)(e.id,t.file_id).then(r=>{const p=r.app_id;if(p&&u[p][o]&&((0,a.isBrowseFile)(t)||(0,a.isSharedFile)(t))){const r=c.get_uri().getQuery().web_open_id,a=f(c.get_uri().getQuery().from_editor,i)||"preview",h={editorWithLock:u[p][o],currentEditor:a,file:t,user:e,showViewOnlyMode:d[a],openId:r,isLockEditorEnabled:!0};e.is_team?(0,s.getTeamSettings)(e.id).then(e=>{const t=e.settings;if(m.hasOwnProperty(p)){const e=m[p];h.isLockEditorEnabled=t[e][".tag"]===l.IntegrationCreateAndEdit[".tag"]}("preview"!==h.currentEditor||h.isLockEditorEnabled)&&(0,n.showDynamicRoutingModal)(h)}):(0,n.showDynamicRoutingModal)(h)}})}))},t.getCloudEditorString=f})),define("metaserver/static/js/previews/ui/constants",["require","exports","typescript/libraries/file-viewer/src/core/logging/constants"],(function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PreviewSourceAction=t.PreviewSourceContext=void 0,Object.defineProperty(t,"PreviewSourceContext",{enumerable:!0,get:function(){return o.SourceContext}}),(function(e){e.Visit="visit",e.Click="click",e.FileViewerExit="file_viewer_exit"})(t.PreviewSourceAction||(t.PreviewSourceAction={}))}));var __createBinding=this&&this.__createBinding||(Object.create?function(e,t,o,i){void 0===i&&(i=o);var r=Object.getOwnPropertyDescriptor(t,o);r&&("get"in r?t.__esModule:!r.writable&&!r.configurable)||(r={enumerable:!0,get:function(){return t[o]}}),Object.defineProperty(e,i,r)}:function(e,t,o,i){void 0===i&&(i=o),e[i]=t[o]}),__setModuleDefault=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),__importStar=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var o in e)"default"!==o&&Object.prototype.hasOwnProperty.call(e,o)&&__createBinding(t,e,o);return __setModuleDefault(t,e),t};define("metaserver/static/js/share_download/ui/button",["require","exports","metaserver/static/js/async/loadable"],(function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ShareDownloadButton=t.DownloadSimpleButton=void 0,t.DownloadSimpleButton=(0,o.Loadable)({loader:()=>new Promise((t,o)=>{e(["metaserver/static/js/share_download/ui/button_component"],t,o)}).then(__importStar).then(({DownloadSimpleButton:e})=>e)}),t.ShareDownloadButton=(0,o.Loadable)({loader:()=>new Promise((t,o)=>{e(["metaserver/static/js/share_download/ui/button_component"],t,o)}).then(__importStar).then(({ShareDownloadButton:e})=>e)})})),define("metaserver/static/js/teams/email_checker_store",["require","exports","tslib","metaserver/static/js/deprecated_ajax/ajax_jquery","metaserver/static/js/clean/active_user"],(function(e,t,o,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EmailCheckerStore=t.EmailCheckResult=void 0,i=o.__importStar(i);class n{constructor(){this.inFlight=!0,this.canInvite=!1,this.reason="checking",this.callbacks=[]}whenReady(e){this.inFlight?this.callbacks.push(e):e()}resultArrived(e,t){if(this.inFlight){this.inFlight=!1,this.canInvite=e,this.reason=t;for(const e of this.callbacks)e();this.callbacks=[]}}}t.EmailCheckResult=n;t.EmailCheckerStore=class{constructor(e){this.checkEmails=(e,t)=>{const o={};let s=e.length;if(0===s)return t(o);const a=[];for(const i of e){let e=this.checkedEmails[i];e||(e=this.checkedEmails[i]=new n,a.push(i)),e.whenReady((function(){o[i]=e,0==--s&&t(o)}))}a.length>0&&(e=>{i.WebRequest({url:this.checkUrl,data:{emails:e.join(",")},subject_user:(0,r.mustGetActiveUserId)(),success:e=>{const t=JSON.parse(e);for(const e in t)if(t[e]){const{can_invite:o,reason:i}=t[e];this.checkedEmails[e]&&this.checkedEmails[e].resultArrived(o,i)}},error:()=>{for(const t of e)delete this.checkedEmails[t]}})})(a)},this.checkUrl=e,this.checkedEmails={}}getEmailCheckResult(e){return this.checkedEmails[e]}}})),define("metaserver/static/js/clean/shallow_equal",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.shallowEqualArray=t.shallowEqual=void 0;const o=Object.prototype.hasOwnProperty;function i(e,t){return e===t?0!==e||0!==t||1/e==1/t:e!=e&&t!=t}t.shallowEqual=function(e,t){if(i(e,t))return!0;if("object"!=typeof e||null===e||"object"!=typeof t||null===t)return!1;const r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(let n=0;n<r.length;n++)if(!o.call(t,r[n])||!i(e[r[n]],t[r[n]]))return!1;return!0},t.shallowEqualArray=function(e,t){if(e===t)return!0;if(!e||!t||e.length!==t.length)return!1;for(let o=0;o<e.length;++o)if(e[o]!==t[o])return!1;return!0}})),define("metaserver/static/js/bug_reporting/routing",["require","exports","tslib","react"],(function(e,t,o,i){"use strict";var r;let n;Object.defineProperty(t,"__esModule",{value:!0}),t.RegisterComponentWithBugReporter=t.getBugScopes=void 0,i=o.__importStar(i),r||(r={});const s=window.currentBugScopes;s?n=s:window.currentBugScopes=n={nextId:0,scopes:{}},t.getBugScopes=function(){return Object.values(n.scopes)};t.RegisterComponentWithBugReporter=({componentId:e,componentName:t,children:o})=>((0,i.useEffect)(()=>{const o=(function(e,t){const o=n.nextId;return n.nextId++,n.scopes[o]={componentId:e,componentName:t},o})(e,t);return()=>{return e=o,void delete n.scopes[e];var e}},[e,t]),i.default.createElement(i.default.Fragment,null,o)),t.RegisterComponentWithBugReporter.displayName="RegisterComponentWithBugReporter"}));
//# sourceMappingURL=pkg-previews_core.min.js-vfl19Quwb.map