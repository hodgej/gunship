define("metaserver/static/js/flux/action_type",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.withActionNamespace=void 0;t.withActionNamespace=function(e,t){const s={},r={};for(const a of Object.keys(t||{})){const n=t[a];if(s[a]=`${e}__${n}`,null!=r[n])throw new Error(`Duplicate action value '${n}'!`);r[n]=!0}return s}})),define("metaserver/static/js/sharing/action_types",["require","exports","metaserver/static/js/flux/action_type"],(function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SharingActionTypes=t.ShareModalActionTypes=void 0,t.ShareModalActionTypes=(0,s.withActionNamespace)("share-modal-actions",{SHARE_MODAL_OPEN:"share-modal-open",SHARE_MODAL_CLOSE:"share-modal-close",RESET_MODAL_STATE:"reset-modal-state",OPEN_LINK_SETTINGS_MODAL:"open-link-settings-modal",OPEN_FOLDER_SETTINGS_MODAL:"open-folder-settings-modal",OPEN_SHARED_LINK_MODAL:"open-shared-link-modal",CLOSE_LINK_SETTINGS_MODAL:"close-link-settings-modal",CLOSE_FOLDER_SETTINGS_MODAL:"close-folder-settings-modal",CLOSE_SHARED_LINK_MODAL:"close-shared-link-modal",CLEAR_METADATA:"clear-metadata",FETCH_METADATA_REQUEST:"metadata-request",FETCH_METADATA_SUCCESS:"metadata-success",FETCH_METADATA_FAILURE:"metadata-failure",CLEAR_LINK_METADATA:"clear-link-metadata",FETCH_LINK_METADATA_REQUEST:"link-metadata-request",FETCH_LINK_METADATA_SUCCESS:"link-metadata-success",FETCH_LINK_METADATA_FAILURE:"link-metadata-failure",CLEAR_SHARING_PREFS:"clear-sharing-prefs",FETCH_SHARING_PREFS_REQUEST:"sharing-prefs-request",FETCH_SHARING_PREFS_SUCCESS:"sharing-prefs-success",FETCH_SHARING_PREFS_FAILURE:"sharing-prefs-failure",ERROR_MESSAGE:"error-message",ERROR_MESSAGE_CLEAR:"error-message-clear",CLEAR_FILE_MEMBERSHIP:"clear-file-membership",FETCH_FILE_MEMBERSHIP_REQUEST:"fetch-file-membership-request",FETCH_FILE_MEMBERSHIP_SUCCESS:"fetch-file-membership-success",FETCH_FILE_MEMBERSHIP_FAILURE:"fetch-file-membership-failure",CLEAR_FOLDER_MEMBERSHIP:"clear-folder-membership",FETCH_FOLDER_MEMBERSHIP_REQUEST:"fetch-folder-membership-request",FETCH_FOLDER_MEMBERSHIP_SUCCESS:"fetch-folder-membership-success",FETCH_FOLDER_MEMBERSHIP_FAILURE:"fetch-folder-membership-failure",FETCH_USER_ACCOUNTS_REQUEST:"fetch-user-accounts-request",FETCH_USER_ACCOUNTS_SUCCESS:"fetch-user-accounts-success",FETCH_USER_ACCOUNTS_FAILURE:"fetch-user-accounts-failure",FETCH_USER_ACCOUNTS_CONTINUED_REQUEST:"fetch-user-accounts-continued-request",FETCH_USER_ACCOUNTS_CONTINUED_SUCCESS:"fetch-user-accounts-continued-success",CLEAR_FILE_MEMBERSHIP_LAST_SEEN_INFO:"clear-file-membership-last-seen-info",FETCH_FILE_MEMBER_COUNT_REQUEST:"fetch-file-member-count-request",FETCH_FILE_MEMBER_COUNT_SUCCESS:"fetch-file-member-count-success",CHANGE_RECIPIENTS:"change-recipients",CHANGE_RECIPIENT_MESSAGE:"change-recipient-message",APPEND_TO_RECIPIENT_MESSAGE:"append-to-recipient-message",CHANGE_RECIPIENT_ACCESS:"change-recipient-access",UPDATE_RECIPIENT_VALIDATION:"update-recipient-validation",CREATE_LINK_REQUEST:"create-link-request",CREATE_LINK_SUCCESS:"create-link-success",CREATE_LINK_FAILURE:"create-link-failure",DISPLAY_CONTENT_NAME_INFO:"display-content-name-info",SEND_SHARE_REQUEST:"send-share-request",SEND_SHARE_SUCCESS:"send-share-success",SEND_SHARE_FAILURE:"send-share-failure",SHARE_FOLDER_REQUEST:"share-folder-request",SHARE_FOLDER_SUCCESS:"share-folder-success",SHARE_FOLDER_FAILURE:"share-folder-failure",SEND_FOLDER_SHARE_REQUEST:"send-folder-share-request",SEND_FOLDER_SHARE_SUCCESS:"send-folder-share-success",SEND_FOLDER_SHARE_FAILURE:"send-folder-share-failure",CHANGE_MEMBER_ACCESS_REQUEST:"change-member-access-request",CHANGE_MEMBER_ACCESS_SUCCESS:"change-member-access-success",CHANGE_MEMBER_ACCESS_FAILURE:"change-member-access-failure",MEMBER_ACTION_PENDING:"member-action-pending",MEMBER_ACTION_COMPLETE:"member-action-complete",REMOVE_MEMBER_SUCCESS:"remove-member-success",REMOVE_MEMBER_KEEP_ACCESS:"remove-member-keep-access",TRANSFER_OWNER_SUCCESS:"transfer-owner-success",FETCH_CURRENT_ACCOUNT_REQUEST:"fetch-current-account-request",FETCH_CURRENT_ACCOUNT_SUCCESS:"fetch-current-account-success",FETCH_MEMBER_COUNTS_REQUEST:"fetch-member-counts-request",FETCH_MEMBER_COUNTS_SUCCESS:"fetch-member-counts-success",HANDLE_CONTENT_NAME_CHANGE:"handle-content-name-change",VALIDATE_CONTENT_NAME_SUCCESS:"validate-content-name-success",VALIDATE_CONTENT_NAME_ERROR:"validate-content-name-error",CHANGE_LINK_AUDIENCE_REQUEST:"change-link-audience-request",CHANGE_LINK_AUDIENCE_SUCCESS:"change-link-audience-success",CHANGE_LINK_AUDIENCE_FAILURE:"change-link-audience-failure",UNBLOCK_MEMBER_LIST_ON_PASS_LOAD:"unblock-member-list-on-pass-load",UPDATE_SHARING_SETTINGS_SUCCESS:"update-sharing-settings-success",DELETE_LINK_METADATA_SUCCESS:"delete-link-metadata-success",CHANGE_CREATE_COMMENT_CHECKBOX:"change-create-comment-checkbox",SET_UPSELL_COUNTER_PREF:"set-upsell-counter-pref",SET_UPSELL_COUNTER_PREF_SUCCESS:"set-upsell-counter-pref-success",CHANGE_LINK_AUDIENCE_SELECTION:"change-link-audience-selection",REMOVE_LINK_AUDIENCE_SELECTION:"remove-link-audience-selection",TOGGLE_SEND_APPROVAL:"toggle-send-approval",CHANGE_NEEDS_ALL_APPROVERS:"change-needs-all-approvers",CREATE_APPROVAL_REQUEST:"create-approval-request",CREATE_APPROVAL_SUCCESS:"create-approval-success",CREATE_APPROVAL_FAILURE:"create-approval-failure",TOGGLE_OPEN_AUTOMATIONS:"toggle-open-automations",UPDATE_SHARING_TASKS:"update-sharing-tasks",DOCSEND_ANALYTICS_LINK_REQUEST:"docsend-analytics-link-request",DOCSEND_ANALYTICS_LINK_SUCCESS:"docsend-analytics-link-success",DOCSEND_ANALYTICS_LINK_FAILURE:"docsend-analytics-link-failure"}),t.SharingActionTypes=(0,s.withActionNamespace)("sharing-actions",{CLEAR_EVERYTHING:"clear-everything",FETCH_METADATA_BATCH_ATTEMPT:"fetch-metadata-batch-attempt",FETCH_METADATA_BATCH_SUCCESS:"fetch-metadata-batch-success",FETCH_METADATA_BATCH_FAIL:"fetch-metadata-batch-fail"})})),define("metaserver/static/js/sharing/actions/sharing_actions",["require","exports","metaserver/static/js/flux/dispatcher","metaserver/static/js/sharing/action_types","metaserver/static/js/sharing/api/client","typescript/component_libraries/spectrum-sharing/src/utils/sharing_constants","metaserver/static/js/sharing/share_page/action_types","metaserver/static/js/sharing/stores/sharing_info","metaserver/static/js/core/assert","metaserver/static/js/pass/action_timestamps","metaserver/static/js/pass/constants"],(function(e,t,s,r,a,n,i,o,c,l,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SharingActions=void 0,t.SharingActions={loadFileMetadataBatch:(e,t)=>new a.FileShareApiClient({userId:e.id}).getMetadataBatchAlpha({contentIds:t,actions:Object.keys(n.ALPHA_FILE_METADATA_PERMISSIONS)}).then(t=>s.Dispatcher.dispatch({type:r.SharingActionTypes.FETCH_METADATA_BATCH_SUCCESS,user:e,data:t})),loadFileMetadata:({user:e,contentId:t,sourceUrl:c,client:l})=>{const d=o.sharingInfoStore.getSharingInfo(e.id,t);if(d&&d.fetchingMetadataPromise())return d.fetchingMetadataPromise();const _=(l=l||new a.FileShareApiClient({userId:e.id})).getMetadataAlpha({contentId:t,actions:Object.keys(n.ALPHA_FILE_METADATA_PERMISSIONS),sourceURL:c}).then(t=>{s.Dispatcher.dispatch({type:r.SharingActionTypes.FETCH_METADATA_BATCH_SUCCESS,user:e,data:[t]}),s.Dispatcher.dispatch({type:i.SharePageActionTypes.FETCH_METADATA_SUCCESS,metadata:t,user:e})});return s.Dispatcher.dispatch({type:r.ShareModalActionTypes.FETCH_METADATA_REQUEST,contentIds:[t],data:{promise:_},user:e}),_},listMembers:({user:e,contentId:t,isFolder:n,limit:i,url:_,members:E,client:u,includeSeenState:h=!0,passSessionId:m,isNonUserRelativeContext:S=!1})=>{(0,c.assert)(!i||i<=100,"listMembers not implemented for limit > 100");const p=i||9999999,A=o.sharingInfoStore.getSharingInfo(e.id,t);if(A){const e=A.fetchingMembersRequest();if(e&&p<=e.limitNonNull)return e.promise;if(A.hasDisplayableMembers()&&p<A.members().getMemberCount())return Promise.resolve({})}const T=Math.random().toString(),g=!n;u||(u=n?new a.FolderShareApiClient({userId:e.id,isNonUserRelativeContext:S}):new a.FileShareApiClient({userId:e.id,isNonUserRelativeContext:S}));const f=a=>a?(s.Dispatcher.dispatch({type:r.ShareModalActionTypes.FETCH_USER_ACCOUNTS_CONTINUED_REQUEST,contentIds:[t],user:e}),u.listMembersContinue({cursor:a,url:_,isAlpha:g}).then(a=>{s.Dispatcher.dispatch({type:r.ShareModalActionTypes.FETCH_USER_ACCOUNTS_CONTINUED_SUCCESS,contentIds:[t],data:{members:a,requestId:T},user:e}),f(a.cursor)})):Promise.resolve({});let M;return m&&l.ActionTimestampsTracker.record(d.LoggingActions.LIST_MEMBERS_BEGIN,m),M=E?Promise.resolve(E):u.listMembers({contentId:t,url:_,limit:i,isAlpha:g,includeSeenState:h}),M=M.then(a=>{m&&l.ActionTimestampsTracker.record(d.LoggingActions.LIST_MEMBERS_RECEIVE,m),s.Dispatcher.dispatch({type:r.ShareModalActionTypes.FETCH_USER_ACCOUNTS_SUCCESS,contentIds:[t],data:{members:a,requestId:T},user:e}),i||f(a.cursor)}),s.Dispatcher.dispatch({type:r.ShareModalActionTypes.FETCH_USER_ACCOUNTS_REQUEST,contentIds:[t],data:{limitNonNull:p,requestId:T,promise:M},user:e}),M},fetchFileMemberCount:({user:e,contentId:t,limit:n,url:i,client:o,countGroupsAsMembers:c=!1,passSessionId:_,runViewerInfoChecks:E=!1})=>{o=o||new a.FileShareApiClient({userId:e.id}),_&&l.ActionTimestampsTracker.record(d.LoggingActions.MEMBER_COUNTS_BEGIN,_);const u=o.getMemberCounts({contentId:t,limit:n,url:i,countGroupsAsMembers:c,runViewerInfoChecks:E});return s.Dispatcher.dispatch({type:r.ShareModalActionTypes.FETCH_FILE_MEMBER_COUNT_REQUEST,contentIds:[t],user:e}),u.then(a=>{_&&l.ActionTimestampsTracker.record(d.LoggingActions.MEMBER_COUNTS_RECEIVE,_),s.Dispatcher.dispatch({type:r.ShareModalActionTypes.FETCH_FILE_MEMBER_COUNT_SUCCESS,contentIds:[t],data:a,user:e})})},fetchFolderMemberCount:({user:e,contentId:t,client:a})=>(s.Dispatcher.dispatch({type:r.ShareModalActionTypes.FETCH_MEMBER_COUNTS_REQUEST,data:{},contentIds:[t],user:e}),a.getMemberCounts({contentId:t}).then(a=>{s.Dispatcher.dispatch({type:r.ShareModalActionTypes.FETCH_MEMBER_COUNTS_SUCCESS,data:{memberCounts:a},contentIds:[t],user:e})}))}})),define("metaserver/static/js/sharing/clean/util/guards",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isEither=t.isBoth=t.isObjectOf=t.isArrayOf=t.isObject=t.isArray=t.isUndefined=t.isNull=t.isNumber=t.isString=t.isBoolean=t.isExactly=t.isUnknown=void 0;t.isUnknown=e=>!0;t.isExactly=e=>t=>t===e;t.isBoolean=e=>"boolean"==typeof e;t.isString=e=>"string"==typeof e;t.isNumber=e=>"number"==typeof e;t.isNull=e=>null===e;t.isUndefined=e=>void 0===e;t.isArray=e=>Array.isArray(e);t.isObject=e=>!(0,t.isNull)(e)&&!(0,t.isArray)(e)&&"object"==typeof e;t.isArrayOf=e=>s=>(0,t.isArray)(s)&&s.every(e);t.isObjectOf=e=>s=>(0,t.isObject)(s)&&Object.entries(e).every(([e,t])=>t(s[e]));t.isBoth=(e,t)=>s=>e(s)&&t(s);t.isEither=(e,t)=>s=>e(s)||t(s)})),define("metaserver/static/js/sharing/content_info",["require","exports","tslib","immutable"],(function(e,t,s,r){"use strict";function a(e){const t=(e.isFolder?e.targetNsId:e.fileId)||e.fqPath;if(null===t)throw new Error("Not enough fields provided for extras");return t}Object.defineProperty(t,"__esModule",{value:!0}),t.ContentInfoExtras=t.ContentInfo=void 0,r=s.__importStar(r);class n extends(r.Record({extras:null,id:null},"ContentInfo")){static createFromParams(e){const t=new i(e);return new n({extras:t,id:a(t)})}setNsId(e){const t=this.setIn(["extras","targetNsId"],e);return t.set("id",a(t.extras))}setFQPath(e){const t=this.setIn(["extras","fqPath"],e);return t.set("id",a(t.extras))}isFolder(){return this.extras.isFolder}isFile(){return!this.isFolder()}isFileFolder(){return this.isFolder()&&!this.isSharedFolder()}isSharedFolder(){return Boolean(this.extras.targetNsId)}isTeamSharedFolder(){return this.extras.isTeamSharedFolder}isFolderInsideTeamFolderTree(){return this.extras.isFolderInsideTeamFolderTree}isInSharedFolder(){return Boolean(this.extras.nsId&&this.extras.nsId!==this.extras.userHomeNs)}isNestedSharedFolder(){return this.isInSharedFolder()&&this.isSharedFolder()}isMounted(){return!this.extras.url}url(){return this.extras.url}pathExists(){return Boolean(this.extras.exists)}name(){return this.displayPath()?this.displayPath().split("/").pop():this.filename()}idForLink(){const e=this.extras.fileId||this.extras.fqPath;if(!e)throw new Error("No identifiers for getting links");return e}sharedFolderId(){const e=this.extras.targetNsId;if(!e)throw new Error("No shared folder ID");return e}displayPath(){return this.extras.fqPath}fileId(){return this.extras.fileId}filename(){return this.extras.filename}nsId(){if(!this.extras.nsId)throw new Error("Can't determine nsId");return this.extras.nsId}nsPath(){if(null===this.extras.nsPath)throw new Error("Can't determine nsPath");return this.extras.nsPath}sjid(){return this.extras.sjid}teamGroupInfo(){return this.extras&&this.extras.teamGroupInfo}}t.ContentInfo=n;class i extends(r.Record({exists:!0,fileId:null,filename:null,fqPath:null,isFolder:null,isTeamSharedFolder:!1,isFolderInsideTeamFolderTree:!1,modalSessionId:null,nsId:null,nsPath:null,origin:null,sjid:null,targetNsId:null,url:null,userHomeNs:null,teamGroupInfo:null},"ContentInfoExtras")){}t.ContentInfoExtras=i})),define("metaserver/static/js/sharing/gating_util",["require","exports","metaserver/static/js/modules/constants/sharing"],(function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isUserNoCommentEnabled=t.GoldenGate=void 0,t.GoldenGate={hasNewOwnershipModel:e=>Boolean(s.GOLDEN_GATE.HAS_NEW_OWNERSHIP_MODEL[e]),hasContentManagerAndSuperAdmin:e=>Boolean(s.GOLDEN_GATE.HAS_CONTENT_MANAGER_AND_SUPER_ADMIN[e]),hasContentManagerCdm:e=>Boolean(s.GOLDEN_GATE.HAS_CONTENT_MANAGER_CDM[e]),hasContentManagerFolderRestore:e=>Boolean(s.GOLDEN_GATE.CAN_RESTORE_FOLDERS_IN_CM[e]),SHARING_TOTAL_LIMIT:s.GOLDEN_GATE.SHARING_TOTAL_LIMIT},t.isUserNoCommentEnabled=function(e){return s.TRUELINK.NO_COMMENT_ENABLED&&!!(null!=e?s.TRUELINK.NO_COMMENT_ENABLED[e.id]:void 0)}})),define("metaserver/static/js/sharing/share_modal/store/modal_info/reducer",["require","exports","tslib","immutable","metaserver/static/js/sharing/content_info","metaserver/static/js/cloud_docs/constants","metaserver/static/js/sharing/action_types","metaserver/static/js/sharing/views/constants","metaserver/static/js/sharing/access_level"],(function(e,t,s,r,a,n,i,o,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.modalInfoReducer=t.initialModalInfoState=void 0,r=s.__importStar(r),t.initialModalInfoState={canRelinquishMembership:!1,contentInfo:a.ContentInfo.createFromParams({fqPath:"",isFolder:!1}),contentNameInputValue:"",contentNameMessageLevel:o.CONTENT_NAME_MESSAGE_LEVELS.INFO,initialProps:{},initialRecipientTokens:[],isContentNameFocused:!1,pendingMemberAction:r.Set(),recipientMessage:"",recipientRawInput:"",recipientTokens:[],recipientValidation:{},referrer:"",shareAsConfidential:!1,uiMode:o.MODES.MEMBERSHIP,fetchMetadataStatus:o.FETCH_METADATA_STATUS.FETCHING,sendApproval:!1,needsAllApprovers:!0,creatingApprovalRequest:!1,automationOptionChecked:!1,sharingTasks:["save_copy"],docsendAnalyticsLink:{status:"initial"}};function l(e,t){return t.shared_folder_id?e.setNsId(t.shared_folder_id):e}t.modalInfoReducer=(e,s)=>{const r=s.payload;switch(s.type){case i.ShareModalActionTypes.CHANGE_CREATE_COMMENT_CHECKBOX:return Object.assign(Object.assign({},e),{isShareMessageAsCommentExplicitlyChecked:r.checked});case i.ShareModalActionTypes.CHANGE_RECIPIENTS:{const t=r.recipientTokens,s=r.recipientRawInput;let a=e.uiMode;return t.length>0||s.length>0?a===o.MODES.MEMBERSHIP&&(a=o.MODES.SHARE):a===o.MODES.SHARE&&(a=o.MODES.MEMBERSHIP),Object.assign(Object.assign({},e),{recipientTokens:t,recipientRawInput:s,uiMode:a})}case i.ShareModalActionTypes.CHANGE_RECIPIENT_ACCESS:return Object.assign(Object.assign({},e),{recipientAccess:r.newAccess});case i.ShareModalActionTypes.CHANGE_RECIPIENT_MESSAGE:return Object.assign(Object.assign({},e),{recipientMessage:r.message});case i.ShareModalActionTypes.APPEND_TO_RECIPIENT_MESSAGE:const s=e.recipientMessage,a=r.messageToAppend;return Object.assign(Object.assign({},e),{recipientMessage:0===s.length?a:s+"\n"+a});case i.ShareModalActionTypes.UPDATE_RECIPIENT_VALIDATION:const d=r.recipientValidation,_=r.resetCurrentValidations?{}:e.recipientValidation,E={};return c.ACCESS_VALUES.forEach(e=>{const t=_[e]||{},s=d[e]||{};E[e]=Object.assign(Object.assign({},t),s)}),Object.assign(Object.assign({},e),{recipientValidation:E});case i.ShareModalActionTypes.FETCH_METADATA_FAILURE:return Object.assign(Object.assign({},e),{uiMode:o.MODES.LINK_ONLY,linkOnlyReason:e.linkOnlyReason!==o.LINK_ONLY_REASON.LINKS_PAGE?r.reason:e.linkOnlyReason,fetchMetadataStatus:o.FETCH_METADATA_STATUS.FAIL,countsExceedNsLimit:r.countExceedNsLimit});case i.ShareModalActionTypes.FETCH_METADATA_SUCCESS:{const t=r.metadata,s=t.path_lower&&(0,n.isPointerByExtension)(t.path_lower)?o.MODES.POINTER:e.uiMode;return Object.assign(Object.assign({},e),{uiMode:s,contentInfo:l(e.contentInfo,t),fetchMetadataStatus:o.FETCH_METADATA_STATUS.SUCCESS})}case i.ShareModalActionTypes.HANDLE_CONTENT_NAME_CHANGE:return Object.assign(Object.assign({},e),{contentNameInputValue:r.name,contentNameMessageLevel:o.CONTENT_NAME_MESSAGE_LEVELS.INFO,contentNameMessage:""===r.name?o.CONTENT_NAME_EMPTY_TOOLTIP:void 0});case i.ShareModalActionTypes.HANDLE_CONTENT_NAME_FOCUS_CHANGE:return Object.assign(Object.assign({},e),{isContentNameFocused:r.focus});case i.ShareModalActionTypes.MEMBER_ACTION_COMPLETE:return Object.assign(Object.assign({},e),{pendingMemberAction:e.pendingMemberAction.delete(r.member.memberKey())});case i.ShareModalActionTypes.MEMBER_ACTION_PENDING:return Object.assign(Object.assign({},e),{pendingMemberAction:e.pendingMemberAction.add(r.member.memberKey())});case i.ShareModalActionTypes.REMOVE_MEMBER_KEEP_ACCESS:case i.ShareModalActionTypes.REMOVE_MEMBER_SUCCESS:return Object.assign(Object.assign({},e),{pendingMemberAction:e.pendingMemberAction.delete(r.member.memberKey())});case i.ShareModalActionTypes.SEND_SHARE_FAILURE:return Object.assign(Object.assign({},e),{uiMode:o.MODES.SHARE});case i.ShareModalActionTypes.SEND_SHARE_REQUEST:return Object.assign(Object.assign({},e),{uiMode:o.MODES.SHARE_SENDING});case i.ShareModalActionTypes.SEND_SHARE_SUCCESS:return Object.assign(Object.assign({},e),{uiMode:o.MODES.SHARE});case i.ShareModalActionTypes.SHARE_FOLDER_SUCCESS:return Object.assign(Object.assign({},e),{contentInfo:l(e.contentInfo,r.metadata)});case i.ShareModalActionTypes.SHARE_MODAL_OPEN:{const s=r.shareModalInfoAttrs.contentInfo,a=r.shareModalInfoAttrs.inLinksPage,i=s.isFolder()&&!s.pathExists(),c=i&&!r.initialProps.initialContentName;let l,d=t.initialModalInfoState.uiMode;return(0,n.isPointerByExtension)(s.displayPath()||"")?d=o.MODES.POINTER:i?d=o.MODES.SHARE:a&&(d=o.MODES.LINK_ONLY,l=o.LINK_ONLY_REASON.LINKS_PAGE),Object.assign(Object.assign({},e),{contentInfo:s,linkOnlyReason:l,uiMode:d,contentNameInputValue:r.initialProps.initialContentName,contentNameMessage:c?o.CONTENT_NAME_EMPTY_TOOLTIP:"",initialProps:r.initialProps,initialRecipientTokens:r.shareModalInfoAttrs.initialRecipientTokens||[],isContentNameFocused:c,onCreateGroupCallback:r.initialProps.onCreateGroupCallback,recipientAccess:void 0,recipientMessage:r.initialProps.recipientMessage||"",recipientTokens:[],recipientValidation:{},referrer:r.initialProps.referrer,experiments:r.initialProps.experiments,sendApproval:!1,needsAllApprovers:!0,creatingApprovalRequest:!1,automationOptionChecked:r.initialProps.automationOptionChecked||!1})}case i.ShareModalActionTypes.SHARE_MODAL_CLOSE:return Object.assign(Object.assign({},e),{initialRecipientTokens:r.tokens||e.initialRecipientTokens||[]});case i.ShareModalActionTypes.VALIDATE_CONTENT_NAME_ERROR:return Object.assign(Object.assign({},e),{contentNameMessage:r.errorMsg,contentNameMessageLevel:o.CONTENT_NAME_MESSAGE_LEVELS.ERROR});case i.ShareModalActionTypes.VALIDATE_CONTENT_NAME_SUCCESS:return Object.assign(Object.assign({},e),{contentInfo:e.contentInfo.setFQPath(r.newFolderPath)});case i.ShareModalActionTypes.TOGGLE_SEND_APPROVAL:return Object.assign(Object.assign({},e),{sendApproval:!e.sendApproval});case i.ShareModalActionTypes.CHANGE_NEEDS_ALL_APPROVERS:return Object.assign(Object.assign({},e),{needsAllApprovers:r.needsAllApprovers});case i.ShareModalActionTypes.CREATE_APPROVAL_REQUEST:return Object.assign(Object.assign({},e),{creatingApprovalRequest:!0});case i.ShareModalActionTypes.CREATE_APPROVAL_SUCCESS:case i.ShareModalActionTypes.CREATE_APPROVAL_FAILURE:return Object.assign(Object.assign({},e),{creatingApprovalRequest:!1});case i.ShareModalActionTypes.TOGGLE_OPEN_AUTOMATIONS:return Object.assign(Object.assign({},e),{automationOptionChecked:!e.automationOptionChecked});case i.ShareModalActionTypes.UPDATE_SHARING_TASKS:return Object.assign(Object.assign({},e),{sharingTasks:r.sharingTasks});case i.ShareModalActionTypes.DOCSEND_ANALYTICS_LINK_REQUEST:return Object.assign(Object.assign({},e),{docsendAnalyticsLink:{status:"loading"}});case i.ShareModalActionTypes.DOCSEND_ANALYTICS_LINK_SUCCESS:return Object.assign(Object.assign({},e),{docsendAnalyticsLink:{status:"ready",linkData:r.linkData}});case i.ShareModalActionTypes.DOCSEND_ANALYTICS_LINK_FAILURE:return Object.assign(Object.assign({},e),{docsendAnalyticsLink:{status:"error"}});default:return e}}})),define("metaserver/static/js/sharing/share_modal/store/sharing_info/reducer",["require","exports","metaserver/static/js/sharing/action_types","metaserver/static/js/sharing/api/types/metadata"],(function(e,t,s,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.sharingInfoReducer=t.initialSharingInfoState=void 0,t.initialSharingInfoState={areMembersFullyLoaded:!1,areSharingPrefsLoaded:!1,hasDisplayableMembers:!1,isLinkMetadataLoaded:!1,isCurrentAccountLoaded:!1,shouldBlockMemberListOnPassLoad:!0,memberCounts:new r.MemberCounts,members:new r.SharingMembership,sharingPrefs:new r.SharingPrefs,sharedLinks:[],selectedAudienceByAccessLevel:{}};function a(e,t){const s=e.metadata,r=t.permissions||s&&s.permissions;return t.set("permissions",r)}t.sharingInfoReducer=(e=t.initialSharingInfoState,n)=>{const i=n.payload;switch(n.type){case s.ShareModalActionTypes.CHANGE_MEMBER_ACCESS_FAILURE:return Object.assign(Object.assign({},e),{members:e.members.setIn([i.member.type(),i.member.memberKey(),"access_type"],i.prevAccess)});case s.ShareModalActionTypes.CHANGE_MEMBER_ACCESS_REQUEST:return Object.assign(Object.assign({},e),{members:e.members.setIn([i.member.type(),i.member.memberKey(),"access_type"],i.newAccess)});case s.ShareModalActionTypes.CLEAR_FILE_MEMBERSHIP_LAST_SEEN_INFO:return Object.assign(Object.assign({},e),{members:e.members.update("users",e=>e.map(e=>e.set("time_last_seen",null)))});case s.ShareModalActionTypes.CREATE_LINK_SUCCESS:return Object.assign(Object.assign({},e),{hasCreatedLink:!0,linkMetadata:i.linkMetadata,sharedLinks:e.sharedLinks.concat(i.linkMetadata)});case s.ShareModalActionTypes.FETCH_MEMBER_COUNTS_SUCCESS:return Object.assign(Object.assign({},e),{memberCounts:i.memberCounts});case s.ShareModalActionTypes.FETCH_METADATA_FAILURE:return Object.assign(Object.assign({},e),{fetchingMetadataPromise:void 0});case s.ShareModalActionTypes.FETCH_METADATA_REQUEST:return Object.assign(Object.assign({},e),{fetchingMetadataPromise:i.promise});case s.ShareModalActionTypes.FETCH_METADATA_SUCCESS:return Object.assign(Object.assign({},e),{metadata:a(e,i.metadata),fetchingMetadataPromise:void 0});case s.ShareModalActionTypes.FETCH_SHARING_PREFS_REQUEST:return Object.assign({},e);case s.ShareModalActionTypes.FETCH_SHARING_PREFS_SUCCESS:return Object.assign(Object.assign({},e),{areSharingPrefsLoaded:!0,sharingPrefs:i.sharingPrefs});case s.ShareModalActionTypes.FETCH_LINK_METADATA_FAILURE:return Object.assign(Object.assign({},e),{isLinkMetadataLoaded:!0,linkMetadata:void 0,sharedLinks:[]});case s.ShareModalActionTypes.FETCH_LINK_METADATA_SUCCESS:return Object.assign(Object.assign({},e),{isLinkMetadataLoaded:!0,linkMetadata:i.sharedLinks.length>0?i.sharedLinks[0]:null,sharedLinks:i.sharedLinks,selectedAudienceByAccessLevel:{}});case s.ShareModalActionTypes.DELETE_LINK_METADATA_SUCCESS:{const t=[];for(const s of e.sharedLinks)s.url!==i.deletedLink.url&&t.push(s);return Object.assign(Object.assign({},e),{hasCreatedLink:!1,hasIncrementedUpsellCounter:!1,linkMetadata:t[0]?t[0]:null,sharedLinks:t})}case s.ShareModalActionTypes.FETCH_USER_ACCOUNTS_REQUEST:return Object.assign(Object.assign({},e),{fetchingMembersRequest:{limitNonNull:i.limitNonNull,promise:i.promise,requestId:i.requestId}});case s.ShareModalActionTypes.FETCH_USER_ACCOUNTS_SUCCESS:return e.fetchingMembersRequest&&e.fetchingMembersRequest.requestId!==i.requestId?e:e.hasDisplayableMembers&&e.fetchingMembersRequest&&e.fetchingMembersRequest.limitNonNull<e.members.getMemberCount()?e:Object.assign(Object.assign({},e),{hasDisplayableMembers:!0,areMembersFullyLoaded:!i.members.cursor,fetchingMembersRequest:i.members.cursor?e.fetchingMembersRequest:void 0,members:i.members});case s.ShareModalActionTypes.FETCH_USER_ACCOUNTS_CONTINUED_SUCCESS:return e.fetchingMembersRequest&&e.fetchingMembersRequest.requestId!==i.requestId?e:Object.assign(Object.assign({},e),{areMembersFullyLoaded:!i.members.cursor,fetchingMembersRequest:i.members.cursor?e.fetchingMembersRequest:void 0,members:e.members.mergeDeep(i.members)});case s.ShareModalActionTypes.FETCH_CURRENT_ACCOUNT_REQUEST:return Object.assign(Object.assign({},e),{isCurrentAccountLoaded:!1});case s.ShareModalActionTypes.FETCH_CURRENT_ACCOUNT_SUCCESS:return Object.assign(Object.assign({},e),{isCurrentAccountLoaded:!0,isFamilyUser:i.isFamilyUser,teamPolicy:i.teamPolicy});case s.ShareModalActionTypes.FETCH_FILE_MEMBER_COUNT_SUCCESS:return Object.assign(Object.assign({},e),{memberCounts:new r.MemberCounts({total_unique_users:i.count,users_outside_team:0,exceeds_count:i.exceeds_limit})});case s.ShareModalActionTypes.REMOVE_MEMBER_KEEP_ACCESS:return Object.assign(Object.assign({},e),{members:e.members.setIn([i.member.type(),i.member.memberKey(),"access_type"],i.access)});case s.ShareModalActionTypes.REMOVE_MEMBER_SUCCESS:return Object.assign(Object.assign({},e),{members:e.members.deleteIn([i.member.type(),i.member.memberKey()])});case s.ShareModalActionTypes.SHARE_FOLDER_FAILURE:return Object.assign(Object.assign({},e),{shareFolderPromise:void 0});case s.ShareModalActionTypes.SHARE_FOLDER_REQUEST:return Object.assign(Object.assign({},e),{shareFolderPromise:i.promise});case s.ShareModalActionTypes.SHARE_FOLDER_SUCCESS:return Object.assign(Object.assign({},e),{metadata:a(e,i.metadata),shareFolderPromise:i.promise});case s.ShareModalActionTypes.TRANSFER_OWNER_SUCCESS:return Object.assign(Object.assign({},e),{metadata:void 0,isLinkMetadataLoaded:!1,hasDisplayableMembers:!1});case s.ShareModalActionTypes.UNBLOCK_MEMBER_LIST_ON_PASS_LOAD:return Object.assign(Object.assign({},e),{shouldBlockMemberListOnPassLoad:!1});case s.ShareModalActionTypes.UPDATE_SHARING_SETTINGS_SUCCESS:return Object.assign(Object.assign({},e),{metadata:a(e,i.metadata)});case s.ShareModalActionTypes.SET_UPSELL_COUNTER_PREF_SUCCESS:return Object.assign(Object.assign({},e),{hasIncrementedUpsellCounter:!0});case s.ShareModalActionTypes.CHANGE_LINK_AUDIENCE_SELECTION:const t=e.selectedAudienceByAccessLevel;return t[i.accessLevel]=i.audience,Object.assign(Object.assign({},e),{selectedAudienceByAccessLevel:t});case s.ShareModalActionTypes.REMOVE_LINK_AUDIENCE_SELECTION:if(e.selectedAudienceByAccessLevel){const t=Object.keys(e.selectedAudienceByAccessLevel).reduce((t,s)=>(e.selectedAudienceByAccessLevel&&s!==i.accessLevel&&(t[s]=e.selectedAudienceByAccessLevel[s]),t),{});return Object.assign(Object.assign({},e),{selectedAudienceByAccessLevel:t})}return e;case s.ShareModalActionTypes.SHARE_MODAL_OPEN:return Object.assign(Object.assign({},e),{selectedAudienceByAccessLevel:{}});default:return e}}})),define("metaserver/static/js/sharing/share_page/action_types",["require","exports","metaserver/static/js/flux/action_type"],(function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SharePageActionTypes=void 0;const r=(0,s.withActionNamespace)("share-page",{INITIALIZE:"initialize-store",EMAIL_UNVERIFIED:"email-unverified",RECENT_TAB_EMAIL_UNVERIFIED:"recent-tab-email-unverified",SWITCH_TAB:"switch-tab",SWITCH_ROLE:"switch-role",SWITCH_USER:"switch-user",LOAD_PRE_FOLDER_DATA_REQUEST:"load-pre-folder-data-request",LOAD_PRE_FOLDER_DATA_SUCCESS:"load-pre-folder-data-success",LOAD_PRE_FOLDER_DATA_ERROR:"load-pre-folder-data-error",LOAD_FOLDER_DATA_REQUEST:"load-folder-data-request",LOAD_FOLDER_DATA_SUCCESS:"load-folder-data-success",LOAD_FOLDER_DATA_ERROR:"load-folder-data-error",LOAD_PRE_FILE_DATA_REQUEST:"load-pre-file-data-request",LOAD_PRE_FILE_DATA_SUCCESS:"load-pre-file-data-success",LOAD_PRE_FILE_DATA_ERROR:"load-pre-file-data-error",LOAD_FILE_DATA_REQUEST:"load-file-data-request",LOAD_FILE_DATA_SUCCESS:"load-file-data-success",LOAD_FILE_DATA_ERROR:"load-file-data-error",MOUNT_FOLDER_REQUEST:"mount-folder-request",MOUNT_FOLDER_SUCCESS:"mount-folder-success",MOUNT_FOLDER_ERROR:"mount-folder-error",UNMOUNT_FOLDER_REQUEST:"unmount-folder-request",UNMOUNT_FOLDER_SUCCESS:"unmount-folder-success",UNMOUNT_FOLDER_ERROR:"unmount-folder-error",UNSHARE_FOLDER_REQUEST:"unshare-folder-request",UNSHARE_FOLDER_SUCCESS:"unshare-folder-success",UNSHARE_FOLDER_ERROR:"unshare-folder-error",FETCH_TEAM_POLICY_REQUEST:"fetch-team-policy-request",FETCH_TEAM_POLICY_SUCCESS:"fetch-team-policy-success",FETCH_TEAM_POLICY_ERROR:"fetch-team-policy-error",FETCH_FOLDER_POLICY_SUCCESS:"fetch-folder-policy-success",FETCH_METADATA_SUCCESS:"fetch-metadata-success",RELINQUISH_FOLDER_MEMBERSHIP_REQUEST:"relinquish-folder-membership-request",RELINQUISH_FOLDER_MEMBERSHIP_SUCCESS:"relinquish-folder-membership-success",RELINQUISH_FOLDER_MEMBERSHIP_ERROR:"relinquish-folder-membership-error",RELINQUISH_FILE_MEMBERSHIP_REQUEST:"relinquish-file-membership-request",RELINQUISH_FILE_MEMBERSHIP_SUCCESS:"relinquish-file-membership-success",RELINQUISH_FILE_MEMBERSHIP_ERROR:"relinquish-file-membership-error"});t.SharePageActionTypes=r})),define("metaserver/static/js/sharing/stores/sharing_info",["require","exports","tslib","metaserver/static/js/modules/constants/python","metaserver/static/js/flux/base_store","metaserver/static/js/sharing/action_types","metaserver/static/js/sharing/api/types/metadata","metaserver/static/js/sharing/share_modal/store/modal_info/reducer","metaserver/static/js/sharing/share_modal/store/sharing_info/reducer","metaserver/static/js/sharing/access_level","metaserver/static/js/sharing/stores/sharing_info_util","metaserver/static/js/sharing/ui_util","metaserver/static/js/user_survey/user_survey","metaserver/static/js/core/assert","lodash"],(function(e,t,s,r,a,n,i,o,c,l,d,_,E,u,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SharingInfo=t.Permissions=t.sharingInfoStore=void 0,r=s.__importStar(r),h=s.__importStar(h);const m=(e,t)=>((t=String(t)).startsWith("id:")||(t=t.toLowerCase()),`${e}::${t}`);class S extends a.Store{constructor(){super(),this.sharingInfoMap={}}getSharingInfo(e,t){return t?this.sharingInfoMap[m(e,t)]:null}mapContentIdsToSharingInfo(e,t,s){for(const r of t)r&&(this.sharingInfoMap[m(e,r)]=s)}_new_payload(e){if(e&&e.action&&e.action.type)switch(e.action.type){case n.SharingActionTypes.CLEAR_EVERYTHING:this.sharingInfoMap={};break;case n.SharingActionTypes.FETCH_METADATA_BATCH_SUCCESS:{const t=e.action.user;e.action.data.forEach(e=>{this._new_payload_for_single_content(n.ShareModalActionTypes.FETCH_METADATA_SUCCESS,t,(0,d.getContentIdsForMetadata)(e),{metadata:e})}),this.emit_change();break}default:if(!e.action.contentIds)return;this._new_payload_for_single_content(e.action.type,e.action.user,e.action.contentIds,e.action.data),this.emit_change()}}_new_payload_for_single_content(e,t,s,r){let a;(0,u.assert)(Boolean(t.id),"valid user needed"),(0,u.assert)(s.length>0,"contentIds cannot be empty");for(const e of s){const s=m(t.id,e);if(s in this.sharingInfoMap){a=this.sharingInfoMap[s];break}}a||(a=new A(t));const n={type:e,payload:r,user:t};return a.setState((0,o.modalInfoReducer)(a.modalInfoState(),n),(0,c.sharingInfoReducer)(a.sharingInfoState(),n)),s.push(a.fqPath()),this.mapContentIdsToSharingInfo(t.id,s,a),a}}t.sharingInfoStore=new S;class p{constructor(e){this.change_options=h.get(e,"change_options.allow",!1),this.edit_contents=h.get(e,"edit_contents.allow",!1),this.invite_editor=h.get(e,"invite_editor.allow",!1),this.invite_viewer=h.get(e,"invite_viewer.allow",!1),this.relinquish_membership=h.get(e,"relinquish_membership.allow",!1),this.leave_a_copy=h.get(e,"leave_a_copy.allow",!1),this.create_edit_link=h.get(e,"create_edit_link.allow"),this.create_view_link=h.get(e,"create_view_link.allow",!1),this.unshare=h.get(e,"unshare.allow",!1),this.update_confidentiality=h.get(e,"update_confidentiality.allow",!1),this.is_file_permissions=e instanceof i.FilePermissions,this.share_message_as_comment=h.get(e,"share_message_as_comment.allow",!1)}canChangeOptions(){return this.change_options}canEdit(){return this.edit_contents}canInviteEditor(){return this.invite_editor}canInviteViewer(){return this.invite_viewer}canInvite(){return this.canInviteViewer()||this.canInviteEditor()}canRelinquishMembership(){return this.relinquish_membership}canCreateEditLink(){return this.is_file_permissions&&this.create_edit_link}canCreateViewLink(){return this.is_file_permissions&&this.create_view_link}canUnshare(){return this.unshare}canUpdateConfidentiality(){return this.update_confidentiality}canLeaveACopy(){return this.leave_a_copy}canShareMessageAsComment(){return this.share_message_as_comment}}t.Permissions=p;class A{constructor(e){this._user=e,this.setState(o.initialModalInfoState,c.initialSharingInfoState)}setState(e,s){this._modalInfo=e,this._sharingInfoState=s,s.metadata&&t.sharingInfoStore.mapContentIdsToSharingInfo(this._user.id,(0,d.getContentIdsForMetadata)(s.metadata),this)}sharingInfoState(){return this._sharingInfoState}modalInfoState(){return this._modalInfo}user(){return this._user}hasDirectMemberSelf(){const e=this.members();if(e&&1===e.users.count()){return e.users.first().account_id===this._user.account_id}return!1}hasNonSelfMembers(){const e=this.members(),t=e&&e.getMemberCount();if(!t)return!1;if(1===t&&1===e.users.count()){return e.users.first().account_id!==this._user.account_id}return!0}hasNonOwnerMembers(){return this.hasNonSelfMembers()&&this.isOwner()}hasOutsideTeamMembers(){const e=this.memberCounts();return(e?e.users_outside_team:0)>0}memberNum(){const e=this.memberCounts(),t=this.members();return e&&e.total_unique_users?e.total_unique_users:t?t.getMemberCount():void 0}memberCountWithRecipients(){return(this.memberNum()||0)+(0,_.getMemberCountForTokens)(this.recipientTokens())}getInitialProps(){return this.modalInfoState().initialProps}areMembersFullyLoaded(){return this.sharingInfoState().areMembersFullyLoaded}areSharingPrefsLoaded(){return this.sharingInfoState().areSharingPrefsLoaded}sharingPrefs(){return this.sharingInfoState().sharingPrefs}canShareLink(){return!this.isConfidentialFolder()&&!this.isTeamSharedFolder()&&this.contentInfo().pathExists()&&this.contentInfo().isMounted()}canDeleteLink(){const e=this.linkMetadata();return Boolean(e&&e.link_permissions.can_revoke)}contactsError(){return(0,_.validateContacts)(this.recipientTokens(),this._user,this.recipientValidation()[this.recipientAccess()]||{},this.isTeamSharedFolder(),this.isFolderInsideTeamFolderTree(),this.memberCountWithRecipients(),this.recipientAccess(),this.isFolder(),this.sharedLinks())}contentId(){return this.contentInfo().id}contentInfo(){return this.modalInfoState().contentInfo}contentNameInputValue(){return this.modalInfoState().contentNameInputValue}contentNameMessage(){return this.modalInfoState().contentNameMessage}contentNameMessageLevel(){return this.modalInfoState().contentNameMessageLevel}displayPath(){const e=this.metadata();return this.contentInfo().displayPath()||e&&e.path_display||""}parentFolderName(){const e=this.metadata();if(e&&e instanceof i.SharedFileMetadata){const t=e.path_display;if(t){const e=t.split("/");if(e.length>1)return e[e.length-2]}}return e&&e instanceof i.SharedFolderMetadata&&e.parent_folder_name||""}fetchingMembersRequest(){return this.sharingInfoState().fetchingMembersRequest}fetchingMetadataPromise(){return this.sharingInfoState().fetchingMetadataPromise}filePolicy(){const e=this.metadata();return e&&e.file_policy}folderPolicy(){const e=this.metadata();return e&&e.policy}fqPath(){return this.contentInfo().displayPath()}hasDisplayableMembers(){return this.sharingInfoState().hasDisplayableMembers}hasParentSharedFolder(){const e=this.metadata();return!!e&&e.is_inside_team_folder}initialRecipientTokens(){return this.modalInfoState().initialRecipientTokens}isNonUserRelativeContext(){return this.getInitialProps().isInContentManager}isFolder(){return this.contentInfo().isFolder()}isConfidentialFolder(){const e=this.metadata();return Boolean(e&&e.is_confidential)}isContentNameFocused(){return this.modalInfoState().isContentNameFocused}isFolderInsideTeamFolderTree(){const e=this.metadata();return!!e&&e.is_inside_team_folder}isInsideSharedFolder(){const e=this.metadata();return Boolean(e&&e.parent_shared_folder_id||this.contentInfo().isInSharedFolder())}isLinkMetadataLoaded(){return this.sharingInfoState().isLinkMetadataLoaded}isMetadataLoaded(){return Boolean(this.metadata())}isOwner(){const e=this.metadata();return Boolean(e&&e.access_type===l.ACCESS_LEVEL.OWNER)}isOSXPackage(){const e=this.displayPath(),t=e.substr(e.lastIndexOf("."));return r.PACKAGE_EXTS.indexOf(t)>=0}isShareModalUpsellPremiumSharing(){return this.sharingPrefs().in_share_modal_upsell_premium_sharing}shareModalUpsellPremiumSharingVariant(){return this.sharingPrefs().in_share_modal_upsell_premium_sharing_variant}hasSeenUpsellCounter(){return this.sharingPrefs().has_seen_share_modal_upsell_premium_sharing_counter}hasCreatedLink(){return this.sharingInfoState().hasCreatedLink}hasIncrementedUpsellCounter(){return this.sharingInfoState().hasIncrementedUpsellCounter}inviteOrRequestAfterSharingModalVariant(){return this.sharingPrefs().invite_or_request_after_sharing_modal_variant}getExperiments(){return this.modalInfoState().experiments}getExpTeamSpace3OffteamSharingSprigSurvey(){return this.sharingPrefs().team_space_3_offteam_sharing_sprig_survey}hasSeenEsignPostSharing(){return this.sharingPrefs().has_seen_esign_post_sharing}isInEsignPostSharingExclusionPeriod(){return this.sharingPrefs().is_in_esign_post_sharing_exclusion_period}isShowingFileUploadToolkitCampaign(){return this.sharingPrefs().is_showing_file_upload_toolkit_campaign}getReferrer(){return this.modalInfoState().referrer}isUserOnOwnerTeam(){const e=this.metadata();return Boolean(e&&e.owner_team&&e.owner_team.id===this._user.team_dbtid)}isCurrentAccountLoaded(){return this.sharingInfoState().isCurrentAccountLoaded}isTeamSharedFolder(){const e=this.metadata();return Boolean(e&&e.is_team_folder||this.contentInfo().isTeamSharedFolder())}isTokenizerEmpty(){return 0===this.recipientRawInput().length&&0===this.recipientTokens().length}linkMetadata(){return this.sharingInfoState().linkMetadata}sharedLinks(){return this.sharingInfoState().sharedLinks||[]}shmodelLink(){return this.sharedLinks().filter(e=>!e.isRighteousLink())[0]}editRighteousLink(){return this.sharedLinks().filter(e=>"editor"===e.link_permissions.link_access_level)[0]}viewRighteousLink(){return this.sharedLinks().filter(e=>"viewer"===e.link_permissions.link_access_level)[0]}linkOnlyReason(){return this.modalInfoState().linkOnlyReason}countsExceedNsLimit(){return this.modalInfoState().countsExceedNsLimit}memberCounts(){return this.sharingInfoState().memberCounts}members(){return this.sharingInfoState().members}metadata(){return this.sharingInfoState().metadata}name(){const e=this.contentInfo(),t=this.metadata();return e&&e.name()||t&&t.name||""}ownerTeam(){const e=this.metadata();return e&&e.owner_team}parentSharedFolderId(){const e=this.metadata();return e&&e.parent_shared_folder_id}pendingMemberAction(){return this.modalInfoState().pendingMemberAction}permissionsObj(){return new p(this.permissions())}permissions(){const e=this.metadata();return e&&e.permissions}recipientAccess(){const e=this.modalInfoState();return e.recipientAccess?e.recipientAccess:this.permissionsObj().canInviteEditor()||this.permissionsObj().canCreateEditLink()||this.editRighteousLink()?l.ACCESS_LEVEL.WRITER:l.ACCESS_LEVEL.READER}recipientMessage(){return this.modalInfoState().recipientMessage}onCreateGroupCallback(){return this.modalInfoState().onCreateGroupCallback}recipientRawInput(){return this.modalInfoState().recipientRawInput}recipientTokens(){return this.modalInfoState().recipientTokens}recipientValidation(){return this.modalInfoState().recipientValidation}shareAsConfidential(){return Boolean(this.getInitialProps().shareAsConfidential)}shareFolderPromise(){return this.sharingInfoState().shareFolderPromise}shouldBlockMemberListOnPassLoad(){return this.sharingInfoState().shouldBlockMemberListOnPassLoad}shouldSyncThisFolder(){return this.getInitialProps()?this.getInitialProps().shouldSyncThisFolder:null}teamPolicy(){return this.sharingInfoState().teamPolicy}isFamilyUser(){return this.sharingInfoState().isFamilyUser}uiMode(){return this.modalInfoState().uiMode}isCloudDoc(){const e=this.metadata();return!(!e||!e.is_cloud_doc)}fetchMetadataStatus(){return this.modalInfoState().fetchMetadataStatus}isShareMessageAsCommentChecked(){const e=this.modalInfoState().isShareMessageAsCommentExplicitlyChecked;return void 0===e?this.permissionsObj().canShareMessageAsComment():e}shouldSuppressRedirectToBrowse(){return this.getInitialProps()?this.getInitialProps().shouldSuppressRedirectToBrowse:null}shouldCloseImmediately(){return this.getInitialProps()?this.getInitialProps().shouldCloseImmediately:null}shouldFetchLinkMetadata(){return this.canShareLink()&&!this.isNonUserRelativeContext()&&this.contentInfo().isMounted()}showOffTeamSharingSurvey(e){this.getExpTeamSpace3OffteamSharingSprigSurvey()&&(e||(e=this.contactsError()),(null==e?void 0:e.level)===_.ContactsErrorLevel.Warn&&(null==e?void 0:e.message)===_.CONTACT_ERROR_MESSAGES.GENERAL_OUT_OF_TEAM_MULTIPLE&&E.UserSurvey.trackEvent("attempting_offteam_share","sharing"))}getSelectedAudienceByAccessLevel(e){return this.sharingInfoState().selectedAudienceByAccessLevel[e]}getEligibleInviteAfterSharingContacts(){return(0,d.getEligibleInviteAfterSharingContactsImpl)(this.recipientTokens(),this.recipientValidation())}sendApproval(){return this.modalInfoState().sendApproval}needsAllApprovers(){return this.modalInfoState().needsAllApprovers}creatingApprovalRequest(){return this.modalInfoState().creatingApprovalRequest}automationOptionChecked(){return this.modalInfoState().automationOptionChecked}isExpBsxOrganizeAroundPeopleEnabled(){return this.sharingPrefs().bsx_organize_around_people}getSharingTasks(){return this.modalInfoState().sharingTasks}}t.SharingInfo=A})),define("metaserver/static/js/sharing/stores/sharing_info_util",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getEligibleInviteAfterSharingContactsImpl=t.getContentIdsForContentInfo=t.getContentIdsForMetadata=void 0;t.getContentIdsForMetadata=e=>[e.shared_folder_id,e.id,e.path_lower].filter(e=>!!e);t.getContentIdsForContentInfo=e=>{const t=[];return e.isSharedFolder()?t.push(e.sharedFolderId()):(e.extras.fileId&&t.push(e.extras.fileId),e.extras.nsId&&e.extras.nsPath&&t.push(`ns:${e.nsId()}${e.nsPath()}`)),e.displayPath()&&t.push(e.displayPath()),t};t.getEligibleInviteAfterSharingContactsImpl=(e,t)=>{const s=new Set(e.filter(e=>!e.invalid).map(e=>e.getKey())),r=Object.values(t),a=new Set,n=new Set;for(const e of r)for(const t in e)if(e.hasOwnProperty(t)&&s.has(t)){const s=e[t];if(s&&s.inviteAfterSharingEligibility){const e=s.inviteAfterSharingEligibility[".tag"];"eligible_not_seen"===e?a.add(t):"eligible_seen"===e&&n.add(t)}}return{inviteEligibleNotSeenContacts:e.filter(e=>a.has(e.getKey())&&!e.invalid),inviteEligibleSeenContacts:e.filter(e=>n.has(e.getKey())&&!e.invalid)}}})),define("metaserver/static/js/sharing/ui_util",["require","exports","tslib","react","lodash","metaserver/static/js/clean/analytics","metaserver/static/js/api_v2/error","metaserver/static/js/contacts/contact_token_state","metaserver/static/js/filepath/filepath","metaserver/static/js/clean/filetypes","metaserver/static/js/icon/icon_helper","metaserver/static/js/sharing/api/types/metadata","metaserver/static/js/sharing/gating_util","metaserver/static/js/modules/constants/trademark","metaserver/static/js/core/i18n","metaserver/static/js/core/format_html","metaserver/static/js/user_survey/user_survey","typescript/component_libraries/spectrum-sharing/src/utils/sharing_constants","metaserver/static/js/sharing/clean/util/guards","metaserver/static/js/campaigns/emitter","metaserver/static/js/onboarding/logging/events","typescript/component_libraries/spectrum-sharing/src/share_modal/sharing_settings/utils/sharing_settings_util"],(function(e,t,s,r,a,n,i,o,c,l,d,_,E,u,h,m,S,p,A,T,g,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.publishShopModalEvent=t.getShopModalLoggingParams=t.getShopModalCtx=t.trackSharePageUserLeapEvent=t.trackReceiverUserLeapEvent=t.ReceiverUserLeapEvent=t.trackUserLeapEvent=t.SharingUserLeapEvent=t.validateContacts=t.validateContact=t.namespaceLimitExceededFailCreateSharedFolderSnackbarMsg=t.treeSizeExceededFailSnackbarMsg=t.homeMountsExceededFailSnackbarMsg=t.totalMountsExceededFailSnackbarMsg=t.spectrumFolderIconForMetadata=t.shouldEnforceMemberLimits=t.logTiburonEvent=t.getTreeSizeExceededLinkOnlyMsg=t.getHomeMountsExceededLinkOnlyMsg=t.getTotalMountsExceededLinkOnlyMsg=t.getLinkOnlyTitle=t.getTotalMountsExceededMountFoldersMsg=t.getTreeSizeExceededMountFoldersMsg=t.getHomeMountsExceededMountFoldersMsg=t.getTotalMountsExceededMsg=t.getTreeSizeExceededMsg=t.getNewFolderPathFromContentName=t.getMountLimitInfo=t.getMemberCountForTokens=t.getHomeMountsExceededMsg=t.getExceededCountInfo=t.getContactSupportMessage=t.genAddMemberErrorMessage=t.isTreeSizeExceededError=t.isHomeMountsExceededError=t.isTotalMountsExceededError=t.SHARE_UI_TYPE=t.SharingExperiments=t.makeMemberSortCmp=t.fileIconForMetadata=t.convertIfHTML=t.NSF_HELP_ARTICLE_LINK=t.CONTACT_ERROR_MESSAGES=t.ContactsErrorLevel=void 0,r=s.__importDefault(r),a=s.__importStar(a),A=s.__importStar(A);t.SharingExperiments={};const M={strong:e=>r.default.createElement("strong",null,e),em:e=>r.default.createElement("em",null,e)};t.SHARE_UI_TYPE={SHARED_FILE:"shared-file",SHARED_FOLDER:"shared-folder",SHARED_LINK:"shared-link",PUBLIC:"public",NO_SHARE:"no-share"};const I={SINGLE_INVALID:h.intl.formatMessage({id:"AwwRIX",defaultMessage:"The email address you entered is invalid."}),OUT_OF_TEAM:h.intl.formatMessage({id:"KCd6Mi",defaultMessage:"You can only share with your team and people your admin has approved."}),NOT_DROPBOX_USER:(e,t,s)=>h.intl.formatMessage({id:"vFxlGE",defaultMessage:"{count, plural, one{The person} other{Some people}} you invited will need to create an account to {access_level} the {file_type}. "},{file_type:t?"folder":"file",access_level:"writer"===s?"edit":"view",count:e}),SEND_LINK:h.intl.formatMessage({id:"f8bN8Q",defaultMessage:"Copy and send them a link instead to view without an account."}),SINGLE_TOO_MANY_MEMBERS:h.intl.formatMessage({id:"ZEnulX",defaultMessage:"Can’t share with this many people."}),GENERAL_INVALID:h.intl.formatMessage({id:"85p8vn",defaultMessage:"One or more names or email addresses you entered are invalid."}),GENERAL_OUT_OF_TEAM_MULTIPLE:h.intl.formatMessage({id:"XliECV",defaultMessage:"Some of these emails aren’t on your Dropbox team."}),GENERAL_OUT_OF_TEAM_SINGLE:h.intl.formatMessage({id:"vgnpLP",defaultMessage:"This email isn’t on your Dropbox team."}),GENERAL_TOO_MANY_MEMBERS:h.intl.formatMessage({id:"rTaV0v",defaultMessage:"This will put the folder over its {member_limit}-member limit. <a>Learn more.</a>"},{member_limit:E.GoldenGate.SHARING_TOTAL_LIMIT,a:e=>r.default.createElement("a",{href:"/help/9292",target:"_blank",key:"help_center_article"},e)}),NONGROUP_INVITEE:h.intl.formatMessage({id:"XHbTJ8",defaultMessage:"Only groups can be added to team folders."}),NO_PERMISSION:h.intl.formatMessage({id:"O1327M",defaultMessage:"You don’t have permission to share with this person."}),GENERAL_NO_PERMISSION:h.intl.formatMessage({id:"XDLsmJ",defaultMessage:"You don’t have permission to share with some of these people."})};var C;t.CONTACT_ERROR_MESSAGES=I,(function(e){e.Error="error",e.Warn="warn"})(C||(C={})),t.ContactsErrorLevel=C;t.NSF_HELP_ARTICLE_LINK="https://help.dropbox.com/files-folders/share/shared-folder-faq#cantcreate";const O=(e,t)=>(t.displayName()||"").toLowerCase(),N=Math.pow(2,53)-1;t.makeMemberSortCmp=function(e,t,s){const r=s?(e=>function(t,s){const r=s.memberId()===t,a=s instanceof _.GroupMembershipInfo?"0":"1",n=(s.displayName()||"").toLowerCase(),i=null!=s.account_id&&e.has(s.account_id);return`${a}${i&&r?"a":i?"b":null!=s.time_last_seen?`c${(function(e){let t=String(N-Number(e));const s=String(N).length;return t.length<s&&(t=`${Array(s-t.length+1).join("0")}${t}`),t})(s.time_last_seen)}`:"d"}${n}`})(t):O;return function(t,s){const a=r(e.account_id,t),n=r(e.account_id,s);return a<n?-1:a===n?0:1}};const R=function(e,t,s){return!e.is_cdm_member&&(t||s)};t.shouldEnforceMemberLimits=R;t.validateContact=function(e,t,s,r,a,n,i){let c={state:o.ContactTokenState.ok,msg:null};if(a&&!e.group_id)return{state:o.ContactTokenState.invalid,msg:I.NONGROUP_INVITEE};if(R(t,a,n)&&i>E.GoldenGate.SHARING_TOTAL_LIMIT)return{state:o.ContactTokenState.invalid,msg:I.SINGLE_TOO_MANY_MEMBERS};if(e.invalid)c={state:o.ContactTokenState.invalid,msg:I.SINGLE_INVALID};else{if(e.email===t.email)return c;if(null!=s&&t.is_team&&e.dbx_team_id!==s.id&&!e.group_id){const e=I.OUT_OF_TEAM;let t;t="team"===(null!=r?r.member_policy:void 0)||"team"===(null!=r?r.resolved_member_policy:void 0)?o.ContactTokenState.invalid:o.ContactTokenState.warn,c={msg:e,state:t}}}return c};t.validateContacts=function(e,t,s,r,a,n,i,c,l){let d,_;for(const t of e){const r=s[t.getKey()];if(!r)continue;const a=e.filter(e=>!e.on_team).length,n=e.filter(e=>null==e.dbx_account_id).length,{state:E,msg:u}=r;if(E===o.ContactTokenState.invalid){if(d=C.Error,u===I.SINGLE_INVALID){_=I.GENERAL_INVALID;break}u===I.OUT_OF_TEAM&&(_=a>1?I.GENERAL_OUT_OF_TEAM_MULTIPLE:I.GENERAL_OUT_OF_TEAM_SINGLE),u===I.NONGROUP_INVITEE&&(_=I.NONGROUP_INVITEE),u===I.NO_PERMISSION&&(_=I.GENERAL_NO_PERMISSION)}if(E===o.ContactTokenState.warn)if(d=C.Warn,u===I.OUT_OF_TEAM)_=a>1?I.GENERAL_OUT_OF_TEAM_MULTIPLE:I.GENERAL_OUT_OF_TEAM_SINGLE;else if("NOT_DROPBOX_USER"===u){let e;if(_=I.NOT_DROPBOX_USER(n,c,i),e="writer"===i?l.find(e=>"editor"===e.accessLevel()):l.find(e=>"viewer"===e.accessLevel()||!e.isRighteousLink()),e){"no_one"!==(0,f.getAudienceForLink)(e.link_permissions)&&(_+=I.SEND_LINK)}else _+=I.SEND_LINK}}return R(t,r,a)&&e.length>0&&d!==C.Error&&n>E.GoldenGate.SHARING_TOTAL_LIMIT&&(d=C.Error,_=I.GENERAL_TOO_MANY_MEMBERS),{level:d,message:_}};t.logTiburonEvent=(e,t,s,r={})=>{const i=e.extras.origin;n.ShareTibEventLogger.log(t,s,i,a.assignIn(r,{file_id:e.extras.fileId,fq_path:e.displayPath(),ns_id:e.isSharedFolder()?e.sharedFolderId():void 0,modal_session_id:e.extras.modalSessionId}))};const L={access_error:h.intl.formatMessage({id:"N0ZK+y",defaultMessage:"You don’t have access to this content."}),email_unverified:h.intl.formatMessage({id:"YVPxPt",defaultMessage:"You haven’t verified your email. Check your email and try again."}),bad_member:h.intl.formatMessage({id:"0AMMBX",defaultMessage:"You entered an invalid name or email address."}),cant_share_outside_team:h.intl.formatMessage({id:"JoJWle",defaultMessage:"Your team settings don’t allow sharing outside your team."}),too_many_members:h.intl.formatMessage({id:"Zq3Ehi",defaultMessage:"You’re sharing with too many people."}),too_many_pending_invites:h.intl.formatMessage({id:"Zq3Ehi",defaultMessage:"You’re sharing with too many people."}),rate_limit:h.intl.formatMessage({id:"ZXI9uh",defaultMessage:"You’ve hit the limit of invites for today. Try again later."}),insufficient_plan:h.intl.formatMessage({id:"osl3qq",defaultMessage:"You need a Dropbox {trademark_plus} or Business account to do this."},{trademark_plus:u.TRADEMARK_PLUS}),team_folder:h.intl.formatMessage({id:"ehBhap",defaultMessage:"You can’t add members to a team folder. Contact your team admin."}),no_permission:h.intl.formatMessage({id:"5/am2Y",defaultMessage:"You don’t have permission to do this. Contact the owner."})};t.genAddMemberErrorMessage=function(e){return e.message?e.message:e instanceof i.AppError&&e.error&&e.error[".tag"]&&L[e.error[".tag"]]?L[e.error[".tag"]]:h.intl.formatMessage({id:"bLA3rA",defaultMessage:"There was a problem completing this request."})};t.spectrumFolderIconForMetadata=function(e){const t=null!=e.parent_shared_folder_id,s=e.isViewOnly();let r=l.FileTypes.FOLDER;return e.isSharedFolder()?r=l.FileTypes.SHARED_FOLDER:e.is_team_folder&&(r=l.FileTypes.TEAM_SHARED_FOLDER),(0,d.spectrumFolderIcon)({fileType:r,isInTeamFolderTree:t,isViewOnly:s})};t.fileIconForMetadata=e=>(0,d.file_icon)(e.name,{size:d.ICON_SIZES.LARGE});t.getNewFolderPathFromContentName=function(e,t){return[(0,c.normalize)(t),e].join("/")};t.getMemberCountForTokens=function(e){return null==e?0:e.map(e=>e.group_size||1).reduce((e,t)=>e+t,0)};var b,y;t.convertIfHTML=function(e){return e.toHTML?(0,m.legacyFormatHtmlAsReact)(e.toHTML(),M):e},(function(e){e.SHARE_SUCCESS="share_success",e.SHARE_MODAL_CLOSE="share_modal_close",e.SHARE_LINK_MEMBER_LIST_ON="share_link_member_list_on",e.SHARE_LINK_MEMBER_LIST_CONTROL="share_link_member_list_control",e.SHARE_LINK_COPY_SUCCESS="share_link_copy_success",e.SHARE_LINK_CREATE_SUCCESS="share_link_create_success"})(b||(b={})),t.SharingUserLeapEvent=b,(function(e){e.VIEWED_SHARED_FOLDER="viewed_shared_folder",e.VIEWED_SHARED_FILE="viewed_shared_file",e.VISIT_SHARE_PAGE="visit_share_page",e.VISIT_SHARE_PAGE_LINKS_TAB="visit_share_page_links_tab",e.VIEWED_SHARED_FOLDER_PROMPT_ON="viewed_shared_folder_prompt_on",e.VIEWED_SHARED_FOLDER_PROMPT_CONTROL="viewed_shared_folder_prompt_control"})(y||(y={})),t.ReceiverUserLeapEvent=y;t.trackUserLeapEvent=(e,t)=>{(e=>void 0!==e&&[p.SHARE_ACTION_ORIGIN_TYPE.BROWSE_FILE_ACTIONS,p.SHARE_ACTION_ORIGIN_TYPE.BROWSE_FILE_FACEPILE,p.SHARE_ACTION_ORIGIN_TYPE.BROWSE_FILE_ROW,p.SHARE_ACTION_ORIGIN_TYPE.BROWSE_FILE_ROW_BUTTON,p.SHARE_ACTION_ORIGIN_TYPE.BROWSE_FILE_ROW_OVERFLOW_MENU,p.SHARE_ACTION_ORIGIN_TYPE.MANAGE_ACCESS_CLOSE,p.SHARE_ACTION_ORIGIN_TYPE.SHARE_LINK_MODAL].indexOf(e)>=0)(t)&&(S.UserSurvey.addAttribute("eventName",e),S.UserSurvey.trackEvent(e,"sharing"))};const F=e=>{S.UserSurvey.addAttribute("eventName",e),S.UserSurvey.trackEvent(e,"sharing")};t.trackReceiverUserLeapEvent=F;t.trackSharePageUserLeapEvent=(e,t)=>{S.UserSurvey.addAttribute("contentCount",t),F(e)};t.getTotalMountsExceededMsg=()=>h.intl.formatMessage({id:"CdLxbe",defaultMessage:"Unable to complete this operation because your Dropbox has too many shared folders."});t.getHomeMountsExceededMsg=()=>h.intl.formatMessage({id:"AMJRvM",defaultMessage:"Unable to complete this operation because your Dropbox has too many shared folders."});t.getTreeSizeExceededMsg=()=>h.intl.formatMessage({id:"SfQyoF",defaultMessage:"Unable to complete this operation because the top level folder has too many shared folders."});t.getTotalMountsExceededMountFoldersMsg=e=>{const t=H(e);return h.intl.formatMessage({id:"EjCgHX",defaultMessage:"Couldn’t add folder. Your Dropbox account is {number, plural, one{1 shared folder} other {{number} shared folders}} over the limit."},{number:t})};t.getHomeMountsExceededMountFoldersMsg=e=>{const t=H(e);return h.intl.formatMessage({id:"ufWtvO",defaultMessage:"Couldn’t add folder. Your Dropbox account is {number, plural, one{1 shared folder} other {{number} shared folders}} over the limit."},{number:t})};t.getTreeSizeExceededMountFoldersMsg=e=>{const t=H(e);return h.intl.formatMessage({id:"6mGfdj",defaultMessage:"Couldn’t add folder. Your Dropbox account is {number, plural, one{1 shared folder} other {{number} shared folders}} over the limit."},{number:t})};t.getLinkOnlyTitle=()=>h.intl.formatMessage({id:"Ugz0Dm",defaultMessage:"This folder can only be shared with a link"});t.getTotalMountsExceededLinkOnlyMsg=e=>h.intl.formatMessage({id:"XP7H5x",defaultMessage:"Your Dropbox account is {number, plural, one{1 shared folder} other {{number} shared folders}} over the limit."},{number:e});t.getHomeMountsExceededLinkOnlyMsg=e=>h.intl.formatMessage({id:"wCYUIO",defaultMessage:"Your Dropbox account is {number, plural, one{1 shared folder} other {{number} shared folders}} over the limit."},{number:e});t.getTreeSizeExceededLinkOnlyMsg=e=>h.intl.formatMessage({id:"BY6VL1",defaultMessage:"The parent folder is {number, plural, one{1 shared folder} other {{number} shared folders}} over the limit."},{number:e});const v=e=>A.isObjectOf({error:A.isObjectOf({".tag":A.isExactly("too_many_mounts"),too_many_mounts:A.isObjectOf({".tag":e})})}),P=v(A.isExactly("total_mounts_exceeded"));t.isTotalMountsExceededError=P;const U=v(A.isExactly("home_mounts_exceeded"));t.isHomeMountsExceededError=U;const D=v(A.isExactly("tree_size_exceeded"));t.isTreeSizeExceededError=D;t.getContactSupportMessage=()=>h.intl.formatMessage({id:"Bcojaq",defaultMessage:"Contact support"});const k=e=>new _.MountLimitInfo({limit:e.error.too_many_mounts.limit,current_count:e.error.too_many_mounts.current_count,new_count:e.error.too_many_mounts.new_count});t.getMountLimitInfo=k;t.namespaceLimitExceededFailCreateSharedFolderSnackbarMsg=e=>{const t=H(e);return h.intl.formatMessage({id:"0UrAT5",defaultMessage:"Couldn’t create shared folder. Your Dropbox account is {number, plural, one{1 shared folder} other {{number} shared folders}} over the limit."},{number:t})};t.homeMountsExceededFailSnackbarMsg=e=>{const t=H(e);return h.intl.formatMessage({id:"ZQSxHJ",defaultMessage:"Couldn’t create link. Your Dropbox account is {number, plural, one{1 shared folder} other {{number} shared folders}} over the limit."},{number:t})};t.totalMountsExceededFailSnackbarMsg=e=>{const t=H(e);return h.intl.formatMessage({id:"mV9Yzt",defaultMessage:"Couldn’t create link. Your Dropbox account is {number, plural, one{1 shared folder} other {{number} shared folders}} over the limit."},{number:t})};t.treeSizeExceededFailSnackbarMsg=e=>{const t=H(e);return h.intl.formatMessage({id:"Hhv0z6",defaultMessage:"Couldn’t create link. Your Dropbox account is {number, plural, one{1 shared folder} other {{number} shared folders}} over the limit."},{number:t})};const H=e=>{const t=k(e),s=t.limit;return t.new_count-s};t.getExceededCountInfo=H;const x=(e,t)=>{const s=e.name().split(".").pop();let r="share_modal";return t&&(r=`${t}_${r}`),{fileExts:s?{[s]:1}:{},fileIds:e.fileId(),referrer:r,shouldLogQualifyEvent:!0}};t.getShopModalCtx=x;const j=(e,t)=>{const{referrer:s,fileExts:r}=x(e,t),a={experiment:"core_act_shop_entry_point",location:s,file_exts:r};return{onImpression:{eventName:g.ShopEntryPointEvents.SHOP_ENTRY_POINT_IMPRESSION,extras:a},onConfirm:{eventName:g.ShopEntryPointEvents.SHOP_ENTRY_POINT_CTA_CLICK,extras:a},onDismiss:{eventName:g.ShopEntryPointEvents.SHOP_ENTRY_POINT_DISMISS,extras:a}}};t.getShopModalLoggingParams=j;t.publishShopModalEvent=(e,t,s,r=!1)=>{t.isFile()&&t.name()&&(0,T.publishEvent)(e,{context:x(t,s),loggingParams:r?j(t,s):void 0})}})),define("metaserver/static/js/sharing/views/constants",["require","exports","tslib","lodash","metaserver/static/js/core/i18n"],(function(e,t,s,r,a){"use strict";var n,i,o;Object.defineProperty(t,"__esModule",{value:!0}),t.CREATE_EDIT_FOLDER_LINK_VARIANT=t.EXP_LINK_IN_MEMBER_LIST_VARIANT=t.LINK_CREATION_SURFACE=t.CONTENT_NAME_MESSAGE_LEVEL_VALUES=t.BANNER_VALUES=t.MODE_VALUES=t.CONTENT_NAME_EMPTY_TOOLTIP=t.NS_LIMIT_ERROR=t.LINK_ONLY_REASON=t.MODES=t.LinkabilityStates=t.FETCH_METADATA_STATUS=t.CONTENT_NAME_MESSAGE_LEVELS=t.BANNERS=void 0,r=s.__importStar(r),(function(e){e[e.NO_MEMBERS=0]="NO_MEMBERS",e[e.INPUT_CONTENT_NAME=1]="INPUT_CONTENT_NAME"})(n=t.BANNERS||(t.BANNERS={})),(function(e){e[e.INFO=0]="INFO",e[e.ERROR=1]="ERROR"})(i=t.CONTENT_NAME_MESSAGE_LEVELS||(t.CONTENT_NAME_MESSAGE_LEVELS={})),(function(e){e[e.FETCHING=0]="FETCHING",e[e.SUCCESS=1]="SUCCESS",e[e.FAIL=2]="FAIL"})(t.FETCH_METADATA_STATUS||(t.FETCH_METADATA_STATUS={})),(function(e){e.CAN_LINK="CAN_LINK",e.INVITE_NO_LINK="INVITE_NO_LINK",e.NO_INVITE_NO_LINK="NO_INVITE_NO_LINK",e.CANT_LINK_TEAM_FOLDER="CANT_LINK_TEAM_FOLDER",e.ERROR_FETCHING_LINK_INFO="ERROR_FETCHING_LINK_INFO"})(t.LinkabilityStates||(t.LinkabilityStates={})),(function(e){e.LINK_ONLY="link-only",e.LOADING="loading",e.MEMBERSHIP="membership",e.POINTER="pointer",e.SHARE="share",e.SHARE_SENDING="share-sending",e.EVOLUTION="evolution"})(o=t.MODES||(t.MODES={})),(function(e){e.INSIDE_SHARED_FOLDER="inside_shared_folder",e.CONTAINS_SHARED_FOLDER="contains_shared_folder",e.LINKS_PAGE="links_page",e.TOTAL_MOUNTS_EXCEEDED="total_mounts_exceeded",e.HOME_MOUNTS_EXCEEDED="home_mounts_exceeded",e.TREE_SIZE_EXCEEDED="tree_size_exceeded"})(t.LINK_ONLY_REASON||(t.LINK_ONLY_REASON={})),(function(e){e.TOTAL_MOUNTS_EXCEEDED="total_mounts_exceeded",e.HOME_MOUNTS_EXCEEDED="home_mounts_exceeded",e.TREE_SIZE_EXCEEDED="tree_size_exceeded"})(t.NS_LIMIT_ERROR||(t.NS_LIMIT_ERROR={})),t.CONTENT_NAME_EMPTY_TOOLTIP=a.intl.formatMessage({id:"mYGncD",defaultMessage:"Name your shared folder"}),t.MODE_VALUES=r.values(o),t.BANNER_VALUES=r.values(n),t.CONTENT_NAME_MESSAGE_LEVEL_VALUES=r.values(i),(function(e){e.COPY_OR_CREATE_LINK_SECTION="COPY_OR_CREATE_LINK_SECTION"})(t.LINK_CREATION_SURFACE||(t.LINK_CREATION_SURFACE={})),(function(e){e.ON="ON",e.OFF="OFF",e.CONTROL="CONTROL"})(t.EXP_LINK_IN_MEMBER_LIST_VARIANT||(t.EXP_LINK_IN_MEMBER_LIST_VARIANT={})),(function(e){e.ON="ON",e.OFF="OFF",e.CONTROL="CONTROL"})(t.CREATE_EDIT_FOLDER_LINK_VARIANT||(t.CREATE_EDIT_FOLDER_LINK_VARIANT={}))})),define("typescript/component_libraries/spectrum-sharing/src/share_modal/sharing_settings/utils/sharing_settings_util",["require","exports","typescript/component_libraries/spectrum-sharing/src/share_modal/sharing_settings/utils/link_metadata_types","typescript/component_libraries/spectrum-sharing/src/utils/datetime_util"],(function(e,t,s,r){"use strict";function a(e){return e.requested_visibility===s.RequestedVisibilityPolicy.password||e.require_password}function n(e){return e.audience_options.filter(e=>"password"===e.audience&&e.allowed).length>0}function i(e){if(e.effective_audience)return e.effective_audience;switch(e.resolved_visibility){case"public":case"password":case"no_one":return e.resolved_visibility;case"team_only":return"team";case"team_and_password":return"password";case"shared_folder_only":case"only_you":return"no_one"}}Object.defineProperty(t,"__esModule",{value:!0}),t.canCreateLink=t.getLinkControlPolicyWarningText=t.isReadOnlyPolicy=t.isExpirationPolicyEnforcedByAdmin=t.isPasswordPolicyEnforcedByAdmin=t.isExpirationPolicySetByAdmin=t.isExternalAudience=t.daysExpirationPolicyToNumber=t.SharingSettingsUtil=t.getAudienceForLink=t.canModifyExpire=t.canToggleExpire=t.canModifyPassword=t.canChangeShmodelPassword=t.canTogglePassword=t.hasLinkPassword=void 0,t.hasLinkPassword=a,t.canTogglePassword=function(e){return Boolean(e&&e.require_password?e.can_remove_password:e.can_set_password)||n(e)},t.canChangeShmodelPassword=n,t.canModifyPassword=function(e){return Boolean(e&&e.can_set_password)||n(e)},t.canToggleExpire=function(e){const t=e.link_permissions;return Boolean(null!=e.expires?t.can_remove_expiry:t.can_set_expiry)},t.canModifyExpire=function(e){const t=e.link_permissions;return Boolean(t.can_set_expiry)},t.getAudienceForLink=i;function o(e){return["public","password"].includes(e)}function c(e){return!!e.days_to_expire_policy&&"none"!==e.days_to_expire_policy}function l(e){return!!e.enforce_shared_link_password_policy&&"required"===e.enforce_shared_link_password_policy}function d(e){return c(e)&&!!e.change_shared_link_expiration_policy&&"not_allowed"===e.change_shared_link_expiration_policy}function _(e,t){return o(e.audience)&&(!e.expires&&d(t)||!a(t)&&l(t))}t.SharingSettingsUtil=e=>({getLinkPolicy:e=>({link_password:a(e.link_permissions)?void 0:"",expires:e.expires,allow_download:e.link_permissions.allow_download,audience:i(e.link_permissions),require_password:e.link_permissions.require_password}),getModifiedSettings:(t,s,a)=>{if(s===a)return;const n={},i=null!=t.expires&&null==s.expires;if(s.audience!==a.audience&&(n.audience=s.audience),s.allow_download!==a.allow_download&&(n.allow_download=s.allow_download),s.expires&&t.link_permissions.can_set_expiry&&(n.expires=(0,r.formatDateToString)(s.expires)),s.require_password!==a.require_password&&(n.require_password=s.require_password),"password"===s.audience||s.require_password)if(s.link_password)n.require_password=!0,n.link_password=s.link_password;else if(""===s.link_password)return{error:e.formatMessage({id:"wFrAfD",defaultMessage:"Password can’t be empty"})};return Object.keys(n).length<=0&&!i?void 0:{url:t.url,settings:n,remove_expiration:i}}}),t.daysExpirationPolicyToNumber={day_1:1,day_3:3,day_7:7,day_30:30,day_90:90,day_180:180,year_1:365},t.isExternalAudience=o,t.isExpirationPolicySetByAdmin=c,t.isPasswordPolicyEnforcedByAdmin=l,t.isExpirationPolicyEnforcedByAdmin=d,t.isReadOnlyPolicy=_,t.getLinkControlPolicyWarningText=function(e,s,r,a){let n="";if(_(e,r)){const e=d(r),t=l(r);n=a.formatMessage({id:"wCF2Es",defaultMessage:"Your admin requires {requirements, select, 0 {an expiration and a password} 1 {a password} 2 {an expiration}} for links shared outside the team. To change the link setting, delete the link and create it again."},{requirements:e&&t?0:t?1:2})}else s.display_expiration_warning?n=a.formatMessage({id:"wKX132",defaultMessage:"Your admin {show_password_text, select, true {requires a password and } false {}}has set an expiration for all links shared outside the team. This link will expire in {days_to_expire, plural, =365 {1 year} one {# day} other {# days}}.{expiration_enforced, select, true { You can change or remove this expiration.} false {}}"},{days_to_expire:t.daysExpirationPolicyToNumber[r.days_to_expire_policy],expiration_enforced:"allowed"===r.change_shared_link_expiration_policy,show_password_text:!!s.display_password_warning}):s.display_password_warning&&(n=a.formatMessage({id:"lcVbzE",defaultMessage:"Your admin requires to set a password for links shared outside the team."}));return n},t.canCreateLink=function(e,t,s,r,a,n,i,o,c,l,d,_){switch(e){case"editor":return s?n&&i&&!r&&!a:!r&&l;case"viewer":return!("writer"===d&&!_)&&(t?c:!r&&c||o);default:return!1}}})),define("typescript/component_libraries/spectrum-sharing/src/share_modal/sharing_settings/utils/link_metadata_types",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LinkAudienceDisallowedReason=t.ResolvedVisibilityPolicy=t.RequestedVisibilityPolicy=void 0,t.RequestedVisibilityPolicy={policy_name:"requested_visibility",password:"password",public:"public",team_only:"team_only"},t.ResolvedVisibilityPolicy={policy_name:"resolved_visibility",only_you:"only_you",password:"password",public:"public",shared_folder_only:"shared_folder_only",team_and_password:"team_and_password",team_only:"team_only",no_one:"no_one"},(function(e){e.DeleteAndRecreate="delete_and_recreate",e.RestrictedBySharedFolder="restricted_by_shared_folder",e.RestrictedByTeam="restricted_by_team",e.UserAccountType="user_account_type",e.UserNotOnTeam="user_not_on_team",e.PermissionDenied="permission_denied"})(t.LinkAudienceDisallowedReason||(t.LinkAudienceDisallowedReason={}))}));
//# sourceMappingURL=pkg-browse-and-photos.min.js-vflYlzNIE.map