/*
 Microsoft Corporation. All rights reserved.
*/
'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[7],{1476:function(C,N,d){d.d(N,"c",function(){return G});d.d(N,"b",function(){return F});d.d(N,"s",function(){return O});d.d(N,"q",function(){return J});d.d(N,"p",function(){return L});d.d(N,"g",function(){return S});d.d(N,"d",function(){return E});d.d(N,"o",function(){return P});d.d(N,"n",function(){return T});d.d(N,"a",function(){return U});d.d(N,"e",function(){return X});d.d(N,"i",function(){return Y});d.d(N,
"m",function(){return ca});d.d(N,"r",function(){return da});d.d(N,"j",function(){return ua});d.d(N,"k",function(){return ra});d.d(N,"h",function(){return qa});d.d(N,"u",function(){return ka});d.d(N,"t",function(){return la});d.d(N,"f",function(){return bb});d.d(N,"l",function(){return ha});C=d(22);var l=d(59),e=d(100),a=d(128);N=d(428);var k=d(42),n=d(11),v=d(453),u=d(5),t=d(8),y=d(1485),B=d(1568);const G=new N.a,F=`.ParaWrappingDiv .${k.a.hAd}`,K=C.a.instance.ef("Box4.CommentParagraphMapping"),O=
[Box4Intl.Box4Strings.l_HK_Bold,Box4Intl.Box4Strings.l_HK_Bold_Mac,Box4Intl.Box4Strings.l_HK_Italic,Box4Intl.Box4Strings.l_HK_Italic_Mac,Box4Intl.Box4Strings.l_HK_Underline,Box4Intl.Box4Strings.l_HK_Underline_Mac];let H=void 0;const I=()=>{if(void 0===H){let ia;try{ia=CSS.supports("selector(:not(* *))")}catch(va){ia=!1}ia||t.ULS.sendTraceTag(526263553,324,15,"Cannot use complex CSS selector in CommentHelpers, falling back to less performant alternative");H=ia}return H},J=ia=>!!ia&&!!ia.Rf,L=(ia,va,
Ka,Xa)=>{if(!ia||!ia.objectId)return!1;const xa=Ka.Eb(l.a.Of(ia.objectId)),Ma=y.a.K3b(xa,!0),Na=y.a.K3b(xa,!1);if(!Ma||!Na||Ma===Na&&Ma!==va||!n.ParagraphReader.HOc(va,Ma,Na))return!1;ia=!0;var pa=!1;Ma===va&&(pa=y.a.h$(xa,Ka,!0),ia=ia&&!!pa&&pa.Ob.cp<=Xa,pa=!!pa&&pa.Ob.cp===Xa);va===Na&&(va=y.a.h$(xa,Ka,!1),ia=ia&&!!va&&va.Ob.cp>Xa,pa=pa&&!!va&&va.Ob.cp===Xa);return ia||pa},S=ia=>{if(!ia)return null;ia=e.a.Eb(ia,k.a.xBc);return null!==ia&&void 0!==ia?ia:[]},E=ia=>ia?e.a.Eb(ia,k.a.Jvd):null,P=(ia,
va)=>{if(!ia)return-1;for(let Ka=0;Ka<ia.length;Ka++)if(ia[Ka].zac.equals(va))return Ka;return-1},T=(ia,va)=>{if(!ia)return-1;for(let Ka=0;Ka<ia.length;Ka++)if(ia[Ka].O9h.equals(va))return Ka;return-1},U=ia=>`Comment Object Id: ${ia.objectId}`,X=(ia=!1)=>bb(document.getElementById(a.AppFrame.AFa),ia),Y=()=>Ja()?Array.from(document.getElementById(a.AppFrame.AFa).querySelectorAll(".ParaWrappingDiv:not([style*='visibility: hidden;']) .TextDeletionSimpleOrNoMarkup .CommentStart")):[],ca=(ia,va=!1)=>{if(ia.Uj){for(let Ka of ia.zg.Ii)if(ha(Ka,
va))return!0;return!1}return ha(ia.htmlElement,va)},da=ia=>!!ia&&!!ia.ia(u.a.mL,null),ua=()=>{const ia=new Set,va=Y();for(let Ka=0;Ka<va.length;Ka++)S(va[Ka]).forEach(Xa=>{ia.add(Xa.toString())});return ia},ra=(ia,va)=>va?Ha(ia,!0,va):wa(ia,!0),qa=(ia,va)=>va?Ha(ia,!1,va):wa(ia,!1),ka=(ia,va)=>{Ca(ia,va,!0);v.a.isEnabled&&t.ULS.sendTraceTag(512372928,327,50,`Adding to CommentParagraphMapping CommentId: ${ia.id} StartParaId: ${va}`)},la=(ia,va)=>{Ca(ia,va,!1);v.a.isEnabled&&t.ULS.sendTraceTag(512372899,
327,50,`Adding to CommentParagraphMapping CommentId: ${ia.id} EndParaId: ${va}`)},Ha=(ia,va,Ka)=>{var Xa,xa;const Ma=ia.id.toString();return va?v.a.isEnabled?null!==(Xa=K.value.xZb.get(Ma))&&void 0!==Xa?Xa:Ka:ia.ia(u.a.PPa,Ka):v.a.isEnabled?null!==(xa=K.value.uZb.get(Ma))&&void 0!==xa?xa:Ka:ia.ia(u.a.xsa,Ka)},wa=(ia,va)=>{const Ka=ia.id.toString();return va?v.a.isEnabled?K.value.xZb.get(Ka):ia.getValue(u.a.PPa):v.a.isEnabled?K.value.uZb.get(Ka):ia.getValue(u.a.xsa)},Ca=(ia,va,Ka)=>{const Xa=ia.id.toString();
v.a.isEnabled?ia.i6b||(Ka?K.value.xZb:K.value.uZb).set(Xa,va):ia.setValue(Ka?u.a.PPa:u.a.xsa,va)},Ja=()=>0===B.a.Ri||2===B.a.Ri,bb=(ia,va)=>{if(va&&Ja()){if(I())return Array.from(ia.querySelectorAll(".ParaWrappingDiv:not([style*='visibility: hidden;']) .CommentStart:not(.ParaWrappingDiv:not([style*='visibility: hidden;']) .TextDeletionSimpleOrNoMarkup .CommentStart)"));va=ia.querySelectorAll(".ParaWrappingDiv:not([style*='visibility: hidden;']) .TextDeletionSimpleOrNoMarkup .CommentStart");const Ka=
va.length;if(0<Ka){ia=ia.querySelectorAll(".ParaWrappingDiv:not([style*='visibility: hidden;']) .CommentStart");const Xa=[];let xa=0;for(let Ma=0,Na=ia.length;Ma<Na;Ma++){const pa=ia[Ma];xa<Ka&&va[xa]===pa?++xa:Xa.push(pa)}return Xa}}return Array.from(ia.querySelectorAll(".ParaWrappingDiv:not([style*='visibility: hidden;']) .CommentStart"))},ha=(ia,va)=>{if(va&&Ja()){if(I())return!!ia.querySelector(".ParaWrappingDiv:not([style*='visibility: hidden;']) .CommentStart:not(.ParaWrappingDiv:not([style*='visibility: hidden;']) .TextDeletionSimpleOrNoMarkup .CommentStart)");
va=ia.querySelectorAll(".ParaWrappingDiv:not([style*='visibility: hidden;']) .TextDeletionSimpleOrNoMarkup .CommentStart").length;if(0<va)return va!==ia.querySelectorAll(".ParaWrappingDiv:not([style*='visibility: hidden;']) .CommentStart").length}return!!ia.querySelector(".ParaWrappingDiv:not([style*='visibility: hidden;']) .CommentStart")}},1480:function(C,N,d){var l=this&&this.BO||(Object.create?function(a,k,n,v){void 0===v&&(v=n);var u=Object.getOwnPropertyDescriptor(k,n);if(!u||("get"in u?!k.iG:
u.writable||u.configurable))u={enumerable:!0,get:function(){return k[n]}};Object.defineProperty(a,v,u)}:function(a,k,n,v){void 0===v&&(v=n);a[v]=k[n]}),e=this&&this.__exportStar||function(a,k){for(var n in a)"default"===n||Object.prototype.hasOwnProperty.call(k,n)||l(k,a,n)};Object.defineProperty(N,"__esModule",{value:!0});e(d(1766),N);e(d(1767),N);C.exports.ErrorCode||Object.defineProperty(C.exports,"ErrorCode",{enumerable:!0,get:function(){return C.exports.ErrorCode}});C.exports.FormattingSuggestionType||
Object.defineProperty(C.exports,"FormattingSuggestionType",{enumerable:!0,get:function(){return C.exports.FormattingSuggestionType}});C.exports.FormattingSuggestionsAnnotation||Object.defineProperty(C.exports,"FormattingSuggestionsAnnotation",{enumerable:!0,get:function(){return C.exports.FormattingSuggestionsAnnotation}});C.exports.FormattingSuggestionsRange||Object.defineProperty(C.exports,"FormattingSuggestionsRange",{enumerable:!0,get:function(){return C.exports.FormattingSuggestionsRange}});
C.exports.FormattingSuggestionsSummaryAnnotation||Object.defineProperty(C.exports,"FormattingSuggestionsSummaryAnnotation",{enumerable:!0,get:function(){return C.exports.FormattingSuggestionsSummaryAnnotation}})},1481:function(C,N,d){d.d(N,"f",function(){return B});d.d(N,"e",function(){return G});d.d(N,"d",function(){return F});d.d(N,"g",function(){return K});d.d(N,"h",function(){return O});d.d(N,"a",function(){return H});d.d(N,"j",function(){return I});d.d(N,"i",function(){return J});d.d(N,"c",function(){return L});
d.d(N,"b",function(){return S});var l=d(48),e=d(8),a=d(1488);d.n(a);C=[{role:2,roleType:a.RoleType.Title},{role:3,roleType:a.RoleType.Subtitle},{role:4,roleType:a.RoleType.Heading1},{role:5,roleType:a.RoleType.Heading2},{role:6,roleType:a.RoleType.Heading3},{role:7,roleType:a.RoleType.Heading4},{role:8,roleType:a.RoleType.Heading5},{role:9,roleType:a.RoleType.Heading6},{role:10,roleType:a.RoleType.Heading7},{role:11,roleType:a.RoleType.Heading8},{role:12,roleType:a.RoleType.Heading9},{role:15,roleType:a.RoleType.ListItem},
{role:13,roleType:a.RoleType.BodyText},{role:14,roleType:a.RoleType.Caption}];N=[{role:1,YF:{default:"Unknown",GI:null}},{role:2,YF:{default:"Title",GI:Box4Intl.Box4Strings.L_StyleWordTitle}},{role:3,YF:{default:"Subtitle",GI:Box4Intl.Box4Strings.L_StyleWordSubtitle}},{role:4,YF:{default:"Heading1",GI:Box4Intl.Box4Strings.L_StyleWordHeading1}},{role:5,YF:{default:"Heading2",GI:Box4Intl.Box4Strings.L_StyleWordHeading2}},{role:6,YF:{default:"Heading3",GI:Box4Intl.Box4Strings.L_StyleWordHeading3}},{role:7,
YF:{default:"Heading4",GI:Box4Intl.Box4Strings.L_StyleWordHeading4}},{role:8,YF:{default:"Heading5",GI:Box4Intl.Box4Strings.L_StyleWordHeading5}},{role:9,YF:{default:"Heading6",GI:Box4Intl.Box4Strings.L_StyleWordHeading6}},{role:10,YF:{default:"Heading7",GI:Box4Intl.Box4Strings.L_StyleWordHeading17}},{role:11,YF:{default:"Heading8",GI:Box4Intl.Box4Strings.L_StyleWordHeading8}},{role:12,YF:{default:"Heading9",GI:Box4Intl.Box4Strings.L_StyleWordHeading9}},{role:13,YF:{default:"BodyText",GI:Box4Intl.Box4Strings.L_StyleWordNormal}},
{role:14,YF:{default:"Caption",GI:Box4Intl.Box4Strings.L_StyleWordCaption}},{role:15,YF:{default:"ListItem",GI:null}},{role:16,YF:{default:"SubtleEmphasis",GI:Box4Intl.Box4Strings.L_StyleWordSubtleEmphasis}},{role:17,YF:{default:"Emphasis",GI:Box4Intl.Box4Strings.L_StyleWordEmphasis}},{role:18,YF:{default:"IntenseEmphasis",GI:Box4Intl.Box4Strings.L_StyleWordIntenseEmphasis}},{role:19,YF:{default:"Strong",GI:Box4Intl.Box4Strings.L_StyleWordStrong}},{role:20,YF:{default:"Quote",GI:Box4Intl.Box4Strings.L_StyleWordQuote}},
{role:21,YF:{default:"IntenseQuote",GI:Box4Intl.Box4Strings.L_StyleWordIntenseQuote}},{role:22,YF:{default:"SubtleReference",GI:Box4Intl.Box4Strings.L_StyleWordSubtleReference}},{role:23,YF:{default:"IntenseReference",GI:Box4Intl.Box4Strings.L_StyleWordIntenseReference}},{role:24,YF:{default:"BookTitle",GI:Box4Intl.Box4Strings.L_StyleWordBookTitle}},{role:25,YF:{default:"NoSpacing",GI:Box4Intl.Box4Strings.L_StyleWordNoSpacing}}];const k=new Map(N.map(E=>[E.YF.default,E.role])),n=new Map(N.map(E=>
[E.role,E.YF.default])),v=new Map(N.map(E=>[E.role,E.YF.GI])),u=new Map(C.map(E=>[E.roleType,E.role])),t=new Map(C.map(E=>[E.role,E.roleType])),y=(E,P,T)=>E.has(P)?E.get(P):T,B=E=>y(k,E,1),G=E=>y(u,E,1),F=E=>y(t,E,a.RoleType.Unknown),K=E=>y(n,E,"Unknown"),O=E=>y(v,E,null),H=E=>{switch(E){case 4:return 0;case 5:return 1;case 6:return 2;case 7:return 3;case 8:return 4;case 9:return 5;case 10:return 6;case 11:return 7;case 12:return 8;default:return 9}},I=E=>{switch(E){case 13:return"Normal";case 1:return"Unknown";
case 4:return"Heading 1";case 5:return"Heading 2";case 2:return"Title";case 15:return"List Paragraph";case 3:return"Subtitle";case 14:return"Caption";case 6:return"Heading 3";case 7:return"Heading 4";case 8:return"Heading 5";case 9:return"Heading 6";case 10:return"Heading 7";case 11:return"Heading 8";case 12:return"Heading 9";case 16:return"Subtle Emphasis";case 17:return"Emphasis";case 18:return"Intense Emphasis";case 19:return"Strong";case 20:return"Quote";case 21:return"Intense Quote";case 22:return"Subtle Reference";
case 23:return"Intense Reference";case 24:return"Book Title";case 25:return"No Spacing";default:return"Unknown"}},J=E=>{switch(E){case 13:return l.StyleReader.wordStyleIdNormal;case 4:return l.StyleReader.wordStyleIdHeading1;case 5:return l.StyleReader.wordStyleIdHeading2;case 2:return l.StyleReader.K4a;case 15:return l.StyleReader.wordStyleIdListParagraph;case 3:return l.StyleReader.gic;case 6:return l.StyleReader.wordStyleIdHeading3;case 7:return l.StyleReader.D4a;case 8:return l.StyleReader.E4a;
case 9:return l.StyleReader.F4a;case 10:return l.StyleReader.Fmb;case 11:return l.StyleReader.Gmb;case 12:return l.StyleReader.G4a;case 16:return l.StyleReader.J4a;case 17:return l.StyleReader.OQa;case 18:return l.StyleReader.H4a;case 19:return l.StyleReader.vag;case 20:return l.StyleReader.PMb;case 21:return l.StyleReader.I4a;case 22:return l.StyleReader.wag;case 23:return l.StyleReader.uag;case 24:return l.StyleReader.sag;case 25:return l.StyleReader.Hmb;case 14:return l.StyleReader.pmj;default:return e.ULS.shipAssertTag(571867614,
3016,!1,K(E)),"Unknown"}},L=E=>{switch(E){case 18:case 21:case 23:return!0;default:return!1}},S=E=>4<=E&&12>=E},1482:function(C,N,d){d.d(N,"a",function(){return k});C=d(0);var l=d(2),e=d(1744),a=d(16);class k{static XQh(){return k.y9j+"_"+e.a.iLc+"_"+a.a.cW(l.AFrameworkApplication.userName)+"_"}static ELh(n){return n+"_"+e.a.iLc+"_"+a.a.cW(l.AFrameworkApplication.userName)+"_"}static lXh(){return k.c9m+"_"+e.a.iLc+"_"+a.a.cW(l.AFrameworkApplication.userName)+"_"}}k.nra="ack0";k.tVa="ack1";k.qrd="ack2";
k.y9j="ack3";k.syc="ack4";k.$$g="ack7";k.Nvf="ack8";k.j4i="ack9";k.ySe="ack10";k.i4i="ack13";k.w9j="DdaMethod";k.v9j="ControlId";k.srd="OsfcontrolId";k.JPe="SecurityOrigin";k.mXb="ak0";k.C9j="ak1";k.dah="ak2";k.tyc="ak4";k.Y$g="Office.AutoShowTaskpaneWithDocument";k.aah="value";k.B9j="errorCode";k.E_k="OsfControl";k.F_k="RibbonUpdaterData";k.Mae="AddinShared";k.c9m="__OSF_PRIVATECATALOG_ADDINIDS";Object(C.a)(k,"AddinConstantsString",null,[])},1485:function(C,N,d){C=d(0);var l=d(22),e=d(67),a=d(59),
k=d(2),n=d(720),v=d(121),u=d(205),t=d(619),y=d(9),B=d(6),G=d(287),F=d(11),K=d(384),O=d(1151),H=d(93),I=d(78),J=d(1708),L=d(1754),S=d(1755),E=d(17),P=d(5),T=d(595),U=d(8),X=d(120),Y=d(229),ca=d(86),da=d(1622);class ua extends Sys.EventArgs{constructor(Ja,bb){super();this.graphNode=Ja;this.kAk=bb}}Object(C.a)(ua,"OnCopyCommentEventArgs",Sys.EventArgs,[]);class ra extends Sys.EventArgs{constructor(Ja,bb){super();this.graphNode=Ja;this.iyk=bb}}Object(C.a)(ra,"OnPasteCommentEventArgs",Sys.EventArgs,[]);
var qa=d(1184),ka=d(1476),la=d(1540);class Ha extends Sys.EventArgs{constructor(Ja){super();this.commentNode=Ja}}Object(C.a)(Ha,"OnDeleteEventArgs",Sys.EventArgs,[]);class wa extends Sys.EventArgs{constructor(Ja){super();this.commentNode=Ja}}Object(C.a)(wa,"OnPasteEventArgs",Sys.EventArgs,[]);d.d(N,"a",function(){return Ca});class Ca{static get characterPropertiesEditor(){return null!=Ca.bhg?Ca.bhg:Ca.bhg=l.a.instance.resolve("Box4.ICharacterPropertiesEditor")}static get me(){return null!=Ca.Hig?
Ca.Hig:Ca.Hig=new e.a}static get Cza(){return la.a.instance}static get Ui(){return y.App.xa.jb.Yc.zd}static get Qb(){return null!=Ca.Gjg?Ca.Gjg:Ca.Gjg=l.a.instance.Pa("Box4.IFeatureHelper")}static isComment(Ja){return 40===Ja.Qe}static SNd(Ja){return 40===Ja.type}static Apf(Ja){return!!Ja&&39===Ja.Qe}static ZFf(Ja,bb){bb.property===E.a.qf&&(Ca.MCb=!1)}static cGf(Ja,bb){bb&&!Ja.Pc&&Ca.gyh(Ja)}static gyh(Ja){const bb=Ja.Ob.paragraph.Lc;Ja=bb.Eb(Ja.Qj);Ca.lFc();Ja&&Ja.anchor&&Ca.deleteComment(Ja,bb)}static h0e(Ja){const bb=
new B.GraphIterator;bb.set(Ja.Di());Ca.Cza.G0a(bb);return bb}static deleteComment(Ja,bb){Ja&&(Ca.lFc(),Ca.Zyd(Ja,bb),Ja.anchor&&(Ca.me.raiseEvent(Ca.vTc,new Ha(Ja)),bb=Ja.ia(P.a.iE,0),U.ULS.sendTraceTag(592188697,327,15,"Comment deleted by canvas anchor removal. DurableId:{0}",bb),Ca.Myg.add(bb.toString()),bb=new B.GraphIterator,bb.set(Ja),bb.Bb(39),bb.Eg()))}static obm(Ja){return Ca.Myg.contains(Ja)}static Zyd(Ja,bb){Ca.lFc();const ha=Ca.h$(Ja,bb,!0);Ja=Ca.h$(Ja,bb,!1);Ca.zjb(ha);Ca.zjb(Ja);ha&&
Ja&&ha.Ob===Ja.Ob&&U.ULS.sendTraceTag(50619292,327,10,"comment start and end range objects belonged to same chp")}static zjb(Ja){if(Ja&&Ja.Ob.Ff){Ja.Ob.Ff.remove(Ja);const bb=Ja.Ob.paragraph;0<=Ja.Ee&&Ja.Ee<bb.wordRunProperties.length&&(Ja.Ob.cp||1!==bb.wordRunProperties.length||(bb.wordRunProperties.DZ(0,4),bb.wordRunProperties.Hq.Z(1,G.CharacterPropertiesEditor.CQ),bb.wordRunProperties.gt.Z(1,G.CharacterPropertiesEditor.aU)),bb.wordRunProperties.removeAt(Ja.Ee,4));bb.wn()}}static xPm(Ja,bb){if(bb){var ha=
bb.paragraph;Ja=bb.cpBegin;var ia=bb.cpEnd;if(ha&&F.ParagraphReader.nc(ha)&&(ha=ha.qa)){bb.xo[Ca.Uvd]||(bb.xo[Ca.Uvd]=[]);bb=bb.xo[Ca.Uvd];for(let Ka=0;Ka<ha.length;Ka++){const Xa=ha.J(Ka).Ff;if(!Xa)continue;const xa=Xa.length;var va=ha.J(Ka).cp;if(va<Ja||va>ia)for(va=0;va<xa;va++)bb.push(Xa.J(va))}}}}static QOm(Ja,bb){if(bb&&(Ja=bb.xo[Ca.Uvd]))for(bb=0;bb<Ja.length;bb++)Ca.gyh(Ja[bb])}static h$(Ja,bb,ha){if(!Ja)return null;const ia=ha?ka.k(Ja,a.a.nil):ka.h(Ja,a.a.nil);bb=bb.Eb(ia);return bb?Ca.Ssa(bb,
Ja.id,ha):(ha||U.ULS.sendTraceTag(4531344,327,15,"Comment anchor missing!"),null)}static Ssa(Ja,bb,ha){for(let ia=0;ia<Ja.qa.length;ia++){const va=Ja.qa.J(ia);if(va.Ff)for(let Ka=0;Ka<va.Ff.length;Ka++)if(va.Ff.J(Ka).Qj.equals(bb)&&ha===va.Ff.J(Ka).Pc)return va.Ff.J(Ka)}return null}static K3b(Ja,bb){if(!Ja)return null;bb=bb?ka.k(Ja,a.a.nil):ka.h(Ja,a.a.nil);return Ja.Lc.Eb(bb)}static DHc(Ja,bb,ha,ia=null){const va=!ia;for(let Ka=0;Ka<Ja.qa.length;Ka++){const Xa=Ja.qa.J(Ka);if(Xa.cp>=bb&&Xa.Ff)for(let xa=
0;xa<Xa.Ff.length;xa++){const Ma=Xa.Ff.J(xa).Qj.toString();if(Xa.Ff.J(xa).Pc===ha&&(va||ia.contains(Ma)))return Xa.Ff.J(xa)}}return null}static Xwl(Ja,bb,ha,ia){for(let va=0;va<Ja.qa.length;va++){const Ka=Ja.qa.J(va);if(Ka.cp>bb)break;if(Ka.cp===bb&&Ka.Ff)for(let Xa=Ka.Ff.length-1;0<=Xa;Xa--){const xa=Ka.Ff.J(Xa).Qj.toString();if(Ka.Ff.J(Xa).Pc===ha&&ia.contains(xa))return Ka.Ff.J(Xa)}}return null}static KWb(Ja,bb,ha,ia){let va=null;for(let Ka=0;Ka<Ja.qa.length;Ka++){let Xa=Ja.qa.J(Ka);if(Xa.cp>=
ha){Xa.cp>ha||!Xa.formatting?(va=Ca.characterPropertiesEditor.OX(Ja,Ka,ha,va),Xa=Ja.qa.J(Ka)):va=Xa.formatting;Xa.Ff||(Xa.Ff=new K.a(Xa));Ca.vqd(bb,Xa.Ff,va.Bj,ia);break}Xa.formatting&&(va=Xa.formatting)}}static vqd(Ja,bb,ha,ia){ha=bb.Ob.paragraph;const va=new O.a(bb.Ob,null,Ja,ia);for(let Ka=0;Ka<bb.length;Ka++)if(bb.J(Ka).Qj===Ja&&bb.J(Ka).Pc===ia){U.ULS.sendTraceTag(589616028,327,10,"CommentRangeObject {0} already exists with isStart value {1} in commentRangeObjects",Ja,ia);break}bb.add(va);ha.wn();
va.Ee?ha.wordRunProperties.DZ(va.Ee-1,4):ha.wordRunProperties.wta(va.Ee,4);ha.wordRunProperties.Hq.Z(va.Ee,G.CharacterPropertiesEditor.CQ);ha.wordRunProperties.gt.Z(va.Ee,G.CharacterPropertiesEditor.aU);return va}static lFc(){if(!Ca.MCb){var Ja=new B.GraphIterator;Ja.set(y.App.xa.jb.Yc);Ca.Cza.G0a(Ja);if(Ja.Rb(1))for(;Ja.vf(1););Ca.MCb=!0}}static B9k(Ja){const bb=new B.GraphIterator;bb.set(y.App.xa.jb.Yc);Ca.Cza.G0a(bb);if(39!==bb.Qe)return!1;let ha;if(ha=bb.Rb(1)){if(ha.id.equals(Ja))return!0;for(;ha=
bb.vf(1);)if(ha.id.equals(Ja))return!0}return!1}static Z0a(Ja,bb){Ca.GXc(bb)}static GXc(Ja){Ca.RRf(F.ParagraphReader.Tzb(Ja));let bb=null;var ha=new B.GraphIterator;ha.set(Ja);if(ha.qo()&&(ha=H.a.Kr(ha,ha.origin),ha.moveNext()))for(;ha.moveNext();)if(F.ParagraphReader.zh(ha.iterator)){bb=ha.iterator.currentNode;break}if(bb){Ja=F.ParagraphReader.Tzb(Ja);for(let ia of Ja)ia.Pc&&(Ja=ia.Ob.paragraph.Lc.Eb(ia.Qj))&&(Ca.zjb(ia),Ca.KWb(bb,Ja.id,0,!0),ka.u(Ja,bb.id))}}static RRf(Ja){for(let bb of Ja)if(!bb.Pc){Ja=
bb.Ob.paragraph.Lc;const ha=Ja.Eb(bb.Qj);Ca.deleteComment(ha,Ja)}}static kHd(Ja,bb){const ha=[];if(!Ja)return U.ULS.shipAssertTag(594908762,327,!1,"Trying to highlight null node."),ha;if(!Ja.isConnected)return U.ULS.shipAssertTag(51467871,327,!1,"Trying to highlight disconnected node."),ha;const ia=Ca.h$(Ja,Ca.Ui,!0);Ja=Ca.h$(Ja,Ca.Ui,!1);if(!ia||!Ja)return U.ULS.shipAssertTag(51467872,327,!1,"Missing comment achor."),ha;let va=!1,Ka=ia.Ob.paragraph;for(;Ka&&(!bb||!bb(Ka,Ka===ia.Ob.paragraph));){Ka===
ia.Ob.paragraph&&(va=!0);va&&ha.push(Ka);if(Ka===Ja.Ob.paragraph)break;Ka=F.ParagraphReader.Vg(Ka,!1)}return ha}static $Ff(Ja,bb){bb.xo.Comments||(bb.xo.Comments={});Ca.TWd(bb.operation,bb.JBi,bb.original,bb.clone,bb.xo.Comments,!0)}static bGf(Ja,bb){bb.xo.Comments||(bb.xo.Comments={});Ca.TWd(bb.operation,bb.JBi,bb.original,bb.clone,bb.xo.Comments,!1)}static rQm(Ja,bb){bb.xo.Comments||(bb.xo.Comments={});Ja=bb.xo.Comments;if((bb=Object.keys(Ja))&&0<bb.length)for(let ha=0;ha<bb.length;ha++){const ia=
Ja[bb[ha].toString()];ia&&(ia.Qj=null,Ca.zjb(ia))}}static TWd(Ja,bb,ha,ia,va,Ka){const Xa=ha.Lc;var xa=F.ParagraphReader.Tzb(ia);xa.sort((eb,zb)=>eb.Ob.cp<zb.Ob.cp||eb.Ob.cp===zb.Ob.cp&&eb.Pc?-1:eb.Ob.cp===zb.Ob.cp&&eb.Pc===zb.Pc?0:1);const Ma=new ca.a,Na=new Y.a,pa=Ca.Qb.isFeatureEnabled(122);for(let eb of xa)if(Object(X.a)(qa.PageView,I.InteractiveViewManager.instance.xd)){var Ra=Xa.Eb(eb.Qj);if(Ra&&Ra.isConnected)if(eb.Pc)va[eb.Qj.toString()]=eb;else{var Sa=Ra.ia(P.a.iE,0);xa=Ka?Ca.zVc(Ra,ia,Ja,
bb):Ca.DVc(Ra,ia,Ja,bb);if(Ka)pa&&(Sa=B.GraphIterator.$a(ia),Sa.Bb(25)&&Sa.kd(25)&&da.a.me.raiseEvent(da.a.Dwi,new ua(Sa.currentNode,xa.getValue(P.a.iE))));else{if(pa){var ab=xa.ia(P.a.iE,0);Sa&&ab&&(Na.xb(Sa)?Na.J(Sa)!==ab&&U.ULS.sendTraceTag(589616029,327,10,"Failed to add Key {0}, Value {1} to clonedDurableIdMapping, since Key {0}, Value {2} already exists. This could affect copy/paste of tasks.",Sa,ab,Na.J(Sa)):Na.add(Sa,ab))}xa.setValue(P.a.Lfb,!0);Ra.ia(P.a.eYe,null)||(Sa=Ra.ia(P.a.WJa,null))&&
xa.setValue(P.a.eYe,Sa);xa.setValue(P.a.WJa,k.AFrameworkApplication.userSessionId)}Sa=eb.Qj.toString();ab=va[Sa];eb.Qj=xa.id;if(!Ka){eb.Vs=null;Ra=Ra.getValue(P.a.JG);const zb=xa.getValue(P.a.JG);va[Ra]=zb;if(Ra=xa.ia(P.a.mL,null))Ma.xb(Ra)||Ma.add(Ra,[]),Ma.J(Ra).push(xa)}ka.t(xa,ia.id);ia.id||U.ULS.shipAssertTag(5564305,327,!1,"Comment node has no end anchor!");ab?(ab.Qj=xa.id,Ka||(ab.Vs=null),ka.u(xa,ab.Ob.paragraph.id),delete va[Sa]):(Ca.KWb(ia,xa.id,eb.Ob.cp,!0),ka.u(xa,ia.id))}else U.ULS.sendTraceTag(592188835,
327,10,String.format("Node is null or not connected, IsNodeChildOfCommentContent:{0}, IsNull:{1}",Ca.B9k(eb.Qj),!Ra)),eb.Qj=null,Ca.zjb(eb)}else eb.Qj=null,Ca.zjb(eb);if(!Ka){for(let eb of Ma){Ja=eb.key;bb=eb.value;for(let zb of bb)zb.setValue(P.a.mL,va[Ja])}0<Na.count&&pa&&(ha=B.GraphIterator.$a(ha),ha.Bb(25)&&ha.kd(25)&&da.a.me.raiseEvent(da.a.Yyi,new ra(ha.currentNode,Na)))}ia.ik()}static $6e(Ja,bb){if(Ja.Bb(25)&&Ja.kd(25)&&!Ja.aq(16)){const ha=B.GraphIterator.$a(bb);ha.Bb(39);ha.kd(39);bb=T.a(ha.currentNode,
bb.Di().Lc,!0);Ja.Sf(bb,16)}}static a_e(Ja,bb){var ha=bb.Di().zd;ha=T.a(Ja,ha,!0);bb=B.GraphIterator.$a(bb);Ca.$6e(bb,Ja);bb.Rb(16);bb.j1(ha,1,Ja.id);return ha}static zVc(Ja,bb,ha,ia){Ca.lFc();bb=Ca.a_e(Ja,bb);bb.i6b=!0;Ca.Q4k(Ja,bb,ha,ia);return bb}static Q4k(Ja,bb,ha,ia){Ja=new J.a(B.GraphIterator.$a(Ja),B.GraphIterator.$a(bb),{});Ja.dKb=!0;ha=new n.a(ha,ia,new L.a(Ja,null));ha.eh=!0;ha.ml("ExecuteInternalCommentCopy");ha.run()}static DVc(Ja,bb,ha,ia){Ca.lFc();var va=bb.Di().zd;bb=B.GraphIterator.$a(bb);
bb.Bb(7);bb.kd(7);bb.Rb(16);va=T.a(Ja,va,!0);va.lh(P.a.JG,v.a.create().toString());va.lh(P.a.commentId,u.a.RF());let Ka=!1;Ca.Nii(va.Og(P.a.iE))?Ka=!0:va.lh(P.a.iE,Ca.wdf());bb.Sf(va,1);Ca.R4k(Ja,va,ha,ia);bb.Ei(va);bb.oE(1);bb.tdb(2);bb.Rb(2);va.setValue(P.a.JG,bb.currentNode.Og(P.a.Nc).toString());Ca.me.raiseEvent(Ca.mVm,new wa(va));Ka&&this.Lwh.add(va.id.toString());return va}static R4k(Ja,bb,ha,ia){Ja=new S.a(B.GraphIterator.$a(Ja),B.GraphIterator.$a(bb),null,null);ha=new n.a(ha,ia,Ja);ha.eh=
!0;ha.ml("ExecuteInternalCommentPaste");ha.run()}static wdf(){const Ja=u.a.Sbc(1,this.Xpi);return Ca.Nii(Ja)?Ja:Ca.wdf()}static Nii(Ja){if(!Ja)return!1;if(y.App.xa){const bb=new B.GraphIterator;bb.set(y.App.xa.jb.Yc);Ca.Cza.G0a(bb);let ha=bb.Xd();for(;ha;){if(ha.Og(P.a.iE)===Ja)return!1;ha=bb.xj()}}return!0}static nPe(Ja){Ca.me.addHandler(Ca.vTc,Ja)}}Ca.mVm="OnPaste";Ca.vTc="OnDelete";Ca.Uvd="CommentRangesToTrimOutsideSelection";Ca.Myg=new t.a;Ca.MCb=!1;Ca.Xpi=2147483646;Ca.Lwh=new Set;Object(C.a)(Ca,
"CommentEditor",null,[])},1488:function(C,N,d){var l=this&&this.BO||(Object.create?function(a,k,n,v){void 0===v&&(v=n);var u=Object.getOwnPropertyDescriptor(k,n);if(!u||("get"in u?!k.iG:u.writable||u.configurable))u={enumerable:!0,get:function(){return k[n]}};Object.defineProperty(a,v,u)}:function(a,k,n,v){void 0===v&&(v=n);a[v]=k[n]}),e=this&&this.__exportStar||function(a,k){for(var n in a)"default"===n||Object.prototype.hasOwnProperty.call(k,n)||l(k,a,n)};Object.defineProperty(N,"__esModule",{value:!0});
e(d(1746),N);e(d(1747),N);C.exports.DocumentRoleDetectionAnnotation||Object.defineProperty(C.exports,"DocumentRoleDetectionAnnotation",{enumerable:!0,get:function(){return C.exports.DocumentRoleDetectionAnnotation}});C.exports.RoleDetectionAnnotation||Object.defineProperty(C.exports,"RoleDetectionAnnotation",{enumerable:!0,get:function(){return C.exports.RoleDetectionAnnotation}});C.exports.RoleDetectionCustomMetadata||Object.defineProperty(C.exports,"RoleDetectionCustomMetadata",{enumerable:!0,get:function(){return C.exports.RoleDetectionCustomMetadata}});
C.exports.RoleDetectionSettings||Object.defineProperty(C.exports,"RoleDetectionSettings",{enumerable:!0,get:function(){return C.exports.RoleDetectionSettings}});C.exports.RoleType||Object.defineProperty(C.exports,"RoleType",{enumerable:!0,get:function(){return C.exports.RoleType}})},1491:function(C,N,d){d.d(N,"a",function(){return e});C=d(0);var l=d(8);class e{constructor(){this.Itb=this.HLf=this.Jn=null;this.$Ba=()=>{var a;return null===(a=this.Itb)||void 0===a?void 0:a.Mof()};this.fUm=(a,k)=>{k&&
k.appMode?this.$Ba():l.ULS.sendTraceTag(558999755,337,15,"MandatoryLabellingModeEventListener is called with invalid inputs.")}}get rWi(){return Box4Intl.Box4Strings.l_ShowIntentSuggestionTooltipClickOrPress}get sMf(){return 1}get K4b(){return null}KAc(){return!1}bcc(){}Onn(a){this.Itb||(this.Itb=a)}lMi(){this.HLf.execute(a=>{a.a$g(this.fUm)})}C6b(){return{returnValue:!1,type:null,data:null}}Abb(){return null}UKh(a,k,n){let v=0;n=a.length<n?a.length:n;for(let u=0;u<n;u++)if(a[u]===k)return v=u,{returnValue:!0,
WQe:v};l.ULS.sendTraceTag(588908620,341,15,"Didn't find suggestion inside suggestion group. Null suggestion: {0}",!k);return{returnValue:!1,WQe:v}}s6b(){return!1}}Object(C.a)(e,"ContextualIntentDefinitionProvider",null,[435,436])},1494:function(C,N,d){d.d(N,"a",function(){return k});C=d(0);var l=d(8),e=d(2),a=d(35);class k{static Lka(){if(0>k.Mrd){k.Mrd=0;try{const n=e.AFrameworkApplication.K.lb("OAuthManagerServiceSettings");void 0!==n&&null!==n&&""!==n&&(k.appSettings=a.b(n),k.Mrd=k.appSettings._Version);
l.ULS.sendTraceTag(572298006,3E3,100,"AppSettings: {0}",n)}catch(n){l.ULS.sendTraceTag(572298007,3E3,15,"AppSettings failed to load: {0}",n.message)}}}static UAd(){if(0>k.pyb){e.AFrameworkApplication.K.l_a&&(k.pyb=0);try{const n=e.AFrameworkApplication.K.lb("OAuthManagerDocumentSettings");void 0!==n&&null!==n&&""!==n&&(k.uEc=a.b(n),k.pyb=k.uEc._Version);l.ULS.sendTraceTag(572298008,3E3,100,"DocSettings: {0}",n)}catch(n){l.ULS.sendTraceTag(572298009,3E3,15,"DocSettings failed to load: {0}",n.message)}}}static get clientVersion(){return 7}static get appVersion(){k.Lka();
return k.Mrd}static get lZk(){k.UAd();return k.pyb}static get JQe(){k.Lka();return k.appSettings.AppMapping}static get authority(){k.Lka();return k.appSettings.Authority}static get enableConsoleLogging(){k.Lka();return k.appSettings.EnableConsoleLogging}static get KGk(){k.Lka();return 7<=k.appVersion?k.appSettings.CorePFTData:{["IsEnabled"]:!0,["Application"]:"e03a13ee-9730-4cae-8525-47559c8cf18a",["Endpoint"]:""}}static get mLc(){k.Lka();if(4<=k.appVersion){if(!k.WHg&&k.appSettings.HostPageSupportsAuth&&
(e.AFrameworkApplication.K.$("IsO365ConsumerHost")||e.AFrameworkApplication.K.$("IsO365CommercialHost")))try{const n=e.AFrameworkApplication.nHb.toLowerCase(),v=k.appSettings.GetAuthTokenFromParentOriginList;if(void 0!==v&&null!==v)for(const u of v)if((new RegExp("^"+u+"/?$")).test(n)){k.VHg=!0;break}}catch(n){l.ULS.sendTraceTag(570729249,3E3,15,"Failed to validate origin: {0}",n.message)}k.WHg=!0;return k.VHg}return e.AFrameworkApplication.K.$("UiHostSupportsAuthToken")}static get isEnabled(){k.Lka();
return k.appSettings.IsEnabled}static get QIm(){k.Lka();return k.appSettings.MockTokenForAutomation}static get YNf(){k.Lka();return k.appSettings.PromiseTimeoutInMs}static get GRn(){k.Lka();return k.appSettings.SharedAuthFilePath}static get HRn(){k.Lka();return k.appSettings.SharedAuthOrigin}static get P$i(){k.Lka();return k.appSettings.TeamsSDXEnabledSSOList}static get Jqo(){k.Lka();return k.appSettings.WacFrameTeamsElectronSSO}static get HNm(){k.UAd();return 3<=k.pyb?k.uEc.OAuthLoginHint:null}static get jyf(){k.UAd();
return 4<=k.pyb?k.uEc.LokiAlternateAuthToken:null}static get KTd(){k.UAd();return 4<=k.pyb?k.uEc.LokiAlternateAuthTokenTTL:-1}}k.Mrd=-1;k.appSettings=null;k.pyb=-1;k.uEc=null;k.VHg=!1;k.WHg=!1;Object(C.a)(k,"OAuthManagerSettings",null,[])},1495:function(C,N,d){d.d(N,"a",function(){return l});C=d(0);class l extends Sys.EventArgs{constructor(e){super();this.data=e}}Object(C.a)(l,"DesignerEventArgs",Sys.EventArgs,[])},1497:function(C,N,d){d.d(N,"a",function(){return v});C=d(0);var l=d(5),e=d(308),a=
d(1162),k=d(1056),n=d(8);class v{constructor(u,t,y,B){this.Nqm=u;this.i7l=t;this.h7l=y;this.GEi=B}Rac(u,t,y,B,G){u?(u=this.KCc(u,t,y),null!==u&&(B=this.p_e(B,u,G),this.h7l.setState(this.Nqm.value,B))):n.ULS.shipAssertTag(543499408,3016,!1,"No ParagraphNode")}KCc(u,t,y){return 0>y?(n.ULS.sendTraceTag(539018900,389,10,"Attempted to create a ParagraphRange descriptor with negative length"),null):e.a.TCc(u.ia(l.a.Nc,-1),u.ia(l.a.nj,-1),t,y,t,y,u)}p_e(u,t,y){return Object.assign(new k.a,{annotationType:u,
contentDescriptor:t,state:y})}yNd(u,t,y,B,G){if(u){var F=u.ia(l.a.Nc,-1),K=u.ia(l.a.nj,-1);-1===F||-1===K?G(null):(u=this.KCc(u,t,y),null===u?G(0):this.i7l.PTc(u,B,O=>{G(O)}))}else n.ULS.shipAssertTag(543499409,3016,!1,"No ParagraphNode")}CEi(u,t=null){u&&(t=a.a.YIk(u,t),this.GEi.S8g({Fkb:t,settingType:u})||n.ULS.shipAssertTag(521416710,3016,!1,"Persist Designer suppression setting failed"))}ghi(u){return new Promise(t=>{this.GEi.wWh(u,y=>{(null===y||void 0===y?0:y.Fkb)?t(y.Fkb):t(null)})})}}v.iOf=
"WordDesignerPullQuotesAnnotation";v.jxh="WordDesignerDefaultAnnotation";v.m3f="WordDesignerSuggestedImageAnnotation";v.xaj="WordDesignerThemeImageAnnotation";v.Y2f="WordDesignerStylizedTitleAnnotation";v.BBc="WordDesignerComplexDecoratorAnnotationType";v.Wyh="DesignerPaneSuppressionSetting";v.Zyh="DesignerTemplatesSetting";Object(C.a)(v,"PersistenceHelperImpl",null,[1053])},1498:function(C,N,d){d.d(N,"a",function(){return e});C=d(0);N=d(566);var l=d(111);class e extends N.a{constructor(){super();
this.H_=Object.assign(new l.a,{T_:e.getTypeName(),B_:e.getBaseTypes()})}static getTypeName(){return"AugLoop_Core_DeleteOperation"}static getBaseTypes(){return["AugLoop_Core_Operation"]}}Object(C.a)(e,"DeleteOperation",N.a,[])},1499:function(C,N,d){d.d(N,"a",function(){return l});const l={Roh:"CommentDeepLinkNavigationFailed",ZXe:"CommentDataLoss",uBc:"CommentExperienceDegraded",F8e:"CommentsFeatureUsage",hYe:"CommentThreadInProgress",Vvd:"CommentReplyInProgress",Uoh:"CommentEditInProgress",Ivd:"CommentDeepLink",
Poh:"CommentCommit",Qvd:"CommentLoad",iph:"CommentInitialization"}},1500:function(C,N,d){d.d(N,"a",function(){return l});C=d(0);class l{constructor(e,a,k,n,v=null,u=null,t=null,y=0,B=0){this.V2=this.hgc=this.oDa=this.EQ=null;this.UG=y;this.J2d=e;this.fOa=a;this.J3a=k;n&&(this.EQ=n);null!=v&&(this.oDa=v);null!=u&&(this.hgc=u);t&&(this.V2=t);this.shapeId=B}}Object(C.a)(l,"AnchorData",null,[])},1503:function(C,N,d){function l(O){return 1===(null===O||void 0===O?void 0:O.Jq)||3===(null===O||void 0===
O?void 0:O.Jq)}C=d(0);var e=d(37),a=d(57),k=d(36),n=d(8),v=d(1579),u;(function(O){O[O.initial=0]="initial";O[O.sqo=.1]="viewingOriginal";O[O.yek=.5]="applying";O[O.applied=1]="applied";O[O.accepted=2]="accepted";O[O.rejected=3]="rejected";O[O.ZJo=4]="roleChanged";O[O.mGo=5]="invalidated"})(u||(u={}));Object(C.b)("ReviewIntentState",u);var t=d(144);d.d(N,"d",function(){return B});d.d(N,"e",function(){return l});d.d(N,"b",function(){return G});d.d(N,"c",function(){return F});d.d(N,"a",function(){return K});
class y{constructor(O,H,I=null,J,L=!0){this.id=O;this.Jq=H;this.ZF=I;this.Re=J;this.Eam=L;this.udi=!1;this.Tji=e.a.lf()}Z3h(){return!1}nhb(O){var H=this.jua,I=u;a:switch(O){case u.sqo:var J=u.rejected;break a;case u.yek:J=u.applied;break a;default:J=O}H.call(this,I[J]);this.FTd(O)}FTd(O){1===O&&this.ZF&&this.Re&&(this.Eam?(this.Re.i9l()&&this.ZF.execute(H=>{H.logActivity(t.a.Etj,null)}),2===this.Jq&&this.Re.vlm()?this.ZF.execute(H=>{H.logActivity(t.a.Ttj,null)}):1===this.Jq&&this.Re.uhm()?this.ZF.execute(H=>
{H.logActivity(t.a.Otj,null)}):0===this.Jq&&this.Re.Gdm()&&this.ZF.execute(H=>{H.logActivity(t.a.Itj,null)})):4===this.Jq&&this.Re.ybm()&&this.ZF.execute(H=>{H.logActivity(t.a.Gtj,null)}))}ATd(){6E4>e.a.lf()-this.Tji?this.jua("removed"):n.ULS.sendTraceTag(539109067,3016,50,"ID: {0}, Type: {1}, State: {2}",this.id,this.Jq,"removedButKept")}Qxm(){this.udi||(this.jua("hovered"),this.udi=!0)}jua(O){this.Tji=e.a.lf();n.ULS.sendTraceTag(540357460,3016,50,"ID: {0}; Type: {1}, State: {2};",this.id,this.Jq,
O);a.a(t.a.DUk,!0,void 0,[Object.assign(new k.a,{name:"suggestionType",int64:this.Jq}),Object.assign(new k.a,{name:"ID",string:this.id.toString()}),Object.assign(new k.a,{name:"State",string:O})])}}Object(C.a)(y,"DesignerSuggestion",null,[]);class B extends y{constructor(O,H=1,I=null,J,L=!1,S=0,E=""){super(O,H,I,J,L);this.G1a=S;this.SVc=E}}Object(C.a)(B,"PullQuoteSuggestion",y,[]);class G extends y{constructor(O,H,I,J=null,L){super(O,2,J,L);this.jQ=H;this.baseUrl=I;this.selectedIndex=0;this.Dfc=t.a.k2l}H0l(){n.ULS.shipAssertTag(527708514,
3016,this.Dfc===t.a.vNm,`${this.Dfc}`);this.Dfc=Math.min(this.jQ.length,t.a.zUd)}Z3h(){return this.Dfc<Math.min(this.jQ.length,t.a.zUd)}oAb(O){return O>=this.jQ.length?(n.ULS.shipAssertTag(527708515,3016,!1),null):this.baseUrl+this.jQ[O].imageId}Hif(O){return O>=this.jQ.length?(n.ULS.shipAssertTag(527708544,3016,!1),null):this.baseUrl+this.jQ[O].thumbnailId}lT(O){return O>=this.jQ.length?(n.ULS.shipAssertTag(527708545,3016,!1),null):this.jQ[O].altText?this.jQ[O].altText:this.jQ[O].category===v.SuggestionCategory.AbstractImage?
WordEditorIntl.WordEditorStrings.L_DesignerImageSuggestionAbstractImageAltText:WordEditorIntl.WordEditorStrings.L_DesignerDecorativeImage}$ul(O){var H;return O>=this.jQ.length?(n.ULS.shipAssertTag(527210446,3016,!1),0):null!==(H=this.jQ[O].score)&&void 0!==H?H:0}}Object(C.a)(G,"ImageSuggestion",y,[]);class F extends y{constructor(O,H=null,I,J,L=null){super(O,0,H,I,J);this.metadata=L;this.hri=!1}nhb(O){this.hri||(this.hri=!0,this.metadata&&a.a(t.a.lHk,!0,0,this.metadata.concat([Object.assign(new k.a,
{name:"ID",string:this.id.toString()})])));super.nhb(O)}}Object(C.a)(F,"InconsistencySuggestion",y,[]);class K extends y{constructor(O,H=null,I,J=!1,L){super(O,4,H,I,J);this.j3m=L}nhb(O){this.b4n=O;super.nhb(O)}}Object(C.a)(K,"DesignerPasteSuggestion",y,[])},1504:function(C,N,d){d.d(N,"a",function(){return G});C=d(0);var l=d(16),e=d(125),a=d(9),k=d(551),n=d(49),v=d(19),u=d(25),t=d(247),y=d(11),B=d(20);class G{constructor(F,K,O,H,I){this.SBb=F;this.XYa=K;this.nrb=O;this.Cia=H;this.Vd=I;this.POg=0;
this.l7a=null;this.PTj=!1;this.xOg=!0;this.qJg=null;this.uSc=this.efd=!0;this.FKg=!1;this.Rsc=F?F.innerText:y.ParagraphReader.text(K)}get OB(){throw Error.notImplemented("The inherit class should have the default value.");}set OB(F){}get M8b(){return this.POg}n1i(F){this.POg=F}get kb(){return this.l7a}set kb(F){this.l7a=F}get JF(){return this.nrb}get VZ(){return this.Cia}get Nci(){return this.FKg}get Cii(){return!1}get Oua(){return this.Rsc}get BVn(){return!0}invoke(){this.FKg=!0;if(this.SBb&&this.SBb.parentNode&&
!this.OB){var F=this.SBb.innerText;if(this.uSc&&l.a.substring(this.Rsc,this.nrb,this.Cia)!==l.a.substring(F,this.nrb,this.Cia))return 0;this.nyb(this.SBb);this.n1i(this.SBb.innerText.length-F.length);return 1}this.efd||e.a.instance.Zb("MatchTextIsNotTheSame",{["Reason"]:"MatchTextIsNotTheSame"});if(!this.xOg)return e.a.instance.Zb("AbortedAction",{["Reason"]:this.qJg}),0;var K=y.ParagraphReader.text(this.XYa);F=K.length;var O=this.Rsc.length,H=l.a.substring(this.Rsc,this.nrb,this.Cia).trimEnd();K=
l.a.substring(K,this.nrb,this.Cia).trimEnd();this.BVn&&H===K&&this.Cia>O&&(this.Cia=O);if(this.uSc&&H!==K)if(O=H.replace(RegExp('"',"g"),""),O===l.a.substr(K,0,O.length))this.Cia-=2;else return 0;if(B.a.instance.J(4)&&a.App.ud.Mp&&k.CoauthLockEditor.getInstance().V2a(G.Zf.q2b(this.XYa)))return 0;O=new n.GraphTransaction(15);O.Db(this.XYa);O.Al=this.commandId;this.Eka(this.XYa);this.n1i(y.ParagraphReader.textLength(this.XYa)-F);this.l7a&&!this.PTj&&v.SelectionEditor.Qm(this.l7a)&&(K=this.l7a.Qa,F=
K.cpBegin,H=K.cpEnd,K=K.node,K===this.XYa&&this.M8b&&(F>=this.Cia&&(F+=this.M8b),H>=this.Cia&&(H+=this.M8b),this.l7a=u.SelectionFactory.DN(K,F,H)));O.dispose();return 2}jkj(){this.efd=this.Ylh()}nyb(){}Ylh(){var F=y.ParagraphReader.text(this.XYa);const K=l.a.substring(this.Rsc,this.nrb,this.Cia).trimEnd();F=l.a.substring(F,this.nrb,this.Cia).trimEnd();return K===F}static get Zf(){return t.a.instance}}Object(C.a)(G,"AAutoCorrectAction",null,[455])},1505:function(C,N,d){d.d(N,"a",function(){return a});
C=d(0);var l=d(34),e=d(8);class a{constructor(k){this.Rx=k}static create(k){if(!k)return e.ULS.shipAssertTag(575930373,3016,!1),null;k=l.a.create(k);return new a(k)}}Object(C.a)(a,"ShowReviewArgs",null,[])},1509:function(C,N,d){d.d(N,"c",function(){return a});d.d(N,"a",function(){return k});d.d(N,"b",function(){return n});C=d(0);var l=d(1497);class e{constructor(v,u,t){this.suggestion=v;this.Jq=u;this.paragraphNode=t}get role(){switch(this.Jq){case 1:case 3:return 27;case 2:return 28;default:return 1}}}
Object(C.a)(e,"AddEnhancementActionData",null,[]);class a extends e{constructor(v,u,t,y,B,G=1){super(v,G,u);this.G1a=t;this.SVc=y;this.callback=B}}Object(C.a)(a,"AddPullQuoteActionData",e,[]);class k extends e{constructor(v,u,t=0){super(v,2,u);this.Lla=t}}Object(C.a)(k,"AddCoverPhotoActionData",e,[]);class n{constructor(v,u,t,y,B){this.suggestion=v;this.lu=u;this.A5b=t;this.PMc=y;this.isd=B}get annotationType(){switch(this.suggestion.Jq){case 1:case 3:return l.a.iOf;case 2:return l.a.m3f;default:return l.a.jxh}}get uNa(){return this.lu&&
1<=this.lu.length?this.lu[0]:null}}Object(C.a)(n,"AddDesignerSuggestionActionData",null,[])},1510:function(C,N,d){d.d(N,"a",function(){return l});C=d(0);class l{constructor(e,a,k,n=!1,v=!1,u=!1,t=!1,y=null){this.Rx=e;this.source=a;this.XMa=k;this.zja=n;this.efc=v;this.jFh=u;this.tKa=t;this.Fn=y}}Object(C.a)(l,"ContextualIntentInvocationParameters",null,[])},1512:function(C,N,d){C=d(0);var l=d(8),e=d(44),a=d(2),k=d(124),n=d(96),v=d(7),u=d(68),t=d(57),y=d(103);d(158);class B{constructor(){this.secondActionButtonProps=
this.firstActionButtonProps=this.messageTitle=this.message=null;this.isMultiline=!1;this.messageBarType=0;this.closeable=!1;this.messageBarIconProps=this.linkProps=this.dismissButtonAriaLabel=this.onDismiss=null}}Object(C.a)(B,"MessageBarProps",null,[]);var G=d(1390),F=d(171),K=d(1018),O=d(27),H=d(141),I=d(121),J=d(13);d.d(N,"a",function(){return L});class L{constructor(S,E,P){this._message=this._title=null;this.Sue=this.wOb=!1;this.Aie=0;this.yxa="";this._image=0;this.IM=this.o0=this.eGa=this._link=
this.$qb=this.ekc=this.dkc=this.ckc=this.bkc=this.JV=this.Lha=this.TIa=this.C7a=null;this.bOb=this.aOb=!1;this.Awg=this.cje="";this.aje=!1;this.Bwg=this.gje="";this.eje=!1;this.fje=this.bje=null;this.kSb=!1;this.Qxe=this.arb="";this.Zqb=null;this.Apc=this.tJg=!1;this.pWa=this.aka=this.Nla=this.AY=this.tP=null;this.errorCode=0;this.fbh=this.visible=!1;this.title=S;this.message=E;this.Sla=P;this.id=0;this.image=1;this.wPd=!0;this.jfh=5}get htmlElement(){return this.AY}get wPd(){return this.Sue}set wPd(S){this.Sue=
S}get jfh(){return this.Aie}set jfh(S){this.Aie=S}get title(){return this._title}set title(S){this._title!==S&&(this._title=S,this.TIa&&(this.TIa.innerText=this._title))}get message(){return this._message}set message(S){this._message!==S&&(this._message=S,this.Lha&&(this.Lha.innerText=this._message))}get image(){return this._image}set image(S){this._image=S;4!==this._image&&(this.Nla="")}get imageAltText(){return this.yxa}set imageAltText(S){this.yxa=S}get closeable(){return this.wOb}set closeable(S){this.wOb!==
S&&(this.wOb=S,this.eGa&&(this.eGa.style.display=this.wOb?"table-cell":"none"))}get RJi(){return a.AFrameworkApplication.K.$("ReactBusinessBarIsEnabled")}get apo(){return a.AFrameworkApplication.K.$("Fluent2StyleIsEnabled")}addButton(S,E,P,T=!1){this.cje=S;this.bje=E;this.aOb=!0;this.Awg=P;this.aje=T}i9g(S,E){this.gje=S;this.fje=E;this.bOb=!0;this.Bwg="";this.eje=!1}j3j(S){this.arb=Box4Intl.Box4Strings.l_BusinessBarODTDocumentDetailsLink;this.Qxe=S;this.kSb=!0}Kqd(S,E){this.arb=S;this.Zqb=E;this.kSb=
!0}MMk(){var S=H.a.dla(a.AFrameworkApplication.K.lb("VNextStyleOptOutCookieName"),!1);S=this.apo&&!S;this.AY=document.createElement("div");this.htmlElement.className=String.format("{0} {1} {2}",L.ywg,L.KRj,S?L.CZj:"");this.htmlElement.setAttribute("UNSELECTABLE","on");void 0!==this.pWa&&null!==this.pWa&&(this.htmlElement.id=this.pWa);S=()=>{F.UISurfaces.ezl().then(E=>{this.tP.Zsf||(E.initializeMessageBarInStore(),this.tP.Zsf=!0);const P=Object.assign(new B,{message:this._message,messageTitle:this._title,
isMultiline:this.Sue,messageBarType:this.Aie});if(this.wOb){P.closeable=!0;var T=this._message+". "+CommonUIStrings.l_DialogClose;this._title&&(T=this._title+". "+T);P.dismissButtonAriaLabel=T;P.onDismiss=()=>{this.BXe(this)}}4===this._image&&(P.messageBarIconProps={["iconName"]:this.Nla});this.kSb&&(P.linkProps={["type"]:"AppLinkProps",["text"]:this.arb,["handler"]:{["href"]:this.Qxe,["target"]:"_blank"}},this.Zqb&&(T=Object(e.a)(this,this.nUm,"onMessageBarLinkClicked"),P.linkProps.handler=T));this.aOb&&
(P.firstActionButtonProps=new G.a(this.cje,()=>{this.$nk(this)}));this.bOb&&(P.secondActionButtonProps=new G.a(this.gje,()=>{this.fok(this)}));E.createNewMessageBarWithCallback?E.createNewMessageBarWithCallback(this.htmlElement,P,()=>{a.AFrameworkApplication.ua.RSc()}):E.createNewMessageBar(this.htmlElement,P);return null}).catch(()=>{l.ULS.sendTraceTag(595096981,324,10,"Failed to load React Message Bar API");return null})};k.a.get_instance().isCompleted(7)?S():k.a.get_instance().tl(7,S);this.Sla&&
(a.AFrameworkApplication.ua.ez.mb(v.a.click,this.htmlElement,Object(e.a)(this,this.onClick,"onClick")),a.AFrameworkApplication.ua.my.uE(v.a.oh,this.htmlElement,Object(e.a)(this,this.EFf,"onBodyKeyUp"),this),this.tJg&&!this.Apc&&(a.AFrameworkApplication.ua.Yva.mb(this.htmlElement,Object(e.a)(this,this.onClick,"onClick"),null),this.Apc=!0));return this.htmlElement}createElement(){a.AFrameworkApplication.naa("Microsoft.Office.Web.SessionSettings.IWacWordReactBusinessBarSettings");if(this.RJi)return this.MMk();
this.AY=document.createElement("div");this.htmlElement.className=L.ywg;this.htmlElement.setAttribute("UNSELECTABLE","on");void 0!==this.pWa&&null!==this.pWa&&(this.htmlElement.id=this.pWa);this.C7a=null;if(0!==this._image){this.C7a=document.createElement("span");this.C7a.className="WACBusinessBarIcon";this.htmlElement.appendChild(this.C7a);var S=null;let E=null;switch(this._image){case 2:S=L.GCj;E=CommonUIStrings.l_DialogError;break;case 1:S=L.d_j;E=CommonUIStrings.l_DialogWarning;break;case 3:S=
L.kqb;E=CommonUIStrings.l_DialogInfo;break;case 4:S=this.Nla,E=this.yxa}this.C7a.title=E;this.C7a.setAttribute(O.a.Ch,O.a.WRe);this.C7a.appendChild(n.createClusteredImage(24,24,S,L.$Gj,!0,""))}S=I.a.create().toString();this.JV=document.createElement("div");this.JV.id="BBTitleAndBody"+S;this.JV.className=L.Wxj;this.JV.tabIndex=0;this._title&&(this.TIa=document.createElement("p"),this.TIa.innerText=this._title,this.TIa.className=L.Xxj+" UIFontBold",this.TIa.id="BBTitle"+S,this.TIa.setAttribute("UNSELECTABLE",
"on"),this.JV.setAttribute(O.a.mda,this.TIa.id),this.JV.appendChild(this.TIa));this.Lha=document.createElement("p");this.Lha.className=L.Pxj;this.Lha.innerText=this._message;this.Lha.id="BBBody"+S;this.Lha.setAttribute("UNSELECTABLE","on");this.Lha.style.width="100%";this.JV.setAttribute(O.a.u1,this.Lha.id);this.aOb&&this.N7g(this.Lha,this.Awg);this.bOb&&this.N7g(this.Lha,this.Bwg);this.JV.appendChild(this.Lha);S=document.createElement("div");S.setAttribute(O.a.Ch,O.a.PRe);S.appendChild(this.JV);
this.htmlElement.appendChild(S);this.aOb&&(this.ckc=document.createElement("span"),this.bkc=document.createElement("button"),this.CWa(this.ckc,this.bkc,this.cje,Object(e.a)(this,this.iih,"buttonOneClickHandler")));this.bOb&&(this.ekc=document.createElement("span"),this.dkc=document.createElement("button"),this.CWa(this.ekc,this.dkc,this.gje,Object(e.a)(this,this.kih,"buttonTwoClickHandler")));this.kSb&&(this.$qb=document.createElement("span"),this.$qb.className=L.Vxj,this._link=document.createElement("a"),
this._link.className=K.a.Uxj,this._link.innerText=this.arb,this.Zqb?(this._link.tabIndex=0,a.AFrameworkApplication.ua.ez.uE(v.a.click,this._link,Object(e.a)(this,this.cli,"linkClickHandler"),this),a.AFrameworkApplication.ua.my.uE(v.a.oh,this._link,Object(e.a)(this,this.dyi,"onLinkKeyUp"),this)):(this._link.href=this.Qxe,this._link.target="_blank"),this.$qb.appendChild(this._link),this.htmlElement.appendChild(this.$qb));a.AFrameworkApplication.ua.ez.mb(v.a.click,this.htmlElement,Object(e.a)(this,this.onClick,
"onClick"));a.AFrameworkApplication.ua.my.uE(v.a.oh,this.JV,Object(e.a)(this,this.EFf,"onBodyKeyUp"),this);this.tJg&&!this.Apc&&(a.AFrameworkApplication.ua.Yva.mb(this.htmlElement,Object(e.a)(this,this.onClick,"onClick"),null),this.Apc=!0);this.wOb&&(this.eGa=document.createElement("span"),this.eGa.className=L.Vyj,this.o0=document.createElement("a"),this.o0.className=L.Wyj,this.o0.tabIndex=0,this.o0.title=CommonUIStrings.l_DialogClose,this.o0.setAttribute(O.a.Ch,O.a.t1),this.IM=n.createClusteredImage(16,
16,L.Xyj,"",!0,""),this.o0.appendChild(this.IM),this.eGa.style.display="table-cell",this.eGa.appendChild(this.o0),this.htmlElement.appendChild(this.eGa),a.AFrameworkApplication.ua.ez.uE(v.a.click,this.o0,Object(e.a)(this,this.rwi,"onCloseClick"),this),a.AFrameworkApplication.ua.my.uE(v.a.oh,this.o0,Object(e.a)(this,this.swi,"onCloseKeyUp"),this));return this.htmlElement}ZWn(){this.JV&&this.JV.setAttribute(O.a.zz,O.a.jL)}N7g(S,E){if(E&&""!==E){var P=document.createElement("span");P.className=L.ATj;
P.innerText=E;S.appendChild(P)}}CWa(S,E,P,T){S.className=L.Rxj;E.setAttribute("type","button");E.className=L.Qxj;E.innerText=P;S.appendChild(E);this.htmlElement.appendChild(S);a.AFrameworkApplication.ua.ez.uE(v.a.click,E,T,this)}TRi(){this.RJi||(this.JV.style.whiteSpace="nowrap",this.closeable?this.eGa.style.width="auto":this.kSb?this.$qb.style.width="auto":this.bOb?this.ekc.style.width="auto":this.aOb?this.ckc.style.width="auto":this.JV.style.width="auto",this.htmlElement.clientWidth>this.tP.htmlElement.clientWidth?
this.JV.style.whiteSpace="normal":this.closeable?this.eGa.style.width="100%":this.kSb?this.$qb.style.width="100%":this.bOb?this.ekc.style.width="100%":this.aOb?this.ckc.style.width="100%":this.JV.style.width="100%")}r7f(S,E){if(y.a.t$b()){var P={};P.WacSessionId=a.AFrameworkApplication.userSessionId;P.ActionName="BusinessBar"+S;P.InputMethod=E;l.ULS.sendTraceTag(35489761,207,50,JSON.stringify(P))}}L6(S,E,P,T){this.r7f(S,P);y.a.Egb()&&t.c(E,!0,t.e,T,10)}iih(S){this.bje(S.yp);this.L6("ButtonOne",J.a.$hh,
"Mouse",2);this.aje&&(this.L6("Close",J.a.zYb,"Mouse_ButtonOne",2),this.close(S));return!0}$nk(S){this.bje(S);this.L6("ButtonOne",J.a.$hh,"Mouse",2);this.aje&&(this.L6("Close",J.a.zYb,"Mouse_ButtonOne",2),this.BXe(S))}kih(S){this.fje(S.yp);this.L6("ButtonTwo",J.a.aih,"Mouse",2);this.eje&&(this.L6("Close",J.a.zYb,"Mouse_ButtonTwo",2),this.close(S));return!0}fok(S){this.fje(S);this.L6("ButtonTwo",J.a.aih,"Mouse",2);this.eje&&(this.L6("Close",J.a.zYb,"Mouse_ButtonTwo",2),this.BXe(S))}cli(S){this.Zqb(S.yp);
this.L6("Link",J.a.eih,"Mouse",2);return!0}nUm(){this.Zqb(null)}dyi(S){return S.Ib.keyCode!==u.a.es||S.Ib.altKey?!1:(this.Zqb(S.yp),this.L6("Link",J.a.eih,"Keyboard",1),!0)}EFf(S){return S.Ib.keyCode===u.a.es&&!S.Ib.altKey&&this.Sla?(this.Sla(S.yp,S),this.L6("Invoke",J.a.dih,"Keyboard",1),!0):!1}dispose(){this.htmlElement&&(a.AFrameworkApplication.ua.ez.sc(v.a.click,this.htmlElement,Object(e.a)(this,this.onClick,"onClick")),this.Apc&&a.AFrameworkApplication.ua.Yva.sc(this.htmlElement,Object(e.a)(this,
this.onClick,"onClick")));this.o0&&(a.AFrameworkApplication.ua.ez.sc(v.a.click,this.o0,Object(e.a)(this,this.rwi,"onCloseClick")),a.AFrameworkApplication.ua.my.sc(v.a.oh,this.o0,Object(e.a)(this,this.swi,"onCloseKeyUp")));this.bkc&&a.AFrameworkApplication.ua.ez.sc(v.a.click,this.bkc,Object(e.a)(this,this.iih,"buttonOneClickHandler"));this.dkc&&a.AFrameworkApplication.ua.ez.sc(v.a.click,this.dkc,Object(e.a)(this,this.kih,"buttonTwoClickHandler"));this._link&&this.Zqb&&(a.AFrameworkApplication.ua.ez.sc(v.a.click,
this._link,Object(e.a)(this,this.cli,"linkClickHandler")),a.AFrameworkApplication.ua.my.sc(v.a.oh,this._link,Object(e.a)(this,this.dyi,"onLinkKeyUp")));this.JV&&a.AFrameworkApplication.ua.my.sc(v.a.oh,this.JV,Object(e.a)(this,this.EFf,"onBodyKeyUp"));this.tP=this.o0=this.eGa=this.IM=this.$qb=this._link=this.ekc=this.dkc=this.ckc=this.bkc=this.JV=this.Lha=this.AY=this.TIa=this.C7a=this.yxa=null}onClick(S){this.L6("Invoke",J.a.dih,"Mouse",2);return!!this.Sla&&this.Sla(this,S)}rwi(S){this.L6("Close",
J.a.zYb,"Mouse",2);this.close(S);return!0}swi(S){return S.Ib.keyCode!==u.a.es||S.Ib.altKey?!1:(this.L6("Close",J.a.zYb,"Keyboard",1),this.close(S),!0)}close(S){const E=S.yp;this.tP.removeEntry(E);this.y$h(E,S.gg)}y$h(S,E){if(S.aka){const P=a.AFrameworkApplication.ya;P.IG=10;P.q6=E;S.aka(S);P.IG=0;P.q6=0}}BXe(S){S&&this.tP&&(this.tP.removeEntry(S),this.y$h(S,0))}}L.ywg="WACBusinessBarEntry";L.Xxj="WACBusinessBarTitle";L.Pxj="WACBusinessBarBody";L.Wxj="WACBusinessBarTitleBodyHolder";L.Rxj="WACBusinessBarButtonHolder";
L.Qxj="WACBusinessBarButton";L.Vxj="WACBusinessBarLinkHolder";L.Wyj="WACBusinessBarClose";L.Vyj="WACBusinessBarCloseHolder";L.Xyj="BusinessBarClose_16x16x32";L.$Gj="WACBusinessBarImage";L.ATj="WACScreenReaderOnly";L.GCj="CancelRequest_24x24x32";L.d_j="Risks_24x24x32";L.kqb="Info_24x24x32";L.KRj="ReactBusinessBarEntry";L.CZj="VNextBusinessBarEntry";Object(C.a)(L,"BusinessBarEntry",null,[260,9])},1515:function(C,N,d){d.r(N);d.d(N,"FindManagerHelper",function(){return v});C=d(0);var l=d(8),e=d(120),
a=d(9),k=d(181),n=d(1008);d=d(1762);class v extends d.a{constructor(){super()}get Yc(){return a.App.xa.jb.Yc}get Ui(){return a.App.xa.jb.Yc.zd}get Pta(){return a.App.xa.jb.Pta()}get Hpf(){return a.App.xa.jb.Ic.wi}JOe(u){a.App.Xj.al.kJa(u)}qVd(u,t,y){return n.b(u,t,y)}W6f(u,t,y){if(1===y){if(!v.qh.X6f(u))return!1}else if(!(u.Qe===t||u.Bb(t)&&u.kd(t)))return!1;return Object(e.a)(114,u.currentNode)||this.qVd(u,t,y)?!0:!1}uLa(u){return this.Ui.Eb(u).uLa()}hgi(u,t,y,B){if(!u||u.matchCase!==y.matchCase||
u.matchWholeWord!==y.matchWholeWord||B.length!==t.length)return!0;for(u=0;u<B.length;u++){if(B[u]!==t[u])return!0;if(y.matchCase){if(B[u]!==t[u])return!0}else if(B[u].toLocaleLowerCase()!==t[u].toLocaleLowerCase())return!0}return!1}sgi(u,t,y,B){if(!u||u.matchWholeWord&&!y.matchWholeWord||u.matchCase&&!y.matchCase||B.length!==t.length)return!1;if(u.matchWholeWord)return u.matchCase?t[0]===B[0]:B[0].toLocaleLowerCase()===t[0].toLocaleLowerCase();for(let G=0;G<B.length;G++)if(u.matchCase){if(!B[G].startsWith(t[G]))return!1}else if(!B[G].toLocaleLowerCase().startsWith(t[G].toLocaleLowerCase()))return!1;
u.matchCase===y.matchCase&&u.matchWholeWord===y.matchWholeWord&&1===t.length&&l.ULS.sendTraceTag(4069025,313,50,"{0}",{["IncrementalSearchTriggeredQueryLength"]:y.text.length});return!0}f3d(u,t,y){const B=a.App.Xj.al.Se(12);B.lp(u);B.ys(t);B.zv(y)}static get qh(){return k.PageNavigator.instance}static get instance(){v.znc||(v.znc=new v);return v.znc}}v.znc=null;Object(C.a)(v,"FindManagerHelper",d.a,[])},1516:function(C,N,d){d.d(N,"a",function(){return e});C=d(0);var l=d(2);class e{constructor(){this.currentDocumentPath=
l.AFrameworkApplication.K.lb("EditDocInClientUrl")}}Object(C.a)(e,"SmartLookupApplicationInterface",null,[])},1517:function(C,N,d){d.d(N,"a",function(){return J});C=d(0);var l=d(720),e=d(6),a=d(1708),k=d(1754),n=d(1755),v=d(206),u=d(11),t=d(49),y=d(133),B=d(181),G=d(658),F=d(5),K=d(595),O=d(89),H=d(157),I=d(550);class J{constructor(L,S,E,P,T){J.sOd=!1;this.KE=L;this.QBe=S;this.PBe=E;this.Xc=P;this.AEj=T}iKn(L,S){this.KE.ama(L)&&L.properties.setValue(F.a.Zka,S)}Y0b(){if(!J.sOd){var L=this.UVh();for(var S=
L.Rb(7);S;S=L.Wi(7))for(S=L.Rb(8);S;S=L.Wi(8));J.sOd=!0}}UVh(){const L=this.Xc.Dk();L.set(this.AEj());J.qh.zQ(L);return L}pu(){const L=this.UVh();this.PBe.sVd(L);this.Qtn(L.currentNode);J.sOd=!1}L9m(L){this.Y0b();if(L.isConnected){var S=this.h6(L);if(S=this.KE.OFd(L,S)){var E=this.Xc.Dk();E.set(S);E.Bb(25);L.anchor&&(E.set(L),E.Bb(37),E.Eg())}}}J2k(L,S){if(L.Bb(25)&&L.kd(25)&&!L.aq(7)){const E=e.GraphIterator.$a(S);E.Bb(37);E.kd(37);S=K.a(E.currentNode,S.Di().Lc,!0);L.Sf(S,7)}}V4k(L,S,E,P){L=new a.a(e.GraphIterator.$a(L),
e.GraphIterator.$a(S),{});L.dKb=!0;E=new l.a(E,P,new k.a(L,null));E.eh=!0;E.ml("ExecuteInternalFootnoteEndnoteCopy");E.run()}a_e(L,S){S=S.Ob.paragraph;var E=S.Di().zd;E=K.a(L,E,!0);S=e.GraphIterator.$a(S);this.J2k(S,L);S.Rb(7);S.Sf(E,8);return E}zVc(L,S,E,P){this.Y0b();const T=this.h6(L);if(!this.KE.OFd(this.KE.bWh(L),T))return null;S=this.a_e(L,S);this.V4k(L,S,E,P);return S}DVc(L,S,E,P){this.Y0b();var T=S.Ob.paragraph;const U=T.Di().zd;T=e.GraphIterator.$a(T);T.Bb(7);T.kd(7);this.oVd(T,S.h6());S=
K.a(L,U,!0);T.Sf(S,8);this.W4k(L,S,E,P);return S}W4k(L,S,E,P){L=new n.a(e.GraphIterator.$a(L),e.GraphIterator.$a(S),null,null);E=new l.a(E,P,L);E.eh=!0;E.ml("ExecuteInternalFootnoteEndnotePaste");E.run()}oVd(L,S){L.Rb(7);this.KE.Zci(L,S)||L.vf(7)}bTh(L,S){const E=this.Xc.Dk();E.set(S);E.Bb(7);E.kd(7);this.oVd(E,L);return E}KUh(L,S,E){return this.SUh(L,S,E,!1)}OEl(L,S,E){return this.SUh(L,S,E,!0)}SUh(L,S,E,P){var T=this.Xc.Dk();let U=null,X=!1;T.set(L);T.qo();T.kd(8);T.Xd();for(T=v.a.Kr(T,T.g4c(8));T.moveNext();){if(u.ParagraphReader.nc(T.currentNode)){const ca=
T.currentNode;var Y=O.i(ca,7);for(let da of Y){if(ca===L){Y=da.Ob.cp;if(P&&Y>=S)return U;Y>=S&&-1!==S&&(X=!0)}if(da.h6()===E){if(!P&&X)return da;U=da}}ca===L&&(X=!0)}if(P&&X)return U}return null}Qtn(L){const S=new t.GraphTransaction(3);S.Db(L);L=v.a.Wp(J.qh.ju(L));let E=1,P=1;for(;L.moveNext();){var T=L.currentNode;if(T&&u.ParagraphReader.nc(T)){T=O.i(T,7);for(let U of T){T=U.h2();const X=U.h6()?E++:P++;this.iKn(T,X)}}}S.dispose()}h6(L){return this.KE.ama(L)?L.properties.getValue(F.a.a6):0}static ctl(){return new J(I.a.instance,
y.PageReader.instance,B.PageNavigator.instance,new G.a,J.Fgl)}static Fgl(){return H.App.fm.jb.Yc}static get qh(){return B.PageNavigator.instance}static get instance(){return null!=J.Zlg?J.Zlg:J.Zlg=J.ctl()}}J.sOd=!1;Object(C.a)(J,"FootnoteEndnoteEditorInteractive",null,[426])},1521:function(C,N,d){C=d(0);class l{static nAl(){return l._nextEventReceiverId++}}l._nextEventReceiverId=0;Object(C.a)(l,"EventReceiverIdCounter",null,[]);d.d(N,"a",function(){return e});class e{constructor(a,k){this.gQb=a;
this._id=l.nAl();this.OSj=k}get id(){return this._id}notify(a,k){this.OSj(a,k)}fk(a,k){return this.gQb.Sbn(a,k?this:null)}}Object(C.a)(e,"EventReceiver",null,[326])},1523:function(C,N,d){d.d(N,"a",function(){return K});C=d(0);var l=d(8),e=d(9),a=d(551),k=d(40),n=d(59),v=d(1908),u=d(2),t=d(1485),y=d(1499),B=d(110),G=d(601),F=d(1476);class K{static Pzm(){const O=document.getElementsByClassName(G.a.AJf);if(O&&O.length){var H=O[0].clientWidth;for(let I=1;I<O.length;I++){if(O[I].clientWidth!==H||I===O.length-
1){l.ULS.sendTraceTag(540160401,327,50,"{0}:NoOfContainers={1}",O[I].clientWidth-H,O.length);break}H=O[I].clientWidth}}}static Gcg(O,H,I){O&&(O=e.App.ud.Lq.rff(O),a.CoauthLockEditor.getInstance().V2a(O)&&l.ULS.sendTraceTag(540160402,327,15,`Comment with ObjectId: ${H.objectId} added to a locked ${I?"start":"end"} paragraph. Lock Type ${O.Type.toString()}`))}static Upo(O,H,I){var J=H.Eb(n.a.Of(O.objectId));if(J){var L=t.a.h$(J,H,!0);H=t.a.h$(J,H,!1);null!==L&&void 0!==L&&L.Vs||(L=F.k(J),l.ULS.sendTraceTag(540160404,
327,15,`CommentRangeStart failed to save. startParaId: ${L}, CommentObjectId: ${O.objectId}`),K.nmi(I));null!==H&&void 0!==H&&H.Vs||(J=F.h(J),l.ULS.sendTraceTag(540160405,327,15,`CommentRangeEnd failed to save. endParaId: ${J}, CommentObjectId: ${O.objectId}`),K.nmi(I))}else l.ULS.sendTraceTag(540160403,327,15,`Commited Comment missing CommentNode graph object ObjectId: ${O.objectId}`)}static nmi(O){O.logKpiFailure(y.a.Poh,"CommentReferenceFailedToSave",{isIntentional:!1,isInternal:!0},{name:y.a.ZXe,
isIntentional:!1,isInternal:!0,isSessionEndingError:!1})}static Yym(O,H,I){0!==O.size&&O.forEach(J=>{H.has(J)||K.czm(J,I)})}static czm(O,H){H.Eb(n.a.Of(O))&&l.ULS.sendTraceTag(539800642,327,15,`comment start missing for ${O}`)}static juk(O){const H=new Set;O.forEach(I=>{I&&I.Qi&&((I=K.JVh(I))?H.add(I):l.ULS.sendTraceTag(539554689,327,15,"Outline Node is undefined"))});H.forEach(I=>{const J=I.ia(B.a.lYe,[]);0===I.ia(B.a.jYe,[]).length&&0===J.length&&l.ULS.sendTraceTag(539800644,327,15,`Outline Element Node ${I.id.toString()} is missing comment info while paragraph has comments. This will cause some comments to fail to load.`)})}static bnm(O,
H,I,J){O=I.nOh(O);if(!O)return!1;I=F.k(O,n.a.nil);J=J.Eb(I);H.has(I.toString())&&l.ULS.sendTraceTag(539800643,327,15,`Para Node ${I} missing comment reference for comment ${O.id}`);return J&&J.Qi?!0:(l.ULS.sendTraceTag(539567714,327,15,`Para Node ${I} with missing comment reference for comment ${O.id} is in a invalid state ${J?"paraNode containingGraph is null":"paraNode is null"}`),!1)}static JVh(O){let H;try{H=k.OutlineElementNavigator.Uk(O)}catch(I){l.ULS.sendTraceTag(539567715,327,10,`ParaNode ${O.id} OutlineNode failed to retrieve ${I}`)}return H}static sql(O){var H;
switch(null===(H=O.Hy)||void 0===H?void 0:H.sessionType){case v.a.create:return y.a.hYe;case v.a.reply:return y.a.Vvd;case v.a.edit:return y.a.Uoh}}static Rlh(O){if(u.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.CheckForDuplicateReactionUsers",!0)&&(O=O[1])&&0!==O.length){var H=new Set;for(let I=0;I<O.length;I++)H.add(O[I].UserId);O.length>H.size&&l.ULS.sendTraceTag(521458447,327,15,`Reaction UserList has duplicates: ${O.length-H.size}`)}}}Object(C.a)(K,"CommentDiagnosticHelpers",
null,[])},1524:function(C,N,d){d.d(N,"a",function(){return l});C=d(0);class l{}l.open="open";l.refresh="refresh";l.LVf="saveAs";l.translate="translate";l.modeSwitch="modeSwitch";l.s0e="createNew";Object(C.a)(l,"ReasonList",null,[])},1525:function(C,N,d){d.d(N,"a",function(){return l});C=d(0);class l{static X2c(e){if(!e)return"{NULL}";const a=e.length;if(600>=a)return e;const k=a-195;return e.substring(0,400)+"[...]"+e.substring(k,a)}}Object(C.a)(l,"LogUtils",null,[])},1526:function(C,N,d){d.d(N,"b",
function(){return l});d.d(N,"a",function(){return e});d.d(N,"c",function(){return a});const l=(k,n,v,u,t,y,B,G)=>{var F=1;if(!k&&!n||!v||!u)return F;t&&y?(y=v+k,F=u+n,k=1/v,n=1/u,t=k>n?k:n,1>y?y=1:1920<y&&(y=1920),1>F?F=1:1280<F&&(F=1280),k=y-v,n=F-u,G?(v=y/v,u=F/u,F=Math.abs(v-B)<Math.abs(u-B)?v:u):F=Math.abs(k/v)>Math.abs(n/u)?y/v:F/u,F<t&&(F=t)):t?(B=v+k,1>B?B=1:1920<B&&(B=1920),F=B/v):y&&(B=u+n,1>B?B=1:1280<B&&(B=1280),F=B/u);return F},e=(k,n)=>{k=Math.atan2(n.y-k.y,n.x-k.x);0>k&&(k+=2*Math.PI);
return k},a=k=>{k%=360;0>k&&(k+=360);return k}},1527:function(C,N,d){d.d(N,"a",function(){return l});C=d(0);class l{}Object(C.a)(l,"SmartLookupSelection",null,[])},1529:function(C,N,d){d.d(N,"a",function(){return I});C=d(0);var l=d(22),e=d(821),a=d(658),k=d(38),n=d(181),v=d(5),u=d(45),t=d(17),y=d(8),B=d(120),G=d(72),F=d(44),K=d(445),O=d(156),H=d(931);class I{constructor(J,L,S,E,P,T){this.b_j=J;this.He=L;this.Hjf=S;this.Rxa=E;this.Sqe=P;this.Rqe=T}get Gk(){return null!=this.drg?this.drg:this.drg=l.a.instance.resolve("WordEditor.ITableEditor")}get Qd(){return null!=
this.esg?this.esg:this.esg=l.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance}get Nj(){return null!=this.Lrg?this.Lrg:this.Lrg=l.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance}get FMb(){return this.b_j.value}get M4c(){return this.He.value}mnh(J){const L=this.FMb.ZAb(J,e.a.XVd);L&&(this.APa(L,J),this.Wna(1696,J))}APa(J,L,S=!0){const E=this.FMb.HLa(L);if(E&&(J=this.M4c.rf(J),E.xh(J))){const P=this.FMb.nT(L);let T="Unknown";this.FMb.f9.value&&(T=this.FMb.f9.value.xb(J)?
J:"CustomStyle");y.ULS.sendTraceTag(0,311,50,"{0}",{["ApplyTableStyleId"]:T,["RowCount"]:this.Sqe(L),["ColumnCount"]:this.Rqe(L),["HR"]:!!(P&32),["FC"]:!!(P&128),["TR"]:!!(P&64),["LC"]:!!(P&256),["BR"]:!(P&512),["BC"]:!(P&1024),["TableId"]:L.id.toString()});S&&this.dba(L);this.b9f(L,E);S=E.xh(J);L.properties.setValue(v.a.tableStyle,S.id);this.cXe(L);L.CS.o2(!0)}}J_c(J,L,S){if(J=this.FMb.ZAb(S,J))this.Wna(L,S),this.APa(J,S)}Wna(J,L,S=!0){S&&this.dba(L);L.properties.setValue(v.a.tableLook,J);y.ULS.sendTraceTag(0,
311,50,"{0}",{["HR"]:!!(J&32),["FC"]:!!(J&128),["TR"]:!!(J&64),["LC"]:!!(J&256),["BR"]:!(J&512),["BC"]:!(J&1024),["TableId"]:L.id.toString()});L.CS.o2(!0)}b9f(J,L){(J=this.Rxa(J))&&L.K_c(J,!1)}cXe(J){if(J.isConnected){J.hasProperty(u.a.hv)&&J.removeProperty(u.a.hv);this.xSf(J);this.SXc(J);J=this.Hjf.fg(J);for(var L=J.Rb(1);L;){for(L=J.Rb(1);L;)L.hasProperty(t.a.ZH)&&L.removeProperty(t.a.ZH),L.hasProperty(v.a.cha)&&L.removeProperty(v.a.cha),this.MOa(L),this.SXc(L),L=J.Wi(1);L=J.Wi(1)}}}Q3b(J){let L=
J.ia(u.a.hna,null);if(L)return L;if(J=this.M4c.rf(J))if(L=({value:L}=this.FMb.f9.value.Dc(J,L)).returnValue?L:null)return L;return J}UXi(J,L,S,E,P){J.properties.setValue(L.style,S);J.properties.setValue(L.size,E*O.a.kYb);J.properties.setValue(L.color,P)}dba(J){if(this.Qd.ng){var L;Object(B.a)(K.a,J)&&(L=Object(G.a)(K.a,J))&&(L=L.OQ())&&this.Nj.dba(J,L)}}xSf(J){J.Qg(v.a.Ta,v.a.Va,v.a.tba,v.a.nb,v.a.pb,v.a.rba,v.a.Sa,v.a.Ua,v.a.qba,v.a.ob,v.a.qb,v.a.sba,v.a.rb,v.a.tb,v.a.$ga,v.a.Jb,v.a.Kb,v.a.aha)}MOa(J){J.Qg.apply(J,
this.Gk.PVe)}SXc(J){J.Qg(v.a.Ca,v.a.za,v.a.Aa,v.a.Ba,v.a.vM,v.a.vO,v.a.JEa,v.a.HEa)}static qif(){return new I(l.a.instance.ef("WordEditor.IWACTableStyleReader"),l.a.instance.ef("Box4.Styles.IWACStyleReader"),new a.a,Object(F.a)(I.qh,I.qh.ju,"navigateToPageContentNode"),k.TableReader.ag,k.TableReader.kh,H.a.instance)}static get qh(){return n.PageNavigator.instance}static get instance(){return null!=I.Wmg?I.Wmg:I.Wmg=I.qif()}}Object(C.a)(I,"WACTableStyleEditor",null,[410,15])},1530:function(C,N,d){d.d(N,
"a",function(){return l});C=d(0);class l{constructor(){this.data=this.landingTab=null}}Object(C.a)(l,"LaunchData",null,[])},1540:function(C,N,d){d.d(N,"a",function(){return a});C=d(0);var l=d(181),e=d(244);class a{G0a(k){a.qh.zQ(k);return k.Rb(16)}static mr(){return new e.a(()=>new a)}static get instance(){return a._instance.value}static get qh(){return l.PageNavigator.instance}}a._instance=a.mr();Object(C.a)(a,"CommentNavigator",null,[210])},1542:function(C,N,d){d.d(N,"a",function(){return l});C=
d(0);class l extends Sys.EventArgs{constructor(){super();this.pxi=this.UCa=null}}Object(C.a)(l,"OnCommentInitArgs",Sys.EventArgs,[])},1543:function(C,N,d){d.d(N,"a",function(){return v});C=d(0);var l=d(50),e=d(106),a=d(8),k=d(97),n=d(65);class v{constructor(u,t,y){a.ULS.shipAssertTag(6305502,307,!!u);this.properties=u;this.Mc=t;this.iP=y}tWh(){return this.properties.ia(e.a.hU,"")}XFi(){return!0}Bdj(){let u=!1,t=null;const y=this.tWh();if(this.iP||""!==y)try{({osa:t,returnValue:u}=this.bhc(y))}catch(B){a.ULS.shipAssertTag(4203138,
307,!1),this.Mc.Zb(k.a.Ska,{["Reason"]:n.a.gUe}),l.a.eZ(t)}else a.ULS.sendTraceTag(3994443,307,50,"PastedHTMLString empty"),this.Mc.Zb(k.a.P_,{["Reason"]:n.a.g8e});return{returnValue:u,Cwd:t}}}Object(C.a)(v,"AStringInputImportStrategy",null,[593])},1545:function(C,N,d){d.d(N,"a",function(){return l});C=d(0);class l{constructor(e){this.id=e}}Object(C.a)(l,"DesignerPaneToggleData",null,[])},1547:function(C,N,d){d.d(N,"a",function(){return n});C=d(0);var l=d(1791),e=d(658),a=d(5),k=d(1008);class n{constructor(v){this.Srl=
(u,t)=>{const y=this.kYh(u),B=this.Xc.fg(t);return B.Bb(y)?(B.kd(y),new l.a(B.currentNode,t,u)):null};this.Rrl=(u,t)=>{let y=null,B=null;const G=this.kYh(u);t=this.Xc.fg(t);({rootNode:y,Pva:B}=this.aOn(t,u,G,y,B));return y&&B?new l.a(y,B,u):null};this.Xrl=u=>{u=this.Xc.fg(u);return(this.E6(2)||this.E6(4))&&u.Bb(36)?(u.kd(36),this.p$k(u.currentNode)):(this.E6(8)||this.E6(16))&&u.Bb(37)?(u.kd(37),this.VHh(u.currentNode)):this.E6(32)&&u.Bb(40)?32:this.E6(1)&&u.Bb(8)?1:0};this.Xc=v;this.q$k=this.Xrl;
this.b$k=this.Srl;this.a$k=this.Rrl;this.F$k=31;this.s3f=this.asl()}EQh(v){const u=[],t=this.q$k(v);if(t){var y=this.b$k(t,v);y&&(u[u.length]=y)}for(let B of this.s3f)B!==t&&B&&(y=this.a$k(B,v))&&(u[u.length]=y);return u}E6(v){return!!v&&!!(this.F$k&v)}aOn(v,u,t,y,B){if(v.Bb(7)){v.kd(7);if(8===t||37===t||39===t)for(var G=v.Xd();G;){if(G.type===t)if(37===t){if((8===u||16===u)&&u===this.VHh(G)){y=v.currentNode;break}}else{y=v.currentNode;break}G=v.xj()}y&&v.bD()&&(G=this.Xc.fg(y),k.b(G,t,u)&&(B=v.currentNode))}return{rootNode:y,
Pva:B}}asl(){const v=[];this.E6(1)&&(v[v.length]=1);this.E6(2)&&(v[v.length]=2);this.E6(4)&&(v[v.length]=4);this.E6(8)&&(v[v.length]=8);this.E6(16)&&(v[v.length]=16);this.E6(32)&&(v[v.length]=32);return v}kYh(v){let u=8;switch(v){case 1:case 2:case 4:u=8;break;case 8:case 16:u=37;break;case 32:u=39}return u}VHh(v){v=v.properties.getValue(a.a.a6);return this.E6(8)&&1===v?8:this.E6(16)&&!v?16:0}p$k(v){v=v.getValue(a.a.A4b);return this.E6(2)&&n.bem(v)?2:this.E6(4)&&n.Adm(v)?4:0}static hE(){return new n(new e.a)}static get instance(){return null!=
n.emg?n.emg:n.emg=n.hE()}static bem(v){return v&&1!==v&&2!==v?!1:!0}static Adm(v){return 3===v||4===v||5===v?!0:!1}}Object(C.a)(n,"WordFindContextHelper",null,[312])},1559:function(C,N,d){var l=d(1500);C=d(0);class e{}Object(C.a)(e,"SerializableAnchorDataV1",null,[]);class a{}Object(C.a)(a,"SerializableCpDataV1",null,[]);var k=d(959);d.d(N,"a",function(){return n});d.d(N,"c",function(){return v});d.d(N,"b",function(){return u});d.d(N,"d",function(){return t});const n=y=>new l.a(y.RK,y.PS,y.TS,d(1585).versionedDeserialize(y.OS),
y.PE,y.TE,d(1585).versionedDeserialize(y.OE),y.DK,y.SI),v=y=>{const B=new e;B.RK=y.J2d;B.PS=y.fOa;B.TS=y.J3a;B.DK=y.UG;B.SI=y.shapeId;y.EQ&&(B.OS=t(y.EQ));y.oDa&&(B.PE=y.oDa);y.hgc&&(B.TE=y.hgc);y.V2&&(B.OE=t(y.V2));return B},u=y=>{if(!y)return null;const B=new k.a(y.CP);B.Fsa=null!=y.FB?y.FB:0;B.jea=null!=y.FE?y.FE:0;B.Ora=null!=y.CB?y.CB:0;B.Pra=null!=y.CE?y.CE:0;B.ZLa=null!=y.HB?y.HB:0;B.Qea=null!=y.HE?y.HE:0;B.tva=null!=y.R?y.R:0;B.Bsa=null!=y.E?y.E:0;B.Xva=null!=y.TW?y.TW:0;B.Pua=null!=y.PB?
y.PB:0;B.symbols=null!=y.SYM?y.SYM:0;B.uta=null!=y.IE?y.IE:0;B.Bua=null!=y.OO?y.OO:0;B.kra=null!=y.AX?y.AX:0;B.Hza=null!=y.CCI?y.CCI:0;B.dryDeletion=null!=y.DD?y.DD:0;return B},t=y=>{if(!y)return null;const B=new a;B.CP=y.cp;B.VS=1;0<y.Fsa&&(B.FB=y.Fsa);0<y.jea&&(B.FE=y.jea);0<y.Ora&&(B.CB=y.Ora);0<y.Pra&&(B.CE=y.Pra);0<y.ZLa&&(B.HB=y.ZLa);0<y.Qea&&(B.HE=y.Qea);0<y.tva&&(B.R=y.tva);0<y.Bsa&&(B.E=y.Bsa);0<y.Xva&&(B.TW=y.Xva);0<y.Pua&&(B.PB=y.Pua);0<y.symbols&&(B.SYM=y.symbols);0<y.uta&&(B.IE=y.uta);
0<y.Bua&&(B.OO=y.Bua);0<y.kra&&(B.AX=y.kra);0<y.Hza&&(B.CCI=y.Hza);0<y.dryDeletion&&(B.DD=y.dryDeletion);return B}},1566:function(C,N,d){d.d(N,"a",function(){return l});C=d(0);class l{constructor(e,a="",k="",n=""){this.IsCurrentUser=!1;this.UserId=e;this.Provider=a;this.DisplayName=k;this.Email=n}}Object(C.a)(l,"CommentTaskPerson",null,[899])},1567:function(C,N,d){d.d(N,"a",function(){return l});C=d(0);class l{constructor(e,a,k,n,v=!1){this.priority=this.completion=-1;this.type=e;this.user=a;this.time=
k;this.recordId=n;this.isLossy=v}}Object(C.a)(l,"HistoryRecord",null,[])},1568:function(C,N,d){d.d(N,"a",function(){return k});C=d(0);var l=d(546),e=d(428),a=d(628);class k{constructor(){this.eug=null;this.dX=!1;this.eGb=this.$ab=null;this.fx=new l.a(new e.a);this.dU=new l.a(new e.a);this.OPf=this.ZBb=!1}get mn(){return a.a.mn}set mn(n){a.a.mn=n}get G$a(){return this.eug}set G$a(n){this.eug=n}}k.Ri=1;Object(C.a)(k,"CommentsState",null,[])},1569:function(C,N,d){d.d(N,"a",function(){return l});C=d(0);
class l{}l.yellow="FFFF00";l.Xki="00FF00";l.Bdh="00FFFF";l.EKh="FF00FF";l.blue="0000FF";l.red="FF0000";l.bti="000080";l.teal="008080";l.green="008000";l.purple="800080";l.Ppi="800000";l.wvi="808000";l.gray="808080";l.p6i="C0C0C0";l.black="000000";Object(C.a)(l,"FontHighlightColorEnum",null,[])},1570:function(C,N,d){d.d(N,"a",function(){return l});C=d(0);class l{constructor(){this.l8={};this.l8.ops=[]}Wea(e){const a=this.l8.ops;if(a.length){var k=a.length-1;const n=a[k];if(!n.attributes){n.insert+=
e;a[k]=n;this.l8.ops=a;return}}k={};k.insert=e;Array.add(a,k)}f9h(e,a){const k={};this.M_i(k,a);Array.add(this.l8.ops,this.j_b(e,k))}Qnf(e,a,k,n=!1){var v={};v.fullName=a.fullName;v.email=a.email;v.resolveState=a.resolveState;a={};a.atmention=v;e=this.j_b(e,a);k&&(v={},v.contentId=k.contentId,a={},a.atmention=v,n&&(v.isCurrentUser=k.isCurrentUser),e.optional=a);Array.add(this.l8.ops,e)}insertImage(e,a){e=this.j_b(e,{});const k={};k.base64=a.base64;a={};a.image=k;e.optional=a;Array.add(this.l8.ops,
e)}U8h(e,a){const k={};k.link=a.link;this.M_i(k,a);Array.add(this.l8.ops,this.j_b(e,k))}RHc(){return Sys.Serialization.JavaScriptSerializer.serialize(this.l8)}j_b(e,a){const k={};k.insert=e;k.attributes=a;return k}M_i(e,a){this.wJb(a.weight>=l.gAf,e,"weight",a.weight);this.wJb(a.italic,e,"italic",!0);this.wJb(a.underline,e,"underline",!0);this.wJb(a.strikethrough,e,"strikethrough",!0);this.wJb(!!a.highlight,e,"highlight",a.highlight);this.wJb(!!a.color,e,"color",a.color);this.wJb(!!a.paragraph,e,
"paragraph",a.paragraph)}wJb(e,a,k,n){e&&(a[k]=n)}static C2b(e){return Sys.Serialization.JavaScriptSerializer.deserialize(e,!0)}}l.gAf=700;Object(C.a)(l,"DeltaFormatCreator",null,[860])},1571:function(C,N,d){d.d(N,"a",function(){return a});C=d(0);var l=d(524),e=d(428);class a{constructor(k=!1){this.bM=null;this.jZa=!1;k&&(this.bM=new l.a(new e.a))}}Object(C.a)(a,"OpenCommentInfo",null,[])},1572:function(C,N,d){d.d(N,"b",function(){return y});d.d(N,"a",function(){return B});d.d(N,"c",function(){return G});
d.d(N,"d",function(){return F});d.d(N,"e",function(){return K});var l=d(15),e=d(2),a=d(110),k=d(8),n=d(311),v=d(438),u=d(20),t=d(256);const y=()=>l.a.Ak||l.a.Ys,B=()=>void 0!==window.self.FormData&&null!==window.self.FormData?!0:!1,G=O=>!!O&&O.isConnected,F=(O,H,I,J)=>{if(!H||!H.isConnected)return O.dispose(),!1;const L=H.Di();let S=t.a.Cq;u.a.instance.J(4)&&(S=H.ia(a.a.mK,t.a.Cq));const E={};E[n.a.nodeId]=H.id.toString();E[n.a.cellId]=L.Zl.toString();E[n.a.fileId]=L.Fs;E[n.a.Ara]=L.contentReplicator.eu.toString();
E[n.a.qQ]=L.contentReplicator.qQ;E[n.a.R1]=I.toString();E[n.a.lcid]=e.AFrameworkApplication.lcid.toString();E[n.a.accessToken]=e.AFrameworkApplication.accessToken;E[n.a.classId]=H.Qc.toString();E[n.a.mK]=S;J=J||{};for(const P of v.a(J))E[P]=J[P];for(const P of v.a(E))O.f_b(P,E[P]);return!0},K=(O,H,I)=>{const J={};J.IsResponseNull=!H;H&&(J.OperationResult=H.StatusCode,J.RevisionListLength=H.RevisionList?H.RevisionList.length.toString():"null");k.ULS.sendTraceTag(36783366,322,50,"UploadResponseReceived: {0}",
J);I&&I.isConnected&&(H&&!H.StatusCode?(I.YG().contentReplicator.lE(null,null,null),O.nno()):O.D1a(null,H?H.StatusCode:14))}},1573:function(C,N,d){var l=this&&this.BO||(Object.create?function(a,k,n,v){void 0===v&&(v=n);Object.defineProperty(a,v,{enumerable:!0,get:function(){return k[n]}})}:function(a,k,n,v){void 0===v&&(v=n);a[v]=k[n]}),e=this&&this.__exportStar||function(a,k){for(var n in a)"default"===n||Object.prototype.hasOwnProperty.call(k,n)||l(k,a,n)};Object.defineProperty(N,"__esModule",{value:!0});
e(d(1768),N);e(d(1769),N);C.exports.DocumentPullQuoteAnnotation||Object.defineProperty(C.exports,"DocumentPullQuoteAnnotation",{enumerable:!0,get:function(){return C.exports.DocumentPullQuoteAnnotation}});C.exports.PullQuoteAnnotation||Object.defineProperty(C.exports,"PullQuoteAnnotation",{enumerable:!0,get:function(){return C.exports.PullQuoteAnnotation}});C.exports.PullQuotesSignal||Object.defineProperty(C.exports,"PullQuotesSignal",{enumerable:!0,get:function(){return C.exports.PullQuotesSignal}})},
1574:function(C,N,d){d.d(N,"a",function(){return l});C=d(0);class l{constructor(){this.neighborhood=null;this.mentionLength=this.mentionStart=0}}Object(C.a)(l,"InsightsParameters",null,[])},1577:function(C,N,d){d.d(N,"a",function(){return S});C=d(0);var l=d(22),e=d(821),a=d(48),k=d(6),n=d(38),v=d(181),u=d(5),t=d(45),y=d(17),B=d(8),G=d(244),F=d(120),K=d(72),O=d(44),H=d(86),I=d(445),J=d(156),L=d(845);class S{constructor(E,P,T,U,X,Y){this.Qt=E;this.mGg=P;this.MOb=T;this.Rxa=U;this.Sqe=X;this.Rqe=Y;this.f9=
new G.a(()=>this.wId())}get Gk(){return null!=this.erg?this.erg:this.erg=l.a.instance.resolve("WordEditor.ITableEditor")}get Qd(){return null!=this.gsg?this.gsg:this.gsg=l.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance}get Nj(){return null!=this.Mrg?this.Mrg:this.Mrg=l.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance}get btd(){return this.Qt.value}mnh(E){const P=this.btd.ZAb(E,L.a.$4c);P&&(this.dba(E),this.APa(P,E),this.Wna(1696,E))}APa(E,P,T=!0){const U=
this.btd.HLa(P);if(U&&(E=this.mGg(E),U.xh(E))){const X=this.btd.nT(P);let Y="Unknown";this.f9.value&&(Y=this.f9.value.xb(E)?E:"CustomStyle");B.ULS.sendTraceTag(39661653,311,50,"{0}",{["ApplyTableStyleId"]:Y,["RowCount"]:this.Sqe(P),["ColumnCount"]:this.Rqe(P),["HR"]:!!(X&32),["FC"]:!!(X&128),["TR"]:!!(X&64),["LC"]:!!(X&256),["BR"]:!(X&512),["BC"]:!(X&1024),["TableId"]:P.id.toString()});T&&this.dba(P);this.b9f(P,U);T=U.xh(E);P.properties.setValue(u.a.tableStyle,T.id);this.cXe(P);P.CS.o2(!0)}}J_c(E,
P,T){if(E=this.btd.ZAb(T,E))this.Wna(P,T),this.APa(E,T)}Wna(E,P,T=!0){T&&this.dba(P);P.properties.setValue(u.a.tableLook,E);B.ULS.sendTraceTag(39661654,311,50,"{0}",{["HR"]:!!(E&32),["FC"]:!!(E&128),["TR"]:!!(E&64),["LC"]:!!(E&256),["BR"]:!(E&512),["BC"]:!(E&1024),["TableId"]:P.id.toString()});P.CS.o2(!0)}b9f(E,P){(E=this.Rxa(E))&&P.K_c(E,!1)}cXe(E){if(E.isConnected){E.hasProperty(t.a.hv)&&E.removeProperty(t.a.hv);this.xSf(E);this.SXc(E);E=this.MOb(E);for(var P=E.Rb(1);P;){for(P=E.Rb(1);P;)P.hasProperty(y.a.ZH)&&
P.removeProperty(y.a.ZH),P.hasProperty(u.a.cha)&&P.removeProperty(u.a.cha),this.MOa(P),this.SXc(P),P=E.Wi(1);P=E.Wi(1)}}}xSf(E){E.Qg(u.a.Ta,u.a.Va,u.a.tba,u.a.nb,u.a.pb,u.a.rba,u.a.Sa,u.a.Ua,u.a.qba,u.a.ob,u.a.qb,u.a.sba,u.a.rb,u.a.tb,u.a.$ga,u.a.Jb,u.a.Kb,u.a.aha)}MOa(E){E.Qg.apply(E,this.Gk.PVe)}SXc(E){E.Qg(u.a.Ca,u.a.za,u.a.Aa,u.a.Ba,u.a.vM,u.a.vO,u.a.JEa,u.a.HEa)}Q3b(E){let P=E.ia(t.a.hna,null);if(P)return P;if(E=this.mGg(E))if(P=({value:P}=this.f9.value.Dc(E,P)).returnValue?P:null)return P;return E}LJc(E){return E.ia(u.a.Ea,
16)}q_h(E){for(let P of this.f9.value.keys)if(this.f9.value.J(P)===E)return P;return null}UXi(E,P,T,U,X){E.properties.setValue(P.style,T);E.properties.setValue(P.size,U*J.a.kYb);E.properties.setValue(P.color,X)}wId(){const E=new H.a;E.Z(e.a.Q1c,WordEditorIntl.WordEditorStrings.L_TableGrid);E.Z(e.a.N_d,WordEditorIntl.WordEditorStrings.L_PlainTable1);E.Z(e.a.O_d,WordEditorIntl.WordEditorStrings.L_PlainTable2);E.Z(e.a.P_d,WordEditorIntl.WordEditorStrings.L_PlainTable3);E.Z(e.a.Q_d,WordEditorIntl.WordEditorStrings.L_PlainTable4);
E.Z(e.a.R_d,WordEditorIntl.WordEditorStrings.L_PlainTable5);E.Z(e.a.iKd,WordEditorIntl.WordEditorStrings.L_TableGridLight);E.Z(e.a.sJd,WordEditorIntl.WordEditorStrings.L_GridTable1Light);E.Z(e.a.mJd,this.Kd(WordEditorIntl.WordEditorStrings.L_GridTable1Light,Box4Intl.Box4Strings.l_ThemeLabel5));E.Z(e.a.nJd,this.Kd(WordEditorIntl.WordEditorStrings.L_GridTable1Light,Box4Intl.Box4Strings.l_ThemeLabel6));E.Z(e.a.oJd,this.Kd(WordEditorIntl.WordEditorStrings.L_GridTable1Light,Box4Intl.Box4Strings.l_ThemeLabel7));
E.Z(e.a.pJd,this.Kd(WordEditorIntl.WordEditorStrings.L_GridTable1Light,Box4Intl.Box4Strings.l_ThemeLabel8));E.Z(e.a.qJd,this.Kd(WordEditorIntl.WordEditorStrings.L_GridTable1Light,Box4Intl.Box4Strings.l_ThemeLabel9));E.Z(e.a.rJd,this.Kd(WordEditorIntl.WordEditorStrings.L_GridTable1Light,Box4Intl.Box4Strings.l_ThemeLabel10));E.Z(e.a.zJd,WordEditorIntl.WordEditorStrings.L_GridTable2);E.Z(e.a.tJd,this.Kd(WordEditorIntl.WordEditorStrings.L_GridTable2,Box4Intl.Box4Strings.l_ThemeLabel5));E.Z(e.a.uJd,this.Kd(WordEditorIntl.WordEditorStrings.L_GridTable2,
Box4Intl.Box4Strings.l_ThemeLabel6));E.Z(e.a.vJd,this.Kd(WordEditorIntl.WordEditorStrings.L_GridTable2,Box4Intl.Box4Strings.l_ThemeLabel7));E.Z(e.a.wJd,this.Kd(WordEditorIntl.WordEditorStrings.L_GridTable2,Box4Intl.Box4Strings.l_ThemeLabel8));E.Z(e.a.xJd,this.Kd(WordEditorIntl.WordEditorStrings.L_GridTable2,Box4Intl.Box4Strings.l_ThemeLabel9));E.Z(e.a.yJd,this.Kd(WordEditorIntl.WordEditorStrings.L_GridTable2,Box4Intl.Box4Strings.l_ThemeLabel10));E.Z(e.a.GJd,WordEditorIntl.WordEditorStrings.L_GridTable3);
E.Z(e.a.AJd,this.Kd(WordEditorIntl.WordEditorStrings.L_GridTable3,Box4Intl.Box4Strings.l_ThemeLabel5));E.Z(e.a.BJd,this.Kd(WordEditorIntl.WordEditorStrings.L_GridTable3,Box4Intl.Box4Strings.l_ThemeLabel6));E.Z(e.a.CJd,this.Kd(WordEditorIntl.WordEditorStrings.L_GridTable3,Box4Intl.Box4Strings.l_ThemeLabel7));E.Z(e.a.DJd,this.Kd(WordEditorIntl.WordEditorStrings.L_GridTable3,Box4Intl.Box4Strings.l_ThemeLabel8));E.Z(e.a.EJd,this.Kd(WordEditorIntl.WordEditorStrings.L_GridTable3,Box4Intl.Box4Strings.l_ThemeLabel9));
E.Z(e.a.FJd,this.Kd(WordEditorIntl.WordEditorStrings.L_GridTable3,Box4Intl.Box4Strings.l_ThemeLabel10));E.Z(e.a.NJd,WordEditorIntl.WordEditorStrings.L_GridTable4);E.Z(e.a.HJd,this.Kd(WordEditorIntl.WordEditorStrings.L_GridTable4,Box4Intl.Box4Strings.l_ThemeLabel5));E.Z(e.a.IJd,this.Kd(WordEditorIntl.WordEditorStrings.L_GridTable4,Box4Intl.Box4Strings.l_ThemeLabel6));E.Z(e.a.JJd,this.Kd(WordEditorIntl.WordEditorStrings.L_GridTable4,Box4Intl.Box4Strings.l_ThemeLabel7));E.Z(e.a.KJd,this.Kd(WordEditorIntl.WordEditorStrings.L_GridTable4,
Box4Intl.Box4Strings.l_ThemeLabel8));E.Z(e.a.LJd,this.Kd(WordEditorIntl.WordEditorStrings.L_GridTable4,Box4Intl.Box4Strings.l_ThemeLabel9));E.Z(e.a.MJd,this.Kd(WordEditorIntl.WordEditorStrings.L_GridTable4,Box4Intl.Box4Strings.l_ThemeLabel10));E.Z(e.a.UJd,WordEditorIntl.WordEditorStrings.L_GridTable5Dark);E.Z(e.a.OJd,this.Kd(WordEditorIntl.WordEditorStrings.L_GridTable5Dark,Box4Intl.Box4Strings.l_ThemeLabel5));E.Z(e.a.PJd,this.Kd(WordEditorIntl.WordEditorStrings.L_GridTable5Dark,Box4Intl.Box4Strings.l_ThemeLabel6));
E.Z(e.a.QJd,this.Kd(WordEditorIntl.WordEditorStrings.L_GridTable5Dark,Box4Intl.Box4Strings.l_ThemeLabel7));E.Z(e.a.RJd,this.Kd(WordEditorIntl.WordEditorStrings.L_GridTable5Dark,Box4Intl.Box4Strings.l_ThemeLabel8));E.Z(e.a.SJd,this.Kd(WordEditorIntl.WordEditorStrings.L_GridTable5Dark,Box4Intl.Box4Strings.l_ThemeLabel9));E.Z(e.a.TJd,this.Kd(WordEditorIntl.WordEditorStrings.L_GridTable5Dark,Box4Intl.Box4Strings.l_ThemeLabel10));E.Z(e.a.aKd,WordEditorIntl.WordEditorStrings.L_GridTable6Colorful);E.Z(e.a.VJd,
this.Kd(WordEditorIntl.WordEditorStrings.L_GridTable6Colorful,Box4Intl.Box4Strings.l_ThemeLabel5));E.Z(e.a.WJd,this.Kd(WordEditorIntl.WordEditorStrings.L_GridTable6Colorful,Box4Intl.Box4Strings.l_ThemeLabel6));E.Z(e.a.XJd,this.Kd(WordEditorIntl.WordEditorStrings.L_GridTable6Colorful,Box4Intl.Box4Strings.l_ThemeLabel7));E.Z(e.a.YJd,this.Kd(WordEditorIntl.WordEditorStrings.L_GridTable6Colorful,Box4Intl.Box4Strings.l_ThemeLabel8));E.Z(e.a.ZJd,this.Kd(WordEditorIntl.WordEditorStrings.L_GridTable6Colorful,
Box4Intl.Box4Strings.l_ThemeLabel9));E.Z(e.a.$Jd,this.Kd(WordEditorIntl.WordEditorStrings.L_GridTable6Colorful,Box4Intl.Box4Strings.l_ThemeLabel10));E.Z(e.a.hKd,WordEditorIntl.WordEditorStrings.L_GridTable7Colorful);E.Z(e.a.bKd,this.Kd(WordEditorIntl.WordEditorStrings.L_GridTable7Colorful,Box4Intl.Box4Strings.l_ThemeLabel5));E.Z(e.a.cKd,this.Kd(WordEditorIntl.WordEditorStrings.L_GridTable7Colorful,Box4Intl.Box4Strings.l_ThemeLabel6));E.Z(e.a.dKd,this.Kd(WordEditorIntl.WordEditorStrings.L_GridTable7Colorful,
Box4Intl.Box4Strings.l_ThemeLabel7));E.Z(e.a.eKd,this.Kd(WordEditorIntl.WordEditorStrings.L_GridTable7Colorful,Box4Intl.Box4Strings.l_ThemeLabel8));E.Z(e.a.fKd,this.Kd(WordEditorIntl.WordEditorStrings.L_GridTable7Colorful,Box4Intl.Box4Strings.l_ThemeLabel9));E.Z(e.a.gKd,this.Kd(WordEditorIntl.WordEditorStrings.L_GridTable7Colorful,Box4Intl.Box4Strings.l_ThemeLabel10));E.Z(e.a.kSd,WordEditorIntl.WordEditorStrings.L_ListTable1Light);E.Z(e.a.eSd,this.Kd(WordEditorIntl.WordEditorStrings.L_ListTable1Light,
Box4Intl.Box4Strings.l_ThemeLabel5));E.Z(e.a.fSd,this.Kd(WordEditorIntl.WordEditorStrings.L_ListTable1Light,Box4Intl.Box4Strings.l_ThemeLabel6));E.Z(e.a.gSd,this.Kd(WordEditorIntl.WordEditorStrings.L_ListTable1Light,Box4Intl.Box4Strings.l_ThemeLabel7));E.Z(e.a.hSd,this.Kd(WordEditorIntl.WordEditorStrings.L_ListTable1Light,Box4Intl.Box4Strings.l_ThemeLabel8));E.Z(e.a.iSd,this.Kd(WordEditorIntl.WordEditorStrings.L_ListTable1Light,Box4Intl.Box4Strings.l_ThemeLabel9));E.Z(e.a.jSd,this.Kd(WordEditorIntl.WordEditorStrings.L_ListTable1Light,
Box4Intl.Box4Strings.l_ThemeLabel10));E.Z(e.a.rSd,WordEditorIntl.WordEditorStrings.L_ListTable2);E.Z(e.a.lSd,this.Kd(WordEditorIntl.WordEditorStrings.L_ListTable2,Box4Intl.Box4Strings.l_ThemeLabel5));E.Z(e.a.mSd,this.Kd(WordEditorIntl.WordEditorStrings.L_ListTable2,Box4Intl.Box4Strings.l_ThemeLabel6));E.Z(e.a.nSd,this.Kd(WordEditorIntl.WordEditorStrings.L_ListTable2,Box4Intl.Box4Strings.l_ThemeLabel7));E.Z(e.a.oSd,this.Kd(WordEditorIntl.WordEditorStrings.L_ListTable2,Box4Intl.Box4Strings.l_ThemeLabel8));
E.Z(e.a.pSd,this.Kd(WordEditorIntl.WordEditorStrings.L_ListTable2,Box4Intl.Box4Strings.l_ThemeLabel9));E.Z(e.a.qSd,this.Kd(WordEditorIntl.WordEditorStrings.L_ListTable2,Box4Intl.Box4Strings.l_ThemeLabel10));E.Z(e.a.ySd,WordEditorIntl.WordEditorStrings.L_ListTable3);E.Z(e.a.sSd,this.Kd(WordEditorIntl.WordEditorStrings.L_ListTable3,Box4Intl.Box4Strings.l_ThemeLabel5));E.Z(e.a.tSd,this.Kd(WordEditorIntl.WordEditorStrings.L_ListTable3,Box4Intl.Box4Strings.l_ThemeLabel6));E.Z(e.a.uSd,this.Kd(WordEditorIntl.WordEditorStrings.L_ListTable3,
Box4Intl.Box4Strings.l_ThemeLabel7));E.Z(e.a.vSd,this.Kd(WordEditorIntl.WordEditorStrings.L_ListTable3,Box4Intl.Box4Strings.l_ThemeLabel8));E.Z(e.a.wSd,this.Kd(WordEditorIntl.WordEditorStrings.L_ListTable3,Box4Intl.Box4Strings.l_ThemeLabel9));E.Z(e.a.xSd,this.Kd(WordEditorIntl.WordEditorStrings.L_ListTable3,Box4Intl.Box4Strings.l_ThemeLabel10));E.Z(e.a.FSd,WordEditorIntl.WordEditorStrings.L_ListTable4);E.Z(e.a.zSd,this.Kd(WordEditorIntl.WordEditorStrings.L_ListTable4,Box4Intl.Box4Strings.l_ThemeLabel5));
E.Z(e.a.ASd,this.Kd(WordEditorIntl.WordEditorStrings.L_ListTable4,Box4Intl.Box4Strings.l_ThemeLabel6));E.Z(e.a.BSd,this.Kd(WordEditorIntl.WordEditorStrings.L_ListTable4,Box4Intl.Box4Strings.l_ThemeLabel7));E.Z(e.a.CSd,this.Kd(WordEditorIntl.WordEditorStrings.L_ListTable4,Box4Intl.Box4Strings.l_ThemeLabel8));E.Z(e.a.DSd,this.Kd(WordEditorIntl.WordEditorStrings.L_ListTable4,Box4Intl.Box4Strings.l_ThemeLabel9));E.Z(e.a.ESd,this.Kd(WordEditorIntl.WordEditorStrings.L_ListTable4,Box4Intl.Box4Strings.l_ThemeLabel10));
E.Z(e.a.MSd,WordEditorIntl.WordEditorStrings.L_ListTable5Dark);E.Z(e.a.GSd,this.Kd(WordEditorIntl.WordEditorStrings.L_ListTable5Dark,Box4Intl.Box4Strings.l_ThemeLabel5));E.Z(e.a.HSd,this.Kd(WordEditorIntl.WordEditorStrings.L_ListTable5Dark,Box4Intl.Box4Strings.l_ThemeLabel6));E.Z(e.a.ISd,this.Kd(WordEditorIntl.WordEditorStrings.L_ListTable5Dark,Box4Intl.Box4Strings.l_ThemeLabel7));E.Z(e.a.JSd,this.Kd(WordEditorIntl.WordEditorStrings.L_ListTable5Dark,Box4Intl.Box4Strings.l_ThemeLabel8));E.Z(e.a.KSd,
this.Kd(WordEditorIntl.WordEditorStrings.L_ListTable5Dark,Box4Intl.Box4Strings.l_ThemeLabel9));E.Z(e.a.LSd,this.Kd(WordEditorIntl.WordEditorStrings.L_ListTable5Dark,Box4Intl.Box4Strings.l_ThemeLabel10));E.Z(e.a.SSd,WordEditorIntl.WordEditorStrings.L_ListTable6Colorful);E.Z(e.a.T8b,this.Kd(WordEditorIntl.WordEditorStrings.L_ListTable6Colorful,Box4Intl.Box4Strings.l_ThemeLabel5));E.Z(e.a.NSd,this.Kd(WordEditorIntl.WordEditorStrings.L_ListTable6Colorful,Box4Intl.Box4Strings.l_ThemeLabel6));E.Z(e.a.OSd,
this.Kd(WordEditorIntl.WordEditorStrings.L_ListTable6Colorful,Box4Intl.Box4Strings.l_ThemeLabel7));E.Z(e.a.PSd,this.Kd(WordEditorIntl.WordEditorStrings.L_ListTable6Colorful,Box4Intl.Box4Strings.l_ThemeLabel8));E.Z(e.a.QSd,this.Kd(WordEditorIntl.WordEditorStrings.L_ListTable6Colorful,Box4Intl.Box4Strings.l_ThemeLabel9));E.Z(e.a.RSd,this.Kd(WordEditorIntl.WordEditorStrings.L_ListTable6Colorful,Box4Intl.Box4Strings.l_ThemeLabel10));E.Z(e.a.ZSd,WordEditorIntl.WordEditorStrings.L_ListTable7Colorful);E.Z(e.a.TSd,
this.Kd(WordEditorIntl.WordEditorStrings.L_ListTable7Colorful,Box4Intl.Box4Strings.l_ThemeLabel5));E.Z(e.a.USd,this.Kd(WordEditorIntl.WordEditorStrings.L_ListTable7Colorful,Box4Intl.Box4Strings.l_ThemeLabel6));E.Z(e.a.VSd,this.Kd(WordEditorIntl.WordEditorStrings.L_ListTable7Colorful,Box4Intl.Box4Strings.l_ThemeLabel7));E.Z(e.a.WSd,this.Kd(WordEditorIntl.WordEditorStrings.L_ListTable7Colorful,Box4Intl.Box4Strings.l_ThemeLabel8));E.Z(e.a.XSd,this.Kd(WordEditorIntl.WordEditorStrings.L_ListTable7Colorful,
Box4Intl.Box4Strings.l_ThemeLabel9));E.Z(e.a.YSd,this.Kd(WordEditorIntl.WordEditorStrings.L_ListTable7Colorful,Box4Intl.Box4Strings.l_ThemeLabel10));return E}Kd(E,P){return String.format(WordEditorIntl.WordEditorStrings.L_TableStyleNameWithThemeFormat,E,P)}dba(E){if(this.Qd.ng){let P=null;if(Object(F.a)(I.a,E)){const T=Object(K.a)(I.a,E);T&&(P=T.OQ())}P&&this.Nj.dba(E,P)}}static qif(){return new S(new G.a(()=>a.StyleReader.E3a),a.StyleReader.rf,k.GraphIterator.$a,Object(O.a)(S.qh,S.qh.ju,"navigateToPageContentNode"),
n.TableReader.ag,n.TableReader.kh)}static get qh(){return v.PageNavigator.instance}static get instance(){return null!=S.Xmg?S.Xmg:S.Xmg=S.qif()}}Object(C.a)(S,"TableStyleEditor",null,[421,422,423])},1578:function(C,N,d){d.d(N,"c",function(){return n});d.d(N,"b",function(){return v});d.d(N,"a",function(){return u});var l=d(37),e=d(593),a=d(69),k=d(293);const n=(t,y,B)=>{var G=t.characterData.length;if(y>B||B>G)return null;a:{for(F of t.wD)if(G=F.fc,G.ze){var F=G;break a}F=null}if(!F)return null;F=
t.Ni(F.Tb);if(!F)return null;G=[];t=t.qa;for(let O=t.Ysa(y);O<t.length;O++){var K=t.J(O);if(K.cp>B||K.cp===B&&y!==B)break;(K=k.a.GLa(F,K.cp))&&0>Array.indexOf(G,K)&&G.push(K)}return G},v=t=>{let y=null;for(let G of t){var B=l.a.getElementBounds(G);y?(t=y,t.x>B.x&&(t.x=B.x),t.x+t.width<B.x+B.width&&(t.width=B.x+B.width-t.x),t.y>B.y&&(t.y=B.y),t.y+t.height<B.y+B.height&&(t.height=B.y+B.height-t.y)):y=B}y||(y=new Sys.UI.Bounds(0,0,0,0));return y},u=(t,y)=>{t=v(t);if(!t.width&&!t.height)return null;const B=
document.createElement("div");B.id=y;B.style.position="absolute";B.style.left=t.x+"px";B.style.top=t.y+"px";B.style.width=t.width+"px";B.style.height=t.height+"px";B.style.zIndex="-9999";a.d(B,e.a.Gvb,"true");return B}},1579:function(C,N,d){var l=this&&this.BO||(Object.create?function(a,k,n,v){void 0===v&&(v=n);Object.defineProperty(a,v,{enumerable:!0,get:function(){return k[n]}})}:function(a,k,n,v){void 0===v&&(v=n);a[v]=k[n]}),e=this&&this.__exportStar||function(a,k){for(var n in a)"default"===
n||Object.prototype.hasOwnProperty.call(k,n)||l(k,a,n)};Object.defineProperty(N,"__esModule",{value:!0});e(d(1785),N);e(d(1786),N);e(d(1787),N);e(d(1788),N);e(d(1789),N);C.exports.SuggestionCategory||Object.defineProperty(C.exports,"SuggestionCategory",{enumerable:!0,get:function(){return C.exports.SuggestionCategory}})},1580:function(C,N,d){d.d(N,"a",function(){return l});C=d(0);class l{constructor(e){this.source=e}}Object(C.a)(l,"AcceptAllActionData",null,[])},1582:function(C,N,d){d.d(N,"c",function(){return e});
d.d(N,"a",function(){return a});d.d(N,"b",function(){return k});var l=d(28);const e=(n,v,u)=>{if(!l.c(n)&&"#text"!==n.nodeName&&(v?n.setAttribute("unselectable","on"):n.setAttribute("unselectable","off"),u))for(n=n.firstChild;n;)e(n,v,!0),n=n.nextSibling},a=n=>{n=document.createElement(n);n.setAttribute("unselectable","on");return n},k=(n,v)=>{if(!l.c(n)){var u=n.className;if(l.c(u)||-1===u.indexOf(v))v=u.trim()+" "+v,v=v.trim(),n.className=v}}},1583:function(C,N,d){d.d(N,"a",function(){return t});
C=d(0);var l=d(8),e=d(44),a=d(2),k=d(137),n=d(22),v=d(248),u=d(36);class t{constructor(){this.H9a=null;this.C0g=!1}d7f(){try{this.H9a||(this.H9a=n.a.instance.resolve("Common.App.SearchCommon.ISearchOAuthManager"),this.C0g=!!a.AFrameworkApplication.K&&a.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.EnableOAuthMgrForService",!1))}catch(y){l.ULS.sendTraceTag(51689674,1300,10,"Unable to resolve ISearchOAuthManager: "+y)}}vyl(){this.d7f();return this.H9a?this.H9a.getToken("Search",
a.AFrameworkApplication.kyf,!1):null}NZh(){if("Dev Box"===a.AFrameworkApplication.K.lb("StatusBarEnvironmentNameToUse")&&void 0!==window.TellMeSubstrateTokenOverride&&null!==window.TellMeSubstrateTokenOverride)return new Promise(y=>{window.setTimeout(()=>{y(window.TellMeSubstrateTokenOverride)},750)});this.d7f();return this.H9a?this.H9a.getToken("Search",a.AFrameworkApplication.j3f,!0):null}WLl(){this.d7f();return this.H9a?this.H9a.getToken("Search",this.TLl(),this.C0g):null}TLl(){return a.AFrameworkApplication.K.lb("TellMeServiceAuthEndpointForSearch")}wyl(){return Object(e.a)(this,
this.vyl,"getLokiTokenPromise")}AKl(){return Object(e.a)(this,this.NZh,"getSubstrateTokenPromise")}iKb(){return!!a.AFrameworkApplication.ua&&a.AFrameworkApplication.ua.Sb.iKb}GMl(){const y={};this.iKb()&&(y.Loki=this.wyl(),y.Substrate=this.AKl());return y}pRc(y){k.a.hEa(Object.assign(new v.a,{name:"Events",dataFields:[Object.assign(new u.a,{name:"Event",string:"StringsLoaded"}),Object.assign(new u.a,{name:"Status",bool:y})],durationMs:Math.round(window.performance.now())}),"TellMeWAC.")}ktm(){return a.AFrameworkApplication.K.$("DynamicBundlesIsEnabled")?
appResourceLoader.loadChunk("tellme-strings").catch(()=>{this.pRc(!1);return!1}).then(()=>{this.pRc(!0);return!0}):new Promise((y,B)=>{const G=n.a.instance.resolve("Common.IDynamicScriptLoaderProvider").JE;G?G.loadScript("tellme-strings").then(()=>{this.pRc(!0);y(!0)}).catch(()=>{this.pRc(!1);B(!1)}):(this.pRc(!1),B(!1))})}static Tjm(){return!!a.AFrameworkApplication.ua&&(a.AFrameworkApplication.ua.Sb.APc||a.AFrameworkApplication.ua.Sb.A7b)}static fQd(){return!!a.AFrameworkApplication.ua&&a.AFrameworkApplication.ua.Sb.A7b}}
Object(C.a)(t,"ReactSharedHeaderSearchUtils",null,[])},1585:function(C,N,d){d.r(N);d.d(N,"validateCpDataV1",function(){return e});d.d(N,"isEqual",function(){return a});d.d(N,"isSupportedCpVersion",function(){return k});d.d(N,"validateVersionedCpData",function(){return v});d.d(N,"versionedDeserialize",function(){return u});var l=d(1559);const e=t=>"number"!==typeof t.CP||null!=t.FB&&"number"!==typeof t.FB||null!=t.FE&&"number"!==typeof t.FE||null!=t.HB&&"number"!==typeof t.HB||null!=t.HE&&"number"!==
typeof t.HE||null!=t.CB&&"number"!==typeof t.CB||null!=t.CE&&"number"!==typeof t.CE||null!=t.R&&"number"!==typeof t.R||null!=t.E&&"number"!==typeof t.E||null!=t.TW&&"number"!==typeof t.TW||null!=t.PB&&"number"!==typeof t.PB||null!=t.SYM&&"number"!==typeof t.SYM||null!=t.IE&&"number"!==typeof t.IE||null!=t.OO&&"number"!==typeof t.OO||null!=t.AX&&"number"!==typeof t.AX||null!=t.CCI&&"number"!==typeof t.CCI||null!=t.DD&&"number"!==typeof t.DD?!1:!0,a=(t,y)=>t||y?t&&y&&t.CP===y.CP&&t.FB===y.FB&&t.FE===
y.FE&&t.HB===y.HB&&t.HE===y.HE&&t.CB===y.CB&&t.CE===y.CE&&t.R===y.R&&t.E===y.E&&t.TW===y.TW&&t.PB===y.PB&&t.SYM===y.SYM&&t.IE===y.IE&&t.OO===y.OO&&t.AX===y.AX&&t.CCI===y.CCI&&t.DD===y.DD?!0:!1:!0,k=t=>1===t,n=t=>{let y=t,B=0;"number"===typeof y.VS&&(B=y.VS);if("number"===typeof y.VS||"number"===typeof y.CP)return{returnValue:y,p$f:B};y=null;for(let G=0;G<t.length;G++){const F=t[G];1===F.VS&&F.VS>B&&(B=F.VS,y=t[G])}return{returnValue:y,p$f:B}},v=t=>{const y=({p$f:t}=n(t)).returnValue;if(!y)return!1;
switch(t){case 0:case 1:return e(y);default:return!1}},u=t=>{if(!t)return null;const y=({p$f:t}=n(t)).returnValue;if(!y)return null;switch(t){case 0:case 1:return l.b(y);default:return null}}},1597:function(C,N,d){C=d(0);var l=d(594),e=d(16),a=d(169),k=d(68),n=d(2),v=d(22),u=d(8),t=d(1427),y=d(20),B=d(14),G=d(108),F=d(34),K=d(3),O=d(1019),H=d(164),I=d(19),J=d(25),L=d(140),S=d(11);class E{static get Yeh(){E.Ijc||(E.Ijc=[],E.l9b(l.a.pg("ar-sa")),E.l9b(l.a.pg("de-de")),E.l9b(l.a.pg("es-es")),E.UZ(l.a.pg("en-029"),
l.a.pg("en-us")),E.UZ(l.a.pg("en-au"),l.a.pg("en-us")),E.UZ(l.a.pg("en-bz"),l.a.pg("en-us")),E.UZ(l.a.pg("en-ca"),l.a.pg("en-us")),E.UZ(l.a.pg("en-gb"),l.a.pg("en-us")),E.UZ(l.a.pg("en-id"),l.a.pg("en-us")),E.UZ(l.a.pg("en-my"),l.a.pg("en-us")),E.UZ(l.a.pg("en-ph"),l.a.pg("en-us")),E.UZ(l.a.pg("zh-tw"),l.a.pg("en-us")),E.l9b(l.a.pg("fr-fr")),E.UZ(l.a.pg("hr-ba"),l.a.pg("hr-hr")),E.UZ(l.a.pg("it-ch"),l.a.pg("it-it")),E.UZ(l.a.pg("nb-no"),l.a.pg("nn-no")),E.l9b(l.a.pg("nl-nl")),E.UZ(l.a.pg("ro-md"),
l.a.pg("ro-ro")),E.UZ(l.a.pg("ru-md"),l.a.pg("ru-ru")),E.UZ(l.a.pg("sr-latn-ba"),l.a.pg("sr-latn-cs")),E.UZ(l.a.pg("sr-latn-me"),l.a.pg("sr-latn-cs")),E.UZ(l.a.pg("sr-latn-rs"),l.a.pg("sr-latn-cs")),E.l9b(l.a.pg("sr-cyrl-cs")),E.UZ(l.a.pg("sv-fi"),l.a.pg("sv-se")));return E.Ijc}static l9b(ma){E.Ijc[ma.languageId]=ma.LCID}static UZ(ma,Ga){E.Ijc[ma.LCID]=Ga.LCID}static uQh(ma){var Ga=l.a.pg(ma);if(!Ga)return 0;Ga=E.Yeh[Ga.LCID]||E.Yeh[Ga.languageId]||0;return Ga===ma?0:Ga}}E.Ijc=null;Object(C.a)(E,
"AutoCorrectListFallback",null,[]);var P=d(374),T=d(83),U=d(106),X=d(110),Y=d(5),ca=d(17),da=d(6),ua=d(101),ra=d(312),qa=d(40),ka=d(70),la=d(105),Ha=d(49),wa=d(1504);class Ca extends wa.a{constructor(ma,Ga,Fa,ib,ob,fb){super(ma,Ga,Fa,ib,fb);this.oX=ob}get OB(){return!0}get commandId(){return K.a.vgk}set OB(ma){super.OB=ma}}Object(C.a)(Ca,"ARegexCorrectAction",wa.a,[]);class Ja extends Ca{static get ihb(){if(null!=Ja.Ang)var ma=Ja.Ang;else(ma=v.a.instance.Pa("Box4.List.IListCommands"))||u.ULS.sendTraceTag(512357316,
393,50,"IListCommands was tried to be resolved before it was registered."),ma=Ja.Ang=ma;return ma}static get Ko(){return null!=Ja.Fng?Ja.Fng:Ja.Fng=v.a.instance.resolve("Box4.List.IListEditor")}static get hd(){return null!=Ja.Yng?Ja.Yng:Ja.Yng=v.a.instance.resolve("Box4.List.IListReader")}get levelText(){const [ma,Ga]=this.oX;return Ga?ma.replace(Ga,"%1"):ma}}Object(C.a)(Ja,"AListAutoCorrectAction",Ca,[]);var bb=d(231);class ha extends Ja{get commandId(){return K.a.ogk}Eka(ma){if(ha.ihb){var Ga=da.GraphIterator.$a(ma);
Ga.vd();qa.OutlineElementNavigator.Zd(Ga);if(ha.Ko.W7d(Ga,this.oX[0])){var Fa=ha.hd.Hs(Ga),ib=this.oX[0],ob=e.a.charAt(ib,0),fb=this.Nyl(ob),Mb=ra.a.HP(1,fb.listStyle);Fa&&Mb.Nkf(Fa)||(Fa=new Ha.GraphTransaction(15),Fa.Ou(Ga),this.Vd.replaceTextRange(F.a.createTextRange(ma,this.JF,this.VZ+1),"",!0,!1),ha.Ko.TZi(Mb),ma=new P.DictionaryPropertySet,ma.setValue(U.a.G$e,!0),ob&&(Mb.qP=ob,ma.setValue(X.a.qP,Mb.qP)),ma.setValue(Y.a.Ur,fb.levelText),ma.setValue(ca.a.font,fb.fontName),"-"===ob&&T.Health.instance.recordKpiUsage("DashBulletAutoCreate",
0,ha.EB,null),bb.a.bX&&(ma.setValue(X.a.Bma,"autocorrect"),ma.setValue(X.a.tfa,ib)),ha.ihb.Rnk(Mb.listType,Mb.listStyle,ma),Fa.dispose())}}}Nyl(ma){const Ga={listStyle:0,levelText:ua.a.Iyd,fontName:ua.a.wDc};switch(ma){case "*":return Object.assign(Object.assign({},Ga),{listStyle:1});case "-":return Object.assign(Object.assign({},Ga),{levelText:"-",fontName:la.a.QG});default:return Ga}}static jF(ma,Ga,Fa,ib,ob){return new ha(null,ma,Ga,Fa,ib,ob)}static FS(ma,Ga,Fa,ib,ob){return new ha(ma,ka.a(ma).zb,
Ga,Fa,ib,ob)}}ha.EB="wwaengidc";ha.UQf=["[\\*](?![\\*])","[\\-](?![\\-])"];Object(C.a)(ha,"BulletListAction",Ja,[]);var ia=d(86);class va extends Ca{constructor(ma,Ga,Fa,ib,ob,fb){super(ma,Ga,Fa,ib,ob,fb);this.Lpc=!1;this.OB=!ma;va.Ro=new ia.a}get OB(){return this.Lpc}set OB(ma){this.Lpc=ma}nyb(ma){this.xWe(ma.innerText,(Ga,Fa,ib)=>{ma.innerText=e.a.substring(ma.innerText,0,Ga)+ib+e.a.right(ma.innerText,Fa)})}Eka(ma){this.xWe(S.ParagraphReader.text(ma).substring(this.JF,this.VZ),(Ga,Fa,ib)=>{this.Vd.replaceTextRange(F.a.createTextRange(ma,
this.JF+Ga,this.JF+Fa),ib,!0,!1)})}xWe(ma,Ga){if(!(2>this.oX.length)&&this.oX[1]){var Fa=this.oX[1];va.Ro.count||this.qFi();va.Ro.xb(Fa)&&(ma=ma.lastIndexOf(Fa),-1!==ma&&Ga(ma,ma+Fa.length,va.Ro.J(Fa)))}}}Object(C.a)(va,"ADictionarySequenceReplacerAction",Ca,[]);class Ka extends va{get commandId(){return K.a.tSe}qFi(){va.Ro.Z("--","\u2014");va.Ro.Z(" -- "," \u2013 ");va.Ro.Z(" - "," \u2013 ");va.Ro.Z("-- ","\u2014");va.Ro.Z(" --"," \u2013");va.Ro.Z(" -"," \u2013")}static jF(ma,Ga,Fa,ib,ob){return new Ka(null,
ma,Ga,Fa,ib,ob)}static FS(ma,Ga,Fa,ib,ob){return new Ka(ma,ka.a(ma).zb,Ga,Fa,ib,ob)}}Object(C.a)(Ka,"DashAction",va,[]);class Xa extends va{constructor(ma,Ga,Fa,ib,ob,fb,Mb){super(ma,Ga,Fa,ib,ob,fb);this.ga=Mb}get commandId(){return K.a.pgk}qFi(){va.Ro.Z(":)","\ud83d\ude0a");va.Ro.Z(":-)","\ud83d\ude0a");va.Ro.Z(":|","\ud83d\ude10");va.Ro.Z(":-|","\ud83d\ude10");va.Ro.Z(":(","\ud83d\ude41");va.Ro.Z(":-(","\ud83d\ude41");va.Ro.Z(";)","\ud83d\ude09");va.Ro.Z(";-)","\ud83d\ude09");va.Ro.Z(":D","\ud83d\ude00");
va.Ro.Z(":-D","\ud83d\ude00");va.Ro.Z(":')","\ud83d\ude02");va.Ro.Z("=D","\ud83d\ude03");va.Ro.Z(":>","\ud83d\ude06");va.Ro.Z(":->","\ud83d\ude06");va.Ro.Z(":3","\ud83d\ude0a");va.Ro.Z(":-3","\ud83d\ude0a");va.Ro.Z("B-)","\ud83d\ude0e");va.Ro.Z("*-*","\ud83d\ude0d");va.Ro.Z(":*","\ud83d\ude19");va.Ro.Z(":-*","\ud83d\ude19");va.Ro.Z(":X","\ud83d\ude36");va.Ro.Z(":-X","\ud83d\ude36");va.Ro.Z(":O","\ud83d\ude2e");va.Ro.Z(":-O","\ud83d\ude2e");va.Ro.Z(":#","\ud83e\udd10");va.Ro.Z(":-#","\ud83e\udd10");
va.Ro.Z(":P","\ud83d\ude1b");va.Ro.Z(":-P","\ud83d\ude1b");va.Ro.Z(";P","\ud83d\ude1c");va.Ro.Z(";-P","\ud83d\ude1c");va.Ro.Z(":-/","\ud83d\ude15");va.Ro.Z("$-$","\ud83e\udd11");va.Ro.Z(":S","\ud83d\ude16");va.Ro.Z(":-S","\ud83d\ude16");va.Ro.Z(":[","\ud83d\ude1f");va.Ro.Z(":-[","\ud83d\ude1f");va.Ro.Z(":\u2019(","\ud83d\ude22");va.Ro.Z(":'(","\ud83d\ude22");va.Ro.Z("@-@","\ud83d\ude31")}Eka(ma){this.xWe(S.ParagraphReader.text(ma).substring(this.JF,this.VZ),(Ga,Fa,ib)=>{Ga=F.a.createTextRange(ma,
this.JF+Ga,this.JF+Fa);Fa={};Fa.MenuItemId=ib;this.ga.Qf(Ga,K.a.pfb,2,!1,null,Fa,null)})}static jF(ma,Ga,Fa,ib,ob,fb){return new Xa(null,ma,Ga,Fa,ib,ob,fb)}static FS(ma,Ga,Fa,ib,ob,fb){return new Xa(ma,ka.a(ma).zb,Ga,Fa,ib,ob,fb)}}Object(C.a)(Xa,"EmojiAction",va,[]);class xa{constructor(ma,Ga,Fa,ib){this.uR=ma;this.Aod=Ga;this.oqc=ib;this.NE=Fa}Bfi(){if(!this.NE)return!1;this.uR=this.uR.trimStart();return this.uR===this.NE?!0:!1}Hnm(){if(!this.uR)return!1;const ma=this.uR.lastIndexOf(" ");return-1!==
ma&&"."===this.uR.charAt(ma-1)&&"."===this.uR.charAt(ma-3)?!0:!1}Gnm(){if(!this.uR)return!1;var ma=this.uR.lastIndexOf(" ");return-1!==ma&&(ma=this.uR.substring(0,ma-1).lastIndexOf(" "),"."===this.uR.charAt(ma+2))?!0:!1}bhm(){return this.Bfi()&&(1===this.NE.length&&"."===this.Aod||"."===this.uR.charAt(1))?!0:!1}chm(){return this.NE?0<="\\/".indexOf(this.Aod)||3===this.NE.length&&0<="\\/".indexOf(this.NE.charAt(1))?!0:!1:!1}bgm(){return this.NE?0<=this.NE.indexOf("@")?!0:!1:!1}IA(){if(!this.NE)return!1;
for(const ma of xa.ujf())if(e.a.startsWith(this.NE+this.Aod,ma))return!0;return!1}Ifm(){return this.NE?"i"===this.NE&&0<=xa.quotes.indexOf(this.Aod)?!0:!1:!1}dam(){if(!this.uR)return!1;const ma=e.a.V_a(this.uR,this.uR.length-1);if(-1!==ma&&this.uR.substring(ma+1,this.uR.length)===this.NE){const Ga=this.uR.charAt(ma-1);if(0<=xa.ZWf.indexOf(Ga)||0<=xa.quotes.indexOf(Ga)&&0<=xa.ZWf.indexOf(this.uR.charAt(ma-2)))return!0}return!1}Atk(){return!this.uR||this.Hnm()||this.bhm()||this.chm()||this.Gnm()||this.bgm()||
this.IA()?!1:this.Bfi()||this.Ifm()||this.dam()?!0:!1}static ujf(){return xa.WOg||(xa.WOg="http: https: ftp:// mailto: \\\\ www.".split(" "))}}xa.ZWf=".!?";xa.quotes="'\"";xa.WOg=null;Object(C.a)(xa,"FirstLetterUpperCaseRules",null,[]);class Ma{constructor(ma){this.NE=ma}fel(){if(!this.NE)return null;for(let ma=0;ma<Ma.v1h().length;ma++)if(this.NE===Ma.v1h()[ma])return Ma.cQl()[ma];return null}static v1h(){return Ma.xFg||(Ma.xFg=["1/2","1/4","3/4"])}static cQl(){return Ma.wFg||(Ma.wFg=["\u00bd","\u00bc",
"\u00be"])}}Ma.xFg=null;Ma.wFg=null;Object(C.a)(Ma,"FractionsCollection",null,[]);class Na extends wa.a{constructor(ma,Ga,Fa,ib,ob,fb){super(ma,Ga,Fa,ib,fb);this.qsh=ob}get OB(){return!0}get commandId(){return K.a.qgk}nyb(ma){ma.innerText=e.a.substring(ma.innerText,0,this.JF)+this.qsh+e.a.right(ma.innerText,this.VZ)}Eka(ma){this.Vd.replaceTextRange(F.a.createTextRange(ma,this.JF,this.VZ),this.qsh,!0,!1)}set OB(ma){super.OB=ma}static jF(ma,Ga,Fa,ib,ob){return new Na(null,ma,Ga,Fa,ib,ob)}}Object(C.a)(Na,
"FractionsReplaceCorrectAction",wa.a,[]);class pa extends Ja{get commandId(){return K.a.sgk}Eka(ma){if(pa.ihb){var Ga=da.GraphIterator.$a(ma);Ga.vd();qa.OutlineElementNavigator.Zd(Ga);if(pa.Ko.W7d(Ga,this.oX[0])){var [Fa,ib]=this.oX,ob=pa.rNm(ib),fb=e.a.V7b(ib)?4:2,Mb=F.a.createTextRange(ma,this.JF,this.VZ+1);pa.Ko.YXb(ma,Ga,fb,ob,Mb,Fa,this.levelText,pa.ihb)}}}static jF(ma,Ga,Fa,ib,ob){return new pa(null,ma,Ga,Fa,ib,ob)}static FS(ma,Ga,Fa,ib,ob){return new pa(ma,ka.a(ma).zb,Ga,Fa,ib,ob)}static rNm(ma){if(!ma)return 0;
ma=e.a.mh(ma);if(!e.a.wNd(ma.charAt(0)))return 0;const Ga=ma.charCodeAt(0)-97+1;let Fa;for(Fa=1;Fa<ma.length&&ma.charAt(Fa)===ma.charAt(0);Fa++);return 26*(Fa-1)+Ga}}Object(C.a)(pa,"LetterListAction",Ja,[]);var Ra=d(135);class Sa extends Ja{get commandId(){return K.a.YXb}Eka(ma){if(Sa.ihb){var Ga=da.GraphIterator.$a(ma);Ga.vd();qa.OutlineElementNavigator.Zd(Ga);if(Sa.Ko.W7d(Ga,this.oX[0])){var [Fa,ib]=this.oX,ob=parseInt(ib);if(!(99999999<=ob)){var fb=F.a.createTextRange(ma,this.JF,this.VZ+1);Ra.a.XQd()&&
Ra.a.VRl();Sa.Ko.YXb(ma,Ga,1,ob,fb,Fa,this.levelText,Sa.ihb)}}}}static jF(ma,Ga,Fa,ib,ob){return new Sa(null,ma,Ga,Fa,ib,ob)}static FS(ma,Ga,Fa,ib,ob){return new Sa(ma,ka.a(ma).zb,Ga,Fa,ib,ob)}}Object(C.a)(Sa,"NumberListAction",Ja,[]);class ab extends wa.a{get OB(){return!0}get commandId(){return K.a.tgk}nyb(){}Eka(ma){const Ga=F.a.createTextRange(ma,this.VZ-2,this.VZ),Fa=new Ha.GraphTransaction(15);Fa.Db(ma);let ib=!1,ob=null,fb=0;for(;fb<ma.qa.length;){var Mb=ma.qa.J(fb),Tb=Mb.D6;const rc=Mb.GT;
if(Mb.cp>=Ga.cpBegin){Mb.cp>Ga.cpBegin||!Mb.formatting?ob=ib?Mb.formatting:this.Vd.OX(ma,fb,Ga.cpBegin,ob):(ob=Mb.formatting,rc&&(ib=!1),Tb&&(ib=!0));fb++;break}Mb.formatting&&(ob=Mb.formatting);rc&&(ib=!1);Tb&&(ib=!0);fb++}for(;fb<ma.qa.length;){Tb=ma.qa.J(fb);if(Tb.cp>=Ga.cpEnd){if(Tb.cp>Ga.cpEnd||!Tb.formatting&&!Tb.Xh)ib||this.Vd.OX(ma,fb,Ga.cpEnd,ob);ib||ab.vi.cba(ob,!0);break}Tb.formatting&&(ib||ab.vi.cba(ob,!0),ob=Tb.formatting);Mb=Tb.D6;Tb=Tb.GT;Mb&&(ib=!0);!Mb&&Tb&&(ib=!1);fb++}Fa.dispose()}set OB(ma){super.OB=
ma}static get vi(){return null!=ab.pkg?ab.pkg:ab.pkg=v.a.instance.resolve("Box4.IFormattingEditor")}static jF(ma,Ga,Fa,ib){return new ab(null,ma,Ga,Fa,ib)}}Object(C.a)(ab,"OrdinalsReplaceCorrectAction",wa.a,[]);var eb;(function(ma){ma[ma.rand=0]="rand";ma[ma.randOld=1]="randOld";ma[ma.lorem=2]="lorem"})(eb||(eb={}));Object(C.b)("RandTextType",eb);class zb extends Ca{constructor(ma,Ga,Fa,ib,ob,fb){super(ma,Ga,Fa,ib,ob,fb);zb.TDe||zb.B2n()}static Pgm(){var ma;return null===(ma=n.AFrameworkApplication.K)||
void 0===ma?void 0:ma.getBooleanFeatureGate("Microsoft.Office.WordOnline.isNoRandDoubleSpaceEnabled",!0)}get commandId(){return K.a.ugk}Eka(ma){if(!ma.vw){var Ga=this.l7a.Qa.node===ma,Fa=5,ib=3;if(this.oX[0].startsWith("=rand.old")){var ob=eb.randOld;Fa=3}else if(this.oX[0].startsWith("=rand"))ob=eb.rand;else if(this.oX[0].startsWith("=lorem"))ob=eb.lorem;else return;this.oX[1]&&(Fa=parseInt(this.oX[1]));this.oX[2]&&(ib=parseInt(this.oX[2]));if(!(20<ib||100<Fa)){ma.YG().AF.y9(7);var fb=da.GraphIterator.$a(ma);
fb.vd();qa.OutlineElementNavigator.Zd(fb);zb.Wg.eD(fb,!1,!1);zb.Wg.zN(fb);var Mb=!1;switch(ob){case eb.rand:ob=zb.TDe;break;case eb.randOld:ob=zb.eXg;break;case eb.lorem:ob=zb.PPg;Mb=!0;break;default:return}var Tb=0;for(let vb=0;vb<Fa;++vb){const Ya=[];for(var rc=0;rc<ib;rc++)Ya.push(ob[Tb++%ob.length]);rc=F.a.Uc(fb.currentNode,0);if(Mb){const wb=G.FormattingReader.Pr(rc);zb.vi.$l(wb,Y.a.noProof,!0)}this.Vd.replaceTextRange(rc,Ya.join(zb.Pgm()?"":" "),!0,!1);vb<Fa-1&&(qa.OutlineElementNavigator.Zd(fb),
zb.Wg.eD(fb,!1,!1),zb.Wg.zN(fb))}Fa=fb.currentNode;fb=da.GraphIterator.$a(ma);fb.vd();qa.OutlineElementNavigator.Zd(fb);fb.Eg();Ga&&(this.l7a=J.SelectionFactory.xe(Fa,S.ParagraphReader.textLength(Fa)))}}}static get Wg(){return null!=zb.zog?zb.zog:zb.zog=v.a.instance.resolve("Box4.IOutlineElementEditor")}static get vi(){return null!=zb.ukg?zb.ukg:zb.ukg=v.a.instance.resolve("Box4.IFormattingEditor")}static B2n(){zb.TDe="Video provides a powerful way to help you prove your point. ;When you click Online Video, you can paste in the embed code for the video you want to add. ;You can also type a keyword to search online for the video that best fits your document. ;To make your document look professionally produced, Word provides header, footer, cover page, and text box designs that complement each other. ;For example, you can add a matching cover page, header, and sidebar. ;Click Insert and then choose the elements you want from the different galleries. ;Themes and styles also help keep your document coordinated. ;When you click Design and choose a new Theme, the pictures, charts, and SmartArt graphics change to match your new theme. ;When you apply styles, your headings change to match the new theme. ;Save time in Word with new buttons that show up where you need them. ;To change the way a picture fits in your document, click it and a button for layout options appears next to it. ;When you work on a table, click where you want to add a row or a column, and then click the plus sign. ;Reading is easier, too, in the new Reading view. ;You can collapse parts of the document and focus on the text you want. ;If you need to stop reading before you reach the end, Word remembers where you left off - even on another device. ".split(";");
zb.eXg=["The quick brown fox jumps over the lazy dog. "];zb.PPg="Lorem ipsum dolor sit amet, consectetuer adipiscing elit. ;Maecenas porttitor congue massa. ;Fusce posuere, magna sed pulvinar ultricies, purus lectus malesuada libero, sit amet commodo magna eros quis urna. ;Nunc viverra imperdiet enim. ;Fusce est. ;Vivamus a tellus. ;Pellentesque habitant morbi tristique senectus et netus et malesuada fames ac turpis egestas. ;Proin pharetra nonummy pede. ;Mauris et orci. ;Aenean nec lorem. ;In porttitor. ;Donec laoreet nonummy augue. ;Suspendisse dui purus, scelerisque at, vulputate vitae, pretium mattis, nunc. ;Mauris eget neque at sem venenatis eleifend. ;Ut nonummy. ;Fusce aliquet pede non pede. ;Suspendisse dapibus lorem pellentesque magna. ;Integer nulla. ;Donec blandit feugiat ligula. ;Donec hendrerit, felis et imperdiet euismod, purus ipsum pretium metus, in lacinia nulla nisl eget sapien. ;Donec ut est in lectus consequat consequat. ;Etiam eget dui. ;Aliquam erat volutpat. ;Sed at lorem in nunc porta tristique. ;Proin nec augue. ;Quisque aliquam tempor magna. ;Pellentesque habitant morbi tristique senectus et netus et malesuada fames ac turpis egestas. ;Nunc ac magna. ;Maecenas odio dolor, vulputate vel, auctor ac, accumsan id, felis. ;Pellentesque cursus sagittis felis. ;Pellentesque porttitor, velit lacinia egestas auctor, diam eros tempus arcu, nec vulputate augue magna vel risus. ;Cras non magna vel ante adipiscing rhoncus. ;Vivamus a mi. ;Morbi neque. ;Aliquam erat volutpat. ;Integer ultrices lobortis eros. ;Pellentesque habitant morbi tristique senectus et netus et malesuada fames ac turpis egestas. ;Proin semper, ante vitae sollicitudin posuere, metus quam iaculis nibh, vitae scelerisque nunc massa eget pede. ;Sed velit urna, interdum vel, ultricies vel, faucibus at, quam. ;Donec elit est, consectetuer eget, consequat quis, tempus quis, wisi. ;In in nunc. ;Class aptent taciti sociosqu ad litora torquent per conubia nostra, per inceptos hymenaeos. ;Donec ullamcorper fringilla eros. ;Fusce in sapien eu purus dapibus commodo. ;Cum sociis natoque penatibus et magnis dis parturient montes, nascetur ridiculus mus. ;Cras faucibus condimentum odio. ;Sed ac ligula. ;Aliquam at eros. ;Etiam at ligula et tellus ullamcorper ultrices. ;In fermentum, lorem non cursus porttitor, diam urna accumsan lacus, sed interdum wisi nibh nec nisl. ;Ut tincidunt volutpat urna. ;Mauris eleifend nulla eget mauris. ;Sed cursus quam id felis. ;Curabitur posuere quam vel nibh. ;Cras dapibus dapibus nisl. ;Vestibulum quis dolor a felis congue vehicula. ;Maecenas pede purus, tristique ac, tempus eget, egestas quis, mauris. ;Curabitur non eros. ;Nullam hendrerit bibendum justo. ;Fusce iaculis, est quis lacinia pretium, pede metus molestie lacus, at gravida wisi ante at libero. ;Quisque ornare placerat risus. ;Ut molestie magna at mi. ;Integer aliquet mauris et nibh. ;Ut mattis ligula posuere velit. ;Nunc sagittis. ;Curabitur varius fringilla nisl. ;Duis pretium mi euismod erat. ;Maecenas id augue. ;Nam vulputate. ;Duis a quam non neque lobortis malesuada. ;Praesent euismod. ;Donec nulla augue, venenatis scelerisque, dapibus a, consequat at, leo. ;Pellentesque libero lectus, tristique ac, consectetuer sit amet, imperdiet ut, justo. ;Sed aliquam odio vitae tortor. ;Proin hendrerit tempus arcu. ;In hac habitasse platea dictumst. ;Suspendisse potenti. ;Vivamus vitae massa adipiscing est lacinia sodales. ;Donec metus massa, mollis vel, tempus placerat, vestibulum condimentum, ligula. ;Nunc lacus metus, posuere eget, lacinia eu, varius quis, libero. ;Aliquam nonummy adipiscing augue. ".split(";")}static jF(ma,
Ga,Fa,ib,ob){return new zb(null,ma,Ga,Fa,ib,ob)}static FS(ma,Ga,Fa,ib,ob){return new zb(ma,ka.a(ma).zb,Ga,Fa,ib,ob)}}zb.TDe=null;zb.eXg=null;zb.PPg=null;Object(C.a)(zb,"RandAction",Ca,[]);class Ua{constructor(ma,Ga,Fa,ib){this.pattern=ib&8?new RegExp(ma,"i"):new RegExp(ma);this.CZl=Ga;this.RQl=Fa;this.flags=ib}}Object(C.a)(Ua,"RegexAutoCorrectEntry",null,[]);class Ab extends Ja{get commandId(){return K.a.wgk}Eka(ma){if(Ab.ihb){var Ga=da.GraphIterator.$a(ma);Ga.vd();qa.OutlineElementNavigator.Zd(Ga);
if(Ab.Ko.W7d(Ga,this.oX[0])){var [Fa,ib]=this.oX,ob=Ab.sNm(ib);if(!(0>=ob)){var fb=e.a.V7b(ib.charAt(0))?5:3,Mb=F.a.createTextRange(ma,this.JF,this.VZ+1);Ab.Ko.YXb(ma,Ga,fb,ob,Mb,Fa,this.levelText,Ab.ihb)}}}}static jF(ma,Ga,Fa,ib,ob){return new Ab(null,ma,Ga,Fa,ib,ob)}static FS(ma,Ga,Fa,ib,ob){return new Ab(ma,ka.a(ma).zb,Ga,Fa,ib,ob)}static q3k(){Ab.zIa||(Ab.zIa={},Ab.zIa.M=1E3,Ab.zIa.D=500,Ab.zIa.C=100,Ab.zIa.L=50,Ab.zIa.X=10,Ab.zIa.V=5,Ab.zIa.I=1)}static sNm(ma){if(!ma)return 0;Ab.q3k();ma=e.a.Wz(ma);
let Ga=0,Fa=0;for(let ib=ma.length-1;0<=ib;ib--){const ob=Ab.zIa[e.a.charAt(ma,ib).toString()];Fa=ob<Ga?Fa-ob:Fa+ob;Ga=ob}return Fa}}Ab.zIa=null;Ab.UQf=["M{1,4}(CM|CD|D?C{0,3})(XC|XL|L?X{0,3})(IX|IV|V?I{0,3})","(CM|CD|DC{0,3}|C{1,3})(XC|XL|L?X{0,3})(IX|IV|V?I{0,3})","(XC|XL|LX{0,3}|X{1,3})(IX|IV|V?I{0,3})","(IX|IV|VI{0,3}|I{1,3})"].map(ma=>`\\(?(${ma})[\\.\\)\\-]`);Object(C.a)(Ab,"RomanListAction",Ja,[]);var mb=d(43);class Rb extends wa.a{constructor(ma,Ga,Fa,ib,ob,fb){super(ma,Ga,Fa,Fa+1,fb);this.CYj=
ib;this.zzg=ob;this.uSc=!1}get OB(){return!1}get commandId(){return K.a.xgk}nyb(ma){ma.innerText=e.a.substring(ma.innerText,0,this.JF)+this.zzg+e.a.right(ma.innerText,this.VZ)}Eka(ma){this.Vd.replaceTextRange(F.a.createTextRange(ma,this.JF,this.VZ),this.CYj,!0,!1);this.Vd.replaceTextRange(F.a.createTextRange(ma,this.JF,this.JF+1),this.zzg,!0,!1)}set OB(ma){super.OB=ma}static jF(ma,Ga,Fa,ib,ob,fb){if("'"!==Fa&&'"'!==Fa)return null;var Mb=da.GraphIterator.$a(ma);Mb.vd();qa.OutlineElementNavigator.Zd(Mb);
if(mb.OutlineElementReader.hm(Mb.currentNode))return null;ib=!Ga||e.a.daa(ib)||-1!==Array.indexOf(Rb.AZm,ib);Mb="'"===Fa;return new Rb(fb,ma,Ga,Fa+"",ib?Mb?"\u2018":"\u201c":Mb?"\u2019":"\u201d",ob)}}Rb.AZm=["[","{","("];Object(C.a)(Rb,"SmartQuoteCorrectAction",wa.a,[]);class hc extends wa.a{constructor(ma,Ga,Fa,ib,ob,fb){super(ma,Ga,Fa,ib,fb);this.yzg=ob}get OB(){return hc.Lpc}set OB(ma){hc.Lpc=ma}get commandId(){return K.a.ygk}jkj(){this.efd=this.Ylh();this.efd||(this.xOg=!1,this.qJg="MatchTextIsNotTheSame")}nyb(ma){ma.innerText=
e.a.substring(ma.innerText,0,this.JF)+this.yzg+e.a.right(ma.innerText,this.VZ)}Eka(ma){this.Vd.replaceTextRange(F.a.createTextRange(ma,this.JF,this.VZ),this.yzg,!0,!1)}static FS(ma,Ga,Fa,ib,ob){const fb=ka.a(ma);return new hc(ma,fb?fb.zb:null,Ga,Fa,ib,ob)}static jF(ma,Ga,Fa,ib,ob){return new hc(null,ma,Ga,Fa,ib,ob)}}hc.Lpc=!1;Object(C.a)(hc,"StringReplaceCorrectAction",wa.a,[]);class Hb extends wa.a{constructor(ma,Ga,Fa,ib,ob,fb,Mb,Tb){super(ma,Ga,Fa,ib,ob);this.Ok=fb;this.kJj=Mb;this.GC=Tb}get OB(){return!0}get commandId(){return K.a.zgk}nyb(ma){let Ga=
e.a.substring(ma.innerText,this.JF,this.VZ);Ga.charAt(0)!==Ga.charAt(0).toUpperCase()&&(Ga=Ga.charAt(0).toUpperCase()+Ga.substring(1,Ga.length));ma.innerText=e.a.substring(ma.innerText,0,this.JF)+Ga+e.a.right(ma.innerText,this.VZ)}Eka(ma){const Ga=this.JF,Fa=this.JF+1,ib=ma.characterData.substring(Ga,Fa).charAt(0);if(!e.a.V7b(ib)){const ob=F.a.createTextRange(ma,Ga,Fa);this.Aam(ob)||this.GC&&this.GC.DPc(ma,Ga,Fa)||this.Vd.replaceTextRange(ob,ib.toUpperCase().toString(),!0,!1)}}Aam(ma){return this.kJj?
!!this.Ok&&this.Ok.T$(ma):!1}set OB(ma){super.OB=ma}static FS(ma,Ga,Fa,ib){const ob=ka.a(ma);return new Hb(ma,ob?ob.zb:null,Ga,Fa,ib,null,!1,null)}static jF(ma,Ga,Fa,ib,ob,fb){return new Hb(null,ma,Ga,Fa,ib,ob,!0,fb)}}Object(C.a)(Hb,"UpperFirstLetterAutoCorrectAction",wa.a,[]);class Ta{constructor(ma,Ga){this.oqc=Ga;this.NE=ma}lpo(){const ma=Number.parseInvariant(this.NE.substring(0,this.NE.length-2));switch(Number.parseInvariant(this.NE.charAt(this.NE.length-3).toString())){case 1:return 11===ma?
"th":"st";case 2:return 12===ma?"th":"nd";case 3:return 13===ma?"th":"rd";case 4:case 5:case 6:case 7:case 8:case 9:case 0:return"th";default:return""}}phm(){var ma=l.a.pg(this.oqc);if(!ma||!ma.name.toLowerCase().startsWith("en")||!this.NE||2>=this.NE.length)return!1;for(ma=0;ma<Ta.XId().length;ma++)if(this.NE.toLowerCase().endsWith(Ta.XId()[ma])){if(RegExp("^\\d+$").test(this.NE.substr(0,this.NE.length-2))){const Ga=this.lpo();if(this.NE.toLowerCase().endsWith(Ta.XId()[ma])&&Ga===Ta.XId()[ma])return!0}break}return!1}static XId(){return Ta.gUg||
(Ta.gUg=["st","nd","rd","th"])}}Ta.gUg=null;Object(C.a)(Ta,"ValidateOrdinalsRule",null,[]);d.d(N,"a",function(){return Aa});class Aa{constructor(ma,Ga,Fa,ib,ob,fb,Mb){this.huc=[];this.VNb=[];this.Hjc=[];this.qie=[];this.E7a=-1;this.mIg=this.Kca=this.B$c=!1;this.LGj=ma;this.Vd=Ga;this.Ok=Fa;this.ga=ib;this.NU=fb;this.GC=Mb;ob?(this.B$c=ob.$("WordEditorEmoticonAutoCorrectIsEnabled"),this.Kca=ob.$("ReplaceQuoteWithSmartQuoteIsEnabled"),this.mIg=ob.$("HyperlinkUrlValidationIsEnabled"),u.ULS.sendTraceTag(23418953,
324,50,"{0}",{["WordEditorEmoticonAutoCorrectIsEnabled"]:this.B$c,["ReplaceQuoteWithSmartQuoteIsEnabled"]:this.Kca})):(u.ULS.sendTraceTag(23418954,324,50,"appSettingsManager is null.  Auto correct is disabled for: emoticons and smart quotes."),this.Kca=this.B$c=!1)}Nfb(ma){return 0<=Aa.uSe.indexOf(ma)}guf(ma){return 0<=Aa.vSe.indexOf(ma)}Trf(ma){return ma.toLowerCase()===ma}V7b(ma){return ma.toUpperCase()===ma}wNd(ma){return ma.toLowerCase()!==ma.toUpperCase()}$cm(ma,Ga,Fa,ib){return(new xa(ma,Ga,
Fa,ib)).Atk()}nol(ma){do{if(ma.getAttribute("xml:lang"))return l.a.pg(ma.getAttribute("xml:lang"))||l.a.WMc;if(ma.getAttribute("lang"))return l.a.pg(ma.getAttribute("lang"))||l.a.WMc;ma=ma.parentNode}while(ma&&1===ma.nodeType);return l.a.WMc}Zcf(ma){return l.a.pg(G.FormattingReader.language(G.FormattingReader.Pr(ma)))||l.a.WMc}GCd(ma,Ga){0>Ga&&(Ga=0);let Fa=-1;const ib=Aa.uSe.length;for(let ob=0;ob<ib;++ob){const fb=ma.lastIndexOf(e.a.charAt(Aa.uSe,ob),Ga);fb>Fa&&(Fa=fb)}ma=e.a.V_a(ma,Ga);ma>Fa&&
(Fa=ma);return Fa}m9k(ma){for(let Ga=0;Ga<ma.length;++Ga)if(this.wNd(e.a.charAt(ma,Ga)))return Ga;return-1}C9e(ma,Ga){if(!ma||0>Ga)return-1;let Fa=Ga;Fa=Fa?this.GCd(ma,Fa-1):-1;Fa=Fa>e.a.V_a(ma,Ga-1)?Fa:e.a.V_a(ma,Ga-1);Fa++;return Fa}aIh(ma,Ga,Fa){if(!y.a.instance.J(9))return null;this.kFc(Ga);if(!this.VNb[Ga]){Ga=E.uQh(Ga);if(0>=Ga)return null;this.kFc(Ga);if(!this.VNb[Ga])return null}if(Fa&&this.Hjc[Ga]&&Array.contains(this.Hjc[Ga],ma+Fa))return null;Fa=this.VNb[Ga][e.a.mh(ma)];if("string"!==typeof Fa||
Fa===ma||!Fa)return null;var ib=this.m9k(ma);if(0>ib||this.Trf(e.a.charAt(ma,ib)))return Fa;Ga=!0;for(ib+=1;ib<ma.length;++ib){const ob=e.a.charAt(ma,ib);Ga&&!this.V7b(ob)&&(Ga=!1)}return Ga?null:e.a.Wz(e.a.substring(Fa,0,1))+e.a.right(Fa,1)}z9k(ma,Ga,Fa,ib){a.a.mark(4666);const ob=this.nol(Ga).LCID;let fb=0,Mb=ma;const Tb=Ga.innerText;if(this.Aqf(Tb.substring(Tb.lastIndexOf(" ",ma)+1,ma)))return a.a.mark(4667),null;let rc=null;var vb=!1;do{Mb=Mb?this.GCd(Tb,Mb-1):-1;if(-1===Mb&&!Fa){vb=Ga;var Ya=
null;if(!this.Nfb(Tb.charAt(0))){do{for(;vb&&!vb.previousSibling;)vb=vb.parentNode;vb&&(vb=vb.previousSibling,Ya=vb.innerText)}while(vb&&!Ya);if(vb&&Ya&&!this.Nfb(e.a.charAt(Ya,Ya.length-1)))return a.a.mark(4667),null}vb=!0}Ya=e.a.substring(Tb,Mb+1,ma);++fb;var wb=this.aIh(Ya,ob,ib.toString());if(wb)rc=hc.FS(Ga,Mb+1,ma,wb,this.Vd),Aa.oxf();else for(const jb of this.huc)if(!(jb.flags&1&&!(Fa&&1>Mb)||jb.flags&4||jb.flags&2&&" "!==ib)&&(wb=jb.pattern.exec(Ya))){rc=jb.CZl(Ga,Mb+1,ma,wb,this.Vd,this.ga);
break}}while(!vb&&!rc&&fb<Aa.aqi&&0<=Mb);a.a.mark(4667);return rc}x9k(ma,Ga,Fa){const ib=ma.node;let ob=S.ParagraphReader.text(ib);0>Ga&&(Ga=ma.cpBegin);ma=this.Zcf(ma).LCID;if(this.Aqf(ob.substring(e.a.V_a(ob,Ga)+1,Ga)))return null;var fb=-1,Mb=L.HyperlinkReader.tIc(ib);for(var Tb=0;Tb<Mb.length;Tb++)if(Ga>Mb[Tb].cpEnd)fb=Mb[Tb].cpEnd;else{if(Ga>Mb[Tb].cpBegin)return null;break}Mb=null;Tb=(Tb=Ga)?this.GCd(ob,Tb-1):-1;Tb<fb&&(Tb=fb-1);fb=e.a.substring(ob,Tb+1,Ga);fb=fb.trimStart();if(1>Tb)for(const rc of this.huc){let vb=
ob;" "!==Fa&&(vb=ob+Fa);if(rc.pattern.exec(vb))return null}ob=ob.substring(0,Ga);if(!this.$cm(ob,Fa.toString(),fb,ma))return null;fb.charAt(0).toUpperCase()!==fb.charAt(0)&&(Mb=Hb.jF(ib,Tb+1,Ga,this.Vd,this.Ok,this.GC));return Mb}DHh(ma,Ga,Fa){ma=J.SelectionFactory.wo(ma,!1);if(!ma)return null;ma=ma.Tc;return I.SelectionEditor.xf(ma)?this.x9k(ma,Ga,Fa):null}Aqf(ma){return e.a.aX(ma)}h9e(ma,Ga,Fa,ib){a.a.mark(4666);const ob=ma.node,fb=this.Zcf(ma).LCID,Mb=S.ParagraphReader.text(ob);0>Ga&&(Ga=ma.cpBegin);
if(Fa&&!this.Nfb(e.a.charAt(Mb,Ga))||this.Aqf(Mb.substring(e.a.V_a(Mb,Ga)+1,Ga)))return a.a.mark(4667),null;ma=-1;Fa=L.HyperlinkReader.tIc(ob);for(var Tb=0;Tb<Fa.length;Tb++)if(Ga>Fa[Tb].cpEnd)ma=Fa[Tb].cpEnd;else{if(Ga>Fa[Tb].cpBegin)return null;break}Fa=0;Tb=Ga;let rc=null;do{Tb=Tb?this.GCd(Mb,Tb-1):-1;Tb<ma&&(Tb=ma-1);const Ya=e.a.substring(Mb,Tb+1,Ga);++Fa;var vb=null;let wb=!1;if(O.a.FBh){const jb=Mb+String.fromCharCode(ib);wb=this.huc.some(Zb=>Zb.pattern.exec(jb))}wb||(vb=this.aIh(Ya,fb,null));
if(vb)this.NU.QOa&&(rc=hc.jF(ob,Tb+1,Ga,vb,this.Vd),Aa.oxf());else for(const jb of this.huc)if(!(jb.flags&1&&-1!==Tb||jb.flags&4&&ib!==k.a.es||jb.flags&2&&ib!==k.a.sFa)&&(vb=jb.pattern.exec(Ya))){rc=jb.RQl(ob,Tb+1,Ga,vb,this.Vd,this.ga);if(rc.commandId!==K.a.tSe&&!this.NU.QOa||rc.commandId===K.a.tSe&&!this.NU.mYc)rc=null;break}}while(0<=Tb&&Tb>=ma&&!rc&&Fa<Aa.aqi);a.a.mark(4667);return rc}CHh(ma,Ga,Fa){ma=J.SelectionFactory.wo(ma,!1);if(!ma)return null;ma=ma.Tc;return I.SelectionEditor.xf(ma)?this.h9e(ma,
Ga,!1,Fa):null}JHh(ma,Ga){var Fa=J.SelectionFactory.wo(ma,!1);if(!Fa)return null;let ib=Fa.Tc;Fa.eE&&Fa.Tc.contextId!==B.a.endOfParagraph&&0<=Ga&&(ib=F.a.Uc(ma,Ga));if(!I.SelectionEditor.xf(ib)||L.HyperlinkReader.cma(ib,!1))return null;Fa=S.ParagraphReader.text(ib.node);ma=0<Ga?e.a.V_a(Fa,Ga-1)+1:e.a.V_a(Fa,Fa.length-1)+1;Ga=0<Ga?Ga:Fa.length;Fa=e.a.substring(Fa,ma,Ga);return!Fa||this.mIg&&!L.HyperlinkReader.QMa(Fa)||!e.a.aX(Fa)&&!e.a.GNc(Fa)||!Aa.hyperlinkEditor.nqn(ib,ma,Ga)?null:this.LGj.lKk(ib.node,
ma,Ga)}NHh(ma,Ga){var Fa=J.SelectionFactory.wo(ma,!1);if(!Fa)return null;var ib=Fa.Tc;if(!I.SelectionEditor.xf(ib))return null;0>Ga&&(Ga=ib.cpBegin);var ob=S.ParagraphReader.text(ib.node);Fa=this.C9e(ob,Ga);const fb=Aa.vSe.length;for(let Mb=0;Mb<fb;++Mb){const Tb=ob.lastIndexOf(e.a.charAt(Aa.vSe,Mb),Ga-1);Tb>Fa&&(Fa=Tb+1)}ob=e.a.substring(ob,Fa,Ga);if(!ob)return null;ib=this.Zcf(ib).LCID;return(new Ta(ob,ib)).phm()?ab.jF(ma,Fa,Ga,this.Vd):null}zHh(ma,Ga){var Fa=J.SelectionFactory.wo(ma,!1);if(!Fa)return null;
Fa=Fa.Tc;if(!I.SelectionEditor.xf(Fa))return null;0>Ga&&(Ga=Fa.cpBegin);var ib=S.ParagraphReader.text(Fa.node);Fa=this.C9e(ib,Ga);ib=e.a.substring(ib,Fa,Ga);return ib?(ib=(new Ma(ib)).fel())?Na.jF(ma,Fa,Ga,ib,this.Vd):null:null}x$k(ma,Ga,Fa,ib,ob){var fb=J.SelectionFactory.wo(ma,!1);if(!fb)return null;fb=fb.Tc;if(Fa>Ga||!I.SelectionEditor.xf(fb))return null;0>Ga&&(Ga=fb.cpBegin);if(0>Ga)return null;fb=S.ParagraphReader.text(fb.node);return Rb.jF(ma,Fa,ob,Ga?fb.charAt(Ga-1):"\x00",this.Vd,ib)}$ub(ma,
Ga,Fa,ib){this.huc.push(new Ua(`^${ma}$`,Ga,Fa,ib))}Rzf(ma){if(this.VNb[this.E7a]){const Ga=this.VNb[this.E7a];for(const Fa in ma)Ga[Fa]=ma[Fa]}else this.VNb[this.E7a]=ma}Vzf(ma){this.Hjc[this.E7a]?this.Hjc[this.E7a].push(...(ma||[])):this.Hjc[this.E7a]=ma}qsm(ma,Ga){this.qie[Ga]||(this.qie[Ga]=!0,n.AFrameworkApplication.Xe.Lj(ma,1,null,null,!1,3,Fa=>{this.E7a=Ga;try{Object(t.a)(Fa.data.Ge)}catch(ib){u.ULS.sendTraceTag(5898336,324,50,"Failed to parse autocorrect: {0}",{["ResponseData"]:Fa.data?Fa.data.Ge:
""})}this.E7a=-1},()=>{this.D2k(Ga)},null,void 0,void 0,void 0,void 0,"27"))}D2k(ma){ma=E.uQh(ma);0<ma&&this.kFc(ma)}static get Rgk(){return null!=Aa.Fgg?Aa.Fgg:Aa.Fgg=(()=>Aa.ffh.map(([ma,...Ga])=>(new Ua(`^${ma}`,...Ga)).pattern))()}static get ffh(){return null!=Aa.Ggg?Aa.Ggg:Aa.Ggg=(()=>[...ha.UQf.map(ma=>[ma,ha.FS,ha.jF,3]),["\\(?(\\d+)[\\.\\)\\-]",Sa.FS,Sa.jF,3],["\\(?(L|l|C|c|D|d|M|m){1}[\\.\\)\\-]",pa.FS,pa.jF,3],...Ab.UQf.map(ma=>[ma,Ab.FS,Ab.jF,11]),["\\(?([A-Za-z]){1}[\\.\\)\\-]",pa.FS,
pa.jF,3]])()}zsm(){y.a.instance.J(9)&&(this.kFc(1033),this.$ub("=rand\\((?:(\\d+)(?:, ?(\\d+))?)?\\)",zb.FS,zb.jF,5),this.$ub("=rand\\.old\\((?:(\\d+)(?:, ?(\\d+))?)?\\)",zb.FS,zb.jF,5),this.$ub("=lorem\\((?:(\\d+)(?:, ?(\\d+))?)?\\)",zb.FS,zb.jF,5),Aa.ffh.forEach(ma=>this.$ub(...ma)),this.$ub("[\\w\\d]+( ?\\-{1,2} ?)[\\w\\d]+",Ka.FS,Ka.jF,0),this.B$c&&(this.$ub("(?:.*)([\\:\\;\\=][\\'\\-]??[DOPSX3>\\(\\)\\*#\\|\\[\\/])",Xa.FS,Xa.jF,0),this.$ub("(?:.*)([\\@\\*\\$][\\-][\\@\\*\\$])",Xa.FS,Xa.jF,0)))}kFc(ma){this.qie[ma]||
this.qsm(H.a.Ujk(String.format("Acl/Acl{0}.js",ma)),ma)}static oxf(){v.a.instance.Za("Common.ISystemInitiatedFeedback").execute(ma=>{ma.logActivity("AutocorrectStringMatch",null)})}static get hyperlinkEditor(){return null!=Aa.Ykg?Aa.Ykg:Aa.Ykg=v.a.instance.resolve("Box4.IHyperlinkEditor")}}Aa.uSe=" ,;:()[]{}<>\"'-~`@#$%^&*_+=|\u00a9\u00ae\u2122\ufffc\uc2a0\u2013\u2014";Aa.vSe=" ,;:()[]{}<>\"'-~`@#$%^&*_+=|\u00a9\u00ae\u2122\ufffc\uc2a0\u2013\u2014/\\.!?\"'";Aa.ZWf=".!?";Aa.aqi=5;Object(C.a)(Aa,"AutoCorrectRules",
null,[443])},1602:function(C,N,d){C=d(0);var l=d(35),e=d(8),a=d(311),k=d(684),n=d(44),v=d(2),u=d(29);const t=(X,Y,ca)=>{if(X){var da=0;do{try{X();break}catch(ua){if(e.ULS.sendTraceTag(50946190,306,10,"RetryOnException: [Retries: {0}] [Caller: {1}] [Exception: {2}] [Callstack: {3}].",da,ca,ua.message,ua.stack),da>=Y)break}da++}while(1)}};var y=d(80),B=d(27),G=d(192),F=d(212),K=d(46),O=d(285),H=d(15),I=d(121);class J{constructor(X,Y,ca,da,ua,ra,qa,ka,la=!0,Ha=null,wa=!1){this.eHh="FileUpload.ashx";
this._iframe=null;this._initialized=!1;this.pl=this.tnc=this.tpe=this.VUa=this.had=this.LD=this._form=null;this.uh=!1;this.s0=this.iad=this.s$a=null;this._parent=X;this.BHj=Y;this.MSj=ca;this.zFg=ua;this.qya=qa;this.Otg=ka;this.mxg=Ha;this.OLe=!1;this.uIj=da.$("CanaryRenewalForFileUploadIsEnabled");this.Uno=!1;(this.J8a=wa)||this.CHk(ra);la&&this.l8h()}get bSi(){return this.MSj}get sessionId(){return this.qya}get iFrame(){return this._iframe}get bT(){return this.LD}get IFb(){return v.AFrameworkApplication.K?
v.AFrameworkApplication.K.$("NativeFileOpenDialogIsEnabled"):!1}get YGh(){return v.AFrameworkApplication.K?v.AFrameworkApplication.K.$("FileInputDescriptionAccessibilityIsEnabled"):!1}get Xfm(){return this.J8a?!1:F.b(this._iframe.contentWindow.location.pathname,this.eHh,0)}get pak(){return!H.a.S$&&v.AFrameworkApplication.K.$("AllowMultipleImageInsertFromLocalDevice")}l8h(){this.s0=I.a.create().toString();this.J8a?this.f7e():this.Zbk()}CHk(X){this._iframe=document.createElement("iframe");this._iframe.className=
X;this._iframe.id=X;this.zFg&&(this._iframe.style.visibility="visible",this._iframe.style.height="30px",this._iframe.setAttribute("frameborder","0"));this.VUa=Object(n.a)(this,this.YIf,"onUploadFrameLoad");u.a.addHandler(this._iframe,"load",this.VUa)}Nzd(X=null){v.AFrameworkApplication.ua.n0d();if(!this.LD)return e.ULS.sendTraceTag(25798093,322,50,"_fileInput is null"),"";u.a.addHandler(this.LD,"change",()=>{this.U7k(X)});t(Object(n.a)(this,this.XGh,"fileInputClick"),1,"DoFileOpenDialog");return this.LD.value}U7k(X){X&&
X(this.LD.value)}V7k(){this.had&&(this.had.innerText=this.JSh())}omn(X){u.a.addHandler(this.LD,"change",()=>{X(this.JSh())})}JSh(){let X=null;if(this.LD.value){const Y=this.LD.value,ca=Y.lastIndexOf("\\");0<ca&&(X=Y.substring(ca+1,Y.length))}return X?X:""}XGh(){try{e.ULS.sendTraceTag(35939520,322,50,"UploadFrame.FileInputClick - Clicking on File input element."),this.LD.click()}catch(X){throw e.ULS.sendTraceTag(36783331,322,10,"UploadFrame.FileInputClick Exception: {0}",X.message),X;}}v1c(){this.okm()?
this.f9i():(this.h9f(),this._form.submit())}okm(){return(this.uIj||this.J8a)&&!(void 0===window.self.FormData||null===window.self.FormData)}YWi(X){if(X){const Y=this.Ish();this.pl=new XMLHttpRequest;this.pl.open("POST",Y);this.pl.setRequestHeader("X-CorrelationId",this.s0);this.lxm(X);this.pl.onreadystatechange=Object(n.a)(this,this.kwa,"uploadResponseReceived");this.pl.send(X)}}lxm(X){if(!H.a.S$&&X.get){var Y=X.get("ImageId");X=window.self.navigator;Y={["CorrelationId"]:this.s0,["Canary"]:v.AFrameworkApplication.canary,
["ImageNodeId"]:Y};X&&(X=X.connection?X.connection:X.mozConnection?X.mozConnection:X.webkitConnection?X.webkitConnection:null)&&(Y.effectiveType=X.effectiveType,Y.downlink=X.downlink,Y.type=X.type,Y.rtt=X.rtt);e.ULS.sendTraceTag(573345858,322,50,"LogFileUploadStatistics: FileUpload {0}",Y)}}f9i(){try{this.h9f();e.ULS.sendTraceTag(594888409,322,50,"SubmitFormWithRequest is preparing to send an upload request");const X=new (Type.parse("FormData"))(this._form);this.YWi(X)}catch(X){e.ULS.sendTraceTag(594888407,
322,10,"SubmitFormWithRequest failed to send the request with exception "+X.message),this.eac(null)}}e9i(X){try{if(this.h9f(),e.ULS.sendTraceTag(594888406,322,50,"SubmitFormWithBlob is preparing to send an upload request"),this.tpo(X)){this.iad=X;this._form.contains(this.LD)&&this._form.removeChild(this.LD);var Y=new (Type.parse("FormData"))(this._form);Y.append("applicationfileInput",X.blob,X.filename);this.YWi(Y)}else this.eac(null)}catch(ca){e.ULS.sendTraceTag(591267743,322,10,"SubmitFormWithBlob failed to send the request with exception "+
ca.message),this.eac(null)}}tpo(X){return X&&void 0!==X.blob&&null!==X.blob&&void 0!==X.filename&&null!==X.filename&&""!==X.filename?void 0===window.self.FormData||null===window.self.FormData?(e.ULS.sendTraceTag(578380442,322,10,"FormData isn't supported"),!1):!0:(X=X?String.format("[isNull: false] [blobIsNullorEmpty: {0}] [filenameIsNullOrEmpty: {1}]",void 0===X.blob||null===X.blob,void 0===X.filename||null===X.filename||""===X.filename):"[isNull: true] [blobIsNullorEmpty: false] [filenameIsNullOrEmpty: false]",
e.ULS.sendTraceTag(578380441,322,10,String.format("Content of the blob is empty {0}",X)),!1)}kwa(){if(4===this.pl.readyState)if(200===this.pl.status){e.ULS.sendTraceTag(594888405,322,50,"UploadResponseReceived received a successful response. CorrelationId: {0}",this.s0);const X=this.pl.getResponseHeader("X-NewKey"),Y=this.t$l(this.pl);let ca=!1;if(void 0!==X&&null!==X&&Y&&(ca=this.gpo(X),!this.OLe&&ca)){e.ULS.sendTraceTag(594888404,322,50,"UploadResponseReceived resubmitting the upload request with a fresh canary. correlationId: {0}",
this.s0);this.OLe=!0;this.Dxd();void 0!==this.iad&&null!==this.iad?this.e9i(this.iad):this.f9i();return}e.ULS.sendTraceTag(594888403,322,50,"UploadResponseReceived processing the response [retried: {0}] [canaryInvalid: {1}] [gotNewCanary: {2}] [canaryRenewed: {3}] [CorrelationId: {4}]",this.OLe,Y,!(void 0===X||null===X),ca,this.s0);this.eac(this.pl.responseText)}else e.ULS.sendTraceTag(42874946,322,15,"Upload request failed with status: {0} [isResponseNull: {1}] [correlationId: {2}]",this.pl.status,
this.pl.responseText?!1:!0,this.s0),this.eac(null)}t$l(X){try{const Y=l.a(X.responseText).Responses;if(void 0!==Y&&null!==Y&&1===Y.length){const ca=Y[0];if(void 0!==ca&&null!==ca&&2===ca.length&&28===ca[1].StatusCode)return!0}}catch(Y){}return!1}gpo(X){O.a.Z7f(X);return v.AFrameworkApplication.canary!==X?!1:!0}h9f(){this.s$a||(this.s$a=new Date)}dispose(){this.uh||(this.J8a?this._parent.removeChild(this._form):(this._parent.removeChild(this._iframe),u.a.removeHandler(this._iframe,"load",this.VUa),
this.VUa=null),this.tpe&&(u.a.removeHandler(this.LD,"change",this.tpe),this.tpe=null),this.YGh&&(this.tnc&&(u.a.removeHandler(this.LD,"change",this.tnc),this.tnc=null),this.had=null),this.LD=this._form=this._parent=this._iframe=null,this.uh=!0,this.s$a=null,e.ULS.sendTraceTag(25798094,322,50,"UploadFrame disposed"))}delayedDispose(){this.dispose()}f_b(X,Y){if(this._form){var ca;(ca=this._form.querySelector("input[name="+X+"]"))?ca.value=Y:(ca=this.f0e(),ca.type="hidden",ca.id=X,ca.name=X,ca.value=
Y,this._form.appendChild(ca))}}f0e(){return this.J8a?document.createElement("input"):this._iframe.contentWindow.document.createElement("input")}YIf(){try{if(!this._iframe.contentWindow.document.body)return}catch(Y){this.HKc();return}if(!(this._initialized||this.IFb&&H.a.gH))this.f7e();else if(!this.IFb||!H.a.gH||this.Xfm){let Y;Y=H.a.Ak?this._iframe.contentWindow.document.body.innerText:this.Uno?this._iframe.contentWindow.document.body.firstChild.innerText:this._iframe.contentWindow.document.body.firstChild.innerHTML;
var X=this._iframe.contentWindow.document.body.innerText.toLowerCase();const ca=0<=X.indexOf("responses")||0<=X.indexOf("wopisrc");X=0<=X.indexOf("http error");!ca&&X&&e.ULS.sendTraceTag(42551183,322,15,"Couldn't obtain a valid response but the frame contains: "+this._iframe.contentWindow.document.body.innerText);this.eac(Y)}}f7e(){if(!this._initialized){var X=this.nE("uploadForm");const Y=this.nE("fileInput"),ca=this.Ish();this.MJk();this._form.id=X;this._form.method="post";this._form.encoding="multipart/form-data";
this._form.action=ca;this.LD.type="file";this.Otg&&(this.LD.accept=this.Otg,this.mxg&&(this.LD.capture=this.mxg));this.LD.id=Y;this.LD.name=Y;this.pak&&(this.LD.multiple=!0);!this.YGh||H.a.Ak||H.a.Ys||(this.tnc=Object(n.a)(this,this.V7k,"fileInputChangedHandleAccessibility"),u.a.addHandler(this.LD,"change",this.tnc),this.had=B.a.Rrd(this._form,this.LD,"InputFileDescription",""));this.zFg&&(this.J8a||(X=this._iframe.contentWindow.document.body,X.style.margin="0",X.style.overflow="hidden"),X=v.AFrameworkApplication.ua,
this.LD.style.fontFamily=X.fwa,this.LD.style.fontSize=X.q7f,this.LD.style.margin="0");(X=document.getElementById("__REQUESTDIGEST"))&&this.f_b("__REQUESTDIGEST",X.value);this.Dxd();this._form.appendChild(this.LD);this._initialized=!0;this.BHj(this)}}MJk(){if(this.J8a)this._form=document.createElement("form"),this._parent.appendChild(this._form),this.LD=document.createElement("input");else{this._form=this._iframe.contentWindow.document.createElement("form");const X=this._iframe.contentWindow.document;
X.body.appendChild(this._form);this.LD=X.createElement("input")}}Zbk(){this._parent.appendChild(this._iframe);this.IFb&&H.a.gH&&this.f7e()}Ish(){var X=new G.QueryStringBuilder(this.eHh);v.AFrameworkApplication.vja(X);this.uHn(X);X=X.toString();if(H.a.gj||H.a.gH||H.a.Ys)X=K.a.dEd(X);return X}Cqd(){const X=new y.a(2,1,0,Object(n.a)(this,this.delayedDispose,"delayedDispose"),4);v.AFrameworkApplication.uc.$b(X)}}Object(C.a)(J,"UploadFrame",null,[9]);var L=d(16),S=d(263),E=d(9),P=d(1709);class T extends J{constructor(X,
Y,ca,da,ua,ra,qa=null,ka=!1){super(X,Y,ca,da,ua,"WACUploadFrame",v.AFrameworkApplication.userSessionId,ra,!1,qa,ka)}nE(X){return E.App.xa.qj(X)}uHn(X){S.a.instance.fvb(X)}Dxd(){v.AFrameworkApplication.canary&&this.f_b(a.a.canary,v.AFrameworkApplication.canary);E.App.xa.jb.activeSection.jI&&this.f_b(a.a.jI,E.App.xa.jb.activeSection.jI)}Fhf(X){let Y=null,ca;({group:ca}=k.a.M7(X)).returnValue?Y=ca.Responses[0]:e.ULS.sendTraceTag(41697634,322,10,"Box4UploadFrame.GetServerResponse: unable to deserialize the response");
return Y}HKc(){e.ULS.sendTraceTag(41697635,322,15,"Box4ImageUploadFrame.HandleUploadError: The response is invalid, falling back on a default unspecified failure response");const X=new P.a;X.StatusCode=14;this.bSi(X);this.Cqd()}eac(X){X?(X=L.a.O8i(X),X=X.replace(RegExp("&amp;","g"),"&"),(X=this.Fhf(X))?(this.bSi(X),this.Cqd()):this.HKc()):this.HKc()}}Object(C.a)(T,"Box4UploadFrame",J,[]);d.d(N,"a",function(){return U});class U extends T{constructor(X,Y,ca,da,ua,ra=null,qa=!1){super(X,Y,ca,da,ua,U.qgl(),
ra,qa);this.l8h()}static qgl(){return U.f5g.join(",")+","+U.YLe.join(",")}Dxd(){super.Dxd();this.f_b(a.a.Emb,"1");this.f_b(a.a.rMb,"1")}HKc(){super.HKc();e.ULS.sendTraceTag(41697632,322,15,"Box4ImageUploadFrame.HandleUploadError: Falling back on a default Unspecified Failure response")}Fhf(X){const Y=super.Fhf(X);if(!Y)try{const ca=l.a(X);k.a.iaf(ca)}catch(ca){e.ULS.sendTraceTag(41697633,322,10,"Box4ImageUploadFrame.GetServerResponse: {0}",ca.toString())}return Y}}U.f5g=".jpg .jpeg .png .gif .bmp .tif .tiff .jfif".split(" ");
U.YLe=[".webp"];Object(C.a)(U,"Box4ImageUploadFrame",T,[])},1603:function(C,N,d){C=d(0);var l=d(121),e=d(59),a=d(374),k=d(58),n=d(3),v=d(1170),u=d(21),t=d(6),y=d(318),B=d(49),G=d(1288),F=d(808),K=d(45),O=d(17),H=d(5),I=d(110),J=d(106),L=d(47),S=d(8),E=d(1801),P=d(629),T=d(1651),U=d(130),X=d(1526);class Y{constructor(qa,ka,la,Ha,wa,Ca){this.H0b=this.hcb=null;this.saf=ka;if(qa[P.a.pKc])this.Mea=qa[P.a.pKc],this.Eyc=qa[P.a.Eyc],this.H0b=Array(4),this.H0b[0]=qa[P.a.ecb],this.H0b[1]=qa[P.a.fcb],this.H0b[2]=
qa[P.a.gcb],this.H0b[3]=qa[P.a.dcb],this.Aro=qa[P.a.width],this.NXl=qa[P.a.height],this.T7b=void 0!==qa[P.a.T7b]?"true"===qa[P.a.T7b].toLowerCase():void 0,this.Eq=la,this.w0b=Ha;else{ka=qa[P.a.ecb];const Ja=qa[P.a.fcb],bb=qa[P.a.gcb],ha=qa[P.a.dcb];Ca&&Ca.$("EffectExtentPointsForGraphicsEditorIsEnabled")&&void 0!==ka&&void 0!==Ja&&void 0!==bb&&void 0!==ha?(this.ecb=ka,this.fcb=Ja,this.gcb=bb,this.dcb=ha):(this.ecb=qa[P.a.left],this.fcb=qa[P.a.right],this.gcb=qa[P.a.top],this.dcb=qa[P.a.bottom]);this.width=
qa[P.a.width];this.height=qa[P.a.height];this.rotationAngle=qa[P.a.angle];this.f5m=qa[P.a.e5m];this.Eq=la;this.w0b=Ha;this.Rab=wa;this.GBa=2;this.flipH=this.BW(qa,P.a.flipH);this.flipV=this.BW(qa,P.a.flipV);this.cMm();this.pio()}}pio(){this.hcb||(this.hcb=Array(4),this.hcb[0]=U.a.qF(this.ecb),this.hcb[1]=U.a.qF(this.fcb),this.hcb[2]=U.a.qF(this.gcb),this.hcb[3]=U.a.qF(this.dcb))}cMm(){var qa=X.c(this.rotationAngle);if(45<=qa&&135>=qa||225<=qa&&315>=qa){qa=this.width/2;const ka=this.height/2;this.ecb-=
qa-ka;this.fcb+=qa-ka;this.gcb-=ka-qa;this.dcb+=ka-qa}}BW(qa,ka){if(qa.hasOwnProperty(ka))return qa[ka]}}Object(C.a)(Y,"JsonToDocumentXmlResponseCommonParams",null,[]);class ca extends Y{constructor(qa,ka,la,Ha,wa,Ca){super(qa,ka,la,Ha,wa,Ca);this.yak="string"===typeof qa[P.a.Grd]?qa[P.a.Grd]:null;this.o1b="string"===typeof qa[P.a.o1b]?qa[P.a.o1b]:null}}Object(C.a)(ca,"JsonToDocumentXmlResponseDrawingParams",Y,[]);var da=d(492);class ua extends Y{constructor(qa,ka,la,Ha,wa,Ca){var Ja,bb,ha,ia,va;
super(qa,ka,la,Ha,wa,Ca);this.ino=qa[P.a.Q4m];this.NDk=qa[P.a.I4m];this.GBa=1;this.NDk||(this.GBa=0,this.hcb=da.a.instance.ila(U.a.qF(this.width),U.a.qF(this.height),this.rotationAngle));this.uJf=this.BW(qa,P.a.oac);this.rZd=this.BW(qa,P.a.rZd);this.vJf=this.BW(qa,P.a.vJf);this.qlj=this.BW(qa,P.a.plj);this.aee=this.BW(qa,P.a.aee);this.Q$f=this.BW(qa,P.a.Q$f);this.BXc=null!==(Ja=this.BW(qa,P.a.BXc))&&void 0!==Ja?Ja:"";this.extension=qa[P.a.extension];this.Tza=null!==(bb=this.BW(qa,P.a.left))&&void 0!==
bb?bb:0;this.Vza=null!==(ha=this.BW(qa,P.a.top))&&void 0!==ha?ha:0;this.Uza=null!==(ia=this.BW(qa,P.a.right))&&void 0!==ia?ia:0;this.Sza=null!==(va=this.BW(qa,P.a.bottom))&&void 0!==va?va:0;this.lockAspectRatio=this.BW(qa,P.a.lockAspectRatio);this.Dgh=this.BW(qa,P.a.hga);this.borderStyle=this.BW(qa,P.a.mna);this.borderColor=this.BW(qa,P.a.xDa);this.rjk=void 0!==this.Dgh||void 0!==this.borderStyle||void 0!==this.borderColor;this.altTextDescription=this.BW(qa,P.a.altTextDescription);this.alphaModFix=
this.BW(qa,P.a.alphaModFix)}}Object(C.a)(ua,"JsonToDocumentXmlResponsePictureParams",Y,[]);d.d(N,"a",function(){return ra});class ra{constructor(qa,ka,la,Ha,wa,Ca,Ja,bb,ha,ia,va,Ka,Xa,xa,Ma,Na,pa){this.U6a=this.Htb=null;this.qbd=qa;this.vqe=ka;this.lJ=la;this.wm=Ha;this.em=wa;this.Hc=Ca;this.PCj=bb;this.BCg=Ja;this.ij=ha;this.rm=ia;this.DQj=va;this.CQj=Ka;this.Oa=Xa;this.OU=xa;this.Ac=Ma;this.bJj=Na;this.iHj=pa}Wma(qa,ka,la,Ha,wa,Ca,Ja){Ca.stop();Ja?S.ULS.sendTraceTag(575522565,3001,10,qa):S.ULS.sendTraceTag(575522566,
3001,10,qa);this.BCg?(Ha=this.Hc.Rc(7,n.a.qKc),Ha.Db(la),ka.Gb.setValue(K.a.CZ,0),ka.Gb.setValue(O.a.rfa,ka.Kok),ka.Gb.setValue(O.a.yma,ka.Iok),Ha.dispose()):Ha();this.U6a&&this.U6a(qa);wa()}b1a(qa,ka,la,Ha,wa,Ca,Ja){S.ULS.sendTraceTag(575522567,3001,50,"GraphicsEditorJsonToDocumentXmlRequestHelper: {0}",{["Method"]:"OnRequestSuccess",["DurationInMilliseconds"]:Ja.oi});var bb=qa.data.Ge,ha=null;try{ha=JSON.parse(bb)}catch(va){this.Wma("Failed to parse incoming JSON blob.",ka,wa,Ha,la,Ja,!1);return}if(E.a.error in
ha)this.Wma("Error code returned from WordGraphicsEditorHandler endpoint: "+ha[E.a.error],ka,wa,Ha,la,Ja,!1);else{bb=10;var ia=1;try{bb=parseInt(ha[P.a.Eq]),ia=parseInt(ha[P.a.w0b])}catch(va){this.Wma("Invalid data found in the JSON blob. (i.e. placeholderkind/drawingid)",ka,wa,Ha,la,Ja,!1);return}la=qa.data.request?v.a.OFc(qa.data.request.get_body()):null;qa=null;qa=ka.Gb;Ha=ka.getId();ka=qa.getValue(H.a.Eq);ka=ka!==bb&&(5===ka||5===bb||this.MVl(qa,ha));5===bb?(ha=new ua(ha,this.vqe,bb,ia,la,this.Oa),
qa=this.uml(wa,Ca,ha,ka,qa,Ha)):(ha=new ca(ha,this.vqe,bb,ia,la,this.Oa),qa=this.tml(wa,Ca,ha,ka,qa,Ha));ha=this.Hc.Rc(7,n.a.qKc);bb=wa;u.ImageReader.s6(wa)&&ka&&(bb=t.GraphIterator.$a(wa),bb.Bb(12),bb=bb.parentNode);ha.Db(bb);qa();this.lJ.kEa(Ca);ha.dispose();if(this.em&&this.em!==l.a.nil){const va=bb.Di();null===va||void 0===va?void 0:va.contentReplicator.forceOutbound(()=>{S.ULS.sendTraceTag(574358089,3001,50,"Graphical Content Properties Persisted to Box4: {0}",{["Method"]:"OnRequestSuccess",
["DurationInMilliseconds"]:Ja.oi});Ja.stop();const Ka=new e.a(this.em,1);this.wm.zZb(va,Ka);const Xa=this.qbd.properties;null!=Xa&&Object(y.a)(()=>{let xa=new B.GraphTransaction(3,n.a.imageRotate);xa.Db(wa);Xa.setValue(I.a.l3,1);xa.dispose()})},null,null)}this.Htb&&this.Htb(wa)}}Tbh(qa,ka){qa.Ie(E.a.CLf,"false");qa.Ie(E.a.saf,this.vqe);qa.Ie(E.a.JZe,"0");qa.gL(P.a.Rab,window.self.devicePixelRatio.toString());void 0!==ka&&null!==ka&&(ka=this.rm.Xl(ka.vk),ka=this.rm.ul(ka),qa.Ie(P.a.Eq,G.a[ka]));this.bJj&&
(qa.Ie(P.a.TLd,"true"),qa.Ie(P.a.k0l,this.iHj.toString()))}L6g(qa){if(this.BCg){qa=qa.vk;var ka=this.rm.Xl(qa);if(!ka)return null;const la=new T.a(this.PCj,ka),Ha=this.Hc.Rc(15,n.a.qKc);Ha.Db(qa.node);this.BEi(ka);ka.setValue(H.a.Eq,ka.ia(H.a.Eq,10));Ha.Al=n.a.qKc;Ha.NCa(this.em,1);Ha.dispose();return la}ka=new a.DictionaryPropertySet;this.BEi(ka);return(qa=this.ij.JAh(qa,ka,this.em))&&qa.blob?new T.a(qa.blob.id,qa.blob.properties):null}NHd(){return Box4Intl.Box4Strings.l_GraphicsEditorError}BEi(qa){qa.setValue(O.a.rfa,
k.a.pn(this.DQj,0));qa.setValue(O.a.yma,k.a.pn(this.CQj,1));qa.setValue(K.a.CZ,1);qa.setValue(J.a.P$,!0)}tml(qa,ka,la,Ha,wa,Ca){const Ja=bb=>{this.qbd.Qio(la,bb,qa)};return this.dti(Ha,wa,qa)?this.qOh(ka,wa,Ca,Ja):()=>{Ja(wa)}}uml(qa,ka,la,Ha,wa,Ca){const Ja=bb=>{this.qbd.Rio(la,bb,qa)};return this.dti(Ha,wa,qa,la)?this.qOh(ka,wa,Ca,Ja):()=>Ja(wa)}dti(qa,ka,la,Ha){return qa?!0:Ha?u.ImageReader.YGd(ka,la.Lc,!1)!==Ha.uJf:!1}qOh(qa,ka,la,Ha){const wa=F.a.instance.H5c;wa.Cs(ka);wa.id=la;return()=>{this.qbd.wun(qa,
la,wa,this.OU,Ha)}}cPn(qa){this.Htb=qa}FJn(qa){this.U6a=qa}MVl(qa,ka){return this.Ac.isFeatureEnabled(46)&&(qa.hasProperty(L.a.Mea)&&!ka[P.a.pKc]||!qa.hasProperty(L.a.Mea)&&ka[P.a.pKc])?!0:!1}}Object(C.a)(ra,"GraphicsEditorJsonToDocumentXmlRequestHelper",null,[498])},1604:function(C,N,d){C=d(0);var l=d(76),e=d(44),a=d(269),k=d(278);class n{constructor(G,F,K,O=0,H=0,I=null){this.commandId=G;this.controlId=F;this.timeStamp=K;this.commandSurface=a.a[O];this.Ww=k.a[H];this.contentType=I}}Object(C.a)(n,
"CommandActionInfo",null,[]);class v{constructor(){this.Juj=RegExp("(Close|TabSwitch|((Populate|Query|Report|Show|BrowserFocus).+)|(.+(Rendered|Seen|Scroll)))")}nnm(G){return!this.Juj.exec(G)}}Object(C.a)(v,"EventsCacheLoggingUtils",null,[]);var u=d(2),t=d(1765),y=d(504);d.d(N,"a",function(){return B});class B{constructor(){this.NPg=null;this.Jye=20;this.xnc=this.g8c=this.I8c=null}init(){this.NPg=new v;this.I8c=new l.a;this.g8c=new l.a;this.xnc=new l.a;this.Jye=u.AFrameworkApplication.K.rc("MaxCommandClickedEventQueueSize",
20);t.a.r7j(Object(e.a)(this,this.Zzk,"commandClickEventRaised"));y.a.instance.jPe(Object(e.a)(this,this.Kgn,"recordActionEvent"))}C6f(G){G.count>this.Jye&&G.removeAt(this.Jye)}Zzk(G,F){this.I8c.insert(0,new n(F.commandId,F.controlId,F.time,F.commandSurface,F.Ww,F.contentType));this.C6f(this.I8c)}Kgn(G,F){this.g8c.insert(0,new n(F.actionName,"",F.timeStamp,F.commandSurface,F.Ww,F.contentType));this.C6f(this.g8c);this.NPg.nnm(F.actionName)&&(this.xnc.insert(0,new n(F.actionName,"",F.timeStamp,F.commandSurface,
F.Ww,F.contentType)),this.C6f(this.xnc))}t2b(){return this.I8c}gdb(){return this.g8c}static get instance(){return B._instance||(B._instance=new B)}}B._instance=null;Object(C.a)(B,"CommandClickEventsCache",null,[])},1606:function(C,N,d){C=d(0);class l{}Object(C.a)(l,"AuthContext",null,[]);var e=d(2),a=d(1494);d.d(N,"a",function(){return k});class k{static getAuthContext(){const n=e.AFrameworkApplication.K.lb("UserPrincipalName")||"";let v=n;e.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OAuthLoginHintEnabled",
!1)&&(v=a.a.HNm||n);return Object.assign(new l,{upn:n,loginHint:v,authority:a.a.authority,authorityType:k.oEd(),tenantId:e.AFrameworkApplication.K.lb("TenantId")||""})}static oEd(){let n=0;const v=k.vMh();"aad"===v.toLowerCase()?n=2:"msa"===v.toLowerCase()&&(n=1);return n}static vMh(){return e.AFrameworkApplication.K.lb("HostAuthType")||""}}Object(C.a)(k,"OAuthIdentity",null,[])},1607:function(C,N,d){d.r(N);C=d(0);var l=d(1757),e=d(44),a=d(1759),k=d(480),n=d(1760),v=d(159),u=d(2),t=d(90),y=d(96),
B=d(471),G=d(204),F=d(7),K=d(56),O=d(68),H=d(84),I=d(80),J=d(27),L=d(50),S=d(37),E=d(15),P=d(13);class T{constructor(Y){this.TUd=4;this.EWg=0;this.ZAg=this.exg=this.eYg=this.dCg=this.zZg=this.vya=this.zVb=this.hw=this.D1g=this.gFg=this.hFg=this.oya=this.XTa=this.Rne=this.XRa=this.PRa=this.W=this.mY=this.Rwa=null;E.a.Kta&&(this.TUd=6);this.Ru=Y;this.wY=H.KeyInputManager.lc(O.a.X_,0);this.render()}get containerElement(){return this.W}dispose(){var Y=u.AFrameworkApplication.ua.ez;const ca=u.AFrameworkApplication.ua.my;
Y.sc(F.a.click,this.W,Object(e.a)(this,this.zwi,"onContainerClick"));Y.sc(F.a.VC,this.W,Object(e.a)(this,this.Awi,"onContainerDoubleClick"));ca.sc(F.a.oh,this.W,Object(e.a)(this,this.Bwi,"onContainerKeyPress"));this.PRa&&(Y.sc(F.a.click,this.PRa,Object(e.a)(this,this.iGf,"onDeleteButtonClick")),ca.emb(this.PRa,this.ZAg));this.XRa&&(Y.sc(F.a.click,this.XRa,Object(e.a)(this,this.pGf,"onDoneButtonClick")),ca.emb(this.XRa,this.dCg));this.oya&&(Y.sc(F.a.click,this.oya,Object(e.a)(this,this.nYd,"onSaveButtonClick")),
ca.emb(this.oya,this.zZg));this.Rwa&&(Y.sc(F.a.click,this.Rwa,Object(e.a)(this,this.IFf,"onCancelButtonClick")),ca.emb(this.Rwa,this.exg));this.XTa&&(Y.sc(F.a.click,this.XTa,Object(e.a)(this,this.eIf,"onReplyButtonClick")),ca.emb(this.XTa,this.eYg));this.hw&&(ca.sc(F.a.Ft,this.hw,Object(e.a)(this,this.$Ca,"onKeyEvent")),ca.sc(F.a.oh,this.hw,Object(e.a)(this,this.$Ca,"onKeyEvent")),E.a.ki&&(Y=u.AFrameworkApplication.ua.lgc,Y.sc(F.a.GBc,this.hw,Object(e.a)(this,this.VCa,"onCompositionEvent")),Y.sc(F.a.BZb,
this.hw,Object(e.a)(this,this.VCa,"onCompositionEvent")),Y.sc(F.a.CZb,this.hw,Object(e.a)(this,this.VCa,"onCompositionEvent"))),B.a.instance.sc(F.a.paste,this.hw,Object(e.a)(this,this.OTc,"onPaste")));this.vya=this.zVb=this.hw=this.Rwa=this.oya=this.Rne=this.XRa=this.XTa=this.PRa=this.W=null}focus(){K.FocusManager.instance().fC(v.AFrame.gr);this.W.focus();this.Ru.tq.lcf().Vj.oy(this.W)}qJh(){K.FocusManager.instance().fC(a.a.vBc);this.hw.focus();this.Ru.tq.lcf().Vj.oy(this.hw);2===this.Ru.Sq&&this.hw.value&&
0<this.hw.value.length&&S.a.xZc(this.hw);const Y=this.Ru.tq.Faa.DUc,ca=S.a.LYa(Y,this.W);ca.y+this.W.clientHeight>Y.scrollTop+Y.clientHeight&&(Y.scrollTop=ca.y+this.W.clientHeight-Y.clientHeight)}S$k(){Sys.UI.DomElement.removeCssClass(this.W,"NewOrEditComment");this.Rwa.style.display="none";this.hw.style.display="none";K.FocusManager.J6f(this.hw);K.FocusManager.J6f(this.oya);K.FocusManager.instance().re(a.a.vBc).Dr(this.wY);K.FocusManager.instance().tIb(a.a.vBc);H.KeyInputManager.instance.sc(F.a.Ft,
this.hw,Object(e.a)(this,this.$Ca,"onKeyEvent"));H.KeyInputManager.instance.sc(F.a.oh,this.hw,Object(e.a)(this,this.$Ca,"onKeyEvent"));if(E.a.ki){const Y=u.AFrameworkApplication.ua.lgc;Y.sc(F.a.GBc,this.hw,Object(e.a)(this,this.VCa,"onCompositionEvent"));Y.sc(F.a.BZb,this.hw,Object(e.a)(this,this.VCa,"onCompositionEvent"));Y.sc(F.a.CZb,this.hw,Object(e.a)(this,this.VCa,"onCompositionEvent"))}B.a.instance.sc(F.a.paste,this.hw,Object(e.a)(this,this.OTc,"onPaste"));this.mY.removeChild(this.hw);this.mY.removeChild(this.zVb);
this.vya=this.zVb=this.hw=null;this.S8f();this.P3c();this.focus()}P3c(){this.PPi(this.D1g,this.hFg,this.gFg,this.Rne,this.W)}render(){var Y=k.a("a",this.Dfa("cc"),"CommentContainer");J.a.Iq(Y,J.a.u1,a.a.kBk);Y.tabIndex=0;this.Ru.Rf&&(Y.className+=" Reply1");var ca=k.a("div",this.Dfa("ch"),"CommentHeaderRow");const da=k.a("span",this.Dfa("ca"),"CommentAuthor UIFontBold");da.innerText=this.Ru.author;ca.appendChild(da);const ua=k.a("span",this.Dfa("ct"),"CommentDate");ua.innerText=T.yQk(this.Ru.date,
this.Ru.tq.xQk,this.Ru.tq.E8n);Sys.UI.DomElement.addCssClass(ua,u.AFrameworkApplication.isRtl?"FloatLeft":"FloatRight");ca.appendChild(ua);const ra=k.a("span",this.Dfa("ci"),"CommentStatusIcon");ca.appendChild(ra);let qa=null;this.Ru.LCb&&(qa=n.a.CWa(this.Dfa("cl"),a.a.qAk,CommonUIStrings.l_CommentCancelButton,"ClosePaneGlyph_16x16x32",!1),Sys.UI.DomElement.addCssClass(qa,u.AFrameworkApplication.isRtl?"FloatLeft":"FloatRight"),qa.tabIndex=0,ca.appendChild(qa));this.mY=k.a("div",this.Dfa("cn"),"CommentContent");
let ka=null,la=null,Ha=null;this.Ru.LCb?(ka=k.a("textarea",this.Dfa("ce"),a.a.qph+" UIFont"),ka.rows=this.TUd,ka.cols=50,ka.tabIndex=0,J.a.Iq(ka,"title",CommonUIStrings.l_CommentContent),this.mY.appendChild(ka),la=k.a("div","","CommentTextMeasurementContainer"),Ha=k.a("textarea","",a.a.qph+" UIFont"),Ha.rows=1,Ha.cols=50,Ha.style.visibility="hidden",Ha.spellcheck=!1,la.appendChild(Ha),this.mY.appendChild(la),2===this.Ru.Sq&&(ka.value=this.Ru.text.join("\n")+"\n")):this.S8f();const wa=k.a("div","",
"CommentFooterRow"),Ca=k.a("span",this.Dfa("cf"),""),Ja=n.a.CWa(this.Dfa("cr"),a.a.eBk+" CommentFooterButton",CommonUIStrings.l_CommentReplyButton,"CommentReply_16x16x32",!1);Ja.tabIndex=0;Ja.setAttribute(J.a.Ch,J.a.t1);Ca.appendChild(Ja);const bb=n.a.CWa(this.Dfa("cd"),"CommentDoneButton CommentFooterButton",CommonUIStrings.l_CommentDoneButton,"CheckboxUnchecked_16x16x32",!1);bb.tabIndex=0;const ha=bb.childNodes[0].childNodes[0];Ca.appendChild(bb);const ia=n.a.CWa(this.Dfa("cx"),a.a.rAk+" CommentFooterButton",
CommonUIStrings.l_CommentDeleteButton,"Delete_16x16x32",!1);bb.tabIndex=0;Ca.appendChild(ia);wa.appendChild(Ca);const va=k.a("span",this.Dfa("cfa"),""),Ka=n.a.CWa(this.Dfa("cs"),a.a.fBk,CommonUIStrings.l_CommentSaveCommentButton,null);n.a.yJb(Ka,!1);Ka.tabIndex=0;va.appendChild(Ka);wa.appendChild(va);this.PPi(ra,Ca,va,ha,Y);this.Ru.tq.lsh||(da.setAttribute("Unselectable","on"),ua.setAttribute("Unselectable","on"));Y.appendChild(ca);Y.appendChild(this.mY);Y.appendChild(wa);this.W=Y;this.XRa=bb;this.Rne=
ha;this.PRa=ia;this.XTa=Ja;this.oya=Ka;this.hw=ka;this.zVb=la;this.vya=Ha;this.Rwa=qa;this.hFg=Ca;this.gFg=va;this.D1g=ra;Y=u.AFrameworkApplication.ua.ez;ca=u.AFrameworkApplication.ua.my;Y.mb(F.a.click,this.W,Object(e.a)(this,this.zwi,"onContainerClick"));Y.mb(F.a.VC,this.W,Object(e.a)(this,this.Awi,"onContainerDoubleClick"));ca.mb(F.a.oh,this.W,Object(e.a)(this,this.Bwi,"onContainerKeyPress"));this.XRa&&(Y.mb(F.a.click,this.XRa,Object(e.a)(this,this.pGf,"onDoneButtonClick")),this.dCg=ca.sjb(this.XRa,
Object(e.a)(this,this.pGf,"onDoneButtonClick"),O.a.es));this.XTa&&(Y.mb(F.a.click,this.XTa,Object(e.a)(this,this.eIf,"onReplyButtonClick")),this.eYg=ca.sjb(this.XTa,Object(e.a)(this,this.eIf,"onReplyButtonClick"),O.a.es));this.oya&&(Y.mb(F.a.click,this.oya,Object(e.a)(this,this.nYd,"onSaveButtonClick")),this.zZg=ca.sjb(this.oya,Object(e.a)(this,this.nYd,"onSaveButtonClick"),O.a.es));this.PRa&&(Y.mb(F.a.click,this.PRa,Object(e.a)(this,this.iGf,"onDeleteButtonClick")),this.ZAg=ca.sjb(this.PRa,Object(e.a)(this,
this.iGf,"onDeleteButtonClick"),O.a.es));this.Rwa&&(Y.mb(F.a.click,this.Rwa,Object(e.a)(this,this.IFf,"onCancelButtonClick")),this.exg=ca.sjb(this.Rwa,Object(e.a)(this,this.IFf,"onCancelButtonClick"),O.a.es));ka&&(ca.mb(F.a.Ft,ka,Object(e.a)(this,this.$Ca,"onKeyEvent")),ca.mb(F.a.oh,ka,Object(e.a)(this,this.$Ca,"onKeyEvent")),E.a.ki&&(Y=u.AFrameworkApplication.ua.lgc,Y.mb(F.a.GBc,ka,Object(e.a)(this,this.VCa,"onCompositionEvent"),null),Y.mb(F.a.BZb,ka,Object(e.a)(this,this.VCa,"onCompositionEvent"),
null),Y.mb(F.a.CZb,ka,Object(e.a)(this,this.VCa,"onCompositionEvent"),null)),B.a.instance.mb(F.a.paste,ka,Object(e.a)(this,this.OTc,"onPaste")),this.oRn())}Q_i(Y){n.a.yJb(this.oya,Y)}Dfa(Y){return Y+"_"+this.Ru.id}PPi(Y,ca,da,ua,ra){switch(this.Ru.iPa){case 0:case 1:this.s5i(Y,0);break;case 2:case 4:Y.style.display="none";break;case 3:Sys.UI.DomElement.addCssClass(ra,"SaveFailure"),Sys.UI.DomElement.addCssClass(ra,"NoReply"),this.s5i(Y,1)}this.Ru.done?(Sys.UI.DomElement.addCssClass(ra,"CommentIsDone"),
ua.className=y.getImageClass("CheckboxChecked_16x16x32")):(Sys.UI.DomElement.removeCssClass(ra,"CommentIsDone"),ua.className=y.getImageClass("CheckboxUnchecked_16x16x32"));this.Ru.LCb?(Sys.UI.DomElement.addCssClass(ra,"NewOrEditComment"),Sys.UI.DomElement.addCssClass(ra,"SelectedComment"),Y.style.display="none",ca.style.display="none",da.style.display="inline",0===this.Ru.tq.mode&&(this.Q_i(!1),n.a.yJb(this.Rwa,!1))):(1===this.Ru.Gga?(Sys.UI.DomElement.addCssClass(ra,"SelectedComment"),Sys.UI.DomElement.removeCssClass(ra,
"SelectedParentComment"),ca.style.display=1!==this.Ru.tq.mode||3===this.Ru.iPa||this.Ru.U6b?"none":"inline"):(2===this.Ru.Gga?(Sys.UI.DomElement.removeCssClass(ra,"SelectedComment"),Sys.UI.DomElement.addCssClass(ra,"SelectedParentComment")):(Sys.UI.DomElement.removeCssClass(ra,"SelectedComment"),Sys.UI.DomElement.removeCssClass(ra,"SelectedParentComment")),ca.style.display="inline"),da.style.display="none")}s5i(Y,ca){L.a.nA(Y);switch(ca){case 0:ca=document.createElement("img");ca.alt=CommonUIStrings.l_CommentProgressTooltip;
ca.src=t.a.G9("progress16.gif");Y.appendChild(ca);break;case 1:ca=y.createClusteredImage(16,16,"Risks_16x16x32","",!0,CommonUIStrings.l_CommentFailTooltip),Y.appendChild(ca)}Y.style.display="inline-block"}S8f(){L.a.eZ(this.mY);var Y=this.Ru.text;1===Y.length&&Y[0]&&(Y=Y[0].split("\n"));for(const ca of Y)Y=k.a("p","","CommentContentPara"),Y.innerText=ca||"\u00a0",this.Ru.tq.lsh||Y.setAttribute("Unselectable","on"),this.mY.appendChild(Y)}oRn(){const Y=K.FocusManager.instance().re(a.a.vBc);Y.parent=
v.AFrame.gr;G.a.instance.Eqd(a.a.vBc,this.hw);Y.bindAction(H.KeyInputManager.lc(O.a.gge,2),P.a.Ag);Y.bindAction(this.wY,P.a.YXe);Y.bindAction(H.KeyInputManager.lc(O.a.U7,0),P.a.kXa);Y.bindAction(H.KeyInputManager.lc(O.a.xha,0),P.a.kXa);Y.Dr(K.FocusManager.instance().EV);Y.Dr(K.FocusManager.instance().FV)}zwi(Y){if(this.Ru.LCb&&Y.Ib.target===this.hw)return!0;this.Ru.vIf();return!0}Awi(){this.Ru.axi();return!0}Bwi(Y){let ca=!1;Y.Ib.keyCode===O.a.es&&(0===this.Ru.Gga?this.Ru.vIf():this.Ru.axi(),ca=!0);
return ca}iGf(){if(this.PRa.disabled)return!0;this.Ru.Qfa();return!0}pGf(){if(this.XRa.disabled)return!0;this.Ru.rYm();return!0}eIf(){if(this.XTa.disabled)return!0;this.Ru.qWm();return!0}nYd(){if(this.oya.disabled)return!0;this.Ru.zGb(this.hw.value);return!0}IFf(){if(this.Rwa.disabled)return!0;this.Ru.cGb();return!0}$Ca(Y){if(Y.Ib.ctrlKey&&Y.Ib.keyCode===O.a.es)return 0<this.hw.value.length&&this.nYd(null),!0;if(Y.Ib.keyCode===O.a.X_)return!0;this.onTextEntered(Y.eventName===F.a.Ft&&Y.Ib.charCode===
O.a.es);return!1}VCa(){this.onTextEntered(!1);return!1}OTc(){const Y=new I.a(0,1,0,()=>{this.onTextEntered(!1)},1);u.AFrameworkApplication.uc.$b(Y);return!1}onTextEntered(Y){if(0!==this.Ru.tq.mode&&(this.Q_i(0<this.hw.value.length),!E.a.Kta)){this.zVb.clientWidth!==this.hw.clientWidth&&(this.zVb.style.width=this.hw.clientWidth+"px");this.vya.value=this.hw.value+"___";this.EWg>this.hw.value.length&&(this.vya.rows=1);for(var ca=0,da=Number.MAX_VALUE;1<=(ca=this.vya.scrollHeight-this.vya.clientHeight)&&
ca<da;)da=ca,this.vya.rows++;this.vya.rows<this.TUd?this.hw.rows=this.TUd:(Y&&this.vya.rows++,this.hw.rows=this.vya.rows);this.EWg=this.hw.value.length}}static yQk(Y,ca,da){if(!Y||isNaN(Y.getDate()))return"";let ua=da;const ra=new Date;if(ra.getFullYear()!==Y.getFullYear()||ra.getMonth()!==Y.getMonth()||ra.getDate()!==Y.getDate())ua=String.format(CommonUIStrings.l_CommentLongDateFormat,ca,da);return Y.localeFormat(ua)}}Object(C.a)(T,"CommentViewObject",null,[9,1079]);var U=d(121);d.d(N,"Comment",
function(){return X});class X{constructor(Y,ca,da,ua,ra,qa,ka,la,Ha=!1,wa=null,Ca=null,Ja=null){this.Fug=this.Gug=this.xCg=null;this.pld=0;this.C9a=2;this.Xwa=0;this.Yne=this.kN=null;this.fsf=!1;this.objectId=null;this.U6b=!1;this._id=Y;this.FGg=ca;this.tvg=da;this.B9c=ua;this.ckd=ra;this.BGa=qa;this.rV=ka;this.DGg=la;this.Vqh=Ha;this.Nwj=wa;this.Owj=Ca;this.usersByReactionType=Ja;this.aj=l.a.instance}get id(){return this._id}set id(Y){this._id=Y}get author(){return this.eQd?CommonUIStrings.l_RemovedAuthorName:
this.tvg}get authorId(){return this.Nwj}get XXb(){return this.Owj}get date(){return this.eQd?null:this.B9c}set date(Y){this.B9c=Y}get done(){return this.BGa}set done(Y){this.BGa!==Y&&(this.BGa=Y,this.kN&&this.kN.P3c())}get t2h(){return this.DGg}set t2h(Y){this.DGg=Y}get Rf(){return this.ckd}set Rf(Y){this.ckd=Y}get text(){return this.rV}set text(Y){this.rV=Y;this.kN&&this.kN.S8f()}get NLa(){return this.FGg}set NLa(Y){this.FGg=Y}get xKa(){return this.xCg}set xKa(Y){this.xCg=Y}get Hyc(){return this.Gug}set Hyc(Y){this.Gug=
Y}get Gyc(){return this.Fug}set Gyc(Y){this.Fug=Y}get Gga(){return this.pld}set Gga(Y){this.pld!==Y&&(this.pld=Y,this.kN&&this.kN.P3c())}get iPa(){return this.C9a}set iPa(Y){this.C9a===Y||0===this.C9a&&2===Y||3===this.C9a||(this.C9a=Y,this.kN&&this.kN.P3c())}get Sq(){return this.Xwa}set Sq(Y){if(this.Xwa!==Y){const ca=this.LCb&&0===Y;this.Xwa=Y;ca&&this.kN&&this.kN.S$k()}}get LCb(){return 1===this.Xwa||2===this.Xwa}get eQd(){return!!this.aj&&this.aj.removePersonalInformation}get containerElement(){return this.kN?
this.kN.containerElement:null}get tq(){return this.aj}get Hy(){return this.Yne}set Hy(Y){this.Yne=Y}dispose(){this.kN&&(this.kN.dispose(),this.kN=null)}render(){this.kN=new T(this);return this.kN.containerElement}D0a(){this.kN&&this.kN.P3c()}focus(){this.vIf();this.kN.focus();this.LCb&&this.kN.qJh()}toString(){let Y="[null]";this.rV&&0<this.rV.length&&(Y=30<this.rV[0].length?this.rV[0].substr(0,30)+"...":this.rV[0]);return String.format('I:{0} A:{1} T:{2} R:{3} D:{4} "{5}"',this._id||"[null]",this.tvg||
"[null]",this.B9c?this.B9c.toString():"[null]",this.ckd||"[null]",this.BGa,Y)}vIf(){2===this.tq.mode||3===this.tq.mode?this.LCb&&this.kN.qJh():(K.FocusManager.instance().fC(v.AFrame.gr),1!==this.pld&&this.tq.selectComment(this._id))}axi(){this.tq.g4n&&0===this.Xwa&&(K.FocusManager.instance().fC(v.AFrame.gr),this.Xwa=2,this.C9a=0,this.tq.editComment(this,null))}JRm(){3===this.tq.mode&&(K.FocusManager.instance().fC(v.AFrame.gr),this.Xwa=0,this.C9a=2,this.tq.zVe())}Qfa(){K.FocusManager.instance().fC(v.AFrame.gr);
this.tq.deleteComment(this)}rYm(){this.tq.vwb(this,!this.BGa)}qWm(){2!==this.tq.mode&&(K.FocusManager.instance().fC(v.AFrame.gr),this.tq.addReply(this.ckd||this._id,null))}zGb(Y){K.FocusManager.instance().fC(v.AFrame.gr);this.rV=Array(1);this.rV[0]=Y;1===this.Xwa?this.tq.Rra(this):this.tq.bbb(this)}cGb(){K.FocusManager.instance().fC(v.AFrame.gr);this.tq.Faa.DUc&&this.tq.Faa.DUc.focus();1===this.Xwa?(this.tq.deleteComment(this),this.tq.G5d(this.Rf)):this.JRm()}static hth(Y,ca,da,ua){const ra=U.a.create().toString();
Y=new X(ra,X.ERl,Y,new Date,ca,!1,[],da,!1,u.AFrameworkApplication.K.lb("PresenceUserId"),u.AFrameworkApplication.K.lb("PresenceProvider"));Y.Xwa=1;Y.C9a=0;Y.Yne=ua;return Y}}X.ERl=null;X.QCi=-1;Object(C.a)(X,"Comment",null,[9,265])},1618:function(C,N,d){d.d(N,"a",function(){return l});C=d(0);class l{constructor(){this.handler=null}}Object(C.a)(l,"SetAnnotationResultCallbackParameters",null,[])},1620:function(C,N,d){d.d(N,"a",function(){return l});C=d(0);class l{static get Lib(){return CommonUIStrings.l_ModernFontPicker_FontInfoPaneTitle}}
l.vzb="fontInfoTaskPane";l.experienceId="modernfontpicker";Object(C.a)(l,"FontInfoPaneConstants",null,[])},1621:function(C,N,d){d.d(N,"a",function(){return l});C=d(0);class l{constructor(){this.endDate=this.startDate=null}}Object(C.a)(l,"CommentTaskSchedule",null,[])},1622:function(C,N,d){d.d(N,"a",function(){return e});C=d(0);var l=d(67);class e{static get me(){return null!=e.Gig?e.Gig:e.Gig=new l.a}static s7j(a){e.me.addHandler(e.Dwi,a)}static W7j(a){e.me.addHandler(e.Yyi,a)}}e.Dwi="OnCopyComment";
e.Yyi="OnPasteComment";Object(C.a)(e,"CommentEventsManager",null,[])},1623:function(C,N,d){d.d(N,"a",function(){return l});const l={F8e:"TasksFeatureUsage",H6n:"TaskExperienceDegraded",rae:"TaskCreate",sae:"TaskEngagement"}},1626:function(C,N,d){d.d(N,"c",function(){return n});d.d(N,"b",function(){return v});d.d(N,"a",function(){return u});var l=d(76),e=d(8),a=d(2),k=d(35);const n=t=>{if(!t)return null;let y;try{y=k.b(t)}catch(B){y=null,e.ULS.sendTraceTag(578352835,202,15,"MruActor.TryDeserializeMruV2Response: SecureDeserialize Exception: {0}",
B)}return y},v=(t,y)=>{let B=[];if(t.breadcrumbs&&0<t.breadcrumbs.length)B=t.breadcrumbs;else{const G=t.service_info;G&&G.friendly_service_name&&Array.add(B,G.friendly_service_name);t.display_path&&Array.addRange(B,t.display_path)}return B.join(y?" \u00ab ":" \u200f\u00bb ")},u=(t,y=!1)=>{if(!t)return[];if(!t.documents)return e.ULS.sendTraceTag(578352838,202,15,"missing documents object"),[];if(!t.documents.items)return e.ULS.sendTraceTag(578352839,202,15,"missing items object"),[];t=t.documents.items;
const B=new l.a;for(let F=0;F<t.length;F++){const K=t[F];var G=K.web_url;if(!G){e.ULS.sendTraceTag(578320064,202,15,"Empty web_url");if(!K.url){e.ULS.sendTraceTag(578140248,202,15,"Empty url");continue}G=String.format("{0}?web=1",K.url)}const O={};O.DocumentUrl=G;O.MruId=K.mru_id;{G=K;let H=G.title;H?(G.extension&&(H=String.format("{0}.{1}",H,G.extension)),G=H):(e.ULS.sendTraceTag(578352837,202,15,"empty file title"),G="")}O.FileName=G;O.IsPinned=K.is_pinned;O.Path=v(K,a.AFrameworkApplication.isRtl);
y&&(O.App=K.app,O.TimeStamp=K.time_stamp);B.add(O)}return B.toArray()}},1627:function(C,N,d){d.d(N,"a",function(){return l});C=d(0);class l{}l.Callback="action";Object(C.a)(l,"MenuLauncherAsyncTriggerCommandProperties",null,[])},1628:function(C,N,d){var l=this&&this.BO||(Object.create?function(a,k,n,v){void 0===v&&(v=n);Object.defineProperty(a,v,{enumerable:!0,get:function(){return k[n]}})}:function(a,k,n,v){void 0===v&&(v=n);a[v]=k[n]}),e=this&&this.__exportStar||function(a,k){for(var n in a)"default"===
n||Object.prototype.hasOwnProperty.call(k,n)||l(k,a,n)};Object.defineProperty(N,"__esModule",{value:!0});e(d(1770),N);e(d(1771),N);e(d(1772),N);e(d(1773),N);e(d(1774),N);e(d(1775),N);C.exports.TextToImageAnnotation||Object.defineProperty(C.exports,"TextToImageAnnotation",{enumerable:!0,get:function(){return C.exports.TextToImageAnnotation}});C.exports.TextToImageSignal||Object.defineProperty(C.exports,"TextToImageSignal",{enumerable:!0,get:function(){return C.exports.TextToImageSignal}})},1629:function(C,
N,d){var l=this&&this.BO||(Object.create?function(a,k,n,v){void 0===v&&(v=n);var u=Object.getOwnPropertyDescriptor(k,n);if(!u||("get"in u?!k.iG:u.writable||u.configurable))u={enumerable:!0,get:function(){return k[n]}};Object.defineProperty(a,v,u)}:function(a,k,n,v){void 0===v&&(v=n);a[v]=k[n]}),e=this&&this.__exportStar||function(a,k){for(var n in a)"default"===n||Object.prototype.hasOwnProperty.call(k,n)||l(k,a,n)};Object.defineProperty(N,"__esModule",{value:!0});e(d(1776),N);e(d(1777),N);C.exports.ThemeExtractorAnnotation||
Object.defineProperty(C.exports,"ThemeExtractorAnnotation",{enumerable:!0,get:function(){return C.exports.ThemeExtractorAnnotation}});C.exports.ThemeExtractorSignal||Object.defineProperty(C.exports,"ThemeExtractorSignal",{enumerable:!0,get:function(){return C.exports.ThemeExtractorSignal}})},1630:function(C,N,d){var l=this&&this.BO||(Object.create?function(a,k,n,v){void 0===v&&(v=n);var u=Object.getOwnPropertyDescriptor(k,n);if(!u||("get"in u?!k.iG:u.writable||u.configurable))u={enumerable:!0,get:function(){return k[n]}};
Object.defineProperty(a,v,u)}:function(a,k,n,v){void 0===v&&(v=n);a[v]=k[n]}),e=this&&this.__exportStar||function(a,k){for(var n in a)"default"===n||Object.prototype.hasOwnProperty.call(k,n)||l(k,a,n)};Object.defineProperty(N,"__esModule",{value:!0});e(d(1778),N);e(d(1779),N);C.exports.TableType||Object.defineProperty(C.exports,"TableType",{enumerable:!0,get:function(){return C.exports.TableType}});C.exports.TableTypeAnnotation||Object.defineProperty(C.exports,"TableTypeAnnotation",{enumerable:!0,
get:function(){return C.exports.TableTypeAnnotation}})},1632:function(C,N,d){function l(){a||(e.Health.instance.addQosPillar("AsyncCollab"),a=!0)}d.d(N,"a",function(){return l});var e=d(83);let a=!1},1633:function(C,N,d){d.d(N,"a",function(){return l});C=d(0);class l{constructor(e,a=0,k=!1){this.Wjj=!1;this.paragraphNode=e;this.KDf=a;this.Wjj=k}}Object(C.a)(l,"ReviewActionArgs",null,[])},1640:function(C,N,d){d.d(N,"a",function(){return a});C=d(0);var l=d(49);d(5);var e=d(8);class a{constructor(k,
n){this.rBm=()=>{e.ULS.sendTraceTag(39358976,324,50,"ForceSave request was successful in AutoSaveParamsUpdateService.")};this.iua=(v,u)=>{e.ULS.sendTraceTag(39358977,324,10,"ForceSave request failed in AutoSaveParamsUpdateService with status code {0}.",u)};this.AQb=n}bXi(k,n,v,u=null,t=null,y=null){if(k){var B=new l.GraphTransaction(0);B.Db(k);k.setValue(n,v);B.dispose();try{this.AQb(15,!1,u||this.rBm,t||this.iua,y,null,null)}catch(G){e.ULS.sendTraceTag(39358947,324,10,"Error calling ForceSave in TableOfContentsActor.SendSaveRequest. Message: {0}",
G.message)}}else e.ULS.sendTraceTag(39358946,324,10,"AutoSaveParametersNode is null in AutoSaveParamsUpdateService.")}}Object(C.a)(a,"AutoSaveParamsUpdateService",null,[417])},1641:function(C,N,d){d.d(N,"a",function(){return e});C=d(0);var l=d(8);class e{constructor(a){this.Jaj=a}Pd(a,k){if(a){var n=this.Jaj();a();a=this.Jaj();l.ULS.sendTraceTag(0,345,50,`${k}-${a-n}`)}else l.ULS.shipAssertTag(520127454,345,!1)}}Object(C.a)(e,"PerfLogger",null,[375])},1642:function(C,N,d){d.d(N,"a",function(){return l});
C=d(0);class l{constructor(e,a){this.paragraphNode=e;this.state=a}}Object(C.a)(l,"ReviewCompletedArgs",null,[])},1643:function(C,N,d){d.d(N,"a",function(){return l});C=d(0);class l{constructor(e,a){this.index=e;this.count=a}}Object(C.a)(l,"DesignerReviewPosition",null,[])},1644:function(C,N,d){d.d(N,"a",function(){return e});C=d(0);var l;(function(a){a[a.empty=0]="empty";a[a.filled=1]="filled"})(l||(l={}));Object(C.b)("BlueDotHighlightContextType",l);class e{constructor(a,k,n=WordEditorIntl.WordEditorStrings.L_ShowIntentSuggestionTooltipClick,
v=l.empty){this.lu=a;this.Azc=k;this.Z9n=n;this.Kik=v}}Object(C.a)(e,"BlueDotHighlightContext",null,[])},1645:function(C,N,d){d.d(N,"a",function(){return l});C=d(0);class l{constructor(){this.ay=this.Lo=this.marginRight=this.marginLeft=this.marginBottom=this.marginTop=0;this.Mta=!1;this.LGb=this.lFb=5;this.iW=this.KC=this.Qzk=0}}Object(C.a)(l,"SectionPropertiesData",null,[])},1646:function(C,N,d){d.d(N,"a",function(){return l});C=d(0);class l{}Object(C.a)(l,"PersonaInfo",null,[])},1647:function(C,
N,d){d.d(N,"a",function(){return l});C=d(0);class l{}Object(C.a)(l,"PersonaIdentifiers",null,[])},1648:function(C,N,d){d.d(N,"a",function(){return l});C=d(0);N=d(1111);d=d(1029);class l{}l.i_=[new N.a(1440,1440,1440,1440),new N.a(720,720,720,720),new N.a(1440,1440,1080,1080),new N.a(1440,1440,2880,2880),new N.a(1440,1440,1800,1800)];l.rna=[new d.a(12240,15840),new d.a(12240,20160),new d.a(10440,15120),new d.a(11907,16839),new d.a(8391,11907)];Object(C.a)(l,"PredefinedPageProperties",null,[])},1650:function(C,
N,d){d.d(N,"a",function(){return F});C=d(0);var l=d(192),e=d(2),a=d(22),k=d(15),n=d(21),v=d(1288),u=d(263),t=d(468),y=d(8),B=d(311),G=d(629);class F{constructor(K,O,H,I,J,L,S,E,P,T,U,X,Y,ca){this.Nq=K;this.bqb=O;this.Oa=H;this.Bp=I;this.Zq=J;this.zD=L;this.d9=S;this.QOb=E;this.NOb=P;this.OOb=T;this.POb=U;this.c7a=X;this.d7a=Y;this.ped=ca}build(K,O,H,I){const J=new l.QueryStringBuilder("WordOart.ashx");e.AFrameworkApplication.vja(J);J.Ie(B.a.nodeId,O.id.toString());O=n.ImageReader.cEl(O,K.Lc);J.Ie(G.a.Ayd,
O?O.ia(t.a.MEf,""):"");J.Ie(G.a.width,this.Bp.toString());J.Ie(G.a.height,this.Zq.toString());J.Ie(G.a.ZUc,this.d9.toString());J.Ie(G.a.Mtn,v.a[this.bqb]);O=this.Oa.$("WordEditorImageCropIsEnabled");J.Ie(G.a.Xvh,O.toString());O&&(J.Ie(G.a.top,this.QOb.toString()),J.Ie(G.a.bottom,this.NOb.toString()),J.Ie(G.a.left,this.OOb.toString()),J.Ie(G.a.right,this.POb.toString()));O=this.Oa.$("WordEditorImageRotateIsEnabled");J.Ie(G.a.yTi,O.toString());O&&(J.Ie(G.a.angle,this.zD.toString()),J.Ie(G.a.flipH,this.c7a?
"true":"false"),J.Ie(G.a.flipV,this.d7a?"true":"false"));J.Ie(G.a.CLf,H?"true":"false");J.Ie(G.a.strict,this.ped?"true":"false");this.Oa.$("WacWordEditorRenderHighContrastGraphicsIsEnabled")&&this.Nq&&this.Nq.vlf&&J.Ie(G.a.MBb,this.Nq.vlf);(K=K.Di())?(J.Ie(B.a.fileId,K.Fs),J.Ie(B.a.cellId,K.Zl.toString())):y.ULS.sendTraceTag(575522528,322,10,"parentGraphSpace is null. Cannot set FileId and CellId. url: {0}",J.toString());K=a.a.instance.Pa("Box4.IFeatureHelper");K=!!K&&K.isFeatureEnabled(48);J.Ie(G.a.p_k,
"true");J.Ie(G.a.E4l,K.toString());J.Ie(G.a.SCh,"true");K&&J.Ie(G.a.REi,K.toString());J.Ie(G.a.H4l,"true");u.a.instance.fvb(J);H&&I&&!k.a.Ak&&J.gL(G.a.Rab,window.self.devicePixelRatio.toString());J.Ie(G.a.kfh,"true");return J.toString()}}Object(C.a)(F,"WordOartEndpointUrlBuilder",null,[])},1651:function(C,N,d){d.d(N,"a",function(){return e});C=d(0);var l=d(17);class e{constructor(a,k){this._id=a;this.Gb=k;this.Kok=k.ia(l.a.rfa,0);this.Iok=k.ia(l.a.yma,0)}getId(){return this._id}}Object(C.a)(e,"GraphicsEditorImageContainer",
null,[519])},1652:function(C,N,d){d.d(N,"a",function(){return S});C=d(0);var l=d(59),e=d(2),a=d(130),k=d(192),n=d(21),v=d(492),u=d(1170),t=d(5),y=d(106),B=d(45),G=d(17),F=d(47),K=d(468),O=d(110),H=d(965),I=d(8),J=d(629),L=d(1650);class S{constructor(E,P,T,U,X,Y){this.properties=null;this.Nq=P;this.ij=U;this.Oa=X;this.jB=Y}Qio(E,P,T){E.Mea||(P.setValue(t.a.Frd,E.yak),P.setValue(t.a.RBd,E.o1b));this.Dmj(E,P,T)}Rio(E,P,T){P.setValue(t.a.ZGb,E.ino);n.ImageReader.YGd(P,T.Lc,!1)!==E.uJf&&P.Qg(t.a.G_d,y.a.Fu,
y.a.ana,B.a.B4a);if(E.rZd)P.setValue(G.a.Laa,l.a.Of(E.rZd));else{var U=this.Gth(E.uJf,E.vJf,E.extension);T.Lc.Ku(U);P.setValue(G.a.Laa,U.id)}E.aee?P.setValue(B.a.B4a,l.a.Of(E.aee)):E.qlj&&(U=this.Gth(E.qlj,E.Q$f,E.extension),T.Lc.Ku(U),P.setValue(B.a.B4a,U.id));P.ia(t.a.H_d,"")!==E.BXc&&(""!==E.BXc?P.setValue(t.a.H_d,E.BXc):P.removeProperty(t.a.H_d));0===E.Tza&&0===E.Vza&&0===E.Uza&&0===E.Sza||this.ij.kYf(P,E.Vza,E.Sza,E.Tza,E.Uza);void 0!==E.lockAspectRatio?P.setValue(t.a.QW,E.lockAspectRatio):P.setValue(t.a.QW,
!1);E.rjk&&(this.JJb(P,t.a.hga,E.Dgh),this.JJb(P,t.a.mna,E.borderStyle),this.JJb(P,t.a.xDa,E.borderColor));void 0!==E.altTextDescription&&P.setValue(t.a.PW,E.altTextDescription);this.JJb(P,F.a.alphaModFix,E.alphaModFix);this.Dmj(E,P,T);E=v.a.instance.rBd(P);P.setValue(t.a.f3,E)}Gth(E,P,T){const U=new H.a(524345);U.setValue(K.a.MEf,E);U.setValue(K.a.oac,E);U.setValue(B.a.R7k,l.a.Of(E).nr);U.setValue(t.a.M6h,P);U.setValue(K.a.Q8e,e.AFrameworkApplication.rootQuerySignature);U.setValue(B.a.VGh,T);return U}Dmj(E,
P,T){E.Mea?(this.properties=P,P.setValue(F.a.Mea,E.Mea),E.Eyc&&P.setValue(F.a.Erd,E.Eyc),P.setValue(F.a.oBa,E.Aro),P.setValue(F.a.pBa,E.NXl),P.setValue(F.a.ZYa,E.H0b),P.setValue(t.a.Eq,E.Eq),P.setValue(t.a.Ayb,E.w0b),P.setValue(B.a.CZ,0),P.setValue(O.a.l3,0),this.JJb(P,F.a.Pfb,E.T7b),this.U7g(P,T,!1,!0),this.Cvk(P)):(P.setValue(t.a.GBa,E.GBa),P.setValue(y.a.Fu,E.GBa?E.f5m:""),E.Rab&&P.setValue(y.a.$4b,E.Rab),P.setValue(t.a.Eq,E.Eq),P.setValue(t.a.Ayb,E.w0b),P.setValue(t.a.f3,E.hcb),P.setValue(G.a.rfa,
a.a.qF(E.width)),P.setValue(G.a.yma,a.a.qF(E.height)),P.setValue(B.a.TEi,a.a.qF(E.width)),P.setValue(B.a.SEi,a.a.qF(E.height)),P.setValue(y.a.FBa,-1),P.setValue(y.a.EBa,-1),P.setValue(G.a.ifa,!0),P.setValue(t.a.dK,E.rotationAngle),P.setValue(B.a.CZ,0),E.GBa&&this.U7g(P,T,!0,!1),this.Dvk(P));5!=n.ImageReader.ul(P)?this.Fvk(P):this.Bvk(P);this.JJb(P,t.a.MKc,E.flipH);this.JJb(P,t.a.VKc,E.flipV)}wun(E,P,T,U,X=null){E=this.ij.oun(E.vk,P,T,U);null==E?I.ULS.sendTraceTag(561538391,3001,10,"Failed to replace picture properties"):
X&&X(E)}U7g(E,P,T,U){let X=!1;const Y=this.jB.ju(P);Y&&Y.Og(t.a.Ktf)&&(X=!0);P=(new L.a(this.Nq,n.ImageReader.ul(E),this.Oa,n.ImageReader.tA(E),n.ImageReader.JB(E),n.ImageReader.vZ(E),n.ImageReader.ceb(E),Math.max(n.ImageReader.pla(E),0),Math.max(n.ImageReader.lla(E),0),Math.max(n.ImageReader.nla(E),0),Math.max(n.ImageReader.ola(E),0),n.ImageReader.dGd(E),n.ImageReader.mAb(E),X)).build(P,E,!0,!1);U&&(U=new k.QueryStringBuilder(P),U.Ie(J.a.TLd,"true"),P=U.toString());E.setValue(t.a.bcb,P);T&&u.a.LJb(E,
1,e.AFrameworkApplication.K,this.Nq)}JJb(E,P,T){void 0===T||null===T?E.removeProperty(P):E.setValue(P,T)}Dvk(E){E.removeProperty(F.a.Mea);E.removeProperty(F.a.Erd);E.removeProperty(F.a.oBa);E.removeProperty(F.a.pBa);E.removeProperty(F.a.ZYa);E.removeProperty(F.a.GNm);E.removeProperty(F.a.jZk);E.removeProperty(F.a.Pfb)}Fvk(E){E.removeProperty(t.a.G_d);E.removeProperty(t.a.ZGb);E.removeProperty(G.a.Laa);E.removeProperty(t.a.H_d)}Bvk(E){E.removeProperty(t.a.RBd);E.removeProperty(t.a.Frd);E.removeProperty(F.a.Mea);
E.removeProperty(F.a.Erd)}Cvk(E){E.removeProperty(t.a.Frd);E.removeProperty(y.a.Fu);E.removeProperty(G.a.rfa);E.removeProperty(G.a.yma);E.removeProperty(t.a.f3);E.removeProperty(y.a.ana);E.removeProperty(t.a.RBd);E.removeProperty(t.a.dK)}}Object(C.a)(S,"GraphicsEditorImageEditor",null,[499])},1657:function(C,N,d){d.d(N,"a",function(){return l});C=d(0);class l{constructor(){this.vetoPillar=this.crewAlias=this.featureName=this.topLevelKpiName=null}}Object(C.a)(l,"FeatureUsageAndHealthConfig",null,[])},
1660:function(C,N,d){d.d(N,"a",function(){return e});C=d(0);N=d(245);var l=d(126);class e extends N.a{constructor(){super();this.CellId=this.FileId=null}Wl(){return 37}static construct(a){const k=new e;k.FileId=a.Di().Fs;k.CellId=l.a(a.Lc.id);return k}}Object(C.a)(e,"LastSavedRevisionRequest",N.a,[])},1683:function(C,N,d){d.d(N,"a",function(){return B});C=d(0);var l=d(59),e=d(11),a=d(14),k=d(8),n=d(18),v=d(1509),u=d(1503),t=d(1505),y=d(1510);class B{constructor(G,F,K,O,H,I,J){this.Owi=(L,S)=>{S&&
S.data&&S.data.Rx&&(L=new y.a(S.data.Rx,1,!0),this.Pme.WX(L))};this.Kzi=(L,S)=>{S&&S.data&&S.data.Rx&&S.data.Rx.node&&this.pBj.Wsi(this.Pme,S.data.Rx.node)};this.Qcc=(L,S,E)=>{L=S.view.ze?S.view:null;if(!L||!L.Cb)return 8;L=L.Cb.hb.J(0).Qa;return e.ParagraphReader.nc(L.node)?1===E?32:2===E?(E=new y.a(L,2,!1),this.Pme.WX(E),32):2:2};this.n_b=(L,S,E)=>{var P,T;L=S.view.ze?S.view:null;if(!L||!L.Cb)return 8;L=null===(P=L.Cb.hb.J(0))||void 0===P?void 0:P.Qa;return L&&L.node?e.ParagraphReader.nc(L.node)?
1===E?32:2===E?(E=L.node,P=e.ParagraphReader.text(L.node),S=L.cpBegin,L=L.cpEnd-S,0<L&&(P=P.substr(S,L)),L=Math.floor(Math.random()*B.iUi),S=l.a.create(),k.ULS.sendTraceTag(541446531,3016,50,"Create Pull Quote invoked from context menu. PullQuote info: {0}; Document info: {1}",{["suggestionId"]:S,["textLength"]:P.length,["paragraphLength"]:e.ParagraphReader.textLength(E),["paragraphRole"]:null===(T=this.eP.wA(E))||void 0===T?void 0:T.role,["styleId"]:L},this.QLj.AIc()),T=[new v.c(new u.d(S,3,null,
null,!1,L,P),E,L,P,U=>{this.wPb.RWc(t.a.create(U));this.wPb.Qbc({role:27,paragraphNode:U,placeholder:!1})},3)],this.ARj.esd(T),32):2:2:8};this.ga=G;this.Pme=F;this.pBj=K;this.wPb=O;this.ARj=H;this.eP=I;this.QLj=J}initialize(){this.ga.gb(n.a.Qcc,a.a.view,this.Qcc,1028);this.wPb.p8j(this.Kzi);this.wPb.o7j(this.Owi);this.ga.gb(n.a.n_b,a.a.view,this.n_b,4)}dispose(){this.ga.Yy(n.a.n_b,a.a.view,this.n_b);this.wPb.Hrn(this.Owi);this.wPb.Zrn(this.Kzi);this.ga.Yy(n.a.Qcc,a.a.view,this.Qcc)}}B.iUi=5;Object(C.a)(B,
"DesignerActionListener",null,[1021,9])},1686:function(C,N,d){d.d(N,"a",function(){return l});C=d(0);class l{}l.seen="Seen";l.kept="Kept";l.rejected="Rejected";Object(C.a)(l,"CritiqueAction",null,[])},1695:function(C,N,d){var l=d(0),e=d(1758),a=d(387),k=d(619),n=d(59),v=d(22),u=d(1906),t=d(2),y=d(82),B=d(80),G=d(1570),F=d(148);class K{constructor(Ub,uc){this.CommentId=Ub;this.ResolveState=uc}}Object(l.a)(K,"CommentProperties",null,[]);var O=d(579),H=d(1908),I=d(1909),J=d(1607),L=d(195),S=d(1756);
class E extends S.a{constructor(Ub,uc="",Tc="",qd="",re=!1){super(Ub,uc,Tc,qd,re);this.DateUtc=null}}Object(l.a)(E,"CommentReactionUser",S.a,[]);var P;(function(Ub){Ub[Ub.like=1]="like"})(P||(P={}));Object(l.b)("ReactionType",P);var T;(function(Ub){Ub[Ub.first=0]="first";Ub[Ub.done=0]="done";Ub[Ub.undone=1]="undone";Ub[Ub.addComment=2]="addComment";Ub[Ub.deleteComment=3]="deleteComment";Ub[Ub.editComment=4]="editComment";Ub[Ub.addReaction=5]="addReaction";Ub[Ub.removeReaction=6]="removeReaction";
Ub[Ub.last=7]="last"})(T||(T={}));Object(l.b)("CommentChangeType",T);var U=d(205),X=d(592),Y=d(244);class ca{constructor(){this.I_g=this.Z1g=!1;this.rYj=[]}get Lgc(){return this.rYj}get TKb(){return this.Z1g}set TKb(Ub){this.Z1g=Ub;for(const uc of this.Lgc)uc.TKb=Ub}get GJb(){return this.I_g}set GJb(Ub){this.I_g=Ub;for(const uc of this.Lgc)uc.GJb=Ub}V3a(Ub){for(const uc of this.Lgc)Ub=uc.V3a(Ub);return Ub}}Object(l.a)(ca,"AggregateCommentTaskPersonTransformer",null,[911]);var da=d(8),ua=d(121),ra=
d(1567);class qa{constructor(Ub,uc){this.MKj=new Y.a(()=>uc.V3a(Ub.value))}gpl(){return new Date}BWa(Ub,uc,Tc){if(0===Ub)throw da.ULS.sendTraceTag(594650201,327,10,"CreateBlankHistoryRecord: we do not expect user to be able to create a record of type Unknown in the browser."),Error.argument("recordType");const qd=ua.a.create().toString();Tc=new ra.a(Ub,this.MKj.value,Tc,qd,!1);Tc.commentId=uc;da.ULS.sendTraceTag(42796192,327,50,"History Record Generated. [RecordType: {0}]",Ub);return Tc}}Object(l.a)(qa,
"HistoryRecordFactory",null,[913]);var ka=d(1621);class la{constructor(Ub,uc,Tc,qd,re,Je){this.isLossy=Ub;this.title=uc;this.assignees=Tc;this.schedule=qd;this.completion=re;this.priority=Je}}Object(l.a)(la,"CommentTaskState",null,[]);class Ha{constructor(){this.commentId=null}}Object(l.a)(Ha,"HistoryItem",null,[]);class wa{constructor(Ub,uc,Tc,qd,re,Je,Jf){this.Rte=!1;if(1!==uc.type)throw Error.argument("createRecord");this.Ylc=Tc;this.Vlc=qd;this.Wlc=re;this.SRg=1;this.icd=Ub;this.QMj=Je;this._state=
new la(!1,this.Ylc,Jf,new ka.a,this.Wlc,this.Vlc);this._history=[];this.vuh(uc)}r_b(Ub,uc){if(1!==Ub.type)throw Error.argument("createRecordTemplate");const Tc=wa.RKl(Ub,this.SRg);this.SRg++;return Object.assign(new ra.a(uc,Ub.user,Ub.time,Tc),{commentId:Ub.commentId})}get Pji(){return this.history[this.history.length-1]}get I3h(){return this.state.completion===this.Wlc}get H3h(){return this.state.priority===this.Vlc}get J3h(){return(void 0===this.state.schedule.startDate||null===this.state.schedule.startDate)&&
(void 0===this.state.schedule.endDate||null===this.state.schedule.endDate)}get K3h(){return this.state.title===this.Ylc}vuh(Ub){Ub=Object.assign(new Ha,{commentId:Ub.commentId,records:[Ub]});this.history.push(Ub)}rMh(Ub){let uc=-1;for(let Tc=0;Tc<this.state.assignees.length;Tc++)if(this.icd.equals(this.state.assignees[Tc],Ub)){uc=Tc;break}return uc}bSn(Ub){const uc=this.Pji,Tc=uc.records[uc.records.length-1];return this.icd.equals(Tc.user,Ub.user)&&uc.commentId===Ub.commentId&&Tc.time.getTime()===
Ub.time.getTime()?!0:!1}ano(Ub){switch(Ub.type){case 2:-1===this.rMh(Ub.assignee)&&this.state.assignees.push(Ub.assignee);break;case 3:const uc=this.rMh(Ub.assignee);0<=uc&&this.state.assignees.splice(uc,1);break;case 4:Array.clear(this.state.assignees);break;case 5:this.state.schedule=Ub.schedule;break;case 6:this.state.completion=Ub.completion;break;case 9:this.state.title=Ub.title;break;case 10:this.state.priority=Ub.priority;break;case 0:this.state.isLossy=!0;break;case 1:da.ULS.sendTraceTag(595198540,
327,10,"Create record passed for state evaluation");break;case 7:this.Rte=!0;break;case 8:this.Rte=!1;break;case -1:da.ULS.sendTraceTag(51139905,327,10,"Undo record passed for state evaluation");break;default:this.state.isLossy=!0}Ub.isLossy&&(this.state.isLossy=!0);this.bSn(Ub)?this.Pji.records.push(Ub):this.vuh(Ub)}get isDeleted(){return this.Rte}get state(){return this._state}get history(){return this._history}Bul(Ub){if(!Ub)return this.history;const uc=Array.clone(this.history),Tc=uc[0],qd=Tc.records.shift();
if(!this.QMj){var re=this.r_b(qd,4);Tc.records.unshift(re)}!Ub.I3h&&this.I3h&&(re=this.r_b(qd,6),re.completion=this.Wlc,Tc.records.unshift(re));!Ub.H3h&&this.H3h&&(re=this.r_b(qd,10),re.priority=this.Vlc,Tc.records.unshift(re));!Ub.J3h&&this.J3h&&(re=this.r_b(qd,5),re.schedule=new ka.a,Tc.records.unshift(re));!Ub.K3h&&this.K3h&&(re=this.r_b(qd,9),re.title=this.Ylc,Tc.records.unshift(re));Ub.isDeleted&&(Ub=this.r_b(qd,8),Tc.records.unshift(Ub));return uc}static RKl(Ub,uc){return"Synthesized-"+Ub.recordId+
"-"+uc}}Object(l.a)(wa,"CommentTaskStateBuilder",null,[]);class Ca{constructor(Ub,uc,Tc,qd){this.id=Ub;this.commentId=uc;this.currentState=Tc;this.history=qd}}Object(l.a)(Ca,"CommentTaskItem",null,[]);var Ja=d(1566);const bb=Ub=>{const uc=new Ja.a(Ub.UserId,Ub.Provider,Ub.DisplayName,Ub.Email);uc.IsCurrentUser=Ub.IsCurrentUser;return uc};var ha=d(1753);class ia{static clone(Ub){Ub=ia.gyk(Ub.extensions);return new ha.a(Ub)}static Hnh(Ub){return Ub?ia.clone(Ub):null}static isEmpty(Ub){return!Ub.extensions||
!Ub.extensions.count}static mf(Ub){return!Ub||ia.isEmpty(Ub)}static gyk(Ub){if(!Ub)return null;const uc=new a.a;Ub.forEach((Tc,qd)=>{uc.add(Tc,qd);return!0});return uc}}Object(l.a)(ia,"ExtensionListExtensions",null,[]);class va{static clone(Ub){var uc=bb(Ub.user);uc=new ra.a(Ub.type,uc,Ub.time,Ub.recordId,Ub.isLossy);uc.commentId=Ub.commentId;uc.anchorExtensionList=ia.Hnh(Ub.anchorExtensionList);uc.recordExtensionList=ia.Hnh(Ub.recordExtensionList);Ub.assignee&&(uc.assignee=bb(Ub.assignee));if(Ub.schedule){var Tc=
Ub.schedule;const qd=new ka.a;qd.startDate=Tc.startDate;qd.endDate=Tc.endDate;uc.schedule=qd}uc.completion=Ub.completion;uc.title=Ub.title;uc.priority=Ub.priority;uc.undoId=Ub.undoId;return uc}}Object(l.a)(va,"HistoryRecordExtensions",null,[]);class Ka{constructor(Ub,uc,Tc,qd,re,Je,Jf,Ig=!1){this.icd=Ub;this.Gid=uc;this.rIa=Tc;this.Yzj=qd;this.Ylc=re;this.Vlc=Je;this.Wlc=Jf;this.Vdd=Ig}$Nk(Ub,uc,Tc,qd=null){if(!Ub)throw da.ULS.sendTraceTag(42796181,327,10,"taskId cannot be null."),Error.argumentNull("taskId");
if(!uc)throw da.ULS.sendTraceTag(42796182,327,10,"parentCommentId cannot be null."),Error.argumentNull("parentCommentId");if(!Tc||!Tc.length)throw da.ULS.sendTraceTag(42796183,327,10,"records cannot be null or empty."),Error.argumentNull("records");if(1!==Tc[0].type)throw da.ULS.sendTraceTag(42796184,327,10,"First record must be a Create record."),Error.argument("First record must be a Create record.");var re=[],Je=null,Jf=this.ban(Tc);for(var Ig of Tc)if(!Jf.contains(Ig.recordId))if(Tc=this.x0h(Ig.commentId,
qd),Tc=this.agl(Ig,Tc),1===Tc.type){let Lb=[];this.Vdd&&Je&&Je.state&&(Lb=Je.state.assignees);Je=new wa(this.icd,Tc,this.Ylc,this.Vlc,this.Wlc,this.Vdd,Lb);re.push(Je)}else if(Je)Je.ano(Tc);else throw da.ULS.sendTraceTag(595198539,327,10,"Undo resulted in ignoring of Task creation without also ignoring records after the create record."),Error.argument("Undo resulted in ignoring of Task creation without also ignoring records after the create record.");Jf=null;Ig=[];if(Je){Je.isDeleted||(Jf=Je.state);
Je=null;for(var pb of re)re=pb.Bul(Je),Array.addRange(Ig,re),Je=pb}pb=this.x0h(uc,qd);Jf&&(Jf.completion=this.lCk(uc,qd,Jf.completion));return new Ca(Ub,pb,Jf,Ig)}bLh(Ub,uc,Tc,qd=null){if(!uc)throw da.ULS.sendTraceTag(42796185,327,10,"update cannot be null."),Error.argumentNull("update");if(Tc&&!Ub)throw da.ULS.sendTraceTag(42796187,327,10,"CommentId must be specified for task creation."),Error.argument("commentId");const re=[],Je=this.rIa.gpl();if(Tc){var Jf=this.rIa.BWa(1,Ub,Je);re.push(Jf)}Jf=
null;if(uc.assigneeUpdate){if(!uc.assigneeUpdate.assigneesToAdd||!uc.assigneeUpdate.assigneesToRemove)throw da.ULS.sendTraceTag(536999254,327,15,"Invalid AssigneeUpdate."),Error.argument("Schedule","Invalid AssigneeUpdate.");for(var Ig=0;Ig<uc.assigneeUpdate.assigneesToAdd.length;Ig++){var pb=this.wuh(2,uc.assigneeUpdate.assigneesToAdd[Ig],Ub,Je);pb&&re.push(pb)}for(Ig=0;Ig<uc.assigneeUpdate.assigneesToRemove.length;Ig++)(pb=this.wuh(3,uc.assigneeUpdate.assigneesToRemove[Ig],Ub,Je))&&re.push(pb)}else uc.assignee&&
(Tc||(Jf=this.rIa.BWa(4,Ub,Je),re.push(Jf)),Ig=this.rIa.BWa(2,Ub,Je),Jf=this.Gid.V3a(uc.assignee),Ig.assignee=Jf,re.push(Ig));uc.title?(qd=this.rIa.BWa(9,Ub,Je),qd.title=uc.title,re.push(qd)):Tc&&qd&&(Ig=this.rIa.BWa(9,Ub,Je),Ig.title=this.Yzj.yNl(qd,Jf),re.push(Ig));if(uc.schedule){if(uc.schedule.startDate>uc.schedule.endDate)throw da.ULS.sendTraceTag(42796188,327,10,"Invalid schedule."),Error.argument("Schedule","Invalid schedule.");qd=this.rIa.BWa(5,Ub,Je);qd.schedule=uc.schedule;re.push(qd)}if(void 0!==
uc.completion&&null!==uc.completion){qd=uc.completion;if(0>qd||100<qd)throw da.ULS.sendTraceTag(42796189,327,10,"Invalid completion state."),Error.argumentOutOfRange("completion");Tc||da.ULS.sendTraceTag(595198538,327,50,"Task progress change. [Progress: {0}]",qd);Tc=this.rIa.BWa(6,Ub,Je);Tc.completion=qd;re.push(Tc)}if(void 0!==uc.priority&&null!==uc.priority){uc=uc.priority;if(0>uc||10<uc)throw da.ULS.sendTraceTag(42796190,327,10,"Invalid priority state."),Error.argumentOutOfRange("priority");Ub=
this.rIa.BWa(10,Ub,Je);Ub.priority=uc;re.push(Ub)}return re}wuh(Ub,uc,Tc,qd){if(2!==Ub&&3!==Ub)return da.ULS.sendTraceTag(0,327,10,"Assignee field should only be used for an Assign or Unassign HistoryRecord."),null;Ub=this.rIa.BWa(Ub,Tc,qd);Ub.assignee=this.Gid.V3a(uc);return Ub}ban(Ub){const uc=new k.a,Tc=new k.a;for(let qd=Ub.length-1;0<=qd;qd--){const re=Ub[qd],Je=Tc.contains(re.recordId);Je||-1!==re.type||(Tc.contains(re.undoId)?da.ULS.sendTraceTag(578670598,327,50,"Multiple Undo records attempting to undo the same record."):
Tc.add(re.undoId));if(Je||-1===re.type)uc.contains(re.recordId)?da.ULS.sendTraceTag(578670599,327,50,"Record was already added to records to ignore. There must be multiple records with same ID."):uc.add(re.recordId)}return uc}agl(Ub,uc){const Tc=va.clone(Ub);Tc.commentId=uc;Tc.user=this.Gid.V3a(Ub.user);Tc.assignee=this.Gid.V3a(Ub.assignee);return Tc}lCk(Ub,uc,Tc){let qd=Tc;Ub&&uc&&(({value:uc}=uc.Dc(Ub)).returnValue?(qd=uc.ResolveState?100:100===Tc?0:Tc,qd!==Tc&&da.ULS.sendTraceTag(592719873,327,
50,"Task completion state has been changed to match comment resolution state for comment {0}",Ub)):da.ULS.sendTraceTag(592719874,327,50,"Comment {0} not found in translation map. Completion unchanged",Ub));return qd}x0h(Ub,uc){let Tc=Ub;Ub&&uc&&(({value:uc}=uc.Dc(Ub)).returnValue?Tc=uc.CommentId:(da.ULS.sendTraceTag(42796191,327,50,"Id not found in translation map. Possible Orphan task candidate [CommentId: {0}]",Ub),Tc=Ub));return Tc}}Object(l.a)(Ka,"CommentTaskTranslatorImpl",null,[912]);var Xa=
d(1001),xa=d(1202);class Ma{constructor(){this.icb=CommonUIStrings.l_Ellipsis}yNl(Ub,uc){if(!Ub)throw da.ULS.sendTraceTag(592998807,327,10,"Missing commentRichText"),Error.argumentNull("commentRichText");try{var Tc=G.a.C2b(Ub)}catch(pb){throw da.ULS.sendTraceTag(592998806,327,10,"commentRichText not in Delta Format"),Error.format("Improperly formatted Delta text in commentRichText");}var qd=Ub=0,re=0;const Je=RegExp("\\s+","g"),Jf=new Sys.StringBuilder;for(var Ig of Tc.ops)Ig.attributes&&Ig.attributes.atmention&&
Ig.attributes.atmention.email&&uc&&(Tc=Ig.attributes.atmention.email,0<Tc.length&&(Tc===uc.UserId||Tc===uc.Email||Tc===Xa.a.Gcb(uc.UserId))&&(qd=Ub,re=qd+Ig.insert.length)),Tc=Ig.insert.replace(Je," "),Ub+=Tc.length,Jf.append(Tc);!re&&uc&&da.ULS.sendTraceTag(592998805,327,10,"Assignee was not found in comment text",uc.Provider);uc=Jf.toString().trimEnd();Ub=uc.length;255<Ub?(Ig=(255-(re-qd))/2,0>qd-Ig?(Ub=xa.a.instance.aYa(uc,255-this.icb.length),re=uc.substring(0,Ub)+this.icb,Ub="Trimmed End"):re+
Ig>Ub?(qd=xa.a.instance.oYa(uc,Ub-255+this.icb.length),re=this.icb+uc.substring(qd,Ub),Ub="Trimmed Start"):(qd=xa.a.instance.oYa(uc,qd-Ig+this.icb.length),Ub=xa.a.instance.aYa(uc,re+Ig-this.icb.length),re=this.icb+uc.substring(qd,Ub)+this.icb,Ub="Trimmed Both")):(Ub="No Trim",re=uc);da.ULS.sendTraceTag(592998804,327,50,Ub);return re}}Object(l.a)(Ma,"ContentExtractor",null,[]);class Na{constructor(Ub,uc){this.SGj=Ub;this.PKj=uc;this.GJb=this.TKb=!1}V3a(Ub){if(!Ub)return null;if(void 0===Ub.UserId||
null===Ub.UserId)throw da.ULS.sendTraceTag(593368219,327,10,"Unexpected user missing UserId field"),Error.argumentType();if(Ub.IsCurrentUser||!this.SGj.equals(this.PKj.value,Ub))return Ub;Ub=bb(Ub);Ub.IsCurrentUser=!0;return Ub}}Object(l.a)(Na,"EnsureIsCurrentUserSetTransformer",null,[911]);class pa{constructor(){this.GJb=this.TKb=!1}V3a(Ub){if(!Ub)return null;if(void 0===Ub.UserId||null===Ub.UserId)return Ub;if(!Ub.Email||""===Ub.Email){let uc;if(uc=Xa.a.Gcb(Ub.UserId))return Ub=bb(Ub),Ub.Email=
uc,Ub}return Ub}}Object(l.a)(pa,"RestoreEmailTransformer",null,[911]);class Ra{constructor(){this.GJb=this.TKb=!1}V3a(Ub){if(!Ub)return null;if(void 0!==Ub.UserId&&null!==Ub.UserId)return Ub;switch(this.TKb?this.GJb?2:1:0){case 0:if(void 0===Ub.UserId||null===Ub.UserId)throw da.ULS.sendTraceTag(593368215,327,10,"assignee missing UserId"),Error.argument("assignee.UserId");Ub=bb(Ub);break;case 1:if(void 0===Ub.Id||null===Ub.Id)throw da.ULS.sendTraceTag(593368214,327,10,"assignee missing Id"),Error.argument("assignee.Id");
if(void 0===Ub.Email||null===Ub.Email)throw da.ULS.sendTraceTag(593368213,327,10,"assignee missing Email"),Error.argument("assignee.Email");var uc=Ra.IDi(Ub.Id,Ub.Email,null);if(!uc||""===uc)throw da.ULS.sendTraceTag(593368212,327,10,"Failed to generate UserId"),Error.argument("UserId");var Tc=t.AFrameworkApplication.K.lb("HostAuthType")||"";if("aad"!==Tc.toLowerCase()||uc.startsWith("S::")){if("msa"===Tc.toLowerCase())throw da.ULS.sendTraceTag(593368210,327,10,"Unexpected IPersonObject in MSA Environment"),
Error.argument("CommentTaskUserType");da.ULS.sendTraceTag(593368209,327,50,"Receiving IPersonObject with AuthType {0}",Tc)}else throw da.ULS.sendTraceTag(593368211,327,10,"Unexpected UserID format"),Error.argument("userId");Ub=new Ja.a(uc,"AD",Ub.DisplayName,Ub.Email);break;case 2:if(void 0===Ub.UserPrincipalName||null===Ub.UserPrincipalName)throw da.ULS.sendTraceTag(593368208,327,10,"assignee missing UserPrincipalName"),Error.argument("assignee.UserPrincipalName");if(void 0!==Ub.SuggestionSubtype&&
null!==Ub.SuggestionSubtype)if("OrganizationUser"===Ub.SuggestionSubtype)uc="AD";else throw da.ULS.sendTraceTag(593368207,327,10,"Unexpected LPP SuggestionSubtype : {0}",Ub.SuggestionSubtype),Error.argument("assignee.SuggestionSubtype");else throw da.ULS.sendTraceTag(593368206,327,10,"Missing SuggestionSubtype"),Error.argument("assignee.SuggestionSubtype");Tc=Ra.IDi(Ub.Id,Ub.UserPrincipalName,Ub.AadObjectId);if(!Tc||""===Tc)throw da.ULS.sendTraceTag(593368205,327,10,"Failed to generate UserId"),Error.argument("UserId");
if("AD"===uc&&!Tc.startsWith("S::"))throw da.ULS.sendTraceTag(593368204,327,10,"Unexpected UserID and Provider combination"),Error.argument("userId");Ub=new Ja.a(Tc,uc,Ub.Name,Ub.UserPrincipalName);break;default:throw da.ULS.sendTraceTag(593368203,327,10,"Unexpected UserType"),Error.argument("assignee.UserType");}return Ub}static IDi(Ub,uc,Tc){if(!uc||""===uc)return da.ULS.sendTraceTag(593368218,327,50,"Missing UPN"),Ub;if(Tc&&""!==Tc)return"S::"+uc+"::"+Tc;if(!Ub||""===Ub)return da.ULS.sendTraceTag(593368217,
327,50,"Missing ID"),Ub;if(Ub.startsWith("S::"))return Ub;if(-1!==Ub.indexOf("@")){Tc=Ub.split("@");if(ua.a.Rd(Tc[0]))return"S::"+uc+"::"+Tc[0];da.ULS.sendTraceTag(593368216,327,50,"ID is not in AadObjectId@TenantId format")}return Ub}}Object(l.a)(Ra,"UserIdCanonicalizationTransformer",null,[911]);class Sa{constructor(Ub,uc,Tc=!1,qd=!1){this.BCj=Ub;this.gxg=uc;this.ALj=Tc;this.Vdd=qd}wIk(){const Ub=new Xa.a;var uc=new Y.a(Sa.Iol);const Tc=new ca;this.gxg&&(Tc.Lgc.push(new Ra),Tc.Lgc.push(new pa));
this.BCj&&Tc.Lgc.push(new Na(Ub,uc));Tc.TKb=this.gxg;Tc.GJb=this.ALj;uc=new qa(uc,Tc);const qd=new Ma;return new Ka(Ub,Tc,uc,qd,Sa.BRk,Sa.qRk,Sa.rRk,this.Vdd)}static Iol(){const Ub=new Ja.a(t.AFrameworkApplication.K.lb("PresenceUserId")||"",t.AFrameworkApplication.K.lb("PresenceProvider")||"",t.AFrameworkApplication.userName||"");Ub.IsCurrentUser=!0;return Ub}}Sa.BRk="";Sa.qRk=5;Sa.rRk=0;Object(l.a)(Sa,"CommentTaskTranslatorFactory",null,[903]);var ab=d(57),eb=d(196),zb=d(13),Ua=d(6),Ab=d(54),mb=
d(9),Rb=d(181),hc=d(53),Hb=d(25),Ta=d(725),Aa=d(42),ma=d(19),Ga=d(11),Fa=d(1189),ib=d(34),ob=d(93),fb=d(298),Mb=d(145),Tb=d(291),rc=d(428),vb=d(707),Ya=d(391),wb=d(78),jb=d(247),Zb=d(14),Eb=d(5),tc=d(697),lc=d(524),Lc=d(375),Bb=d(44),jc=d(485),dc=d(120),nb=d(86),Gb=d(267),lb=d(1447),Kb=d(35),Vb=d(1003);class vc{create(){return new Vb.a}}Object(l.a)(vc,"CommentNodeFactory",null,[256]);var Fc=d(1184),Zc=d(1023),td=d(1485),xd=d(1540);class le{constructor(){this.bFc=this.j1c=null;this.IAd=this.U9d=!1;
this.VJa=this.zza=null}}Object(l.a)(le,"CommentAnchorParaNodesStatus",null,[]);var Yc=d(1386),xc=d(17);class md extends Yc.a{constructor(Ub){super();this.ZRj=Ub}get index(){return 2}run(){this.ZRj()}Qoh(Ub,uc){uc.property===xc.a.qf&&this.tX()}}Object(l.a)(md,"CommentContentPropertyTracker",Yc.a,[]);var Ie=d(1476);class Te{constructor(Ub,uc){this.zac=Ub;this.O9h=uc}}Object(l.a)(Te,"CommentIntentIdentifier",null,[]);var rf=d(993),ke=d(1036),xe=d(187),zf=d(157);class $c extends Yc.a{constructor(Ub,uc){super();
this.M5a=new lc.a(new rf.a);this.VVb=new ke.a(Ie.c);this.WVb=new xe.ScriptSharpLegacyMap;this.WNj=Ub;this.YOj=uc;this.WVb.add(Eb.a.F9,1);this.WVb.add(Eb.a.JG,0);this.WVb.add(xc.a.qf,0);this.WVb.add(Eb.a.H5,2)}get index(){return 4}run(){let Ub="";for(let uc of this.M5a)if(this.WNj(uc),this.VVb.xb(uc.id))for(let Tc of this.VVb.J(uc.id))Ub+="_"+Tc;this.YOj(Ub);this.M5a.clear();this.VVb=new ke.a(Ie.c)}$Ak(Ub,uc){Ub=uc.property;if(Ub===Eb.a.F9||Ub===Eb.a.JG||Ub===xc.a.qf||zf.App.qee&&Ub===Eb.a.sZb||Ub===
Eb.a.H5)this.M5a.add(uc.node),this.WVb.xb(Ub)&&(this.VVb.xb(uc.node.id)||this.VVb.add(uc.node.id,new jc.a),this.VVb.J(uc.node.id).add(this.WVb.J(Ub))),this.tX();td.a.Lwh.has(uc.node.id.toString())&&Ub===Eb.a.iE&&da.ULS.sendTraceTag(521484097,327,15,"Durable ID changed of a Cut Pasted Comment")}lBk(Ub,uc){uc.property===xc.a.lo&&(Ub=uc.node,Ub.NCb&&(this.M5a.add(Ub),this.tX()))}O6n(Ub,uc){this.M5a.add(uc.node);this.tX()}}Object(l.a)($c,"CommentNodeTransactionCompletedProcessor",Yc.a,[]);var Hg=d(1542),
Rc=d(1571);class Ed{constructor(){this.coe=new Map;this.ere=new Map}L1j(Ub,uc){if(this.coe.has(Ub))throw Error("DuplicateDurableId");if(this.ere.has(uc))throw Error("DuplicateGuardId");this.coe.set(Ub,uc);this.ere.set(uc,Ub)}Mtl(Ub){return this.coe.get(Ub)}vql(Ub){return this.ere.get(Ub)}}Object(l.a)(Ed,"CommentIdMapper",null,[]);var Yd=d(18),Zf=d(1499),Hc=d(1623),sc=d(1523);d.d(N,"a",function(){return pd});class pd extends e.a{constructor(Ub,uc,Tc,qd,re,Je,Jf,Ig,pb,Lb,Ic,Ad,oe,gf,Oe,Sg,Ng,Nh,Eg,
Wh,Bf,vf,Fj,Pe,sf,Xf=null,Se){super();this.yx=Ub;this.Gxe=uc;this.Bxe=Tc;this.Hc=qd;this.mzj=re;this.Wqb=Je;this.JMe=Jf;this.Vkc=Ig;this.Oa=pb;this.Ac=Lb;this.Ns=Ic;this.sSb=Ad;this.EY=oe;this.iSb=gf;this.IOg=Oe;this.kf=Sg;this.wm=Ng;this.$Qa=Nh;this.tj=Eg;this.k4=Wh;this.JM=Bf;this.HUa=vf;this.Huc=Fj;this.$kc=[];this.qRa=[];this.VJe=new a.a(0);this.mkd=new a.a;this.Cnd=new lc.a(Lc.a.Rj());this.vJe=new lc.a(Lc.a.Rj());this.i$c=null;this.Rob=new a.a;this.Jme=!1;this.p8c=new k.a;this.mJg=!1;this.Qke=
new Set;this.sY=[];this.SPb=2;this.xya=new a.a(!1);this.dsc=new k.a;this.Jmc=new Map;this.Pke=new Ed;this.k8c=0;this.lzj=5;this.hTc=($f,Jg)=>{$f=Jg.paragraphNode;for(let fg of Jg.contents)this.bZa(fg.element,$f,fg.intents,fg.iI)};this.Cvi=($f,Jg)=>{if($f.Lc.id.equals(this.zd.id)){this.$Qa.KDa(7);var fg=$f.getValue(Eb.a.JG),Lg=$f.getValue(Eb.a.iE).toString();fg=this.kf.qcb?this.Jmc.has(Lg)?this.Jmc.get(Lg):Lg:fg;fg=this.GB(fg);if(Jg){if(fg){this.Ly&&this.Ly.Rf===fg.id&&(da.ULS.sendTraceTag(592188698,
327,50,"Draft lost by parent deletion"),this.JM.logKpiFailure(Zf.a.Vvd,"DraftCommentLostOnParentDelete",{isIntentional:!1,isInternal:!0},{name:Zf.a.ZXe,isIntentional:!1,isInternal:!0,isSessionEndingError:!1}));Jg=fg.Rf?"The comment is a reply":"";Lg=Ie.k($f,n.a.nil).toString();const Af=Ie.h($f,n.a.nil).toString();if(this.p8c.contains(fg.id)&&!td.a.obm(fg.xKa)){this.p8c.remove(fg.id);const Jh=+new Date-+fg.date;da.ULS.sendTraceTag(577307335,327,15,"New session comment deleted by inbound change: {0}. duration: {1}. startParaId: {2}. endParaId: {3}. {4}.",
Ie.a(fg),Jh,Lg,Af,Jg)}else da.ULS.sendTraceTag(50426379,327,50,"{0} deleted by inbound changes. startParaId: {1}. endParaId: {2}. {3}.",Ie.a(fg),Lg,Af,Jg);this.aj.DDc(fg);this.syh($f.id)}}else if(!fg){this.JM.ensureFeatureDenominatorLoggedAndVetoPillarRegistered();v.a.instance.Pa("WordEditor.Comments.EditorCommentManager")||da.ULS.sendTraceTag(525379405,327,10,"comment Manager resolve failed");if(this.kf.cyb&&!this.tj.dX){this.k4.xna("OnCommentInit",Object.assign(new Hg.a,{pxi:()=>{this.aGf($f);this.lIb()}}));
return}this.kf.vq||this.tj.dX||this.k4.xna("OnCommentInit");this.ndn($f)||this.aGf($f)}this.Jme=!0}};this.lIb=($f=null)=>{this.kf.mLb&&this.Z7h();this.kf.mLb&&this.n2k();this.RJ.nIb(void 0,$f);this.$Qa.KDa(8)};this.NAi=($f,Jg,fg)=>{if($f.Lc.id.equals(this.zd.id)){var Lg=$f.ia(Eb.a.taskId,"");if(""===Lg)da.ULS.sendTraceTag(42856717,3003,10,"Newly added or deleted task node does not have a task id.");else{if(Jg)if(this.vJe.add(Lg),Lg=this.iSb.value.y_h($f),void 0!==Lg&&null!==Lg)this.Rob.remove(Lg);
else{da.ULS.sendTraceTag(591971722,3003,10,"A task without comment id was deleted even though that shouldn't be possible.");return}else if(this.Cnd.add(Lg),Jg=this.iSb.value,$f=Jg.y_h($f),void 0!==$f&&null!==$f)for(this.Rob.J($f)?this.Rob.Z($f,Lg):this.Rob.add($f,Lg),$f=Jg.A_h(Lg),Jg=0;Jg<$f.length;Jg++){var Af=$f[Jg].commentId;Af&&(Af=Number.parseInvariant(Af),this.Rob.J(Af)||this.Rob.add(Af,Lg))}else{da.ULS.sendTraceTag(591971723,3003,10,"A task without comment id was added or modified even though that shouldn't be possible.");
return}fg&&this.lIb()}}};this.lho=$f=>{if(td.a.SNd($f)){const fg=this.uZ($f.id.toString());if(fg){const Lg={text:fg.text,done:fg.done};var Jg=Ua.GraphIterator.$a($f);fg.text=this.Uzb(Jg);fg.done=$f.ia(Eb.a.F9,!1);this.kf.bab&&$f.hasProperty(Eb.a.H5)&&(Jg=(Jg=$f.getValue(Eb.a.H5))?Kb.b(Jg||""):null,fg.usersByReactionType=Jg,sc.a.Rlh(fg.usersByReactionType),this.tuk(fg));this.oho($f,fg);fg.Rf||this.tho($f,fg);!this.kf.Qra||!this.cN||this.Ly&&this.Ly.id===fg.id||this.cN.fireEvent(10,{comment:fg,fOm:Lg})}}else this.Ac.isFeatureEnabled(122)&&
72===$f.type?this.NAi($f,!1,!1):this.nho($f)};this.o2k=()=>{const $f=this.MEd();for(this.$kc.sort((Jg,fg)=>{const Lg=Jg.ia(Eb.a.mL,null),Af=fg.ia(Eb.a.mL,null);if(!Lg&&Af)return-1;if(!Af&&Lg)return 1;Jg.hasProperty(Eb.a.Aza)&&fg.hasProperty(Eb.a.Aza)?(Jg=Jg.getValue(Eb.a.Aza),fg=fg.getValue(Eb.a.Aza),fg=Jg<fg):(Jg=new Date(Jg.getValue(Eb.a.tBc)),fg=new Date(fg.getValue(Eb.a.tBc)),fg=Jg<fg);return fg?-1:1});this.$kc.length;){const Jg=this.$kc[0];$f.zeb(Jg)&&($f.Ei(Jg),this.aj.addComment(this.uxd($f),
null),this.aj.mode=1);Array.removeAt(this.$kc,0)}if($f.Rb(1))for(;$f.vf(1););this.Ac.isFeatureEnabled(122)&&this.iSb.value.C_h();this.Jme&&(this.lIb(),this.Jme=!1)};this.IVk=$f=>{1===$f&&(Gb.WoncaApp.Eae.Ssh(),this.sSb.value.hkb(!0,"CommentInboundFailed"));this.EY.Zw(Ab.a.h_e,this.Cji)};this.Bta=$f=>{if(!this.kf.vq||$f.done)return!1;if($f.Sq===u.a.beingCreated)return!0;if($f.objectId){if(this.Y$l($f))return!1;if(!this.Zfm($f.objectId)||$f.Rf)return!0;for(let Jg of this.gT())if(Jg.Rf===$f.id)return!0}return!1};
pd.lJ=Xf;this.wgd=new lc.a(Lc.a.Rj());!this.kf.cyb&&this.kf.vq||Vb.a.HOa(this.Cvi);sf.gXb(this.hTc);Pe&&(Pe.zv(($f,Jg)=>{$f=Ie.o(this.sY,Jg.node.id);0<this.sY.length&&(!$f||$f===this.sY.length-1)&&(this.SPb=1,this.sY=[])}),Se.execute($f=>{this.cN=$f}),t.AFrameworkApplication.B2&&(t.AFrameworkApplication.Hf("AutoPopulateShareTUIComment;AutoPopulateShareTUICommentCf"),this.kf.Igk&&this.W0j()))}W0j(){y.a.instance.$b(new B.a(5,1,0,()=>{const Ub=this.Hc.Rc(7);Ub.Db(this.BFa);var uc=mb.App.xa.jb.Yc;uc&&
(uc=Rb.PageNavigator.instance.pT(uc),uc=Ua.GraphIterator.$a(uc),uc.Xd(),uc.Xd(),uc.Xd(),uc.Xd(),hc.a.instance.setSelection(Hb.SelectionFactory.DN(uc.currentNode,0,0)),uc=new G.a,uc.Wea("Get the conversation going by adding comments and using Share (above) to send a link to this doc. It\u2019s free! No subscription or sign-in necessary. \n"),this.txb(hc.a.instance.hb.kb,"Microsoft Word",uc),Ub.dispose(),ab.a("ShareTUICommentCreated"),da.ULS.sendTraceTag(520728590,327,50,"ShareTUICommentCreated"))}))}get RJ(){return this.aj}get lQe(){return this.Zg}get Cji(){return null!=
this.nng?this.nng:this.nng=Object.assign(new Ta.a,{A9:WoncaIntl.WoncaStrings.l_InboundingCommentFailed,Qja:1})}get IL(){return this.Hc}get Sy(){return this.yx.value}get zd(){return this.Sy.zd}get BFa(){return this.Gxe.value}get Cza(){return this.Bxe.value}get Cb(){return this.Wqb.value}get CX(){return this.Oa.lb("PresenceUserId")}get x1a(){return this.Oa.lb("PresenceProvider")}bZa(Ub,uc,Tc,qd){if(Tc&&this.Ly&&(!this.Ly||!this.Ly.Rf)){var re=!1;for(let Je of Tc)if(3===Je.type)switch(re=!0,Tc=Ie.n(this.sY,
Je.id),-1<Tc&&(this.sY[Tc].zac=uc.id),Ub.classList.add(Aa.a.hAd),qd){case 1:Ub.classList.add(Aa.a.A5e);break;case 0:Ub.classList.add(Aa.a.B5e)}re||Ub.classList.remove(Aa.a.hAd,Aa.a.B5e,Aa.a.A5e);this.$Qa.KDa(3)}}mcf(Ub=!1){return this.JMe.Gel(this.Zg,t.AFrameworkApplication.ya.mode,uc=>!this.kf.GKb||!Ub||this.Bta(uc))}Sbf(Ub){return this.JMe.nkl(this.aj.model.gT(),t.AFrameworkApplication.ya.mode,Ub)}Hgf(Ub){if(!Ub||!Ub.Rf)return Ub;Ub=Ub.Rf;for(let uc=0;uc<this.Zg.length;uc++)if(this.Zg[uc].id===
Ub)return this.Zg[uc];return null}vIk(){const Ub=[];if(this.Ac.isFeatureEnabled(122)){var uc=this.iSb.value;for(let Tc of uc.C_h())(uc=this.oLh(Tc))&&Ub.push(uc)}return Ub}U0l(Ub){if(!this.qRa)throw F.a.invalidOperation("UpdateContent must have been called before this.");for(let uc=0;uc<this.qRa.length;uc++)if(this.qRa[uc].id===Ub)return uc;return-1}Z7h(){const Ub=new nb.a;for(let Tc of this.Zg)if(Tc.objectId&&Tc.NLa){var uc=n.a.Of(Tc.objectId);if((uc=this.zd.Eb(uc))&&uc.hasProperty(Eb.a.iE))if(uc=
uc.getValue(Eb.a.iE).toString(),Ub.xb(uc)){const qd=Ub.J(uc).CommentId;this.pqj(qd,Tc,uc)}else Ub.add(uc,new K(Tc.id,Tc.done))}this.i$c=Ub}pqj(Ub,uc,Tc){Ub!==uc.NLa?(da.ULS.sendTraceTag(42866777,327,10,"Multiple comments contains the same DurableId [{0}], GuardId [{1}], GuardId of existing entry: {2}",Tc,uc.NLa,Ub),this.JM.logKpiFailure(Zf.a.Qvd,"MultipleCommentsWithSameDurableId",{isInternal:!0},{name:Zf.a.uBc,isInternal:!0})):da.ULS.sendTraceTag(554297428,327,15,"Duplicate entry of same comment with DurableId [{0}], GuardId [{1}]",
Tc,uc.NLa)}oLh(Ub){const uc=this.IOg.value;var Tc=this.iSb.value;const qd=Tc.S3b(Ub);if(void 0===qd||null===qd)return da.ULS.sendTraceTag(592234717,3003,50,"GenerateTaskItemForTaskId was called with a taskId [{0}] that has no comment anchor id.",Ub),null;Tc=Tc.A_h(Ub);try{return uc.$Nk(Ub,qd.toString(),Tc,this.i$c)}catch(re){return da.ULS.sendTraceTag(42856716,3003,10,"CreateTaskItemFromHistoryRecords Failed due to [{0}]",re.message),null}}oOh(Ub=!1,uc=!1){const Tc=new k.a,qd=uc?Ie.j():new Set;this.xya.keys.forEach(re=>
{qd.has(re)||Ub&&this.xya.J(re)||Tc.add(re);return!0});return Tc}XGd(){if(!this.Zg)return 0;let Ub=0;for(let uc of this.Zg)uc.Rf||Ub++;return Ub}FNc(Ub){var uc,Tc;return(null===(Tc=null===(uc=this.Ly)||void 0===uc?void 0:uc.Hy)||void 0===Tc?void 0:Tc.draftId)===Ub}O1j(Ub){var uc;if(Ub.Sq===u.a.beingCreated){if(this.aj.mode=2,this.D7a=Ub,this.Cb.hb){var Tc=this.Cb.hb.kb;if(Tc&&Tc.Qa){if(ma.SelectionEditor.Qm(Tc)){var qd=ma.SelectionEditor.X1(Tc.Qa,!1);qd&&(this.Cb.setSelection(qd),Tc=qd)}for(qd=0;qd<
Tc.length;qd++){var re=Tc.J(qd).node;if(!Ga.ParagraphReader.nc(re)||!(-1!==Tc.J(qd).cpBegin&&-1!==Tc.J(qd).cpEnd||-1!==Tc.J(qd).hl&&-1!==Tc.J(qd).ut))continue;var Je=-1===Tc.J(qd).cpBegin?Tc.J(qd).hl:Tc.J(qd).cpBegin;const Jf=-1===Tc.J(qd).cpEnd?Tc.J(qd).ut:Tc.J(qd).cpEnd,Ig=n.a.create();this.Ns.o9b(re,new Fa.a(3,Je,Jf,Ig));this.sY.push(new Te(re.id,Ig));this.t2j(null===(uc=Ub.Hy)||void 0===uc?void 0:uc.draftId,re,Je,Tc)}}}}else this.EQf(Ub);Tc=({index:uc}=this.Obe(Ub)).returnValue;qd=null;if(!Ub.Rf){re=
this.oOh();Ub.Sq!==u.a.beingCreated&&(qd=this.zIl(Ub),re.remove(Ub.objectId));re=({index:Je}=this.Szl(qd,re)).returnValue;uc=-1<Je?Je:uc;Je=0;if(re)for(;uc<this.Zg.length&&this.Zg[uc].Rf;)uc++;if(!re&&this.kf.vq&&Ub.Sq===u.a.beingCreated)for(re=0;re<uc;re++)this.Zg[re].Rf||this.Zg[re].done||Je++;this.q3n(Ub,Je)}Tc&&(Array.insert(this.Zg,uc,Ub),this.kf.Qra&&this.cN&&Ub.Sq!==u.a.beingCreated&&this.cN.fireEvent(11,{comment:Ub}),this.R1j(Ub,qd))}t2j(Ub,uc,Tc,qd){this.kf.contentNavigationApiEnabled&&Ub&&
uc&&qd&&this.Huc.VOe({contentId:Ub,containerContentType:0,c7:{Ed:Tc,aM:uc.vn}},{selection:qd})}R1j(Ub,uc){if(this.kf.contentNavigationApiEnabled&&Ub&&!Ub.Rf&&Ub.Sq!==u.a.beingCreated){var Tc=this.zd.Eb(Ub.objectId);if(Tc){var qd=Ie.k(Tc,n.a.nil);qd=this.zd.Eb(qd);Tc=td.a.Ssa(qd,Tc.id,!1);(null===Tc||void 0===Tc?0:Tc.Ob)&&(null===Tc||void 0===Tc?0:Tc.paragraph)?this.Huc.VOe({contentId:Ub.id,containerContentType:0,c7:{Ed:Tc.Ob.cp,aM:Tc.paragraph.vn}},{selection:uc}):da.ULS.sendTraceTag(520717896,327,
10,`commentStartRangeObject Valid: ${!!Tc},
        containingProperties Valid: ${!(null===Tc||void 0===Tc||!Tc.Ob)},
        paragraph valid: ${!(null===Tc||void 0===Tc||!Tc.paragraph)};
        Failed to add to ReviewSuggestionModel`)}}}Rra(Ub){super.Rra(Ub);this.p8c.add(Ub.id)}dun(Ub,uc){this.kf.contentNavigationApiEnabled&&this.Huc.cun(Ub,uc)}q3n(Ub,uc){this.kf.vq&&Ub.Sq===u.a.beingCreated&&Ub.Hy&&this.VJe.Z(Ub.Hy.draftId,uc)}qMl(Ub){return this.VJe.J(Ub)}qNi(Ub){this.VJe.remove(Ub)}Fvl(Ub){let uc=0,Tc=0;for(let qd=0;qd<this.Zg.length;qd++){if(this.Zg[qd].id===Ub.id){Tc=qd;break}this.Zg[qd].Rf||this.Zg[qd].done||uc++}return{returnValue:Tc,s8n:uc}}Bhf(Ub){var uc=null,Tc=this.zd.Eb(Ub);
Ub=td.a.h$(Tc,this.zd,!0);Tc=td.a.h$(Tc,this.zd,!1);Ub&&Tc&&(uc=Hb.SelectionFactory.xe(Ub.Ob.paragraph,Ub.Ob.cp),uc=Hb.SelectionFactory.XC(uc,ib.a.Uc(Tc.Ob.paragraph,Tc.Ob.cp)));Ub&&Tc||this.JM.logKpiFailure(Zf.a.Qvd,"ParaNodeNotConnected",{isIntentional:!1,isInternal:!0});return uc}zIl(Ub){Ub=n.a.Of(Ub.objectId);return this.Bhf(Ub)}lSf(Ub,uc){var Tc=this.zd.Eb(Ub);if(Tc){var qd=this.zd.Eb(Ie.k(Tc));Tc=this.zd.Eb(Ie.h(Tc));if(qd===Tc)for(Tc=0;Tc<qd.qa.length&&!qd.qa.J(Tc).Xco(Ub,uc);Tc++);}}Szl(Ub,
uc){let Tc=-1;var qd=null;Ub||(Ub=this.Cb.hb?this.Cb.hb.kb:null);if(!Ub||!Ub.Qa)return{returnValue:null,index:Tc};const re=this.SWh(Ub.Qa);if(!re)return{returnValue:null,index:Tc};var Je=td.a.Xwl(re.iterator.currentNode,Ub.Qa.cpBegin,this.kf.vq,uc);Je&&(qd=this.uZ(Je.Qj.toString()),Je=Array.indexOf(this.Zg,qd),qd=0<=Je?qd:null,Tc=0<=Je?Je+1:Tc);qd||(Ub=this.mOh(re,Ub.Qa,this.kf.vq,uc),qd=0<=Ub?this.Zg[Ub]:null,Tc=0<=Ub?Ub:Tc);return{returnValue:qd,index:Tc}}hml(Ub=null){var uc=null;uc=this.Cb.hb.kb;
return uc&&uc.Qa?this.isl(uc.Qa,this.kf.vq,Ub):null}SWh(Ub){const uc=new Ua.GraphIterator;uc.set(Ub.node);return uc.qo()?ob.a.Kr(uc,uc.origin):null}isl(Ub,uc,Tc=null){const qd=this.SWh(Ub);Ub=this.mOh(qd,Ub,uc,Tc);return-1<Ub?this.Zg[Ub]:null}mOh(Ub,uc,Tc,qd=null){let re=-1;if(Ub)for(uc=uc.cpBegin;-1===re&&Ub.moveNext();)Ga.ParagraphReader.zh(Ub.iterator)&&((uc=td.a.DHc(Ub.iterator.currentNode,uc,Tc,qd))&&(re=Array.indexOf(this.Zg,this.uZ(uc.Qj.toString()))),uc=0);return re}Yai(Ub){const uc=Ub.toString();
return this.xya.xb(uc)&&this.xya.J(uc)||this.dsc.contains(Ub)&&this.zd.kta(Ub)&&this.zd.Eb(Ub).ia(Eb.a.F9,!1)}nYi(Ub,uc=!1){if(Ub=this.EHc(Ub))Ub.fsf=!uc}Csf(Ub){return this.xya.xb(Ub.toString())||this.dsc.contains(Ub)&&this.zd.kta(Ub)&&!this.zd.Eb(Ub).ia(Eb.a.mL,null)}EQf(Ub){!Ub.objectId||Ub.Rf||this.xya.xb(Ub.objectId)||this.xya.add(Ub.objectId,Ub.done)}deleteComment(Ub){Ub&&!Ub.Rf&&(this.kf.vq&&Ub.Sq!==u.a.beingCreated?this.xya.remove(Ub.objectId):Ub.Sq===u.a.beingCreated&&this.ffj());this.p8c.remove(Ub.id);
return super.deleteComment(Ub)}xdf(Ub){return Ub&&Ub.hasProperty(Eb.a.iE)?Ub.Og(Eb.a.iE).toString():""}EHc(Ub){if(!Ub)return null;if(this.kf.qcb)return this.GB(Ub);for(let uc of this.Zg){const Tc=this.zd.Eb(n.a.Of(uc.objectId));if(this.xdf(Tc)===Ub.toString())return Ub=Tc.Og(Eb.a.JG),this.GB(Ub)}return null}APf(Ub,uc=!1){if(Ub&&td.a.SNd(Ub)&&this.Ac.isFeatureEnabled(122)){const Tc=this.xdf(Ub);if(""!==Tc){if(uc){let qd;if(this.i$c&&({value:qd}=this.i$c.Dc(Tc,qd)).returnValue&&qd.ResolveState===Ub.ia(Eb.a.F9,
!1))return}(Ub=this.Rob.J(Number.parseInvariant(Tc)))&&this.Cnd.add(Ub)}}}ndn(Ub){const uc=this.kcf(Ub);let Tc=!1;uc.U9d&&uc.IAd||(this.dsc.add(Ub.id),Tc=!0,this.xwi(Ub));return Tc}xwi(Ub){O.a.n1(t.AFrameworkApplication.uc,()=>{this.aGf(Ub);this.dsc.remove(Ub.id);this.dsc.count||(this.lIb(),this.RJ.uio())},"DelayLoadCommentNodeIntoModel")}aGf(Ub){if(!this.aj&&(da.ULS.sendTraceTag(525379406,327,10,"Comment Manager Not initialized"),this.k8c<this.lzj)){this.k8c+=1;this.xwi(Ub);da.ULS.sendTraceTag(525378784,
327,50,`Comment Node add Retry attempt ${this.k8c}`);return}const uc=this.MEd();uc.Ei(Ub);if(uc.bD()){let Tc;try{Tc=this.uxd(uc)}catch(qd){da.ULS.lM(512553930,327,10,qd,"create comment from comment node failed")}if(!Tc){da.ULS.sendTraceTag(512553929,327,15,`CommentNode Failed to add: ${null===Ub||void 0===Ub?void 0:Ub.id}`);return}this.aj.addComment(Tc,null);2!==this.aj.mode&&3!==this.aj.mode&&(this.aj.mode=1);this.APf(Ub);this.HMm(Tc)}else this.$kc.push(Ub);this.k4.xna("OnCommentNodeAdded",{commentNode:Ub})}HMm(Ub){this.kf.vq&&
!this.tj.mn&&this.RJ.Uz&&Ub.Rf&&this.RJ.Uz.id===Ub.Rf&&this.RJ.notify(String.format(Box4Intl.Box4Strings.L_CommentReplyAdded,Ub.author),!1)}kcf(Ub){const uc=new le;uc.j1c=Ie.k(Ub,n.a.nil);uc.bFc=Ie.h(Ub,n.a.nil);Ub=uc.j1c.equals(n.a.nil);const Tc=uc.bFc.equals(n.a.nil);Ub||(uc.zza=this.zd.Eb(uc.j1c),uc.U9d=!!uc.zza&&uc.zza.isConnected);Tc||(uc.VJa=this.zd.Eb(uc.bFc),uc.IAd=!!uc.VJa&&uc.VJa.isConnected);return uc}aEh(Ub,uc){const Tc=this.U0l(Ub);-1!==Tc&&Array.removeAt(this.qRa,Tc);uc||((Ub=this.oLh(Ub))?
this.qRa.push(Ub):da.ULS.sendTraceTag(42870813,3003,10,"GenerateTaskItemForTaskId returned null"))}n2k(){for(let Ub of this.Cnd)this.aEh(Ub,!1);this.Cnd.clear();for(let Ub of this.vJe)this.aEh(Ub,!0);this.vJe.clear()}Obe(Ub){var uc=this.Zg.length,Tc=!1;if(Ub.Rf){var qd=(Tc=this.GB(Ub.Rf))&&Tc.objectId?this.zd.Eb(n.a.Of(Tc.objectId)):null;qd=!!qd&&qd.hasProperty(Eb.a.Aza);uc=Array.indexOf(this.Zg,Tc);Tc=0>uc;for(uc+=1;uc<this.Zg.length&&this.Zg[uc].Rf===Ub.Rf&&this.Zg[uc]!==this.Ly&&!(qd&&Ub.date<
this.Zg[uc].date);)uc++}return{returnValue:!Tc,index:uc}}QYl(){const Ub=new $c(this.lho,this.lIb),uc=mb.App.Xj.al;uc.Se(40).lp(Object(Bb.a)(Ub,Ub.$Ak,"commentPropertyChanged"));uc.Se(12).lp(Object(Bb.a)(Ub,Ub.lBk,"commentTextChanged"));this.Ac.isFeatureEnabled(122)&&uc.Se(72).lp(Object(Bb.a)(Ub,Ub.O6n,"taskPropertyChanged"));fb.GraphTransactionManager.instance.Rna(Ub,3)}tuk(Ub){if(Ub&&this.Qke.has(Ub.id)){var uc=Ub.usersByReactionType[1];for(let Tc=0;uc&&Tc<uc.length;Tc++)if(uc[Tc].UserId===this.CX)return;
da.ULS.sendTraceTag(542765345,327,15,`Like by current user on Comment ${Ub.objectId} removed by inbound changes`)}}tho(Ub,uc){this.tyk(uc);const Tc=this.kf.vq;Tc&&this.IVl(uc)?(this.XRk(uc),this.APf(Ub),this.rlo(uc)):Tc||this.APf(Ub,!0)}nho(Ub){let uc=new Ua.GraphIterator;uc.set(Ub);uc.Bb(40);uc.kd(40);if(uc.currentNode){if(Ub=this.uZ(uc.currentNode.id.toString())){let Tc={done:Ub.done,text:Ub.text};Ub.text=this.Uzb(uc);!this.kf.Qra||!this.cN||this.Ly&&this.Ly.id===Ub.id||this.cN.fireEvent(10,{comment:Ub,
fOm:Tc})}}else da.ULS.sendTraceTag(592738053,327,15,"UpdateComment Unexpected Node Type: "+Mb.a[Ub.type])}rlo(Ub){if(!this.tj.mn){var uc=new jc.a;this.M8f(Ub,uc);0<uc.count&&tc.b(uc)}}XRk(Ub){const uc=new B.a(0,1,0,()=>{this.mho(Ub)},137,void 0,!0);t.AFrameworkApplication.uc.$b(uc)}tyk(Ub){var uc;null!==(uc=this.Ly)&&void 0!==uc&&uc.Hy&&this.Ly.Hy.sessionType!==H.a.metadata&&(uc=this.Ly,Ub.Rf||!Ub.done||uc.Rf!==Ub.id&&uc.id!==Ub.id||(da.ULS.sendTraceTag(592188699,327,15,"Draft comment lost on parent resolve, DraftType: {0}",
uc.Sq),this.JM.logKpiFailure(Zf.a.Vvd,"DraftCommentLostOnParentResolve",{isIntentional:!1,isInternal:!0},{name:Zf.a.ZXe,isIntentional:!1,isInternal:!0,isSessionEndingError:!1}),uc.Sq===u.a.beingCreated?(this.aj.clearSelection(),this.deleteComment(uc),this.selectComment(Ub)):uc.Sq===u.a.beingEdited&&(uc.Sq=u.a.normal,uc.iPa=I.a.succeeded,this.aj.zVe())))}oho(Ub,uc){var Tc;const qd=null===(Tc=uc.Hy)||void 0===Tc?void 0:Tc.draftId;if(this.kf.qcb){if(Ub=Ub.getValue(Eb.a.iE).toString(),uc.id!==Ub){if(!uc.Rf)for(Tc=
Array.indexOf(this.Zg,uc)+1;Tc<this.Zg.length&&this.Zg[Tc].Rf===uc.id;Tc++)this.Zg[Tc].Rf=Ub;da.ULS.sendTraceTag(555044877,327,50,"durable Id updated.");uc.id=Ub;this.Jmc.has(Ub)&&this.Jmc.delete(Ub)}}else if(Ub=Ub.getValue(Eb.a.JG),uc.id!==Ub){if(!uc.Rf)for(Tc=Array.indexOf(this.Zg,uc)+1;Tc<this.Zg.length&&this.Zg[Tc].Rf===uc.id;Tc++)this.Zg[Tc].Rf=Ub;uc.id=Ub}qd&&this.dun(qd,uc.id)}IVl(Ub){return this.xya.xb(Ub.objectId)&&this.xya.J(Ub.objectId)!==Ub.done}mho(Ub){this.xya.Z(Ub.objectId,Ub.done);
if(Ub.done)if(this.RJ.phc(Ub),this.tj.mn)this.RJ.CTc(Ub,!0);else{var uc=new B.a(0,1,0,()=>{this.RJ.CTc(Ub,!0,!1);this.mkd.remove(Ub.id)},139);this.mkd.add(Ub.id,uc);t.AFrameworkApplication.uc.$b(uc);this.zy&&Ub.id===(void 0===this.zy.Rf||null===this.zy.Rf?this.zy.id:this.zy.Rf)&&this.RJ.clearSelection()}else this.RJ.phc(Ub),uc=null,({value:uc}=this.mkd.Dc(Ub.id)).returnValue?(t.AFrameworkApplication.uc.We(uc),this.mkd.remove(Ub.id)):this.RJ.CTc(Ub,!1)}vyi(){this.K2l();this.I2l();t.AFrameworkApplication.K.$("IsDocumentOwner")||
v.a.instance.Za("Common.ISystemInitiatedFeedback").execute(Ub=>{Ub.logActivity("ShowTUIForCommentAwareness",null)})}I2l(){this.kf.mLb&&this.Z7h();this.kf.mLb&&(this.qRa=this.vIk(),Zc.a.HOa(this.NAi))}K2l(){!this.kf.cyb&&this.kf.vq&&Vb.a.HOa(this.Cvi);this.QYl();this.PYl()}PYl(){const Ub=new md(this.o2k),uc=mb.App.Xj.al;uc.Se(39).lp(Object(Bb.a)(Ub,Ub.Qoh,"commentContainerPropertyChanged"));this.Ac.isFeatureEnabled(122)&&uc.Se(71).lp(Object(Bb.a)(Ub,Ub.Qoh,"commentContainerPropertyChanged"));fb.GraphTransactionManager.instance.Rna(Ub,
3)}uZ(Ub){for(let uc=0;uc<this.Zg.length;uc++){const Tc=this.Zg[uc];if(Tc.objectId===Ub)return Tc}return null}L5j(Ub){if(Ub)for(let uc of Ub)uc&&this.wgd.add(uc)}Gwk(){this.wgd.clear()}PNe(Ub,uc){Array.insert(this.Zg,uc,Ub);this.EQf(Ub);this.pwm(Ub);uc=this.oFd(Ub);this.wgd.contains(uc)&&(Ub.fsf=!0,this.wgd.remove(uc))}pwm(Ub){da.ULS.sendTraceTag(539800645,327,50,`Comment added to Model. ${Ie.a(Ub)} `)}uxd(Ub){40!==Ub.Qe&&da.ULS.sendTraceTag(594363294,327,15,"[CreateCommentForNode] Iterator is not at commentNode");
const uc=Ub.currentNode;var Tc=uc.getValue(Eb.a.sZb);const qd=uc.getValue(Eb.a.JG),re=uc.getValue(Eb.a.iE).toString(),Je=uc.getValue(Eb.a.tBc);let Jf=null,Ig=null;this.Ac.Vq(15);if(this.kf.bab&&uc.hasProperty(Eb.a.H5)){var pb=uc.getValue(Eb.a.H5);Jf=pb?Kb.b(pb||""):null;sc.a.Rlh(Jf)}uc.hasProperty(Eb.a.Aza)&&(Ig=uc.getValue(Eb.a.Aza));let Lb=null,Ic=null;uc.hasProperty(Eb.a.Fvd)&&uc.hasProperty(Eb.a.sBc)&&(Lb=uc.getValue(Eb.a.Fvd),Ic=uc.getValue(Eb.a.sBc));pb=Ie.k(uc,n.a.nil).toString();const Ad=
Ie.h(uc,n.a.nil).toString(),oe=uc.ia(Eb.a.F9,!1),gf=uc.ia(Eb.a.mL,null),Oe=uc.ia(Eb.a.Heb,!1),Sg=this.Uzb(Ub);Tc=new J.Comment(this.kf.qcb?re:qd,qd,Tc,Ig||new Date(Je),this.kf.qcb?this.Pke.vql(gf):gf,oe,Sg,J.Comment.QCi,Oe,Ic,Lb,Jf);Tc.Hyc=pb;Tc.Gyc=Ad;Tc.objectId=uc.id.toString();Tc.xKa=re;this.K7g(re,qd);Ub.kd(39);return Tc}K7g(Ub,uc){(!Ub||Number.parseInvariant(Ub)>=td.a.Xpi)&&da.ULS.sendTraceTag(544022547,327,10,`Durable Id is invalid ${Ub}`);uc||da.ULS.sendTraceTag(544022548,327,10,`Guard Id is invalid ${uc}`);
try{this.Pke.L1j(Ub,uc)}catch(Tc){"DuplicateDurableId"===Tc.message?da.ULS.sendTraceTag(544511521,327,10,`Duplicate Durable Id: ${Ub} with Guard Id: ${uc}`):"DuplicateGuardId"===Tc.message?da.ULS.sendTraceTag(544511522,327,10,`Duplicate GuardId: ${uc} with Durable Id: ${Ub}`):da.ULS.sendTraceTag(544022549,327,10,`Unkown Error when adding to CommentIds map: ${Tc}`)}}Uzb(Ub){if(40!==Ub.Qe)return da.ULS.sendTraceTag(594379426,327,15,"Trying to get text from node of type: {0}",Ub.Qe),this.Vkc.E5f([]);
let uc=Ub.Qe+":";const Tc=Ub.Jp();0<Tc&&(Ub.Xd(),uc+=Ub.Qe+":");const qd=Array(Tc);for(let re=0;re<Tc;re++){Ub.Xd();uc+=Ub.Qe+":";const Je=Ub.currentNode;Je.NCb=!0;qd[re]=Je;Je.qa||da.ULS.sendTraceTag(594363293,327,15,"[GetCommentText_Crash] "+uc);!Je.qa&&this.kf.cFn&&(t.AFrameworkApplication.Hl("Microsoft.Office.Web.SessionSettings.IWacWordSendErrorReportOnCommentInboundCrashSettings"),this.xp());Ub.mc();Ub.xj();uc+=re<Tc-1?":"+Ub.Qe+":":":"}return this.Vkc.E5f(qd)}xp(){if(Gb.WoncaApp.Eae){var Ub=
new lb.a(!0,WoncaIntl.WoncaStrings.l_InboundingCommentErrorReportTitle,WoncaIntl.WoncaStrings.l_InboundingCommentErrorReportDescription,WoncaIntl.WoncaStrings.l_InboundingCommentErrorReportPrivacyStatement);Ub.Fd=1;Ub.Ve(1,WoncaIntl.WoncaStrings.l_SendErrorReport);Ub.Ve(0,WoncaIntl.WoncaStrings.l_NoThanks);Ub.tU(1);Ub.jy(Ab.a.h_e,CommonUIStrings.l_DefaultDialogTitle,WoncaIntl.WoncaStrings.l_InboundingCommentFailed,this.IVk,!1)}else this.EY.Zw(Ab.a.h_e,this.Cji)}oFd(Ub){if(!Ub||!Ub.objectId)return"";
Ub=n.a.Of(Ub.objectId);Ub=this.zd.Eb(Ub);return this.xdf(Ub)}BDl(Ub){return this.oFd(Ub.Rf?this.GB(Ub.Rf):Ub)}$in(Ub,uc){if(this.Ac.isFeatureEnabled(122))if(this.kf.removePersonalInformation)da.ULS.sendTraceTag(595128897,3003,50,"RecordTaskChanges no ops because filter PII flag on"),this.lIb();else{this.HUa.TB(zb.a.UZf);var Tc=null===uc||void 0===uc?void 0:uc.taskId,qd=!Tc;qd?this.HUa.logKpiUsage(Hc.a.rae,0):this.HUa.logKpiUsage(Hc.a.sae,0);try{const pb=this.iSb.value,Lb=this.oFd(Ub);if(""===Lb)this.GTd(qd,
"FailedDurableIdForComment");else{var re=this.BDl(Ub);if(""===re)this.GTd(qd,"FailedDurableIdForParentComment");else if(qd&&Ub.Hy.sessionType!==H.a.create&&Ub.Hy.sessionType!==H.a.reply)da.ULS.sendTraceTag(42856725,3003,10,"Unexpected create task for drafting session type [{0}]",Ub.Hy.sessionType),this.HUa.logKpiFailure(Hc.a.rae,"FailedTaskCreateInvalidSessionType");else{var Je=null;Ub.Hy.sessionType!==H.a.metadata&&(Je=Lb);var Jf=this.IOg.value;var Ig=L.a.mf(Ub.text)?Jf.bLh(Je,uc,qd):Jf.bLh(Je,uc,
qd,Ub.text[0]);0<Ig.length?qd?(pb.xbb(Number.parseInvariant(re),Ig)||this.HUa.logKpiFailure(Hc.a.rae,"TaskCreateFailed"),this.lIb()):(this.HUa.logKpiUsage(Hc.a.sae,0),pb.nck(Tc,Ig)||this.HUa.logKpiFailure(Hc.a.sae,"TaskEngagementFailed")):this.GTd(qd,"HistoryRecordsLengthZero")}}}catch(pb){this.GTd(qd,"RecordTaskChangesFailed")}}}GTd(Ub,uc){const Tc={name:Hc.a.H6n,isInternal:!0};Ub?this.HUa.logKpiFailure(Hc.a.rae,uc,Tc):this.HUa.logKpiFailure(Hc.a.sae,uc,Tc)}wqd(Ub,uc){if(this.kf.bab&&Ub){var Tc=
t.AFrameworkApplication.userName,qd=uc.toString();Ub.usersByReactionType||(Ub.usersByReactionType={});var re=Ub.usersByReactionType[qd];Tc=new E(this.CX,this.x1a,Tc);Tc.DateUtc=new Date;re?re.push(Tc):Ub.usersByReactionType[qd]=[Tc];da.ULS.sendTraceTag(572014993,327,50,"Reaction type {0} added to {1} with Object Id: {2} ",uc,Ub.Rf?"reply":"parent",Ub.objectId);qd=[Ub];this.JM.TB(Yd.a.aBk,{succeeded:!0,customData:{reactionType:P[uc]}});this.bXc(qd,T.addReaction);this.Qke.add(Ub.id)}}y3d(Ub,uc){if(this.kf.bab&&
Ub&&Ub.usersByReactionType){var Tc=Ub.usersByReactionType[uc.toString()];if(Tc&&Tc.length){for(let qd=0;qd<Tc.length;qd++)if(Tc[qd].UserId===this.CX){Array.removeAt(Tc,qd);break}da.ULS.sendTraceTag(572014994,327,50,"Reaction type {0} removed from {1} with Object Id: {2} ",uc,Ub.Rf?"reply":"parent",Ub.objectId);Tc=[Ub];this.JM.TB(Yd.a.bBk,{succeeded:!0,customData:{reactionType:P[uc]}});this.Qke.delete(Ub.id);this.bXc(Tc,T.removeReaction)}}}bXc(Ub,uc){const Tc=this.Hc.Rc(15);Tc.Db(this.BFa);this.Sy.AF.y9(3);
switch(uc){case T.deleteComment:for(uc=0;uc<Ub.length;uc++){var qd=Ub[uc];if(qd.Sq===u.a.beingCreated)this.kf.contentNavigationApiEnabled&&this.Huc.remove(qd.Hy.draftId),this.RJ.p8f();else{var re=n.a.Of(qd.objectId);(re=this.zd.Eb(re))&&td.a.Zyd(re,this.zd);da.ULS.sendTraceTag(39364559,327,50,`Deleting Comment: [CommentObjectId:${qd.objectId}]`);this.kf.Qra&&this.cN&&this.cN.fireEvent(7,{comment:qd});this.kf.contentNavigationApiEnabled&&this.Huc.remove(qd.id)}}break;case T.addComment:this.aj.mode=
1;Ub=Ub[0];Ub.date=new Date;uc=this.ILk(Ub);qd=uc.getValue(Eb.a.iE).toString();Ub.xKa=qd;this.kf.qcb&&this.Jmc.set(qd,Ub.id);qd=Ub.text;re=this.MEd();if(Ub.Rf){var Je=this.GB(Ub.Rf),Jf=this.zd.Eb(n.a.Of(Je.objectId));uc.setValue(Eb.a.mL,Jf.getValue(Eb.a.JG));this.addReply(uc,qd,this.zd,re,Jf);da.ULS.sendTraceTag(39364560,327,50,`Adding Reply: [ObjectId:${Ub.objectId}][ParentObjectId:${Je.objectId}]`)}else(Je=this.Cb.hb.kb)&&Je.Qa&&(ma.SelectionEditor.Qm(Je)&&(Jf=ma.SelectionEditor.X1(Je.Qa,!1))&&
(this.Cb.setSelection(Jf),Je=Jf,da.ULS.sendTraceTag(592569872,327,50,"[RecordChanges] Selection extended")),Ga.ParagraphReader.nc(Je.Qa.node)&&Ga.ParagraphReader.nc(Je.Tc.node)&&(this.Yub(uc,qd,re,Je),da.ULS.sendTraceTag(39364561,327,50,`Adding Comment: [ObjectId:${Ub.objectId}]`)));qd=uc.ia(Eb.a.JG,null);Ub.NLa=qd;Ub.iPa=I.a.sentToServer;Ub.iPa=I.a.succeeded;Ub.objectId=uc.id.toString();this.EQf(Ub);this.K7g(Ub.xKa,Ub.NLa);this.kf.Qra&&this.cN&&this.cN.fireEvent(11,{comment:Ub});break;case T.editComment:this.aj.mode=
1;Ub=Ub[0];uc=n.a.Of(Ub.objectId);uc=this.zd.Eb(uc);qd=Ub.NLa;Ub.NLa||(qd=uc.getValue(Eb.a.JG),da.ULS.sendTraceTag(554446870,327,15,`Missing GuardID for Comment with objectId ${Ub.objectId} while editing`),qd=this.kf.qcb?qd:Ub.id);this.ogj(uc,Ub.text,qd);da.ULS.sendTraceTag(39364562,327,50,`Editing Comment: [CommentObjectId:${Ub.objectId}]`);Ub.iPa=I.a.sentToServer;Ub.iPa=I.a.succeeded;this.kf.Qra&&this.cN&&this.cN.fireEvent(10,{comment:Ub,changeType:Ub.Rf?"replyEdited":"edited"});break;case T.addReaction:case T.removeReaction:uc=
Ub[0];Ub=n.a.Of(uc.objectId);Ub=this.zd.Eb(Ub);uc=this.kf.bab?(uc=uc.usersByReactionType)?Kb.c(uc):"":null;uc&&Ub.setValue(Eb.a.H5,uc);break;case T.done:case T.undone:for(uc=0;uc<Ub.length;uc++)qd=Ub[uc],re=n.a.Of(qd.objectId),this.zd.Eb(re).setValue(Eb.a.F9,qd.done),da.ULS.sendTraceTag(594124932,327,50,`${qd.done?"Resolved":"Re-opened"} Comment: [CommentObjectId:${qd.objectId}]`),this.kf.Qra&&this.cN&&this.cN.fireEvent(10,{comment:qd,changeType:qd.done?"resolved":"reopened"})}this.wm.EF();da.ULS.sendTraceTag(572281361,
327,50,"Disposing transaction, should raise context reload event");Tc.dispose()}MEd(){const Ub=new Ua.GraphIterator;Ub.set(this.Sy);this.Cza.G0a(Ub);return Ub}CZc(){return this.cWi(!0)}DZc(){return this.cWi(!1)}cWi(Ub){if(!this.Zg.length)return null;let uc=this.zy;do{if(uc){const Tc=this.kf.vq&&!this.tj.mn;uc=Ub?this.fsl(uc,Tc):this.gsl(uc,Tc)}else uc=Ub?this.Zg[0]:this.Zg[this.Zg.length-1];if(!uc)return null}while(uc.Rf&&""!==uc.Rf);this.selectComment(uc);return uc}ith(Ub,uc,Tc,qd,re){const Je=this.mzj.create(1074135127);
this.kf.removePersonalInformation&&(uc=CommonUIStrings.l_RemovedAuthorName,Tc=null);Je.setValue(Eb.a.commentId,U.a.RF());Je.setValue(Eb.a.iE,td.a.wdf());Je.setValue(Eb.a.WJa,t.AFrameworkApplication.userSessionId);Je.setValue(Eb.a.JG,Ub);Je.setValue(Eb.a.sZb,uc);Je.setValue(Eb.a.jph,uc);Je.setValue(Eb.a.tBc,Tc?X.a.R$e(Tc,"MM/dd/yyyy HH:mm:ss",X.a.dataCulture):"");Je.setValue(Eb.a.Aza,Tc);Je.setValue(Eb.a.F9,qd);this.kf.bab&&re&&(Ub=re?Kb.c(re):"",Je.setValue(Eb.a.H5,Ub));Je.setValue(Eb.a.sBc,this.CX);
Je.setValue(Eb.a.Fvd,this.x1a);return Je}ILk(Ub){var uc;const Tc=this.ith(Ub.id,Ub.author,Ub.date,Ub.done,null!==(uc=Ub.usersByReactionType)&&void 0!==uc?uc:{});Ub.Rf&&(this.kf.qcb?((uc=this.Pke.Mtl(Ub.Rf))||da.ULS.sendTraceTag(555008772,327,10,`Missing guardId for Comment With Durable Id ${Ub.Rf}`),Ub=uc):Ub=Ub.Rf,Tc.setValue(Eb.a.mL,Ub));return Tc}addReply(Ub,uc,Tc,qd,re){this.addComment(Ub,uc,qd);uc=pd.$8g(Ub,Tc,re,!0);Tc=pd.$8g(Ub,Tc,re,!1);uc&&Ie.u(Ub,uc.Ob.paragraph.id);Tc&&(Ie.t(Ub,Tc.Ob.paragraph.id),
Tc.Ob.paragraph.id||da.ULS.shipAssertTag(5564303,327,!1,"Comment node has no end anchor!"))}Yub(Ub,uc,Tc,qd){this.addComment(Ub,uc,Tc);let re,Je;({start:uc,end:re,startCp:Tc,endCp:Je,Ldh:Jf}=this.Pok());Jf&&(qd.Qa.node===uc&&(Tc=Tb.a.Adb(qd,!0)),qd.Tc.node===re&&(Je=Tb.a.Adb(qd,!1)));if(-1===Tc||-1===Je){this.mJg||0!==this.SPb||(this.JM.logKpiFailure(Zf.a.hYe,"DraftSelectionLost",{isInternal:!0},{name:Zf.a.uBc,isInternal:!0}),this.mJg=!0);uc=qd.Qa.node;Tc=Tb.a.Adb(qd,!0);re=qd.Tc.node;Je=Tb.a.Adb(qd,
!1);if(2<qd.length){var Jf=[];for(let Ig=0;Ig<qd.length;Ig++)Jf.push(qd.J(Ig).node.id);this.E8g(Ub,Jf)}da.ULS.sendTraceTag(51233603,327,50,"Intents invalid reason {0}",this.SPb)}else if(2<this.sY.length){Jf=[];for(qd=0;qd<this.sY.length;qd++)Jf.push(this.sY[qd].zac);this.E8g(Ub,Jf)}td.a.KWb(uc,Ub.id,Tc,!0);td.a.KWb(re,Ub.id,Je,!1);Ie.u(Ub,uc.id);Ie.t(Ub,re.id);this.ffj();re.id||da.ULS.shipAssertTag(5564304,327,!1,"Comment node has no end anchor!")}E8g(Ub,uc){if(!(2>=uc.length||!Ub||Ie.r(Ub))){this.tj.dU.add(Ub.id,
new lc.a(new rc.a));for(var Tc=n.a.Fp(uc[0],uc[1])?2:1,qd=uc.length-2;Tc<=qd;Tc++){const re=uc[Tc];this.tj.fx.xb(re)?this.tj.fx.J(re).bM||(this.tj.fx.J(re).bM=new lc.a(new rc.a)):this.tj.fx.add(re,new Rc.a(!0));this.tj.fx.J(re).jZa=!0;this.tj.fx.J(re).bM.add(Ub.id);this.tj.dU.J(Ub.id).add(re)}}}Pok(){let Ub=null,uc=-1,Tc=null;var qd=-1;let re=!1;if(!this.sY.length||2!==this.SPb)return{start:Ub,end:Tc,startCp:uc,endCp:qd,Ldh:re};Ub=this.zd.Eb(this.sY[0].zac);Tc=1===this.sY.length?Ub:this.zd.Eb(this.sY[this.sY.length-
1].zac);if(Ga.ParagraphReader.nc(Ub)&&Ga.ParagraphReader.nc(Tc)){qd=Jf=>3===Jf.type;let Je=this.Ns.vYa(Ub,3,qd);uc=0<Je.count?Je.J(0).begin:-1;Ub!==Tc&&(Je=this.Ns.vYa(Tc,3,qd));qd=0<Je.count?Je.J(0).end:-1;-1===uc&&null!=Ub&&(uc=Ub.qa.first.cp,re=!0,da.ULS.sendTraceTag(524862562,327,50,"Draft Anchor startCp was adjusted"));-1===qd&&null!=Tc&&(qd=Tc.qa.last.cp,re=!0,da.ULS.sendTraceTag(524862563,327,50,"Draft Anchor endCp was adjusted"))}this.SPb=-1===uc||-1===qd?0:2;return{start:Ub,end:Tc,startCp:uc,
endCp:qd,Ldh:re}}ffj(){for(let Ub of this.sY){const uc=this.zd.Eb(Ub.zac);Ga.ParagraphReader.nc(uc)&&this.Ns.ihc(uc,3)}this.sY=[];this.SPb=2}addComment(Ub,uc,Tc){Ub.anchor||(Tc.Sf(Ub,1),Tc.Ei(Ub),this.oYi(Ub,uc,Tc))}oYi(Ub,uc,Tc){let qd=0;var re=null;uc=this.Vkc.n9n(uc,Je=>{const Jf=new vb.a;Tc.Sf(Jf,1);Tc.Ei(Jf);Tc.Sf(Je,2);Tc.Ei(Je);Tc.mc();Tc.mc()});for(let Je=0;Je<uc.length;Je++)re=uc[Je],qd=re.getValue(Eb.a.Nc),pd.paragraphEditor.o4a(re),pd.lJ&&pd.lJ.DJa&&pd.lJ.kEa(ib.a.create(re));Ub.setValue(Eb.a.JG,
qd.toString());return re}Kfb(Ub,uc){return this.r9l(Ub,uc)}RVl(){return 0<this.sY.length}txb(Ub,uc,Tc){return Ub.Qa&&Ga.ParagraphReader.nc(Ub.Qa.node)&&Ga.ParagraphReader.nc(Ub.Tc.node)?(uc=this.ith(Ga.ParagraphReader.qT(Ub.Tc.node).toString(),uc?uc:t.AFrameworkApplication.userName,new Date,!1,{}),Tc||(Tc=new G.a,Tc.Wea("\n")),this.Yub(uc,[Tc.RHc()],this.MEd(),Ub),uc):null}As(Ub){return!this.JMe.I_f(this.EHc(Ub.getValue(Eb.a.iE)))}ogj(Ub,uc,Tc){const qd=new Ua.GraphIterator;for(qd.set(Ub);qd.Xd();)qd.Eg();
this.oYi(Ub,uc,qd).lh(Eb.a.Nc,Number.parseInvariant(Tc));Ub.setValue(Eb.a.JG,Tc);if(uc=this.uZ(Ub.id.toString()))uc.Vqh=!1;Ub.setValue(Eb.a.Heb,!1)}ngj(Ub,uc){this.ogj(Ub,[Sys.Serialization.JavaScriptSerializer.serialize(uc)],Ub.getValue(Eb.a.JG))}HF(Ub){Ub=this.zd.Eb(n.a.Of(Ub));return!!Ub&&Ub.ia(Eb.a.HF,!1)}VEi(Ub){Ub=this.zd.Eb(n.a.Of(Ub));return!!Ub&&Ub.ia(Eb.a.Eqh,!1)}Y$l(Ub){const uc=Ie.j();return Ub&&uc.has(Ub.objectId)}Zfm(Ub){const uc=this.zd.Eb(n.a.Of(Ub));return uc?this.V6b(uc):(da.ULS.sendTraceTag(562562755,
341,15,"CommentNode is null, commentObjectId: "+Ub),!1)}V6b(Ub){var uc=Ub.id,Tc=Ie.k(Ub),qd=Ie.h(Ub);if(!n.a.Fp(Tc,qd))return!1;Tc=Ub.Lc.Eb(Tc);if(!Tc)return!1;qd=({MAc:Ub}=this.wCc(Tc,uc,!0)).returnValue;var re=({MAc:uc}=this.wCc(Tc,uc,!1)).returnValue;if(-1===qd||-1===re)return!1;Tc=Tc.qa;qd=Tc.J(Ub);re=Tc.J(uc);if(!qd.hyperlink||!qd.hyperlink.GF||!re.wl)return!1;for(Ub+=1;Ub<uc;Ub++)if(qd=Tc.J(Ub),qd.hyperlink||qd.wl)return!1;return!0}Ikf(){return pd.aWl(this.Zg,Ub=>this.HF(Ub),Ub=>this.VEi(Ub))}wCc(Ub,
uc,Tc){let qd;for(qd=0;qd<Ub.qa.length;qd++){const re=Ub.qa.J(qd);if(re.Ff)for(let Je=0;Je<re.Ff.length;Je++){const Jf=re.Ff.J(Je);if(Jf.Qj.equals(uc)&&Jf.Pc===Tc)return{returnValue:re.cp,MAc:qd}}}return{returnValue:-1,MAc:qd}}syh(Ub){if(this.tj.dU.xb(Ub)){const uc=new jc.a;for(let Tc of this.tj.dU.J(Ub))this.Von(Tc,Ub,uc);this.tj.dU.remove(Ub);tc.b(uc)}}M8f(Ub,uc){if(Ub.objectId){Ub=n.a.Of(Ub.objectId);var Tc=this.zd.Eb(Ub);if(Tc){var qd=Ie.k(Tc,n.a.nil);Tc=Ie.h(Tc,n.a.nil);qd.equals(n.a.nil)||uc.add(this.zd.Eb(qd));
Tc.equals(n.a.nil)||uc.add(this.zd.Eb(Tc));if(this.tj.dU.xb(Ub))for(let re of this.tj.dU.J(Ub))uc.add(this.zd.Eb(re))}}}Von(Ub,uc,Tc){let qd;({value:qd}=this.tj.fx.Dc(Ub,qd));qd&&(qd.bM.remove(uc),qd.bM.count||(qd.jZa=!1,Tc.add(this.zd.Eb(Ub))))}static get paragraphEditor(){return null!=pd.kpg?pd.kpg:pd.kpg=v.a.instance.resolve("Box4.IParagraphEditor")}static getInstance(){return pd.Gl()}static Gl(){if(pd._instance)return pd._instance;const Ub=new Y.a(()=>(new Sa(!0,!0,!0)).wIk()),uc=v.a.instance;
pd._instance=new pd(new Y.a(()=>mb.App.xa.jb.Yc),new Y.a(()=>mb.App.xa.jb.Ic.rd),new Y.a(()=>xd.a.instance),new Ya.a,new vc,new Y.a(()=>hc.a.instance),uc.resolve("WordEditor.Comments.IWordEditorSharedCommentModelTranslator"),uc.resolve("WordEditor.Comments.ICommentFormatTranslator"),uc.resolve("Common.IAppSettingsManager"),uc.resolve("Box4.IFeatureHelper"),uc.resolve("Box4.Intent.IIntentRangeEditor"),new Y.a(()=>mb.App.F_),uc.resolve("Box4.IKickoutExecutor"),uc.ef("WordEditor.Tasks.ITaskActor"),Ub,
uc.resolve("WordEditor.Comments.CommentsSettings"),uc.resolve("Box4.IUndoManager"),uc.resolve("WordEditor.Comments.ICommentActionInTypingRecorder"),uc.resolve("WordEditor.Comments.CommentsState"),uc.resolve("WordEditor.Comments.WordCommentEventsActor"),uc.resolve("WordEditor.Comments.ICommentsUsageAndHealthLogger"),uc.resolve("WordEditor.Comments.ITasksUsageAndHealthLogger"),uc.resolve("WordEditor.ReviewSuggestionContent.IReviewSuggestionContentModel"),mb.App.Xj.al.Se(12),uc.resolve("Box4.ParagraphRenderEvents"),
uc.resolve("Box4.CatchUpActivity.IChangeIdEditor"),uc.Za("WordEditor.Extension.RichApiEventManager"));return pd._instance}static $8g(Ub,uc,Tc,qd){uc=td.a.h$(Tc,uc,qd);if(!uc)return null;uc=uc.Ob.Ff;return td.a.vqd(Ub.id,uc,uc.J(0).Vs,qd)}r9l(Ub,uc){if(mb.App.lostSession||(uc?!mb.App.As:!mb.App.As&&!mb.App.Bm)||1===Ub.mode||!Object(dc.a)(Fc.PageView,wb.InteractiveViewManager.instance.xd))return!1;Ub=this.Zhl();return!Ub||jb.a.instance.iZ(Ub)||jb.a.instance.Jta(Ub)||Ub.contextId===Zb.a.anchoredObject?
!1:!0}Zhl(){const Ub=wb.InteractiveViewManager.instance.xd;var uc=Ub.Cb.Rg;this.$$l()&&this.Ly&&eb.m(uc.node)&&(uc=Ua.GraphIterator.$a(uc.node),uc.Bb(12),uc=uc.ap(12),uc=Hb.SelectionFactory.lka(uc),Ub.Cb.setSelection(uc),uc=Ub.Cb.Rg);return uc}$$l(){var Ub;return null===(Ub=this.Oa)||void 0===Ub?void 0:Ub.getBooleanFeatureGate("Microsoft.Office.WordOnline.isCommentInLoopsBugFixEnabled",!1)}static aWl(Ub,uc,Tc){const qd=new jc.a,re=new jc.a,Je=new nb.a,Jf=new nb.a;for(let Lb of Ub){var Ig=Lb.id,pb=
Lb.objectId;Ub=Lb.done;const Ic=!!pb&&uc(pb);Ig&&(Ub&&qd.add(Ig),Ic&&re.add(Ig),pb&&Je.Z(Ig,pb));if(Ig=Lb.Rf)({value:pb}=Jf.Dc(Ig,0)).returnValue||(pb=0),Jf.Z(Ig,pb+1);if(!Ig&&!Ub&&!Ic)return!0}for(let Lb of re){if(qd.contains(Lb))continue;let Ic;if(({value:Ic}=Je.Dc(Lb,Ic)).returnValue&&Tc(Ic))return!0;let Ad;if(({value:Ad}=Jf.Dc(Lb,0)).returnValue&&0<Ad)return!0}return!1}cml(Ub){const uc=[];let Tc=this.Zg.findIndex(qd=>qd.id===Ub);if(-1<Tc)for(uc.push(this.Zg[Tc]);++Tc<this.Zg.length&&this.Zg[Tc].Rf===
Ub;)uc.push(this.Zg[Tc]);return uc}}pd._instance=null;pd.lJ=null;Object(l.a)(pd,"EditorCommentModel",e.a,[240,241,242])},1697:function(C,N,d){var l=d(79);C=d(0);var e=d(390),a=d(121),k=d(57),n=d(495),v=d(3),u=d(8),t=d(18),y=d(1580),B=d(1545);class G{constructor(da,ua,ra=!1){this.paragraphNode=da;this.role=ua;this.l6i=ra}}Object(C.a)(G,"DesignerReviewActionData",null,[]);class F{constructor(da,ua,ra){this.paragraphNode=da;this.Jq=ua;this.role=ra}}Object(C.a)(F,"TriageActionData",null,[]);class K extends F{constructor(da,
ua){super(da,0,ua)}}Object(C.a)(K,"RoleTriageActionData",F,[]);class O extends F{constructor(da,ua,ra){super(da,1,27);this.styleId=ua;this.R1=ra}}Object(C.a)(O,"PullQuoteTriageActionData",F,[]);class H extends F{constructor(da,ua){super(da,2,28);this.Lla=ua}}Object(C.a)(H,"ImageTriageActionData",F,[]);class I{constructor(da,ua){this.paragraphNode=da;this.aEb=ua}}Object(C.a)(I,"ViewOriginalActionData",null,[]);var J=d(144),L=d(1503),S=d(1642);class E{constructor(da,ua){this.currentNode=da;this.nextNode=
ua}}Object(C.a)(E,"ReviewNavigationArgs",null,[]);class P{constructor(da,ua){this.paragraphNode=da;this.isVisible=ua}}Object(C.a)(P,"ReviewVisibilityArgs",null,[]);class T{constructor(da){this.JTj=da}getSelectedOption(){return this.JTj}getSeparatorIndexes(){return[1]}}Object(C.a)(T,"DesignerPreviewData",null,[]);var U=d(996),X=d(1491),Y=d(1643);d.d(N,"a",function(){return ca});class ca extends X.a{constructor(da,ua,ra,qa,ka,la,Ha,wa,Ca,Ja,bb,ha){super();this.zc=da;this.Re=ua;this.jzd=ra;this.zfb=
qa;this.Sn=ka;this.SA=la;this.Acj=Ha;this.lm=wa;this.Mx=Ca;this.kzd=Ja;this.Wt=bb;this.raf=ha;this.m$a=null;this.Z6c=void 0;this.rle=0;this.g1=[U.a.Oyh]}get types(){return this.g1}get rWi(){return Box4Intl.Box4Strings.l_ShowDesignerReviewTooltipSelectOrPress}get sMf(){return 0}ZUn(da){return 3!==da.suggestion.Jq&&!this.Mx.isVisible&&(!this.rle||!da.zvb&&1===this.rle)}WX(da){var ua;if(!da.source||e.SessionStatusManager.instance.Sj)return!1;const ra=da.Rx;var qa=this.zfb.DIc(ra,1);if(!qa||!qa.count)return!1;
const ka=qa.J(0).intent;if(da.efc)return.5!=(null===ka||void 0===ka?void 0:ka.state)&&4!=(null===ka||void 0===ka?void 0:ka.state);const la=ra.node;if(0==(null===ka||void 0===ka?void 0:ka.state)&&(2==(null===ka||void 0===ka?void 0:ka.suggestion.Jq)||1==(null===ka||void 0===ka?void 0:ka.suggestion.Jq)))return ka.zvb(),this.zfb.ihc(la,1),this.SA.lJi(new S.a(la,1)),!0;if(1==da.source&&27==(null===ka||void 0===ka?void 0:ka.mfb)&&(.5==(null===ka||void 0===ka?void 0:ka.state)||4==(null===ka||void 0===ka?
void 0:ka.state)))return!1;qa=this.Mx.isVisible?this.jzd.dVk(la):new Y.a(0,1);let Ha;const wa=this.hwl(null===(ua=null===ka||void 0===ka?void 0:ka.suggestion)||void 0===ua?void 0:ua.Jq);ua=this.Jn.c3a(ra,{id:"Intent-"+U.a.Oyh,suggestionGroups:[{type:wa,id:wa,title:ka.description,snippet:this.R7m(this.Sn.plainText(ra.node)),snippetFormatting:[],supportedActions:this.Xbf(null===ka||void 0===ka?void 0:ka.suggestion,!0),suggestions:({qEn:Ha}=this.Mvh(la)).returnValue,previewData:Ha?new T(Ha):null,isContentPending:!1}],
setSize:qa.count,positionInSet:qa.index},this,da.XMa,!1,()=>{var Ca;this.SA.mJi(new P(la,!0));this.Mx.isVisible||3===(null===(Ca=null===ka||void 0===ka?void 0:ka.suggestion)||void 0===Ca?void 0:Ca.Jq)||this.rle++},()=>{this.SA.mJi(new P(la,!1))},null,!1,Ca=>{const Ja=this.ZUn(ka);Ca.showDesignerButton=!this.Mx.isVisible;Ca.shouldSkipTwoStepReview=!0;Ca.isFormattingSuggestion=0==ka.suggestion.Jq;Ca.isMultiParagraphSuggestion=1<ka.oP.length;Ca.shouldShowProactivePrompt=Ja;Ca.proactivePromptHintType=
Ja?n.e.HideFromReviewCardAndRibbon:n.e.None});k.c(t.a.GZm,ua,void 0,void 0,30);return ua}executeAction(da,ua){var ra,qa,ka,la,Ha;if(!da||!ua)return!1;const wa=this.lm.wA(ua);u.ULS.sendTraceTag(541446529,3016,50,"Action: {0}; Role: {1}; Pane: {2};",da.actionType,null===wa||void 0===wa?void 0:wa.role,this.Mx.isVisible);const Ca=this.kzd.sT(ua);try{switch(da.actionType){case n.b.Accepted:let Ja=this.zc.Xb(t.a.Rpd,2,new G(ua,null===wa||void 0===wa?void 0:wa.role,!0));this.C8f(Ma=>{Ma.supportedActions=
this.Xbf(null===Ca||void 0===Ca?void 0:Ca.suggestion,!1)});return this.Mx.isVisible&&32===Ja?this.iDf(ua):32===Ja;case n.b.Rejected:let bb=this.zc.Xb(t.a.j3d,2,new G(ua,null===wa||void 0===wa?void 0:wa.role,!0));2===(null===Ca||void 0===Ca?void 0:Ca.suggestion.Jq)||Object(L.e)(null===Ca||void 0===Ca?void 0:Ca.suggestion)||this.G3c(ua,!1);2===(null===Ca||void 0===Ca?void 0:Ca.suggestion.Jq)&&this.Jn.dismiss();return this.Mx.isVisible&&32===bb?this.iDf(ua):32===bb;case n.b.Next:case n.b.Previous:return!this.Mx.isVisible||
this.iDf(ua,da.actionType===n.b.Previous);case n.b.Apply:const ha=null===(ra=da.suggestion)||void 0===ra?void 0:ra.contentData;let ia;switch(null===ha||void 0===ha?void 0:ha.Jq){case 0:ia=new K(ua,ha.role);break;case 1:case 3:const Ma=ha.G1a;u.ULS.sendTraceTag(541446530,3016,50,"Changing PullQuote style: {0}",{["suggestionId"]:null===(qa=null===Ca||void 0===Ca?void 0:Ca.suggestion)||void 0===qa?void 0:qa.id,["newStyleId"]:Ma});Ca.suggestion.G1a=Ma;ia=new O(ua,Ma,a.a.create());break;case 2:ia=new H(ua,
ha.Lla);break;default:return u.ULS.shipAssertTag(527459665,3016,!1,String.format("DesignerSuggestionType: {0}",ha.Jq)),!1}this.Jn.focus();let va=this.zc.Xb(t.a.changeDesignerRole,2,ia);this.G3c(ua,!1);return 32===va;case n.b.AcceptAll:return 32===this.zc.Xb(v.a.C$a,2,new y.a(2));case n.b.RejectAll:return 32===this.zc.processAction(t.a.AXc,2);case n.b.SnoozeAll:return 32===this.zc.processAction(t.a.designerSnoozeContextualSuggestions,2);case n.b.Undo:let Ka=this.zc.Xb(t.a.fFa,2,new G(ua,null===wa||
void 0===wa?void 0:wa.role));this.G3c(ua,!0);return 32===Ka;case n.b.OpenDesignerPane:return 32===this.zc.Xb(t.a.rQa,2,new B.a(6));case n.b.ViewOriginal:const Xa={aEb:da.descriptorData.isViewingOriginal,nYf:da.descriptorData.setIsViewingOriginal};if(void 0==(null===Xa||void 0===Xa?void 0:Xa.aEb)||void 0==(null===Xa||void 0===Xa?void 0:Xa.nYf))return u.ULS.shipAssertTag(538789889,3016,!1,String.format("isViewingOriginal: {0}; setIsViewingOriginal: {1}",null===Xa||void 0===Xa?void 0:Xa.aEb,null===Xa||
void 0===Xa?void 0:Xa.nYf)),!1;this.Jn.focus();let xa=this.zc.Xb(t.a.E3e,2,new I(ua,Xa.aEb));Xa.nYf(!Xa.aEb);this.G3c(ua,!0);return 32===xa;case n.b.GiveFeedback:switch(null===(ka=null===Ca||void 0===Ca?void 0:Ca.suggestion)||void 0===ka?void 0:ka.Jq){case 0:return this.Wt.invokeUserFeedback(J.a.Ktj),!0;case 1:case 3:return this.Wt.invokeUserFeedback(J.a.Qtj),!0;case 2:return this.Wt.invokeUserFeedback(J.a.Mtj),!0;default:return u.ULS.shipAssertTag(537658138,3016,!1,String.format("DesignerSuggestionType: {0}",
null===(la=null===Ca||void 0===Ca?void 0:Ca.suggestion)||void 0===la?void 0:la.Jq)),!1}case n.b.ShowMore:switch(null===(Ha=null===Ca||void 0===Ca?void 0:Ca.suggestion)||void 0===Ha?void 0:Ha.Jq){case 2:u.ULS.sendTraceTag(527210449,3016,50,"User clicked show more images"),Ca.suggestion.H0l(),this.G3c(ua,!0,!0)}return!0;default:return!1}}catch(Ja){return u.ULS.shipAssertTag(572027277,3016,!1,String.format("{0} {1}",Ja.message,Ja.stack)),!1}}iDf(da,ua=!1){let ra=this.jzd.f3b(da,ua)||this.jzd.f3b(da,
!ua);this.SA.ten(new E(da,ra,!ua));return!ra||this.jzd.Wsi(this,ra)}ktl(da){switch(da.Jq){case 0:case 1:case 3:return Object.assign(Object.assign({},n.h),{font:da.font,cssColor:da.color,fontSize:da.fontSize,fontWeight:da.bold?n.d.Bold:n.d.Normal,italic:da.italic,underlineType:da.underline?n.f.Single:n.f.None,backgroundImg:da.backgroundImg});case 2:break;default:u.ULS.shipAssertTag(527569927,3016,!1,`${da.Jq}`)}}hvl(da){if(2===da.Jq)return{src:da.imageUrl,width:0,height:0,imageAltText:da.altText}}Mvh(da){var ua=
null;let ra=null;if(this.m$a=this.Acj.DBl(da)){ra=Array(this.m$a.options.length);for(da=0;da<this.m$a.options.length;da++)ua=this.m$a.options[da],ra[da]={type:"DesignerTriageItem",id:String.format("DesignerTriageItem {0}",da),title:ua.title,supportedActions:[n.b.Apply],contentData:ua,image:this.hvl(ua),titleFormatting:[this.ktl(ua)]};ua=(null===ra||void 0===ra?0:ra.length)?ra[this.m$a.selectedIndex]:void 0}return{returnValue:ra,qEn:ua}}C8f(da){this.Jn.definition?this.Jn.definition.suggestionGroups?
1===this.Jn.definition.suggestionGroups.length&&(da(this.Jn.definition.suggestionGroups[0]),this.Jn.definition=this.Jn.definition):u.ULS.shipAssertTag(573687426,3016,!1):u.ULS.shipAssertTag(573687425,3016,!1)}G3c(da,ua,ra=!1){const qa=this.kzd.sT(da);this.C8f(ka=>{ka.supportedActions=this.Xbf(null===qa||void 0===qa?void 0:qa.suggestion,ua);if(this.m$a){if(ra){var la=this.Mvh(da).returnValue;ka.suggestions=la}la=this.Acj.fIl(this.m$a.options,da);ka.previewData=new T(ka.suggestions[la])}})}Xbf(da,ua){const ra=
[];ua?(ra.push(n.b.Accepted),ra.push(n.b.Rejected),0==(null===da||void 0===da?void 0:da.Jq)&&ra.push(n.b.ViewOriginal)):(ra.push(n.b.Next),ra.push(n.b.Undo));this.Mx.isVisible||(this.Re.Fam()&&this.Mek(qa=>{qa&&this.C8f(ka=>ka.supportedActions.push(n.b.GiveFeedback))})&&ra.push(n.b.GiveFeedback),this.Re.rbm()&&ra.push(n.b.OpenDesignerPane),ra.push(n.b.SnoozeAll));0===(null===da||void 0===da?void 0:da.Jq)&&ra.push(n.b.AcceptAll);ra.push(n.b.RejectAll);(null===da||void 0===da?0:da.Z3h())&&ra.push(n.b.ShowMore);
return ra}R7m(da){const ua=da.split(" ",10);return 10>ua.length?da:ua.join(" ")+"\u2026"}static wbm(da){return da===U.a.Pyh||da===U.a.Ryh||da===U.a.Vyh}hwl(da){return 2===da?U.a.Ryh:1===da||3===da?U.a.Vyh:U.a.Pyh}Mek(da){void 0===this.Z6c&&this.raf.execute(ua=>Object(l.__awaiter)(this,void 0,void 0,function*(){this.Z6c=yield ua.isFeatureEnabled(J.a.Ksi,!1);da(this.Z6c)}));return!!this.Z6c}}Object(C.a)(ca,"DesignerIntentProvider",X.a,[])},1705:function(C,N,d){var l=d(79);C=d(0);var e=d(11),a=d(108),
k=d(49),n=d(34),v=d(25),u=d(495),t=d(1058),y=d(1491),B=d(2),G=d(781),F=d(15),K=d(68),O=d(594),H=d(16),I=d(18),J=d(8),L=d(436),S=d(843),E=d(437),P=d(862),T=d(996),U=d(1E3),X=d(36);class Y{constructor(){this.dBe=void 0}onKeyPressed(ra){return this.dBe?this.dBe(ra):!1}setKeyPressHandler(ra){this.dBe=ra}}var ca;(function(ra){ra[ra.pnj=0]="ArrowDown";ra[ra.qnj=1]="ArrowUp";ra[ra.gwo=2]="ArrowLeft";ra[ra.hwo=3]="ArrowRight";ra[ra.End=4]="End";ra[ra.Yoj=5]="Enter";ra[ra.pxo=6]="Escape";ra[ra.vpj=7]="Home";
ra[ra.Dzo=8]="Space";ra[ra.Tab=9]="Tab"})(ca||(ca={}));var da=d(803);d.d(N,"a",function(){return ua});class ua extends y.a{constructor(ra,qa,ka,la,Ha,wa,Ca,Ja,bb,ha,ia){super();this.ga=ra;this.Jf=qa;this.Vd=ka;this.tC=la;this.ib=Ha;this.tG=wa;this.HJ=Ca;this.Z3=Ja;this.Drc=bb;this.hS=ia;this.vVj=0;this.bHe=!1;this.z1g=0;this.lMj=10;this.hWj=18E5;this.yVj=3500;this.lmd="ContextIQSignalId";this.DHe=0;this.HKg=!0;this.isPaneOpen=!1;this.Cka=()=>{this.Drc.reset();this.cwm()};ha&&ha.execute(va=>this.CTa=
va);this.Cfd=new U.a;this.mNg=new Y;this.getPersonImageUrl=this.getPersonImageUrl.bind(this);this.mLh(!0);this.dfl()}dfl(){const ra=B.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.InsertFluidComponent",!1),qa=Object.assign(new S.a,{parentPath:["Signal",P.ClientConfigSignal.getTypeName()],items:[Object.assign(new L.a,{id:"ClientConfigSignal",body:Object.assign(new P.ClientConfigSignal,{timestamp:Date.now(),clientConfig:Object.assign(new P.ClientConfig,{ecc:Object.assign(new P.EccConfig,
{enabled:!0,entities:[Object.assign(new P.EccEntityConfig,{entityType:P.EntityType.People,enabled:!0,queryPrefix:["@"],customProps:[Object.assign(new P.CustomProp,{name:"Filter",value:'{"And":[{"Term":{"PeopleType":"Person"}},{"Term":{"PeopleSubtype":"OrganizationUser"}}]}'})]}),Object.assign(new P.EccEntityConfig,{entityType:P.EntityType.File,enabled:!0,queryPrefix:["@"]}),Object.assign(new P.EccEntityConfig,{entityType:P.EntityType.Loop,enabled:ra,queryPrefix:["@"]})],bestMatch:Object.assign(new P.BestMatchConfig,
{enabled:!1}),scopes:Object.assign(new P.ScopeConfig,{enabled:!1})}),flag:Object.assign(new P.FlagConfig,{enabled:!1}),nudge:Object.assign(new P.NudgeConfig,{enabled:!1}),prediction:Object.assign(new P.PredictionConfig,{enabled:!1})})})})]});this.HJ.En().then(()=>{this.Z3.getAugLoopRuntimeManager().submitOperation(Object.assign(new E.a,{operation:qa}));J.ULS.sendTraceTag(520104021,3034,50,"Submitted ClientConfigSignal Operation.")})}mLh(ra){const qa=Object.assign(new S.a,{parentPath:["Signal",P.StartupSignal.getTypeName()],
items:[Object.assign(new L.a,{id:"SessionStartupSignal",body:Object.assign(new P.StartupSignal,{timestamp:Date.now()})})]});this.HJ.En().then(()=>{ra&&this.QA();this.Z3.getAugLoopRuntimeManager().submitOperation(Object.assign(new E.a,{operation:qa}));J.ULS.sendTraceTag(521412674,3034,50,"Submitted StartupSignal Operation.")});B.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ResendStartupSignalIsEnabled",!1)&&this.z1g<this.lMj&&(this.z1g++,setTimeout(()=>{this.mLh(!1)},
this.hWj))}QA(){B.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ContextIQUseEccResultAnnotation",!1)?(this.Jf.mb(this,P.EccResultAnnotation.getTypeName()),J.ULS.sendTraceTag(521412673,3034,50,"Registered for EccResultAnnotations.")):(this.Jf.mb(this,P.UserInitiatedResultAnnotation.getTypeName()),J.ULS.sendTraceTag(521412672,3034,50,"Registered for UserInitiatedResultAnnotations."))}Ogo(ra,qa,ka,la,Ha){const wa=void 0===qa?!1:this.DHe>qa;this.Jn.bO&&!wa&&(ra=this.ifl(ra),
la&&ra.suggestionGroups&&0<ra.suggestionGroups.length&&(ra.suggestionGroups[0].previewData=la.substring(Ha+1,la.length)),this.Jn.definition=ra,qa&&(this.DHe=qa));qa?(la=Date.now(),ka=[Object.assign(new X.a,{name:this.lmd,string:ka}),Object.assign(new X.a,{name:"ContextIQMenuOpen",bool:this.Jn.bO}),Object.assign(new X.a,{name:"ContextIQStaleAnnotation",bool:wa})],this.Cfd.fRc("ContextIQUserInitUserPerceivedLatency",la-qa,1,!0,void 0,ka)):J.ULS.sendTraceTag(537966025,3034,15,"SignalGenerationTime is undefined, can not determine if this annotation is stale or generate User Perceived Latency telemetry.")}ifl(ra){if(ra){var qa=
[];if(ra.annotationType===P.UserInitiatedResultAnnotation.getTypeName()){var ka=ra.content;if(!ka)return;for(var la of ka.results)qa=qa.concat(la.results)}else{la=ra.content;if(!la)return;for(ka of la.entityResults)qa=qa.concat(ka.entities)}if(la=this.HKg)this.HKg=!1;return Object.assign(Object.assign({},u.g),{id:T.a.yWa,suggestionGroups:[{type:T.a.yWa,isContentPending:!1,contentData:qa,isFirstInvoke:la}]})}}getPersonImageUrl(ra,qa){return Object(l.__awaiter)(this,void 0,void 0,function*(){var ka=
new G.a(ra,"O365",qa,ra);if(this.CTa&&this.CTa.getPersonaIconPropertiesArray&&(ka=yield this.CTa.getPersonaIconPropertiesArray([ka]),0<ka.length&&ka[0].authorImageURL))return ka[0].authorImageURL})}static x5c(){return!F.a.u7b&&!F.a.s2&&B.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ContextIQAtMentionEntryPointIsEnabled",!1)}static get e3a(){return ua.xVj}fZn(ra){if(this.CTa){var qa=Object.assign(Object.assign({},u.g),{id:T.a.yWa,suggestionGroups:[{type:T.a.yWa,isContentPending:!0,
contentData:[]}]});var ka=!1;this.ga.b6(I.a.Y2a)&&(ka=!this.isPaneOpen);this.Jn.c3a(ra,qa,this,!0,!1,null,this.Cka,null,!1,la=>{la.shouldIgnoreFocusEvent=Ha=>this.bHe?!0:this.Jn.shouldIgnoreFocusEvent(Ha);la.getPersonImageUrl=this.getPersonImageUrl},ka,!1,this.mNg)}else J.ULS.sendTraceTag(539068165,3034,15,"PeopleAPI was not ready in time for showing a User Init Context IQ Card")}Qnh(){this.Jn.dismiss()}onKeyDown(ra){if(ra&&ra.Ib){switch(ra.Ib.keyCode){case K.a.xha:var qa=ca.pnj;break;case K.a.FK:qa=
ca.End;break;case K.a.es:qa=ca.Yoj;break;case K.a.R3:qa=ca.vpj;break;case K.a.mx:qa=ca.Tab;break;case K.a.U7:qa=ca.qnj}void 0!==qa&&(ra.Ib.stopPropagation(),ra.Ib.preventDefault(),this.mNg.onKeyPressed(qa))}}wI(ra,qa){if(ra&&ra.content&&qa===t.a.getTypeName()&&(ra.annotationType===P.UserInitiatedResultAnnotation.getTypeName()||ra.annotationType===P.EccResultAnnotation.getTypeName())){var ka=qa=void 0,la=void 0,Ha=0,wa=ra.parentPath.split("\\");if(wa&&6===wa.length)if(ka=wa[5],wa=Date.now(),ka in ua.e3a){clearTimeout(ua.e3a[ka].y5f);
qa=ua.e3a[ka].startTime;la=ua.e3a[ka].uZn;Ha=ua.e3a[ka].wsd;delete ua.e3a[ka];const Ca=[Object.assign(new X.a,{name:this.lmd,string:ka})];this.Cfd.fRc("ContextIQUserInitALLatency",wa-qa,1,!0,void 0,Ca)}else J.ULS.sendTraceTag(537962376,3034,15,"SignalId is not in the dictionary, can not generate AL Latency telemetry.");else J.ULS.sendTraceTag(537966026,3034,15,"Annotation's parent path is not the expected length of 6. Can not generate AL Latency telemetry.");this.Ogo(ra,qa,ka,la,Ha)}}get types(){return[T.a.yWa]}d8f(ra,
qa){this.Jn.bO&&this.Jn.d8f(ra,qa)}WX(){return!1}executeAction(ra,qa,ka,la){const Ha=Date.now();if(!qa)return!1;switch(ra.actionType){case u.b.Apply:this.mKd(ra.descriptorData,qa,ka,la);this.Qnh();break;case u.b.ClearSearch:this.bHe=!0;this.clearSearch(qa,ka,la,!1);this.Jn.bO&&(this.Z4i(),ra=e.ParagraphReader.text(qa).substring(0,ka+1),this.Haf(qa,ra,ka,Ha));this.bHe=!1;break;case u.b.Retry:this.Jn.bO&&(this.Z4i(),ra=e.ParagraphReader.text(qa).substring(0,la),this.Haf(qa,ra,ka,Ha));break;case u.b.OpenEditorPane:if(32!==
this.ga.processAction(I.a.Y2a,2))return J.ULS.sendTraceTag(520898381,3034,15,"Failed to launch the editor pane from contextual card.",ra.actionType),!1;break;default:return J.ULS.sendTraceTag(539849408,3034,15,"Failed to process action of type {0} since it is not known to us.",ra.actionType),!1}return!0}Haf(ra,qa,ka,la){var Ha,wa;const Ca=ka.toString(),Ja=ra.id.toString(),bb=Ja+"-"+Ca,ha=++this.vVj,ia=bb+"-"+ha;ra=(ra=a.FormattingReader.KFd(ra,ka,e.ParagraphReader.textLength(ra)))?a.FormattingReader.language(ra):
B.AFrameworkApplication.lcid;ra=null!==(wa=null===(Ha=O.a.pg(ra))||void 0===Ha?void 0:Ha.$$e)&&void 0!==wa?wa:"";const va=Object.assign(new S.a,{parentPath:["Signal",da.TextPredictorSignal.getTypeName(),Ja,Ca,bb],items:[Object.assign(new L.a,{id:ia,body:Object.assign(new da.TextPredictorSignal,{languageId:ra,startOfSentence:!0,text:qa,timestamp:Date.now(),userInitQuery:!0})})]});this.HJ.En().then(()=>{this.Z3.getAugLoopRuntimeManager().submitOperation(Object.assign(new E.a,{operation:va}));J.ULS.sendTraceTag(521412643,
3034,50,"Submitted Text Predictor Signal.");const Ka=[Object.assign(new X.a,{name:this.lmd,string:ia})];this.Cfd.fRc("ContextIQUserInitSignalGenerationLatency",Date.now()-la,1,!0,void 0,Ka)});Ha=setTimeout(()=>{this.aXn(ia)},this.yVj);ua.e3a[ia]={startTime:la,uZn:qa,wsd:ka,y5f:Ha}}Z4i(){let ra;ra=Object.assign(Object.assign({},u.g),{id:T.a.yWa,suggestionGroups:[{type:T.a.yWa,isContentPending:!0,contentData:[]}]});this.Jn.definition=ra}aXn(ra){if(ra in ua.e3a){var qa=ua.e3a[ra].startTime;qa=void 0===
qa?!1:this.DHe>qa;if(!qa&&this.Jn.bO){let ka;ka=Object.assign(Object.assign({},u.g),{id:T.a.yWa,suggestionGroups:[{type:T.a.yWa,isContentPending:!1,errorMessage:"No results received from AugLoop",contentData:[]}]});this.Jn.definition=ka}ra=[Object.assign(new X.a,{name:this.lmd,string:ra}),Object.assign(new X.a,{name:"ContextIQMenuOpen",bool:this.Jn.bO}),Object.assign(new X.a,{name:"ContextIQStaleSignal",bool:qa})];this.Cfd.fRc("ContextIQUserInitALTimeout",1,0,!0,void 0,ra)}}mKd(ra,qa,ka,la){const Ha=
ra.type;switch(Ha){case P.EntityType.File:this.t5l(ra,qa,ka,la);break;case P.EntityType.People:this.uco(ra,qa,ka,la);break;case P.EntityType.Loop:this.O5l(ra,qa,ka,la);break;default:J.ULS.sendTraceTag(539849409,3034,15,"Failed to process entity of type {0} since it is not known to us.",Ha)}}uco(ra,qa,ka,la){const Ha=ra.displayName,wa=ra.primaryEmailAddress,Ca=new G.a(wa,"O365",Ha,wa);this.CTa.checkUserAccess(Ca).then(Ja=>{Ja.UserCanWrite?(J.ULS.sendTraceTag(539100301,3034,50,"User has the correct permissions to be AtMentioned"),
this.tG.bof(qa,ka,la,Ha,wa)):this.Rdj(Ca,qa,ka,la)},()=>{J.ULS.sendTraceTag(539100302,3034,15,"Got back failed response from checking user access for AtMentioned User");this.Rdj(Ca,qa,ka,la)})}Rdj(ra,qa,ka,la){this.CTa.grantUsersAccess([ra]).then(Ha=>{let wa=!1;Ha.Details&&(wa=Ha.Details.Result[0].UserCanWrite);wa?(J.ULS.sendTraceTag(539100303,3034,50,"AtMentioned User has been granted access"),this.tG.bof(qa,ka,la,ra.DisplayName,ra.Email)):(J.ULS.sendTraceTag(539100304,3034,50,"AtMentioned user has been denied access"),
this.clearSearch(qa,ka,la,!0))},()=>{J.ULS.sendTraceTag(539100305,3034,15,"Failed Response from Attempt to grant access to AtMentioned user")})}t5l(ra,qa,ka,la){if(qa){var Ha=new k.GraphTransaction(15),wa=ra.fileName+" ";try{Ha.Db(qa);this.Vd.replaceTextRange(n.a.createTextRange(qa,ka,la),wa);const Ca=H.a.sLc(ra.url+"?web=1");this.tC.NG(n.a.createTextRange(qa,ka,ka+ra.fileName.length),Ca,!1,!1,!1);this.ib.setSelection(v.SelectionFactory.xe(qa,ka+wa.length))}finally{Ha&&Ha.dispose()}}else J.ULS.sendTraceTag(539849100,
3034,15,"Paragraph node is undefined/null.")}O5l(ra,qa,ka,la){if(qa){var Ha=new k.GraphTransaction(15);try{Ha.Db(qa);this.Vd.replaceTextRange(n.a.createTextRange(qa,ka,la),"");this.ib.setSelection(v.SelectionFactory.xe(qa,ka));const wa=ra.id;wa===T.a.QCm?this.ga.processAction(I.a.GMc,2):wa===T.a.PCm?this.ga.processAction(I.a.vMc,2):J.ULS.sendTraceTag(537458136,3034,15,"Trying to insert unsupported loop type.")}finally{Ha&&Ha.dispose()}}else J.ULS.sendTraceTag(537458135,3034,15,"Paragraph node is undefined/null.")}clearSearch(ra,
qa,ka,la){if(ra){var Ha=new k.GraphTransaction(15);la||(qa+=1);try{Ha.Db(ra),this.Vd.replaceTextRange(n.a.createTextRange(ra,qa,ka),""),this.ib.setSelection(v.SelectionFactory.xe(ra,qa))}finally{Ha&&Ha.dispose()}}else J.ULS.sendTraceTag(529413333,3034,15,"Paragraph node is undefined/null.")}cwm(){this.hS.execute(ra=>{ra.logActivity("CIQ_AtInvoke",null)})}}ua.xVj={};Object(C.a)(ua,"ContextIQIntentProvider",y.a,[250])},1706:function(C,N,d){C=d(0);var l=d(526),e=d(469),a=d(7),k=d(1452),n=d(1911),v=d(372),
u=d(8),t=d(120),y=d(1505);class B{constructor(H,I,J){this.isVisible=H;this.elements=I;this.content=J}}Object(C.a)(B,"TooltipVisibilityArgs",null,[]);var G;(function(H){H[H.consistency=0]="consistency";H[H.yJo=1]="pullQuote";H[H.ZLo=2]="suggestedImage";H[H.zJo=3]="pullQuoteMenu";H[H.nDo=4]="designerPaste"})(G||(G={}));Object(C.b)("DesignerSuggestionType",G);var F=d(144),K=d(1644);d.d(N,"a",function(){return O});class O extends k.a{constructor(H,I,J,L,S,E,P,T){super();this.jn=H;this.Ky=I;this.vxk=J;
this.Tri=L;this.Sn=S;this.SA=E;this.kH=P;this.Ic=T;this.Hra=this.ABa=null;this.onMouseEnter=U=>{U=U.yp;this.SA.EJi(new B(!0,[U.Azc],U.Z9n));if(U.lu&&0<U.lu.length){const X=this.kH.sT(U.lu[0]);X&&X.suggestion.Qxm()}return this.qZi(U)};this.Tma=U=>{this.SA.EJi(new B(!1));return this.Umh(U.yp)};this.S0a=U=>{if(O.FDb(U.yp,this.Hra))return!0;this.SA.uen(y.a.create(U.yp.lu[0]));return!0};this.iIf=(U,X)=>{X.data?X.data.isVisible?this.fIn(X.data.paragraphNode):this.gwk():u.ULS.shipAssertTag(573850384,3016,
!1)};this.SA.uPe(this.iIf)}HKn(H){H?(H=this.zef(H))&&this.qZi(H):u.ULS.shipAssertTag(589693324,3016,!1)}vwk(){this.Umh(this.ABa)}eKb(H){H=this.Sn.en(H.zb);return!!H&&this.kH.bPc(H)}oxb(H){const I=H.kwb(0,F.a.Jik,this.zoom),J=[];J.push(this.IWa(H.Y6,I,H.D4c[0].y-H.E$[0].y));return J}IWa(H,I,J){var L,S=H.Ig.ownerDocument;const E=l.a.createElement(S,e.a.div);E.className=F.a.Eik;E.style.left=I+"px";E.style.top=J+"px";I=l.a.createElement(S,e.a.div);I.className=F.a.Hik;S=l.a.createElement(S,e.a.div);S.className=
F.a.Fik;H=this.Sn.en(H.zb);J=this.kH.sT(H);if(null===(L=null===J||void 0===J?void 0:J.suggestion)||void 0===L?0:L.Jq)S.className+=String.format(" {0}",G[J.suggestion.Jq]);I.appendChild(S);E.appendChild(I);E.id=O.KMh(H);L=this.zef(H,E);1==L.Kik&&(S.className+=String.format(" {0}",F.a.Gik));this.Hra&&this.Hra.lu.includes(H)?(E.className+=String.format(" {0}",F.a.nTe),this.Hra=L):this.ABa&&this.ABa.lu.includes(H)&&(E.className+=String.format(" {0}",F.a.mTe),this.ABa=L);this.Tri(a.a.yQ,E,this.onMouseEnter,
L);this.Tri(a.a.oK,E,this.Tma,L);this.vxk(a.a.click,E,this.S0a,L);return E}fIn(H){if(H){var I=this.zef(H);I?(this.kH.sT(H)&&(H=Object.assign(new n.a,{action:0,type:3,DF:I,iO:this.Hra}),this.Ky.nH(H)),this.Hra=I,O.FDb(this.ABa,this.Hra)&&(this.ABa=null)):u.ULS.shipAssertTag(590112344,3016,!1)}else u.ULS.shipAssertTag(590112343,3016,!1)}gwk(){if(this.Hra){var H=Object.assign(new n.a,{action:1,type:3,DF:null,iO:this.Hra});this.Hra=null;this.Ky.nH(H)}}qZi(H){if(O.FDb(H,this.Hra)||O.FDb(H,this.ABa))return!0;
const I=Object.assign(new n.a,{action:2,type:3,DF:H,iO:this.ABa});this.ABa=H;this.Ky.nH(I);return!0}Umh(H){if(O.FDb(H,this.Hra))return!0;H=Object.assign(new n.a,{action:3,type:3,DF:null,iO:this.ABa});this.ABa=null;this.Ky.nH(H);return!0}zef(H,I){I=I?I:this.sjl(H);if(!I)return null;const J=this.kH.sT(H);return new K.a(0<(null===J||void 0===J?void 0:J.oP.length)?null===J||void 0===J?void 0:J.oP:[H],I,O.k0h(J),O.tjl(J))}static k0h(H){if(!H)return WordEditorIntl.WordEditorStrings.L_ReviewDesignerSuggestion;
switch(H.suggestion.Jq){case 0:return O.HNd(H.state)?WordEditorIntl.WordEditorStrings.L_ReviewUpdatedDesignerFormattingSuggestion:WordEditorIntl.WordEditorStrings.L_ReviewDesignerFormattingSuggestion;case 1:case 3:return O.HNd(H.state)?WordEditorIntl.WordEditorStrings.L_ReviewAddedDesignerPullQuoteSuggestion:WordEditorIntl.WordEditorStrings.L_ReviewDesignerPullQuoteSuggestion;case 2:return O.HNd(H.state)?WordEditorIntl.WordEditorStrings.L_ReviewAddedDesignerText2ImageSuggestion:WordEditorIntl.WordEditorStrings.L_ReviewDesignerText2ImageSuggestion;
default:return WordEditorIntl.WordEditorStrings.L_ReviewDesignerSuggestion}}static tjl(H){return H?O.HNd(H.state)?1:0:0}static HNd(H){return 0!==H&&.1!==H}sjl(H){var I=null,J=this.jn.fg(H);J.Bb(11)&&(J.mc(),J=J.currentNode.Ni(this.Ic.Tb))&&(H=String.format("#{0}",O.KMh(H)),I=J.htmlElement.querySelector(H),!I&&Object(t.a)(v.a,J)&&(I=(I=J.l9e())?I.querySelector(H):null));return I}static KMh(H){return String.format("p{0}{1}",H.id.nr,H.id.n)}static FDb(H,I){return!!I&&!!H&&H.Azc===I.Azc}}Object(C.a)(O,
"BlueDotActor",k.a,[528,495])},1708:function(C,N,d){C=d(0);var l=d(646);class e{constructor(k){this.YBa=k.kwl();this.pBb=k.tef("intCopy");this.f_d=k.jWh("intCopy");this.Bwb=k.bcf("intCopy");this.pab=k.Bbf("intCopy")}static sF(){return e.mr()}static mr(){return new e(l.a.instance)}}Object(C.a)(e,"InternalCopyUsageHelper",null,[]);d.d(N,"a",function(){return a});class a{constructor(k,n,v){this.PV=e.sF();this.Iud=null;this.dKb=this.nde=!1;this.ZDg=null;this.source=k;this.target=n;this.pKf=v}get wha(){return this.PV}get xo(){return this.ZDg}set xo(k){this.ZDg=
k}}Object(C.a)(a,"InternalCopyArguments",null,[])},1709:function(C,N,d){C=d(0);var l=d(1423);class e extends l.a{constructor(){super();this.LastAutoSaveErrorReported=0;this.LastAutoSaveCorrelation=null;this.MeritsErrorReport=!1;this.LocalCobaltMachineId=this.LocalCobaltSessionId=null;this.WaciiEnabledRequests=0;this.ShowMergePrompt=!1;this.PartMergeInfo=0}}Object(C.a)(e,"ALocalCobaltServerResponse",l.a,[]);d.d(N,"a",function(){return a});class a extends e{constructor(){super();this.RootCellId=null;
this.AvailableFileAccess=0;this.PageHtml=this.ClientKnowledge=this.LatestRevisionId=this.RevisionList=null;this.PinRevisionForAugLoopResponse=this.ContentBytes=0;this.RevisionIdPinnedForAugLoop=null;this.ScheduledShutdownTime=0;this.LastSavedToHostRevisionSequenceNumber=-1}}Object(C.a)(a,"GetChangesResponse",e,[])},1710:function(C,N,d){C=d(0);var l=d(67);class e extends Sys.EventArgs{constructor(){super()}}Object(C.a)(e,"UploadEventArgs",Sys.EventArgs,[]);d.d(N,"a",function(){return a});class a{constructor(){this.sa=
new l.a}q9f(k){this.sa.raiseEvent("UploadStarted",new e(k,-1))}yhc(k,n){this.sa.raiseEvent("UploadComplete",new e(k,n))}static get instance(){return null!=a.Nmg?a.Nmg:a.Nmg=new a}}Object(C.a)(a,"Box4UploadNotifier",null,[611])},1742:function(C,N,d){d.d(N,"a",function(){return l});C=d(0);class l{constructor(){this.authority=this.userId=this.upn=null;this.authorityType=0;this.tenantId=null;this.supportsAuthToken=this.isAnonymous=!1;this.authority=this.userId=this.upn="";this.authorityType=0;this.tenantId=
"";this.isAnonymous=!0;this.supportsAuthToken=!1}static uMh(e){switch(e){case 0:return"external";case 2:return"aad";case 1:return"msa";default:return"external"}}}Object(C.a)(l,"WopiAuthContext",null,[727])},1743:function(C,N,d){d.d(N,"a",function(){return l});C=d(0);class l{}l.oZm="OneDriveWOPI";Object(C.a)(l,"HostApplicationType",null,[])},1744:function(C,N,d){d.d(N,"a",function(){return l});C=d(0);class l{}l.zmj="WAC_Word";l.iLc=null;Object(C.a)(l,"AddinHostApp",null,[])},1746:function(C,N){Object.defineProperty(N,
"__esModule",{value:!0});N.RoleType=N.ErrorCode=void 0;(function(d){d[d.Success=0]="Success";d[d.DocumentTooLarge=1]="DocumentTooLarge"})(N.ErrorCode||(N.ErrorCode={}));(function(d){d[d.Unknown=0]="Unknown";d[d.Title=1]="Title";d[d.Subtitle=2]="Subtitle";d[d.Heading1=3]="Heading1";d[d.Heading2=4]="Heading2";d[d.Heading3=5]="Heading3";d[d.Heading4=6]="Heading4";d[d.Heading5=7]="Heading5";d[d.Heading6=8]="Heading6";d[d.Heading7=9]="Heading7";d[d.Heading8=10]="Heading8";d[d.Heading9=11]="Heading9";d[d.ListItem=
12]="ListItem";d[d.BodyText=13]="BodyText";d[d.ListHeader=14]="ListHeader";d[d.Caption=15]="Caption";d[d.CoverPageElement=16]="CoverPageElement"})(N.RoleType||(N.RoleType={}))},1747:function(C,N,d){Object.defineProperty(N,"__esModule",{value:!0});N.NavigationPaneInputClassifierSignal=N.DesignerInputClassifierSignal=N.DocumentRoleDetectionAnnotation=N.RoleDetectionAnnotation=N.RoleDetectionSettings=N.RoleDetectionCustomMetadata=N.BasePartialDocumentLevelAnnotation=N.WordNavPaneInputTargetDocumentClassificationAnnotation=
N.WordDesignerInputTargetDocumentClassificationAnnotation=N.BaseInputTargetDocumentClassificationAnnotation=void 0;const l=d(203);class e{constructor(F){l.SchemaObject.assign(e,this,F)}get metadata(){return this.M_}set metadata(F){this.M_=F}static getTypeName(){return"AugLoop_RoleDetection_BaseInputTargetDocumentClassificationAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(F){return l.SchemaObject.matchesTypesFor(F,[e.getTypeName()])}}N.BaseInputTargetDocumentClassificationAnnotation=
e;e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()};class a{constructor(F){l.SchemaObject.assign(a,this,F)}get metadata(){return this.M_}set metadata(F){this.M_=F}static getTypeName(){return"AugLoop_RoleDetection_WordDesignerInputTargetDocumentClassificationAnnotation"}static getBaseTypes(){return["AugLoop_RoleDetection_BaseInputTargetDocumentClassificationAnnotation","AugLoop_Core_Annotation"]}static typeGuard(F){return l.SchemaObject.matchesTypesFor(F,[a.getTypeName()])}}N.WordDesignerInputTargetDocumentClassificationAnnotation=
a;a.H_={T_:a.getTypeName(),B_:a.getBaseTypes()};class k{constructor(F){l.SchemaObject.assign(k,this,F)}get metadata(){return this.M_}set metadata(F){this.M_=F}static getTypeName(){return"AugLoop_RoleDetection_WordNavPaneInputTargetDocumentClassificationAnnotation"}static getBaseTypes(){return["AugLoop_RoleDetection_BaseInputTargetDocumentClassificationAnnotation","AugLoop_Core_Annotation"]}static typeGuard(F){return l.SchemaObject.matchesTypesFor(F,[k.getTypeName()])}}N.WordNavPaneInputTargetDocumentClassificationAnnotation=
k;k.H_={T_:k.getTypeName(),B_:k.getBaseTypes()};class n{constructor(F){l.SchemaObject.assign(n,this,F)}get metadata(){return this.M_}set metadata(F){this.M_=F}static getTypeName(){return"AugLoop_RoleDetection_BasePartialDocumentLevelAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(F){return l.SchemaObject.matchesTypesFor(F,[n.getTypeName()])}}N.BasePartialDocumentLevelAnnotation=n;n.H_={T_:n.getTypeName(),B_:n.getBaseTypes()};class v{constructor(F){l.SchemaObject.assign(v,
this,F)}static getTypeName(){return"AugLoop_RoleDetection_RoleDetectionCustomMetadata"}static getBaseTypes(){return[]}static typeGuard(F){return l.SchemaObject.matchesTypesFor(F,[v.getTypeName()])}}N.RoleDetectionCustomMetadata=v;v.H_={T_:v.getTypeName(),B_:v.getBaseTypes()};class u{constructor(F){l.SchemaObject.assign(u,this,F)}static getTypeName(){return"AugLoop_RoleDetection_RoleDetectionSettings"}static getBaseTypes(){return[]}static typeGuard(F){return l.SchemaObject.matchesTypesFor(F,[u.getTypeName()])}}
N.RoleDetectionSettings=u;u.H_={T_:u.getTypeName(),B_:u.getBaseTypes()};class t{constructor(F){l.SchemaObject.assign(t,this,F)}get metadata(){return this.M_}set metadata(F){this.M_=F}static getTypeName(){return"AugLoop_RoleDetection_RoleDetectionAnnotation"}static getBaseTypes(){return["AugLoop_Text_RangeAnnotation","AugLoop_Core_Annotation"]}static typeGuard(F){return l.SchemaObject.matchesTypesFor(F,[t.getTypeName()])}}N.RoleDetectionAnnotation=t;t.H_={T_:t.getTypeName(),B_:t.getBaseTypes()};class y{constructor(F){l.SchemaObject.assign(y,
this,F)}get metadata(){return this.M_}set metadata(F){this.M_=F}static getTypeName(){return"AugLoop_RoleDetection_DocumentRoleDetectionAnnotation"}static getBaseTypes(){return["AugLoop_RoleDetection_BasePartialDocumentLevelAnnotation","AugLoop_Core_Annotation"]}static typeGuard(F){return l.SchemaObject.matchesTypesFor(F,[y.getTypeName()])}}N.DocumentRoleDetectionAnnotation=y;y.H_={T_:y.getTypeName(),B_:y.getBaseTypes()};class B{constructor(F){l.SchemaObject.assign(B,this,F)}static getTypeName(){return"AugLoop_RoleDetection_DesignerInputClassifierSignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(F){return l.SchemaObject.matchesTypesFor(F,
[B.getTypeName()])}}N.DesignerInputClassifierSignal=B;B.H_={T_:B.getTypeName(),B_:B.getBaseTypes()};class G{constructor(F){l.SchemaObject.assign(G,this,F)}static getTypeName(){return"AugLoop_RoleDetection_NavigationPaneInputClassifierSignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(F){return l.SchemaObject.matchesTypesFor(F,[G.getTypeName()])}}N.NavigationPaneInputClassifierSignal=G;G.H_={T_:G.getTypeName(),B_:G.getBaseTypes()}},1753:function(C,N,d){d.d(N,"a",function(){return l});
C=d(0);class l{constructor(e){this.extensions=e}}Object(C.a)(l,"ExtensionList",null,[])},1754:function(C,N,d){d.d(N,"a",function(){return l});C=d(0);d=d(1708);class l extends d.a{constructor(e,a){super(e.source,e.target,e.pKf);this.Vi=e;this.insertAfter=a}get wha(){return this.Vi.wha}get xo(){return this.Vi.xo}set xo(e){this.Vi.xo=e}}Object(C.a)(l,"CoreInternalCopyArguments",d.a,[])},1755:function(C,N,d){d.d(N,"a",function(){return l});C=d(0);class l{constructor(e,a,k,n,v=null){this.source=e;this.target=
a;this.insertAfter=k;this.EJf=n;this.xo=v||{}}}Object(C.a)(l,"CoreInternalPasteArguments",null,[])},1756:function(C,N,d){d.d(N,"a",function(){return l});C=d(0);class l{constructor(e,a="",k="",n="",v=!1){this.Email=this.DisplayName=this.Provider=this.UserId=null;this.IsCurrentUser=!1;this.UserId=e;this.Provider=a;this.DisplayName=k;this.Email=n;this.IsCurrentUser=v}}Object(C.a)(l,"OfficeSharedCommentUser",null,[])},1757:function(C,N,d){d.d(N,"a",function(){return H});C=d(0);var l=d(44),e=d(1758),a=
d(159),k=d(2),n=d(104),v=d(289),u=d(1366),t=d(477),y=d(472),B=d(1367),G=d(171),F=d(142),K=d(60),O=d(13);class H{constructor(I){this.r8=this.ii=this.p0=null;this.nC=0;this.COb=this.jia=this.Wb=null;this.T_g=!1;this.Lke=null;this.lsh=!0;this.ga=I;this.Vb()}get Faa(){return this.p0}get model(){return this.ii}get M4b(){return this.r8}get xQk(){return k.AFrameworkApplication.XRn}get E8n(){return k.AFrameworkApplication.k2i}get ASk(){return CommonUIStrings.l_DeleteCommentConfirm}get g4n(){return!1}get Gz(){return!1}get Ati(){return!1}get bFh(){return this.jia}set bFh(I){this.jia=
I}get mode(){return this.nC}set mode(I){I!==this.nC&&(this.nC=I,-1!==this.nC&&(this.p0.D0a(),this.ii.D0a(),0===this.nC&&this.F6e()))}get $Jb(){return this.T_g}set $Jb(I){this.T_g=I}get removePersonalInformation(){return!1}get o4i(){return!0}dispose(){this.p0&&(this.p0.dispose(),this.p0=null);this.ii&&(this.ii.dispose(),this.ii=null);this.r8&&(this.r8.dispose(),this.r8=null);this.F6e()}selectComment(I,J=1){const L=this.ii.GB(I);!L||2===this.mode&&1!==L.Sq||(this.ii.selectComment(L),this.r8.highlightComment(L,
!0),this.p0.selectComment(L,J),1===J&&this.$Jb&&this.jia.selectComment(I))}CZc(){const I=this.ii.CZc();I&&(this.r8.highlightComment(I,!0),this.p0.selectComment(I),this.$Jb&&this.jia.selectComment(I.id))}DZc(){const I=this.ii.DZc();I&&(this.r8.highlightComment(I,!0),this.p0.selectComment(I),this.$Jb&&this.jia.selectComment(I.id))}G5d(I){I?this.selectComment(I,0):this.p0.mti&&this.lcf().Vj.oy(this.p0.mti)}clearSelection(){this.ii.clearSelection();this.$Jb&&this.jia.selectComment(null);this.r8.twk()}paneClosing(){this.Gz||
(2===this.nC?(this.clearSelection(),this.deleteComment(this.ii.Ly)):this.clearSelection())}Yub(I){if(1===this.mode){I=e.a.txb(I);var J=({anchor:L}=this.r8.uHk()).returnValue;if(L&&0===J)this.addComment(I,L);else{switch(J){case 1:I=CommonUIStrings.l_NewCommentError;break;case 2:I=CommonUIStrings.l_NewCommentInvalidContent;break;default:I=CommonUIStrings.l_NewCommentError}var L=new F.StandardDialog;L.Fd=0;L.Sga(CommonUIStrings.l_DefaultDialogTitle,I,null)}}}addComment(I){0!==this.mode&&(this.ii.O1j(I),
0===I.Sq||this.Ati||this.selectComment(I.id),this.ga.processAction(O.a.lph,2))}editComment(I,J){1===this.mode&&I&&(this.ii.KEc(I,J),this.selectComment(I.id))}zVe(){this.ii.Krk()}addReply(I,J){1===this.mode&&(I=this.ii.Msh(I,J),this.selectComment(I.id,0),this.ga.processAction(O.a.oph,2))}deleteComment(I){if(1!==this.mode)if(2===this.mode){if(1!==I.Sq)return;this.mode=1}else return;this.o4i&&1!==I.Sq?(this.COb=I,I=new F.StandardDialog,I.Fd=4,I.tU(2),I.P0f(CommonUIStrings.l_DefaultDialogTitle,this.ASk,
Object(l.a)(this,this.ISk,"deleteDialogHandler"))):this.DDc(I)}Vb(){this.ga.gb(O.a.mAk,K.a.frame,n.ActionManager.Nf,64);this.ga.gb(O.a.nAk,K.a.frame,n.ActionManager.Nf,64);this.ga.gb(O.a.Loh,K.a.frame,n.ActionManager.Nf,64);this.ga.pa(O.a.YXe,K.a.frame,n.ActionManager.Nf);this.ga.pa(O.a.Soh,K.a.frame,n.ActionManager.Nf);this.ga.pa(O.a.Toh,K.a.frame,n.ActionManager.Nf);this.ga.gb(O.a.sAk,K.a.frame,n.ActionManager.Nf,64);this.ga.gb(O.a.tAk,K.a.frame,n.ActionManager.Nf,64);this.ga.pa(O.a.lph,K.a.frame,
n.ActionManager.Nf);this.ga.pa(O.a.mph,K.a.frame,n.ActionManager.Nf);this.ga.pa(O.a.oph,K.a.frame,n.ActionManager.Nf);this.ga.gb(O.a.gBk,K.a.frame,n.ActionManager.Nf,64);this.ga.gb(O.a.iBk,K.a.frame,n.ActionManager.Nf,64);this.ga.gb(O.a.hBk,K.a.frame,n.ActionManager.Nf,64);this.ga.pa(O.a.rph,K.a.frame,n.ActionManager.Nf);this.ga.pa(O.a.L0a,K.a.frame,()=>{this.L0a();return 32})}ISk(I){1===I?this.DDc(this.COb):(this.COb&&this.selectComment(this.COb.id),this.COb=null)}DDc(I){const J=I.Rf;1===I.Sq?this.ga.processAction(O.a.YXe,
2):this.ga.processAction(O.a.Soh,2);this.COb=null;this.$Jb||this.clearSelection();I=this.ii.deleteComment(I);for(let L=0;L<I.length;L++)I[L].dispose();this.G5d(J)}vwb(I,J){0!==this.mode&&(this.ga.processAction(J?O.a.Toh:O.a.rph,2),this.ii.vwb(I,J))}Rra(I){this.ii.Rra(I);this.mode=1;this.ga.processAction(O.a.mph,2)}bbb(I){this.ii.bbb(I);this.mode=1}wBk(I,J){this.ii.$in(I,J)}qMc(){}F6e(){}uKb(I,J,L,S,E){return this.p0.uKb(I,J,L,S,E)}UX(I,J,L,S,E){return this.p0.UX(I,J,L,S,E)}lcf(){var I=this.Wb.getRegion(a.AFrame.gr);
if(!I){const J=this.Wb.re(a.AFrame.gr);I=new v.DOMFocusListing(()=>this.Faa.DUc);I.PDa=!0;I.Go(3);I.Go(2);I.Go(4);I.Go(1);I.Go(6);I.Go(5);this.Wb.Pja(()=>this.Faa.DUc,J,I);I=this.Wb.getRegion(a.AFrame.gr);I.JOa();I.mX=!0;I.oWa=!0;J.Dr(this.Wb.EV);J.Dr(this.Wb.FV)}return I}wqd(I,J){0!==this.mode&&this.ii.wqd(I,J)}y3d(I,J){0!==this.mode&&this.ii.y3d(I,J)}L0a(){G.UISurfaces.bK().then(I=>{var J=Object.assign(new u.a,{target:'[data-unique-id~="ShowCommentsTopBar"]',showCloseIcon:!0,content:CommonUIStrings.l_DeepLinkedCommentDoesNotExistNotification,
calloutProps:Object.assign(new B.a,{directionalHint:6,gapSpace:4,isBeakVisible:!1})});J=I.callout(J);const L=Object.assign(new y.a,{expirationOptions:Object.assign(new t.a,{displayTimeoutSeconds:10,onExpire:Object(l.a)(this,this.dismiss,"dismiss")})});this.Lke=I.addNotification(J,L)})}dismiss(){G.UISurfaces.bK().then(I=>{I.removeNotification(this.Lke);return this.Lke=null})}static get instance(){return H._instance||(H.factory?H._instance=H.factory():null)}static set instance(I){H._instance=I}}H._instance=
null;H.factory=null;Object(C.a)(H,"CommentManager",null,[245,246,9])},1758:function(C,N,d){d.d(N,"a",function(){return a});C=d(0);var l=d(2),e=d(742);class a{constructor(){this.aj=null;this.Zg=[];this._changes=[];this.D7a=this.yUb=this.zy=null}get Ks(){return this.zy}get Ly(){return this.D7a}initialize(k){this.aj=k}dispose(){const k=this.Zg.length;for(let n=0;n<k;n++)this.Zg[n].dispose();this.Zg=[]}D0a(){this.zy&&this.zy.D0a();this.yUb&&this.yUb.D0a()}selectComment(k){this.clearSelection();k.Gga=
1;this.zy=k;if(k.Rf){var n=Array.indexOf(this.Zg,k);for(--n;0<=n;n--){const v=this.Zg[n];if(v.id===k.Rf){v.Gga=2;this.yUb=v;break}}}l.AFrameworkApplication.ua&&l.AFrameworkApplication.ua.Sb.nma&&e.ShyRibbon.Lab(1,0)}CZc(){if(!this.Zg.length)return null;let k;k=this.zy?this.jOh(this.zy,!0):this.Zg[0];this.selectComment(k);return k}DZc(){if(!this.Zg.length)return null;let k;k=this.zy?this.dml(this.zy):this.Zg[this.Zg.length-1];this.selectComment(k);return k}clearSelection(){this.zy&&(this.zy.Gga=0,
this.zy=null);this.yUb&&(this.yUb.Gga=0,this.yUb=null)}KEc(k,n){this.aj.mode=3;k.Sq=2;k.iPa=0;k.Hy=n;this.D7a=k}Krk(){this.D7a=null;this.aj.mode=1}Msh(k,n){var v=this.GB(k);this.aj.mode=2;this.D7a=k=d(1607).Comment.hth(l.AFrameworkApplication.userName,k,v.t2h,n);for(n=this.Zg.length-1;0<=n;n--)if(v=this.Zg[n],v.Rf===k.Rf||v.id===k.Rf){Array.insert(this.Zg,n+1,k);break}return k}Rra(k){this.sph(k,2)}bbb(k){this.sph(k,4)}deleteComment(k){const n=[],v=Array.indexOf(this.Zg,k);for(;v<this.Zg.length;){const u=
this.Zg[v];if(u.id===k.id||u.Rf===k.id)Array.removeAt(this.Zg,v),Array.add(n,u);else break}this.bXc(n,3);-1<Array.indexOf(n,this.D7a)&&(this.D7a=null,this.aj.mode=1);return n}vwb(k,n){const v=[];let u=Array.indexOf(this.Zg,k);for(;u<this.Zg.length;){const t=this.Zg[u];if(t.id===k.id||t.Rf===k.id)t.done=n,Array.add(v,t),u++;else break}this.bXc(v,n?0:1)}gT(){return Array.clone(this.Zg)}o4b(){return!!this.Zg&&!!this.Zg.length}GB(k){for(let n=0;n<this.Zg.length;n++){const v=this.Zg[n];if(v.id===k)return v}return null}jOh(k,
n){k=Array.indexOf(this.Zg,k);return k===this.Zg.length-1?n?this.Zg[0]:null:this.Zg[k+1]}fsl(k,n=!1){let v=k=Array.indexOf(this.Zg,k);do if(v=v===this.Zg.length-1?0:v+1,!n||!this.Zg[v].done)return this.Zg[v];while(v!==k);return this.Zg[k]}dml(k){return(k=Array.indexOf(this.Zg,k))?this.Zg[k-1]:this.Zg[this.Zg.length-1]}gsl(k,n=!1){let v=k=Array.indexOf(this.Zg,k);do if(v=v?v-1:this.Zg.length-1,!n||!this.Zg[v].done)return this.Zg[v];while(v!==k);return this.Zg[k]}wqd(){}y3d(){}sph(k,n){const v=[];k.Sq=
0;Array.add(v,k);this.bXc(v,n);this.D7a=null}static txb(k){return d(1607).Comment.hth(l.AFrameworkApplication.userName,null,d(1607).Comment.QCi,k)}}Object(C.a)(a,"CommentModel",null,[9,241])},1759:function(C,N,d){d.d(N,"a",function(){return l});C=d(0);class l{}l.vBc="CommentPaneTextbox";l.Tvd="CommentPane";l.rAk="CommentDeleteButton";l.fBk="CommentSaveButton";l.eBk="CommentReplyButton";l.qAk="CommentCancelButton";l.qph="CommentTextEntry";l.kBk="CommentTabHelp";Object(C.a)(l,"CommentManagerConstants",
null,[])},1760:function(C,N,d){d.d(N,"a",function(){return k});C=d(0);var l=d(480),e=d(96),a=d(27);class k{dispose(){}static CWa(n,v,u,t=null,y=!0){var B=y?"":u;n=l.a("a",n,"StandardButton "+v);n.title=B;n.tabIndex=0;B=null;t?(B=e.createClusteredImage(16,16,t,"StandardButtonImage",!0,null),B.setAttribute(a.a.Ch,a.a.Az),n.appendChild(B)):Sys.UI.DomElement.addCssClass(n,"StandardButtonNoImage");y?(t=l.a("span",null,"StandardButtonLabel"),t.innerText=u,n.appendChild(t)):Sys.UI.DomElement.addCssClass(B,
"StandardButtonImageNoText");n.setAttribute(a.a.Ch,a.a.t1);return n}static yJb(n,v){void 0!==n&&null!==n&&(n.disabled=!v,v?(v=a.a.jL,Sys.UI.DomElement.removeCssClass(n,"DisabledButton"),Sys.UI.DomElement.removeCssClass(n,"cui-disabled")):(v=a.a.Ho,Sys.UI.DomElement.containsCssClass(n,"DisabledButton")||Sys.UI.DomElement.addCssClass(n,"DisabledButton"),Sys.UI.DomElement.containsCssClass(n,"cui-disabled")||Sys.UI.DomElement.addCssClass(n,"cui-disabled")),a.a.Iq(n,a.a.SRe,v))}}Object(C.a)(k,"SimpleButtonFactory",
null,[9])},1762:function(C,N,d){d.d(N,"a",function(){return n});C=d(0);var l=d(1763),e=d(89),a=d(758),k=d(8);class n{get Yc(){return null}get Ui(){return null}get Pta(){return!1}get Hpf(){return!1}JOe(){}qVd(){return!1}W6f(){return!1}GQh(v){return e.f(v,()=>!1)}uLa(){return null}NUd(v,u,t,y,B){u=u||[];t=t||[];const G=[];let F=0,K=0,O=0;for(;F<u.length||K<t.length;){const H=F<u.length&&K<t.length?u[F].begin<t[K].begin?u[F++]:t[K++]:F<u.length?u[F++]:t[K++];G[O]=l.a.createInstance(H.begin,H.end,v,O,
y,B);++O}return G}hgi(){return!1}sgi(){return!1}rKc(v,u){if(u&&v){let t;const y=[];try{for(;t=u.exec(v);){const B=new a.a(t.index,u.lastIndex);y.push(B)}return y}catch(B){k.ULS.sendTraceTag(522846819,313,15,B instanceof SyntaxError?"Invalid regular expression":`errorName: ${B.name}`)}}return null}f3d(){}}Object(C.a)(n,"BaseFindManagerHelper",null,[700])},1763:function(C,N,d){d.d(N,"a",function(){return l});C=d(0);class l{constructor(e,a,k,n,v,u,t){this.id=++l.QSj;this.Qvg=e;this.M6a=a;this.YRg=k;
this.LHg=n;this.Fl=v;this.zJg=u;this.fp=t;this.next=this.previous=null}get begin(){return this.Qvg}get end(){return this.M6a}get type(){return this.Fl}CVh(){return this.fp.uLa(this.nodeId)}get nodeId(){return this.YRg}get Reb(){return this.LHg}get vNd(){return this.zJg}oGk(e){this.Qvg=e.begin;this.M6a=e.end;this.YRg=e.nodeId;this.LHg=e.Reb;this.Fl=e.type;this.zJg=e.vNd}static createInstance(e,a,k,n,v,u){const {FindManagerHelper:t}=d(1515);return new l(e,a,k,n,v,u,t.instance)}}l.QSj=0;Object(C.a)(l,
"FindResult",null,[732])},1764:function(C,N,d){d.d(N,"a",function(){return k});C=d(0);var l=d(44),e=d(80),a=d(15);class k{constructor(n,v,u){this.$r=this.XIf=null;this.HYg=this.v9a=this.GYg=this.cUa=0;this.kad=null;this._context=n;this.Hb=v;this.Oa=u;this.b0b=!1;this.rde=!0;this.Qwn();this.IFb=this.K.$("NativeFileOpenDialogIsEnabled")}get context(){return this._context}get K(){return this.Oa}get retryCount(){return this.cUa}get Pyn(){return this.GYg}get PIb(){return this.v9a}get Qyn(){return this.HYg}dac(n){this.$r=
n;if(!this.b0b){if(this.rde){if(this.IFb&&a.a.gH){this.kad=n.Nzd(Object(l.a)(this,this.uGf,"onFileChosen"));return}this.kad=n.Nzd(null);if(!this.rwa(this.kad,n))return}this.VKa(n,null)}}uGf(n){if(this.rwa(n,this.$r)){if(a.a.gH||a.a.gj)this.kad=n;this.VKa(this.$r,null)}}YTc(){this.XIf&&this.XIf()}Xyn(n){if(!n||this.retryCount>=this.Pyn)return!1;this.cUa=this.retryCount+1;const v=new e.a(2,1,this.PIb,()=>{this.l4d(n)},110);this.Hb.$b(v);this.PIb<this.Qyn&&(this.v9a=2*this.PIb);return!0}Qwn(){this.cUa=
0;this.GYg=this.K.rc("Box4UploadRetryCount",20);this.v9a=this.K.rc("Box4UploadRetryDelayStart",200);this.HYg=this.K.rc("Box4UploadRetryDelayMax",3200);this.$r&&(this.$r.dispose(),this.$r=null)}}Object(C.a)(k,"FileUploader",null,[])},1765:function(C,N,d){d.d(N,"a",function(){return e});C=d(0);var l=d(2);d=d(67);class e{static r7j(a){e.igg.addHandler(e.voh,a)}static Pdn(a){l.AFrameworkApplication.K.$("SqmCommandEventSourceEnabled")&&e.igg.raiseEvent(e.voh,a)}}e.voh="CommandClickEvent";e.igg=new d.a;
Object(C.a)(e,"CommandClickEvents",null,[])},1766:function(C,N){Object.defineProperty(N,"__esModule",{value:!0});N.ErrorCode=N.FormattingSuggestionsRange=N.FormattingSuggestionType=void 0;(function(d){d[d.FontSize=0]="FontSize";d[d.FontFamily=1]="FontFamily";d[d.FontColor=2]="FontColor";d[d.Alignment=3]="Alignment";d[d.Indentation=4]="Indentation";d[d.Bold=5]="Bold";d[d.RightIndentation=6]="RightIndentation";d[d.Italic=7]="Italic";d[d.Underline=8]="Underline";d[d.AllCaps=9]="AllCaps";d[d.LineSpacing=
10]="LineSpacing";d[d.BeforeSpacing=11]="BeforeSpacing";d[d.AfterSpacing=12]="AfterSpacing";d[d.SpecialIndentType=13]="SpecialIndentType";d[d.SpecialIndentBy=14]="SpecialIndentBy";d[d.FontKerning=15]="FontKerning"})(N.FormattingSuggestionType||(N.FormattingSuggestionType={}));(function(d){d[d.Paragraph=0]="Paragraph";d[d.List=1]="List"})(N.FormattingSuggestionsRange||(N.FormattingSuggestionsRange={}));(function(d){d[d.Success=0]="Success";d[d.DocumentTooLarge=1]="DocumentTooLarge"})(N.ErrorCode||
(N.ErrorCode={}))},1767:function(C,N,d){Object.defineProperty(N,"__esModule",{value:!0});N.FormattingSuggestionsSummaryAnnotation=N.FormattingSuggestionsAnnotation=void 0;const l=d(203);class e{constructor(k){l.SchemaObject.assign(e,this,k)}get metadata(){return this.M_}set metadata(k){this.M_=k}static getTypeName(){return"AugLoop_ConsistencyChecker_FormattingSuggestionsAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(k){return l.SchemaObject.matchesTypesFor(k,
[e.getTypeName()])}}N.FormattingSuggestionsAnnotation=e;e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()};class a{constructor(k){l.SchemaObject.assign(a,this,k)}get metadata(){return this.M_}set metadata(k){this.M_=k}static getTypeName(){return"AugLoop_ConsistencyChecker_FormattingSuggestionsSummaryAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(k){return l.SchemaObject.matchesTypesFor(k,[a.getTypeName()])}}N.FormattingSuggestionsSummaryAnnotation=a;a.H_={T_:a.getTypeName(),
B_:a.getBaseTypes()}},1768:function(C,N){Object.defineProperty(N,"__esModule",{value:!0})},1769:function(C,N,d){Object.defineProperty(N,"__esModule",{value:!0});N.PullQuotesSignal=N.DocumentPullQuoteAnnotation=N.PullQuoteAnnotation=void 0;const l=d(203);class e{constructor(n){l.SchemaObject.assign(e,this,n)}get metadata(){return this.M_}set metadata(n){this.M_=n}static getTypeName(){return"AugLoop_PullQuotes_PullQuoteAnnotation"}static getBaseTypes(){return["AugLoop_Text_RangeAnnotation","AugLoop_Core_Annotation"]}static typeGuard(n){return l.SchemaObject.matchesTypesFor(n,
[e.getTypeName()])}}N.PullQuoteAnnotation=e;e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()};class a{constructor(n){l.SchemaObject.assign(a,this,n)}get metadata(){return this.M_}set metadata(n){this.M_=n}static getTypeName(){return"AugLoop_PullQuotes_DocumentPullQuoteAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(n){return l.SchemaObject.matchesTypesFor(n,[a.getTypeName()])}}N.DocumentPullQuoteAnnotation=a;a.H_={T_:a.getTypeName(),B_:a.getBaseTypes()};class k{constructor(n){l.SchemaObject.assign(k,
this,n)}static getTypeName(){return"AugLoop_PullQuotes_PullQuotesSignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(n){return l.SchemaObject.matchesTypesFor(n,[k.getTypeName()])}}N.PullQuotesSignal=k;k.H_={T_:k.getTypeName(),B_:k.getBaseTypes()}},1770:function(C,N){Object.defineProperty(N,"__esModule",{value:!0})},1771:function(C,N){Object.defineProperty(N,"__esModule",{value:!0})},1772:function(C,N){Object.defineProperty(N,"__esModule",{value:!0})},1773:function(C,N,
d){Object.defineProperty(N,"__esModule",{value:!0});N.TextToImageAnnotation=void 0;var l=d(203);C=function(){function e(a){l.SchemaObject.assign(e,this,a)}Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(a){this.M_=a},enumerable:!1,configurable:!0});e.getTypeName=function(){return"AugLoop_TextToImage_TextToImageAnnotation"};e.getBaseTypes=function(){return["AugLoop_Core_Annotation"]};e.typeGuard=function(a){return l.SchemaObject.matchesTypesFor(a,[e.getTypeName()])};
e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()};return e}();N.TextToImageAnnotation=C},1774:function(C,N,d){Object.defineProperty(N,"__esModule",{value:!0});N.TextToImageSignal=void 0;var l=d(203);C=function(){function e(a){l.SchemaObject.assign(e,this,a)}e.getTypeName=function(){return"AugLoop_TextToImage_TextToImageSignal"};e.getBaseTypes=function(){return["AugLoop_TextToSuggestions_TextToSuggestionSignal","AugLoop_Signals_Signal"]};e.typeGuard=function(a){return l.SchemaObject.matchesTypesFor(a,
[e.getTypeName()])};e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()};return e}();N.TextToImageSignal=C},1775:function(C,N,d){Object.defineProperty(N,"__esModule",{value:!0});N.TextToImageTraceSignal=void 0;var l=d(203);C=function(){function e(a){l.SchemaObject.assign(e,this,a)}e.getTypeName=function(){return"AugLoop_TextToImage_TextToImageTraceSignal"};e.getBaseTypes=function(){return["AugLoop_Signals_Signal"]};e.typeGuard=function(a){return l.SchemaObject.matchesTypesFor(a,[e.getTypeName()])};e.H_=
{T_:e.getTypeName(),B_:e.getBaseTypes()};return e}();N.TextToImageTraceSignal=C},1776:function(C,N){Object.defineProperty(N,"__esModule",{value:!0})},1777:function(C,N,d){Object.defineProperty(N,"__esModule",{value:!0});N.ThemeExtractorSignal=N.ThemeExtractorAnnotation=void 0;const l=d(203);class e{constructor(k){l.SchemaObject.assign(e,this,k)}get metadata(){return this.M_}set metadata(k){this.M_=k}static getTypeName(){return"AugLoop_ThemeExtractor_ThemeExtractorAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(k){return l.SchemaObject.matchesTypesFor(k,
[e.getTypeName()])}}N.ThemeExtractorAnnotation=e;e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()};class a{constructor(k){l.SchemaObject.assign(a,this,k)}static getTypeName(){return"AugLoop_ThemeExtractor_ThemeExtractorSignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(k){return l.SchemaObject.matchesTypesFor(k,[a.getTypeName()])}}N.ThemeExtractorSignal=a;a.H_={T_:a.getTypeName(),B_:a.getBaseTypes()}},1778:function(C,N){Object.defineProperty(N,"__esModule",{value:!0});N.TableType=
void 0;C=N.TableType||(N.TableType={});C[C.Other=0]="Other";C[C.SimpleHeaded=1]="SimpleHeaded"},1779:function(C,N,d){Object.defineProperty(N,"__esModule",{value:!0});N.TableTypeAnnotation=void 0;const l=d(203);class e{constructor(a){l.SchemaObject.assign(e,this,a)}get metadata(){return this.M_}set metadata(a){this.M_=a}static getTypeName(){return"AugLoop_TableAnalysis_TableTypeAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(a){return l.SchemaObject.matchesTypesFor(a,
[e.getTypeName()])}}N.TableTypeAnnotation=e;e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()}},1780:function(C,N,d){d.d(N,"a",function(){return F});C=d(0);var l=d(1527),e=d(1574),a=d(2),k=d(16),n=d(1516),v=d(35),u=d(8),t=d(9),y=d(19),B=d(134),G=d(11);class F{constructor(K=2E3){this.jZj=/(https?:\/\/)?(www\.)?[-a-zA-Z0-9@:%._\+~#=]{1,256}\.[a-zA-Z0-9()]{1,6}\b([-a-zA-Z0-9()@:%_\+.~#?&//=]*)?/g;this.s8a=K}Uam(){F.e2();return!0}Umm(){return!0}cvh(K,O,H){K=Object.assign(new n.a,{selection:Object.assign(new l.a,
{neighborhood:K.neighborhood,mentionStart:K.mentionStart,mentionLength:K.mentionLength}),entryPoint:O,launchData:H});return v.c(K)}getSelectedText(){const K=F.e2();return this.cId(K)}yhf(){const K=F.e2();return this.sIl(K)}cId(K){return this.IYh(K,!0)}sIl(K){return this.IYh(K,!1)}IYh(K,O){try{return this.rIl(K,O)}catch(H){u.ULS.sendTraceTag(545869845,1303,15,"Error accessing selection: {0}",H)}return Object.assign(new e.a,{neighborhood:"",mentionStart:0,mentionLength:0})}rIl(K,O){var H=null;let I=
!1;O&&K&&K.eE&&y.SelectionEditor.xf(K.Qa)&&y.SelectionEditor.ugb(K.Qa)&&(u.ULS.sendTraceTag(17944729,1303,50,"Selection was an insertion point, expanding to word"),I=y.SelectionEditor.xf(K.Qa),(H=y.SelectionEditor.X1(K.Qa,!1))&&H.eE&&0<=H.Qa.cpBegin&&0<=H.Qa.cpEnd&&1>=H.Qa.cpEnd-H.Qa.cpBegin&&(H=null));H&&(K=H);if(!K)return Object.assign(new e.a,{neighborhood:"",mentionStart:0,mentionLength:0});const J=new Sys.StringBuilder;H=O=0;const L=[],S=K.length;let E=null;for(let U=0;U<S;U++){const X=K.J(U);
if(!G.ParagraphReader.nc(X.node)||Array.contains(L,X.node.vn))continue;L.push(X.node.vn);const Y=G.ParagraphReader.text(X.node);a.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.SmartLookupUrlExtIsEnabled",!1)&&I&&(E=this.D6k(Y,X.cpBegin));let ca=Y,da=0;var P=G.ParagraphReader.Vg(X.node,!0,!0,!0);let ua=G.ParagraphReader.Vg(X.node,!1,!0,!0),ra=0;for(;ca.length<this.s8a&&(P||ua);){if(!(ra%2)&&P){var T=G.ParagraphReader.text(P);T&&(ca=T+" "+ca,da+=T.length+1);P=G.ParagraphReader.Vg(P,
!0,!0,!0)}1===ra%2&&ua&&(ca=(T=G.ParagraphReader.text(ua))?ca+" "+T:ca,ua=G.ParagraphReader.Vg(ua,!1,!0,!0));ra++}P=U===S-1;U||-1===X.cpBegin||(O=X.cpBegin);H+=P&&-1!==X.cpEnd?X.cpEnd:Y.length;J.append(ca);a.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.SmartLookupUrlExtIsEnabled",!1)&&I&&E&&(O=E.start,H=E.start+E.length);O+=da;H+=da;P||(J.append(" "),H++)}for(K=B.AParagraphNode.lU(J.toString()," ");O<H&&k.a.$u(K.charCodeAt(O));)O++;for(;H>O&&k.a.$u(K.charCodeAt(H-1));)H--;
return this.o$j(K,O,H)}D6k(K,O){for(var H;null!==(H=this.jZj.exec(K));){const I=H.index;H=H[0].length;if(O>=I&&O<=I+H)return{start:I,length:H}}return null}o$j(K,O,H){if(K.length>this.s8a){var I=H-O;if(I>this.s8a)K=K.substr(O,this.s8a),H=this.s8a,O=0;else{I=Math.max(O-Math.floor((this.s8a-I)/2),0);let J;J=Math.min(I+this.s8a,K.length);I=Math.max(J-this.s8a,0);O-=I;H-=I;K=K.substring(I,J)}}return Object.assign(new e.a,{neighborhood:K,mentionStart:O,mentionLength:H-O})}static e2(){var K=t.App.xa.jb.Ic;
if(!K)return u.ULS.sendTraceTag(38548897,1303,50,"ContentView is null"),null;K=K.Cb;return K&&K.hb&&K.hb.length?K.hb.kb:(u.ULS.sendTraceTag(38548898,1303,50,"SelectionManager or selectionCollection is null"),null)}}Object(C.a)(F,"Box4InsightsSelection",null,[619,620])},1781:function(C,N,d){d.d(N,"a",function(){return l});C=d(0);class l{constructor(){this.y=this.x=0}}Object(C.a)(l,"IPoint",null,[])},1782:function(C,N,d){d.d(N,"a",function(){return a});C=d(0);var l=d(16),e=d(8);d=d(1543);class a extends d.a{constructor(k,
n,v,u,t){super(k,n,t);this.Yj=v;this.B0g=t}bhc(k){let n;if(this.iP&&!k)return e.ULS.sendTraceTag(594408835,307,10,"No htmlDomContent"),{returnValue:!1,osa:null};if(this.B0g){if(this.Yj)return n=this.Yj.GKf(k,!1),{returnValue:!0,osa:n};e.ULS.sendTraceTag(592269661,307,10,"_clipboardDataHelper should not be null")}n=document.createElement("div");k=k.split(RegExp("\r\n|\r|\n"));for(var v=0;v<k.length-1;v++){const u=document.createElement("p");u.innerText=this.OQc(k[v]);n.appendChild(u)}v=document.createElement("span");
v.innerText=l.a.aFc(k[k.length-1]);n.appendChild(v);return{returnValue:!0,osa:n}}OQc(k){return l.a.aFc(k.length?k:" ")}}Object(C.a)(a,"MultiLineTextImportStrategy",d.a,[])},1785:function(C,N){Object.defineProperty(N,"__esModule",{value:!0})},1786:function(C,N){Object.defineProperty(N,"__esModule",{value:!0});N.SuggestionCategory=void 0;C=N.SuggestionCategory||(N.SuggestionCategory={});C[C.TextRelatedImage=0]="TextRelatedImage";C[C.AbstractImage=1]="AbstractImage";C[C.Icon=2]="Icon"},1787:function(C,
N){Object.defineProperty(N,"__esModule",{value:!0})},1788:function(C,N){Object.defineProperty(N,"__esModule",{value:!0})},1789:function(C,N,d){Object.defineProperty(N,"__esModule",{value:!0});N.TextToSuggestionSignal=void 0;var l=d(203);C=function(){function e(a){l.SchemaObject.assign(e,this,a)}e.getTypeName=function(){return"AugLoop_TextToSuggestions_TextToSuggestionSignal"};e.getBaseTypes=function(){return["AugLoop_Signals_Signal"]};e.typeGuard=function(a){return l.SchemaObject.matchesTypesFor(a,
[e.getTypeName()])};e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()};return e}();N.TextToSuggestionSignal=C},1790:function(C,N,d){d.d(N,"a",function(){return n});C=d(0);var l=d(80),e=d(195),a=d(8),k=d(120);class n{constructor(v,u,t,y,B,G,F,K,O){this.Apd=0;this.pV=null;this.YUa="";this.nRb=this.ype=!1;this.QGa=this.l5=null;this.sTf=!1;this.pQb=null;this.K1n=H=>{this.QGa===H&&(this.QGa=null,this.l5?this.YUa=this.Jca.qVc(this.pV.text):(this.xFf(),this.findInternal(null)),this.x7i())};this.findInternal=
()=>{this.l5=null;if(!this.CVe())if(!this.Jca.VGb(this.YUa).length)this.Iab(),this.Dkb(!0);else if(!this.uUf())switch(this._state){case 0:this.$qo();break;case 1:this.nKi()}};this.$6a=v;this.Jca=u;this.uDj=t;this.fp=y;this.Exe=B;this.Vsb=G;this.FDj=F;this.qQb=K;this.Ej=O;this._state=2;this.KK=0}get G$f(){return this.Apd}set G$f(v){this.Apd=v}get $hc(){return this.Apd}set $hc(v){this.Apd=v}get taskManager(){return this.Exe.value}get yIb(){return this.Vsb.value}get SYc(){return this.FDj.value}get Y8k(){return this.ype}Dkb(v){(this.ype=
v)&&this.$6a&&this.$6a.w1b()}get u9e(){return null}get LCd(){return this.pQb}find(v){this.pV=v;this.Qwk();this.QGa=new l.a(2,1,this.G$f,this.K1n,51);this.taskManager.$b(this.QGa)}VVa(){}PYc(){}m2i(){return!1}dJd(){}eJd(){}o4h(){return!1}Qwk(){this.l5&&(this.taskManager.We(this.l5),this.l5=null);this.QGa&&(this.taskManager.We(this.QGa),this.QGa=null)}$qo(){var v=(new Date).getTime();this.dwi();const u=this.aro(v);this._state||(this.l5=new l.a(2,1,this.$hc,this.findInternal,52),this.taskManager.$b(this.l5));
v=(new Date).getTime()-v;a.ULS.sendTraceTag(17306246,313,50,"{0}",{["Extension Walk Time"]:v,["Count"]:u})}Pjf(v,u,t=!0){this.Klh(v);if(Object(k.a)(114,v))if(12===v.type)this.lRl(v,u,this.nRb,t);else{const y=this.fp.rKc(v.uLa(),this.LCd);t&&(y&&0<y.length?this.uPa(v,y):v.Yja());t=this.fp.NUd(v.id,y,null,u,this.nRb);this.Tqd(v.id,t,v,u);this.hzf(v)}}lRl(v,u,t,y=!0){const B=[];var G=this.fp.GQh(v);if(!e.a.mf(G)&&(this.hzf(v),y))for(var F of G)G=this.fp.rKc(F.uLa(),this.LCd),e.a.mf(G)?this.Yja(F):(this.uPa(F,
G),B.push(G));F=this.fp.rKc(v.uLa(),this.LCd);this.Yja(v);!e.a.mf(F)&&y&&this.uPa(v,F);t=this.fp.NUd(v.id,F,B,u,t);this.Tqd(v.id,t,v,u)}aro(v){let u=this._state=0;const t=this.yZh();this.bGi();const y=this.I0i();do this.cJf(),u++;while(this.FYe(t)&&(new Date).getTime()-v<n.tqi);y&&y.dispose();this.iFf();return u}xFf(){}x7i(){}CVe(){return!1}Iab(){}uUf(){return!1}nKi(){}dwi(){}Klh(){}uPa(){}Yja(){}hzf(){}Tqd(){}iFf(){}yZh(){return null}bGi(){}I0i(){return null}cJf(){}FYe(){return!1}}n.tqi=200;Object(C.a)(n,
"BaseFindManager",null,[1394])},1791:function(C,N,d){d.d(N,"a",function(){return l});C=d(0);class l{constructor(e,a,k){this.rootNode=e;this.Pva=a;this.C1b=k}}Object(C.a)(l,"FindNodeContext",null,[])},1797:function(C,N,d){d.d(N,"a",function(){return l});C=d(0);class l{constructor(){this.A1f=this.formatting=null}}Object(C.a)(l,"TextFormattingActionData",null,[])},1798:function(C,N,d){d.d(N,"a",function(){return l});C=d(0);class l{constructor(e,a=null,k=null,n=null){this.iconSet={};this.iconSet["default"]=
e;this.iconSet.icon16=a;this.iconSet.icon24=k;this.iconSet.icon32=n}}Object(C.a)(l,"IconSetContainer",null,[])},1801:function(C,N,d){d.d(N,"a",function(){return l});C=d(0);d=d(311);class l extends d.a{constructor(){super()}}l.JZe="conversionRequestType";l.CLf="png";l.saf="gc2json";l.strict="strict";l.m5k="existingcontent";l.error="error";Object(C.a)(l,"GraphicsEditorParameters",d.a,[])},1814:function(C,N,d){d.d(N,"a",function(){return l});C=d(0);class l{constructor(e){this.Knb=0;this.egd=isFinite(e)?
Math.max(e,8):8;this.Qo=Array(this.egd);this.ej=this.z$a=this.QTa=0;this.Ezg=this.TOh(this.egd)}get count(){return this.ej}get isEmpty(){return!this.count}enqueue(e){this.count===this.Knb&&this.D0l();this.Qo[this.z$a]=e;this.z$a++;this.z$a===this.Knb&&(this.z$a=0);this.ej=this.count+1}dequeue(){if(!this.count)throw Error.create("Empty Queue");const e=this.Qo[this.QTa];this.QTa++;this.QTa===this.Knb&&(this.QTa=0);this.ej=this.count-1;this.count<=this.Ezg&&this.JQk();return e}Vy(){if(!this.count)throw Error.create("Empty Queue");
return this.Qo[this.QTa]}D0l(){this.h_i(2*this.Knb)}JQk(){const e=Math.max(this.Knb/2,this.egd);this.count>e||this.h_i(e)}h_i(e){const a=Array(e);let k=0;if(this.QTa<this.z$a||!this.count)for(var n=this.QTa;n<this.z$a;n++)a[k]=this.Qo[n],k++;else{for(n=this.QTa;n<this.Knb;n++)a[k]=this.Qo[n],k++;for(n=0;n<this.z$a;n++)a[k]=this.Qo[n],k++}this.Qo=a;this.Knb=e;this.QTa=0;this.z$a=k;this.Ezg=this.TOh(e)}TOh(e){return e<=this.egd?-1:Math.floor(.25*e)}}Object(C.a)(l,"Queue",null,[])},1842:function(C,N,
d){d.r(N);C=d(0);var l=d(2),e=d(80),a=d(1914),k=d(8),n=d(72),v=d(44),u=d(120),t=d(244),y=d(658),B=d(391),G=d(93),F=d(3),K=d(9),O=d(98),H=d(49),I=d(1008),J=d(6),L=d(102);class S extends O.a{constructor(){super(new L.a(33));this.w9e=this.rVf=0}kMd(){return 0}tFf(){const ab=new H.GraphTransaction(3);ab.Db(this);const eb=new J.GraphIterator;eb.set(this);if(eb.bD()){const zb=eb.Xd();eb.set(zb);const Ua=I.b(eb,this.rVf,this.w9e),Ab=new J.GraphIterator;Ab.set(this);Ab.Xd();Ab.Eg();Ua&&eb.currentNode!==zb&&
Ab.Sf(eb.currentNode,-2)}ab.dispose()}}Object(C.a)(S,"FindTrackingNode",O.a,[]);var E=d(19),P=d(53),T=d(11),U=d(1790),X=d(1791);class Y{constructor(ab){this.Xc=ab;ab=[];ab.push(1);this.s3f=ab}EQh(ab){const eb=this.Xc.Dk();eb.set(ab);const zb=[];eb.Bb(8)&&(eb.kd(8),zb.push(new X.a(eb.currentNode,ab,1)));return zb}static hE(){return new Y(new y.a)}static get instance(){return null!=Y.Slg?Y.Slg:Y.Slg=Y.hE()}}Object(C.a)(Y,"FindContextHelper",null,[312]);var ca=d(1515),da=d(387),ua=d(82),ra=d(17);class qa{constructor(ab,
eb,zb,Ua,Ab,mb,Rb,hc,Hb){this.$n=null;this.RQb=this.ire=!1;this.t6a=this.jug=this.M5a=null;this.AYg=!1;this.Y2=(Ta,Aa)=>{Ta=Aa.node;Aa.property===ra.a.lo&&this.BOc(Ta)&&this.vBb(Ta,3)};this.oib=(Ta,Aa)=>{Ta=Aa.node;this.BOc(Ta)&&this.vBb(Ta,2)};this.Sfa=(Ta,Aa)=>{Ta=Aa.node;Aa=Aa.Zpf;!this.cA.Y8k&&Aa||!this.BOc(Ta)||this.vBb(Ta,1)};this.processDirtyNodes=()=>{const Ta=this.le.hg("UserAction","ProcessDirtyNodesInFindResultsTime");this.$n=null;const Aa=this.Hc.Rc(3);Aa.Db(this.fp.Yc);0<this.addedNodes.count&&
(this.RQb=!0,this.Vxg(this.addedNodes,this.cA.Ej));0<this.IDc.count&&this.Vxg(this.IDc,this.cA.Ej);if(0<this.Mab.count){const ma=!this.cSj(this.Mab,this.cA,this.fp,this.bSj);this.RQb=this.RQb||ma}Aa.dispose();this.cA.Ej.gmb();this.tkb(this.RQb);this.aVi();Ta.stop()};this.ECn=()=>{this.Xud();if(0<this.Mab.count||0<this.addedNodes.count||0<this.IDc.count)this.$n=new e.a(2,1,500,this.processDirtyNodes,53),this.Hb.$b(this.$n)};this.cA=ab;this.bV=eb;this.fp=zb;this.Hb=Ua;this.Hc=Ab;this.Vxg=mb;this.cSj=
Rb;this.bSj=hc;this.le=Hb;this.reset();this.aVi=this.ECn;this.fp.f3d(this.Y2,this.Sfa,this.oib)}get Mab(){return this.M5a}get addedNodes(){return this.jug}get IDc(){return this.t6a}get oSi(){return this.AYg}get GVl(){return 0<this.Mab.count||0<this.IDc.count}start(){this.ire=!0;this.tkb(!1)}stop(){this.reset()}reset(){this.ire=!1;this.tkb(!1);this.M5a=new da.a;this.jug=new da.a;this.t6a=new da.a;this.Xud()}BOc(ab){return!!ab.Lc&&!!this.fp.Ui&&ab.Lc.id.equals(this.fp.Ui.id)}vBb(ab,eb){if(this.ire&&
Object(u.a)(114,ab)&&!this.cA.yIb.nYc)if(this.cA.Ej.P3a||this.cA.Ej.Sgb.length){switch(eb){case 1:this.Mab.xb(ab.id)||this.addedNodes.Z(ab.id,ab);break;case 2:this.Mab.xb(ab.id)&&this.Mab.remove(ab.id);this.addedNodes.xb(ab.id)?this.addedNodes.remove(ab.id):this.IDc.Z(ab.id,ab);break;case 3:this.Mab.Z(ab.id,ab)}this.aVi()}else 2!==eb&&this.tkb(this.RQb=!0)}Xud(){this.$n&&(this.Hb.We(this.$n),this.$n=null)}tkb(ab){this.oSi!==ab&&(this.AYg=ab,this.bV.tkb(ab));ab||(this.RQb=!1)}static hE(ab,eb){return new qa(ab,
eb,ca.FindManagerHelper.instance,ua.a.instance,new B.a,qa.lwk,qa.Snn,qa.Rnn,K.App.xa.jq)}static createInstance(ab,eb){return qa._instance||(qa._instance=qa.hE(ab,eb))}static Snn(ab,eb,zb,Ua){let Ab=!1;const mb=qa.G0h(ab,qa.WFm);for(let Rb=0;Rb<mb.length;++Rb){const hc=!Ua(mb[Rb],eb,zb);Ab=Ab||hc;ab.remove(mb[Rb].id)}return!Ab}static Rnn(ab,eb,zb){const Ua=eb.Ej;ab.Yja();const Ab=ab.id,mb=Ua.z3b(Ab);if(mb)eb=zb.rKc(ab.uLa(),eb.LCd),zb=zb.NUd(Ab,eb,null,mb.type,mb.vNd),ab.uPa(eb),Ua.h4d(Ab,zb);else return!1;
return!0}static lwk(ab,eb){const zb=qa.G0h(ab,qa.VFm);for(let Ua=0;Ua<zb.length;++Ua){const Ab=zb[Ua],mb=Ab.id;Ab.Yja();eb.QXc(mb);ab.remove(mb)}}static G0h(ab,eb){const zb=[];let Ua=eb;ab.forEach((Ab,mb)=>{zb.push(mb);--Ua;return Ua?!0:!1});return zb}}qa.WFm=5;qa.VFm=15;qa._instance=null;Object(C.a)(qa,"FindResultAppEventCoordinator",null,[1419]);class ka{constructor(ab,eb){this.dub=this.zNb=0;this.Flc=this.awc=this.Eha=null;this.NVb=0;this.Oqb=null;this.bV=ab;this.lia=eb;this.bUa=new da.a;this.Zsb=
new da.a;this.C8a=new da.a;this.B6a=new da.a;this.aUa=new da.a(0);this.Euc=new da.a;for(ab=0;ab<eb.length;++ab)this.aUa.Z(eb[ab],0);this.Sgb=[]}get YD(){return this.Eha}set YD(ab){this.Eha=ab;ab=Array(1);ab[0]=this.Eha;this.bV.WKa(3,ab)}get D7(){return this.awc}set D7(ab){this.awc=ab}get P1(){return this.Flc}set P1(ab){this.Flc=ab}get JAa(){let ab=null;for(const eb of this.lia)if(ab=this.bUa.J(eb))break;return ab}get zNe(){return this.zNb}N7d(ab){ab!==this.zNb&&(this.zNb=ab)}get lha(){return this.dub}pec(ab){ab!==
this.dub&&(this.dub=ab,this.bV&&!this.dub&&(this.bV.j6d(0),this.bV.I7d(0)))}get P3a(){return this.NVb}get v8b(){return this.Oqb}GNe(ab,eb){if(ab&&!(0>=ab.length)){var zb=ab[0].type,Ua=eb,Ab=Ua?Ua.next:this.bUa.J(zb);Ua||this.bUa.Z(zb,ab[0]);for(const mb of ab){const Rb=mb;this.Euc.Z(Rb.id,Rb);Ua&&(Ua.next=Rb);Rb.previous=Ua;Ua=Rb}Ua&&(Ua.next=Ab);Ab&&(Ab.previous=Ua);eb&&ab[0].nodeId.equals(eb.nodeId)||this.C8a.Z(ab[0].nodeId,ab[0]);!Ab&&Ua&&this.Zsb.Z(Ua.type,Ua);this.v8b===eb&&(this.Oqb=Ua);this.aUa.Z(zb,
this.aUa.J(zb)+ab.length);this.pec(this.lha+ab.length);this.NVb=this.P3a+ab.length;this.bV&&this.bV.WKa(0,ab)}}Xqd(ab){!ab||0>=ab.length||this.GNe(ab,this.Zsb.J(ab[0].type))}r7g(ab){!ab||0>=ab.length||(this.v8b&&this.v8b.type!==ab[0].type&&(this.Oqb=null),this.GNe(ab,this.v8b))}QXc(ab){const eb=this.z3b(ab);if(eb){ab=eb;for(var zb=0;ab;){++zb;if(!ab.next||!ab.nodeId.equals(ab.next.nodeId))break;ab=ab.next}this.mOi(eb,ab)}else k.ULS.sendTraceTag(4069027,313,15,"RemoveResultsForNode called for node not in cache: {0}",
ab.toString())}mOi(ab,eb){let zb=0,Ua=0;const Ab=[];let mb=ab;for(;mb!==eb.next;){const Rb=this.Dgi(mb);this.C8a.J(mb.nodeId).id===mb.id&&(mb.next&&mb.next.nodeId.equals(mb.nodeId)?(this.C8a.Z(mb.nodeId,mb.next),Rb&&this.B6a.Z(mb.nodeId,mb.next)):(this.C8a.remove(mb.nodeId),Rb&&this.B6a.remove(mb.nodeId)));this.v8b&&this.v8b.id===mb.id&&(this.Oqb=ab.previous);this.D7&&this.D7.id===mb.id&&(this.D7=this.Wff(mb,ab));this.P1&&this.P1.id===mb.id&&(this.P1=this.Wff(mb,ab));this.YD&&this.YD.id===mb.id&&
(this.YD=this.Wff(mb,ab));this.Euc.remove(mb.id);Ab.push(mb);mb=mb.next;Rb?++Ua:++zb}ab.previous?ab.previous.next=eb.next:eb.next?this.bUa.Z(eb.type,eb.next):this.bUa.remove(eb.type);eb.next?eb.next.previous=ab.previous:ab.previous?this.Zsb.Z(ab.type,ab.previous):this.Zsb.remove(ab.type);eb.next=null;ab.previous=null;this.aUa.Z(ab.type,this.aUa.J(ab.type)-zb);this.pec(this.lha-zb);this.NVb=this.P3a-(zb+Ua);this.bV&&this.bV.WKa(1,Ab)}h4d(ab,eb){const zb=this.z3b(ab);if(zb){const Ua=[],Ab=[],mb=[];
let Rb=zb,hc,Hb=0;do Hb<eb.length?(Rb.oGk(eb[Hb]),Ua.push(Rb)):(Ab.push(Rb),this.D7&&this.D7.id===Rb.id&&0<Ua.length&&(this.D7=Ua[Ua.length-1])),++Hb,hc=Rb,Rb=Rb.next;while(Rb&&hc.nodeId.equals(Rb.nodeId));for(;Hb<eb.length;++Hb)mb.push(eb[Hb]);0<Ab.length&&this.mOi(Ab[0],Ab[Ab.length-1]);0<mb.length&&this.GNe(mb,0<Ua.length?Ua[Ua.length-1]:zb);eb=Ua.length;if(0<eb){if(this.B6a.xb(ab)){this.B6a.remove(ab);this.pec(this.lha+eb);let Ta,Aa;(Ta=this.aUa).Z(Aa=Ua[0].type,Ta.J(Aa)+eb)}this.bV&&this.bV.WKa(4,
Ua)}}else k.ULS.sendTraceTag(4069056,313,15,"ReplaceResultsForNode: NodeId not found in cache nodeId={0}",ab.toString())}fnh(){this.C8a=new da.a;this.B6a=new da.a;this.bUa=new da.a;this.Zsb=new da.a;this.Euc=new da.a;for(let ab=0;ab<this.lia.length;++ab)this.aUa.Z(this.lia[ab],0);this.YD=null;this.N7d(0);this.P1=this.D7=this.Oqb=null;this.pec(0);this.NVb=0;this.bV&&this.bV.WKa(2,null)}Cpi(){this.B6a=new da.a;this.C8a.forEach((ab,eb)=>{this.B6a.Z(ab,eb);return!0});for(let ab=0;ab<this.lia.length;++ab)this.aUa.Z(this.lia[ab],
0);this.YD=null;this.N7d(0);this.Oqb=null;this.pec(0);this.bV&&this.bV.WKa(2,null)}z3b(ab){return this.C8a.xb(ab)?this.C8a.J(ab):null}fk(ab){let eb=null;this.Euc.xb(ab)&&(eb=this.Euc.J(ab));return eb}QQh(ab){return this.bUa.xb(ab)?this.bUa.J(ab):null}Zwl(ab){return this.Zsb.xb(ab)?this.Zsb.J(ab):null}gmb(){var ab=0;if(this.YD){ab=0;const Ua=this.YD.type;var eb=this.bUa.J(Ua);if(eb){for(var zb=1;eb&&this.YD.id!==eb.id;)this.Dgi(eb)||++zb,eb=eb.next;eb&&(ab=zb)}if(eb){eb=0;for(zb=0;zb<this.lia.length&&
this.lia[zb]!==Ua;++zb)eb+=this.aUa.J(this.lia[zb]);ab=eb+ab}else k.ULS.sendTraceTag(4069057,313,10,"UpdateActiveIndexFromActiveResult, active result not found in cache, setting it to null"),this.YD=null,ab=0}this.N7d(ab);this.bV&&(this.bV.j6d(this.zNe),this.bV.I7d(this.lha))}CYa(ab){return this.UGd(ab,!1)}DHd(ab){return this.UGd(ab,!0)}UGd(ab,eb){let zb=eb?ab.previous:ab.next,Ua=ab.type;for(;!zb&&(Ua=this.tAl(Ua,eb),zb=eb?this.Zwl(Ua):this.QQh(Ua),Ua!==ab.type););return zb||ab}M2b(ab){return this.WNh(ab,
!1)}sTh(ab){return this.WNh(ab,!0)}WNh(ab,eb){let zb=this.UGd(ab,eb);for(;zb.nodeId.equals(ab.nodeId)&&zb.id!==ab.id;)zb=this.UGd(zb,eb);return zb}tAl(ab,eb){let zb=0;for(let Ua=0;Ua<this.lia.length;++Ua)if(ab===this.lia[Ua]){zb=Ua;break}eb?(--zb,0>zb&&(zb=this.lia.length-1)):(++zb,zb===this.lia.length&&(zb=0));return this.lia[zb]}BRi(){this.Oqb=null}Wff(ab,eb){ab=this.CYa(ab);ab.id===eb.id&&(ab=null);return ab}Dgi(ab){return this.B6a.xb(ab.nodeId)}static createInstance(ab,eb,zb=!1){return zb?new ka(ab,
eb):ka._instance||(ka._instance=new ka(ab,eb))}}ka._instance=null;Object(C.a)(ka,"FindResultManager",null,[1393]);class la{constructor(ab,eb){this.IQl=zb=>{const Ua=this.fp.Ui.Eb(zb.nodeId);if(Ua){if(this.kB.YD){var Ab=this.fp.Ui.Eb(this.kB.YD.nodeId);(Ab=Object(n.a)(114,Ab))?Ab.Jmh():k.ULS.sendTraceTag(4069060,313,15,"{0}",{["GoToResultInternal"]:"ActiveHitNodeNotFound",["NodeId"]:this.kB.YD.nodeId})}Ua.Yyf(zb.Reb,zb.type)?(this.kB.YD=zb,k.ULS.sendTraceTag(4065305,313,50,"{0}",{["GoToResultInternal"]:"Success",
["ResultId"]:zb.id})):d(1842).FindManager.instance.o4h()?k.ULS.sendTraceTag(4575581,313,15,"{0}",{["GoToResultInternal"]:"Failure",["NodeId"]:Ua.id,["HitIndexInNode"]:zb.Reb,["ResultId"]:zb.id}):k.ULS.sendTraceTag(4069061,313,10,"{0}",{["GoToResultInternal"]:"Failure",["NodeId"]:Ua.id,["HitIndexInNode"]:zb.Reb,["ResultId"]:zb.id});this.kB.gmb()}else k.ULS.sendTraceTag(4069059,313,10,"{0}",{["GoToResultInternal"]:"Invalid findResult.NodeId",["NodeId"]:zb.nodeId})};this.kB=ab;this.fp=eb;this.yjf=this.IQl}W1h(){const ab=
this.kB.YD?this.kB.CYa(this.kB.YD):this.kB.JAa;this.yjf(ab)}HQl(){const ab=this.kB.YD?this.kB.DHd(this.kB.YD):this.kB.JAa;this.yjf(ab)}Z1h(ab){const eb=this.kB.fk(ab);eb?this.yjf(eb):k.ULS.sendTraceTag(4069058,313,10,"{0}",{["GoToResult"]:"Invalid FindResult",["ResultId"]:ab})}static hE(ab){return new la(ab,ca.FindManagerHelper.instance)}static createInstance(ab){return la._instance||(la._instance=la.hE(ab))}}la._instance=null;Object(C.a)(la,"FindResultNavigator",null,[1391]);var Ha=d(16),wa=d(1202);
O=d(107);class Ca{static VGb(ab){const eb=[];var zb=RegExp('"[^"\\r\\n]*"',"ig"),Ua=ab.match(zb);let Ab;if(Ua&&0<Ua.length)for(Ab=0;Ab<Ua.length;Ab++){var mb=Ua[Ab].split('"').join("");mb=mb.trim();mb=mb.split(Ca.HKb).join(" ");if(""!==mb){eb.push(mb);var Rb=mb.split(Ca.punctuation).join(" ");Rb=Rb.trim();Rb=Rb.split(Ca.HKb).join(" ");""!==Rb&&Rb!==mb&&eb.push(Rb)}}ab=ab.split(zb).join(" ");zb=wa.a.instance.Vjl(ab);if(!zb.length)return eb.sort(Ca.E6i),eb;Ua=zb[0];for(Ab=1;Ab<zb.length;Ab++)if(Rb=
zb[Ab],2!==Ua.GK||2!==Rb.GK)mb=ab.substring(Ua.cp,Rb.cp),mb=mb.trim(),Ca.dji(mb,Ua)&&eb.push(mb),Ua=Rb;mb=ab.substring(Ua.cp,ab.length);mb=mb.trim();Ca.dji(mb,Ua)&&eb.push(mb);eb.sort(Ca.E6i);return eb}static dji(ab,eb){return""!==ab&&'"'!==ab&&1!==eb.GK}static xun(ab){for(let eb=0;eb<ab.length;eb++)ab[eb]=ab[eb].split(Ca.HKb).join("\\s+");return ab}static E6i(ab,eb){return ab.length>eb.length?-1:ab.length===eb.length?0:1}}Ca.punctuation=RegExp("[\\[\\]\\\\\\^\\$\\.\\|\\+\\(\\)\\?\\*\\-_=,;:%!'<>/@#&{}]");
Ca.HKb=RegExp("\\s+");Ca.Ojn=[new O.a(RegExp("\\[","g"),"\\["),new O.a(RegExp("\\]","g"),"\\]"),new O.a(RegExp("\\\\","g"),"\\\\"),new O.a(RegExp("\\^","g"),"\\^"),new O.a(RegExp("\\$","g"),"\\$"),new O.a(RegExp("\\.","g"),"\\."),new O.a(RegExp("\\|","g"),"\\|"),new O.a(RegExp("\\+","g"),"\\+"),new O.a(RegExp("\\(","g"),"\\("),new O.a(RegExp("\\)","g"),"\\)"),new O.a(RegExp("\\?","g"),"\\?"),new O.a(RegExp("\\*","g"),"\\*")];Object(C.a)(Ca,"SearchAndFindUtils",null,[]);class Ja{qVc(ab){return Ha.a.aea(ab,
Ca.Ojn)}VGb(ab){ab=Ca.VGb(ab);return ab=Ca.xun(ab)}eGi(){return null}RQd(){return!1}static get instance(){return null!=Ja.smg?Ja.smg:Ja.smg=new Ja}}Object(C.a)(Ja,"QueryProcessor",null,[921]);var bb=d(720),ha=d(22),ia=d(20),va=d(14),Ka=d(34),Xa=d(656),xa=d(758),Ma=d(291),Na=d(247);class pa{constructor(){this.oYc=this.transaction=null;this.Egc=this.uTf=0;this.rTf=this.Ebb=null}}Object(C.a)(pa,"ReplaceAllContext",null,[]);class Ra{constructor(ab,eb,zb,Ua,Ab,mb,Rb,hc,Hb,Ta,Aa){this.GSm=(ma,Ga,Fa,ib,
ob)=>{let fb=null;if(ma>Ga)for(fb=Fa;0<Ga&&fb.nodeId.equals(ob.id);)fb=this.kB.CYa(fb),--Ga;else 0<ma?fb=this.kB.M2b(Fa):ib.nodeId!==ob.id&&(fb=ib);return fb};this.Xmh=()=>{const ma=this.kB.Sgb;if(ma&&0<ma.length){const Ga=this.Hc.Rc(3);Ga.Db(this.fp.Ui.Eb(ma[0]));for(let Fa=0;Fa<ma.length;++Fa){const ib=this.fp.Ui.Eb(ma[Fa]);ib?ib.Yja(!1,!0):k.ULS.sendTraceTag(4069064,313,10,"Last replaced node not found in object Space, NodeId: {0}",ma[Fa])}Ga.dispose();Array.clear(this.kB.Sgb)}};this.LXm=(ma,Ga)=>
{this.uuc=!0;this.ONi();const Fa=new pa;Fa.oYc=ma?ma:"";Fa.rTf=Ga;Fa.Egc=this.kB.lha;ma=this.Hc.Rc(15);ma.Db(this.fp.Yc);Fa.transaction=ma;this.b5k(Fa,ma)};this.$Rm=(ma,Ga)=>{ma=new bb.a(null,this.D$m,ma);const Fa=this.fp.Yc;Fa&&Fa.YG().AF.y9(9);ma.ml("ReplaceAll");Ga.jEa(ma);ma.run()};this.IVm=(ma,Ga)=>{ma=this.le.hg("UserAction","OnProcessReplaceAll");if(this.ljm(Ga))return this.$Bk(Ga),!1;let Fa=Ga.Ebb;Fa||(Fa=this.kB.JAa);Ga.Ebb=this.kB.M2b(Fa);const ib=this.fp.Ui.Eb(Fa.nodeId);if(!ib)return k.ULS.sendTraceTag(4065307,
313,10,"ReplaceAll: Node for result with id: {0} and nodeId: {1}, Not Found!",Fa.id,Fa.nodeId),!0;const ob=ib.yLa();if(ob&&ob.length)if(this.jtk(ib,ob[0].begin,ob[0].end))k.ULS.sendTraceTag(5007254,313,50,"ReplaceAll: Skipping node: {0} as Paragraph is locked",ib.id);else{let fb=0;for(let Mb=0;Mb<ob.length;++Mb){Ga.uTf+=1;const Tb=this.replaceText(this.cA.u9e,ib,Ga.oYc,Ka.a.createTextRange(ib,ob[Mb].begin+fb,ob[Mb].end+fb));fb+=Ga.oYc.length-(ob[Mb].end-ob[Mb].begin)+Tb;ib.VYf(0,Ga.oYc.length)}0<
Ga.oYc.length&&this.kB.Sgb.push(Fa.nodeId)}else k.ULS.sendTraceTag(4065308,313,15,"ReplaceAll: No hits found for result with id: {0} and nodeId: {1}!",Fa.id,Fa.nodeId);ma.stop();return!0};this.CQm=ma=>{ma.transaction.dispose();this.uuc=!1;this.cA.VVa(!1);ma.rTf&&ma.rTf(ma.uTf,ma.Egc)};this.oWm=(ma,Ga,Fa,ib)=>{!ma.matchCase&&0<Fa.length&&(ma=Ga.uLa().substr(ib.cpBegin,ib.cpEnd-ib.cpBegin),Fa=this.Yrk(Fa,ma));return this.vuc(ib,Fa,!0,!1)};this.cA=ab;this.kB=eb;this.fp=zb;this.Hc=Ua;this.Dxe=Ab;this.DIj=
Rb;this.Ttg=hc;this.vuc=Hb;this.LKj=Ta;this.le=Aa;this.uuc=!1;this.d2n=this.LXm;this.D$m=this.IVm;this.$Bk=this.CQm;this.b5k=this.$Rm;this.ONi=this.Xmh;this.replaceText=this.oWm;this.Yrk=Ra.LPm;this.AAl=this.GSm}get pPa(){return this.Dxe.value}get nYc(){return this.uuc}replace(ab){var eb=!1;if(this.nYc)return k.ULS.sendTraceTag(4069062,313,15,"Replace: Cancelled as replace is already in progress"),eb;if(this.pPa.DPk){var zb=this.pPa.Isa;const mb=zb.node;zb.contextId===va.a.paragraph&&(zb=Ka.a.createTextRange(mb,
0,T.ParagraphReader.textLength(mb)));var Ua=Object(n.a)(114,mb);if(Ua){var Ab=new xa.a(zb.cpBegin,zb.cpEnd);Ab=Ua.zSh(Ab);if(Ab!==Xa.a.invalid&&0<=Ab){if(this.ulh(zb))return k.ULS.sendTraceTag(5007250,313,50,"Replace: Cancelled as Paragraph is locked"),eb;this.uuc=!0;eb=this.Hc.Rc(15);eb.Db(mb);this.replaceText(this.cA.u9e,Ua,ab,zb);eb.dispose();this.ONi();Ua.VYf(Ab,ab.length);0<ab.length&&this.kB.Sgb.push(mb.id);ab=this.kB.z3b(mb.id);zb=this.kB.CYa(ab);Ua=Ua.yLa();Ua=this.fp.NUd(mb.id,Ua,null,ab.type,
ab.vNd);this.kB.h4d(mb.id,Ua);(zb=this.AAl(Ua.length,Ab,ab,zb,mb))?this.cA.SYc.Z1h(zb.id):this.kB.gmb();eb=!0;this.uuc=!1}else k.ULS.sendTraceTag(5007251,313,50,"Replace: Cancelled as current selection not on a find hit.")}else k.ULS.sendTraceTag(4069063,313,15,"Replace: Failed as No node found corresponding to current selection")}else k.ULS.sendTraceTag(5007252,313,50,"Replace: Cancelled as current selection does not contain single context");eb?(k.ULS.sendTraceTag(4065306,313,50,"ReplaceManager Replace Success"),
this.cA.sTf=!0):(k.ULS.sendTraceTag(5007253,313,50,"ReplaceManager Replace Not Successful"),this.cA.SYc.W1h());return eb}replaceAll(ab,eb){this.nYc?k.ULS.sendTraceTag(4069065,313,15,"ReplaceAll: Called when Replace is already in Progress"):this.kB.lha?this.d2n(ab,eb):k.ULS.sendTraceTag(4069066,313,15,"ReplaceAll: Called when total results is 0")}ulh(ab){const eb=this.DIj(ab);!eb&&this.Ttg.value&&this.LKj.value&&this.Ttg.value(ab.node);return eb}jtk(ab,eb,zb){return this.ulh(Ka.a.createTextRange(ab,
eb,zb))}ljm(ab){return ab.Ebb===this.kB.JAa}static get characterPropertiesEditor(){return null!=Ra.ahg?Ra.ahg:Ra.ahg=ha.a.instance.resolve("Box4.ICharacterPropertiesEditor")}static hE(ab,eb){const zb=new t.a(()=>K.App.ud&&K.App.ud.Lq?Object(v.a)(K.App.ud.Lq,K.App.ud.Lq.CG,"acquireAndApplyLock"):null);return new Ra(ab,eb,ca.FindManagerHelper.instance,new B.a,new t.a(()=>Ma.a.instance),new t.a(()=>P.a.instance),Object(v.a)(Na.a.instance,Na.a.instance.Dam,"isContextSetInLockedRange"),zb,Object(v.a)(Ra.characterPropertiesEditor,
Ra.characterPropertiesEditor.replaceTextRange,"replaceTextRange"),new t.a(()=>ia.a.instance.J(4)&&K.App.ud.Mp),K.App.xa.jq)}static createInstance(ab,eb){return Ra._instance||(Ra._instance=Ra.hE(ab,eb))}static LPm(ab,eb){const zb=Ha.a.mh(eb);!Ha.a.localeCompare(Ha.a.Wz(eb),eb)&&Ha.a.localeCompare(zb,eb)?ab=Ha.a.Wz(ab):Ha.a.V7b(eb.charAt(0))&&!Ha.a.Trf(eb.charAt(0))&&(eb=Ha.a.Wz(ab.substr(0,1)),ab=1===ab.length?eb:eb+ab.substr(1,ab.length-1));return ab}}Ra._instance=null;Object(C.a)(Ra,"ReplaceManager",
null,[1342]);d.d(N,"FindManager",function(){return Sa});class Sa extends U.a{constructor(ab,eb,zb,Ua,Ab,mb,Rb,hc,Hb,Ta,Aa,ma,Ga,Fa,ib,ob=!1){super(ab,eb,zb,Ab,mb,Ga,Fa,Aa,ma);this.kia=this.avc=null;this.Cpd=!1;this.Gya=this.p6a=this.a8a=null;this.dnc=0;this.Zmd=Ua;this.Wqb=Rb;this.Xc=hc;this.Hc=Hb;this.VCe=Ta;this.EDj=ib;this.Jqc=[];this._state=2;this.xtb=!ob;this.oob=new S;this.fp.JOe(this.oob);this.eVb=new S;this.fp.JOe(this.eVb);this.fp.Yc&&(this.a8a=this.fp.Ui);this.G$f=400;this.$hc=100}get Cb(){return this.Wqb.value}get u9e(){return this.avc}get MCd(){return this.EDj.value}VVa(ab=
!0){this.yIb&&this.yIb.nYc||(this.Iab(ab),this.$6a.reset(),this.YUa="",this.Zmd&&this.MCd.stop(),this.Rwk(),this.i0i(null))}Rwk(){this.l5&&(this.taskManager.We(this.l5),this.l5=null);this.QGa&&(this.taskManager.We(this.QGa),this.QGa=null)}Iab(ab=!0){!this.a8a&&0<this.Ej.P3a&&k.ULS.sendTraceTag(4235910,313,10,"{0}",{["CancelFind"]:"LastKnowSpaceNull"});if(0<this.Ej.P3a&&this.a8a){let zb=this.Ej.JAa;const Ua=zb.nodeId;if(this.a8a.Eb(Ua)){const Ab=this.Hc.Rc(3);for(Ab.Db(this.a8a.Eb(Ua));zb;){const mb=
this.a8a.Eb(zb.nodeId);var eb=Object(n.a)(114,mb);if(eb){if(this.xtb&&(eb.Yja(void 0,ab),T.ParagraphReader.nc(mb)&&(eb=this.fp.GQh(mb))))for(const Rb of eb)Rb.Yja(void 0,ab);mb.gk(16,!0)}zb=this.Ej.M2b(zb);if(!zb||zb.nodeId.equals(Ua))break}Ab.dispose()}else k.ULS.sendTraceTag(4235911,313,10,"ClearFindHits: Error - node not in last known space");this.Ej.fnh()}ab&&this.yIb&&this.yIb.Xmh();this.IRi();this.Jqc=[];this.pQb=this.avc=null;this.KK=0;this.sTf=this.Cpd=!1}PYc(){const ab=this.pV;this.Iab();
ab&&""!==ab.text&&this.find(ab)}m2i(){return""===this.YUa}o4h(){return this.Zmd&&this.MCd.GVl}fSi(){10>this.dnc?(this.dnc++,k.ULS.sendTraceTag(4069014,313,15,"{0}",{["ErrorRestartCount"]:this.dnc}),this.find(this.pV)):(k.ULS.sendTraceTag(4235912,313,10,"RestartFindAfterErrorCondition: max retries reached"),l.AFrameworkApplication.ya.processAction(F.a.rwb,2),this.dnc=0)}nKi(){var ab=(new Date).getTime();let eb=!1;this.Ej.P3a||(eb=!0);let zb=0;if(!eb){this.Ej.D7||(this.Ej.D7=this.Ej.JAa);this.Ej.P1||
(this.Ej.P1=this.Ej.D7,this.Ej.YD=null);let Ua=null,Ab=!0;for(;!eb&&this.Ej.P1&&(new Date).getTime()-ab<U.a.tqi;){const mb=this.Ej.P1,Rb=this.fp.Ui.Eb(mb.nodeId);Rb?(Ab&&(Ua=this.Hc.Rc(3),Ua.Db(Rb),Ab=!1),mb.vNd&&!this.p6a&&(this.p6a=Rb),this.Ej.P1=this.Ej.M2b(this.Ej.P1),eb=!this.Ej.P1||this.Ej.P1.nodeId.equals(this.Ej.D7.nodeId),this.Pjf(Rb,mb.type,this.xtb),++zb):this.Ej.QXc(mb.nodeId)}Ua&&Ua.dispose()}this.Ej.gmb();eb&&(this.Ej.P1=null,this.Cpd?this._state=0:(this._state=2,this.Dkb(!0)));this.l5=
new e.a(2,1,this.$hc,Object(v.a)(this,this.findInternal,"findInternal"),52);this.taskManager.$b(this.l5);ab=(new Date).getTime()-ab;k.ULS.sendTraceTag(4065247,313,50,"{0}",{["RecheckTime"]:ab,["Count"]:zb,["Total"]:this.Ej.lha,["TotalWithDirty"]:this.Ej.P3a})}B7m(){this.Iab();this.KK=0;if(this.fp.Hpf&&this.xtb){var ab=this.Cb;if(ab){var eb=ab.hb.kb;if(eb){var zb=K.App.xa.jb.Ic;(zb=zb?zb.kw:null)&&zb.WKb();eb=E.SelectionEditor.Pj(eb,!1,!1);ab.setSelection(eb);zb&&zb.vvb()}}}ab=this.pVk();this.kia=
this.uDj.EQh(ab)}j0i(){this.i0i(this.kia[this.KK].Pva)}i0i(ab){this.UOn(ab);this.zYi(ab)}IRi(){this.p6a=null;this.nRb=!1}Tff(ab){const eb=this.Xc.Dk();eb.set(ab);if(!eb.Bb(7))return eb.reset(),null;if(this.fp.qVd(eb,7,0))return ab=eb.currentNode,eb.reset(),ab;k.ULS.sendTraceTag(4235914,313,10,"GetNextFindableNode: No findable nodes");eb.reset();return null}pVk(){if(this.fp.Hpf){var ab=this.Cb;if((ab=ab?ab.hb.kb:null)&&this.xtb)return ab.Tc.vl?(ab=ab.Tc,E.SelectionEditor.du(ab)?(ab=ab.node,Object(u.a)(114,
ab)?ab:this.Tff(ab)):Object(u.a)(114,ab.node)?ab.node:this.Tff(ab.node)):this.Tff(this.fp.Yc);ab=this.Xc.Dk();ab.set(this.fp.Yc);if(this.fp.W6f(ab,8,1)){k.ULS.sendTraceTag(4069018,313,50,"No Selection: No selection, choosing title or first findable");const eb=ab.currentNode;ab.reset();return eb}k.ULS.sendTraceTag(4235915,313,10,"TryMoveToPageLeadingContent failed")}k.ULS.sendTraceTag(4235916,313,10,"Error: ContentView isn't PageView");return null}Shf(){const ab=this.Xc.Dk();ab.set(this.eVb);if(1===
ab.Jp())return ab.Xd(),ab.currentNode;k.ULS.sendTraceTag(4069019,313,15,"Something went wrong in GetStartingNode...");return null}UOn(ab){const eb=this.Hc.Rc(3);eb.Db(this.eVb);const zb=this.Xc.Dk();zb.set(this.eVb);zb.bD()&&(zb.Xd(),zb.Eg());ab&&(zb.Sf(ab,81),ab=this.kia[this.KK],this.eVb.rVf=ab.rootNode.type,this.eVb.w9e=ab.C1b);eb.dispose()}Bol(){if(this.oob){var ab=this.Xc.Dk();ab.set(this.oob);if(ab.Jp())return ab.Xd(),ab.currentNode;ab=this.VCe(this.fp.Yc);ab.moveNext();if(ab.currentNode)return ab.currentNode}k.ULS.sendTraceTag(4069020,
313,15,"Something went wrong in GetCurrentNode...");return null}zYi(ab){const eb=this.Hc.Rc(3);eb.Db(this.oob);const zb=this.Xc.Dk();zb.set(this.oob);zb.bD()&&(zb.Xd(),zb.Eg());ab&&(zb.Sf(ab,81),ab=this.kia[this.KK],this.oob.rVf=ab.rootNode.type,this.oob.w9e=ab.C1b);eb.dispose()}dJd(){let ab=this.Ej.YD||this.Ej.JAa;if(ab){for(var eb=!1,zb=!0;ab;){var Ua=this.fp.Ui.Eb(ab.nodeId);if(Ua=Object(n.a)(114,Ua))if(eb=Ua.Zyf(ab.type)){zb&&(ab=this.Ej.CYa(ab));break}else ab=this.Ej.CYa(ab);else if(zb=ab,ab=
this.Ej.M2b(ab),this.Ej.QXc(zb.nodeId),!ab||zb.nodeId.equals(ab.nodeId))break;zb=!1}eb?(this.Ej.YD=ab,this.Ej.gmb(),k.ULS.sendTraceTag(4065248,313,50,"FindManager GoToNextHit Success")):k.ULS.sendTraceTag(4069022,313,15,"Failed to go to Next Hit")}}eJd(){let ab=this.Ej.YD||this.Ej.JAa;if(ab){for(var eb=!1,zb=!0;ab;){var Ua=this.fp.Ui.Eb(ab.nodeId);if(Ua=Object(n.a)(114,Ua))if(eb=Ua.upi(ab.type)){zb&&(ab=this.Ej.DHd(ab));break}else ab=this.Ej.DHd(ab);else if(zb=ab,ab=this.Ej.sTh(ab),this.Ej.QXc(zb.nodeId),
!ab||zb.nodeId.equals(ab.nodeId))break;zb=!1}eb?(this.Ej.YD=ab,k.ULS.sendTraceTag(4065249,313,50,"FindManager GoToPreviousHit Success")):k.ULS.sendTraceTag(4069024,313,15,"Failed to go to Previous Hit");this.Ej.gmb()}}Ark(){return 2===this._state&&(this.sTf||this.Zmd&&this.MCd.oSi)}xFf(){this.fp.Pta?(this.YUa=this.Jca.qVc(this.pV.text),this.a8a=this.fp.Ui,this.IRi()):this.fSi()}x7i(){this.Zmd&&this.MCd.start()}CVe(){if(!this.fp.Pta||this.a8a!==this.fp.Ui)return this.Iab(),this.fSi(),!0;this.dnc=0;
return!1}uUf(){const ab=this.Jca.VGb(this.YUa),eb=this.Ark();let zb=!1;if(eb||this.fp.hgi(this.avc,this.Jqc,this.pV,ab)){zb=!0;this.Dkb(!1);this.$6a.update();this.$6a.z9e();!eb&&this.fp.sgi(this.avc,this.Jqc,this.pV,ab)?(this.Ej.Cpi(),this.Ej.P1=null,this._state=1):(this.B7m(),this.j0i(),this._state=0,this.Cpd=!0);this.avc=this.pV;this.Jqc=ab;try{this.pQb=this.qQb.w3b(this.Jqc.join("|"),this.pV)}catch(Ua){return k.ULS.sendTraceTag(0,313,10,"FindManager Find being completed because of invalid search with case filter {0} and whole word {1} .",
this.pV.matchCase,this.pV.matchWholeWord),this.pQb=null,this._state=2,this.Dkb(!0),!0}this.l5=new e.a(2,1,this.$hc,Object(v.a)(this,this.findInternal,"findInternal"),52);this.taskManager.$b(this.l5)}return zb}dwi(){if(!this.p6a){const ab=this.Xc.Dk();ab.set(1===this.kia[this.KK].C1b?this.fp.Yc:this.kia[this.KK].rootNode);this.fp.W6f(ab,this.kia[this.KK].rootNode.type,this.kia[this.KK].C1b)?(this.p6a=ab.currentNode,ab.reset()):(k.ULS.sendTraceTag(17306254,313,10,"TryToMoveToPageLeadingParagraph failed."),
ab.reset(),this.l5=new e.a(2,1,this.$hc,Object(v.a)(this,this.findInternal,"findInternal"),52),this.taskManager.$b(this.l5))}}iFf(){this.Ej.gmb();this.zYi(this.Gya.currentNode);this.Gya.currentNode===this.Shf()&&(this.KK++,this.KK===this.kia.length?(this.KK=0,this._state=2,this.Cpd=!1,this.Dkb(!0)):this.j0i());this.Gya=null}yZh(){return this.Shf()}bGi(){const ab=this.Bol();this.Gya=this.Xc.Dk();this.Gya.set(ab);this.Gya.O_(this.kia[this.KK].rootNode)}I0i(){const ab=this.Hc.Rc(3);ab.Db(this.Gya.currentNode);
return ab}cJf(){this.Pjf(this.Gya.currentNode,this.kia[this.KK].C1b,this.xtb);this.fp.qVd(this.Gya,this.kia[this.KK].rootNode.type,this.kia[this.KK].C1b)}FYe(ab){return!!this.Gya.currentNode&&!this.Gya.currentNode.id.equals(ab.id)}Klh(ab){!this.nRb&&this.p6a&&ab.id===this.p6a.id&&this.Shf().id!==this.p6a.id&&0<this.Ej.P3a&&(this.nRb=!0,this.Ej.BRi())}Tqd(ab,eb,zb,Ua){const Ab=this.Ej.z3b(ab);Ab?this.Ej.h4d(ab,eb):this.nRb?this.Ej.r7g(eb):this.Ej.Xqd(eb);this.xtb&&!this.Ej.YD&&0<eb.length&&zb.Zyf(Ua)&&
(this.Ej.YD=Ab?Ab:eb[0],this.Ej.D7||(this.Ej.D7=this.Ej.YD))}uPa(ab,eb){ab.uPa(eb)}Yja(ab){this.xtb&&ab.Yja()}hzf(ab){ab.gk(16,!0)}static hE(ab,eb,zb,Ua,Ab=!1){eb||(eb=Ja.instance);zb||(zb=Y.instance);const mb=ka.createInstance(ab,zb.s3f,Ab),Rb=new t.a(()=>Ra.createInstance(Sa.instance,Sa.instance.Ej)),hc=new t.a(()=>la.createInstance(Sa.instance.Ej)),Hb=new t.a(()=>qa.createInstance(Sa.instance,ab));return new Sa(ab,eb,zb,Ua,ca.FindManagerHelper.instance,new t.a(()=>l.AFrameworkApplication.uc),new t.a(()=>
P.a.instance),new y.a,new B.a,G.a.createInstance,a.a.instance,mb,Rb,hc,Hb,Ab)}static get instance(){return Sa._instance}static createInstance(ab,eb=null,zb=null,Ua=!1,Ab=!1){return Ab?Sa.hE(ab,eb,zb,Ua,!0):Sa.instance||(Sa._instance=Sa.hE(ab,eb,zb,Ua))}}Sa._instance=null;Object(C.a)(Sa,"FindManager",U.a,[])},1844:function(C,N,d){C=d(0);var l=d(22),e=d(2),a=d(205),k=d(5),n=d(17),v=d(45),u=d(8),t=d(72),y=d(120),B=d(76),G=d(20),F=d(197),K=d(14),O=d(6),H=d(595),I=d(64),J=d(108),L=d(808),S=d(997),E=d(40),
P=d(223),T=d(211),U=d(92);class X{constructor(Rb){this.Oma=Rb}}Object(C.a)(X,"ValidParentData",null,[]);var Y=d(43),ca=d(48),da=d(392),ua=d(668),ra=d(386),qa=d(667),ka=d(536);class la{constructor(){this.X_b=0}}Object(C.a)(la,"BelowOutlineElementData",null,[]);var Ha=d(644),wa=d(851),Ca=d(553);class Ja extends Ha.a{constructor(Rb,hc,Hb,Ta){super(4,Ta);this.W_b=Rb;this.Mub=hc;this.vzc=Hb}$3b(){var Rb=this.W_b;if(!Rb)return u.ULS.shipAssertTag(16819992,300,!1,"IParagraphStateWithChps not provided for DeletePara GetUpdateHintsForOperation"),
null;const hc=[],Hb=new wa.a(this.W_b.id,this.W_b.Nc,this.Mub?this.Mub.id:null);""!==Rb.characterData&&Rb.characterData&&(Rb=new Ca.DeleteTextUpdateHint(this.W_b.id,0,Rb.characterData),hc.push(Rb));hc.push(Hb);return hc}}Object(C.a)(Ja,"DeleteParagraphOperation",Ha.a,[]);var bb=d(928),ha=d(499);class ia extends Ha.a{constructor(Rb,hc,Hb,Ta,Aa){super(3,Aa);this.Qma=Rb;this.NNa=hc;this.WKm=Hb;this.tua=Ta}$3b(){const Rb=[];var hc=new bb.AddParagraphUpdateHint(this.tua.id,this.tua.Nc,this.Qma?this.Qma.id:
null);Rb.push(hc);""!==this.tua.characterData&&this.tua.characterData&&(hc=new ha.a(this.tua.id,0,this.tua.characterData),Rb.push(hc));return Rb}}Object(C.a)(ia,"InsertNewParagraphOperation",Ha.a,[]);var va=d(927);class Ka extends Ha.a{constructor(Rb,hc,Hb,Ta){super(2,Ta);this.Qma=Rb;this.NNa=hc;this.LUd=Hb}$3b(){const Rb=[],hc=new va.MergeParagraphUpdateHint(this.Qma.id,this.Qma.Nc,this.Qma.characterData.length,this.NNa.id,this.NNa.Nc,this.LUd.id,this.LUd.Nc);Rb.push(hc);return Rb}}Object(C.a)(Ka,
"MergeParagraphOperation",Ha.a,[]);var Xa=d(850);class xa extends Ha.a{constructor(Rb,hc,Hb,Ta,Aa){super(1,Aa);this.W2=Rb;this.Z6i=hc;this.Mub=Hb;this.vzc=Ta}$3b(){const Rb=[],hc=new Xa.a(this.W2.id,this.W2.Nc,this.Z6i,this.Mub.id,this.Mub.Nc,this.vzc.id,this.vzc.Nc);Rb.push(hc);return Rb}}Object(C.a)(xa,"SplitParagraphOperation",Ha.a,[]);var Ma=d(395),Na=d(9),pa=d(551),Ra=d(49),Sa=d(1064),ab=d(38),eb=d(134),zb=d(247),Ua=d(11),Ab=d(188);d.d(N,"a",function(){return mb});class mb{constructor(Rb,hc,
Hb,Ta,Aa,ma=null,Ga=null,Fa=null,ib=null){this.BJ=Rb;this.uG=hc;this.Cf=Hb;this.gca=ma;this.G4=Ga;this.iS=Fa;this.BC=ib}k0j(Rb){G.a.instance.J(4)&&Na.App.ud&&Na.App.ud.Mp&&Na.App.ud.Lq.CG(Rb)}Hva(Rb,hc,Hb,Ta=!1){E.OutlineElementNavigator.De(Rb);Ua.ParagraphReader.zh(Rb)?mb.paragraphEditor.qp.Hva(Rb,hc,Hb):ab.TableReader.isTable(Rb)&&14===Rb.Qe&&(hc=(new ra.a(1,Hb)).kt,Hb=Object(t.a)(da.TableNode,Rb.currentNode),this.s0i(Hb,hc,Ta));E.OutlineElementNavigator.Zd(Rb)}s0i(Rb,hc,Hb=!1){Rb&&Object(y.a)(da.TableNode,
Rb)&&(Hb?hc?(Rb.setValue(k.a.fe,hc),hc=ab.TableReader.kh(Rb),mb.Gk.FYf(Rb,hc)):Rb.removeProperty(k.a.fe):Rb.fe=hc)}get qp(){return S.a.GAb}get eR(){return this.iS||(this.iS=l.a.instance.resolve("Box4.Styles.IWACStyleEditor"))}get oc(){return this.BC||(this.BC=l.a.instance.resolve("Box4.Styles.IWACStyleReader"))}get Qd(){return null!=this.Wrg?this.Wrg:this.Wrg=l.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance}get Nj(){return null!=this.Irg?this.Irg:this.Irg=l.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance}get Ko(){return this.uG.value}get hd(){return this.Cf.value}get rK(){return this.BJ.value}get Zf(){return zb.a.instance}get LC(){return null!=
this.zhg?this.zhg:this.zhg=l.a.instance.Pa("Box4.IContentControlConverter")}vxb(){const Rb=L.a.instance.createInstance(393229);Rb.setValue(n.a.sK,P.a.first);Rb.setValue(n.a.ROk,new Date);Rb.Sce();return Rb}bMk(){const Rb=new Sa.a;Rb.setValue(n.a.sK,P.a.first);return Rb}N5e(Rb,hc,Hb=!1){Y.OutlineElementReader.ltf(Rb)?(Rb=Y.OutlineElementReader.isRtl(Rb),Hb?this.OJb(hc,Rb):this.NJb(hc,Rb)):this.Jqn(hc)}kec(Rb,hc){const Hb=E.OutlineElementNavigator.Uk(Rb);Y.OutlineElementReader.hm(Hb)!==hc&&(this.NJb(Hb,
hc),Rb.anchor.SW(4))}NJb(Rb,hc){const Hb=new Ra.GraphTransaction(7);Hb.Db(Rb);this.OJb(Rb,hc);const Ta=new O.GraphIterator;Ta.set(Rb);Ma.a.instance.I7l(Ta);if(Ta.Bb(10)){const Aa=Ta.kd(10);Ta.Rb(1)===Rb&&this.rK.NJb(Aa,hc)}Hb.dispose()}OJb(Rb,hc){let Hb=null,Ta=null;if(G.a.instance.J(3)&&Rb.isConnected){Hb=Ua.ParagraphReader.Sw(Rb,!0,!0);Ta=new B.a;for(let Aa=0;Aa<Hb.count;Aa++)12===Hb.J(Aa).type&&Ta.add(Hb.J(Aa).Kz())}Rb.properties.setValue(n.a.wX,hc);if(G.a.instance.J(3)&&Hb&&Ta)if(Hb.count!==Ta.count)u.ULS.shipAssertTag(35973010,
376,!1,"Paragraph count [{0}] doesn't match PreviousFormatProp count [{1}]",Hb.count,Ta.count);else for(Rb=0;Rb<Hb.count;Rb++)this.Nj.nM(Hb.J(Rb),Ta.J(Rb),this.Qd.ng)}Jqn(Rb){Rb.properties.removeProperty(n.a.wX)}zN(Rb,hc=null,Hb=!1){var Ta=null;let Aa=null;if(!Y.OutlineElementReader.Nh(Rb))return u.ULS.sendTraceTag(40502923,307,15,"GraphIterator does not point to an outline element."),null;var ma=null;let Ga=null,Fa=0;hc&&(ma=hc.formatting,Ga=hc.uwa,Fa=hc.languageId);Hb||({Qma:Ta,NNa:Aa}=this.xLh(Rb,
Ta,Aa));hc=F.a.instance.createInstance(393230);hc.setValue(n.a.lo,"");Rb.Sf(hc,2);Rb.Ei(hc);mb.paragraphEditor.sIb(hc);mb.paragraphEditor.JDm(hc);mb.paragraphEditor.o4a(hc);this.k0j(hc);ma&&(hc.qa.first.formatting.Bj=ma);Fa||(Fa=e.AFrameworkApplication.lcid);Rb.currentNode.lh(n.a.VIb,Rb.currentNode.ia(n.a.VIb,Fa));Rb.currentNode.setValue(k.a.gOa,0);!G.a.instance.J(10)||G.a.instance.J(8)||Ga||(ma=this.oc.Qx(hc))&&(Ga=ma.xh(ca.StyleReader.styleIdNormal));Ga&&this.eR.oM(Ga,hc,!0);!Hb&&Ta&&(Hb=new ka.a(hc),
Ta=new ia(Ta,Aa,Ta,Hb,hc.sAa),Rb.currentNode.YG().AF.JJ(Ta));return hc}xLh(Rb,hc,Hb){Hb=new O.GraphIterator;Hb.fd(Rb);hc=null;Hb.Hqf?Hb.currentNode.YG().AF.y9(6):(E.OutlineElementNavigator.R2(Hb,!0,!1),hc=this.VFd(Hb));Hb.fd(Rb);Hb=this.DMh(Hb);return{Qma:hc,NNa:Hb}}DMh(Rb){const hc=new O.GraphIterator;hc.fd(Rb);Rb=null;hc.sCa||(E.OutlineElementNavigator.Vr(hc,!0,!1),Rb=this.VFd(hc));return Rb}VFd(Rb,hc=!1){Rb=E.OutlineElementNavigator.De(Rb,!0);return Rb?this.DRh(Rb,hc):(u.ULS.sendTraceTag(8451733,
355,15,"No paragraph node below OutlineElement"),null)}DRh(Rb,hc=!1){if(12===Rb.type)return hc?new ka.a(Rb):new qa.a(Rb);Rb.YG().AF.y9(5);return new ua.a(Rb)}Rxk(Rb,hc){var Hb=hc.currentNode.clone();Rb.cH(Hb,null,1);Rb.Ei(Hb);Hb.Lra=hc.currentNode;E.OutlineElementNavigator.De(hc);hc.p6&1&&hc.currentNode.yMb(null);Hb=hc.currentNode.clone();Hb.D3=hc.currentNode.D3;Hb.gJ=hc.currentNode.gJ;Rb.cH(Hb,null,2);Rb.Ei(Hb);Rb.GZ(1);Hb.Lra=hc.currentNode;G.a.instance.J(5)&&Hb.setValue(k.a.Nc,a.a.RF());hc.it(11)}sIb(Rb){Rb.Rb(2)&&
Rb.Eg()}eun(Rb,hc){const Hb=Rb.currentNode;E.OutlineElementNavigator.De(Rb);const Ta=Rb.currentNode;E.OutlineElementNavigator.Zd(Rb);hc.oE(1);E.OutlineElementNavigator.De(hc);Rb.Sf(hc.currentNode,2);hc.Eg();var Aa=new O.GraphIterator;Aa.fd(hc);if(Aa.Rb(1)){const ma=new O.GraphIterator;ma.fd(Rb);const Ga=new X(null);if(!this.HOl(ma,Aa.currentNode,Ga))return;H.f(ma,null,1,1,Aa,-1)}hc.Eg();Aa=null;Rb.aD(1)&&(Aa=Rb.currentNode);for(Rb.mc();T.OutlineNavigator.P6(hc);)Rb.cH(hc.currentNode,Aa,1),Aa=hc.currentNode,
hc.Eg();Rb.Ei(Hb);Rb.Ei(Ta);Rb.Eg()}mba(Rb,hc,Hb,Ta,Aa,ma,Ga=!1,Fa=!1){var ib,ob=Y.OutlineElementReader.Nh(Rb),fb=Y.OutlineElementReader.Nh(hc),Mb=Hb.Rd&&Hb.contextId===K.a.Wc;ob&&fb&&Mb||u.ULS.sendTraceTag(594642515,307,15,"sourceOutlineElementIsValid:{0}; destinationOutlineElementIsValid:{1}; ipContextIsValid:{2}",ob,fb,Mb);var Tb=Rb.currentNode;if(null===(ib=this.gca)||void 0===ib?0:ib.splitParagraph){if(11===Rb.Qe)E.OutlineElementNavigator.De(Rb),hc=Rb.currentNode,E.OutlineElementNavigator.Zd(Rb);
else if(12===Rb.Qe)hc=Rb.currentNode;else throw Error(`Unexpected node type ${Rb.Qe}`);this.gca.splitParagraph(hc,Hb.cpBegin)}else{this.sIb(hc);ob=hc.Qe;var rc=null;ib=fb=null;var vb=!1;E.OutlineElementNavigator.De(Rb);Mb=Rb.Qe;if(Ua.ParagraphReader.zh(Rb)){var Ya=Rb.currentNode;(fb=Object(t.a)(eb.AParagraphNode,Ya))?fb.qa&&fb.qa.length||u.ULS.sendTraceTag(38925760,307,15,"srcParaNode: {0}. srcParaNode has no characterProperties",fb):u.ULS.sendTraceTag(38925731,307,15,"srcParaNode is null");fb=new ka.a(fb);
(vb=Hb.cpBegin===Ua.ParagraphReader.textLength(Ya))&&(ib=this.DMh(hc));const wb=hc.currentNode;rc=this.zN(hc,void 0,!0);mb.paragraphEditor.OPa(Rb,hc,Hb,Aa,ma,Ga,Fa);G.a.instance.J(10)&&(Ta?(Aa=this.oc.yo(Ya))&&this.eR.oM(Aa,rc,!0):vb&&(Aa=this.oc.yo(Ya))&&((Fa=Aa.ia(v.a.ee,null))?(Aa=this.oc.Qx(rc).xh(Fa),this.eR.oM(Aa,rc,!1)):this.eR.oM(Aa,rc,!0)));this.N5e(Tb,wb)}E.OutlineElementNavigator.Zd(Rb);E.OutlineElementNavigator.Zd(hc);E.OutlineElementNavigator.De(Rb);(Tb=Object(t.a)(eb.AParagraphNode,
Rb.currentNode))?Tb.qa&&Tb.qa.length||u.ULS.sendTraceTag(38925762,307,15,"srcParaNode: {0}. srcParaNode has no characterProperties",Tb):u.ULS.sendTraceTag(38925761,307,15,"srcPara is null");Tb=new ka.a(Tb);E.OutlineElementNavigator.Zd(Rb);(Rb=rc)?Rb.qa&&Rb.qa.length||u.ULS.sendTraceTag(38925764,307,15,"paragraphNode: {0}. paragraphNode has no characterProperties.",Rb):(u.ULS.sendTraceTag(38925763,307,15,"paragraphNode is null"),u.ULS.sendTraceTag(40425482,307,50,"SplitAtIp state. {0}",{["splittingAtEnd"]:vb,
["moveText"]:ma,["overrideParagraphStyle"]:Ta,["sourceOutlineElementContentNodeType"]:Mb,["destinationOutlineElementNodeType"]:ob,["alwaysMoveEopToDestinationPara"]:Ga}));vb?(Hb=new ka.a(Rb),Hb=new ia(fb,ib,Tb,Hb,Rb.sAa),hc.currentNode.YG().AF.JJ(Hb)):(Hb=ma?new xa(fb,Hb.cpBegin,Tb,new ka.a(Rb),Rb.sAa):new xa(fb,Hb.cpBegin,new ka.a(Rb),Tb,Rb.sAa),hc.currentNode.YG().AF.JJ(Hb))}}Fjh(Rb,hc){E.OutlineElementNavigator.De(Rb);let Hb=Ua.ParagraphReader.xu(Rb.currentNode)&&this.irk(Rb);const Ta=Rb.currentNode;
Hb=hc?Hb&&!this.Zf.Z1m(Ta):Hb&&!this.Zf.P1m(Ta);E.OutlineElementNavigator.Zd(Rb);return Hb}irk(Rb){return Ua.ParagraphReader.zh(Rb)&&!Ua.ParagraphReader.gbb(Rb.currentNode)}merge(Rb,hc,Hb,Ta,Aa=null,ma=!1,Ga,Fa=!1,ib=!1,ob=!1){var fb;if(Rb.currentNode.id===hc.currentNode.id)return!1;let Mb;const Tb=new O.GraphIterator;Tb.fd(hc);Ga=this.VFd(Tb);Tb.fd(Rb);Mb=this.VFd(Tb,!0);if(!this.Fjh(hc,!0)||!this.Fjh(Rb,!1))return!1;if(this.Zf.yh){E.OutlineElementNavigator.De(Rb);E.OutlineElementNavigator.De(hc);
var rc=Ua.ParagraphReader.zh(Rb)?Rb.currentNode:null,vb=Ua.ParagraphReader.zh(hc)?hc.currentNode:null;E.OutlineElementNavigator.Zd(Rb);E.OutlineElementNavigator.Zd(hc);if(rc&&vb&&!this.Zf.Gjh(rc,vb,!1)){if(!this.LC||!this.Zf.Gjh(rc,vb,!0))return!1;this.LC&&(this.LC.vej(rc,!1),this.LC.vej(vb,!0))}}rc=Object(t.a)(eb.AParagraphNode,Rb.currentNode);rc=(Hb||!rc||!rc.characterData.length)&&!I.ListReader.ai(Rb);Fa||this.Ko.merge(Rb,hc,rc,Aa);E.OutlineElementNavigator.De(Rb);Fa=Rb.currentNode.sAa;E.OutlineElementNavigator.De(hc);
if(Ua.ParagraphReader.zh(hc)){Aa=hc.currentNode;if(G.a.instance.J(4)&&Na.App.ud.Mp&&(rc=Rb.currentNode,vb=pa.CoauthLockEditor.getInstance(),vb.V2a(this.Zf.q2b(Aa))||vb.V2a(this.Zf.q2b(rc))))return hc.mc(),Rb.mc(),!1;rc=!1;I.ListReader.rr&&(vb=Rb.parentNode)&&Y.OutlineElementReader.X$(vb)&&(rc=I.ListReader.w2(vb));vb=this.gSn(Ua.ParagraphReader.isEmpty(Rb),rc,Hb,Ta,ib);if(G.a.instance.J(10)&&vb){var Ya=this.oc.nId(hc);Ya&&this.eR.oM(Ya,Rb.currentNode,!0)}if(Hb){Ya=hc.currentNode;const wb=Rb.currentNode;
Ab.s()&&vb&&Ab.b(Ya,wb);ib&&Ta||this.G4.Zqi(Ya,wb,rc);e.AFrameworkApplication.Hl("Microsoft.Office.Web.SessionSettings.IWacWordPreserveEopFormattingPasteSettings");ob&&(ib=this.mGk(wb,Ya),u.ULS.sendTraceTag(588288132,307,50,"wasCopied: {0}",ib))}Hb=mb.paragraphEditor.merge(Rb,hc,Hb,Ta,ma);Ta=Tb.currentNode;ma=Rb.currentNode;Rb.mc();Hb&&Y.OutlineElementReader.isEmpty(hc,!0)&&this.iXa(hc);Rb=new Ka(Mb,Ga,new qa.a(Ta),Fa);ma.YG().AF.JJ(Rb);(null===(fb=this.gca)||void 0===fb?0:fb.oBc)&&this.gca.oBc(Ta,
Aa);return!0}hc.mc();Rb.mc();return!1}mGk(Rb,hc){let Hb=null;hc&&hc.qa&&0<hc.qa.length&&hc.qa.first.Xh&&(Hb=hc.qa.first.formatting);return Hb&&Rb&&Rb.qa&&0<Rb.qa.length&&J.FormattingReader.VDk(Rb.qa)?(Rb.qa.last.formatting=Hb.Yf(Rb.qa.last),!0):!1}gSn(Rb,hc,Hb,Ta,Aa){return hc?!1:Hb?!(Ta&&Aa):Rb}g6l(Rb){const hc=new O.GraphIterator;hc.set(Rb.node);hc.vd();E.OutlineElementNavigator.Zd(hc);const Hb=this.xta(hc),Ta=this.xta(hc);this.mba(hc,Hb,Rb,!1,!0,!0);Y.OutlineElementReader.isEmpty(hc,!1)&&(this.Ko.RDa(hc),
hc.Eg());Y.OutlineElementReader.isEmpty(Hb,!1)&&!Y.OutlineElementReader.bgb(Hb)&&(this.Ko.RDa(Hb),Hb.Eg());return Ta}eD(Rb,hc,Hb,Ta=null,Aa=!1,ma=!0){if(!this.frk(Rb))return null;const Ga=Rb.currentNode;var Fa=!1;ma&&(Fa=I.ListReader.ai(Rb),Aa=hc||Aa||!Y.OutlineElementReader.isEmpty(Rb,!1),Fa=this.Ko.xVn(Fa,Aa));Aa=hc?Rb.aD(1):Rb.currentNode;Rb.mc();Hb=this.rK.qfb(Rb,Aa,Hb,Ta);if(!Hb)return null;this.N5e(Ga,Hb);ma&&Fa&&this.Ko.jao(Rb,hc,Ga,Hb);return Hb}frk(Rb){return Y.OutlineElementReader.Nh(Rb)&&
(Rb=Rb.parentNode,U.OutlineReader.DPd(Rb)||Y.OutlineElementReader.X$(Rb)||Y.OutlineElementReader.tCa(Rb))?!0:!1}QDa(Rb){const hc=new O.GraphIterator;hc.set(Rb);hc.vd();hc.it(11);let Hb=null,Ta=null;({Qma:Hb,NNa:Ta}=this.xLh(hc,Hb,Ta));let Aa=-1;12===Rb.type&&(Aa=Rb.sAa);hc.currentNode?(hc.currentNode.YG().AF.JJ(new Ja(this.DRh(Rb,!0),Hb,Ta,Aa)),this.iXa(hc)):u.ULS.sendTraceTag(574650269,324,15,"The content to be deleted does not have a containing OE")}iXa(Rb){if(Rb.aq(1)){const hc=new la,Hb=new O.GraphIterator;
Hb.fd(Rb);this.bjl(Hb,hc)&&this.qp.KDc(Rb,-hc.X_b)}Rb.Eg();ab.TableReader.Yw(Rb)&&this.z6m(Rb)}hof(Rb,hc,Hb){if(!U.OutlineReader.xw(Rb)&&!Y.OutlineElementReader.Nh(Rb))return null;const Ta=this.bMk();0<Hb&&Hb<P.a.last&&Ta.setValue(n.a.sK,Math.min(P.a.nil,Hb));Rb.cH(Ta,hc,1);return Ta}i6l(Rb,hc){if(!Y.OutlineElementReader.Nh(Rb)&&!Y.OutlineElementReader.kK(Rb)||!U.OutlineReader.Ota(Rb.parentNode)&&!Y.OutlineElementReader.X$(Rb.parentNode))return null;const Hb=Rb.currentNode;let Ta;Ta=Rb.currentNode;
Rb.mc();hc=this.hof(Rb,Ta,hc);Rb.Ei(Hb);return hc}z6m(Rb){Y.OutlineElementReader.kK(Rb)&&(Rb.aq(1)||Rb.Eg());this.JIh(Rb,!1);this.Gah(Rb)}JIh(Rb,hc){var Hb,Ta=null;for(Hb=Rb.Rb(1);Hb;){var Aa=!1;Y.OutlineElementReader.tCa(Hb)&&!Rb.aq(1)&&(Aa=!0);var ma=Hb;Hb=Rb.Wi(1);if(Aa)Aa=new O.GraphIterator,Aa.set(ma),Aa.vd(),Aa.Eg();else if(Y.OutlineElementReader.tCa(ma)){if(Ta){Aa=new O.GraphIterator;Aa.set(Ta);var Ga=new O.GraphIterator;Ga.set(ma);Ga.vd();Aa.Sf(Ga.currentNode,1);Ga.Eg();Ga=Y.OutlineElementReader.sea(ma);
Ga===P.a.nil&&(Ga=1);const Fa=Y.OutlineElementReader.sea(ma);(Ga=Math.max(0,Fa-Ga))?ma.setValue(n.a.sK,Math.min(P.a.nil,Ga)):(Aa.Ei(ma),Rb.Rb(1),H.d(Aa),Aa.mc());hc&&this.JIh(Aa,!0)}}else Ta=ma}hc=null;Ta=P.a.last+1;for(Hb=Rb.Rb(1);Hb;Hb=Rb.Wi(1))if(Y.OutlineElementReader.kK(Rb))ma=Y.OutlineElementReader.sea(Hb),Ta>ma&&(Ta=ma,hc=Hb);else{Rb.mc();return}if(hc){for(Hb=Rb.Rb(1);Hb;Hb=Rb.Wi(1))Hb!==hc&&(Hb=Y.OutlineElementReader.sea(Hb),Rb.currentNode.setValue(n.a.sK,Math.min(P.a.nil,Hb-Ta)));Ta+=Y.OutlineElementReader.sea(Rb.currentNode);
Rb.currentNode.setValue(n.a.sK,Math.min(P.a.nil,Ta));Hb=new O.GraphIterator;Hb.fd(Rb);Hb.Ei(hc);Hb.Rb(1);H.d(Hb)}}HOl(Rb,hc,Hb){var Ta=Y.OutlineElementReader.sea(Rb.currentNode);if(1===Ta)return!0;if(Y.OutlineElementReader.kK(Rb))return!1;if(!Rb.tdb(1)||this.ghm(Rb,hc))return Rb.currentNode.setValue(n.a.sK,Math.min(P.a.nil,1)),!0;if(Hb.Oma&&Rb.Ei(Hb.Oma)){if(Y.OutlineElementReader.kK(Rb)&&1===Ta+Y.OutlineElementReader.sea(Rb.currentNode))return Hb.Oma=Rb.oE(1),Rb.mc(),!0;Rb.mc()}if(Hb.Oma&&Rb.Ei(Hb.Oma)||
!Hb.Oma&&Rb.Rb(1)){if(Rb.currentNode!==hc&&Rb.vf(1)&&Y.OutlineElementReader.kK(Rb)&&1===Ta+Y.OutlineElementReader.sea(Rb.currentNode))return Hb.Oma=null,!0;Rb.mc()}if(Rb.zeb(hc)&&this.fhm(Rb,hc)){for(Hb=Rb.Rb(1);Hb;Hb=Rb.Wi(1))if(Hb!==hc){var Aa=Y.OutlineElementReader.sea(Hb);Hb.setValue(n.a.sK,Math.min(P.a.nil,Aa+(Ta-1)))}Rb.currentNode.setValue(n.a.sK,Math.min(P.a.nil,1));return!0}if(1>Ta)return Ta=this.hof(Rb,Hb.Oma,1-Ta),Rb.Ei(Ta),Hb.Oma=null,!0;if(1<Ta){Rb.currentNode.setValue(n.a.sK,Math.min(P.a.nil,
1));hc=null;for(Aa=Rb.Rb(1);Aa;){if(Y.OutlineElementReader.kK(Rb)){Aa.setValue(n.a.sK,Math.min(P.a.nil,Ta-1+Y.OutlineElementReader.sea(Aa)));Aa=Rb.Wi(1);continue}hc||(hc=this.i6l(Rb,Ta-1));const ma=Aa;Aa=H.h(Rb,hc,1);Aa===hc&&(Aa=Rb.Wi(1));Hb.Oma===ma&&(Hb.Oma=hc,hc=null)}return!0}return!1}ghm(Rb,hc){return O.GraphIterator.Qka(()=>{if(1===Rb.tdb(1)){const Hb=Rb.Rb(1);Rb.mc();if(Hb===hc)return!0}return!1})}fhm(Rb,hc){return O.GraphIterator.Qka(()=>{let Hb;for(Hb=Rb.Rb(1);Hb;Hb=Rb.Wi(1))if(Hb!==hc&&
!Y.OutlineElementReader.kK(Rb))return Rb.mc(),!1;return!0})}bjl(Rb,hc){hc.X_b=0;do{const Hb=Rb.currentNode;if(Rb.Rb(1))hc.X_b-=Y.OutlineElementReader.sea(Hb);else{if(U.OutlineReader.xw(Rb)||null===Rb.currentNode)return!1;if(3!==Rb.role||!Rb.k6(1))for(;!Rb.Wi(1);)if(hc.X_b+=Y.OutlineElementReader.sea(Rb.currentNode),U.OutlineReader.xw(Rb)||null===Rb.currentNode)return!1}}while(Y.OutlineElementReader.kK(Rb));return!0}xta(Rb,hc=!1){return this.HMd(Rb,!1,hc)}f6l(Rb){return this.HMd(Rb,!0,!1)}HMd(Rb,hc,
Hb=!1){const Ta=new O.GraphIterator;Ta.fd(Rb);Rb=new O.GraphIterator;Rb.fd(Ta);this.eD(Rb,hc,!1,null,Hb);Rb.currentNode.setValue(n.a.sK,Math.min(P.a.nil,Y.OutlineElementReader.sea(Ta.currentNode)));Ta.Rb(1)&&H.f(Rb,null,1,1,Ta,-1);return Rb}Gah(Rb){if(Y.OutlineElementReader.Uvn(Rb)){1!==Y.OutlineElementReader.sea(Rb.currentNode)&&Rb.currentNode.setValue(n.a.sK,P.a.first);for(var hc=Rb.Rb(1);hc;)if(Y.OutlineElementReader.kK(Rb)){hc=new O.GraphIterator;hc.fd(Rb);hc.mc();const Hb=new O.GraphIterator;
Hb.fd(Rb);Hb.Rb(1);H.f(hc,Rb.currentNode,1,1,Hb,-1);hc=Rb.gXa(1)}else this.Gah(Rb),hc=Rb.Wi(1)}}static get Gk(){return null!=mb.irg?mb.irg:mb.irg=l.a.instance.resolve("Box4.ITableEditor")}static get paragraphEditor(){return mb.su||(mb.su=l.a.instance.resolve("Box4.IParagraphEditor"))}static set paragraphEditor(Rb){mb.su=Rb}}mb.su=null;Object(C.a)(mb,"OutlineElementEditor",null,[536])},1845:function(C,N,d){C=d(0);var l=d(121),e=d(46),a=d(22),k=d(2),n=d(59),v=d(505),u=d(80),t=d(83),y=d(390),B=d(16),
G=d(374),F=d(58),K=d(142),O=d(57),H=d(35),I=d(13),J=d(1011),L=d(110),S=d(5),E=d(17),P=d(106),T=d(8),U=d(311),X=d(629),Y=d(684),ca=d(161),da=d(20),ua=d(21),ra=d(260),qa=d(261),ka=d(34),la=d(31);class Ha{constructor(ab){this.ry=null;this.oQg=!1;this.hp=null;this.Nt=new J.a;this.oca=new J.a;this.Bc=ab}get Rhb(){la.a(4281429,307,this.Nt.count===this.oca.count);return this.Nt.count}get BUd(){return this.oQg}set BUd(ab){this.oQg=ab}cYb(ab){this.ry=ab}get R1(){return null}Nah(ab,eb){this.Nt.add(ab);this.oca.add(eb)}}
Ha.vhb=2712;Object(C.a)(Ha,"APicturePasteHandler",null,[595]);var wa=d(263),Ca=d(3),Ja=d(9),bb=d(1126),ha;(function(ab){ab[ab.unknown=0]="unknown";ab[ab.other=1]="other";ab[ab.file=2]="file";ab[ab.blob=3]="blob";ab[ab.chromeExtension=4]="chromeExtension";ab[ab.cid=5]="cid"})(ha||(ha={}));Object(C.b)("UnsupportedUrlScheme",ha);var ia=d(256),va=d(49),Ka=d(11),Xa=d(1316),xa=d(1349),Ma=d(1710);class Na{constructor(){this.delay=this.retry=0}}Object(C.a)(Na,"ForceInboundData",null,[]);class pa{constructor(ab,
eb,zb,Ua){this.IKd=!1;this.request=ab;this.Jvn=eb;this.url=Ua;this.u6l=zb}}Object(C.a)(pa,"PicturePasteRequestInfo",null,[]);d.d(N,"a",function(){return Sa});const Ra=["ImageInsertFailed"];class Sa extends Ha{constructor(ab,eb,zb,Ua,Ab,mb=null,Rb=null,hc=!1,Hb=!1,Ta=!1,Aa=!1,ma=null,Ga=null){super(ab);this.em=l.a.nil;this.jA=new J.a;this.WHa=0;this.wqc=this.MYg=null;this.WWg=!1;this.Dtc=null;this.Oad=new J.a;this.zp=null;this.M7m=()=>{var Fa=this.Xil(),ib=131073;this.iKj&&(ib=1073872970);Fa=e.a.Pn(Fa,
U.a.cellId,this.hp.Zl.toString());Fa=e.a.Pn(Fa,U.a.R1,this.em.toString());Fa=e.a.Pn(Fa,U.a.classId,ib.toString());this.hp.jI&&(Fa=e.a.Pn(Fa,U.a.jI,this.hp.jI));Fa=e.a.Pn(Fa,U.a.Emb,"1");Fa=e.a.Pn(Fa,X.a.imageType,"1");Fa=wa.a.instance.XOe(Fa);this.hp.contentReplicator&&this.hp.contentReplicator.YDb&&(Fa=e.a.Pn(Fa,U.a.lTe,"1"));let ob=0;ib=Fa;var fb=new J.a;const Mb=new J.a,Tb=new J.a,rc=new J.a,vb=new J.a,Ya=new J.a;var wb="";for(let lc=0;lc<this.Rhb;lc++){T.ULS.shipAssertTag(7869452,307,!!this.oca.J(lc).src);
T.ULS.shipAssertTag(7869453,307,""!==this.oca.J(lc).src);T.ULS.shipAssertTag(7869454,307,19922944>this.oca.J(lc).src.length);var jb=ia.a.Cq;da.a.instance.J(4)&&(jb=this.Nt.J(lc).node.ia(L.a.mK,ia.a.Cq));this.pjo(this.Nt.J(lc).blob,this.oca.J(lc));var Zb=this.oca.J(lc).alt,Eb=this.oca.J(lc).NTk;this.Ase&&!Eb&&(Eb=Zb,Zb="");jb=Xa.a.construct(this.Nt.J(lc).blob?this.Nt.J(lc).blob.id.toString():this.Nt.J(lc).node.id.toString(),this.oca.J(lc).src,Zb,this.oca.J(lc).width,this.oca.J(lc).height,Eb,jb,this.Nt.J(lc).yT,
this.Nt.J(lc).blob?this.Nt.J(lc).blob.properties.ia(S.a.hfa,!1):!1,this.Nt.J(lc).blob?this.Nt.J(lc).blob.properties.ia(L.a.Zda,-1):-1,da.a.instance.J(4)&&this.Nt.J(lc).blob?this.Nt.J(lc).blob.properties.ia(S.a.lhb,Box4Intl.Box4Strings.l_Picture):"",this.Nt.J(lc).node?this.Nt.J(lc).node.properties.ia(E.a.ifa,!1):!1,null,null,null,this.oca.J(lc).cvd);if(this.oca.J(lc).src.startsWith("data:")){var tc=!1;(Zb=a.a.instance.Pa("Box4.IFeatureHelper"))&&Zb.isFeatureEnabled(11)&&Zb.isFeatureEnabled(48)&&this.oca.J(lc).cvd?
(tc=!0,Zb=vb,Eb=Ya):(Zb=Tb,Eb=rc);Zb.add(jb);Eb.add(this.Nt.J(lc));tc=xa.a.construct(Zb.toArray(),!tc,k.AFrameworkApplication.K.$("SendFileIdInPicturePasteRequestBodyIsEnabled")?this.hp.Fs:null,tc);tc=H.c(tc);tc.length>Sa.qGm?(T.ULS.shipAssertTag(7869456,307,1<Zb.count),Zb.remove(jb),Eb.remove(this.Nt.J(lc)),tc=this.jA.count?(new n.a(this.em,ob)).toString():this.hp.contentReplicator.eu.toString(),ib=e.a.Pn(ib,U.a.Ara,tc),ib=e.a.Pn(ib,U.a.Kac,ob.toString()),ua.ImageReader.increaseMaxWebFriendlyDimensionTo1600&&
(ib=e.a.Pn(ib,U.a.rMb,"1")),this.jA.add(new pa(xa.a.construct(Zb.toArray(),!0,k.AFrameworkApplication.K.$("SendFileIdInPicturePasteRequestBodyIsEnabled")?this.hp.Fs:null),wb,Eb,ib)),ob+=Tb.count,Zb=new J.a,Zb.add(jb),Eb=new J.a,Eb.add(this.Nt.J(lc))):wb=tc}else fb.add(jb),Mb.add(this.Nt.J(lc))}Tb.count&&(ib=Fa,tc=this.jA.count?(new n.a(this.em,ob)).toString():this.hp.contentReplicator.eu.toString(),ib=e.a.Pn(ib,U.a.Ara,tc),ib=e.a.Pn(ib,U.a.Kac,ob.toString()),ua.ImageReader.increaseMaxWebFriendlyDimensionTo1600&&
(ib=e.a.Pn(ib,U.a.rMb,"1")),wb=xa.a.construct(Tb.toArray(),!0,k.AFrameworkApplication.K.$("SendFileIdInPicturePasteRequestBodyIsEnabled")?this.hp.Fs:null),this.jA.add(new pa(wb,H.c(wb),rc,ib)),ob+=Tb.count,this.Oad.add(Sa.E$e));fb.count&&(ib=Fa,tc=this.jA.count?(new n.a(this.em,ob)).toString():this.hp.contentReplicator.eu.toString(),ib=e.a.Pn(ib,U.a.Ara,tc),ib=e.a.Pn(ib,U.a.Kac,ob.toString()),ib=e.a.Pn(ib,U.a.rMb,"1"),fb=xa.a.construct(fb.toArray(),!1,k.AFrameworkApplication.K.$("SendFileIdInPicturePasteRequestBodyIsEnabled")?
this.hp.Fs:null),this.jA.add(new pa(fb,H.c(fb),Mb,ib)),k.AFrameworkApplication.maa("WoInc325;WoInc325cf"),this.Oad.add(this.kFg));vb.count&&(ib=Fa,tc=this.jA.count?(new n.a(this.em,ob)).toString():this.hp.contentReplicator.eu.toString(),ib=e.a.Pn(ib,U.a.Ara,tc),ib=e.a.Pn(ib,U.a.Kac,ob.toString()),ib=e.a.Pn(ib,U.a.rMb,"1"),Fa=xa.a.construct(vb.toArray(),!1,k.AFrameworkApplication.K.$("SendFileIdInPicturePasteRequestBodyIsEnabled")?this.hp.Fs:null,!0),this.jA.add(new pa(Fa,H.c(Fa),Ya,ib)),this.Oad.add(this.kFg));
T.ULS.sendTraceTag(595068930,307,50,"Prepared "+(this.jA?this.jA.count:-1)+" picture paste requests to send");this.dkb()};this.picturePasteRequestSucceeded=Fa=>{T.ULS.sendTraceTag(572528019,307,50,"PicturePasteRequestSucceeded received response with Http status: {0}",this.Nul(Fa));if(({group:ib}=Y.a.M7(Fa.data.Ge)).returnValue){var ib=ib.Responses[0];if(ib.StatusCode)46!==ib.StatusCode||this.jA.J(this.WHa).IKd?(T.ULS.sendTraceTag(51212675,322,15,"Picture paste request failed with reason "+ib.StatusCode),
Fa=Object.assign(new ca.a,{extendedProperties:new Map}),Fa.extendedProperties.set("statuscode",ib.StatusCode.toString()),t.Health.instance.recordQosError("PictureRemotePasteFailed",Ra,!1,!0,!1,!1,Fa),this.YSl()):(this.jA.J(this.WHa).IKd=!0,this.dkb());else{let ob=ib="";Fa&&Fa.data&&Fa.data.rj&&(X.a.nD in Fa.data.rj&&Fa.data.rj[X.a.nD]&&(ob=Fa.data.rj[X.a.nD]),"X-CorrelationId"in Fa.data.rj&&Fa.data.rj["X-CorrelationId"]&&(ib=Fa.data.rj["X-CorrelationId"]));T.ULS.sendTraceTag(595068929,307,50,"PicturePasteRequestSucceeded called.[Status code: {0}][X-CorrelationID: {1}]",
ob,ib);this.Dtc&&(this.Dtc.stop(),this.Dtc=null);this.WHa++;this.tfj&&this.dkb();this.MYg=this.hp.contentReplicator.eu;let fb=null;fb=Object.assign(new Na,{retry:0,delay:this.Oad.J(this.WHa-1)});Fa=new u.a(2,1,Sa.E$e,()=>{this.hp.contentReplicator.j0d(this.YJh,null,fb)},124);this.Hb.$b(Fa)}}else T.ULS.sendTraceTag(7869457,307,10,"PicturePasteRequestSucceeded received null or empty server response group"),Fa=new v.a(Fa.data),this.Tac(Fa)};this.YJh=Fa=>{const ib=!n.a.Fp(this.MYg,this.hp.contentReplicator.eu);
T.ULS.sendTraceTag(8246492,307,50,"Revision changed after ForceInbound: {0}",ib);if(ib)this.vjh();else{const ob=Fa?Fa:null;if(Fa&&ob&&ob.retry<Sa.kdl){ob.retry+=1;Fa=new u.a(2,1,ob.delay,()=>{this.hp.contentReplicator.j0d(this.YJh,null,ob)},125);this.Hb.$b(Fa);return}Fa=Sa.E$e;null!=ob&&(Fa=ob.delay);Fa=new u.a(2,1,Fa,()=>{this.hp.contentReplicator.j0d(null,null,null)},125);this.Hb.$b(Fa);this.wjh()}Sa.GEf--;k.AFrameworkApplication.ya.processAction(I.a.m4a,2);Ma.a.instance.yhc(this.hp,0);this.sfg();
this.jw.sendNotification(Box4Intl.Box4Strings.l_ImageUploaded,!0)};this.Tac=Fa=>{var ib="",ob="";Fa&&Fa.data&&Fa.data.rj&&("X-CorrelationId"in Fa.data.rj&&Fa.data.rj["X-CorrelationId"]&&(ib=Fa.data.rj["X-CorrelationId"]),X.a.nD in Fa.data.rj&&Fa.data.rj[X.a.nD]&&(ob=Fa.data.rj[X.a.nD]));ob=""===ob?"":String.format("[Operation Result: {0}]",ob);ib=""===ib?"":String.format("[X-CorrelationID: {0}]",ib);T.ULS.sendTraceTag(51212676,322,15,"Picture paste request failed.[HttpStatus: {2}] [Connection state: {3}]{0}{1}",
ob,ib,Fa.data.wf,y.SessionStatusManager.instance.jK);9===Fa.data.status||this.jA.J(this.WHa).IKd?(Ma.a.instance.yhc(this.hp,127),this.glh(),this.Dtc=null,t.Health.instance.recordQosError("PictureRemotePasteFailed",Ra,!1,!0,!1,!1,null)):(this.jA.J(this.WHa).IKd=!0,this.dkb())};this.ij=eb;this.Hb=zb;this.wm=Ua;this.le=Ja.App.xa.jq;this.cpc=mb;this.JY=Rb;this.T8a=hc;this.qCe=Hb;this.Ase=Ta;this.lye=Aa;this._operationId=ma;this.sTj=Ga;this.kFg=k.AFrameworkApplication.K.rc("PicturePasteHttpForceInboundDelay",
3E3);this.WWg=this.K?this.K.$("ProvideUnsupportedUrlSchemeIsEnabled"):!1;Ja.App.mgc.addHandler(this);this.iKj=!!Ab&&Ab.isFeatureEnabled(128)}get jw(){return this.zp||(this.zp=a.a.instance.resolve("Common.Utils.IAriaNotifier"))}get K(){return k.AFrameworkApplication.K}get Sac(){return Ja.App.Sac}get oqi(){return this.Rhb===Ja.App.szf}get tfj(){return this.WHa!==this.jA.count}sfg(){k.AFrameworkApplication.K&&k.AFrameworkApplication.K.$("WordEditorInsertImagesFloodgateIsEnabled")&&window.setTimeout(()=>
{const ab=a.a.instance.Za("Common.ISystemInitiatedFeedback");ab&&ab.execute(eb=>{eb.logActivity("WordInsertImageApplied","WordEditorInsertImagesFloodgateIsEnabled")})},5E3)}get R1(){return this.em}Gua(ab){ab.alt.length>Ha.vhb&&(ab.alt=ab.alt.substring(0,B.a.Ny(ab.alt,Ha.vhb)?Ha.vhb-1:Ha.vhb));if(this.JY&&this.T8a&&this.qCe&&Sa.yem(ab)){this.lye&&O.c(Ca.a.N6k);var eb="unknown";this.WWg&&(ab=new URL(ab.src),eb=ha[bb.a.Vfo(ab.protocol)]);T.ULS.sendTraceTag(41969745,322,15,"Unable to paste image with local URL. OperationId: {0}, URL scheme: {1}, rtfDataStatus: {2}",
this._operationId,eb,this.sTj);ab=Object.assign(new ca.a,{extendedProperties:new Map});ab.extendedProperties.set("protocol",eb);t.Health.instance.recordQosError("PictureRemoteWithLocalPath",Ra,!0,!0,!1,!1,ab);this.HYn()}else{eb=new G.DictionaryPropertySet;ab=this.RUi(ab);null!==ab.cvd&&"chart"===ab.cvd.type&&eb.setValue(S.a.Eq,7);this.ij.o0d(eb,ab.width,ab.height,!0);T.ULS.shipAssertTag(7869444,307,Ka.ParagraphReader.nc(this.Bc.currentNode));this.Dtc=this.le.hg("WebServiceCall",Sa.K4m);T.ULS.sendTraceTag(20505094,
322,50,String.format("ImagePasteRequest img width: {0}, height {1}",ab.width,ab.height));var zb=ka.a.ow(this.Bc.currentNode);eb=this.ij.KMd(zb,eb);this.Nah(eb,ab)}}NHf(){0<this.Rhb&&(this.em=l.a.create(),this.hp=this.Nt.J(0).node.Di(),T.ULS.sendTraceTag(38122840,307,50,"Pasted pictures: {0}",this.Rhb),this.BUd&&(T.ULS.sendTraceTag(38122841,307,15,"MaxPicturesExceeded in paste."),this.QXn()),Ma.a.instance.q9f(this.hp),this.sfg(),this.hp.contentReplicator.forceOutbound(this.M7m,null,null))}N6d(ab){if(0<
this.Rhb){const zb=ab.ia(S.a.hfa,!1),Ua=ab.ia(P.a.OPc,!1),Ab=ab.ia(P.a.P$,!1);ab=ab.ia(L.a.Zda,-1);for(let mb=0;mb<this.Nt.count;mb++){var eb=this.Nt.J(mb).blob;eb&&(eb=eb.properties,eb.setValue(S.a.hfa,zb),eb.setValue(P.a.OPc,Ua),eb.setValue(P.a.P$,Ab),eb.setValue(L.a.Zda,ab),this.ij.XVf(eb,ab))}}}a1a(){}RUi(ab){T.ULS.shipAssertTag(7869447,307,da.a.instance.J(7));var eb=ra.WordSectionNavigator.instance.$L(this.Bc.Cn);if(!eb)return ab;var zb=F.a.Pi(Sa.Sg.uA(eb)-Sa.Sg.$sa(eb)-Sa.Sg.rla(eb),1);eb=F.a.Pi(Sa.Sg.Jv(eb)-
Sa.Sg.BL(eb)-Sa.Sg.CL(eb),0);T.ULS.shipAssertTag(7869449,307,0<=zb);T.ULS.shipAssertTag(7869450,307,0<=eb);if(ab.height>zb){const Ua=zb/ab.height;ab.height=zb;ab.width=Math.floor(ab.width*Ua)}ab.width>eb&&(zb=eb/ab.width,ab.width=eb,ab.height=Math.floor(ab.height*zb));return ab}HYn(){const ab=Box4Intl.Box4Strings.l_PastedImageFailedWithInvalidUrl;if(!this.wqc||this.wqc.message!==ab&&!this.wqc.mma)this.wqc=this.JY.Yra(ab,!1),this.JY.mA(this.wqc)}Xil(){if(this.cpc&&this.cpc.pGo())return this.cpc.fFo();
var ab=new Sys.Net.WebRequest;ab.set_url("PicturePaste.ashx");ab=ab.getResolvedUrl();k.AFrameworkApplication.K.$("SendFileIdInPicturePasteRequestBodyIsEnabled")||(ab=e.a.Pn(ab,U.a.fileId,this.hp.Fs));return ab}pjo(ab,eb){if(ab&&eb){const zb=F.a.yf(ua.ImageReader.ZG(ab.properties),0);ab=F.a.yf(ua.ImageReader.YJ(ab.properties),1);0<zb&&zb<eb.width&&(eb.width=zb,eb.height=ab)}}dkb(){const ab={},eb=l.a.create().toString();ab[Sa.correlationID]=eb;k.AFrameworkApplication.Xe.Lj(this.jA.J(this.WHa).url,2,
this.jA.J(this.WHa).Jvn,ab,!1,2,this.picturePasteRequestSucceeded,this.Tac,null,void 0,void 0,void 0,void 0,"26");Sa.GEf++;T.ULS.sendTraceTag(572528018,307,50,"SendPicturePasteRequest PicturePaste request added to the queue with correlation id : {0}",eb)}Nul(ab){return ab&&ab.data?ab.data.wf:-1}YSl(){Ma.a.instance.yhc(this.hp,127);this.glh()}glh(){T.ULS.shipAssertTag(7869458,307,this.tfj);const ab=new va.GraphTransaction(15);ab.Db(this.Nt.J(0).node);for(let eb=this.WHa;eb<this.jA.count;eb++){const zb=
this.jA.J(eb).u6l;for(let Ua=0;Ua<zb.count;Ua++){const Ab=zb.J(Ua).blob.properties;this.ij.vPa(Ab,Box4Intl.Box4Strings.l_PastedImageFailed);ua.ImageReader.wZi(Ab)}}ab.dispose();this.wm.iZb(this.hp,!1);this.ujh()}QXn(){const ab=new K.StandardDialog;ab.Fd=0;ab.jy(0,Box4Intl.Box4Strings.l_MaxPicturesExceededTitle,String.format(Box4Intl.Box4Strings.l_MaxPicturesExceededMessage,Ja.App.szf),null,!0);k.AFrameworkApplication.ya.processAction(Ca.a.eEi,2)}wTm(ab,eb){ab.alt.length>Ha.vhb&&(ab.alt=ab.alt.substring(0,
B.a.Ny(ab.alt,Ha.vhb)?Ha.vhb-1:Ha.vhb));const zb=new G.DictionaryPropertySet;this.ij.o0d(zb,ab.width,ab.height);eb=this.ij.KMd(eb,zb);ab=this.RUi(ab);this.Nah(eb,ab)}ujh(){}vjh(){}wjh(){}ZKd(){return!!Sa.GEf}static get Sg(){return qa.a.instance}static yem(ab){return!!ab&&!!ab.src&&!bb.a.Ehi(ab.src)}}Sa.E$e=1E3;Sa.kdl=4;Sa.K4m="PicturePasteRequestTime";Sa.correlationID="X-CorrelationId";Sa.GEf=0;Sa.qGm=20971520;Object(C.a)(Sa,"Box4ImageSteward",Ha,[598])},1847:function(C,N,d){C=d(0);var l=d(44),e=
d(96),a=d(7),k=d(27);class n extends Sys.UI.Control{constructor(K,O,H,I){super(document.createElement("div"));this.kY=this.Nha=this.IM=this.ov=this.K0=this.x5a=this.L8a=null;this.poc=this.o7a=!1;this.content=this._title=null;this.Bha=0;this.pfh=null;this.oda=0;this.lAi=null;this.y2g=K;this.qTb=O;this.Kj=H;this.Knh=I;this.Hk=O.ownerDocument;this.XKd=this.Bt=this.KR=!1}get X6(){this.L8a||(this.L8a=this.Hk.createElement("div"),this.L8a.id=this.qj("WACCalloutOuter"),this.L8a.className="WACCalloutOuter",
this.L8a.setAttribute(k.a.Ch,k.a.Udh),this.L8a.style.width=this.Bha+"px");return this.L8a}get qzc(){if(!this.x5a){this.x5a=this.Hk.createElement("div");this.x5a.id=this.qj("WACCalloutBeakContainer");this.x5a.className="WACCalloutBeakContainer";var K="CalloutBeakTopFilled_32x16x32";if(5===this.oda||6===this.oda||4===this.oda)K="CalloutBeakBottomFilled_32x16x32";K=e.createClusteredImage(32,16,K,"WACCalloutBeak",!0,"");this.x5a.appendChild(K)}return this.x5a}set qzc(K){this.x5a=K}get fH(){return this.KR}get title(){return this._title}set title(K){this._title!==
K&&(this._title=K,this.Nha&&(this.Nha.innerText=this._title))}get Bt(){return this.o7a}set Bt(K){this.o7a!==K&&(this.o7a=K,this.K0&&(this.K0.contains(this.IM)&&!this.o7a?this.K0.removeChild(this.IM):!this.K0.contains(this.IM)&&this.o7a&&this.J7g()))}get XKd(){return this.poc}set XKd(K){this.poc!==K&&(this.poc=K,this.K0&&(this.K0.contains(this.Nha)&&!this.poc?this.K0.removeChild(this.Nha):!this.K0.contains(this.Nha)&&this.poc&&this.r9g()))}show(){this.KR||(this.jJk(),this.VH(),this.qTb.appendChild(this.X6),
this.X6.style.display="Block",this.LOn(),this.KR=!0,this.lAi&&this.lAi())}dismiss(){this.KR&&(this.MUk(),this.qTb.removeChild(this.X6),this.KR=!1,this.Knh&&this.Knh())}dispose(){this.dismiss();this.Nha=this.IM=this.ov=this.x5a=this.K0=this.L8a=null;Sys.Component.prototype.dispose.call(this)}qj(K){return this.get_element().id+K}jJk(){this.K0=this.Hk.createElement("div");this.K0.id=this.qj("WACCalloutHeader");this.K0.className="WACCalloutHeader";this.Bt&&this.J7g();this.XKd&&this.r9g();this.ov=this.Hk.createElement("div");
this.ov.id=this.qj("WACCalloutContent");this.ov.className="WACCalloutContent";this.ov.style.width=190<this.Bha?this.Bha-26+"px":"164px";this.ov.appendChild(this.content);this.X6.appendChild(this.qzc);this.X6.appendChild(this.K0);this.X6.appendChild(this.ov)}J7g(){this.IM=this.Hk.createElement("a");this.IM.className="WACCalloutCloseAnchor";this.IM.id=this.qj("WACCalloutCloseAnchor");this.IM.href="#";this.K0.appendChild(this.IM);const K=e.createClusteredImage(16,16,"ClosePaneGlyph_16x16x32","WACCalloutCloseIcon",
!0,CommonUIStrings.l_DialogClose);this.IM.appendChild(K)}r9g(){this.Nha=this.Hk.createElement("div");this.Nha.className="WACCalloutTitle UIFontBold";this.Nha.style.width=190<this.Bha?this.Bha-30+"px":"160px";this.Nha.id=this.qj("WACCalloutTitle");this.Nha.innerText=this.title;this.K0.contains(this.IM)?this.K0.insertBefore(this.Nha,this.IM):this.K0.appendChild(this.Nha)}LOn(){var K=this.y2g;let O;if(1===this.oda){var H=this.pfh.y+16;O=-16}else 2===this.oda||3===this.oda||0===this.oda?(H=K.y+K.height+
15,O=-15):(H=K.y-this.X6.clientHeight-15-2,O=this.X6.clientHeight-1);this.X6.style.top=H+"px";this.qzc.style.top=O+"px";1===this.oda?(K=this.pfh.x-16,this.X6.style.left="50%",this.X6.style.marginLeft=-this.Bha/2+"px",H=Sys.UI.DomElement.getBounds(this.X6),this.qzc.style.left=K-H.x+"px"):(H=K.x+this.y2g.width/2,2===this.oda||5===this.oda?(K=20,H-=36):0===this.oda||4===this.oda?(K=this.Bha/2-16,H-=this.Bha/2):(K=this.Bha-20-32,H=H-this.Bha+36),this.X6.style.left=H+"px",this.qzc.style.left=K+"px")}VH(){this.Bt&&
!this.kY&&(this.kY=Object(l.a)(this,this.aka,"closeHandler"),this.Kj.mb(a.a.click,this.IM,this.kY,null))}MUk(){this.Bt&&this.kY&&(this.Kj.sc(a.a.click,this.IM,this.kY),this.kY=null)}aka(){this.dismiss();return!0}}Object(C.a)(n,"Callout",Sys.UI.Control,[1065]);class v extends n{constructor(K,O,H,I,J,L=null){super(K,H,J.G_,L);this.aRg=0;this.Bha=this.nzl(I);this.MVb=O;this.zi=J;this.U8n=7;this.oq=this.MVb.ownerDocument.createElement("div");this.oq.className="ModalCalloutControlOverlay";this.oq.tabIndex=
0;this.MVb.insertBefore(this.oq,this.MVb.firstChild)}show(){this.fH||(this.zi.n0d(),this.zi.pda(!1),this.oq.style.zIndex=String(this.zi.Mya),super.show(),this.Xy(),this.aRg=window.setTimeout(Object(l.a)(this,this.dismiss,"dismiss"),1E3*this.U8n))}dismiss(){this.fH&&(this.zi.Y9(!1),this.Q7(),this.MVb&&this.MVb.contains(this.oq)&&this.MVb.removeChild(this.oq),super.dismiss(),window.clearTimeout(this.aRg))}Xy(){this.zi.o1(Object(l.a)(this,this.dismiss,"dismiss"));this.zi.ez.mb(a.a.click,this.oq,Object(l.a)(this,
this.onClick,"onClick"))}Q7(){this.zi.tga(Object(l.a)(this,this.dismiss,"dismiss"));this.zi.ez.sc(a.a.click,this.oq,Object(l.a)(this,this.onClick,"onClick"))}onClick(){this.dismiss();return!0}nzl(K){let O=0;switch(K){case 0:O=190;break;case 1:O=250;break;case 2:O=300;break;case 3:O=360}return O}}Object(C.a)(v,"ModalCallout",n,[]);var u=d(8),t=d(472),y=d(171);class B extends v{constructor(K,O,H,I,J,L=null){super(K,O,H,I,J,L);this.VR=null}show(){if(!this.fH){const K=Object.assign(new t.a,{onShow:()=>
{v.prototype.show.call(this)}});y.UISurfaces.bK().then(O=>{const H=O.externalNotification();this.VR=O.addNotification(H,K);return null},O=>{u.ULS.sendTraceTag(593352345,383,15,"Failed to GetNotificationsAPIAsync: {0}",O);return null})}}dismiss(){this.fH&&this.VR&&(y.UISurfaces.bK().then(K=>{K.removeNotification(this.VR);return this.VR=null},K=>{u.ULS.sendTraceTag(593352344,383,15,"Failed to GetNotificationsAPIAsync: {0}",K);return null}),super.dismiss())}}Object(C.a)(B,"ReactManagedModalCallout",
v,[]);var G=d(2);d.d(N,"a",function(){return F});class F{static ouh(K,O,H,I){return G.AFrameworkApplication.ua.Sb.HMa?new B(K,O,H,I,G.AFrameworkApplication.ua,null):new v(K,O,H,I,G.AFrameworkApplication.ua,null)}}Object(C.a)(F,"ModalCalloutControlFactory",null,[])},1853:function(C,N,d){C=d(0);class l{constructor(a){this.next=null;this.data=a}}Object(C.a)(l,"QueueNode",null,[]);d.d(N,"a",function(){return e});class e{constructor(){this.xpb=this.znb=null;this.ej=0}get count(){return this.ej}get isEmpty(){return!this.count||
!this.znb||!this.xpb}enqueue(a){a=new l(a);this.isEmpty?this.xpb=this.znb=a:this.znb=this.znb.next=a;this.ej=this.count+1}back(){return this.isEmpty?null:this.znb.data}dequeue(){if(this.isEmpty)return null;const a=this.xpb;this.xpb=a.next;this.ej=this.count-1;this.xpb||(this.znb=null);return a.data}clear(){this.xpb=this.znb=null;this.ej=0}toArray(){const a=Array(this.count);let k=this.xpb;for(let n=0;n<this.count&&k;n++)a[n]=k.data,k=k.next;return a}}Object(C.a)(e,"Queue",null,[])},1904:function(C,
N,d){d.d(N,"b",function(){return l});d.d(N,"e",function(){return e});d.d(N,"d",function(){return a});d.d(N,"c",function(){return k});d.d(N,"h",function(){return n});d.d(N,"a",function(){return v});d.d(N,"f",function(){return u});d.d(N,"g",function(){return t});var l;(function(y){y[y.Unspecified=0]="Unspecified";y[y.Inline=1]="Inline";y[y.Floating=2]="Floating"})(l||(l={}));var e;(function(y){y[y.Undefined=0]="Undefined";y[y.Bullet=1]="Bullet";y[y.Numbered=2]="Numbered";y[y.Lim=3]="Lim";y[y.Nil=4]=
"Nil";y[y.Any=5]="Any";y[y.NoList=6]="NoList";y[y.Invalid=7]="Invalid"})(e||(e={}));var a;(function(y){y[y.DontCare=1]="DontCare";y[y.Thin=2]="Thin";y[y.ExtraLight=3]="ExtraLight";y[y.Light=4]="Light";y[y.Normal=5]="Normal";y[y.Medium=6]="Medium";y[y.SemiBold=7]="SemiBold";y[y.Bold=8]="Bold";y[y.ExtraBold=9]="ExtraBold";y[y.Heavy=10]="Heavy"})(a||(a={}));var k;(function(y){y[y.NoCaps=0]="NoCaps";y[y.SmallCaps=1]="SmallCaps";y[y.AllCaps=2]="AllCaps";y[y.AllPetiteCaps=3]="AllPetiteCaps";y[y.PetiteCaps=
4]="PetiteCaps";y[y.Unicase=5]="Unicase";y[y.Titling=6]="Titling";y[y.Other=7]="Other"})(k||(k={}));var n;(function(y){y[y.None=0]="None";y[y.Words=1]="Words";y[y.SingleLine=2]="SingleLine";y[y.DoubleLine=3]="DoubleLine";y[y.HeavyLine=4]="HeavyLine";y[y.DottedLine=5]="DottedLine";y[y.DottedHeavyLine=6]="DottedHeavyLine";y[y.DashLine=7]="DashLine";y[y.DashHeavyLine=8]="DashHeavyLine";y[y.DashLongLine=9]="DashLongLine";y[y.DashLongHeavyLine=10]="DashLongHeavyLine";y[y.DotDashLine=11]="DotDashLine";
y[y.DotDashHeavyLine=12]="DotDashHeavyLine";y[y.DotDotDashLine=13]="DotDotDashLine";y[y.DotDotDashHeavyLine=14]="DotDotDashHeavyLine";y[y.WavyLine=15]="WavyLine";y[y.WavyHeavyLine=16]="WavyHeavyLine";y[y.WavyDoubleLine=17]="WavyDoubleLine"})(n||(n={}));var v;(function(y){y[y.Left=0]="Left";y[y.Right=1]="Right";y[y.Center=2]="Center";y[y.Justified=3]="Justified";y[y.Other=4]="Other";y[y.None=5]="None";y[y.JustifyLow=6]="JustifyLow";y[y.Distributed=7]="Distributed";y[y.ThaiDistributed=8]="ThaiDistributed"})(v||
(v={}));var u;(function(y){y[y.Image=0]="Image";y[y.TextBox=1]="TextBox";y[y.Chart=2]="Chart";y[y.SmartArt=3]="SmartArt";y[y.Drawing=4]="Drawing";y[y.EquationObject=5]="EquationObject";y[y.Ink=6]="Ink";y[y.InkSpace=7]="InkSpace";y[y.InkEndOfLine=8]="InkEndOfLine";y[y.LineBreak=9]="LineBreak";y[y.PageBreak=10]="PageBreak";y[y.PageNumbers=11]="PageNumbers";y[y.FootnoteEndnote=12]="FootnoteEndnote";y[y.FootnoteEndnoteReferenceMark=13]="FootnoteEndnoteReferenceMark";y[y.Tab=14]="Tab";y[y.UnsupportedObject=
15]="UnsupportedObject";y[y.Other=16]="Other"})(u||(u={}));var t;(function(y){y[y.Initial=0]="Initial";y[y.FirstLine=1]="FirstLine";y[y.Hanging=2]="Hanging"})(t||(t={}))},1906:function(C,N,d){d.d(N,"a",function(){return l});C=d(0);var l;(function(e){e[e.normal=0]="normal";e[e.beingCreated=1]="beingCreated";e[e.beingEdited=2]="beingEdited"})(l||(l={}));Object(C.b)("CommentType",l)},1908:function(C,N,d){d.d(N,"a",function(){return l});C=d(0);class l{static Sef(e){return e===l.create?0:e===l.reply?1:
e===l.edit?2:e===l.metadata?3:null}}l.create="CREATE";l.reply="REPLY";l.edit="EDIT";l.metadata="METADATA";Object(C.a)(l,"CommentSessionType",null,[])},1909:function(C,N,d){d.d(N,"a",function(){return l});C=d(0);var l;(function(e){e[e.unsaved=0]="unsaved";e[e.sentToServer=1]="sentToServer";e[e.succeeded=2]="succeeded";e[e.failed=3]="failed";e[e.saveNotNeeded=4]="saveNotNeeded"})(l||(l={}));Object(C.b)("CommentSaveStatus",l)},1910:function(C,N,d){d.d(N,"a",function(){return l});C=d(0);class l{constructor(e,
a){this.className=e;this.sKc=a}}Object(C.a)(l,"HighlightCssClassPair",null,[])},1911:function(C,N,d){d.d(N,"a",function(){return l});C=d(0);class l{constructor(){this.type=this.action=0;this.iO=this.DF=null}}Object(C.a)(l,"HighlightOperation",null,[])},1912:function(C,N,d){d.d(N,"a",function(){return e});C=d(0);N=d(245);var l=d(126);class e extends N.a{constructor(){super();this.LastKnownPaginationRevision=this.FileId=null}Wl(){return 36}static I9(a,k){const n=new e;n.FileId=a;n.LastKnownPaginationRevision=
l.a(k);return n}}Object(C.a)(e,"PaginationRequest",N.a,[])},1914:function(C,N,d){d.d(N,"a",function(){return l});C=d(0);class l{w3b(e,a){let k="g";a.matchCase||a.sUd||(k+="i");if(a.matchPrefix||a.matchWholeWord)e="\\b"+e;if(a.matchSuffix||a.matchWholeWord)e+="\\b";return new RegExp(e,k)}static get instance(){return l._instance||(l._instance=new l)}}l._instance=null;Object(C.a)(l,"FindUtils",null,[1080])},1916:function(C,N,d){d.d(N,"a",function(){return l});C=d(0);class l{constructor(e,a){this._text=
e;this.ync=a}get text(){return this._text}get matchCase(){return this.ADb(1)}get matchWholeWord(){return this.ADb(2)}get sUd(){return this.ADb(4)}get matchPrefix(){return this.ADb(8)}get matchSuffix(){return this.ADb(16)}get ignorePunct(){return this.ADb(32)}get ignoreSpace(){return this.ADb(64)}ADb(e){return(this.ync&e)===e}static createQuery(e,a){return new l(e,a)}}Object(C.a)(l,"Query",null,[1077])},1917:function(C,N,d){d.d(N,"a",function(){return l});C=d(0);var l;(function(e){e[e.none=0]="none";
e[e.matchCase=1]="matchCase";e[e.wholeWordOnly=2]="wholeWordOnly";e[e.wildCards=4]="wildCards";e[e.prefix=8]="prefix";e[e.suffix=16]="suffix";e[e.ignorePunct=32]="ignorePunct";e[e.ignoreSpace=64]="ignoreSpace"})(l||(l={}));Object(C.b)("QueryFilters",l)},1918:function(C,N,d){d.d(N,"a",function(){return v});C=d(0);var l=d(153),e=d(159),a=d(2),k=d(56),n=d(154);class v extends l.a{constructor(u,t=!1){super(u,!1,t)}get tPd(){return!1}get UJ(){return n.a.UDc+"/modeless"}get Ugb(){return null}set Ugb(u){}get Qgb(){return null}set Qgb(u){}Wh(u,
t=null,y=null){this.oS&&(y.isModal=!1);super.Wh(u,t,y)}hide(){if(a.AFrameworkApplication.K.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.HideReactModelessDialogEnabled")||this.ed)this.vhj(),a.AFrameworkApplication.ua.jv.Mw(e.AFrame.sAf),super.hide()}C2j(){const u=a.AFrameworkApplication.ua.jv,t=a.AFrameworkApplication.ua.$o;u.Rya(this.UJ);u.qS(this.UJ);t.re(this.UJ).parent=e.AFrame.Np}Sya(){k.FocusManager.fJ()&&(super.Sya(),this.C2j(),a.AFrameworkApplication.ua.jv.DG(e.AFrame.sAf))}$Rf(){if(k.FocusManager.fJ()&&
!a.AFrameworkApplication.Mk){const u=k.FocusManager.instance();u.NQ(this.UJ);const t=u.getRegion(this.UJ);t&&t.Vj.oy(null);u.tIb(this.UJ)}}nga(){"DL"===this.Hya||"DP"===this.Hya?super.nga():a.AFrameworkApplication.K&&a.AFrameworkApplication.K.$("WacAutoFitNonModalDialogIsEnabled")?(this.vhj(),this.bfh()&&this.a6i(this.ed.clientHeight,this.ed.clientWidth)):this.rO()}rO(){this.a6i(l.a.KAg,l.a.RAg)}a6i(u,t){if(this.Qgb&&this.Ugb){let y,B;y=n.a.f0d+this.Ugb;B=n.a.e0d+this.Qgb;y+u>this.uA()&&(y=this.uA()-
u);B+t>this.Jv()&&(B=this.Jv()-t);this.b6i(y,B)}else super.rO()}cgf(u){if(!u)return null;u.endsWith("px")&&(u=u.substring(0,u.length-2));return n.a.a7b(u)?((u=parseInt(u))||(u=1),u):null}vhj(){if(this.ed&&this.ed.style){var u=this.cgf(this.ed.style.top);u&&(this.Ugb=u-n.a.f0d);if(u=a.AFrameworkApplication.isRtl?this.cgf(this.ed.style.right):this.cgf(this.ed.style.left))this.Qgb=u-n.a.e0d}}}Object(C.a)(v,"ModelessCustomDialog",l.a,[])},1919:function(C,N,d){d.d(N,"a",function(){return y});C=d(0);var l=
d(8),e=d(2),a=d(285),k=d(185),n=d(505),v=d(602),u=d(603),t=d(16);class y{constructor(B,G=null,F=-1,K=null){this.i5=B;this.t5g=K||(()=>G);this.F9c=F}Lj(B,G,F,K,O,H,I,J,L,S=null,E=!1,P=null,T=null){const U=new XMLHttpRequest;let X="";H="";2===G?(X="POST",F&&(H=F)):X="GET";G={};this.i5&&(B=a.a.iOe(G,B,a.a.Ade,e.AFrameworkApplication.Jhc,this.i5));U.open(X,B,!0);this.Jmk(G,B);if(K)for(let ca in K)U.setRequestHeader(ca,t.a.gQ(K[ca]));for(let ca in G)U.setRequestHeader(ca,G[ca]);B=P||this.F9c;0<B&&(U.timeout=
B);B=[];Array.add(B,a.a.N5);K=new Sys.Net.WebRequest;const Y=new v.a(1,2,K,B,O,I,J,L,E,S,T);U.onreadystatechange=()=>{this.TVm(U,Y)};try{U.send(H)}catch(ca){l.ULS.sendTraceTag(24938643,205,15,"Invoke failed in SimpleClientRequestSender")}return 1}y3b(){return 1}TVm(B,G){if(this.Huk(B,G)&&4===B.readyState)if(B.getResponseHeader(a.a.IDh)&&e.AFrameworkApplication.dFc)e.AFrameworkApplication.dFc();else{var F=B.getResponseHeader(a.a.ckh);a.a.Z7f(F);this.olo(B,G);B.status===k.a.xD?(G.status=2,G.yK(new u.a(G))):
(G.status=B.status&&B.status!==k.a.tcc?B.status===k.a.kga?5:3:7,G.Y1(new n.a(G)))}}Jmk(B,G){B["X-xhr"]=1;e.AFrameworkApplication.z_a&&(B[a.a.Hmi]=1);e.AFrameworkApplication.buildVersion&&(B[a.a.s$b]=t.a.gQ(e.AFrameworkApplication.buildVersion));let F=null;this.t5g&&(F=this.t5g());F&&(B[a.a.B$f]=F);e.AFrameworkApplication.canary&&(B[a.a.NYb]=t.a.gQ(e.AFrameworkApplication.canary),e.AFrameworkApplication.gRc&&l.ULS.sendTraceTag(24938644,205,50,"Canary in request: {0}",B[a.a.NYb]));e.AFrameworkApplication.accessToken&&
(a.a.Awb(G,e.AFrameworkApplication.m5)||(B[a.a.hNe]=t.a.gQ(e.AFrameworkApplication.accessToken)),a.a.Awb(G,e.AFrameworkApplication.Lya)||(B[a.a.iNe]=e.AFrameworkApplication.fJa.toString()));e.AFrameworkApplication.userType&&(B[a.a.Tjj]=t.a.gQ(e.AFrameworkApplication.userType))}olo(B,G){G.wf=B.status?B.status:k.a.tcc;try{G.Ge=B.responseText;if(void 0!==G.$Oa&&null!==G.$Oa){G.rj={};for(let F=0;F<G.$Oa.length;++F){const K=G.$Oa[F];G.rj[K]=B.getResponseHeader(K)}}G.h8d&&(G.wga=B.responseText&&B.responseText.length?
B.responseXML:null)}catch(F){l.ULS.sendTraceTag(24938645,205,10,"OnRequestCompleted: Unable to get ResponseData/XML, Id={0}, Url={1} ResponseAvailable={2}",G.id,G.request.get_url(),4===B.readyState)}}Huk(B,G){return B?G?!0:(l.ULS.sendTraceTag(24938648,205,15,"OnRequestCompleted in SimpleClientRequestSender: RequestItem doesn't exist."),!1):(l.ULS.sendTraceTag(24938646,205,15,"OnRequestCompleted in SimpleClientRequestSender: XMLHttpRequest doesn't exist."),!1)}static create(B,G,F){return new y(B,null,
F,G)}}Object(C.a)(y,"SimpleClientRequestSender",null,[842])},1920:function(C,N,d){d.d(N,"a",function(){return l});C=d(0);var l;(function(e){e[e.connected=0]="connected";e[e.disconnected=1]="disconnected";e[e.connecting=2]="connecting";e[e.timeout=3]="timeout"})(l||(l={}));Object(C.b)("AppNetworkConnectivityState",l)},1921:function(C,N,d){d.d(N,"a",function(){return l});C=d(0);class l{WKa(){}w1b(){}I7d(){}j6d(){}reset(){}z9e(){}update(){}tkb(){}dispose(){}}Object(C.a)(l,"FindStatusManagerStub",null,
[284,9])},1939:function(C,N,d){C=d(0);var l=d(1566),e=d(1567),a=d(1621),k=d(216),n=d(35);class v{}v.eventType="Type";v.xcb="Time";v.eventId="Id";v.Ieh="AttributionId";v.Jeh="AttributionProvider";v.Heh="AttributionName";v.teh="AssigneeId";v.ueh="AssigneeProvider";v.seh="AssigneeName";v.startDate="Start";v.endDate="End";v.title="Title";v.Joh="Anchor";v.anchorExtensionList="AnchorExtensionList";v.mEi="Percent";v.priority="Priority";v.undoId="UndoId";v.isLossy="IsLossy";v.recordExtensionList="RecordExtensionList";
Object(C.a)(v,"Key",null,[]);var u=d(387),t=d(1753);const y=G=>{if(!G)return null;let F=null;G=u.a.ICc(G,K=>K.toString(),K=>K.toString());0<G.count&&(F=new t.a(G));return F};d.d(N,"a",function(){return B});class B{$Wf(G){if(!G)return"[]";G=B.DFk(G);return n.c(G)}Z_b(G){G=n.b(G||"[]");return B.nFk(G)}static Dba(G,F){throw Error.argument(G,F);}static j3b(G,F){F=F.toString();return F in G?G[F].toString():null}static XAb(G,F){F=F.toString();F in G||B.Dba("dictionary",String.format("Serialized task history dictionary is missing key '{0}'",
F));return G[F].toString()}static Vef(G,F){F=F.toString();F in G||B.Dba("dictionary",String.format("Serialized task history dictionary is missing key '{0}'",F));return Number.parseInvariant(G[F].toString())}static BBl(G,F,K){F=F.toString();return F in G?Boolean.parse(G[F].toString()):K}static CBl(G,F){F=F.toString();return F in G?G[F]:null}static S2f(G){G=new Date(G);isNaN(G.getUTCMilliseconds())&&B.Dba("dateTime","Date and time is in invalid format");return G}static q2e(G){return G.toISOString()}static Fth(G,
F){return y(B.CBl(G,F))}static EFk(G){const F={};F[v.eventType]=G.type;F[v.xcb]=B.q2e(G.time);F[v.eventId]=G.recordId;G.isLossy!==B.Bei&&(F[v.isLossy]=G.isLossy);G.user&&(G.user.UserId&&G.user.Provider&&G.user.DisplayName||B.Dba("record","HistoryRecord has invalid attribution"),F[v.Ieh]=G.user.UserId,F[v.Jeh]=G.user.Provider,F[v.Heh]=G.user.DisplayName);G.commentId&&(F[v.Joh]=G.commentId);if(G.anchorExtensionList&&G.anchorExtensionList.extensions){var K=G.anchorExtensionList.extensions.xgc();F[v.anchorExtensionList]=
K}G.recordExtensionList&&G.recordExtensionList.extensions&&(K=G.recordExtensionList.extensions.xgc(),F[v.recordExtensionList]=K);switch(G.type){case 1:case 4:case 7:case 8:case 0:break;case 2:case 3:G.assignee&&G.assignee.UserId&&G.assignee.Provider&&G.assignee.DisplayName||B.Dba("record","HistoryRecord has invalid assignee");F[v.teh]=G.assignee.UserId;F[v.ueh]=G.assignee.Provider;F[v.seh]=G.assignee.DisplayName;break;case 5:G.schedule||B.Dba("record","Schedule history record must have a schedule object");
G.schedule.startDate&&(F[v.startDate]=B.q2e(G.schedule.startDate));G.schedule.endDate&&(F[v.endDate]=B.q2e(G.schedule.endDate));break;case 6:(0>G.completion||100<G.completion)&&B.Dba("record","Progress history record must have a completion >= 0 and <= 100");F[v.mEi]=G.completion;break;case 10:(0>G.priority||10<G.priority)&&B.Dba("record","Priority history record must have a completion >= 0 and <= 10");F[v.priority]=G.priority;break;case 9:G.title||B.Dba("record","SetTitle history record must have a title");
F[v.title]=G.title;break;case -1:G.undoId||B.Dba("record","Undo history record must have an id to undo");F[v.undoId]=G.undoId;break;default:B.Dba("record","Unsupported history record type")}return F}static NFk(G){var F=null,K=B.j3b(G,v.Ieh);const O=B.j3b(G,v.Jeh),H=B.j3b(G,v.Heh);if(K||O||H)K&&O&&H||B.Dba("dictionary","Record has invalid attribution user"),F=new l.a(K,O,H);F=new e.a(B.Vef(G,v.eventType),F,B.S2f(B.XAb(G,v.xcb)),B.XAb(G,v.eventId));F.commentId=B.j3b(G,v.Joh);F.anchorExtensionList=B.Fth(G,
v.anchorExtensionList);F.recordExtensionList=B.Fth(G,v.recordExtensionList);F.isLossy=B.BBl(G,v.isLossy,B.Bei);switch(F.type){case 1:case 4:case 7:case 8:case 0:break;case 2:case 3:F.assignee=new l.a(B.XAb(G,v.teh),B.XAb(G,v.ueh),B.XAb(G,v.seh));break;case 5:F.schedule=new a.a;if(K=B.j3b(G,v.startDate))F.schedule.startDate=B.S2f(K);if(G=B.j3b(G,v.endDate))F.schedule.endDate=B.S2f(G);break;case 10:F.priority=B.Vef(G,v.priority);(0>F.priority||10<F.priority)&&B.Dba("dictionary","Priority record must have history >= 0 and <= 10");
break;case 6:F.completion=B.Vef(G,v.mEi);(0>F.completion||100<F.completion)&&B.Dba("dictionary","Progress record must have history >= 0 and <= 100");break;case 9:F.title=B.XAb(G,v.title);break;case -1:F.undoId=B.XAb(G,v.undoId);break;default:B.Dba("dictionary","Unsupported history record type")}return F}static DFk(G){const F=Array(G.length);for(let K=0;K<G.length;++K)F[K]=B.EFk(G.J(K));return F}static nFk(G){const F=new k.a;for(const K of G)G=B.NFk(K),F.add(G);return F}}B.Bei=!1;Object(C.a)(B,"JsonTaskHistorySerialization",
null,[309])},1941:function(C,N,d){C=d(0);class l{constructor(n){this.result=null;this.ELi=n}exec(n){return(this.result=this.ELi.exec(n))?!0:!1}rI(){return this.result.index}wGd(){return this.ELi.lastIndex}}Object(C.a)(l,"RegularExpressionWrapper",null,[]);var e=d(2),a=d(16);d.d(N,"a",function(){return k});class k{qVc(n){return this.n7i(n).join("").replace(RegExp("(\\\\.\\\\.\\\\.)","g"),"(\\.\\.\\.|\u2026)")}eGi(n){var v=n.text;v=n.sUd?this.$0n(v):this.n7i(v);if(n.ignorePunct||n.ignoreSpace){let u=
"";n.ignoreSpace&&(u+="\\s");n.ignorePunct&&(u+=k.ubn);u="["+u+"]*";for(let t=1;t<v.length;t++)if(!n.sUd||"{"!==v[t].charAt(0)&&"@"!==v[t].charAt(0))v[t]=u+v[t]}return v.join("")}VGb(n){return[n]}RQd(n){for(let v=0;v<n.length;++v){const u=n.charAt(v);let t=0;if("["===u){if(!({WC:t}=this.Vkm(n.substr(v))).returnValue)return!1;v=t+v-1}else if("<"===u){if(!this.Skm(n.substr(v)))return!1}else if(">"===u){if(!v)return!1}else if("{"===u){if(!v||!({WC:t}=this.Ukm(n.substr(v))).returnValue)return!1;v=t+v-
1}else if("@"===u){if(!v||!this.Tkm(n.substr(v)))return!1}else if("("===u){if(!({WC:t}=this.Rkm(n.substr(v))).returnValue)return!1;v=t+v-1}else if("}"===u||"]"===u||")"===u)return!1}return!0}iIh(n,v){let u,t;t=u=0;if(n.length<=v)return{returnValue:!1,WC:u,P4c:t};const y=n.length;var B=n.charAt(v);if("["===B)for(B=v+1;B<y;B++){if("]"===n.charAt(B)&&1!==B-v)return u=B,t=5,{returnValue:!0,WC:u,P4c:t}}else if("{"===B)for(B=-1,v+=1;v<y;v++){let G=n.charAt(v);if(","===G)B=v;else if("}"===G)return t=-1===
B?6:1!==v-B?7:8,u=v,{returnValue:!0,WC:u,P4c:t}}return{returnValue:!1,WC:u,P4c:t}}vdo(n,v,u){let t;if((t=v)||1!==n.length)switch(n.charAt(v+1)){case "{":let y,B;if(!({WC:y,P4c:B}=this.iIh(n,v+1)).returnValue)return{returnValue:this.dFa("*",u,!1),WC:t};n=this.dFa("*",u,!0)+this.dFa(n.substring(v+1,y+1),B);t=y;if(7===B||8===B)n+="?";return{returnValue:n,WC:t};case "@":return t=v+1,{returnValue:this.dFa("*",u,!0),WC:t};case "*":if(!v){for(t++;"*"===n.charAt(t);)t++;if(t===n.length)return{returnValue:this.dFa("*",
u,!0),WC:t}}return{returnValue:this.dFa("*",u,!1),WC:t};default:return{returnValue:this.dFa("*",u,!1),WC:t}}else return{returnValue:this.dFa(n,u,!0),WC:t}}dFa(n,v,u=!1){const t=n.length;switch(v){case 5:return"!"===n.charAt(1)&&2<t?"([^"+this.fGi(n.substr(2,t-3))+"]\u0640*)":"(["+this.fGi(n.substr(1,t-2))+"]\u0640*)";case 6:return n;case 7:return n;case 9:return"+?";case 8:return n;case 3:return"\\b";case 4:return"\\b";case 1:return".";case 2:return u?"(.+?)":"(.*?)";case 10:return n}return null}b1h(n){switch(n){case "?":return 1;
case "*":return 2;case "<":return 3;case ">":return 4;case "@":return 9}return 0}W6m(n){return"["===n||"]"===n||"\\"===n||"("===n||")"===n?String.format("\\{0}",n):"'"===n||"\u2018"===n||"\u2019"===n||'"'===n||"\u201c"===n||"\u201d"===n||a.a.daa(n)?this.mNf(n):n}fGi(n){const v=[];for(let u=0;u<n.length;++u)v[u]=this.W6m(n.charAt(u));return v.join("")}Vkm(n){let v;var u;v=-1;var t=new l(RegExp("\\[.+?\\]","g"));if(t.exec(n)){if(u=t.rI())return{returnValue:!1,WC:v};v=t.wGd()}else return{returnValue:!1,
WC:v};if((new l(RegExp("(\\(\\))|(.+?!)","g"))).exec(n.substring(1,v-1)))return{returnValue:!1,WC:v};u=new l(RegExp("[^!\\[]-[^\\]]","g"));for(n.substring(0,v);u.exec(n.substring(0,v));){t=u.rI();const y=RegExp("[-]","g");t=n.substring(t,u.wGd()).split(y);if(t[0].charAt(0)>t[1].charAt(0))return{returnValue:!1,WC:v}}return{returnValue:!0,WC:v}}Skm(n){return(new l(RegExp("\\<(\\{|\\@|\\>|\\<|\\}|\\))","g"))).exec(n)?!1:!0}Ukm(n){let v;v=-1;var u;if((new l(RegExp("(\\}\\{)|(\\}\\@)","g"))).exec(n))return{returnValue:!1,
WC:v};const t=new l(RegExp("\\{\\d+(,|(,\\d+))?\\}","g"));if(t.exec(n)){if(u=t.rI())return{returnValue:!1,WC:v};v=t.wGd();u=RegExp("[{,}]","g");u=n.substring(0,v).split(u);if(4===u.length&&(n=Number.parseInvariant(u[1]),u=Number.parseInvariant(u[2]),n>=u))return{returnValue:!1,WC:v}}else return{returnValue:!1,WC:v};return{returnValue:!0,WC:v}}Tkm(n){return(new l(RegExp("\\@\\{","g"))).exec(n)?!1:!0}Rkm(n){let v;v=-1;let u;const t=new l(RegExp("\\(([^\\[\\]]*?(\\[.+?\\])?)+?\\)","g"));if(t.exec(n)){if(u=
t.rI(),v=t.wGd(),u||!this.RQd(n.substring(1,v-1)))return{returnValue:!1,WC:v}}else if(e.AFrameworkApplication.K&&e.AFrameworkApplication.K.$("ScriptLabBugFixIsEnabled"))return{returnValue:!1,WC:v};return{returnValue:!0,WC:v}}$0n(n){const v=[],u=n.length,t=!!e.AFrameworkApplication.K&&e.AFrameworkApplication.K.$("ScriptLabBugFixIsEnabled");let y=0;for(let B=0;B<u;++B){const G=t?y:B,F=n.charAt(B);let K=0,O=0;"["===F||"\\"===F||"^"===F||"$"===F||"."===F||"|"===F||"+"===F||"("===F||")"===F||"?"===F||
"*"===F||"<"===F||">"===F||"@"===F||"?"===F||"{"===F?"["!==F&&"{"!==F||!({WC:K,P4c:O}=this.iIh(n,B)).returnValue?"?"===F||"<"===F||">"===F||"@"===F?(O=this.b1h(F),v[G]=this.dFa(F,O)):"*"===F?(O=this.b1h(F),v[G]=({WC:K}=this.vdo(n,B,O)).returnValue,B=K):"("===F||")"===F?(O=10,v[G]=this.dFa(F,O)):v[G]=String.format("\\{0}",F):(v[G]=this.dFa(n.substr(B,K+1-B),O),B=K):v[G]="'"===F||"\u2018"===F||"\u2019"===F||'"'===F||"\u201c"===F||"\u201d"===F||"-"===F||"\u2013"===F||"\u2014"===F||a.a.daa(F)?"["+this.mNf(F)+
"]":"\u2026"===F?"\\.\\.\\.":F;""!==v[G]&&0===O&&(v[G]=B<n.length-1&&("@"===n.charAt(B+1)||"{"===n.charAt(B+1))?"("+v[G]+"\u0640*)":v[G]+"\u0640*");y++}return v}n7i(n){const v=[];for(let u=0;u<n.length;++u){const t=n.charAt(u);v[u]="["===t||"\\"===t||"^"===t||"$"===t||"."===t||"|"===t||"+"===t||"("===t||")"===t||"?"===t||"*"===t?String.format("\\{0}",t):"'"===t||"\u2018"===t||"\u2019"===t||'"'===t||"\u201c"===t||"\u201d"===t||"-"===t||"\u2013"===t||"\u2014"===t||a.a.daa(t)?"["+this.mNf(t)+"]":"\u2026"===
t?"\\.\\.\\.":t;""!==v[u]&&(v[u]+="\u0640*")}return v}mNf(n){return"'"===n||"\u2018"===n||"\u2019"===n?"'\u2018\u2019":'"'===n||"\u201c"===n||"\u201d"===n?'"\u201c\u201d':"-"===n||"\u2013"===n||"\u2014"===n?"-\u2013\u2014":a.a.daa(n)?k.seo:n}static get instance(){return k._instance||(k._instance=new k)}}k._instance=null;k.seo=" \u00a0\u1680\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000";k.ubn='-\u2013.,:;/?!"\u3002\uff0c\uff1a\uff1b\u3001\uff1f\uff01\u201d\u201c';
Object(C.a)(k,"WordQueryProcessor",null,[921])}}]);

//# sourceMappingURL=https://res-dev.cdn.officeppe.net/1js/build/16477519/wdjs/WordEditorDS.common.js.map