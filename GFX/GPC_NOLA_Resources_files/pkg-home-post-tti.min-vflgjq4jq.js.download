define("metaserver/static/js/cloud_docs/home_create_file_experiments_post_tti",["require","exports","tslib","react","metaserver/static/js/cloud_docs/constants","metaserver/static/js/new_file_menu/new_file_menu","metaserver/static/js/browse/constants","metaserver/static/js/home/modals/async_home_modals","metaserver/static/js/home/store","metaserver/static/js/home/util/logging/activity_logger","metaserver/static/js/home/constants"],(function(e,t,s,i,r,a,n,o,c,l,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getNewFileMenu=t.getCloudDocsExperiments=void 0,i=s.__importDefault(i),t.getCloudDocsExperiments=function(){return{expGddCreate:!1,expPaperCreate:!1,expBinderCreate:!1}};const m=(e,t)=>i=>s.__awaiter(void 0,void 0,void 0,(function*(){(0,o.asyncShowNewFolderModal)({user:e,initialPath:i,origin:n.CREATE_FOLDER_ACTION_ORIGIN_TYPE.HOME_CREATE_FILE_MODAL,redirectOnClose:t})})),u=e=>{l.homeActivityLogger.logClickRightMenu(d.LoggingTypes.CLICK_CREATE_NEW_FILE,{display_type:e})};t.getNewFileMenu=function(e){return s.__awaiter(this,void 0,void 0,(function*(){const t=e.cloudDocsExperiments.expGddCreate,s=e.cloudDocsExperiments.expPaperCreate,n=e.cloudDocsExperiments.expBinderCreate,o=()=>i.default.createElement(a.NewFileMenu,{key:"new-file-menu",user:(0,c.getUser)(),disabled:!1,showGdd:t,showPaper:s,showBinder:n,source:r.NewFileMenuFromType.HOME,handleClickNewFolder:m,logClickEvent:u});return new Promise((e,t)=>{e(o)})}))}})),define("metaserver/static/js/home/content_suggestions/actions",["require","exports","metaserver/static/js/flux/dispatcher","metaserver/static/js/home/content_suggestions/constants"],(function(e,t,s,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SuggestedActions=void 0,t.SuggestedActions={dispatchLoaded(e){s.Dispatcher.dispatch({type:i.SuggestedResourceActionTypes.LOAD_SUCCESS,items:e})}}})),define("metaserver/static/js/home/content_suggestions/actions_post_tti",["require","exports","tslib","metaserver/static/js/flux/dispatcher","metaserver/static/js/home/content_suggestions/constants","metaserver/static/js/starred/id_type_pair","metaserver/static/js/content_suggestions/api","metaserver/static/js/home/content_suggestions/actions","metaserver/static/js/home/resource/api_post_tti","metaserver/static/js/home/resource_id_types","metaserver/static/js/home/store","metaserver/static/js/home/constants","metaserver/static/js/display_types/constants","metaserver/static/js/clean/navigation","metaserver/static/js/content_suggestions/constants","metaserver/static/js/home/resource/actions_post_tti","metaserver/static/js/clean/browse_uri_interface"],(function(e,t,s,i,r,a,n,o,c,l,d,m,u,h,p,_,g){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.openSuggestedParentOnHome=t.openSuggestedItemOnHome=t.fetchSuggestedFileMetadata=t.loadItems=t.dismissSuggestedItem=void 0,t.dismissSuggestedItem=function(e,t){return s.__awaiter(this,void 0,void 0,(function*(){try{yield(0,n.trackDismissSuggestedItemFromIdTypePair)(e,t,"home"),i.Dispatcher.dispatch({type:r.SuggestedResourceActionTypes.DISMISS_ITEM_SUCCESS,dismissed:t})}catch(e){i.Dispatcher.dispatch({type:r.SuggestedResourceActionTypes.DISMISS_ITEM_FAILURE,dismissed:t})}}))},t.loadItems=function(e,t,a){return s.__awaiter(this,void 0,void 0,(function*(){try{const s=yield(0,n.getSuggested)(e,a,"home",t,void 0),c=(0,n.handlePayload)(s);"ERROR"!==c?o.SuggestedActions.dispatchLoaded(c.items):i.Dispatcher.dispatch({type:r.SuggestedResourceActionTypes.LOAD_FAILURE})}catch(e){i.Dispatcher.dispatch({type:r.SuggestedResourceActionTypes.LOAD_FAILURE})}}))},t.fetchSuggestedFileMetadata=function(e){return s.__awaiter(this,void 0,void 0,(function*(){const t=e.map(e=>({id:e.resourceId,type:l.HOME_RESOURCE_ID_TYPE.ENCODED_FILE_OBJ_ID})),s=yield(0,c.getFileMetadata)((0,d.getUser)(),t),r={};s.forEach(e=>r[(0,a.idTypePairToString)(e)]=e.file_metadata),i.Dispatcher.dispatch({type:m.HomeResourceStoreActionTypes.RECEIVED_RESOURCE_ID_TO_FILE,resourceIdToFile:r})}))};t.openSuggestedItemOnHome=(e,t,s,i,r)=>{if(s){const s=e.displayType===u.EXTERNAL_RESOURCE_TYPE?h.NavigationMethod.UNSAFE_NEW_TAB:h.NavigationMethod.NEW_TAB;(0,h.logAndNavigate)(e.url,t,s)}else p.PreviewableDisplayTypes.includes(e.displayType)?(0,_.openInFileViewer)({resourceId:"ENCODED_FILE_OBJ_ID:"+e.encodedFileObjId,logViewFunction:t,href:i,middleClick:r}):(0,h.logAndNavigate)(e.url,t,h.NavigationMethod.REDIRECT)};t.openSuggestedParentOnHome=(e,t,s)=>{const i=(0,d.getHomeStore)().getUser(),r=e.breadcrumb.length?e.breadcrumb[0]:null,a=r?r.url:(0,g.browse_uri_for_fq_path)(i,"").toString();if(a){const e=s?h.NavigationMethod.NEW_TAB:h.NavigationMethod.REDIRECT;(0,h.logAndNavigate)(a,t,e)}}})),define("metaserver/static/js/home/content_suggestions/constants",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LoggingTypes=t.SUGGEST_REASONS=t.SuggestedResourceActionTypes=void 0,(function(e){e.LOAD_SUCCESS="HOME_SUGGESTED_LOAD_SUCCESS",e.LOAD_FAILURE="HOME_SUGGESTED_LOAD_FAILURE",e.DISMISS_ITEM_SUCCESS="HOME_SUGGESTED_DISMISS_ITEM_SUCCESS",e.DISMISS_ITEM_FAILURE="HOME_SUGGESTED_DISMISS_ITEM_FAILURE"})(t.SuggestedResourceActionTypes||(t.SuggestedResourceActionTypes={})),(function(e){e.UNKNOWN="UNKNOWN",e.RECENCY="RECENCY",e.FRECENCY="FRECENCY",e.WEEKLY_PERIODICITY="WEEKLY_PERIODICITY",e.EVENT_COUNT="EVENT_COUNT",e.EDIT_COUNT="EDIT_COUNT",e.VIEW_COUNT="VIEW_COUNT",e.PREDICTION="PREDICTION",e.PREDICTION_VIEW="PREDICTION_VIEW",e.PREDICTION_EDIT="PREDICTION_EDIT",e.PREDICTION_SHARE="PREDICTION_SHARE",e.WEEKLY_FRECENCY="WEEKLY_FRECENCY",e.DIR_WEEKLY_FRECENCY="DIR_WEEKLY_FRECENCY",e.RECENT_SHARE="RECENT_SHARE"})(t.SUGGEST_REASONS||(t.SUGGEST_REASONS={})),t.LoggingTypes={OPEN_SUGGESTED_ITEM:"open_suggested_item",OPEN_PARENT_FOLDER:"open_parent_folder",RENDERED_SUGGESTED_ITEM:"rendered_suggested_item",CLICK_ADD_TO_STARRED:"click_add_to_starred",CLICK_DISMISS_SUGGESTED_ITEM:"click_dismiss_suggested_item",CANCEL_DISMISS_SUGGESTED_ITEM:"cancel_dismiss_suggested_item",DISMISS_SUGGESTED_ITEM:"dismiss_suggested_item",LIKE_SUGGESTED_ITEM:"like_suggested_item",SUGGESTED_SECTION_SHOWN:"suggested_section_shown",THUMBNAIL_LOADED:"thumbnail_loaded",THUMBNAIL_ERROR:"thumbnail_error",HIDE_SECTION:"hide_section",UNHIDE_SECTION:"unhide_section",CLICK_INFO_ICON:"click_info_icon"}})),define("metaserver/static/js/home/content_suggestions/home_suggest",["require","exports","tslib","react","metaserver/static/js/clean/js_client_stopwatch","metaserver/static/js/home/actions_post_tti","metaserver/static/js/home/content_suggestions/actions_post_tti","metaserver/static/js/home/content_suggestions/suggested_resource_store","metaserver/static/js/home/content_suggestions/util/logging/home_suggest_logger","metaserver/static/js/home/store","metaserver/static/js/files_view/contexts/file_thumb_store","metaserver/static/js/home/constants","metaserver/static/js/content_suggestions/suggest_loading","metaserver/static/js/content_suggestions/suggest_empty","metaserver/static/js/content_suggestions/grid_layout","metaserver/static/js/content_suggestions/suggest_frame","metaserver/static/js/content_suggestions/suggest_nonempty","metaserver/static/js/content_suggestions/models/suggested_item"],(function(e,t,s,i,r,a,n,o,c,l,d,m,u,h,p,_,g,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RootComponent=t.HomeSuggest=t.initPrefetch=void 0,i=s.__importDefault(i);t.initPrefetch=()=>{};class v extends i.default.PureComponent{constructor(e){super(e),this.numItemsLastLogged=0,this.onStoreUpdate=()=>this.setState(this.getStateFromStore()),this.onChangeSuggestVisibility=()=>{const e=!this.props.isHiddenByUser;(0,a.setSectionVisibilityPostTTI)((0,l.getUserId)(),{".tag":"suggest"},!e),c.homeSuggestLogger.logShowHideSection(e)},this.handleDismissSuggestedItem=(e,t)=>{const s=(0,f.suggestedItemToIdTypePair)(t);return(0,n.dismissSuggestedItem)(e,s)},this.removeSuggestionFromUi=e=>()=>{e.isDismissed&&this.setState({dismissedSuggestionKeys:[...this.state.dismissedSuggestionKeys,e.key]})},this.store=(0,o.getSuggestedResourceStore)(e.homeAvailabilityLogger),this.featureVariant=this.store.getFeatureVariant(),this.removeStoreListener=this.store.addListener(this.onStoreUpdate),this.state=Object.assign(Object.assign({},this.getStateFromStore()),{dismissedSuggestionKeys:[]}),this.loggedItems={},r.JSStopwatch.create_stopwatch_if_not_exist("infinite_tile_grid_logging")}getStateFromStore(){const e=this.store.getItems();return{loadingState:this.store.getLoadingState(),suggested:e}}UNSAFE_componentWillMount(){const e=(0,l.getHomeStore)().getUser();this.store.getLoadingState()===m.LoadingStates.FAILURE&&(0,n.loadItems)(e,this.featureVariant,10)}componentWillUnmount(){this.removeStoreListener&&this.removeStoreListener()}renderSuggestContainer(){const{containerWidth:e,isHiddenByUser:t}=this.props;if(t)return null;const{itemsToShow:s,tileWidth:r}=(0,p.getLayout)(e),a=this.state.suggested.filter(e=>!this.state.dismissedSuggestionKeys.includes(e.key)).slice(0,s),o=a.filter(e=>!e.isDismissed).length;if(this.state.loadingState!==m.LoadingStates.SUCCESS&&0===o)return i.default.createElement(u.SuggestLoadingInner,{isHiddenByUser:t,itemsToShow:s,tileWidth:r});if(0===s||0===o)return i.default.createElement(h.SuggestEmpty,null);if(this.numItemsLastLogged!==s){const e=[];a.forEach(t=>{this.loggedItems[t.resourceId]||(e.push(t),this.loggedItems[t.resourceId]=!0)}),c.homeSuggestLogger.logRenderedSuggestedItems(e),c.homeSuggestLogger.logSuggestedShown(a.length,this.featureVariant,s),this.numItemsLastLogged=s}return i.default.createElement(g.SuggestNonEmpty,{source:"home",logger:c.homeSuggestLogger,user:(0,l.getHomeStore)().getUser(),dismissSuggestedItem:this.handleDismissSuggestedItem,removeSuggestionFromUi:this.removeSuggestionFromUi,tileWidth:r,suggestedItemsToShow:a,openSuggestedItem:n.openSuggestedItemOnHome,openSuggestedParent:n.openSuggestedParentOnHome})}render(){const{canRenderItems:e,isHiddenByUser:t}=this.props;return e?i.default.createElement(d.ThumbStoreProvider,{shouldPrewarm:!0,path:"suggest"},i.default.createElement(_.SuggestFrame,{isHiddenByUser:t},i.default.createElement(_.SuggestHeader,{isHiddenByUser:t,buttonAction:this.onChangeSuggestVisibility}),this.renderSuggestContainer())):null}}t.HomeSuggest=v,v.displayName="HomeSuggest";t.RootComponent=e=>i.default.createElement(v,Object.assign({},e))})),define("metaserver/static/js/home/content_suggestions/logger_api",["require","exports","tslib","lodash","metaserver/static/js/core/exception","metaserver/static/js/clean/web_timing_logger","metaserver/static/js/home/api"],(function(e,t,s,i,r,a,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.logHomeActivity=void 0,i=s.__importStar(i),n=s.__importStar(n);let o={},c={};const l=(e,t,s)=>{n.makeRequest({url:s,type:"POST",data:{role:t,activities_json:JSON.stringify(i.map(e,"json")),send_ts:Date.now(),page_start_ts:window.performance&&window.performance.timing?window.performance.timing.navigationStart||window.performance.timing.fetchStart:void 0}},{isBackground:!0,delayRequest:!0}).then(()=>e.forEach(e=>e.resolve()),()=>e.forEach(e=>e.reject()))},d=i.throttle(()=>{i.size(o)>1&&(0,r.reportStack)("Multiple role activities",{severity:r.SEVERITY.NONCRITICAL,exc_extra:o}),Object.keys(o).forEach(e=>{const t=o[e];l(t,e,"/home_feed/log_activities")}),o={},Object.keys(c).forEach(e=>{const t=c[e];l(t,e,"/home_feed/log_suggested_activities")}),c={}},1e3,{leading:!0,trailing:!0});t.logHomeActivity=({role:e,eventName:t,extra:n,suggestId:l,table:m})=>new Promise((u,h)=>s.__awaiter(void 0,void 0,void 0,(function*(){m||(m="home_activity");const p={json:{event_name:t,event_time:Date.now(),extra:i.mapValues(n||{},e=>String(e))},resolve:u,reject:h};switch(m){case"home_activity":o[e]=o[e]||[],o[e].push(p);break;case"home_suggest":{o[e]=o[e]||[];const{json:t}=p,i=s.__rest(p,["json"]),r=Object.assign({json:Object.assign({},t)},i);o[e].push(r),p.json.suggest_id=l,c[e]=c[e]||[],c[e].push(p);break}default:return void(0,r.reportStack)("Unknown logging table specified",{severity:r.SEVERITY.NONCRITICAL,exc_extra:{table:m,role:e,eventName:t,extra:n,suggestId:l}})}yield(0,a.waitForTTI)(),d()})))})),define("metaserver/static/js/home/content_suggestions/suggested_resource_store",["require","exports","metaserver/static/js/flux/dispatcher","metaserver/static/js/home/constants","metaserver/static/js/flux/flux_store","metaserver/static/js/home/content_suggestions/constants","metaserver/static/js/home/content_suggestions/actions","metaserver/static/js/content_suggestions/api","metaserver/static/js/home/content_suggestions/actions_post_tti","metaserver/static/js/home/store"],(function(e,t,s,i,r,a,n,o,c,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getSuggestedResourceStore=t.PrivateSuggestedResourceStoreClass=void 0;class d extends r.FluxStore{constructor(e){super(s.Dispatcher),this.items=[],this.loadingState=i.LoadingStates.LOADING;let t=!1;e.handlePrefetch(i.HomePrefetchTypes.GET_SUGGESTED,e=>{const i=(0,o.handlePayload)(e);if("ERROR"!==i){const{items:e,modelVariant:s}=i;this.usedVariant=s,t?n.SuggestedActions.dispatchLoaded(e):this.onItemsLoadSuccess(e)}else t?s.Dispatcher.dispatch({type:a.SuggestedResourceActionTypes.LOAD_FAILURE}):this.onItemsLoadFailure()}),t=!0}getItems(){return this.items}getLoadingState(){return this.loadingState}getFeatureVariant(){if(!this.featureVariant){const e=(0,l.getHomeStore)().getActiveVariant(i.SUGGEST_GRID_FEATURE).toLowerCase();this.featureVariant=i.SUGGEST_GRID_FEATURE+":"+e}return this.featureVariant}getUsedVariant(){return this.usedVariant}onItemsLoadSuccess(e){this.items=e,this.loadingState=i.LoadingStates.SUCCESS,e&&(0,c.fetchSuggestedFileMetadata)(e)}onItemsLoadFailure(){this.loadingState=i.LoadingStates.FAILURE}onDismissItemSuccess(e){this.loadingState=i.LoadingStates.LOADING,this.items=this.items.map(t=>"ENCODED_FILE_OBJ_ID"===e.type&&t.encodedFileObjId===e.id||"FQ_PATH"===e.type&&t.fqPath===e.id?Object.assign(Object.assign({},t),{isDismissed:!0}):t),this.loadingState=i.LoadingStates.SUCCESS}onDismissItemFailure(e){this.loadingState=i.LoadingStates.LOADING,this.items=this.items.map(t=>"ENCODED_FILE_OBJ_ID"===e.type&&t.encodedFileObjId===e.id||"FQ_PATH"===e.type&&t.fqPath===e.id?Object.assign(Object.assign({},t),{isDismissed:!1}):t),this.loadingState=i.LoadingStates.SUCCESS}__onDispatch(e){const t=e.action;switch(t.type){case a.SuggestedResourceActionTypes.LOAD_SUCCESS:this.onItemsLoadSuccess(t.items),this.__emitChange();break;case a.SuggestedResourceActionTypes.LOAD_FAILURE:this.onItemsLoadFailure(),this.__emitChange();break;case a.SuggestedResourceActionTypes.DISMISS_ITEM_SUCCESS:this.onDismissItemSuccess(t.dismissed),this.__emitChange();break;case a.SuggestedResourceActionTypes.DISMISS_ITEM_FAILURE:this.onDismissItemFailure(t.dismissed),this.__emitChange()}}}t.PrivateSuggestedResourceStoreClass=d;let m=null;t.getSuggestedResourceStore=function(e){return null===m&&(m=new d(e)),m}})),define("metaserver/static/js/home/content_suggestions/util/logging/home_suggest_logger",["require","exports","tslib","lodash","metaserver/static/js/home/content_suggestions/logger_api","metaserver/static/js/home/store","metaserver/static/js/home/constants","metaserver/static/js/home/content_suggestions/constants"],(function(e,t,s,i,r,a,n,o){"use strict";function c(e){return`home_${e}`}Object.defineProperty(t,"__esModule",{value:!0}),t.homeSuggestLogger=t.HomeSuggestLogger=t.withHomePrefix=void 0,i=s.__importStar(i),t.withHomePrefix=c;class l{constructor(){this.homeSection=n.HomeSections.SUGGEST,this.loggingSource=c(this.homeSection)}logOpenSuggestedItem(e,t,s,i="home"){return(0,r.logHomeActivity)({eventName:o.LoggingTypes.OPEN_SUGGESTED_ITEM,role:(0,a.getHomeStore)().getRole(),suggestId:e.suggestId,table:"home_suggest",extra:{position:s,clickOrigin:t,source:this.loggingSource,isDir:e.isDir}})}logOpenParentFolder(e,t,s,i="home"){return(0,r.logHomeActivity)({eventName:o.LoggingTypes.OPEN_PARENT_FOLDER,role:(0,a.getHomeStore)().getRole(),suggestId:e.suggestId,table:"home_suggest",extra:{position:s,clickOrigin:t,source:this.loggingSource,isDir:e.isDir}})}logClickDismissSuggestedItem(e,t,s,i="home"){(0,r.logHomeActivity)({eventName:o.LoggingTypes.CLICK_DISMISS_SUGGESTED_ITEM,role:(0,a.getHomeStore)().getRole(),suggestId:e.suggestId,table:"home_suggest",extra:{position:s,clickOrigin:t,source:this.loggingSource,isDir:e.isDir}})}logDismissSuggestedItem(e,t,s,i,n="home"){(0,r.logHomeActivity)({eventName:o.LoggingTypes.DISMISS_SUGGESTED_ITEM,role:(0,a.getHomeStore)().getRole(),suggestId:e.suggestId,table:"home_suggest",extra:{position:s,clickOrigin:t,source:this.loggingSource,reason:i,isDir:e.isDir}})}logSuggestedShown(e,t,s,i="home"){(0,r.logHomeActivity)({eventName:o.LoggingTypes.SUGGESTED_SECTION_SHOWN,role:(0,a.getHomeStore)().getRole(),table:"home_suggest",extra:{num_items:e,variant:t,items_shown:s}})}logShowHideSection(e,t="home"){(0,r.logHomeActivity)({eventName:e?o.LoggingTypes.HIDE_SECTION:o.LoggingTypes.UNHIDE_SECTION,role:(0,a.getHomeStore)().getRole(),table:"home_suggest",extra:{section_name:this.homeSection}})}logRenderedSuggestedItems(e,t="home"){const s=(0,a.getHomeStore)().getRole(),n=i.map(e,(e,t)=>(0,r.logHomeActivity)({eventName:o.LoggingTypes.RENDERED_SUGGESTED_ITEM,role:s,suggestId:e.suggestId,table:"home_suggest",extra:{index:t,isDir:e.isDir}}));Promise.all(n)}}t.HomeSuggestLogger=l,t.homeSuggestLogger=new l})),define("metaserver/static/js/home/modals/new_folder_modal",["require","exports","tslib","react","dig-components/buttons","dig-components/modal","dig-components/typography","metaserver/static/js/clean/browse_uri_interface","metaserver/static/js/file_actions/create-folder","ts-key-enum","metaserver/static/js/logging/hive/schemas/web-modal-activity","metaserver/static/js/browse/actions","metaserver/static/js/folder_dialog/api","metaserver/static/js/components/ui/modal_controller","metaserver/static/js/sharing/cdm_new_folder_modal_components","metaserver/static/js/ux_analytics/utils","metaserver/static/js/clean/viewer","metaserver/static/js/clean/web_modal_activity_logger","metaserver/static/js/clean/web_timing_logger","metaserver/static/js/core/dom","metaserver/static/js/core/i18n","metaserver/static/js/clean/history_singleton","metaserver/static/js/folder_dialog/folder_picker_dig"],(function(e,t,s,i,r,a,n,o,c,l,d,m,u,h,p,_,g,f,v,E,S,T,y){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.showNewFolderModal=void 0,i=s.__importStar(i),c=s.__importStar(c),v=s.__importStar(v),E=s.__importStar(E);class b extends i.Component{constructor(e){super(e),this.close=()=>{this.logger.log(d.ModalEventName.CLOSE),this.setState({isModalOpen:!1}),(0,_.dispatchModalClosed)(),(0,h.unmountModal)(this.elementToFocusOnClose instanceof HTMLElement?this.elementToFocusOnClose:void 0)},this.handleFolderSelected=e=>{this.setState({currentPath:e||"/"})},this.handleClickCancel=()=>{this.logger.log(d.ModalEventName.SECONDARY_CLICK),m.browseActions.cancelCreateFolder(this.props.origin),this.props.redirectOnClose&&this.props.redirectOnClose(this.props.initialPath),this.close()},this.handleCreateClick=()=>{this.logger.log(d.ModalEventName.PRIMARY_CLICK,{path:this.state.currentPath}),c.createFolder({destination:this.state.currentPath,name:this.state.currentInputFolderName,user:this.props.user,checkFsw:!0,origin:this.props.origin,surface:"home"}).then(e=>{"success"===e.type?(this.logger.log(d.ModalEventName.SUCCESS),this.props.redirectOnClose?this.props.redirectOnClose(e.folder.path_display):(0,T.browserRedirectWrapper)((0,o.browse_uri_for_fq_path)(this.props.user,e.folder.path_display))):this.props.redirectOnClose&&this.props.redirectOnClose(),this.close()})},this.handleKeyDown=e=>{this.shouldAllowSubmit()&&e.key===l.Key.Enter&&E.focus_in_input()&&this.handleCreateClick()},this.handleReady=()=>{this.logger.log(d.ModalEventName.READY),(0,_.dispatchModalOpened)()},this.handleError=e=>{this.logger.log(d.ModalEventName.ERROR,{error:e.message})},this.handleDataLoaded=e=>{this.logger.log(d.ModalEventName.DATA_LOADED,{path:e})},this.handleBreadcrumbClicked=e=>{this.logger.log(d.ModalEventName.BREADCRUMB_CLICKED,{path:e})},this.handleRowClicked=(e,t,s)=>{this.logger.log(d.ModalEventName.ROW_CLICKED,{path:e,index:t,is_keyboard:s})},this.handleFolderNameChange=e=>{const t=e.target.value.trim();let s=void 0,i=void 0;t.length&&((0,p.FolderNameDefaultErrorValidator)(t)?(0,p.FolderNameDefaultWarningValidator)(t)||(i=p.FolderNameDefaultWarningMessage):s=p.FolderNameDefaultErrorMessage),this.setState({currentInputFolderName:t,folderNameValid:(0,p.FolderNameDefaultErrorValidator)(t),folderNameErrorText:s,folderNameWarningText:i})},this.shouldAllowSubmit=()=>{const{currentPath:e,currentInputFolderName:t,folderNameValid:s}=this.state;return!!("view"!==this.props.user.user_root_permissions||e&&"/"!==e)&&(""!==t&&s)},this.elementToFocusOnClose=document.activeElement,this.state={currentPath:e.initialPath||"/",currentInputFolderName:"",folderNameValid:!0,folderNameErrorText:void 0,folderNameWarningText:void 0,isModalOpen:!0}}componentDidMount(){this.logger=new f.WebModalActivityLogger(d.ModalName.HOME_NEW_FOLDER),this.logger.log(d.ModalEventName.SHOW),this.props.onShowModal&&this.props.onShowModal(this.logger.modalSessionId)}render(){const{user:e,initialPath:t}=this.props,{folderNameValid:s,folderNameErrorText:o,folderNameWarningText:c}=this.state,l=i.createElement(y.FolderPicker,{user:e,webTimer:v.get_timer(),rootName:g.Viewer.get_role_title(e)||S.intl.formatMessage({id:"mSjmSo",defaultMessage:"Dropbox"}),initialPath:t,canSelectReadonly:!1,onFolderSelected:this.handleFolderSelected,showFolderSuggestion:!1,apiClient:{getFolderContents:u.getFolderContentsAPIv2},skipFocusOnMount:!0,forceFolderSelectedCallback:!0,onError:this.handleError,onDataLoaded:this.handleDataLoaded,onBreadcrumbClicked:this.handleBreadcrumbClicked,onRowClicked:this.handleRowClicked});return i.createElement(a.Modal,{onAfterOpen:this.handleReady,open:this.state.isModalOpen,onRequestClose:this.close,withCloseButton:S.intl.formatMessage({id:"TnYT4C",defaultMessage:"Close"})},i.createElement(a.Modal.Header,{hasBottomSpacing:"title-small"},i.createElement(n.Title,{size:"small"},S.intl.formatMessage({id:"5Z9j+l",defaultMessage:"Create folder"}))),i.createElement(a.Modal.Body,{className:"folder-picker-container__fixed-height"},i.createElement(p.FolderNameInput,{key:"input",focusOnMount:!0,isValid:s,errorText:o,warningText:c,handleFolderNameChange:this.handleFolderNameChange,onKeyDown:this.handleKeyDown,useDig:!0,className:"folder-picker-name-input"}),l),i.createElement(a.Modal.Footer,null,i.createElement(r.Button,{variant:"opacity",onClick:this.handleClickCancel},S.intl.formatMessage({id:"aNfH1w",defaultMessage:"Cancel"})),i.createElement(r.Button,{variant:"primary",onClick:this.handleCreateClick,disabled:!this.shouldAllowSubmit()},S.intl.formatMessage({id:"Z2P2Q/",defaultMessage:"Create"}))))}}b.displayName="NewFolderModal";t.showNewFolderModal=({user:e,origin:t,initialPath:s,onShowModal:r,redirectOnClose:a})=>{c.logCreateFolder({uid:e.id,origin:t}),(0,h.mountModal)(i.createElement(b,{user:e,initialPath:s,onShowModal:r,origin:t,redirectOnClose:a}))}})),define("metaserver/static/js/home/post_tti/interface",["require","exports","metaserver/static/js/home/resource/actions_post_tti","metaserver/static/js/home/starred/actions_post_tti","metaserver/static/js/home/roots/home_access_web_post_tti","metaserver/static/js/home/recents/actions/recent_activity_actions_post_tti","metaserver/static/js/home/recents/actions/recent_activity_actions_utils_post_tti","metaserver/static/js/home/post_tti/unity_post_tti","metaserver/static/js/home/recents/components/recent_activity_container_post_tti","metaserver/static/js/home/recents/recent_activity_starred_post_tti","metaserver/static/js/home/recents/store_utils_post_tti","metaserver/static/js/home/recents/components/attachment_list_view_post_tti","metaserver/static/js/sharing/async_share_modal_util","metaserver/static/js/home/api_post_tti","metaserver/static/js/home/post_tti/props_post_tti","metaserver/static/js/home/util/logging/availability_logger_post_tti","metaserver/static/js/home/recents/recent_activity_client_post_tti","metaserver/static/js/home/recents/recent_activity_logger_utils_post_tti","metaserver/static/js/home/starred/actions_post_tti","metaserver/static/js/cloud_docs/home_create_file_experiments_post_tti","metaserver/static/js/extensions/client","metaserver/static/js/home/recents/recent_activity_file_action_post_tti","metaserver/static/js/home/starred/starred_item_file_action_post_tti","metaserver/static/js/home/content_suggestions/home_suggest","metaserver/static/js/upsell/home_inline_location","spectrum/dimensions/index","metaserver/static/js/home/surface_teams_homepage/home_teams","metaserver/static/js/home/recommended_members/recommended_members_post_tti","metaserver/static/js/plusplus/file_actions"],(function(e,t,s,i,r,a,n,o,c,l,d,m,u,h,p,_,g,f,v,E,S,T,y,b,I,w,j,A,R){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getLinkNodeEventObject=t.handleLinkNodeAction=t.initPrefetchRecommendedMembers=t.RecommendedMembers=t.initPrefetchHomeTeams=t.HomeTeams=t.Dimensions=t.initPrefetchHomeInlineContentPrompt=t.HomeInlineContentPrompt=t.initPrefetch=t.HomeSuggest=t.StarredItemFileActionPost=t.RecentActivityFileActionPost=t.getExtensionsClient=t.getNewFileMenu=t.loadAllStarredItems=t.logViewInFolder=t.logRecentsLoaded=t.logRequestFailed=t.openUrl=t.logOpenPathUrl=t.postLogEvent=t.archivePaperResources=t.logHomeAvailability=t.getPostTTIPropsInEdison=t.getDefaultHomePostTTIProps=t.getPostTTIProps=t.setSectionVisibility=t.createPaperDoc=t.asyncShowShareModal=t.AttachmentListView=t.loadRecentItems=t.loadPaperRecentItems=t.ensureAttachments=t.fetchStarredStatus=t.setStarredStatusOfPaperRecentItems=t.recentActivityContainerComponentDidMount=t.getUnityFeatures=t.deleteAttachments=t.deleteRecentItem=t.previewFileSyncRecentItem=t.shareFile=t.openVersions=t.downloadFiles=t.openFile=t.homeAccessWebComponentDidMount=t.getStarredStatusMetadata=t.createAutoShareLink=t.openInFileViewer=void 0,Object.defineProperty(t,"openInFileViewer",{enumerable:!0,get:function(){return s.openInFileViewer}}),Object.defineProperty(t,"createAutoShareLink",{enumerable:!0,get:function(){return s.createAutoShareLink}}),Object.defineProperty(t,"getStarredStatusMetadata",{enumerable:!0,get:function(){return i.getStarredStatusMetadata}}),Object.defineProperty(t,"homeAccessWebComponentDidMount",{enumerable:!0,get:function(){return r.homeAccessWebComponentDidMount}}),Object.defineProperty(t,"openFile",{enumerable:!0,get:function(){return a.openFile}}),Object.defineProperty(t,"downloadFiles",{enumerable:!0,get:function(){return a.downloadFiles}}),Object.defineProperty(t,"openVersions",{enumerable:!0,get:function(){return a.openVersions}}),Object.defineProperty(t,"shareFile",{enumerable:!0,get:function(){return a.shareFile}}),Object.defineProperty(t,"previewFileSyncRecentItem",{enumerable:!0,get:function(){return a.previewFileSyncRecentItem}}),Object.defineProperty(t,"deleteRecentItem",{enumerable:!0,get:function(){return a.deleteRecentItem}}),Object.defineProperty(t,"deleteAttachments",{enumerable:!0,get:function(){return n.deleteAttachments}}),Object.defineProperty(t,"getUnityFeatures",{enumerable:!0,get:function(){return o.getUnityFeatures}}),Object.defineProperty(t,"recentActivityContainerComponentDidMount",{enumerable:!0,get:function(){return c.recentActivityContainerComponentDidMount}}),Object.defineProperty(t,"setStarredStatusOfPaperRecentItems",{enumerable:!0,get:function(){return l.setStarredStatusOfPaperRecentItems}}),Object.defineProperty(t,"fetchStarredStatus",{enumerable:!0,get:function(){return l.fetchStarredStatus}}),Object.defineProperty(t,"ensureAttachments",{enumerable:!0,get:function(){return d.ensureAttachments}}),Object.defineProperty(t,"loadPaperRecentItems",{enumerable:!0,get:function(){return d.loadPaperRecentItems}}),Object.defineProperty(t,"loadRecentItems",{enumerable:!0,get:function(){return d.loadRecentItems}}),Object.defineProperty(t,"AttachmentListView",{enumerable:!0,get:function(){return m.AttachmentListView}}),Object.defineProperty(t,"asyncShowShareModal",{enumerable:!0,get:function(){return u.asyncShowShareModal}}),Object.defineProperty(t,"createPaperDoc",{enumerable:!0,get:function(){return h.createPaperDoc}}),Object.defineProperty(t,"setSectionVisibility",{enumerable:!0,get:function(){return h.setSectionVisibility}}),Object.defineProperty(t,"getPostTTIProps",{enumerable:!0,get:function(){return p.getPostTTIProps}}),Object.defineProperty(t,"getDefaultHomePostTTIProps",{enumerable:!0,get:function(){return p.getDefaultHomePostTTIProps}}),Object.defineProperty(t,"getPostTTIPropsInEdison",{enumerable:!0,get:function(){return p.getPostTTIPropsInEdison}}),Object.defineProperty(t,"logHomeAvailability",{enumerable:!0,get:function(){return _.logHomeAvailability}}),Object.defineProperty(t,"archivePaperResources",{enumerable:!0,get:function(){return g.archivePaperResources}}),Object.defineProperty(t,"postLogEvent",{enumerable:!0,get:function(){return g.postLogEvent}}),Object.defineProperty(t,"logOpenPathUrl",{enumerable:!0,get:function(){return f.logOpenPathUrl}}),Object.defineProperty(t,"openUrl",{enumerable:!0,get:function(){return f.openUrl}}),Object.defineProperty(t,"logRequestFailed",{enumerable:!0,get:function(){return f.logRequestFailed}}),Object.defineProperty(t,"logRecentsLoaded",{enumerable:!0,get:function(){return f.logRecentsLoaded}}),Object.defineProperty(t,"logViewInFolder",{enumerable:!0,get:function(){return f.logViewInFolder}}),Object.defineProperty(t,"loadAllStarredItems",{enumerable:!0,get:function(){return v.loadAllStarredItems}}),Object.defineProperty(t,"getNewFileMenu",{enumerable:!0,get:function(){return E.getNewFileMenu}}),Object.defineProperty(t,"getExtensionsClient",{enumerable:!0,get:function(){return S.getExtensionsClient}}),Object.defineProperty(t,"RecentActivityFileActionPost",{enumerable:!0,get:function(){return T.RecentActivityFileActionPost}}),Object.defineProperty(t,"StarredItemFileActionPost",{enumerable:!0,get:function(){return y.StarredItemFileActionPost}}),Object.defineProperty(t,"HomeSuggest",{enumerable:!0,get:function(){return b.HomeSuggest}}),Object.defineProperty(t,"initPrefetch",{enumerable:!0,get:function(){return b.initPrefetch}}),Object.defineProperty(t,"HomeInlineContentPrompt",{enumerable:!0,get:function(){return I.HomeInlineContentPrompt}}),Object.defineProperty(t,"initPrefetchHomeInlineContentPrompt",{enumerable:!0,get:function(){return I.initPrefetchHomeInlineContentPrompt}}),Object.defineProperty(t,"Dimensions",{enumerable:!0,get:function(){return w.Dimensions}}),Object.defineProperty(t,"HomeTeams",{enumerable:!0,get:function(){return j.HomeTeams}}),Object.defineProperty(t,"initPrefetchHomeTeams",{enumerable:!0,get:function(){return j.initPrefetchHomeTeams}}),Object.defineProperty(t,"RecommendedMembers",{enumerable:!0,get:function(){return A.RecommendedMembers}}),Object.defineProperty(t,"initPrefetchRecommendedMembers",{enumerable:!0,get:function(){return A.initPrefetchRecommendedMembers}}),Object.defineProperty(t,"handleLinkNodeAction",{enumerable:!0,get:function(){return R.handleLinkNodeAction}}),Object.defineProperty(t,"getLinkNodeEventObject",{enumerable:!0,get:function(){return R.getLinkNodeEventObject}})})),define("metaserver/static/js/home/post_tti/props_post_tti",["require","exports","tslib","metaserver/static/js/cloud_docs/home_create_file_experiments_post_tti","metaserver/static/js/home/util/prefetch_handler","metaserver/static/js/core/exception","lodash","metaserver/static/js/home/store","metaserver/static/js/proto_utils/unpack","typescript/dropbox/proto/edison_starred/edison_starred_pb","typescript/dropbox/proto/edison_recent/edison_recent_pb"],(function(e,t,s,i,r,a,n,o,c,l,d){"use strict";function m(){return{maybeRenderTeamAdminModals:!1,permissionsAtUploadModalProps:{autoTeamGroupId:""},uploaderPostTTIExperiments:{},cloudDocsExperiments:(0,i.getCloudDocsExperiments)(),preferredEditors:{},showLegacyCreatePaperButton:!1,expFlowsAutomatedFolderUI:!1,userHasSharedFileOrFolderInfo:{},expFlowsBuilderUI:!1}}Object.defineProperty(t,"__esModule",{value:!0}),t.getPostTTIPropsInEdison=t.getPostTTIProps=t.getDefaultHomePostTTIProps=void 0,t.getDefaultHomePostTTIProps=m,t.getPostTTIProps=(0,n.once)(()=>new Promise(e=>{const t=(0,r.getPrefetchHandler)("__REGISTER_POST_TTI_PREFETCH_HANDLER"),s=()=>e(m());t?(0,r.handlePrefetch)(t,t=>{try{e(JSON.parse(t))}catch(e){(0,a.reportStack)("Failed to parse post TTI props",{severity:a.SEVERITY.CRITICAL,exc_extra:{error:e}}),s()}},e=>{(0,a.reportStack)("Post TTI prefetch failed",{severity:a.SEVERITY.CRITICAL,exc_extra:{error:e}}),s()}):s()})),t.getPostTTIPropsInEdison=function(){return s.__awaiter(this,void 0,void 0,(function*(){const e=(0,o.getHomeStore)(),t=e.getPostTTIPropsPromise();return new Promise(t?function(s){t.then(t=>{let i;i="STARRED"===e.getPageType(location.pathname)?(0,c.unmarshalProto)(t,l.EdisonStarredPostTtiPrefetchResults):(0,c.unmarshalProto)(t,d.EdisonRecentsPostTTIPrefetchResults);let r=m();i.error||(r=JSON.parse(i.jsonData)),s(r)})}:function(e){e(m())})}))}})),define("metaserver/static/js/home/post_tti/unity_post_tti",["require","exports","tslib"],(function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getUnityFeatures=void 0,t.getUnityFeatures=function(){return s.__awaiter(this,void 0,void 0,(function*(){try{const{UnityFeatures:t}=yield new Promise((t,s)=>{e(["metaserver/static/js/unity/features"],t,s)}).then(s.__importStar);return t.isUnitySupported()?t:null}catch(e){return null}}))}})),define("metaserver/static/js/home/recents/actions/recent_activity_actions_post_tti",["require","exports","tslib","lodash","react-intl","typescript/component_libraries/spectrum-sharing/src/utils/sharing_constants","metaserver/static/js/clean/browse_uri_interface","metaserver/static/js/cloud_docs/constants","metaserver/static/js/cloud_docs/preferred_editor_utils","metaserver/static/js/clean/downloads","metaserver/static/js/filepath/filepath","metaserver/static/js/clean/navigation","metaserver/static/js/display_types/constants","metaserver/static/js/home/post_tti/unity_post_tti","metaserver/static/js/home/recents/actions/recent_activity_actions_utils_post_tti","metaserver/static/js/home/recents/models/utils","metaserver/static/js/home/recents/recent_activity_constants","metaserver/static/js/home/recents/recent_activity_logger_utils_post_tti","metaserver/static/js/home/recents/store_utils_post_tti","metaserver/static/js/home/recents/stores/attachment_store","metaserver/static/js/home/resource/actions_post_tti","metaserver/static/js/home/store","metaserver/static/js/clean/ui/modal_dig","metaserver/static/js/sharing/async_share_modal_util","metaserver/static/js/core/assert","metaserver/static/js/core/exception","metaserver/static/js/core/i18n","metaserver/static/js/core/notify","metaserver/static/js/core/uri","metaserver/static/js/edison/ui/router_utils"],(function(e,t,s,i,r,a,n,o,c,l,d,m,u,h,p,_,g,f,v,E,S,T,y,b,I,w,j,A,R,C){"use strict";function P(e){return{index:e.index}}function D({attachment:e,attachmentIds:t,logData:s,shouldOpenInTab:i,isCommentAction:r,href:a,middleClick:l}){const u=e.fqPath&&((0,o.isCloudDocByExtension)((0,d.file_extension)(e.fqPath))||(0,c.hasPreferredEditorSupport)(e.fqPath));if(e.isDir||i&&!u){const r=(function(e,t){return e.fqPath?String((0,n.preview_uri_for_fq_path)(t,e.fqPath)):e.previewInfo&&e.previewInfo.href||null})(e,(0,T.getHomeStore)().getUser());if(r){if(e.isDir&&!i)if((0,C.shouldUseReactRouter)()){const i=(0,n.get_browse_root)((0,T.getHomeStore)().getUser())+e.fqPath;(0,f.openUrl)(i,g.ActionType.OPEN_DIR,t,s)}else(0,m.logAndNavigate)(r,()=>(0,f.logRecentActivityAction)(g.ActionType.VIEW_FILE,t,s),m.NavigationMethod.REDIRECT);else(0,f.openTab)(r,g.ActionType.VIEW_FILE,t,s);return!0}return!1}{const i=r?g.ActionType.COMMENT:g.ActionType.VIEW_FILE;return(0,S.openInFileViewer)({resourceId:e.id,logViewFunction:()=>(0,f.logRecentActivityAction)(i,t,s),isCommentAction:r,href:a,middleClick:l}),!0}}Object.defineProperty(t,"__esModule",{value:!0}),t.previewAttachment=t.previewFileSyncRecentItem=t.openVersions=t.downloadFiles=t.deleteRecentItem=t.openFile=t.shareFile=void 0,i=s.__importStar(i),l=s.__importStar(l),w=s.__importStar(w),t.shareFile=function(e,t,i){var r;return s.__awaiter(this,void 0,void 0,(function*(){const s=(0,T.getUser)(),n=yield(0,v.ensureAttachments)([e],g.EnsureAttachmentsPurpose.SHARE_FILE),o=n[0],c=o.fqPath||"",l=o.previewInfo,d=l?l.target_ns:null;let m=!1;return i?((0,S.createAutoShareLink)(s,c),m=!0):m=yield(0,b.asyncShowShareModal)(s,{fqPath:c,isFolder:!!(null===(r=o.previewInfo)||void 0===r?void 0:r.is_dir),targetNsId:d},{origin:a.SHARE_ACTION_ORIGIN_TYPE.RECENTS}),t&&m&&((0,f.logShareFile)(s.id,c,t.totalCount,t),(0,p.homeLogEvent)(t,g.ActionType.SHARE,n,(0,p.getFqPaths)(n).indexOf(c))),m}))},t.openFile=function(e,t){return s.__awaiter(this,void 0,void 0,(function*(){const s=yield(0,h.getUnityFeatures)();(0,I.assert)(!!s,"Unity is not supported by this browser");const r=yield(0,v.ensureAttachments)([e],g.EnsureAttachmentsPurpose.OPEN_FILE),{nsId:a,nsPath:n}=r[0],o=r[0].fqPath||"",c=(0,T.getUserId)();s.open_file(a,n,c,i.noop,e=>{A.Notify.error("We were unable to open this file"),w.reportException({err:Error(e),tags:["recents"],severity:w.SEVERITY.NONCRITICAL})}),t&&((0,f.logUnityOpenFile)(c,o,t.totalCount,t),(0,p.homeLogEvent)(t,g.ActionType.OPEN,r))}))},t.deleteRecentItem=function(e,t,a,n){return s.__awaiter(this,void 0,void 0,(function*(){const{federatedRecentItem:s,displayType:n}=e;if(s)w.reportStack("Deleting is not supported for federated recent items",{severity:w.SEVERITY.NONCRITICAL,exc_extra:{recentItem:e}});else{const e=(0,_.extractAttachmentIds)(t),s=()=>(0,p.deleteAttachments)(e,a);let o,c;if(1===e.length){const t=(0,E.getAttachmentStore)().getById(e[0]);if(t&&t.isLoaded){c=t.isDir?j.intl.formatMessage({id:"Z9HlH9",defaultMessage:"Delete folder?"}):j.intl.formatMessage({id:"mPIBsk",defaultMessage:"Delete file?"});const e=n===u.DisplayTypes.SHARED_FOLDER?(0,r.defineMessage)({id:"9Fi8TL",defaultMessage:"Are you sure you want to remove the shared folder <b>{file_name}</b> from your Dropbox? This shared folder will stay shared with other members and you can re-add it later."}):(0,r.defineMessage)({id:"l7h1V3",defaultMessage:"Do you want to delete <b>{file_name}</b>?"});o=j.intl.formatMessage(e,{file_name:i.escape(t.displayName||""),b:e=>`<b>${e.join("")}</b>`})}else c=j.intl.formatMessage({id:"mPIBsk",defaultMessage:"Delete file?"}),o=j.intl.formatMessage({id:"D3751u",defaultMessage:"Do you want to delete this file?"})}else c=j.intl.formatMessage({id:"V5KZzi",defaultMessage:"Delete files?"}),o=j.intl.formatMessage({id:"ZRCJDk",defaultMessage:"Do you want to delete <b>{num} files</b>?"},{num:i.escape(String(e.length)),b:e=>`<b>${e.join("")}</b>`});y.SimpleModal.show({title_text:c,body_html:o,confirm_text:j.intl.formatMessage({id:"iNfEof",defaultMessage:"Delete"}),confirm_callback:s,cancel_text:j.intl.formatMessage({id:"AqRWwC",defaultMessage:"Cancel"}),autoclose:!0})}}))},t.downloadFiles=function(e,t){return s.__awaiter(this,void 0,void 0,(function*(){const s=(0,T.getUserId)(),i=yield(0,v.ensureAttachments)(e,g.EnsureAttachmentsPurpose.DOWNLOAD_FILES);t&&((0,f.logDownloadFile)(s,(0,p.getFqPaths)(i),t.totalCount,t),(0,p.homeLogEvent)(t,g.ActionType.DOWNLOAD,i)),i.forEach(e=>{if(e.isDir&&e.fqPath&&null!=e.previewInfo&&null!=e.previewInfo.block_hash)l.get_zip({fq_paths:[e.fqPath],subject_uid:s,block_hash:e.previewInfo.block_hash,parent_path:e.fqPath});else{const t=null!=e.previewInfo&&"href"in e.previewInfo?e.previewInfo.href:void 0;t&&l.get({url:t})}})}))},t.openVersions=function(e,t,i){return s.__awaiter(this,void 0,void 0,(function*(){const s=(0,T.getUserId)(),{attachments:r,isRetry:a}=yield(0,v.ensureAttachmentsWithRetryStatus)([t],g.EnsureAttachmentsPurpose.OPEN_VERSIONS),n=r[0].fqPath||"",o=(function(e,t,s={}){return s=Object.assign({_subject_uid:String(t)},s),new R.URI({path:`/history${e}`,query:s})})(n,s);(0,m.logAndNavigate)(o.toString(),i?()=>((0,f.logOpenVersions)(s,n,i.totalCount,i),(0,p.homeLogEvent)(i,g.ActionType.VERSIONS,r)):void 0,a?m.NavigationMethod.REDIRECT:e)}))},t.previewFileSyncRecentItem=function(e,t,i,r,a,n){return s.__awaiter(this,void 0,void 0,(function*(){const{attachments:s,isRetry:c}=yield(0,v.ensureAttachmentsWithRetryStatus)([e.attachmentIds[0]],g.EnsureAttachmentsPurpose.PREVIEW_RECENT_ITEM);if(1===s.length){const l=s[0];if(!e.isMounted&&e.scl)return void(e.fqPath&&(0,o.isPointerByExtension)(e.fqPath)?(0,f.openUnsafeTab)(e.scl,g.ActionType.VIEW_FILE,e.attachmentIds,r):(0,f.openTab)(e.scl,g.ActionType.VIEW_FILE,e.attachmentIds,r));if(D({attachment:l,attachmentIds:e.attachmentIds,logData:r,shouldOpenInTab:t&&!c,isCommentAction:i.isCommentAction,href:a,middleClick:n}))return}w.reportStack("Preview failed",{severity:w.SEVERITY.NONCRITICAL,exc_extra:{recentItem:e,attachments:s,previewOptions:P(i)}})}))},t.previewAttachment=function(e,t,s,i,r,a){D({attachment:t.find(t=>t.id===e),attachmentIds:(0,_.extractAttachmentIds)(t),logData:i,shouldOpenInTab:(0,m.isMetaKeyPressed)(s),href:r,middleClick:a})}})),define("metaserver/static/js/home/recents/actions/recent_activity_actions_utils_post_tti",["require","exports","tslib","lodash","metaserver/static/js/file_actions/metrics","metaserver/static/js/metrics/index","metaserver/static/js/files_view/file_actions/api_v2","metaserver/static/js/home/recents/recent_activity_constants","metaserver/static/js/home/recents/recent_activity_dispatcher","metaserver/static/js/home/recents/recent_activity_logger_utils_post_tti","metaserver/static/js/home/recents/store_utils_post_tti","metaserver/static/js/home/recents/utils/events","metaserver/static/js/home/store","metaserver/static/js/clean/ui/snackbar","metaserver/static/js/core/i18n","metaserver/static/js/core/exception"],(function(e,t,s,i,r,a,n,o,c,l,d,m,u,h,p,_){"use strict";function g(e){return i.compact(i.map(e,"fqPath"))}function f(e,t,s,i){return"cellView"in e?(0,m.logEvent)(t,e.cellView,s,e.totalCount,i):(0,m.logCleanerEvent)(t,e.itemNumber,e.subgroupPosition,s,e.totalCount,i)}Object.defineProperty(t,"__esModule",{value:!0}),t.deleteAttachments=t.homeLogEvent=t.getFqPaths=void 0,i=s.__importStar(i),n=s.__importStar(n),t.getFqPaths=g,t.homeLogEvent=f,t.deleteAttachments=function(e,t){return s.__awaiter(this,void 0,void 0,(function*(){const s=(0,u.getUserId)(),m=yield(0,d.ensureAttachments)(e,o.EnsureAttachmentsPurpose.PROMPT_AND_DELETE_ATTACHMENTS),v=g(m),E=m.filter(e=>null!==e.fqPath).map(e=>({fq_path:e.fqPath,is_dir:e.isDir}));if(t){const{totalCount:e}=t;(0,l.logDeleteFiles)(s,v,e,t),f(t,o.ActionType.DELETE,m,void 0)}const S=(0,a.getMetricsReporter)(),T={surface:"recents",batchSizeBucket:(0,r.bucketForBatchSize)(e.length),contentType:"files"},y=S.createTimer({ns:r.FILE_ACTIONS_AMP_NAMESPACE,name:"delete/batch/latency_total_ms"},T),b=Date.now(),I=S.createStats({ns:r.FILE_ACTIONS_AMP_NAMESPACE,name:"delete/batch/latency_average_ms"},T),w=S.createStats({ns:r.FILE_ACTIONS_AMP_NAMESPACE,name:"delete/batch/completed"},T),j=i.uniqueId("DELETE_FILES");c.recentActivityDispatcher.dispatch({type:o.DELETE_FILES_PENDING,attachmentIds:e,transactionId:j}),h.Snackbar.complete(p.intl.formatMessage({id:"20q1Pn",defaultMessage:"{count, plural, one{Deleted {count} item.} other{Deleted {count} items.}}"},{count:v.length}),"home-delete");const A=yield n.deleteFiles(E,s,!1);if(y.record(),I.record((Date.now()-b)/e.length),A.isError)h.Snackbar.fail(p.intl.formatMessage({id:"gq9/8S",defaultMessage:"Failed to perform the delete. Please try again later."}),"home-delete"),(0,_.reportException)({err:new Error(A.error_summary),severity:"non-critical",tags:["browse","recents"]}),w.record(0),c.recentActivityDispatcher.dispatch({type:o.DELETE_FILES_ROLLBACK,transactionId:j});else{c.recentActivityDispatcher.dispatch({type:o.DELETE_FILES_COMMIT,transactionId:j});const e=A.result.entries.filter(e=>n.isFailure(e)&&!n.isPathLookupFailure(e.failure)).length,t=A.result.entries.filter(n.isFailure);w.record(e>0?0:1),(0,r.recordPathLookupErrors)(t,"delete",T)}}))}})),define("metaserver/static/js/home/recents/components/attachment_file_icon_view_post_tti",["require","exports","tslib","react","dig-components/tooltips","dig-components/typography","metaserver/static/js/home/util/resource_icon"],(function(e,t,s,i,r,a,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AttachmentFileIconView=void 0,i=s.__importDefault(i);class o extends i.default.Component{constructor(){super(...arguments),this.onClick=e=>{e.preventDefault(),e.stopPropagation(),this.props.handleClick(this.props.id,e)}}render(){const{overlayText:e,file:t,width:s,height:o}=this.props;return e?i.default.createElement("button",{onClick:this.onClick,className:"recents-item__attachment-item recents-item__attachment-item--has-overlay",style:{width:s,height:o}},i.default.createElement("span",{className:"recents-item__attachment-overlay"},i.default.createElement(a.Text,{size:"large",inverse:!0,isBold:!0},e))):i.default.createElement(r.Tooltip,{title:t.displayName,placement:"bottom"},i.default.createElement("button",{className:"recents-item__attachment-item","aria-label":t.displayName,onClick:this.onClick,style:{width:s,height:o}},i.default.createElement(n.HomeResourceIcon,{className:"recents-item__attachment-icon",displayType:t.displayType,fileName:t.displayName,isLarge:!0})))}}t.AttachmentFileIconView=o,o.displayName="AttachmentFileIconView"})),define("metaserver/static/js/home/recents/components/attachment_grid_post_tti",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AttachmentGrid=void 0;class s{constructor(e,t){this._gridWidth=e,this._gutterWidth=t}static create(e,t){return new s(e,t)}generate(e,t=1/0){const s=[];let i=0;for(;s.length<t&&i<e.length;){const t=this.buildRow(e.slice(i));i+=t.length,s.push(t)}return s}buildRow(e){const t=[];let s=this._gridWidth+this._gutterWidth;for(const i of e){if(s=s-i.width-this._gutterWidth,!(s>=0||0===t.length))break;t.push(i)}return t}}t.AttachmentGrid=s})),define("metaserver/static/js/home/recents/components/attachment_image_view_post_tti",["require","exports","tslib","react","classnames","dig-components/typography","dig-components/tooltips"],(function(e,t,s,i,r,a,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AttachmentImageView=void 0,i=s.__importDefault(i),r=s.__importDefault(r);class o extends i.default.PureComponent{constructor(){super(...arguments),this.state={isLoading:!0},this.onClick=e=>{e.preventDefault(),e.stopPropagation(),this.props.handleClick(this.props.id,e)},this.onLoad=()=>{this.setState({isLoading:!1})},this.onError=()=>{this.props.handleLoadError(this.props.id),this.setState({isLoading:!1})}}render(){const{image:e,overlayText:t}=this.props,s=i.default.createElement("button",{onClick:this.onClick,className:(0,r.default)("recents-item__attachment-item",{"recents-item__attachment-item--has-overlay":!!t}),style:{width:e.width,height:e.height},"aria-label":e.displayName},i.default.createElement("img",{alt:e.displayName,className:(0,r.default)("recents-item__attachment-thumbnail",{"recents-item__attachment-thumbnail--has-overlay":!!t,"recents-item__attachment-thumbnail--is-loading":this.state.isLoading}),src:e.thumbnailUrl,onLoad:this.onLoad,onError:this.onError}),t&&i.default.createElement("span",{className:"recents-item__attachment-overlay"},i.default.createElement(a.Text,{size:"large",inverse:!0,isBold:!0},t)));return t?s:i.default.createElement(n.Tooltip,{title:e.displayName,placement:"bottom"},s)}}t.AttachmentImageView=o,o.displayName="AttachmentImageView"})),define("metaserver/static/js/home/recents/components/attachment_list_layout_post_tti",["require","exports","tslib","lodash","metaserver/static/js/photos/thumbnail_url_util","metaserver/static/js/home/recents/components/attachment_file_icon_view_post_tti","metaserver/static/js/home/recents/components/attachment_grid_post_tti","metaserver/static/js/home/recents/components/attachment_image_view_post_tti","metaserver/static/js/core/browser_detection","metaserver/static/js/core/assert"],(function(e,t,s,i,r,a,n,o,c,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AttachmentListLayout=void 0,i=s.__importStar(i);const d=r.ThumbnailSizeMode.FIT_ONE,m=r.ThumbnailSizeMode.EXACT_NO_BACKGROUND;class u{constructor(e,t,s){this.gridWidth=e,this.columnWidth=t,this.gutterWidth=s,this._grid=n.AttachmentGrid.create(this.gridWidth,this.gutterWidth)}static create(e,t,s){return new u(e,t,s)}generate(e,t,s){const i=this.cellMetadata(e,s);return this._grid.generate(i,t)}cellMetadata(e,t){const s=i.zipObject(t,t);return e.map(e=>{const{isLoaded:t,thumbnailUrl:i}=e;return s[e.id]||t&&!i?this.buildFileIconViewMetadata(e):t?this.buildImageViewMetadata(e):this.buildLoadingImageViewMetadata(e)})}buildFileIconViewMetadata(e){return{id:e.id,scaledThumbnailUrl:null,view:a.AttachmentFileIconView,width:this.columnWidth,height:this.columnWidth,attachment:e}}buildLoadingImageViewMetadata(e){return{id:e.id,scaledThumbnailUrl:null,view:null,width:this.columnWidth,height:this.columnWidth,attachment:e}}buildImageViewMetadata(e){let t=e.thumbnailUrl;const{width:s,height:i,variant:a}=this.calculateThumbnailDimensions(e.thumbnailDimensions);return t.startsWith("data:")||(t=(function(e,t){let s,i,a;const n=(0,c.is_high_density_display)();switch(t){case"aggregated-scaled":a=n?200:100,s=n?200:100,i=d;break;case"aggregated-cropped":a=n?200:100,s=n?200:100,i=m;break;case"aggregated-wide-cropped":a=n?718:359,s=n?200:100,i=m;break;default:return(0,l.assert)(!1,`invalid ThumbnailVariant: ${t}`),""}return(0,r.thumbnailUrlForSize)(e,a,s,i)})(t,a)),{id:e.id,view:o.AttachmentImageView,scaledThumbnailUrl:t,width:s+0,height:i+0,attachment:e}}calculateThumbnailDimensions(e){let t,s,i;if(e){i="aggregated-scaled";const r=e.width/e.height;t=this.columnWidth,s=Math.floor(r*t),s>this.columnWidth-0&&(i="aggregated-wide-cropped",s=this.columnWidth-0)}return(!e||s<75)&&(i="aggregated-cropped",s=this.columnWidth,t=this.columnWidth),{width:s,height:t,variant:i}}}t.AttachmentListLayout=u})),define("metaserver/static/js/home/recents/components/attachment_list_view_post_tti",["require","exports","tslib","lodash","react","metaserver/static/js/components/loading_indicator","metaserver/static/js/display_types/constants","metaserver/static/js/home/recents/actions/recent_activity_actions_post_tti","metaserver/static/js/home/recents/components/attachment_file_icon_view_post_tti","metaserver/static/js/home/recents/components/attachment_image_view_post_tti","metaserver/static/js/home/recents/components/attachment_list_layout_post_tti","metaserver/static/js/home/recents/recent_activity_constants","metaserver/static/js/home/recents/store_utils_post_tti","metaserver/static/js/core/i18n"],(function(e,t,s,i,r,a,n,o,c,l,d,m,u,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AttachmentListView=void 0,i=s.__importStar(i),r=s.__importDefault(r);class p extends r.default.Component{constructor(e){super(e),this.previewAttachment=(e,t)=>{const{attachments:s}=this.props,i={totalCount:s.length,cellView:this};(0,o.previewAttachment)(e,s,t,i)},this.handleImageLoadError=e=>{const t=[...this.state.errored];t.push(e),this.setState({errored:t})},this.revealNextGroup=()=>{this.setState({rows:this.state.rows+m.SHOW_MORE_THUMBNAIL_ROW_INCREMENT})},this.state={rows:1,errored:[],expandedAttachments:{},grid:[]}}componentDidMount(){this.updateLayoutController()}componentDidUpdate(e,t){e.width===this.props.width&&t.errored===this.state.errored&&t.rows===this.state.rows||(this.updateLayoutController(),this.state.rows>t.rows&&this.loadRemainingAttachments())}updateLayoutController(){this.props.width&&this.props.width>0&&this.setState({grid:i.flattenDeep(d.AttachmentListLayout.create(this.props.width,this.props.width>400?100:50,8).generate(this.props.attachments,this.isLoading()?1:this.state.rows,this.state.errored))})}loadRemainingAttachments(){const e=this.props.attachments.filter(e=>!e.isLoaded).map(e=>e.id);e.length&&(0,u.ensureAttachments)(e,m.EnsureAttachmentsPurpose.LOAD_REMAINING_ATTACHMENTS)}isLoading(){return this.state.rows>1&&this.props.attachments.some(e=>!e.isLoaded)}renderAttachmentItems(){const{attachments:e}=this.props,{grid:t}=this.state;if(!t.length)return[];let s=this.previewAttachment;const i=t.length,a=e.length,o=a-i+1,d=!this.isLoading()&&i<a;return t.map((e,i)=>{let a;d&&i===t.length-1&&(s=this.revealNextGroup,a=h.intl.formatMessage({id:"o+CHKf",defaultMessage:"+{count}"},{count:o}));const{attachment:m,view:u,id:p,scaledThumbnailUrl:_,width:g,height:f}=e,{displayName:v,displayType:E}=m;switch(u){case c.AttachmentFileIconView:return r.default.createElement(c.AttachmentFileIconView,{key:`attachment-${p}`,id:p,file:{displayName:v||"",displayType:E||n.DisplayTypes.FILE},overlayText:a,handleClick:s,width:g,height:f});case l.AttachmentImageView:return r.default.createElement(l.AttachmentImageView,{key:`attachment-expanded-${p}`,overlayText:a,id:p,image:{thumbnailUrl:_,displayName:v||"",width:g,height:f},handleClick:s,handleLoadError:this.handleImageLoadError});default:return null}})}renderLoadingView(){return r.default.createElement("div",{className:"attachment-loading"},r.default.createElement(a.LoadingIndicator,{style:a.LoadingIndicator.LoadingIndicatorStyle.BLUE_SPINNER,className:"recents-loading-indicator"}))}render(){let e=null;return this.isLoading()&&(e=this.renderLoadingView()),r.default.createElement(r.default.Fragment,null,this.renderAttachmentItems(),e)}}t.AttachmentListView=p,p.displayName="AttachmentListView"})),define("metaserver/static/js/home/recents/components/recent_activity_container_post_tti",["require","exports","tslib","lodash","metaserver/static/js/sharing/share_modal_util","metaserver/static/js/sharing/wizard/wizard_modals"],(function(e,t,s,i,r,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.recentActivityContainerComponentDidMount=t.shareExistingFolder=t.generateModalSessionId=void 0,i=s.__importStar(i),Object.defineProperty(t,"generateModalSessionId",{enumerable:!0,get:function(){return r.generateModalSessionId}}),Object.defineProperty(t,"shareExistingFolder",{enumerable:!0,get:function(){return a.shareExistingFolder}}),t.recentActivityContainerComponentDidMount=function(e){return s.__awaiter(this,void 0,void 0,(function*(){(function(e){let t=0;const s=()=>{const s=void 0!==window.pageYOffset?window.pageYOffset:(document.documentElement||document.body.parentNode||document.body).scrollTop,i=document.documentElement.scrollHeight-window.innerHeight;s/i>.8&&i>t&&(e(),t=i)};window.addEventListener("scroll",i.throttle(s,150)),s()})(e)}))}})),define("metaserver/static/js/home/recents/recent_activity_client_post_tti",["require","exports","tslib","metaserver/static/js/modules/constants/python","lodash","metaserver/static/js/home/api","metaserver/static/js/home/recents/recent_activity_client_utils"],(function(e,t,s,i,r,a,n){"use strict";function o(e,t,s,i=!0){return(0,a.makeRequest)({subject_user:e,type:"POST",url:t,data:s},{isBackground:i})}function c(e,t,i,r=!0){return s.__awaiter(this,void 0,void 0,(function*(){return(0,n.getPayload)(yield o(e,t,i,r))}))}Object.defineProperty(t,"__esModule",{value:!0}),t.checkFileInRootCollection=t.activityGenerateJson=t.archivePaperResources=t.postLogEvent=t.retrievePaperRecents=t.recentsJson=t.fetchPayload=void 0,r=s.__importStar(r),t.fetchPayload=c,t.recentsJson=function(e,t){return o(e,"/recents/json",{num_activities:t?20:10,cursor:t})},t.retrievePaperRecents=function(e,t){return s.__awaiter(this,void 0,void 0,(function*(){return yield o(e,"/home_feed/retrieve_paper_recents",{is_initial_fetch:t})}))},t.postLogEvent=function(e,t){(0,a.makeRequest)({url:"/recents/logger",type:"POST",subject_user:e,data:t,dataType:"text"},{isBackground:!0})},t.archivePaperResources=function(e,t){return c(e,"/home_feed/archive_paper_resources",{resources_json:JSON.stringify(t)},!1)},t.activityGenerateJson=function(e,t,a){return s.__awaiter(this,void 0,void 0,(function*(){return(yield c(e,"/activity/generate/json",{activity_keys:JSON.stringify(r.uniq(t)),loading_modes:JSON.stringify([i.FILE_ACTIVITY_LOADING_MODE.PREVIEW_INFO]),encrypted:a})).activities_by_activity_key}))},t.checkFileInRootCollection=function(e,t){return s.__awaiter(this,void 0,void 0,(function*(){return(yield c(e,"/recents/check_files_in_root_collection",{files_json:JSON.stringify(t)})).file_in_root_collection_info}))}})),define("metaserver/static/js/home/recents/recent_activity_file_action_post_tti",["require","exports","tslib","react","metaserver/static/js/filepath/filepath","metaserver/static/js/app_actions/app_actions_menu","metaserver/static/js/extensions/data/types","metaserver/static/js/home/resource_id_types","metaserver/static/js/home/store","metaserver/static/js/home/util/file_utils"],(function(e,t,s,i,r,a,n,o,c,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RecentActivityFileActionPost=void 0,i=s.__importDefault(i);class d extends i.default.PureComponent{constructor(e){super(e),this.onActionDropdownOpen=()=>{this.setState({isActionDropdownOpen:!0})},this.onActionDropdownClose=()=>{this.setState({isActionDropdownOpen:!1})},this.state={isActionDropdownOpen:!1}}render(){const{recentItem:e,attachments:t,arialabelledby:s}=this.props;if(!(e&&e.idType===o.HOME_RESOURCE_ID_TYPE.ENCODED_FILE_OBJ_ID&&t.length&&e.viewingUserId&&e.displayName))return null;const d=(0,l.getFileFromPartial)({file_id:e.resourceId,ext:"."+(0,r.file_extension)(e.displayName),ns_id:t[0].nsId||void 0,ns_path:t[0].nsPath||void 0,fq_path:t[0].fqPath||void 0});return i.default.createElement(a.UnconnectedExtensionsMenu,{className:"recents-item__action recents-item__action--hover-only recents-item__action--standard-breakpoint-only",user:(0,c.getUser)(),file:d,arialabelledby:s,onDropdownOpen:this.onActionDropdownOpen,onDropdownClose:this.onActionDropdownClose,telemetryContext:{surface:"home_recent"},triggerType:n.TriggerType.OpacityButton})}}t.RecentActivityFileActionPost=d,d.displayName="RecentActivityFileActionPost"})),define("metaserver/static/js/home/recents/recent_activity_logger_post_tti",["require","exports","tslib","lodash","metaserver/static/js/core/assert","metaserver/static/js/home/recents/recent_activity_client_post_tti","metaserver/static/js/pap/analytics_client","metaserver/static/js/dropbox/proto/pap_events/top_level_nav/shown_recents_screen"],(function(e,t,s,i,r,a,n,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.logTimeToFirstAction=t.logCellAction=t.logRequestFailed=t.logPageLoaded=t.disableLogging=t.enableLogging=t.FilterViews=void 0,i=s.__importStar(i);const c=o.pap_events.top_level_nav.Shown_RecentsScreen;t.FilterViews={EVERYTHING:"everything"};const l=["is_full_page","item_count","contains_aggregation","latency","is_paginated","is_empty"],d=["failure_type","is_paginated"],m=["in_aggregation","filter_view","action_type","target_activity_type","action_scope","position","file_extension","days_ago"],u=["latency","action_type","action_scope"];let h=!0;function p(e,t,s={}){if(!h)return;const i=Object.assign(Object.assign({},s),{event_name:t});(0,a.postLogEvent)(e,i)}function _(e,t,s){const a=Object.keys(s),n=i.difference(a,t);(0,r.assert)(0===n.length,`${e} called with unsupported keys: ${n}`)}t.enableLogging=function(){h=!0},t.disableLogging=function(){h=!1},t.logPageLoaded=function(e,t){_("logPageLoaded",l,t),p(e,"client_page_loaded",t);const s=Object.assign(Object.assign({},t),{active_user_id:e,event_name:"client_page_loaded",isEmpty:0===t.item_count});(0,n.logEvent)(c.create(s))},t.logRequestFailed=function(e,t){_("logRequestFailed",d,t),p(e,"request_failed",t)},t.logCellAction=function(e,t){_("logCellAction",m,t),p(e,"cell_action",t)},t.logTimeToFirstAction=function(e,t){_("logTimeToFirstAction",u,t),p(e,"time_to_first_action",t)}})),define("metaserver/static/js/home/recents/recent_activity_logger_utils_post_tti",["require","exports","tslib","react-dom","lodash","metaserver/static/js/home/recents/utils/events","metaserver/static/js/home/recents/recent_activity_logger_post_tti","metaserver/static/js/home/recents/recent_activity_constants","metaserver/static/js/home/recents/stores/attachment_store","metaserver/static/js/clean/web_timing_logger","metaserver/static/js/clean/navigation","metaserver/static/js/home/recents/recent_activity_logger_utils","metaserver/static/js/edison/ui/router_utils","metaserver/static/js/clean/history_singleton","metaserver/static/js/core/uri"],(function(e,t,s,i,r,a,n,o,c,l,d,m,u,h,p){"use strict";function _(e){return Math.floor((Date.now()-e)/864e5)}function g(e,t,s,a,c){const l=i.findDOMNode(c);if(null===l)return;const d=r.filter(r.uniq(r.map(s,e=>null!=e?e.split(".").pop().toLowerCase():void 0)),Boolean),m=a>1;let u;u=1===a?o.ActionScope.SINGLE:s.length===a?o.ActionScope.AGGREGATION:o.ActionScope.SUBSET;const h=Array.prototype.indexOf.call(l.parentNode.childNodes,l),p=Number(l.getAttribute("data-item-type")),g=Number(l.getAttribute("data-item-date")),v={in_aggregation:m,filter_view:n.FilterViews.EVERYTHING,action_type:e,action_scope:u,target_activity_type:p,position:h,file_extension:d.join(","),days_ago:_(g)};(0,n.logCellAction)(t,v),f(t,r.pick(v,"action_scope","action_type"))}function f(e,t){if(!(0,m.canLogFirstAction)())return;const s=l.start_time();s&&((0,m.onLogFirstAction)(),(0,n.logTimeToFirstAction)(e,Object.assign(Object.assign({},t),{latency:Date.now()-s})))}function v(e){return(t,s,i,a)=>{(function(e,t,s,i,a){if(!("totalCount"in a))return g(e,t,s,i,a);if("cellView"in a)return g(e,t,s,i,a.cellView);const c=a,{subgroupPosition:l,targetActivityType:d,dataItemDate:m}=c,u=r.filter(r.uniq(r.map(s,e=>null!=e?e.split(".").pop().toLowerCase():void 0)),Boolean),h=i>1;let p;p=1===i?o.ActionScope.SINGLE:s.length===i?o.ActionScope.AGGREGATION:o.ActionScope.SUBSET;const v={in_aggregation:h,filter_view:n.FilterViews.EVERYTHING,action_type:e,action_scope:p,target_activity_type:d,position:l,file_extension:u.join(","),days_ago:_(m)};(0,n.logCellAction)(t,v),f(t,r.pick(v,"action_scope","action_type"))})(e,t,s,i,a)}}function E(e){return(t,s,i,r)=>v(e)(t,[s],i,r)}function S(e,t,s={}){const i=Object.assign(Object.assign({is_full_page:t.isFullPage},s),{latency:Date.now()-t.startTime});(0,n.logPageLoaded)(e,i)}function T(e,t,s){const i=(0,c.getAttachmentStore)().getByIds(t);return"cellView"in s?(0,a.logEvent)(e,s.cellView,i,s.totalCount,void 0,s.loggedComponentName):(0,a.logCleanerEvent)(e,s.itemNumber,s.subgroupPosition,i,s.totalCount,void 0,s.loggedComponentName)}Object.defineProperty(t,"__esModule",{value:!0}),t.openUrl=t.openUnsafeTab=t.openTab=t.logRecentActivityAction=t.logRecentsLoaded=t.startRequestTimer=t.logRequestFailed=t.logViewInFolder=t.logOpenVersions=t.logDownloadFile=t.logCommentFile=t.logOpenSharedLinkUrl=t.logOpenPathUrl=t.logUnityOpenFile=t.logDeleteFiles=t.logPreviewFiles=t.logShareFile=void 0,i=s.__importStar(i),r=s.__importStar(r),l=s.__importStar(l),t.logShareFile=E(o.ActionType.SHARE),t.logPreviewFiles=v(o.ActionType.VIEW_FILE),t.logDeleteFiles=v(o.ActionType.DELETE),t.logUnityOpenFile=E(o.ActionType.UNITY_OPEN),t.logOpenPathUrl=v(o.ActionType.OPEN_DIR),t.logOpenSharedLinkUrl=v(o.ActionType.VIEW_SHARED_LINK),t.logCommentFile=E(o.ActionType.COMMENT),t.logDownloadFile=v(o.ActionType.DOWNLOAD),t.logOpenVersions=E(o.ActionType.VERSIONS),t.logViewInFolder=v(o.ActionType.VIEW_IN_FOLDER),t.logRequestFailed=function(e,t){(0,n.logRequestFailed)(e,{failure_type:t?t.status:-1,is_paginated:!1})},t.startRequestTimer=function(){const e=(0,m.getRecentsLoggingData)();return(t,s={})=>S(t,e,s)},t.logRecentsLoaded=S,t.logRecentActivityAction=T,t.openTab=function(e,t,s,i){(0,d.logAndNavigate)(e,()=>T(t,s,i),d.NavigationMethod.NEW_TAB)},t.openUnsafeTab=function(e,t,s,i){(0,d.logAndNavigate)(e,()=>T(t,s,i),d.NavigationMethod.UNSAFE_NEW_TAB)},t.openUrl=function(e,t,s,i){if((0,u.shouldUseReactRouter)()){const r=p.URI.parse(e).getPath();T(t,s,i),(0,h.getBrowserHistory)().push(r)}else(0,d.logAndNavigate)(e,()=>T(t,s,i),d.NavigationMethod.REDIRECT)}})),define("metaserver/static/js/home/recents/recent_activity_starred_post_tti",["require","exports","metaserver/static/js/starred/constants","metaserver/static/js/starred/actions","metaserver/static/js/home/recents/recent_activity_federated_model","metaserver/static/js/home/store","metaserver/static/js/home/recents/recent_activity_starred","metaserver/static/js/flux/dispatcher"],(function(e,t,s,i,r,a,n,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.fetchStarredStatus=t.setStarredStatusOfPaperRecentItems=void 0,t.setStarredStatusOfPaperRecentItems=function(e){e.length&&o.Dispatcher.dispatch({type:s.StarredActionTypes.SET_STATUS,starredStatuses:e.map(e=>new r.FederatedRecentItem(e).getStarredStatus())})},t.fetchStarredStatus=function(e){const t=(0,n.getIdTypePairsByRecentActivityItems)(e);t.length&&i.StarredActions.fetchStatuses((0,a.getRole)(),t,!0)}})),define("metaserver/static/js/home/recents/store_utils_post_tti",["require","exports","tslib","lodash","metaserver/static/js/core/i18n","metaserver/static/js/home/recents/stores/attachment_store","metaserver/static/js/core/notify","metaserver/static/js/home/recents/recent_activity_dispatcher","metaserver/static/js/home/recents/recent_activity_client_post_tti","metaserver/static/js/home/recents/recent_activity_constants","metaserver/static/js/home/store","metaserver/static/js/core/exception","metaserver/static/js/home/post_tti/unity_post_tti","metaserver/static/js/home/recents/store_utils","metaserver/static/js/home/recents/recent_activity_logger_utils_post_tti"],(function(e,t,s,i,r,a,n,o,c,l,d,m,u,h,p){"use strict";function _(e,t,i=l.MAX_ENSURE_ATTACHMENT_LOAD_ATTACHMENTS_ATTEMPTS){return s.__awaiter(this,void 0,void 0,(function*(){return(yield f(e,t,i)).attachments}))}Object.defineProperty(t,"__esModule",{value:!0}),t.loadRecentItems=t.loadPaperRecentItems=t.ensureAttachmentsWithRetryStatus=t.ensureAttachments=void 0,i=s.__importStar(i),t.ensureAttachments=_;const g=[l.EnsureAttachmentsPurpose.LOAD_REMAINING_ATTACHMENTS,l.EnsureAttachmentsPurpose.RECENTS_JSON_CONTINUATION];function f(e,t,h=l.MAX_ENSURE_ATTACHMENT_LOAD_ATTACHMENTS_ATTEMPTS,p=!1){return s.__awaiter(this,void 0,void 0,(function*(){const _=(0,a.getAttachmentStore)().getByIds(e),v=_.filter(e=>!e.isLoaded).map(e=>e.id);if(v.length){if((0,a.getAttachmentStore)().areSomeActivityKeysPending(v))return yield new Promise((s,i)=>{const r=(0,a.getAttachmentStore)().addListener(()=>{(0,a.getAttachmentStore)().areSomeActivityKeysPending(v)||(r(),f(e,t,h,!0).then(s,i))})});if(h>0){try{yield(function(e){return s.__awaiter(this,void 0,void 0,(function*(){o.recentActivityDispatcher.dispatch({type:l.ADD_PENDING_ACTIVITY_KEYS,activityKeys:e});const t=(0,a.getAttachmentStore)().groupIdsByEncryptedToken(e),r=(0,d.getUserId)();let n={},m=0;yield Promise.all(i.map(t,(e,t)=>s.__awaiter(this,void 0,void 0,(function*(){try{n=Object.assign(Object.assign({},n),yield(0,c.activityGenerateJson)(r,e,t))}catch(t){o.recentActivityDispatcher.dispatch({type:l.REMOVE_PENDING_ACTIVITY_KEYS,activityKeys:e}),m++}})))),o.recentActivityDispatcher.dispatch({type:l.RECEIVE_RAW_RELATED_ACTIVITIES_BY_KEY,rawRelatedActivitiesByKey:n,userId:r});const h=i.filter(n,e=>!(!e.ns_id||!e.ns_path)).map(({ns_id:e,ns_path:t})=>({ns_id:e,ns_path:t,bytes:0,isDeleted:!1}));if(h.length&&((0,u.getUnityFeatures)().then(e=>{e&&e.check_file_batch(h,r,null).then(e=>{o.recentActivityDispatcher.dispatch({type:l.RECEIVE_CAN_OPEN_INFO,canOpenInfo:e})})}),(0,c.checkFileInRootCollection)(r,h).then(e=>o.recentActivityDispatcher.dispatch({type:l.RECEIVE_FILE_IN_ROOT_COLLECTION_INFO,fileInRootCollectionInfo:e}))),m)throw new Error(`${m} activityGenerateJson failures`)}))})(v)}catch(e){}return yield f(e,t,h-1,!0)}throw(0,m.reportStack)("retry attempts depleted",{severity:m.SEVERITY.NONCRITICAL,exc_extra:{attachmentIds:e,purpose:t}}),g.indexOf(t)<0&&n.Notify.error(r.intl.formatMessage({id:"bLA3rA",defaultMessage:"There was a problem completing this request."})),new Error("retry attempts depleted")}return{attachments:_,isRetry:p}}))}function v(){return s.__awaiter(this,void 0,void 0,(function*(){return{logRecentsLoaded:p.logRecentsLoaded,ensureAttachments:_,logRequestFailed:p.logRequestFailed,loadPaperRecentItems:E}}))}function E(e){return s.__awaiter(this,void 0,void 0,(function*(){const t=(0,c.retrievePaperRecents)((0,d.getUserId)(),e);(0,h.handleRetrievePaperRecentsPromise)(v,yield t,e)}))}t.ensureAttachmentsWithRetryStatus=f,t.loadPaperRecentItems=E,t.loadRecentItems=function(e){return(0,h.logErrorAndRethrowAsync)(v,()=>s.__awaiter(this,void 0,void 0,(function*(){return(0,h.handleAndLogRecentsJsonPromise)(v,yield(0,c.recentsJson)((0,d.getUserId)(),e),!e)})))}})),define("metaserver/static/js/home/resource/actions_post_tti",["require","exports","tslib","metaserver/static/js/flux/dispatcher","metaserver/static/js/home/constants","metaserver/static/js/home/store","metaserver/static/js/home/resource/store","metaserver/static/js/clean/referrer_cleansing_redirect","metaserver/static/js/file_viewer/constants","metaserver/static/js/modules/constants/python","metaserver/static/js/file_viewer/controller","metaserver/static/js/core/browser","metaserver/static/js/filepath/filepath","metaserver/static/js/home/api","metaserver/static/js/home/post_tti/props_post_tti","metaserver/static/js/core/uri","metaserver/static/js/cloud_docs/preferred_editor_utils","metaserver/static/js/cloud_docs/constants","metaserver/static/js/cloud_docs/utils","metaserver/static/js/cloud_docs/types","metaserver/static/js/core/browser","metaserver/static/js/cloud_docs/event_logging","spectrum/util/uuid_generator","metaserver/static/js/plusplus/logging","metaserver/static/js/pnm/utils","metaserver/static/js/plusplus/file_actions","metaserver/static/js/home/post_tti/props_post_tti"],(function(e,t,s,i,r,a,n,o,c,l,d,m,u,h,p,_,g,f,v,E,S,T,y,b,I,w,j){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.openInFileViewer=t.createAutoShareLink=void 0,o=s.__importStar(o),S=s.__importStar(S),t.createAutoShareLink=function(e,t){const s=new _.URI({path:"/sm/create"+(0,u.normalize)(t)});s.updateQuery("_subject_uid",e.id.toString()),s.updateQuery("redirect","0"),(0,h.makeRequest)({url:s.toString(),type:"POST",data:null,dataType:"text"}).then(e=>(0,m.redirect)(e))},t.openInFileViewer=function({resourceId:e,logViewFunction:t,isCommentAction:s,href:m,middleClick:u}){const h=(0,n.getHomeResourceStore)().addListener((function(){const e=(0,n.getHomeResourceStore)().getFileToPreview();if(e){const n=(function(e){var t,s;if("cloud_doc"===(null===(s=null===(t=e.preview)||void 0===t?void 0:t.content)||void 0===s?void 0:s[".tag"])){return e.preview.content.exit_url}})(e),A=(0,a.getHomeStore)().getUser();if(n)if(t(),h(),f.POINTER_EXTS.includes((0,v.getFileExt)(e).slice(1)))o.safe_open_tab_and_redirect(n),(0,T.logUserAction)({actionEvent:E.UserActionEventType.PRE_OPEN,userId:A.id,docPathOrId:e.file_id,actionSource:E.UserActionSourceType.WEB_HOME});else{const t=(0,y.generateUUID)("web_open_id"),s=_.URI.parse(n).updateQuery("web_open_id",t).toString();S.open_tab(s),(0,T.logUserAction)({actionEvent:E.UserActionEventType.PRE_OPEN,userId:A.id,docPathOrId:e.file_id,actionSource:E.UserActionSourceType.WEB_HOME,data:{webOpenId:t}})}else{const a=()=>{m&&u?S.open_tab(m):(function(e,t,s,a){window.requestAnimationFrame(()=>{if((0,d.isShown)())(0,d.updateFiles)([e]);else{const s="/recents"===location.pathname?c.FileViewOriginType.RECENTS:"/starred"===location.pathname?c.FileViewOriginType.STARRED:c.FileViewOriginType.HOME;(0,d.open)([e],0,t,"react-file-viewer",{canClose:!0,oref:l.OREF_CONSTANTS.HOME,fileViewTarget:c.FileViewTargetType.PRIVATE,fileViewOrigin:s,onClose:()=>i.Dispatcher.dispatch({type:r.HomeActionTypes.CLOSE_FILE_VIEWER})}),i.Dispatcher.dispatch({type:r.HomeActionTypes.OPEN_FILE_VIEWER})}s(),a()})})(e,A,t,h)};e.hasOwnProperty("per_node_metadata")&&(0,I.isSupportedLinkNodeClickAction)(e.per_node_metadata)?(0,w.handleLinkNodeAction)(e.per_node_metadata,e=>{(0,b.logProductAnalytics)(A.id,"web","select",e,"home")}):!s&&(0,g.hasPreferredEditorSupport)(e)?window.RUNNING_IN_EDISON?(0,j.getPostTTIPropsInEdison)().then(t=>{const{preferredEditors:s}=t;(0,g.openInPreferredEditor)(A,e,s,a,{fileViewOrigin:c.FileViewOriginType.HOME}),h()}):(0,p.getPostTTIProps)().then(t=>{const{preferredEditors:s}=t;(0,g.openInPreferredEditor)(A,e,s,a,{fileViewOrigin:c.FileViewOriginType.HOME}),h()}):a()}}}));i.Dispatcher.dispatch({type:r.HomeResourceStoreActionTypes.REQUEST_PREVIEW,resourceId:e})}})),define("metaserver/static/js/home/resource/api_post_tti",["require","exports","metaserver/static/js/home/api"],(function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getFileMetadata=void 0,t.getFileMetadata=function(e,t){return(0,s.makeRequest)({url:"/home_feed/get_file_metadata",type:"POST",subject_user:e.id,data:{resources_json:JSON.stringify(t)}},{isBackground:!0})}})),define("metaserver/static/js/home/roots/file_uploader",["require","exports","tslib","react","metaserver/static/js/file_uploader/upload_controller","metaserver/static/js/file_uploader/upload_kit_provider"],(function(e,t,s,i,r,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FileUploader=void 0,i=s.__importDefault(i);t.FileUploader=e=>i.default.createElement(a.UploadKitProvider,{chooseDestination:!0,user:e.user},i.default.createElement(r.UploadController,Object.assign({},e)))})),define("metaserver/static/js/home/roots/home_access_web_post_tti",["require","exports","tslib","metaserver/static/js/clean/history","metaserver/static/js/upsell/prompt_event_emitter"],(function(e,t,s,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.homeAccessWebComponentDidMount=void 0,i=s.__importDefault(i),t.homeAccessWebComponentDidMount=function(t){return s.__awaiter(this,void 0,void 0,(function*(){i.default.remove_query_param("role"),r.promptBufferedEventEmitter.on(r.Events.ON_PROMPT_INITIALIZED,i=>s.__awaiter(this,void 0,void 0,(function*(){if((!i||!i.didMainCampaignLoad()&&!i.didCampaignForUserEducationLoad())&&t){const{postTTINCCTReminderModal:t}=yield new Promise((t,s)=>{e(["metaserver/static/js/ncct/ui/post_tti_ncct_modal"],t,s)}).then(s.__importStar);t()}})))}))}})),define("metaserver/static/js/home/starred/actions_post_tti",["require","exports","tslib","metaserver/static/js/flux/dispatcher","metaserver/static/js/home/resource/api_post_tti","metaserver/static/js/starred/id_type_pair","metaserver/static/js/home/constants","metaserver/static/js/home/store","metaserver/static/js/home/starred/constants","metaserver/static/js/home/starred/api_post_tti","metaserver/static/js/home/starred/actions"],(function(e,t,s,i,r,a,n,o,c,l,d){"use strict";function m(e){return s.__awaiter(this,void 0,void 0,(function*(){const t=e.map(e=>e.idTypePair);if(0===t.length)return;const s=yield(0,r.getFileMetadata)((0,o.getUser)(),t),c={};s.forEach(e=>c[(0,a.idTypePairToString)(e)]=e.file_metadata),i.Dispatcher.dispatch({type:n.HomeResourceStoreActionTypes.RECEIVED_RESOURCE_ID_TO_FILE,resourceIdToFile:c})}))}Object.defineProperty(t,"__esModule",{value:!0}),t.getStarredStatusMetadata=t.loadAllStarredItems=void 0,t.loadAllStarredItems=function(){return s.__awaiter(this,void 0,void 0,(function*(){let e;i.Dispatcher.dispatch({type:c.StarredResourceActionTypes.LOADING_ALL});try{e=yield(0,l.retrieveStarred)(c.LOAD_ALL_ITEMS_COUNT)}catch(e){throw(0,d.onRetrieveStarredError)(c.StarredLoadingTypes.ALL,e)}d.StarredActions.handleRetrieveStarredPayload(()=>Promise.resolve({getStarredStatusMetadata:m}),c.StarredLoadingTypes.ALL,e)}))},t.getStarredStatusMetadata=m})),define("metaserver/static/js/home/starred/starred_item_file_action_post_tti",["require","exports","tslib","react","metaserver/static/js/app_actions/app_actions_menu","metaserver/static/js/extensions/data/types","metaserver/static/js/home/recents/models/utils","metaserver/static/js/home/resource_id_types","metaserver/static/js/home/util/file_utils"],(function(e,t,s,i,r,a,n,o,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.StarredItemFileActionPost=void 0,i=s.__importDefault(i);class l extends i.default.PureComponent{constructor(e){super(e),this.onActionDropdownOpen=()=>{this.setState({isActionDropdownOpen:!0})},this.onActionDropdownClose=()=>{this.setState({isActionDropdownOpen:!1})},this.state={isActionDropdownOpen:!1}}render(){const{starredItem:e,user:t}=this.props;if(e.idType!==o.HOME_RESOURCE_ID_TYPE.ENCODED_FILE_OBJ_ID||!t.id||!e.title)return null;const s=(0,c.getFileFromPartial)({file_id:e.resourceId,fq_path:e.details.fqPath||void 0,ext:(0,n.getExtension)(e.title)});return i.default.createElement(r.UnconnectedExtensionsMenu,{className:"starred-item__file-actions",file:s,user:this.props.user,onDropdownOpen:this.onActionDropdownOpen,onDropdownClose:this.onActionDropdownClose,telemetryContext:{surface:"home_starred"},triggerType:a.TriggerType.OpacityButton})}}t.StarredItemFileActionPost=l,l.displayName="StarredItemFileActionPost"})),define("metaserver/static/js/home/util/file_utils",["require","exports","metaserver/static/js/browse/models"],(function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getFileFromPartial=void 0;const i={bytes:1024,direct_blockserver_link:"",event_type:0,ext:"",file_id:"",fq_path:"",has_automated_rule:!1,href:"",icon:"",is_cloud_doc:!1,is_dir:!1,is_in_team_folder_tree:!1,is_in_vault_folder:!1,is_symlink:!1,is_locked:!1,is_unmounted:!1,is_versionable:!0,_mount_access_perms:[],ns_id:0,ns_path:"",revision_id:"",sjid:0,sort_key:[""],target_ns:null,type:1};t.getFileFromPartial=function(e){return e&&Object.keys(e).forEach(t=>{void 0===e[t]&&delete e[t]}),new s.File(e?Object.assign(Object.assign({},i),e):i)}})),define("metaserver/static/js/home/util/logging/availability_logger_post_tti",["require","exports","tslib","lodash","metaserver/static/js/home/constants","metaserver/static/js/home/api","metaserver/static/js/home/store","metaserver/static/js/home/util/logging/availability_logger_common"],(function(e,t,s,i,r,a,n,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.logHomeAvailability=void 0,i=s.__importStar(i),t.logHomeAvailability=function({sectionToTTI:e,sectionToIsSkipped:t,sectionToTTData:s,typeToExecutionData:c}){const l={};Object.keys(r.HomeSections).forEach(i=>{const a=r.HomeSections[i];l[a]={tti:e[a],tt_data:s[a],skipped:t[a]}});const d=(0,n.getHomeStore)(),m=d.getUser();(0,a.makeRequest)({url:"/log/home_availability",type:"POST",dataType:"text",subject_user:m.id,data:{success:i.values(c).every(e=>e.success||!(0,o.isPendingPrefetch)(d,e)),metrics_json:JSON.stringify({referrer:document.referrer}),sections_json:JSON.stringify(l),prefetches_json:JSON.stringify(i.mapValues(c,(e,t)=>{const{success:s,homeTiming:i}=e,r=o.HOME_PREFETCH_TYPE_TO_INFO[t].section;return Object.assign(Object.assign({},i),{conditional_loading_preference:d.getSectionLoadingPreference(r),conditional_loading_mode:d.getSectionLoadingMode(r),success:!!s})}))}},{isBackground:!0,delayRequest:!0,shouldAssertResponse:!0})}})),define("metaserver/static/js/sharing/wizard/share_a_folder_wizard_modal",["require","exports","tslib","react","metaserver/static/js/components/ui/css","metaserver/static/js/clean/viewer","metaserver/static/js/core/i18n","dig-components/modal","dig-components/buttons","dig-components/controls","spectrum/label/index"],(function(e,t,s,i,r,a,n,o,c,l,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ShareAFolderWizardModal=void 0,i=s.__importDefault(i);class m extends i.default.Component{constructor(){super(...arguments),this.state={option:"new-folder",open:!0},this.getTitle=e=>{switch(e){case"work":return n.intl.formatMessage({id:"OVz2f8",defaultMessage:"Share a folder from your {team_name} Dropbox"},{team_name:a.Viewer.get_viewer().team_name});case"personal":return n.intl.formatMessage({id:"4X0XOP",defaultMessage:"Share a folder from your personal Dropbox"})}},this.title=this.getTitle(this.props.user.role),this.onSubmit=()=>this.props.onSubmit(this.state.option),this.onModalReady=()=>{this.focusOnRadioButton()},this.closeModal=()=>{this.setState({open:!1})},this.renderSpectrumContent=()=>i.default.createElement("form",{className:"shared-folder-wizard__contents"},this._renderHeader(),this.renderSpectrumRadio()),this._renderHeader=()=>i.default.createElement("div",{className:"shared-folder-wizard__header u-mar-bottom-s"},n.intl.formatMessage({id:"uf8ArB",defaultMessage:"What would you like to do?"})),this.renderSpectrumRadio=()=>i.default.createElement("div",{className:"shared-folder-wizard__radio-group"},this.renderRadioOptionWithLabel("new-folder",n.intl.formatMessage({id:"xve3fd",defaultMessage:"Id like to create and share a new folder"})),this.renderRadioOptionWithLabel("existing-folder",n.intl.formatMessage({id:"sFfjOe",defaultMessage:"Id like to share an existing folder"}))),this.renderRadioOptionWithLabel=(e,t)=>i.default.createElement("div",{className:"shared-folder-wizard__audience-input u-mar-bottom-xs"},i.default.createElement(d.Label,{htmlFor:e,key:`${e}-label`},i.default.createElement(l.RadioButton,{"aria-checked":this.state.option===e,checked:this.state.option===e,onChange:this.updateOption(e),value:e,id:e}),i.default.createElement("div",{className:`${e}_title u-l-ib u-pad-left-xs`},t))),this.updateOption=e=>()=>this._handleChange(e),this._handleChange=e=>this.setState({option:e})}render(){return i.default.createElement(o.Modal,{open:this.state.open,withCloseButton:"Close",overlayClassName:"shared-folder-wizard__overlay",onRequestClose:this.closeModal,"aria-label":this.title,className:"shared-folder-wizard",title:this.getTitle(this.props.user.role),onAfterOpen:this.onModalReady},i.default.createElement(o.Modal.Header,{hasBottomSpacing:"title-standard"},i.default.createElement(o.Modal.Title,null,this.title)),i.default.createElement(o.Modal.Body,null,this.renderSpectrumContent()),i.default.createElement(o.Modal.Footer,null,i.default.createElement(c.Button,{variant:"primary",onClick:this.onSubmit},n.intl.formatMessage({id:"TbfCYq",defaultMessage:"Next"}))))}focusOnRadioButton(){const e=document.querySelector("input#new-folder");e&&e.focus()}}m.displayName="ShareAFolderWizardModalNoCss",t.ShareAFolderWizardModal=(0,r.requireCssWithComponent)(m,["/static/metaserver/static/css/sharing/wizard_modals-vflY6WFPP.css","/static/metaserver/static/css/modal-vflf1hwfZ.css"])})),define("metaserver/static/js/sharing/wizard/share_existing_folder_wizard_modal",["require","exports","tslib","react","metaserver/static/js/components/ui/css","metaserver/static/js/clean/viewer","metaserver/static/js/core/i18n","dig-components/modal","dig-components/buttons","metaserver/static/js/folder_dialog/folder_picker_dig","metaserver/static/js/folder_dialog/api","metaserver/static/js/clean/web_timing_logger"],(function(e,t,s,i,r,a,n,o,c,l,d,m){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ShareExistingFolderWizardModal=void 0,i=s.__importDefault(i),m=s.__importStar(m);const u=e=>i.default.createElement("div",{className:"u-l-fr"},i.default.createElement(c.Button,{variant:"primary","data-testid":"next_button",disabled:e.disabled,onClick:e.onSubmit},n.intl.formatMessage({id:"n11jli",defaultMessage:"Next"})));u.displayName="PrimaryButton";class h extends i.default.Component{constructor(){super(...arguments),this.state={open:!0},this.getTitle=e=>{switch(e){case"work":return n.intl.formatMessage({id:"/+wDxa",defaultMessage:"Choose a folder from your {team_name} Dropbox"},{team_name:a.Viewer.get_viewer().team_name});case"personal":return n.intl.formatMessage({id:"Xvzici",defaultMessage:"Choose a folder from your personal Dropbox"})}},this.onModalCloseClick=()=>{this.setState({open:!1})},this.renderSpectrumContent=()=>i.default.createElement("form",{className:"existing-shared-folder-wizard__contents folder-picker-dig-container"},this._renderError(),this._renderFolderPicker()),this._renderError=()=>{if(null!=this.state.folderPath&&(null!=this.state.errorMsg?this.state.errorMsg.length:void 0)>0)return i.default.createElement("div",{className:"text-input-error-wrapper"},i.default.createElement("div",{className:"text-input-error-text u-font-danger"},this.state.errorMsg))},this._setFolderPickerPath=e=>this.setState({folderPath:e,errorMsg:void 0}),this._renderFolderPicker=()=>i.default.createElement(l.FolderPicker,{user:this.props.user,webTimer:m.get_timer(),onFolderSelected:this._setFolderPickerPath,rootName:a.Viewer.get_role_title(this.props.user)||n.intl.formatMessage({id:"mSjmSo",defaultMessage:"Dropbox"}),canSelectReadonly:!1,apiClient:{getFolderContents:d.getFolderContentsAPIv2},initialPath:this.props.folderPath}),this.onSubmit=e=>("function"==typeof e.nativeEvent.preventDefault&&e.nativeEvent.preventDefault(),this.props.onSubmit(this.state.folderPath,this._setError)),this.onBack=()=>(this.setState({open:!1}),this.props.onBack&&this.props.onBack()),this._setError=e=>{var t;return this.setState({errorMsg:null===(t=null==e?void 0:e.path)||void 0===t?void 0:t.message_text})},this._isValid=()=>!!this.state.folderPath&&(!this.state.errorMsg&&"/"!==this.state.folderPath)}render(){return i.default.createElement(o.Modal,{onRequestClose:this.onModalCloseClick,overlayClassName:"existing-shared-folder-wizard__overlay","aria-label":n.intl.formatMessage({id:"itH+AR",defaultMessage:"Shared Existing Folder Modal"}),className:"existing-shared-folder-wizard folder-picker-modal",open:this.state.open,withCloseButton:"Close",title:this.getTitle(this.props.user.role)},i.default.createElement(o.Modal.Header,{hasBottomSpacing:"title-standard"},i.default.createElement(o.Modal.Title,null,this.getTitle(this.props.user.role))),i.default.createElement(o.Modal.Body,{className:"folder-picker-container__fixed-height",hasVerticalSpacing:!1},this.renderSpectrumContent()),i.default.createElement(o.Modal.Footer,null,i.default.createElement(c.Button,{variant:"opacity",onClick:this.onBack},n.intl.formatMessage({id:"mYtVp8",defaultMessage:"Back"})),i.default.createElement(u,{disabled:!this._isValid(),onSubmit:this.onSubmit})))}}h.displayName="ShareExistingFolderWizardModalNoCss",t.ShareExistingFolderWizardModal=(0,r.requireCssWithComponent)(h,["/static/metaserver/static/css/sharing/wizard_modals-vflY6WFPP.css"])})),define("metaserver/static/js/sharing/wizard/wizard_modals",["require","exports","tslib","react","metaserver/static/js/css/css","metaserver/static/js/account/email","metaserver/static/js/account/email_verify_reasons","metaserver/static/js/browse/constants","metaserver/static/js/clean/analytics","metaserver/static/js/deprecated_ajax/ajax_form_extract_errors","metaserver/static/js/components/ui/modal","metaserver/static/js/file_actions/create-folder","metaserver/static/js/sharing/api","typescript/component_libraries/spectrum-sharing/src/utils/sharing_constants","metaserver/static/js/sharing/share_modal_util","metaserver/static/js/sharing/ui_notifications_util","metaserver/static/js/sharing/wizard/share_a_folder_wizard_modal","metaserver/static/js/sharing/wizard/share_existing_folder_wizard_modal","metaserver/static/js/sharing/async_share_modal_util","metaserver/static/js/sharing/create_shared_folder_modal/async_create_shared_folder_util","metaserver/static/js/clean/web_user_action_events","metaserver/static/js/clean/web_user_action_logger","metaserver/static/js/flows/utils/exposure_logger","metaserver/static/js/browse/data/store","metaserver/static/js/browse/data/selectors","metaserver/static/js/sharing/actions/create_shared_folder_modal_actions"],(function(e,t,s,i,r,a,n,o,c,l,d,m,u,h,p,_,g,f,v,E,S,T,y,b,I,w){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.showShareAFolderWizardModal=t.shareExistingFolder=void 0,i=s.__importDefault(i),r=s.__importStar(r),m=s.__importStar(m);const j=function(e,t,s,i){return new u.SharingApi(e).validate_shareable_existing_sf_path(t,(function(){return(0,v.asyncShowShareModal)(e,{fqPath:t,isFolder:!0,exists:!0,modalSessionId:null!=i?i:void 0},{origin:h.SHARE_ACTION_ORIGIN_TYPE.WIZARD})}),(function(e){const t=(0,l.extractErrors)(e.responseText);return!1===t?void 0:"string"==typeof t?(0,_.sharingNotificationError)(t):"function"==typeof s?s(t):void 0})),Promise.resolve(!0)};t.shareExistingFolder=j;function A(e,t=!1,s,l,u){if(!a.EmailVerification.get_for_user(e).verified_or_show(n.EmailVerificationReasons.SHARE_FOLDER))return;r.require_css("/static/metaserver/static/css/scooter/scooter-scoped-vflhkBqI_.css");const h=(0,p.generateModalSessionId)();if(c.SharingExperimentsLogger.log(e.id,"SIMPLIFIED_WIZARD_UI::BEGIN_SHARE_A_FOLDER_WIZARD",{modalSessionId:h}),e.is_cdm_member){const t=(0,b.getStoreForBrowse)(),{expFlowsCoreFolderSetupFlow:s}=(0,I.browsePostTTIExperiments)(t.getState());s&&(0,y.logExposure)({feature:"flows_adoption_core_folder_setup_flow",variant:s}),(0,v.asyncShowNewFolderShareModal)({defaultBasePath:e.cdm_tmf_path,modalSessionId:h,user:e})}else(function(e,t,s=!1,r,a,n){d.Modal.showInstance(i.default.createElement(g.ShareAFolderWizardModal,{user:e,onSubmit:l=>{null!=t&&c.SharingExperimentsLogger.log(e.id,"SIMPLIFIED_WIZARD_UI::SUBMIT_SHARE_A_FOLDER_WIZARD",{target:l,modalSessionId:t});const u=l.slice(0,l.indexOf("-"));if(T.WebUserActionLog.log(e.id,S.WebUserActionLogEvent.SELECT_FOLDER_TYPE,{folder_type:u}),"new-folder"===l){if(s&&r){const t=({folderName:t})=>{(0,w.handleCreateSharedFolder)({user:e,pathName:r.currentFQPath,folderName:t,redirectOnSuccess:a,showShareModalOnSuccess:n})};return m.logCreateFolder({uid:e.id,origin:o.CREATE_FOLDER_ACTION_ORIGIN_TYPE.CREATE_SHARED_FOLDER_MODAL}),(0,E.asyncShowCreateSharedFolderModal)({handleCreateFolder:t,user:e,context:r})}const i=(0,b.getStoreForBrowse)(),{expFlowsCoreFolderSetupFlow:c}=(0,I.browsePostTTIExperiments)(i.getState());return c&&(0,y.logExposure)({feature:"flows_adoption_core_folder_setup_flow",variant:c}),(0,v.asyncShowNewFolderShareModal)({defaultBasePath:e.cdm_tmf_path,modalSessionId:t,user:e})}return"existing-folder"===l?(function(e,t,s,r){return null!=s&&c.SharingExperimentsLogger.log(e.id,"SIMPLIFIED_WIZARD_UI::BEGIN_SHARE_EXISTING_FOLDER_WIZARD",{modalSessionId:s}),d.Modal.showInstance(i.default.createElement(f.ShareExistingFolderWizardModal,{user:e,onBack:t,onSubmit:function(t,i){return null!=s&&c.SharingExperimentsLogger.log(e.id,"SIMPLIFIED_WIZARD_UI::SUBMIT_SHARE_EXISTING_FOLDER_WIZARD",{modalSessionId:s}),j(e,t,(function(...t){return null!=s&&c.SharingExperimentsLogger.log(e.id,"SIMPLIFIED_WIZARD_UI::SUBMIT_SHARE_EXISTING_FOLDER_WIZARD_ERROR",{modalSessionId:s}),i(...Array.from(t||[]))}))},folderPath:r}))})(e,()=>A(e,s,r,a,n),t,null==r?void 0:r.currentFQPath):void 0}}))})(e,h,t,s,l,u);return h}t.showShareAFolderWizardModal=A})),define("metaserver/static/js/home/recommended_members/recommended_member_card",["require","exports","tslib","react","metaserver/static/js/core/user_i18n","dig-components/avatar","dig-components/buttons","dig-components/icons","dig-components/icons/src","metaserver/static/js/components/ui/css","metaserver/static/js/core/i18n"],(function(e,t,s,i,r,a,n,o,c,l,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RecommendedMemberCard=t.RecommendedMemberAvatar=void 0,i=s.__importDefault(i),r=s.__importStar(r);t.RecommendedMemberAvatar=({photoUrl:e,name:t})=>{const s=r.getInitials(t);return i.default.createElement(a.Avatar,{size:"large",src:e||"",backgroundColor:(0,a.avatarColorForUserIdentifier)(s)},s)};class m extends i.default.PureComponent{constructor(e){super(e)}componentDidMount(){this.props.onRecommendationCardShown()}render(){const{buttonText:e,onButtonClick:s,recommendationReasons:r,email:a,name:l,onDismissClick:m,photoUrl:u}=this.props,h="recommended-member-card";return i.default.createElement("article",{className:h},i.default.createElement("div",{className:`${h}__top-bar-wrapper`},i.default.createElement("div",{className:`${h}__top-bar`},i.default.createElement("div",{className:`${h}__avatar`},i.default.createElement(t.RecommendedMemberAvatar,{name:l,photoUrl:u})),i.default.createElement("div",{className:`${h}__user-context`},i.default.createElement("span",{className:`${h}__title`},l),i.default.createElement("span",{className:`${h}__email`},a)),i.default.createElement(n.IconButton,{variant:"transparent",className:`${h}__dismiss`,onClick:m},i.default.createElement(o.UIIcon,{src:c.CloseLine,"aria-label":d.intl.formatMessage({id:"KaeLBh",defaultMessage:"Dismiss suggestion"})})))),i.default.createElement("div",{className:`${h}__content`},i.default.createElement("ul",{className:`${h}__suggestion-context`},r.map((e,t)=>i.default.createElement("li",{key:t,className:`${h}__text`},e))),i.default.createElement("div",{className:`${h}__invite`},i.default.createElement(n.Button,{"aria-label":e,onClick:s,variant:"outline"},e))))}}m.displayName="RecommendedMemberCard",m.defaultProps={isLoading:!1},t.RecommendedMemberCard=(0,l.requireCssWithComponent)(m,["/static/metaserver/static/css/dig-components/index.web-vflR-4-Ka.css"])})),define("metaserver/static/js/home/recommended_members/recommended_member_components",["require","exports","tslib","react","metaserver/static/js/core/i18n","metaserver/static/js/clean/static_urls","metaserver/static/js/clean/ui/image","metaserver/static/js/components/ui/section/section_header"],(function(e,t,s,i,r,a,n,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RecommendedMembersEmpty=t.RecommendedMembersHeader=void 0,i=s.__importDefault(i);t.RecommendedMembersHeader=({isHidden:e,buttonAction:t})=>i.default.createElement(o.SectionHeader,{title:r.intl.formatMessage({id:"e9fyCS",defaultMessage:"Suggested members"}),ueName:"recommended",isHidden:e,onToggleHidden:t}),t.RecommendedMembersHeader.displayName="RecommendedMembersHeader";t.RecommendedMembersEmpty=()=>i.default.createElement("article",{className:"recommended-members-empty"},i.default.createElement(n.Image,{className:"recommended-members-empty__img",src:(0,a.static_url)("/static/metaserver/static/images/home/experiments/illustration_1x-vflq5p19x.png"),srcHiRes:(0,a.static_url)("/static/metaserver/static/images/home/experiments/illustration_2x-vflGzU5Lp.png"),alt:r.intl.formatMessage({id:"yd60sv",defaultMessage:"happy face"})}),i.default.createElement("p",{className:"recommended-members-empty__text"},r.intl.formatMessage({id:"yzPd3d",defaultMessage:"Thats it for now. Thanks!"}))),t.RecommendedMembersEmpty.displayName="RecommendedMembersEmpty"})),define("metaserver/static/js/home/recommended_members/recommended_members_post_tti",["require","exports","tslib","react","metaserver/static/js/core/i18n","metaserver/static/js/clean/viewer","metaserver/static/js/home/recommended_members/recommended_member_components","metaserver/static/js/home/recommended_members/recommended_member_card","metaserver/static/js/api_v2/user_client","metaserver/static/js/clean/analytics","metaserver/static/js/home/recommended_members/utils","metaserver/static/js/home/actions_post_tti","metaserver/static/js/loggers/join_flow_logger"],(function(e,t,s,i,r,a,n,o,c,l,d,m,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RecommendedMembers=t.initPrefetchRecommendedMembers=t.MIN_CARD_WIDTH=void 0,i=s.__importDefault(i),t.MIN_CARD_WIDTH=350;t.initPrefetchRecommendedMembers=()=>{};class h extends i.default.Component{constructor(e){super(e),this.logOrigin=u.Source.HOME_RECOMMENDED_MEMBERS,this.onInviteSuccess=e=>{this.hideCard(e)},this.onDismissMemberClick=e=>{const t=this.state.recommendedMembers[e];this.hideCard(e);const s=this.getSubjectUser();if(s){(new c.UserApiV2Client).ns("team_experience").rpc("teammate_suggestions/dismiss",{teammate_id:t.user_id},{subjectUserId:s.id})}l.TeamsWebActionsLogger.log("admin_dismiss_recommended_contact",{user_id:t.user_id,team_id:t.team_id,team_type:t.team_type,prediction_id:t.prediction_id,origin:this.logOrigin})},this.toggleModuleVisibility=()=>{const{isHiddenByUser:e}=this.props;(0,m.setSectionVisibilityPostTTI)(this.getSubjectUser().id,{".tag":"recommended_members"},e)},this.hideCard=e=>{const{recommendedMembers:t}=this.state,s=t.slice(0,e).concat(t.slice(e+1));this.setState({recommendedMembers:s})},this.renderCards=e=>{const{cardsToRender:t}=this.state,s=e.slice(0,t).map((e,t)=>i.default.createElement(o.RecommendedMemberCard,{key:e.user_id,recommendationReasons:(0,d.getRecommendationContext)(e,this.viewer),buttonText:r.intl.formatMessage({id:"bgAvOC",defaultMessage:"Invite to team"}),email:e.email,name:e.display_name,photoUrl:e.photo_url,onDismissClick:()=>{this.onDismissMemberClick(t)},onButtonClick:()=>{this.onInviteClick(t)},onRecommendationCardShown:()=>{l.TeamsWebActionsLogger.log("admin_display_recommended_contact",{user_id:e.user_id,team_id:e.team_id,team_type:e.team_type,prediction_id:e.prediction_id,origin:this.logOrigin})}}));return i.default.createElement("div",{className:"recommended-members__list"},s)},this.checkCardsToRender=()=>{const{containerWidth:e}=this.props;return e<t.MIN_CARD_WIDTH?0:e<2*t.MIN_CARD_WIDTH?1:2},this.validateBrowserSize=()=>{const{cardsToRender:e}=this.state,t=this.checkCardsToRender();e!==t&&this.setState({cardsToRender:t})},this.viewer=a.Viewer.get_viewer(),this.getSubjectUser()&&(this.actionHandler=new d.RecommendedMembersApiActionsHandler(this.viewer.work_user.id)),this.state={recommendedMembers:[],receivedRecommendations:void 0,suggestId:void 0,cardsToRender:this.checkCardsToRender()}}componentDidMount(){this.actionHandler&&(this.actionHandler.teammateSuggestionsList().then(e=>{const t=e.recommended_members.members,s=t.slice(0,2),i=e.suggest_id;this.setState({recommendedMembers:s,receivedRecommendations:t,suggestId:i}),l.TeamsWebActionsLogger.log("admin_recommendations_shown",{user_id:this.viewer.get_uid_by_role("work"),team_id:this.viewer.team_id,num_recommendation:s.length,number_cards:this.state.cardsToRender,suggest_id:i})}),this.validateBrowserSize(),window.addEventListener("resize",this.validateBrowserSize))}componentWillUnmount(){window.removeEventListener("resize",this.validateBrowserSize)}getSubjectUser(){return this.viewer.work_user}onInviteClick(t){const{recommendedMembers:i}=this.state,r=i[t];new Promise((t,s)=>{e(["metaserver/static/js/teams/invite/modals/invite_confirmation_modal"],t,s)}).then(s.__importStar).then(({showInviteConfirmationModal:e})=>{e({emailsToInvite:[r.email],origin:this.logOrigin,onInviteSuccess:()=>this.onInviteSuccess(t)})}),l.TeamsWebActionsLogger.log("admin_invite_recommended_contact",{user_id:r.user_id,team_id:r.team_id,team_type:r.team_type,prediction_id:r.prediction_id,origin:this.logOrigin})}render(){const{recommendedMembers:e,cardsToRender:t,receivedRecommendations:s}=this.state,{isHiddenByUser:r}=this.props;return 0!==t&&s&&0!==s.length?i.default.createElement("div",{className:"recommended-members"},i.default.createElement(n.RecommendedMembersHeader,{isHidden:r,buttonAction:this.toggleModuleVisibility}),r?null:e.length>0?this.renderCards(e):i.default.createElement(n.RecommendedMembersEmpty,null)):null}}t.RecommendedMembers=h,h.displayName="RecommendedMembers"})),define("metaserver/static/js/home/recommended_members/utils",["require","exports","metaserver/static/js/core/i18n","metaserver/static/js/api_v2/user_client"],(function(e,t,s,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getRecommendationContext=t.RecommendedMembersApiActionsHandler=void 0;t.RecommendedMembersApiActionsHandler=class{constructor(e){this.teammateSuggestionsList=()=>this.apiClient.rpc("teammate_suggestions/list",void 0,{subjectUserId:this.userId}).then(e=>e),this.apiClient=(new i.UserApiV2Client).ns("team_experience"),this.userId=e}},t.getRecommendationContext=function(e,t){const i=[];return e.same_domain&&i.push(s.intl.formatMessage({id:"ZlxnJ/",defaultMessage:"On your same email domain"})),e.known_collaborator_id===t.get_uid_by_role("work")?i.push(s.intl.formatMessage({id:"RNA89X",defaultMessage:"Works with you a lot"})):0!==e.known_collaborator_id&&e.known_collaborator_display_name&&i.push(s.intl.formatMessage({id:"+f7iaX",defaultMessage:"Works with {collaborator} a lot"},{collaborator:e.known_collaborator_display_name})),e.num_team_shared_members>0&&i.push(s.intl.formatMessage({id:"0SGkpt",defaultMessage:"{count, plural, one{Collaborates with 1 person on your team} other{Collaborates with {count} people on your team}}"},{count:e.num_team_shared_members})),e.num_team_shared_folders>0&&i.push(s.intl.formatMessage({id:"SC1JCB",defaultMessage:"{count, plural, one{In 1 shared folder with you} other{In {count} shared folders with you}}"},{count:e.num_team_shared_folders})),i.slice(0,3)}})),define("metaserver/static/js/home/surface_teams_homepage/home_teams",["require","exports","tslib","react","classnames","metaserver/static/js/home/actions_post_tti","metaserver/static/js/home/store","metaserver/static/js/home/surface_teams_homepage/home_teams_frame","metaserver/static/js/teams/ui/team_discovery/view/home_team_card","metaserver/static/js/home/util/show_hide_link","metaserver/static/js/home/surface_teams_homepage/home_teams_util","metaserver/static/js/home/surface_teams_homepage/home_teams_logger"],(function(e,t,s,i,r,a,n,o,c,l,d,m){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.HomeTeams=t.initPrefetchHomeTeams=void 0,i=s.__importDefault(i),r=s.__importDefault(r);t.initPrefetchHomeTeams=()=>{};class u extends i.default.Component{constructor(e){super(e),this.onRequestSubmit=e=>{this.setState({requestSubmitting:!0,userSelectedDbxTeamID:e})},this.onAcceptTeamInvite=e=>{this.setState({joiningTeam:!0});const{teamInvitation:t}=this.state;t?this.actionHandler.onAcceptTeamInvite(t):m.HomeTeamsLogger.getJoinStatus(e)===m.TeamJoinStatus.AUTO_JOIN&&(this.actionHandler.onJoinAutoJoinableTeam(e,this.updateJoinableTeams),this.logger.logClickedJoinForAutoJoinableTeam(e.id,this.state.joinableTeams))},this.onTeamDismiss=e=>{this.setState({dismissingTeam:!0});const{teamInvitation:t,joinableTeams:s}=this.state;this.actionHandler.onUserDismissedTeam(e,s,t).then(t=>{t&&(this.logger.logDismissTeam(e.id),this.setState(Object.assign(Object.assign({},t),{dismissingTeam:!1})))})},this.onCancelPendingRequest=e=>{this.setState({cancellingRequest:!0}),this.actionHandler.onCancelPendingRequest(e,()=>{this.logger.logCancelRequestToJoin("manual",e),this.updateJoinableTeams()})},this.joinTeamHandler=e=>{this.actionHandler.requestToJoin(e,this.logger.getExtraForRequestAccess(e)).then(t=>{t&&this.logger.logClickedReqToJoin(t,e),this.updateJoinableTeams()})},this.updateJoinableTeams=()=>this.actionHandler.getJoinableTeamsList().then(e=>{const t={requestSubmitting:!1,cancellingRequest:!1,joiningTeam:!1,dismissingTeam:!1};if(e){const s=e.joinableTeams.find(e=>"waiting_for_approval"===e.joinTeamRequestState[".tag"]),i=Object.assign(Object.assign(Object.assign({},e),t),{userSelectedDbxTeamID:null==s?void 0:s.dbxTeamId});this.setState(i)}else this.setState(t)}),this.onChangeHomeTeamsVisibility=()=>{const e=!this.props.isHiddenByUser;(0,a.setSectionVisibilityPostTTI)(this.userId,{".tag":"teams"},!e)},this.onToggleShowHide=()=>{const e=!this.state.showAll;this.setState({showAll:e}),this.logger.logExpanderClicker()};const t=(0,n.getUser)();this.userId=t.id,this.userDomain=-1!==t.email.indexOf("@")?t.email.split("@")[1]:void 0,this.role=(0,n.getRole)(),this.logger=new m.HomeTeamsLogger(this.userId,this.role),this.actionHandler=new d.HomeTeamsApiActionsHandler(this.userId),this.numberOfTeamsToDisplay=u.getNumberOfTeamsToDisplay(this.props.numberOfTeams),this.state={joinableTeams:[],requestSubmitting:!1,cancellingRequest:!1,joiningTeam:!1,dismissingTeam:!1,showAll:!1,hasLoadedTeams:!1,userSelectedDbxTeamID:void 0,teamInvitation:void 0,windowWidth:window.innerWidth}}componentDidMount(){this.updateJoinableTeams().then(()=>{this.props.showTeamsLoadingState&&!this.props.isHiddenByUser&&this.logger.logExposedToSETOnHomepage(this.state.joinableTeams,this.state.teamInvitation)}),window.addEventListener("resize",e=>{this.setState({windowWidth:window.innerWidth})})}getHomeTeamCard(e){const{teamInvitation:t}=this.state;return void 0===e?null:i.default.createElement("div",{key:e.id},i.default.createElement(c.HomeTeamCard,{key:e.id,userSelectedDbxTeamID:this.state.userSelectedDbxTeamID,onRequestSubmit:()=>this.onRequestSubmit(e.dbxTeamId),requestSubmitting:this.state.requestSubmitting,cancellingRequest:this.state.cancellingRequest,joiningTeam:this.state.joiningTeam,dismissingTeam:this.state.dismissingTeam,userHasMadeSelection:"waiting_for_approval"===e.joinTeamRequestState[".tag"],team:e,joinTeamHandler:()=>this.joinTeamHandler(e),teamInvitation:void 0!==t&&t.team_id===e.id?t:void 0,onAcceptTeamInvite:()=>this.onAcceptTeamInvite(e),onTeamDismiss:()=>this.onTeamDismiss(e),onCancelPendingRequest:()=>this.onCancelPendingRequest(e),isMobile:this.state.windowWidth<u.DEFAULT_MOBILE_WIDTH,userDomain:this.userDomain}))}renderHomeTeamsContainer(e){if(e)return null;if(!this.state.hasLoadedTeams)return i.default.createElement(o.HomeTeamsSpinner,null);if(0===this.state.joinableTeams.length)return i.default.createElement(o.HomeTeamsEmptyState,null);const{teamInvitation:t,joinableTeams:s,userSelectedDbxTeamID:r,requestSubmitting:a}=this.state;if(void 0!==t){const e=s.find(e=>e.id===t.team_id);return this.getHomeTeamCard(e)}if(void 0!==r&&!a){const e=s.find(e=>e.dbxTeamId===r);return this.getHomeTeamCard(e)}let n=0;const c=this.state.joinableTeams.map(e=>((n<this.numberOfTeamsToDisplay||this.state.showAll)&&this.props.showTeamsLoadingState&&!this.props.isHiddenByUser&&this.logger.logTeamExposedToSETOnHomepage(e),n++,this.getHomeTeamCard(e)));return this.state.showAll||this.state.joinableTeams.length<=this.numberOfTeamsToDisplay?i.default.createElement("ul",{className:"home-teams-list"},c):i.default.createElement("ul",{className:"home-teams-list"},c.slice(0,this.numberOfTeamsToDisplay))}render(){var e;if(!this.props.canRenderItems||!this.props.showTeamsLoadingState||!this.props.showTeamsOnHomepageExperiment)return null;const t=(null===(e=this.state.joinableTeams)||void 0===e?void 0:e.length)-this.numberOfTeamsToDisplay,{isHiddenByUser:s}=this.props,{hasLoadedTeams:a,joinableTeams:n,showAll:c,userSelectedDbxTeamID:d,teamInvitation:m,requestSubmitting:u}=this.state,h=(!a||n.length>0)&&(!c||n.length<=this.numberOfTeamsToDisplay)&&(void 0===d||u)&&void 0===m&&!s,p=t>0&&!s&&!c&&(void 0===d||u)&&void 0===m,_=(0,r.default)({"home-teams-frame":h,"home-teams-loading-view":!a,"home-teams-no-list-style":!0});return i.default.createElement(o.HomeTeamsFrame,null,i.default.createElement(o.HomeTeamsHeader,{isHiddenByUser:s,buttonAction:this.onChangeHomeTeamsVisibility,ariaControls:"HomeTeamsSectionID"}),i.default.createElement("div",{className:_,id:"HomeTeamsSectionID"},i.default.createElement("div",{key:"teams"},this.renderHomeTeamsContainer(s)),i.default.createElement("div",{key:"showMore"},p?i.default.createElement(l.ShowHideLink,{hiddenItemCount:t,canLoadMore:!1,onClick:this.onToggleShowHide,isExpanded:c}):null)))}}t.HomeTeams=u,u.displayName="HomeSurfaceExistingTeams",u.DEFAULT_NUM_TEAMS_TO_SHOW=2,u.DEFAULT_MOBILE_WIDTH=480,u.getNumberOfTeamsToDisplay=e=>1===e?1:u.DEFAULT_NUM_TEAMS_TO_SHOW})),define("metaserver/static/js/home/surface_teams_homepage/home_teams_frame",["require","exports","tslib","react","dig-components/progress_indicators","dig-components/typography","metaserver/static/js/components/ui/section/header_tooltip","metaserver/static/js/components/ui/section/section_header","metaserver/static/js/core/i18n"],(function(e,t,s,i,r,a,n,o,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.HomeTeamsSpinner=t.HomeTeamsEmptyState=t.HomeTeamsFrame=t.HomeTeamsHeader=void 0,i=s.__importDefault(i);t.HomeTeamsHeader=({isHiddenByUser:e,buttonAction:t,ariaControls:s})=>{const r=c.intl.formatMessage({id:"Cjp7Qo",defaultMessage:"People we think you work with have joined one of these teams."}),a=c.intl.formatMessage({id:"b49shP",defaultMessage:"More info"});return i.default.createElement(o.SectionHeader,{title:c.intl.formatMessage({id:"qB+2aM",defaultMessage:"Join a team"}),ueName:"teams",isHidden:e,onToggleHidden:t,ariaControls:s,infoIcon:i.default.createElement(n.HeaderTooltip,{title:r,size:"standard",label:a})})},t.HomeTeamsHeader.displayName="HomeTeamsHeader";t.HomeTeamsFrame=({children:e})=>i.default.createElement("section",{className:"home-access-section"},e),t.HomeTeamsFrame.displayName="HomeTeamsFrame";t.HomeTeamsEmptyState=()=>i.default.createElement(a.Text,{color:"faint",className:"home-access-section__empty",tagName:"p"},c.intl.formatMessage({id:"MeG6h+",defaultMessage:"That's it for now. We'll suggest teams if we think they might be a good match."})),t.HomeTeamsEmptyState.displayName="HomeTeamsEmptyState";t.HomeTeamsSpinner=()=>i.default.createElement(r.Spinner,{size:"small","aria-valuetext":c.intl.formatMessage({id:"ZV8oAs",defaultMessage:"Loading teams you can join"})}),t.HomeTeamsSpinner.displayName="HomeTeamsSpinner"})),define("metaserver/static/js/home/surface_teams_homepage/home_teams_actions",["require","exports","tslib","react","classnames","metaserver/static/js/core/i18n","dig-components/buttons","dig-components/typography","dig-components/hooks"],(function(e,t,s,i,r,a,n,o,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.HomeTeamsCardJoinButtons=void 0,i=s.__importDefault(i),r=s.__importDefault(r);t.HomeTeamsCardJoinButtons=e=>{const{onJoinButtonPress:t,onAcceptTeamInvite:s,onCancelPendingRequest:r}=e.actionHandlers,{cancellingRequest:n,joiningTeam:o,requestSubmitting:c}=e.actionStatus,l=e.actionStatus.isActionInProgress,{askToJoinText:u,cancellingText:h,cancelText:p,declinedText:_,getJoinText:g,joiningText:f,requestingText:v}={askToJoinText:a.intl.formatMessage({id:"7w7C+H",defaultMessage:"Ask to join"}),cancellingText:a.intl.formatMessage({id:"Zzad7F",defaultMessage:"Cancelling..."}),cancelText:a.intl.formatMessage({id:"NCBimA",defaultMessage:"Cancel request"}),declinedText:a.intl.formatMessage({id:"9UmkJy",defaultMessage:"Your request to join was declined"}),getJoinText:e=>e?a.intl.formatMessage({id:"xj5uap",defaultMessage:"Join team"}):a.intl.formatMessage({id:"jggo6V",defaultMessage:"Join team now"}),joiningText:a.intl.formatMessage({id:"lEOstJ",defaultMessage:"Joining..."}),requestingText:a.intl.formatMessage({id:"UFHFaL",defaultMessage:"Requesting..."})};if(c&&e.team.dbxTeamId===e.userSelectedDbxTeamID)return i.default.createElement(d,{disabled:l,onClick:t,teamName:e.team.name,ariaControls:v,teamnameId:e.teamnameId,dataTestId:"team-request-button"},v);if(e.teamHasInvitedUser||"can_auto_join"===e.team.joinTeamRequestState[".tag"]){const t=o?f:g(e.isMobile);return i.default.createElement(d,{disabled:l,onClick:s,teamName:e.team.name,ariaControls:t,teamnameId:e.teamnameId,dataTestId:"team-join-button"},t)}switch(e.team.joinTeamRequestState[".tag"]){case"request_rejected_open":case"request_rejected_dismissed":return i.default.createElement(m,null,_);case"waiting_for_approval":const s=n?h:p;return i.default.createElement(d,{variant:"transparent",disabled:l,onClick:r,teamName:e.team.name,ariaControls:s,teamnameId:e.teamnameId,dataTestId:"cancel-request-button"},s);default:return i.default.createElement(d,{disabled:l,onClick:t,teamName:e.team.name,ariaControls:u,teamnameId:e.teamnameId,dataTestId:"ask-join-button"},u)}},t.HomeTeamsCardJoinButtons.displayName="HomeTeamsCardJoinButtons";const l=e=>i.default.createElement("div",{id:"TeamActionsContainer",className:"home-teams-item__actions"},i.default.createElement("div",{className:"home-teams-item__actions-inner"},e.children));l.displayName="HomeTeamsActionItem";const d=e=>{var t;const s=(0,c.useUniqueId)({prefix:"homeTeamActionsButton-"});return i.default.createElement(l,null,i.default.createElement(n.Button,{variant:null!==(t=e.variant)&&void 0!==t?t:"outline",onClick:e.onClick,disabled:e.disabled,"aria-labelledby":(0,r.default)(s,e.teamnameId),"aria-controls":e.ariaControls,"data-testid":e.dataTestId,id:s},e.children))};d.displayName="HomeTeamsActionButton";const m=e=>i.default.createElement(l,null,i.default.createElement(o.Text,{tagName:"div",color:"faint"},e.children));m.displayName="HomeTeamsActionInfoText"})),define("metaserver/static/js/teams/ui/team_discovery/view/home_team_card",["require","exports","tslib","react","classnames","metaserver/static/js/core/i18n","spectrum/button/index","spectrum/facepile/index","dig-components/badges","dig-components/icons","dig-components/icons/src","dig-components/typography","dig-components/hooks","metaserver/static/js/teams/ui/team_discovery/data/utils","metaserver/static/js/home/surface_teams_homepage/home_teams_util","metaserver/static/js/home/surface_teams_homepage/home_teams_actions","metaserver/static/js/common/uuid"],(function(e,t,s,i,r,a,n,o,c,l,d,m,u,h,p,_,g){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.HomeTeamCard=void 0,i=s.__importDefault(i),r=s.__importDefault(r);class f extends i.default.PureComponent{constructor(e){super(e),this.handleJoinButtonPress=()=>{this.props.onRequestSubmit(),this.props.joinTeamHandler()},this.userRequestedToJoinTeam=()=>this.props.userSelectedDbxTeamID===this.props.team.dbxTeamId&&!this.props.requestSubmitting,this.shouldHideDismiss=()=>{const{team:e,teamInvitation:t}=this.props;return"waiting_for_approval"===e.joinTeamRequestState[".tag"]||void 0!==t},this.shouldDisableDismiss=()=>{const{requestSubmitting:e,dismissingTeam:t,cancellingRequest:s,joiningTeam:i}=this.props;return e||t||s||i},this.isRequestDeclined=()=>"request_rejected_open"===this.props.team.joinTeamRequestState[".tag"],this.userCanRequestToJoin=()=>{const{team:e,teamInvitation:t}=this.props,s=e.joinTeamRequestState[".tag"];return!this.userRequestedToJoinTeam()&&void 0===t&&["can_auto_join","approval_required"].includes(s)},this.getTeamActionHandlers=()=>({onJoinButtonPress:this.handleJoinButtonPress,onTeamDismiss:this.props.onTeamDismiss,onCancelPendingRequest:this.props.onCancelPendingRequest,onAcceptTeamInvite:this.props.onAcceptTeamInvite}),this.getTeamActionStatus=()=>new p.TeamActionStatus({requestSubmitting:this.props.requestSubmitting,cancellingRequest:this.props.cancellingRequest,dismissingTeam:this.props.dismissingTeam,joiningTeam:this.props.joiningTeam}),this.getClassNames=()=>{const e=this.userCanRequestToJoin();return{sectionClassNames:(0,r.default)({"home-teams-item":!0,"home-teams-item__content":!0,"home-teams-item__approved-stripe":void 0!==this.props.teamInvitation}),teamContentClassNames:(0,r.default)({"home-teams-item__team-content":!(this.props.isMobile&&e),"home-teams-item__team-content-mobile":this.props.isMobile&&e}),teamDescriptionContainerClassNames:(0,r.default)({"home-teams-item__team-description-container":e}),teamActionsContainerClassNames:(0,r.default)({"home-teams-item__team-actions-container":!0,"home-teams-item__team-actions-mobile":this.props.isMobile&&e})}}}render(){const e=this.props.isMobile&&this.isRequestDeclined(),{sectionClassNames:t,teamContentClassNames:s,teamDescriptionContainerClassNames:r,teamActionsContainerClassNames:a}=this.getClassNames(),n=(0,g.generateUUID)("team-name-id-");let o;return o=this.userCanRequestToJoin()?i.default.createElement(E,{team:this.props.team,teamnameId:n,showFacepile:this.props.isMobile,showDismissButton:this.props.isMobile,disableDismissButton:this.shouldDisableDismiss(),onDismissClick:this.props.onTeamDismiss,userDomain:this.props.userDomain}):i.default.createElement(b,{team:this.props.team,teamnameId:n,teamInvitation:this.props.teamInvitation,showUserAskedToJoinDescription:this.userRequestedToJoinTeam(),showRequestDeclinedDescription:e,showUserInvitedToTeamDescription:void 0!==this.props.teamInvitation}),i.default.createElement("div",{className:t},i.default.createElement(v,{key:"team-icon"}),i.default.createElement("div",{key:"team-content",className:s},i.default.createElement("div",{key:"team-description",className:r},o),i.default.createElement("div",{key:"team-actions",className:a},i.default.createElement(y,{team:this.props.team,teamnameId:n,userSelectedDbxTeamID:this.props.userSelectedDbxTeamID,teamHasInvitedUser:void 0!==this.props.teamInvitation,isMobile:this.props.isMobile,showFacepile:this.userCanRequestToJoin()&&!this.props.isMobile,showActionButton:!e,hideDismissButton:this.shouldHideDismiss()||this.props.isMobile&&this.userCanRequestToJoin(),disableDismissButton:this.shouldDisableDismiss(),teamActionHandlers:this.getTeamActionHandlers(),teamActionStatus:this.getTeamActionStatus()}))))}}t.HomeTeamCard=f,f.displayName="HomeTeamCard";const v=()=>i.default.createElement("div",null,i.default.createElement("div",{className:"home-teams-item__icon"},i.default.createElement(l.UIIcon,{src:d.TeamLine,size:"standard"})));v.displayName="TeamIcon";const E=e=>i.default.createElement("div",{className:"home-teams-item__team-description"},i.default.createElement(S,{team:e.team,teamnameId:e.teamnameId,showDismissButton:e.showDismissButton,disableDismissButton:e.disableDismissButton,onDismissClick:e.onDismissClick,userDomain:e.userDomain}),e.showFacepile&&i.default.createElement(I,{team:e.team}),i.default.createElement(T,{team:e.team}));E.displayName="TeamSuggestionDescription";const S=e=>{const{getTeamSharesUserDomainText:t}=A();let s=null;e.team.isSameDomain&&e.userDomain&&(s=i.default.createElement("span",{className:"home-teams-item__team-domain-badge"},i.default.createElement(c.AccessoryBadge,null,t(e.userDomain))));let r=null;return e.showDismissButton&&(r=i.default.createElement("span",{className:"home-teams-item__auto-left"},i.default.createElement(w,{onDismissClick:e.onDismissClick,teamnameId:e.teamnameId,hideButton:!1,disableButton:e.disableDismissButton}))),i.default.createElement("div",null,i.default.createElement("span",{className:"home-teams-item__team-name"},i.default.createElement(m.Text,{tagName:"h3",id:e.teamnameId,isBold:!0},e.team.name),r),s)};S.displayName="TeamSuggestionHeader";const T=e=>{const{getLastShareTimeText:t}=A(),s=[],r=(0,h.getSharedContentCountsText)(e.team);return r&&s.push(r),e.team.lastShareTimestamp&&s.push(t(e.team.lastShareTimestamp)),0===s.length?null:i.default.createElement("ul",{className:"home-teams-item__team-context-list"},s.map((e,t)=>i.default.createElement(m.Text,{key:t,tagName:"li"},e)))};T.displayName="TeamSuggestionPoints";const y=e=>{const t=!(e.isMobile&&e.hideDismissButton);return i.default.createElement("div",{className:"home-teams-item__avatar-and-actions"},e.showFacepile&&i.default.createElement(I,{team:e.team}),e.showActionButton&&i.default.createElement(_.HomeTeamsCardJoinButtons,{team:e.team,teamnameId:e.teamnameId,userSelectedDbxTeamID:e.userSelectedDbxTeamID,teamHasInvitedUser:e.teamHasInvitedUser,isMobile:e.isMobile,actionStatus:e.teamActionStatus,actionHandlers:e.teamActionHandlers}),t&&i.default.createElement(w,{onDismissClick:e.teamActionHandlers.onTeamDismiss,teamnameId:e.teamnameId,hideButton:e.hideDismissButton,disableButton:e.disableDismissButton}))};y.displayName="TeamActions";const b=e=>{const{getInvitedByText:t,getAskedToJoinText:s,getAdminNamesText:a,requestDeclinedText:n}=A();let o;o=e.showUserInvitedToTeamDescription&&e.teamInvitation?t(e.teamInvitation.inviting_user_name):e.showUserAskedToJoinDescription?s(e.team):e.showRequestDeclinedDescription?n:a(e.team,!1);const c=(0,u.useUniqueId)({prefix:"team-description-"});return i.default.createElement("div",{className:"home-teams-item__team-description"},i.default.createElement(m.Text,{tagName:"h3",id:e.teamnameId},e.team.name),i.default.createElement(m.Text,{"aria-labelledby":(0,r.default)(e.teamnameId,c),id:c,color:"faint"},o))};b.displayName="TeamShortDescription";const I=e=>{const{getAdminNamesText:t}=A(),s=e.team.members;let r=e.team.membersCount-s.length,a=s.length;r>=1&&(r++,a--);const n=i.default.createElement(o.FacepileMembers,{remainderCount:r>0?r.toString():void 0,remainderTooltipProps:{backgroundColor:"#344063",tooltipContent:i.default.createElement("div",null,`${r} others`)},isRemainderActive:!1,members:s.slice(0,a).map(h.toFacepileMember),avatarSize:24});return i.default.createElement("div",{className:"home-teams-item__facepile-container"},i.default.createElement("span",{className:"home-teams-item__facepile","data-testid":"member-facepile"},n),i.default.createElement("span",{className:"home-teams-item__team-admin"},i.default.createElement(m.Text,{color:"faint"},t(e.team,!0))))};I.displayName="TeamMemberFacepile";const w=e=>{const{dismissButtonLabelText:t}=A(),s=(0,u.useUniqueId)({prefix:"dismissButton-"}),a=(0,r.default)({"home-teams-item__dismiss-button":!0,"home-teams-item__dismiss-invisible":e.hideButton}),o=(0,r.default)({"home-teams-item__actions":!0,"home-teams-item__actions-no-padding":e.hideButton});return i.default.createElement("div",{className:o},i.default.createElement("div",{className:"home-teams-item__actions-inner"},i.default.createElement("div",{className:"home-teams-item__dismiss-container"},i.default.createElement(n.Button,{variant:"styleless",className:a,id:s,onClick:e.onDismissClick,disabled:e.hideButton||e.disableButton,"aria-label":t,"aria-labelledby":(0,r.default)(e.teamnameId,s),"data-testid":"team-suggestion-dismiss-button"},i.default.createElement(l.UIIcon,{className:"home-teams__button-background",src:d.CloseLine,size:"standard"})))))};function j(e){const t=new Date(e);return a.intl.formatDate(t,{month:"long",day:"numeric",year:"numeric"})}function A(){return{dismissButtonLabelText:a.intl.formatMessage({id:"1XbVf0",defaultMessage:"Dismiss this team suggestion"}),getAdminNamesText:(e,t)=>(0,h.getAdminNamesStrForTeam)(e,t),getAskedToJoinText:e=>e.joinRequestStateDate?a.intl.formatMessage({id:"+4exZC",defaultMessage:"Asked to join on {date}"},{date:j(e.joinRequestStateDate)}):a.intl.formatMessage({id:"ABuPQv",defaultMessage:"Asked to join"}),getInvitedByText:e=>a.intl.formatMessage({id:"As2n1+",defaultMessage:"Invited by {name}"},{name:e}),getLastShareTimeText:e=>(0,h.getLastShareTimeStr)(e),getTeamSharesUserDomainText:e=>a.intl.formatMessage({id:"AUEkPL",defaultMessage:"Email match: <span>{emailDomain}</span>"},{span:e=>i.default.createElement("strong",{key:"user-domain"},e),emailDomain:`@${e}`}),requestDeclinedText:a.intl.formatMessage({id:"9UmkJy",defaultMessage:"Your request to join was declined"})}}w.displayName="DismissButton"})),define("metaserver/static/js/home/surface_teams_homepage/home_teams_util",["require","exports","tslib","metaserver/static/js/api_v2/user_client","metaserver/static/js/teams/ui/team_discovery/data/model","metaserver/static/js/core/notify","metaserver/static/js/core/i18n","metaserver/static/js/core/uri","metaserver/static/js/teams/ui/team_discovery/data/logger","metaserver/static/js/home/surface_teams_homepage/home_teams_logger","metaserver/static/js/clean/history_singleton"],(function(e,t,s,i,r,a,n,o,c,l,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.HomeTeamsApiActionsHandler=t.TeamActionStatus=void 0;t.TeamActionStatus=class{constructor({cancellingRequest:e=!1,dismissingTeam:t=!1,joiningTeam:s=!1,requestSubmitting:i=!1}={}){this.cancellingRequest=e,this.dismissingTeam=t,this.joiningTeam=s,this.requestSubmitting=i}get isActionInProgress(){return this.cancellingRequest||this.dismissingTeam||this.joiningTeam||this.requestSubmitting}};class m{constructor(e){this.requestToJoin=(e,t)=>this.apiClient.rpc("joinable_teams/join",{team_id:e.id,dbx_team_id:e.dbxTeamId,extra:t,source:l.HomeTeamsSource},{subjectUserId:this.userId}).then(e=>("request_sent"===e.result[".tag"]||"can_join"===e.result[".tag"]?a.Notify.success((0,r.JoinApiRetReasonToLabel)("request_sent")):a.Notify.error(m.DEFAULT_ERROR_CONTACT_ADMIN),e.result[".tag"])).catch(e=>{a.Notify.error(m.DEFAULT_ERROR_CONTACT_ADMIN)}),this.getJoinableTeamsList=()=>s.__awaiter(this,void 0,void 0,(function*(){return this.apiClient.rpc("joinable_teams/list",{include_user_dismissed_teams:!1,include_user_collab_teams:!0},{subjectUserId:this.userId}).then(e=>({joinableTeams:e.values.map(r.toJoinableTeam),teamInvitation:e.team_invite,hasLoadedTeams:!0})).catch(e=>{a.Notify.error(m.DEFAULT_ERROR_REFRESH_PAGE)})})),this.apiClient=(new i.UserApiV2Client).ns("team_discovery"),this.userId=e}onAcceptTeamInvite(e){const t=new o.URI({path:"/"}).toString(),s={signup_key:e.signup_key,cont:t};(0,d.browserRedirectWrapper)(new o.URI({path:"/team/join",query:s}))}onJoinAutoJoinableTeam(e,t){this.apiClient.rpc("joinable_teams/join",{team_id:e.id,dbx_team_id:e.dbxTeamId},{subjectUserId:this.userId}).then(e=>{"can_join"===e.result[".tag"]?(0,d.browserRedirectWrapper)(e.result.url):t()})}onUserDismissedTeam(e,t,s){return this.apiClient.rpc("joinable_teams/dismiss",{team_id:e.id,dbx_team_id:e.dbxTeamId},{subjectUserId:this.userId}).then(()=>(this.apiClient.rpc("joinable_teams/list",{include_user_dismissed_teams:!1,include_user_collab_teams:!0},{subjectUserId:this.userId}),{joinableTeams:t.filter(t=>t!==e),teamInvitation:e.id===(null==s?void 0:s.team_id)?void 0:s})).catch(e=>{a.Notify.error(m.DEFAULT_ERROR_REFRESH_PAGE)})}onCancelPendingRequest(e,t){return s.__awaiter(this,void 0,void 0,(function*(){try{yield this.apiClient.rpc("joinable_teams/cancel_join",{team_id:e.id,source:c.TeamJoinRequestOrigin.SurfaceExistingTeamHomepage},{subjectUserId:this.userId}),t()}catch(e){a.Notify.error(m.DEFAULT_ERROR_REFRESH_PAGE)}}))}}t.HomeTeamsApiActionsHandler=m,m.DEFAULT_ERROR_REFRESH_PAGE=n.intl.formatMessage({id:"tbMyDV",defaultMessage:"Something went wrong with the request, please refresh the page"}),m.DEFAULT_ERROR_CONTACT_ADMIN=n.intl.formatMessage({id:"td9Mz6",defaultMessage:"Something went wrong with the request, contact the admin"})})),define("metaserver/static/js/home/surface_teams_homepage/home_teams_logger",["require","exports","metaserver/static/js/clean/analytics","metaserver/static/js/teams/ui/team_discovery/data/logger"],(function(e,t,s,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.HomeTeamsLogger=t.HomeTeamsSource=t.TeamJoinStatus=void 0;var r;(function(e){e.DENIED="denied",e.APPROVED="approved",e.PENDING="pending",e.DEFAULT="default",e.AUTO_JOIN="can_auto_join"})(r=t.TeamJoinStatus||(t.TeamJoinStatus={})),t.HomeTeamsSource="home";class a{constructor(e,t){this.userId=e,this.role=t}static getJoinStatus(e){switch(e.joinTeamRequestState[".tag"]){case"waiting_for_approval":return r.PENDING;case"request_rejected_open":case"request_rejected_dismissed":return r.DENIED;case"request_approved":return r.APPROVED;case"can_auto_join":return r.AUTO_JOIN;default:return r.DEFAULT}}logExposedToSETOnHomepage(e,t){let i=0,n=0,o=0,c=0;for(const s of e)if((null==t?void 0:t.team_id)===s.id)c++;else{switch(a.getJoinStatus(s)){case r.PENDING:i++;break;case r.DENIED:n++;break;case r.AUTO_JOIN:c++;break;default:o++}}s.TeamsWebActionsLogger.log("exposed_to_set_on_home_page",{num_of_teams:e.length,num_of_pending_teams:i,num_of_denied_teams:n,num_of_approved_teams:c,num_of_default_teams:o},()=>{},this.userId)}logExpanderClicker(){s.TeamsWebActionsLogger.log("clicked_set_on_home_expander",{},()=>{},this.userId)}logTeamExposedToSETOnHomepage(e){s.TeamsWebActionsLogger.log("exposed_to_set_on_home_team_card",{team_id:e.id,join_status:a.getJoinStatus(e),num_team_members:e.membersCount})}logClickedReqToJoin(e,r){s.TeamsWebActionsLogger.log("clicked_req_to_join",{reason:e,account_role:this.role,team_id:r.id,origin:i.TeamJoinRequestOrigin.SurfaceExistingTeamHomepage,source:t.HomeTeamsSource,join_state:a.getJoinStatus(r),url:"/h",user_plan_type:"basic"},()=>{},this.userId)}getExtraForRequestAccess(e){return{num_team_members:e.membersCount.toString(),user_id:this.userId.toString(),origin:i.TeamJoinRequestOrigin.SurfaceExistingTeamHomepage,source:t.HomeTeamsSource,team_id:e.id.toString(),url:"/h"}}logClickedJoinForAutoJoinableTeam(e,t){let i=0,n=0;for(const e of t){const t=a.getJoinStatus(e);t===r.AUTO_JOIN?n++:t===r.DEFAULT&&i++}s.TeamsWebActionsLogger.log("clicked_join",{account_role:this.role,team_id:e,url:"/h",num_ask_to_join:i,num_auto_join:n},()=>{},this.userId)}logCancelRequestToJoin(e,r){s.TeamsWebActionsLogger.log("cancel_request_to_join",{reason:e,num_team_members:r.membersCount,origin:i.TeamJoinRequestOrigin.SurfaceExistingTeamHomepage,source:t.HomeTeamsSource,team_id:r.id},()=>{},this.userId)}logDismissTeam(e){s.TeamsWebActionsLogger.log("dismiss_team",{team_id:e,origin:i.TeamJoinRequestOrigin.SurfaceExistingTeamHomepage,source:t.HomeTeamsSource},()=>{},this.userId)}}t.HomeTeamsLogger=a})),define("typescript/dropbox/proto/edison_starred/edison_starred_pb",["require","exports","@bufbuild/protobuf","../per_node_metadata/api_v2_meta_pb","../js_init_data/home_web/home_access_web_pb"],(function(e,t,s,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EdisonStarredLegacyPrefetchResults=t.EdisonStarredPostTtiPrefetchResults=t.EdisonStarredPostTtiPrefetchArg=t.EdisonStarredPropsPrefetchResults=t.EdisonStarredPropsPrefetchArg=t.EdisonStarredEmptyArguments=t.EdisonStarredArguments=t.EdisonStarredData=t.EdisonStarredItem=t.EdisonStarredItemDetails=void 0;class a extends s.Message{constructor(e){super(),this.fqPath="",this.targetNsId=s.protoInt64.zero,this.isTeamMemberFolder=!1,s.proto3.util.initPartial(e,this)}static fromBinary(e,t){return(new a).fromBinary(e,t)}static fromJson(e,t){return(new a).fromJson(e,t)}static fromJsonString(e,t){return(new a).fromJsonString(e,t)}static equals(e,t){return s.proto3.util.equals(a,e,t)}}t.EdisonStarredItemDetails=a,a.runtime=s.proto3,a.typeName="edison_starred.EdisonStarredItemDetails",a.fields=s.proto3.util.newFieldList(()=>[{no:1,name:"fq_path",kind:"scalar",T:9},{no:2,name:"target_ns_id",kind:"scalar",T:4},{no:3,name:"is_team_member_folder",kind:"scalar",T:8}]);class n extends s.Message{constructor(e){super(),this.title="",this.url="",this.displayType="",this.idType="",this.resourceId="",this.isMounted=!1,this.icon="",s.proto3.util.initPartial(e,this)}static fromBinary(e,t){return(new n).fromBinary(e,t)}static fromJson(e,t){return(new n).fromJson(e,t)}static fromJsonString(e,t){return(new n).fromJsonString(e,t)}static equals(e,t){return s.proto3.util.equals(n,e,t)}}t.EdisonStarredItem=n,n.runtime=s.proto3,n.typeName="edison_starred.EdisonStarredItem",n.fields=s.proto3.util.newFieldList(()=>[{no:1,name:"details",kind:"message",T:a},{no:2,name:"title",kind:"scalar",T:9},{no:3,name:"url",kind:"scalar",T:9},{no:4,name:"display_type",kind:"scalar",T:9},{no:5,name:"id_type",kind:"scalar",T:9},{no:6,name:"resource_id",kind:"scalar",T:9},{no:7,name:"is_mounted",kind:"scalar",T:8},{no:8,name:"per_node_metadata",kind:"message",T:i.PerNodeMetadataEntity},{no:9,name:"icon",kind:"scalar",T:9}]);class o extends s.Message{constructor(e){super(),this.status="",this.items=[],this.hasMore=!1,this.jsonData="",s.proto3.util.initPartial(e,this)}static fromBinary(e,t){return(new o).fromBinary(e,t)}static fromJson(e,t){return(new o).fromJson(e,t)}static fromJsonString(e,t){return(new o).fromJsonString(e,t)}static equals(e,t){return s.proto3.util.equals(o,e,t)}}t.EdisonStarredData=o,o.runtime=s.proto3,o.typeName="edison_starred.EdisonStarredData",o.fields=s.proto3.util.newFieldList(()=>[{no:1,name:"status",kind:"scalar",T:9},{no:2,name:"items",kind:"message",T:n,repeated:!0},{no:3,name:"has_more",kind:"scalar",T:8},{no:4,name:"json_data",kind:"scalar",T:9}]);class c extends s.Message{constructor(e){super(),this.limit=0,s.proto3.util.initPartial(e,this)}static fromBinary(e,t){return(new c).fromBinary(e,t)}static fromJson(e,t){return(new c).fromJson(e,t)}static fromJsonString(e,t){return(new c).fromJsonString(e,t)}static equals(e,t){return s.proto3.util.equals(c,e,t)}}t.EdisonStarredArguments=c,c.runtime=s.proto3,c.typeName="edison_starred.EdisonStarredArguments",c.fields=s.proto3.util.newFieldList(()=>[{no:1,name:"limit",kind:"scalar",T:13}]);class l extends s.Message{constructor(e){super(),s.proto3.util.initPartial(e,this)}static fromBinary(e,t){return(new l).fromBinary(e,t)}static fromJson(e,t){return(new l).fromJson(e,t)}static fromJsonString(e,t){return(new l).fromJsonString(e,t)}static equals(e,t){return s.proto3.util.equals(l,e,t)}}t.EdisonStarredEmptyArguments=l,l.runtime=s.proto3,l.typeName="edison_starred.EdisonStarredEmptyArguments",l.fields=s.proto3.util.newFieldList(()=>[]);class d extends s.Message{constructor(e){super(),this.encodedUrl="",s.proto3.util.initPartial(e,this)}static fromBinary(e,t){return(new d).fromBinary(e,t)}static fromJson(e,t){return(new d).fromJson(e,t)}static fromJsonString(e,t){return(new d).fromJsonString(e,t)}static equals(e,t){return s.proto3.util.equals(d,e,t)}}t.EdisonStarredPropsPrefetchArg=d,d.runtime=s.proto3,d.typeName="edison_starred.EdisonStarredPropsPrefetchArg",d.fields=s.proto3.util.newFieldList(()=>[{no:1,name:"encoded_url",kind:"scalar",T:9}]);class m extends s.Message{constructor(e){super(),this.initialRole="",s.proto3.util.initPartial(e,this)}static fromBinary(e,t){return(new m).fromBinary(e,t)}static fromJson(e,t){return(new m).fromJson(e,t)}static fromJsonString(e,t){return(new m).fromJsonString(e,t)}static equals(e,t){return s.proto3.util.equals(m,e,t)}}t.EdisonStarredPropsPrefetchResults=m,m.runtime=s.proto3,m.typeName="edison_starred.EdisonStarredPropsPrefetchResults",m.fields=s.proto3.util.newFieldList(()=>[{no:2,name:"initial_role",kind:"scalar",T:9},{no:3,name:"pre_tti_props",kind:"message",T:r.PreTTIGateProps}]);class u extends s.Message{constructor(e){super(),s.proto3.util.initPartial(e,this)}static fromBinary(e,t){return(new u).fromBinary(e,t)}static fromJson(e,t){return(new u).fromJson(e,t)}static fromJsonString(e,t){return(new u).fromJsonString(e,t)}static equals(e,t){return s.proto3.util.equals(u,e,t)}}t.EdisonStarredPostTtiPrefetchArg=u,u.runtime=s.proto3,u.typeName="edison_starred.EdisonStarredPostTtiPrefetchArg",u.fields=s.proto3.util.newFieldList(()=>[]);class h extends s.Message{constructor(e){super(),this.jsonData="",this.error="",s.proto3.util.initPartial(e,this)}static fromBinary(e,t){return(new h).fromBinary(e,t)}static fromJson(e,t){return(new h).fromJson(e,t)}static fromJsonString(e,t){return(new h).fromJsonString(e,t)}static equals(e,t){return s.proto3.util.equals(h,e,t)}}t.EdisonStarredPostTtiPrefetchResults=h,h.runtime=s.proto3,h.typeName="edison_starred.EdisonStarredPostTtiPrefetchResults",h.fields=s.proto3.util.newFieldList(()=>[{no:1,name:"json_data",kind:"scalar",T:9},{no:2,name:"error",kind:"scalar",T:9}]);class p extends s.Message{constructor(e){super(),this.jsonData="",this.error="",s.proto3.util.initPartial(e,this)}static fromBinary(e,t){return(new p).fromBinary(e,t)}static fromJson(e,t){return(new p).fromJson(e,t)}static fromJsonString(e,t){return(new p).fromJsonString(e,t)}static equals(e,t){return s.proto3.util.equals(p,e,t)}}t.EdisonStarredLegacyPrefetchResults=p,p.runtime=s.proto3,p.typeName="edison_starred.EdisonStarredLegacyPrefetchResults",p.fields=s.proto3.util.newFieldList(()=>[{no:2,name:"json_data",kind:"scalar",T:9},{no:3,name:"error",kind:"scalar",T:9}])})),define("typescript/dropbox/proto/edison_recent/edison_recent_pb",["require","exports","@bufbuild/protobuf","../js_init_data/home_web/home_access_web_pb"],(function(e,t,s,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EdisonRecentsPropsPrefetchResults=t.EdisonRecentsPostTTIPrefetchResults=t.EdisonRecentsPrefetchResults=t.EdisonRecentsPropsPrefetchArg=t.EdisonRecentsPostTTIPrefetchArg=t.EdisonRecentsPrefetchArg=void 0;class r extends s.Message{constructor(e){super(),this.numActivities=0,s.proto3.util.initPartial(e,this)}static fromBinary(e,t){return(new r).fromBinary(e,t)}static fromJson(e,t){return(new r).fromJson(e,t)}static fromJsonString(e,t){return(new r).fromJsonString(e,t)}static equals(e,t){return s.proto3.util.equals(r,e,t)}}t.EdisonRecentsPrefetchArg=r,r.runtime=s.proto3,r.typeName="edison_recent.EdisonRecentsPrefetchArg",r.fields=s.proto3.util.newFieldList(()=>[{no:1,name:"num_activities",kind:"scalar",T:5}]);class a extends s.Message{constructor(e){super(),s.proto3.util.initPartial(e,this)}static fromBinary(e,t){return(new a).fromBinary(e,t)}static fromJson(e,t){return(new a).fromJson(e,t)}static fromJsonString(e,t){return(new a).fromJsonString(e,t)}static equals(e,t){return s.proto3.util.equals(a,e,t)}}t.EdisonRecentsPostTTIPrefetchArg=a,a.runtime=s.proto3,a.typeName="edison_recent.EdisonRecentsPostTTIPrefetchArg",a.fields=s.proto3.util.newFieldList(()=>[]);class n extends s.Message{constructor(e){super(),this.UrlPath="",s.proto3.util.initPartial(e,this)}static fromBinary(e,t){return(new n).fromBinary(e,t)}static fromJson(e,t){return(new n).fromJson(e,t)}static fromJsonString(e,t){return(new n).fromJsonString(e,t)}static equals(e,t){return s.proto3.util.equals(n,e,t)}}t.EdisonRecentsPropsPrefetchArg=n,n.runtime=s.proto3,n.typeName="edison_recent.EdisonRecentsPropsPrefetchArg",n.fields=s.proto3.util.newFieldList(()=>[{no:1,name:"UrlPath",kind:"scalar",T:9}]);class o extends s.Message{constructor(e){super(),this.jsonData="",this.error="",s.proto3.util.initPartial(e,this)}static fromBinary(e,t){return(new o).fromBinary(e,t)}static fromJson(e,t){return(new o).fromJson(e,t)}static fromJsonString(e,t){return(new o).fromJsonString(e,t)}static equals(e,t){return s.proto3.util.equals(o,e,t)}}t.EdisonRecentsPrefetchResults=o,o.runtime=s.proto3,o.typeName="edison_recent.EdisonRecentsPrefetchResults",o.fields=s.proto3.util.newFieldList(()=>[{no:2,name:"json_data",kind:"scalar",T:9},{no:3,name:"error",kind:"scalar",T:9}]);class c extends s.Message{constructor(e){super(),this.jsonData="",this.error="",s.proto3.util.initPartial(e,this)}static fromBinary(e,t){return(new c).fromBinary(e,t)}static fromJson(e,t){return(new c).fromJson(e,t)}static fromJsonString(e,t){return(new c).fromJsonString(e,t)}static equals(e,t){return s.proto3.util.equals(c,e,t)}}t.EdisonRecentsPostTTIPrefetchResults=c,c.runtime=s.proto3,c.typeName="edison_recent.EdisonRecentsPostTTIPrefetchResults",c.fields=s.proto3.util.newFieldList(()=>[{no:1,name:"json_data",kind:"scalar",T:9},{no:2,name:"error",kind:"scalar",T:9}]);class l extends s.Message{constructor(e){super(),this.initialRole="",s.proto3.util.initPartial(e,this)}static fromBinary(e,t){return(new l).fromBinary(e,t)}static fromJson(e,t){return(new l).fromJson(e,t)}static fromJsonString(e,t){return(new l).fromJsonString(e,t)}static equals(e,t){return s.proto3.util.equals(l,e,t)}}t.EdisonRecentsPropsPrefetchResults=l,l.runtime=s.proto3,l.typeName="edison_recent.EdisonRecentsPropsPrefetchResults",l.fields=s.proto3.util.newFieldList(()=>[{no:1,name:"initial_role",kind:"scalar",T:9},{no:3,name:"pre_tti_props",kind:"message",T:i.PreTTIGateProps}])})),define("metaserver/static/prod_assets_web_modules/common/TransitionGroup",["exports","./Transition","./extends","react"],(function(e,t,s,i){"use strict";var r=(function(e){return e&&e.__esModule?e:{default:e}})(i);function a(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function n(e,t){var s=Object.create(null);return e&&i.Children.map(e,(function(e){return e})).forEach((function(e){s[e.key]=(function(e){return t&&i.isValidElement(e)?t(e):e})(e)})),s}function o(e,t,s){return null!=s[t]?s[t]:e.props[t]}function c(e,t,s){var r=n(e.children),a=(function(e,t){function s(s){return s in t?t[s]:e[s]}e=e||{},t=t||{};var i,r=Object.create(null),a=[];for(var n in e)n in t?a.length&&(r[n]=a,a=[]):a.push(n);var o={};for(var c in t){if(r[c])for(i=0;i<r[c].length;i++){var l=r[c][i];o[r[c][i]]=s(l)}o[c]=s(c)}for(i=0;i<a.length;i++)o[a[i]]=s(a[i]);return o})(t,r);return Object.keys(a).forEach((function(n){var c=a[n];if(i.isValidElement(c)){var l=n in t,d=n in r,m=t[n],u=i.isValidElement(m)&&!m.props.in;!d||l&&!u?d||!l||u?d&&l&&i.isValidElement(m)&&(a[n]=i.cloneElement(c,{onExited:s.bind(null,c),in:m.props.in,exit:o(c,"exit",e),enter:o(c,"enter",e)})):a[n]=i.cloneElement(c,{in:!1}):a[n]=i.cloneElement(c,{onExited:s.bind(null,c),in:!0,exit:o(c,"exit",e),enter:o(c,"enter",e)})}})),a}var l=Object.values||function(e){return Object.keys(e).map((function(t){return e[t]}))},d=(function(e){function d(t,s){var i,r=(i=e.call(this,t,s)||this).handleExited.bind(a(a(i)));return i.state={contextValue:{isMounting:!0},handleExited:r,firstRender:!0},i}t._inheritsLoose(d,e);var m=d.prototype;return m.componentDidMount=function(){this.mounted=!0,this.setState({contextValue:{isMounting:!1}})},m.componentWillUnmount=function(){this.mounted=!1},d.getDerivedStateFromProps=function(e,t){var s,r,a=t.children,l=t.handleExited;return{children:t.firstRender?(s=e,r=l,n(s.children,(function(e){return i.cloneElement(e,{onExited:r.bind(null,e),in:!0,appear:o(e,"appear",s),enter:o(e,"enter",s),exit:o(e,"exit",s)})}))):c(e,a,l),firstRender:!1}},m.handleExited=function(e,t){var i=n(this.props.children);e.key in i||(e.props.onExited&&e.props.onExited(t),this.mounted&&this.setState((function(t){var i=s._extends({},t.children);return delete i[e.key],{children:i}})))},m.render=function(){var e=this.props,s=e.component,i=e.childFactory,a=t._objectWithoutPropertiesLoose(e,["component","childFactory"]),n=this.state.contextValue,o=l(this.state.children).map(i);return delete a.appear,delete a.enter,delete a.exit,null===s?r.default.createElement(t.TransitionGroupContext.Provider,{value:n},o):r.default.createElement(t.TransitionGroupContext.Provider,{value:n},r.default.createElement(s,a,o))},d})(r.default.Component);d.propTypes={},d.defaultProps={component:"div",childFactory:function(e){return e}};var m=d;e.TransitionGroup=m})),define("metaserver/static/prod_assets_web_modules/common/extends",["exports"],(function(e){"use strict";function t(){return(t=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var i in s)Object.prototype.hasOwnProperty.call(s,i)&&(e[i]=s[i])}return e}).apply(this,arguments)}e._extends=t})),define("metaserver/static/prod_assets_web_modules/common/index4",["exports","../react-transition-group/CSSTransition","./Transition","react","react-dom","./TransitionGroup"],(function(e,t,s,i,r,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}var o=n(i),c=n(r),l=(function(e){function t(){for(var t,s=arguments.length,i=new Array(s),r=0;r<s;r++)i[r]=arguments[r];return(t=e.call.apply(e,[this].concat(i))||this).handleEnter=function(){for(var e=arguments.length,s=new Array(e),i=0;i<e;i++)s[i]=arguments[i];return t.handleLifecycle("onEnter",0,s)},t.handleEntering=function(){for(var e=arguments.length,s=new Array(e),i=0;i<e;i++)s[i]=arguments[i];return t.handleLifecycle("onEntering",0,s)},t.handleEntered=function(){for(var e=arguments.length,s=new Array(e),i=0;i<e;i++)s[i]=arguments[i];return t.handleLifecycle("onEntered",0,s)},t.handleExit=function(){for(var e=arguments.length,s=new Array(e),i=0;i<e;i++)s[i]=arguments[i];return t.handleLifecycle("onExit",1,s)},t.handleExiting=function(){for(var e=arguments.length,s=new Array(e),i=0;i<e;i++)s[i]=arguments[i];return t.handleLifecycle("onExiting",1,s)},t.handleExited=function(){for(var e=arguments.length,s=new Array(e),i=0;i<e;i++)s[i]=arguments[i];return t.handleLifecycle("onExited",1,s)},t}s._inheritsLoose(t,e);var i=t.prototype;return i.handleLifecycle=function(e,t,s){var i,r=this.props.children,a=o.default.Children.toArray(r)[t];a.props[e]&&(i=a.props)[e].apply(i,s),this.props[e]&&this.props[e](c.default.findDOMNode(this))},i.render=function(){var e=this.props,t=e.children,i=e.in,r=s._objectWithoutPropertiesLoose(e,["children","in"]),n=o.default.Children.toArray(t),c=n[0],l=n[1];return delete r.onEnter,delete r.onEntering,delete r.onEntered,delete r.onExit,delete r.onExiting,delete r.onExited,o.default.createElement(a.TransitionGroup,r,i?o.default.cloneElement(c,{key:"first",onEnter:this.handleEnter,onEntering:this.handleEntering,onEntered:this.handleEntered}):o.default.cloneElement(l,{key:"second",onEnter:this.handleExit,onEntering:this.handleExiting,onEntered:this.handleExited}))},t})(o.default.Component);l.propTypes={};var d,m,u=l,h="out-in",p="in-out",_=function(e,t,s){return function(){var i;e.props[t]&&(i=e.props)[t].apply(i,arguments),s()}},g=((d={})[h]=function(e){var t=e.current,i=e.changeState;return o.default.cloneElement(t,{in:!1,onExited:_(t,"onExited",(function(){i(s.ENTERING,null)}))})},d[p]=function(e){var t=e.current,i=e.changeState,r=e.children;return[t,o.default.cloneElement(r,{in:!0,onEntered:_(r,"onEntered",(function(){i(s.ENTERING)}))})]},d),f=((m={})[h]=function(e){var t=e.children,i=e.changeState;return o.default.cloneElement(t,{in:!0,onEntered:_(t,"onEntered",(function(){i(s.ENTERED,o.default.cloneElement(t,{in:!0}))}))})},m[p]=function(e){var t=e.current,i=e.children,r=e.changeState;return[o.default.cloneElement(t,{in:!1,onExited:_(t,"onExited",(function(){r(s.ENTERED,o.default.cloneElement(i,{in:!0}))}))}),o.default.cloneElement(i,{in:!0})]},m),v=(function(e){function t(){for(var t,i=arguments.length,r=new Array(i),a=0;a<i;a++)r[a]=arguments[a];return(t=e.call.apply(e,[this].concat(r))||this).state={status:s.ENTERED,current:null},t.appeared=!1,t.changeState=function(e,s){void 0===s&&(s=t.state.current),t.setState({status:e,current:s})},t}s._inheritsLoose(t,e);var i=t.prototype;return i.componentDidMount=function(){this.appeared=!0},t.getDerivedStateFromProps=function(e,t){return null==e.children?{current:null}:t.status===s.ENTERING&&e.mode===p?{status:s.ENTERING}:!t.current||((i=t.current)===(r=e.children)||o.default.isValidElement(i)&&o.default.isValidElement(r)&&null!=i.key&&i.key===r.key)?{current:o.default.cloneElement(e.children,{in:!0})}:{status:s.EXITING};var i,r},i.render=function(){var e,t=this.props,i=t.children,r=t.mode,a=this.state,n=a.status,c=a.current,l={children:i,current:c,changeState:this.changeState,status:n};switch(n){case s.ENTERING:e=f[r](l);break;case s.EXITING:e=g[r](l);break;case s.ENTERED:e=c}return o.default.createElement(s.TransitionGroupContext.Provider,{value:{isMounting:!this.appeared}},e)},t})(o.default.Component);v.propTypes={},v.defaultProps={mode:h};var E=v,S=Object.freeze({__proto__:null,CSSTransition:t,ReplaceTransition:u,SwitchTransition:E,TransitionGroup:a.TransitionGroup,Transition:s.Transition,config:s.config});e.ReplaceTransition=u,e.SwitchTransition=E,e.esm=S})),define("metaserver/static/prod_assets_web_modules/react-transition-group/CSSTransition",["../common/extends","../common/Transition","react","react-dom"],(function(e,t,s,i){"use strict";var r=(function(e){return e&&e.__esModule?e:{default:e}})(s);function a(e,t){return e.replace(new RegExp("(^|\\s)"+t+"(?:\\s|$)","g"),"$1").replace(/\s+/g," ").replace(/^\s*|\s*$/g,"")}var n=function(e,t){return e&&t&&t.split(" ").forEach((function(t){return i=t,void((s=e).classList?s.classList.remove(i):"string"==typeof s.className?s.className=a(s.className,i):s.setAttribute("class",a(s.className&&s.className.baseVal||"",i)));var s,i}))},o=(function(s){function i(){for(var e,t=arguments.length,i=new Array(t),r=0;r<t;r++)i[r]=arguments[r];return(e=s.call.apply(s,[this].concat(i))||this).appliedClasses={appear:{},enter:{},exit:{}},e.onEnter=function(t,s){e.removeClasses(t,"exit"),e.addClass(t,s?"appear":"enter","base"),e.props.onEnter&&e.props.onEnter(t,s)},e.onEntering=function(t,s){var i=s?"appear":"enter";e.addClass(t,i,"active"),e.props.onEntering&&e.props.onEntering(t,s)},e.onEntered=function(t,s){var i=s?"appear":"enter";e.removeClasses(t,i),e.addClass(t,i,"done"),e.props.onEntered&&e.props.onEntered(t,s)},e.onExit=function(t){e.removeClasses(t,"appear"),e.removeClasses(t,"enter"),e.addClass(t,"exit","base"),e.props.onExit&&e.props.onExit(t)},e.onExiting=function(t){e.addClass(t,"exit","active"),e.props.onExiting&&e.props.onExiting(t)},e.onExited=function(t){e.removeClasses(t,"exit"),e.addClass(t,"exit","done"),e.props.onExited&&e.props.onExited(t)},e.getClassNames=function(t){var s=e.props.classNames,i="string"==typeof s,r=i?(i&&s?s+"-":"")+t:s[t];return{baseClassName:r,activeClassName:i?r+"-active":s[t+"Active"],doneClassName:i?r+"-done":s[t+"Done"]}},e}t._inheritsLoose(i,s);var a=i.prototype;return a.addClass=function(e,t,s){var i=this.getClassNames(t)[s+"ClassName"];"appear"===t&&"done"===s&&(i+=" "+this.getClassNames("enter").doneClassName),"active"===s&&e&&e.scrollTop,this.appliedClasses[t][s]=i,(function(e,t){e&&t&&t.split(" ").forEach((function(t){return i=t,void((s=e).classList?s.classList.add(i):(function(e,t){return e.classList?!!t&&e.classList.contains(t):-1!==(" "+(e.className.baseVal||e.className)+" ").indexOf(" "+t+" ")})(s,i)||("string"==typeof s.className?s.className=s.className+" "+i:s.setAttribute("class",(s.className&&s.className.baseVal||"")+" "+i)));var s,i}))})(e,i)},a.removeClasses=function(e,t){var s=this.appliedClasses[t],i=s.base,r=s.active,a=s.done;this.appliedClasses[t]={},i&&n(e,i),r&&n(e,r),a&&n(e,a)},a.render=function(){var s=this.props;s.classNames;var i=t._objectWithoutPropertiesLoose(s,["classNames"]);return r.default.createElement(t.Transition,e._extends({},i,{onEnter:this.onEnter,onEntered:this.onEntered,onEntering:this.onEntering,onExit:this.onExit,onExiting:this.onExiting,onExited:this.onExited}))},i})(r.default.Component);return o.defaultProps={classNames:""},o.propTypes={},o}));
//# sourceMappingURL=pkg-home-post-tti.min.js-vflYhMnqT.map