define("metaserver/static/js/clean/base64",["require","exports"],(function(e,t){"use strict";function n(e){const t=[];let n=0,r=0,i=0,s=0,o=0;for(e+="";n<e.length;)i=e.charCodeAt(n),i<128?(t[r++]=String.fromCharCode(i),n++):i>191&&i<224?(s=e.charCodeAt(n+1),t[r++]=String.fromCharCode((31&i)<<6|63&s),n+=2):(s=e.charCodeAt(n+1),o=e.charCodeAt(n+2),t[r++]=String.fromCharCode((15&i)<<12|(63&s)<<6|63&o),n+=3);return t.join("")}Object.defineProperty(t,"__esModule",{value:!0}),t.decode=t.encode=void 0,t.encode=function(e){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";let n=void 0,r=void 0,i=void 0,s=void 0,o=void 0,a=void 0,_=void 0,l=void 0,u=0,c=0,d="";const m=[];if(!e)return e;for(;n=e.charCodeAt(u++),r=e.charCodeAt(u++),i=e.charCodeAt(u++),l=n<<16|r<<8|i,s=l>>18&63,o=l>>12&63,a=l>>6&63,_=63&l,m[c++]=t.charAt(s)+t.charAt(o)+t.charAt(a)+t.charAt(_),u<e.length;);d=m.join("");const g=e.length%3;return(g?d.slice(0,g-3):d)+"===".slice(g||3)},t.decode=function(e,t){const r=t?e=>e:n;if("function"==typeof window.atob)return r(window.atob(e));const i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";let s=0,o=0;const a=[];if(!e)return e;for(e+="";;){const t=i.indexOf(e.charAt(s++)),n=i.indexOf(e.charAt(s++)),r=i.indexOf(e.charAt(s++)),_=i.indexOf(e.charAt(s++)),l=t<<18|n<<12|r<<6|_,u=l>>16&255,c=l>>8&255,d=255&l;if(a[o++]=64===r?String.fromCharCode(u):64===_?String.fromCharCode(u,c):String.fromCharCode(u,c,d),!(s<e.length))break}let _=a.join("");return _=r(_),_}})),define("metaserver/static/js/browse/action_logger",["require","exports","tslib","metaserver/static/js/filepath/filepath","metaserver/static/js/clean/filetypes","metaserver/static/js/browse/logger","metaserver/static/js/browse/logger_util","metaserver/static/js/clean/web_user_action_events","metaserver/static/js/user_survey/user_survey","metaserver/static/js/pap/analytics_client","metaserver/static/js/dropbox/proto/pap_events/files_browser/shown_files_root","metaserver/static/js/pap/util"],(function(e,t,n,r,i,s,o,a,_,l,u,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.logApprovalActions=t.logAutoFolderEducationModal=t.logAutoFolderAdoptionSnackbar=t.logFolderRuleFeedbackModal=t.logCreateAutomatedFolderClick=t.logBrowseLoaded=t.logFileAction=t.logRightClickItems=t.logContextMenuClick=t.logKeyboardShortcutUsage=t.logFileCreateSuccess=t.logPageView=t.logFileCreateClick=t.logFileUploadFSWReturned=t.logPermanentDeleteFiles=t.logDeleteFiles=t.logOpenCopyModal=t.logDownload=t.logAddComment=t.logRenameFiles=t.logOpenMoveModal=t.logVersions=t.logCopyFiles=t.logOpenAddToCollectionModal=t.logMoveFiles=t.logFileOperationModalClick=t.logRestore=t.logSwitchViewType=t.logSortRecords=t.logToggleDeletedFiles=t.logViewShareModal=t.logFolderExplorerCollapseRow=t.logFolderExplorerExpandRow=t.logOpenRow=t.logBrowseAction=t.logWebUserAction=t.rightRailStates=t.BrowseLogEventSource=t.folderTypes=t.getEnumValueForBrowseBaseUrl=t.getEnumValueForRightSidebarState=t.getEnumValueForFolderType=t.getEnumValueForListViewType=t.getEnumValueForAccountRole=void 0,r=n.__importStar(r);var d=u.pap_events.files_browser.Shown_FilesRoot;t.getEnumValueForAccountRole=e=>{var t;return null!==(t=(0,c.getEnumValueForString)(`${e}_ACCOUNT_ROLE`,d.AccountRole))&&void 0!==t?t:d.AccountRole.UNKNOWN_ACCOUNT_ROLE};t.getEnumValueForListViewType=e=>{var t;return null!==(t=(0,c.getEnumValueForString)(`${e}_LIST_VIEW_TYPE`,d.ListViewType))&&void 0!==t?t:d.ListViewType.UNKNOWN_LIST_VIEW_TYPE};t.getEnumValueForFolderType=e=>{var t;return null!==(t=(0,c.getEnumValueForString)(`${e}_FOLDER_TYPE`,d.FolderType))&&void 0!==t?t:d.FolderType.UNKNOWN_FOLDER_TYPE};t.getEnumValueForRightSidebarState=e=>{var t;return null!==(t=(0,c.getEnumValueForString)(`${e}_RIGHT_SIDEBAR_STATE`,d.RightSidebarState))&&void 0!==t?t:d.RightSidebarState.UNKNOWN_RIGHT_SIDEBAR_STATE};function m(e){s.browseLogger.log(e)}function g({uid:e,source:t,action:n,num_files_selected:i,num_folders_selected:s,view_type:a,result:_,error_summary:l,action_surface:u,action_source:c,batch_success_count:d,batch_fail_count:g,lookup_error_type:f,right_sidebar_state:v,extra:S}){let E={num_files_selected:i,num_folders_selected:s,source:t,view_type:a,error_summary:l};if((0,o.isFile)(_)){const e=_,{request_id:t,ns_id:n,sjid:i,file_id:s,fq_path:o,bytes:a,ext:l}=e;E=Object.assign(Object.assign({},E),{request_id:t,file_nsid:n,file_sjid:i,file_id:s,file_name:r.filename(o),file_path:o,file_size:a,file_extension:l})}else if((0,o.isPaper)(_)){const e=_,{request_id:t}=e;E=Object.assign(Object.assign({},E),{request_id:t})}m({user_id:e,event_name:n,source:t,view_type:a,request_id:E.request_id,file_nsid:E.file_nsid,file_sjid:E.file_sjid,file_id:E.file_id,file_name:E.file_name,file_path:E.file_path,file_size:E.file_size,file_extension:E.file_extension,action_source:c,extra:Object.assign(Object.assign({},S),{num_files_selected:String(E.num_files_selected),num_folders_selected:String(E.num_folders_selected),error_summary:E.error_summary||null,action_surface:u||null,batch_success_count:d?String(d):null,batch_fail_count:g?String(g):null,lookup_error_type:f||null,right_sidebar_state:null!=v?v:null})})}t.getEnumValueForBrowseBaseUrl=e=>{var t;return null!==(t=(0,c.getEnumValueForString)(`${e.substring(1)}_BROWSE_BASE_URL`,d.BrowseBaseUrl))&&void 0!==t?t:d.BrowseBaseUrl.UNKNOWN_BROWSE_BASE_URL},t.folderTypes=["vault","root","team_member_folder","team_shared_folder","shared_folder","folder"],(function(e){e.MAESTRO_RIGHT_SIDEBAR="MAESTRO_RIGHT_SIDEBAR",e.MAESTRO_PHOTOS_RIGHT_SIDEBAR="MAESTRO_PHOTOS_RIGHT_SIDEBAR",e.LEGACY_HEADER_ACTIONS="LEGACY_HEADER_ACTIONS",e.DRAG="DRAG"})(t.BrowseLogEventSource||(t.BrowseLogEventSource={})),t.rightRailStates=["collapsed","opened"],s.browseLogger.registerRowInjector(s.screenSizeInjector),t.logWebUserAction=m,t.logBrowseAction=g,t.logOpenRow=function({uid:e,entity_type:t,source:n,view_type:r,file_nsid:s,file_sjid:o,file_id:_,file_name:l,file_path:u,file_size:c,file_type:d,file_extension:g,request_id:f,action_source:v,vaultApi:S,vaultLoggingTypes:E,rightRailState:p}){m({user_id:e,event_name:a.WebUserActionLogEvent.OPEN_ROW,source:n,view_type:r,file_nsid:s,file_sjid:o,file_id:_,file_name:l,file_path:u,file_size:c,file_extension:g,request_id:f,action_source:v,extra:{entity_type:t,right_sidebar_state:null!=p?p:null}}),d===i.FileTypes.VAULT_FOLDER&&null!=S&&null!=E&&S.logProductAnalyticsEvent({actionSurface:E.AnalyticsEventActionSurface.BROWSE,eventAction:E.AnalyticsEventAction.SELECT,eventObject:E.AnalyticsEventObject.VAULT_FOLDER})},t.logFolderExplorerExpandRow=function({uid:e,entity_type:t,source:n,file_name:r,file_path:i}){m({user_id:e,event_name:a.WebUserActionLogEvent.FOLDER_EXPLORER_EXPAND_ROW,source:n,file_name:r,file_path:i,extra:{entity_type:t}})},t.logFolderExplorerCollapseRow=function({uid:e,entity_type:t,source:n,file_name:r,file_path:i}){m({user_id:e,event_name:a.WebUserActionLogEvent.FOLDER_EXPLORER_COLLAPSE_ROW,source:n,file_name:r,file_path:i,extra:{entity_type:t}})},t.logViewShareModal=function({uid:e,modal_session_id:t,file_nsid:n,file_sjid:r,file_id:i,file_name:s,file_path:o}){m({user_id:e,event_name:a.WebUserActionLogEvent.VIEW_SHARE_MODEL,file_nsid:n,file_sjid:r,file_id:i,file_name:s,file_path:o,extra:{modal_session_id:t}})},t.logToggleDeletedFiles=function({uid:e,show_deleted_files:t,view_type:n,action_surface:r,source:i}){m({user_id:e,event_name:a.WebUserActionLogEvent.TOGGLE_DELETED_FILES,view_type:n,source:i,extra:{show_deleted_files:t.toString(),action_surface:r}})},t.logSortRecords=function({uid:e,sort_by:t,sort_direction:n,view_type:r}){m({user_id:e,event_name:a.WebUserActionLogEvent.SORT_RECORDS,view_type:r,extra:{sort_by:t,sort_direction:n}})},t.logSwitchViewType=function({uid:e,isSearchMode:t,viewType:n}){m({user_id:e,event_name:a.WebUserActionLogEvent.SWITCH_VIEW_TYPE,view_type:n})},t.logRestore=function({uid:e,source:t,view_type:n,file_nsid:r,file_path:i,file_name:s,num_files_selected:o,num_folders_selected:_}){m({user_id:e,event_name:a.WebUserActionLogEvent.RESTORE,source:t,view_type:n,file_nsid:r,file_path:i,file_name:s,extra:{num_files_selected:o?o.toString():null,num_folders_selected:_?_.toString():null}})},t.logFileOperationModalClick=function({uid:e,event_name:t,selectedPath:n}){m({user_id:e,event_name:t,extra:n?{selectedPath:n}:{}})},t.logMoveFiles=function(e){g(Object.assign(Object.assign({},e),{action:a.WebUserActionLogEvent.MOVE})),_.UserSurvey.trackEvent("move_item","browse")},t.logOpenAddToCollectionModal=function(e){g(Object.assign(Object.assign({},e),{action:a.WebUserActionLogEvent.OPEN_ADD_TO_COLLECTION_MODAL}))},t.logCopyFiles=function(e){g(Object.assign(Object.assign({},e),{action:a.WebUserActionLogEvent.COPY}))},t.logVersions=function(e){g(Object.assign(Object.assign({},e),{action:a.WebUserActionLogEvent.VERSIONS}))},t.logOpenMoveModal=function(e){g(Object.assign(Object.assign({},e),{action:a.WebUserActionLogEvent.OPEN_MOVE_MODAL}))},t.logRenameFiles=function(e){g(Object.assign(Object.assign({},e),{action:a.WebUserActionLogEvent.RENAME}))},t.logAddComment=function(e){g(Object.assign(Object.assign({},e),{action:a.WebUserActionLogEvent.ADD_COMMENT}))},t.logDownload=function(e){g(Object.assign(Object.assign({},e),{action:a.WebUserActionLogEvent.DOWNLOAD})),_.UserSurvey.trackEvent("download_item","browse")},t.logOpenCopyModal=function(e){g(Object.assign(Object.assign({},e),{action:a.WebUserActionLogEvent.OPEN_COPY_MODAL}))},t.logDeleteFiles=function(e){g(Object.assign(Object.assign({},e),{action:a.WebUserActionLogEvent.DELETE}))},t.logPermanentDeleteFiles=function(e){g(Object.assign(Object.assign({},e),{action:a.WebUserActionLogEvent.PERMANENT_DELETE}))},t.logFileUploadFSWReturned=function({uid:e,file_name:t,upload_id:n,all_fsw_ids:r,filtered_fsw_ids:i}){m({user_id:e,event_name:a.WebUserActionLogEvent.FILE_UPLOAD_FSW_RETURNED,file_name:t,upload_id:n,all_fsw_ids:r,filtered_fsw_ids:i}),_.UserSurvey.trackEvent("upload_item","browse")},t.logFileCreateClick=function({uid:e,source:t,action:n,depth_folder_selected:r,selection_mode:i,empty_folder:s}){m({user_id:e,source:t,event_name:n,extra:{depth_folder_selected:void 0!==r?r.toString():null,selection_mode:i,empty_folder:s?"true":"false"}})},t.logPageView=function({uid:e,view_type:n,url:r,baseUrl:i,folder_type:s,right_sidebar_state:o,navigation_depth:_,is_under_tmf:u,role:c}){m({user_id:e,event_name:a.WebUserActionLogEvent.PAGE_VIEW,view_type:n,extra:{url:r,navigation_depth:void 0!==_?_.toString():null,folder_type:s,right_sidebar_state:o,is_under_tmf:void 0!==u?u.toString():null}}),(0,l.logEvent)(d.create({actionSurface:"browse",eventClass:d.EventClass.FILES_BROWSER,accountRole:(0,t.getEnumValueForAccountRole)(c),listViewType:(0,t.getEnumValueForListViewType)(n),navigationDepth:null!=_?_:0,folderType:(0,t.getEnumValueForFolderType)(s),rightSidebarState:(0,t.getEnumValueForRightSidebarState)(o),isUnderTmf:null!=u&&u,browseBaseUrl:(0,t.getEnumValueForBrowseBaseUrl)(i)}))},t.logFileCreateSuccess=function({uid:e,document_type:t,time_elapsed:n,open_id:r,selection_mode:i,empty_folder:s}){m({user_id:e,event_name:a.WebUserActionLogEvent.FILE_CREATE_SUCCESS,extra:{document_type:t.toString(),time_elapsed:n.toString(),open_id:r,create_completed_timestamp_ms:Date.now().toString(),selection_mode:i||null,empty_folder:s?"true":"false"}}),_.UserSurvey.trackEvent("create_item","browse")},t.logKeyboardShortcutUsage=function({user_id:e,view_type:t,keyboard_shortcut_type:n}){m({user_id:e,event_name:a.WebUserActionLogEvent.KEYBOARD_SHORTCUT,view_type:t,extra:{keyboard_shortcut_type:n}})},t.logContextMenuClick=function({uid:e,viewType:t,action_surface:n,numFilesSelected:r,numFoldersSelected:i}){m({user_id:e,event_name:a.WebUserActionLogEvent.CONTEXT_MENU_CLICK,view_type:t,extra:{action_surface:n,num_files_selected:r?r.toString():null,num_folders_selected:i?i.toString():null}})},t.logRightClickItems=function({uid:e,viewType:t,action_surface:n,numFilesSelected:r,numFoldersSelected:i}){m({user_id:e,event_name:a.WebUserActionLogEvent.RIGHT_CLICK_ITEMS,view_type:t,extra:{action_surface:n,num_files_selected:r?r.toString():null,num_folders_selected:i?i.toString():null}})},t.logFileAction=function({uid:e,action:t,num_files_selected:n,num_folders_selected:r,source:i,view_type:s,jobId:o,error_summary:a,error:_,batch_success_count:l,batch_fail_count:u,lookup_error_type:c,extra:d={}}){m({user_id:e,event_name:t,source:i,view_type:s,extra:Object.assign({num_files_selected:n?n.toString():null,num_folders_selected:r?r.toString():null,error_summary:a||null,error:_||null,job_id:o||null,batch_success_count:l?String(l):null,batch_fail_count:u?String(u):null,lookup_error_type:c||null},d)})},t.logBrowseLoaded=function({uid:e,view_type:t,url:n,folder_type:r,navigation_depth:i,is_under_tmf:s}){m({user_id:e,event_name:a.WebUserActionLogEvent.BROWSE_LOADED,view_type:t,extra:{url:n,navigation_depth:void 0!==i?i.toString():null,folder_type:r,is_under_tmf:void 0!==s?s.toString():null}})},t.logCreateAutomatedFolderClick=function({uid:e,source:t,file_path:n,file_nsid:r}){m({user_id:e,source:t,file_path:n,file_nsid:r,event_name:a.WebUserActionLogEvent.CREATE_AUTOMATED_FOLDER_CLICK})},t.logFolderRuleFeedbackModal=function({uid:e,feedback_source:t,modal_session_id:n,event_name:r,file_path:i,error:s}){m({user_id:e,file_path:i,event_name:r,extra:{feedback_source:t,modal_session_id:n,error:s||null}})},t.logAutoFolderAdoptionSnackbar=function({action_source:e,event_name:t,file_nsid:n,source:r,trigger_rule:i,user_id:s,snackbar_click_option:o}){m({user_id:s,event_name:t,action_source:e,file_nsid:n,extra:{source:r||null,trigger_rule:i,snackbar_click_option:o||null}})},t.logAutoFolderEducationModal=function({action_source:e,event_name:t,file_nsid:n,user_id:r,source:i,modal_session_id:s,open_ts:o,close_ts:a}){m({user_id:r,event_name:t,action_source:e,file_nsid:n,extra:{source:i||null,modal_session_id:s,open_ts:o||null,close_ts:a||null}})},t.logApprovalActions=function({user_id:e,event_name:t,action_surface:n,file_sjid:r,file_nsid:i,file_extension:s,file_path:o,file_id:a,comment_id:_,thread_id:l,approval_status:u,details_length:c}){m({user_id:e,event_name:t,file_sjid:r,file_nsid:i,file_extension:s,file_path:o,file_id:a,extra:{action_surface:n||null,comment_id:_||null,thread_id:l||null,approval_status:u||null,details_length:(null==c?void 0:c.toString())||null}})}})),define("metaserver/static/js/browse/logger",["require","exports","tslib","metaserver/static/js/logging/hive/schemas/web-user-action","metaserver/static/js/logging/telemetry"],(function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.screenSizeInjector=t.browseLogger=t.BrowseLogger=void 0,i=n.__importStar(i);class s{constructor(e){this.registerRowInjector=e=>{this.rowInjectors.push(e)},this.log=e=>{let t={};this.rowInjectors.forEach(e=>{const n=e();t=Object.assign(Object.assign(Object.assign({},t),n),{extra:Object.assign(Object.assign({},t.extra),n.extra)})}),this.hiveLogger.log(new r.WebUserActionRow(Object.assign(Object.assign(Object.assign({},t),e),{extra:Object.assign(Object.assign({},t.extra),e.extra)})))},this.hiveLogger=e||new i.HiveLogger,this.rowInjectors=[]}}t.BrowseLogger=s,t.browseLogger=new s;t.screenSizeInjector=()=>({browser_width:window.innerWidth,browser_height:window.innerHeight,device_width:window.screen&&window.screen.width,device_height:window.screen&&window.screen.height})})),define("typescript/dropbox/proto/js_init_data/user_survey/user_survey_pb",["require","exports","@bufbuild/protobuf","../../user_survey_attributes/user_survey_attributes_pb"],(function(e,t,n,r){"use strict";var i;Object.defineProperty(t,"__esModule",{value:!0}),t.UserSurveyInitData=t.FamilyData=t.AccountAge=void 0,(function(e){e[e.UNKNOWN=0]="UNKNOWN",e[e.UNDER_14_DAYS=1]="UNDER_14_DAYS",e[e.FROM_14_DAYS_TO_30_DAYS=2]="FROM_14_DAYS_TO_30_DAYS",e[e.FROM_30_DAYS_TO_90_DAYS=3]="FROM_30_DAYS_TO_90_DAYS",e[e.FROM_90_DAYS_TO_1_YEAR=4]="FROM_90_DAYS_TO_1_YEAR",e[e.FROM_1_YEAR_TO_5_YEARS=5]="FROM_1_YEAR_TO_5_YEARS",e[e.OVER_5_YEARS=6]="OVER_5_YEARS"})(i=t.AccountAge||(t.AccountAge={})),n.proto3.util.setEnumType(i,"user_survey.AccountAge",[{no:0,name:"UNKNOWN"},{no:1,name:"UNDER_14_DAYS"},{no:2,name:"FROM_14_DAYS_TO_30_DAYS"},{no:3,name:"FROM_30_DAYS_TO_90_DAYS"},{no:4,name:"FROM_90_DAYS_TO_1_YEAR"},{no:5,name:"FROM_1_YEAR_TO_5_YEARS"},{no:6,name:"OVER_5_YEARS"}]);class s extends n.Message{constructor(e){super(),this.hasCompletedOnboarding=!1,n.proto3.util.initPartial(e,this)}static fromBinary(e,t){return(new s).fromBinary(e,t)}static fromJson(e,t){return(new s).fromJson(e,t)}static fromJsonString(e,t){return(new s).fromJsonString(e,t)}static equals(e,t){return n.proto3.util.equals(s,e,t)}}t.FamilyData=s,s.runtime=n.proto3,s.typeName="user_survey.FamilyData",s.fields=n.proto3.util.newFieldList(()=>[{no:1,name:"has_completed_onboarding",kind:"scalar",T:8}]);class o extends n.Message{constructor(e){super(),this.iframeSrc="",this.surveyUserId="",this.isCsmTeam=!1,this.isTestAccount=!1,this.skuName=r.SkuName.NONE,this.anonymizedPath="",this.isMobile=!1,this.isPaidTeam=!1,this.isTeamAdmin=!1,this.isCdm=!1,this.isOver30DaysSinceAccountCreated=!1,this.isOver30DaysSinceJoinedTeam=!1,this.accountAge=i.UNKNOWN,n.proto3.util.initPartial(e,this)}static fromBinary(e,t){return(new o).fromBinary(e,t)}static fromJson(e,t){return(new o).fromJson(e,t)}static fromJsonString(e,t){return(new o).fromJsonString(e,t)}static equals(e,t){return n.proto3.util.equals(o,e,t)}}t.UserSurveyInitData=o,o.runtime=n.proto3,o.typeName="user_survey.UserSurveyInitData",o.fields=n.proto3.util.newFieldList(()=>[{no:1,name:"iframe_src",kind:"scalar",T:9},{no:2,name:"survey_user_id",kind:"scalar",T:9},{no:3,name:"is_csm_team",kind:"scalar",T:8},{no:4,name:"is_test_account",kind:"scalar",T:8},{no:5,name:"sku_name",kind:"enum",T:n.proto3.getEnumType(r.SkuName)},{no:6,name:"anonymized_path",kind:"scalar",T:9},{no:7,name:"is_mobile",kind:"scalar",T:8},{no:8,name:"is_paid_team",kind:"scalar",T:8},{no:9,name:"is_team_admin",kind:"scalar",T:8},{no:10,name:"is_cdm",kind:"scalar",T:8},{no:11,name:"is_over_30_days_since_account_created",kind:"scalar",T:8},{no:12,name:"is_over_30_days_since_joined_team",kind:"scalar",T:8},{no:13,name:"family_data",kind:"message",T:s},{no:14,name:"account_age",kind:"enum",T:n.proto3.getEnumType(i)}])})),define("typescript/dropbox/proto/user_survey_attributes/user_survey_attributes_pb",["require","exports","@bufbuild/protobuf"],(function(e,t,n){"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),t.SkuName=void 0,(function(e){e[e.NONE=0]="NONE",e[e.OTHER_SKU=1]="OTHER_SKU",e[e.FAMILY_PAYING_MEMBER=2]="FAMILY_PAYING_MEMBER",e[e.FAMILY_NONPAYING_MEMBER=3]="FAMILY_NONPAYING_MEMBER",e[e.BASIC=4]="BASIC",e[e.TRANSFER=5]="TRANSFER",e[e.PLUS=6]="PLUS",e[e.PROFESSIONAL=7]="PROFESSIONAL",e[e.BUSINESS_STANDARD=8]="BUSINESS_STANDARD",e[e.BUSINESS_ADVANCED=9]="BUSINESS_ADVANCED",e[e.ENTERPRISE=10]="ENTERPRISE",e[e.BACKUP=11]="BACKUP"})(r=t.SkuName||(t.SkuName={})),n.proto3.util.setEnumType(r,"user_survey_attributes.SkuName",[{no:0,name:"NONE"},{no:1,name:"OTHER_SKU"},{no:2,name:"FAMILY_PAYING_MEMBER"},{no:3,name:"FAMILY_NONPAYING_MEMBER"},{no:4,name:"BASIC"},{no:5,name:"TRANSFER"},{no:6,name:"PLUS"},{no:7,name:"PROFESSIONAL"},{no:8,name:"BUSINESS_STANDARD"},{no:9,name:"BUSINESS_ADVANCED"},{no:10,name:"ENTERPRISE"},{no:11,name:"BACKUP"}])})),define("metaserver/static/js/user_survey/user_survey",["require","exports","tslib","metaserver/static/js/proto_utils/unpack","typescript/dropbox/proto/js_init_data/user_survey/user_survey_pb","metaserver/static/js/clean/viewer","metaserver/static/js/logging/telemetry","metaserver/static/js/logging/hive/schemas/web-user_survey","metaserver/static/js/user_survey/user_survey_util"],(function(e,t,n,r,i,s,o,a,_){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.moduleInit=t.InternalSurveyFunctionsForTestOnly=t.UserSurvey=t.init=t.USER_SURVEY_AGGREGATE_EVENTS_MAP=void 0,i=n.__importStar(i);const l=new((o=n.__importStar(o)).HiveLogger);t.USER_SURVEY_AGGREGATE_EVENTS_MAP=new Map([["browse_csat_trigger",[{event:"share_item",eventSurface:"browse"},{event:"move_item",eventSurface:"browse"},{event:"rename_item",eventSurface:"browse"},{event:"delete_item",eventSurface:"browse"},{event:"download_item",eventSurface:"browse"},{event:"upload_item",eventSurface:"browse"},{event:"create_item",eventSurface:"browse"}]],["add_item",[{event:"upload_item",eventSurface:"browse"},{event:"create_item",eventSurface:"browse"}]]]);const u=["/individual"];let c,d=null,m=null,g=[];function f(e,t){d&&(d.height=e,d.width=t)}function v(e){const t=e.data.eventType;if(e.origin===m&&e.source===(null==d?void 0:d.contentWindow))switch(t){case"surveyResized":f(e.data.surveyHeight,e.data.surveyWidth);break;case"surveyPresented":l.log(new a.UserSurveyLoggingTableRow({event_name:"shown_survey",user_survey_id:c}));break;case"surveyClosed":f("0","0"),l.log(new a.UserSurveyLoggingTableRow({event_name:"closed_survey",user_survey_id:c}))}}function S(e){d||(m=`https://${e.iframeSrc}`,d=O.createIframe(m)),u.includes(e.anonymizedPath)&&d.classList.add("usersurvey-iframe--bottom-left"),d.addEventListener("load",()=>{b(),E({type:"setUserId",data:{userId:e.surveyUserId}}),c=e.surveyUserId,A("localeCode",(0,_.getCurrentLocaleCode)()),A("isCsmTeam",e.isCsmTeam?"true":"false"),A("isTestUser",e.isTestAccount?"true":"false"),A("skuName",(0,_.skuNameToStr)(e.skuName)),A("isMobile",e.isMobile?"true":"false"),A("isPaidTeam",e.isPaidTeam?"true":"false"),A("isTeamAdmin",e.isTeamAdmin?"true":"false"),A("isCdm",e.isCdm?"true":"false"),A("isOver30DaysSinceAccountCreated",e.isOver30DaysSinceAccountCreated?"true":"false"),A("isOver30DaysSinceJoinedTeam",e.isOver30DaysSinceJoinedTeam?"true":"false"),A("accountAge",(0,_.accountAgeToStr)(e.accountAge));const t=s.Viewer.get_viewer();A("isSignedIn",t.is_signed_in?"true":"false"),t.get_users().find(e=>e.is_dropbox_admin)?A("isDropboxer","true"):y("isDropboxer"),e.familyData&&A("hasCompletedAllFamilyOnboarding",e.familyData.hasCompletedOnboarding?"true":"false"),g.forEach(e=>E(e)),g=[]}),window.addEventListener("resize",b),window.addEventListener("message",v)}function E(e){const t=d||document&&document.getElementById("usersurvey-iframe"),n=m||t&&t.src;if(t&&t.contentWindow&&n){(function(e){switch(e.type){case"trackEvent":l.log(new a.UserSurveyLoggingTableRow({event_name:"track_event",user_survey_id:c,extras:{event_name:e.data.eventName}}));break;case"addAttribute":l.log(new a.UserSurveyLoggingTableRow({event_name:"add_attribute",user_survey_id:c,extras:{key:e.data.key,value:e.data.value.toString()}}))}})(e);const r={eventType:e.type,eventData:e.data};t.contentWindow.postMessage(r,n)}else g.push(e)}function p(e,t){const n="web_"+e;E({type:"trackEvent",data:{eventName:n}}),E({type:"trackEvent",data:{eventName:n+"_from_"+t}})}function A(e,t){E({type:"addAttribute",data:{key:e,value:t}})}function y(e){E({type:"removeAttribute",data:{key:e}})}function b(){E({type:"setWindowDimensions",data:{height:window.innerHeight,width:360}})}t.init=S,t.UserSurvey={trackEvent:function(e,n){p(e,n),t.USER_SURVEY_AGGREGATE_EVENTS_MAP.forEach((t,r)=>{for(const i of t)e===i.event&&i.eventSurface===n&&(E({type:"trackEvent",data:{eventName:r}}),p(r,n))})},addAttribute:A,addCallback:function(){},removeAttribute:y};const O={init:S,createIframe:function(e){const t=document.createElement("iframe");return t.src=e,t.setAttribute("sandbox","allow-scripts allow-same-origin allow-popups"),t.setAttribute("class","usersurvey-iframe"),t.setAttribute("id","usersurvey-iframe"),t.setAttribute("allowTransparency","true"),t.setAttribute("height","0"),t.setAttribute("width","0"),document.body.insertBefore(t,document.body.childNodes[0]),t},receiveMessage:v};t.InternalSurveyFunctionsForTestOnly=O,t.moduleInit=function(e){S((0,r.unmarshalProto)(e,i.UserSurveyInitData))}})),define("metaserver/static/js/user_survey/user_survey_util",["require","exports","tslib","typescript/dropbox/proto/js_init_data/user_survey/user_survey_pb","typescript/dropbox/proto/user_survey_attributes/user_survey_attributes_pb","metaserver/static/js/modules/constants/page_load","metaserver/static/js/modules/constants/locales","lodash","metaserver/static/js/clean/ts_utils"],(function(e,t,n,r,i,s,o,a,_){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.accountAgeToStr=t.skuNameToStr=t.getCurrentLocaleCode=void 0,r=n.__importStar(r),i=n.__importStar(i),o=n.__importStar(o),t.getCurrentLocaleCode=function(){var e;const t=null===(e=(0,a.find)(o.LIST_OF_LOCALES_WITHOUT_INTERNAL,e=>e.localeCode===s.USER_LOCALE))||void 0===e?void 0:e.localeCode;return t||"unknown"},t.skuNameToStr=function(e){switch(e){case i.SkuName.NONE:return"none";case i.SkuName.OTHER_SKU:return"other";case i.SkuName.FAMILY_PAYING_MEMBER:return"family_paying_member";case i.SkuName.FAMILY_NONPAYING_MEMBER:return"family_nonpaying_member";case i.SkuName.BASIC:return"basic";case i.SkuName.TRANSFER:return"transfer";case i.SkuName.PLUS:return"plus";case i.SkuName.PROFESSIONAL:return"professional";case i.SkuName.BUSINESS_ADVANCED:return"business_advanced";case i.SkuName.BUSINESS_STANDARD:return"business_standard";case i.SkuName.ENTERPRISE:return"enterprise";case i.SkuName.BACKUP:return"backup";default:(0,_.enforceExhaustive)(e)}};t.accountAgeToStr=e=>{switch(e){case r.AccountAge.UNKNOWN:return"unknown";case r.AccountAge.UNDER_14_DAYS:return"under_14_days";case r.AccountAge.FROM_14_DAYS_TO_30_DAYS:return"14_to_30_days";case r.AccountAge.FROM_30_DAYS_TO_90_DAYS:return"30_to_90_days";case r.AccountAge.FROM_90_DAYS_TO_1_YEAR:return"90_days_to_1_year";case r.AccountAge.FROM_1_YEAR_TO_5_YEARS:return"1_to_5_years";case r.AccountAge.OVER_5_YEARS:return"over_5_years";default:return"unknown"}}})),define("metaserver/static/js/logging/hive/schemas/web-user_survey",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.UserSurveyLoggingTableRow=void 0;t.UserSurveyLoggingTableRow=class{constructor(e){this.category="web-user_survey",this.session_id=null,this.team_id=null,this.ua_browser_name=null,this.ua_browser_version=null,this.locale_user_selected=null,this.user_agent=null,this.active_user_id=null,this.user_id=null,this.event_name=e.event_name,this.user_survey_id=e.user_survey_id,this.extras=e.extras,Object.seal(this)}}}));
//# sourceMappingURL=pkg-browse-uncommon.min.js-vflhGUceB.map