'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[4],{1005:function(C,N,d){Object.defineProperty(N,"__esModule",{value:!0});N.globalThis=void 0;C=d(1190);N.globalThis=C},1017:function(C,N,d){function l(L,S=self){S.addEventListener("message",function T(P){if(P&&P.data){var {id:U,type:X,path:Y}=Object.assign({path:[]},P.data),ca=(P.data.Rdh||[]).map(u);try{const ua=Y.slice(0,-1).reduce((qa,ka)=>qa[ka],L),ra=Y.reduce((qa,ka)=>qa[ka],L);switch(X){case "GET":var da=
ra;break;case "SET":ua[Y.slice(-1)[0]]=u(P.data.value);da=!0;break;case "APPLY":da=ra.apply(ua,ca);break;case "CONSTRUCT":const qa=new ra(...ca);da=Object.assign(qa,{[B]:!0});break;case "ENDPOINT":const {port1:ka,port2:la}=new MessageChannel;l(L,la);da=n(ka,[ka]);break;case "RELEASE":da=void 0;break;default:return}}catch(ua){da={value:ua,[K]:0}}Promise.resolve(da).catch(ua=>({value:ua,[K]:0})).then(ua=>{const [ra,qa]=v(ua);S.postMessage(Object.assign(Object.assign({},ra),{id:U}),qa);"RELEASE"===X&&
(S.removeEventListener("message",T),"MessagePort"===S.constructor.name&&S.close())})}});S.start&&S.start()}function e(L){if(L)throw Error("Proxy has been released and is not useable");}function a(L,S=[],E=function(){}){let P=!1;const T=new Proxy(E,{get(U,X){e(P);if(X===F)return()=>t(L,{type:"RELEASE",path:S.map(Y=>Y.toString())}).then(()=>{"MessagePort"===L.constructor.name&&L.close();P=!0});if("then"===X){if(0===S.length)return{then:()=>T};U=t(L,{type:"GET",path:S.map(Y=>Y.toString())}).then(u);
return U.then.bind(U)}return a(L,[...S,X])},set(U,X,Y){e(P);const [ca,da]=v(Y);return t(L,{type:"SET",path:[...S,X].map(ua=>ua.toString()),value:ca},da).then(u)},apply(U,X,Y){e(P);U=S[S.length-1];if(U===G)return t(L,{type:"ENDPOINT"}).then(u);if("bind"===U)return a(L,S.slice(0,-1));const [ca,da]=k(Y);return t(L,{type:"APPLY",path:S.map(ua=>ua.toString()),Rdh:ca},da).then(u)},construct(U,X){e(P);const [Y,ca]=k(X);return t(L,{type:"CONSTRUCT",path:S.map(da=>da.toString()),Rdh:Y},ca).then(u)}});return T}
function k(L){L=L.map(v);return[L.map(S=>S[0]),Array.prototype.concat.apply([],L.map(S=>S[1]))]}function n(L,S){I.set(L,S);return L}function v(L){for(const [S,E]of H)if(E.Ojh(L)){const [P,T]=E.serialize(L);return[{type:"HANDLER",name:S,value:P},T]}return[{type:"RAW",value:L},I.get(L)||[]]}function u(L){switch(L.type){case "HANDLER":return H.get(L.name).deserialize(L.value);case "RAW":return L.value}}function t(L,S,E){return new Promise(P=>{const T=y();L.addEventListener("message",function Y(X){X.data&&
X.data.id&&X.data.id===T&&(L.removeEventListener("message",Y),P(X.data))});L.start&&L.start();L.postMessage(Object.assign({id:T},S),E)})}function y(){return Array(4).fill(0).map(()=>Math.floor(Math.random()*Number.MAX_SAFE_INTEGER).toString(16)).join("-")}C=d(0);const B=Symbol("Comlink.proxy"),G=Symbol("Comlink.endpoint"),F=Symbol("Comlink.releaseProxy"),K=Symbol("Comlink.thrown"),O=L=>"object"===typeof L&&null!==L||"function"===typeof L,H=new Map([["proxy",{Ojh:L=>O(L)&&L[B],serialize(L){const {port1:S,
port2:E}=new MessageChannel;l(L,S);return[E,[E]]},deserialize(L){L.start();return a(L,[],void 0)}}],["throw",{Ojh:L=>O(L)&&K in L,serialize({value:L}){return[L instanceof Error?{cfa:!0,value:{message:L.message,name:L.name,stack:L.stack}}:{cfa:!1,value:L},[]]},deserialize(L){if(L.cfa)throw Object.assign(Error(L.value.message),L.value);throw L.value;}}]]),I=new WeakMap;d.d(N,"a",function(){return J});class J{static Ztj(L){J.N6a=L;J.v_j=a(L,[],void 0)}static get Endpoint(){return J.N6a}static get $tj(){return J.v_j}}
Object(C.a)(J,"WorkerUtils",null,[])},1033:function(C,N,d){d.d(N,"a",function(){return l});C=d(0);class l{}Object(C.a)(l,"WaterlineOverrideSettings",null,[])},1034:function(C,N,d){function l(y){return{scriptUrl:y,insideInitName:"window.UlsWorkerService.ulsWorkerInsideInit"}}d.r(N);d.d(N,"UlsWorkerService",function(){return u});d.d(N,"ulsWorkerInsideInit",function(){return t});d.d(N,"ulsWorkerInsideScript",function(){return l});C=d(0);var e=d(848),a=d(977),k=d(22),n=d(2),v=d(855);class u{constructor(y,
B,G,F,K){this.GYj=new a.a(y,B,G,F,K)}HW(y){this.GYj.HW(y)}}Object(C.a)(u,"UlsWorkerService",null,[]);const t=({config:y,connection:B})=>{"Thread"===B.createMode&&e.setConfig(y);y=k.a.instance.Pa("Common.IRefreshableAppSettings");const G=new u(v.a.Lyd,!0,n.AFrameworkApplication.Xe,null!==y&&void 0!==y?y:n.AFrameworkApplication.K,y);return e.Endpoint.g0e(B,()=>G)}},1035:function(C,N,d){C=d(0);var l=d(448),e=d(544),a=d(684),k=d(245);class n extends k.a{constructor(){super();this.LowWaterline=this.HighWaterline=
this.FileId=null}Wl(){return 97}static I9(G,F,K){const O=new n;O.FileId=G;O.HighWaterline=F;O.LowWaterline=K;return O}}Object(C.a)(n,"GetActivitiesRequest",k.a,[]);class v extends k.a{constructor(G,F,K){super();this.Settings=this.Waterline=this.FileId=null;this.FileId=G;this.Waterline=F;this.Settings=K}Wl(){return 107}static I9(G,F,K){return new v(G,F,K)}}Object(C.a)(v,"GetRelevantActivitiesRequest",k.a,[]);class u extends k.a{constructor(G,F){super();this.WaterlineOverrideSettings=this.FileId=null;
this.FileId=G;this.WaterlineOverrideSettings=F}Wl(){return 96}static I9(G,F){return new u(G,F)}}Object(C.a)(u,"GetWywaActivitiesRequest",k.a,[]);class t{}Object(C.a)(t,"RelevantActivitiesSettings",null,[]);class y extends k.a{constructor(){super();this.FileId=null}Wl(){return 109}static I9(G){const F=new y;F.FileId=G;return F}}Object(C.a)(y,"UpdateWaterlineRequest",k.a,[]);d.d(N,"a",function(){return B});class B{constructor(G,F,K,O,H){this.ZMj=G;this.Ikd=F;this.GEe=K;this.rnb=O;this.rxg=H}requestWYWAActivities(G){G=
u.I9(this.Ikd(),G);return l.a.then(this.W9(G,"wywa"),F=>F)}requestActivities(G,F){G=n.I9(this.Ikd(),G,F);return l.a.then(this.W9(G,"activities"),K=>K)}Qvn(){const G=y.I9(this.Ikd());return l.a.then(this.W9(G,"waterline"),F=>F)}requestRelevantActivities(G,F){F=Object.assign(new t,{FirstDocumentOpen:F,MockDataEnabled:!1});G=v.I9(this.Ikd(),G,F);return l.a.then(this.W9(G,"relevant"),K=>K)}updateActivityState(G){return l.a.j2c(this.rxg,F=>F.ggo(G.itemIds,G.activityStatesToSet,G.activityStatesToReset,
G.resetUnseenCount))}requestActivityFeed(){return l.a.j2c(this.rxg,G=>G.getActivityFeed(null))}W9(G,F){const K={"Content-Type":"application/json; charset=utf-8"};return l.a.then(l.a.j2c(this.ZMj,O=>O.gy(this.GEe,K,e.a.nqh(G,this.rnb),F)),O=>{if(!(O&&O.args&&O.args.data&&O.args.data.Ge))return null;({group:O}=a.a.M7(O.args.data.Ge));return O&&O.Responses&&O.Responses.length?O.Responses[0]:null})}}Object(C.a)(B,"SharedActivityRepository",null,[])},1190:function(C,N,d){C.exports=d(1191)()?globalThis:
d(1192)},1191:function(C){C.exports=function(){return"object"===typeof globalThis&&globalThis?globalThis.Array===Array:!1}},1192:function(C){function N(){if("object"===typeof self&&self)return self;if("object"===typeof window&&window)return window;throw Error("Unable to resolve global `this`");}C.exports=function(){if(this)return this;try{Object.defineProperty(Object.prototype,"__global__",{get:function(){return this},configurable:!0})}catch(d){return N()}try{return __global__?__global__:N()}finally{delete Object.prototype.SAo}}()},
1193:function(C,N,d){Object.defineProperty(N,"__esModule",{value:!0});N.spi=void 0;var l=d(921);N.spi=function(e){return function(a){var k=e[a];switch(typeof k){case "boolean":return(0,l.getBooleanFeatureGate)(a,k);case "number":return(0,l.hVh)(a,k);case "string":return(0,l.getStringFeatureGate)(a,k);default:throw Error("Wrong defaultValue type");}}}},1194:function(C,N,d){Object.defineProperty(N,"__esModule",{value:!0});N.xpi=void 0;var l=d(922);N.xpi=function(){return function(e){return(0,l.isChangeGateEnabled)(e)}}},
1195:function(C,N,d){function l(k){var n=(0,a.CXf)(void 0);(0,a.CXf)(function(){var v=void 0!==n?n():{};return e.__assign(e.__assign({},v),k)});return n}Object.defineProperty(N,"__esModule",{value:!0});N.m0m=N.k0m=void 0;var e=d(79),a=d(922);N.k0m=l;N.m0m=function(k,n){return l(n)}},1196:function(C,N,d){function l(k){function n(){return{}}for(var v,u,t={},y=0,B=Object.keys(k);y<B.length;y++){var G=B[y];t[G]=null===(v=k[G])||void 0===v?void 0:v.toString()}var F=null!==(u=(0,a.VXf)(void 0))&&void 0!==
u?u:n;(0,a.VXf)(function(){return e.__assign(e.__assign({},F()),t)});return F}Object.defineProperty(N,"__esModule",{value:!0});N.n0m=N.l0m=void 0;var e=d(79),a=d(921);N.l0m=l;N.n0m=function(k,n){return l(n)}},1392:function(C,N,d){d.d(N,"a",function(){return e});var l;(function(a){a[a.Unknown=0]="Unknown";a[a.Nxo=1]="Inference"})(l||(l={}));var e;(function(a){a[a.Unknown=0]="Unknown";a[a.gAo=1]="VoiceDictationBadge";a[a.hAo=2]="VoiceDictationPhrase"})(e||(e={}))},1490:function(C,N,d){d.r(N);d.d(N,
"Box4PasteSteward",function(){return ca});C=d(0);var l=d(22),e=d(2),a=d(16),k=d(130),n=d(58),v=d(5),u=d(8),t=d(31),y=d(76),B=d(9),G=d(140),F=d(11),K=d(3),O=d(20),H=d(6),I=d(64),J=d(231),L=d(40),S=d(92),E=d(43),P=d(48),T=d(34),U=d(478),X=d(476),Y=d(1698);class ca extends Y.a{constructor(da,ua,ra,qa,ka,la,Ha,wa=null,Ca=null){super(da,Ha,wa,Ca);this._formatting=null;this.XGa=!1;this.Vpb=null;this.YQb=-1;this.Brb=0;this.twc=new y.a;this.OFm=4294967295;t.a(4223754,307,E.OutlineElementReader.Nh(da));this.aqb=
ua;this.aqb.cYb(this);this.$K=ra;this.$K.cYb(this);this.qp=qa;this.Ko=ka;this.UCm=la;this.uCe=I.ListReader.ai(this.Bc);ca.M3l();ca.y3l();ca.g4l()}get zta(){return null!=this.bng?this.bng:this.bng=l.a.instance.Pa("Box4.IInternalLinkManager")}get kyd(){return this._formatting}get SZb(){return this.uCe&&!this.$K.bAa}get Qxb(){return 0<this.Brb}reset(){super.reset();this._formatting=this.idf(!1)}TQe(da){t.a(4223762,307,E.OutlineElementReader.Nh(this.Bc)||S.OutlineReader.xw(this.Bc));this.S9b(!1);var ua=
new H.GraphIterator;ua.fd(this.Bc);da=Y.a.Wg.zN(this.Bc,this.PIc(da));this.dsd(ua,!1);t.a(4223763,307,da===this.Bc.currentNode);t.a(4223764,307,F.ParagraphReader.nc(da));-1!==this._formatting.Zs&&ca.paragraphEditor.sD(da,this._formatting.Zs);if(ca.paragraphEditor.qp&&!this.j0.P3i){if(this._formatting.textIndent){({unit:ka,returnValue:qa}=ca.SUc(this._formatting.textIndent));var ra=!1;if(qa||!I.ListReader.sZ){if(0>qa){ra=!0;var qa=-1*qa}var ka=ca.Swd(qa,ka);ra?ca.paragraphEditor.qp.mkb(da,ka):ca.paragraphEditor.qp.$aa(da,
ka)}}!this._formatting.marginLeft||ca.ae.zDb||I.ListReader.ai(ua)||({unit:ua,returnValue:ra}=ca.SUc(this._formatting.marginLeft),ua=ca.Swd(ra,ua),ca.paragraphEditor.qp.Iva(da,1,ua))}(ca.Qd.ng||O.a.instance.J(3)&&B.App.Cv.Jgc)&&da.setValue(v.a.lDb,!0);this._formatting.lineSpacing&&ca.paragraphEditor.hC(da,this._formatting.lineSpacing);if(this._formatting.Mfc){ua=[];ra=[];ka=[];qa=this._formatting.Mfc.split(" ");let wa=1,Ca=0;for(let Ja=0;Ja<qa.length;Ja++){var la=ca.VFk(qa[Ja]),Ha=ca.UFk(qa[Ja]);if(-1!==
la)wa=la;else if(-1!==Ha)Ca=Ha;else{({unit:la,returnValue:Ha}=ca.SUc(qa[Ja]));la=ca.Swd(Ha,la);if(0<=la&&la<=this.OFm)ua.push(la),ra.push(wa),ka.push(Ca);else{t.b(555103310,307,15,"Invalid custom tab value. tabStops: "+this._formatting.Mfc+" index: "+Ja);break}wa=1;Ca=0}}0<ua.length&&ca.paragraphEditor.e2j(da,ua,ra,ka)}this._formatting.paragraph=da;this.XGa=!0}dsd(da,ua){t.a(8128518,307,!ua);this.iU&&(0<this.iU&&this.qp.KDc(da,this.iU),0>this.iU&&this.qp.rOa(da,this.iU,0));da&&this.Ko.a7d(da,this.Qxb);
this.iU=0}sbe(da){this.twc.add(da)}WWe(){this.iU=0}Baa(da,ua=null){t.a(4223772,307,F.ParagraphReader.zh(this.Bc));const ra=this.Bc.currentNode;this._formatting.I6f(ra);if(!this.j0.R6f(this.Bc,ua,!1)){var qa=ra.qa.last,ka=T.a.ow(ra);this.XGa&&(qa.formatting=this._formatting.QP.Yf(qa),O.a.instance.J(6)&&ra.wn(),this.XGa=!1);da=this.j0.kkf(da,ua);this.j0.oEa(this.Bc.currentNode,this._formatting.Iaa,ua);this.characterPropertiesEditor.replaceTextRange(ka,da,void 0,void 0,K.a.paste)}}aDa(da){this.j0.JPd&&
this.j0.HOd(da)?(this.LF(),this.MF(da)):(t.a(4223773,307,F.ParagraphReader.zh(this.Bc)),da=T.a.ow(this.Bc.currentNode),this.characterPropertiesEditor.Uea(da,ua=>new U.a(ua)))}tib(){this.j0.pkf(this.Bc)}Gua(da){if(ca.RZk(da)){const ua=this.Bc.currentNode;F.ParagraphReader.nc(ua)&&(ua.Nac=da.r8e)}else this.aqb.Gua(da)}XCa(da){this._formatting=da;this.XGa=!0}PNa(da){t.a(4223774,307,F.ParagraphReader.zh(this.Bc));t.a(4223775,307,!this.Vpb);t.a(4223776,307,0>this.YQb);this.Vpb=da;this.YQb=F.ParagraphReader.textLength(this.Bc.currentNode)}ONa(){t.a(4223777,
307,F.ParagraphReader.zh(this.Bc));t.a(4223778,307,!!this.Vpb);t.a(4223779,307,0<=this.YQb);let da=T.a.createTextRange(this.Bc.currentNode,this.YQb,F.ParagraphReader.textLength(this.Bc.currentNode)),ua="",ra="";this.zta&&({CRf:ua,xKh:ra}=this.zta.K6f(G.HyperlinkReader.FLa(this.Vpb))).returnValue&&(this.Vpb=ua,ra&&(this.characterPropertiesEditor.replaceTextRange(da,ra),da=T.a.createTextRange(this.Bc.currentNode,this.YQb,F.ParagraphReader.textLength(this.Bc.currentNode))));ca.hyperlinkEditor.NG(da,
this.Vpb,!1);this.XGa=!0;this.Vpb=null;this.YQb=-1}MF(da){this.TQe(da);this._formatting.Hbe(this.Bc.currentNode);this.j0.oEa(this.Bc.currentNode,this._formatting.Iaa,da)}LF(){t.a(4223808,307,F.ParagraphReader.zh(this.Bc));ca.hyperlinkEditor.S2k(this.Bc.currentNode);L.OutlineElementNavigator.Zd(this.Bc)}qib(){}pib(){}UNa(){}Y0a(){}dDa(){t.a(4223809,307,E.OutlineElementReader.Nh(this.Bc)||S.OutlineReader.xw(this.Bc));let da=!1;this.Qxb||(da=this.SZb||!0);da||(this.iU+=1);this.Brb++}bDa(){this.Brb--;
let da=!1;this.Qxb||(da=this.SZb||!0,this.Ko.fSf(this.twc));da||--this.iU}TNa(da){t.a(4223810,307,E.OutlineElementReader.Nh(this.Bc)||S.OutlineReader.xw(this.Bc));t.a(4223811,307,!!da.listStyleType);this.Ko.$6d(this.Krm(da))}cDa(){t.a(4223813,307,E.OutlineElementReader.Nh(this.Bc));e.AFrameworkApplication.Hl("Microsoft.Office.Web.SessionSettings.IWacWordQoEListExternalPasteImprovementSettings");if(ca.ae.zDb&&I.ListReader.ai(this.Bc)){const da=F.ParagraphReader.en(this.Bc.currentNode),ua=this.UCm.zAb(this.Bc);
X.a.ae.RL||this.Ko.Z6d(ua,da,null)}}a1a(da){this.aqb.a1a(da)}Aaa(da){this.$K.Aaa(da)}xaa(){this.$K.xaa()}zaa(da){this.$K.zaa(da)}yaa(){this.$K.yaa()}waa(da){this.$K.waa(da)}vaa(){this.$K.vaa()}static get paragraphEditor(){return null!=ca.opg?ca.opg:ca.opg=l.a.instance.resolve("Box4.IParagraphEditor")}static get hyperlinkEditor(){return null!=ca.Zkg?ca.Zkg:ca.Zkg=l.a.instance.resolve("Box4.IHyperlinkEditor")}static get Qd(){return null!=ca.msg?ca.msg:ca.msg=l.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance}static get E$f(){return null!=
ca.Psg?ca.Psg:ca.Psg=l.a.instance.resolve("Box4.Styles.IWACStyleReader")}static get Ffc(){return ca.SIe}static set Ffc(da){ca.SIe=da}static get ae(){return J.a.getInstance()}static M3l(){const da=O.a.instance.J(8);ca.n1a[1]=da?P.StyleReader.wordStyleIdHeading1:P.StyleReader.styleIdHeading1;ca.n1a[2]=da?P.StyleReader.wordStyleIdHeading2:P.StyleReader.styleIdHeading2;ca.n1a[3]=da?P.StyleReader.wordStyleIdHeading3:P.StyleReader.styleIdHeading3;ca.n1a[4]=da?P.StyleReader.D4a:P.StyleReader.Qva;ca.n1a[5]=
da?P.StyleReader.E4a:P.StyleReader.UPa;ca.n1a[6]=da?P.StyleReader.F4a:P.StyleReader.VPa;ca.n1a[7]=da?null:P.StyleReader.s3a}static y3l(){ca.fua.unspecified=0;ca.fua.defaultUnordered=1;ca.fua.defaultOrdered=1;ca.fua.none=0;ca.fua.disc=1;ca.fua.circle=2;ca.fua.square=3;ca.fua.decimal=1;ca.fua.lowerAlpha=2;ca.fua.lowerRoman=3;ca.fua.upperAlpha=4;ca.fua.upperRoman=5}static g4l(){ca.SIe=ca.E$f.Kp()}static VFk(da){let ua=-1;if(!da)return ua;da=da.toLowerCase();switch(da){case "left":ua=1;break;case "center":ua=
3;break;case "right":ua=4;break;case "decimal":ua=6;break;case "bar":ua=7}return ua}static UFk(da){let ua=-1;if(!da)return ua;da=da.toLowerCase();switch(da){case "blank":ua=0;break;case "dotted":ua=1;break;case "dashed":ua=2;break;case "lined":ua=3}return ua}static exb(da){const ua=a.a.substring(da,0,2),ra=a.a.substring(da,2,4);return a.a.substring(da,4,6)+ra+ua}static SUc(da){let ua=0;const ra=da.length;var qa=a.a.substring(da,0,ra-2);qa=parseFloat(qa);da=a.a.substr(da,ra-2,2);switch(da){case "in":ua=
3;break;case "px":ua=7;break;case "cm":ua=1;break;case "pt":ua=5;break;default:u.ULS.sendTraceTag(8208450,307,50,"Pasted DOM with unrecognized css length unit {0}, will default to UnitType.None and value 0",da),qa=0}return{returnValue:qa,unit:ua}}static Swd(da,ua){let ra=0;switch(ua){case 3:ra=k.a.BA(da);break;case 7:ra=n.a.Wy(da,0);break;case 1:ra=k.a.XVe(da);break;case 5:ra=k.a.BA(k.a.FLf(da));break;default:u.ULS.sendTraceTag(8208451,307,50,"ConvertToTwips unable to convert inputValue {0} and inputUnit {1} to twips, returning 0",
da,ua)}return ra}static RZk(da){return!!da&&!!da.r8e&&""!==da.r8e}}ca.n1a=Array(8);ca.fua={};ca.SIe=null;Object(C.a)(ca,"Box4PasteSteward",Y.a,[])},1513:function(C,N,d){C=d(0);var l=d(2),e=d(1905),a=d(8);const k=(v,u)=>{const t={};let y=null;switch(v){case 0:y="HtmlProcessor";var B=u.a;null!=B&&(t.SessionID=B);var G=u.b.toString();null!=G&&(t.Elements=G);var F=u.c.toString();null!=F&&(t.PrunedElements=F);var K=u.d.toString();null!=K&&(t.TransparentElements=K);var O=u.e.toString();null!=O&&(t.VoidElements=
O);var H=u.f.toString();null!=H&&(t.UnknownElements=H);break;case 1:y="WordConverter";var I=u.a;null!=I&&(t.SessionID=I);var J=u.b.toString();null!=J&&(t.BulletsConverted=J);var L=u.c.toString();null!=L&&(t.NumberedConverted=L);break;case 2:y="FormattingSteward";var S=u.a;null!=S&&(t.SourceApp=S);var E=u.b;null!=E&&(t.Browser=E);var P=u.c;null!=P&&(t.OperationId=P);var T=u.d.toString();null!=T&&(t.Lang=T);var U=u.e.toString();null!=U&&(t.TextDir=U);var X=u.f.toString();null!=X&&(t.Bold=X);var Y=u.g.toString();
null!=Y&&(t.Math=Y);var ca=u.h.toString();null!=ca&&(t.Italics=ca);var da=u.i.toString();null!=da&&(t.Underline=da);var ua=u.j.toString();null!=ua&&(t.Strikethrough=ua);var ra=u.k.toString();null!=ra&&(t.Subscript=ra);var qa=u.l.toString();null!=qa&&(t.Superscript=qa);var ka=u.m.toString();null!=ka&&(t.Fontsize=ka);var la=u.n.toString();null!=la&&(t.Fontface=la);var Ha=u.o.toString();null!=Ha&&(t.GrowFontsize=Ha);var wa=u.p.toString();null!=wa&&(t.ShrinkFontsize=wa);var Ca=u.q.toString();null!=Ca&&
(t.FontColor=Ca);var Ja=u.r.toString();null!=Ja&&(t.FontHighlight=Ja);var bb=u.s.toString();null!=bb&&(t.ParagraphStyle=bb);var ha=u.t.toString();null!=ha&&(t.TextAlign=ha);var ia=u.u.toString();null!=ia&&(t.TextIndent=ia);var va=u.v.toString();null!=va&&(t.MarginLeft=va);var Ka=u.w.toString();null!=Ka&&(t.ParagraphSpaceBefore=Ka);var Xa=u.x.toString();null!=Xa&&(t.ParagraphSpaceAfter=Xa);var xa=u.y.toString();null!=xa&&(t.LineSpace=xa);var Ma=u.z.toString();null!=Ma&&(t.CellShadingColor=Ma);var Na=
u.ba.toString();null!=Na&&(t.StyleDefinition=Na);var pa=u.bb.toString();null!=pa&&(t.TabStops=pa);break;case 3:y="SemanticEvents";var Ra=u.a;null!=Ra&&(t.SessionID=Ra);var Sa=u.b.toString();null!=Sa&&(t.Text=Sa);var ab=u.c.toString();null!=ab&&(t.LineBreak=ab);var eb=u.d.toString();null!=eb&&(t.Image=eb);var zb=u.e.toString();null!=zb&&(t.File=zb);var Ua=u.f.toString();null!=Ua&&(t.FormattingChange=Ua);var Ab=u.g.toString();null!=Ab&&(t.Anchor=Ab);var mb=u.h.toString();null!=mb&&(t.Paragraph=mb);
var Rb=u.i.toString();null!=Rb&&(t.Math=Rb);var hc=u.j.toString();null!=hc&&(t.List=hc);var Hb=u.k.toString();null!=Hb&&(t.ListItem=Hb);var Ta=u.l.toString();null!=Ta&&(t.RenderAugmentation=Ta);var Aa=u.m.toString();null!=Aa&&(t.Span=Aa);break;case 4:y="SemanticTableEvents";var ma=u.a;null!=ma&&(t.SessionID=ma);var Ga=u.b.toString();null!=Ga&&(t.Tables=Ga);var Fa=u.c.toString();null!=Fa&&(t.TableRow=Fa);var ib=u.d.toString();null!=ib&&(t.TableCell=ib);var ob=u.e.toString();null!=ob&&(t.TablePart=
ob);break;case 5:y="HtmlEvents";var fb=u.a;null!=fb&&(t.OperationId=fb);var Mb=u.b;null!=Mb&&(t.SourceApp=Mb);var Tb=u.c;null!=Tb&&(t.Browser=Tb);var rc=null==u.d?null:u.d.toString();null!=rc&&(t.Text=rc);var vb=null==u.e?null:u.e.toString();null!=vb&&(t.A=vb);var Ya=null==u.f?null:u.f.toString();null!=Ya&&(t.Abbr=Ya);var wb=null==u.g?null:u.g.toString();null!=wb&&(t.Acronym=wb);var jb=null==u.h?null:u.h.toString();null!=jb&&(t.Address=jb);var Zb=null==u.i?null:u.i.toString();null!=Zb&&(t.Applet=
Zb);var Eb=null==u.j?null:u.j.toString();null!=Eb&&(t.Area=Eb);var tc=null==u.k?null:u.k.toString();null!=tc&&(t.B=tc);var lc=null==u.l?null:u.l.toString();null!=lc&&(t.Base=lc);var Lc=null==u.m?null:u.m.toString();null!=Lc&&(t.Basefont=Lc);var Bb=null==u.n?null:u.n.toString();null!=Bb&&(t.Bdo=Bb);var jc=null==u.o?null:u.o.toString();null!=jc&&(t.Big=jc);var dc=null==u.p?null:u.p.toString();null!=dc&&(t.Blockquote=dc);var nb=null==u.q?null:u.q.toString();null!=nb&&(t.Body=nb);var Gb=null==u.r?null:
u.r.toString();null!=Gb&&(t.Br=Gb);var lb=null==u.s?null:u.s.toString();null!=lb&&(t.Button=lb);var Kb=null==u.t?null:u.t.toString();null!=Kb&&(t.Caption=Kb);var Vb=null==u.u?null:u.u.toString();null!=Vb&&(t.Center=Vb);var vc=null==u.v?null:u.v.toString();null!=vc&&(t.Cite=vc);var Fc=null==u.w?null:u.w.toString();null!=Fc&&(t.Code=Fc);var Zc=null==u.x?null:u.x.toString();null!=Zc&&(t.Col=Zc);var td=null==u.y?null:u.y.toString();null!=td&&(t.Colgroup=td);var xd=null==u.z?null:u.z.toString();null!=
xd&&(t.Dd=xd);var le=null==u.ba?null:u.ba.toString();null!=le&&(t.Del=le);var Yc=null==u.bb?null:u.bb.toString();null!=Yc&&(t.Dfn=Yc);var xc=null==u.bc?null:u.bc.toString();null!=xc&&(t.Dir=xc);var md=null==u.bd?null:u.bd.toString();null!=md&&(t.Div=md);var Ie=null==u.be?null:u.be.toString();null!=Ie&&(t.Dl=Ie);var Te=null==u.bf?null:u.bf.toString();null!=Te&&(t.Dt=Te);var rf=null==u.bg?null:u.bg.toString();null!=rf&&(t.Em=rf);var ke=null==u.bh?null:u.bh.toString();null!=ke&&(t.Fieldset=ke);var xe=
null==u.bi?null:u.bi.toString();null!=xe&&(t.Font=xe);var zf=null==u.bj?null:u.bj.toString();null!=zf&&(t.Form=zf);var $c=null==u.bk?null:u.bk.toString();null!=$c&&(t.Frame=$c);var Hg=null==u.bl?null:u.bl.toString();null!=Hg&&(t.Frameset=Hg);var Rc=null==u.bm?null:u.bm.toString();null!=Rc&&(t.H=Rc);var Ed=null==u.bn?null:u.bn.toString();null!=Ed&&(t.Head=Ed);var Yd=null==u.bo?null:u.bo.toString();null!=Yd&&(t.Hr=Yd);var Zf=null==u.bp?null:u.bp.toString();null!=Zf&&(t.Html=Zf);var Hc=null==u.bq?null:
u.bq.toString();null!=Hc&&(t.I=Hc);var sc=null==u.br?null:u.br.toString();null!=sc&&(t.Iframe=sc);var pd=null==u.bs?null:u.bs.toString();null!=pd&&(t.Img=pd);var Ub=null==u.bt?null:u.bt.toString();null!=Ub&&(t.Input=Ub);var uc=null==u.bu?null:u.bu.toString();null!=uc&&(t.Ins=uc);var Tc=null==u.bv?null:u.bv.toString();null!=Tc&&(t.Isindex=Tc);var qd=null==u.bw?null:u.bw.toString();null!=qd&&(t.Kbd=qd);var re=null==u.bx?null:u.bx.toString();null!=re&&(t.Label=re);var Je=null==u.by?null:u.by.toString();
null!=Je&&(t.Legend=Je);var Jf=null==u.bz?null:u.bz.toString();null!=Jf&&(t.Li=Jf);var Ig=null==u.ca?null:u.ca.toString();null!=Ig&&(t.Link=Ig);var pb=null==u.cb?null:u.cb.toString();null!=pb&&(t.Map=pb);var Lb=null==u.cc?null:u.cc.toString();null!=Lb&&(t.Math=Lb);var Ic=null==u.cd?null:u.cd.toString();null!=Ic&&(t.Menu=Ic);var Ad=null==u.ce?null:u.ce.toString();null!=Ad&&(t.Meta=Ad);var oe=null==u.cf?null:u.cf.toString();null!=oe&&(t.Noframes=oe);var gf=null==u.cg?null:u.cg.toString();null!=gf&&
(t.Noscript=gf);var Oe=null==u.ch?null:u.ch.toString();null!=Oe&&(t.Object=Oe);var Sg=null==u.ci?null:u.ci.toString();null!=Sg&&(t.Ol=Sg);var Ng=null==u.cj?null:u.cj.toString();null!=Ng&&(t.Optgroup=Ng);var Nh=null==u.ck?null:u.ck.toString();null!=Nh&&(t.Option=Nh);var Eg=null==u.cl?null:u.cl.toString();null!=Eg&&(t.P=Eg);var Wh=null==u.cm?null:u.cm.toString();null!=Wh&&(t.Param=Wh);var Bf=null==u.cn?null:u.cn.toString();null!=Bf&&(t.Pre=Bf);var vf=null==u.co?null:u.co.toString();null!=vf&&(t.Q=vf);
var Fj=null==u.cp?null:u.cp.toString();null!=Fj&&(t.S=Fj);var Pe=null==u.cq?null:u.cq.toString();null!=Pe&&(t.Samp=Pe);var sf=null==u.cr?null:u.cr.toString();null!=sf&&(t.Script=sf);var Xf=null==u.cs?null:u.cs.toString();null!=Xf&&(t.Select=Xf);var Se=null==u.ct?null:u.ct.toString();null!=Se&&(t.Small=Se);var $f=null==u.cu?null:u.cu.toString();null!=$f&&(t.Span=$f);var Jg=null==u.cv?null:u.cv.toString();null!=Jg&&(t.Strike=Jg);var fg=null==u.cw?null:u.cw.toString();null!=fg&&(t.Strong=fg);var Lg=
null==u.cx?null:u.cx.toString();null!=Lg&&(t.Style=Lg);var Af=null==u.cy?null:u.cy.toString();null!=Af&&(t.Sub=Af);var Jh=null==u.cz?null:u.cz.toString();null!=Jh&&(t.Sup=Jh);var Vi=null==u.da?null:u.da.toString();null!=Vi&&(t.Tables=Vi);var Ze=null==u.db?null:u.db.toString();null!=Ze&&(t.Tbody=Ze);var sd=null==u.dc?null:u.dc.toString();null!=sd&&(t.Td=sd);var fh=null==u.dd?null:u.dd.toString();null!=fh&&(t.Textarea=fh);var vh=null==u.de?null:u.de.toString();null!=vh&&(t.Tfoot=vh);var am=null==u.df?
null:u.df.toString();null!=am&&(t.Th=am);var aj=null==u.dg?null:u.dg.toString();null!=aj&&(t.Thead=aj);var nk=null==u.dh?null:u.dh.toString();null!=nk&&(t.Title=nk);var sk=null==u.di?null:u.di.toString();null!=sk&&(t.Tr=sk);var De=null==u.dj?null:u.dj.toString();null!=De&&(t.Tt=De);var Ai=null==u.dk?null:u.dk.toString();null!=Ai&&(t.U=Ai);var Mk=null==u.dl?null:u.dl.toString();null!=Mk&&(t.Ul=Mk);var pl=null==u.dm?null:u.dm.toString();null!=pl&&(t.Var=pl);var Og=null==u.dn?null:u.dn.toString();null!=
Og&&(t.Unknown=Og);break;case 6:y="List";var Rk=u.a;null!=Rk&&(t.SessionID=Rk);var xf=u.b.toString();null!=xf&&(t.MaxListLevel=xf)}t.Table=y;return Sys.Serialization.JavaScriptSerializer.serialize(t)};d.d(N,"a",function(){return n});class n{static get ema(){null==n.Cqb&&(n.Cqb=!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.$("UsageEditorLoggingIsDisabled"));return n.Cqb}static get Aei(){null==n.Lue&&(n.Lue=!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.$("WordUsageEditorLoggingIsEnabled"));
return n.Lue}static RZ(v){a.ULS.sendTraceTag(524038472,307,50,v)}static fSh(v){const u={};u.a=v;u.b=0;u.c=0;u.d=0;u.e=0;u.f=0;return u}static Uxm(v){n.ema||n.RZ(k(0,v))}static ANh(v){const u={};u._sessionID=v;return u}static ojf(v){const u={};u.a=v;u.b=0;u.c=0;return u}static yCm(v){n.ema||n.RZ(k(1,v))}static eSh(v,u){const t={};t.c=e.a[v];t.a=u;return t}static Txm(v,u){n.Aei&&v&&(v.b=u,n.RZ(k(5,v)))}static OYh(v){const u={};u.a=v;u.b=0;u.c=0;u.d=0;u.e=0;u.f=0;u.g=0;u.h=0;u.i=0;u.j=0;u.k=0;u.l=0;
u.m=0;return u}static bBm(v){n.ema||n.RZ(k(3,v))}static PYh(v){const u={};u.a=v;u.b=0;u.c=0;u.d=0;u.e=0;return u}static cBm(v){n.ema||n.RZ(k(4,v))}static lef(v,u){const t={};t.b=e.a[v];t.c=u;t.d=0;t.e=0;t.f=0;t.g=0;t.h=0;t.i=0;t.j=0;t.k=0;t.l=0;t.m=0;t.n=0;t.o=0;t.p=0;t.q=0;t.r=0;t.s=0;t.t=0;t.w=0;t.x=0;t.y=0;t.z=0;t.u=0;t.v=0;t.ba=0;t.bb=0;return t}static xxm(v,u){n.Aei&&v&&(v.a=u,n.RZ(k(2,v)))}static jyl(v){const u={};u.a=v;u.b=-1;return u}static yym(v){!n.ema&&v&&0<=v.b&&n.RZ(k(6,v))}}n.Cqb=null;
n.Lue=null;Object(C.a)(n,"UsageEditor",null,[])},1528:function(C,N,d){d.d(N,"a",function(){return a});C=d(0);var l=d(2),e=d(6);class a{static get Clb(){return!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.$("WordDesignerTelemetryPerConstructIsEnabled")}static xdb(k,n=!1){const v=e.GraphIterator.$a(k);v.vd();return(n?v.Rb(4):v.k6(4))?4:e.GraphIterator.$a(k).Bb(36)?16:e.GraphIterator.$a(k).Bb(14)?2:e.GraphIterator.$a(k).Bb(38)?32:1}}Object(C.a)(a,"ConstructTypeHelper",null,[])},1541:function(C,
N,d){d.d(N,"a",function(){return la});C=d(0);var l=d(22),e=d(58),a=d(130);N=d(77);var k=d(5),n=d(17),v=d(8),u=d(120),t=d(72),y=d(707),B=d(237),G=d(38),F=d(6),K=d(211),O=d(92),H=d(32),I=d(94),J=d(23),L=d(392),S=d(1490),E=d(228),P=d(271),T=d(706),U=d(14),X=d(49),Y=d(40),ca=d(131),da=d(43),ua=d(284),ra=d(152),qa=d(569),ka=d(57);class la{static get zZl(){return la.EGj}static get GZl(){return la.IGj}static get EZl(){return la.HGj}static get Tg(){return null!=la.Phg?la.Phg:la.Phg=E.ContextSetEditor.instance}static get Gk(){return null!=
la.grg?la.grg:la.grg=l.a.instance.resolve("Box4.ITableEditor")}static get iC(){return null!=la.Yqg?la.Yqg:la.Yqg=l.a.instance.Pa("Box4.Styles.ITableCellspacingReader")}static d$m(Ha,wa){const Ca=Ha.currentNode;J.forEachCell(Ha,wa.rowSpan,wa.colSpan,(Ja,bb,ha)=>{const ia=Ja.currentNode;ia!==Ca&&(ia.qg=!0,la.bzh(Ja),!ha&&1<=wa.colSpan&&(ia.colSpan=wa.colSpan),la.gZi(Ja,wa.bha,bb,ha,wa.rowSpan,wa.colSpan))})}static P$m(Ha,wa){J.forEachCell(Ha,wa.rowSpan,wa.colSpan,Ca=>{la.Udk(Ca);la.bzh(Ca)})}static Udk(Ha){Ha=
Ha.currentNode;Ha.qg=!0;Ha.F2=!0;Ha.Mkb=!0}static bzh(Ha){Ha&&(Ha.Rb(1),Object(u.a)(y.a,Ha.currentNode)&&Ha.Eg())}static xek(Ha,wa,Ca){0<wa&&(Ha=Object(t.a)(B.TableCellNode,Ha.currentNode))&&(Ha.width=Ca?wa:e.a.pn(wa,0))}static bdk(Ha,wa,Ca){if(Ha=Object(t.a)(L.TableNode,Ha.currentNode))0<wa&&(Ha.fe=e.a.Wy(wa,0)),0<Ca&&(Ha.ev=e.a.Wy(Ca,0))}static vek(Ha,wa){void 0!==wa&&null!==wa&&Ha.currentNode.properties.setValue(k.a.cha,la.GZl[wa+""])}static Tdk(Ha,wa){void 0!==wa&&null!==wa&&""!==wa&&(wa=parseInt(S.Box4PasteSteward.exb(wa),
16),Ha.currentNode.properties.setValue(n.a.ZH,wa))}static Y9j(Ha){if(Ha){if(v.ULS.sendTraceTag(520890260,3022,50,"Adjusting column width after paste."),Object(ka.a)("AdjustingColumnWidthAfterPaste",!0),16==Ha.type){var wa=new F.GraphIterator;wa.set(Ha);if(wa.Bb(14)){var Ca=I.a(wa),Ja=H.TableCellReader.WP(Ha);if(wa.kd(14)){Ha=wa.currentNode;var bb=G.TableReader.tea(wa),ha=Array.clone(bb);wa=G.TableReader.PGd(wa);var ia=0,va=0;for(var Ka=0;Ka<bb.length;Ka++)Ka>=Ca&&Ka<Ca+Ja?wa[Ka]>bb[Ka]&&(ia+=wa[Ka]-
bb[Ka],ha[Ka]=wa[Ka]):va+=bb[Ka]>wa[Ka]?bb[Ka]-wa[Ka]:0;(null==va||0>=va||isNaN(va))&&v.ULS.sendTraceTag(521187336,3022,50,"spaceAvailableToShrink is invalid");(null==ia||0>=ia||isNaN(ia))&&v.ULS.sendTraceTag(521187335,3022,50,"spaceToShrink is invalid");if(va<ia)for(Ca=0;Ca<bb.length;Ca++)ha[Ca]=wa[Ca];else for(Ka=0;Ka<bb.length;Ka++)if((Ka<Ca||Ka>=Ca+Ja)&&bb[Ka]>wa[Ka]){let Xa=(bb[Ka]-wa[Ka])/va;ha[Ka]-=Xa*ia;(null==ha[Ka]||0>=ha[Ka]||isNaN(ha[Ka]))&&v.ULS.sendTraceTag(521187334,3022,50,"Getting negative column width for scale {0}",
Xa)}Ca=ra.a.uba+(la.iC?la.iC.cta(Ha):0);for(bb=0;bb<ha.length;bb++)if(null==ha[bb]||0>=ha[bb]||isNaN(ha[bb]))v.ULS.sendTraceTag(521187333,3022,50,"Column width can not be negative."),ha[bb]=e.a.pn(Ca,0);Ha.Kx=ha}}}}else v.ULS.sendTraceTag(537997910,3022,15,"Table cell should not be null")}static iOl(Ha){var wa=new F.GraphIterator;wa.fd(Ha);if((Ha=K.OutlineNavigator.VUf(wa))&&O.OutlineReader.xw(wa)){wa=Ha.Og(k.a.Lo);const Ca=Ha.Og(k.a.marginLeft);Ha=Ha.Og(k.a.marginRight);return wa-Ca-Ha}return 0}static hjm(Ha){return!(void 0===
Ha||null===Ha||1===Ha)}static MHn(Ha,wa,Ca,Ja,bb){if(void 0===wa||null===wa||""!==wa){switch(wa){case "thin":wa=a.a.T_d(.25);break;case "initial":case "medium":wa=a.a.T_d(.5);break;case "thick":wa=a.a.T_d(1);break;default:wa=la.$Jl(wa,Ca,Ja)}bb.currentNode.properties.setValue(Ha,wa)}}static LHn(Ha,wa,Ca){void 0!==wa&&null!==wa&&wa&&Ca.currentNode.properties.setValue(Ha,la.EZl[wa+""])}static JHn(Ha,wa,Ca){void 0!==wa&&null!==wa&&""!==wa&&(wa=parseInt(S.Box4PasteSteward.exb(wa),16),Ca.currentNode.properties.setValue(Ha,
wa))}static $Jl(Ha,wa,Ca){let Ja=0;const bb=({unit:Ha}=S.Box4PasteSteward.SUc(Ha)).returnValue;switch(Ha){case 5:Ja=a.a.T_d(bb);break;case 1:Ja=a.a.Hsk(bb);break;case 3:Ja=a.a.d7h(bb);break;case 7:Ja=e.a.V4m(bb,Ca)}if(6===wa||7===wa||10===wa)Ja/=3;return Math.round(Ja)}static aKl(Ha,wa){let Ca=0;const Ja=({unit:Ha}=S.Box4PasteSteward.SUc(Ha)).returnValue;switch(Ha){case 5:Ca=a.a.$ua(Ja);break;case 1:Ca=a.a.WVe(Ja);break;case 3:Ca=a.a.IBa(Ja);break;case 7:Ca=e.a.pn(Ja,wa)}return Ca}static n6d(Ha,wa,
Ca,Ja,bb,ha,ia){if(bb&&(!ia||16===bb.Qe||ia||14!==bb.Qe)&&12!==Ca){if(ia)switch(Ja){case 5:Ja=k.a.tba;var va=k.a.Va;var Ka=k.a.Ta;var Xa=0;break;case 4:Ja=k.a.sba;va=k.a.qb;Ka=k.a.ob;Xa=1;break;case 0:Ja=k.a.qba;va=k.a.Ua;Ka=k.a.Sa;Xa=0;break;case 3:Ja=k.a.rba;va=k.a.pb;Ka=k.a.nb;Xa=1;break;default:return}else switch(Ja){case 5:Ja=k.a.C3a;va=k.a.eQa;Ka=k.a.ulb;Xa=0;break;case 4:Ja=k.a.B3a;va=k.a.dQa;Ka=k.a.tlb;Xa=1;break;case 0:Ja=k.a.z3a;va=k.a.bQa;Ka=k.a.rlb;Xa=0;break;case 3:Ja=k.a.A3a;va=k.a.cQa;
Ka=k.a.slb;Xa=1;break;default:return}void 0!==bb.currentNode&&null!==bb.currentNode&&(la.hjm(Ca)?(la.JHn(Ja,Ha,bb),la.LHn(va,Ca,bb),la.MHn(Ka,wa,Ca,Xa,bb)):ha||ia||bb.currentNode.properties.setValue(va,"nil"))}}static gZi(Ha,wa,Ca,Ja,bb,ha){Ja||(la.Tch(wa,Ha,!1,!1),la.qRe(wa,Ha,!0,!1));Ja===ha-1&&la.qRe(wa,Ha,!0,!1);Ca||la.tdh(wa,Ha,!0,!1);Ca===bb-1&&la.Bch(wa,Ha,!0,!1)}static Ach(Ha,wa,Ca,Ja){Ha&&(la.tdh(Ha,wa,Ca,Ja),la.qRe(Ha,wa,Ca,Ja),la.Bch(Ha,wa,Ca,Ja),la.Tch(Ha,wa,Ca,Ja))}static tdh(Ha,wa,Ca,
Ja){la.n6d(Ha.borderTopColor,Ha.borderTopWidth,Ha.borderTopStyle,5,wa,Ca,Ja)}static qRe(Ha,wa,Ca,Ja){la.n6d(Ha.borderRightColor,Ha.borderRightWidth,Ha.borderRightStyle,4,wa,Ca,Ja)}static Bch(Ha,wa,Ca,Ja){la.n6d(Ha.borderBottomColor,Ha.borderBottomWidth,Ha.borderBottomStyle,0,wa,Ca,Ja)}static Tch(Ha,wa,Ca,Ja){la.n6d(Ha.borderLeftColor,Ha.borderLeftWidth,Ha.borderLeftStyle,3,wa,Ca,Ja)}static o6d(Ha,wa,Ca){if(Ca&&16===Ca.Qe&&""!==Ha){switch(wa){case 3:wa=k.a.JEa;var Ja=0;break;case 2:wa=k.a.vO;Ja=1;
break;case 0:wa=k.a.HEa;Ja=0;break;case 1:wa=k.a.vM;Ja=1;break;default:return}(Ha=la.aKl(Ha,Ja))&&Ca.currentNode.properties.setValue(wa,Ha)}}static yck(Ha,wa){wa&&(la.oek(wa,Ha),la.Odk(wa,Ha),la.Eck(wa,Ha),la.mdk(wa,Ha))}static oek(Ha,wa){la.o6d(Ha.Bsk,3,wa)}static Odk(Ha,wa){la.o6d(Ha.Ask,2,wa)}static Eck(Ha,wa){la.o6d(Ha.ysk,0,wa)}static mdk(Ha,wa){la.o6d(Ha.zsk,1,wa)}static Jck(Ha,wa,Ca,Ja){var bb=0;const ha=Array(Ha.length);var ia=0;Ja&&(ia=(ia=a.a.m7f(la.iOl(wa)))?ia:1);for(Ja=0;Ja<Ha.length;Ja++)ha[Ja]=
0<ia?ia/100*Ha[Ja]:e.a.pn(Ha[Ja],0),bb+=ha[Ja];Ha=Ca.getValue(n.a.az);Ja=new F.GraphIterator;Ja.fd(wa);wa=0;if(H.TableCellReader.MZ(Ja)){if(Ha=J.returnToContainingCell(Ja))wa=Ha.width;ia=I.a(Ja);Ja=J.returnToContainingTable(Ja);if(-1!==ia&&ia<=Ja.Kx.length){let va=0;for(let Ka=ia;Ka<ia+Ha.colSpan&&Ka<Ja.Kx.length;Ka++)va+=Ja.Kx[Ka];wa=Math.min(wa,va);wa===va&&(wa-=e.a.pn(la.RKm,0))}}else if(Ha)for(ia=0;ia<Ha.length;ia++)wa+=Ha[ia];if(0<wa&&bb>wa&&bb)for(bb=wa/bb,wa=0;wa<ha.length;wa++)ha[wa]*=bb;
Ca.setValue(n.a.az,ha)}static Pdk(Ha,wa){Ha.currentNode.setValue(k.a.A_,e.a.pn(wa,1))}static COn(Ha){var wa,Ca;v.ULS.sendTraceTag(520890259,3022,50,"Setting selection info and bound");Object(ka.a)("SettingTableSelectionBounds",!0);var Ja=Ha.hb,bb=Ha.Rg;Ha=la.Tg.UP(bb,16);if(bb=la.Tg.uS(bb,14))if(bb=bb.node,!bb||14!==bb.type)v.ULS.sendTraceTag(537507990,306,15,"Table node must be present");else if(!Ha)v.ULS.sendTraceTag(537507991,306,15,"Cell context must be present");else{if(!((null===(Ca=null===
(wa=null===Ja||void 0===Ja?void 0:Ja.kb)||void 0===wa?void 0:wa.Ke)||void 0===Ca?0:Ca.Qa)&&Ja.kb.Ke.Qa.contextId===U.a.y_&&P.TableBorderSelectionCache.JLa()&&0<P.TableBorderSelectionCache.JLa().length)){P.TableBorderSelectionCache.pMc(bb);wa=P.TableBorderSelectionCache.n7;wa.leftMostColumnSelected=Number.MAX_SAFE_INTEGER;wa.rightMostColumnSelected=Number.MIN_SAFE_INTEGER;wa.topMostRowSelected=Number.MAX_SAFE_INTEGER;wa.bottomMostRowSelected=Number.MIN_SAFE_INTEGER;for(Ca=0;Ca<Ha.length;Ca++){if(Ha.getContext(Ca).contextId!==
U.a.tableCell)return;Ja=Ha.getContext(Ca).node;if(!H.TableCellReader.Rr(Ja)){var ha=new F.GraphIterator;ha.set(Ja);if(ha.Bb(14)&&J.getContainingTable(ha)===bb){ha.kd(14);ha=H.TableCellReader.RAa(ha,Ja);if(!ha)return;Array.add(P.TableBorderSelectionCache.JLa(),new T.a(Ja,ha.rowIndex,ha.ao,Ja.rowSpan,Ja.colSpan));wa.leftMostColumnSelected=Math.min(wa.leftMostColumnSelected,ha.ao);wa.rightMostColumnSelected=Math.max(wa.rightMostColumnSelected,ha.ao);wa.topMostRowSelected=Math.min(wa.topMostRowSelected,
ha.rowIndex);wa.bottomMostRowSelected=Math.max(wa.bottomMostRowSelected,ha.rowIndex)}}}P.TableBorderSelectionCache.n7=wa}}else v.ULS.sendTraceTag(537145810,306,15,"IP in table should be there")}static MUi(Ha){if(Ha&&14===Ha.type){v.ULS.sendTraceTag(520890258,3022,50,"Scaling Column Width");Object(ka.a)("ScalingColumnWidthForCCP",!0);var wa=new F.GraphIterator;wa.set(Ha);if(wa.vd()){var Ca=Ha.Kx,Ja=G.TableReader.PGd(wa),bb=J.returnToContainingCell(wa),ha=J.getContainingTable(wa);if(bb&&ha){var ia=
I.a(wa),va=H.TableCellReader.WP(bb);if(wa.kd(14)){var Ka=G.TableReader.tea(wa);wa=0;for(let Xa=ia;Xa<ia+va;Xa++)wa+=Ka[Xa];ia=ra.a.aQ(bb,ha,k.a.vM,k.a.za,0);bb=ra.a.aQ(bb,ha,k.a.vO,k.a.Aa,0);wa-=e.a.pn(ia+bb,0);(null==wa||0>=wa||isNaN(wa))&&v.ULS.sendTraceTag(521187332,3022,50,"Containing cell width is invalid for cell margins {0} & {1}",ia,bb);bb=0;for(ha=0;ha<Ca.length;ha++)bb+=Ca[ha];bb=wa/bb;(null==bb||0>=bb||isNaN(bb))&&v.ULS.sendTraceTag(521187331,3022,50,"scale is invalid");ha=0;for(ia=0;ia<
Ca.length;ia++)Ca[ia]*=bb,Ca[ia]<Ja[ia]&&(Ca[ia]=Ja[ia]),ha+=Ca[ia];ha>wa&&(Ca=Array.clone(Ja));Ja=ra.a.uba+(la.iC?la.iC.cta(Ha):0);for(wa=0;wa<Ca.length;wa++)if(null==Ca[wa]||0>=Ca[wa]||isNaN(Ca[wa]))v.ULS.sendTraceTag(521187330,3022,50,"Column width is invalid for inner table"),Ca[wa]=e.a.pn(Ja,0);Ja=new X.GraphTransaction(4);Ja.Db(Ha);Ha.Kx=Ca;Ja.dispose()}}}}else v.ULS.sendTraceTag(524932511,3022,15,"Table node should not be null")}static Aun(Ha){if(!Ha||!G.TableReader.Wtf(Ha)||1!=Ha.Jp())return v.ULS.sendTraceTag(525361986,
3022,50,"Outline iterator should contain a single table"),null;v.ULS.sendTraceTag(525361987,3022,50,"Pasting table over cell selection");Object(ka.a)("ReplaceTableContentForExternalPaste",!0);let wa=new F.GraphIterator;wa.set(Ha.currentNode);wa.Bb(14);Y.OutlineElementNavigator.De(wa);let Ca=new F.GraphIterator;Ca.set(Ha.currentNode);Ca.Bb(14);if(!Ca.kd(14)||!wa||14!=wa.currentNode.type)return null;if(Ha=J.getContainingTableCell(wa))if(Ha=H.TableCellReader.RAa(Ca,Ha)){if(P.TableBorderSelectionCache.eKc())var Ja=
this.uIl();else{Ja=G.TableReader.ag(wa.currentNode)-(G.TableReader.ag(Ca.currentNode)-Ha.rowIndex);var bb=G.TableReader.kh(wa.currentNode)-(G.TableReader.kh(Ca.currentNode)-Ha.ao);this.L4j(Ca,Ja,bb);Ja=new ua.a(Ha.ao,G.TableReader.kh(Ca.currentNode)-1,Ha.rowIndex,G.TableReader.ag(Ca.currentNode)-1)}if(!Ja)return null;bb=Ja.bottomMostRowSelected-Ja.topMostRowSelected+1;var ha=Ja.rightMostColumnSelected-Ja.leftMostColumnSelected+1;bb=Math.min(bb,G.TableReader.ag(wa.currentNode));ha=Math.min(ha,G.TableReader.kh(wa.currentNode));
for(let ia=0;ia<bb;ia++){J.moveToCell(Ca,ia+Ja.topMostRowSelected,Ja.leftMostColumnSelected);J.moveToCell(wa,ia,0);for(let va=0;va<ha;va++)ia==Ha.rowIndex-Ja.topMostRowSelected&&va==Ha.ao-Ja.leftMostColumnSelected||this.ksi(wa,Ca),J.moveToNextColumn(Ca),J.moveToNextColumn(wa);Ca.it(14);wa.it(14)}J.moveToCell(Ca,Ha.rowIndex,Ha.ao);Ha.rowIndex-Ja.topMostRowSelected<G.TableReader.ag(wa.currentNode)&&Ha.ao-Ja.leftMostColumnSelected<G.TableReader.kh(wa.currentNode)?J.moveToCell(wa,Ha.rowIndex-Ja.topMostRowSelected,
Ha.ao-Ja.leftMostColumnSelected):wa=null;this.ksi(wa,Ca);Ca.it(14);J.moveToCell(Ca,Ja.topMostRowSelected,Ja.leftMostColumnSelected);Ca.Xd();return Ca.currentNode}}static t3m(Ha){if(Ha&&G.TableReader.Wtf(Ha)&&1==Ha.Jp()){v.ULS.sendTraceTag(520890257,3022,50,"Pasting table below table");Object(ka.a)("PasteTableBelowTable",!0);var wa=new F.GraphIterator;wa.set(Ha.currentNode);Ha=ca.a.$a(Ha.currentNode);wa.qo()&&Ha.qo()&&(Y.OutlineElementNavigator.R2(Ha,!1,!0),da.OutlineElementReader.Nh(Ha)&&1==Ha.Jp()&&
(Y.OutlineElementNavigator.De(wa),Y.OutlineElementNavigator.De(Ha),wa&&Ha&&wa.currentNode!=Ha.currentNode&&G.TableReader.isTable(wa)&&G.TableReader.isTable(Ha)&&this.IHm(wa,Ha)&&(v.ULS.sendTraceTag(525361989,3022,50,"Pasting table below table"),wa.Eg(),wa.Eg())))}else v.ULS.sendTraceTag(525361988,3022,50,"Outline iterator should contain a single table")}static ksi(Ha,wa){if(wa&&H.TableCellReader.isTableCell(wa)){var Ca=wa.Jp();if(Ha&&H.TableCellReader.isTableCell(Ha)&&Ha.bD())for(;Ha.bD();)Ha.Xd(),
wa.Sf(Ha.currentNode,Ha.role),Ha.Eg();else Ca--;for(;0<Ca--;)wa.Xd(),wa.Eg()}}static IHm(Ha,wa){if(!G.TableReader.isTable(Ha)||!G.TableReader.isTable(wa))return!1;var Ca=G.TableReader.kh(Ha.currentNode),Ja=G.TableReader.kh(wa.currentNode);if(Ca!=Ja)return v.ULS.sendTraceTag(525361990,3022,50,"Number of columns in source and target table should be same"),!1;Ca=G.TableReader.ag(Ha.currentNode);Ja=G.TableReader.ag(wa.currentNode);let bb=new X.GraphTransaction(4);bb.Db(wa.currentNode);wa.currentNode.setValue(n.a.Sva,
Ca+Ja);for(bb.dispose();Ha.bD();){Ha.Xd();wa.Sf(Ha.currentNode,1);Ca=new F.GraphIterator;Ca.set(Ha.currentNode);Ha.Eg();Ca.Xd();do Ca.currentNode&&16==Ca.currentNode.type&&(Ca.currentNode.nL=wa.currentNode);while(Ca.Du())}return!0}static L4j(Ha,wa,Ca){la.uxa=qa.a.e3b;0<wa&&(J.moveToLastRow(Ha),v.ULS.sendTraceTag(523896290,307,50,"Begin insert rows: "+wa),this.Gk.insertRows(Ha,!1,wa,this.uxa),v.ULS.sendTraceTag(523896291,307,50,"Completed inserting rows."),Ha.kd(14));0<Ca&&(v.ULS.sendTraceTag(523896320,
307,50,"Begin insert columns: "+Ca),this.Gk.insertColumns(Ha,G.TableReader.kh(Ha.currentNode),!1,Ca,this.uxa),v.ULS.sendTraceTag(523896321,307,50,"Completed inserting columns."))}static uIl(){return P.TableBorderSelectionCache?P.TableBorderSelectionCache.n7:null}}la.RKm=8;la.Lxh="Table Grid";la.uxa=null;la.EGj=N.a.I3("MsoNormalTable","Normal Table","MsoTableGrid",la.Lxh,"MsoTableGridLight","Grid Table Light","MsoTable15Plain1","Plain Table 1","MsoTable15Plain2","Plain Table 2","MsoTable15Plain3",
"Plain Table 3","MsoTable15Plain4","Plain Table 4","MsoTable15Plain5","Plain Table 5","MsoTable15Grid1Light","Grid Table 1 Light","MsoTable15Grid1LightAccent1","Grid Table 1 Light Accent 1","MsoTable15Grid1LightAccent2","Grid Table 1 Light Accent 2","MsoTable15Grid1LightAccent3","Grid Table 1 Light Accent 3","MsoTable15Grid1LightAccent4","Grid Table 1 Light Accent 4","MsoTable15Grid1LightAccent5","Grid Table 1 Light Accent 5","MsoTable15Grid1LightAccent6","Grid Table 1 Light Accent 6","MsoTable15Grid2",
"Grid Table 2","MsoTable15Grid2Accent1","Grid Table 2 Accent 1","MsoTable15Grid2Accent2","Grid Table 2 Accent 2","MsoTable15Grid2Accent3","Grid Table 2 Accent 3","MsoTable15Grid2Accent4","Grid Table 2 Accent 4","MsoTable15Grid2Accent5","Grid Table 2 Accent 5","MsoTable15Grid2Accent6","Grid Table 2 Accent 6","MsoTable15Grid3","Grid Table 3","MsoTable15Grid3Accent1","Grid Table 3 Accent 1","MsoTable15Grid3Accent2","Grid Table 3 Accent 2","MsoTable15Grid3Accent3","Grid Table 3 Accent 3","MsoTable15Grid3Accent4",
"Grid Table 3 Accent 4","MsoTable15Grid3Accent5","Grid Table 3 Accent 5","MsoTable15Grid3Accent6","Grid Table 3 Accent 6","MsoTable15Grid4","Grid Table 4","MsoTable15Grid4Accent1","Grid Table 4 Accent 1","MsoTable15Grid4Accent2","Grid Table 4 Accent 2","MsoTable15Grid4Accent3","Grid Table 4 Accent 3","MsoTable15Grid4Accent4","Grid Table 4 Accent 4","MsoTable15Grid4Accent5","Grid Table 4 Accent 5","MsoTable15Grid4Accent6","Grid Table 4 Accent 6","MsoTable15Grid5Dark","Grid Table 5 Dark","MsoTable15Grid5DarkAccent1",
"Grid Table 5 Dark Accent 1","MsoTable15Grid5DarkAccent2","Grid Table 5 Dark Accent 2","MsoTable15Grid5DarkAccent3","Grid Table 5 Dark Accent 3","MsoTable15Grid5DarkAccent4","Grid Table 5 Dark Accent 4","MsoTable15Grid5DarkAccent5","Grid Table 5 Dark Accent 5","MsoTable15Grid5DarkAccent6","Grid Table 5 Dark Accent 6","MsoTable15Grid6Colorful","Grid Table 6 Colorful","MsoTable15Grid6ColorfulAccent1","Grid Table 6 Colorful Accent 1","MsoTable15Grid6ColorfulAccent2","Grid Table 6 Colorful Accent 2",
"MsoTable15Grid6ColorfulAccent3","Grid Table 6 Colorful Accent 3","MsoTable15Grid6ColorfulAccent4","Grid Table 6 Colorful Accent 4","MsoTable15Grid6ColorfulAccent5","Grid Table 6 Colorful Accent 5","MsoTable15Grid6ColorfulAccent6","Grid Table 6 Colorful Accent 6","MsoTable15Grid7Colorful","Grid Table 7 Colorful","MsoTable15Grid7ColorfulAccent1","Grid Table 7 Colorful Accent 1","MsoTable15Grid7ColorfulAccent2","Grid Table 7 Colorful Accent 2","MsoTable15Grid7ColorfulAccent3","Grid Table 7 Colorful Accent 3",
"MsoTable15Grid7ColorfulAccent4","Grid Table 7 Colorful Accent 4","MsoTable15Grid7ColorfulAccent5","Grid Table 7 Colorful Accent 5","MsoTable15Grid7ColorfulAccent6","Grid Table 7 Colorful Accent 6","MsoTable15List1Light","List Table 1 Light","MsoTable15List1LightAccent1","List Table 1 Light Accent 1","MsoTable15List1LightAccent2","List Table 1 Light Accent 2","MsoTable15List1LightAccent3","List Table 1 Light Accent 3","MsoTable15List1LightAccent4","List Table 1 Light Accent 4","MsoTable15List1LightAccent5",
"List Table 1 Light Accent 5","MsoTable15List1LightAccent6","List Table 1 Light Accent 6","MsoTable15List2","List Table 2","MsoTable15List2Accent1","List Table 2 Accent 1","MsoTable15List2Accent2","List Table 2 Accent 2","MsoTable15List2Accent3","List Table 2 Accent 3","MsoTable15List2Accent4","List Table 2 Accent 4","MsoTable15List2Accent5","List Table 2 Accent 5","MsoTable15List2Accent6","List Table 2 Accent 6","MsoTable15List3","List Table 3","MsoTable15List3Accent1","List Table 3 Accent 1","MsoTable15List3Accent2",
"List Table 3 Accent 2","MsoTable15List3Accent3","List Table 3 Accent 3","MsoTable15List3Accent4","List Table 3 Accent 4","MsoTable15List3Accent5","List Table 3 Accent 5","MsoTable15List3Accent6","List Table 3 Accent 6","MsoTable15List4","List Table 4","MsoTable15List4Accent1","List Table 4 Accent 1","MsoTable15List4Accent2","List Table 4 Accent 2","MsoTable15List4Accent3","List Table 4 Accent 3","MsoTable15List4Accent4","List Table 4 Accent 4","MsoTable15List4Accent5","List Table 4 Accent 5","MsoTable15List4Accent6",
"List Table 4 Accent 6","MsoTable15List5Dark","List Table 5 Dark","MsoTable15List5DarkAccent1","List Table 5 Dark Accent 1","MsoTable15List5DarkAccent2","List Table 5 Dark Accent 2","MsoTable15List5DarkAccent3","List Table 5 Dark Accent 3","MsoTable15List5DarkAccent4","List Table 5 Dark Accent 4","MsoTable15List5DarkAccent5","List Table 5 Dark Accent 5","MsoTable15List5DarkAccent6","List Table 5 Dark Accent 6","MsoTable15List6Colorful","List Table 6 Colorful","MsoTable15List6ColorfulAccent1","List Table 6 Colorful Accent 1",
"MsoTable15List6ColorfulAccent2","List Table 6 Colorful Accent 2","MsoTable15List6ColorfulAccent3","List Table 6 Colorful Accent 3","MsoTable15List6ColorfulAccent4","List Table 6 Colorful Accent 4","MsoTable15List6ColorfulAccent5","List Table 6 Colorful Accent 5","MsoTable15List6ColorfulAccent6","List Table 6 Colorful Accent 6","MsoTable15List7Colorful","List Table 7 Colorful","MsoTable15List7ColorfulAccent1","List Table 7 Colorful Accent 1","MsoTable15List7ColorfulAccent2","List Table 7 Colorful Accent 2",
"MsoTable15List7ColorfulAccent3","List Table 7 Colorful Accent 3","MsoTable15List7ColorfulAccent4","List Table 7 Colorful Accent 4","MsoTable15List7ColorfulAccent5","List Table 7 Colorful Accent 5","MsoTable15List7ColorfulAccent6","List Table 7 Colorful Accent 6");la.IGj=N.a.I3("0","center","1","top","2","center","3","bottom");la.HGj=N.a.I3("0","nil","1","none","2","nil","3","single","5","dotted","4","dashed","11","single","6","double","7","double","10","double","8","inset","9","outset");Object(C.a)(la,
"Box4TableStewardHelper",null,[])},1544:function(C,N,d){d.d(N,"a",function(){return T});C=d(0);var l=d(76),e=d(125),a=d(22),k=d(169),n=d(2),v=d(205),u=d(5),t=d(97),y=d(65),B=d(9),G=d(49),F=d(596),K=d(228),O=d(247),H=d(11),I=d(64),J=d(270),L=d(21),S=d(14),E=d(297),P=d(3);class T{static get Tg(){return K.ContextSetEditor.instance}static get Zf(){return O.a.instance}static get Mc(){return e.a.instance}static uw(){return T.Hm||(T.Hm=a.a.instance.Za("Box4.IExternalSelectionManager"))}static get ey(){return null!=
T.rpg?T.rpg:T.rpg=a.a.instance.resolve("Box4.IParagraphIndentationReader")}static BMl(){this.iN||(this.iN=new l.a,this.iN.add(P.a.Sv),this.iN.add(P.a.font),this.iN.add(P.a.IX),this.iN.add(P.a.Xja),this.iN.add(P.a.bold),this.iN.add(P.a.setItalic),this.iN.add(P.a.superscript),this.iN.add(P.a.subscript),this.iN.add(P.a.aWa),this.iN.add(P.a.sza),this.iN.add(P.a.FJa),this.iN.add(P.a.ZVe),this.iN.add(P.a.GJa),this.iN.add(P.a.$Va),this.iN.add(P.a.JL),this.iN.add(P.a.rM),this.iN.add(P.a.clearFormatting),
this.iN.add(P.a.Pab),this.iN.add(P.a.UAc));return this.iN}static Z5b(U){return T.BMl().contains(U)?!0:!1}static Av(U,X,Y,ca,da){var ua=!0;if(!X.view.ze)return 2;var ra=X.view,qa=ra.Cb;qa&&qa.hb.kb||(T.Mc.Zb(t.a.zf,{["Reason"]:y.a.noSelection}),ua=!1);T.Tg.Jza(L.ImageReader.cOc,ra.Cb.Rg)&&(T.Mc.Zb(t.a.zf,{["Reason"]:y.a.fZe}),ua=!1);if(T.Tg.Jza(L.ImageReader.WZa,ra.Cb.Rg))return T.Mc.Zb(t.a.zf,{["Reason"]:y.a.SBc}),8;var ka=!T.Z5b(U);T.Zf.g6b(ra.Cb.Rg,ka)&&(T.Mc.Zb(t.a.zf,{["Reason"]:y.a.dE}),ua=!1);
T.Tg.Jza(L.ImageReader.BOd,ra.Cb.Rg)&&(T.Mc.Zb(t.a.zf,{["Reason"]:y.a.aZe}),ua=!1);T.Tg.Jza(E.c,ra.Cb.Rg)&&(T.Mc.Zb(t.a.zf,{["Reason"]:y.a.bZe}),ua=!1);T.Tg.Jza(J.a.Lqf,ra.Cb.Rg)&&(T.Mc.Zb(t.a.zf,{["Reason"]:y.a.$Ye}),ua=!1);T.Tg.swa(H.ParagraphReader.UW,ra.Cb.Rg)&&(T.Mc.Zb(t.a.zf,{["Reason"]:y.a.uN}),ua=!1);T.uw()&&T.uw().instance&&T.uw().instance.HT(ra.Cb.Rg)&&(T.Mc.Zb(t.a.zf,{["Reason"]:y.a.externalSelection}),ua=!1);var la=null;qa&&qa.hb.kb&&(la=qa.hb.kb);U===P.a.A9d&&la&&la.eE&&H.ParagraphReader.iK(la.Qa.node)&&
!I.ListReader.rr&&(ua=!1);if(1===Y||!ua||!la)return ua?32:8;ua=U===P.a.L8b||U===P.a.YYb||U===P.a.Ucc||U===P.a.Z1b;ra=U===P.a.CHb||U===P.a.eyb||U===P.a.hcc;ka=U===P.a.yPa||U===P.a.zPa||U===P.a.hC;const Ha=new G.GraphTransaction(15);Ha.Db(la.Qa.node);la=new l.a;let wa=!1;if(ua||ra||ka)k.a.mark(7121),X=T.Tg.RKh(X.vk);else{k.a.mark(7119);X=F.OutlineElementGeneralizer.$ka(qa.hb,!0);if(!X)return T.Mc.Zb(t.a.Ska,{["Reason"]:y.a.ZBd}),Ha.dispose(),8;qa=U===P.a.CZa||U===P.a.hfb;X.Xw&&qa&&(wa=T.uWl(la,X))}(U===
P.a.leftJustify||U===P.a.L8b||U===P.a.centerJustify||U===P.a.YYb||U===P.a.rightJustify||U===P.a.Ucc||U===P.a.fullJustify||U===P.a.Z1b)&&X.Xw&&1<X.length&&T.vWl(X)&&(da||(da={}),Object.getType(da)===Object&&(da.InContextSet=!0));n.AFrameworkApplication.ya.Qf(X,U,Y,!0,ca,da);wa&&T.aMm(la,X,da);Ha.dispose();B.App.xa.updateCommandUI();ua||ra||ka?k.a.mark(7122):k.a.mark(7120);return 32}static uWl(U,X){if(!X.Xw)return!1;let Y=!1,ca=!1;for(let ua=0;ua<X.length;ua++)if(X.getContext(ua).vl){var da=X.getContext(ua).node;
da&&(da=T.ey.Ndb(da),2===da.specialIndentType?(Y=!0,U.add(ua)):1!==da.specialIndentType&&da.specialIndentType||(ca=!0))}return ca&&Y}static aMm(U,X,Y){if(X.Xw)for(let da=0;da<U.count;da++){var ca=X.getContext(U.J(da));if(!ca.vl)continue;ca=ca.node;const ua=T.ey.Ndb(ca);2!==ua.specialIndentType||v.a.JZ(Y.value,ua.DA)||ca.setValue(u.a.fe,ua.DA-ua.kba)}}static n_f(U,X){let Y=!0;X.contextId!==S.a.paragraph?Y=!1:T.Zf.C_a(X)?(T.Mc.Zb(t.a.Sm,{["Reason"]:y.a.dE}),Y=!1):T.uw()&&T.uw().instance&&T.uw().instance.HT(X)?
(T.Mc.Zb(t.a.Sm,{["Reason"]:y.a.externalSelection}),Y=!1):X.vl&&(X=X.node,H.ParagraphReader.nc(X)&&X.yP&&(T.Mc.Zb(t.a.Sm,{["Reason"]:y.a.uN}),Y=!1));return{returnValue:1!==U&&Y,Gx:Y?32:8}}static vWl(U){if(!U.Xw)return!1;let X=1;for(let ca=0;ca<U.length;ca++){var Y=U.getContext(ca);if(Y&&Y.vl&&Y.contextId===S.a.paragraph&&(Y=Y.node))if(Y=H.ParagraphReader.Hv(Y),!ca)X=Y;else if(Y!==X)return!0}return!1}}T.Hm=null;T.iN=null;Object(C.a)(T,"FormattingActionHelper",null,[])},1546:function(C,N,d){d.d(N,"a",
function(){return e});d.d(N,"b",function(){return a});var l=d(2);const e=k=>{switch(k){case 2:return WordEditorIntl.WordEditorStrings.L_ResultTypeHeader;case 4:return WordEditorIntl.WordEditorStrings.L_ResultTypeFooter;case 8:return WordEditorIntl.WordEditorStrings.L_ResultTypeFootnote;case 16:return WordEditorIntl.WordEditorStrings.L_ResultTypeEndnote;case 32:return WordEditorIntl.WordEditorStrings.L_ResultTypeComment}return""},a=()=>{var k;return null===(k=l.AFrameworkApplication.K)||void 0===k?
void 0:k.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate32",!1)}},1554:function(C,N,d){d.r(N);C=d(0);var l=d(8),e=d(1903),a=d(1565),k;(function(Ja){Ja[Ja.external=0]="external";Ja[Ja.msa=1]="msa";Ja[Ja.aad=2]="aad"})(k||(k={}));Object(C.b)("AuthorityType",k);class n{}Object(C.a)(n,"OAuthResult",null,[]);class v{constructor(Ja){this.HMj=Ja}initialize(){return Promise.resolve(0)}aTd(){return Promise.resolve(0)}uoa(){l.ULS.sendTraceTag(574239257,3E3,50,"Automation flag set.  Returning Mock Token.");
return Promise.resolve(Object.assign(new n,{IsSuccess:!0,Token:this.HMj}))}Sbe(){return Promise.resolve(Object.assign(new n,{IsSuccess:!1,ErrorCode:"authTokenStrategy_loginNotSupported",ErrorMessage:"This Token Strategy does not support login flow, TryLogin could not be completed"}))}H$d(){return!1}FJc(){return"MockAuthTokenStrategy"}}Object(C.a)(v,"MockAuthTokenStrategy",null,[252]);var u=d(1606);class t{static get(Ja,bb,ha){if(!ha)return Ja;let ia=0;return Promise.race([Ja,new Promise(va=>{ia=window.setTimeout(()=>
{va(bb)},ha)})]).then(va=>{window.clearTimeout(ia);return Promise.resolve(va)}).catch(()=>{window.clearTimeout(ia);return Promise.resolve(bb)})}}Object(C.a)(t,"PromiseWithTimeout",null,[]);var y=d(2),B=d(1494);class G{constructor(Ja,bb,ha,ia,va){this.scope=this.resource=null;this.silentLogin=!1;this.correlationId=this.options=null;this.resource=Ja;this.scope=bb;this.silentLogin=ha;this.options=ia;this.correlationId=va}}Object(C.a)(G,"TokenRequestParameters",null,[258]);var F=d(15),K=d(22);class O{constructor(){this.L5g=
null;let Ja=y.AFrameworkApplication.K.lb(y.AFrameworkApplication.pha),bb=y.AFrameworkApplication.K.lb(y.AFrameworkApplication.dce);this.kVb=String.format("ParentFrameTokenStrategy uiHost={0} uiHostIntegrationType={1}",Ja&&""!==Ja?Ja:"Unspecified",bb&&""!==bb?bb:"Unspecified")}initialize(){return new Promise(Ja=>{K.a.instance.Za("Common.App.WopiIdentity.IWopiIdentity").execute(bb=>{this.L5g=bb;Ja(0)})})}re(Ja){const bb=["HTTPS:","API:"];let ha=!1;const ia=Ja.toLocaleUpperCase();for(const va of bb)if(ia.startsWith(va)){ha=
!0;break}return ha||this.Xdm(Ja)?Ja+"/.default":Ja}Xdm(Ja){return RegExp("/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i").test(Ja)}aTd(){return Promise.resolve(0)}uoa(Ja,bb,ha,ia,va,Ka,Xa){if(F.a.OMa){va=B.a.Jqo;if(!va)return bb=Object.assign(new n,{IsSuccess:!1,ErrorCode:"TeamsNoAllowListFound",ErrorMessage:"No app list was found."}),Promise.resolve(bb);if(!Array.contains(va,Ja))return bb=Object.assign(new n,{IsSuccess:!1,ErrorCode:"TeamsDisallowedApp",ErrorMessage:"Disallowed appName: "+
Ja}),Promise.resolve(bb)}Ja=this.re(ha);ha=new G(ha,Ja,!ia,null,y.AFrameworkApplication.userSessionId);return this.L5g.getAccessToken(ha,bb,Xa).then(xa=>Object.assign(new n,{IsSuccess:!0,Token:xa.accessToken}),xa=>Object.assign(new n,{IsSuccess:!1,ErrorCode:xa}))}Sbe(){return Promise.resolve(Object.assign(new n,{IsSuccess:!1,ErrorCode:"authTokenStrategy_loginNotSupported",ErrorMessage:"This Token Strategy does not support login flow, TryLogin could not be completed"}))}H$d(){return!1}FJc(){return this.kVb}}
Object(C.a)(O,"ParentFrameTokenStrategy",null,[252]);var H=d(44),I=d(1512),J=d(76);class L{constructor(){this.reject=this.resolve=null;this.startTime=0;this.GHi=this.mfh=null}}Object(C.a)(L,"PromiseWrapper",null,[]);class S{constructor(Ja=0){this.rx=0;this.utc=!1;this.Cx=new J.a;this._timeout=Ja}enqueue(Ja){return new Promise((bb,ha)=>{this.Cx.add(Object.assign(new L,{GHi:Ja,resolve:bb,reject:ha}));this.process()})}process(){if(this.utc||this.rx===this.Cx.count)return!1;const Ja=this.Cx.J(this.rx++);
try{this.utc=!0,Ja.GHi().then(bb=>{this.utc=!1;this.vYe(Ja,bb,null,!0)}).catch(bb=>{this.utc=!1;this.vYe(Ja,null,bb,!1)})}catch(bb){this.utc=!1,this.vYe(Ja,null,bb,!1)}return!0}vYe(Ja,bb,ha,ia){if(ia){const va=()=>{Ja.resolve(bb);this.process()};0<this._timeout?window.setTimeout(()=>{va()},this._timeout):va()}else{const va=()=>{Ja.reject(ha);this.process()};0<this._timeout?window.setTimeout(()=>{va()},this._timeout):va()}}}Object(C.a)(S,"PromiseQueue",null,[]);class E{constructor(){this.correlationId=
this.resolve=null}}Object(C.a)(E,"ResolveWithCorrelation",null,[]);var P=d(72),T=d(153),U=d(930),X=d(87);class Y extends T.a{constructor(Ja,bb,ha,ia,va,Ka,Xa){super(!1,!1,!0);this.vBg=this.cxa=null;this.Iqa=Ja;this.fRj=ha;this.Mt=ia;this.zYj=va;this.pqb=Ka;this.zG=document.createElement("iframe");this.zG.id="SharedAuthInteractiveFrame";this.zG.setAttribute("name","SharedAuthInteractiveFrame");this.zG.setAttribute("title","SharedAuthInteractiveFrame");this.zG.setAttribute("sandbox","allow-scripts allow-same-origin allow-forms allow-popups");
this.zG.style.border="0";this.zG.style.height="48px";this.zG.style.width="190px";$addHandler(this.zG,"error",Object(H.a)(this,this.uXm,"onSharedAuthFrameError"));Ja=String.format("{0}{1}{2}{3}{4}{5}{6}{7}{8}",this.Iqa,bb,"?replyUrl=",window.location.protocol,"//",window.location.host,"&interactive=1","&WacUserType=",y.AFrameworkApplication.userType);Xa&&(Ja+="&vnext=1");this.zG.src=Ja;this.tBj=new Promise(xa=>{this.vBg=xa});this.wBg=!1}KPa(){this.cxa={["id"]:"SharedAuthConsentDialog",["bodyControls"]:{["promptMessage"]:this.fRj,
["errorText"]:CommonUIStrings.l_InternalError,["rtl"]:y.AFrameworkApplication.isRtl,["frameLoaded"]:!1,["createFrame"]:Object(H.a)(this,this.OJk,"createFrame"),["resolveDialogStyles"]:this.vBg}};this.Fd=5;this.Wh(CommonUIStrings.l_SignIn,Object(H.a)(this,this.FRn,"sharedAuthConsentDialogHandler"),this.cxa)}nij(Ja=!1,bb=5){this.cxa&&this.cxa.bodyControls&&(!0!==Object(P.a)(Object,this.cxa.bodyControls).frameLoaded&&(Object(P.a)(Object,this.cxa.bodyControls).frameLoaded=!0),Ja!==Object(P.a)(Object,
this.cxa.bodyControls).frameLoadSuccess&&(Object(P.a)(Object,this.cxa.bodyControls).frameLoadSuccess=Ja),bb!==this.cxa.dialogButtonsOption&&(this.cxa.dialogButtonsOption=null,this.Fd=bb),this.update(this.cxa))}EYn(Ja,bb){const ha=new U.a(X.a.JRn);ha.Values={["signInLabel"]:CommonUIStrings.l_SignIn,["cancelLabel"]:CommonUIStrings.l_DialogCancel,["rtl"]:y.AFrameworkApplication.isRtl,["messageCorrelationId"]:Ja,["dialogStyles"]:bb};this.Mt.z2a(ha,this.zG.contentWindow,this.Iqa)}eKh(){this.nij(!1,6)}get G1i(){return this.zG}get KVk(){return this.tBj.then(Ja=>
{this.wBg=!0;return Ja})}get LVk(){return this.wBg}uXm(){this.eKh()}OJk(){return this.zG}FRn(Ja){0===Ja&&(this.zYj.reject(Object.assign(new n,{ErrorCode:"UserCancelled",ErrorMessage:"The interactive flow was cancelled by the user"})),this.pqb(null))}}Object(C.a)(Y,"SharedAuthConsentDialog",T.a,[259]);var ca=d(935),da=d(83),ua=d(112),ra=d(37),qa=d(121),ka=d(161);class la{constructor(){this.zG=null;this.bcd=0;this.xSb=this.SVb=this.oie=this.pqb=this.a9=this.S3g=null;this.Mt=new ca.a(null,null);this.gpd=
y.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedAuthVNext",!1);this.kVb="SharedAuthTokenStrategy "+(this.gpd?"BrowserAuth 1.20210701.2/MSAL 2.11.0":"BrowserAuth 1.20210426.1/MSAL 2.11.0");this.Iqa=B.a.HRn;this.W_g=B.a.GRn;this.XCg=B.a.enableConsoleLogging;this.yCj=y.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OAuthPopupFlashEnabled",!1);this.LVj=y.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OAuthSkipUpnCheckEnabled",
this.gpd);this.g9a={};this.RHj=new S(1500)}FJc(){return this.kVb}initialize(){var {OAuthManager:Ja}=d(1554);if("loadFrame"in this.g9a)return this.g9a.loadFrame.mfh;if(!this.Iqa)return da.Health.instance.recordKpiFailure(Ja.kpiName,"SharedAuthFrameOriginNotSet",!1,!1,null),l.ULS.sendTraceTag(562381581,3E3,10,"SharedAuthTokenStrategy Init failed: No Shared Frame Origin Path"),Promise.reject(1);Ja=this.j$d("loadFrame");this.bcd=ra.a.lf();var bb=this.Iqa+this.W_g+"?replyUrl="+window.location.protocol+
"//"+window.location.host+"&usid="+y.AFrameworkApplication.userSessionId+"&WacUserType="+y.AFrameworkApplication.userType;this.gpd&&(bb+="&vnext=1");this.zG=document.createElement("iframe");this.unf(this.zG);this.zG.style.cssText="height:0;width:0;display:none;";this.zG.id="SharedAuthFrame";this.zG.setAttribute("name","SharedAuthFrame");this.zG.setAttribute("sandbox","allow-scripts allow-same-origin allow-forms allow-popups");this.zG.setAttribute("title","SharedAuthFrame");this.zG.src=bb;document.body.appendChild(this.zG);
bb=ra.a.lf()-this.bcd;l.ULS.sendTraceTag(573112899,3E3,50,"SharedAuthTokenStrategy Create: Frame Appended to Document. E/T:[{0}]. sharedAuthFrame.Src={1}",bb,this.zG.src);return Ja}aTd(Ja){this.oie=Ja;const bb=new U.a(X.a.J1i);bb.Values=this.Reh(Ja);Ja=this.j$d("initFrame");this.Mt.z2a(bb,this.zG.contentWindow,this.Iqa);l.ULS.sendTraceTag(573112900,3E3,50,"SharedAuthTokenStrategy Init: Called package initialize.");return Ja}uoa(Ja,bb,ha,ia,va,Ka){const Xa=new U.a(X.a.KRn),xa=this.XXh();Xa.Values=
this.Odj(Ja,bb,ha,ia,va,Ka,xa);Ja=this.j$d(xa);ia&&y.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedAuthInteractiveConsentUI",!1)?this.RHj.enqueue(()=>new Promise(Ma=>{this.nco(Ka,Xa,Ma,xa)})):(this.Mt.z2a(Xa,this.zG.contentWindow,this.Iqa),l.ULS.sendTraceTag(573112901,3E3,50,"SharedAuthTokenStrategy TryGetToken: Called TryGetToken for app {0}",bb));return Ja}nco(Ja,bb,ha,ia){const va=this.g9a[ia];va&&(this.SVb=bb,this.pqb=Object.assign(new E,{resolve:ha,correlationId:ia}),
this.a9=new Y(this.Iqa,this.W_g,Ja,this.Mt,va,ha,this.gpd),this.a9.KPa())}XXh(){return qa.a.create().toString()}Odj(Ja,bb,ha,ia,va,Ka,Xa){const xa={};xa.appName=Ja;xa.appId=bb;xa.target=ha;xa.withPopup=ia;xa.claims=va;xa.promptMessage=Ka;xa.messageCorrelationId=Xa;return xa}unf(Ja){$addHandler(Ja,"load",Object(H.a)(this,this.eTm,"onIFrameLoaded"));$addHandler(Ja,"error",Object(H.a)(this,this.jib,"onIFrameError"));this.Mt.iVa(this.Iqa);this.Mt.xv(X.a.M1i);this.Mt.cC(X.a.M1i,Object(H.a)(this,this.WWm,
"onScriptLoaded"));this.Mt.xv(X.a.L1i);this.Mt.cC(X.a.L1i,Object(H.a)(this,this.VWm,"onScriptInitialized"));this.Mt.xv(X.a.H1i);this.Mt.cC(X.a.H1i,Object(H.a)(this,this.ISm,"onGetTokenResponse"));this.Mt.xv(X.a.N1i);this.Mt.cC(X.a.N1i,Object(H.a)(this,this.cUm,"onLoginResponse"));this.Mt.xv(X.a.K1i);this.Mt.cC(X.a.K1i,Object(H.a)(this,this.ATm,"onInteractiveFlowReady"));this.Mt.xv(X.a.I1i);this.Mt.cC(X.a.I1i,Object(H.a)(this,this.RSm,"onHideDialog"));this.Mt.xv(X.a.F1i);this.Mt.cC(X.a.F1i,Object(H.a)(this,
this.RFf,"onCloseDialog"))}j$d(Ja){const bb=new L;bb.startTime=ra.a.lf();const ha=new Promise((ia,va)=>{bb.resolve=ia;bb.reject=va});bb.mfh=ha;this.g9a[Ja]=bb;return ha}eTm(){const Ja=ra.a.lf()-this.bcd;l.ULS.sendTraceTag(572346566,3E3,50,"WACOAuth.aspx iFrame loaded successfully. E/T:[{0}]",Ja)}jib(Ja){const {OAuthManager:bb}=d(1554),ha=ra.a.lf()-this.bcd,ia=Object.assign(new ka.a,{durationMs:ha});da.Health.instance.recordKpiFailure(bb.kpiName,"SharedAuthWACOAuthAspxFrameError",!1,!0,ia);l.ULS.sendTraceTag(572346567,
3E3,10,"WACOAuth.aspx iFrame failed to load after {0} ms: {1}",ha,this.XCg?JSON.stringify(Ja):"")}WWm(Ja){const {OAuthManager:bb}=d(1554),ha=this.g9a.loadFrame;var ia=ra.a.lf()-ha.startTime,va=Ja.Values.AuthLibrary.toString();Ja=Ja.Values.Success.toString();l.ULS.sendTraceTag(573112902,3E3,50,"SharedAuthTokenStrategy OnScriptLoaded. Success={0} AuthLibrary={1} E/T: [{2}]",Ja,va,ia);va&&(this.kVb="SharedAuthTokenStrategy "+va);va=Boolean.parse(Ja);va||(Ja=ua.a.iF(),void 0!==Ja&&null!==Ja&&(Ja.set("AuthLibrary",
this.FJc()),ia=Object.assign(new ka.a,{durationMs:ia,extendedProperties:Ja}),da.Health.instance.recordKpiFailure(bb.kpiName,"SharedAuthStrategyInitFailed",!1,!0,ia)));ha.resolve(va?0:1)}VWm(Ja){if(Ja.Values.interactive&&this.SVb&&this.SVb.Values.messageCorrelationId){const ha=this.SVb.Values.messageCorrelationId.toString();if(Ja.Values.interactive&&this.a9){this.a9.KVk.then(ia=>{this.Mt.z2a(this.SVb,this.a9.G1i.contentWindow,this.Iqa);this.a9.EYn(ha,ia);this.a9.nij(!0);this.SVb=null});return}}Ja=
this.g9a.initFrame;const bb=ra.a.lf()-Ja.startTime;l.ULS.sendTraceTag(573112903,3E3,50,"SharedAuthTokenStrategy OnScriptInitialized. E/T: [{0}]",bb);Ja.resolve(0)}ISm(Ja){if(Ja.Values.messageCorrelationId&&Ja.Values.messageCorrelationId.toString()){var bb=Ja.Values.messageCorrelationId.toString(),ha=this.g9a[bb];if(ha){var ia=ra.a.lf()-ha.startTime;l.ULS.sendTraceTag(573112906,3E3,50,"SharedAuthTokenStrategy OnGetTokenResponse. E/T: [{0}]",ia);Ja.Values.isSuccess&&Ja.Values.isSuccess?ha.resolve(Ja.Values.response):
ha.reject(Ja.Values.response);this.jej(bb)}else l.ULS.sendTraceTag(573112905,3E3,10,"SharedAuthTokenStrategy OnGetTokenResponse called with an unregistered messageCorrelationId")}else l.ULS.sendTraceTag(573112904,3E3,10,"SharedAuthTokenStrategy OnGetTokenResponse called without valid messageCorrelationId")}ATm(){if(this.a9.LVk)this.a9.eKh();else if(this.oie&&this.a9){const Ja=new U.a(X.a.J1i);Ja.Values=this.Reh(this.oie,!0);this.Mt.z2a(Ja,this.a9.G1i.contentWindow,this.Iqa)}}RSm(){this.a9&&this.a9.lLd()}RFf(Ja){Ja.Values.cancelled&&
Ja.Values.cancelled&&Ja.Values.messageCorrelationId&&this.jej(Ja.Values.messageCorrelationId.toString());this.a9&&this.a9.hide()}Reh(Ja,bb=!1){const ha={};ha.appIds=this.til();ha.upn=Ja.loginHint;ha.authority=Ja.authority;ha.authorityType=Object(e.a)(k,Ja.authorityType);ha.tenantId=Ja.tenantId;ha.correlationId=y.AFrameworkApplication.userSessionId;ha.enableConsoleLogging=this.XCg;ha.enablePopupFlash=this.yCj;ha.skipUpnCheck=this.LVj;ha.interactive=bb;return ha}til(){const Ja=[],bb=B.a.JQe;for(let ha in bb)Array.add(Ja,
bb[ha]);return Ja}Sbe(Ja,bb,ha,ia,va,Ka){const Xa=new U.a(X.a.IRn),xa=this.XXh();Xa.Values=this.Odj(Ja,bb,ha,ia,va,Ka,xa);this.S3g=Xa;Ja=this.j$d(xa);l.ULS.sendTraceTag(555049437,3E3,50,"SharedAuthTokenStrategy TryLogin: Called TryLogin for app {0}",bb);this.tWn();return Ja}H$d(){return!0}tWn(){this.xSb||(this.xSb=new I.a(CommonUIStrings.l_WAC_OAuth_CompleteSignIn_Title,CommonUIStrings.l_WAC_OAuth_CompleteSignIn_Body,null),this.xSb.id=16,this.xSb.wPd=!1,this.xSb.addButton(CommonUIStrings.l_WAC_OAuth_CompleteSignIn_Button,
()=>{l.ULS.sendTraceTag(527827290,3E3,50,"SharedAuthTokenStrategy TryLogin: User Clicked Login");this.Mt.z2a(this.S3g,this.zG.contentWindow,this.Iqa)},CommonUIStrings.l_WAC_OAuth_CompleteSignIn_Button,!0),y.AFrameworkApplication.ua.Sb.lVa(this.xSb,!0)||l.ULS.sendTraceTag(555049438,3E3,10,"Failed to add entry to business bar. Login message could not be shown to user."))}cUm(Ja){if(Ja.Values.messageCorrelationId&&Ja.Values.messageCorrelationId.toString()){var bb=this.g9a[Ja.Values.messageCorrelationId.toString()];
if(bb){var ha=ra.a.lf()-bb.startTime;l.ULS.sendTraceTag(555049441,3E3,50,"SharedAuthTokenStrategy OnLoginResponse. E/T: [{0}]",ha);Ja.Values.isSuccess&&Ja.Values.isSuccess?bb.resolve(Ja.Values.response):bb.reject(Ja.Values.response)}else l.ULS.sendTraceTag(555049440,3E3,10,"SharedAuthTokenStrategy OnLoginResponse called with an unregistered messageCorrelationId")}else l.ULS.sendTraceTag(555049439,3E3,10,"SharedAuthTokenStrategy OnLoginResponse called without valid messageCorrelationId")}jej(Ja){this.pqb&&
this.pqb.correlationId===Ja&&(this.pqb.resolve(null),this.pqb=null)}}Object(C.a)(la,"SharedAuthTokenStrategy",null,[252]);class Ha{constructor(Ja){this.d5=Ja;this.kVb="UnsupportedAuthTokenStrategy Reason="+a.a[this.d5]}initialize(){return Promise.resolve(0)}aTd(){return Promise.resolve(0)}uoa(){return Promise.resolve(Object.assign(new n,{IsSuccess:!1,ErrorCode:a.a[this.d5],ErrorMessage:"Unable to get a token. Reason: ["+a.a[this.d5]+"]"}))}Sbe(){return Promise.resolve(Object.assign(new n,{IsSuccess:!1,
ErrorCode:"authTokenStrategy_loginNotSupported",ErrorMessage:"This Token Strategy does not support login flow, TryLogin could not be completed"}))}H$d(){return!1}FJc(){return this.kVb}}Object(C.a)(Ha,"UnsupportedAuthTokenStrategy",null,[252]);var wa=d(1482);d.d(N,"OAuthManager",function(){return Ca});class Ca{constructor(Ja=null){this.Jha=0;this.Pba=null;this.Wsb=0;const bb=ra.a.lf();this.xHj=this.QUk(Ja).then(ha=>ha?this.m1l():(l.ULS.sendTraceTag(527827277,3E3,15,"DetermineAuthLibrary failed leaving {0} in {1} ms, all future TryGetToken requests will fail.",
this.WJ(),Math.floor(ra.a.lf()-bb)),ha=ua.a.iF(),void 0!==ha&&null!==ha&&(ha.set("AuthLibrary",this.WJ()),ha=Object.assign(new ka.a,{durationMs:Math.floor(ra.a.lf()-bb),extendedProperties:ha}),da.Health.instance.recordKpiFailure(Ca.kpiName,"StrategyPickFailed",!1,!0,ha)),Promise.resolve(1))).then(ha=>0!==ha?Promise.resolve(ha):this.psm())}RUk(){var Ja=B.a.QIm;Ja&&0<Ja.length?(this.Jha=1,this.Pba=new v(Ja)):y.AFrameworkApplication.K.$("IsO365ConsumerHost")||y.AFrameworkApplication.K.$("IsO365CommercialHost")?
y.AFrameworkApplication.K.$("IsAnonymousUser")?(this.Jha=2,this.Pba=new Ha(this.Jha)):(Ja=u.a.getAuthContext().loginHint)&&Ja.length?B.a.mLc?(this.Jha=1,this.Pba=new O):(this.Jha=1,this.Pba=new la):(this.Jha=3,this.Pba=new Ha(this.Jha)):(this.Jha=4,this.Pba=new Ha(this.Jha))}WJ(){return this.Pba?this.Pba.FJc()||"Unknown":"None"}QUk(Ja=null){l.ULS.sendTraceTag(562128578,3E3,50,"Creating OAuthManager.");const bb=ra.a.lf();return y.AFrameworkApplication.K.ptl().then(ha=>{ha?(this.RUk(),Ja&&(this.Pba=
Ja),l.ULS.sendTraceTag(42084323,3E3,50,"Creation succeeded OAuthManager successfully in {4} ms with clientVer={0}, appVer={1}, docVer={2}, strategy={3}",B.a.clientVersion,B.a.appVersion,B.a.lZk,this.WJ(),Math.floor(ra.a.lf()-bb))):l.ULS.sendTraceTag(562128579,3E3,15,"Creation failed for OAuthManager, unable to get app settings after {0} ms, all future TryGetToken requests will fail.",Math.floor(ra.a.lf()-bb));return Promise.resolve(ha)},()=>{l.ULS.sendTraceTag(562128580,3E3,15,"Creation failed for OAuthManager, unable to get app settings after {0} ms, all future TryGetToken requests will fail.",
Math.floor(ra.a.lf()-bb));return Promise.resolve(!1)})}m1l(){l.ULS.sendTraceTag(573390991,3E3,50,"Initializing {0}",this.WJ());const Ja=ra.a.lf();return t.get(this.Pba.initialize(),2,B.a.YNf).then(bb=>{if(0===bb)l.ULS.sendTraceTag(42084353,3E3,50,"Initialization succeeded for {0} in {1} ms.",this.WJ(),Math.floor(ra.a.lf()-Ja));else if(1===bb){l.ULS.sendTraceTag(527827291,3E3,15,"Initialization failed for {0} in {1} ms, all future TryGetToken requests will fail.",this.WJ(),Math.floor(ra.a.lf()-Ja));
var ha=ua.a.iF();void 0!==ha&&null!==ha&&(ha.set("AuthLibrary",this.WJ()),ha=Object.assign(new ka.a,{durationMs:Math.floor(ra.a.lf()-Ja),extendedProperties:ha}),da.Health.instance.recordKpiFailure(Ca.kpiName,"StrategyInitFailed",!1,!0,ha))}else 2===bb&&(l.ULS.sendTraceTag(42267908,3E3,15,"Initialization timed out for {0} after {1} ms, all future TryGetToken requests will fail.",this.WJ(),Math.floor(ra.a.lf()-Ja)),ha=ua.a.iF(),void 0!==ha&&null!==ha&&(ha.set("AuthLibrary",this.WJ()),ha=Object.assign(new ka.a,
{durationMs:Math.floor(ra.a.lf()-Ja),extendedProperties:ha}),da.Health.instance.recordKpiFailure(Ca.kpiName,"StrategyInitTimedOut",!1,!0,ha)));return Promise.resolve(bb)},()=>{l.ULS.sendTraceTag(574239256,3E3,15,"Initialization failed for {0} after {1} ms, all future TryGetToken requests will fail.",this.WJ(),Math.floor(ra.a.lf()-Ja));return Promise.resolve(1)})}psm(){l.ULS.sendTraceTag(562128581,3E3,50,"Loading {0}",this.WJ());const Ja=ra.a.lf();return t.get(this.Pba.aTd(u.a.getAuthContext()),2,
B.a.YNf).then(bb=>{if(0===bb)l.ULS.sendTraceTag(562128582,3E3,50,"Load succeeded for {0} in {1} ms.",this.WJ(),Math.floor(ra.a.lf()-Ja));else if(1===bb){l.ULS.sendTraceTag(562128583,3E3,15,"Load failed for {0} after {1} ms, all future TryGetToken requests will fail.",this.WJ(),Math.floor(ra.a.lf()-Ja));var ha=ua.a.iF();void 0!==ha&&null!==ha&&(ha.set("AuthLibrary",this.WJ()),ha=Object.assign(new ka.a,{durationMs:Math.floor(ra.a.lf()-Ja),extendedProperties:ha}),da.Health.instance.recordKpiFailure(Ca.kpiName,
"StrategyLoadFailed",!1,!0,ha))}else 2===bb&&(l.ULS.sendTraceTag(558469660,3E3,15,"Load timed out for {0} after {1} ms, all future TryGetToken requests will fail.",this.WJ(),Math.floor(ra.a.lf()-Ja)),ha=ua.a.iF(),void 0!==ha&&null!==ha&&(ha.set("AuthLibrary",this.WJ()),ha=Object.assign(new ka.a,{durationMs:Math.floor(ra.a.lf()-Ja),extendedProperties:ha}),da.Health.instance.recordKpiFailure(Ca.kpiName,"StrategyLoadTimedOut",!1,!0,ha)));return Promise.resolve(bb)},()=>{l.ULS.sendTraceTag(562128584,
3E3,15,"Load failed for {0} after {1} ms, all future TryGetToken requests will fail.",this.WJ(),Math.floor(ra.a.lf()-Ja));return Promise.resolve(1)})}uoa(Ja,bb,ha=null){return this.Zgc(Ja,bb,!1,null,"",ha)}Pdj(Ja,bb,ha,ia,va=null){return this.Zgc(Ja,bb,!0,ha,ia,va)}Zgc(Ja,bb,ha,ia,va,Ka,Xa=0){Xa+=1;l.ULS.sendTraceTag(42084352,3E3,50,"OAuthManager TryGetToken(appName={0}, target={1}) called.  Using strategy {2} - attempt {3}",Ja,this.dJb(Ja,bb),this.WJ(),Xa);var xa=ua.a.iF();void 0!==xa&&null!==xa&&
(xa.set("AuthLibrary",this.WJ()),xa.set("AppName",Ja),xa.set("Target",this.dJb(Ja,bb)),da.Health.instance.recordKpiUsage(Ca.kpiName,0,"WacOAuthFC",xa));if(!B.a.isEnabled){var Ma;return this.vxf((Ma=new n,Ma.IsSuccess=!1,Ma.Token=null,Ma.ErrorCode="NotEnabled",Ma.ErrorMessage="OAuthManager is disabled.",Ma),Ja)}const Na=B.a.JQe[Ja];if(void 0===Na||null===Na){l.ULS.sendTraceTag(41961345,3E3,15,"Auth context not found. Ensure that your app [{0}] is listed in the OAuthManagerApplications setting.",Ja);
var pa;return this.vxf((pa=new n,pa.IsSuccess=!1,pa.Token=null,pa.ErrorCode="DisallowedApp",pa.ErrorMessage="Disallowed appName: "+Ja,pa),Ja)}const Ra=ra.a.lf(),Sa=this;xa=this.xHj.then(Ua=>Sa.G8l(Ja,Na,bb,ha,ia,va,Ka,Ua));Ma=ha?0:B.a.YNf;let ab;pa=(ab=new n,ab.IsSuccess=!1,ab.Token=null,ab.ErrorCode="authTokenStrategy_timeout",ab.ErrorMessage="Auth Strategy timed out after ["+Ma+"] ms when fetching token",ab);let eb=this,zb=this;return t.get(xa,pa,Ma).then(Ua=>Xa<=Ca.iGm&&(Ua.ErrorCode===Ca.Raj||
Ua.ErrorCode===Ca.t3n)?(l.ULS.sendTraceTag(573175516,3E3,50,"TryGetToken attempt {0} timed out after {1} ms - retrying",Xa,Math.floor(ra.a.lf()-Ra)),eb.Zgc(Ja,bb,ha,ia,va,Ka,Xa)):Ua.ErrorCode===Ca.jji&&!ha&&(l.ULS.sendTraceTag(561517645,3E3,50,"TryGetToken attempt {0} failed with ITP error.  3P Cookies are [{1}]. Retry: [{2]}]",Xa,Ca.lDh),Ca.u1k&&eb.Pba.H$d()&&eb.Pba.Sbe(Ja,Na,bb,ha,ia,va).then(Ab=>Promise.resolve(eb.CTd(Ab,Ja,bb,Na,Ra))).catch(()=>{let Ab;const mb=(Ab=new n,Ab.IsSuccess=!1,Ab.Token=
null,Ab.ErrorCode="authTokenStrategy_failure",Ab.ErrorMessage="LoginPopup failed, GetToken could not be called",Ab);return Promise.resolve(eb.CTd(mb,Ja,bb,Na,Ra))}),Ca.lDh)?eb.Zgc(Ja,bb,!0,ia,va,Ka,Xa):Promise.resolve(eb.CTd(Ua,Ja,bb,Na,Ra))).catch(()=>{let Ua;const Ab=(Ua=new n,Ua.IsSuccess=!1,Ua.Token=null,Ua.ErrorCode="authTokenStrategy_failure",Ua.ErrorMessage="Auth Strategy failed with an unknown error",Ua);return Promise.resolve(zb.CTd(Ab,Ja,bb,Na,Ra))})}G8l(Ja,bb,ha,ia,va,Ka,Xa,xa){return 1===
xa||2===xa?this.vxf(Object.assign(new n,{IsSuccess:!1,Token:null,ErrorCode:1===xa?"InitFailed":"InitTimedOut",ErrorMessage:"Auth Strategy Failed to Init or Load"}),Ja):this.Pba.uoa(Ja,bb,ha,ia,va,Ka,Xa).then(Ma=>Promise.resolve(this.iui(Ma,!0,Ja))).catch(Ma=>Promise.resolve(this.iui(Ma,!1,Ja)))}CTd(Ja,bb,ha,ia,va){const Ka={};va=ra.a.lf()-va;Ka.IsSuccess=Ja.IsSuccess;Ka.ErrorCode=Ja.IsSuccess?"Success":Ja.ErrorCode||"";Ka.ErrorMessage=Ja.IsSuccess?"Success":this.dJb(bb,Ja.ErrorMessage||"");Ka.Target=
this.dJb(bb,ha||"");Ka.TimeInMS=Math.floor(va);Ka.AuthLibrary=this.WJ();Ka.AppName=bb;Ka.AuthorityType=Object(e.a)(k,u.a.oEd());Ka.UserType=this.yOl(u.a.getAuthContext());Ka.IsAuthSupportedInSession=a.a[this.Jha];Ka.RequestCount=++this.Wsb;Ka.AppId=ia;l.ULS.sendTraceTag(593863640,3E3,50,JSON.stringify(Ka));Ja.IsSuccess||(ha=ua.a.iF(),void 0!==ha&&null!==ha&&(ha.set("AppName",bb),ha.set("AuthLibrary",this.WJ()),ha.set("ErrorCode",Ja.ErrorCode),ha.set("ErrorMessage",this.dJb(bb,Ja.ErrorMessage)),bb=
Object.assign(new ka.a,{durationMs:va,extendedProperties:ha}),da.Health.instance.recordKpiFailure(Ca.kpiName,"TryGetTokenFailure",!1,!0,bb)));return Ja}vxf(Ja,bb){l.ULS.sendTraceTag(578435090,3E3,15,"OAuthManager failed without invoking GetToken. AppName: '{0}', Reason: '{1}'",bb,this.dJb(bb,Ja.ErrorMessage));const ha=ua.a.iF();void 0!==ha&&null!==ha&&(ha.set("AppName",bb),ha.set("AuthLibrary",this.WJ()),ha.set("ErrorCode",Ja.ErrorCode),ha.set("ErrorMessage",this.dJb(bb,Ja.ErrorMessage)),bb=Object.assign(new ka.a,
{extendedProperties:ha}),da.Health.instance.recordKpiFailure(Ca.kpiName,"FailureBeforeGetToken",!1,!0,bb));return Promise.resolve(Ja)}adi(Ja){return Ja===wa.a.Mae}dJb(Ja,bb){return this.adi(Ja)&&bb?"REDACTED":bb}yOl(Ja){return y.AFrameworkApplication.K.$("IsAnonymousUser")?"anonymous":!Ja.loginHint||1>Ja.loginHint.length?"empty":-1<Ja.loginHint.indexOf("guest#")?"guest":-1<Ja.loginHint.indexOf("ext#")?"external":0>Ja.upn.indexOf("@")?"no-at":"supported"}K9l(){return 1===this.Jha}iui(Ja,bb,ha){let ia=
null,va=null,Ka=null,Xa=null;Ja?Ja.ErrorCode||Ja.ErrorMessage?(va=Ja.ErrorCode?Ja.ErrorCode:Ca.lFh,Ka=Ja.ErrorMessage?Ja.ErrorMessage:"No message"):Ja.Token?bb?ia=Ja.Token:(va=Ca.Xnn,Ka="A rejected promise returned a token."):(va=Ca.lFh,Ka=JSON.stringify(Ja)):(va=Ca.ELm,Ka="No result came from Auth Token Strategy");Ja&&Ja.Telemetry&&!this.adi(ha)&&(Xa=Ja.Telemetry,l.ULS.sendTraceTag(579166408,3E3,50,JSON.stringify(Xa)));if(va===Ca.mJm||va===Ca.S9n)va=Ca.Raj,Ka="Auth Library Timed Out";va===Ca.hgk&&
-1<Ka.indexOf(Ca.F_j)&&(va=Ca.jji);if(va||Ka)ia=null;return Object.assign(new n,{IsSuccess:!!ia,Token:ia,ErrorCode:va,ErrorMessage:Ka,Telemetry:Xa})}static get lDh(){return y.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OAuthInteractiveFallbackEnabled",!1)}static get u1k(){return y.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OAuthLoginFlowEnabled",!1)}}Ca.S9n="token_renewal_error";Ca.lFh="Exception";Ca.ELm="NoResult";Ca.Xnn="RejectToken";
Ca.mJm="monitor_window_timeout";Ca.Raj="Timeout";Ca.t3n="authTokenStrategy_timeout";Ca.hgk="login_required";Ca.F_j="AADSTS50058";Ca.jji="Cookies Disabled";Ca.kpiName="OAuthManager";Ca.iGm=2;Object(C.a)(Ca,"OAuthManager",null,[165])},1555:function(C,N,d){d.r(N);C=d(0);var l=d(2),e=d(104),a=d(22),k=d(58),n=d(374),v=d(44),u=d(49),t=d(6);class y{g3e(dc,nb,Gb){return 1===Gb?32:y.ZSk(nb.node)}static ZSk(dc){const nb=new t.GraphIterator;nb.set(dc);nb.qo();dc=new u.GraphTransaction(7);dc.Ou(nb);nb.Eg();dc.dispose();
return 32}}Object(C.a)(y,"DeleteOutlineLevelContentStrategy",null,[]);var B=d(106),G=d(181),F=d(68),K=d(228),O=d(19),H=d(25),I=d(11),J=d(108),L=d(40),S=d(211),E=d(92),P=d(34);class T{constructor(dc){this.wm=null;this.pja=dc}get Mvb(){return null!=this.Bgg?this.Bgg:this.Bgg=a.a.instance.Pa("Box4.IAutoCorrectRules")}get $V(){return null!=this.Dgg?this.Dgg:this.Dgg=a.a.instance.Pa("Box4.IAutoCorrectScheduler")}get dM(){return null!=this.Vog?this.Vog:this.Vog=a.a.instance.Pa("Box4.Pages.IPageContentEditor")}get rK(){return null!=
this.sog?this.sog:this.sog=a.a.instance.Pa("Box4.IOutlineEditor")}get xi(){return this.wm||(this.wm=this.pja())}Lki(dc,nb,Gb){if(this.rK&&T.vi){var lb=K.ContextSetEditor.aff(nb);dc=lb.node;O.SelectionEditor.uk(lb)&&(lb=P.a.Uc(dc,I.ParagraphReader.textLength(dc)));var Kb=J.FormattingReader.language(J.FormattingReader.Pr(lb));lb=t.GraphIterator.$a(Gb.rd);T.qh.VYc(lb);var Vb=dc=null;if(lb)for(let vc=lb.Rb(1);vc&&!Vb;vc=lb.Wi(1))E.OutlineReader.Ota(vc)&&(Vb=vc);if(lb&&!Vb){if(!this.dM||!this.rK)return;
dc=new u.GraphTransaction(7);dc.Ou(lb);Vb=this.dM.Mxd(lb);this.rK.r5(lb,!0);Kb&&(L.OutlineElementNavigator.De(lb),lb=P.a.Uc(lb.currentNode,0),T.vi.U6d(J.FormattingReader.Pr(lb),Kb))}Kb=H.SelectionFactory.wo(Vb,!0);Gb.Cb.setSelection(Kb);O.SelectionEditor.xf(nb)&&(Gb=t.GraphIterator.$a(nb.node),Gb.qo(),S.OutlineNavigator.VUf(Gb),this.Mvb&&this.$V&&E.OutlineReader.Pz(Gb,nb,!0)&&(nb=this.Mvb.h9e(nb,-1,!1,F.a.mx))&&this.$V.ZUi(nb));this.xi&&this.xi.EF();dc&&dc.dispose()}}static get vi(){return null!=
T.xkg?T.xkg:T.xkg=a.a.instance.Pa("Box4.IFormattingEditor")}static get instance(){return null!=T.Ymg?T.Ymg:T.Ymg=T.Gl()}static Gl(){return new T(()=>a.a.instance.Pa("Box4.IUndoManager"))}static get qh(){return G.PageNavigator.instance}}Object(C.a)(T,"TitleViewEditor",null,[]);var U=d(53),X=d(442),Y=d(647),ca=d(23),da=d(14),ua=d(297),ra=d(3);class qa{constructor(){this.jBj=new y}Vb(dc){const nb=Object(v.a)(this.Fyh,this.Fyh.n3e,"deleteView"),Gb=Object(v.a)(this,this.g3e,"deleteOutlineLevelContent"),
lb=Object(v.a)(this.uyh,this.uyh.dTk,"deleteParagraphContent");this.$Qf(dc,nb,Gb,lb);dc.pa(ra.a.backspace,da.a.Wc,lb);dc.pa(ra.a.backspace,da.a.Gd,lb);dc.pa(ra.a.backspace,da.a.endOfParagraph,e.ActionManager.qZ);dc.pa(ra.a.backspace,da.a.outline,Gb);dc.pa(ra.a.backspace,da.a.view,nb);dc.Vc(ra.a.backspace,1124);dc.pa(ra.a.gsa,da.a.Wc,e.ActionManager.qZ);dc.pa(ra.a.gsa,da.a.Gd,lb);dc.pa(ra.a.gsa,da.a.endOfParagraph,e.ActionManager.qZ);dc.pa(ra.a.gsa,da.a.outline,Gb);dc.pa(ra.a.gsa,da.a.view,nb);dc.gb(ra.a.hyd,
da.a.view,nb,1124);dc.pa(ra.a.SG,da.a.Wc,lb);dc.pa(ra.a.SG,da.a.Gd,lb);dc.pa(ra.a.SG,da.a.endOfParagraph,e.ActionManager.qZ);dc.pa(ra.a.SG,da.a.outline,Gb);dc.pa(ra.a.SG,da.a.view,nb);dc.Vc(ra.a.SG,1124);dc.gb(ra.a.v1e,da.a.view,nb,1124);dc.gb(ra.a.Aka,da.a.view,qa.Aka,1028)}$Qf(){}g3e(dc,nb,Gb,lb,Kb){return this.jBj.g3e(dc,nb,Gb,lb,Kb)}static get qh(){return G.PageNavigator.instance}static get Wg(){return null!=qa.vog?qa.vog:qa.vog=a.a.instance.resolve("Box4.IOutlineElementEditor")}static get dM(){return null!=
qa.Sog?qa.Sog:qa.Sog=a.a.instance.resolve("Box4.Pages.IPageContentEditor")}static get rK(){return null!=qa.rog?qa.rog:qa.rog=a.a.instance.resolve("Box4.IOutlineEditor")}static get Qb(){return null!=qa.Hjg?qa.Hjg:qa.Hjg=a.a.instance.Pa("Box4.IFeatureHelper")}static Aka(dc,nb,Gb,lb,Kb){lb=nb.view;if(!lb.Cb||!lb.Cb.hb.kb||O.SelectionEditor.Qm(lb.Cb.hb.kb))return 8;if(1===Gb)return 32;Gb=lb.Cb.hb;const Vb=Gb.kb;var vc=Vb.Qa,Fc=null,Zc=!1;if(Gb.zI){if(vc.contextId===da.a.outline&&1===Gb.length){for(dc=
t.GraphIterator.$a(vc.node);dc.Xd();)dc.Eg();qa.rK.r5(dc,!0);L.OutlineElementNavigator.De(dc);dc=H.SelectionFactory.xe(dc.currentNode,0);lb.Cb.setSelection(dc);return 32}var td=vc.node;Fc=null;if(ua.c(vc)){var xd=td.Ce(lb.Tb);xd&&(xd=xd.KJo)&&0<=xd.width&&0<=xd.height&&(Fc=new X.a(k.a.pn(xd.x,0),k.a.pn(xd.y,1)));Fc||(Fc=Y.a(td))}else Fc=Y.a(vc.node);vc=t.GraphIterator.$a(vc.node);vc.qo();qa.qh.VYc(vc);td=qa.dM.Mxd(vc);Y.b(td,Fc.x,Fc.y);qa.rK.r5(vc,!0);Fc=H.SelectionFactory.wo(td,!0)}else if(1===Gb.length){Zc=
Gb.last;vc=U.a.sxb(Zc);if(qa.Qb&&qa.Qb.isFeatureEnabled(23)&&K.ContextSetEditor.instance.f1f(vc).returnValue)return 2;Zc=Zc.Tc;Zc=!Gb.yw&&(O.SelectionEditor.uk(Zc)||I.ParagraphReader.gm(Zc)||O.SelectionEditor.v6(Zc))}Zc&&(Zc=O.SelectionEditor.Pj(Vb,!1,!1,void 0,!1),lb.Cb.setSelection(Zc),l.AFrameworkApplication.ya.Qf(nb,ra.a.VB,2,!1,null,Kb),Fc=lb.Cb.hb.kb,lb.Cb.setSelection(Vb));Kb||(Kb=new n.DictionaryPropertySet);Kb.setValue(B.a.pEc,!0);l.AFrameworkApplication.ya.Qf(nb,ra.a.SG,2,!0,null,Kb);if(Fc&&
Fc.Qa.Rd)return lb.Cb.setSelection(Fc),32;Gb.zI&&T.instance.Lki(dc,nb.vk,lb);O.SelectionEditor.Qm(lb.Cb.hb.kb)||l.AFrameworkApplication.ya.Qf(nb,ra.a.VB,2,!1,null,Kb);return 32}static YSk(dc,nb){if(1===nb)return 32;nb=new u.GraphTransaction(7);nb.Db(dc);qa.Wg.QDa(dc);nb.dispose();return 32}}Object(C.a)(qa,"ADeleteActor",null,[]);var ka=d(9),la=d(247),Ha=d(254),wa=d(20),Ca=d(157),Ja=d(1485);class bb{lSk(dc,nb,Gb){({DeleteActor:dc}=d(1555));if(1===Gb)return 32;Gb=ka.App.xa.jq.hg("ModelUpdate","DeleteAnchoredObject");
nb=nb.node;const lb=new t.GraphIterator;lb.set(nb);lb.Bb(12);const Kb=lb.ap(12);if(bb.Zf.GOc(Kb))return 2;dc.yWb(Kb);dc=new u.GraphTransaction(7);dc.Db(nb);lb.Eg();dc.dispose();Gb.stop();return 32}static get Zf(){return la.a.instance}}Object(C.a)(bb,"DeleteAnchoredObjectStrategy",null,[]);var ha=d(59),ia=d(16),va=d(120),Ka=d(72),Xa=d(110),xa=d(692),Ma=d(138);class Na{get Zf(){return la.a.instance}dTk(dc,nb,Gb,lb,Kb){if(1===Gb)return 32;lb=dc===ra.a.backspace;if(this.Zf.yh){if(this.Zf.ldi(nb)&&Na.Tra&&
(Gb=nb.clone(),Gb.Ub+=1,--Gb.Fb,this.Zf.O7b(Gb)))return Na.Tra.LMi([Gb]),32;if(this.Zf.Rrf(nb,lb))return 2}if(Na.uw()&&Na.uw().instance&&Na.uw().instance.HT(nb))return 4;var Vb=nb.node;let vc=nb.cpBegin;Gb=nb.cpEnd;let Fc=nb.Fb,Zc=nb.Ub;const td=I.ParagraphReader.text(Vb),xd=td.length;let le=!1;if(vc===Gb){if(lb&&!vc||!lb&&vc===xd)return 2;lb?({cp:vc,returnValue:le}=this.Zf.isi(Vb,vc),le||({cp:vc,Uja:Fc,returnValue:le}=this.Zf.hsi(nb,vc,Fc)),le||(vc--,ia.a.Ny(td,vc)&&vc--),dc=ra.a.GSe):({cp:Gb,returnValue:le}=
this.Zf.HJm(Vb,Gb),le||({cp:Gb,Uja:Zc,returnValue:le}=this.Zf.GJm(nb,Gb,Zc)),le||(Gb++,ia.a.Ny(td,Gb)&&Gb++),dc=ra.a.fyh)}nb=vc===Gb?P.a.Uc(Vb,vc):P.a.createTextRange(Vb,vc,Gb);le&&this.Zf.yh&&(lb?nb.Fb=Fc:nb.Ub=Zc);if(!this.Zf.O7b(nb))return 2;this.yWb(Vb);lb=new u.GraphTransaction(15);lb.Al=dc;lb.Db(Vb);Vb=Object(va.a)(xa.a,Kb)&&Kb.TXa;if(Na.Qd.ng&&!Vb){Vb=Na.Qd.HVa();try{const Yc=Na.Ph.$0c(nb);let xc;if(({type:xc}=Yc.PId()).returnValue){const md=Object(Ka.a)(93,Kb);md&&md.ia(Xa.a.$pf,!1)||!Ma.a.fE&&
4===xc?Na.Qd.r1a=xc:Na.Qd.zs(xc)}Kb=0;for(let md=Yc.length-1;0<=md;--md){let Ie;const Te=({IQd:Ie}=Yc.getContext(md)).returnValue;Ie?(Na.hyperlinkEditor.Ohb(Te,null),Kb+=Na.Nj.zkb(Te,2),Na.Nj.lxd=Gb+Kb):this.vyh(Te)}}finally{Vb&&Vb.dispose()}}else this.vyh(nb);lb.dispose();return 32}yWb(){}static get Qd(){return null!=Na.Xrg?Na.Xrg:Na.Xrg=a.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance}static get Nj(){return null!=Na.Jrg?Na.Jrg:Na.Jrg=a.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance}static get Ph(){return null!=
Na.qsg?Na.qsg:Na.qsg=a.a.instance.resolve("Box4.TrackChange.ITrackChangeReaderFactory").instance}static get hyperlinkEditor(){return null!=Na.$kg?Na.$kg:Na.$kg=a.a.instance.resolve("Box4.IHyperlinkEditor")}static uw(){return Na.Hm||(Na.Hm=a.a.instance.Za("Box4.IExternalSelectionManager"))}static get Tra(){Na.zpb||(Na.zpb=a.a.instance.Za("Box4.ContentControl.IContentControlOperator"));return Na.zpb.instance}}Na.Hm=null;Na.zpb=null;Object(C.a)(Na,"ADeleteParagraphContentStrategy",null,[]);var pa=d(183),
Ra=d(791),Sa=d(235),ab=d(89),eb=d(76),zb=d(86);class Ua extends Na{constructor(){super()}get characterPropertiesEditor(){return null!=this.Zgg?this.Zgg:this.Zgg=a.a.instance.resolve("Box4.ICharacterPropertiesEditor")}get sq(){return null!=this.Qgg?this.Qgg:this.Qgg=a.a.instance.Za("Box4.ContentControlConfigSettings")}get J9b(){return null!=this.fog?this.fog:this.fog=a.a.instance.resolve("Box4.Proofing.IModifiedRangeEditor")}get Fda(){return null!=this.uhg?this.uhg:this.uhg=a.a.instance.resolve("Box4.IContentControlChpHelper")}vyh(dc){this.rSk(dc)}l$j(dc,
nb,Gb,lb){this.sq.instance&&this.sq.instance.yh&&(dc.cpBegin===nb.cpBegin?dc.Fb=nb.Fb:Gb&&(dc.Fb=Gb.Mb&&Gb.Mb.length?0:-1),dc.Ub=lb)}yWb(dc){const {DeleteActor:nb}=d(1555);nb.yWb(dc)}rSk(dc){var nb=dc.node;const Gb=Sa.b([new pa.a(dc.cpBegin,dc.cpEnd)],this.KNl(dc));var lb=new zb.a,Kb=[];Ua.gzk(nb,Gb,lb,Kb);for(let Vb of lb.keys)1<lb.J(Vb)&&Ra.a.Hvi(ha.a.Of(Vb));this.gpn(nb,Kb);this.J9b.WAc(nb);nb=dc.Ub;lb=!!this.sq.instance&&this.sq.instance.yh;for(Kb=Gb.length-1;0<=Kb;Kb--)nb=this.deleteRange(dc,
Gb[Kb],nb,lb)}KNl(dc){const nb=[],Gb=dc.node;var lb=ab.f(Gb,vc=>vc.Tja);for(var Kb of lb)lb=Kb.Ob.cp,nb.push(new pa.a(lb,lb+1));Kb=I.ParagraphReader.vLa(Gb);for(var Vb of Kb)Vb.IS&&Ua.Qcm(Vb,dc)||nb.push(Vb);Vb=!!this.sq.instance&&this.sq.instance.Yla;this.sq.instance&&this.sq.instance.yh||!Vb||!Gb.vw||(Ua.$qh&&Ua.$qh.fon(dc),this.Fda&&nb.push(...this.Fda.Ccf(Gb).toArray()));return Sa.a(nb)}gpn(dc,nb){const Gb=new eb.a;for(let lb of nb)for(nb=0;nb<lb.length;){nb=this.ySh(lb,nb,0);if(-1===nb)break;
let Kb=this.ySh(lb,nb+1,3);if(-1===Kb)break;if(lb.J(nb).IS)for(;Kb>=nb;){const Vb=lb.J(Kb);Gb.add(Vb.Ee);lb.remove(Vb);Kb--}nb=Kb+1}dc.sga(wa.a.instance.J(6),Gb)}ySh(dc,nb,Gb){for(;nb<dc.length;nb++){const lb=dc.J(nb);if(1===lb.AQ&&lb.Yl===Gb)return nb}return-1}deleteRange(dc,nb,Gb,lb){let Kb=nb.begin,Vb=nb.end;nb=null;lb&&(nb=dc.node.qa.ji(Kb));Kb<Vb&&(lb=P.a.createTextRange(dc.node,Kb,Vb),this.l$j(lb,dc,nb,Gb),this.characterPropertiesEditor.replaceTextRange(lb,"",void 0,void 0,ra.a.pzc));return Gb=
nb&&nb.Mb&&nb.Mb.length?nb.Mb.length:-1}static get $qh(){return null!=Ua.Fhg?Ua.Fhg:Ua.Fhg=a.a.instance.Pa("WordEditor.ContentControl.IContentControlOperator")}static Qcm(dc,nb){return dc.begin>=nb.cpBegin&&dc.end<=nb.cpEnd}static gzk(dc,nb,Gb,lb){let Kb=0;dc=dc.qa;for(let Vb of nb)for(;Kb<dc.length;){nb=dc.J(Kb);if(nb.cp>=Vb.begin&&nb.cp<Vb.end&&(nb.af&&nb.af.ODk&&lb.push(nb.af),nb.Lh))for(let vc=0;vc<nb.Lh.length;vc++){const Fc=nb.Lh.J(vc).qn.toString();Gb.xb(Fc)?Gb.Z(Fc,Gb.J(Fc)+1):Gb.Z(Fc,1)}++Kb}}}
Object(C.a)(Ua,"DeleteParagraphContentStrategy",Na,[]);class Ab{static get fG(){return Ha.a.instance}static zTk(dc,nb,Gb){if(1===Gb)return 32;dc=nb.node;return Ab.fG.Gtd(dc)?qa.YSk(dc,Gb):32}}Object(C.a)(Ab,"DeleteUnsupportedObjectStrategy",null,[]);var mb=d(169),Rb=d(335),hc=d(125),Hb=d(299),Ta=d(8),Aa=d(997),ma=d(43),Ga=d(131),Fa=d(655),ib=d(441),ob=d(549),fb=d(596),Mb=d(832),Tb=d(184),rc=d(147),vb=d(291),Ya=d(530),wb=d(38),jb=d(134);class Zb{constructor(dc,nb,Gb,lb){this.lqo=dc;this.k7=Gb;this.Cd=
lb;this.actionId=nb}}Object(C.a)(Zb,"DeleteActionData",null,[]);var Eb=d(979),tc=d(231);class lc{constructor(dc,nb,Gb,lb,Kb,Vb,vc,Fc,Zc){this.wyh=dc;this.Zf=nb;this.fG=Gb;this.hyperlinkEditor=lb;this.xI=Kb;this.Sn=Vb;this.nDi=vc;this.characterPropertiesEditor=Fc;this.Qd=Zc}S$n(dc){return!O.SelectionEditor.Ek(dc)&&!O.SelectionEditor.I$(dc)}HIl(dc,nb,Gb){let lb,Kb,Vb,vc;if(!nb&&dc&&dc.eE&&(lb=dc.Qa)&&O.SelectionEditor.xf(lb)&&this.Sn.nc(lb.node)&&(Kb=lb.node.qa.ji(lb.cpBegin))&&Kb.wl&&(Vb=this.wll(Kb))&&
Vb.hyperlink.GF&&(vc=this.xIl(dc,Vb.cp)))return vc;if(!dc)return null;if(!Gb)return dc;nb=O.SelectionEditor.JXa(dc,!nb,{eC:!1,Xs:!0,kE:!0,dG:!0});return H.SelectionFactory.XC(dc,nb.Qa,!1)}wll(dc){const nb=dc.paragraph.qa;let Gb=null;dc=dc.cp;for(let lb=0;lb<nb.length;lb++){const Kb=nb.J(lb);if(Kb.cp>=dc)break;Kb.wl&&(Gb=null);Kb.hyperlink&&(Gb=Kb)}return Gb}xIl(dc,nb){var Gb=O.SelectionEditor.IAa(dc,{eC:!1,Xs:!1,kE:!0,dG:!0});if(!Gb||!Gb.eE||Gb.Qa.node!==dc.Qa.node)return null;Gb=Gb.Qa;if(Gb.cpBegin!==
Gb.cpEnd)return null;const lb=this.Sn.text(Gb.node);for(let Kb=Gb.cpBegin-1;Kb>=nb;Kb--)if(!ia.a.$u(lb.charCodeAt(Kb)))return H.SelectionFactory.XC(dc,P.a.Uc(Gb.node,Kb+1),!1);return H.SelectionFactory.XC(dc,P.a.Uc(Gb.node,nb),!1)}n3e(dc,nb,Gb,lb,Kb){if(1===Gb)return 32;var Vb=!1;dc===ra.a.v1e?(dc=ra.a.SG,Vb=!0):dc===ra.a.hyd?(dc=ra.a.backspace,Vb=!0):dc===ra.a.gsa&&(nb=new ob.a(ka.App.xa.jb.Ic));if(!nb.view.ze)return 2;rc.GrippersManager.instance.XA(!1);Gb=dc===ra.a.SG;const vc=vb.a.SQh(nb);if(Vb&&
this.Zf.yh&&vc&&O.SelectionEditor.Qm(vc)&&this.Zf.Rrf(vc.Qa,!Gb,!0))return 2;Vb=this.HIl(vc,Gb,Vb);return this.BTk(dc,nb,lb,Kb,Vb,Gb)}BTk(dc,nb,Gb,lb,Kb,Vb){const vc=nb.view,Fc=vc.Cb;var Zc=lb,td=lb;dc===ra.a.gsa&&(td=Zc=null,Kb=new Tb.Selection(lb,!0));if(!Kb)return 32;const xd=new Zb(nb,dc,Gb,td),le=this.DSn(Zc,Vb);if(this.Zf.yh&&lc.Tra&&1===Fc.hb.length&&O.SelectionEditor.Qm(Kb)&&Kb.eE&&lc.Tra.GDn(Kb.Qa,Vb))return 32;let Yc;Vb?mb.a.mark(Yc=5009):mb.a.mark(Yc=5011);Zc=new u.GraphTransaction(15);
Zc.Al=dc;Zc.Db(vc.rd);let xc=null,md=({mCn:xc}=this.tnl(dc,lb,Fc,Kb,xc)).returnValue;td=null;({g9d:td}=K.ContextSetEditor.instance.f1f(md)).returnValue&&(md=td);if(!md)return Zc.dispose(),32;this.Zf.yh&&lc.Tra&&(td=K.ContextSetEditor.instance.rP(md),lc.Tra.LMi(td));this.mcj(md);const Ie=this.bhl(md,Kb,Vb);let Te=null;Vb?Te=new Mb.a(Kb):Ie&&(Te=new Mb.a(Ie));let rf=!1;td=lc.fj;if(O.SelectionEditor.xf(md)){const ke=Eb.a.WGd(vc.rd,le);td.Pd(()=>{this.mSk(nb,Gb,lb,md,Vb,Te,Kb,ke,Fc,le,xd,Ie)},"DVS:DAIPC")}else this.Qd.ng?
(td.Pd(()=>{this.R$n(dc,vc.rd,md,Vb,Kb,Fc,le,xd,Te)},"DVS:TCDC"),rf=!0):td.Pd(()=>{rf=this.xEi(dc,vc.rd,md,Fc,le,xd,Te,xc)},"DVS:PUD");this.Qal(Fc);this.FRi(md);Zc.dispose();mb.a.mark(Yc+1);return dc===ra.a.gsa?rf?32:8:32}xEi(dc,nb,Gb,lb,Kb,Vb,vc,Fc){nb=Eb.a.WGd(nb,Kb);this.S$n(Gb)&&nb.S3a(Gb);dc=lc.Mc.oo(dc);dc.properties.Z("CountOfParagraphsDeleted",this.Sn.d_e(Gb).toString());Gb=this.CXk(Gb,lb,Kb,nb,Vb,vc,Fc);dc.end();return Gb}R$n(dc,nb,Gb,lb,Kb,Vb,vc,Fc,Zc){var td=0,xd=null;const le=K.ContextSetEditor.instance.rP(Gb),
Yc=le[le.length-1];if(Yc.contextId===da.a.paragraph||Yc.contextId===da.a.endOfParagraph){var xc=t.GraphIterator.$a(Yc.node);xc.vd();L.OutlineElementNavigator.Zd(xc);L.OutlineElementNavigator.Vr(xc,!0,!1)&&(xd=L.OutlineElementNavigator.De(xc))&&(td=this.Sn.textLength(xd))}else td=this.Sn.textLength(Yc.node)-Yc.cpEnd;xc=Object(Ka.a)(93,Fc.Cd);if(xc=!!xc&&xc.ia(Xa.a.$pf,!1))this.vEi(dc,nb,Gb,Vb,vc,Fc,Zc,!1,xc);else{xc=this.Qd.HVa();try{this.vEi(dc,nb,Gb,Vb,vc,Fc,Zc,!0)}finally{xc&&xc.dispose()}}if(lb){if(Gb.Xw){dc=
le.length-1;do Kb=le[dc],dc--;while(!Kb.node.isConnected&&0<=dc)}else Kb=Gb;if(!this.Sn.nc(Kb.node))return;switch(Yc.contextId){case da.a.paragraph:case da.a.endOfParagraph:td=xd&&xd.isConnected?0:td;break;case da.a.Wc:case da.a.Gd:break;default:td=0}td=H.SelectionFactory.xe(Kb.node,this.Sn.textLength(Kb.node)-td);Kb.hl===td.Qa.cpBegin&&(td.Qa.Fb=Kb.Fb)}else{td=Kb.Qa.node;if(!this.Sn.nc(td))return;xd=Kb.Qa.contextId===da.a.paragraph?0:Kb.Qa.contextId===da.a.endOfParagraph?this.Sn.textLength(td):Kb.Qa.cpBegin;
td=H.SelectionFactory.xe(td,xd)}U.a.instance.setSelection(td)}vEi(dc,nb,Gb,lb,Kb,Vb,vc,Fc,Zc=!1){Gb=this.Vel(lb,Gb);Gb=lc.Ph.$0c(Gb);({type:xd}=Gb.PId()).returnValue&&(Fc&&4!==xd?this.Qd.zs(xd):Ma.a.fE||(this.Qd.r1a=xd));for(Fc=Gb.length-1;0<=Fc;--Fc){var td=void 0;var xd=({IQd:td}=Gb.getContext(Fc)).returnValue;td?(td=Zc&&xd.contextId===da.a.endOfParagraph&&Fc===Gb.length-1,this.hyperlinkEditor.Ohb(xd,2),td||lc.Nj.zkb(xd,2)):this.xEi(dc,nb,xd,lb,Kb,Vb,vc,null)}}Vel(dc,nb){if(Object(va.a)(ib.a,nb)){dc=
fb.OutlineElementGeneralizer.$ka(dc.hb,!0);for(let Gb=0;Gb<dc.length;Gb++)if(dc.getContext(Gb).contextId===da.a.table)return dc}return nb}tnl(dc,nb,Gb,lb,Kb){dc===ra.a.gsa?(dc=Rb.a.Qza(nb),Kb=Ya.SelectionReferenceFactory.instance.xxb()):(Kb=null,dc=1===Gb.hb.length?U.a.sxb(lb):Gb.Rg);return{returnValue:dc,mCn:Kb}}Uqk(dc){return!dc.vl||dc.contextId!==da.a.paragraph||!this.Sn.nc(dc.node)||this.Qd.ng||this.Zf.GPd(dc)?!1:!0}mcj(dc){if(dc.Xw)for(let nb=0;nb<dc.length;nb++)this.mcj(dc.getContext(nb));else this.Uqk(dc)&&
(dc.node.Htd=!0)}FRi(dc){if(dc.Xw)for(let nb=0;nb<dc.length;nb++)this.FRi(dc.getContext(nb));else dc.vl&&(dc=dc.node)&&this.Sn.nc(dc)&&(dc.Htd=!1)}bhl(dc,nb,Gb){if(dc.vl&&O.SelectionEditor.xf(dc)&&!Gb){const lb=dc.node;let Kb=dc.cpBegin,Vb=-1;if(({cp:Kb}=this.Zf.isi(lb,Kb)).returnValue)return H.SelectionFactory.xe(lb,Kb);if(({cp:Kb,Uja:Vb}=this.Zf.hsi(dc,Kb,Vb)).returnValue)return nb=H.SelectionFactory.xe(lb,Kb),nb.Qa.Fb=Vb,nb.Qa.Ub=Vb,nb}nb=O.SelectionEditor.JXa(nb,!Gb,{eC:!0,Xs:!1,kE:!1,dG:!0});
this.Zf.yh&&O.SelectionEditor.Ek(dc)&&(nb.Qa.Ub=nb.Qa.Fb=Gb?dc.Ub:dc.Fb);return nb}mSk(dc,nb,Gb,lb,Kb,Vb,vc,Fc,Zc,td,xd,le){const Yc=lc.fj;!O.SelectionEditor.Pz(lb.node,lb,Kb)||this.Zf.yh&&this.Zf.ldi(lb)?Yc.Pd(()=>{this.RSk(lb,Kb,Vb,vc,Fc,Zc,td,xd)},"DVS:IPM"):Yc.Pd(()=>{let xc,md;({response:xc,LX:md}=this.QSk(dc,nb,Gb,lb,Kb,vc,Fc,Zc,xd,le));lc.hui(Fc,32===xc);md&&lc.Gna(Zc,Vb)},"DVS:ISE")}BTl(dc,nb){tc.a.bX&&(nb.Cd||(nb.Cd=new n.DictionaryPropertySet),nb.Cd.setValue(Xa.a.Bma,"delete"),nb.Cd.setValue(Xa.a.tfa,
"backspace"));var Gb=dc.kW;let lb=lc.hd.VN(Gb);const Kb=Fa.a.Ppm;if(null===Kb||void 0===Kb?0:Kb.cjm(Gb,lb)){tc.a.bX&&nb.Cd.setValue(Xa.a.tfa,"backspace-autocorrect");Gb=Kb.Tcj+" ";let Vb=P.a.Uc(dc,0);this.characterPropertiesEditor.replaceTextRange(Vb,Gb);dc=H.SelectionFactory.xe(dc,Gb.length);U.a.instance.setSelection(dc);Ta.ULS.sendTraceTag(540386467,393,50,"Unlisted list with trigger string: {0}",Kb.Tcj)}return l.AFrameworkApplication.ya.Qf(nb.lqo,lb.sr?ra.a.tH:ra.a.Xz,2,!1,nb.k7,nb.Cd)}aTl(dc,
nb,Gb,lb,Kb){let Vb=!1;0<this.nDi.g2(dc).kt&&(Kb=l.AFrameworkApplication.ya.Qf(nb,ra.a.hcc,2,!1,Gb,lb),Vb=!0);return{tT:Vb,response:Kb}}hTl(dc,nb,Gb,lb,Kb){let Vb=!1;0<this.nDi.wF(dc).kt&&(Kb=l.AFrameworkApplication.ya.Qf(nb,ra.a.MXc,2,!1,Gb,lb),Vb=!0);return{tT:Vb,response:Kb}}hUl(dc,nb,Gb,lb,Kb){let Vb=!1;lc.qp.pwb(dc)&&(Kb=l.AFrameworkApplication.ya.Qf(nb,ra.a.OF,2,!1,Gb,lb),Vb=!0);return{tT:Vb,response:Kb}}NRl(dc,nb,Gb,lb,Kb,Vb,vc,Fc,Zc){const td=new Ga.a;td.fd(nb);let xd=!1;if(L.OutlineElementNavigator.RCa(td,
!1,!dc,!1)){Zc=!0;Fc=32;xd=!0;(new t.GraphIterator).fd(td);L.OutlineElementNavigator.De(td);const Yc=td.currentNode;var le=new t.GraphIterator;le.set(Vb);(le=this.Sn.isEmpty(le))&&lb&&O.SelectionEditor.v6(lb.Qa)?(Gb.S3a(Kb),L.OutlineElementNavigator.De(nb),lc.Wg.QDa(nb.currentNode)):Yc.yI?(Gb.S3a(Kb),L.OutlineElementNavigator.Zd(td),td.Eg()):dc&&le?this.Zf.Efi(Vb)&&!({LX:Zc}=this.$Gi(dc,Vb,Yc,lb,Zc)).returnValue&&(Gb.S3a(Kb),lc.Ko.RDa(nb),this.wyh.v7m(Vb),nb.Eg()):wb.TableReader.isTable(td)?(Gb.S3a(Kb),
dc&&(ca.moveToFirstRow(td),ca.moveToFirstColumn(td),S.OutlineNavigator.P6(td),L.OutlineElementNavigator.De(td),vc.setSelection((new Mb.a(H.SelectionFactory.xe(td.currentNode,0))).restore())),Fc=2,Zc=!1):this.Sn.nc(Yc)&&(1==this.Sn.textLength(Yc)&&(vc=ab.e(Yc),1==vc.length&&8==vc[0].si&&(vc=P.a.createTextRange(Yc,0,1),this.characterPropertiesEditor.replaceTextRange(vc,"",void 0,void 0,ra.a.pzc))),({LX:Zc}=this.$Gi(dc,Vb,Yc,lb,Zc)).returnValue||this.wyh.nSk(dc,Gb,Kb,nb,Vb,td))}return{tT:xd,response:Fc,
LX:Zc}}$Gi(dc,nb,Gb,lb,Kb){if(this.Qd.ng){if(lc.Ura){const Vb=Object(va.a)(jb.AParagraphNode,Gb)?lc.Ura.sDb(Gb):!1,vc=Object(va.a)(jb.AParagraphNode,nb)?lc.Ura.sDb(nb):!1;if(Vb!==vc)return{returnValue:!1,LX:Kb};if(!Ma.a.fE&&vc)return this.Zf.yh&&lc.Oek(nb,Gb,dc)&&this.Qd.zs(4),{returnValue:!1,LX:Kb}}dc=dc?nb:Gb;if(!Object(va.a)(jb.AParagraphNode,dc))return{returnValue:!1,LX:Kb};nb=dc.qa.last;Gb=l.AFrameworkApplication.userName;if(!nb.Zi||nb.Zi.authorName!==Gb)return lc.Nj.XJb(dc,2),lb&&(U.a.instance.setSelection(lb),
Kb=!1),{returnValue:!0,LX:Kb}}return{returnValue:!1,LX:Kb}}vTl(dc,nb,Gb,lb,Kb,Vb,vc,Fc){ma.OutlineElementReader.cdm(nb,dc)||({response:vc,LX:Fc}=lc.vYk(Gb,lb,dc,Vb,Kb,vc,Fc));return{tT:!1,response:vc,LX:Fc}}QSk(dc,nb,Gb,lb,Kb,Vb,vc,Fc,Zc,td){let xd=!1,le=2;const Yc=lb.node;let xc=void 0,md=!1;const Ie=lc.fj;if(!Kb){if(Yc.kW)return Ie.Pd(()=>{le=this.BTl(Yc,Zc)},"DVS:HLOE"),{response:le,LX:xd};Ie.Pd(()=>{({response:le,tT:md}=this.aTl(Yc,dc,nb,Gb,le))},"DVS:HIOD");if(md)return{response:le,LX:xd};Ie.Pd(()=>
{({response:le,tT:md}=this.hTl(Yc,dc,nb,Gb,le))},"DVS:HWPF");if(md)return{response:le,LX:xd};xc=this.cTh(Yc);Ie.Pd(()=>{({response:le,tT:md}=this.hUl(xc,dc,nb,Gb,le))},"DVS:HPOB");if(md)return{response:le,LX:xd}}null!==xc&&void 0!==xc?xc:xc=this.cTh(Yc);Ie.Pd(()=>{({response:le,tT:md,LX:xd}=this.NRl(Kb,xc,vc,td,lb,Yc,Fc,le,xd))},"DVS:HAOE");if(md)return{response:le,LX:xd};Ie.Pd(()=>{({response:le,tT:md,LX:xd}=this.vTl(Kb,xc,nb,Gb,vc,Vb,le,xd))},"DVS:HFLOE");return{response:le,LX:xd}}MSn(dc){return O.SelectionEditor.Ek(dc)||
this.fG.Hii(dc)||O.SelectionEditor.I$(dc)}DSn(dc,nb){return dc&&dc.hasProperty(B.a.pEc)?!dc.ia(B.a.pEc,!1):!nb}static get hd(){return null!=lc.Png?lc.Png:lc.Png=a.a.instance.resolve("Box4.List.IListReader")}static get Ko(){return null!=lc.Gng?lc.Gng:lc.Gng=a.a.instance.resolve("Box4.List.IListEditor")}static get Wg(){return null!=lc.Dog?lc.Dog:lc.Dog=a.a.instance.resolve("Box4.IOutlineElementEditor")}static get qp(){return Aa.a.GAb}static get Nj(){return null!=lc.Nrg?lc.Nrg:lc.Nrg=a.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance}static get Ph(){return null!=
lc.ssg?lc.ssg:lc.ssg=a.a.instance.resolve("Box4.TrackChange.ITrackChangeReaderFactory").instance}static get Mc(){return hc.a.instance}static get Tra(){lc.zpb||(lc.zpb=a.a.instance.Za("Box4.ContentControl.IContentControlOperator"));return lc.zpb.instance}static get Ura(){return null!=lc.Jhg?lc.Jhg:lc.Jhg=a.a.instance.Pa("Box4.IContentControlReader")}static get fj(){return Hb.a.instance}Qal(dc){if(1===dc.hb.length&&(dc=dc.hb.J(0),O.SelectionEditor.Qm(dc))){var nb=dc.Qa;dc=nb.node;nb=nb.cpBegin;var Gb=
this.Sn.text(dc);nb<Gb.length&&0<nb&&" "===Gb.charAt(nb-1)&&" "===Gb.charAt(nb)&&this.characterPropertiesEditor.replaceTextRange(P.a.createTextRange(dc,nb-1,nb),"\u00a0")}}dhk(dc,nb){if(!nb.hyperlink.Yfb){const Gb=new u.GraphTransaction(15);try{Gb.Db(dc.node),this.xI.RQ(dc,nb)}finally{Gb&&Gb.dispose()}nb.hyperlink.GF&&this.Qd.zs(2)}}static vYk(dc,nb,Gb,lb,Kb,Vb,vc){if(Gb=O.SelectionEditor.JXa(lb,!Gb,{eC:!1,Xs:!1,kE:!1,dG:!0})){lb=H.SelectionFactory.XC(lb,Gb.Qa);Vb=32;for(Gb=0;Gb<lb.length;++Gb){Kb.S3a(lb.J(Gb));
const Fc=l.AFrameworkApplication.ya.Qf(lb.J(Gb),ra.a.SG,2,!0,dc,nb);2!==Fc&&(Vb=Fc)}32===Vb&&(vc=!0)}return{response:Vb,LX:vc}}CXk(dc,nb,Gb,lb,Kb,Vb,vc){let Fc=!1;this.NSn(dc)?(Fc=lc.H4e(dc,!0,nb,Gb,lb,Kb))&&lc.oFa(Vb,nb,vc):this.MSn(dc)?(Fc=lc.H4e(dc,!1,nb,Gb,lb,Kb))&&lc.oFa(Vb,nb,vc):(lb.normalize(),lc.oFa(Vb,nb,vc));return Fc}static oFa(dc,nb,Gb){Gb&&Gb.Gna()||lc.Gna(nb,dc)}static H4e(dc,nb,Gb,lb,Kb,Vb){lb||E.OutlineReader.DMa(dc)||(Gb=lc.g3c(Gb))&&Kb.hPn(Gb);dc=32===l.AFrameworkApplication.ya.Qf(dc,
Vb.actionId,2,nb,Vb.k7,Vb.Cd);lc.hui(Kb,dc);return dc}static hui(dc,nb){nb?dc.normalize():dc.cancel()}static Gna(dc,nb){nb&&lc.fj.Pd(()=>{const Gb=nb.restore();Gb&&dc.setSelection(Gb)},"DVS:RS")}RSk(dc,nb,Gb,lb,Kb,Vb,vc,Fc){let Zc;!nb&&({hyperlink:Zc}=this.xI.M6b(dc)).returnValue?(Gb=new Mb.a(lb),this.dhk(dc,Zc),Kb.normalize(),lc.Gna(Vb,Gb)):lc.H4e(dc,!1,Vb,vc,Kb,Fc)&&(nb&&this.Qd.ng?(nb=lc.Nj.lxd)?(Vb.setSelection(H.SelectionFactory.xe(dc.node,nb)),lc.Nj.lxd=null):lc.Gna(Vb,Gb):lc.Gna(Vb,Gb))}static Oek(dc,
nb,Gb){Gb?(Gb=dc,dc=nb):Gb=nb;nb=lc.Ura.j7b(Gb,!1);dc=lc.Ura.j7b(dc,!0);return!(nb&&dc)}NSn(dc){return dc.Xw||E.OutlineReader.DMa(dc)||this.Sn.gm(dc)}static g3c(dc){return(dc=fb.OutlineElementGeneralizer.$ka(dc.hb,!0))&&1===dc.length&&(dc=dc.getContext(0).node,wb.TableReader.fX(dc))?dc:null}cTh(dc){const nb=new t.GraphIterator;nb.set(dc);nb.vd();L.OutlineElementNavigator.Zd(nb);return nb}}lc.zpb=null;Object(C.a)(lc,"ADeleteViewStrategy",null,[]);class Lc{nSk(dc,nb,Gb,lb,Kb,Vb){const vc=Vb.currentNode;
L.OutlineElementNavigator.Zd(Vb);dc?(nb.ncj(Vb.currentNode),Lc.Zf.wei(Gb,Kb,vc,!1)||Lc.Wg.merge(lb,Vb,!1,!1)):Lc.Zf.wei(Gb,vc,Kb,!0)||Lc.Wg.merge(Vb,lb,!1,!1)}v7m(dc){dc&&I.ParagraphReader.nc(dc)&&(Ja.a.GXc(dc),Lc.H_k.QPe(dc))}static get Wg(){return null!=Lc.yog?Lc.yog:Lc.yog=a.a.instance.resolve("Box4.IOutlineElementEditor")}static get H_k(){return null!=Lc.uig?Lc.uig:Lc.uig=a.a.instance.resolve("Box4.IDynamicRangeEditor")}static get Zf(){return la.a.instance}}Object(C.a)(Lc,"DeleteParagraphNodeStrategy",
null,[523]);class Bb extends lc{constructor(dc,nb,Gb,lb,Kb,Vb,vc,Fc){super(new Lc,dc,nb,Gb,lb,Kb,Vb,vc,Fc)}}Object(C.a)(Bb,"DeleteViewStrategy",lc,[]);d.d(N,"DeleteActor",function(){return jc});class jc extends qa{constructor(dc,nb,Gb,lb,Kb,Vb,vc,Fc,Zc,td,xd){super();this.deleteParagraph=(le,Yc)=>{le=Yc.node;Ja.a.GXc(le);this.foe.QPe(le);this.nl&&this.nl.instance&&Ca.App.hee&&this.nl.instance.LHf(le);le.vw&&(this.qm.eon(le,!this.yh),this.yh&&this.DFg.instance&&this.DFg.instance.rgj(le));return 0};
this.$yd=(le,Yc,xc)=>{2==xc&&(le=l.AFrameworkApplication.breadcrumbFolderUrl,le&&0!=le.length||(le=l.AFrameworkApplication.breadcrumbBrandUrl),ka.App.uzb(le));return 32};this.kBj=new Ua;this.XAg=new bb;this.lBj=new Bb(la.a.instance,Ha.a.instance,Vb,vc,Fc,Zc,td,xd);this.qm=dc;this.Xnc=nb;this.DFg=Gb;this.foe=lb;this.nl=Kb}get yh(){return this.Xnc.instance?this.Xnc.instance.yh:!1}get Fyh(){return this.lBj}get uyh(){return this.kBj}$Qf(dc,nb,Gb,lb){const Kb=Ab.zTk,Vb=Object(v.a)(this.XAg,this.XAg.lSk,
"deleteAnchoredObject");dc.pa(ra.a.backspace,da.a.anchoredObject,Vb);dc.pa(ra.a.backspace,da.a.unsupportedObject,Kb);dc.pa(ra.a.SG,da.a.anchoredObject,Vb);dc.pa(ra.a.SG,da.a.unsupportedObject,Kb);dc.pa(ra.a.backspace,da.a.paragraph,this.deleteParagraph);dc.pa(ra.a.SG,da.a.paragraph,this.deleteParagraph);dc.pa(ra.a.gsa,da.a.paragraph,this.deleteParagraph);dc.pa(ra.a.$yd,da.a.view,this.$yd);dc.Vc(ra.a.gsa,64);super.$Qf(dc,nb,Gb,lb)}static yWb(dc){wa.a.instance.J(4)&&ka.App.ud.Mp&&ka.App.ud.Lq.CG(dc)}}
Object(C.a)(jc,"DeleteActor",qa,[])},1558:function(C,N,d){C=d(0);class l{constructor(v,u,t,y){this.jAj=v;this.RSj=u;this.PSj=t;this.SSj=y}get EZe(){return this.jAj}get FUf(){return this.RSj}get CUf(){return this.PSj}get resultType(){return this.SSj}}Object(C.a)(l,"SearchContext",null,[1105]);class e{J0e(v,u,t,y){var B=t-u;let G;if(100<=B)B=u,G=t;else{B=Math.max(0,u+Math.ceil(B/2)-50);G=Math.min(v.length,B+100);B=Math.max(0,G-100);let K;if(B&&" "!==v.charAt(B-1)){K=Math.min(u,B+10);for(var F=B;F<K;++F)if(" "===
v.charAt(F)){B=F+1;break}}if(G!==v.length&&" "!==v.charAt(G))for(K=Math.max(t,G-10),F=G-1;F>=K;--F)if(" "===v.charAt(F)){G=F;break}}v=v.substring(B,G);return new l(v,u-B,t-B,y)}Uxd(v){return this.J0e(v.CVh(),v.begin,v.end,"")}}Object(C.a)(e,"SearchContextFactory",null,[1076]);var a=d(134),k=d(1546);d.d(N,"a",function(){return n});class n extends e{constructor(){super()}Uxd(v){let u=v.begin,t=v.end;const y=({begin:u,end:t}=n.JCl(v,u,t)).returnValue;v=k.a(v.type);return this.J0e(y,u,t,v)}static get instance(){return null!=
n.amg?n.amg:n.amg=new n}static JCl(v,u,t){v=v.CVh();return n.vNi(v,u,t)}static vNi(v,u,t){const y=a.AParagraphNode.lU(v);if(y.length<v.length){v=v.substring(0,u);const B=a.AParagraphNode.lU(v);v=v.length-B.length;u-=v;t-=v}return{returnValue:y,begin:u,end:t}}}Object(C.a)(n,"EditorSearchContextFactory",e,[])},1560:function(C,N,d){C=d(0);var l=d(2),e=d(22),a=d(310),k=d(711),n=d(25),v=d(9),u=d(133),t=d(53),y=d(658),B=d(211),G=d(260),F=d(92),K=d(34),O=d(11),H=d(3),I=d(5),J=d(595),L=d(1015);class S{create(){return new L.a}}
Object(C.a)(S,"FootnoteEndnoteContainerNodeFactory",null,[256]);var E=d(550);d.d(N,"a",function(){return P});class P{constructor(T,U,X,Y,ca,da,ua,ra,qa){this.Pod=null;P.ga=T;this.KE=X;this.QBe=Y;this.Nzj=da;this.Xc=ua;this.ib=ca;this.VMj=ra;this.VAj=qa;P.Eh=U}oVd(T,U){this.K2k(T);T.Rb(7);this.KE.Zci(T,U)||T.vf(7)}K2k(T){if(this.QBe.zfi(T)){var U=!1,X=!1;if(T.Rb(7)){do{const Y=T.currentNode;if(37===Y.type)switch(Y.getValue(I.a.a6)){case 0:X=!0;break;case 1:U=!0}}while(T.Wi(7))}X||this.M7g(T,0);U||
this.M7g(T,1)}}M7g(T,U){const X=this.Nzj.create(1074135124);X.setValue(I.a.a6,U);T.Sf(X,7)}VDn(T){T&&this.ZVi(T.Yka)}ZVi(T){T&&(T=n.SelectionFactory.xe(T.Ob.paragraph,T.Ob.cp+1),this.ib.setSelection(T))}FKm(T){let U=this.VMj(T);void 0!==U&&null!==U?this.KE.ama(U)&&(U=this.KE.bWh(U)):U=T;return this.VAj(U)}eZn(){this.Pod?P.Eh.notificationBar.removeEntry(this.Pod):this.Pod=P.Eh.notificationBar.Yra(WordEditorIntl.WordEditorStrings.l_FootnoteEndnoteFormattingUnsupportedNotification,!1);P.Eh.notificationBar.mA(this.Pod)}Yck(T,
U){T=this.Xc.WAa(T,37,37);let X=!1;if(T.Xd()){do{const Y=T.currentNode;this.KE.Ptf(Y)?this.Kch(Y,U):X=!0}while(T.xj())}X&&this.eZn()}Kch(T,U){J.e(T,X=>{P.Hdl(X,U);return!0},12)}bWl(T,U){T=this.KE.OFd(T,U);return T?(T=this.Xc.fg(T))?T.bD():!1:!1}IQh(T,U){T=this.KE.OFd(T,U);T=this.Xc.fg(T);if(T.Xd()){do if(U=T.currentNode,1===U.getValue(I.a.Zka))return U;while(T.xj())}return null}static iIc(){return new P(l.AFrameworkApplication.ya,v.App.xa,E.a.instance,u.PageReader.instance,t.a.instance,new S,new y.a,
B.OutlineNavigator.DKm,G.WordSectionNavigator.E2e)}static get instance(){return null!=P.lmg?P.lmg:P.lmg=P.iIc()}static get paragraphEditor(){return null!=P.mpg?P.mpg:P.mpg=e.a.instance.resolve("Box4.IParagraphEditor")}static Hdl(T,U){U.Deb?P.paragraphEditor.qp.$aa(T,F.OutlineReader.yL(T)):P.paragraphEditor.qp.$aa(T,0);T=K.a.createTextRange(T,0,O.ParagraphReader.textLength(T));P.ga.Qf(T,H.a.font,2,!0,new a.a,new k.a(U.fontName));P.ga.Qf(T,H.a.Sv,2,!0,new a.a,new k.a(U.fontSize))}}P.ga=null;P.Eh=null;
Object(C.a)(P,"FootnoteEndnoteEditor",null,[428])},1565:function(C,N,d){d.d(N,"a",function(){return l});C=d(0);var l;(function(e){e[e.unknown=0]="unknown";e[e.supported=1]="supported";e[e.userUnsupportedAnonymous=2]="userUnsupportedAnonymous";e[e.userUnsupportedNoLoginHint=3]="userUnsupportedNoLoginHint";e[e.hostUnsupported=4]="hostUnsupported"})(l||(l={}));Object(C.b)("SupportStatus",l)},1575:function(C,N,d){d.d(N,"a",function(){return O});C=d(0);var l=d(374),e=d(59),a=d(22),k=d(106),n=d(8),v=d(120),
u=d(72),t=d(14),y=d(108),B=d(549),G=d(134),F=d(140),K=d(11);class O{constructor(H,I,J,L,S,E=null,P="",T=!0,U=!1){this.IXa=this.V9d=this.Ojb=this.NHi=this.j4d=null;this.fOc=!1;this.Tmf=null;this.EEf=0;this.context=H;this.ve=H.view;this.lA=I;this.Cd=S;this.FQ=J;this.k7=L;this.eEa=this.failed=!1;this.pZd=null;this.f_a=this.d7b=!1;this.SZn=O.zZe(H);this.browserName=P;this.Djj=T;this.euf=U;this.IQa=!1;this.XZb=0;if(H=Object(v.a)(93,S)?S:null){this.NHi=new l.DictionaryPropertySet;this.NHi.Cs(H);J=H.ia(k.a.UUc,
e.a.nil);this.dBc=J!=e.a.nil?J.toString():e.a.create().toString();if(H.ia(k.a.fEi,!1)){this.d7b=!0;this.f_a=H.ia(k.a.f_a,!1);this.pZd=E;for(E=this.ve.Cb.Rg;E.Xw;)E=E.getContext(0);if(S=Object(u.a)(G.AParagraphNode,E.node)){J=0;L=K.ParagraphReader.textLength(S);switch(E.contextId){case t.a.Gd:J=E.cpBegin;L=E.cpEnd;break;case t.a.endOfParagraph:J=L}this.j4d=y.FormattingReader.KFd(E.node,J,E.Fb);n.ULS.shipAssertTag(6305503,307,!!this.j4d);S=F.HyperlinkReader.tIc(S);for(const X of S)X.cpEnd<=J||X.cpBegin>=
L||O.hyperlinkEditor.RQ(E.node,X.hyperlink)}}this.eEa=H.ia(k.a.eEa,!1);this.IQa=H.ia(k.a.IQa,!1);this.Ojb=H.ia(k.a.Ojb,null)}else this.dBc=e.a.create().toString();I&64&&(this.eEa=!0)}static get hyperlinkEditor(){return null!=O.Qkg?O.Qkg:O.Qkg=a.a.instance.resolve("Box4.IHyperlinkEditor")}static zZe(H){if(H){if(H.Xw){for(let I=0;I<H.length;I++)if(O.zZe(H.getContext(I)))return!0;return!1}if(Object(v.a)(B.a,H))return O.zZe(H.vk);if(K.ParagraphReader.nc(H.node)&&H.node.vN)return!0}return!1}}Object(C.a)(O,
"ClipboardActionArguments",null,[])},1576:function(C,N,d){d.d(N,"a",function(){return J});C=d(0);var l=d(22),e=d(59),a=d(49),k=d(651),n=d(133),v=d(658),u=d(181),t=d(20),y=d(9),B=d(115),G=d(5),F=d(860),K=d(761),O=d(550),H=d(1517),I=d(1560);class J{constructor(L,S,E,P,T,U){this.KE=L;this.WGa=E;this.QBe=P;this.Bme=T;this.Xc=U}T5l(L,S,E){const P=this.bTh(S,L.node),T=L.node.Lc;if(!T)return null;const U=new a.GraphTransaction(15);U.Db(L.node);U.Al=E;E=this.U5l(P,S);J.V5l(E,T,L,S);U.dispose();return E}bTh(L,
S){const E=this.Xc.Dk();E.set(S);E.Bb(7);E.kd(7);this.WGa.oVd(E,L);return E}U5l(L,S){const E=K.a.createNode();E.properties.setValue(G.a.a6,S);L.Sf(E,8);this.Bme.SIk(E,S);return E}static get characterPropertiesEditor(){return null!=J.Ygg?J.Ygg:J.Ygg=l.a.instance.resolve("Box4.ICharacterPropertiesEditor")}static get Jba(){return J.JC||(J.JC=new k.WACStyleSet)}static set Jba(L){J.JC=L}static iIc(){const {FootnoteEndnoteDefaultContentInserter:L}=d(1638);return new J(O.a.instance,H.a.instance,I.a.instance,
n.PageReader.instance,L.instance,new v.a)}static get instance(){return null!=J.Qmg?J.Qmg:J.Qmg=J.iIc()}static get qh(){return J.jB||(J.jB=u.PageNavigator.instance)}static set qh(L){J.jB=L}static V5l(L,S,E,P){t.a.instance.J(4)&&y.App.ud.Mp&&y.App.ud.Lq.CG(E.node);const T=new B.a;T.setValue(G.a.N1b,L.id);T.setValue(G.a.a6,P);const U=S.Ku(T,e.a.create());J.characterPropertiesEditor.Uea(E,X=>F.a.getInstance(X,U,L.id),J.yNh(E.node,P))}static yNh(L,S){let E=null;(L=J.qh.ju(L))&&(L=J.Jba.XN(L))&&(E=L.eta(S?
Box4Intl.Box4Strings.L_StyleWordFootnoteReference:Box4Intl.Box4Strings.L_StyleWordEndnoteReference));return E}}J.JC=null;J.jB=null;Object(C.a)(J,"FootnoteEndnoteInserter",null,[451])},1581:function(C,N,d){d.d(N,"a",function(){return l});C=d(0);class l{static $tn(e,a){l.qBe=e;l.BEe=a}static Xtn(e,a){l.zEe=e;l.MUa=a}static VXh(){return l.zEe===l.MUa?String.format(WordEditorIntl.WordEditorStrings.l_ReplacedAllMessage,l.MUa,l.qBe,l.BEe):String.format(WordEditorIntl.WordEditorStrings.l_ReplacedSomeMessage,
l.zEe,l.MUa,l.qBe,l.BEe)}}l.zEe=0;l.MUa=0;l.qBe=null;l.BEe=null;Object(C.a)(l,"ReplaceAllContext",null,[])},1599:function(C,N,d){d.r(N);C=d(0);var l=d(1913),e=d(59),a=d(2),k=d(333),n=d(22),v=d(1842),u=d(9),t=d(8),y=d(244),B=d(1915),G=d(13),F=d(18),K=d(1558);class O{constructor(vb="",Ya="",wb=!1,jb=!1){this.xgm=wb;this.Ujm=jb;this.actionId=vb;this.xEa=Ya}}Object(C.a)(O,"SearchEntryPointContext",null,[]);class H{constructor(vb){this.Pca=null;this.ru=!1;this.FM=vb}initialize(){this.bZ();this.Xy();this.C5(0)}Xy(){this.Pca.Xy()}dispose(){this.FM=
null}zJc(){return!1}get lF(){return this.Pca?this.Pca.lF:0}C5(vb){this.Pca.C5(vb)}get isVisible(){return this.ru}MOe(vb){this.Pca&&this.Pca.iBo(vb)}sOi(vb){this.Pca&&this.Pca.JJo(vb)}Bij(vb){this.Pca&&this.Pca.YMo(vb)}Kmh(){this.Pca&&this.Pca.rCo()}J5d(vb){this.Pca&&this.Pca.J5d(vb)}}Object(C.a)(H,"FindReplacePane",null,[493,9]);var I=d(56),J=d(1388),L=d(80),S=d(1027),E=d(159),P=d(171),T=d(1016),U=d(82),X=d(83),Y=d(57),ca=d(28),da=d(439),ua=d(1488),ra=d(410),qa=d(1498),ka=d(696),la=d(86),Ha=d(1055);
class wa{constructor(vb){this.T2j=(Ya,wb)=>{this.Qod.xb(Ya)?this.Qod.Z(Ya,wb):this.Qod.add(Ya,wb);(Ya=this.eil(Ya))&&this.x$h(wb,Ya,this.vrh(ra.a.getTypeName()))};this.Qod=new la.a;this.MU=new la.a;this.annotationType=ua.RoleDetectionAnnotation.getTypeName();vb.ckn(this.T2j)}wI(vb,Ya){let wb;const jb=vb.parentPath.substr(vb.parentPath.lastIndexOf("\\")+1),Zb=vb.content;if(!Zb||this.Bjm(Zb))""!==jb&&({value:wb}=this.Qod.Dc(jb,wb)).returnValue&&this.x$h(wb,vb,this.vrh(Ya)),Ya===ra.a.getTypeName()?(Ya=
null,({value:Ya}=this.MU.Dc(jb,Ya)).returnValue?this.MU.Z(jb,vb):this.MU.add(jb,vb)):Ya===qa.a.getTypeName()&&this.MU.remove(jb)}x$h(vb,Ya,wb){const jb=this.mxl(Ya);Ya=this.fil(Ya);0<Ya&&vb(wb,jb,Ya)}fil(vb){try{return Number.parseInvariant(vb.id.substr(2))}catch(Ya){t.ULS.sendTraceTag(554747009,367,10,Ya.toString())}return-1}eil(vb){let Ya;return({value:Ya}=this.MU.Dc(vb,Ya)).returnValue?Ya:null}nVc(vb){if(vb)for(const Ya of vb)this.wI(Ya,"AugLoop_Core_AddOperation")}mxl(vb){if(vb=vb.content)switch(vb.roleType){case ua.RoleType.Heading1:return 1;
case ua.RoleType.Heading2:return 2;case ua.RoleType.Heading3:return 3;case ua.RoleType.Heading4:return 4;case ua.RoleType.Heading5:return 5;case ua.RoleType.Heading6:return 6;case ua.RoleType.Heading7:return 7;case ua.RoleType.Heading8:return 8;case ua.RoleType.Heading9:return 9}return-1}Bjm(vb){vb=vb.roleType;return vb===ua.RoleType.Heading1||vb===ua.RoleType.Heading2||vb===ua.RoleType.Heading3||vb===ua.RoleType.Heading4||vb===ua.RoleType.Heading5||vb===ua.RoleType.Heading6||vb===ua.RoleType.Heading7||
vb===ua.RoleType.Heading8||vb===ua.RoleType.Heading9}vrh(vb){if(vb===ra.a.getTypeName()||vb===ka.a.getTypeName())return Ha.a.uOe;if(vb===qa.a.getTypeName())return Ha.a.bzd;throw Error.create("Invalid operation type");}}Object(C.a)(wa,"RoleDetectionAnnotationHandler",null,[250]);var Ca=d(164),Ja=d(78),bb=d(1122),ha=d(53),ia=d(76),va=d(44),Ka=d(189),Xa=d(181),xa=d(557);class Ma extends Ka.a{constructor(vb,Ya){super(vb,Ya,u.App.Bba);this.sRd=null;this.Ieb=this.hYb=0;this.headingsReady=!1;this.vOa=this.jab=
0;this.Vni=!1;this.ERg=this.uHg=this.DDg=null;this.I2e=!1}get WQd(){return!0}get OFh(){return this.DDg}get BVd(){return this.ERg}Ikj(){this.headingsReady&&(this.uHg.style.display="none",this.Ieb||this.hYb?(this.OFh.style.display="none",this.container.style.display="block"):(this.container.style.display="none",this.OFh.style.display="block"))}get HZ(){return super.HZ|240}static H0e(vb,Ya,wb){var jb=u.App.xa.jb.Yc;if(jb&&(jb=Xa.PageNavigator.instance.pT(jb))){const Zb=new Ma(new xa.a,n.a.instance.resolve("Box4.IHtmlViewRootFactory"));
Zb.Ieb=0;Zb.hYb=0;Zb.sRd=null;Zb.oab(vb);Zb.DDg=Ya;Zb.uHg=wb;Zb.rB(jb);Zb.headingsReady=!0;Zb.Ikj();Zb.ERg=null;return Zb}return null}}Object(C.a)(Ma,"WordNavigationPaneHeadingsView",Ka.a,[508,140,80,9]);class Na{constructor(vb){this.MU=new la.a;this.TSg=vb}wI(vb,Ya){Ya===ra.a.getTypeName()?(Ya=null,({value:Ya}=this.MU.Dc(vb.id,Ya)).returnValue?this.MU.Z(vb.id,vb):this.MU.add(vb.id,vb)):Ya===qa.a.getTypeName()&&this.MU.remove(vb.id);this.TSg&&this.TSg()}nVc(vb){if(vb)for(const Ya of vb)this.wI(Ya,
ra.a.getTypeName())}c2b(){var vb;let Ya=[];if(0<(null===(vb=this.MU)||void 0===vb?void 0:vb.count))for(const wb of this.MU.values)Ya.push(wb);return Ya}}Object(C.a)(Na,"ContractEntityAnnotationHandler",null,[250]);var pa=d(3);class Ra{constructor(vb){this.ga=vb}cQm(){this.cancelSearch()}hSm(vb){this.ga.Xb(F.a.aJd,2,vb)}JHf(){this.cancelSearch()}cancelSearch(){this.ga.processAction(pa.a.rwb,2)}YWm(){this.ga.processAction(pa.a.findOnPage,2)}onSearchQueryChanged(vb){this.ga.Xb(pa.a.ICd,2,vb)}DYm(){this.ga.processAction(F.a.replace,
2)}EYm(){this.ga.processAction(F.a.replaceAll,2)}zYm(){this.ga.processAction(G.a.m9e,2)}AYm(){this.ga.processAction(G.a.B9e,2)}CYm(){this.ga.processAction(pa.a.z0d,2)}BYm(){this.ga.processAction(pa.a.QVd,2)}Jbc(vb){this.ga.Xb(F.a.Jbc,2,vb)}}Object(C.a)(Ra,"FindReplaceActions",null,[507]);var Sa=d(336);class ab{}ab.wO=Sa.a.Ncb;ab.vac=0;ab.esa="FindReplaceTaskPaneData";ab.WQ=WordEditorIntl.WordEditorStrings.L_NavigationPaneTitle;Object(C.a)(ab,"FindReplaceConstants",null,[]);var eb=d(758);class zb{Idj(vb){var Ya,
wb,jb;return da.a.Rdb(null===(jb=null===(wb=null===(Ya=u.App.xa)||void 0===Ya?void 0:Ya.jb)||void 0===wb?void 0:wb.Yc)||void 0===jb?void 0:jb.zd,vb)}clearSelection(){if(this.jxe){const vb=this.Idj(this.jxe);vb&&vb.Yja()}this.jxe=this.XZg=null}MDn(vb){this.clearSelection();if(vb){const Ya=this.Idj(vb.parentPath);if(Ya){const wb=vb.content;wb&&(this.XZg=vb.id,Ya.uPa([new eb.a(wb.range.start,wb.range.start+wb.range.length)]),Ya.Yyf(0,1));this.jxe=vb.parentPath}}}}Object(C.a)(zb,"RangeAnnotationContentSelector",
null,[]);var Ua=d(1581);class Ab{constructor(vb){this.eLj=vb}get Ej(){return this.eLj.value}BAl(vb){vb=this.Ej.CYa(vb);return this.hdm(vb)?null:vb}hdm(vb){return vb.id===this.Ej.JAa.id}static get instance(){return null!=Ab.Elg?Ab.Elg:Ab.Elg=Ab.hE()}static hE(){const vb=new y.a(()=>v.FindManager.instance.Ej);return new Ab(vb)}}Object(C.a)(Ab,"SearchResultOrder",null,[]);var mb=d(11),Rb=d(291);class hc{constructor(vb){this.Dxe=vb}get pPa(){return this.Dxe.value}getSelectedText(){var vb=this.pPa.Isa;
if(vb){const Ya=vb.cpBegin,wb=vb.cpEnd-Ya;if(0<wb&&(vb=vb.node,mb.ParagraphReader.nc(vb)))return vb.characterData.substr(Ya,wb)}return null}static getInstance(){return hc.Gl()}static Gl(){const vb=new y.a(()=>Rb.a.instance);return new hc(vb)}}Object(C.a)(hc,"SelectionHelper",null,[]);var Hb=d(36),Ta=d(161),Aa=d(437),ma=d(843),Ga=d(230),Fa=d(436),ib=d(1792),ob=d(391);class fb extends Ka.a{constructor(vb,Ya,wb){super(vb,Ya,u.App.Bba);this.P1a=wb;this.U3h=!1}get WQd(){return!0}get HZ(){return super.HZ|
248}static H0e(vb){var Ya=u.App.xa.jb.Yc;const wb=ob.a.instance.Rc(3);return Ya&&(Ya=Xa.PageNavigator.instance.pT(Ya))?(vb=new fb(new xa.a,n.a.instance.resolve("Box4.IHtmlViewRootFactory"),vb),wb.nec(vb.Tb),vb.rB(Ya),wb.dispose(),vb.U3h=!0,vb):null}}Object(C.a)(fb,"WordNavigationPaneReactHeadingsView",Ka.a,[140,80,9]);class Mb extends H{constructor(vb,Ya,wb,jb,Zb,Eb,tc,lc,Lc,Bb,jc,dc,nb,Gb){var lb,Kb,Vb,vc;super(vb);this.npb=ab.wO;this.qXj="FindReplaceTaskPaneProps";this.Wb=I.FocusManager.instance();
this.vRa=this.yIa=this.HY=this.QIe=null;this.TNb=a.AFrameworkApplication.K.$("AugLoopOperationsAreEnabled");this.Y6c=a.AFrameworkApplication.K.$("AutoDetectedHeadingsIsEnabled");this.sgd=(null===(lb=a.AFrameworkApplication.K)||void 0===lb?void 0:lb.getBooleanFeatureGate("Microsoft.Office.WordOnline.NavPaneReactHeadings",!1))||(null===(Kb=a.AFrameworkApplication.K)||void 0===Kb?void 0:Kb.$("NavPaneReactHeadings"));this.TMj=null===(Vb=a.AFrameworkApplication.K)||void 0===Vb?void 0:Vb.getBooleanFeatureGate("Microsoft.Office.WordOnline.NavPaneReactEntities",
!1);this.phj=()=>{this.isVisible&&this.lyd===B.a.intelligentPlaceholder&&this.Vm()};this.iA=new J.a;this.lGg=Ya;this.rGa=B.a.headings;this.rxc=l.a.initial;this.Epa=new ia.a;this.NO="";this.Anc={matchCase:!1,matchWholeWord:!1};this.AEe="";this.rGe=null;this.lP=wb;this.I0g=!1;this.jtb=jb;this.ib=Zb;this.iNj=Eb;this.Fya=tc;this.tG=lc;this.ohd=!0;this.T4=this.S4=!1;this.Jf=Lc;this.Gne=Bb;this.WK=jc;this.Hb=dc;this.Z3=nb;this.ozg=Gb;this.iie&&this.Fya.Jnn(()=>{this.Vm()});(null===(vc=a.AFrameworkApplication.K)||
void 0===vc?0:vc.getBooleanFeatureGate("Microsoft.Office.WordOnline.OpenNavPaneOnBoot",!1))&&this.b5j()}b5j(){this.Hb.$b(new L.a(5,1,0,()=>{const vb=this.Gne.PRh();null!=vb&&6<vb.count&&(a.AFrameworkApplication.ya.processAction(F.a.sQa,2),this.m7c=window.performance.now(),Y.a("DefaultNavigationPaneOpened"))}))}get yJe(){return 1}get iie(){return this.TNb&&this.Y6c&&!!this.Jf}get jie(){return this.TNb&&this.TMj&&!!this.Jf}get headingsReady(){return this.sgd?this.WK.headingsReady:this.Spb?this.Spb.headingsReady:
!1}set headingsReady(vb){this.sgd?this.WK.headingsReady=vb:this.Spb&&(this.Spb.headingsReady=vb)}get lyd(){return this.rGa}F4i(){this.rGa=B.a.headings;this.Vm()}IWn(){this.rGa=B.a.contracts;this.Vm()}y4i(){this.rGa=B.a.find;Y.a("NavigationPaneFind");this.Vm()}n5i(){this.rGa=B.a.replace;this.Vm()}S4i(){this.rGa=B.a.intelligentPlaceholder;this.Vm()}A0c(vb){this.I0g=vb;this.Vm()}zJc(){return this.lyd===B.a.replace}get lF(){return this.rxc}C5(vb){this.rxc=vb;this.Vm()}MOe(vb){this.S4j(vb);this.Vm()}S4j(vb){const Ya=
this.iNj(vb[vb.length-1]);if(Ya){let wb=-1;for(let jb=0;jb<this.Epa.count;jb++)if(Ya.id===this.Epa.J(jb).id){wb=jb;break}-1===wb?t.ULS.sendTraceTag(40776785,313,50,"Taskpane AddSearchResult gave illegal -1 index"):this.Epa.EA(wb,this.Urh(vb))}else this.Epa.addRange(this.Urh(vb))}sOi(vb){for(let Ya of vb)for(vb=this.Epa.count-1;0<=vb;vb--)if(this.Epa.J(vb).id===Ya.id){this.Epa.removeAt(vb);break}this.Vm()}Bij(vb){for(let Ya of vb)for(vb=this.Epa.count-1;0<=vb;vb--)if(this.Epa.J(vb).id===Ya.id){this.Epa.Z(vb,
this.Trh(Ya));break}this.Vm()}Kmh(){this.Epa.clear();this.rGe=null;this.Vm()}J5d(vb){this.rGe=vb?vb.id:null;this.Vm()}Urh(vb){if(!vb)return new ia.a;const Ya=new ia.a;for(let wb of vb)Ya.add(this.Trh(wb));return Ya}Trh(vb){const Ya=this.jtb.Uxd(vb);return{id:vb.id,searchBeginIndex:Ya.FUf,searchEndIndex:Ya.CUf,searchResult:Ya.EZe}}Nce(){}lmo(){var vb={};this.FM.Jbc(vb);vb=vb[S.a.Value];this.QIe=ca.c(vb)?"":vb;this.Vm()}tLa(){return this.NO}RAb(){return this.AEe}XXf(vb){this.NO=vb;this.Vm()}clearSearch(){}initialize(){this.imd=
window.performance.now();const vb=this.Wb.re(this.npb);vb.parent=E.AFrame.Np;vb.UL=!0;this.bZ();this.C5(l.a.initial)}qO(){this.isVisible?(t.ULS.sendTraceTag(527237715,312,50,"Navpane is already open, so making it the selected task pane."),P.UISurfaces.$t().then(vb=>{vb.setSelectedTaskPane(this.npb,this.yJe);this.q7();this.ohd&&this.T_i(!0);return null}).catch(vb=>{Mb.recordQosError("NavPaneOpenActionFailure",["NavPaneInteractionFailed"],vb)})):(this.F0c(),this.ohd&&this.T_i(!1))}T_i(vb){const Ya=
this.lGg();Ya?this.NO=Ya:vb&&this.NO||(this.NO="");this.FM.onSearchQueryChanged(this.NO)}Hla(){P.UISurfaces.$t().then(vb=>{vb.hideTaskPane(this.npb,this.yJe);return null}).catch(vb=>{Mb.recordQosError("NavPaneCloseActionFailure",["NavPaneInteractionFailed"],vb)})}bZ(){this.lP.iKa();this.HY=this.lP.s_b(this.Wb);this.G2j()}F0c(){P.UISurfaces.$t().then(vb=>{this.imd=window.performance.now();vb.showTaskPane(this.npb,this.wB());vb=[Object.assign(new Hb.a,{name:"Tab",string:this.rGa})];const Ya=window.performance.now()-
this.imd;Y.a("NavigationPaneOpen",!0,Ya,vb);return null}).catch(vb=>{Mb.recordQosError("NavPaneOpenActionFailure",["NavPaneInteractionFailed"],vb)})}Vm(){P.UISurfaces.$t().then(vb=>{vb.updateTaskPane(this.npb,this.wB());return null}).catch(vb=>{Mb.recordQosError("NavPaneUpdateActionFailure",["NavPaneInteractionFailed"],vb)})}wB(){const vb={activeTab:B.a.initial};this.iA.KJb(vb);return Object.assign(new T.a,{title:ab.WQ,hideHeader:!1,width:320,location:this.yJe,contentProps:vb,onOpen:()=>{this.ru=
!0;this.hnn();this.pkn();this.ohd&&this.q7();u.App.xa.updateCommandUI();u.App.xa.pVa(this.phj)},onClose:()=>{try{const Ya=window.performance.now();null!=this.m7c&&(5E3>window.performance.now()-this.m7c&&Y.a("DefaultNavigationPaneClosed"),this.m7c=null,this.Spb?this.Spb.I2e=!1:this.$Pj=!0);this.aba();this.ru=!1;this.Qeo();this.rfo();this.FM.JHf();this.QIe="";this.rxc=l.a.initial;u.App.xa.mcc(this.phj);u.App.xa.updateCommandUI();const wb=window.performance.now()-Ya;Y.a("NavigationPaneClose",!0,wb)}catch(Ya){Mb.recordQosError("NavPaneCloseActionFailure",
["NavPaneInteractionFailed"],Ya)}},enableResize:!1,minResizeWidth:280,maxResizeWidth:920,isModernPane:!0})}hnn(){this.iie&&!this.yIa&&da.a.En().then(()=>{this.yIa=new wa(this.Fya);this.Jf.mb(this.yIa,this.yIa.annotationType);this.Jf.getAnnotationsByType(this.yIa.annotationType).then(vb=>{this.yIa.nVc(vb)})})}rfo(){this.iie&&this.yIa&&(this.Jf.sc(this.yIa,this.yIa.annotationType),this.yIa=null)}Mao(){if(this.jie){var vb=new ib.ContractEntitySignal;vb=Object.assign(new ma.a,{parentPath:["Signal",Ga.a.getTypeNameFor(vb)],
items:[Object.assign(new Fa.a,{body:vb})]});this.Z3.getAugLoopRuntimeManager().submitOperation(Object.assign(new Aa.a,{operation:vb}))}}pkn(){this.jie&&!this.vRa&&da.a.En().then(()=>{this.vRa=new Na(this.Vm);this.Jf.mb(this.vRa,ib.ContractEntityAnnotation.getTypeName());this.Mao();this.Jf.getAnnotationsByType(ib.ContractEntityAnnotation.getTypeName()).then(vb=>{this.vRa.nVc(vb)})})}Qeo(){this.jie&&this.vRa&&(this.Jf.sc(this.vRa,ib.ContractEntityAnnotation.getTypeName()),this.vRa=null)}G2j(){this.iA.vK(this.Wrl());
this.iA.vK(this.Yrl());this.iA.vK(this.oul());this.iA.vK(this.ynl());this.iA.vK(this.fwl());this.iA.vK(this.Hgl());this.iA.vK(this.onLinkExecute());this.iA.vK(this.onPivotTabExecute());this.iA.vK(this.kJl());this.iA.vK(this.PLl());this.iA.vK(this.Ovl());this.iA.vK(this.EMl());this.iA.vK(this.qGl())}EMl(){return vb=>{vb.autoDetectedHeadingsToggleDisabled=this.Fya?!this.Fya.Bgk():!0}}PLl(){return vb=>{vb.type=this.qXj}}onLinkExecute(){return vb=>{vb.onLinkExecute=()=>{this.FM.YWm()}}}onPivotTabExecute(){return vb=>
{vb.onPivotTabExecute=Ya=>{switch(Ya){case B.a.headings:this.F4i();break;case B.a.replace:this.n5i();break;case B.a.contracts:this.IWn();break;case B.a.intelligentPlaceholder:this.S4i();break;default:this.y4i()}ca.b(this.NO)&&(this.NO=this.lGg(),this.NO||(this.NO=""),ca.b(this.NO)||(this.FM.onSearchQueryChanged(this.NO),this.Vm()))}}}kJl(){return vb=>{vb.showOutOfSyncNotification=this.I0g}}Yrl(){return vb=>{vb.findSearchBoxContent={onSearchQueryChanged:Ya=>{this.NO=Ya;this.Vm();this.FM.onSearchQueryChanged(Ya)},
findOptions:this.Anc,matchCase:this.S4,matchWholeWord:this.T4,findSearchText:this.NO,onClearButtonExecute:()=>{void 0!==this.NO&&null!==this.NO&&""!==this.NO&&(this.NO="",this.ib.setSelection(null),this.FM.cQm())},onMatchCaseExecute:()=>{this.Anc.matchCase=!this.Anc.matchCase;this.S4=!this.S4;this.Vm();this.FM.zYm()},onMatchWholeWordExecute:()=>{this.Anc.matchWholeWord=!this.Anc.matchWholeWord;this.T4=!this.T4;this.Vm();this.FM.AYm()},onMenuClose:()=>{if(this.HY)this.HY.onMenuClose()},onMenuOpen:()=>
{if(this.HY)this.HY.onMenuOpen()}}}}Hgl(){return vb=>{vb.activeTab=this.lyd}}Ovl(){return vb=>{vb.autoDetectedHeadingsToggleState=this.Fya?this.Fya.wSe:!1;this.WK.GFc=vb.autoDetectedHeadingsToggleState;!vb.autoDetectedHeadingsToggleState&&this.Fya&&this.Fya.ygc(!1)}}Wrl(){return vb=>{const Ya={onReplaceAllExecute:()=>{this.FM.EYm()},onReplaceExecute:()=>{this.FM.DYm()},onReplaceQueryChanged:wb=>{this.AEe=wb;this.Vm()},replaceSearchText:this.AEe};vb.findReplaceContent={searchResults:this.Epa.toArray(),
replaceSearchBoxContent:Ya,onNextSearchResultExecute:()=>{this.FM.BYm()},onPrevSearchResultExecute:()=>{this.FM.CYm()},onSearchResultSelected:wb=>{const {FindReplaceUIManager:jb}=d(1599);this.FM.hSm(wb);jb.yni(1)},selectedResultId:this.rGe,summaryLabel:this.QIe,explanationText:this.orl(this.rxc),haveTooManySearchResults:this.rxc===l.a.tooManyResults}}}orl(vb){switch(vb){case l.a.initial:return WordEditorIntl.WordEditorStrings.l_LandingMessage;case l.a.noMatchesFound:return WordEditorIntl.WordEditorStrings.l_NoMatchesMessage;
case l.a.replaceAllComplete:return Ua.a.VXh();case l.a.tooManyResults:return WordEditorIntl.WordEditorStrings.l_TooManyResultsMessage;default:return""}}qGl(){return vb=>{vb.replaceFollowUpsWithCommentsIsEnabled=!0}}fwl(){return vb=>{var Ya=this.tG.thl();const wb=[];for(let jb of Ya)Ya=this.tG.iEd(jb.Lc,jb.id),wb.push({id:jb.id.toString(),intelligentPlaceholderAnchorText:Ya});vb.intelligentPlaceholderContent={intelligentPlaceholderContentEntry:wb,onIntelligentPlaceholderInputExecute:jb=>{this.NO=jb;
this.rGa=B.a.find;this.Vm();this.FM.onSearchQueryChanged(jb)},onSearchResultSelected:jb=>{this.Vm();jb=e.a.Of(jb);this.tG.WDn(jb)}}}}oul(){return vb=>{let Ya=()=>{};this.Fya&&(Ya=Object(va.a)(this.Fya,this.Fya.ygc,"toggleAutoDetectedHeadings"));vb.headingsContent={onHeaderInputExecute:wb=>{this.NO=wb;this.rGa=B.a.find;this.Vm();Y.a("NavigationPaneFind");this.FM.onSearchQueryChanged(wb)},renderHeadingContent:(wb,jb,Zb)=>{this.Hb.$b(new L.a(0,1,100,()=>{var Eb=window.performance.now()-this.imd;if(this.sgd){var tc=
this.WK.Jaa;this.headingsReady=!0;this.Vm();Zb.style.display="none";tc.first&&(wb.style.display="block");this.Hb.$b(new L.a(1,1,0,()=>{fb.H0e(this)}))}else this.Spb=Ma.H0e(wb,jb,Zb),this.Vm();null==this.m7c||this.$Pj||(this.Spb.I2e=!0);tc=window.performance.now()-this.imd;Y.a("NavigationPaneHeadingsLoaded",!0,tc,[Object.assign(new Hb.a,{name:"NavPaneReactHeadings",bool:this.sgd})]);Eb=[Object.assign(new Hb.a,{name:"HeadingFetchStart",double:Eb}),Object.assign(new Hb.a,{name:"HeadingFetchFinished",
double:tc})];Y.a("NavigationPaneHeadingsLoadDetails",!0,void 0,Eb)}))},autoDetectedHeadingsToggle:Ya,onHeadingsUnmounted:()=>{this.headingsReady=!1},headingsReady:this.headingsReady,headingsList:this.WK.Jaa,onHeadingChevronClick:wb=>{this.Hb.$b(new L.a(0,1,0,()=>{this.WK.t5k(wb);this.Vm()}))},onClickHeading:wb=>{this.Hb.$b(new L.a(0,1,0,()=>{this.WK.onClickHeading(wb);this.Vm()}))},onClickBookmark:wb=>{this.Hb.$b(new L.a(0,1,0,()=>{this.WK.onClickBookmark(wb);this.Vm()}))},bookmarkIconUrl:Ca.a.Sh("BookmarkDefault.png")}}}xnl(){var vb,
Ya=null===(vb=this.vRa)||void 0===vb?void 0:vb.c2b();if(Ya){vb=Array(Ya.length);let wb=0;for(const jb of Ya)(Ya=jb.content)&&(vb[wb++]={id:jb.id,type:Ya.type,value:Ya.value});return vb}return null}ynl(){return vb=>{vb.contractsContent={onHeaderInputExecute:Ya=>{this.NO=Ya;this.rGa=B.a.find;this.Vm();Y.a("NavigationPaneFind");this.FM.onSearchQueryChanged(Ya)},contractEntities:this.xnl(),selectedEntityId:this.ozg.XZg,onEntitySelected:Ya=>{var wb;const jb=null===(wb=this.vRa)||void 0===wb?void 0:wb.c2b();
if(jb)for(const Zb of jb)if(Zb.id===Ya){this.ozg.MDn(Zb);break}this.Vm()}}}}k_i(vb){this.ohd=vb}tko(vb){this.Hb.$b(new L.a(0,1,0,()=>{this.WK.I8f(vb)&&this.Vm()}))}ESl(vb){this.Hb.$b(new L.a(0,1,0,()=>{const Ya=this.WK.FHb;this.WK.WSk(vb)?this.Vm():0===this.WK.FHb&&0<Ya&&this.Vm()}))}W7f(vb,Ya){this.Hb.$b(new L.a(0,1,0,()=>{const wb=this.WK.FHb;this.WK.W7f(vb,Ya)?this.Vm():0<this.WK.FHb&&0===wb&&this.Vm()}))}pSk(vb){this.Hb.$b(new L.a(0,1,0,()=>{const Ya=this.WK.FHb;this.WK.qSk(vb)?this.Vm():0===
this.WK.FHb&&0<Ya&&this.Vm()}))}EPn(vb){this.Hb.$b(new L.a(0,1,0,()=>{this.WK.A9n(vb);this.Vm()}))}u8f(vb){this.WK.u8f(vb)&&this.Vm()}e3e(vb){this.WK.e3e(vb)&&this.Vm()}wbn(){return 0<this.WK.FHb}q7(){this.Wb.Jg(this.npb);t.ULS.sendTraceTag(40469190,312,50,"Taskpane now visible with focus on SearchBox")}aba(){if(this.K_a()){var vb;(vb=Ja.InteractiveViewManager.instance.xd)?(vb=vb.mI,t.ULS.sendTraceTag(40469191,312,50,"Taskpane now hidden with focus on previous selection view.")):(vb=this.Wb.HS,t.ULS.sendTraceTag(40469192,
312,50,"Taskpane now hidden with focus on default scope."));this.Wb.Jg(vb)}}K_a(){return!!this.Wb.og&&this.Wb.og.name===this.npb}static getInstance(){return Mb.Gl()}static Gl(){return new Mb(new Ra(a.AFrameworkApplication.ya),Object(va.a)(hc.getInstance(),hc.getInstance().getSelectedText,"getSelectedText"),bb.a.instance,K.a.instance,ha.a.instance,Object(va.a)(Ab.instance,Ab.instance.BAl,"getNextSearchResult"),n.a.instance.Pa("Box4.NavigationPaneViewElementManager.INavigationPaneViewElementManager"),
n.a.instance.Pa("WordEditor.IntelligentPlaceholder.IIntelligentPlaceholderEditor"),n.a.instance.Pa("Box4.AugmentationLoop.IAnnotationStorage"),n.a.instance.resolve("WordEditor.TableOfContents.IDocumentHeadings"),n.a.instance.resolve("WordEditor.FindReplace.NavPaneHeadingsManager"),U.a.instance,n.a.instance.resolve("Box4.AugmentationLoop.IAlFactoryWrapper"),new zb)}static recordQosError(vb,Ya,wb){const jb=Object.assign(new Ta.a,{extendedProperties:new Map});wb&&jb.extendedProperties.set("exception",
wb);X.Health.instance.recordQosError(vb,Ya,!1,!0,!1,!1,jb)}}Object(C.a)(Mb,"ReactFindReplacePane",H,[492,493,9]);var Tb=d(1546);d.d(N,"FindReplaceUIManager",function(){return rc});class rc{constructor(vb,Ya,wb=null,jb=null,Zb=null,Eb=null){this.h9c=this.M0=0;this.T4=this.S4=this.Rtb=!1;this.Sl=this.dSg=this.Eha=null;this.oCa=this.wve=!1;this.hh=vb;this.zp=wb;this.jtb=jb;this.HOg=Zb;this.le=Eb;rc.CYb=new O}get jtf(){return this.wve}set jtf(vb){vb!==this.wve&&(this.wve=vb,this.Elh())}I7d(vb){this.M0=
vb;this.update();this.M0||this.lF!==l.a.searchComplete&&this.lF!==l.a.tooManyResults?0<this.M0&&this.lF===l.a.noMatchesFound?this.C5(l.a.searchComplete):this.M0>rc.vbj&&this.lF!==l.a.tooManyResults&&(t.ULS.sendTraceTag(4065350,312,50,"Shifting to TooManyResults UI"),this.C5(l.a.tooManyResults)):this.C5(l.a.noMatchesFound)}j6d(vb){this.h9c=vb;this.oCa&&this.update();this.HOg&&!this.HOg.value.nYc&&this.rXf()}reset(){}z9e(){this.le&&(this.Sl=this.le.hg("UserAction","Find"));if(this.oCa||!this.lF)this.oCa=
!1,t.ULS.sendTraceTag(4065351,312,50,"FindStarted");this.C5(l.a.searching)}w1b(){var vb;this.oCa=!0;let Ya=this.M0?l.a.searchComplete:l.a.noMatchesFound;if(this.lF!==l.a.tooManyResults&&v.FindManager.instance){const wb=v.FindManager.instance.Ej;0<wb.lha&&(wb.lha>rc.vbj?Ya=l.a.tooManyResults:this.tlo(wb))}this.C5(Ya);this.update();this.Sl&&(this.Sl.stop(),this.Sl=null);rc.EVi=e.a.create().toString();rc.yni(0,this.Gbb,this.tLa().length,this.M0);Object(Tb.b)()&&(null===(vb=this.hh)||void 0===vb?0:vb.isVisible)&&
(vb={},a.AFrameworkApplication.ya.Xb(G.a.c2d,2,vb),vb[k.a.On]&&a.AFrameworkApplication.ya.Xb(G.a.lNd,2,{CommandValueId:{query:this.tLa(),matchCase:this.S4,matchWholeWordOnly:this.T4,totalResultLimit:-1}}))}tlo(vb){const Ya=vb.JAa;let wb=Ya;const jb=[];do jb[jb.length]=wb,wb=vb.CYa(wb);while(Ya!==wb);this.hh.MOe(jb);this.Eha&&this.hh.J5d(this.Eha)}update(){this.hh&&this.hh.lmo()}get lF(){return this.hh.lF}get Gbb(){return this.hh.lyd}tkb(vb){this.jtf=vb}Elh(){if(this.jtf)switch(this.lF){case l.a.searchComplete:case l.a.noMatchesFound:case l.a.tooManyResults:this.hh.A0c(!0)}else this.hh.A0c(!1)}C5(vb){if(this.hh.isVisible){switch(vb){case l.a.noMatchesFound:case l.a.searchComplete:this.lF===
l.a.tooManyResults&&(vb=l.a.tooManyResults)}this.hh&&(this.hh.C5(vb),this.Elh());this.update();this.rXf()}}WKa(vb,Ya){const wb=this.oCa&&this.lF!==l.a.tooManyResults;switch(vb){case 0:wb&&this.hh.MOe(Ya);break;case 1:wb&&this.hh.sOi(Ya);break;case 4:wb&&this.hh.Bij(Ya);break;case 2:this.hh.Kmh();break;case 3:this.Eha=Ya[0],wb&&0<this.M0&&this.hh.J5d(this.Eha)}}get matchCase(){return this.S4}set matchCase(vb){this.S4!==vb&&(this.S4=vb,this.Ugj())}get matchWholeWord(){return this.T4}set matchWholeWord(vb){this.T4!==
vb&&(this.T4=vb,this.Ugj())}Ugj(){this.hh.Nce()}tLa(){return this.hh.tLa()}RAb(){return this.hh.RAb()}XXf(vb){this.hh.XXf(vb)}clearSearch(){this.hh.clearSearch()}get o5i(){return 0<this.M0&&this.lF!==l.a.replaceAllInProgress&&this.lF!==l.a.replaceAllComplete}vHn(vb){let Ya="";vb?Ya=0<this.M0?String.format(WordEditorIntl.WordEditorStrings.l_ReadoutReplacedAndMoveToNextResult,this.tLa(),this.RAb()):String.format(WordEditorIntl.WordEditorStrings.l_ReadoutReplaceWithNoMoreResults,this.tLa(),this.RAb()):
vb||0<this.M0&&(Ya=WordEditorIntl.WordEditorStrings.l_ReadoutReplaceSkippedAndMoveToNextResult);this.rXf(Ya)}dispose(){this.hh.dispose()}zJc(){return this.hh.zJc()}oMn(vb,Ya=!0){vb!==this.Gbb&&(vb===B.a.headings?(t.ULS.sendTraceTag(9056651,367,50,""),this.hh.F4i()):vb===B.a.find?this.hh.y4i():vb===B.a.replace?this.hh.n5i():vb===B.a.intelligentPlaceholder&&(Ya||this.hh.k_i(Ya),this.hh.S4i()))}XA(vb,Ya=!0){this.hh.k_i(Ya);vb?(this.Rtb||this.Enf(),this.hh.qO(),this.M0||this.lF===l.a.noMatchesFound?a.AFrameworkApplication.K&&
a.AFrameworkApplication.K.$("WordEditorFindReplaceCancelButtonFixIsEnabled")&&this.hh.C5(l.a.searchComplete):this.C5(l.a.initial)):this.hh.Hla()}Enf(){this.Rtb||(this.hh.initialize(),this.Rtb=!0)}rXf(vb=""){var Ya=this.EGl();Ya&&(vb=String.format(WordEditorIntl.WordEditorStrings.l_FindReplaceResultSummaryScreenReaderNotification,vb,Ya));this.jtb&&Ya&&this.Eha&&this.lF!==l.a.tooManyResults&&this.lF!==l.a.replaceAllInProgress&&(Ya=this.jtb.Uxd(this.Eha),vb=String.format(WordEditorIntl.WordEditorStrings.l_FindReplaceResultSummaryScreenReaderNotification,
vb,Ya.EZe));(Ya=this.nrl())&&(vb=String.format(WordEditorIntl.WordEditorStrings.l_FindReplaceResultSummaryScreenReaderNotification,vb,Ya));this.zp&&vb&&this.dSg!==vb&&(this.dSg=vb,this.zp.sendNotification(vb,!0))}EGl(){let vb="";switch(this.lF){case l.a.startSearch:vb=WordEditorIntl.WordEditorStrings.l_SummarySearching;break;case l.a.searchComplete:vb=String.format(WordEditorIntl.WordEditorStrings.l_ReadoutCurrentResult,this.h9c,this.M0);break;case l.a.tooManyResults:this.oCa&&(vb=String.format(WordEditorIntl.WordEditorStrings.l_ReadoutCurrentResult,
this.h9c,this.M0));break;case l.a.noMatchesFound:vb=WordEditorIntl.WordEditorStrings.l_SummaryNoMatches;break;case l.a.replaceAllInProgress:vb=WordEditorIntl.WordEditorStrings.l_ReplaceAllInProgressReadout;break;case l.a.replaceAllComplete:vb=WordEditorIntl.WordEditorStrings.l_ReplaceAllComplete}return vb}nrl(){let vb="";switch(this.lF){case l.a.initial:vb=String.format(WordEditorIntl.WordEditorStrings.l_FindReplaceResultSummaryScreenReaderNotification,WordEditorIntl.WordEditorStrings.l_LandingMessage,
this.Prl());break;case l.a.noMatchesFound:vb=WordEditorIntl.WordEditorStrings.l_NoMatchesMessage;break;case l.a.replaceAllComplete:vb=Ua.a.VXh();break;case l.a.tooManyResults:vb=WordEditorIntl.WordEditorStrings.l_TooManyResultsMessage}return vb}Prl(){let vb="";this.S4&&this.T4?vb=String.format(WordEditorIntl.WordEditorStrings.l_SelectedSearchOptions,WordEditorIntl.WordEditorStrings.l_MatchCase,WordEditorIntl.WordEditorStrings.l_MatchWholeWord):this.S4?vb=String.format(WordEditorIntl.WordEditorStrings.l_SelectedSearchOption,
WordEditorIntl.WordEditorStrings.l_MatchCase):this.T4&&(vb=String.format(WordEditorIntl.WordEditorStrings.l_SelectedSearchOption,WordEditorIntl.WordEditorStrings.l_MatchWholeWord));return vb}static getInstance(vb){return rc.Gl(vb)}static Gl(vb){const Ya=Mb.getInstance();return new rc(Ya,vb,n.a.instance.resolve("Common.Utils.IAriaNotifier"),K.a.instance,new y.a(()=>v.FindManager.instance.yIb),u.App.xa.jq)}static yni(vb,Ya=-1,wb=-1,jb=-1){t.ULS.sendTraceTag(4065352,312,50,"{0}",{["SearchOp"]:vb,["SearchComplete.ResultsCount"]:jb,
["SearchOpsCorrelation"]:rc.EVi,["ActionId"]:rc.CYb.actionId,["SourceControlId"]:rc.CYb.xEa,["IsNavPanOpenedAlready"]:rc.CYb.xgm,["IsSearchFromNavPane"]:rc.CYb.Ujm,["CurrentTab"]:Ya,["QueryLength"]:wb})}static Fok(vb,Ya,wb){Ya=void 0!==Ya&&null!==Ya?void 0===Ya.SourceControlId||null===Ya.SourceControlId?"Unknown":Ya.SourceControlId:vb===F.a.Nkb?"FindKeyboardShorcut":vb===F.a.Pkb?"ReplaceKeyboardShorcut":"Unknown";switch(vb){case F.a.Oec:vb="ShowHeadingsPane";break;case F.a.Nkb:vb="ShowFindPane";break;
case F.a.Pkb:vb="ShowReplacePane";break;case F.a.Sec:vb="ShowIntelligentPlaceholderPane";break;case F.a.sQa:vb="ToggleNavigationPane";break;default:vb="Unknown"}rc.CYb=new O(vb,Ya,wb,!0)}}rc.vbj=100;rc.EVi=null;rc.CYb=null;Object(C.a)(rc,"FindReplaceUIManager",null,[475,284,9])},1600:function(C,N,d){d.r(N);C=d(0);var l=d(159),e=d(84),a=d(68),k=d(2),n=d(22),v=d(56),u=d(1059),t=d(128),y=d(9),B=d(8),G=d(18),F=d(336),K=d(502),O=d(1517),H=d(1760),I=d(27),J=d(289),L=d(7),S=d(480),E=d(19),P=d(273),T=d(53),
U=d(550),X=d(1639);class Y{constructor(zb,Ua,Ab,mb,Rb,hc,Hb,Ta){this.QRg=this.qWg=this.sFg=this.qG=this.b5a=this.rNb=this.bqe=this.Xle=this.Fne=this.UM=this.W4=this.a5=null;this.Ace=()=>{const Aa=this.Qia.hAb(this.qG),ma=this.Qia.$sl(this.qG);this.Xle.innerText=Aa.toString();this.bqe.innerText=ma.toString();H.a.yJb(this.a5,1===Aa?!1:!0);H.a.yJb(this.W4,Aa===ma?!1:!0)};this.PJn=()=>{const Aa=this.Wb.getRegion(F.a.RXa);let ma;if(this.Kqb)if(this.UM&&!this.UM.disabled)ma=this.UM;else if(this.a5.disabled){if(this.W4.disabled)return;
ma=this.W4}else ma=this.a5;else if(this.W4.disabled)if(this.a5.disabled)if(this.UM&&!this.UM.disabled)ma=this.UM;else return;else ma=this.a5;else ma=this.W4;ma.focus();Aa.Vj.oy(ma)};this.una=(Aa,ma)=>{(Aa=ma.ll.kb)&&this.UM&&H.a.yJb(this.UM,E.SelectionEditor.Qm(Aa)?!0:!1)};this.jXe=()=>{if(!this.W4.disabled){const Aa=this.Qia.Sfb(this.qG)?G.a.eDf:G.a.dDf;this.ga.processAction(Aa,2)}return!0};this.kXe=()=>{if(!this.a5.disabled){const Aa=this.Qia.Sfb(this.qG)?G.a.gDf:G.a.fDf;this.ga.processAction(Aa,
2)}return!0};this.iXe=()=>{this.UM&&!this.UM.disabled&&this.ga.processAction(G.a.vki,2);return!0};this.Wb=zb;this.ga=mb;this.ig=Rb;this.ke=hc;this.ib=Hb;this.Qia=Ab;this.M5=document.createElement("div");this.M5.classList.add("FootnoteEndnoteActionBarControl");this.Kqb=Ta;this.M5.style.zIndex=String(P.a.qAd);this.M5.style.position="relative";this.vmc=document.createElement("div");this.vmc.classList.add("FootnoteEndnoteActionBarControlDividerElement");this.Kqb=Ta;this.M5.appendChild(this.vmc);this.oHk();
this.M5.appendChild(this.rNb);this.M5.appendChild(this.b5a);this.wY=e.KeyInputManager.lc(a.a.X_,0);this.g3l();this.f3l()}dea(zb){B.ULS.shipAssertTag(4520065,308,this.Qia.ama(zb));if(this.qG!==zb){this.qG=zb;this.Ace();zb=this.Qia.Sfb(this.qG);this.NJk(zb);this.qG.x$g(this.Ace);let Ua,Ab;this.Kqb&&(Ua=this.Qia.hAb(this.qG)-1,Ab=this.Qia.hAb(this.qG)+1);zb?(this.W4.title=this.Kqb&&!this.W4.disabled?String.format(WordEditorIntl.WordEditorStrings.L_NextFootnoteWithNumber,Ab.toString()):WordEditorIntl.WordEditorStrings.L_NextFootnote,
this.a5.title=this.Kqb&&!this.a5.disabled?String.format(WordEditorIntl.WordEditorStrings.L_PrevFootnoteWithNumber,Ua.toString()):WordEditorIntl.WordEditorStrings.L_PrevFootnote):(this.W4.title=this.Kqb&&!this.W4.disabled?String.format(WordEditorIntl.WordEditorStrings.L_NextEndnoteWithNumber,Ab.toString()):WordEditorIntl.WordEditorStrings.L_NextEndnote,this.a5.title=this.Kqb&&!this.a5.disabled?String.format(WordEditorIntl.WordEditorStrings.L_PrevEndnoteWithNumber,Ua.toString()):WordEditorIntl.WordEditorStrings.L_PrevEndnote);
this.MDa()}}hyb(){this.qG&&(this.UM&&this.UM.parentNode===this.rNb&&this.rNb.removeChild(this.UM),this.rha(),this.qG.Lrn(this.Ace),this.qG=null)}dispose(){this.Wb.re(F.a.RXa).Dr(this.wY)}NJk(zb){3===this.ga.mode&&(zb=zb?WordEditorIntl.WordEditorStrings.L_FormatFootnotes:WordEditorIntl.WordEditorStrings.L_FormatEndnotes,this.UM=this.i_e("FootnoteEndnoteFormattingOptionButton","FootnoteEndnoteActionBarFormattingButton",zb,null),I.a.Iq(this.UM,I.a.lda,zb),this.rNb.appendChild(this.UM))}oHk(){this.rNb=
document.createElement("div");this.rNb.classList.add("FootnoteEndnoteActionBarButtonHolder","FootnoteEndnoteActionBarLeftDiv");this.b5a=document.createElement("div");this.b5a.classList.add("FootnoteEndnoteActionBarButtonHolder","FootnoteEndnoteActionBarRightDiv");this.a5=this.i_e("FootnoteEndnotePreviousButton","FootnoteEndnoteActionBarNavigationButton","","LeftPageArrow_20x20x32");this.b5a.appendChild(this.a5);this.Xle=S.b("span","FootnoteEndnoteActionBarCurrentCount","FootnoteEndnoteActionBar");
this.b5a.appendChild(this.Xle);this.Fne=S.b("span","FootnoteEndnoteActionBarDivider","FootnoteEndnoteActionBar");this.Fne.innerText=" / ";this.b5a.appendChild(this.Fne);this.bqe=S.b("span","FootnoteEndnoteActionBarTotalCount","FootnoteEndnoteActionBar");this.b5a.appendChild(this.bqe);this.W4=this.i_e("FootnoteEndnoteNextButton","FootnoteEndnoteActionBarNavigationButton","","RightPageArrow_20x20x32");this.b5a.appendChild(this.W4)}i_e(zb,Ua,Ab,mb){zb=H.a.CWa(zb,Ua,Ab,mb,void 0===mb||null===mb);zb.setAttribute(I.a.Ch,
I.a.t1);return zb}g3l(){const zb=this.Wb.re(F.a.RXa);zb.parent=t.AppFrame.Np;zb.bindAction(this.wY,G.a.T9);zb.eda(this.PJn)}f3l(){var zb=new J.DOMFocusListing(()=>this.M5);zb.PDa=!1;zb.Go(2);zb.Go(1);zb=this.Wb.AUe(this.M5,this.Wb.re(F.a.RXa),zb);zb.JOa();zb.mX=!0}MDa(){this.UM&&(this.ig.mb(L.a.click,this.UM,this.iXe),this.sFg=this.ke.sjb(this.UM,this.iXe,a.a.es));this.ig.mb(L.a.click,this.a5,this.kXe);this.qWg=this.ke.sjb(this.a5,this.kXe,a.a.es);this.ig.mb(L.a.click,this.W4,this.jXe);this.QRg=this.ke.sjb(this.W4,
this.jXe,a.a.es);this.ib.oB(this.una)}rha(){this.UM&&(this.ig.sc(L.a.click,this.UM,this.iXe),this.ke.emb(this.UM,this.sFg));this.ig.sc(L.a.click,this.a5,this.kXe);this.ke.emb(this.a5,this.qWg);this.ig.sc(L.a.click,this.W4,this.jXe);this.ke.emb(this.W4,this.QRg);this.ib.uga(this.una)}static Vsl(){return Y.Wsl()}static Wsl(){return new Y(v.FocusManager.instance(),X.a.instance,U.a.instance,k.AFrameworkApplication.ya,y.App.xa.ez,y.App.xa.my,T.a.instance,!!y.App.instance&&y.App.instance.Igb)}}Object(C.a)(Y,
"FootnoteEndnoteActionBarControl",null,[448]);var ca=d(204),da=d(13),ua=d(1560),ra=d(1718);class qa{constructor(zb,Ua,Ab,mb,Rb,hc,Hb,Ta,Aa,ma,Ga,Fa){this.OD=null;this.KR=!1;this.ov=null;this.onClick=()=>{this.dismiss(!1,!0);return!0};this.qTb=zb;this.B0b=Ua;this.Zic=Ab;this.KOj=mb;this.GAe=Rb;this.Ql=hc;this.k7a=Hb;this.ig=Ta;this.TUg=Aa;this.JBj=Ga;this.Xq=this.qTb.ownerDocument.createElement("div");this.Xq.id="FootnoteEndnoteControlOverlay";this.Xq.className="EditingSurfaceOverlay";this.zH=this.znl();
this.o_(!1);this.qTb.appendChild(this.Xq);this.qTb.appendChild(this.zH);this.B0b.bind();this.jg=null;this.ga=Fa;this.WGa=ma}Kwn(){const zb=this.TUg();zb&&zb.wi&&(zb.Wjb=0,zb.vrd())}Vfj(zb){if(this.lzc){const Ua=this.lzc.Yka;Ua&&(Ua.Sqf=zb)}}get fH(){return this.KR}get lzc(){return this.OD}get dialog(){return this.jg}get Hn(){return null!=this.Fkg?this.Fkg:this.Fkg=n.a.instance.Za("Common.IZoomManager")}N_e(){this.jg=ra.a.dtl()}GYc(){this.jg=null}show(zb=!0){this.KR||(this.Vfj(!0),this.JBj(),this.o_(!0),
this.Xy(),zb&&this.setFocus())}setFocus(){this.KR&&(this.B0b.setInitialSelection(),this.KOj())}update(){this.KR&&(this.OD.isConnected?this.Zic.Ace():this.dismiss())}dismiss(zb=!1,Ua=!1){this.KR&&(this.Vfj(!1),this.Q7(),this.Kwn(),this.o_(!1),this.GAe(Ua),this.jg&&(this.ga.processAction(da.a.TDc,2),this.jg=null),!zb&&this.OD&&this.OD.isConnected&&this.WGa.VDn(this.OD),this.hyb())}tvn(zb){const Ua=null!==this.Hn.instance?this.Hn.instance.vj:1;this.zH.style.width=zb.Cqh*Ua+"px";this.ov.style.width=zb.dCc*
Ua+"px";this.zH.style.marginLeft=zb.GZb*Ua+"px";this.Ql?this.ov.style.marginRight=zb.wZe*Ua+"px":this.ov.style.marginLeft=zb.OZb*Ua+"px";if(zb=this.TUg())zb=zb.wK,this.zH.style.bottom=zb.offsetHeight-zb.clientHeight+"px"}dea(zb){B.ULS.shipAssertTag(4520073,308,this.k7a.ama(zb));this.OD!==zb&&(this.OD=zb,this.B0b.dea(zb),this.Zic.dea(this.OD))}dispose(){this.dismiss();this.B0b.dispose();this.Zic.dispose()}Xy(){this.ig&&this.ig.mb(L.a.click,this.Xq,this.onClick)}Q7(){this.ig&&this.ig.sc(L.a.click,this.Xq,
this.onClick)}znl(){let zb;zb=document.createElement("div");zb.classList.add("FootnoteEndnoteControl");this.ov=document.createElement("div");this.ov.classList.add("FootnoteEndnoteContent");this.ov.appendChild(this.B0b.M5);this.ov.appendChild(this.Zic.M5);zb.appendChild(this.ov);return zb}o_(zb){zb=(this.KR=zb)?"":"none";this.Xq.style.display=zb;this.zH.style.display=zb}hyb(){this.OD&&(this.B0b.hyb(),this.Zic.hyb(),this.OD=null)}static gHd(){const zb=y.App.xa.jb.Ic;return zb&&zb.wi?zb:null}static Zsl(zb,
Ua,Ab,mb,Rb){return new qa(zb,Ua,Ab,mb,Rb,k.AFrameworkApplication.isRtl,U.a.instance,ca.a.instance,qa.gHd,ua.a.instance,qa.vXk,k.AFrameworkApplication.ya)}static vXk(){k.AFrameworkApplication.ya.Xb(da.a.Neb,2,!0)}}Object(C.a)(qa,"FootnoteEndnoteControl",null,[447]);var ka=d(799),la=d(6),Ha=d(211),wa=d(40),Ca=d(11),Ja=d(25),bb=d(89),ha=d(1638),ia=d(371),va=d(946),Ka=d(581),Xa=d(1434),xa=d(78),Ma=d(120);class Na extends ia.a{constructor(zb,Ua,Ab,mb,Rb,hc,Hb,Ta,Aa,ma,Ga,Fa,ib,ob,fb,Mb,Tb){super(F.a.mea,
Ab,mb,Rb,Hb,Ta,Aa,ma,Ga,Fa,ib,ob,fb,Mb,Tb);this.rzg=zb;this.YTa=hc;this.YTa.U1c=this;Ua(this);this.features.x3f=!0}get $ci(){return!0}ijf(){const zb=this.rzg.Baf(this);return va.ViewReference.sF(this,zb)}B4e(zb){Object(Ma.a)(Na,zb)||this.rzg.y4e()}CJc(){return Ka.a.Hri}onResize(){super.onResize();this.YTa.vEh()}rB(zb,Ua=null){super.rB(zb,Ua);this.YTa.iEh(this.rd.Qi)}detach(){this.YTa.uEh();super.detach()}HDd(){this.onResize()}static AWa(){const {FootnoteEndnoteControlManager:zb}=d(1600);return new Na(zb.instance,
Xa.a.MYe,y.App.xa.jb,xa.InteractiveViewManager.instance,()=>n.a.instance.resolve("Box4.IUndoManager"),n.a.instance.resolve("WordEditor.SectionAlignedViewRepositioner"),k.AFrameworkApplication.ya,n.a.instance.resolve("Box4.IHtmlViewRootFactory"),n.a.instance.resolve("Box4.IInteractiveEventNotifier"),n.a.instance.Za("Box4.ITextMetricsAdapter"),n.a.instance.resolve("Box4.IRotatingCoordinateConverter"),n.a.instance.Za("Common.IZoomManager"),n.a.instance.Pa("Box4.IContentControlViewElementManager"),n.a.instance.Pa("Box4.CpConversionManagerImpl"),
n.a.instance.Pa("Box4.ContentControlConfigSettings"),n.a.instance.Pa("Box4.IContentControlReader"),n.a.instance.Pa("Box4.IContentControlBoundaryNavigator"))}}Object(C.a)(Na,"FootnoteEndnoteEditView",ia.a,[]);class pa{constructor(zb,Ua,Ab,mb=!1){this.tpb=null;this.kue=this.lwg=!1;this.Ycl=()=>{const Rb=String.format("{0} {1}",this.kue?WordEditorIntl.WordEditorStrings.l_FootnoteEditingSurfaceAccessibilityTitleText:WordEditorIntl.WordEditorStrings.l_EndnoteEditingSurfaceAccessibilityTitleText,WordEditorIntl.WordEditorStrings.l_EditingSurfaceAccessibilityDescribedByText);
this.jw.sendNotification(Rb,!0)};this.Wb=zb;this.Qia=Ua;this.fca=Ab();this.ddd=mb;this.M5=document.createElement("div");this.M5.classList.add("FootnoteEndnoteEditControl");this.vmc=document.createElement("div");this.vmc.classList.add("FootnoteEndnoteEditControlDividerElement");this.yub=(new ka.a(this.M5,"WACViewPanel_FootnoteEndnoteEditControl")).BE;this.M5.appendChild(this.vmc);this.M5.appendChild(this.yub)}get jw(){return null!=this.ugg?this.ugg:this.ugg=n.a.instance.resolve("Common.Utils.IAriaNotifier")}dea(zb){B.ULS.shipAssertTag(4520077,
308,this.Qia.ama(zb));this.tpb!==zb&&(this.tpb=zb,this.lSe(this.tpb),this.kue=this.Qia.Sfb(this.tpb),this.ddd?(this.fca.BJb(I.a.msd),this.Wb.re(F.a.mea).dda(this.Ycl)):this.fca.MYi(this.kue?WordEditorIntl.WordEditorStrings.l_FootnoteEditingSurfaceAccessibilityTitleText:WordEditorIntl.WordEditorStrings.l_EndnoteEditingSurfaceAccessibilityTitleText,I.a.msd))}hyb(){const zb=U.a.instance.Sfb(this.tpb)?"Footnote":"Endnote";B.ULS.sendTraceTag(4006494,308,50,"{0}",{["Type"]:zb,["CalloutHeight"]:this.M5.scrollHeight});
this.Tbb();this.tpb=null}bind(){this.lwg||(this.fca.oab(this.yub),this.lwg=!0)}setInitialSelection(){const zb=this.tIl();zb?this.fca.setSelection(zb):this.fca.F_c()}dispose(){this.Tbb()}lSe(zb){this.Tbb();this.fca.rB(zb,zb.Qi)}Tbb(){this.fca.detach()}tIl(){let zb=0;var Ua=null,Ab=la.GraphIterator.$a(this.tpb);Ha.OutlineNavigator.P6(Ab);if((Ab=wa.OutlineElementNavigator.De(Ab))&&Ca.ParagraphReader.nc(Ab)){if(Ua=pa.Rwl(Ab)){zb=Ua.Ob.cp+1;Ua=ha.FootnoteEndnoteDefaultContentInserter.Kxh;const mb=Ua.length;
zb+mb<=Ca.ParagraphReader.textLength(Ab)&&Ab.characterData.substr(zb,mb)===Ua&&(zb+=mb)}Ua=Ja.SelectionFactory.xe(Ab,zb)}return Ua}static atl(){return pa.btl()}static btl(){return new pa(v.FocusManager.instance(),U.a.instance,()=>Na.AWa(),k.AFrameworkApplication.K.$("AccessibilityNotificationEnabledViaAriaLiveRegion"))}static Rwl(zb){zb=bb.i(zb,10);return 0<zb.length?zb[zb.length-1]:null}}Object(C.a)(pa,"FootnoteEndnoteEditControl",null,[446]);var Ra=d(1158);class Sa{constructor(zb,Ua){this.eya=zb;
this.Ql=Ua}G3b(zb,Ua){zb=this.eya.G3b(zb);var Ab=Ua.clientWidth;const mb=Ua.scrollLeft,Rb=zb.Cqh;let hc=zb.GZb,Hb=zb.GZb,Ta=Sa.hAf,Aa=Sa.iAf,ma=Rb,Ga=zb.dCc;this.Ql?Aa=zb.wZe-Hb:Ta=zb.OZb-hc;Ab<Rb&&(hc=Math.max(hc-mb,0),ma=Ab-hc,this.Ql?(Ab=Ua.scrollWidth-mb-Ab,Hb=Ua.scrollWidth-zb.GZb-Rb,Aa=Math.max(zb.wZe-Ab-Hb,Sa.iAf),Ga=ma-Aa-Sa.hAf):(Ta=Math.max(zb.OZb-mb-hc,Sa.hAf),Ga=ma-Ta-Sa.iAf));return new Ra.a(hc,ma,Ta,Aa,Ga)}}Sa.hAf=25;Sa.iAf=50;Object(C.a)(Sa,"FootnoteEndnoteViewPositionProvider",null,
[]);class ab{constructor(zb,Ua=0,Ab=0){this.clientWidth=zb;this.scrollLeft=Ua;this.scrollWidth=Ab?Ab:zb}}Object(C.a)(ab,"PageViewScrollContainerSizeInfo",null,[]);d.d(N,"FootnoteEndnoteControlManager",function(){return eb});class eb{constructor(zb,Ua,Ab,mb,Rb,hc,Hb,Ta){this.HD=null;this.q7=()=>{this.Oo.DG(F.a.mea);this.Oo.DG(F.a.RXa);this.Oo.Mw(l.AFrame.Zp);this.Wb.Rxc(F.a.mea);this.Wb.Jg(F.a.mea)};this.XJn=Aa=>{this.Oo.Mw(F.a.mea);this.Oo.Mw(F.a.RXa);this.Oo.DG(l.AFrame.Zp);this.Wb.rDc(F.a.mea);
(Aa||this.Wb.og&&(this.Wb.og.name===F.a.mea||this.Wb.og.name===F.a.RXa))&&this.Wb.Jg(l.AFrame.Zp)};this.Wb=zb;this.Oo=Ua;this.TEj=Ab;this.UEj=mb;this.SEj=Rb;this.eya=hc;this.Hpa=Hb;this.RD=Ta;this.wY=e.KeyInputManager.lc(a.a.X_,0);this.wnf();this.qS()}get control(){return this.HD}get dialog(){return this.control.dialog}get rbi(){return this.control.fH}N_e(){this.control.N_e()}GYc(){this.control.GYc()}bind(zb){this.lDk(zb)}k0f(zb){if(this.control.lzc!==zb.vWa)this.control.dismiss();else if(this.rbi)return;
this.g0b();this.control.dea(zb.vWa);this.control.show(zb.$7d)}g0b(){if(this.RD){const zb=new u.a(!0);this.RD.HDa(zb)}}HX(){this.control.setFocus()}z3c(){this.control.update()}y4e(zb,Ua=!1){this.g0b();this.control.dismiss(zb,Ua)}rvn(zb){const Ua=eb.gHd().wK;zb=this.eya.G3b(zb,new ab(Ua.clientWidth,Ua.scrollLeft,Ua.scrollWidth));this.control.tvn(zb)}dispose(){this.control.dispose();this.Wb.re(F.a.mea).Dr(this.wY)}Baf(zb){B.ULS.shipAssertTag(4520074,308,!!this.control);B.ULS.shipAssertTag(4520075,308,
!!this.control.lzc);return this.Caf(this.control.lzc.id,zb)}lDk(zb){const Ua=this.UEj(),Ab=this.SEj();this.HD=this.TEj(zb,Ua,Ab,this.q7,this.XJn)}wnf(){const zb=this.Wb.re(F.a.mea);zb.parent=3===k.AFrameworkApplication.ya.mode?t.AppFrame.pF:t.AppFrame.$Wc;this.Wb.cOe(F.a.mea);zb.bindAction(this.wY,G.a.T9)}qS(){this.Oo.qS(F.a.mea);this.Oo.qS(F.a.RXa)}Caf(zb,Ua){return()=>{const Ab=eb.gHd().rd.Lc.Eb(zb);this.Hpa.Y0b();if(!Ab.isConnected)return B.ULS.sendTraceTag(4520076,308,10,"{0}",{["Error"]:"Unable to restore footnoteEndnote control"}),
null;this.k0f(new K.a(Ab,!0));return Ua}}static Gl(){const zb=new Sa(n.a.instance.resolve("Box4.SectionAlignedViewPositionProvider"),k.AFrameworkApplication.isRtl);return new eb(v.FocusManager.instance(),y.App.xa.jv,qa.Zsl,pa.atl,Y.Vsl,zb,O.a.instance,n.a.instance.resolve("Box4.IPasteFloatieEventSource"),n.a.instance.resolve("Common.IAppSettingsManager"))}static gHd(){const zb=y.App.xa.jb.Ic;return zb&&zb.wi?zb:null}static get instance(){return null!=eb.Hmg?eb.Hmg:eb.Hmg=eb.Gl()}}Object(C.a)(eb,"FootnoteEndnoteControlManager",
null,[429])},1619:function(C,N,d){d.d(N,"a",function(){return y});C=d(0);var l=d(8),e=d(44),a=d(159),k=d(2),n=d(7),v=d(143),u=d(158),t=d(22);class y{constructor(B,G){this.ot=null;this.Njd=!1;this.t8a=0;this.wNg="";this.uje={};this.lze=B;this.Wb=G;this.oTg=Object(e.a)(this,this.vHf,"onModalMouseWheel");this.qMg=!!k.AFrameworkApplication.ua&&k.AFrameworkApplication.ua.Sb.nma;this.ew=!!k.AFrameworkApplication.ua&&k.AFrameworkApplication.ua.Sb.A6}onMenuOpen(){0<this.t8a?this.t8a++:(this.t8a++,k.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.DelayMenuFocusActionsUntilNextFrame",
!1)?window.requestAnimationFrame(()=>{window.setTimeout(Object(e.a)(this,this.THi,"pushTransientFocusScope"),0)}):this.THi(),this.showModal())}THi(){this.Wb&&this.Wb.uK(a.AFrame.yna,!0)}okl(){const B=u.f(),G=appChrome.selectors.getShyState();return String.format("{0}{1}",B,this.qMg&&G.isActive&&1===G.state?"_ShyRibbon":"")}RMl(B){var G=0;if(this.ew){if(this.uje[B])return this.uje[B];(G=document.getElementById("BusinessBar"))||l.ULS.sendTraceTag(524142489,340,10,"Failed to propertly get region composer Business Bar Region for setting up Modal Div");
G=G?G.offsetTop:0;this.uje[B]=G}return G}showModal(){if(!this.ot)if(this.ot=this.createElement("div"),this.ot.setAttribute("id","ReactModalDiv"),this.ot.style.position="absolute",this.ot.style.bottom="0px",this.ot.style.left="0px",this.ot.style.right="0px",this.ot.style.backgroundColor="white",this.ot.style.opacity="0.0",this.ew){var B=document.getElementById("regionComposerRoot");B&&B.appendChild(this.ot)}else this.lze.appendChild(this.ot);B=this.okl();if(B!==this.wNg){const G=this.RMl(B),F=appChrome.selectors.getShyState();
this.qMg&&F.isActive&&1===F.state&&u.a("getRibbonHeight")?this.ot.style.top=String.format("{0}px",G+appChrome.api.getRibbonHeight(u.f())):this.ot.style.top=String.format("{0}px",G);this.wNg=B}this.ot.style.display="block";this.ot.style.visibility="visible";this.ot.style.zIndex="1000";this.Njd||(window.addEventListener("wheel",this.oTg,!0),this.sPd()?v.a.instance.mb(n.a.fM,this.ot,Object(e.a)(this,this.PXd,"onModalPointerUp")):v.a.instance.mb(n.a.pointerDown,this.ot,Object(e.a)(this,this.OXd,"onModalPointerDown")),
this.Njd=!0)}onMenuClose(){this.t8a--;0<this.t8a||(0>this.t8a?this.t8a=0:this.e5h())}PFf(){this.t8a=0;this.x4e();this.e5h()}createElement(B){B=document.createElement(B);B.setAttribute("unselectable","on");return B}d5h(){this.Wb&&this.Wb.og&&this.Wb.og.name===a.AFrame.yna&&!k.AFrameworkApplication.uc.Mv&&this.Wb.NQ(a.AFrame.yna,!1);this.ot&&(this.ot.style.zIndex="-1",this.ot.style.visibility="hidden",this.ot.style.display="none");this.Njd&&(window.removeEventListener("wheel",this.oTg,!0),this.sPd()?
v.a.instance.sc(n.a.fM,this.ot,Object(e.a)(this,this.PXd,"onModalPointerUp")):v.a.instance.sc(n.a.pointerDown,this.ot,Object(e.a)(this,this.OXd,"onModalPointerDown")),this.Njd=!1)}e5h(){this.sPd()?window.requestAnimationFrame(()=>{window.setTimeout(()=>{this.d5h()},0)}):this.d5h()}OXd(){this.fEc();this.jAh();this.PFf();this.lkb();return!0}PXd(){this.fEc();this.jAh();this.PFf();window.requestAnimationFrame(()=>{window.setTimeout(()=>{this.lkb()},0)});return!0}lkb(){4===k.AFrameworkApplication.ua.Sb.jo&&
k.AFrameworkApplication.K.$("OneNoteAutoSwitchToTypeWhileInkingIsEnabled")?k.AFrameworkApplication.ua.lkb():this.Wb.Jg(a.AFrame.Zp)}vHf(B){B.stopPropagation()}fEc(){const B=t.a.instance.Pa("Common.IReactContextualUILauncher");B&&B.fEc()}x4e(){const B=t.a.instance.Pa("Common.IReactContextualUILauncher");B&&B.x4e()}jAh(){k.AFrameworkApplication.ua&&k.AFrameworkApplication.ua.Sb.GMa&&(this.sPd()?appChrome.selectors.getFileMenuExpanded():1)&&appChrome.api.dispatch(appChrome.actions.updateFileMenuExpandedValue(!1))}sPd(){return k.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ReactModalDivPerfImprovements",
!1)}}Object(C.a)(y,"ReactModalDiv",null,[])},1624:function(C,N,d){d.d(N,"a",function(){return e});d.d(N,"b",function(){return a});d.d(N,"c",function(){return k});var l=d(2);const e=(n,v)=>{const u=RegExp("mailto:(.*)").exec(n.url);v.email=u&&2===u.length?u[1]:n.url;v.resolveState=n.Hx.charAt(35)===d(1707).ACommentFormatTranslator.Hfk?1:0},a=(n,v)=>{v.contentId=n.Hx},k=(n,v,u)=>{v.contentId=n.Hx;v.isCurrentUser=u.email===l.AFrameworkApplication.K.lb("UserPrincipalName")}},1625:function(C,N,d){d.d(N,
"a",function(){return a});C=d(0);var l=d(1004),e=d(5);class a{constructor(k,n){this.MM=this.xsc=null;this.fb=k;this.T5a=n}get key(){return"COMMENT"}get mw(){return WordEditorIntl.WordEditorStrings.L_Comment}get ska(){return this.MM}reset(k){this.MM=k.node}ZEa(k){let n=null;if(this.xsc&&this.vbi(k,this.ska,this.xsc))return n=Object.assign(new l.a,{QF:this.key,contentObject:this.xsc}),{returnValue:!0,XE:n};this.xsc=null;const v=this.T5a.h0e(this.ska);if(this.T5a.Apf(v)){let u=v.Xd();for(;u;){if(this.vbi(k,
this.ska,u))return this.xsc=u,n=Object.assign(new l.a,{QF:this.key,contentObject:u,description:this.zdb()}),{returnValue:!0,XE:n};u=v.xj()}}return{returnValue:!1,XE:n}}vbi(k,n,v){if(this.K3i(v))return!1;const u=this.T5a.K3b(v,!0),t=this.T5a.K3b(v,!1);return u&&t&&this.fb.HOc(n,u,t)&&(n=this.T5a.Ssa(u,v.id,!0))&&(u!==this.ska||n.Ob.cp<=k)&&(v=this.T5a.Ssa(t,v.id,!1))&&(t!==this.ska||v.Ob.cp>k||v.Ob.cp>=k)?!0:!1}K3i(k){return k.ia(e.a.HF,!1)}zdb(){return null}}Object(C.a)(a,"CommentDetailsProvider",
null,[268,269])},1631:function(C,N,d){d.d(N,"a",function(){return e});C=d(0);N=d(174);var l=d(111);class e extends N.a{constructor(){super();this.documentTypeConfidences=null;this.H_=Object.assign(new l.a,{T_:e.getTypeName(),B_:e.getBaseTypes()})}static getTypeName(){return"AugLoop_DocumentTypeClassifier_DocumentTypeClassifierAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}}Object(C.a)(e,"DocumentTypeClassifierAnnotation",N.a,[])},1634:function(C,N,d){d.d(N,"a",function(){return t});
C=d(0);var l=d(2),e=d(83),a=d(8),k=d(44),n=d(97),v=d(65),u=d(643);class t{constructor(y,B,G,F,K,O){this.oCe=null;this.jWg=0;this.ld=F;this.te=B;this.i4=K;this.dse=G;this.Bkc=l.AFrameworkApplication.Y_f();this.hke=y.appSettings.ChromeClipboardAccessOperationTimeout;this.DH=0;this.Lyj=O;this.VCj=y.$("EnableExternalPasteSupportOnMobileIsEnabled")}get jOa(){return this.i4.jOa}process(y,B){if(!this.DH)return this.q3m(B);if(1===this.DH)return this.prepareForPaste(y,B);if(2===this.DH)return this.DH=3,this.oCe(y,
B);3===this.DH&&this.i4.X_i(y,B);return!1}q3m(y){let B=!0;this.VCj&&(B=!(y.lA&1));this.te.z2&&B||y.lA&512?(this.oCe=y.lA&2?Object(k.a)(this.i4,this.i4.paste,"paste"):Object(k.a)(this.i4,this.i4.TDi,"pasteInternal"),this.DH=2):(this.Bkc?(this.DH=1,this.jWg=Date.now()):this.DH=2,this.oCe=Object(k.a)(this.i4,this.i4.paste,"paste"));u.a.Tzm(y);return!0}prepareForPaste(y,B){y=!0;if(this.dse.value.XFi())this.DH=2;else{const G=Date.now()-this.jWg;G>this.hke&&(a.ULS.sendTraceTag(18158340,307,50,"prepareTime : {0}",
G),this.ld.Zb(n.a.Ska,{["Reason"]:v.a.KBi}),B.FQ&&(B.FQ.fail("Prepare for paste timed out",!1),e.Health.instance.recordQosError("PreparePasteTimedOut",[u.a.t_d],!1,!0,!0,!1,null)),B.failed=!0,y=!1,this.Lyj.$wn())}return y}}Object(C.a)(t,"ClipboardOperationPasteProcessor",null,[589])},1635:function(C,N,d){d.d(N,"a",function(){return P});C=d(0);N=d(239);var l=d(2),e=d(83),a=d(57),k=d(106),n=d(8),v=d(120),u=d(72),t=d(1903),y=d(44),B=d(20),G=d(3),F=d(97),K=d(65),O=d(1061),H=d(19),I=d(53),J=d(1575),L=
d(1636),S=d(643),E=d(161);class P extends N.a{constructor(T,U,X,Y,ca,da,ua,ra,qa,ka,la,Ha,wa,Ca,Ja,bb,ha,ia,va,Ka,Xa,xa,Ma,Na,pa,Ra,Sa,ab=!0){super();this.Oha=this.mB=null;this.JK=this.pz=0;this.d$a=this.sGe=this.E8=this.Ef=null;this.VO=!1;this.cS=!0;this.YGg=!1;this.init(T);this.ml("ClipboardOperation");this.lfb(qa,U,ca,da,ua);this.ld=ka;this.Fe=la;this.te=Ha;this.Hc=wa;this.iyg=Ca;this.kyg=Ja;this.jyg=bb;this.uke=ha;this.vOb=ia;this.vke=va;this.Bkc=ra;this.qkc=Ka;this.IIa=Xa;this.qZj=ab;this.GC=
xa;this.Hd=Ma;this.wm=Na;this.RD=pa;this._context=Y;this.Tca=Ra;this.SUb=Sa;ua&&Object(v.a)(93,ua)&&(this.E8=Object(u.a)(606,ua.ia(k.a.Jra,null)));this.E8||(this.E8=this.Tca.i1c());this.anb=void 0===X||null===X?"NotAvailable":Object(t.a)(L.a,X);this.E8.dck(this.anb.split(", "));T=this._context;if(this.SUb){if(!P.Ljh(T,this.uke,this.ld,this.E8,ab)){this.ar=8;this.finish();return}this.Ef=T.view;this.VO=3===this.Ef.mEb;this.pz=0;this.JK=X;this.d$a=ha.jOa}else{if(!T.view.ze){this.ld.Zb(F.a.zf,{["Reason"]:K.a.QFb});
this.E8.fail("Not in interactive view",!0);this.ar=8;this.finish();return}this.Ef=T.view;if(!this.Ef.Cb){this.ld.Zb(F.a.zf,{["Reason"]:K.a.noSelection});this.E8.fail("No selection manager",!0);this.ar=8;this.finish();return}this.VO=3===this.Ef.mEb;this.pz=0;this.JK=X;this.d$a=ha.jOa;if(ab&&!(this.d$a&&this.d$a.kb&&this.d$a.length)){this.ld.Zb(F.a.zf,{["Reason"]:K.a.noSelection});this.E8.fail("No selection when one required",!0);this.ar=8;this.finish();return}}ha=H.SelectionEditor.Qm(this.d$a.kb);
ha=!(this.JK&16&&ha);ha=va.K$l(X,this.Rg)&&ha;1!==this.behavior&&ha||(ha||this.E8.fail("Clipboard operation disabled for selection",!0),this.ar=ha?32:8,this.Una());!this.YGg&&this.te.ki&&(a.b("IPadCCP"),this.YGg=!0)}get Rg(){this.sGe||(this.sGe=I.a.xYb(this.d$a));return this.sGe}Paa(){super.Paa();this.d$a=null}run(){this.pz||this.setup();1===this.pz&&this.process();2===this.pz&&this.teardownSync();3===this.pz&&this.teardownAsync();4===this.pz&&this.finish()}setup(){if(this.JK&256&&this.Bkc){this.fF||
this.vOb.Wuk(this,this.JK,this.anb);this.fF.run();if(this.fF.inProgress)return;this.cS=this.fF.Vfa;this.Qud();if(!this.cS){this.E8.fail("No access to system clipboard",!0);this.ar=8;this.pz=4;this.oTd();return}}else n.ULS.sendTraceTag(9037319,307,50,"ClipboardOperation ran into Setup: {0}; {1}; {2}; {3}",this.JK,this.anb,this.te.dF,this.actionId);this.JK&32&&!this.Fe.kOd(this.Ef.Cb.Rg)?(n.ULS.sendTraceTag(6305506,307,50,"Cut not allowed"),this.ld.Zb(F.a.zf,{["Reason"]:K.a.c2e}),this.E8.fail("Cut not allowed",
!0),this.qkc.show(),this.ar=8,this.pz=4):(this.JK&16||this.JK&32)&&B.a.instance.J(3)&&this.GC.iQd(this.Ef.Cb.hb.kb)?(this.E8.fail("Selected content deleted in coauthoring",!0),this.Hd.wKb(),this.ar=8,this.pz=4):(this.JK&4096&&(this.RD.Rbc(Object.assign(new O.a,{ONc:!0,KQ:this.anb})),this.wm.undo()),this.vke.C7m(this.JK),!this.Ef.rd&&l.AFrameworkApplication.K&&l.AFrameworkApplication.K.$("WordEditorPasteFailuresImprovementIsEnabled")?(this.E8.fail("Interactive view has null target node",!0),this.ar=
8,this.pz=4):(this.mB=this.Hc.Rc(15),this.mB.Al=this.actionId,this.mB.Db(this.Ef.rd),this.pz=1))}process(){if(!this.fF){n.ULS.sendTraceTag(9037320,307,50,"ClipboardOperation ran into Process: {0}; {1}; {2}",this.JK,this.anb,this.te.dF);n.ULS.shipAssertTag(6305507,307,!this.Oha);this.Oha=new J.a(this._context,this.JK,this.E8,this.k7,this.yD,void 0,this.te.dF,this.qZj,this.VO);let T;T=this.JK&65536?Object(y.a)(this.iyg,this.iyg.process,"process"):this.JK&64?Object(y.a)(this.kyg,this.kyg.process,"process"):
this.JK&1?Object(y.a)(this.uke,this.uke.process,"process"):Object(y.a)(this.jyg,this.jyg.process,"process");this.JK&16&&this.Ef.Cb.Zva.bKh();this.IIa.create(this,T,this.Oha).ml("ClipboardAction")}n.ULS.shipAssertTag(6305536,307,!!this.fF);this.fF.run();this.fF.inProgress||(this.Qud(),this.pz=this.eh?2:3)}teardownSync(){this.Oha.d7b&&(this.mB.Al=G.a.typing);this.Oha.fOc&&this.mB.NCa(this.Oha.Tmf,this.Oha.EEf);this.mB.dispose();this.ar=this.Oha.failed?8:32;this.pz=4}teardownAsync(){if(this.fF){if(this.fF.run(),
this.fF.inProgress)return}else if(this.Oha.d7b&&(this.mB.Al=G.a.typing),this.mB.jEa(this),this.Oha.fOc&&this.mB.NCa(this.Oha.Tmf,this.Oha.EEf),this.mB.dispose(),this.vNe)return;this.ar=this.Oha.failed?8:32;this.pz=4}finish(){this.RD.Rbc(Object.assign(new O.a,{ONc:!1}));this.Una();32===this.response?n.ULS.sendTraceTag(6305537,307,50,"ClipboardOperation Succeeded after {0} milliseconds: {1}; {2}; {3} ",+this.endTime-+this.startTime,this.JK,this.anb,this.te.dF):n.ULS.sendTraceTag(6305538,307,50,"ClipboardOperation Failed after {0} milliseconds: {1}; {2}; {3}",
+this.endTime-+this.startTime,this.JK,this.anb,this.te.dF);this.Tca.bea(this.E8);P.$gn&&this.ywm()}oTd(){const T=!!(this.JK&1),U=this._context.view;U&&S.a.oTd(T,U.Cb,this.te.dF)}ywm(){if(!(this.JK&4||this.JK&64)){var T=new Map;T.set("isCopy",String.format("{0}",!!(this.JK&16)));T.set("isIPad",String.format("{0}",this.te.ki));e.Health.instance.recordKpiUsage(S.a.Ukh,0,S.a.OVe,T);this.cS||(T=Object.assign(new E.a,{extendedProperties:T}),e.Health.instance.recordKpiFailure(S.a.Ukh,S.a.usk,!0,!0,T))}}static get $gn(){null==
P.hEe&&(P.hEe=!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.$("RecordCcpErrorDialogKpiIsEnabled"));return P.hEe}static kQf(T,U,X,Y){T&&T.Zb(F.a.zf,{["Reason"]:X});U&&U.fail(Y,!0)}static Ljh(T,U,X=null,Y=null,ca=!0){return T.view.ze?T.view.Cb?!ca||U.jOa&&U.jOa.kb&&U.jOa.length?!0:(P.kQf(X,Y,K.a.noSelection,"Paste target is invalid"),!1):(P.kQf(X,Y,K.a.noSelection,"No selection manager"),!1):(P.kQf(X,Y,K.a.QFb,"Not in interactive view"),!1)}}P.hEe=null;Object(C.a)(P,"ClipboardOperation",N.a,
[])},1636:function(C,N,d){d.d(N,"a",function(){return l});C=d(0);var l;(function(e){e[e.paste=1]="paste";e[e.textOnly=2]="textOnly";e[e.overtype=4]="overtype";e[e.copy=16]="copy";e[e.deleteSelection=32]="deleteSelection";e[e.move=64]="move";e[e.useSystemClipboard=256]="useSystemClipboard";e[e.forceInternalClipboard=512]="forceInternalClipboard";e[e.reformatPastedContent=4096]="reformatPastedContent";e[e.pasteAsPlainText=8192]="pasteAsPlainText";e[e.showPlaceholderGlossary=65536]="showPlaceholderGlossary";
e[e.reformatPastedContentWithDesignerPaste=131072]="reformatPastedContentWithDesignerPaste"})(l||(l={}));Object(C.b)("ClipboardActionFlags",l)},1637:function(C,N,d){var l=this&&this.BO||(Object.create?function(a,k,n,v){void 0===v&&(v=n);var u=Object.getOwnPropertyDescriptor(k,n);if(!u||("get"in u?!k.iG:u.writable||u.configurable))u={enumerable:!0,get:function(){return k[n]}};Object.defineProperty(a,v,u)}:function(a,k,n,v){void 0===v&&(v=n);a[v]=k[n]}),e=this&&this.__exportStar||function(a,k){for(var n in a)"default"===
n||Object.prototype.hasOwnProperty.call(k,n)||l(k,a,n)};Object.defineProperty(N,"__esModule",{value:!0});e(d(1783),N);e(d(1784),N);C.exports.IntentIds||Object.defineProperty(C.exports,"IntentIds",{enumerable:!0,get:function(){return C.exports.IntentIds}});C.exports.ObjectSchemaType||Object.defineProperty(C.exports,"ObjectSchemaType",{enumerable:!0,get:function(){return C.exports.ObjectSchemaType}});C.exports.ObjectSemantic||Object.defineProperty(C.exports,"ObjectSemantic",{enumerable:!0,get:function(){return C.exports.ObjectSemantic}});
C.exports.SearchSuggestionAnnotation||Object.defineProperty(C.exports,"SearchSuggestionAnnotation",{enumerable:!0,get:function(){return C.exports.SearchSuggestionAnnotation}});C.exports.SearchSuggestionSignal||Object.defineProperty(C.exports,"SearchSuggestionSignal",{enumerable:!0,get:function(){return C.exports.SearchSuggestionSignal}});C.exports.SequenceType||Object.defineProperty(C.exports,"SequenceType",{enumerable:!0,get:function(){return C.exports.SequenceType}})},1638:function(C,N,d){d.r(N);
d.d(N,"FootnoteEndnoteDefaultContentInserter",function(){return K});C=d(0);var l=d(22),e=d(59),a=d(2),k=d(40),n=d(658),v=d(34),u=d(5),t=d(17),y=d(44),B=d(1171),G=d(864),F=d(1576);class K{constructor(O,H,I,J,L=null){this.Xc=O;this.Eyj=H;this.Ql=I;K.Kh=J;this.Qzg=L||K.FKk}get rK(){return null!=this.oog?this.oog:this.oog=l.a.instance.resolve("Box4.IOutlineEditor")}SIk(O,H){var I=this.Xc.Dk();I.set(O);this.rK.qfb(I,null,!0);K.Kh.OJb(I.currentNode,this.Ql);O=k.OutlineElementNavigator.De(I);K.H7.w7d(H?
Box4Intl.Box4Strings.L_StyleWordFootnoteText:Box4Intl.Box4Strings.L_StyleWordEndnoteText,O);I=this.Qzg(I.currentNode);K.characterPropertiesEditor.replaceTextRange(I,K.Kxh);this.W5l(O,H)}W5l(O,H){var I=this.Eyj(131073);I.setValue(u.a.Eq,1===H?36:35);I.setValue(u.a.Tja,!0);I.setValue(t.a.K7,!0);const J=O.Lc.Ku(I,e.a.create());I=this.Qzg(O);K.characterPropertiesEditor.Uea(I,L=>G.a.getInstance(L,J,!0),F.a.yNh(O,H))}static Gl(){return new K(new n.a,Object(y.a)(B.a.instance,B.a.instance.createInstance,
"createInstance"),a.AFrameworkApplication.isRtl,l.a.instance.resolve("Box4.IOutlineElementEditor"))}static get H7(){return null!=K.yqg?K.yqg:K.yqg=l.a.instance.resolve("Box4.Styles.IWACStyleEditor")}static get characterPropertiesEditor(){return null!=K.fhg?K.fhg:K.fhg=l.a.instance.resolve("Box4.ICharacterPropertiesEditor")}static get instance(){return null!=K.Vmg?K.Vmg:K.Vmg=K.Gl()}static FKk(O){return v.a.Uc(O,0)}}K.Kxh=" ";K.Kh=null;Object(C.a)(K,"FootnoteEndnoteDefaultContentInserter",null,[454])},
1639:function(C,N,d){d.d(N,"a",function(){return n});C=d(0);var l=d(658),e=d(550),a=d(1517),k=d(1576);class n{constructor(v,u){this.Hpa=u}gJd(v,u,t){return(v=this.Hpa.KUh(v.node,t?v.cpBegin:v.cpEnd,u))?v.h2():null}a2h(v,u){return(v=this.Hpa.OEl(v.node,v.cpBegin,u))?v.h2():null}static iIc(){return new n(e.a.instance,a.a.instance,new l.a,k.a.instance)}static get instance(){return null!=n.tmg?n.tmg:n.tmg=n.iIc()}}Object(C.a)(n,"FootnoteEndnoteNavigator",null,[449])},1649:function(C,N,d){d.d(N,"a",function(){return n});
C=d(0);var l=d(1700),e=d(2),a=d(41),k=d(22);class n{constructor(v,u,t,y,B,G){this.kqa=v;this.lqa=u;this.gse=t;this.eY=y;this.N9c=B;this.NNb=G}get G4i(){return!this.lqa&&!this.gse}get cvi(){return 2===this.NNb?CommonUIStrings.l_OICErrorC2ROneNoteOffer:CommonUIStrings.l_OICErrorC2ROffer}get id(){return"OICErrorDialogWithTrial"}get QEh(){return CommonUIStrings.l_OICErrorMessageNoOffice}get r6h(){return CommonUIStrings.l_OICErrorIHaveOfficeButton}get Jeb(){return CommonUIStrings.l_OICErrorHelpLink}get R4h(){return"OICFailure"}get icon(){return 3}get Xpd(){return 2===
this.NNb?CommonUIStrings.l_OICErrorC2RInstallOneNoteButton:CommonUIStrings.l_OICErrorC2RInstallButton}get sKa(){return CommonUIStrings.l_DefaultDialogTitle}Ofn(v){this.mvi(v)}hrm(v){this.mvi(v)}mvi(v){let u=10;1===v?(k.a.instance.resolve("Common.IOfficeTrialExperience").Uvf(this.NNb),u=3):2===v&&((!this.gse||this.gse(this.eY))&&this.lqa&&l.a.instance.QLk(this.lqa,this.kqa,this.eY),u=5);(0===v||1===v)&&this.kqa&&this.kqa(this.eY);e.AFrameworkApplication.wYc(a.a.yBi,this.N9c,u);this.dispose()}dispose(){this.eY=
this.lqa=this.kqa=null}}Object(C.a)(n,"AOICErrorDialogWithTrial",null,[9])},1698:function(C,N,d){C=d(0);var l=d(2),e=d(15),a=d(22),k=d(594),n=d(1513),v=d(1393),u=d(31);class t{constructor(pa,Ra=null){this.jNj=pa;this.OV=Ra||n.a.lef(e.a.$vb,"")}get $x(){return this.jNj}get Jc(){return this.OV}pYf(pa){this.Jc.d++;return this.$x.pYf(pa)}kec(pa){this.Jc.e++;return this.$x.kec(pa)}UF(pa){this.Jc.f++;return this.$x.UF(pa)}okb(pa){this.Jc.h++;return this.$x.okb(pa)}w3(pa){this.Jc.i++;return this.$x.w3(pa)}x7(pa){this.Jc.j++;
return this.$x.x7(pa)}Yna(pa){this.Jc.k++;return this.$x.Yna(pa)}cba(pa){this.Jc.l++;return this.$x.cba(pa)}F6d(pa){this.Jc.m++;return this.$x.F6d(pa)}E2a(pa,Ra=!1){this.Jc.n++;return this.$x.E2a(pa,Ra)}Tjf(){this.Jc.o++;return this.$x.Tjf()}h1f(){this.Jc.p++;return this.$x.h1f()}Ls(pa){this.Jc.q++;return this.$x.Ls(pa)}Fva(pa){this.Jc.r++;return this.$x.Fva(pa)}Zdc(pa){this.Jc.g++;return this.$x.Zdc(pa)}M_c(pa){return this.$x.M_c(pa)}qkb(pa){this.Jc.s++;return this.$x.qkb(pa)}k7d(pa){this.Jc.s++;
return this.$x.k7d(pa)}T0e(pa){this.Jc.ba++;return this.$x.T0e(pa)}p6d(pa){this.Jc.s++;return this.$x.p6d(pa)}pkb(pa){this.Jc.s++;return this.$x.pkb(pa)}UJb(pa){this.Jc.t++;return this.$x.UJb(pa)}C7d(pa){this.Jc.u++;return this.$x.C7d(pa)}Lga(pa){this.Jc.v++;return this.$x.Lga(pa)}gZf(pa){this.Jc.bb++;return this.$x.gZf(pa)}oEa(pa){return this.$x.oEa(pa)}p7(pa){this.Jc.z++;return this.$x.p7(pa)}fUf(){return this.$x.fUf()}Mga(pa,Ra){this.Jc.w++;this.Jc.x++;return this.$x.Mga(pa,Ra)}hC(pa){this.Jc.y++;
return this.$x.hC(pa)}clearFormatting(){return this.$x.clearFormatting()}clone(){return new t(this.$x.clone(),this.Jc)}}Object(C.a)(t,"FormattingStewardUsageCollector",null,[222]);class y extends t{constructor(pa,Ra=null){super(pa,Ra)}get R6(){return this.$x}get Zs(){return this.R6.Zs}set Zs(pa){this.R6.Zs=pa}get textIndent(){return this.R6.textIndent}get marginLeft(){return this.R6.marginLeft}get Mfc(){return this.R6.Mfc}get uDa(){return this.R6.uDa}get lineSpacing(){return this.R6.lineSpacing}get ZI(){return this.R6.ZI}get leftIndent(){return this.R6.leftIndent}get Iaa(){return this.R6.Iaa}get paragraph(){return this.R6.paragraph}set paragraph(pa){this.R6.paragraph=
pa}get QP(){return this.R6.QP}get Sfc(){return this.R6.Sfc}Hbe(pa){return this.R6.Hbe(pa)}I6f(pa){return this.R6.I6f(pa)}clone(){const pa=this.$x.clone();return new y(pa,this.Jc)}}Object(C.a)(y,"FormattingStewardUsageCollector",t,[625,222]);var B=d(11),G=d(64),F=d(312),K=d(853),O=d(40),H=d(211),I=d(92),J=d(43),L=d(59),S=d(374),E=d(146),P=d(16),T=d(83),U=d(58),X=d(17),Y=d(5),ca=d(45),da=d(161),ua=d(524),ra=d(375),qa=d(20),ka=d(118),la=d(48),Ha=d(61),wa=d(194),Ca=d(1569),Ja=d(173),bb=d(34),ha=d(1317),
ia=d(685);class va{constructor(pa,Ra,Sa,ab,eb,zb,Ua,Ab,mb,Rb,hc=null){this.FD=this._paragraph=null;this.did=0;this.Bxg=this.eid=null;this.A8=0;this.isb=this.Sfc=this.leftIndent=this.ZI=this.Qqc=this.uDa=this._tabStops=this._marginLeft=this._textIndent=null;this.paragraph=pa;this.mg=Ra;this.iS=Sa;this.BC=ab;this.vx=eb;this.EQb=zb;this.nia=Ua;this.kPb=Ab;this.dSa=mb;this.rpb=Rb;hc?(u.a(4223818,307,!!hc.FD),this.FD=hc.FD.Kra(this.paragraph),this.did=hc.Cac,this.eid=hc.uKf,hc.uDa&&(this.uDa=new ha.a,
this.uDa.afterSpacing.value=hc.uDa.afterSpacing.value,this.uDa.beforeSpacing.value=hc.uDa.beforeSpacing.value),hc.lineSpacing&&(this.Qqc=hc.lineSpacing.clone()),this.A8=hc.A8,this.Sfc=hc.Sfc.clone(),this._textIndent=hc.textIndent,this._marginLeft=hc.marginLeft,this._tabStops=hc.Mfc,this.ZI=hc.ZI,this.leftIndent=hc.leftIndent,hc.Iaa&&(this.isb=hc.Iaa)):(this.FD=new wa.a(this.paragraph,0),this.FD.formatting=new Ja.a(this.FD,L.a.nil),Ra=bb.a.ow(pa),Ra=this.vx.Pr(Ra),this.SIn(Ra),this.XVn(pa)?(this.EQb.nKn(this.FD.formatting,
Ra),pa.hasProperty(X.a.Zh)?this.A8=pa.getValue(X.a.Zh):this.A8=0):this.A8=-1,this.did=0,this.uDa=this.eid=null,this.rpb&&(this.uDa=this.EQb.fBa(pa),this.Qqc=this.EQb.ALa(pa),this.ZI=this.EQb.J3b(pa),this.leftIndent=this.EQb.mT(pa)),this.Sfc=new S.DictionaryPropertySet)}get paragraph(){return this._paragraph}set paragraph(pa){u.a(4223816,307,!!pa&&B.ParagraphReader.nc(pa));this._paragraph=pa}get QP(){return this.FD.formatting}get Cac(){return this.did}get uKf(){return this.eid}get tB(){return this.Bxg}get Zs(){return this.A8}set Zs(pa){u.a(4223817,
307,1===pa||2===pa||3===pa||6===pa);this.A8=pa}get textIndent(){return this._textIndent}get marginLeft(){return this._marginLeft}get Mfc(){return this._tabStops}get lineSpacing(){return this.Qqc}get Iaa(){return this.isb}get oc(){return this.BC}SIn(pa){const Ra=this.vx.language(pa);Ra&&this.mg.qYf(this.FD.formatting,Ra,0,pa.cache.nDb,!1)}XVn(pa){if(!qa.a.instance.J(10))return!0;pa=this.oc.rf(this.oc.yo(pa));return pa===la.StyleReader.Z4c||pa===la.StyleReader.wordStyleIdNormal||pa===la.StyleReader.Hmb||
pa===la.StyleReader.styleIdNormal}pYf(pa){(pa=k.a.pg(pa))&&this.mg.U6d(this.FD.formatting,pa.LCID);return!0}kec(){return!1}UF(pa){this.mg.UF(this.FD.formatting,pa);return!0}okb(pa){this.mg.setItalic(this.FD.formatting,pa);return!0}w3(pa){this.mg.w3(this.FD.formatting,pa);return!0}x7(pa){this.mg.x7(this.FD.formatting,pa);return!0}Yna(pa){this.mg.Yna(this.FD.formatting,pa);return!0}cba(pa){this.mg.cba(this.FD.formatting,pa);return!0}F6d(pa){if(0>=pa)return!1;this.mg.Sv(this.FD.formatting,pa);return!0}E2a(pa,
Ra){if(!pa||""===pa)return!1;if(({CJh:Sa}=E.FontUtils.rej(pa)).returnValue)return this.mg.p_(this.FD.formatting,Sa.fontName),!0;var Sa=!1;const ab=E.FontUtils.LNa(pa);Ra&&this.ygb(ab,this.nia)&&(this.nia.Pda(pa),Sa=!0);if(this.ygb(ab,this.kPb)||this.ygb(ab,this.dSa))Sa=!0;Sa&&this.mg.p_(this.FD.formatting,ab);return Sa}ygb(pa,Ra){return!!Ra&&Ra.isEnabled&&Ra.ygb(pa)}Tjf(){this.mg.y2h(this.FD.formatting);return!0}h1f(){this.mg.G5i(this.FD.formatting);return!0}Ls(pa){var {Box4PasteSteward:Ra}=d(1490);
if(null===pa||""===pa)return!1;pa=Ra.exb(pa);Ra=null;this.Iaa&&this.Iaa.hasOwnProperty(Y.a.listLevel.id.toString())&&(Ra=this.Iaa[Y.a.listLevel.id.toString()]);this.mg.Ls(this.FD.formatting,pa,Ra);return!0}Fva(pa){const {Box4PasteSteward:Ra}=d(1490);if(!pa||""===pa||!va.wQl().contains(pa))return!1;this.mg.Fva(this.FD.formatting,Ra.exb(pa));return!0}Zdc(pa){this.mg.Zdc(this.FD.formatting,pa);return!0}M_c(pa){let Ra=0;switch(P.a.mh(pa)){case "small-caps":Ra=1;break;case "uppercase":Ra=2}this.mg.$l(this.FD.formatting,
ca.a.capitalization,Ra);return!0}p7(pa){const {Box4PasteSteward:Ra}=d(1490);if(!pa||""===pa)return!1;this.Sfc.setValue(X.a.ZH,parseInt(Ra.exb(pa),16));return!0}pkb(pa){return 0>=pa?!1:this.k7d(this.oc.IZh(pa))}qkb(pa){this.clearFormatting();this.did=pa;return!0}T0e(pa){var {Box4PasteSteward:Ra}=d(1490),Sa=new Map;Sa.set("Source","CreateStyleCCP_FormattingSteward");T.Health.instance.recordKpiUsage(ka.a.Xlj,0,ka.a.EB,Sa);Sa=Ha.a.nKl(pa);pa=[];pa.push(Sa);(pa=Ha.a.SNe(pa,this.paragraph))?(Ra.Ffc=this.oc.Kp(),
u.b(593078085,3017,50,"Custom style created via paste.")):(Ra=new Map,Ra.set("Source","CreateStyleCCP_FormattingSteward"),Ra.set("IsStyleNull",(!Sa).toString()),Ra=Object.assign(new da.a,{extendedProperties:Ra}),T.Health.instance.recordKpiFailure(ka.a.Xlj,"UnableToCreateStyle",!1,!0,Ra));return pa}k7d(pa){const {Box4PasteSteward:Ra}=d(1490);return pa&&0<pa.length&&Ra.Ffc&&Ra.Ffc.xh(pa)?(this.eid=pa,!0):!1}p6d(pa){const {Box4PasteSteward:Ra}=d(1490);return pa&&0<pa.length&&Ra.Ffc&&Ra.Ffc.xh(pa)?(this.Bxg=
pa,!0):!1}I6f(pa){if(this.tB){pa=this.oc.Qx(pa);if(!pa)return u.a(41968715,307,!1),!1;(pa=pa.xh(this.tB))&&this.mg.Ckb(this.FD.formatting,pa);return!0}return!1}Mga(){return!1}hC(pa){if(!pa)return!1;const Ra=parseFloat(P.a.substring(pa,0,P.a.mh(pa).indexOf("px")));if(!isNaN(Ra))return this.Qqc=new ia.a(3,U.a.Wy(Ra,1)),!0;pa=parseFloat(P.a.substring(pa,0,P.a.mh(pa).indexOf("%")));return isNaN(pa)?!1:(this.Qqc=new ia.a(2,pa/100),!0)}UJb(pa){let Ra=0;if(!pa||""===pa)return!1;switch(pa){case "left":Ra=
1;break;case "center":Ra=2;break;case "right":Ra=3;break;case "justify":Ra=6}if(!Ra)return!1;this.Zs=Ra;return!0}C7d(pa){this._textIndent=pa;return!0}Lga(pa){this._marginLeft=pa;return!0}gZf(pa){this._tabStops=pa;return!0}oEa(pa){this.isb=JSON.parse(pa);return this.Iaa?!0:!1}clearFormatting(){this.FD.formatting=new Ja.a(this.FD,L.a.nil);return!0}fUf(){this.A8=0;return!0}Hbe(pa){var {Box4PasteSteward:Ra}=d(1490);if(!qa.a.instance.J(10))return!1;if(0<this.Cac&&Ra.n1a[this.Cac]){u.a(4223819,307,1<=this.Cac);
u.a(4223820,307,7>=this.Cac);Ra=this.oc.Qx(pa);if(!Ra)return u.a(4223821,307,!1),!1;Ra=Ra.xh(d(1490).Box4PasteSteward.n1a[this.Cac]);this.iS.oM(Ra,pa,!1);return!0}if(this.uKf){Ra=this.oc.Qx(pa);if(!Ra)return u.a(41968716,307,!1),!1;Ra=Ra.xh(this.uKf);this.iS.oM(Ra,pa,!1);return!0}return!1}clone(){return new va(this.paragraph,this.mg,this.iS,this.BC,this.vx,this.EQb,this.nia,this.kPb,this.dSa,this.rpb,this)}static wQl(){va.WY||(va.WY=new ua.a(ra.a.Rj()),va.WY.add(Ca.a.yellow),va.WY.add(Ca.a.Xki),va.WY.add(Ca.a.Bdh),
va.WY.add(Ca.a.EKh),va.WY.add(Ca.a.blue),va.WY.add(Ca.a.red),va.WY.add(Ca.a.bti),va.WY.add(Ca.a.teal),va.WY.add(Ca.a.green),va.WY.add(Ca.a.purple),va.WY.add(Ca.a.Ppi),va.WY.add(Ca.a.wvi),va.WY.add(Ca.a.gray),va.WY.add(Ca.a.p6i),va.WY.add(Ca.a.black));return va.WY}}va.WY=null;Object(C.a)(va,"FormattingSteward",null,[625,222]);class Ka{R6f(){return!1}kkf(pa){return pa}pkf(){}oEa(){}$6d(){}HOd(){return!1}get JPd(){return!1}hC(){}Mga(){}t7d(){}get P3i(){return!1}}Object(C.a)(Ka,"NoOpPasteStewardBridge",
null,[334]);var Xa=d(76);class xa{constructor(pa,Ra){this.sMm=pa;this.tMm=Ra||"Normal"}}Object(C.a)(xa,"NoteTagInfoBox4",null,[]);const Ma=pa=>{const Ra=new Xa.a;for(const Sa of pa)pa=new xa(Sa.sMm,Sa.tMm),Ra.add(pa);return Ra};d.d(N,"a",function(){return Na});class Na{constructor(pa,Ra,Sa=null,ab=null){this.vcl=l.AFrameworkApplication.K.$("FollowDestinationFormattingPasteIsEnabled");this.EVg=0;this.Bc=pa;this.N4=Ra;this.j0=ab||new Ka;this.Jc=Sa||n.a.lef(e.a.$vb,"")}get characterPropertiesEditor(){return null!=
this.Xgg?this.Xgg:this.Xgg=a.a.instance.resolve("Box4.ICharacterPropertiesEditor")}get fontService(){return null!=this.Xjg?this.Xjg:this.Xjg=a.a.instance.Pa("Box4.IFontService")}get dAa(){return null!=this.Zhg?this.Zhg:this.Zhg=a.a.instance.Pa("Box4.CustomFontService")}get X0k(){return null!=this.Cig?this.Cig:this.Cig=a.a.instance.Pa("Box4.IEmbeddedFontService")}reset(){}get yDc(){return this.idf(!1)}idf(pa){u.a(4223770,307,J.OutlineElementReader.Nh(this.Bc));const Ra=O.OutlineElementNavigator.De(this.Bc);
O.OutlineElementNavigator.Zd(this.Bc);u.a(4223771,307,!!Ra&&B.ParagraphReader.nc(Ra));pa=new va(Ra,Na.vi,Na.eR,Na.oc,Na.U1b,Na.Tdl,this.fontService,this.dAa,this.X0k,this.vcl,void 0,pa);return new y(pa,this.Jc)}Baa(){}aDa(){}tib(){}Gua(){}XCa(){}PNa(){}ONa(){}MF(){}LF(){}qib(){}pib(){}UNa(){}Y0a(){}dDa(){}bDa(){}TNa(){}cDa(){}a1a(){}S9b(pa){J.OutlineElementReader.Nh(this.Bc)?(Na.Wg.xta(this.Bc,!0),O.OutlineElementNavigator.Vr(this.Bc,!1,!1)):I.OutlineReader.xw(this.Bc)?H.OutlineNavigator.P6(this.Bc)?
pa?(this.Bc.Eg(),Na.rK.r5(this.Bc,!1)):Na.Wg.sIb(this.Bc):Na.rK.r5(this.Bc,!1):u.a(8128524,307,!1,"Unexpected node type {0} encountered",this.Bc.Qe)}PIc(pa){let Ra=null;if(pa&&pa.Z6&&pa.cultureName)try{Ra=Object.assign(new K.a,{languageId:k.a.pg(pa.cultureName).LCID})}catch(Sa){u.a(8128526,307,!1,"Setting up culture {0} encountered {1}",pa.cultureName,Sa)}Ra||null==this.N4||(Ra=Object.assign(new K.a,{languageId:this.N4}));return Ra}get iU(){return this.EVg}set iU(pa){this.EVg=pa}dsd(){}sbe(){}WWe(){}get SZb(){return!1}get Qxb(){return!1}Krm(pa){let Ra=
1;if(pa.pei){var Sa=0;switch(pa.listStyleType){case 1:Ra=0;break;case 7:Ra=1;break;case 8:Ra=2;break;case 9:Ra=3;break;case 10:Ra=4;break;case 11:Ra=5}}else switch(Sa=1,pa.listStyleType){case 1:Ra=0;break;case 3:Ra=1;break;case 4:Ra=2;break;case 5:Ra=3}let ab;Sa=(ab=G.ListReader.sZ)?F.a.HP(Sa,Ra,Ma(pa.bna),pa.listId,pa.listLevel,pa.levelText,pa.font):F.a.HP(Sa,Ra,Ma(pa.bna));3!==pa.vr&&(Sa.O3=pa.vr);pa.pei&&!pa.pai&&(Sa.Tz=ab&&0<pa.listId&&0<=pa.listLevel&&!pa.Jac?pa.qfc:pa.APk);!Sa.sr||3!==Sa.listStyle&&
5!==Sa.listStyle||(Sa.Zs="right");v.a.pOc&&((pa=pa.Fwf)&&Sa.propertySet.Cs(pa),Sa.X1b=!0);this.j0.$6d(this.Bc);return Sa}Aaa(){}xaa(){}zaa(){}yaa(){}waa(){}vaa(){}static get Wg(){return null!=Na.Fog?Na.Fog:Na.Fog=a.a.instance.resolve("Box4.IOutlineElementEditor")}static get rK(){return null!=Na.uog?Na.uog:Na.uog=a.a.instance.resolve("Box4.IOutlineEditor")}static get vi(){return null!=Na.zkg?Na.zkg:Na.zkg=a.a.instance.resolve("Box4.IFormattingEditor")}static get eR(){return null!=Na.Nsg?Na.Nsg:Na.Nsg=
a.a.instance.resolve("Box4.Styles.IWACStyleEditor")}static get oc(){return null!=Na.stg?Na.stg:Na.stg=a.a.instance.resolve("Box4.Styles.IWACStyleReader")}static get U1b(){return null!=Na.Bkg?Na.Bkg:Na.Bkg=a.a.instance.resolve("Box4.IFormattingReader")}static get Tdl(){return null!=Na.Ckg?Na.Ckg:Na.Ckg=a.a.instance.resolve("Box4.Actors.IFormattingStewardBridge")}}Na.Cf=null;Object(C.a)(Na,"Box4PasteStewardBase",null,[612,204,205])},1700:function(C,N,d){C=d(0);var l=d(44),e=d(8),a=d(2),k=d(41),n=d(356),
v=d(22);class u{constructor(J,L,S,E){this.Bye=null;this.N9c=E;this.kqa=J;this.lqa=L;this.eY=S;this.l0g=this.hFb.PTn;J=CommonUIStrings.l_OICErrorMacOfficeOffer.split("{0}");this.ULj=J[0];this.TLj=J[1]}get hFb(){return this.Bye||(this.Bye=v.a.instance.resolve("Common.IMacOfficeOffer"))}get id(){return"OICErrorDialog"}get errorMessage(){return CommonUIStrings.l_OICErrorMessage}get Jeb(){return CommonUIStrings.l_OICErrorHelpLink}get m0c(){return this.l0g}get npi(){return this.ULj}get mpi(){return this.TLj}get lpi(){return CommonUIStrings.l_OICErrorMacOFficeLink}get icon(){return this.l0g?
3:2}get wFc(){return CommonUIStrings.l_OICErrorFileDownloadOffer}get rwd(){return!!this.lqa}get xFc(){return CommonUIStrings.l_OICErrorNoOfficeDownloadButton}get sKa(){return CommonUIStrings.l_DefaultDialogTitle}UPf(J){this.cTc(J)}uwf(J){this.cTc(J)}cTc(J){let L=10;this.lqa&&1===J&&(this.lqa(this.eY),L=1);this.kqa&&this.kqa(this.eY);this.SQ(L)}YFb(){n.Redirect.showHelp("OICFailure");this.SQ(2)}QEf(){this.hFb.wki();this.SQ(4)}SQ(J){e.ULS.sendTraceTag(18715410,211,10,"Report OICErrorDialog. Dialog cause: {0}, solution: {1}",
this.N9c,J);a.AFrameworkApplication.wYc(k.a.wBi,this.N9c,J)}dispose(){this.eY=this.kqa=this.lqa=null}}Object(C.a)(u,"AOICErrorDialog",null,[9]);var t=d(29),y=d(142);class B extends u{constructor(J,L,S,E){super(J,L,S,E);this.q8a=this.ME=null;J=document.createElement("span");J.id="errorMessageText";J.innerText=this.errorMessage;J.appendChild(document.createElement("br"));J.appendChild(document.createElement("br"));this.ME=document.createElement("a");this.ME.href="#";this.ME.innerText=this.Jeb;J.appendChild(this.ME);
t.a.addHandler(this.ME,"click",Object(l.a)(this,this.YFb,"oicErrorHelpLinkHandler"));L=new y.StandardDialog;L.kg=this.id;this.m0c?(S=document.createElement("span"),E=document.createElement("span"),S.innerText=this.npi,E.innerText=this.mpi,this.q8a=document.createElement("a"),this.q8a.href="#",this.q8a.innerText=this.lpi,J.appendChild(document.createElement("br")),J.appendChild(S),J.appendChild(this.q8a),J.appendChild(E),t.a.addHandler(this.q8a,"click",Object(l.a)(this,this.QEf,"oicErrorMacOfferLinkHandler"))):
this.rwd&&(J.appendChild(document.createElement("br")),J.appendChild(document.createElement("br")),S=document.createElement("span"),S.innerText=this.wFc,J.appendChild(S));this.rwd?(L.Fd=1,L.Ve(1,this.xFc)):L.Fd=0;L.Pv(this.sKa,null,this.icon,Object(l.a)(this,this.uwf,"legacyOICErrorDialogHandler"),J);L.u3("errorMessageText")}dispose(){this.ME&&(t.a.removeHandler(this.ME,"click",Object(l.a)(this,this.YFb,"oicErrorHelpLinkHandler")),this.ME=null);this.q8a&&(t.a.removeHandler(this.q8a,"click",Object(l.a)(this,
this.QEf,"oicErrorMacOfferLinkHandler")),this.q8a=null);super.dispose()}}Object(C.a)(B,"OICErrorDialog",u,[]);class G{constructor(J,L,S){this.kqa=L;this.lqa=J;this.eY=S}get id(){return"OICErrorDialogWithDownload"}get REh(){return CommonUIStrings.l_OICErrorNoOfficeDetected}get Jeb(){return CommonUIStrings.l_OICErrorHelpLink}get wFc(){return CommonUIStrings.l_OICErrorFileDownloadOffer}get xFc(){return CommonUIStrings.l_OICErrorNoOfficeDownloadButton}get icon(){return 2}get sKa(){return CommonUIStrings.l_DefaultDialogTitle}UPf(J){this.cTc(J)}uwf(J){this.cTc(J)}cTc(J){let L=
10;1===J&&(this.lqa(this.eY),L=1);this.kqa&&this.kqa(this.eY);this.SQ(L)}YFb(){n.Redirect.showHelp("OICFailure");this.SQ(2)}SQ(J){a.AFrameworkApplication.wYc(k.a.xBi,3,J)}dispose(){this.eY=this.lqa=this.kqa=null}}Object(C.a)(G,"AOICErrorDialogWithDownload",null,[9]);class F extends G{constructor(J,L,S){super(J,L,S);this.ME=null;J=document.createElement("span");J.id="errorMessageText";J.innerText=this.REh;J.appendChild(document.createElement("br"));J.appendChild(document.createElement("br"));this.ME=
document.createElement("a");this.ME.href="#";this.ME.innerText=this.Jeb;J.appendChild(this.ME);t.a.addHandler(this.ME,"click",Object(l.a)(this,this.YFb,"oicErrorHelpLinkHandler"));J.appendChild(document.createElement("br"));J.appendChild(document.createElement("br"));L=document.createElement("span");L.innerText=this.wFc;J.appendChild(L);L=new y.StandardDialog;L.kg=this.id;L.Fd=1;L.Ve(1,this.xFc);L.Pv(this.sKa,null,this.icon,Object(l.a)(this,this.uwf,"legacyOICErrorDialogHandler"),J);L.u3("errorMessageText")}dispose(){this.ME&&
(t.a.removeHandler(this.ME,"click",Object(l.a)(this,this.YFb,"oicErrorHelpLinkHandler")),this.ME=null);super.dispose()}}Object(C.a)(F,"OICErrorDialogWithDownload",G,[]);var K=d(153);class O extends u{constructor(J,L,S,E){super(J,L,S,E);L={["errorMessage"]:this.errorMessage};L.helpLink={["type"]:"AppLinkProps",["id"]:"helpLink",["text"]:this.Jeb,["onExecute"]:P=>{this.YFb(P)}};this.m0c?(L.macOfficePreLinkText=this.npi,L.macOfficeLink={["type"]:"AppLinkProps",["id"]:"macOfficeLink",["text"]:this.lpi,
["onExecute"]:P=>{this.QEf(P)}},L.macOfficePostText=this.mpi):this.rwd&&(L.errorFileDownloadOffer=this.wFc);J=new K.a(!1,!1,!0);this.rwd?(J.Fd=1,J.Ve(1,this.xFc)):J.Fd=0;J.kg=this.id;L={["id"]:this.id,["dialogIcon"]:this.icon,["bodyControls"]:L};J.Wh(this.sKa,Object(l.a)(this,this.UPf,"reactOICErrorDialogHandler"),L)}}Object(C.a)(O,"ReactOICErrorDialog",u,[]);class H extends G{constructor(J,L,S){super(J,L,S);L={["errorMessage"]:this.REh,["errorFileDownloadOffer"]:this.wFc};L.helpLink={["type"]:"AppLinkProps",
["id"]:"helpLink",["text"]:this.Jeb,["onExecute"]:E=>{this.YFb(E)}};J=new K.a(!1,!1,!0);J.Fd=1;J.Ve(1,this.xFc);J.kg=this.id;L={["id"]:this.id,["dialogIcon"]:this.icon,["bodyControls"]:L};J.Wh(this.sKa,Object(l.a)(this,this.UPf,"reactOICErrorDialogHandler"),L)}}Object(C.a)(H,"ReactOICErrorDialogWithDownload",G,[]);d.d(N,"a",function(){return I});class I{constructor(){this.bqa=!!a.AFrameworkApplication.ua&&a.AFrameworkApplication.ua.Sb.KA}PLk(J,L,S){this.bqa?new O(J,L,null,S):new B(J,L,null,S)}QLk(J,
L,S){this.bqa?new H(J,L,S):new F(J,L,S)}RLk(J,L,S,E,P){const {ReactOICErrorDialogWithTrial:T}=d(1799),{OICErrorDialogWithTrial:U}=d(1800);this.bqa?new T(J,L,S,null,E,P):new U(J,L,S,null,E,P)}static get instance(){return I._instance||(I._instance=new I)}}I._instance=null;Object(C.a)(I,"OICErrorDialogFactory",null,[987])},1701:function(C,N,d){d.r(N);C=d(0);var l=d(333),e=d(1781),a=d(932),k=d(374),n=d(2),v=d(59),u=d(22),t=d(104),y=d(84),B=d(68),G=d(1424),F=d(125),K=d(37),O=d(15),H=d(275),I=d(106),J=
d(8),L=d(244),S=d(120),E=d(72),P=d(321),T=d(14),U=d(34),X=d(3),Y=d(9),ca=d(128),da=d(549),ua=d(53),ra=d(1635),qa=d(1634),ka=d(643),la=d(239);class Ha extends la.a{constructor(xa,Ma,Na,pa,Ra,Sa){super();this.init(xa);this.ml("DummyClipboardOperation");this.lfb(n.AFrameworkApplication.ya,Ma,pa,Ra,Sa);this._context=Na;this.ar=8;this.Una()}run(){this.J7a=!0;this.c_c(this._context);this.C1a();this.ar=32}}Object(C.a)(Ha,"DummyClipboardOperation",la.a,[]);la=d(1543);class wa extends la.a{constructor(xa,
Ma,Na,pa,Ra){super(xa,Ma,Ra);this.Yj=Na;this.aHe=pa}bhc(xa){let Ma;if(this.iP&&!xa)return J.ULS.sendTraceTag(594408836,307,10,"No htmlDomContent and htmlClipboardDataContent"),{returnValue:!1,osa:null};Ma=null;if(this.aHe&&!this.iP){const Na=this.properties.ia(I.a.ZDi,"");Na&&(Ma=this.Yj.Oib(Na))}Ma||(Ma=this.Yj.Oib(xa));return{returnValue:!0,osa:Ma}}}Object(C.a)(wa,"HtmlStringImportStrategy",la.a,[]);var Ca=d(1782);class Ja extends Ca.a{constructor(xa,Ma,Na,pa,Ra){super(xa,Ma,Na,pa,Ra)}tWh(){return this.properties.ia(I.a.Oac,
"")}bhc(xa){n.AFrameworkApplication.Hl("Microsoft.Office.Web.SessionSettings.IWacWordUseClipboardDataHelperInMultiLineImportSettings");if(this.B0g){if(this.Yj)return xa=this.Yj.GKf(xa,!0),{returnValue:!0,osa:xa};J.ULS.sendTraceTag(592269660,307,10,"_clipboardDataHelper should not be null")}return super.bhc(xa)}OQc(xa){xa=super.OQc(xa);return xa.length&&" "!==xa?xa:"\u00a0"}}Object(C.a)(Ja,"MultiLinePlainTextImportStrategy",Ca.a,[]);class bb extends la.a{constructor(xa,Ma,Na){super(xa,Ma,Na)}bhc(xa){({ClipboardActor:Ma}=
d(1701));if(this.iP&&!xa)return J.ULS.sendTraceTag(594408834,307,10,"No htmlDomContent"),{returnValue:!1,osa:null};var Ma=Ma.r3m;Ma.innerText=xa;return{returnValue:!0,osa:Ma}}}Object(C.a)(bb,"PlainTextImportStrategy",la.a,[]);var ha=d(97),ia=d(65);class va{constructor(xa){this.Uta=this.Osf=!1;this.Rca=xa}XFi(){this.Osf||(this.Osf=!0,this.Uta=!1,this.Rca.prepareForPaste(()=>{this.Uta=!0}));return this.Uta}Bdj(){this.Osf=!1;const xa=this.Rca.paste();return xa?xa.hasChildNodes()?{returnValue:!0,Cwd:xa}:
(J.ULS.sendTraceTag(7891019,307,50,"DOM innerText empty."),va.Mc.Zb(ha.a.P_,{["Reason"]:ia.a.g8e}),{returnValue:!1,Cwd:xa}):(J.ULS.sendTraceTag(6305676,307,50,"SystemClipboard didn't paste"),va.Mc.Zb(ha.a.Xyb,{["Reason"]:ia.a.Q3f}),{returnValue:!1,Cwd:xa})}static get Mc(){return F.a.instance}}Object(C.a)(va,"SystemClipboardImportStrategy",null,[593]);var Ka=d(270);d.d(N,"ClipboardActor",function(){return Xa});class Xa{constructor(xa,Ma,Na,pa,Ra,Sa,ab,eb,zb,Ua,Ab,mb,Rb,hc,Hb,Ta,Aa,ma){this.z7c=null;
this.FHa=0;this.sbd=this.gxc=!1;this.Gnb=l.a.On;this.E0c=()=>{const Ga=Array(1);Ga.push("PasteRecoveryFloatie");var Fa=this.bya.wLa();Fa=Object.assign(new e.a,{x:Fa.x,y:Fa.y});this.Zv.showFloatie(Fa,Ga,1);return 32};this.KBb=()=>{this.Zv.KZ&&this.Zv.qw();return 32};this.BIi=(Ga,Fa,ib,ob,fb)=>{if(1===ib)return 32;fb[a.a.On]=!1;return 32};this.q_k=(Ga,Fa,ib,ob,fb,Mb)=>{J.ULS.sendTraceTag(42530335,307,50,"Drag and drop browser content");var Tb=Mb.DataTransfer;Mb=Tb.getData("text/html");Tb=Tb.getData("text/plain");
let rc=!1;const vb=new k.DictionaryPropertySet;0<Mb.length?(J.ULS.sendTraceTag(42530336,307,50,"Drag and drop browser content with HTML"),vb.setValue(I.a.hU,Mb),rc=!0):0<Tb.length&&(J.ULS.sendTraceTag(42530337,307,50,"Drag and drop browser content with plain text"),vb.setValue(I.a.Oac,Tb),rc=!0);if(rc){const Ya=this.kz.J(Fa);return this.fvd.create(Ga,Fa,Ya,new L.a(()=>this.QDc(Ya,vb)),ib,ob,fb,vb)}return null};this.gPf=(Ga,Fa,ib,ob,fb)=>{if(Fa="object"===typeof fb?fb:null)this.TUb?this.PHn(Ga,this.FHa,
Fa):Ga===X.a.J1d?(Ga=this.FHa!==X.a.reformatPastedContent&&this.FHa!==X.a.EOa&&this.FHa!==X.a.jva,Fa[this.Gnb]=this.FHa===X.a.reformatPastedContent||Ga):Ga===X.a.K1d?Fa[this.Gnb]=this.FHa===X.a.EOa:Ga===X.a.cPf&&(Fa[this.Gnb]=this.FHa===X.a.jva);return 32};this.gW=(Ga,Fa,ib,ob,fb,Mb)=>{if(n.AFrameworkApplication.K&&n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.RestrictCopyWithIRMEnabled",!1)){if((n.AFrameworkApplication.protectFile||n.AFrameworkApplication.jO)&&!n.AFrameworkApplication.N0b)return new Ha(Ga,
Fa,ib,ob,fb,Mb)}else if(n.AFrameworkApplication.protectFile)return new Ha(Ga,Fa,ib,ob,fb,Mb);if(Ka.a.gfa(ib)&&Ka.a.UCb())return new Ha(Ga,Fa,ib,ob,fb,Mb);let Tb=this.kz.J(Fa);1!==ob&&Tb&1&&(this.FHa=Fa);if(1!==ob){var rc=Object(S.a)(93,Mb)?Mb:null;Mb?(Tb&1&&(this.z7c=rc),rc=rc?rc.ia(I.a.KQ,0):0,Fa===X.a.paste&&rc===X.a.UVa?Tb=this.kz.J(X.a.C1):Fa===X.a.b7&&rc===X.a.Fab&&(Tb=this.kz.J(X.a.v_d))):!Mb&&Tb&4096&&(Mb=this.z7c,rc=Object(S.a)(93,Mb)?Mb:null)&&(rc=rc.ia(I.a.UUc,v.a.nil),J.ULS.sendTraceTag(575255109,
307,50,"Reformatting operation occurred. CorrelationId: {0}",rc))}return this.fvd.create(Ga,Fa,Tb,new L.a(()=>this.QDc(Tb,Mb)),ib,ob,fb,Mb)};this.y9m=(Ga,Fa,ib,ob,fb)=>this.fVe(Ga,Fa,ib,fb);this.x9m=(Ga,Fa,ib,ob,fb)=>this.fVe(Ga,Fa,ib,fb);this.w9m=(Ga,Fa,ib,ob,fb)=>this.fVe(Ga,Fa,ib,fb);this.kVd=(Ga,Fa,ib,ob,fb,Mb)=>{Mb=U.a.Uc(ua.a.instance.hb.kb.Qa.node,Mb);return this.gW(Ga,Fa,ib,ob,fb,Mb)};this.Pyj=xa;this.Rca=Ma;this.ld=Na;this.Yj=pa;this.ga=Sa;this.X7c=Ua;this.vOb=Ab;this.Ud=mb;this.$f=Rb;this.Wb=
zb;this.SUb=hc;this.TUb=Hb;this.bya=Ta;this.Zv=Aa;this.zHa=ma;eb&&(this.gxc=eb.$("UseClipboardDataHelperInMultiLineImportIsEnabled"),this.sbd=this.TUb&&eb.$("HandleCtrlShiftVAsPasteTextOnlyIsEnabled"));this.kz=new P.a;this.kz.Z(X.a.paste,257);this.kz.Z(X.a.b7,8449);this.kz.Z(X.a.C1,1);this.kz.Z(X.a.JZa,1);this.kz.Z(X.a.yvb,1);this.kz.Z(X.a.Zya,1);this.kz.Z(X.a.aNd,513);this.kz.Z(X.a.reformatPastedContent,4097);this.kz.Z(X.a.EOa,12289);this.kz.Z(X.a.jva,131073);this.kz.Z(X.a.NKf,7);this.kz.Z(X.a.RDi,
1);this.kz.Z(X.a.v_d,8193);this.kz.Z(X.a.copy,272);this.kz.Z(X.a.Jzc,16);this.kz.Z(X.a.cut,304);this.kz.Z(X.a.iUe,48);this.kz.Z(X.a.jVd,64);this.kz.Z(X.a.kVd,64);this.kz.Z(X.a.showPlaceholderGlossary,65536);this.kz.Z(X.a.C5e,1);this.sbd&&this.kz.Z(X.a.Tib,this.kz.J(X.a.v_d))}get Wji(){return this.FHa}set Wji(xa){this.FHa=xa}get $Pa(){return null!=this.Sqg?this.Sqg:this.Sqg=u.a.instance.Pa("Box4.Clipboard.ISystemClipboardAccessManager")}get telemetry(){return null!=this.lrg?this.lrg:this.lrg=u.a.instance.Pa("Common.Utils.Telemetry.ITelemetry")}get fvd(){return this.Pyj.value}get q5n(){return this.Rca}Vb(){this.ga.gb(X.a.icn,
T.a.application,this.BIi,97);this.ga.gb(X.a.jcn,T.a.application,this.BIi,97);this.ga.gb(X.a.J1d,T.a.application,this.gPf,97);this.ga.gb(X.a.K1d,T.a.application,this.gPf,97);this.ga.gb(X.a.cPf,T.a.application,this.gPf,97);this.ga.pS(X.a.iUe,T.a.view,this.gW,1028);this.ga.I$a(X.a.Jzc,T.a.view,this.gW);this.ga.pS(X.a.C5e,T.a.view,this.q_k,1028);this.ga.pS(X.a.C1,T.a.view,this.gW,1028);this.ga.pS(X.a.JZa,T.a.view,this.gW,1028);this.ga.pS(X.a.yvb,T.a.view,this.gW,1028);this.ga.pS(X.a.Zya,T.a.view,this.gW,
1028);this.SUb&&this.ga.gb(X.a.UVa,T.a.view,this.w9m,1028);this.TUb&&this.ga.gb(X.a.Fab,T.a.view,this.x9m,1028);this.ga.pS(X.a.paste,T.a.view,this.gW,1028);this.ga.pS(X.a.b7,T.a.view,this.gW,1028);this.ga.pS(X.a.v_d,T.a.view,this.gW,1028);this.ga.pS(X.a.RDi,T.a.view,this.gW,1028);this.ga.pS(X.a.NKf,T.a.view,this.gW,1028);this.ga.pS(X.a.reformatPastedContent,T.a.view,this.gW,1028);this.ga.pS(X.a.EOa,T.a.view,this.gW,1028);this.ga.pa(X.a.DIb,T.a.view,t.ActionManager.Nf);this.ga.pa(X.a.eEi,T.a.view,
t.ActionManager.Nf);this.ga.pa(X.a.bEi,T.a.view,t.ActionManager.Nf);this.ga.pa(X.a.cEi,T.a.view,t.ActionManager.Nf);this.ga.pa(X.a.dEi,T.a.view,t.ActionManager.Nf);this.ga.pa(X.a.aEi,T.a.view,t.ActionManager.Nf);this.ga.I$a(X.a.jVd,T.a.view,this.gW);this.ga.I$a(X.a.kVd,T.a.view,this.kVd);this.ga.I$a(X.a.aNd,T.a.view,this.gW);this.ga.I$a(X.a.showPlaceholderGlossary,T.a.view,this.gW);this.sbd&&(this.ga.gb(X.a.GYb,T.a.view,this.y9m,1028),this.ga.pS(X.a.Tib,T.a.view,this.gW,1028));this.ga.pa(X.a.kwh,
T.a.view,t.ActionManager.Nf);this.ga.pa(X.a.Kwh,T.a.view,t.ActionManager.Nf);this.zHa&&(this.ga.gb(X.a.E0c,T.a.view,this.E0c,96),this.ga.gb(X.a.KBb,T.a.view,this.KBb,96))}k3(){if(this.Wb){const xa=this.Wb.re(ca.AppFrame.pF);this.sbd&&xa.bindAction(y.KeyInputManager.lc(B.a.Xmb,y.KeyInputManager.Mh|4),X.a.GYb)}else J.ULS.sendTraceTag(592196489,307,10,"Null focus manager and fail to register clipboard shortcuts.")}PHn(xa,Ma,Na){switch(Ma){case X.a.EOa:case X.a.b7:case X.a.Tib:Ma=X.a.K1d;break;case X.a.jva:Ma=
X.a.cPf;break;default:Ma=X.a.J1d}Na[this.Gnb]=xa===Ma}NDl(){const xa=Object(S.a)(93,this.z7c)?this.z7c:null;return xa?xa.ia(I.a.UUc,v.a.nil):v.a.nil}fVe(xa,Ma,Na,pa){if(1===Na){if(!Object(S.a)(da.a,Ma)||!this.X7c||Ka.a.gfa(Ma)&&Ka.a.UCb())return 8;Na=new L.a(()=>this.QDc(this.kz.J(X.a.C1),pa));const Ra=this.X7c.create(Na,Object(E.a)(93,pa));Na=new qa.a(n.AFrameworkApplication.K,G.a.instance,Na,F.a.instance,Ra,this.vOb);return ra.a.Ljh(Ma,Na)?32:8}if(2===Na){if(this.VSn(Y.App.dVa))return this.UVa(xa);
Y.App.Ybc(()=>{this.UVa(xa)});return 32}return 2}UVa(xa){if(!this.Ud)return J.ULS.sendTraceTag(592454657,307,10,"No _editingDomManager"),8;var Ma=this.Ud.pLa();if(!Ma)return J.ULS.sendTraceTag(592454658,307,10,"No ownerDocument"),8;Ma=Ma.Dn;if(!Ma)return J.ULS.sendTraceTag(592454659,307,10,"No document"),8;J.ULS.sendTraceTag(592454660,307,50,"Calling execCommand. Command: {0}",xa);this.$f.m1k(xa);xa=K.a.Ryb(Ma,"paste");Ma=this.$f.tWk();J.ULS.sendTraceTag(573388233,307,50,"PasteEventHandled: {0}",
Ma);if(xa)return J.ULS.sendTraceTag(592454661,307,50,"execCommand succeeded"),32;this.USl();J.ULS.sendTraceTag(592454662,307,10,"execCommand failed");return 8}USl(){this.$Pa&&(this.$Pa.yKb(),ka.a.oTd(!0,ua.a.instance,O.a.dF));if(this.telemetry){const xa=this.telemetry.i1c();xa.EXb("CallExecCommandPasteOperation");xa.fail("call to execCommand('paste') failed",!0);this.telemetry.bea(xa)}}VSn(xa){let Ma=!1;this.Wb?this.Wb.og?Ma=!this.Wb.mqf(this.Wb.og.name):J.ULS.sendTraceTag(573388235,307,10,"No CurrentScope"):
J.ULS.sendTraceTag(573388234,307,10,"No _focusManager");if(Ma){J.ULS.sendTraceTag(573388236,307,50,"CurrentScope: {0}",this.Wb.og.name);if(1>xa)return J.ULS.sendTraceTag(573388237,307,10,"Action callbacks will not execute"),!0;this.Wb.nJh();return!1}return!0}QDc(xa,Ma){return xa&256?new va(this.q5n):xa&2?xa&4096?new wa(Ma,this.ld,this.Yj,Y.App.instance.$Nc,Y.App.instance.FPa):new bb(Ma,this.ld,Y.App.instance.FPa):Ma.hasProperty(I.a.Oac)?new Ja(Ma,this.ld,this.Yj,this.gxc,Y.App.instance.FPa):new wa(Ma,
this.ld,this.Yj,Y.App.instance.$Nc,Y.App.instance.FPa)}static get r3m(){return H.a.aId("Box4PasteScratchPad")}Kjh(xa,Ma,Na,pa){const Ra=n.AFrameworkApplication.protectFile||n.AFrameworkApplication.jO;return n.AFrameworkApplication.K&&n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.RestrictCopyWithIRMEnabled",!1)&&Ra&&!n.AFrameworkApplication.N0b?8:(xa=this.gW(null,xa?X.a.cut:X.a.copy,Ma,1,Na,pa))?xa.response:8}}Object(C.a)(Xa,"ClipboardActor",null,[])},1707:function(C,
N,d){d.r(N);C=d(0);var l=d(16),e=d(1907),a=d(1761);class k extends a.a{constructor(){super();this.isCurrentUser=!1}}Object(C.a)(k,"IsMeAtMentionOptionalAttributes",a.a,[]);class n{constructor(){this.atmention=this.altText=this.lang=null;this.italic=!1;this.link=null;this.underline=this.strikethrough=!1;this.weight=0;this.paragraph=this.color=this.highlight=null}}Object(C.a)(n,"DeltaAttributes",null,[]);var v=d(1570),u=d(11),t=d(74),y=d(17),B=d(8),G=d(1624);d.d(N,"ACommentFormatTranslator",function(){return F});
class F{constructor(K){this.kf=K}eck(K,O){const H=u.ParagraphReader.text(O);let I=null,J=null,L=null,S=0;var E=0,P=!1;let T="";for(O.qa||H&&H.length&&"\n"!==H||B.ULS.sendTraceTag(50870150,327,10,"paragraph chps are null and paragraph text is null or empty");S<O.qa.length;){const X=O.qa.J(S),Y=X.cp;var U=X.formatting?X.formatting.an:null;T+=l.a.substring(H,P?E+1:E,Y);X.wl&&I&&(E=new e.a,E.fullName=T.startsWith("@")?T.substr(1):T,G.a(I,E),P=new k,G.c(I,P,E),K.Qnf(T,E,P,!0),T="",I=null);X.wl&&J&&(E=
L||new n,E.link=J.url,K.U8h(T,E),T="",J=null);I&&J||""===T||(this.kf.Qvb&&L?(K.f9h(T,L),L=null):K.Wea(T),T="");X.hyperlink&&(X.hyperlink.Hx?I=X.hyperlink:X.hyperlink.url&&(J=X.hyperlink));this.kf.Qvb&&U&&(L=new n,L.weight=U.ia(y.a.bold,!1)?v.a.gAf:0,L.italic=U.ia(y.a.italic,!1),L.underline=U.ia(y.a.underline,!1),L.strikethrough=U.ia(y.a.strikethrough,!1),this.kf.ZCb&&(U.hasProperty(y.a.highlight)&&(E=U.getValue(y.a.highlight),L.highlight=t.a.MC(E)),U.hasProperty(y.a.fontColor)&&(U=U.getValue(y.a.fontColor),
L.color=t.a.MC(U))));E=Y;P=!!X.blob;S++}}}F.Gfk="_@_";F.Hfk="Z";Object(C.a)(F,"ACommentFormatTranslator",null,[286])},1718:function(C,N,d){C=d(0);var l=d(153),e=d(16),a=d(27),k=d(22),n=d(2),v=d(236),u=d(157);class t{static get vg(){return l.a.Px(t.sl,WordEditorIntl.WordEditorStrings.l_FootnoteEndnoteFormattingOptionsFont,WordEditorIntl.WordEditorStrings.l_FootnoteEndnoteFormattingOptionsIndent)}}t.sl="<div class='FootnoteEndnoteDialogFontTitle UIFontBold' id='FontTitle'> <label id='FontTitleLabel' class='WACDialogLabel' for='FontPlaceholder' >{0}</label> </div> <div class='normal' id='FontControl'> <div id='FontPlaceholder'></div> </div> <div class='FootnoteEndnoteDialogIndentTitle UIFontBold' id='IndentTitle'> <label id='IndentTitleLabel' class='WACDialogLabel' for='IndentControl' >{1}</label> </div> <div class='normal' id='IndentControl'> <div id='IndentPlaceholderStyles' class='FootnoteEndnoteDialogIndentPlaceholder'></div> </div>";
Object(C.a)(t,"FootnoteEndnoteFormattingOptionsDialogHtml",null,[]);var y=d(18),B=d(3);d.d(N,"a",function(){return G});class G extends l.a{constructor(F,K,O){super();this.QGg=!1;this.cV=null;this.Vcl=H=>{switch(H){case 1:this.ga.processAction(y.a.MJh,2);break;case 2:this.ga.processAction(y.a.NJh,2);break;case 0:this.ga.processAction(y.a.OJh,2)}};this.kp=K;this.LK=!1;this.yQb=G.Bcl;this.Eh=F;this.ga=O;this.kg="FootnoteEndnoteFormattingOptionsDialog";this.Fd=2;this.vg=t.vg;this.Ve(1,WordEditorIntl.WordEditorStrings.L_FootnoteEndnoteFormattingOptionsDialogApplyButton);
this.Ve(2,WordEditorIntl.WordEditorStrings.L_FootnoteEndnoteFormattingOptionsDialogApplyAllButton);this.Wh(WordEditorIntl.WordEditorStrings.L_FootnoteEndnoteFormattingOptionsDialogTitle,this.Vcl,null);this.Deb=!1;document.getElementById("FontStyleComboBox").focus()}get fontName(){return this.cV}set fontName(F){this.cV=F;if(F=document.getElementById("FontSizeComboBox"))F.focus(),this.Eh.updateCommandUI()}get fontSize(){return this.yQb}get Deb(){return this.QGg}set Deb(F){this.QGg=F;this.n5m()}cU(){this.ltd("FontStyleComboBox",
"FontPlaceholder",y.a.xDd.toString(),y.a.kIi.toString(),y.a.hVc.toString(),WoncaIntl.WoncaStrings.L_FontName,"100px");this.ltd("FontSizeComboBox","FontPlaceholder",y.a.yDd.toString(),B.a.bWc.toString(),y.a.iVc.toString(),WoncaIntl.WoncaStrings.L_FontSize,"32px");const F=String.format('<div aria-hidden="true" role="presentation">\r\n\t\t\t<div class="FootnoteEndnoteDialogIndentButtonText">{1}1.{0}</div>\r\n\t\t\t<div class="FootnoteEndnoteDialogIndentButtonSeparator"></div>\r\n\t\t\t<div class="FootnoteEndnoteDialogIndentButtonText">{1}2.{0}</div></div>',
e.a.BZ(WordEditorIntl.WordEditorStrings.l_FootnoteEndnotesIndentButtonText),""),K=String.format('<div aria-hidden="true" role="presentation">\r\n\t\t\t<div class="FootnoteEndnoteDialogIndentButtonText">{1}1.{0}</div>\r\n\t\t\t<div class="FootnoteEndnoteDialogIndentButtonSeparator"></div>\r\n\t\t\t<div class="FootnoteEndnoteDialogIndentButtonText">{1}2.{0}</div></div>',e.a.BZ(WordEditorIntl.WordEditorStrings.l_FootnoteEndnotesIndentButtonText),"&nbsp;&nbsp;&nbsp;&nbsp;");this.Nzc("NoStyle","IndentPlaceholderStyles",
y.a.QJh.toString(),y.a.lIi.toString(),F,WordEditorIntl.WordEditorStrings.l_FootnoteEndnotesNoIndentButtonTitle,"Size110by75");this.Nzc("FirstLineIndent","IndentPlaceholderStyles",y.a.PJh.toString(),y.a.JOf.toString(),K,WordEditorIntl.WordEditorStrings.l_FootnoteEndnotesFirstLineIndentButtonTitle,"Size110by75")}ltd(F,K,O,H,I,J,L){O=v.c(F,O,!0,!0,H,I,e.a.If(J),!0,L);this.yxd(F,K,O,"Medium")}Nzc(F,K,O,H,I,J,L){O=v.g(F,O,H,e.a.If(I),e.a.If(J),L);this.yxd(F,K,O,"Large",J)}yxd(F,K,O,H,I=null){K=document.getElementById(K);
this.kp.Pya(F,O);O=this.kp.hYa(F,H);I&&a.a.Srd(O,String.format("{0}Label",F),I);K.appendChild(O);this.kp.gM(F)}n5m(){this.kp.gM("NoStyle");this.kp.gM("FirstLineIndent")}dispose(){this.LK||(this.kp.RA("FontStyleComboBox"),this.kp.RA("FontSizeComboBox"),this.kp.RA("NoStyle"),this.kp.RA("FirstLineIndent"),this.LK=!0);this.Eh.updateCommandUI();super.dispose()}static get oQa(){return k.a.instance.resolve("Common.IStandaloneRootController").y3}static etl(){return new G(u.App.fm,G.oQa,n.AFrameworkApplication.ya)}static dtl(){return G.etl()}}
G.Bcl=-1;Object(C.a)(G,"FootnoteEndnoteFormattingOptionsDialog",l.a,[])},1745:function(C,N,d){d.d(N,"a",function(){return l});C=d(0);class l{constructor(e,a){this.Gi=this.ffd=0;this.oGg=a;this.iXj=e}Hhb(){return this.ffd-this.Gi>=this.iXj}reset(){this.Gi=this.ffd=this.oGg()}update(){this.ffd=this.oGg()}}Object(C.a)(l,"TimeBasedTaskYieldStrategy",null,[283])},1748:function(C,N,d){var l=this&&this.BO||(Object.create?function(a,k,n,v){void 0===v&&(v=n);var u=Object.getOwnPropertyDescriptor(k,n);if(!u||
("get"in u?!k.iG:u.writable||u.configurable))u={enumerable:!0,get:function(){return k[n]}};Object.defineProperty(a,v,u)}:function(a,k,n,v){void 0===v&&(v=n);a[v]=k[n]}),e=this&&this.__exportStar||function(a,k){for(var n in a)"default"===n||Object.prototype.hasOwnProperty.call(k,n)||l(k,a,n)};Object.defineProperty(N,"__esModule",{value:!0});e(d(1749),N);e(d(1750),N);e(d(1751),N);e(d(1752),N);C.exports.TableCell||Object.defineProperty(C.exports,"TableCell",{enumerable:!0,get:function(){return C.exports.TableCell}});
C.exports.TableCellVerticalAlignment||Object.defineProperty(C.exports,"TableCellVerticalAlignment",{enumerable:!0,get:function(){return C.exports.TableCellVerticalAlignment}});C.exports.TableRow||Object.defineProperty(C.exports,"TableRow",{enumerable:!0,get:function(){return C.exports.TableRow}});C.exports.WordTable||Object.defineProperty(C.exports,"WordTable",{enumerable:!0,get:function(){return C.exports.WordTable}})},1749:function(C,N){Object.defineProperty(N,"__esModule",{value:!0})},1750:function(C,
N){Object.defineProperty(N,"__esModule",{value:!0});N.TableCellVerticalAlignment=void 0;C=N.TableCellVerticalAlignment||(N.TableCellVerticalAlignment={});C[C.Top=0]="Top";C[C.Center=1]="Center";C[C.Bottom=2]="Bottom"},1751:function(C,N,d){Object.defineProperty(N,"__esModule",{value:!0});N.OOXmlTableDesign=N.TableDesign=void 0;var l=d(203);C=function(){function e(a){l.SchemaObject.assign(e,this,a)}Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(a){this.M_=
a},enumerable:!1,configurable:!0});e.getTypeName=function(){return"AugLoop_Table_TableDesign"};e.getBaseTypes=function(){return["AugLoop_Core_Annotation"]};e.typeGuard=function(a){return l.SchemaObject.matchesTypesFor(a,[e.getTypeName()])};e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()};return e}();N.TableDesign=C;C=function(){function e(a){l.SchemaObject.assign(e,this,a)}Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(a){this.M_=a},enumerable:!1,configurable:!0});
e.getTypeName=function(){return"AugLoop_Table_OOXmlTableDesign"};e.getBaseTypes=function(){return["AugLoop_Table_TableDesign","AugLoop_Core_Annotation"]};e.typeGuard=function(a){return l.SchemaObject.matchesTypesFor(a,[e.getTypeName()])};e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()};return e}();N.OOXmlTableDesign=C},1752:function(C,N,d){Object.defineProperty(N,"__esModule",{value:!0});N.WordOOXmlTableTile=N.WordTable=N.Table=N.TableCell=N.TableRow=void 0;var l=d(203);C=function(){function e(a){l.SchemaObject.assign(e,
this,a)}e.getTypeName=function(){return"AugLoop_Table_TableRow"};e.getBaseTypes=function(){return[]};e.typeGuard=function(a){return l.SchemaObject.matchesTypesFor(a,[e.getTypeName()])};e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()};return e}();N.TableRow=C;C=function(){function e(a){l.SchemaObject.assign(e,this,a)}e.getTypeName=function(){return"AugLoop_Table_TableCell"};e.getBaseTypes=function(){return[]};e.typeGuard=function(a){return l.SchemaObject.matchesTypesFor(a,[e.getTypeName()])};e.H_={T_:e.getTypeName(),
B_:e.getBaseTypes()};return e}();N.TableCell=C;C=function(){function e(a){l.SchemaObject.assign(e,this,a)}e.getTypeName=function(){return"AugLoop_Table_Table"};e.getBaseTypes=function(){return[]};e.typeGuard=function(a){return l.SchemaObject.matchesTypesFor(a,[e.getTypeName()])};e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()};return e}();N.Table=C;C=function(){function e(a){l.SchemaObject.assign(e,this,a)}e.getTypeName=function(){return"AugLoop_Table_WordTable"};e.getBaseTypes=function(){return["AugLoop_Table_Table"]};
e.typeGuard=function(a){return l.SchemaObject.matchesTypesFor(a,[e.getTypeName()])};e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()};return e}();N.WordTable=C;C=function(){function e(a){l.SchemaObject.assign(e,this,a)}e.getTypeName=function(){return"AugLoop_Table_WordOOXmlTableTile"};e.getBaseTypes=function(){return["AugLoop_Table_WordTable","AugLoop_Table_Table"]};e.typeGuard=function(a){return l.SchemaObject.matchesTypesFor(a,[e.getTypeName()])};e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()};return e}();
N.WordOOXmlTableTile=C},1761:function(C,N,d){d.d(N,"a",function(){return l});C=d(0);class l{constructor(){this.contentId=""}}Object(C.a)(l,"AtMentionOptionalAttributes",null,[])},1783:function(C,N){Object.defineProperty(N,"__esModule",{value:!0});N.ObjectSchemaType=N.ObjectSemantic=N.SequenceType=N.InputMethod=N.CommandSurface=N.IntentIds=void 0;(function(d){d.Logging="Logging";d.KeyPhrases="KeyPhrases";d.ZeroTermMenu="ZeroTermMenu"})(N.IntentIds||(N.IntentIds={}));(function(d){d.Canvas="Canvas";
d.KeyboardShortcut="KeyboardShortcut";d.ClassicRibbon="ClassicRibbon";d.SimplifiedRibbon="SimplifiedRibbon";d.ContextMenu="ContextMenu";d.Floatie="Floatie";d.SearchBox="SearchBox";d.QuickAccessToolbar="QuickAccessToolbar"})(N.CommandSurface||(N.CommandSurface={}));(function(d){d.Unknown="Unknown";d.Keyboard="Keyboard";d.Mouse="Mouse";d.Touch="Touch";d.Pen="Pen";d.Voice="Voice"})(N.InputMethod||(N.InputMethod={}));(function(d){d.CommandId="CommandId";d.ControlId="ControlId"})(N.SequenceType||(N.SequenceType=
{}));(function(d){d.CommandIdHistory="CommandIdHistory";d.ControlIdHistory="ControlIdHistory";d.FilteredCommandIdHistory="FilteredCommandIdHistory";d.CanvasContext="CanvasContext"})(N.ObjectSemantic||(N.ObjectSemantic={}));(function(d){d.CommandExecutionSequence="CommandExecutionSequence";d.WordCanvasContext="WordCanvasContext"})(N.ObjectSchemaType||(N.ObjectSchemaType={}))},1784:function(C,N,d){Object.defineProperty(N,"__esModule",{value:!0});N.SearchSuggestionAnnotation=N.SearchSuggestionSignal=
void 0;const l=d(203);class e{constructor(k){l.SchemaObject.assign(e,this,k)}static getTypeName(){return"AugLoop_SearchSuggestion_SearchSuggestionSignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(k){return l.SchemaObject.matchesTypesFor(k,[e.getTypeName()])}}N.SearchSuggestionSignal=e;e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()};class a{constructor(k){l.SchemaObject.assign(a,this,k)}get metadata(){return this.M_}set metadata(k){this.M_=k}static getTypeName(){return"AugLoop_SearchSuggestion_SearchSuggestionAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(k){return l.SchemaObject.matchesTypesFor(k,
[a.getTypeName()])}}N.SearchSuggestionAnnotation=a;a.H_={T_:a.getTypeName(),B_:a.getBaseTypes()}},1792:function(C,N,d){var l=this&&this.BO||(Object.create?function(a,k,n,v){void 0===v&&(v=n);var u=Object.getOwnPropertyDescriptor(k,n);if(!u||("get"in u?!k.iG:u.writable||u.configurable))u={enumerable:!0,get:function(){return k[n]}};Object.defineProperty(a,v,u)}:function(a,k,n,v){void 0===v&&(v=n);a[v]=k[n]}),e=this&&this.__exportStar||function(a,k){for(var n in a)"default"===n||Object.prototype.hasOwnProperty.call(k,
n)||l(k,a,n)};Object.defineProperty(N,"__esModule",{value:!0});e(d(1793),N);e(d(1794),N);e(d(1795),N);e(d(1796),N);C.exports.ContractEntityAnnotation||Object.defineProperty(C.exports,"ContractEntityAnnotation",{enumerable:!0,get:function(){return C.exports.ContractEntityAnnotation}});C.exports.ContractEntitySignal||Object.defineProperty(C.exports,"ContractEntitySignal",{enumerable:!0,get:function(){return C.exports.ContractEntitySignal}})},1793:function(C,N){Object.defineProperty(N,"__esModule",{value:!0})},
1794:function(C,N){Object.defineProperty(N,"__esModule",{value:!0})},1795:function(C,N,d){Object.defineProperty(N,"__esModule",{value:!0});N.ContractEntityAnnotation=void 0;const l=d(203);class e{constructor(a){l.SchemaObject.assign(e,this,a)}get metadata(){return this.M_}set metadata(a){this.M_=a}static getTypeName(){return"AugLoop_ContractsIntelligence_ContractEntityAnnotation"}static getBaseTypes(){return["AugLoop_Text_RangeAnnotation","AugLoop_Core_Annotation"]}static typeGuard(a){return l.SchemaObject.matchesTypesFor(a,
[e.getTypeName()])}}N.ContractEntityAnnotation=e;e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()}},1796:function(C,N,d){Object.defineProperty(N,"__esModule",{value:!0});N.ContractEntitySignal=void 0;const l=d(203);class e{constructor(a){l.SchemaObject.assign(e,this,a)}static getTypeName(){return"AugLoop_ContractsIntelligence_ContractEntitySignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(a){return l.SchemaObject.matchesTypesFor(a,[e.getTypeName()])}}N.ContractEntitySignal=
e;e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()}},1799:function(C,N,d){d.r(N);d.d(N,"ReactOICErrorDialogWithTrial",function(){return k});C=d(0);var l=d(44);N=d(1649);var e=d(356),a=d(153);class k extends N.a{constructor(n,v,u,t,y,B){super(n,v,u,t,y,B);v={["errorMessage"]:this.QEh,["offerString"]:this.cvi};n=new a.a(!1,!1,!0);this.G4i?(n.Fd=1,v.helpLink={["type"]:"AppLinkProps",["id"]:"helpLink",["text"]:this.Jeb,["onExecute"]:()=>{e.Redirect.showHelp(this.R4h)}}):(n.Fd=4,n.Ve(2,this.r6h));n.Ve(1,this.Xpd);
n.kg=this.id;v={["id"]:this.id,["dialogIcon"]:this.icon,["bodyControls"]:v};n.Wh(this.sKa,Object(l.a)(this,this.Ofn,"reactOICErrorDialogWithTrialHandler"),v)}}Object(C.a)(k,"ReactOICErrorDialogWithTrial",N.a,[])},1800:function(C,N,d){d.r(N);d.d(N,"OICErrorDialogWithTrial",function(){return a});C=d(0);var l=d(44);N=d(1649);var e=d(142);class a extends N.a{constructor(k,n,v,u,t,y){super(k,n,v,u,t,y);k=document.createElement("span");k.innerText=this.QEh;k.appendChild(document.createElement("br"));k.appendChild(document.createElement("br"));
n=document.createElement("span");n.innerText=this.cvi;k.appendChild(n);n=new e.StandardDialog;this.G4i?(n.Fd=1,n.jOe(this.Jeb,this.R4h)):(n.Fd=4,n.Ve(2,this.r6h));n.Ve(1,this.Xpd);n.kg=this.id;n.Pv(this.sKa,null,this.icon,Object(l.a)(this,this.hrm,"legacyOICErrorDialogWithTrialHandler"),k)}}Object(C.a)(a,"OICErrorDialogWithTrial",N.a,[])},1802:function(C,N,d){var l=this&&this.BO||(Object.create?function(a,k,n,v){void 0===v&&(v=n);Object.defineProperty(a,v,{enumerable:!0,get:function(){return k[n]}})}:
function(a,k,n,v){void 0===v&&(v=n);a[v]=k[n]}),e=this&&this.__exportStar||function(a,k){for(var n in a)"default"===n||Object.prototype.hasOwnProperty.call(k,n)||l(k,a,n)};Object.defineProperty(N,"__esModule",{value:!0});e(d(1803),N);e(d(1804),N);C.exports.SearchProviderAnnotation||Object.defineProperty(C.exports,"SearchProviderAnnotation",{enumerable:!0,get:function(){return C.exports.SearchProviderAnnotation}});C.exports.SearchProviderSignal||Object.defineProperty(C.exports,"SearchProviderSignal",
{enumerable:!0,get:function(){return C.exports.SearchProviderSignal}})},1803:function(C,N){Object.defineProperty(N,"__esModule",{value:!0})},1804:function(C,N,d){Object.defineProperty(N,"__esModule",{value:!0});N.SearchProviderAnnotation=N.SearchProviderSignal=void 0;const l=d(203);class e{constructor(k){l.SchemaObject.assign(e,this,k)}static getTypeName(){return"AugLoop_SearchProvider_SearchProviderSignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(k){return l.SchemaObject.matchesTypesFor(k,
[e.getTypeName()])}}N.SearchProviderSignal=e;e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()};class a{constructor(k){l.SchemaObject.assign(a,this,k)}get metadata(){return this.M_}set metadata(k){this.M_=k}static getTypeName(){return"AugLoop_SearchProvider_SearchProviderAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(k){return l.SchemaObject.matchesTypesFor(k,[a.getTypeName()])}}N.SearchProviderAnnotation=a;a.H_={T_:a.getTypeName(),B_:a.getBaseTypes()}},1838:function(C,
N,d){function l(oa){Type.registerNamespace("WordEditor.Comments");Type.registerNamespace("WordEditor.CommentsInteractive");Type.registerNamespace("Common.App.OAuth");oa?I.Bmn():I.main();aj.main(oa);Jg.main(oa);y.a.instance.Oc(new Gl,0,oa);y.a.instance.Oc(new Wo,0,oa);Ok(oa);tg(oa)}var e=d(0),a=d(8),k=d(1554),n=d(1565),v=d(2),u=d(83),t=d(1494),y=d(178),B=d(35),G=d(37),F=d(15),K=d(77),O=d(22),H=d(161);class I{get name(){return"Common.App.OAuth.OAuthPackage"}yc(oa){oa.register(165,"Common.App.OAuth.IOAuthManager").singleInstance().Yd(()=>
new k.OAuthManager)}init(){const oa=O.a.instance.resolve("Common.App.OAuth.IOAuthManager");this.ido(oa)}ido(oa){const cb=v.AFrameworkApplication.K.lb("FileSource");if(v.AFrameworkApplication.K.$("IsO365ConsumerHost")||v.AFrameworkApplication.K.$("IsO365CommercialHost")||"WopiTest"===cb){var xb=t.a.KGk;if(xb&&xb.IsEnabled){var Qb=xb.Application,qc=t.a.authority;if(void 0!==Qb&&null!==Qb&&Qb.length&&void 0!==qc&&null!==qc&&qc.length){var Mc=n.a[oa.Jha],Gd=F.a.dF,de=oa.WJ();try{var Id=new Map;void 0!==
Id&&null!==Id?(Id.set("SupportStatus",Mc),Id.set("Browser",Gd),Id.set("AuthStrategy",de)):Id=null}catch(hf){Id=null}u.Health.instance.recordKpiUsageForAlertableKpi("WacCorePFT","WacOAuthFC",Id);var Xe=G.a.lf();oa.uoa("Core",Qb).then(hf=>{const Ef=Math.floor(G.a.lf()-Xe);Mc=n.a[oa.Jha];Gd=F.a.dF;de=oa.WJ();a.ULS.sendTraceTag(562943369,3E3,50,'OAuthManager attempted to get a Core token to the WAC FrontEnd API in {0} ms. Success={1}, SupportStatus={2}, ErrorCode="{3}", Host="{4}", Browser="{5}", AuthStrategy="{6}"',
Ef,hf.IsSuccess,Mc,hf.ErrorCode,cb,Gd,de);Id&&(Id.set("SupportStatus",Mc),Id.set("Browser",Gd),Id.set("AuthStrategy",de));var ng=Object.assign(new H.a,{durationMs:Ef,extendedProperties:Id});if(hf.IsSuccess){if(u.Health.instance.recordKpiSuccess("WacCorePFT",ng),ng=xb.Endpoint){var Bh=G.a.lf();v.AFrameworkApplication.Xe.XWb(ng,1,null,{["Authorization"]:"Bearer "+hf.Token},"OAuthManagerValidateAccess",void 0,void 0,void 0,2E4).continueWith(fi=>{var jj=Math.floor(G.a.lf()-Bh),Qg=null;fi.ho?fi="Canceled":
fi.Ji?fi="Faulted":(Qg=fi.result,fi=Qg.succeeded?"Completed":"Failed");jj={["TaskResult"]:fi,["BrowserTokenDurationMS"]:Ef,["BrowserValidationDurationMS"]:jj};Qg&&(jj.HttpStatus=Qg.args.data.wf,Qg.succeeded&&(Qg=B.a(Qg.args.data.Ge),jj.ServerValidationDurationMS=Qg.ElapsedMilliseconds,jj.ServerValidationResult=Qg.ValidatedToken,jj.KMSI=Qg.KMSI,jj.Scopes=Qg.Scopes,jj.TokenExpirationS=Math.floor(parseInt(Qg.Expiration)-(new Date).getTime()/1E3)));a.ULS.sendTraceTag(520632322,3E3,"Completed"===fi?50:
15,K.a.toJSON(jj))})}}else u.Health.instance.recordKpiFailure("WacCorePFT",hf.ErrorCode,!1,!1,ng)}).catch(hf=>{var Ef=Math.floor(G.a.lf()-Xe);Ef=Object.assign(new H.a,{durationMs:Ef,extendedProperties:Id});u.Health.instance.recordKpiFailure("WacCorePFT","UNEXPECTED CATCH: "+hf.toString(),!1,!1,Ef)})}}}}dispose(){}static main(){y.a.instance.Oc(new I)}static Bmn(){y.a.instance.Oc(new I,0,!0)}}Object(e.a)(I,"OAuthPackage",null,[1,2]);var J=d(299),L=d(387),S=d(16);class E{constructor(){this.ald=new L.a}Vco(oa,
cb){if(!oa)return a.ULS.sendTraceTag(40478031,306,10,"SDX AssetId is null."),!1;oa=S.a.mh(oa);if(this.ald.xb(oa))return a.ULS.sendTraceTag(40478032,306,10,"ISdxPaneSuppressionHandler already registered for SDX AssetId: {0}.",oa),!1;this.ald.Z(oa,cb);return!0}wgf(oa){if(!oa)return a.ULS.sendTraceTag(40478033,306,10,"SDX AssetId is null."),null;oa=S.a.mh(oa);return this.ald.xb(oa)?this.ald.J(oa):(a.ULS.sendTraceTag(40478034,306,10,"ISdxPaneSuppressionHandler does not exist for SDX AssetId: {0}.",oa),
null)}}Object(e.a)(E,"SdxPaneSuppressionManager",null,[]);var P=d(244),T=d(263),U=d(9);class X{constructor(oa){this.Wze=0;this.tNj=oa}Hhb(){return this.Wze>=this.tNj}reset(){this.Wze=0}update(){this.Wze++}}Object(e.a)(X,"NodeCountBasedTaskYieldStrategy",null,[283]);var Y=d(1745);class ca{constructor(){this.XZc=new Set}imn(oa){this.XZc.add(oa)}ffo(oa){this.XZc.delete(oa)}kXm(){return()=>{this.XZc.forEach(oa=>{oa.onSessionClose()})}}lXm(){return()=>{this.XZc.forEach(oa=>{oa.onSessionConnect()})}}mXm(){return()=>
{this.XZc.forEach(oa=>{oa.onSessionDisconnect()})}}}Object(e.a)(ca,"AlSessionLifeEventNotifier",null,[132]);var da=d(1377),ua=d(79),ra=d(67),qa=d(80),ka=d(59),la=d(5),Ha=d(1488),wa=d(174),Ca=d(410),Ja=d(1498),bb=d(696),ha=d(230),ia=d(447),va=d(678),Ka=d(451),Xa=d(534);class xa{constructor(){this.token=null}}Object(e.a)(xa,"ReleaseAnnotationParameters",null,[]);class Ma{constructor(){this.value=this.id=this.parentPath=null}}Object(e.a)(Ma,"SetAnnotationMetadataParameters",null,[]);class Na{constructor(){this.id=
this.parentPath=null;this.value=0}}Object(e.a)(Na,"SetAnnotationStateParameters",null,[]);var pa=d(524),Ra=d(375),Sa=d(76),ab=d(86),eb=d(595),zb=d(1189),Ua=d(322),Ab=d(743),mb=d(11),Rb=d(439);class hc extends Sys.EventArgs{constructor(oa,cb){super();this.annotation=oa;this.U$a=cb}}Object(e.a)(hc,"AnnotationLocalStateChangedEventArgs",Sys.EventArgs,[]);var Hb=d(974);class Ta{constructor(oa){this.FQe=this.annotations=null;if(!oa)a.ULS.sendTraceTag(41418884,389,10,"Null operation received!"),this.annotations=
null;else if(oa.items&&0<oa.items.length){const cb=Ta.rHd(oa.parentPath);this.annotations=Array(oa.items.length);let xb=0;for(const Qb of oa.items){const qc=Object.assign(new Hb.a,{id:Qb.id,parentPath:cb,content:Qb.body,annotationType:ha.a.getTypeNameFor(Qb.body),parentRevId:oa.parentRevId});this.annotations[xb++]=qc}this.FQe=ha.a.getTypeNameFor(oa)}}static rHd(oa){return oa?oa.join("\\"):""}}Object(e.a)(Ta,"AnnotationOperation",null,[]);class Aa extends Sys.EventArgs{constructor(oa,cb){super();this.annotationType=
oa;this.activated=cb}}Object(e.a)(Aa,"AnnotationActivationEventArgs",Sys.EventArgs,[]);class ma extends Sys.EventArgs{constructor(oa,cb){super();this.annotation=oa;this.opType=cb}}Object(e.a)(ma,"AnnotationOperationEventArgs",Sys.EventArgs,[]);class Ga{constructor(){this.newState=this.oldState=0;this.handlers=new Sa.a}}Object(e.a)(Ga,"AnnotationResultStateUpdateData",null,[]);var Fa=d(485),ib=d(968);class ob{constructor(){this.BQe=this.Wak=this.DQe=null}}Object(e.a)(ob,"AnnotationCallbacks",null,
[]);class fb{constructor(oa,cb,xb,Qb,qc,Mc){this.sWb=null;this.ltc=new L.a(0);this.Bxc=new L.a;this.N6c=new L.a;this.Did=new Fa.a;this.PHf=null;this.Ih=oa;this.vHa=cb;this.JH=xb;this.AD=Qb;this.FY=qc;this.Ac=Mc}gro(oa,cb,xb,Qb){this.AD.L5b(oa)&&this.Ih.Pd(()=>{if(!this.sWb){this.sWb=new L.a;var qc=mb.ParagraphReader.Sw(Rb.a.getRootNode(),!0,!0);for(const Mc of qc)Mc&&(qc=Mc.ia(la.a.Nc,0))&&(this.sWb.add(qc,Mc.id),this.ltc.Z(Mc.id.toString(),qc))}this.vHa.OHf(oa,(Mc,Gd)=>{if(Mc){var de=this.AD.cUh(oa);
Mc.contentDescriptor.av===de&&((de=this.Btl(Mc))?Mc.T$a?(de=this.o_e(Mc,de))&&(Gd?xb(Gd,Mc.contentDescriptor):cb(de,Mc.contentDescriptor)):Qb(Mc.contentDescriptor):this.RRk(Mc,Object.assign(new ob,{DQe:cb,Wak:xb,BQe:Qb})))}})},"PAS:FEPAOT")}Btl(oa){if(3===oa.contentDescriptor.av){let cb;return({value:cb}=this.sWb.Dc(oa.contentDescriptor.paragraphId)).returnValue?cb:null}if(4===oa.contentDescriptor.av)return ka.a.nil;a.ULS.sendTraceTag(592525442,fb.Hi,15,"GetGraphNodeIdForAnnotationIfConnected: Unsupported content type");
return null}Tdm(oa,cb){if(3===oa.contentDescriptor.av)return cb=this.FY.value.Eb(cb).getValue(la.a.nj),oa.contentDescriptor.nj===cb;if(4===oa.contentDescriptor.av&&cb===ka.a.nil)return!0;a.ULS.sendTraceTag(592525443,fb.Hi,15,"IsGraphNodeValidForAnnotation: Unsupported content type");return!1}RRk(oa,cb){if(3===oa.contentDescriptor.av){const xb=oa.contentDescriptor.paragraphId;this.Bxc.xb(xb)||this.Bxc.add(xb,new Sa.a);this.Bxc.J(xb).add(Qb=>{12===Qb.type&&this.sWb.add(xb,Qb.id);oa.T$a?(Qb=this.o_e(oa,
Qb.id))&&cb.DQe(Qb,oa.contentDescriptor):cb.BQe(oa.contentDescriptor)})}else if(4===oa.contentDescriptor.av)if(oa.T$a){const xb=this.o_e(oa,ka.a.nil);xb&&cb.DQe(xb,oa.contentDescriptor)}else cb.BQe(oa.contentDescriptor);else a.ULS.sendTraceTag(592525444,fb.Hi,15,"DelayCallbackForAnnotation: Unsupported content type")}o_e(oa,cb){if(this.Tdm(oa,cb)){if(cb=this.AD.RLm(oa.T$a,oa.contentDescriptor,cb.toString()))return this.N6c.Z(cb.id,oa.V1a),cb}else this.Ac.isFeatureEnabled(92)&&this.JH.fyc(oa);return null}eij(oa,
cb){let xb=this.AD.VEd(oa);xb&&(cb===Ja.a.getTypeName()?this.Cbo(oa,xb):this.qbo(oa,xb))}Cbo(oa,cb){this.AD.L5b(oa.annotationType)&&(this.JH.KOa(this.FY.value,cb,oa.annotationType),this.N6c.remove(oa.id))}qbo(oa,cb){if(this.AD.L5b(oa.annotationType)){cb=Object.assign(new ib.a,{T$a:this.AD.$ak(oa),contentDescriptor:cb,annotationType:oa.annotationType});cb=this.JH.addAnnotation(this.FY.value,cb);this.N6c.Z(oa.id,cb);const xb=this.AD.k1h(oa.annotationType);xb&&this.Did.contains(xb)&&(this.Ih.Pd(()=>
{var Qb=mb.ParagraphReader.Sw(Rb.a.getRootNode(),!0,!0);if(Qb&&0<Qb.count){const qc=new Sa.a;for(const Mc of Qb)(Qb=fb.nHd(Mc))&&qc.add(Qb);0<qc.count&&this.JH.N8g(this.FY.value,xb,qc.toArray())}},"PAS:TAOCPA"),this.Did.remove(xb))}}Uma(oa){if(this.sWb)if(oa){var cb=oa.ia(la.a.Nc,0);if(cb&&(this.ltc.Z(oa.id.toString(),cb),({value:cb}=this.Bxc.Dc(cb)).returnValue))for(const xb of cb)xb(oa)}else a.ULS.sendTraceTag(592525445,fb.Hi,10,"OnParagraphNodeConnected: Invalid node")}Vyi(oa,cb){if(oa){var xb=
oa.id.toString();oa=oa.ia(la.a.Nc,0);var Qb=0;({value:Qb}=this.ltc.Dc(xb)).returnValue&&(3===cb?(this.Bxc.remove(Qb),this.ltc.remove(xb)):2===cb?this.ltc.Z(xb,oa):a.ULS.sendTraceTag(592525447,fb.Hi,15,"OnParagraphNodeModified: Updating persisted annotation not supported for event"))}else a.ULS.sendTraceTag(592525446,fb.Hi,10,"UpdatePersistedAnnotations: Invalid node")}jGl(oa){let cb;return({value:cb}=this.N6c.Dc(oa)).returnValue?cb:ka.a.nil}dno(oa,cb,xb){oa?cb?this.vHa.xWh(oa,Qb=>{if(Qb){const Gd=
fb.nHd(cb,xb);if(Gd){var qc=Array(Qb.length),Mc=!1;for(let de=0;de<Qb.length;de++)if(Mc||Gd!==Qb[de])qc[de]=Qb[de];else{const Id=fb.nHd(cb);if(!Id)return;Mc=!0;qc[de]=Id;Qb[de]=Id}Mc&&this.JH.N8g(this.FY.value,oa,qc)}}}):a.ULS.sendTraceTag(588863697,fb.Hi,10,"UpdateWorkflowParagraphVersion: Invalid node"):a.ULS.sendTraceTag(588863696,fb.Hi,10,"UpdateWorkflowParagraphVersion: null workflowType")}jNn(oa){oa?this.Did.add(oa):a.ULS.sendTraceTag(588863698,fb.Hi,10,"SetPendingWorkflow: null workflowType")}Swk(oa){oa?
this.Did.remove(oa):a.ULS.sendTraceTag(588105731,fb.Hi,10,"ClearPendingWorkflow: null workflowType")}static nHd(oa,cb=0){if(!oa)return null;cb||(cb=oa.ia(la.a.nj,0));oa=mb.ParagraphReader.qT(oa);if(cb&&oa)return String.format("{0}{1}{2}",oa,fb.e2m,cb);a.ULS.sendTraceTag(588091606,fb.Hi,10,"GetParagraphVersion: Node with text id {0} and paragraph id {1}",cb?"valid":"0",oa?"valid":"0");return null}}fb.Hi=389;fb.e2m="-";Object(e.a)(fb,"PersistedAnnotationStorage",null,[174]);class Mb{constructor(){this.config=
this.token=null}}Object(e.a)(Mb,"UpdateAnnotationConfigParameters",null,[]);var Tb=d(135),rc=d(1169),vb=d(338),Ya=d(1387);class wb{constructor(oa,cb,xb,Qb,qc,Mc,Gd,de,Id,Xe,hf,Ef=null,ng){this.z9a=ng;this.sa=new ra.a;this.Gwa=new ab.a;this.Y7=new ab.a;this.BD=new ab.a;this.Qhe=new ab.a;this.cmc=new pa.a(Ra.a.Rj());this.sBe=new Sa.a;this.JNb=new ab.a;this.Mhe=new ab.a;this.O6c=new ab.a;this.KNb=new ab.a;this.vjc=new ab.a;this.P6c=new ab.a;this.X8c=new ab.a;this.Dgd=[];this.Egd=[];this.prc=null;this.uNj=
new pa.a(Ra.a.Rj());this.Ohe=new Map;this.rPb=new Map;this.Ckc=null;this.Gha=new ab.a;this.jDc=null;this.qPk=()=>{if(this.Dgd.length||this.Egd.length)try{0<this.Dgd.length&&this.MEm(),0<this.Egd.length&&this.Deo()}finally{this.fxk()}else this.Hb.We(this.prc),this.prc=null};this.bxk=()=>{const Bh=new Sa.a;for(const fi of this.BD.values)if(Bh.add(fi),Bh.count===wb.DNj)break;for(const fi of Bh)this.V_b(fi),this.nJb(fi,Ja.a.getTypeName());this.BD.count||(this.Hb.We(this.Ckc),this.Ckc=null)};this.KRm=
(Bh,fi)=>{for(const jj of fi.pk)Bh=jj.intent,!Bh.type&&this.CSn(Bh.intent,jj.cpBegin,jj.cpEnd,jj.M8b)&&this.V_b(Bh.intent)};this.kIj=oa.$("AugLoopAnnotationsAttachingIsEnabled");this.RTj=oa.KB("SendReleaseMessageAnnotationList")||[];this.Ac=Xe;this.PFa=Ef;this.vHa=Mc;this.JH=Gd;this.Ns=xb;this.AD=de;this.M8=Id;this.FY=Qb;this.Ih=cb;this.Hb=qc;O.a.instance.resolve("Box4.ICharacterPropertiesEditor").A7j(this.KRm);this.IL=hf;this.joo=oa.getBooleanFeatureGate("Microsoft.Office.WordOnline.InteractivePerfAnnotationStorageSuperTransaction",
!1);this.Gvj=oa.getBooleanFeatureGate("Microsoft.Office.WordOnline.AnnotationProcessingStateIsEnabled",!1);this.cIj=oa.getBooleanFeatureGate("Microsoft.Office.WordOnline.ProofingALV2Migration",!1);this.z9a&&this.$Tl()}get EMi(){return this.KNb}set EMi(oa){this.KNb=oa}mb(oa,cb){a.ULS.sendTraceTag(41521862,wb.Hi,50,"New registration for annotation type: {0}.",cb);this.addHandler(oa,cb);this.qNe(cb).catch(xb=>{a.ULS.sendTraceTag(594396739,wb.Hi,10,"Failed to activate annotation type {0}: {1}",cb,xb.toString())})}addHandler(oa,
cb){if(oa&&cb&&""!==cb){var xb=null;({value:xb}=this.KNb.Dc(cb,xb)).returnValue?xb.add(oa):(xb=new Sa.a,xb.add(oa),this.KNb.add(cb,xb))}else a.ULS.sendTraceTag(41521861,wb.Hi,10,"Invalid registration. Handler == null? {0} or annotationType == null? {1} or annotationType == empty? {2}.",!oa,!cb,""===cb)}sc(oa,cb){a.ULS.sendTraceTag(41521863,wb.Hi,50,"Unregister handler for annotation type: {0}.",cb);let xb=null;({value:xb}=this.KNb.Dc(cb,xb)).returnValue&&(xb.remove(oa),xb.count||(a.ULS.sendTraceTag(41521864,
wb.Hi,50,"Unregister all handlers for annotation type: {0}.",cb),this.KNb.remove(cb),this.TOm(cb)))}l0i(oa){this.joo&&!this.jDc&&(this.jDc=this.IL.Rc(2),this.jDc.Db(oa))}fxk(){var oa;null===(oa=this.jDc)||void 0===oa?void 0:oa.dispose();this.jDc=null}bth(){this.prc||(this.prc=new qa.a(4,2,100,this.qPk,141),this.Hb.$b(this.prc))}MEm(){let oa;oa=Array.dequeue(this.Dgd);const cb=Rb.a.UIc(this.FY.value,oa);if(cb)if(cb.Qi){this.l0i(cb);var xb=null;if(({value:xb}=this.vjc.Dc(oa,xb)).returnValue){this.vjc.remove(oa);
for(const Qb of xb)this.NEm(cb,Qb)}else a.ULS.sendTraceTag(50663568,wb.Hi,100,"MarkIntentForAnnotationTask: No annotations for given tile id.")}else this.uNj.add(oa);else a.ULS.sendTraceTag(50436127,wb.Hi,15,"MarkIntentForAnnotationTask: Unable to get node from tileId.")}NEm(oa,cb){var xb=cb.content.range;xb=new zb.a(0,xb.start,xb.start+xb.length,ka.a.create(),cb,Qb=>{this.Qhe.Z(cb.id,Qb.toString())});this.Ns.o9b(oa,xb);this.sa.Oea&&this.sa.raiseEvent(wb.u$b,new ma(cb,Ca.a.getTypeName()))}Mpi(oa){const cb=
Rb.a.jeb(oa.parentPath);let xb=null;({value:xb}=this.vjc.Dc(cb,xb)).returnValue||(xb=new Sa.a,this.vjc.add(cb,xb),this.Dgd.push(cb));xb.add(oa);this.bth()}PEm(oa,cb){this.Ih.Pd(()=>{let xb;if(({value:xb}=this.Y7.Dc(oa,xb)).returnValue){var Qb=this.r3i(oa);for(const qc of xb){let Mc;({value:Mc}=this.BD.Dc(qc,Mc)).returnValue&&cb(Mc)&&wb.yCb(Mc)&&(this.Mpi(Mc),Qb&&this.sa.raiseEvent(wb.u$b,new ma(Mc,Ja.a.getTypeName())))}}},"AS:MIFAT")}Eeo(oa,cb){this.Ih.Pd(()=>{let xb;if(({value:xb}=this.Y7.Dc(oa,
xb)).returnValue)for(const Qb of xb){let qc;({value:qc}=this.BD.Dc(Qb,qc)).returnValue&&cb(qc)&&wb.yCb(qc)&&this.z7f(qc)}},"AS:UIFAT")}ZOm(oa){var cb=Rb.a.aK(oa);let xb=null;if(({value:xb}=this.Gwa.Dc(cb,xb)).returnValue){cb=0;for(var Qb=new Sa.a;xb.count>cb;){var qc=xb.J(cb),Mc=null;({value:Mc}=this.BD.Dc(qc,Mc)).returnValue&&wb.yCb(Mc)?this.AD.g0c(oa,Mc)?this.V_b(Mc,!this.Ac.isFeatureEnabled(92)):(qc=Mc.content.range,Mc=new zb.a(0,qc.start,qc.start+qc.length,ka.a.create(),Mc),Qb.add(Mc),cb++):cb++}0<
Qb.count&&this.Ns.gzf(oa,Qb)}}Deo(){let oa="";oa=Array.dequeue(this.Egd);const cb=Rb.a.UIc(this.FY.value,oa);if(cb&&12===cb.type){this.l0i(cb);var xb=null;({value:xb}=this.P6c.Dc(oa,xb)).returnValue?(this.Ns.A7f(Qb=>xb.contains(Qb.intent),cb,0),this.P6c.remove(oa)):a.ULS.sendTraceTag(50663570,wb.Hi,100,"UnmarkIntentForAnnotationsTask: No annotations for given tileId.")}else a.ULS.sendTraceTag(50436128,wb.Hi,15,"UnmarkIntentForAnnotationsTask: Unable to unmark ChPs in node")}z7f(oa){let cb;({value:cb}=
this.Qhe.Dc(oa.id,cb)).returnValue||(cb=Rb.a.jeb(oa.parentPath));this.Qhe.remove(oa.id);var xb=null;({value:xb}=this.P6c.Dc(cb,xb)).returnValue||(xb=new Sa.a,this.P6c.add(cb,xb),this.Egd.push(cb));xb.add(oa);this.bth();xb=null;({value:xb}=this.vjc.Dc(cb,xb)).returnValue&&xb.remove(oa)}x3j(oa){const cb=oa.id;var xb=oa.annotationType;const Qb=oa.parentPath;if(this.AD.egb(oa)){var qc=Rb.a.Rdb(this.FY.value,Qb);if(qc&&(qc=qc.ia(la.a.nj,0).toString(),oa.parentRevId&&qc!==oa.parentRevId))return!1}qc=null;
({value:qc}=this.Y7.Dc(xb,qc)).returnValue||(qc=new Sa.a,this.Y7.add(xb,qc));qc.add(cb);xb=null;({value:xb}=this.Gwa.Dc(Qb,xb)).returnValue||(xb=new Sa.a,this.Gwa.add(Qb,xb));xb.add(cb);this.BD.add(cb,oa);this.fro(oa);return!0}fro(oa){let cb=this.AD.QLh(oa);if(0===cb.length)this.oAh(oa);else{let xb=!1;this.vHa.rVm(cb,oa.annotationType,(Qb,qc)=>{this.BD.xb(oa.id)?(qc=this.AD.xgb(oa,Rb.a.iil(oa)),!Qb&&qc?this.E8f(oa,10,!1):Qb&&this.E8f(oa,Qb),xb||(this.oAh(oa),xb=!0)):qc.HPa=!0})}}oAh(oa){const cb=
wb.yCb(oa);cb&&this.Mpi(oa);!cb&&this.sa.Oea&&this.sa.raiseEvent(wb.u$b,new ma(oa,Ca.a.getTypeName()))}Nfj(oa,cb,xb){let Qb=!0;this.Ih.Pd(()=>{if(xb.startsWith(Rb.a.qyb)){var qc=oa.id,Mc=null;if(cb===Ja.a.getTypeName())this.V_b(oa);else if(({value:Mc}=this.BD.Dc(qc,Mc)).returnValue)a.ULS.sendTraceTag(41418891,wb.Hi,50,"UpdateAnnotationsStorage: Updating storage for annotation {0} of type {1}.",qc,oa.annotationType),this.BD.Z(qc,oa);else if(!this.x3j(oa)){Qb=!1;return}cb===Ca.a.getTypeName()&&xb!==
Rb.a.qyb&&this.sBe.add(oa.annotationType)}this.nJb(oa,cb)},"AS:UAS");return Qb}zIn(oa){if(oa)for(const cb of oa)this.nJb(cb,bb.a.getTypeName()),oa=cb.content,this.X8c.xb(oa.categoryName)?this.X8c.Z(oa.categoryName,cb):this.X8c.add(oa.categoryName,cb);else a.ULS.sendTraceTag(592802119,wb.Hi,10,"SetCritiqueCategoryCountAndSendToHandlers: critiqueCategoryCountAnnotations null")}a7j(oa){this.sa.addHandler(wb.u$b,oa)}i$g(oa){this.sa.addHandler(wb.Rvi,oa)}K5b(oa){return this.JNb.xb(oa)}$6j(oa){this.sa.addHandler(wb.AWd,
oa)}Arn(oa){this.sa.removeHandler(wb.AWd,oa)}r3i(oa){return!Rb.a.mf(oa)&&Ab.a(oa)&&this.sa.Oea}V_b(oa,cb=!0){if(this.BD.xb(oa.id)){var xb=this.BD.J(oa.id);this.BD.remove(oa.id);var Qb=null;({value:Qb}=this.Gwa.Dc(oa.parentPath,Qb)).returnValue?(Qb.remove(oa.id),wb.yCb(xb)&&this.z7f(xb)):a.ULS.sendTraceTag(50734169,wb.Hi,15,"DeleteAnnotationFromStorage: No annotations in given parent path");Qb=null;({value:Qb}=this.Y7.Dc(oa.annotationType,Qb)).returnValue?Qb.remove(oa.id):a.ULS.sendTraceTag(50734170,
wb.Hi,15,"DeleteAnnotationFromStorage: Annotation of this type does not exist in document");this.r3i(oa.annotationType)?this.sa.raiseEvent(wb.u$b,new ma(xb,Ja.a.getTypeName())):this.nJb(oa,Ja.a.getTypeName());cb&&this.M8.eij(xb,Ja.a.getTypeName())}}lbf(oa,cb,xb=!1){const Qb=new Sa.a;var qc;if(!({value:qc}=this.Y7.Dc(oa,qc)).returnValue)return Qb;for(const Mc of qc)this.BD.xb(Mc)?(oa=this.BD.J(Mc),(qc=this.AD.VEd(oa))&&(cb.equals(qc)||xb&&cb.overlaps(qc))&&Qb.add(oa)):a.ULS.sendTraceTag(577843217,
wb.Hi,50,"GetAnnotationsByDescription: Annotation {0} exists in a cache but not in storage",Mc);return Qb}Nam(oa){return ha.a.getTypeNameFor(oa)===vb.a.getTypeName()}wbi(oa){var cb,xb;return(null===(xb=null===(cb=this.z9a)||void 0===cb?void 0:cb.ZTh)||void 0===xb?void 0:xb.call(cb))===rc.a.zic&&oa&&0===oa.priority?this.z9a.b2c(oa.context.substr(oa.startInContext,oa.range.length)):!1}l$m(oa){this.Ih.Pd(()=>{a.ULS.A7(wb.Hi,100)&&a.ULS.sendTraceTag(41418894,wb.Hi,100,"Operation of type {0} with path {1} received",
ha.a.getTypeNameFor(oa),oa.parentPath.join("\\"));try{const cb=new Ta(oa);for(const xb of cb.annotations){cb.FQe===Ca.a.getTypeName()&&Ab.b(xb,!1);if(this.Nam(xb.content)&&this.wbi(xb.content)){this.CQa(xb,70);continue}const Qb=xb.parentPath,qc=cb.FQe;qc===Ja.a.getTypeName()&&this.YMi(xb,Qb);if(qc===Ca.a.getTypeName()&&Ab.a(xb.annotationType)){const Gd=Rb.a.jeb(Qb);if(xb.content.isHotCritique&&this.cIj){this.rPb.set(Gd,Date.now());continue}}const Mc=xb.annotationType;if(Rb.a.mf(Mc)||Mc!==ia.a.getTypeName())if(!Rb.a.mf(Mc)&&
Ab.a(Mc)&&xb.content&&0==xb.content.priority&&Tb.a.D2){const Gd=Rb.a.jeb(Qb);Gd&&Gd==Tb.a.Ggl()&&a.ULS.sendTraceTag(539870169,wb.Hi,10,"Skipping the Spelling Error Annotation as Text Prediction is visible")}else qc!==Ja.a.getTypeName()&&this.cmc.contains(Qb)?a.ULS.sendTraceTag(41418897,wb.Hi,50,"ProcessOperation: Parent tile {0} for annotation {1} was deleted.",Qb,xb.id):this.Lfj(xb,Qb,qc);else a.ULS.sendTraceTag(595342670,wb.Hi,50,"ProcessOperation: Skipping CritiqueCategoryCountAnnotation for Parent tile {0} since the counts are maintained locally.",
Qb)}}catch(cb){a.ULS.sendTraceTag(41418898,wb.Hi,10,"Exception occurred while processing annotations: Error Message {0}, Stack {1}",cb.message,cb.stack)}},"AS:PO")}Gon(oa){if(oa&&oa.annotationType&&this.AD.L5b(oa.annotationType)){var cb;if(({value:cb}=this.Y7.Dc(oa.annotationType,cb)).returnValue&&(oa=this.AD.VEd(oa)))for(const xb of cb){let Qb;({value:Qb}=this.BD.Dc(xb,Qb)).returnValue&&(cb=this.AD.VEd(Qb))&&(oa.equals(cb)||oa.overlaps(cb))&&this.V_b(Qb)}}}nJb(oa,cb){this.Ih.Pd(()=>{let xb=null;
if(({value:xb}=this.EMi.Dc(oa.annotationType,xb)).returnValue)for(const Qb of xb)Qb.wI(oa,cb)},"AS:SATH")}axk(){a.ULS.sendTraceTag(50860999,wb.Hi,50,"ClearStorage: Initiated Clearing Storage");this.Ckc||(this.Ckc=new qa.a(4,2,100,this.bxk,142),this.Hb.$b(this.Ckc))}activateAnnotation(oa,cb){let xb;if(({value:xb}=this.O6c.Dc(oa,xb)).returnValue){if(xb.contains(cb))return Promise.resolve(null);xb.add(cb)}else{let Qb;this.O6c.add(oa,(Qb=new Sa.a,Qb.add(cb),Qb))}return this.qNe(oa)}qNe(oa){a.ULS.sendTraceTag(41521865,
wb.Hi,50,"ActivateAnnotation: Activating annotation type {0}.",oa);if(this.JNb.xb(oa))return Promise.resolve(null);var cb=null;if(({value:cb}=this.Mhe.Dc(oa,cb)).returnValue)return cb;this.C0j(oa);cb=null;this.PFa&&(cb=this.PFa());if(cb){const xb=new Xa.a;xb.annotationType=oa;this.Gvj&&(this.Gha.xb(oa)||this.Gha.Z(oa,new Ga),xb.stateUpdateHandler=(Qb,qc)=>{this.Gha.J(oa).oldState=Qb;this.Gha.J(oa).newState=qc;for(const Mc of this.Gha.J(oa).handlers)Mc(oa,Qb,qc)});cb=cb.activateAnnotation(xb);this.Mhe.add(oa,
cb);return cb.then(Qb=>{this.Mhe.remove(oa);this.JNb.add(oa,Qb.token);this.Mfj(Qb.token,oa);this.sa.raiseEvent(wb.AWd,new Aa(oa,!0));this.YTl(oa);return Qb})}return Promise.reject(Error.create("Error during annotation activation"))}YTl(oa){const cb=this.AD.k1h(oa);cb&&this.vHa.xWh(cb,xb=>{if(this.M8.PHf){var Qb=mb.ParagraphReader.Sw(Rb.a.getRootNode(),!0,!0);if(Qb&&0<Qb.count){let qc=0;for(const Mc of Qb){Qb=fb.nHd(Mc);if(!Qb)continue;let Gd=!1;for(;qc<xb.length;){if(Qb===xb[qc]){Gd=!0;break}qc++}if(!Gd){this.M8.PHf(cb);
break}qc++}}}})}C0j(oa){this.M8.gro(oa,(cb,xb)=>{0<this.lbf(oa,xb,!0).count||this.Nfj(cb,Ca.a.getTypeName(),cb.parentPath)},(cb,xb)=>{if(3!==xb.av)a.ULS.sendTraceTag(591541786,wb.Hi,15,"Annotation moved to unsupported location type: {0}",xb.av);else if(cb.av!==xb.av)a.ULS.sendTraceTag(591541787,wb.Hi,15,"Location types are not equal. This is not currently supported. Old: {0} New: {1}",cb.av,xb.av);else{cb=this.lbf(oa,cb);for(const qc of cb){const Mc=qc.content;cb=Rb.a.Rdb(this.FY.value,qc.parentPath);
if(!cb){a.ULS.sendTraceTag(591541788,wb.Hi,15,"RegisterHandler.onPersistedAnnotationMoved: Unable to get node from tileId.");break}if(!this.Ns.A7f(Gd=>Gd.intent===Mc,cb,0))break;var Qb=xb.sra;Qb=new zb.a(0,Qb,Qb+xb.rra,null,Mc);this.Ns.o9b(cb,Qb)}}},cb=>{for(const xb of this.lbf(oa,cb))this.V_b(xb,!1)})}releaseAnnotation(oa,cb){let xb;if(({value:xb}=this.O6c.Dc(oa,xb)).returnValue){xb.contains(cb)&&xb.remove(cb);if(0<xb.count)return Promise.resolve(!1);this.O6c.remove(oa)}a.ULS.sendTraceTag(593790408,
wb.Hi,50,"ReleaseAnnotation: Releasing annotation type {0}.",oa);return this.$Wi(oa)}TOm(oa){var cb=null;if(({value:cb}=this.Y7.Dc(oa,cb)).returnValue){a.ULS.sendTraceTag(41418899,wb.Hi,50,"OnAllHandlersUnregistered: Purging all storage for annotation type {0}.",oa);for(const xb of cb)if(cb=null,({value:cb}=this.BD.Dc(xb,cb)).returnValue){const Qb=cb.parentPath;let qc=null;({value:qc}=this.Gwa.Dc(Qb,qc)).returnValue&&(qc.remove(xb),qc.count||this.Gwa.remove(Qb));this.BD.remove(xb);wb.yCb(cb)&&this.z7f(cb)}this.Y7.remove(oa)}Array.contains(this.RTj,
oa)&&this.$Wi(oa)}$Wi(oa){let cb=null,xb=null;this.PFa&&(xb=this.PFa());if(xb){if(({value:cb}=this.JNb.Dc(oa,cb)).returnValue){const Qb=new xa;Qb.token=cb;this.JNb.remove(oa);this.sa.raiseEvent(wb.AWd,new Aa(oa,!1));return xb.releaseAnnotation(Qb)}return Promise.resolve(!0)}return Promise.reject(Error.create("Error during annotation release"))}bli(){this.Ih.Pd(()=>{if(this.kIj){var oa=Rb.a.getRootNode();if(oa){var cb=new ab.a;eb.e(oa,xb=>{var Qb=Rb.a.aK(xb),qc=null;if(({value:qc}=this.Gwa.Dc(Qb,qc)).returnValue)for(const Mc of qc)Qb=
null,({value:Qb}=this.BD.Dc(Mc,Qb)).returnValue&&(Qb.parent=xb,Qb.mOc=!0,Qb.UGb=2,cb.xb(Qb.annotationType)||cb.Z(Qb.annotationType,new Sa.a),cb.J(Qb.annotationType).add(Mc),qc=null,({value:qc}=this.Y7.Dc(Qb.annotationType,qc)).returnValue&&qc.remove(Qb.id));return!0},12);for(const xb of this.Y7.keys)if(oa=null,({value:oa}=this.Y7.Dc(xb,oa)).returnValue)for(const Qb of oa)if(oa=null,({value:oa}=this.BD.Dc(Qb,oa)).returnValue){let qc=null;oa.parentPath===Rb.a.qyb?(oa.UGb=1,oa.parent=null):({value:qc}=
this.BD.Dc(oa.parentPath,qc)).returnValue?(oa.UGb=3,oa.parent=qc):(oa.UGb=0,oa.parent=null,a.ULS.sendTraceTag(41554060,wb.Hi,15,"LinkAnnotations: Unknown annotation parent for annotation ID: {0}.",oa.id));oa.mOc=!0;cb.xb(oa.annotationType)||cb.Z(oa.annotationType,new Sa.a);cb.J(oa.annotationType).add(Qb)}else a.ULS.sendTraceTag(41997840,wb.Hi,15,"LinkAnnotations: Annotation object not found for the given annotation ID: {0}.",Qb);else a.ULS.sendTraceTag(41997841,wb.Hi,15,"LinkAnnotations: Annotations not found for the given annotation type: {0}.",
xb);this.Y7=cb;this.sBe.clear()}else a.ULS.sendTraceTag(41554058,wb.Hi,10,"LinkAnnotations: There is no root node in the current document.")}else a.ULS.sendTraceTag(41554057,wb.Hi,50,"LinkAnnotations: Link annotations called but flags is not set.")},"AS:LA")}Zak(oa){this.l$m(oa)}hYm(oa,cb){this.Ih.Pd(()=>{const xb=cb?cb+String.format("\\{0}",oa.id):Rb.a.aK(oa);a.ULS.sendTraceTag(41418900,wb.Hi,50,"OnTileDeleted: Tile delete event received for tile {0}.",xb);this.cmc.contains(xb)||this.cmc.add(xb);
var Qb=null;if(({value:Qb}=this.Gwa.Dc(xb,Qb)).returnValue){a.ULS.sendTraceTag(41418901,wb.Hi,100,"OnTileDeleted: Removing {0} annotations for tile {1} from storage.",Qb.count,xb);for(const qc of Qb)Qb=null,({value:Qb}=this.BD.Dc(qc,Qb)).returnValue&&(this.nJb(Qb,Ja.a.getTypeName()),this.sa.Oea&&this.sa.raiseEvent(wb.u$b,new ma(Qb,Ja.a.getTypeName())),this.BD.remove(qc));this.Gwa.remove(xb)}},"AS:OTD")}gYm(oa){oa=Rb.a.aK(oa);this.cmc.remove(oa)&&a.ULS.sendTraceTag(41418902,wb.Hi,50,"OnTileAdded: Deleted tile {0} was re-added.",
oa)}elo(oa){if(oa){a.ULS.sendTraceTag(50436131,wb.Hi,50,"UpdateRangeForAnnotations: Updated ranges for annotations {0}",oa.count);var cb=new ab.a;for(var xb of oa)oa=null,({value:oa}=cb.Dc(xb.parentPath,oa)).returnValue||(oa=new ab.a,cb.add(xb.parentPath,oa)),oa.Z(xb.id,xb);for(const Qb of cb){cb=Rb.a.Rdb(this.FY.value,Qb.key);if(!cb){a.ULS.sendTraceTag(50436160,wb.Hi,10,"UpdateRangeForAnnotations: Unable to get node for the annotation");break}xb=new Ua.a([0]);for(let qc=0,Mc=cb.qa.length;qc<Mc;qc++)oa=
cb.qa.J(qc),oa.pk&&xb.q4a(oa.pk,void 0,(Gd,de)=>{if(de){var Id=null,Xe=de.intent;Xe&&({value:Id}=Qb.value.Dc(Xe.id,Id)).returnValue&&(Xe=new va.a,Xe.start=de.Ob.cp,Xe.length=Gd.Ob.cp-Xe.start,Id.content.range=Xe,Id.GNa=!1)}})}}else a.ULS.sendTraceTag(50436130,wb.Hi,10,"UpdateRangeForAnnotations: annotations list null")}getAnnotationsByType(oa){a.ULS.sendTraceTag(593049729,wb.Hi,50,"GetAnnotationsByType: Method called for type {0}.",oa);return this.qNe(oa).then(()=>{const cb=new Sa.a;this.Ih.Pd(()=>
{if(Rb.a.mf(oa)||oa!==ia.a.getTypeName()){this.sBe.contains(oa)&&this.bli();var xb=null;if(({value:xb}=this.Y7.Dc(oa,xb)).returnValue){a.ULS.sendTraceTag(41418903,wb.Hi,50,"GetAnnotationsByType: Enumerating annotations of type {0}.",oa);var Qb=new Sa.a;for(const qc of xb)xb=null,({value:xb}=this.BD.Dc(qc,xb)).returnValue&&(xb.GNa&&Qb.add(xb),cb.add(xb));Qb&&0<Qb.count&&wb.yCb(Qb.J(0))&&this.elo(Qb)}}else for(Qb of this.X8c.values)cb.add(Qb);cb.count||a.ULS.sendTraceTag(41418904,wb.Hi,50,"GetAnnotationsByType: No annotations found for type {0}!",
oa)},"AS:GABT");return cb},cb=>{a.ULS.sendTraceTag(41418905,wb.Hi,10,"Exception occurred while fetching annotations of type {0}: {1}",oa,cb);return null})}ldb(oa){let cb=null;return({value:cb}=this.BD.Dc(oa,cb)).returnValue?cb:null}dMh(oa){let cb=null;if(this.Gwa.xb(oa))for(const xb of this.Gwa.J(oa))if(oa=this.ldb(xb))cb||(cb=new Sa.a),cb.add(oa);return cb}GEb(oa){return(oa=this.ldb(oa))?(oa.mOc||this.bli(),oa):null}CQa(oa,cb){this.WOn(oa,cb);this.E8f(oa,cb);this.nJb(oa,bb.a.getTypeName())}sgo(oa,
cb){this.bko(oa,cb);this.iMn(oa,Rb.a.hil(oa));this.nJb(oa,bb.a.getTypeName())}tgo(oa,cb){oa=this.AD.QLh(oa);for(const xb of oa)this.JH.t8f(this.FY.value,xb,cb)}WOn(oa,cb){let xb=null;this.PFa&&(xb=this.PFa());xb&&(oa=this.jil(oa,cb))&&xb.setAnnotationState(oa)}E8f(oa,cb,xb=!0){if(oa&&wb.tai(oa)){var Qb=this.ldb(oa.id);!oa.content||Qb&&oa.content===Qb.content||Rb.a.setAnnotationState(oa,cb);Qb&&Qb.content&&Rb.a.setAnnotationState(Qb,cb);xb&&this.sa.Oea&&(70===cb||60===cb)&&this.sa.raiseEvent(wb.Rvi,
new hc(oa,cb))}}jil(oa,cb){let xb=null;oa&&(xb=Object.assign(new Na,{id:oa.id,value:cb}),Rb.a.mf(oa.parentPath)||(xb.parentPath=oa.parentPath.split("\\")));return xb}iMn(oa,cb){const xb=this.PFa?this.PFa():null;xb&&(oa=this.gil(oa,cb))&&xb.setAnnotationMetadata(oa)}bko(oa,cb){if(oa&&wb.tai(oa)){var xb=this.ldb(oa.id);!oa.content||xb&&oa.content==xb.content||Rb.a.IXi(oa,cb);xb&&xb.content&&Rb.a.IXi(xb,cb)}}gil(oa,cb){if(!oa)return null;const xb=new Ma;xb.id=oa.id;xb.value=cb;Rb.a.mf(oa.parentPath)||
(xb.parentPath=oa.parentPath.split("\\"));return xb}CSn(oa,cb,xb,Qb){const qc=oa.content;if(this.AD.egb(oa)&&qc){const Mc=qc.range.start+qc.range.length;if(0<Qb&&Mc<=xb||0>Qb&&Mc<=xb+Qb)return!1;if(0<Qb&&qc.range.start>=cb||0>Qb&&qc.range.start>=xb)return qc.range.start+=Qb,!1}return!this.Ac.isFeatureEnabled(62)&&qc&&qc.M_?(oa=this.AD.xgb(oa,60),!(60===qc.M_.state&&oa)):!0}v7g(oa,cb){this.Gha.xb(cb)||this.Gha.Z(cb,new Ga);this.Gha.J(cb).handlers.add(oa);oa(cb,this.Gha.J(cb).oldState,this.Gha.J(cb).newState)}$Mi(oa,
cb){this.Gha.xb(cb)&&this.Gha.J(cb).handlers.contains(oa)&&this.Gha.J(cb).handlers.remove(oa)}static tai(oa){oa=ha.a.getBaseTypesFor(oa.content);return Array.contains(oa,wa.a.getTypeName())}static yCb(oa){if(void 0===oa.content||null===oa.content||""===Rb.a.jeb(oa.parentPath))return!1;const cb=ha.a.getBaseTypesFor(oa.content);return Array.contains(cb,Ka.a.getTypeName())&&oa.annotationType!==Ha.RoleDetectionAnnotation.getTypeName()}rgo(oa){oa?(this.Ohe.AugLoop_Text_Critique=oa,oa=this.K5b("AugLoop_Text_Critique")?
this.JNb.J("AugLoop_Text_Critique"):null,this.Mfj(oa,"AugLoop_Text_Critique")):a.ULS.sendTraceTag(540615552,wb.Hi,50,"Annotation configuration could not be updated for annotation type: {0}.","AugLoop_Text_Critique")}Mfj(oa,cb){if(oa&&this.Ohe[cb]){const xb=new Mb;xb.token=oa;xb.config=this.Ohe[cb];this.PFa&&(this.PFa().updateAnnotationConfig(xb),a.ULS.sendTraceTag(540615553,wb.Hi,50,"Annotation configuration has been updated for annotation type: {0}.",cb))}}YMi(oa,cb){let xb=null;({value:xb}=this.BD.Dc(oa.id,
xb)).returnValue&&(oa.annotationType=xb.annotationType);cb=Rb.a.jeb(cb);this.rPb.has(cb)&&Ab.a(oa.annotationType)&&this.rPb.delete(cb)}Lfj(oa,cb,xb){this.Gon(oa);this.Nfj(oa,xb,cb)&&this.M8.eij(oa,xb)}KOa(oa){const cb=oa.parentPath,xb=Ja.a.getTypeName();this.YMi(oa,cb);this.CQa(oa,70);this.cmc.contains(cb)||this.Lfj(oa,cb,xb)}pyl(oa){const cb=new Sa.a;oa=this.Y7.Dc(oa).value;if(null===oa)return cb;for(const xb of oa)oa=this.BD.Dc(xb).value,null!==oa&&cb.push(oa);return cb}$Tl(){Object(ua.__awaiter)(this,
void 0,void 0,function*(){yield Object(Ya.b)();this.kNi()})}kNi(){const oa=this.pyl(vb.a.getTypeName());for(const cb of oa)this.wbi(cb.content)&&this.KOa(cb)}}wb.Hi=389;wb.u$b="OnAnnotationOperation";wb.Rvi="OnAnnotationLocalStateChange";wb.AWd="OnAnnotationActivationChange";wb.DNj=20;Object(e.a)(wb,"AnnotationStorage",null,[175]);class jb{constructor(){this.F5d=null;this.o0c=!1}}Object(e.a)(jb,"AugmentationLoopStateManager",null,[171]);var Zb=d(185),Eb=d(684),tc=d(72),lc=d(91),Lc=d(600),Bb=d(245);
class jc extends Bb.a{constructor(){super();this.FileId=this.AugLoopSeedUrl=this.Authorization=this.OriginString=this.ExpectedEndRevisionId=null;this.AddSubDocumentKindTypeToPathIsEnabled=this.CheckOnDemandNodeVersionEnabled=this.AddDocumentKindTypeToPathIsEnabled=this.SeedBatchesInParallelIsEnabled=!1}Wl(){return 102}static construct(oa,cb,xb,Qb,qc,Mc){const Gd=new jc;Gd.ExpectedEndRevisionId=oa;Gd.OriginString=cb;Gd.Authorization=xb;Gd.AugLoopSeedUrl=Qb;Gd.FileId=qc;Gd.SeedBatchesInParallelIsEnabled=
Mc;Gd.AddDocumentKindTypeToPathIsEnabled=!0;Gd.CheckOnDemandNodeVersionEnabled=!0;Gd.AddSubDocumentKindTypeToPathIsEnabled=!0;return Gd}}Object(e.a)(jc,"FullFileAugLoopSeedingRequest",Bb.a,[]);class dc{constructor(){this.authToken=this.url=this.RBi=null}}Object(e.a)(dc,"ReseedingTaskInfo",null,[]);class nb{constructor(oa,cb,xb,Qb,qc,Mc){this.Xba=null;this.AFg=!1;this.yPb=null;this.REe=0;this.FVc=(Gd,de)=>{Gd=de.C9;this.yPb&&lc.AT(Gd,Id=>Id===this.yPb)&&(de.httpStatusCode!==Zb.a.xD||de.nD||2!==de.wLf?
de.httpStatusCode!==Zb.a.xD||de.nD||1!==de.wLf?this.ESi(()=>{a.ULS.sendTraceTag(50861003,nb.Hi,10,"ProcessReplicationStatus: ForceInbound or pinning the lastest revision failed. HttpStatusCode: {0}, OperationResult: {1}, PinRevisionForAugLoopResponse: {2}, Correlation: {3}",de.httpStatusCode,de.nD,de.wLf,de.Vt)}):(this.fN.o0c=!1,this.Xba.vIb(this.FVc),this.Jf.axk(),a.ULS.sendTraceTag(50861002,nb.Hi,50,"ProcessReplicationStatus: Initiated Full File Seeding Request"),Gd=Object(tc.a)(dc,this.yPb),this.PIi(de.szn,
Gd.RBi,Gd.url,Gd.authToken)):this.ESi(()=>{a.ULS.sendTraceTag(50861001,nb.Hi,50,"Replication succeeded but failed to pin the latest revision on the server for the user")}))};this.d8k=Gd=>{if(void 0===Gd||null===Gd||void 0===Gd.data||null===Gd.data||void 0===Gd.data.Ge||null===Gd.data.Ge)a.ULS.sendTraceTag(41445393,nb.Hi,10,"FileSeedingSuccessCallback: args or args.Data or args.Data.ResponseData is null or Undefined");else if(Gd.data.wf!==Zb.a.xD)a.ULS.sendTraceTag(41445394,nb.Hi,10,"FileSeedingSuccessCallback: Returned unexpected args.Data.HttpStatus code: {0}",
Gd.data.wf);else try{let de;({group:de}=Eb.a.M7(Gd.data.Ge)).returnValue?de.Responses&&de.Responses.length?(Gd=null,de&&de.Responses&&de.Responses.length&&(Gd=de.Responses[0])?(this.B8.omb(Gd),Gd.StatusCode?a.ULS.sendTraceTag(41445398,nb.Hi,10,"FileSeedingSuccessCallback: FullFileAugLoopSeedingResponse returned unexpected status code: {0}",Gd.StatusCode):a.ULS.sendTraceTag(41445399,nb.Hi,50,"FileSeedingSuccessCallback: FullFileAugLoopSeeding was successful and last revision seeded is {0}",Gd.LastSeededRevisionId)):
a.ULS.sendTraceTag(41445397,nb.Hi,10,"FileSeedingSuccessCallback: serverResponseGroup is null or serverResponseGroup.Responses is null or serverResponseGroup.Responses is empty or response is null")):a.ULS.sendTraceTag(41445396,nb.Hi,10,"FileSeedingSuccessCallback: responseGroup or responseGroup.Responses is null or empty"):a.ULS.sendTraceTag(41445395,nb.Hi,10,"FileSeedingSuccessCallback received null or empty server response group")}catch(de){a.ULS.sendTraceTag(41445400,nb.Hi,10,"FileSeedingSuccessCallback: {0}",
de.message)}};this.c8k=Gd=>{void 0===Gd||null===Gd||void 0===Gd.data||null===Gd.data||void 0===Gd.data.Ge||null===Gd.data.Ge?a.ULS.sendTraceTag(41445401,nb.Hi,10,"FileSeedingFailCallback: args or args.Data or args.Data.ResponseData is null or Undefined"):a.ULS.sendTraceTag(41445402,nb.Hi,10,"FileSeedingFailCallback: Editor Service token generation server request failed:{0}",Gd.data.wf)};this.Ewj=oa.$("AugLoopServerSideSeedingIsEnabled");this.Cwj=oa.$("AugLoopReseedingIsEnabled");this.Dwj=oa.$("AugLoopFFSSeedBatchesInParallelIsEnabled");
this.pQg=oa.rc("MaxReseedingRetries",1);this.rg=cb;this.Vbd=xb;this.fN=Qb;this.B8=qc;this.Jf=Mc;U.App.xa&&U.App.xa.jb&&U.App.xa.jb.Yc&&U.App.xa.jb.Yc.contentReplicator&&(this.Xba=U.App.xa.jb.Yc.contentReplicator)}B4l(oa,cb,xb){if(this.Ewj){var Qb=this.fN.F5d;Qb&&Qb.trim().length?this.AFg?this.Cwj&&(a.ULS.sendTraceTag(50861E3,nb.Hi,50,"InitiateFullFileSeedingFlow: Initiated Reseeding Flow"),this.REe=0,this.Xba?(this.fN.o0c=!0,this.Xba.eXb(this.FVc),this.yPb=Object.assign(new dc,{RBi:oa,url:cb,authToken:xb}),
this.Xba.lE(null,null,this.yPb)):a.ULS.sendTraceTag(592814793,nb.Hi,50,"InitiateFullFileSeedingFlow: ContentReplicator is null")):(a.ULS.sendTraceTag(41445392,nb.Hi,50,"InitiateFullFileSeedingFlow: Initiated FullFileSeedingFlow"),this.PIi(Qb,oa,cb,xb),this.AFg=!0):a.ULS.sendTraceTag(41445391,nb.Hi,10,"InitiateFullFileSeedingFlow: Empty or Null SeedRevision. Unable to InitiateFullFileSeedingFlow.")}else a.ULS.sendTraceTag(41445390,nb.Hi,50,"InitiateFullFileSeedingFlow: AugLoopServerSideSeeding BRS setting has been diabled. File will not be seeded to Augmentation Loop.")}ESi(oa){this.REe<
this.pQg?(a.ULS.sendTraceTag(594384E3,nb.Hi,50,"RetryReseeding: ForceInbound or pinning the latest revision failed. Reseeding retry #{0} of {1}",++this.REe,this.pQg),this.Xba.lE(null,null,this.yPb)):(this.fN.o0c=!1,this.Xba.vIb(this.FVc),oa())}PIi(oa,cb,xb,Qb){const qc=jc.construct(oa,cb,Qb,xb,v.AFrameworkApplication.rootQuerySignature,this.Dwj);a.ULS.sendTraceTag(595178454,nb.Hi,50,"QueueFullFileSeedingRequest: Calling AddSeedRequestToRequestManager on Host store replicator load completion.");this.Vbd.dCb.execute(()=>
{this.T4j(qc)})}T4j(oa){a.ULS.sendTraceTag(595178453,nb.Hi,50,"InitiateFullFileSeedingFlow: Adding seed request to RequestManager");this.rg.Lj(U.App.webServiceBase+"OneNote.ashx?perfTag=FullFileAugLoopSeed",2,Lc.b(oa),{["Content-Type"]:"application/json; charset=utf-8"},!1,2,this.d8k,this.c8k,oa);a.ULS.sendTraceTag(42016906,nb.Hi,50,"InitiateFullFileSeedingFlow: Added seed request to RequestManager")}}nb.Hi=389;Object(e.a)(nb,"FullFileAugLoopSeedingService",null,[]);class Gb{constructor(){}}Object(e.a)(Gb,
"RuntimeManagerInitializationTracker",null,[]);class lb{getAugLoopRuntimeManager(){return augLoop.ALFactoryGlobal.getAugLoopRuntimeManager()}}Object(e.a)(lb,"AlFactoryWrapper",null,[172]);class Kb{En(){return Rb.a.En()}}Object(e.a)(Kb,"UtilsWrapper",null,[173]);var Vb=d(594),vc=d(58),Fc=d(17),Zc=d(45),td=d(106),xd=d(1904),le=d(6),Yc=d(108),xc=d(168),md=d(34),Ie=d(268),Te=d(428),rf=d(105),ke=d(231);class xe{constructor(oa,cb,xb,Qb,qc){this.Oa=oa;this.Cf=xb;this.gp=Qb;this.He=qc;this.Wla=this.Oa.getBooleanFeatureGate("Microsoft.Office.WordOnline.Augloop.IsCaptionDetectionEnabled",
!1)}static get ae(){return ke.a.getInstance()}mKn(oa,cb){oa.listType=this.hyl(cb);oa.outlineLevel=mb.ParagraphReader.dBa(cb);oa.indentation=xe.Oef(this.gp.mT(cb));oa.alignment=xe.Xaf(mb.ParagraphReader.Hv(cb));oa.isInsideTable=this.isInsideTable(cb);oa.isInsideTOC=cb.Sr;oa.rightIndentation=xe.Oef(this.gp.NYa(cb));var xb=this.gp.J3b(cb);oa.specialIndentType=xe.BJl(xb);oa.specialIndentBy=xe.Oef(xb);oa.listType!==xd.e.NoList&&this.RLn(cb,oa);this.POn(cb,oa);xb=[];this.Wla&&(xb=this.o9m(cb));oa.formattedRanges=
this.ltl(cb,xb);this.Wla&&null!=xb&&(oa.objectReferences=0<xb.length?xb:void 0)}ltl(oa,cb){var xb=oa.qa?oa.qa.length:0,Qb=Yc.FormattingReader.Pr(md.a.create(oa));let qc=rf.a.QG,Mc=0,Gd=rf.a.OJ/2;Qb&&(Gd=Yc.FormattingReader.Gn(Qb,Fc.a.fontSize,rf.a.OJ)/2,qc=Yc.FormattingReader.Gn(Qb,Fc.a.font,rf.a.QG),Mc=Yc.FormattingReader.language(Qb));Qb="Normal";var de=this.He.yo(oa);de&&(Qb=de.getValue(Zc.a.ja)||"Normal",de.hasProperty(Fc.a.font)&&(qc=de.getValue(Fc.a.font)));if(xb){--xb;de=[];let fi=null,jj=
void 0,Qg=null;this.Wla&&oa.hasProperty(Fc.a.un)&&(Qg=oa.getValue(Fc.a.un));const sh=oa.properties.ia(la.a.Vda,null);for(let Sk=0;Sk<xb;Sk++){var Id=oa.qa.J(Sk),Xe=oa.Lc,hf=null;this.Wla&&(hf=xe.Cif(oa,Qg,Sk));Id.Ff&&(fi=xe.Kho(Xe,Id.Ff,fi));Id.hyperlink&&Id.hyperlink.url?jj=Id.hyperlink.url:Id.wl&&(jj=void 0);var Ef=oa.qa.J(Sk+1).cp-1;Xe=Id.cp;Ef=Ef-Id.cp+1;let Vf=!1,Pk=!1,oj=!1,vi=Gd,kj=0,Vl=0,lh=Qb,Yg=void 0,Fi=Mc,Zj=qc,Um;if(Id.formatting){var ng=Id.formatting;Vf=Yc.FormattingReader.Gn(ng,Fc.a.bold,
!1);Pk=Yc.FormattingReader.Gn(ng,Fc.a.italic,!1);oj=Yc.FormattingReader.Gn(ng,Fc.a.underline,!1);vi=Yc.FormattingReader.Gn(ng,Fc.a.fontSize,2*Gd)/2;kj=Yc.FormattingReader.Gn(ng,Zc.a.capitalization,0);Vl=Yc.FormattingReader.Gn(ng,Fc.a.fontColor,0);Fi=Yc.FormattingReader.language(ng)||Mc;Zj=Yc.FormattingReader.Gn(ng,Fc.a.font,qc);lh=Qb;var Bh=ng.an;Bh&&(Bh=Bh.ia(Zc.a.tB,null))&&!Bh.equals(ka.a.nil)&&ng.paragraph.Lc&&(ng=ng.paragraph.Lc.Eb(Bh))&&(lh=(new xc.a(ng)).getValue(Zc.a.ja))}this.Wla&&(Um=this.ggf(hf),
null!=Um&&this.u9g(cb,hf,Um,de.length,xd.b.Inline));fi&&(Yg=0<fi.count);Id={isDeleted:this.nbm(sh,Id,Sk,jj),fontFamily:Zj,fontWeight:Vf?xd.d.Bold:xd.d.Normal,fontSize:vi,italic:Pk,underline:oj?xd.h.SingleLine:xd.h.None,capitalization:xe.Prh(kj),color:Vl,styleName:lh,isFollowUp:Yg,languageId:xe.Frh(Fi),start:Xe,length:Ef,link:jj,isReference:xe.isReference(Id)?!0:void 0,objectType:null!==Um&&void 0!==Um?Um:void 0};hf=0<de.length?de[de.length-1]:void 0;xe.jrk(hf,Id)?hf.length+=Id.length:de.push(Id)}return de}return[{fontFamily:qc,
fontWeight:xd.d.Normal,fontSize:Gd,italic:!1,underline:xd.h.None,capitalization:xe.Prh(0),color:0,styleName:Qb,isFollowUp:void 0,languageId:xe.Frh(Mc),start:0,length:oa.characterData.length}]}nbm(oa,cb,xb,Qb){if(this.GA()){if(cb.blob||cb.formatting&&cb.formatting.cache&&cb.formatting.cache.nDb||Qb)return!0;if(oa&&xb<oa.length)return oa[xb]}return cb.ei?!0:!1}GA(){return!!v.AFrameworkApplication.K&&v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ProofingALV2Migration",
!1)}static jrk(oa,cb){return!!oa&&!!cb&&oa.start+oa.length===cb.start&&oa.isDeleted===cb.isDeleted&&oa.fontFamily===cb.fontFamily&&oa.fontWeight===cb.fontWeight&&oa.fontSize===cb.fontSize&&oa.italic===cb.italic&&oa.underline===cb.underline&&oa.capitalization===cb.capitalization&&oa.color===cb.color&&oa.highlightColor===cb.highlightColor&&oa.styleName===cb.styleName&&void 0===oa.link&&void 0===cb.link&&oa.languageId===cb.languageId&&!oa.isReference&&!cb.isReference&&!oa.isFollowUp&&!cb.isFollowUp&&
void 0===oa.objectType&&void 0===cb.objectType}hyl(oa){const cb=new le.GraphIterator;cb.set(oa);cb.Bb(11);cb.kd(11);return(oa=this.Cf.Hs(cb))?xe.YFk(oa.listType):xd.e.NoList}RLn(oa,cb){const xb=this.Cf.xF(oa);if(xb){xb.hasProperty(la.a.listID)&&(cb.listId=xb.getValue(la.a.listID).toString());const Qb=this.JTh(oa,xb,Fc.a.font);oa=this.JTh(oa,xb,Fc.a.fontSize);Qb&&(cb.bulletAndNumberFontFamily=Qb);oa&&(cb.bulletAndNumberFontSize=oa)}}isInsideTable(oa){const cb=new le.GraphIterator;cb.set(oa);return cb.Bb(14)}POn(oa,
cb){cb.spacingBeforeParagraph=this.nZh(oa,la.a.ega,la.a.ena,la.a.zj);cb.spacingAfterParagraph=this.nZh(oa,la.a.dga,la.a.dna,la.a.ra);cb.lineSpacing=this.ALa(oa)}nZh(oa,cb,xb,Qb){if(mb.ParagraphReader.Gn(oa,cb,!1))return 0;cb=mb.ParagraphReader.Gn(oa,xb,-1);if(0<=cb)return cb*Ie.a.FUc/100;oa=mb.ParagraphReader.Gn(oa,Qb,-1);return 0<=oa?oa/20:0}JTh(oa,cb,xb){if(xe.ae.RL){if(oa=this.xql(oa),null!=oa&&null!=oa.cache)return oa.cache.getValue(xb)}else if(cb.hasProperty(xb))return cb.getValue(xb)}xql(oa){var cb;
oa=null===(cb=oa.qa)||void 0===cb?void 0:cb.last;return null!=oa&&oa.Xh?oa.formatting:(a.ULS.sendTraceTag(520680196,389,50,"EOP for list item does not have any formatting applied."),null)}ALa(oa){const cb=mb.ParagraphReader.Gn(oa,la.a.va,Ie.a.va);oa=mb.ParagraphReader.Gn(oa,la.a.ta,Ie.a.lineSpacing);switch(cb){case 0:return oa/240;case 1:return oa/20;default:return 0}}static Kho(oa,cb,xb){for(let Qb=0;Qb<cb.length;Qb++){const qc=cb.J(Qb),Mc=qc.Qj,Gd=oa.Eb(Mc);Gd&&Gd.ia(la.a.HF,!1)&&(xb||(xb=new pa.a(new Te.a)),
qc.Pc?xb.add(Mc):xb.remove(Mc))}return xb}static Frh(oa){return(oa=Vb.a.pg(oa))&&oa.name?oa.name.toLowerCase():void 0}static Oef(oa){return oa?2===oa.unit?Math.floor(vc.a.ywb(oa.value)/20):Math.floor(oa.value/20):0}static BJl(oa){if(!oa)return xd.g.Initial;switch(oa.specialIndentType){case 1:return xd.g.FirstLine;case 2:return xd.g.Hanging;default:return xd.g.Initial}}static Prh(oa){switch(oa){case 2:return xd.c.AllCaps;case 1:return xd.c.SmallCaps;default:return xd.c.NoCaps}}static Xaf(oa){switch(oa){case 1:return xd.a.Left;
case 3:return xd.a.Right;case 2:return xd.a.Center;case 6:return xd.a.Justified;case 0:return xd.a.None;default:return xd.a.Other}}static YFk(oa){switch(oa){case 15:return xd.e.Any;case 1:return xd.e.Bullet;case 42:return xd.e.Invalid;case 13:return xd.e.Lim;case 14:return xd.e.Nil;case 16:return xd.e.NoList;case 0:return xd.e.Numbered;default:return xd.e.Invalid}}static isReference(oa){return oa.blob&&(7===oa.blob.si||10===oa.blob.si)||oa.Lh&&0<oa.Lh.length||oa.Ff&&0<oa.Ff.length||oa.Mb&&0<oa.Mb.length?
!0:!1}static Cif(oa,cb,xb){return null==cb?null:cb[xb]&&!cb[xb].equals(ka.a.nil)&&oa.Lc?oa.Lc.Eb(cb[xb]):null}ggf(oa){if(null==oa)return null;if(oa.hasProperty(la.a.Eq)){var cb=oa.getValue(la.a.Eq);if(xe.XEi.has(cb))return xe.XEi.get(cb)}if(oa.hasProperty(la.a.N1b)&&null!=oa.getValue(la.a.N1b))return xd.f.FootnoteEndnote;if(oa.hasProperty(la.a.pageBreak)&&oa.getValue(la.a.pageBreak))return xd.f.PageBreak;if(oa.hasProperty(la.a.RDb)&&oa.getValue(la.a.RDb))return xd.f.Tab;cb=!1;oa.hasProperty(td.a.P$)?
cb=oa.getValue(td.a.P$):oa.hasProperty(la.a.hfa)&&(cb=oa.getValue(la.a.hfa));return cb&&oa.hasProperty(la.a.imageType)&&1==oa.getValue(la.a.imageType)?xd.f.Image:null}static cem(oa){return oa.hasProperty(la.a.A4b)&&0<=oa.getValue(la.a.A4b)?!0:!1}Ihi(oa){return xe.o4n.has(oa)}Guh(oa,cb,xb,Qb){return null==oa||null==cb?(a.ULS.sendTraceTag(null,389,10,"FormattingExtractor.CreateObjectReference: propertySet or objectType is undefined."),null):Qb===xd.b.Inline&&null==xb?(a.ULS.sendTraceTag(null,389,10,
"FormattingExtractor.CreateObjectReference: Inline object does not have formattedRangeIndex defined."),null):Qb===xd.b.Floating&&null!=xb?(a.ULS.sendTraceTag(null,389,10,"FormattingExtractor.CreateObjectReference: Floating object has formattedRangeIndex defined."),null):0>xb?(a.ULS.sendTraceTag(null,389,10,"FormattingExtractor.CreateObjectReference: FormattedRangeIndex is a negative number."),null):xe.cem(oa)?null:this.Ihi(cb)?{referencedPath:["session","doc","main",oa.id.toString()],formattedRangeIndex:xb,
anchorMode:null!==Qb&&void 0!==Qb?Qb:xd.b.Unspecified,anchoredObjectType:Qb==xd.b.Floating?cb:void 0}:null}u9g(oa,cb,xb,Qb,qc){cb=this.Guh(cb,xb,Qb,qc);null!=cb&&null!=oa&&oa.push(cb)}o9m(oa){const cb=[];if(null==oa)return a.ULS.sendTraceTag(null,389,10,"FormattingExtractor.ProcessAnchoredObjects: paragraphNode is null."),cb;let xb=null;oa.hasProperty(la.a.q5)&&(xb=oa.getValue(la.a.q5));if(null!=xb)for(let Qb=0;Qb<xb.length;++Qb){const qc=xe.Cif(oa,xb,Qb),Mc=this.ggf(qc);null!=Mc&&this.u9g(cb,qc,
Mc,null,xd.b.Floating)}return cb}Pqh(oa){if(null==oa||!oa.hasProperty(Fc.a.un))return!1;const cb=oa.getValue(Fc.a.un);for(let Qb=0;Qb<cb.length;Qb++){var xb=xe.Cif(oa,cb,Qb);xb=this.ggf(xb);if(this.Ihi(xb))return!0}return!1}}xe.XEi=new Map([[5,xd.f.Image],[11,xd.f.TextBox],[7,xd.f.Chart],[6,xd.f.SmartArt],[10,xd.f.Drawing],[2,xd.f.EquationObject],[4,xd.f.Ink],[19,xd.f.PageBreak],[23,xd.f.FootnoteEndnote],[24,xd.f.FootnoteEndnote],[35,xd.f.FootnoteEndnoteReferenceMark],[36,xd.f.FootnoteEndnoteReferenceMark],
[0,xd.f.Other]]);xe.o4n=new Set([xd.f.Image,xd.f.TextBox,xd.f.Chart,xd.f.SmartArt,xd.f.Drawing,xd.f.Ink]);Object(e.a)(xe,"FormattingExtractor",null,[170]);var zf=d(1036);class $c extends Sys.EventArgs{constructor(oa){super();this.u4b=oa}}Object(e.a)($c,"HasNodeEventsEventArgs",Sys.EventArgs,[]);class Hg extends Sys.EventArgs{constructor(oa){super();this.w6=oa}}Object(e.a)(Hg,"IsCollectingNodeEventsEventArgs",Sys.EventArgs,[]);class Rc{constructor(oa,cb,xb){this.MSc=oa;this.graphNode=cb;this.fullPath=
xb}}Object(e.a)(Rc,"NodeEvent",null,[197]);class Ed{constructor(){this.Ite=this.wre=!1;this.Sqb=null;this.sa=new ra.a;this.D8=new L.a(0);this.f7a=new zf.a(Ra.a.Rj());this.Drb=new zf.a(Ra.a.Rj());this.Cgd=[]}Y9g(oa){this.sa.addHandler("IsCollectingNodeEventsChangedKey",oa)}Hwk(){this.D8=new L.a(0);this.u4b=!1}get u4b(){return this.wre}set u4b(oa){this.wre!==oa&&(this.wre=oa,this.sa.raiseEvent("HasNodeEventsChangedKey",new $c(oa),this))}get w6(){return this.Ite}set w6(oa){this.Ite!==oa&&(this.Ite=oa,
this.sa.raiseEvent("IsCollectingNodeEventsChangedKey",new Hg(oa),this))}fJb(oa,cb){this.f7a.xb(oa)||this.f7a.Z(oa,cb)}SBn(oa,cb){this.Drb.Z(oa,cb)}bil(oa){let cb=null;this.Drb.xb(oa)&&(cb=this.Drb.J(oa),this.Drb.remove(oa));return cb}T2d(oa,cb){if(oa)if(this.w6){var xb=3!==cb&&4!==cb&&5!==cb||!this.f7a.xb(String.format("{0}",oa.id))?Rb.a.aK(oa):this.f7a.J(String.format("{0}",oa.id));if(({value:Qb}=this.D8.Dc(xb)).returnValue)if(Qb||3!==cb)if(5===Qb&&3===cb){if(oa=xb.split("\\").pop(),this.Drb.xb(oa)){var Qb=
this.Drb.J(oa);Qb===xb?(this.gyf(xb,cb),this.D8.add(xb,cb)):(this.Drb.Z(oa,xb),this.f7a.Z(oa,Qb),this.Sni(xb),this.D8.remove(xb),this.gyf(xb,cb),this.D8.add(Qb,5))}}else Qb&&(4!==Qb||0!==cb&&3!==cb&&5!==cb)&&(this.gyf(xb,cb),this.D8.add(xb,cb));else this.Sni(xb),this.D8.remove(xb);else this.ACm(xb,cb),this.Cgd.push(oa),this.D8.add(xb,cb);this.u4b=0<this.D8.count}else a.ULS.sendTraceTag(593761369,389,15,"Can't record a node event if not in collecting mode.");else a.ULS.sendTraceTag(593761370,389,15,
"node is null.")}ACm(oa,cb){a.ULS.sendTraceTag(593761368,389,100,"Recording new event in queue for node {0} of kind {1}.",oa,cb)}gyf(oa,cb){a.ULS.sendTraceTag(593761366,389,100,"Recording new event for node {0} of kind {1}.",oa,cb)}Sni(oa){a.ULS.sendTraceTag(593761367,389,100,"Removing node {0} form _nodeIdEventKindMap.",oa)}BDk(){let oa=null;var cb=!1;let xb=null;for(;this.Cgd.length&&!cb;){xb=Array.dequeue(this.Cgd);if(!xb)return a.ULS.sendTraceTag(593761365,389,15,"graphNode should not be null."),
null;this.f7a.xb(String.format("{0}",xb.id))?(oa=this.f7a.J(String.format("{0}",xb.id)),this.f7a.remove(String.format("{0}",xb.id)),this.Cgd.push(xb)):oa=Rb.a.aK(xb);cb=this.D8.xb(oa)}if(!cb)return a.ULS.sendTraceTag(593761364,389,15,"NodeEventCollection is empty."),this.Hwk(),null;cb=this.D8.J(oa);this.D8.remove(oa);this.u4b=0<this.D8.count;a.ULS.sendTraceTag(593761363,389,100,"Consuming new event for node {0} of kind {1}.",oa,cb);return new Rc(cb,xb,oa)}Cin(oa){this.Sqb=oa}CDk(){if(!this.Sqb)return null;
for(var oa=0;oa<this.Sqb.length;oa++){var cb=this.Sqb.J(oa);cb=Rb.a.aK(cb.node);if(this.D8.xb(cb))return null}oa=this.Sqb;this.Sqb=null;return oa}Zwk(){this.Sqb=null}y1n(){this.w6=!0}Ccm(oa){return this.D8.xb(oa.id.toString())}}Object(e.a)(Ed,"NodeEventsCollection",null,[169]);var Yd=d(1458),Zf=d(1386),Hc=d(308),sc=d(126);class pd extends Zf.a{constructor(oa,cb,xb,Qb,qc,Mc,Gd,de,Id,Xe,hf){super();this.ncd=new Yd.a;this.R6a=!1;this.Kmc=null;this.Sfa=(Ef,ng)=>{(Ef=ng.node)&&this.W2a(Ef)&&(a.ULS.sendTraceTag(40253400,
389,100,"New paragraph Connect event."),Rb.a.eUn(Ef,this.Kia.w6,this.TNb,this.HTj)&&(this.Kia.T2d(Ef,0),this.Ogj(Ef)));this.Kia.w6&&this.M8.Uma(Ef)};this.$vi=(Ef,ng)=>{Ef=ng.node;this.Kia.fJb(String.format("{0}",Ef.id),Rb.a.aK(Ef))};this.vGb=(Ef,ng)=>{(Ef=ng.node)&&this.W2a(Ef)&&(a.ULS.sendTraceTag(40253401,389,100,"New paragraph Disconnect event."),this.Kia.w6&&this.Kia.T2d(Ef,3));this.Kia.w6&&this.M8.Vyi(Ef,3)};this.Y2=(Ef,ng)=>{Ef=ng.node;ng=ng.property;Ef&&this.Xvj.has(ng)&&this.W2a(Ef)&&(a.ULS.sendTraceTag(40253402,
389,100,"New paragraph Modified event."),this.Kia.w6&&(this.Kia.T2d(Ef,2),ng===la.a.nj&&this.Ogj(Ef)));this.Kia.w6&&ng===la.a.Nc&&this.M8.Vyi(Ef,2)};this.awi=(Ef,ng)=>{(Ef=ng.node)&&mb.ParagraphReader.nc(Ef)&&!this.pmc.has(Ef)&&!this.Ioe.has(Ef)&&(this.pmc.add(Ef),this.tX())};this.Xyi=(Ef,ng)=>{a.ULS.sendTraceTag(51389214,389,100,"Paragraph load event.");(Ef=ng.node)&&this.Jf.ZOm(Ef)};this.ZDf=()=>{this.p0c()?this.jU():this.R6a&&!this.Kia.w6&&this.BQa()};this.rv=cb;this.Kia=xb;this.HTj=sc.b(Qb.F5d);
this.TNb=oa.$("AugLoopOperationsAreEnabled");this.Jf=qc;this.M8=Mc;this.AD=Gd;this.Hb=de;this.Ns=Id;this.JH=Xe;this.pmc=new Set;this.Ioe=new Set;hf.Rna(this,7);this.Xvj=new Set([Fc.a.lo,Fc.a.bold,Fc.a.italic,Fc.a.underline,Fc.a.font,Fc.a.fontSize,Fc.a.fontColor,Zc.a.capitalization,Fc.a.Zh,Fc.a.un,la.a.ega,la.a.ena,la.a.zj,la.a.dga,la.a.dna,la.a.ra,la.a.va,la.a.ta,la.a.listID,la.a.JQ,la.a.fe,la.a.Qua,la.a.ev,la.a.nj])}get index(){return 7}get RTc(){return this.Kmc}set RTc(oa){this.Kmc=oa;this.M8.PHf=
oa?()=>{this.Kmc()}:null}init(){this.p0c()&&this.jU();this.Kia.Y9g(this.ZDf)}jU(){this.rv?(this.R6a=!0,this.rv.ys(this.Sfa),this.rv.WV(this.$vi),this.rv.zv(this.vGb),this.rv.lp(this.Y2),this.rv.F$g(this.Xyi),this.rv.n7j(this.awi)):a.ULS.sendTraceTag(39403912,389,10,"RegisterEventHandlers: ParagraphNode event handlers can't be null.")}BQa(){this.rv?(this.R6a=!1,this.rv.jM(this.Sfa),this.rv.Raa(this.$vi),this.rv.Saa(this.vGb),this.rv.EX(this.Y2),this.rv.gPi(this.Xyi),this.rv.Frn(this.awi)):a.ULS.sendTraceTag(39403913,
389,10,"UnregisterEventHandlers: ParagraphNode event handlers can't be null.")}NLd(oa){oa&&this.ncd.add(oa.id,oa.ia(la.a.nj,0))}Ogj(oa){this.ncd.xb(oa.id)?(this.M8.dno(da.a.n9d,oa,this.ncd.J(oa.id)),this.ncd.remove(oa.id)):(this.M8.Swk(da.a.n9d),this.RTc&&this.RTc())}W2a(oa){const cb=U.App.xa.jb.Ic;return!!cb&&cb.Qr&&!!cb.rd&&!!cb.rd.Lc&&!!oa&&!!oa.Lc&&oa.Lc.id===cb.rd.Lc.id}run(){if(0!==this.pmc.size){var oa=[];for(let cb of this.pmc)oa.push(cb),this.Ioe.add(cb),100<=oa.length&&(this.NDh(oa),oa=
[]);0<oa.length&&this.NDh(oa);this.pmc.clear()}}NDh(oa){const cb=new qa.a(4,1,500,()=>{for(let xb of oa)this.Ioe.delete(xb),this.updateAnnotationRangeData(xb)},158);this.Hb.$b(cb)}updateAnnotationRangeData(oa){var cb=this.Ns.vYa(oa,0,Qb=>this.GVn(Qb.intent));if(0<cb.count)for(const Qb of cb){cb=this.M8.jGl(Qb.intent.id);var xb=oa.Hka;const qc=mb.ParagraphReader.qT(oa);Qb.end<Qb.begin||(xb=Hc.a.TCc(qc,xb,Qb.begin,Qb.end-Qb.begin,Qb.begin,Qb.end-Qb.begin,oa),this.JH.IRf(oa.Lc,cb,xb))}}GVn(oa){return!!oa&&
this.AD.egb(oa)&&!!oa.content}p0c(){return!this.R6a&&this.Kia.w6}}Object(e.a)(pd,"ParagraphNodeEventHandler",Zf.a,[164]);var Ub=d(976),uc=d(390),Tc=d(566),qd=d(111);class re extends Tc.a{constructor(){super();this.H_=Object.assign(new qd.a,{T_:re.getTypeName(),B_:re.getBaseTypes()})}static getTypeName(){return"AugLoop_Core_DeltaUpdateOperation"}static getBaseTypes(){return["AugLoop_Core_Operation"]}}Object(e.a)(re,"DeltaUpdateOperation",Tc.a,[]);var Je=d(436);class Jf{constructor(){this.referencedPath=
null}}Object(e.a)(Jf,"ItemReference",null,[]);class Ig extends Je.a{constructor(){super();this.op=this.deltas=this.delta=this.parentPath=null}}Object(e.a)(Ig,"ItemWithPath",Je.a,[]);var pb=d(956);class Lb extends pb.a{constructor(){super();this.prevParentPath=null;this.H_=Object.assign(new qd.a,{T_:Lb.getTypeName(),B_:Lb.getBaseTypes()})}static getTypeName(){return"AugLoop_Core_MoveOperation"}static getBaseTypes(){return["AugLoop_Core_OperationWithSiblingContext","AugLoop_Core_Operation"]}}Object(e.a)(Lb,
"MoveOperation",pb.a,[]);var Ic=d(474);class Ad extends Ic.a{constructor(){super();this.selectedRanges=null;this.H_=Object.assign(new qd.a,{T_:Ad.getTypeName(),B_:Ad.getBaseTypes()})}static getTypeName(){return"AugLoop_Text_SelectionSignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}}Object(e.a)(Ad,"SelectionSignal",Ic.a,[]);class oe extends Ad{constructor(){super();this.content=null;this.H_=Object.assign(new qd.a,{T_:oe.getTypeName(),B_:oe.getBaseTypes()})}static getTypeName(){return"AugLoop_Text_SelectionContentSignal"}static getBaseTypes(){return["AugLoop_Text_SelectionSignal",
"AugLoop_Signals_Signal"]}}Object(e.a)(oe,"SelectionContentSignal",Ad,[]);class gf{constructor(){this.range=this.tileReference=null}}Object(e.a)(gf,"TextTileRange",null,[]);var Oe=d(1618),Sg=d(437),Ng=d(145),Nh=d(40),Eg=d(19),Wh=d(291);class Bf{constructor(oa,cb,xb,Qb,qc,Mc,Gd,de){this._augLoopRuntimeManager=this.qad=null;this.iHe=!1;this.$ia=this.lxe=this.vld=null;this.W$k=()=>{if(U.App.lostSession||uc.SessionStatusManager.instance&&uc.SessionStatusManager.instance.io)v.AFrameworkApplication.Hf("a596e684;c81e6109"),
v.AFrameworkApplication.K&&v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.CloseALSession",!1)&&(augLoop.ALFactoryGlobal.getAugLoopRuntimeManager().closeSession(),a.ULS.sendTraceTag(512623445,389,10,"TileView.firePreparedEventsForOperations: Closing AL session"),this.Hb.We(this.qad));this.Ih.Pd(()=>{var Id;const Xe=Wh.a.instance.Isa;this.GA()&&this.ptk(Xe);for(this.xwc.reset();this.gTa.u4b&&!this.xwc.Hhb();){let ng;ng=this.gTa.BDk();if(!ng||!ng.graphNode){a.ULS.sendTraceTag(41719901,
389,15,"FirePreparedEventsForOperations: nodeEvent or nodeEvent.GraphNode is null.");this.xwc.update();continue}if(!this.OTn(ng)){a.ULS.sendTraceTag(41719902,389,50,"FirePreparedEventsForOperations: Node with id {0} was not processed.",ng.graphNode.id);this.xwc.update();continue}const Bh=ng.graphNode.id.toString();var hf=-1,Ef=!0;Xe&&Eg.SelectionEditor.xf(Xe)&&Bh==Xe.node.id.toString()&&(hf=Xe.cpBegin,Ef=!1);let fi=null;if(this.ktb.contains(Bh))switch(ng.MSc){case 3:this.ktb.remove(Bh);fi=3;break;
default:fi=ng.MSc}else switch(ng.MSc){case 0:case 1:this.ktb.add(Bh);fi=0;break;case 2:this.ktb.add(Bh);fi=0;break;case 3:this.ktb.remove(Bh);fi=3;break;default:fi=ng.MSc}if(null!=fi){hf=this.jgf(ng.graphNode,ng.fullPath,fi,hf,Ef);if(4==fi||5==fi){if(hf.prevParentPath.join()!==hf.parentPath.join()){Ef=Object.assign(new Ja.a,{parentPath:hf.prevParentPath,items:hf.items});const jj=Object.assign(new Ca.a,{parentPath:hf.parentPath,items:hf.items,prevId:hf.prevId,nextId:hf.nextId});this._augLoopRuntimeManager.submitOperation(Object.assign(new Sg.a,
{operation:Ef}));this._augLoopRuntimeManager.submitOperation(Object.assign(new Sg.a,{operation:jj}));ng.graphNode.type===Ng.a.table&&this.JWi(ng.graphNode,hf.parentPath).forEach(Qg=>{this._augLoopRuntimeManager.submitOperation(Object.assign(new Sg.a,{operation:Qg}))})}}else this._augLoopRuntimeManager.submitOperation(Object.assign(new Sg.a,{operation:hf}));if(this.k7c&&this.$ia&&this.$ia[0]==Bh)switch(fi){case 3:this.$ia=null;break;case 0:case 1:case 2:case 4:case 5:this.$ia[1]=null===(Id=this.Frb.EAb(ng.graphNode))||
void 0===Id?void 0:Id.HHc(ng.graphNode)}a.ULS.sendTraceTag(40776388,389,100,"FirePreparedEventsForOperations: Operation with OpType {0} submitted for tileId {1}",ha.a.getTypeNameFor(hf),Bh);switch(fi){case 0:case 4:case 5:this.Jf.gYm(ng.graphNode);break;case 3:this.Jf.hYm(ng.graphNode,hf.parentPath.join("\\"))}}this.xwc.update()}(Id=this.gTa.CDk())&&this.IQi(Id)},"TV:FPEFO")};this.una=(Id,Xe)=>{var hf;if(Xe.ll&&Xe.ll.length){if(this.k7c)if(Id=Rb.a.OAl(Xe.ll),!Id)this.$ia=null;else if(!this.$ia||this.$ia[0]!=
Id.id.toString()){const Ef=this.gTa.Ccm(Id)?null:null===(hf=this.Frb.EAb(Id))||void 0===hf?void 0:hf.HHc(Id);this.$ia=[Id.id.toString(),Ef]}this.iHe&&(this.Ygi()?this.gTa.Cin(Xe.ll.kb):this.c0i(!1))}};this.Oa=oa;this.gTa=cb;this.Hb=xb;this.xwc=Qb;this.Bwj=this.Oa.$("AugLoopOperationsAreEnabled");this.ktb=new pa.a(Ra.a.Rj());this.Jf=qc;this.Ih=Mc;this.Frb=Gd;this.ib=de;this.PD=new P.a(()=>U.App.xa.jb.Yc.zd);this.k7c=this.Oa.getBooleanFeatureGate("Microsoft.Office.WordOnline.AutoreplaceIsEnabled",!1);
this.ib.oB(this.una);Rb.a.En().then(()=>{this._augLoopRuntimeManager=augLoop.ALFactoryGlobal.getAugLoopRuntimeManager();v.AFrameworkApplication.Hl("Microsoft.Office.Web.SessionSettings.IWacBox4AugLoopTimeBasedYieldTraversalSettings");this.Oa.$("AugLoopAnnotationsIsEnabled")&&this._augLoopRuntimeManager.setAnnotationResultCallback(Object.assign(new Oe.a,{handler:Id=>{this.Jf.Zak(Id)}}));this.Bwj&&this.gTa.y1n();this.n2n()}).catch(()=>{})}ptk(oa){const cb=[],xb=this.Jf.rPb.entries();for(let Qb=0;Qb<
this.Jf.rPb.size;Qb++){const qc=xb.next();(2E3<=Date.now()-qc.value[1]||oa.node.id!=qc.value[0])&&cb.push(qc.value[0])}cb.forEach(Qb=>{this.Jf.rPb.delete(Qb);(Qb=Rb.a.UIc(this.PD.value,Qb))?this.Uao(Qb):a.ULS.sendTraceTag(520734497,389,50,"checkAndTriggerProofingForDelayedNodes: Stale node.")})}OTn(oa){return 3===oa.MSc||Rb.a.U3i(oa.graphNode)}n2n(){!this.qad&&this.gTa.w6&&(this.qad=new qa.a(4,2,this.Oa.rc("NodeEventsFiringInterval",500),this.W$k,131),this.Hb.$b(this.qad))}JWi(oa,cb){var xb,Qb=[];
const qc=le.GraphIterator.$a(oa),Mc=qc.Jp();for(var Gd=0;Gd<Mc;Gd++){let de=qc.uI(Gd);de.type===Ng.a.outlineElement&&(de=Nh.OutlineElementNavigator.De(qc));const Id=de.id.toString(),Xe=null===(xb=this.Frb.EAb(de))||void 0===xb?void 0:xb.dxb(de);Qb.push(Object.assign(new Je.a,{body:Xe,id:Id,revId:Rb.a.Jif(de)}));qc.kd(oa.type)}cb.push(oa.id.toString());xb=[];xb.push(Object.assign(new Ca.a,{parentPath:cb.slice(),items:Qb,prevId:null}));for(Qb=0;Qb<Mc;Qb++)Gd=qc.uI(Qb),Gd.type===Ng.a.outlineElement&&
(Gd=Nh.OutlineElementNavigator.De(qc)),0<qc.Jp()&&(xb=xb.concat(this.JWi(Gd,cb))),qc.kd(oa.type);cb.pop();return xb}ELa(oa){return oa.split("\\").slice(0,-1)}jgf(oa,cb,xb,Qb=-1,qc=!0){var Mc;let Gd=null,de=null;const Id=oa.id.toString();var Xe=null;3!==xb&&(Xe=Rb.a.Dnk(oa));if(Xe)for(let hf=0;hf<Xe.length;hf++)if(Xe[hf]===Id){de=hf+1<Xe.length?Xe[hf+1]:null;Gd=hf?Xe[hf-1]:null;break}Xe=null===(Mc=this.Frb.EAb(oa))||void 0===Mc?void 0:Mc.dxb(oa,Qb,qc);Qb=[Object.assign(new Je.a,{body:Xe,id:Id,revId:Rb.a.Jif(oa)})];
switch(xb){case 0:case 1:return Object.assign(new Ca.a,{parentPath:this.ELa(cb),items:Qb,prevId:Gd,nextId:de});case 4:return Object.assign(new Lb,{parentPath:this.ELa(Rb.a.aK(oa)),prevParentPath:this.ELa(cb),items:Qb,prevId:Gd,nextId:de});case 5:return xb=this.gTa.bil(Id),Object.assign(new Lb,{parentPath:this.ELa(null!==xb&&void 0!==xb?xb:Rb.a.aK(oa)),prevParentPath:this.ELa(cb),items:Qb,prevId:Gd,nextId:de});case 2:return Object.assign(new bb.a,{parentPath:this.ELa(cb),items:Qb});case 3:return Object.assign(new Ja.a,
{parentPath:this.ELa(cb),items:Qb});default:return a.ULS.sendTraceTag(42084322,389,15,"Submitted unknown operation for NodeEventKind ${0}, tileId {1}",xb,Id),Object.assign(new pb.a,{parentPath:this.ELa(cb),items:Qb,prevId:Gd,nextId:de})}}gNl(oa){return this.$ia&&this.$ia[0]===oa?this.$ia[1]:null}dGn(oa){var cb;if(!this.k7c)return a.ULS.sendTraceTag(545552581,389,10,"sendTile: autoreplace is not enabled"),!1;if(!Rb.a.U3i(oa))return!1;const xb=oa.id.toString();var Qb=this.ktb.contains(xb)?2:0;Qb=this.jgf(oa,
Rb.a.aK(oa),Qb);this._augLoopRuntimeManager.submitOperation(Object.assign(new Sg.a,{operation:Qb}));this.ktb.add(xb);this.$ia=[xb,null===(cb=this.Frb.EAb(oa))||void 0===cb?void 0:cb.HHc(oa)];return!0}$En(oa,cb){var xb;if(this.k7c){var Qb=oa.id.toString(),qc=this.ELa(Rb.a.aK(oa));cb=[Object.assign(new Ig,{id:Qb,revId:Rb.a.Jif(oa),parentPath:qc,delta:cb})];qc=Object.assign(new re,{parentPath:qc,items:cb});this._augLoopRuntimeManager.submitOperation(Object.assign(new Sg.a,{gDo:qc}));a.ULS.sendTraceTag(545552583,
389,50,"sendDeltaOperation: tileId {0}",Qb);this.$ia=[Qb,null===(xb=this.Frb.EAb(oa))||void 0===xb?void 0:xb.HHc(oa)]}else a.ULS.sendTraceTag(545552582,389,10,"sendDeltaOperation: autoreplace is not enabled")}Xek(oa,cb){if(oa.tileReference.referencedPath.length!==cb.tileReference.referencedPath.length||oa.range.start!==cb.range.start||oa.range.length!==cb.range.length)return!1;for(let xb=0;xb<oa.tileReference.referencedPath.length;xb++)if(oa.tileReference.referencedPath[xb]!==cb.tileReference.referencedPath[xb])return!1;
return!0}Tek(oa,cb){if(oa.selectedRanges.length!==cb.selectedRanges.length||oa.content!==cb.content)return!1;for(let xb=0;xb<oa.selectedRanges.length;xb++)if(!this.Xek(oa.selectedRanges[xb],cb.selectedRanges[xb]))return!1;return!0}IQi(oa){var cb;if(oa){var xb=new Sa.a,Qb="";for(let Gd=0;Gd<oa.length;Gd++){var qc=oa.J(Gd),Mc=(null===(cb=this.Frb.EAb(qc.node))||void 0===cb?void 0:cb.dxb(qc.node)).content;Qb+=Mc;Mc=qc.cpBegin<Mc.length?qc.cpBegin:-1;Mc=Object.assign(new va.a,{start:Mc,length:qc.cpEnd-
qc.cpBegin});const de=qc.node.id.toString();qc=this.ELa(Rb.a.aK(qc.node));qc.push(de);xb.add(Object.assign(new gf,{range:Mc,tileReference:Object.assign(new Jf,{referencedPath:qc})}))}oa=Object.assign(new oe,{selectedRanges:xb.toArray(),content:Qb});this.lxe&&this.Tek(oa,this.lxe)||(cb=this.vld?this.vld:ka.a.create().toString(),xb=[Object.assign(new Je.a,{body:oa,id:cb})],this.vld?cb=Object.assign(new bb.a,{parentPath:["session","doc"],items:xb}):(this.vld=cb,cb=Object.assign(new Ca.a,{parentPath:["session",
"doc"],items:xb})),this._augLoopRuntimeManager.submitOperation(Object.assign(new Sg.a,{operation:cb})),this.lxe=oa)}}JOn(oa){this.Ygi()&&this.c0i(oa)}c0i(oa){(this.iHe=oa)?this.IQi(this.ib.hb.kb):this.gTa.Zwk()}Ygi(){return this.Oa.getBooleanFeatureGate("Microsoft.Office.WordOnline.EnableSendSelectionSignalToAugloop",!1)}Uao(oa){oa=this.jgf(oa,Rb.a.aK(oa),2);this._augLoopRuntimeManager.submitOperation(Object.assign(new Sg.a,{operation:oa}))}GA(){return!!v.AFrameworkApplication.K&&v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ProofingALV2Migration",
!1)}}Object(e.a)(Bf,"TileView",null,[166]);var vf=d(47),Fj=d(1748),Pe;(function(oa){oa[oa.none=0]="none";oa[oa.firstRow=32]="firstRow";oa[oa.lastRow=64]="lastRow";oa[oa.firstCol=128]="firstCol";oa[oa.lastCol=256]="lastCol";oa[oa.noHBand=512]="noHBand";oa[oa.noVBand=1024]="noVBand";oa[oa.nwCell=160]="nwCell";oa[oa.neCell=288]="neCell";oa[oa.swCell=192]="swCell";oa[oa.seCell=320]="seCell";oa[oa.defaultLook=1184]="defaultLook"})(Pe||(Pe={}));Object(e.b)("TableLookFlags",Pe);class sf{dxb(oa){if(oa)switch(oa.type){case 14:return this.XNk(oa);
case 15:return new Fj.TableRow;case 16:return this.WNk(oa)}else a.ULS.sendTraceTag(524149331,389,10,"ConvertNodeToTile: Node can't be null.")}XNk(oa){var cb=oa.Kx||[];let xb=0;for(let Qb=0;Qb<cb.length;Qb++)xb+=cb[Qb];cb=cb.map((Qb,qc)=>({columnId:qc.toString(),widthPercent:0!=xb?100*Qb/xb:0}));return new Fj.WordTable({columnDefs:cb,tableLook:oa.properties.ia(la.a.tableLook,Pe.defaultLook),complexTable:oa.properties.ia(la.a.complexTable,!1),floatingTable:oa.properties.ia(la.a.Tci,!1)})}WNk(oa){return new Fj.TableCell({rowspan:oa.properties.ia(la.a.rowSpan,
1),colspan:oa.properties.ia(la.a.colSpan,1),borderInfo:{topBorder:{color:oa.properties.ia(la.a.C3a,0),size:oa.properties.ia(la.a.ulb,4),style:oa.properties.ia(la.a.eQa,"single")},leftBorder:{color:oa.properties.ia(la.a.A3a,0),size:oa.properties.ia(la.a.slb,4),style:oa.properties.ia(la.a.cQa,"single")},rightBorder:{color:oa.properties.ia(la.a.B3a,0),size:oa.properties.ia(la.a.tlb,4),style:oa.properties.ia(la.a.dQa,"single")},bottomBorder:{color:oa.properties.ia(la.a.z3a,0),size:oa.properties.ia(la.a.rlb,
4),style:oa.properties.ia(la.a.bQa,"single")}},verticalAlignment:oa.properties.ia(la.a.cha,Fj.TableCellVerticalAlignment.Top),ghostCell:oa.properties.ia(la.a.ghostCell,!1),renderCell:oa.properties.ia(la.a.renderCell,!1),skippedCell:oa.properties.ia(la.a.skippedCell,!1),fillColor:oa.properties.ia(Fc.a.ZH,0),verticalMerge:oa.properties.ia(vf.a.vMerge,null)})}HHc(oa){return null===oa||void 0===oa?void 0:oa.properties}}Object(e.a)(sf,"TableElementNodeToTileConverter",null,[163]);class Xf{constructor(oa,
cb,xb){this.Lp=cb;this.Rva=xb;this.tBd=!1;this.Kmc=null;this.HAi=(Qb,qc)=>{this.hva(qc.node,0)};this.DAi=(Qb,qc)=>{Qb=qc.node;this.Rva.fJb(Qb.id.toString(),Rb.a.aK(Qb))};this.IAi=(Qb,qc)=>{this.hva(qc.node,3)};this.FYd=(Qb,qc)=>{this.hva(qc.node,2)};this.KAi=(Qb,qc)=>{this.hva(qc.node,0)};this.LAi=(Qb,qc)=>{this.hva(qc.node,3)};this.JAi=(Qb,qc)=>{Qb=qc.node;this.Rva.fJb(Qb.id.toString(),Rb.a.aK(Qb))};this.GYd=(Qb,qc)=>{this.hva(qc.node,2)};this.FAi=(Qb,qc)=>{this.hva(qc.node,0)};this.EAi=(Qb,qc)=>
{Qb=qc.node;this.Rva.fJb(Qb.id.toString(),Rb.a.aK(Qb))};this.GAi=(Qb,qc)=>{this.hva(qc.node,3)};this.DYd=(Qb,qc)=>{var Mc;Qb=qc.node;if(qc.property===la.a.ghostCell){if(qc=Qb.qg?Qb:null===(Mc=Qb.pua)||void 0===Mc?void 0:Mc.controlCell){Mc=le.GraphIterator.$a(qc);var Gd=Mc.Jp();for(var de=0;de<Gd;de++){Mc.uI(de);var Id=Nh.OutlineElementNavigator.De(Mc);this.Rva.fJb(Id.id.toString(),String.format("{0}\\{1}",Rb.a.aK(qc),Id.id));this.hva(Id,4);Mc.kd(16)}}}else if(qc.property===Fc.a.qf){qc=le.GraphIterator.$a(Qb);
Mc=qc.Jp();let Xe=null;Gd=[];for(de=0;de<Mc;de++){qc.uI(de);Id=Nh.OutlineElementNavigator.De(qc);this.Rva.SBn(Id.id.toString(),String.format("{0}\\{1}",Rb.a.aK(Qb),Id.id));if(14!==Id.type){if(Xe=Rb.a.aK(Id))this.Rva.fJb(Id.id.toString(),Xe),this.hva(Id,5)}else Gd.push(Id);qc.kd(16)}Xe&&Gd.forEach(hf=>{this.Rva.fJb(hf.id.toString(),String.format("{0}\\{1}",Xe.split("\\").slice(0,-1).join("\\"),hf.id));this.hva(hf,5)})}this.hva(Qb,2)};this.ZDf=()=>{this.p0c()?this.jU():this.tBd&&!this.Rva.w6&&this.BQa()};
this.TNb=oa.$("AugLoopOperationsAreEnabled")}get RTc(){return this.Kmc}init(){this.p0c()&&this.jU();this.Rva.Y9g(this.ZDf)}jU(){const {v$i:oa,gae:cb,i$i:xb}=this.lQh();if(oa&&cb&&xb){this.tBd=!0;var Qb=this.DAi,qc=this.IAi,Mc=this.FYd;oa.ys(this.HAi);oa.WV(Qb);oa.zv(qc);oa.lp(Mc);Qb=this.JAi;qc=this.LAi;Mc=this.GYd;cb.ys(this.KAi);cb.WV(Qb);cb.zv(qc);cb.lp(Mc);Qb=this.EAi;qc=this.GAi;Mc=this.DYd;xb.ys(this.FAi);xb.WV(Qb);xb.zv(qc);xb.lp(Mc)}else a.ULS.sendTraceTag(524149329,389,10,"RegisterEventHandlers: TableNode event handlers can't be null.")}BQa(){const {v$i:oa,
gae:cb,i$i:xb}=this.lQh();if(oa&&cb&&xb){this.tBd=!1;var Qb=this.DAi,qc=this.IAi,Mc=this.FYd;oa.jM(this.HAi);oa.Raa(Qb);oa.Saa(qc);oa.EX(Mc);Qb=this.JAi;qc=this.LAi;Mc=this.GYd;cb.jM(this.KAi);cb.Raa(Qb);cb.Saa(qc);cb.EX(Mc);Qb=this.EAi;qc=this.GAi;Mc=this.DYd;xb.jM(this.FAi);xb.Raa(Qb);xb.Saa(qc);xb.EX(Mc)}else a.ULS.sendTraceTag(524149330,389,10,"UnregisterEventHandlers: TableNode event handlers can't be null.")}hva(oa,cb){oa&&this.W2a(oa)&&this.Rva.w6&&this.TNb&&this.Rva.T2d(oa,cb)}lQh(){return{v$i:this.Lp.Se(14),
gae:this.Lp.Se(15),i$i:this.Lp.Se(16)}}W2a(oa){const cb=U.App.xa.jb.Ic;return!!cb&&cb.Qr&&!!cb.rd&&!!cb.rd.Lc&&!!oa&&!!oa.Lc&&oa.Lc.id===cb.rd.Lc.id}p0c(){return!this.tBd&&!!this.Rva.w6}}Object(e.a)(Xf,"TableNodeEventHandler",null,[164]);class Se{constructor(oa,cb){this.pDi=oa;this.O5n=cb}EAb(oa){return oa?14===oa.type||15===oa.type||16===oa.type?this.O5n:12===oa.type?this.pDi:null:null}}Object(e.a)(Se,"NodeToTileConverterHolder",null,[162]);var $f=d(391);class Jg{get name(){return"Box4.AugmentationLoop"}yc(oa){this.W=
oa;const cb=this.W.resolve("Common.IAppSettingsManager"),xb=cb.$("AugLoopTaskUseTimeBasedYieldStrategy"),Qb=new Ed,qc=xb?new Y.a(cb.rc("AugLoopTaskAllowedRunTimeBeforeYielding",10),G.a.lf):new X(cb.rc("AugLoopTaskNodesToRunBeforeYielding",10));this.W.ha("Common.ICpuMeter",()=>J.a.instance).singleInstance();this.W.ha("Box4.AugmentationLoop.AugmentationLoopStateManager",()=>new jb).as("Box4.AugmentationLoop.IAugmentationLoopStateManager").singleInstance();this.W.ha("Box4.AugmentationLoop.ParagraphNodeEventHandler",
()=>new pd(cb,U.App.Xj.al.Se(12),Qb,this.W.resolve("Box4.AugmentationLoop.IAugmentationLoopStateManager"),this.W.resolve("Box4.AugmentationLoop.IAnnotationStorage"),this.W.resolve("Box4.AugmentationLoop.IPersistedAnnotationStorage"),this.W.resolve("Box4.AugmentationLoop.IAnnotationPolicies"),v.AFrameworkApplication.uc,this.W.resolve("Box4.Intent.IIntentRangeEditor"),this.W.resolve("Box4.IIntelligenceEditor"),this.W.resolve("Box4.Graph.IGraphTransactionManager"))).as("Box4.AugmentationLoop.INodeEventHandler<Box4.AParagraphNode>").singleInstance();
Rb.a.b8d()&&this.W.ha("Box4.AugmentationLoop.TableNodeEventHandler",()=>new Xf(cb,U.App.Xj.al,Qb)).singleInstance();this.W.ha("Common.App.AugmentationLoop.SDX.SdxPaneSuppressionManager",()=>new E).singleInstance();this.W.ha("Box4.AugmentationLoop.IFormattingExtractor",()=>new xe(this.W.resolve("Common.IAppSettingsManager"),this.W.Pa("Box4.IFeatureHelper"),this.W.resolve("Box4.List.IListReader"),this.W.resolve("Box4.IParagraphIndentationReader"),this.W.resolve("Box4.Styles.IWACStyleReader"))).singleInstance();
this.W.ha("Box4.AugmentationLoop.IAnnotationPolicies",()=>new da.a(new P.a(()=>U.App.xa.jb.Yc.zd),this.W.resolve("Box4.Intent.IIntentRangeEditor"))).singleInstance();this.W.ha("Box4.AugmentationLoop.IPersistedAnnotationStorage",()=>new fb(this.W.resolve("Common.ICpuMeter"),this.W.resolve("Box4.IIntelligenceReader"),this.W.resolve("Box4.IIntelligenceEditor"),this.W.resolve("Box4.AugmentationLoop.IAnnotationPolicies"),new P.a(()=>U.App.xa.jb.Yc.zd),oa.resolve("Box4.IFeatureHelper"))).singleInstance();
const Mc=this.W.resolve("IRoamingDictionary");this.W.ha("Box4.AugmentationLoop.IAnnotationStorage",()=>new wb(this.W.resolve("Common.IAppSettingsManager"),this.W.resolve("Common.ICpuMeter"),this.W.resolve("Box4.Intent.IIntentRangeEditor"),new P.a(()=>U.App.xa.jb.Yc.zd),v.AFrameworkApplication.uc,this.W.Pa("Box4.IIntelligenceReader"),this.W.Pa("Box4.IIntelligenceEditor"),this.W.Pa("Box4.AugmentationLoop.IAnnotationPolicies"),this.W.Pa("Box4.AugmentationLoop.IPersistedAnnotationStorage"),oa.resolve("Box4.IFeatureHelper"),
$f.a.instance,()=>{try{return augLoop.ALFactoryGlobal.getAugLoopRuntimeManager()}catch(Gd){return a.ULS.sendTraceTag(50935320,389,10,"Unable to GetAugLoopRuntimeManager, most likely due to al bundle not being loaded: {0}",Gd),null}},Mc)).singleInstance();this.W.ha("Box4.AugmentationLoop.INodeToTileConverterHolder",()=>new Se(new Ub.a(this.W.resolve("Box4.AugmentationLoop.IFormattingExtractor")),new sf)).singleInstance();this.W.ha("Box4.AugmentationLoop.TileView<AugLoop.Deprecated.Tiling.TextTile,Box4.AViewableGraphNode>",
()=>new Bf(cb,Qb,v.AFrameworkApplication.uc,qc,this.W.resolve("Box4.AugmentationLoop.IAnnotationStorage"),this.W.resolve("Common.ICpuMeter"),this.W.resolve("Box4.AugmentationLoop.INodeToTileConverterHolder"),this.W.resolve("Box4.ISelectionManager"))).singleInstance();a.ULS.sendTraceTag(39966347,389,50,"TileView<TextTile, AParagraphNode> registered.");this.W.ha("Box4.AugmentationLoop.IUtilsWrapper",()=>new Kb).singleInstance();this.W.ha("Box4.AugmentationLoop.IAlFactoryWrapper",()=>new lb).singleInstance()}init(){if(v.AFrameworkApplication.K&&
v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.CloseALSession",!1)&&v.AFrameworkApplication.ZY.BootFailed)a.ULS.sendTraceTag(512624089,389,10,"Cannot initialize Box4 Augmentation Loop package: Boot Failure");else if(v.AFrameworkApplication.K.$("AugLoopOperationsAreEnabled")){a.ULS.sendTraceTag(35190237,389,50,"Initializing Box4 Augmentation Loop package.");const oa=new nb(this.W.resolve("Common.IAppSettingsManager"),v.AFrameworkApplication.Xe,U.App.jha,this.W.resolve("Box4.AugmentationLoop.IAugmentationLoopStateManager"),
T.a.instance,this.W.resolve("Box4.AugmentationLoop.IAnnotationStorage")),cb=new ca;this.W.register(132,"Box4.AugmentationLoop.IAlSessionLifeEventNotifier").singleInstance().Boo(()=>cb);v.AFrameworkApplication.Hf("b8afb343;bjdjj400");const xb=Rb.a.osm(this.W.resolve("Common.IDynamicScriptLoaderProvider").JE,this.W.resolve("Common.App.OAuth.IOAuthManager"),oa,this.W.resolve("Common.ISharedDependencyLoader"),cb);this.W.ha("Box4.AugmentationLoop.RuntimeManagerInitializationTracker",()=>new Gb(xb)).singleInstance();
this.W.resolve("Box4.AugmentationLoop.ParagraphNodeEventHandler").init();Rb.a.b8d()&&this.W.resolve("Box4.AugmentationLoop.TableNodeEventHandler").init();this.W.resolve("Box4.IIntelligenceReader").init();this.W.resolve("Box4.AugmentationLoop.TileView<AugLoop.Deprecated.Tiling.TextTile,Box4.AViewableGraphNode>")}}dispose(){}static main(oa){y.a.instance.Oc(new Jg,0,oa);a.ULS.sendTraceTag(35190238,389,50,"Box4 Augmentation Loop package registered.")}}Object(e.a)(Jg,"Box4AugmentationLoopPackage",null,
[1,2]);var fg=d(619),Lg=d(49),Af=d(14),Jh=d(446),Vi=d(1117);class Ze{constructor(oa,cb,xb,Qb=null,qc=null,Mc=null){this.ES=new Vi.a(cb,Qb,qc,Mc);this.Ob=oa;this.Pc=xb}get type(){return this.ES.type}get id(){return this.ES.id}get intent(){return this.ES.intent}Yf(oa){return new Ze(oa,this.type,this.Pc,this.id,this.intent,this.ES.Eua)}toString(){return String.format("Core = [{0}], IsStart = {1}",this.ES,this.Pc)}}Object(e.a)(Ze,"IntentObject",null,[87]);var sd=d(508),fh=d(151),vh=d(229);class am{constructor(){this.ync=
new fh.a}Iqd(oa,cb,xb,Qb,qc=null,Mc=null,Gd=null){oa=oa.Z9(cb,oa.qa.xbo(cb));oa.pk||(oa.pk=new sd.a(oa));oa.pk.add(new Ze(oa,xb,Qb,qc,Mc,Gd));oa.isFromErrorRangeSplit=!0}MNi(oa){return oa.Ob&&oa.Ob.pk&&oa.Ob.pk.ZXc(cb=>cb===oa,[oa.type])?!0:!1}Rpn(oa,cb){if(oa.type===cb.type&&oa.Pc&&!cb.Pc&&oa.Ob&&oa.Ob.pk&&oa.Ob.pk.contains(oa)&&cb.Ob&&cb.Ob.pk&&cb.Ob.pk.contains(cb)){var xb=[oa.type];oa.Ob.pk.ZXc(Qb=>Qb===oa,xb);cb.Ob.pk.ZXc(Qb=>Qb===cb,xb)}}rpo(oa,cb,xb){if(!cb)return!1;xb=new Ua.a([xb]);for(let Qb=
0;Qb<oa.length;Qb++){const qc=oa.J(Qb);if(!qc.pk)continue;let Mc=!0;xb.q4a(qc.pk,void 0,Gd=>{Gd.id&&cb.equals(Gd.id)&&(Mc=!1)});if(!Mc)return!1}return!0}y7m(oa,cb,xb,Qb){let qc=null,Mc=null;cb=new Ua.a([cb]);const Gd=oa.qa;for(let de=0;de<Gd.length;de++){const Id=Gd.J(de);if(!Id.pk)continue;let Xe=!0;cb.q4a(Id.pk,void 0,(hf,Ef)=>{if(Ef){var ng=Ef.Ob.cp<xb,Bh=hf.Ob.cp>Qb;ng&&hf.Ob.cp<=xb||Ef.Ob.cp>=Qb&&Bh||(ng&&Bh?Xe=!1:ng?qc=hf:Bh?Mc=Ef:this.Rpn(Ef,hf))}});if(!Xe)return!1}if(qc){if(!this.MNi(qc))return!1;
this.Iqd(oa,xb,qc.type,qc.Pc,qc.id,qc.intent,qc.ES.Eua)}if(Mc){if(!this.MNi(Mc))return!1;this.Iqd(oa,Qb,Mc.type,Mc.Pc,Mc.id,Mc.intent,Mc.ES.Eua)}return!0}x_f(oa){let cb;return v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.TestBox4Ops",!1)?!1:({value:cb}=this.ync.Dc(oa.type,cb)).returnValue?cb.x_f(oa):!0}OEm(oa,cb){if(this.x_f(cb)){var xb=cb.id,Qb=cb.type,qc=cb.begin,Mc=cb.end;if(({cpEnd:Mc}=am.ukj(oa,qc,Mc)).returnValue){if(Jh.a(Qb)){if(!this.rpo(oa.qa,xb,Qb))return}else if(!this.y7m(oa,
Qb,qc,Mc))return;this.Iqd(oa,qc,Qb,!0,xb,cb.intent,cb.ES.Eua);this.Iqd(oa,Mc,Qb,!1,xb,cb.intent,cb.ES.Eua)}}}B_d(oa,cb){U.App.xa.V6e(oa,()=>{const xb=new Lg.GraphTransaction(2);try{xb.Db(oa);const Qb=oa.QX();try{const qc=oa.nZ();try{cb()}finally{qc&&qc.dispose()}}finally{Qb&&Qb.dispose()}}finally{xb&&xb.dispose()}})}o9b(oa,cb){this.B_d(oa,()=>{this.OEm(oa,cb)})}QEm(oa,cb){if(cb.count){var xb=new Fa.a,Qb=new vh.a;for(var qc of cb){var Mc=qc.value;Jh.a(qc.key)||Mc.Sc((de,Id)=>de.begin!==Id.begin?de.begin-
Id.begin:de.end-Id.end);if(am.vpo(Mc))for(var Gd of Mc)Mc=Gd.end,({cpEnd:Mc}=am.ukj(oa,Gd.begin,Mc)).returnValue&&(Mc=Mc!==Gd.end?new zb.a(Gd.type,Gd.begin,Mc,Gd.id,Gd.intent,Gd.ES.Eua):Gd,xb.add(Mc.begin),xb.add(Mc.end),am.g3j(Qb,Mc))}oa.SAd(xb);oa=oa.qa;for(xb=0;xb<oa.length;xb++){qc=oa.J(xb);if(Gd=qc.pk)for(const Id of cb.keys)Gd.FOi(Id);let de;({value:de}=Qb.Dc(qc.cp,de)).returnValue||(de=null);if(de){Gd||(Gd=qc.pk=new sd.a(qc));for(const Id of de)Gd.add(Id.Yf(qc))}qc.isFromErrorRangeSplit=!0}}}gzf(oa,
cb){const xb=new fh.a;for(const Qb of cb){let qc;({value:qc}=xb.Dc(Qb.type,qc)).returnValue||(qc=new Sa.a,xb.Z(Qb.type,qc));qc.add(Qb)}this.B_d(oa,()=>{this.QEm(oa,xb)})}Heo(oa,cb){oa=oa.qa;for(let xb=0;xb<oa.length;xb++){const Qb=oa.J(xb);Qb.pk&&Qb.pk.FOi(cb)}}ihc(oa,cb){this.B_d(oa,()=>{this.Heo(oa,cb)})}Feo(oa,cb,xb){let Qb=!1;cb=cb.qa;xb=[xb];for(let qc=0;qc<cb.length;qc++){const Mc=cb.J(qc);Mc.pk&&(Qb=Mc.pk.ZXc(oa,xb)||Qb)}return Qb}A7f(oa,cb,xb){let Qb=!1;this.B_d(cb,()=>{Qb=this.Feo(oa,cb,
xb)});return Qb}RSh(oa,cb,xb,Qb){return!oa||0>xb||Qb>oa.characterData.length||xb>Qb?new Sa.a:this.vYa(oa,cb,qc=>Math.max(qc.begin,xb)<=Math.min(qc.end,Qb))}vYa(oa,cb,xb){return am.iwl(oa,cb,xb)}static iwl(oa,cb,xb){const Qb=new Sa.a;oa=oa.qa;cb=new Ua.a([cb]);if(!oa)return Qb;for(let qc=0;qc<oa.length;qc++){const Mc=oa.J(qc);Mc.pk&&cb.q4a(Mc.pk,void 0,(Gd,de)=>{de&&(Gd=new zb.a(de.type,de.Ob.cp,Gd.Ob.cp,de.id,de.intent,de.ES.Eua),xb(Gd)&&Qb.add(Gd))})}return Qb}DIc(oa,cb){const xb=new Sa.a;if(!am.Pmm(oa.contextId))return xb;
let Qb;const qc=oa.node;oa.contextId!==Af.a.paragraph?(Qb=oa.cpBegin,oa=oa.cpEnd):(Qb=0,oa=qc.characterData.length);xb.addRange(this.RSh(qc,cb,Qb,oa));return xb}Sln(oa){this.ync.xb(0)||this.ync.Z(0,oa)}static ukj(oa,cb,xb){oa=mb.ParagraphReader.textLength(oa);if(cb>=oa)return{returnValue:!1,cpEnd:xb};xb>oa&&(xb=oa);return{returnValue:!0,cpEnd:xb}}static vpo(oa){if(!oa.count)return!0;const cb=new fg.a,xb=oa.J(0).type,Qb=Jh.a(xb);let qc=-1;for(const Mc of oa){if(Mc.type!==xb||(Jh.c(Mc.type)?Mc.begin>
Mc.end:Mc.begin>=Mc.end))return!1;if(Qb){oa=Mc.id;if(!oa||oa.equals(ka.a.nil)||cb.contains(oa))return!1;cb.add(oa)}else if(-1===qc)qc=Mc.end;else if(qc>Mc.begin)return!1}return!0}static g3j(oa,cb){let xb;({value:xb}=oa.Dc(cb.begin,xb)).returnValue||(xb=new Sa.a,oa.Z(cb.begin,xb));xb.add(new Ze(null,cb.type,!0,cb.id,cb.intent,cb.ES.Eua));({value:xb}=oa.Dc(cb.end,xb)).returnValue||(xb=new Sa.a,oa.Z(cb.end,xb));xb.add(new Ze(null,cb.type,!1,cb.id,cb.intent,cb.ES.Eua))}static Pmm(oa){return oa===Af.a.Gd||
oa===Af.a.Wc||oa===Af.a.paragraph}}Object(e.a)(am,"IntentRangeEditor",null,[159]);class aj{constructor(){this.W=null}get name(){return"Box4.Intent"}yc(oa){this.W=oa;this.W.ha("Box4.Intent.IntentRangeEditor",()=>new am).as("Box4.Intent.IIntentRangeEditor").singleInstance()}init(){this.W.resolve("Box4.IProofingManager")}dispose(){}static main(oa){y.a.instance.Oc(new aj,0,oa)}}Object(e.a)(aj,"PackageManager",null,[1,2]);var nk=d(988),sk=d(120),De=d(1391);class Ai{constructor(oa){this.iDm=oa;this.eDm=
[]}get handler(){return this.iDm}get Oka(){return this.eDm}}Object(e.a)(Ai,"RegisteredListener",null,[]);class Mk{constructor(oa,cb){this.type=0;this.payload=null;this.type=oa;this.payload=cb}}Object(e.a)(Mk,"OfficeSharedCommentsEvent",null,[837]);class pl{constructor(){this.eventType=0;this.newViewContainer=null;this.viewContainerVisibilityState=1}}Object(e.a)(pl,"ViewContainerEvent",null,[837]);var Og=d(579);class Rk{constructor(oa){this.Dyf=!1;this.Gma=new Sa.a;this.cUd=oa}rln(oa){oa=new Ai(oa);
this.Gma.add(oa)}kfj(oa){for(let cb=0;cb<this.Gma.count;++cb)if(this.Gma.J(cb).handler===oa){this.Gma.removeAt(cb);break}}lPa(oa=!1){const cb=()=>{if(v.AFrameworkApplication.Mk)a.ULS.sendTraceTag(40420181,201,50,"Skipped processing comment pane events since app is shutting down.");else for(let qc=0;qc<this.Gma.count;++qc){const Mc=this.Gma.J(qc);for(;0<Mc.Oka.length;){var xb=Array.dequeue(Mc.Oka);if(Object(sk.a)(pl,xb)){var Qb=Mc.handler;Qb(xb)}else Object(sk.a)(Mk,xb)&&(Qb=Mc.handler,Qb(xb.type,
xb.payload))}}};oa?cb():this.Dyf||(this.Dyf=!0,Og.a.n1(this.cUd,()=>{cb();this.Dyf=!1},De.a.Vbl))}}Object(e.a)(Rk,"GenericEventHost",null,[]);class xf{constructor(){this.numberOfThreads=this.numberOfComments=0;this.contextDetails=this.changes=this.commentId=this.comment=this.comments=null;this.virtualized=!1;this.index=0;this.tempId=this.threadIds=null;this.errorType=0;this.tasks=null;this.richTextCapabilityFlags=this.modelCapabilityFlags=0;this.rehydrationDrafts=this.contextDrafts=this.smartReplies=
null}}Object(e.a)(xf,"BasicEventPayload",null,[872]);class Ql{constructor(oa){this.nextPopulatedContextDetails=0;this.commentThreadCounts=null;this.isReadOnly=!1;this.isReadOnly=oa}}Object(e.a)(Ql,"CommentContextDetails",null,[]);class yd{constructor(){this.numberOfThreads=this.numberOfComments=0;this.contextDetails=null;this.selectedThreadIndex=0;this.virtualized=!1;this.rehydrationDrafts=this.contextDrafts=null}}Object(e.a)(yd,"ContextChangeWithSelectedThreadIndex",null,[872]);class Zk{constructor(){this.tasks=
this.comments=null}}Object(e.a)(Zk,"LoadCommentsNoVirtualization",null,[872]);class Kl extends Rk{constructor(oa){super(oa);this.UYg=0}ZNn(oa){this.UYg=oa}$ln(oa,cb,xb,Qb,qc,Mc){oa=new Ai(oa);Mc&&Array.enqueue(oa.Oka,this.iIk(Mc,this.UYg));Mc=cb?cb.length:0;Array.enqueue(oa.Oka,this.lth(Mc,xb,Qb,0));Mc&&Array.enqueue(oa.Oka,this.guh(cb,qc));this.Gma.add(oa);this.lPa()}khc(oa){this.kfj(oa)}WEn(oa,cb,xb,Qb=0){this.nCb(this.lth(oa,cb,xb,Qb));this.lPa()}XEn(oa,cb,xb){this.nCb(this.IIk(oa,cb,xb));this.lPa()}sFn(oa,
cb){this.nCb(this.guh(oa,cb));this.lPa()}selectComment(oa){this.nCb(this.evh(oa,6));this.lPa()}highlightComment(oa){this.nCb(this.evh(oa,7));this.lPa()}J8f(oa,cb){this.nCb(this.HLk(oa,cb));this.lPa()}cMf(oa,cb){this.nCb(this.CNk(oa,cb));this.lPa()}iIk(oa,cb=0){const xb=new xf;xb.modelCapabilityFlags=oa;xb.richTextCapabilityFlags=cb;return new Mk(12,xb)}lth(oa,cb,xb,Qb){const qc=new xf;qc.numberOfComments=oa;qc.numberOfThreads=cb;qc.contextDetails=Object.assign(new Ql(xb),{nextPopulatedContextDetails:Qb});
qc.contextDrafts=null;qc.rehydrationDrafts=null;return new Mk(0,qc)}IIk(oa,cb,xb){const Qb=new xf;Qb.comments=oa;Qb.numberOfThreads=cb;Qb.tasks=xb;return new Mk(2,Qb)}guh(oa,cb){const xb=new Zk;xb.comments=oa;xb.tasks=cb;return new Mk(1,xb)}evh(oa,cb){const xb=new xf;xb.commentId="";oa&&(xb.commentId=oa);return new Mk(cb,xb)}HLk(oa,cb){const xb=new xf;xb.changes=[];xb.contextDetails=Object.assign(new Ql(cb),{nextPopulatedContextDetails:oa});return new Mk(10,xb)}CNk(oa,cb){const xb=new xf;xb.commentId=
oa;xb.smartReplies=cb;return new Mk(15,xb)}nCb(oa){for(let cb=0;cb<this.Gma.count;++cb)Array.enqueue(this.Gma.J(cb).Oka,oa)}}Object(e.a)(Kl,"OfficeSharedCommentsEventHost",Rk,[861]);var tk=d(204),$k=d(166),un=d(233);class bm{constructor(){this.SGe=this.Ytg=!1;this.hS=this.Wm=this.WIg=this.gPg=this.opd=this.vTb=this.B2g=this.Hyg=this.JE=this.yvc=null}initialize(oa,cb,xb,Qb=null,qc=null,Mc=null,Gd=null,de=null,Id=null,Xe=null){this.JE=oa;this.Hyg=cb;this.B2g=xb;this.vTb=Qb;this.opd=qc;this.gPg=Mc;this.WIg=
Gd;this.Wm=de;this.Ytg=!0;this.hS=Id;this.yvc=Xe}PMd(oa=null,cb=null){if(!this.Ytg)return a.ULS.sendTraceTag(41424203,201,10,"InstantiateSharedComments called before activation manager initialization."),new Promise((xb,Qb)=>{Qb(Og.a.PC(-2130915313))});if(this.SGe)return a.ULS.sendTraceTag(41424204,201,10,"InstantiateSharedComments called after shared comments was already instantiated."),new Promise(()=>{});this.yvc||(v.AFrameworkApplication.K.$("DynamicBundlesIsEnabled")?this.yvc=appResourceLoader.loadChunk("sharedComments"):
this.yvc=this.JE.loadScript("sharedComments"));return this.yvc.then(()=>{oa&&oa();this.SGe||(this.hS&&this.hS.execute(xb=>{xb.logActivity("Office_Docs_SharedComments_InitializeWebFloodgate","InitializeFloodgateServiceInCommentsPane")}),cb&&cb(),sharedComments.instantiate(this.Hyg,this.B2g,this.vTb,this.opd,this.gPg,this.WIg,this.Wm));this.SGe=!0})}}Object(e.a)(bm,"CommentActivationManager",null,[904]);class yh extends Rk{constructor(oa){super(oa)}Mnn(oa){this.rln(oa)}zfo(oa){this.kfj(oa)}R0i(oa){oa=
this.EIk(oa);for(let cb=0;cb<this.Gma.count;++cb)Array.enqueue(this.Gma.J(cb).Oka,oa);this.lPa(!0)}EIk(oa){const cb=new pl;cb.eventType=3;cb.viewContainerVisibilityState=oa;return cb}rcl(){const oa=this.BOk();for(let cb=0;cb<this.Gma.count;++cb)Array.enqueue(this.Gma.J(cb).Oka,oa);this.lPa(!0)}BOk(){const oa=new pl;oa.eventType=2;return oa}}Object(e.a)(yh,"ViewContainerEventHost",Rk,[829]);var fn=d(44);class Sj{constructor(){this.actionBehavior=this.actionType=0}}Object(e.a)(Sj,"CommentUIActionPayload",
null,[]);var qg=d(321);class fl{constructor(oa,cb){this.ga=oa;this.$mb=cb;this.bjc=new qg.a;for(let xb of this.$mb)this.bjc.Z(xb.value.canvasActionId,xb.key),oa=xb.value,oa.delayActionsUntilRegistration||this.pa(oa)}pa(oa){oa.withFlags?this.ga.gb(oa.canvasActionId,oa.canvasContextId,Object(fn.a)(this,this.Q6g,"actionHandler"),97):this.ga.pa(oa.canvasActionId,oa.canvasContextId,Object(fn.a)(this,this.Q6g,"actionHandler"))}GOa(oa,cb){this.$mb.xb(oa)&&(this.$mb.J(oa).delayActionsUntilRegistration&&this.pa(this.$mb.J(oa)),
this.$mb.J(oa).registeredCallback=cb)}Q6g(oa,cb,xb,Qb,qc){if(this.bjc.xb(oa)){var Mc=this.bjc.J(oa);if(!this.$mb.xb(Mc))return 8;const Gd=this.$mb.J(Mc);if(Gd.preCallback){const de=Gd.preCallback(oa,cb,xb,Qb,qc);if(2!==de)return de}if(!Gd.registeredCallback)return 1===xb?8:2;Mc=Object.assign(new Sj,{actionType:Mc});1===xb&&(Mc.actionBehavior=1);Mc=Gd.registeredCallback(Mc);return Gd.postCallback?Gd.postCallback(Mc,oa,cb,xb,Qb,qc):Mc?32:8}return 2}}Object(e.a)(fl,"OfficeSharedCommentsActionHost",null,
[863]);var gm=d(1757),xl=d(56),Ch=d(124),gi=d(1440),Dh=d(13),Yj=d(32),Ek=d(658),wg=d(1122),ye=d(128),Td=d(307),cg=d(53),Hi=d(23),ee=d(1007),Fk=d(1E3),te=d(1540),Cg=d(159),cc=d(7),rh=d(42),pe=d(697),ah=d(501),Tg=d(18),ri=d(1910);class Rl{constructor(oa){this.J4=oa;this.Uac=new L.a;this.oZa=new L.a;this.s3l();this.yYl=[new ri.a(rh.a.Voh,rh.a.zAk),new ri.a(rh.a.Lvd,rh.a.yAk),new ri.a(rh.a.Moh,rh.a.pAk),new ri.a(rh.a.Gvd,rh.a.oAk),new ri.a(rh.a.Woh,rh.a.BAk),new ri.a(rh.a.Mvd,rh.a.AAk)]}W1a(oa){this.J4.W1a(oa);
this.Ton(oa)}qsf(oa,cb){return!!oa&&!!oa.objectId&&cb.contains(ka.a.Of(oa.objectId))}M_a(oa){oa=Object(tc.a)(265,oa);return!!oa&&!!oa.objectId}Ton(oa){for(let cb of this.yYl)oa.classList.remove(cb.className,cb.sKc);oa.classList.remove(rh.a.DLf,rh.a.Ovd,rh.a.Noh,rh.a.Nvd,Rl.tcg)}s3l(){const oa=new L.a,cb=new L.a;oa.add(0,null);oa.add(1,rh.a.Lvd);oa.add(2,rh.a.Voh);oa.add(3,rh.a.Ovd);cb.add(0,null);cb.add(1,rh.a.Gvd);cb.add(2,rh.a.Moh);cb.add(3,rh.a.Noh);this.oZa.Z(1,oa);this.oZa.Z(2,cb);this.oZa.Z(3,
cb);this.Uac.add(0,null);this.Uac.add(1,rh.a.Mvd);this.Uac.add(2,rh.a.Woh);this.Uac.add(3,rh.a.Nvd)}}Rl.tcg="CommentImportant";Object(e.a)(Rl,"CommentHighlightUtils",null,[]);class Tf{constructor(){this.vAd=0;this.Nwb=null}}Object(e.a)(Tf,"CommentGuidsInElementInfo",null,[]);class hm{constructor(){this.W3h=!1;this.fka=this.FGb=null;this.mOa=this.QBb=0}}Object(e.a)(hm,"HighlightInfoForElement",null,[]);class mh{constructor(){this.q7h=this.s7h=this.r7h=-1;this.l5h=[];this.tZb=[];this.dMc=this.eMc=-1;
this.Xai=!1}}Object(e.a)(mh,"HighlightInfoForElementsInPara",null,[]);class ck{constructor(){this.y7f=this.wHf=null}}Object(e.a)(ck,"OnAnchorMouseOutData",null,[]);var Uf=d(1476);class al{constructor(oa,cb,xb,Qb,qc,Mc,Gd,de){this.Nke=oa;this.e8=cb;this.Kj=xb;this.z0=Qb;this.ga=qc;this.Hb=Mc;this.tj=Gd;this.mTa=this.aj=null;this.qQm=Id=>{if(!this.aj||this.z0.XOd)return!0;if(Id=Id.yp){if(this.aj.Uz&&Id[0].toString()===this.aj.Uz.objectId)return!0;this.mTa&&Id[0].equals(this.mTa.y7f[0])?this.Hb.We(this.mTa.wHf):
(this.mTa&&(this.Hb.We(this.mTa.wHf),this.ga.Xb(Dh.a.Pvd,2,this.mTa.y7f)),this.aj.$p.Yai(Id[0])&&!this.tj.mn||this.ga.Xb(Dh.a.bYe,2,Id));this.mTa=null}return!0};this.pQm=Id=>{if(this.z0.XOd)return!0;const Xe=Id.yp;Xe&&(Id=new qa.a(2,1,0,()=>{this.ga.Xb(Dh.a.Pvd,2,Xe);this.mTa=null}),this.Hb.$b(Id),this.mTa=Object.assign(new ck,{wHf:Id,y7f:Xe}));return!0};this.wwi=Id=>{const Xe=new qa.a(2,1,0,()=>{if(this.aj&&!this.aj.$p.Ly){var hf=Id.yp;if(!hf)hf=U.App.xa.$o.og,this.aj.Uz&&(!hf||hf.name!==Cg.AFrame.xL&&
hf.name!==Cg.AFrame.gr)&&this.aj.clearSelection();else if(!this.aj.Uz||hf.toString()!==this.aj.Uz.objectId)if(hf=this.aj.$p.uZ(hf.toString()))hf=Object.assign(new gi.a,{commentId:hf.id,pO:!1,r3:1}),this.ga.Xb(Tg.a.selectComment,2,hf)}});this.Hb.$b(Xe);return!1};de.execute(Id=>{this.aj=Id})}rhh(oa,cb,xb,Qb){const qc=new mh,Mc=[],Gd=this.e8.M_a(cb)?cb.objectId:null;for(let Xe=0,hf=oa.length;Xe<hf;Xe++){var de=oa[Xe],Id=Uf.g(de);const Ef=Uf.d(de);de=new fg.a;const ng=new hm;if(Id){const Bh=new ah.a(Uf.c);
Id=this.kHh(Id,Gd,Bh);0<Id.length&&(this.Yio(Id,xb,de,ng,Gd,Qb),Mc.push(Object.assign(new Tf,{vAd:Xe,Nwb:Bh})))}Ef&&(Id=this.kHh(Ef,Gd),0<Id.length&&(this.$io(Id,xb,de,ng,qc,Gd,Qb,Xe),this.sho(Mc,Id,Xe,ng)));0<xb.count&&this.ajo(cb,xb,ng,Qb);this.qho(Mc,ng);qc.l5h.push(ng)}return qc}Och(oa,cb,xb){let Qb=!1;for(let qc=0,Mc=oa.length;qc<Mc;qc++){const Gd=oa[qc],de=cb.l5h[qc],Id=pe.a(Gd);if(1!==Id&&2!==Id&&3!==Id)continue;const Xe=3===Id||2===Id&&-1!==Gd.className.indexOf(rh.a.pta);this.e8.W1a(Gd);this.b4j(Gd,
de,Xe,Qb);this.V2j(Gd,qc,Id,de,cb,xb);this.W2j(Gd,qc,cb,de);Qb=Xe}}kHh(oa,cb,xb=null){const Qb=[];for(let qc=0;qc<oa.length;qc++)this.Nke.n2i(oa[qc],oa[qc].toString()===cb)&&(Qb.push(oa[qc]),xb&&xb.add(oa[qc]));return Qb}Yio(oa,cb,xb,Qb,qc,Mc){var Gd;let de=!1,Id=!1;for(let hf of oa){cb.add(hf);xb.add(hf);var Xe=hf.toString();Xe===qc?(Xe=Mc?1:2,Qb.mOa=Xe,Qb.QBb=Xe):this.qsf(this.aj.Uz,cb)&&(Xe===(null===(Gd=this.aj.Uz)||void 0===Gd?void 0:Gd.objectId)&&(Id=!0),de=!0)}0<oa.length&&!Qb.mOa&&(Qb.mOa=
Id?1:3,Qb.QBb=de?1:3)}$io(oa,cb,xb,Qb,qc,Mc,Gd,de){var Id,Xe;const hf=new ah.a(Uf.c);Gd=Gd?1:2;let Ef=!1;for(let ng of oa){const Bh=ng.toString();cb.contains(ng)||(Bh===Mc?qc.q7h=de:(qc.r7h=de,Qb.mOa=3,(null===(Id=this.aj.Uz)||void 0===Id?void 0:Id.objectId)===Bh&&(qc.s7h=de,Qb.mOa=1)),hf.add(ng));Bh===(null===(Xe=this.aj.Uz)||void 0===Xe?void 0:Xe.objectId)&&(Ef=!0);cb.remove(ng);xb.contains(ng)&&this.Zio(Qb,ng,Bh,Mc,Gd);Bh===Mc&&(Qb.mOa=Gd)}0<oa.length&&!Qb.mOa&&(Qb.mOa=Ef?1:3);0<hf.count&&qc.tZb.push(Object.assign(new Tf,
{vAd:de,Nwb:hf}))}sho(oa,cb,xb,Qb){0!==oa.length&&(cb.forEach(qc=>{for(let Mc=oa.length-1;0<=Mc;Mc--){const Gd=oa[Mc];if(Gd.Nwb.contains(qc)){Gd.vAd===xb&&(Qb.fka?Qb.fka.push(qc):Qb.fka=[qc]);Gd.Nwb.remove(qc);break}}}),oa=oa.filter(qc=>0<qc.Nwb.count))}ajo(oa,cb,xb,Qb){var qc,Mc;this.qsf(oa,cb)?xb.QBb=Qb?1:2:xb.QBb||(xb.QBb=null!=(null===(qc=this.aj.Uz)||void 0===qc?void 0:qc.objectId)&&cb.contains(ka.a.Of(null===(Mc=this.aj.Uz)||void 0===Mc?void 0:Mc.objectId))?1:3);xb.FGb||(xb.FGb=[]);for(let Gd of cb)xb.FGb.push(Gd)}qho(oa,
cb){if(0<oa.length){cb.fka||(cb.fka=[]);for(let xb of oa[oa.length-1].Nwb)cb.fka.push(xb)}}Zio(oa,cb,xb,Qb,qc){oa.W3h=!0;oa.FGb||(oa.FGb=[]);oa.FGb.push(cb);xb===Qb&&(oa.QBb=qc)}qsf(oa,cb){return!!oa&&!!oa.objectId&&cb.contains(ka.a.Of(oa.objectId))}b4j(oa,cb,xb,Qb){!cb.mOa||xb||Qb||((xb=this.e8.Uac.J(cb.mOa))&&oa.classList.add(xb),cb.W3h&&oa.classList.add(rh.a.DLf))}V2j(oa,cb,xb,Qb,qc,Mc){Qb=this.e8.oZa.J(xb).J(Qb.QBb);cb<qc.q7h?Qb=Mc?this.e8.oZa.J(xb).J(1):this.e8.oZa.J(xb).J(2):cb<qc.r7h&&!Qb&&
(Qb=cb<qc.s7h?this.e8.oZa.J(xb).J(1):this.e8.oZa.J(xb).J(3));Qb&&(cb=qc.Xai,oa.classList.add(Qb),cb&&oa.classList.add(Rl.tcg))}W2j(oa,cb,xb,Qb){Qb.fka||(Qb.fka=this.mml(cb,xb)||Qb.FGb);cb=null;Qb.fka&&0<Qb.fka.length&&(this.Kj.mb(cc.a.rX,oa,this.qQm,Qb.fka),this.Kj.mb(cc.a.Hfa,oa,this.pQm,Qb.fka),cb=Qb.fka[0]);this.Kj.mb(cc.a.click,oa,this.wwi,cb);this.Kj.mb(cc.a.bJ,oa,this.wwi,cb)}mml(oa,cb){for(;0<cb.tZb.length&&cb.tZb[0].vAd===oa;)cb.tZb.splice(0,1);if(0<cb.tZb.length){oa=[];for(let xb of cb.tZb[0].Nwb)oa.push(xb);
return oa}return null}}Object(e.a)(al,"AllMarkupModeHighlightChangeHandler",null,[249]);var gl=d(1451);class nm extends gl.a{constructor(oa){super(100,25);this.$ic=new L.a(0);this.svj=6E4;this.Rbl=()=>{const cb=this.$ic.keys;if(cb.length){var xb="";for(let Qb=0;Qb<cb.length;Qb++)xb+=cb.J(Qb)+":"+this.$ic.J(cb.J(Qb))+";";this.Ana(xb);this.$ic=new L.a(0)}};this.knb=new Sa.a;this.knb.add(1);this.knb.add(6);this.knb.add(2);this.knb.add(4);this.knb.add(10);this.knb.add(11);this.kf=oa;oa.lQf&&window.setInterval(this.Rbl,
this.svj)}KDa(oa){this.kf.ydo&&this.kf.lQf&&(this.knb.contains(oa)?this.Mgn(oa):this.Ana(oa+""))}Mgn(oa){this.$ic.Z(oa,this.$ic.Jy(oa,0)+1)}}Object(e.a)(nm,"CommentActionInTypingRecorder",gl.a,[272]);var dj=d(1570),bi=d(205);class Qd{static gqn(oa){oa&&oa.atmention&&delete oa.atmention.isCurrentUser;return oa}}Object(e.a)(Qd,"DeltaFormatHelpers",null,[]);class Mi{constructor(){this.optional=this.attributes=null}}Object(e.a)(Mi,"Operation",null,[]);class Hn extends Mi{constructor(){super();this.insert=
null}}Object(e.a)(Hn,"DeltaOperation",Mi,[]);class Df{constructor(){this.ops=null}}Object(e.a)(Df,"Delta",null,[]);var ci=d(121),Ll=d(20),Wc=d(194),dk=d(173),Ni=d(48),Ld=d(74),Gk=d(140),bl=d(519),Ae=d(1171),mg=d(1707);class xk extends mg.ACommentFormatTranslator{constructor(oa,cb){super(oa);this.He=cb}E5f(oa){const cb=new dj.a;for(let xb=0;xb<oa.length;xb++){const Qb=oa[xb];Qb.NCb=!0;this.eck(cb,Qb);cb.Wea("\n")}return[cb.RHc()]}n9n(oa,cb){oa=dj.a.C2b(oa[0]);oa=this.V7m(oa);const xb=new Sa.a;let Qb=
0,qc=null,Mc=null;for(;Qb<oa.ops.length;){const Gd=oa.ops[Qb];qc||(qc=Ae.a.instance.createInstance(393230),qc.NCb=!0,qc.lh(la.a.Nc,bi.a.RF()),cb(qc),qc.qa.clear(),qc.Dva(""));"\n"===Gd.insert?(Mc=this.Twf(qc,Mc),this.nQn(qc),xb.add(qc),qc=null):Mc=this.otm(qc,Gd,Mc);Qb++}return xb.toArray()}nQn(oa){if(Ll.a.instance.J(6)){var cb=oa.$ih();for(let xb=0;xb<cb;xb++)oa.wordRunProperties.Hq.Z(xb,xk.lLm),oa.wordRunProperties.gt.Z(xb,xk.HDf)}}Twf(oa,cb){var xb=oa.RAd();xb.cp===oa.characterData.length?xb.Xh=
!0:(xb=Object.assign(new Wc.a(oa,oa.characterData.length),{Xh:!0}),oa.qa.add(xb));xb=oa.qa.last;if(cb){cb=!!cb.Hx;const Qb=this.mqh(oa,xb,!cb,cb,null);xb.formatting=Qb;cb&&(oa=this.kqh(oa,xb),xb.xT=oa.Bj);xb.wl=!0;cb=null}xb.cp||xb.formatting||(xb.formatting=new dk.a(xb,ka.a.nil));return cb}otm(oa,cb,xb){const Qb=oa.RAd(),qc=!!cb.attributes&&!!cb.attributes.link,Mc=!!cb.attributes&&!!cb.attributes.atmention,Gd=this.mqh(oa,Qb,qc,Mc,cb);Qb.formatting=Gd;xb&&(xb.Hx&&(xb=this.kqh(oa,Qb),Qb.xT=xb.Bj),
Qb.wl=!0,xb=null);if(qc||Mc)this.Psm(Qb,oa,cb),xb=Qb.hyperlink;oa.Dva(oa.characterData+cb.insert);return xb}kqh(oa,cb){cb=new dk.a(cb,ka.a.create());let xb=this.Pxd();xb.setValue(la.a.ODb,!0);xb=oa.Lc.QQ(xb);cb.Bj=xb.id;return cb}mqh(oa,cb,xb,Qb,qc){cb=new dk.a(cb,ka.a.create());let Mc=Ae.a.instance.createInstance(1179649);if(xb||Qb)Mc.setValue(Fc.a.IA,!0),Mc.setValue(Fc.a.z6,!0),xb&&this.bIn(oa,Mc);this.kf.Qvb&&qc&&qc.attributes&&this.$Nn(qc.attributes,Mc);Mc=oa.Lc.QQ(Mc);cb.Bj=Mc.id;return cb}bIn(oa,
cb){Ll.a.instance.J(8)&&(oa=this.He.Qx(oa))&&(oa=oa.xh(Ni.StyleReader.OMb))&&cb.setValue(Zc.a.tB,oa.id)}$Nn(oa,cb){this.IJb(oa.weight>=dj.a.gAf,cb,Fc.a.bold,!0);this.IJb(oa.italic,cb,Fc.a.italic,!0);this.IJb(oa.underline,cb,Fc.a.underline,!0);this.IJb(oa.underline,cb,Fc.a.underlineType,rf.a.VLb);this.IJb(oa.strikethrough,cb,Fc.a.strikethrough,!0);if(this.kf.ZCb){if(Ld.a.RPc(oa.highlight)){var xb=Ld.a.Keb(oa.highlight);this.IJb(!!oa.highlight,cb,Fc.a.highlight,Ld.a.xga(xb))}Ld.a.RPc(oa.color)&&(xb=
Ld.a.Keb(oa.color),this.IJb(!!oa.color,cb,Fc.a.fontColor,Ld.a.xga(xb)))}}IJb(oa,cb,xb,Qb){oa&&cb.setValue(xb,Qb)}Psm(oa,cb,xb){if(xb.attributes&&xb.attributes.atmention){var Qb=Gk.HyperlinkReader.FLa(xb.attributes.atmention.email);xb=xb.optional&&xb.optional.atmention&&xb.optional.atmention.contentId?xb.optional.atmention.contentId:xk.zfl(1===xb.attributes.atmention.resolveState);Qb=new bl.a(oa,Qb,!0,void 0,void 0,void 0,xb);this.wHk(Qb,cb.Lc);oa.hyperlink=Qb}else cb=Gk.HyperlinkReader.FLa(xb.attributes.link),
Qb=this.fKk(oa.paragraph.qa.first),oa.hyperlink=new bl.a(oa,cb,!1,Qb.Bj)}fKk(oa){let cb=this.Xuh();cb=oa.paragraph.Lc.QQ(cb);oa=new dk.a(oa,ka.a.nil);oa.Bj=cb.id;return oa}wHk(oa,cb){var xb=String.format(' HYPERLINK "{0}"',oa.url),Qb=oa.Hx;const qc=this.Pxd();qc.setValue(la.a.Eq,15);qc.setValue(la.a.Hx,Qb);qc.setValue(la.a.MMa,!0);qc.setValue(la.a.fieldInstruction,xb);oa.mra(cb.QQ(qc).id);Qb=this.Pxd();Qb.setValue(la.a.Eq,47);Qb.setValue(la.a.fieldInstruction,xb);oa.mra(cb.QQ(Qb).id);xb=this.Pxd();
xb.setValue(la.a.Eq,16);oa.mra(cb.QQ(xb).id)}Xuh(){const oa=Ae.a.instance.createInstance(1179649);oa.setValue(Fc.a.IA,!0);oa.setValue(Fc.a.z6,!0);oa.setValue(Fc.a.isHidden,!0);return oa}Pxd(){const oa=this.Xuh();oa.setValue(Fc.a.K7,!0);return oa}V7m(oa){const cb=new Sa.a;for(let xb=0;xb<oa.ops.length;xb++){const Qb=oa.ops[xb];Qb.optional=Qd.gqn(Qb.optional);if(-1!==Qb.insert.indexOf("\n")&&"\n"!==Qb.insert){const qc=Qb.insert.split("\n");for(let Mc=0;Mc<qc.length;Mc++)if(xb!==oa.ops.length-1||Mc!==
qc.length-1||qc[Mc])cb.add(Object.assign(new Hn,{insert:qc[Mc],attributes:Qb.attributes,optional:Qb.optional})),Mc!==qc.length-1&&cb.add(Object.assign(new Hn,{insert:"\n"}))}else cb.add(Qb)}return Object.assign(new Df,{ops:cb.toArray()})}static zfl(oa){return mg.ACommentFormatTranslator.Gfk+ci.a.create().toString().replace(RegExp("-","g"),"").toUpperCase()+(oa?"Z":"")}}xk.lLm=0;xk.HDf=0;Object(e.a)(xk,"CommentDeltaFormatTranslator",mg.ACommentFormatTranslator,[]);var lf=d(1625),ej=d(1523);class hl{constructor(oa,
cb,xb){this.ek=oa;this.K=cb;this.xS=xb}get userPrincipalName(){return this.K.lb("UserPrincipalName")}GB(oa){return this.ek.GB(oa)}X$l(oa){oa=this.ek.GB(oa);return oa?!oa.done:(a.ULS.sendTraceTag(521426529,327,10,"CommentFilterActor : Comment Not in Model. "),!1)}FNc(oa){return this.ek.FNc(oa)}isCurrentUserMentioned(oa){var cb,xb;oa=this.ek.cml(oa);for(const Qb of oa){oa=dj.a.C2b(Qb.text[0]);let qc=0;for(;oa.ops&&qc<oa.ops.length;){const Mc=null===(xb=null===(cb=oa.ops[qc])||void 0===cb?void 0:cb.attributes)||
void 0===xb?void 0:xb.atmention;if(Mc&&Mc.email===this.userPrincipalName)return!0;qc++}}return!1}BTc(){this.xS.xna("OnContentFilterUpdate")}}Object(e.a)(hl,"CommentFilterActor",null,[267]);var Xh=d(84),Cd=d(1906),db=d(871),Db=d(601);class Yb{constructor(oa,cb,xb,Qb,qc,Mc,Gd,de,Id,Xe){this.ii=oa;this.Hb=cb;this.Ih=xb;this.$Qa=Qb;this.kf=qc;this.tj=Mc;this.k4=Gd;this.Dh=de;this.yS=Id;this.YI=Xe;this.qpb=null;this.bKe=0;this.ved=!1;this.Yid=0;this.fMb=this.P0c=this.Lxg=this.$pc=this.zub=!1;this.updateViewportInfo=
()=>{this.yS.W_f()&&this.Dh.updateViewportInfo(this.ved,this.bJf)};this.Vhb=()=>{this.Dh.tja.Pta()&&(this.$bc(this.Dh.tja.Ic),this.Dh.tja.lcc(this.Vhb))};this.bJf=()=>{this.k4a();this.yS.aJf()};this.M2f=()=>{!this.zub&&this.yS.o_f()&&(this.Yid=this.iMe.scrollTop,this.zub=!0,this.$Qa.KDa(2))};this.KQf=(hf,Ef)=>{this.zub&&(hf=this.iMe.scrollTop,hf-this.Yid?(this.$pc||Ef.Tde||this.updatePosition(),this.$pc||1!==Ef.Tde||this.k4a(),this.UPe(hf),this.yS.XHf()):this.$pc=this.zub=!1)};this.iMe=this.Dh.Iba;
this.fga=Db.a.vZd;this.Ms=this.Dh.Ms;this.Dh.aqh()}get AOd(){return this.yS.Btf()}get fga(){return this.Dh.fga}set fga(oa){this.Dh.fga=oa}get Gdh(){return"1"===this.Ms.rE.style.opacity}A1i(oa){this.P0c||(this.P0c=!0,this.Dh.wFi(),this.qpb=oa(this.Ms.NBa,this.Dh.vOi,()=>{this.updatePosition()}),this.Dh.Imi(this.qpb),this.yS.initialize(this.qpb,this),this.Dh.initialize(this.qpb,this.yS.Yhb),this.Dh.WLi(),this.Dh.u1i(),this.Dh.v1i(),this.Dh.z1i(this.yS.aTe,this.yS.pYd,this.yS.oYd),this.sRf())}X_c(){}Z7d(){return this.Dh.s2i()}setInitialActiveContainerId(oa,
cb,xb=null){this.Dh.setInitialActiveContainerId(oa,0,xb)}updatePosition(){if(!this.fMb&&this.AOd&&this.ii.o4b()){var oa=G.a.lf()-this.bKe<Db.a.jij;oa||this.ved||this.k4a(oa)}}eSe(){this.k4a()}mPa(oa,cb,xb){this.Dh.mPa(oa,cb,xb)}deleteContainer(oa,cb,xb=!1){this.Dh.deleteContainer(oa,cb,()=>{this.ii.Ikf()||this.Dh.qlf();this.yS.jGf()},xb)}addContainer(oa,cb,xb){this.Dh.addContainer(oa,cb,xb,this.Dh.jf,this.yS.SIc,this.yS.XEf)}jEi(oa){this.fMb=!0;oa();this.fMb=!1}lYc(oa,cb,xb){this.Dh.lYc(oa,cb,xb)}eZb(){this.Dh.eZb()}Eij(){const oa=
"1"===this.Ms.rE.style.opacity;switch(!0){case oa&&!this.ii.Ikf():this.Dh.qlf();break;case !oa&&this.ii.Ikf():this.Dh.Yec()}}Q5f(oa=!0){this.yS.S_f&&this.Dh.qbj(oa)}static HPh(oa,cb=null){const xb=new ab.a;for(let Qb of oa)Qb.Rf||Qb.Sq!==Cd.a.beingCreated&&(!cb||cb(Qb))&&Yb.N1j(xb,Qb.objectId,Qb);return xb}static N1j(oa,cb,xb){let Qb;({value:Qb}=oa.Dc(cb,Qb)).returnValue||(Qb=[],oa.Z(cb,Qb));Qb.push(xb)}$bc(oa){oa&&(oa.yja(()=>{this.updateViewportInfo()}),this.Yid=this.iMe.scrollTop,oa.Q$g(this.M2f),
oa.R$g(this.KQf))}sRf(){this.Dh.jf?this.$bc(this.Dh.jf):this.Dh.tja?this.Dh.tja.cXb(this.Vhb):a.ULS.sendTraceTag(523011085,327,15,"Workspace undefined, failed to register page view handlers")}UPe(oa){this.Ms.rE.style.top=oa-this.Yid+"px";this.$pc=!1}k4a(oa=!1){oa=new qa.a(0,1,0,()=>{this.c5e()},129,void 0,!oa);this.Hb.$b(oa);this.ved=!0;this.$pc=this.zub;this.$Qa.KDa(10)}Jgf(oa){return this.Dh.JWa({contentAnchorPositions:oa.contentAnchorPositions})}c5e(){this.ved=!1;if(this.Ms.NBa&&this.qpb&&this.ii.o4b()){this.Dh.gBd();
var oa=0;this.Ih.Pd(()=>{oa=this.Dh.mFd()},"FCM:UP:GET");var cb=null,xb=null;this.Ih.Pd(()=>{const Qb=this.yS.pOh(oa,this.Dh.jf);cb=Qb.mBk;xb=this.Jgf(Qb)},"FCM:UP:GP");this.Ih.Pd(()=>{this.zub?(this.Dh.VCh(xb),this.zub=!1):this.qpb.emitEvent(3,xb);this.k4.y2d()},"FCM:UP:RC");this.qpb.setFirstCommentRenderDone();"0"===this.Ms.rE.style.opacity&&0<cb.count&&!this.tj.mn&&this.Ih.Pd(()=>{this.Dh.Yec()},"FCM:UP:SFC");this.kf.Dib&&!this.Lxg&&0<cb.count&&(Og.a.n1(this.Hb,this.Dh.hni,De.a.gni),this.Lxg=!0);
this.bKe=G.a.lf();this.$Qa.KDa(6)}else this.bKe=G.a.lf()}}Object(e.a)(Yb,"FloatingCommentManager",null,[25,243]);var zc=d(100),Vc=d(96),bd=d(1452),ce;(function(oa){oa[oa.dLo=0]="singleHint";oa[oa.HHo=1]="multiHint";oa[oa.RJo=2]="resolvedHint";oa[oa.IHo=3]="multiResolvedHint";oa[oa.entryPoint=4]="entryPoint";oa[oa.unknown=void 0]="unknown"})(ce||(ce={}));Object(e.b)("CommentIconType",ce);var ud=d(158),Sb=d(1083);const Gf={[1]:"ShowAllCommentsSelected_16x16x32",[0]:"SharedCommentBubbleSelected_16x16x32",
[2]:"MarkCommentDone1Selected_16x16x32",[3]:"ShowAllCommentsResolvedSelected_16x16x32",[4]:"NewComment_16x16x32",[ce.unknown]:""},gg={[1]:"ShowAllCommentsHover_16x16x32",[0]:"SharedCommentBubbleHover_16x16x32",[2]:"MarkCommentDone1Hover_16x16x32",[3]:"ShowAllCommentsResolvedHover_16x16x32",[4]:"NewComment_16x16x32",[ce.unknown]:""},mi={[1]:"ShowAllComments_16x16x32",[0]:"SharedCommentBubble_16x16x32",[2]:"MarkCommentDone1_16x16x32",[3]:"ShowAllCommentsResolved_16x16x32",[4]:"NewComment_16x16x32",
[ce.unknown]:""},ni=(oa,cb)=>{cb===ce.unknown&&a.ULS.sendTraceTag(545056465,327,15,`Unknown hint IconType with state : ${oa}`);switch(oa){case 1:return Gf[cb];case 2:return gg[cb];case 3:return mi[cb];default:return""}},hi={[1]:"CommentMultiHintIcon_16",[0]:"CommentHintIcon_16",[2]:"CommentResolvedHintIcon_16",[3]:"CommentResolvedMultiHintIcon_16",[4]:"NewCommentMarginEntrypoint_16",[ce.unknown]:""},nh={[0]:["OfficeIconColors_mCommentHintIconCenter","OfficeIconColors_mCommentHintIconBorder"],[1]:["OfficeIconColors_mCommentMultiHintIconCenter",
"OfficeIconColors_mCommentMultiHintIconBorder"],[2]:["OfficeIconColors_mCommentResolvedHintIconCenter","OfficeIconColors_mCommentResolvedHintIconBorder","OfficeIconColors_mCommentResolvedHintIconStamp"],[3]:["OfficeIconColors_mCommentResolvedMultiHintIconCenter","OfficeIconColors_mCommentResolvedMultiHintIconBorder","OfficeIconColors_mCommentResolvedMultiHintIconStamp"],[4]:[],[ce.unknown]:[]},Da=(oa,cb)=>{switch(oa){case "OfficeIconColors_mCommentHintIconCenter":case "OfficeIconColors_mCommentMultiHintIconCenter":case "OfficeIconColors_mCommentResolvedHintIconCenter":case "OfficeIconColors_mCommentResolvedMultiHintIconCenter":switch(cb){case 3:return Sb.a.bph;
case 2:return Sb.a.cph;case 1:return Sb.a.dph}break;case "OfficeIconColors_mCommentHintIconBorder":case "OfficeIconColors_mCommentMultiHintIconBorder":case "OfficeIconColors_mCommentResolvedHintIconBorder":case "OfficeIconColors_mCommentResolvedMultiHintIconBorder":switch(cb){case 3:return Sb.a.Zoh;case 2:return Sb.a.$oh;case 1:return Sb.a.aph}break;case "OfficeIconColors_mCommentResolvedHintIconStamp":case "OfficeIconColors_mCommentResolvedMultiHintIconStamp":switch(cb){case 3:return Sb.a.eph;case 2:return Sb.a.fph;
case 1:return Sb.a.gph}}},sb=(oa,cb)=>{ud.a("renderIcon")&&appChrome.api.renderIcon(oa,cb)};class ec{}ec.G5h=16;ec.MYl=1;ec.Wmf=20;ec.Imj=2;Object(e.a)(ec,"CommentIconConstants",null,[]);class Jc{constructor(){this.Hvd=0;this.Xyc=!1}}Object(e.a)(Jc,"CommentHintCensus",null,[]);class jd{constructor(oa,cb,xb,Qb,qc){this.Kyg=oa;this.vWb=xb;this.FBj=Qb;this.qWa=qc;this.eJa=-1;this.Mke=new Set(cb)}get y(){if(-1!==this.eJa)return this.eJa;const oa=Sys.UI.DomElement.getBounds(this.Kyg),cb=this.Kyg.getClientRects();
return this.eJa=0<cb.length&&cb[0]?this.FBj?oa.y/this.vWb+ec.Imj:Math.floor(cb[0].height)/(2*this.vWb)+oa.y/this.vWb-ec.G5h/2:0}get vZb(){return Array.from(this.Mke)}G5j(oa){this.Mke=new Set([...this.Mke,...oa])}}Object(e.a)(jd,"HintInfo",null,[281]);class Ud extends bd.a{constructor(oa,cb,xb,Qb,qc,Mc,Gd,de,Id,Xe,hf,Ef,ng,Bh){super();this.kf=oa;this.ig=cb;this.Kj=xb;this.GD=Qb;this.ga=qc;this.ii=Xe;this.cpa=hf;this.$Qa=Ef;this.tj=ng;this.jzj=Bh;this.Wkc=new Map;this.w7a=this.J9a=null;this.Cgc={Egc:-1,
VDf:-1}}eKb(oa){let cb=!1;U.App.dmj&&oa.fc.wi?J.a.instance.Pd(()=>{cb=Uf.m(oa,!0)},"CHA:SCIVE"):J.a.instance.Pd(()=>{cb=Uf.l(oa.htmlElement,!0)},"CHA:SCI");return cb}oxb(oa){const cb=this.zoom,xb=oa.Y6,Qb=oa.KBa,qc=oa.kwb(1,ec.Wmf,cb);this.$Qa.KDa(1);let Mc=[];Qb.forEach((Gd,de)=>{const Id=oa.E$[de].y/cb,Xe=Ef=>this.hKk(xb,Ef,Ef.y-Id,qc),hf=()=>Ud.$Lk(xb);Gd=this.kf.IVd?this.uKk(this.$Rh(Gd,de),Xe,hf):this.tKk(this.$Rh(Gd,de),Xe);Mc=Mc.concat(Gd)});return Mc}tKk(oa,cb){const xb=[];for(let Qb of oa){oa=
cb(Qb);for(let Mc of Qb.vZb)this.Wkc.set(Mc.toString(),oa);const qc=this.egf(Qb.vZb);this.v8f(qc,oa);oa.qWa=Qb.qWa;xb.push(oa)}this.OBb(this.w7a);this.pZa(this.J9a);return xb}uKk(oa,cb,xb){xb=xb();const Qb=[];for(let qc of oa){oa=cb(qc);for(let Gd of qc.vZb)this.Wkc.set(Gd.toString(),oa);const Mc=this.egf(qc.vZb);this.v8f(Mc,oa);null==xb.qWa&&(xb.qWa=qc.qWa);xb.appendChild(oa);Qb.push(oa)}this.OBb(this.w7a);this.pZa(this.J9a);return[xb]}QZk(oa,cb){oa=null===oa||void 0===oa?void 0:oa.querySelectorAll("."+
Ud.bCi);return 0<(null===oa||void 0===oa?void 0:oa.length)&&oa[0]&&(oa=Array.from(oa[0].querySelectorAll(Ud.CAk)))?this.lDn(oa,cb):!1}lDn(oa,cb){let xb=0,Qb=oa.length-1,qc;for(;Qb>=xb;){qc=Math.floor((Qb-xb)/2+xb);const Mc=oa[qc];if(Mc.offsetTop>=cb-2&&Mc.offsetTop<=cb+2)return!0;Mc.offsetTop>cb+2?Qb=qc-1:xb=qc+1}return!1}egf(oa){var cb,xb;let Qb=0,qc=0;for(let Mc of oa)if(this.ii.Csf(Mc)){if(this.kf.contentFilterApiEnabled&&this.tj.mn&&(oa=this.ii.uZ(Mc.toString()),null===(xb=(cb=this.jzj).isContentInFilteredContent)||
void 0===xb||!xb.call(cb,oa.id)))continue;this.ii.Yai(Mc)?qc+=1:Qb+=1}cb=new Jc;cb.Hvd=Qb+qc;cb.Xyc=0===Qb;return cb}phc(oa){if(oa=this.Wkc.get(oa.objectId)){var cb=Uf.g(oa);cb=this.egf(cb);this.v8f(cb,oa)}}v8f(oa,cb){let xb,Qb;if(this.kf.contentFilterApiEnabled&&0===oa.Hvd)cb.style.display="none";else if(1===oa.Hvd?(xb=oa.Xyc?2:0,Qb=oa.Xyc?WordEditorIntl.WordEditorStrings.L_CommentHintIcon_SingleResolvedLabel:WordEditorIntl.WordEditorStrings.L_CommentHintIcon_SingleActiveLabel):1<=oa.Hvd&&(xb=oa.Xyc?
3:1,Qb=oa.Xyc?WordEditorIntl.WordEditorStrings.L_CommentHintIcon_MultiResolvedLabel:WordEditorIntl.WordEditorStrings.L_CommentHintIcon_MultiActiveLabel),cb.style.display="block",this.kf.XJa){if(oa=cb.firstElementChild)this.tZi(oa,xb),oa.title=Qb+". "+oa.title,sb(hi[xb],oa)}else if(oa=cb.firstElementChild)this.tZi(oa,xb),oa.alt=Qb,oa.className=Vc.getImageClassWithCluster(v.AFrameworkApplication.hQ,ni(3,xb))}tZi(oa,cb){oa.title=WordEditorIntl.WordEditorStrings.L_CommentHintIcon_UserActionStatement;
zc.a.Il(oa,Ud.hph,cb)}$Rh(oa,cb){oa=this.iKk(oa,cb);oa.sort((xb,Qb)=>xb.y-Qb.y);return this.vHm(oa)}iKk(oa,cb){const xb=[],Qb=this.kf.vq,qc=this.zoom;oa=Uf.f(oa,!0);for(let Mc=0,Gd=oa.length;Mc<Gd;Mc++){const de=oa[Mc],Id=Uf.g(de);Id&&xb.push(new jd(de,Id,qc,Qb,cb))}return xb}vHm(oa){let cb=null;const xb=[];for(let Qb=0;Qb<oa.length;Qb++)cb&&Math.abs(oa[Qb].y-cb.y)<ec.G5h+ec.MYl?cb.G5j(oa[Qb].vZb):(cb=oa[Qb],xb.push(cb));return xb}hKk(oa,cb,xb,Qb){const qc=oa.Ig.ownerDocument,Mc=qc.createElement("div");
Mc.className=Ud.Xoh;Mc.style.top=xb+"px";Mc.style.left=Qb+"px";Mc.style.right="auto";Mc.style.zIndex="40";zc.a.Il(Mc,rh.a.xBc,cb.vZb);this.kf.XJa?(cb=qc.createElement("span"),this.F3c(cb,Mc),sb(hi[0],cb),this.QA(cb,oa)):(cb=qc.createElement("img"),this.F3c(cb,Mc),cb.src=v.AFrameworkApplication.pr,cb.className=Vc.getImageClassWithCluster(v.AFrameworkApplication.hQ,ni(3,0)),cb.alt=CommonUIStrings.l_CommentHintTooltip+WordEditorIntl.WordEditorStrings.L_AccHelpShortcutMsgToMoveFocusCommentToDocument,
this.QA(cb,oa));return Mc}F3c(oa,cb){oa.title=CommonUIStrings.l_CommentHintTooltip;oa.setAttribute("role","button");cb.appendChild(oa)}QA(oa,cb){this.ig.uE(cc.a.click,oa,this.SSm.bind(this),cb);this.ig.mb(cc.a.VC,oa,this.VSm.bind(this));this.Kj.mb(cc.a.rX,oa,this.XSm.bind(this));this.Kj.mb(this.kf.XJa?cc.a.oK:cc.a.Hfa,oa,this.WSm.bind(this));this.GD.mb(oa,this.USm.bind(this))}static $Lk(oa){oa=oa.Ig.ownerDocument.createElement("div");oa.className=Ud.bCi;return oa}USm(){return!0}VSm(){return!0}SSm(oa){const cb=
Uf.g(oa.Dv.parentNode);oa.eventName===cc.a.bJ&&(this.cpa.UWe(),this.Vmh());this.ga.Xb(Dh.a.Yoh,2,cb);return!0}XSm(oa){this.YAa(this.w7a)!==oa.Dv&&(oa=Uf.g(oa.Dv.parentNode),this.ga.Xb(Dh.a.bYe,2,oa));return!0}WSm(){this.ga.processAction(Dh.a.Pvd,2);return!0}OBb(oa){this.Vmh();this.w7a=oa;this.$ck()}$ck(){this.adk(this.YAa(this.w7a),this.YAa(this.J9a))}pZa(oa){this.uwk();this.J9a=oa;if(oa=this.YAa(this.J9a)){const cb=this.$Fd(oa);this.kf.XJa?this.J6d(oa,cb,1):oa.className=Vc.getImageClass(ni(1,cb))}}YAa(oa){if(!oa)return null;
let cb=null;if(oa=this.ii.uZ(oa))if(oa=oa.Rf?this.ii.GB(oa.Rf):oa)cb=oa.objectId;return cb&&this.Wkc.has(cb)?this.Wkc.get(cb).firstChild:null}Vmh(){this.wwk(this.YAa(this.w7a),this.YAa(this.J9a))}wwk(oa,cb){if(oa){const xb=this.$Fd(oa);cb=oa===cb?1:3;this.kf.XJa?this.J6d(oa,xb,cb):oa.className=Vc.getImageClass(ni(cb,xb));this.w7a=null}}adk(oa,cb){oa&&(oa.title=0<this.Cgc.VDf&&1<this.Cgc.Egc?CommonUIStrings.l_CommentHintTooltip+String.format(CommonUIStrings.l_CommentHintNthOfTotal,this.Cgc.VDf,this.Cgc.Egc):
CommonUIStrings.l_CommentHintTooltip,cb!==oa&&(cb=this.$Fd(oa),this.kf.XJa?this.J6d(oa,cb,2):oa.className=Vc.getImageClass(ni(2,cb))))}uwk(){var oa=this.YAa(this.w7a);const cb=this.YAa(this.J9a);if(cb){const xb=this.$Fd(cb);oa=oa===cb?2:3;this.kf.XJa?this.J6d(cb,xb,oa):cb.className=Vc.getImageClass(ni(oa,xb));this.J9a=null}}J6d(oa,cb,xb){this.hem()?this.CKn(oa,xb):this.wMn(oa,cb,xb)}CKn(oa,cb){oa=null===oa||void 0===oa?void 0:oa.querySelectorAll(".OfficeIconColors_HighContrast");0<(null===oa||void 0===
oa?void 0:oa.length)&&(oa[0].style.fill=2===cb||1===cb?"Highlight":"ButtonText")}wMn(oa,cb,xb){cb=nh[cb];for(let qc=0;qc<cb.length;qc++){var Qb=cb[qc];const Mc=Da(Qb,xb);Qb=null===oa||void 0===oa?void 0:oa.querySelectorAll("."+Qb);0<(null===Qb||void 0===Qb?void 0:Qb.length)&&(Qb[0].style.fill=`var(${Mc})`)}}hem(){try{return window.matchMedia("screen and (-ms-high-contrast: active)").matches}catch(oa){return!1}}$Fd(oa){return zc.a.Eb(oa,Ud.hph)}}Ud.Xoh="clip16x16 HintContainer";Ud.CAk=".clip16x16.HintContainer";
Ud.bCi="OutlineElementHintMargin";Ud.hph="CommentIconType";Object(e.a)(Ud,"CommentHintActor",bd.a,[264]);var ve=d(975);class bf extends ve.a{constructor(oa,cb,xb,Qb,qc,Mc,Gd,de,Id,Xe){super();this.ui=oa;this.hr=cb;this.ek=xb;this.taskManager=Qb;this.gqd=qc;this.xS=Mc;this.Dh=Gd;this.getSelectedText=de;this.Juo=Id;this.Ci=Xe;this.nTc=()=>{};this.lXd=()=>{};this.cvg=!1;this.Nsk={[0]:()=>this.hyh(),[1]:()=>this.bfc.eSe(),[2]:()=>this.hyh()};this.aJf=()=>{this.gqd.KDa(11)};this.aTe=hf=>{if(this.hr.Qvb)for(let Ef of Uf.s)hf.bindAction(Xh.KeyInputManager.CF(Ef),
Tg.a.KUe)};this.pYd=()=>{this.lXd()};this.oYd=(hf,Ef)=>{if(hf.name!==Cg.AFrame.gr&&Ef){var ng=this.ek.Ks?this.ek.Ks.id:"";this.ui.eGb||(this.ui.eGb=Og.a.n1(this.taskManager,()=>{this.nTc(ng)}))}};this.nAi=()=>{};this.Yhb=()=>{this.n4i()};this.XEf=(hf,Ef)=>{0===Ef&&(this.xS.y2d(),this.gqd.KDa(0))};this.jGf=()=>{this.gqd.KDa(5)};this.SIc=hf=>{let Ef=0;const ng=this.ek.gT();for(let Bh=0;Bh<ng.length;Bh++){if(ng[Bh].Rf||ng[Bh].done)continue;if((ng[Bh].Sq===Cd.a.beingCreated?ng[Bh].Hy.draftId:ng[Bh].id)===
hf.contentId)break;const fi=this.Ow.getContentAnchorPosition(ng[Bh].id);!fi||4<Math.abs(hf.anchorTop-fi.anchorTop)||Ef++}return Ef};this.Kvi=()=>{this.xS.y2d()};this.XHf=()=>{this.gqd.KDa(2)};this.n4i=()=>{if(!this.cvg&&this.Dh.Iba){const hf=this.Dh.Iba.getElementsByClassName(Ud.Xoh);for(let Ef=0;Ef<hf.length;Ef++)hf[Ef].style.opacity="1";this.cvg=!0}}}get S_f(){return this.yZ()}get f5e(){return this.Juo.dZh()}initialize(oa,cb){this.Ow=oa;this.bfc=cb;this.uXc()}YJn(oa,cb){this.lXd=oa;this.nTc=cb}yOh(oa,
cb){return{wVa:this.Oml(oa,cb),containerContentByType:{}}}pOh(oa,cb){const xb=Yb.HPh(this.ek.gT(),this.ek.Bta),Qb=[],qc=Uf.e(!0);var Mc=this.ek.gT();cb=this.W9m(cb,Mc,xb);!cb.MMf&&cb.contentAnchorPosition&&(Qb.push(cb.contentAnchorPosition),cb.contentAnchorPosition=null);for(Mc=0;Mc<qc.length;Mc++){const Gd=qc[Mc],de=Uf.g(Gd);if(de)for(let Id=0;Id<de.length;Id++){const Xe=this.getContentAnchorPosition(oa,xb,Gd,de[Id]);Xe&&(Qb.push(Xe),cb.MMf&&cb.contentAnchorPosition&&Xe.contentId===cb.MMf.id&&(Qb.push(cb.contentAnchorPosition),
cb.contentAnchorPosition=null))}}cb.contentAnchorPosition&&Qb.splice(0,0,cb.contentAnchorPosition);return{mBk:xb,contentAnchorPositions:Qb}}Btf(){var oa;return!(null===(oa=this.Ow)||void 0===oa||!oa.getAreContainersEnabled())}yZ(){return this.ek.o4b()}o_f(){return this.yZ()}s0c(){return this.yZ()}W_f(){return this.Ow&&this.Dh.Iba&&this.yZ()}cAi(oa){0!==oa&&this.nTc(this.ek.Ks?this.ek.Ks.id:"")}getContentAnchorPosition(oa,cb,xb,Qb){let qc=null;return({value:qc}=cb.Dc(Qb.toString(),qc)).returnValue?
(cb=qc[0])&&!cb.Rf?Object.assign(Object.assign({},new db.a),{anchorTop:(Db.a.XHc(xb)-oa)/this.Dh.wka,anchorLeft:0,containerContentType:0,contentId:cb.id}):null:null}W9m(oa,cb,xb){var Qb,qc;const Mc={};"CREATE"===(null===(qc=null===(Qb=this.ek.Ly)||void 0===Qb?void 0:Qb.Hy)||void 0===qc?void 0:qc.sessionType)&&(Qb=this.Dh.Iba.querySelectorAll(Uf.b),oa=this.Dh.$Lh((0<Qb.length?Qb[0]:null)||this.getSelectedText(),this.ek.Ly.Hy.draftId,0,oa),Mc.MMf=this.wDl(cb,xb),Mc.contentAnchorPosition=oa);return Mc}wDl(oa,
cb){var xb=Array.indexOf(oa,this.ek.Ly);for(--xb;-1<xb;xb--)if(cb.xb(oa[xb].objectId))return oa[xb]}Oml(oa,cb){return this.pOh(oa,cb).contentAnchorPositions}uXc(){this.xS.oga("OnAfterTrackChangeMarkupViewChange",(oa,cb)=>{if(cb)this.Nsk[cb.Ri]()})}hyh(){const oa=Uf.i();if(0!==oa.length){var cb=Yb.HPh(this.ek.gT()),xb=this.ek.RJ;for(let Qb=0;Qb<oa.length;Qb++){const qc=Uf.g(oa[Qb]);for(let Mc=0;Mc<qc.length;Mc++){let Gd;({value:Gd}=cb.Dc(qc[Mc].toString(),Gd)).returnValue&&(Gd.forEach(de=>{var Id;
de&&!de.Rf&&(this.bfc.deleteContainer(de.id,0,!1),(null===(Id=xb.Uz)||void 0===Id?void 0:Id.id)===de.id&&xb.clearSelection())}),this.Ci.Jg(Cg.AFrame.Zp))}}}}}Object(e.a)(bf,"CommentFloatingContainerActor",ve.a,[273]);var $e=d(1454),cf=d(1911),oi=d(187);class Dc extends $e.a{constructor(oa,cb,xb,Qb,qc,Mc,Gd,de,Id){super();this.lLj=oa;this.T5a=cb;this.Nke=xb;this.Ih=qc;this.e8=de;this.k4=Id;this.aj=null;this.Ri=1;Qb.execute(Xe=>{this.aj=Xe});this.Opa=[];this.Xkc=new oi.ScriptSharpLegacyMap;this.ikn(Mc,
Gd);this.uXc()}get Ui(){return this.lLj.value}get commentEditor(){return this.T5a}get Ila(){return!!this.aj}get PBb(){return 0}get Qeb(){return this.Opa}get IHg(){return this.Xkc.xb(this.Ri)?this.Xkc.J(this.Ri):this.Xkc.J(0)}M_a(oa){return this.e8.M_a(oa)}Zdb(oa,cb){if(oa=Object(tc.a)(265,oa))for(let xb of this.o$m(oa))cb.add(xb)}WNa(oa,cb){this.Ila&&this.Ih.Pd(()=>{this.iVm(oa,cb)},"CHA:OPHC")}iVm(oa,cb){if(this.aj.$p.o4b()){var xb=this.Ky.mKa,Qb=new pa.a(new Te.a),qc=cb.L1a("*"),Mc=this.qml(xb),
Gd=!!xb&&!xb.action||!!Mc&&Mc===this.aj.Uz,de;this.Ih.Pd(()=>{this.Nke.yBl(oa.id,Qb,null===Mc||void 0===Mc?void 0:Mc.objectId)},"OPHC:GOI");this.Ih.Pd(()=>{de=this.IHg.rhh(qc,Mc,Qb,Gd);de.Xai=this.Vai(xb)&&0===xb.action},"OPHC:BHI");this.Ih.Pd(()=>{this.IHg.Och(qc,de,Gd)},"OPHC:AH")}}qml(oa){let cb=null;!this.Vai(oa)||0!==oa.action&&2!==oa.action||(cb=this.Ky.mKa.DF);return cb||this.aj.Uz}o$m(oa){if(!oa)return[];oa=this.Ui.Eb(ka.a.Of(oa.objectId));return this.commentEditor.kHd(oa,null)}WMi(){return!1}nH(oa,
cb,xb){this.Ila&&(oa=Object.assign(new cf.a,{action:oa,type:0,DF:cb,iO:xb}),this.Ky.nH(oa))}UWe(){this.Ila&&(this.nH(3,this.aj.S4b,this.aj.S4b),this.aj.S4b=null)}ikn(oa,cb){this.Xkc.add(1,oa);this.Xkc.add(0,cb)}uXc(){this.k4.oga("OnBeforeTrackChangeMarkupViewChange",(oa,cb)=>{cb&&cb.FDf!==this.Ri&&(this.Ri=cb.FDf)})}Vai(oa){return oa&&0===oa.type}}Object(e.a)(Dc,"CommentHighlightActor",$e.a,[270,271]);var Ag=d(993),Uc=d(384),cl=d(546),Sh=d(1485);class Kh{constructor(oa,cb){this.ZAk=oa;this.SEf=cb}}
Object(e.a)(Kh,"CommentEndParaIdBeforeChangeInfo",null,[]);var uk=d(1571);class Xg{constructor(oa,cb,xb,Qb,qc,Mc,Gd,de){this.gwf=oa;this.ui=cb;this.ek=xb;this.xS=Qb;this.Lp=qc;this.fj=Mc;this.wAk=Gd;this.hr=de;this.Tnb=null;this.X9m=(Id,Xe)=>{(Id=Xe.commentNode)&&!Uf.r(Id)&&(Xe=this.ek.kcf(Id),ka.a.Fp(Xe.j1c,Xe.bFc)||this.Igj(Xe,Id)||this.Plh(Xe.zza,Xe.VJa,Id)||this.K8f(Id))};this.kPm=(Id,Xe)=>{Xe.property===la.a.xsa&&(Id=Uf.h(Xe.node,ka.a.nil),this.Tnb=new Kh(Xe.node.id,Id))};this.sQm=(Id,Xe)=>{Id=
Xe.node;if(Xe.property===la.a.xsa&&Id){var hf=Uf.k(Id,ka.a.nil);Xe=Uf.h(Id,ka.a.nil);var Ef=this.Tnb?this.zd.Eb(this.Tnb.SEf):null;!Uf.r(Id)&&hf&&!hf.equals(Xe)&&this.Tnb&&Id.id.equals(this.Tnb.ZAk)&&!hf.equals(this.Tnb.SEf)&&Ef&&Ef.isConnected&&this.tOe(this.Tnb.SEf,Id.id);Xe&&this.ui.fx.xb(Xe)&&(hf=this.ui.fx.J(Xe),hf.jZa&&(a.ULS.shipAssertTag(572835481,327,!!hf.bM,"Paranode with HasSpanningComment true should have non null OpenCommentObjIds"),hf.bM&&hf.bM.contains(Id.id)&&(hf.bM.remove(Id.id),
hf.bM.count||(hf.jZa=!1),this.ui.dU.xb(Id.id)?this.ui.dU.J(Id.id).remove(Xe):a.ULS.sendTraceTag(572835482,327,15,"[OnPropertyChanged] OpenComment -> ParaNodes entry missing!"))))}};this.MTc=(Id,Xe)=>{Id=Xe.node.id;this.ui.fx.xb(Id)&&this.lqn(Id)};this.WOm=(Id,Xe)=>{Xe&&Xe.node&&this.nRa.xb(Xe.node)&&(Id=this.nRa.J(Xe.node).uZd,this.nRa.xb(Id)||(Id=this.nRa.J(Xe.node),this.Plh(Id.H1e?Id.currentNode:Id.uZd,Id.H1e?Id.uZd:Id.currentNode,Id.commentNode)||this.K8f(Id.commentNode)),this.nRa.remove(Xe.node))};
this.vQm=(Id,Xe)=>{const hf=Id.Qj;if(!Xe&&this.j9a.xb(hf)){var Ef;(Ef=this.j9a).Z(hf,Ef.J(hf)&(Id.Pc?-2:-3));this.j9a.J(hf)||(this.K8f(this.zd.Eb(hf)),this.j9a.remove(hf))}};this.nRa=new cl.a(new Ag.a);this.j9a=new zf.a(Uf.c);this.xS.oga("OnCommentNodeAdded",this.X9m);this.hr.contentFilterApiEnabled?(this.xS.oga("OnCommentPaneOpen",this.T7l.bind(this)),this.xS.oga("OnCommentPaneClose",this.S7l.bind(this)),this.xS.oga("OnContentFilterUpdate",this.BTc.bind(this))):["OnCommentPaneOpen","OnCommentPaneClose"].forEach(Id=>
{this.xS.oga(Id,this.R7l.bind(this))});oa=this.Lp.Se(12);oa.zv(this.MTc);oa.ys(this.WOm);this.Lp.Se(40).jvb(this.kPm);this.Lp.Se(40).lp(this.sQm);Uc.a.HOa(this.vQm)}get Sy(){return this.gwf.value}get zd(){return this.Sy.zd}yBl(oa,cb,xb){if(this.U1m(oa))for(let Qb of this.ui.fx.J(oa).bM)!this.n2i(Qb,xb===Qb.toString())||cb.add(Qb)}n2i(oa,cb){const xb=this.zd.Eb(oa),Qb=Uf.r(xb);if(!xb||Qb)return!1;oa=this.ek.uZ(oa.toString());return!oa||this.hr.contentFilterApiEnabled&&this.ui.mn&&!this.wAk.isContentInFilteredContent(oa.id)||
!this.ui.mn&&!this.ek.Bta(oa)&&!cb?!1:!0}U1m(oa){return this.A1m(oa)}K8f(oa){if(oa){var cb=Sh.a.kHd(oa,null),xb=new Fa.a;for(let Qb=1;Qb<cb.length-1;Qb++)this.tOe(cb[Qb].id,oa.id),xb.add(cb[Qb]);pe.b(xb)}}A1m(oa){if(!this.ui.dX)return!1;let cb=null;if(({value:cb}=this.ui.fx.Dc(oa,cb)).returnValue)return cb.jZa;let xb=!1;this.fj.Pd(()=>{const Qb=Uf.e();for(let qc=0;qc<Qb.length;qc++)xb=this.zko(Qb[qc],oa,xb);xb||(this.ui.fx.add(oa,new uk.a),this.ui.fx.J(oa).jZa=!1)},"CHORA:PHOC");return xb}zko(oa,
cb,xb){oa=Uf.g(oa);if(!oa)return xb;for(let Qb=0;Qb<oa.length;Qb++){const qc=this.zd.Eb(oa[Qb]);qc&&!Uf.r(qc)&&(xb=xb||this.itk(qc,cb))}return xb}itk(oa,cb){var xb=this.ek.kcf(oa);if(this.Igj(xb,oa))return!1;var Qb=xb.j1c;const qc=xb.bFc;xb=xb.zza;if(Qb!==ka.a.nil&&(Qb.equals(qc)||Qb.equals(cb)))return!1;for(Qb=mb.ParagraphReader.Vg(xb,!1);Qb&&!Qb.id.equals(qc);){if(Qb.id.equals(cb))return this.tOe(cb,oa.id),!0;Qb=mb.ParagraphReader.Vg(Qb,!1)}return!1}tOe(oa,cb){this.ui.dU.xb(cb)||this.ui.dU.add(cb,
new pa.a(new Te.a));this.ui.dU.J(cb).add(oa);this.ui.fx.xb(oa)?this.ui.fx.J(oa).bM||(this.ui.fx.J(oa).bM=new pa.a(new Te.a)):this.ui.fx.add(oa,new uk.a(!0));this.ui.fx.J(oa).jZa=!0;this.ui.fx.J(oa).bM.add(cb)}lqn(oa){if(this.ui.fx.J(oa).bM)for(let cb of this.ui.fx.J(oa).bM)this.ui.dU.xb(cb)?this.ui.dU.J(cb).remove(oa):a.ULS.sendTraceTag(572835483,327,15,"[OnDisconnected] OpenComment -> ParaNodes entry missing!");this.ui.fx.remove(oa)}R7l(){const oa=new Fa.a;for(let cb of this.ek.gT())cb.Rf||cb.Sq===
Cd.a.beingCreated||this.ek.Bta(cb)||this.ek.M8f(cb,oa);pe.b(oa)}T7l(){this.Jof("OnCommentPaneOpen")}BTc(){this.Jof("OnContentFilterUpdate")}S7l(){this.Jof("OnCommentPaneClose")}Jof(oa){const cb=new Fa.a;for(let xb of this.ek.gT())xb.Rf||xb.Sq===Cd.a.beingCreated||this.ek.RJ.Jjh(oa,xb)||this.ek.M8f(xb,cb);pe.b(cb)}Igj(oa,cb){let xb=!1;if(!oa.U9d||!oa.IAd){xb=!0;if(!oa.zza||!oa.VJa)return a.ULS.sendTraceTag(571025377,327,15,"Anchor para nodes missing, start={0}, end={1}",!oa.zza,!oa.VJa),!0;oa.U9d||
this.nRa.xb(oa.zza)||this.nRa.add(oa.zza,{commentNode:cb,currentNode:oa.zza,uZd:oa.VJa,H1e:!0});oa.IAd||this.nRa.xb(oa.VJa)||this.nRa.add(oa.VJa,{commentNode:cb,currentNode:oa.VJa,uZd:oa.zza,H1e:!1})}return xb}Plh(oa,cb,xb){oa=Sh.a.Ssa(oa,xb.id,!0);cb=Sh.a.Ssa(cb,xb.id,!1);let Qb;oa||({value:Qb}=this.j9a.Dc(xb.id,Qb),this.j9a.Z(xb.id,Qb&1));cb||({value:Qb}=this.j9a.Dc(xb.id,Qb),this.j9a.Z(xb.id,Qb&2));return!oa||!cb}}Object(e.a)(Xg,"CommentHighlightOnRestActor",null,[266]);var nj=d(348),qj=d(349),
Lj=d(741);class bh{constructor(oa,cb){this.yub=oa;this.jia=cb}getViewContainer(){return this.yub}registerForViewContainerEvents(oa){this.jia.Mnn(oa)}unregisterForViewContainerEvents(oa){this.jia.zfo(oa)}}Object(e.a)(bh,"ViewContainerProvider",null,[828]);class si{constructor(oa,cb,xb,Qb){this.isRightToLeft=!1;this.dataCulture=this.uiCulture=this.appLocale=null;this.isRightToLeft=oa;this.appLocale=cb;this.uiCulture=xb;this.dataCulture=Qb}}Object(e.a)(si,"LocalizationDetails",null,[]);var nf=d(1119),
ig=d(1499);class Nk{constructor(oa,cb,xb,Qb,qc,Mc,Gd,de,Id,Xe,hf,Ef,ng,Bh,fi,jj,Qg,sh,Sk,Vf,Pk,oj,vi,kj,Vl,lh,Yg,Fi,Zj,Um,kb){this.tq=oa;this.ek=cb;this.wZb=xb;this.hZ=Qb;this.hr=qc;this.ui=Mc;this.gDd=Gd;this.M4b=de;this.iq=Id;this.zc=Xe;this.dynamicScriptLoader=hf;this.Ezn=Ef;this.Ci=ng;this.iYe=Bh;this.fYe=fi;this.X6g=jj;this.jqo=Qg;this.t_=sh;this.xS=Sk;this.jBn=Vf;this.e6k=Pk;this.jvi=oj;this.kqo=vi;this.Owb=kj;this.yS=Vl;this.Dh=lh;this.YI=Yg;this.tZe=Fi;this.i1a=Zj;this.Rvd=Um;this.wEk=kb;
this.Scd=this.BTa=null;this.SIg=!1;this.PAe=[];this.TYg=this.TIg=!1;this.initialize=(nc,Qc)=>{this.s2l(Qc)};this.oQk=nc=>Ld.a.TZe(nc);this.wQm=()=>{this.h8h()};this.Fsl=(nc,Qc,rd)=>{nc=Object.assign(Object.assign({},new nf.a),{containerPanel:nc,paneOpenedCallback:Qc,paneClosedCallback:rd,ulsLogger:new nj.a,canvasAndFcHostOffset:wacBoot.ShiftUtils.canvasAndFcOuterSurfaceOffset,isRtl:v.AFrameworkApplication.isRtl&&this.hr.Dib,viewportInfo:this.Dh.bdf(),destroyAllContainersCallback:()=>{this.ui.mn||
a.ULS.sendTraceTag(571342851,327,10,"The pane is not open but we are destroying the containers!")},featureGates:{deselectionEnabled:!0,floatingContainerVirtualizationEnabled:this.hr.hDd,synchronousContainerPositioningEnabled:!1,trackChangeInSidetrackEnabled:this.hr.trackChangeInSidetrackEnabled,improveJumpingFixEnabled:!1,shouldInitialize:!this.hr.contentNavigationApiEnabled,scrollingPerfImprovementEnabled:!1,contentNavigationApiEnabled:this.hr.contentNavigationApiEnabled,contentFilterApiEnabled:this.hr.contentFilterApiEnabled}});
this.hr.contentNavigationApiEnabled&&(nc.sidetrackContentNavigationApi=this.tZe,nc.featureGateApiSettings=this.yS.f5e,nc.telemetryDetails=this.jvi,this.hr.contentFilterApiEnabled&&(nc.contentFilterAPI=this.wEk));return floatingContainerManager.FactoryGlobal.getFCManagerInstance(nc)};this.mSm=nc=>{2!==this.tq.mode&&3!==this.tq.mode&&this.ek.Ks&&nc===this.ek.Ks.id&&this.tq.clearSelection();U.App.xa.updateCommandUI(!0)};this.ywi=(nc,Qc)=>{this.yv("onCSCStart",window.performance.now());this.G$a&&!nc&&
(this.EZm(),this.yv("openInFishbowl",!0));this.wZb.K$a&&this.hr.cyb&&this.zc.processAction(Dh.a.newComment,2);Qc&&Qc();this.yv("onCSCEnd",window.performance.now())};this.xS.oga("OnCommentInit",this.initialize);this.xS.oga("OnCommentRenderedOnce",this.wQm);this.yS.YJn(()=>{},this.mSm)}get EGa(){return this.tq}get G$a(){return this.ui.G$a}yv(oa,cb){this.i1a.yv(nk.a.comments,oa,cb,!0)}s2l(oa){if(this.ui.dX)oa&&oa.UCa&&oa.UCa();else if(this.SIg)(null===oa||void 0===oa?0:oa.UCa)&&this.PAe.push(oa.UCa);
else{var cb=this.hr.JKc;this.yv("hasCommentOnBoot",cb);cb?this.Owb.logKpiUsage(ig.a.Qvd,0):qj.a.h$b("canvas","floatingComments");this.SIg=!0;this.yv("initInProgress",!0);this.ek.initialize(this.tq);this.wZb.initialize(this.tq,null);this.wZb.w1i(this.tq);this.M4b.l3l(this.hZ.FOn);this.yv("InitAMSetup",window.performance.now());Lj.a.Kq(this.e6k).continueWith(xb=>{(this.BTa=xb.result)||a.ULS.sendTraceTag(574734881,327,10,"InitOfficeSharedComments: IExternalPeopleAPI instance is null");this.iYe.initialize(this.BTa);
this.EGa.WXe.initialize(this.EGa,this.ek,this.BTa,this.iYe);this.X6g.initialize(this.dynamicScriptLoader,this.EGa.WXe,this.jvi,this.BTa,new bh(this.jqo,this.kqo),this.aUh(),"",this.iYe.dZh(),this.t_,U.App.P7d);this.yv("AMInitialized",window.performance.now());this.hr.contentNavigationApiEnabled?(U.App.nzb?U.App.nzb:this.Dh.Ali()).then(()=>{this.yv("FCMLoaded",window.performance.now());this.X_c();this.PMd(oa)}):this.PMd(oa)})}}Z6m(){var oa;this.hr.ZCb&&(null===(oa=sharedComments.setDarkModeColorHandler)||
void 0===oa?void 0:oa.call(sharedComments,this.oQk))}PMd(oa){this.Scd=this.X6g.PMd(void 0,this.Z6m.bind(this));this.qMc(oa);this.ui.dX=!0;this.hr.x1f&&this.fYe.initialize()}qMc(oa){if(!this.ui.ZBb){this.yv("InitCSStart",window.performance.now());var cb=this.iq.hg("Task","InitiateCommentingSession");this.Owb.logKpiUsage(ig.a.iph,0);try{const xb=this.iq.hg("Task","InitiateCommentingSession-UpdateModel");this.Rvd.J2l();xb.stop();this.yv("initAtBoot",window.performance.now());this.hr.vq&&this.ek.o4b()&&
a.ULS.sendTraceTag(574734882,327,50,String.format("Comments loaded into the model at {0}",G.a.lf()));Ch.a.get_instance().XI(12);a.ULS.sendTraceTag(574734883,327,50,"CommentRendered AppInitializationStatus was set");this.ui.ZBb=!0;this.Scd.then(()=>{this.yv("SCLoaded",window.performance.now());this.Dh.c3l();this.yv("FCMInitiated",window.performance.now());if(this.hr.vq){let qc=!1;if(this.G$a){var Qb=this.hZ.OEd(this.G$a);Qb?(v.AFrameworkApplication.Hf("3ge3g205;cha3g788"),Qb=this.hZ.PEd(Qb,0),Qb)?
this.ek.Bta(Qb)||(qc=!0,this.FZm(Qb)):(qc=!0,this.L0a()):qc=!0}Qb=oa?oa.pxi:null;this.hr.contentNavigationApiEnabled?this.ywi(qc,Qb):this.Lsm(qc,Qb)}oa&&oa.UCa&&oa.UCa();for(let qc of this.PAe)qc();this.TIg&&this.h8h();this.PAe=[]})}catch(xb){a.ULS.sendTraceTag(539567713,327,10,`Comments Initialization Failed: ${xb}`),this.Owb.logKpiFailure(ig.a.iph,"CommentsInitializationFailed",{isInternal:!0},{name:ig.a.uBc,isInternal:!0})}finally{cb.stop(),this.yv("InitCSEnd",window.performance.now())}this.zc.processAction(Dh.a.Loh,
2)}}FZm(oa){this.zc.processAction(Dh.a.UX,2);this.yS.n4i();Og.a.n1(v.AFrameworkApplication.uc,()=>{this.hZ.selectComment(oa,Object.assign(Object.assign({},new gi.a),{pO:!0,r3:1}));this.Ci.Jg(Cg.AFrame.gr);a.ULS.sendTraceTag(574734912,327,50,"opened resolved deeplinked comment using pane, time since boot = {0}",(new Date).getTime()-v.AFrameworkApplication.bW)},De.a.RDn);this.Owb.TB(Dh.a.$Xe);v.AFrameworkApplication.Hl("Microsoft.Office.Web.SessionSettings.IWacWordLinkToCommentSettings")}L0a(){this.zc.processAction(Dh.a.L0a,
2)}Lsm(oa,cb){(U.App.nzb?U.App.nzb:this.Dh.Ali()).then(()=>{this.yv("FCMLoaded",window.performance.now());this.X_c();this.ywi(oa,cb)}).catch(xb=>{a.ULS.sendTraceTag(574734913,327,15,"Failed to load floatingContainerManager script: "+xb.toString())})}X_c(){this.YI.trackChangeInSidetrackEnabled?(this.gDd.X_c(),this.yv("STSet",window.performance.now())):this.gDd.A1i(this.Fsl)}h8h(){this.TYg||(this.ui.dX&&this.Scd?(this.Scd.then(()=>{const oa=sharedComments.RichContentEditAPIFactoryGlobal.getRichContentEditAPI();
this.jBn.execute(cb=>{oa.registerSafelinksNavigator(cb.ahc.bind(cb))});this.Ezn.execute(cb=>{cb.lkn(oa)})}),this.TYg=!0):(a.ULS.sendTraceTag(571618846,327,15,"[InitializeRichContentEditAPI] Shared comments runtime not yet loaded"),this.TIg=!0))}aUh(){return new si(v.AFrameworkApplication.isRtl,Sys.CultureInfo.CurrentCulture.name,v.AFrameworkApplication.uiCulture,v.AFrameworkApplication.dataCulture)}EZm(){this.hZ.TVi(this.G$a,Object.assign(Object.assign({},new gi.a),{M_f:!1,zNc:!0}));this.Owb.TB(Dh.a.$Xe)}}
Object(e.a)(Nk,"CommentInitActor",null,[]);class Nd{constructor(oa,cb,xb,Qb,qc,Mc,Gd){this.ig=oa;this.Kj=cb;this.GD=xb;this.ga=Qb;this.kzj=qc;this.Ki=Mc;this.kf=Gd;this.zde=this.eSa=null}get zoom(){let oa=1;this.Ki&&this.Ki.instance&&(oa=this.Ki.instance.vj);return 0<oa?oa:1}v7k(oa,cb){if(!this.zde||!oa.KBa||cb>=oa.KBa.length)return null;const xb=this.zoom,Qb=oa.Y6,qc=oa.kwb(1,ec.Wmf,xb);return this.sJk(oa.KBa[cb],Qb,(this.zde.y-oa.E$[cb].y)/xb+ec.Imj,qc)}sJk(oa,cb,xb,Qb){if(this.eSa)return(cb=this.eSa.parentElement)&&
cb.removeChild(this.eSa),this.rYi(oa,this.eSa,xb,Qb),this.eSa;const qc=cb.Ig.ownerDocument,Mc=qc.createElement("div");Mc.className=Nd.uAk;this.rYi(oa,Mc,xb,Qb);this.kf.XJa?(oa=qc.createElement("span"),this.F3c(oa,Mc),sb(hi[4],oa),this.eMi(oa,cb)):(oa=qc.createElement("img"),this.F3c(oa,Mc),oa.className=Vc.getImageClassWithCluster(v.AFrameworkApplication.hQ,ni(3,4)),oa.src=v.AFrameworkApplication.pr,oa.alt=CommonUIStrings.l_CommentNewCommentButton,this.eMi(oa,cb));return this.eSa=Mc}F3c(oa,cb){oa.title=
CommonUIStrings.l_CommentNewCommentButton;oa.setAttribute("role","button");cb.appendChild(oa)}eMi(oa,cb){this.ig.uE(cc.a.click,oa,this.SRm.bind(this),cb);this.ig.mb(cc.a.VC,oa,this.URm.bind(this));this.kf.XJa||(this.Kj.mb(cc.a.rX,oa,this.WRm.bind(this)),this.Kj.mb(cc.a.Hfa,oa,this.VRm.bind(this)));this.GD.mb(oa,this.TRm.bind(this))}hLd(){if(this.eSa){const oa=this.eSa.parentElement;oa&&oa.removeChild(this.eSa)}}rYi(oa,cb,xb,Qb){this.kzj.QZk(oa,xb)?cb.style.left=Qb+ec.Wmf+"px":cb.style.left=Qb+"px";
cb.style.top=xb+"px";cb.style.right="auto";cb.style.display="block";cb.style.position="absolute";cb.style.overflow="hidden";cb.style.cursor="default";cb.style.zIndex="40"}URm(){return!0}SRm(oa){this.ga.IG=30;this.ga.processAction(Dh.a.newComment,2);oa=oa.Dv;this.kf.XJa?sb(hi[4],oa):oa.className=Vc.getImageClassWithCluster(v.AFrameworkApplication.hQ,ni(3,4));oa=oa.parentElement;(null===oa||void 0===oa?0:oa.parentElement)&&oa.parentElement.removeChild(oa);return!0}WRm(oa){oa.Dv.className=Vc.getImageClassWithCluster(v.AFrameworkApplication.hQ,
ni(2,4));return!0}VRm(oa){oa.Dv.className=Vc.getImageClassWithCluster(v.AFrameworkApplication.hQ,ni(3,4));return!0}TRm(){return!0}}Nd.uAk="clip16x16 EntryPointContainer";Object(e.a)(Nd,"CommentMarginEntryPointActor",null,[]);var $d=d(93),Xd=d(453),ie=d(216),Wk=d(26),nd=d(110);class di{constructor(oa,cb,xb,Qb,qc,Mc,Gd){this.gwf=oa;this.Mqm=cb;this.$p=xb;this.ui=Qb;this.hr=qc;this.dYe=Mc;this.Owb=Gd;this.zHi=new Set;this.NEb=new Set;this.sZd=new ie.a;this.Bda=this.NEd()}get Sy(){return this.gwf.value}get zd(){return this.Sy.zd}get Cza(){return this.Mqm.value}NEd(){const oa=
new le.GraphIterator;oa.set(this.Sy);this.Cza.G0a(oa);return oa}J2l(){this.ui.ZBb&&a.ULS.sendTraceTag(523334300,327,15,"initializeCommentsAtBoot was called while the commenting session was already alive. [Call stack: {0}]",Wk.Debug.YXa());this.hr.contentNavigationApiEnabled||(this.hr.JKc&&this.H2l(),this.$p.vyi())}APm(){this.$p.vyi()}i5l(oa){const cb=[];for(let xb of oa)oa=xb.Qj.toString(),xb.Pc&&(this.zHi.has(oa)?a.ULS.sendTraceTag(523334301,327,50,"[UpdateContent] Duplicate commentRangeStart with id: {0}",
xb.Qj):(this.zHi.add(oa),(oa=this.P1j(xb))&&cb.push(oa)));this.DSi();return cb}P1j(oa){var cb=this.zd.Eb(oa.Qj);this.Bda.Ei(cb);if(40!==this.Bda.Qe||!cb)return a.ULS.sendTraceTag(523334303,327,15,"[UpdateContent] Iterator is not at commentNode or CommentNode is null, commentnode is null: {0}, objId null: {1}",!cb,!oa.Qj),this.Bda=39===this.Bda.Qe?this.Bda:this.NEd(),null;cb=this.$p.uxd(this.Bda);let xb;if(({index:xb}=this.$p.Obe(cb)).returnValue)if(this.$p.PNe(cb,xb),this.NEb.add(cb.objectId),cb.Rf)this.P9e(cb);
else return{contentId:cb.id,containerContentType:0,c7:{Ed:oa.Ob.cp,aM:oa.paragraph.vn}};else this.sZd.add(cb);return null}P9e(oa){if(oa.Rf){var cb=this.$p.GB(oa.Rf);if(cb&&cb.Rf){const xb=this.$p.GB(cb.Rf);xb&&(xb.Rf?a.ULS.sendTraceTag(523270216,327,10,"Multiple chain of replies parented to other replies"):(oa.Rf=cb.Rf,a.ULS.sendTraceTag(523270217,327,15,`Comment reply id pointing to another reply. objectid: ${oa.objectId} parentObjectId: ${cb.objectId}`)))}}}H2l(){const oa=new L.a(0),cb=$d.a.Wp(this.$p.BFa),
xb=new Set;this.hr.T_m&&!Xd.a.isEnabled&&this.P3j(cb,oa);let Qb=this.NEd(),qc=new Set;const Mc=new Set,Gd=new Lg.GraphTransaction(2);try{if(Gd.Ou(Qb),Qb.aq(1)){for(;cb.moveNext();){if(!mb.ParagraphReader.zh(cb.iterator))continue;const Id=cb.iterator.currentNode,Xe=mb.ParagraphReader.Tzb(Id);Xd.a.isEnabled&&this.UEm(Id,Xe,oa);xb.add(Id.id.toString());this.UGi(Xe,Mc,Qb,qc)}this.DSi();const de=this.rml(xb);0<de.length&&this.Tyn(de,xb,Qb,Mc)}}finally{Gd&&Gd.dispose()}0==this.NEb.size&&this.hr.JKc&&a.ULS.sendTraceTag(523334304,
327,15,"Comments not loaded in model while graph has comments");ej.a.Yym(qc,Mc,this.zd)}UGi(oa,cb,xb,Qb){for(let qc of oa)oa=qc.Qj.toString(),(this.hr.vq?!qc.Pc:qc.Pc)?cb.has(oa)||Qb.add(oa):cb.has(oa)?a.ULS.sendTraceTag(523334305,327,50,"[UpdateContent] Duplicate commentRangeStart with id: {0}",qc.Qj):(cb.add(oa),this.Q1j(qc,xb))}Tyn(oa,cb,xb,Qb){const qc=this.HCl(oa);ej.a.juk(qc);const Mc=new Set,Gd=new Set;qc.forEach(Id=>{cb.has(Id.id.toString())||Gd.has(Id.id.toString())||(Gd.add(Id.id.toString()),
Id=mb.ParagraphReader.Tzb(Id),a.ULS.sendTraceTag(523334306,327,50,`Retrying loading ${Id.length} CommentRangeObjects`),this.UGi(Id,Qb,xb,Mc))});const de=[];oa.forEach(Id=>{this.NEb.has(Id)||de.push(Id)});0<de.length&&(a.ULS.sendTraceTag(523334307,327,15,`Load Comments: ${de.length} Failed To Load on Retry: ${de.join(",")}`),this.Owb.logKpiFailure(ig.a.Qvd,"CommentsFailedToLoadOnRetry",{isInternal:!0},{name:ig.a.uBc,isInternal:!0}))}HCl(oa){const cb=[];oa.forEach(xb=>{if(xb=this.dYe.nOh(xb))xb=Uf.k(xb),
(xb=this.zd.Eb(xb))&&xb.Qi&&cb.push(xb)});return cb}Q1j(oa,cb){const xb=this.zd.Eb(oa.Qj);cb.Ei(xb);40===cb.Qe&&xb?(oa=this.$p.uxd(cb),({index:cb}=this.$p.Obe(oa)).returnValue?(this.$p.PNe(oa,cb),this.NEb.add(oa.objectId),oa.Rf&&this.P9e(oa)):this.sZd.add(oa)):(a.ULS.sendTraceTag(523334336,327,15,"[UpdateContent] Iterator is not at commentNode, commentnode is null: {0}, objId null: {1}",!xb,!oa.Qj),39===cb.Qe||this.NEd())}rml(oa){let cb=[];const xb=this.dYe.lml();if(this.NEb.size===xb.length)return cb;
xb.forEach(Qb=>{!this.NEb.has(Qb)&&ej.a.bnm(Qb,oa,this.dYe,this.zd)&&cb.push(Qb)});return cb}DSi(){for(let oa=0;oa<this.sZd.length;oa++){const cb=this.sZd.J(oa);let xb;({index:xb}=this.$p.Obe(cb)).returnValue?(this.$p.PNe(cb,xb),this.NEb.add(cb.objectId),cb.Rf&&this.P9e(cb)):a.ULS.sendTraceTag(523334337,327,10,String.format("Orphaned Comment add on retry failed: CommentGuardID: {0}, DurableId: {1}, ParentId: {2}",cb.NLa,cb.xKa,cb.Rf))}}P3j(oa,cb){oa.Um(xb=>{if(11===xb.Qe){var Qb=xb.currentNode;const qc=
Qb.ia(nd.a.lYe,null),Mc=Qb.ia(nd.a.jYe,null);xb=!!qc&&0<qc.length;const Gd=!!Mc&&0<Mc.length;xb&&qc.forEach(Id=>{const Xe=this.zd.Eb(Id);Xe&&!Uf.r(Xe)&&cb.add(Id,0)});Gd&&Mc.forEach(Id=>{cb.xb(Id)&&cb.remove(Id)});(Qb=Qb.ia(Fc.a.oL,null))&&Qb.forEach(Id=>{const Xe=this.zd.Eb(Id);mb.ParagraphReader.nc(Xe)&&!this.ui.fx.xb(Id)&&this.ui.fx.add(Id,new uk.a)});const de=cb.keys;for(let Id=0;Id<de.length;Id++){Qb&&0<cb.J(de.J(Id))&&(this.ui.dU.xb(de.J(Id))||this.ui.dU.add(de.J(Id),new pa.a(new Te.a)),Qb.forEach(hf=>
{const Ef=this.zd.Eb(hf);mb.ParagraphReader.nc(Ef)&&(this.ui.fx.J(hf).bM||(this.ui.fx.J(hf).bM=new pa.a(new Te.a)),this.ui.dU.J(de.J(Id)).add(hf),this.ui.fx.J(hf).jZa=!0,this.ui.fx.J(hf).bM.add(de.J(Id)))}));let Xe;cb.Z(Xe=cb.keys.J(Id),cb.J(Xe)+1)}return xb||Gd}return!0},null)}UEm(oa,cb,xb){oa&&(this.Wsj(cb,xb),this.ui.fx.xb(oa.id)||this.ui.fx.add(oa.id,new uk.a),xb.forEach((Qb,qc)=>{0<qc&&(this.ui.dU.xb(Qb)||this.ui.dU.add(Qb,new pa.a(new Te.a)),this.ui.fx.J(oa.id).bM||(this.ui.fx.J(oa.id).bM=new pa.a(new Te.a)),
this.ui.dU.J(Qb).add(oa.id),this.ui.fx.J(oa.id).jZa=!0,this.ui.fx.J(oa.id).bM.add(Qb));xb.Z(Qb,qc+1);return!0}))}Wsj(oa,cb){oa.forEach(xb=>{if(xb.Pc){const Qb=this.zd.Eb(xb.Qj);Qb&&!Uf.r(Qb)&&cb.Z(xb.Qj,0)}else cb.xb(xb.Qj)&&cb.remove(xb.Qj)})}}Object(e.a)(di,"CommentModelBootLoader",null,[263]);var Cb=d(1003);class wc{constructor(oa){this.kph=oa;this.Dnc=null;this.XQg=void 0;this.YQg=null;this.rsc=new Map;this.doe=new Map}Dnn(){Cb.a.HOa(this.pho.bind(this))}pho(oa,cb){let xb=oa.id.toString();var Qb=
oa.getValue(la.a.iE).toString();cb?(this.rsc.delete(xb),this.doe.delete(Qb)):(this.rsc.set(xb,oa),this.doe.set(Qb,oa));0===this.rsc.size&&this.Dnc&&(oa=+new Date-+this.Dnc,this.Dnc=null,a.ULS.sendTraceTag(543506649,327,50,`All Nodes Disconnected. Duration between first Node connection and all nodes disconnections : ${oa}`));cb||this.XQg!==Qb||(cb=+new Date-+this.YQg,a.ULS.sendTraceTag(541878464,327,15,`Deeplinked Comment added after deeplink navigation failed: ${cb}`),Qb=new H.a,Qb.durationMs=cb,
this.kph.logKpiFailure(ig.a.Ivd,"CommentFoundAfterDeeplinkAttempt",{isInternal:!0,additionalValues:Qb},{name:ig.a.Roh,isIntentional:!1,isInternal:!0,isSessionEndingError:!1,additionalValues:Qb}));this.Dnc||(this.Dnc=new Date)}set NIm(oa){this.XQg=oa;this.YQg=new Date;if(oa=this.jml(oa))a.ULS.sendTraceTag(538789919,327,15,`Deeplinked Comment ${oa.id} present but failed to load`),oa=new H.a,this.kph.logKpiFailure(ig.a.Ivd,"CommentPresentButFailedToLoad",{isInternal:!0},{name:ig.a.Roh,isIntentional:!1,
isInternal:!0,isSessionEndingError:!1,additionalValues:oa})}lml(){return[...this.rsc.keys()]}jml(oa){return this.doe.get(oa)}nOh(oa){return this.rsc.get(oa)}}Object(e.a)(wc,"CommentNodeTracker",null,[]);class Dd{constructor(oa,cb,xb,Qb,qc){this.$Uf=oa;this.$p=cb;this.hZ=xb;this.RJ=Qb;this.ui=qc;this.$Uf.vMi(this)}get contentType(){return 0}WVi(oa,cb,xb){0===cb?(cb=this.$p.FNc(oa),this.hZ.selectComment(cb?this.$p.Ly:this.$p.GB(oa),Object.assign(new gi.a,{pO:xb||cb,r3:1}))):this.RJ.clearSelection()}V2i(oa){return this.ui.mn||
this.$p.FNc(oa.contentId)?!0:this.$p.Bta(this.$p.GB(oa.contentId))}}Object(e.a)(Dd,"CommentReviewSuggestionContentActor",null,[262]);class Le{constructor(oa){this.Rvd=oa;this.q3f=new Set([12])}get t9i(){return this.q3f}initialize(){}Gli(oa){if(!mb.ParagraphReader.nc(oa.node))return[];oa=mb.ParagraphReader.Tzb(oa.node);return this.Rvd.i5l(oa)}hwi(){this.Rvd.APm()}}Object(e.a)(Le,"CommentReviewSuggestionContentProvider",null,[261]);var ff=d(60),mf=d(104),Qf=d(1542);class yf{constructor(){this.commentId=
null;this.gPc=!1}}Object(e.a)(yf,"CommentToSelectOnPaneLoadData",null,[]);class Hf{constructor(oa,cb,xb,Qb,qc,Mc,Gd,de,Id,Xe,hf,Ef,ng,Bh,fi){this.tq=oa;this.$p=cb;this.Bza=xb;this.hZ=Qb;this.xS=qc;this.ui=Mc;this.gDd=Gd;this.hr=de;this.wZb=Id;this.Y_a=Xe;this.zc=hf;this.hwf=Ef;this.Ci=ng;this.fj=Bh;this.WAk=fi;this.zc.pa(Dh.a.uKb,ff.a.frame,this.tq.uKb.bind(this.tq));this.zc.pa(Dh.a.cAd,ff.a.frame,this.cAd.bind(this));this.zc.pa(Dh.a.XXe,ff.a.frame,this.oQm.bind(this));this.zc.pa(Dh.a.jAk,ff.a.frame,
this.nQm.bind(this));this.zc.pa(Dh.a.lti,ff.a.frame,this.DUm.bind(this));this.zc.pa(Dh.a.lAh,ff.a.frame,this.yRm.bind(this));this.zc.pa(Dh.a.Yoh,ff.a.frame,this.TSm.bind(this));this.zc.gb(Dh.a.bYe,ff.a.frame,this.Kck.bind(this),64);this.zc.gb(Dh.a.Pvd,ff.a.frame,this.Uon.bind(this),64);this.zc.pa(Tg.a.selectComment,ff.a.frame,this.hZ.ODn.bind(this.hZ));this.hr.prm&&this.zc.pa(Tg.a.QRd,ff.a.frame,this.QRd.bind(this));this.R7g(Tg.a.CDc,!1);this.R7g(Tg.a.Y2e,!0);this.zc.gb(Tg.a.Svd,ff.a.frame,this.Svd.bind(this),
64);this.zc.pa(Tg.a.umi,ff.a.frame,mf.ActionManager.Nf);this.hr.Qvb&&this.zc.pa(Tg.a.KUe,ff.a.frame,this.hok.bind(this))}get ek(){return this.$p}get mode(){return this.tq.mode}get Uz(){return this.tq.Uz}get Gz(){return this.hr.vq}get Ui(){return this.Y_a.value}get Cb(){return this.hwf.value}get RJ(){return this.tq}cAd(oa,cb,xb,Qb,qc){return qc?qc?(oa=this.hZ.OEd(qc.NavigationId))&&this.hZ.PEd(oa,1)?32:8:(a.ULS.sendTraceTag(540160449,327,10,"ActionData could not be cast to dict: DoesCommentExist"),
8):(a.ULS.sendTraceTag(540160448,327,10,"No action data: DoesCommentExist"),8)}oQm(oa,cb,xb,Qb,qc){qc&&this.xS.xna("OnCommentInit",Object.assign(Object.assign({},new Qf.a),{UCa:()=>{var Mc=this.hZ.OEd(qc.NavigationId);if(Mc){var Gd=this.hZ.PEd(Mc,1);Gd?this.wZb.isVisible?(this.AZc(Gd,1),this.Ci.fC(Cg.AFrame.gr)):this.ek.Bta(Gd)?(Mc=Uf.q(Gd),this.hZ.selectComment(Gd,Object.assign(Object.assign({},new gi.a),{pO:!Mc,r3:1})),this.Ci.fC(Cg.AFrame.xL)):(this.ui.mn||this.zc.processAction(Dh.a.UX,2),Og.a.n1(v.AFrameworkApplication.uc,
()=>{this.AZc(Gd,1)},De.a.AZc)):this.zc.processAction(Dh.a.L0a,2)}}}));return 32}nQm(oa,cb,xb,Qb,qc){qc?(oa=this.ek.EHc(qc))?this.RJ.y$b(oa.id):a.ULS.sendTraceTag(540160450,327,10,"We were not able to find the comment referenced in the Activity Pane!"):this.RJ.y$b(null);return 32}DUm(oa,cb,xb,Qb,qc){if(qc){if(this.ui.ZBb){for(oa=0;oa<qc.length;oa++)this.ek.nYi(qc[oa]);this.tq.nIb()}else this.ek.L5j(qc);this.jzm(qc)}return 32}yRm(oa,cb,xb,Qb,qc){if(qc)if(this.ui.ZBb){for(oa=0;oa<qc.length;oa++)this.ek.nYi(qc[oa],
!0);this.tq.nIb()}else this.ek.Gwk();return 32}TSm(oa,cb,xb,Qb,qc){this.Gz||this.ui.mn||this.zc.processAction(Dh.a.UX,2);if(qc){oa=null;if(!this.Uz||2!==this.mode&&3!==this.mode){if(!qc)return 8;if(this.Gz)oa=this.X8k(qc);else for(cb=0;cb<qc.length&&(oa=this.ek.uZ(qc[cb].toString()),this.gDd.AOd&&(!oa||oa.done));cb++);}else oa=this.Uz;this.AZc(oa,1);oa&&this.ui.dX&&this.Ci.Jg(this.Gz&&!this.ui.mn?Cg.AFrame.xL:Cg.AFrame.gr)}else a.ULS.sendTraceTag(5017933,327,10,"We have hint but we couldn't find the paragraph that it belongs to!");
return 32}Kck(oa,cb,xb,Qb,qc){var Mc;if(!qc)return 32;if(qc&&0<qc.length){cb=oa=xb=0;Qb=!1;for(let Gd=0;Gd<qc.length;Gd++)qc[Gd].toString()===(null===(Mc=this.Uz)||void 0===Mc?void 0:Mc.objectId)?(Qb=!0,oa++):this.$p.Csf(qc[Gd])&&(Qb&&0===xb&&(xb=Gd,cb=oa),oa++);(Mc=this.$p.uZ(qc[xb].toString()))?(this.Bza.Cgc.VDf=cb+1,this.Bza.Cgc.Egc=oa,this.RJ.y$b(Mc.id)):(qc=qc[xb],this.Ui.Eb(qc)?a.ULS.sendTraceTag(540148256,327,10,`Comment Node with ObjectId ${qc} has no corresponding comment in Model`):a.ULS.sendTraceTag(540148257,
327,10,"Comment ObjectId:{0} is NOT in the model, but we are trying to hightlight!",qc.toString()))}return 32}Uon(){this.RJ.y$b(null);return 32}R7g(oa,cb){this.zc.pa(oa,ff.a.frame,(xb,Qb,qc)=>this.dRm(qc,cb))}QRd(oa,cb,xb){2===xb&&(oa=this.ek.IL.Rc(7),oa.Db(this.ek.BFa),cb=new dj.a,cb.Wea(`${String.fromCodePoint(128077)} \n`),this.$p.txb(cg.a.instance.hb.kb,void 0,cb),this.WAk.hLd(),oa.dispose());return 32}dRm(oa,cb=!1){if(2===oa)oa=this.ek.IL.Rc(15),oa.Db(this.ek.BFa),this.fj.Pd(()=>{this.CDc(cb)},
"ECM:DAC"),oa.dispose();else if(1===oa&&!this.ek.o4b())return 2;return 32}CDc(oa=!1){this.tq.mode=1;const cb=this.ek.gT();for(let xb of cb)xb.Sq===Cd.a.beingCreated||oa&&!xb.done||xb.Rf||this.tq.deleteComment(xb);this.Ci.Jg(Cg.AFrame.Zp);0<(oa?this.ek.gT().filter(xb=>xb.done):this.ek.gT()).length?a.ULS.sendTraceTag(540160454,327,10,"Not all comments were deleted. onlyDeleteResolved: {0}.",oa):a.ULS.sendTraceTag(540160455,327,50,"All comments were successfully deleted. onlyDeleteResolved: {0}.",oa)}Svd(oa,
cb,xb){if(2===xb)if(oa=this.Ci.og.name,oa!==Cg.AFrame.gr&&oa!==Cg.AFrame.xL){!this.Gz||this.ui.mn?(this.ui.mn||this.zc.processAction(Dh.a.UX,2),this.Ci.Jg(Cg.AFrame.gr)):this.Ci.Jg(Cg.AFrame.xL);var Qb=this.Cb.hb.kb;if(!Qb||!Qb.Qa)return 2;oa=Qb.Qa.cpBegin;cb=Qb.Qa.node;Qb=!!this.Uz&&(Eg.SelectionEditor.Qm(Qb)||Qb.QL)&&Uf.p(this.Uz,cb,this.Ui,oa);oa=!!this.Uz&&(2===this.mode||3===this.mode);if(Qb||oa)return this.RJ.YVi(this.Uz.id,!0),32;Qb=this.Gz&&!this.ui.mn?this.ek.oOh(!0,!0):null;this.RJ.XDn(Qb)}else this.ek.Ks&&
(this.tq.M4b.SVi(this.ek.Ks,!0),this.tq.M4b.pZa(null===(Qb=this.ek.Ks)||void 0===Qb?void 0:Qb.objectId)),this.Ci.Jg(Cg.AFrame.Zp);return 32}hok(){return 4}jzm(oa){const cb=new Set;for(let xb=0;xb<oa.length;xb++){const Qb=this.ek.EHc(oa[xb]);Qb&&cb.add(Qb.Rf?Qb.Rf:Qb.id)}a.ULS.sendTraceTag(540160456,327,50,"Threads with new comments: {0}",cb.size.toString())}AZc(oa,cb){oa?this.wZb&&!this.ui.dX?this.ui.$ab=Object.assign(new yf,{commentId:oa.id,gPc:!1}):this.hZ.selectComment(oa,Object.assign(new gi.a,
{pO:!!cb,r3:cb})):a.ULS.sendTraceTag(5017932,327,10,"We were not able to find the comment in the model!")}X8k(oa){let cb=null,xb=!1;for(let Qb=0;Qb<oa.length;Qb++){const qc=oa[Qb].toString();if(this.ek.Csf(oa[Qb])){cb||(cb=qc);if(xb&&this.ek.Ks.objectId!==qc)return this.ek.uZ(qc);xb=xb||!!this.ek.Ks&&this.ek.Ks.objectId===qc}}return cb?this.ek.uZ(cb):null}}Object(e.a)(Hf,"CommentsActionManager",null,[]);var Pg=d(199),Qe=d(39),Fb=d(171),af=d(1759),Ih=d(539),Yh=d(36),ql;(function(oa){oa[oa.ACo=0]="commentDeeplink";
oa[oa.catchUpActivity=1]="catchUpActivity"})(ql||(ql={}));Object(e.b)("DeeplinkSource",ql);class Hj{constructor(oa,cb,xb,Qb,qc,Mc,Gd,de,Id,Xe,hf,Ef,ng){this.ga=oa;this.ii=cb;this.pv=xb;this.Oke=Qb;this.PO=qc;this.U_g=Mc;this.Wb=Gd;this.tj=de;this.kf=Id;this.Wqb=Xe;this.Rke=hf;this.JM=Ef;this.GHe=!1;this.FOn=Bh=>{if(this.kf.vq&&!this.tj.mn){const fi=new qa.a(0,1,0,()=>{this.ZXi(Bh)},136,void 0,!0);v.AFrameworkApplication.uc.$b(fi)}else this.ZXi(Bh)};ng.execute(Bh=>{this.cN=Bh})}get $p(){return this.ii}get Cb(){return this.Wqb.value}WCh(oa){let cb=
oa.Sq===Cd.a.beingCreated?oa.Hy.draftId:oa.id,xb=null;oa.Rf&&(cb=oa.Rf,xb=()=>{this.U_g.selectComment(oa.id)});this.PO.setInitialActiveContainerId(cb,0,xb)}ODn(oa,cb,xb,Qb,qc){if(!qc.commentId)return 2;oa=this.ii.GB(qc.commentId);if(!oa)return 2;this.$jb(oa,qc);return 32}VVi(oa,cb){var xb,Qb;if(oa){var qc=(null===(Qb=null===(xb=this.ii.Ly)||void 0===xb?void 0:xb.Hy)||void 0===Qb?void 0:Qb.draftId)===oa?this.ii.Ly:this.ii.GB(oa);this.selectComment(qc,cb)}}selectComment(oa,cb){oa&&this.$jb(oa,cb)}TVi(oa,
cb){var xb=this.OEd(oa);xb&&((xb=this.PEd(xb,0))?cb.M_f?(this.tj.$ab=Object.assign(new yf,{commentId:xb.id,gPc:!0}),a.ULS.sendTraceTag(579608864,327,50,"Deep linking before comment pane fully loaded.")):(this.$jb(xb,Object.assign(new gi.a,{commentId:xb.id,r3:1,pO:!0,zNc:!0})),this.kf.vq&&void 0!==oa&&null!==oa&&this.WCh(xb),Og.a.n1(v.AFrameworkApplication.uc,()=>{this.Wb.Jg(this.kf.vq&&!this.tj.mn?Cg.AFrame.xL:Cg.AFrame.gr)},De.a.$Jn),Pg.a.instance.Tf(Qe.a.exh,(new Date).getTime()),oa=this.kf.vq?
"Deep linked discrete hosted comment":"Deep linked after comment pane fully loaded",oa+=", elapsed since boot: {0} ms",a.ULS.sendTraceTag(579608865,327,50,oa,(new Date).getTime()-v.AFrameworkApplication.bW)):this.ga.processAction(Dh.a.L0a,2))}OEd(oa){let cb=null;var xb=null;if(S.a.a7b(oa))cb=oa;else if(({Fv:xb}=B.d(oa)).returnValue&&(oa=xb))return Ih.a.comment in oa&&(cb=oa[Ih.a.comment]),cb;cb||(xb=xb?Object.keys(xb):null,a.ULS.shipAssertTag(579608866,327,!1,"Unrecognized navigation id. {0}",xb?
xb.join(","):"Not Json."));return cb?cb.toString():null}PEd(oa,cb){const xb=this.ii.EHc(oa),Qb=0===cb;Qb&&this.JM.logKpiUsage(ig.a.Ivd,0);if(!xb){a.ULS.sendTraceTag(579608867,327,15,"Comment durableCommentId={0} not found for deep linking. Source: {1}",oa,cb);const qc=new Yh.a;qc.name="DeepLinkSource";qc.string=ql[cb];this.JM.logActivity("CommentDeeplinkNotFound",{dataFields:[qc]});Qb&&(cb=new H.a,cb.extendedProperties=new Map([["ErrorLevel","warning"]]),this.JM.logKpiFailure(ig.a.Ivd,"CommentNotFound",
{isIntentional:!1,isInternal:!0,additionalValues:cb}),this.Rke.NIm=oa)}return xb}ZXi(oa){this.GHe=!0;this.Cb.setSelection(oa);this.GHe=!1}$jb(oa,cb){if(oa){this.tj.eGb&&(v.AFrameworkApplication.uc.We(this.tj.eGb),this.tj.eGb=null);var xb=this.ii.Ks,Qb=this.$p.Hgf(oa),qc=2===cb.r3,Mc={};qc&&(Mc.TriggeredByFindReplace=!0);if(this.tj.mn)qc&&(Mc.PaneAlreadyOpen=!0),Fb.UISurfaces.$t().then(Gd=>{Gd.setSelectedTaskPane(af.a.Tvd);return null});else if(oa.Sq!==Cd.a.beingCreated&&!this.$p.Bta(oa))this.tj.dX?
this.ga.processAction(Tg.a.UX,2):this.tj.$ab=Object.assign(new yf,{commentId:oa.id,gPc:cb.zNc}),qc&&(Mc.OpeningPaneToSelect=!0);else if(this.kf.vq){const Gd=Qb.Sq===Cd.a.beingCreated;Gd?this.PO.mPa(Qb.Hy.draftId,0,cb.pO):this.PO.mPa(Qb.id,0,cb.pO);!Gd&&qc&&(Mc.SelectingDHC=!0)}Og.a.n1(v.AFrameworkApplication.uc,()=>{this.tj.dX&&(cb.pO&&this.Wb.Jg(this.kf.vq&&!this.tj.mn?Cg.AFrame.xL:Cg.AFrame.gr),cb.zNc&&this.$p.Bta(oa)||!cb.pO&&!cb.r3||this.U_g.selectComment(oa.id))},De.a.$Xf);qc=this.$p.Hgf(xb);
this.kf.Qra&&this.cN&&qc&&qc.id!==Qb.id&&this.cN.fireEvent(9,{comment:qc});this.ii.selectComment(oa);this.kf.Qra&&this.cN&&oa.Sq===Cd.a.normal&&!oa.Rf&&this.cN.fireEvent(8,{comment:oa});this.Oke.highlightComment(oa,!0);this.pv.nH(0,Qb,xb);U.App.xa.updateCommandUI(!0);0<Object.keys(Mc).length&&this.JM.TB(Tg.a.selectComment,{customData:Mc})}}}Object(e.a)(Hj,"CommentSelectionActor",null,[251]);class Di extends Ic.a{constructor(){super();this.comment=this.commentId=null;this.H_=Object.assign(new qd.a,
{T_:Di.getTypeName(),B_:Di.getBaseTypes()})}static getTypeName(){return"AugLoop_SmartReply_CommentSmartReplySignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}}Object(e.a)(Di,"CommentSmartReplySignal",Ic.a,[]);class Mj extends wa.a{constructor(){super();this.DomainName=this.CommentId=null;this.ConfidenceLevel=0;this.ElapsedTime=this.ResultSets=null;this.H_=Object.assign(new qd.a,{T_:Mj.getTypeName(),B_:Mj.getBaseTypes()})}static getTypeName(){return"AugLoop_SmartReply_SmartReply"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}}
Object(e.a)(Mj,"SmartReply",wa.a,[]);var Bi=d(843);class zh{constructor(oa){this.bpa=oa}j_b(oa,cb){return Object.assign(new Bi.a,{parentPath:["Signal",Di.getTypeName()],items:[Object.assign(new Je.a,{body:Object.assign(new Di,{commentId:oa,comment:cb})})]})}cMf(oa){const cb=new Sa.a;if(oa&&oa.CommentId&&oa.ResultSets&&0<oa.ResultSets.length&&oa.ResultSets[0].Documents&&0<oa.ResultSets[0].Documents.length){for(const xb of oa.ResultSets[0].Documents)cb.add(xb.Caption);0<cb.count&&this.bpa.cMf(oa.CommentId,
cb.toArray())}else a.ULS.sendTraceTag(574493152,327,10,"Invalid response from SmartReplies request")}getTypeName(){return Mj.getTypeName()}}Object(e.a)(zh,"BaseCommentSmartReplyProvider",null,[938]);class Th extends zh{constructor(oa,cb,xb,Qb){super(oa);this.Jf=cb;this.HJ=xb;this.Fwj=Qb}initialize(){this.HJ.En().then(()=>{this.Jf.mb(this,zh.prototype.getTypeName.call(this))})}invoke(oa,cb){this.HJ.En().then(()=>{this.Fwj.getAugLoopRuntimeManager().submitOperation(Object.assign(new Sg.a,{operation:this.j_b(oa,
cb)}))})}wI(oa,cb){oa&&ha.a.getTypeNameFor(oa.content)===this.getTypeName()&&cb===Ca.a.getTypeName()?this.cMf(oa.content):a.ULS.sendTraceTag(579170963,327,10,"Invalid annotation event for smart replies")}}Object(e.a)(Th,"CommentSmartReplyProvider",zh,[250]);var Ci=d(29),tf=d(133),Zh=d(157);class kc{constructor(oa,cb,xb,Qb,qc,Mc){this.Oa=oa;this.Ac=cb;this.yx=xb;this.Bxe=Qb;this.Rke=qc;this.YI=Mc;this.cqb=!1;this.Rke.Dnn();this.hzj=this.eBl();this.lQf&&(Ci.a.addHandler(window.self,cc.a.Lah,()=>{this.cqb=
!0}),Ci.a.addHandler(window.self,cc.a.Mah,()=>{this.cqb=!1}))}get Sy(){return this.yx?this.yx.value:null}get Cza(){return this.Bxe.value}get ydo(){return this.cqb}get JKc(){return 0<this.hzj}get vq(){return this.YI.vq}get $Wk(){return!0}get Igk(){return this.Oa.getBooleanFeatureGate("Microsoft.Office.WordOnline.AutoPopulateShareTUIComment",!1)}get Dib(){return this.Oa.$("OutlineViewElementDisplayWrapperForDhcsIsEnabled")}get mLb(){return this.Ac.isFeatureEnabled(122)&&!Zh.App.COc}get cFn(){return this.Ac.isFeatureEnabled(35)&&
this.Oa.$("SendErrorReportOnCommentInboundCrashIsEnabled")}get IVd(){return this.Oa.getBooleanFeatureGate("Microsoft.Office.WordOnline.newCommentEntryPointEnabled",!1)}get XJa(){return this.Oa.getBooleanFeatureGate("Microsoft.Office.WordOnline.CommentSVGIconsEnabled",!1)}get PXl(){return this.Oa.getBooleanFeatureGate("Microsoft.Office.WordOnline.HiddenRibbonCommentFocusFixEnabled",!1)}get Koh(){return this.Oa.$("CommentAnchorHighlightOnIpSelectionIsEnabled")}get lQf(){return this.Oa.$("RecordCommentActionsInTypingIsEnabled")}get Rti(){return this.Oa.$("NoHighlightWhenCommentDraftInProgressIsEnabled")}get cyb(){return this.vq&&
!this.JKc&&!this.Oa.lb("BootActivityNavigationId")&&F.a.Ys}get Qvb(){return this.Ac.isFeatureEnabled(6)}get Ifk(){return this.Oa.$("AtMentionUserFloodGateCampaignIsEnabled")}get xAk(){return this.Oa.$("CommentFriendlyTimestampsIsEnabled")}get VWk(){return this.Oa.lb("DisabledChangeGatesInSharedComments")}get hDd(){return this.YI.hDd}get GKb(){return this.Oa.getBooleanFeatureGate("Microsoft.Office.WordOnline.WordTrackChangesSimpleMarkupView",!1)}get bab(){return this.Ac.isFeatureEnabled(15)}get x1f(){return this.Oa.getBooleanFeatureGate("Microsoft.Office.WordOnline.SmartRepliesIsEnabled",
!1)}get CX(){return this.Oa.lb("PresenceUserId")}get removePersonalInformation(){return Zh.App.qee&&!!tf.PageReader.instance&&tf.PageReader.instance.Dea(U.App.xa.jb.Yc).removePersonalInformation}get ZCb(){return this.Ac.isFeatureEnabled(52)}get qcb(){return this.Oa.getBooleanFeatureGate("Microsoft.Office.WordOnline.EnableDurableIdForIdentification",!1)}get nsm(){return this.Oa.getBooleanFeatureGate("Microsoft.Office.WordOnline.SharedCommentsLivePersonaCardForWeb",!1)}get J6n(){return this.Oa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TaskHistoryRecordIDs",
!1)}get oBk(){return this.Oa.$("CommentsTasksFpsIsEnabled")}get trackChangeInSidetrackEnabled(){return this.Oa.getBooleanFeatureGate("Microsoft.Office.WordOnline.TCCardInSideTrack",!1)}get cBk(){return this.Oa.getBooleanFeatureGate("Microsoft.Office.WordOnline.ReactionsFPSEnabled",!1)}get prm(){return this.Oa.getBooleanFeatureGate("Microsoft.Office.WordOnline.LikeSelectedContentFlotie",!1)}get contentNavigationApiEnabled(){return this.YI.contentNavigationApiEnabled}get T_m(){return this.Ac.isFeatureEnabled(88)}get Qra(){return this.Oa.getBooleanFeatureGate("Microsoft.Office.WordOnline.CommentEventAPIEnabled",
!1)}get contentFilterApiEnabled(){return this.YI.contentFilterApiEnabled}eBl(){if(this.Sy&&this.Cza){const oa=new le.GraphIterator;oa.set(this.Sy);this.Cza.G0a(oa);let cb=0;39===oa.Qe&&(cb=oa.Jp());return cb}return-1}}Object(e.a)(kc,"CommentsSettings",null,[]);var Nm=d(1568),Nj=d(1355);class Sd{constructor(oa){this.e8=oa}rhh(oa,cb,xb){const Qb=new mh;cb=this.e8.M_a(cb)?cb.objectId:null;if(!cb)return Qb;cb=ka.a.Of(cb);if(xb.contains(cb))return Qb.eMc=0,Qb.dMc=oa.length,Qb;for(let Mc=0,Gd=oa.length;Mc<
Gd;Mc++){var qc=oa[Mc];xb=Uf.g(qc);qc=Uf.d(qc);xb&&Nj.a.Hqh(xb,cb)&&(Qb.eMc=Mc);if(qc&&Nj.a.Hqh(qc,cb)){Qb.dMc=Mc;break}}return Qb}Och(oa,cb,xb){const Qb=-1===cb.eMc&&-1===cb.dMc,qc=-1<cb.eMc?cb.eMc:-1;cb=-1<cb.dMc?cb.dMc:oa.length;const Mc=!Qb&&qc===cb;var Gd=!1;for(let de=0;de<oa.length;de++){const Id=oa[de],Xe=pe.a(Id);if(1!==Xe&&2!==Xe&&3!==Xe)continue;this.e8.W1a(Id);if(Qb||de<qc||de>cb)continue;const hf=3===Xe||2===Xe&&-1!==Id.className.indexOf(rh.a.pta),Ef=xb?1:2;this.Hdk(de,qc,cb,Ef,hf,Gd,
Id,Mc);if(de!==cb||Mc)(Gd=this.e8.oZa.J(Xe).J(Ef))&&Id.classList.add(Gd),Gd=hf}}Hdk(oa,cb,xb,Qb,qc,Mc,Gd,de){oa!==cb&&oa!==xb||qc||Mc||((oa=this.e8.Uac.J(Qb))&&Gd.classList.add(oa),de&&Gd.classList.add(rh.a.DLf))}}Object(e.a)(Sd,"DefaultHighlightChangeHandler",null,[249]);var ue;(function(oa){oa[oa.success=0]="success";oa[oa.noSelection=1]="noSelection";oa[oa.invalidContent=2]="invalidContent"})(ue||(ue={}));Object(e.b)("AnchorCreationResult",ue);var Ri=d(78),Ei=d(25),od=d(293),co=d(247),cd=d(1184);
class ii{}Object(e.a)(ii,"EditorAnchorInfo",null,[254]);class pg{constructor(oa,cb,xb,Qb,qc,Mc,Gd,de){this.Qqm=oa;this.hwf=cb;this.ek=xb;this.DZa=Qb;this.Bza=qc;this.Hu=Mc;this.xS=Gd;this.hr=de;this.L_g=null;this.DZa.ujb(this.Bza);this.hr.contentFilterApiEnabled&&(this.xS.oga("OnCommentPaneOpen",this.jjo.bind(this)),this.xS.oga("OnCommentPaneClose",this.ijo.bind(this)),this.xS.oga("OnContentFilterUpdate",this.BTc.bind(this)))}get Cb(){return this.hwf.value}get Ui(){return this.Qqm.value}initialize(){}l3l(oa){this.L_g=
oa}dispose(){}pZa(oa){this.Bza.pZa(oa)}OBb(oa){this.Bza.OBb(oa)}highlightComment(oa){this.SVi(oa,!1);this.Bza.pZa(oa.objectId)}phc(oa){this.Bza.phc(oa)}YAa(oa){return this.Bza.YAa(oa)}BTc(){this.$fe("OnContentFilterUpdate")}jjo(){this.$fe("OnCommentPaneOpen")}ijo(){this.$fe("OnCommentPaneClose")}$fe(oa){const cb=[],xb=new Set;for(let qc of this.ek.gT())if(!qc.Rf&&qc.Sq!==Cd.a.beingCreated&&!this.ek.RJ.Jjh(oa,qc)){var Qb=this.UBl(qc);xb.has(Qb.id.toString())||(xb.add(Qb.id.toString()),(Qb=Qb.Ce(Ri.InteractiveViewManager.instance.xd.Tb))&&
cb.push(Qb))}cb.forEach(qc=>{this.DZa.qhc(qc)})}UBl(oa){var cb,xb;const Qb=null===(cb=this.Ui)||void 0===cb?void 0:cb.Eb(oa.objectId);if(!Qb)return null;oa=Uf.k(Qb);cb=null===(xb=this.Ui)||void 0===xb?void 0:xb.Eb(oa);return ej.a.JVh(cb)}SVi(oa,cb){if(!oa.Sq){var xb=this.Ui.Eb(ka.a.Of(oa.objectId)),Qb=Sh.a.h$(xb,this.Ui,!0);xb=Sh.a.h$(xb,this.Ui,!1);if(Qb&&xb){const qc=Qb.Ob.paragraph;Qb=Qb.Ob.cp;if(this.mkm(qc,Qb))U.App.xa.updateCommandUI(!0);else{Qb=Ei.SelectionFactory.xe(qc,Qb);xb=md.a.Uc(xb.Ob.paragraph,
xb.Ob.cp);if(pg.Zf.T$(Qb.Qa)||pg.Zf.T$(xb))oa.U6b=!0,oa.D0a();oa=cb?Ei.SelectionFactory.XC(Qb,xb):Qb;this.L_g(oa)}}}}twk(){this.Bza.OBb(null);this.Bza.pZa(null)}uHk(){let oa=new ii;return{returnValue:ue.success,anchor:oa}}mkm(oa,cb){if(oa&&Object(sk.a)(cd.PageView,this.Hu.xd)){var xb=oa.Ce(this.Hu.xd.Tb);oa=document.getElementById(ye.AppFrame.AFa);if(xb&&oa){cb=od.a.rq(xb,cb);if(!cb)return!1;cb=cb.y;xb=Sys.UI.DomElement.getBounds(oa).y;oa=oa.offsetHeight;if(cb>=xb&&cb<=xb+oa)return!0}}return!1}static get Zf(){return co.a.instance}static getInstance(){return pg.Gl()}static Gl(){return pg._instance||
(pg._instance=new pg(new P.a(()=>U.App.xa.jb.Yc.zd),new P.a(()=>cg.a.instance),O.a.instance.resolve("WordEditor.Comments.IEditorCommentModel"),O.a.instance.resolve("Box4.Indicator.IIndicatorManagerFactory").instance,O.a.instance.resolve("WordEditor.Comments.CommentHintActor"),Ri.InteractiveViewManager.instance,O.a.instance.resolve("WordEditor.Comments.WordCommentEventsActor"),O.a.instance.resolve("WordEditor.Comments.CommentsSettings")))}}pg._instance=null;Object(e.a)(pg,"EditorCommentHintManager",
null,[247,248,9]);var qn=d(1908),yk=d(372),xj=d(1127);class eo extends gm.a{constructor(oa,cb,xb,Qb,qc,Mc,Gd,de,Id,Xe,hf,Ef,ng,Bh,fi,jj,Qg,sh,Sk,Vf,Pk,oj,vi,kj,Vl,lh){super(Gd);this.Bi=cb;this.Wqb=de;this.WXe=Xe;this.cpa=hf;this.Zkc=Ef;this.PO=ng;this.kf=Bh;this.zp=fi;this.Unb=jj;this.tj=Qg;this.k4=sh;this.le=Vf;this.JM=Pk;this.Ih=oj;this.yS=kj;this.aYe=Vl;this.I4h=this.I1g=this.ySa=null;this.Vhb=()=>{this.xwa.Pta()&&(this.nMi(this.xwa.Ic),this.xwa.lcc(this.Vhb))};this.jSc=Yg=>{2===Yg.mode?this.nC=
1:1===Yg.mode&&(this.nC=0);this.ii.Ly&&0===this.nC?a.ULS.sendTraceTag(542914062,327,50,"Switch to read only mode while drafting a comment with drafting session type [{0}].",this.ii.Ly.Hy.sessionType):this.tj.dX&&(this.Gz||this.p0.isVisible)&&this.nIb()};this.GOm=()=>{this.tj.ZBb?this.mode=0:this.nC=0};this.gDa=(Yg,Fi)=>{var Zj;Yg=Fi.ll.kb;if((this.Gz||this.Faa&&this.Faa.isVisible)&&!this.Unb.GHe&&Yg){Fi=Eg.SelectionEditor.Qm(Yg);var Um=Yg.QL;!this.kf.IVd||null!==(Zj=this.I4h)&&void 0!==Zj&&Zj.V9||
(Zj=this.$p.Kfb(this.ga,!1),1!==this.mode||Fi&&!Um||!Zj?this.Zkc.hLd():this.gLk(Yg));2!==this.mode&&3!==this.mode&&this.kf.Koh&&this.Sbo(Yg,Fi,Um)}};this.guk=()=>{if(this.ek&&this.ek.Ly&&(!U.App.VMa||!U.App.Yof)){var Yg=this.ek.Ly;Yg.Hy.sessionType!==qn.a.metadata&&(a.ULS.sendTraceTag(545640771,327,15,`Draft Comment of type:${Yg.Sq} present on app shutdown`),(Yg=ej.a.sql(Yg))&&this.JM.logKpiFailure(Yg,"CommentDraftLostOnAppShutdown",{isInternal:!0},{name:ig.a.uBc,isIntentional:!1,isInternal:!0,isSessionEndingError:!1}))}};
this.POm=()=>{if(this.tj.dX){var Yg=()=>!0;this.Gz&&!this.tj.mn&&(Yg=Fi=>this.$p.Bta(Fi));Yg=this.$p.Sbf(Yg);this.nIb(Yg)}};this.ga=Gd;this.nC=1===this.ga.mode?0:1;this.p0=qc;this.ii=Qb;this.r8=Mc;this.Wb=Id;this.Dmn();xb.tjb(this.cpa);(this.kf.Koh||this.kf.IVd)&&this.Cb.oB(this.gDa);oa.CWR(()=>oa.result.ZA.qVa(this.GOm));v.AFrameworkApplication.ua&&v.AFrameworkApplication.ua.oVa(this.jSc);this.k4.oga("OnAfterTrackChangeMarkupViewChange",this.POm);v.AFrameworkApplication.xK&&v.AFrameworkApplication.xK(this.guk);
lh.execute(Yg=>{this.cN=Yg});vi.execute(Yg=>{Yg.ZEk.execute(Fi=>{this.I4h=Fi})})}Dmn(){this.xwa&&(this.xwa.Pta()?this.nMi(this.xwa.Ic):this.xwa.cXb(this.Vhb))}nMi(oa){oa.yja(()=>{this.g2n()})}get xwa(){var oa;return null===(oa=Zh.App.fm)||void 0===oa?void 0:oa.jb}get Cb(){return this.Wqb.value}get ek(){return this.ii}get $p(){return this.ii}get Gz(){return this.kf.vq}get Ati(){return!0}get S4b(){return this.ySa}set S4b(oa){this.ySa=oa}get mode(){return super.mode}set mode(oa){oa!==this.nC&&(super.mode=
oa,this.D0a())}get Uz(){return this.model&&this.model.Ks?this.model.Ks.Rf?this.model.GB(this.model.Ks.Rf):this.model.Ks:null}get Ui(){return this.Bi.value}get o4i(){return!1}get removePersonalInformation(){return this.kf.removePersonalInformation}nIb(oa=null,cb=null){const xb=this.$p,Qb=!this.nC,qc=this.Faa.vAk,Mc=xb.XGd();qc.J8f(Mc?5:1,Qb);oa=this.kf.GKb&&oa?oa:xb.mcf(this.kf.GKb&&this.Gz&&!this.tj.mn);qc.XEn(oa,Mc,xb.qRa);this.p8f();cb&&a.ULS.sendTraceTag(572281362,327,50,cb)}CTc(oa,cb,xb=!1){this.tj.mn?
this.PO.Eij():cb?this.PO.deleteContainer(oa.Sq===Cd.a.beingCreated?oa.Hy.draftId:oa.id,0,xb):this.ufn(oa)}ufn(oa){const {s8n:cb}=this.ii.Fvl(oa),xb=this.r8.YAa(oa.objectId);xb&&this.PO.addContainer(oa.id,xb.parentElement,0,cb)}bWi(oa){const cb=this.Uz;this.CZc();this.cpa.nH(0,this.ii.Ks,cb);this.Gz&&this.ii.Ks&&!this.tj.mn&&this.PO.mPa(this.ii.Ks.id,0,1===oa)}YDn(){const oa=this.Uz;this.DZc();this.cpa.nH(0,this.ii.Ks,oa);this.Gz&&this.ii.Ks&&!this.tj.mn&&this.PO.mPa(this.ii.Ks.id,0,!1)}phc(oa){this.r8.phc(oa)}Z0k(oa,
cb){this.PO.addContainer(oa,null,0,cb)}G3m(oa){this.PO.jEi(oa)}a1k(oa,cb){this.PO.lYc(oa,cb,0)}uio(){this.PO.eSe()}UVi(oa){if(oa&&(2!==this.mode||oa.Sq===Cd.a.beingCreated)){var cb=this.ii.Ks;cb!==oa&&(this.ii.selectComment(oa),this.p0.isVisible?this.tj.dX?(this.p0.selectComment(oa,1),this.jia.selectComment(oa.id)):this.tj.$ab=Object.assign(new yf,{commentId:oa.id,gPc:!1}):this.Gz&&!oa.done&&(this.YVi(oa.id,!1),this.jia.selectComment(oa.id)),!this.p0.isVisible&&this.Gz&&oa.done||(this.M4b.pZa(oa.objectId),
this.cpa.nH(0,this.Uz,cb)))}}qMc(){}F6e(){this.tj.ZBb=!1}Yub(oa){this.kf.Rti&&this.ii.Ks&&this.clearSelection();super.Yub(oa);this.JM.logKpiUsage(ig.a.hYe,0);this.p8f();if(this.Gz){const cb=this.ii.qMl(oa.draftId);this.Z0k(oa.draftId,cb)}}addReply(oa,cb){this.JM.logKpiUsage(ig.a.Vvd,0);super.addReply(oa,cb)}Rra(oa){this.Gz&&null!=oa.Hy&&this.ii.qNi(oa.Hy.draftId);super.Rra(oa);this.r8.pZa(oa.objectId);a.ULS.sendTraceTag(50426376,327,50,"{0}:  added by user action.",Uf.a(oa));this.JM.logKpiUsage(ig.a.Poh,
0);this.kuk(oa);ej.a.Upo(oa,this.Ui,this.JM);this.JM.TB(Tg.a.Ooh,{succeeded:!0,customData:{actionType:oa.Rf?qn.a.reply:qn.a.create}})}bbb(oa){super.bbb(oa);this.JM.TB(Tg.a.Ooh,{succeeded:!0,customData:{actionType:qn.a.edit}})}kuk(oa){if(oa.Rf){var cb=this.ii.Hgf(oa);if(cb.Gyc&&cb.Hyc){var xb=this.Ui.Eb(ka.a.Of(cb.Hyc));cb=cb.Hyc===cb.Gyc?null:this.Ui.Eb(ka.a.Of(cb.Gyc));ej.a.Gcg(xb,oa,!0);ej.a.Gcg(cb,oa,!1)}}}DDc(oa){super.DDc(oa);this.Uz&&this.Uz.id===oa.id&&(super.clearSelection(),this.Gz&&this.PO.eZb());
if(this.Gz)if(Uf.q(oa)){var cb=[];let xb=null;for(let Qb of this.model.gT())Qb!==oa&&(Qb.Rf===oa.Rf&&cb.push(Qb),Qb.id===oa.Rf&&(xb=Qb));xb&&xb.id&&xb.objectId&&!xb.done&&this.$p.HF(xb.objectId)&&!this.$p.VEi(xb.objectId)&&!cb.length&&this.CTc(xb,!0)}else cb=oa.Sq===Cd.a.beingCreated,oa.done||this.CTc(oa,!0),cb&&this.ii.qNi(oa.Hy.draftId)}editComment(oa,cb){1===this.mode&&oa&&(this.ii.KEc(oa,cb),qn.a.edit===cb.sessionType&&this.JM.logKpiUsage(ig.a.Uoh,0),this.kf.mLb&&3!==qn.a.Sef(cb.sessionType)?
this.Unb.selectComment(oa,Object.assign(new gi.a,{pO:!1,r3:0})):this.kf.bab||this.Unb.selectComment(oa,Object.assign(new gi.a,{pO:!1,r3:0})))}G5d(oa){this.Gz&&!this.tj.mn||super.G5d(oa)}deleteComment(oa){oa.Sq!==Cd.a.beingCreated&&this.$p.syh(ka.a.Of(oa.objectId));this.ySa&&this.ySa.id===oa.id&&(this.ii.Ks&&this.ySa.id===this.ii.Ks.id?this.ySa=null:this.cpa.UWe());!this.ii.Ks||this.ii.Ks.id!==oa.id&&this.ii.Ks.Rf!==oa.id?this.ii.Ks&&this.cpa.nH(0,this.ii.Ks,null):void 0===oa.Rf||null===oa.Rf?this.clearSelection():
this.ii.selectComment(this.ii.GB(oa.Rf));oa.U6b&&a.ULS.sendTraceTag(556360779,327,50,"The comment selected for deletion is currently locked: {0}.",Uf.a(oa));super.deleteComment(oa);a.ULS.sendTraceTag(50426377,327,50,`${Uf.a(oa)} deleted by user action. DurableId: ${oa.xKa}`)}vwb(oa,cb){super.vwb(oa,cb);this.Gz&&!this.tj.mn&&cb&&(this.ii.Ks&&this.ii.Ks.id===oa.id&&this.clearSelection(),this.S4b&&this.S4b.id===oa.id&&this.cpa.UWe())}XDn(oa=null){(oa=this.$p.hml(oa))?this.Unb.selectComment(oa,Object.assign(new gi.a,
{pO:!0,r3:1})):this.bWi(1)}gLk(oa){var cb=oa.Qa.node;let xb=Nh.OutlineElementNavigator.Uk(cb);this.Ih.Pd(()=>{const qc=le.GraphIterator.$a(xb);let Mc=null;do qc.qo()&&(Mc=qc.parentNode?Nh.OutlineElementNavigator.Uk(qc.parentNode):null)&&(xb=Mc,qc.set(xb));while(Mc)},"ECM:FOOE");if(null===xb||void 0===xb?0:xb.wD)for(var Qb of xb.wD)if(Qb&&Qb instanceof yk.a){const qc=xj.a.Kuh(Qb);this.Zkc.zde=this.H7k(cb,oa);oa=this.qpk(qc);if(cb=this.Zkc.v7k(qc,oa))qc.KBa[oa].appendChild(cb),Qb.ix(cb);break}}H7k(oa,
cb){let xb;for(let Qb of oa.wD)if(Qb&&Qb){xb=Qb;break}oa=cb.Qa.hl;return 0>oa||null===xb||void 0===xb||!xb.eop?null:od.a.aZ(oa,xb,!1,!1)}qpk(oa){var cb;if(!oa.E$||2>oa.E$.length)return 0;let xb=0;const Qb=null===(cb=this.Zkc.zde)||void 0===cb?void 0:cb.y;for(cb=1;cb<oa.E$.length;cb++)if(Qb>=oa.E$[cb].y-2)xb=cb;else break;return xb}D0a(){U.App.VMa&&(U.App.yeb=2===this.mode||3===this.mode);1!==this.mode&&this.Zkc.hLd()}Sbo(oa,cb,xb){const Qb=this.Wb.og;let qc=null;if(cb||xb){cb=oa.Qa.cpBegin;oa=oa.Qa.node;
if(this.Uz&&Uf.p(this.Uz,oa,this.Ui,cb))return;qc=this.Vzl(oa,cb)}qc?!this.Gz||this.tj.mn?Og.a.n1(v.AFrameworkApplication.uc,()=>{this.UVi(qc)},De.a.QDn):this.UVi(qc):!this.ii.Ks||Qb&&Qb.name===Cg.AFrame.xL||this.clearSelection()}Vzl(oa,cb){let xb=null;const Qb=this.model.gT();for(let qc=Qb.length-1;0<=qc;qc--){const Mc=Qb[qc];if(Mc.objectId&&!(Mc.Rf||this.Gz&&!this.Faa.isVisible&&Mc.done)&&Uf.p(Mc,oa,this.Ui,cb)){xb=Mc;break}}return xb}selectComment(oa,cb=1){this.Unb.VVi(oa,Object.assign(new gi.a,
{pO:1===cb,r3:cb}))}YVi(oa,cb){const xb=this.ii.GB(oa);xb?this.Gz&&!Uf.q(xb)&&xb.Sq!==Cd.a.beingCreated&&this.PO.mPa(oa,0,cb):a.ULS.sendTraceTag(42332933,327,10,"Selected Comment isn't in the model.")}clearSelection(){const oa=this.model.Ks;this.kf.Qra&&this.cN&&oa&&this.cN.fireEvent(9,{comment:oa});super.clearSelection();this.cpa.nH(1,oa,oa);this.Gz&&oa&&this.PO.eZb()}Ojm(){var oa;return 500>(null===(oa=this.I1g)||void 0===oa?void 0:oa.oi)}y$b(oa,cb=1){if(!this.kf.Rti||!this.ii.Ly){var xb=this.ii.GB(oa),
Qb=null;xb||(Qb=this.ySa);var qc=this.Ojm(),Mc=!1;1===cb&&this.jia&&(qc?Mc=!0:this.jia.highlightComment(oa));oa?xb?qc?Mc=!0:this.r8.OBb(xb.objectId):a.ULS.sendTraceTag(37323346,327,10,"Comment is NOT in the model, but we are trying to hightlight!"):this.r8.OBb(null);xb?qc?Mc=!0:(this.ySa=xb,this.cpa.nH(2,xb,Qb)):(this.ySa=null,this.cpa.nH(3,null,Qb));Mc&&a.ULS.sendTraceTag(544532572,327,50,"Comment highlighting was skipped due to the user actively scrolling.")}}g2n(){this.le&&(this.I1g=this.le.hg("UserAction",
"StartScrollDetectionStopwatch"))}notify(oa,cb){this.zp.sendNotification(oa,cb)}p8f(){this.aYe.onContentChanged()}Jjh(oa,cb){var xb,Qb;switch(oa){case "OnCommentPaneOpen":case "OnCommentPaneClose":return this.$p.Bta(cb)===this.aYe.isContentInFilteredContent(cb.id);case "OnContentFilterUpdate":return!(null===(Qb=(xb=this.aYe).isContentInFilterUpdateDiff)||void 0===Qb?0:Qb.call(xb,cb.id));default:return!0}}static getInstance(){return eo.Gl()}static Gl(){eo.Kg||(eo.Kg=new eo(U.App.Cla(),new P.a(()=>
U.App.xa.jb.Yc.zd),O.a.instance.resolve("Box4.Highlight.IHighlightManagerFactory").instance,O.a.instance.resolve("Common.Comments.ICommentModel"),O.a.instance.resolve("Common.Comments.ICommentPane"),pg.getInstance(),v.AFrameworkApplication.ya,new P.a(()=>cg.a.instance),xl.FocusManager.instance(),O.a.instance.resolve("WordEditor.Comments.IWordEditorSharedCommentAPI"),O.a.instance.resolve("WordEditor.Comments.ICommentHighlightActor"),O.a.instance.resolve("WordEditor.Comments.CommentMarginEntryPointActor"),
O.a.instance.resolve("WordEditor.Comments.IFloatingCommentManager"),O.a.instance.resolve("WordEditor.Comments.CommentsSettings"),O.a.instance.resolve("Common.Utils.IAriaNotifier"),O.a.instance.resolve("WordEditor.Comments.ICommentSelectionActor"),O.a.instance.resolve("WordEditor.Comments.CommentsState"),O.a.instance.resolve("WordEditor.Comments.WordCommentEventsActor"),Zh.App.fm.jb.Ic,U.App.xa.jq,O.a.instance.resolve("WordEditor.Comments.ICommentsUsageAndHealthLogger"),J.a.instance,O.a.instance.Za("WordEditor.HeaderFooter.HeaderFooterControlOwner"),
O.a.instance.resolve("WordEditor.Comments.ICommentFloatingContainerActor"),O.a.instance.resolve("WordEditor.ReviewSuggestionContent.WordContentFilterAPI"),O.a.instance.Za("WordEditor.Extension.RichApiEventManager")),eo.Kg.$Jb=!0);return eo.Kg}}eo.Kg=null;Object(e.a)(eo,"EditorCommentManager",gm.a,[244,245,246,9]);var ui=d(1695);class yc{constructor(oa,cb,xb,Qb){this.cancelButton=this.confirmButton=this.body=this.title=null;this.title=oa;this.body=cb;this.confirmButton=xb;this.cancelButton=Qb}}Object(e.a)(yc,
"ViewContainerModalDialogStrings",null,[]);var rg=d(333);d(1461);class Tj{constructor(oa,cb){this.canvasContextId=this.canvasActionId=0;this.withFlags=!1;this.postCallback=this.registeredCallback=this.preCallback=null;this.delayActionsUntilRegistration=!1;this.canvasActionId=oa;this.canvasContextId=cb}}Object(e.a)(Tj,"CommentUIAction",null,[]);var yl=d(1016);class xg{constructor(oa,cb,xb,Qb,qc,Mc,Gd,de,Id,Xe,hf,Ef,ng,Bh,fi,jj,Qg){this.ga=oa;this.ig=cb;this.ke=xb;this.Wb=Qb;this.Oo=qc;this.Eh=Mc;this.lP=
Gd;this.bpa=de;this.opd=Id;this.gMe=Xe;this.Hb=hf;this.PO=Ef;this.kf=ng;this.tj=Bh;this.Unb=fi;this.k4=jj;this.gia=Qg;this.Oke=this.aj=null;this.P_g=this.gug=!1;this.Ztc=null;this.yXn=(sh,Sk,Vf)=>2!==Vf||this.tj.dX?1===Vf?32:2:(this.k4.xna("OnCommentInit",Object.assign(new Qf.a,{UCa:()=>{this.ga.processAction(Dh.a.UX,2)}})),32);this.E7h=(sh,Sk,Vf)=>1!==Vf||this.tj.dX?2:8;this.L0j=(sh,Sk,Vf)=>{if(1===Vf)return!this.Kfb()||this.K$a?8:this.tj.dX?2:32;if(!this.tj.dX)return this.K$a=!0,this.k4.xna("OnCommentInit",
Object.assign(new Qf.a,{UCa:()=>{this.vq||this.tj.mn||this.ga.processAction(Dh.a.UX,2)}})),32;this.vq||this.tj.mn||this.ga.processAction(Dh.a.UX,2);(this.vq||this.tj.mn)&&this.Wb.Jg(this.tj.mn?Cg.AFrame.gr:Cg.AFrame.xL);return 2};this.hSk=(sh,Sk,Vf)=>1===Vf&&uc.SessionStatusManager.instance.Sj?8:2;this.EWk=(sh,Sk,Vf,Pk)=>1!==Pk||(this.vq||this.isVisible)&&this.aj.model.Ks?sh||this.aj.model.Ks?32:8:8;this.Neb=(sh,Sk,Vf,Pk,oj)=>{if(1===Vf||!this.tj.mn)return 32;if(!this.vq&&2===Vf&&(2===this.aj.mode||
3===this.aj.mode))return oj=new yc(CommentPaneStrings.DiscardDialogTitle,CommentPaneStrings.DiscardDialogBody,CommentPaneStrings.DiscardDialogAbandon,CommentPaneStrings.DiscardDialogResume),this.opd.invokeModalConfirmationDialog(()=>{this.EQm(sh,Sk,Vf,Pk)},()=>{this.IPm()},oj),32;this.jLd();if(this.vq)return 32;oj&&this.UCh();return 32};this.ZHb=(sh,Sk,Vf,Pk,oj)=>{if(1===Vf)return 32;oj[rg.a.On]=this.isVisible;return 32};this.bjc=this.qHk()}get isVisible(){return this.tj.mn}get K$a(){return this.gug}set K$a(oa){this.gug=
oa}get LRn(){return"SharedCommentsTaskPaneProps"}get DUc(){return null}get mti(){return null}get aT(){return this.Oo}get Faa(){return null}get vAk(){return this.bpa}get vq(){try{return this.kf.vq}catch(oa){return!1}}aUh(){return new si(v.AFrameworkApplication.isRtl,Sys.CultureInfo.CurrentCulture.name,v.AFrameworkApplication.uiCulture,v.AFrameworkApplication.dataCulture)}qHk(){const oa=new fh.a,cb=new Tj(Dh.a.newComment,ff.a.frame);cb.preCallback=this.L0j;const xb=new Tj(Tg.a.QDf,ff.a.frame),Qb=new Tj(Tg.a.PMf,
ff.a.frame),qc=new Tj(Tg.a.deleteComment,ff.a.frame);qc.preCallback=this.hSk;qc.postCallback=this.EWk;this.vq&&(xb.preCallback=this.E7h,Qb.preCallback=this.E7h);const Mc=new Tj(Dh.a.UX,ff.a.frame);Mc.preCallback=this.yXn;oa.Z(6,Mc);oa.Z(0,cb);oa.Z(1,xb);oa.Z(2,Qb);oa.Z(3,qc);return oa}w1i(oa){this.P_g||(this.oXj=this.LHd(),this.lP.iKa(),this.ZQn(),this.VQn(oa),this.P_g=!0)}VQn(oa){this.aj=oa;this.Oke=oa.M4b;this.aj.bFh=this.bpa}initialize(oa){this.w1i(oa);this.Vb()}ynf(){this.Ztc&&this.Wb.Jg(Cg.AFrame.gr);
this.K$a&&!this.vq?(this.ga.processAction(Dh.a.newComment,2),this.K$a=!1):this.tj.$ab&&Og.a.n1(v.AFrameworkApplication.uc,()=>{const oa=this.tj.$ab.commentId,cb=this.tj.$ab.gPc;this.ga.Xb(Tg.a.selectComment,2,Object.assign(new gi.a,{commentId:oa,r3:1,pO:!0,zNc:cb}));cb&&(Og.a.n1(v.AFrameworkApplication.uc,()=>{this.Wb.Jg(Cg.AFrame.gr)},De.a.$Xf),Pg.a.instance.Tf(Qe.a.exh,(new Date).getTime()));a.ULS.sendTraceTag(35149083,327,50,"Comment selected in shared comment pane after boot: {0}",(new Date).getTime()-
v.AFrameworkApplication.bW);this.tj.$ab=null},De.a.PDn)}dispose(){}z3(){}selectComment(){this.isVisible||this.vq||this.T4i();this.Eh.updateCommandUI(!0)}Vb(){this.ga.pa(Dh.a.Neb,ff.a.frame,this.Neb);this.ga.gb(Dh.a.ZHb,ff.a.frame,this.ZHb,96)}D0a(){-1!==this.aj.mode&&(this.aj.mode||this.UCh())}UCh(){const oa=this.aj,cb=oa.$p,xb=cb.XGd(),Qb=cb.mcf(this.kf.GKb&&this.kf.vq&&!this.tj.mn);this.bpa.WEn(Qb.length,xb,!oa.mode,xb?5:1);this.bpa.sFn(Qb,cb.qRa)}ZQn(){const oa=this.Wb.re(Cg.AFrame.gr);oa.parent=
Cg.AFrame.Np;oa.UL=!0;oa.wUf=!0;oa.Bhc=!0;oa.Zub((cb,xb)=>{Db.a.Ijh(xb.name)&&(this.tj.eGb=Og.a.n1(this.Hb,()=>{xb.name!==Cg.AFrame.xL&&2!==this.aj.mode&&3!==this.aj.mode&&(this.aj.clearSelection(),this.Eh.updateCommandUI(!0));this.tj.eGb=null},De.a.tQm))});this.Oo.qS(Cg.AFrame.gr);if(this.kf.Qvb)for(let cb of Uf.s)oa.bindAction(Xh.KeyInputManager.CF(cb),Tg.a.KUe)}NJn(){this.Ztc&&this.gMe.rcl()}Dlh(){this.ZDj&&this.NJn()}EQm(oa,cb,xb,Qb){const qc=this.aj,Mc=qc.$p.Ly;Mc&&Mc.Hy?qc.WXe.endCommentSession(Mc.Hy.draftId):
a.ULS.sendTraceTag(40130755,327,10,"Attempting to discard when there is no active draft!");this.Neb(oa,cb,xb,Qb,!0);Og.a.n1(this.Hb,()=>{this.Eh.updateCommandUI(!0)},De.a.Pzn)}IPm(){this.Ztc&&this.Wb.Jg(Cg.AFrame.gr);this.Eh.updateCommandUI(!0)}JDa(oa){oa.Dr(this.Wb.EV);oa.Dr(this.Wb.FV)}uKb(oa,cb,xb){if(1===xb)return 32;this.T4i();return 32}T4i(){this.isVisible||(this.tj.dX?(this.wXk(),this.tj.mn=!0,this.k4.y2d(),this.Wb.Rxc(Cg.AFrame.gr),this.vq&&this.kf.GKb&&this.aj.nIb(this.aj.model.Sbf(()=>!0)),
this.ZDj=!0,Fb.UISurfaces.$t().then(oa=>{oa.showTaskPane(af.a.Tvd,this.oXj);return null}).catch(()=>{a.ULS.sendTraceTag(559273377,327,10,"Error showing comment task pane.")}),this.aj.y$b(null),this.Eh.updateCommandUI(!0),this.JDa(this.Wb.re(Cg.AFrame.gr)),this.k4.xna("OnCommentPaneOpen"),a.ULS.sendTraceTag(37007903,327,50,"New Comment Pane opened.")):this.k4.xna("OnCommentInit",Object.assign(new Qf.a,{UCa:()=>{this.tj.mn||this.ga.processAction(Dh.a.UX,2)}})))}wXk(){this.ga.Xb(Tg.a.T9,2,null);this.ga.Xb(Tg.a.KS,
2,null)}Kfb(){return this.gia.Kfb(this.ga,!1)}Yub(){}show(){this.isVisible||this.ga.processAction(Dh.a.UX,2)}editComment(){return 2}jLd(){this.aj.paneClosing();this.tj.mn=!1;if(this.vq&&this.kf.GKb){const cb=this.aj.model;this.aj.nIb(cb.Sbf(xb=>cb.Bta(xb)))}var oa=xl.FocusManager.instance();oa.og&&oa.og.name===Cg.AFrame.gr&&oa.Jg(this.vq&&(2===this.aj.mode||3===this.aj.mode||this.aj.ek.Ks)?Cg.AFrame.xL:oa.HS);this.Oo.Mw(Cg.AFrame.gr);this.Wb.rDc(Cg.AFrame.gr);Fb.UISurfaces.$t().then(cb=>{cb.hideTaskPane(af.a.Tvd,
2);return null}).catch(()=>{a.ULS.sendTraceTag(559273378,327,10,"Error hiding Comment Pane.")});this.vq&&(oa=this.aj.model.Ks)&&this.xho(oa);this.k4.xna("OnCommentPaneClose");a.ULS.sendTraceTag(572281360,327,50,"New Comment Pane closed.")}xho(oa){oa.done?this.aj.clearSelection():this.Unb.WCh(oa)}ZXm(oa=null){this.gMe.R0i(3);this.ynf();if(oa){this.Dlh();Ci.a.gRf(oa,[cc.a.contextMenu]);const cb=this.Wb.re(Cg.AFrame.gr);this.ig.Eqd(Cg.AFrame.gr,oa,cb.Bhc)}}QVm(oa){this.Oo.DG(Cg.AFrame.gr);1!==oa&&Og.a.n1(v.AFrameworkApplication.uc,
()=>{this.Wb.fC(Cg.AFrame.gr)},De.a.$Xf)}onTaskPaneClose(){this.tj.dX&&this.gMe.R0i(1)}LHd(){const oa={type:this.LRn,NEo:this.Dlh};return Object.assign(new yl.a,{title:WordEditorIntl.WordEditorStrings.L_Comments,contentProps:oa,hideHeader:!1,width:300,location:2,onOpen:cb=>{this.Ztc=cb;this.ZXm(cb);this.PO.Q5f(!0)},onClose:()=>{this.Ztc=null;this.ga.Xb(Dh.a.Neb,2,!0);this.Eh.updateCommandUI(!0);this.onTaskPaneClose();this.PO.Q5f(!1)},onShow:cb=>{this.QVm(cb)}})}UX(){return 32}}Object(e.a)(xg,"OfficeSharedCommentPane",
null,[9,238,239]);var zl=d(1623),Sl=d(142);class Po{constructor(oa,cb){this.containerType="full-pane";this.identifier=null;this.ga=oa;this.identifier=cb}openView(){this.ga.processAction(Dh.a.uKb,2)}closeView(){this.ga.Xb(Dh.a.Neb,2,!0)}invokeModalConfirmationDialog(oa,cb,xb){const Qb=new Sl.StandardDialog;xb&&xb.title&&xb.body&&xb.confirmButton&&xb.cancelButton||(a.ULS.sendTraceTag(35678229,327,10,"InvokeModalConfirmationDialog: No localized strings provided."),xb=new yc("","","",""));Qb.Fd=1;Qb.Ve(1,
xb.confirmButton);Qb.Ve(0,xb.cancelButton);Qb.Pv(xb.title,xb.body,1,qc=>{1===qc?oa():cb()})}}Object(e.a)(Po,"ViewContainerAPI",null,[236,237]);class gn{constructor(oa,cb,xb){this.H$n=oa;this.ui=cb;this.SEa=xb;this.me=new ra.a;this.H$n.execute(Qb=>{this.SEa.h3d("OnBeforeTrackChangeMarkupViewChange",(qc,Mc)=>{Mc&&Mc.FDf!==Qb.Ri&&this.me.raiseEvent("OnBeforeTrackChangeMarkupViewChange",Mc)});this.SEa.h3d("OnAfterTrackChangeMarkupViewChangeEventKey",(qc,Mc)=>{Mc&&Mc.Ri===Qb.Ri&&(Nm.a.Ri=Qb.Ri,this.me.raiseEvent("OnAfterTrackChangeMarkupViewChange",
Mc))})})}oga(oa,cb){this.me.addHandler(oa,cb)}xna(oa,cb){this.me.raiseEvent(oa,cb)}y2d(){this.ui.OPf||(this.ui.OPf=!0,this.me.raiseEvent("OnCommentRenderedOnce"))}}Object(e.a)(gn,"WordCommentEventsActor",null,[]);var Om=d(1756);class om{constructor(){this.insertIndex=0;this.author=this.updatedSessionParams=this.anchorHintText=this.authorIdentity=this.authorName=null}}Object(e.a)(om,"InitCommentSessionResult",null,[]);class lk extends om{constructor(){super();this.updatedDraftSessionConfiguration=
null}}Object(e.a)(lk,"BeginDraftingHostResult",om,[]);var Rf=d(1940),We=d(1909),Ij=d(1001);class Al{constructor(oa,cb,xb,Qb,qc,Mc,Gd,de,Id,Xe,hf,Ef,ng,Bh,fi){this.taskManager=oa;this.bpa=cb;this.Luj=xb;this.Dao=Qb;this.fYe=qc;this.hr=Mc;this.Ss=Gd;this.Ci=de;this.t_=Id;this.zc=Xe;this.fj=hf;this.hZ=Ef;this.ui=ng;this.XAk=Bh;this.VAk=fi;this.vTb=this.U4=this.um=null;this.rzj="WordWebCommitNewCommentActivity";this.szj="WordWebCommitTaskActivity";this.ozj="WordWebCommentReactionActivity";this.Ske=null}get gia(){return this.U4}G7m(oa){var cb;
const xb=this.gia.Ly,Qb=this.U4.gT();if(Qb&&xb){const qc=Ij.a.Gcb(null!==(cb=xb.authorId)&&void 0!==cb?cb:"");cb=new Om.a(xb.authorId,xb.XXb,xb.author,null!==qc&&void 0!==qc?qc:"",!0);oa.author=cb;oa.insertIndex=Array.indexOf(Qb,xb);oa.authorName=xb.author;oa.authorIdentity="";return null}return Og.a.PC(-2130915320)}initialize(oa,cb,xb,Qb){this.um=oa;this.U4=cb;this.vTb=xb;this.Ske=Qb}beginDraftingAsync(oa){if(!oa)return new Promise((Qb,qc)=>{qc(Og.a.PC(-2130915327))});const cb=new lk,xb=qn.a.Sef(oa.sessionType);
return void 0===xb||null===xb?new Promise((Qb,qc)=>{qc(Og.a.PC(-2130915317))}):new Promise((Qb,qc)=>{Og.a.n1(this.taskManager,()=>{if(1!==this.um.mode)a.ULS.sendTraceTag(40130753,327,10,"Create InitCommentSession Failed. CommentingMode={0}",this.um.mode),qc(Og.a.PC(-2130915325));else{this.elh();try{switch(xb){case 0:if(!this.um.Faa.Kfb()){qc(Og.a.PC(-2130915326));return}this.hr.IVd&&this.XAk.hLd();a.ULS.sendTraceTag(553710798,327,50,`Creating comment for ${oa.draftId}`);this.um.Yub(oa);break;case 1:if(!oa.threadId||
""===oa.threadId){qc(Og.a.PC(-2130915324));return}if(this.hr.x1f){let de=this.U4.GB(oa.threadId);if(de){const Id=this.U4.jOh(de,!1),Xe=Rf.a.Uzb(de,Id,de.authorId===this.hr.CX);Xe&&this.fYe.invoke(oa.threadId,Xe)}else a.ULS.sendTraceTag(579170962,327,10,"Smart reply provider not invoked since comment is null",this.um.mode)}this.um.addReply(oa.threadId,oa);break;case 3:if(!oa.threadId||""===oa.threadId){qc(Og.a.PC(-2130915324));return}var Mc=this.U4.GB(oa.threadId);if(!Mc){qc(Og.a.PC(-2130915323));
return}this.um.editComment(Mc,oa);break;case 2:if(!oa.commentId||""===oa.commentId){qc(Og.a.PC(-2130915324));return}let Gd=this.U4.GB(oa.commentId);if(!Gd){qc(Og.a.PC(-2130915323));return}this.um.editComment(Gd,oa)}}catch(Gd){qc(Gd);this.uRi();a.ULS.sendTraceTag(553677466,327,10,`Drafting Exception ${Gd} on Session ${xb}`);return}(Mc=this.G7m(cb))?qc(Mc):Qb(cb);this.uRi()}},De.a.beginDraftingAsync)})}commit(oa,cb,xb){const Qb=this.gia.Ly;if(!Qb)throw Og.a.PC(-2130915320);var qc=Qb.Hy;if(!qc)throw Og.a.PC(-2130915320);
const Mc=qn.a.Sef(qc.sessionType);if(void 0===Mc||null===Mc)throw Og.a.PC(-2130915317);if(oa!==qc.draftId)throw Og.a.PC(-2130915327);let Gd=!1,de=!1;qc=!1;switch(Mc){case 3:if(!xb)throw Og.a.PC(-2130915327);break;case 0:this.fj.Pd(()=>{if(!this.um.Faa.Kfb())throw Og.a.PC(-2130915326);Qb.text=[cb];this.um.Gz&&!this.ui.mn?this.um.G3m(()=>{this.um.Rra(Qb);this.um.a1k(oa,Qb.id)}):this.um.Rra(Qb);de=xb&&null!=xb.Task;Gd=this.um.Gz;Og.a.n1(this.taskManager,()=>{this.$jb(Qb.id)},De.a.$jb)},"WESCA:C:C");
break;case 1:this.fj.Pd(()=>{Qb.text=[cb];this.um.Rra(Qb);de=xb&&null!=xb.Task;Gd=this.um.Gz},"WESCA:C:R");break;case 2:this.fj.Pd(()=>{Qb.text=[cb];this.um.bbb(Qb);this.YGi(Tg.a.qwm)},"WESCA:C:E");break;default:throw Og.a.PC(-2130915322);}xb&&(xb.Resolve&&(this.pYi(Qb,xb.Resolve.isResolved),xb.Resolve.isResolved&&!this.ui.mn&&this.um.notify(Box4Intl.Box4Strings.L_CommentResolved,!0)),xb.Task&&this.um.wBk(Qb,xb.Task),xb.Reaction&&(qc=this.hr.cBk,xb.Reaction.isActive?this.um.wqd(Qb,xb.Reaction.reactionType):
this.um.y3d(Qb,xb.Reaction.reactionType)));this.hr.oBk&&de&&this.t_.execute(Id=>Id.logActivity(this.szj,"CommentsTasksFpsIsEnabled"));Gd&&this.t_.execute(Id=>{Id.logActivity(this.rzj,"CommentsFpsIsEnabled")});qc&&this.t_.execute(Id=>{Id.logActivity(this.ozj,"CommentReactionsFpsIsEnabled")});return Qb.id}endCommentSession(oa){const cb=this.gia.Ly;if(cb){if(cb.Hy&&cb.Hy.draftId!==oa)throw Og.a.PC(-2130915327);if(cb.Sq===Cd.a.beingCreated)this.um.deleteComment(cb),!this.um.Gz||cb.Rf||this.ui.mn||this.Ci.Jg(Cg.AFrame.Zp);
else{if(3!==this.um.mode){a.ULS.sendTraceTag(33621450,327,50,"CommentingMode != EditingComment at the time of ending a comment session");return}cb.Sq=Cd.a.normal;cb.iPa=We.a.succeeded;cb.Hy=null;this.um.zVe()}}this.Ss&&this.Ss.updateCommandUI(!0);this.gia.XGd()||this.bpa.J8f(1,!this.um.mode)}deleteComment(oa){(oa=this.U4.GB(oa))?(this.um.deleteComment(oa),this.um.Gz&&!this.ui.mn?oa.Rf||this.Ci.Jg(Cg.AFrame.Zp):this.Ci.fC(Cg.AFrame.gr),this.Dao.I_f(oa)&&this.YGi(Tg.a.umi)):a.ULS.sendTraceTag(594600902,
327,15,"Comment to delete is not in the model.")}selectComment(oa){this.$jb(oa,0)}highlightComment(oa){this.um.y$b(oa,0)}setThreadResolvedState(oa,cb){(oa=this.U4.GB(oa))&&this.pYi(oa,cb)}pYi(oa,cb){if(oa.Rf&&""!==oa.Rf)throw Og.a.PC(-2130915321);this.um.vwb(oa,cb);cb&&!this.ui.mn&&this.Ci.Jg(Cg.AFrame.Zp)}presentLinkToComment(oa){var cb=this.U4.GB(oa);cb?(cb=this.gia.oFd(cb))?(oa={["nav"]:btoa(`{"${Ih.a.comment}":${cb}}`),["mode"]:"copy"},this.VAk.TB(Tg.a.presentLinkToComment),this.zc.Xb(Dh.a.Lcb,
2,oa)):a.ULS.sendTraceTag(578058146,327,10,"[LinkToComment] Invalid durableCommentId for commentId: {0}",oa):a.ULS.sendTraceTag(578401558,327,10,"[LinkToComment] Comment not found for Id {0}",oa)}selectFirstThreadInNextCommentContext(){this.um.bWi(0)}selectLastThreadInPreviousCommentContext(){this.um.YDn()}registerForCommentEvents(oa){const cb=this.gia.mcf(this.hr.GKb&&this.hr.vq&&!this.ui.mn),xb=this.gia.qRa,Qb=this.gia.XGd(),qc=!this.um.mode;this.bpa.ZNn(this.Ske.WGl());this.Ske.pzl().then(Mc=>
{this.bpa.$ln(oa,cb,Qb,qc,xb,Mc);this.bpa.J8f(Qb?5:1,qc);this.Ss&&this.Ss.updateCommandUI(!0)})}unregisterForCommentEvents(oa){this.bpa.khc(oa)}registerForAction(oa,cb){this.Luj.GOa(oa,cb)}unregisterForAction(){}checkAtMentionCapability(){return this.vTb?this.vTb.atMentionsEnabledAsync():(a.ULS.sendTraceTag(36475799,327,10,"AtMentionEnabled called before initialization."),new Promise(oa=>{oa(!1)}))}resolveSupported(){return!0}loadThreads(){a.ULS.sendTraceTag(40130754,327,10,"LoadThreads incorrectly called on unsupported platform.")}elh(){const oa=
this.um.Gz&&!this.ui.mn?Cg.AFrame.xL:Cg.AFrame.gr;if(oa===Cg.AFrame.gr){if(!this.ui.mn)return;Fb.UISurfaces.$t().then(cb=>{cb.setSelectedTaskPane(af.a.Tvd);return null})}this.Ci.fC(oa)}$jb(oa,cb=1){this.elh();const xb=this.hr.PXl?1===cb||0===cb:1===cb;this.hZ.VVi(oa,Object.assign(new gi.a,{r3:cb,pO:xb}))}uRi(){this.um.Faa.K$a&&(this.um.Faa.K$a=!1)}YGi(oa){this.zc.processAction(oa,2)}}Object(e.a)(Al,"WordEditorSharedCommentAPI",null,[191,192]);class fj{constructor(oa,cb,xb,Qb,qc,Mc,Gd=null){this.date=
this.author=this.commentBody=this.parentId=this.commentId=null;this.commentFlags=0;this.usersByReactionType=null;this.commentId=oa;this.parentId=cb;this.commentBody=xb;this.author=Qb;this.date=qc;this.commentFlags=Mc;this.usersByReactionType=Gd}}Object(e.a)(fj,"OfficeSharedCommentModel",null,[]);d(1607);class gj{constructor(oa,cb){this.Oa=oa;this.Y_a=cb;this.n7g="AD";this.Ykc=new L.a;this.TLe=new L.a;this.kgk=RegExp("(.*?)\\s*(\\[\\d+\\])$");this.Jyg=new fg.a}get userPrincipalName(){return this.Oa.lb("UserPrincipalName")}get x1a(){return this.Oa.lb("PresenceProvider")}get CX(){return this.Oa.lb("PresenceUserId")}get Ui(){return this.Y_a.value}eui(oa){const cb=
this.kgk.exec(oa);return cb?cb[1]:oa}cZh(oa,cb=!1){let xb=0;oa.done&&(xb=oa.Rf&&""!==oa.Rf?xb|4:xb|8);oa.Vqh&&(xb|=2);cb&&(xb|=1);this.I_f(oa)&&(xb|=16);oa.fsf&&(xb|=32);this.MWl(oa)||(xb|=128);return xb}MWl(oa){return oa?(oa=this.Ui.Eb(oa.objectId))?oa.hasProperty(la.a.H5):!1:!1}I_f(oa){if(!oa)return!1;if(void 0===oa.authorId||null===oa.authorId||""===oa.authorId)return this.Txf(oa.id,oa.objectId,"Comment AuthorId null or empty"),!1;if(void 0===this.CX||null===this.CX||""===this.CX)return this.Txf(oa.id,
oa.objectId,"PresenceUserId null or empty"),!1;if(this.CX==oa.authorId&&oa.XXb==this.x1a)return!1;const cb=this.TBd(oa.authorId),xb=this.TBd(this.CX);if(this.x1a===this.n7g&&cb&&xb&&cb[0]!=this.userPrincipalName&&cb[1]!=xb[1])return!0;this.Txf(oa.id,oa.objectId,"Unknown");return!1}isCurrentUser(oa){if(!oa||void 0===oa.authorId||null===oa.authorId||""===oa.authorId||void 0===this.CX||null===this.CX||""===this.CX)return!1;if(this.CX==oa.authorId&&oa.XXb==this.x1a)return!0;oa=this.TBd(oa.authorId);const cb=
this.TBd(this.CX);return this.x1a===this.n7g&&oa&&cb?oa[0]==this.userPrincipalName||oa[1]==cb[1]:!1}TBd(oa){if(void 0===oa||null===oa)return null;oa=oa.split("::");return 3===oa.length?oa.slice(1,3):null}Txf(oa,cb,xb){oa&&!this.Jyg.contains(oa)&&(a.ULS.sendTraceTag(42824129,327,50,`No edit restriction for commentObjectId: ${cb}; reason: ${xb}`),this.Jyg.add(oa))}zKh(oa,cb){var xb;if(!oa)return null;const Qb=oa.eQd;let qc=!1;1===cb&&(qc=!0);cb=oa.author?this.eui(oa.author):"";const Mc=Ij.a.Gcb(null!==
(xb=oa.authorId)&&void 0!==xb?xb:"");xb=new Om.a(oa.authorId?oa.authorId:"",oa.XXb,cb,null!==Mc&&void 0!==Mc?Mc:"",this.isCurrentUser(oa));return new fj(oa.id?oa.id:"",oa.Rf?oa.Rf:"",oa.text&&oa.text.length?oa.text[0]:null,xb,oa.date||Qb?oa.date:new Date,this.cZh(oa,qc),this.eZh(oa.usersByReactionType))}Gel(oa,cb,xb){const Qb=[],qc=new L.a;if(!oa)return Qb;for(let Mc of oa)Mc.Sq!==Cd.a.beingCreated&&xb(Mc)&&(Mc.id&&this.Ykc.xb(Mc.id)?(oa=this.Ykc.J(Mc.id),oa=this.wLk(Mc,oa,cb),Qb.push(oa),qc.Z(Mc.id,
oa)):Mc.id?(oa=this.zKh(Mc,cb),Qb.push(oa),qc.Z(Mc.id,oa)):a.ULS.sendTraceTag(50667679,327,10,"CommentId should not be null"));this.Ykc=qc;return Qb}nkl(oa,cb,xb){const Qb=[];for(let qc of oa)qc.Sq!==Cd.a.beingCreated&&xb(qc)&&(qc.id&&this.Ykc.xb(qc.id)?Qb.push(this.Ykc.J(qc.id)):qc.id&&Qb.push(this.zKh(qc,cb)));return Qb}wLk(oa,cb,xb){var Qb=oa.eQd,qc=1===xb;xb=oa.Rf?oa.Rf:"";const Mc=oa.text&&oa.text.length?oa.text[0]:null,Gd=oa.author?this.eui(oa.author):"",de=oa.authorId?oa.authorId:"",Id=oa.XXb?
oa.XXb:"",Xe=Ij.a.Gcb(de);Qb=oa.date||Qb?oa.date:new Date;qc=this.cZh(oa,qc);const hf=this.isCurrentUser(oa),Ef=this.eZh(oa.usersByReactionType);return cb.parentId===xb&&cb.commentBody===Mc&&cb.author.DisplayName===Gd&&cb.author.UserId===de&&cb.author.Provider===Id&&cb.author.IsCurrentUser===hf&&cb.date===Qb&&cb.commentFlags===qc&&this.Qek(cb.usersByReactionType,Ef)?cb:(cb=new Om.a(de,Id,Gd,null!==Xe&&void 0!==Xe?Xe:"",hf),new fj(oa.id,xb,Mc,cb,Qb,qc,Ef))}Qek(oa,cb){if(!oa&&!cb)return!0;if(!cb||!oa)return!1;
var xb=Object.keys(oa);if(xb.length!==Object.keys(cb).length)return!1;for(let Qb of xb){if(!(Qb in cb))return!1;xb=oa[Qb];const qc=cb[Qb];if(xb.length!==qc.length)return!1;for(let Mc=0;Mc<xb.length;Mc++)if(!this.Fek(xb[Mc],qc[Mc]))return!1}return!0}Fek(oa,cb){return oa||cb?oa&&cb&&oa.UserId===cb.UserId&&oa.Provider===cb.Provider&&oa.Email===cb.Email&&oa.DisplayName===cb.DisplayName&&oa.IsCurrentUser===cb.IsCurrentUser?!0:!1:!0}eZh(oa){if(!oa)return null;const cb={},xb=this.Oa.lb("PresenceUserId");
for(let qc of Object.keys(oa)){const Mc=[];var Qb=oa[qc];for(let Gd of Qb){Qb=Gd.UserId===xb;let de;this.TLe.xb(Gd.UserId)?(de=this.TLe.J(Gd.UserId),de.IsCurrentUser=Qb):(de=new Om.a(Gd.UserId,Gd.Provider,Gd.DisplayName,Gd.Email,Qb),this.TLe.add(Gd.UserId,de));Mc.push(de)}cb[qc]=Mc}return cb}}Object(e.a)(gj,"WordEditorSharedCommentModelTranslator",null,[190]);class Tl{constructor(){this.Wm=null;this.e7c=this.oWg=this.lvg=this.A2g=this.p5g=this.ORg=this.sYg=!1}dZh(){this.Wm||(a.ULS.sendTraceTag(588292828,
327,10,"OfficeSharedCommentsAppCapabilities: AppSettings object should not be empty"),this.b0i());return this.Wm}pzl(){return new Promise((oa,cb)=>{this.e7c?oa(this.xUh()):this.NXi().then(()=>{oa(this.xUh())}).catch(xb=>{cb(xb)})})}xUh(){this.e7c||a.ULS.sendTraceTag(588292829,327,10,"OfficeSharedCommentsAppCapabilities: GetModelCapabilitiesInternal should not be called before AtMentions are resolved");let oa;oa=33;this.lvg&&(oa|=2);this.sYg&&(oa|=8);this.p5g&&(oa|=16);this.ORg&&(oa|=4);this.A2g&&
(oa|=64);this.oWg&&(oa|=128);return oa}}Object(e.a)(Tl,"OfficeSharedCommentsAppCapabilities",null,[862]);class Em extends Tl{constructor(oa){super();this.BTa=null;this.kf=oa;this.ePn();this.b0i()}ePn(){this.A2g=this.kf.mLb;this.p5g=!1;this.oWg=this.ORg=this.sYg=!0}initialize(oa){this.BTa=oa;this.NXi()}WGl(){let oa=120;this.kf.ZCb&&(oa|=1536);return oa}b0i(){this.Wm={};this.Wm.LivePersonaPicker="true";this.Wm.PersonaColor="true";this.Wm.DiscreteHostedComments=this.kf.$Wk.toString();this.Wm.NewCommentButton=
"true";this.Wm.DisabledChangeGates="WebThemeIntegrationHighContrastFixes,"+this.kf.VWk;this.Wm.CommentsFluentUI="true";this.Wm.CommentTasks=this.kf.mLb.toString();this.Wm.CommentTasksFromReply=this.Wm.CommentTasks;this.Wm.CommentsFluentUIV2="true";this.Wm.CommentFriendlyTimestamps=this.kf.xAk.toString();this.Wm.AtMentionFloodgateSurvey=this.kf.Ifk.toString();this.Wm.HyperlinksInComments="true";this.Wm.NewModelState="true";this.Wm.LogDraftCommentIdPair="true";this.Wm.RichTextFormattingInWeb=this.kf.Qvb.toString();
this.Wm.NoDiscardOnFocusLoss="true";this.Wm.NewResolvedCardDesignInWeb="true";this.Wm.RichContentEditIntegration="true";this.Wm.HyperlinksWithDisplayText="true";this.Wm.SmartReplies=this.kf.x1f.toString();this.Wm.NewBorderAndFocusLookInWeb="true";this.Wm.LinkToComment="true";this.Wm.TaskPaneWithNewInfrastructure="true";this.Wm.CommentReactions=this.kf.bab.toString();this.Wm.WebThemeIntegration="true";this.Wm.NewSelectionInteractions="true";this.Wm.QuillInitializationTelemetry="true";this.Wm.PersonaIconImageForWeb=
"true";this.Wm.HighlightsAndFontColorInWebComments=this.kf.ZCb.toString();this.Wm.TruncationUIWithReadMoreText="true";this.Wm.CtrlEnterTip="true";this.Wm.AtMentionHintMessage="true";this.Wm.LivePersonaCardForWeb=this.kf.nsm.toString();this.Wm.TaskHistoryRecordIDs=this.kf.J6n.toString();this.Wm.ContentNavigation=this.kf.contentNavigationApiEnabled.toString()}NXi(){return new Promise((oa,cb)=>{this.BTa?this.BTa.atMentionsEnabledAsync().then(xb=>{this.lvg=xb;this.e7c=!0;oa(this.e7c)}):(a.ULS.sendTraceTag(588292830,
327,10,"OfficeSharedCommentsAppCapabilities: SetAtMentionCapabilityAsync should not be called before _peopleAPIInstance is initialized"),cb(Og.a.PC(-2130915320)))})}}Object(e.a)(Em,"WordSharedCommentsAppCapabilities",Tl,[189]);class vn{constructor(){this._initialized=!1;this.nBk={crewAlias:"webasynccollabeng",featureName:"Comments",topLevelKpiName:ig.a.F8e,vetoPillar:7};this.Q6n={crewAlias:"webasynccollabeng",featureName:"Tasks",topLevelKpiName:zl.a.F8e,vetoPillar:7}}get i1a(){return null!=this.Jog?
this.Jog:this.Jog=(()=>this.W.resolve("Box4.IPackageBootPerfLogger"))()}UV(oa){this.i1a.UV(nk.a.comments,oa,!0)}get name(){return"WordEditor.Comments"}yc(oa){this.W=oa;this.UV("CPConfigStart");oa.ha("WordEditor.Comments.ICommentsUsageAndHealthLogger",()=>new ee.a(u.Health.instance,new Fk.a,this.nBk)).as("WordEditor.Comments.ICommentsUsageAndHealthLogger").singleInstance();oa.ha("WordEditor.Comments.ITasksUsageAndHealthLogger",()=>new ee.a(u.Health.instance,new Fk.a,this.Q6n)).as("WordEditor.Comments.ITasksUsageAndHealthLogger").singleInstance();
oa.ha("WordEditor.Comments.CommentNodeTracker",()=>new wc(this.W.resolve("WordEditor.Comments.ICommentsUsageAndHealthLogger"))).as("WordEditor.Comments.CommentNodeTracker").singleInstance();oa.ha("WordEditor.Comments.CommentsSettings",()=>new kc(v.AFrameworkApplication.K,this.W.resolve("Box4.IFeatureHelper"),new P.a(()=>U.App.xa.jb.Yc),new P.a(()=>te.a.instance),this.W.resolve("WordEditor.Comments.CommentNodeTracker"),this.W.resolve("WordEditor.Sidetrack.SidetrackSettings"))).as("WordEditor.Comments.CommentsSettings").singleInstance();
oa.ha("WordEditor.Comments.CommentsState",()=>new Nm.a).singleInstance();oa.ha("WordEditor.Comments.WordCommentEventsActor",()=>new gn(oa.Za("Box4.TrackChange.ITrackChangeManager"),oa.resolve("WordEditor.Comments.CommentsState"),oa.resolve("Box4.TrackChange.ITrackChangeEventsActor"))).singleInstance();oa.ha("WordEditor.Comments.WordEditorSharedCommentModelTranslator",()=>new gj(v.AFrameworkApplication.K,new P.a(()=>U.App.xa.jb.Yc.zd))).as("WordEditor.Comments.IWordEditorSharedCommentModelTranslator").singleInstance();
oa.ha("WordEditor.Comments.CommentDeltaFormatTranslator",()=>new xk(oa.resolve("WordEditor.Comments.CommentsSettings"),oa.resolve("Box4.Styles.IWACStyleReader"))).as("WordEditor.Comments.ICommentFormatTranslator").singleInstance();oa.ha("Common.Comments.OfficeSharedCommentsEventHost",()=>new Kl(v.AFrameworkApplication.uc)).as("Common.Comments.IOfficeSharedCommentsEventHost").singleInstance();oa.ha("WordEditor.Comments.CommentActionInTypingRecorder",()=>new nm(this.W.resolve("WordEditor.Comments.CommentsSettings"))).as("WordEditor.Comments.ICommentActionInTypingRecorder").singleInstance();
oa.ha("WordEditor.Comments.EditorCommentModel",ui.a.getInstance).as("Common.Comments.ICommentModel").as("WordEditor.Comments.IWordEditorCommentModel").as("WordEditor.Comments.IEditorCommentModel").singleInstance();oa.ha("WordEditor.Comments.ICommentModelBootLoader",()=>new di(new P.a(()=>U.App.xa.jb.Yc),new P.a(()=>te.a.instance),oa.resolve("WordEditor.Comments.IEditorCommentModel"),oa.resolve("WordEditor.Comments.CommentsState"),oa.resolve("WordEditor.Comments.CommentsSettings"),oa.resolve("WordEditor.Comments.CommentNodeTracker"),
this.W.resolve("WordEditor.Comments.ICommentsUsageAndHealthLogger")));oa.ha("WordEditor.Comments.ICommentFilterActor",()=>new hl(oa.resolve("WordEditor.Comments.IEditorCommentModel"),v.AFrameworkApplication.K,oa.resolve("WordEditor.Comments.WordCommentEventsActor"))).singleInstance();oa.resolve("WordEditor.Comments.ICommentFilterActor");oa.ha("WordEditor.Comments.CommentHighlightOnRestActor",()=>new Xg(new P.a(()=>U.App.xa.jb.Yc),oa.resolve("WordEditor.Comments.CommentsState"),oa.resolve("WordEditor.Comments.IEditorCommentModel"),
oa.resolve("WordEditor.Comments.WordCommentEventsActor"),oa.resolve("Box4.INotebookManager").al,J.a.instance,this.W.resolve("WordEditor.ReviewSuggestionContent.WordContentFilterAPI"),oa.resolve("WordEditor.Comments.CommentsSettings"))).as("WordEditor.Comments.ICommentHighlightOnRestActor").singleInstance();oa.ha("WordEditor.Comments.CommentHighlightUtils",()=>new Rl(oa.resolve("Box4.Highlight.IHighlightManager"))).singleInstance();oa.ha("WordEditor.Comments.DefaultHighlightChangeHandler",()=>new Sd(oa.resolve("WordEditor.Comments.CommentHighlightUtils"))).singleInstance();
oa.ha("WordEditor.Comments.AllMarkupModeHighlightChangeHandler",()=>new al(oa.resolve("WordEditor.Comments.ICommentHighlightOnRestActor"),oa.resolve("WordEditor.Comments.CommentHighlightUtils"),v.AFrameworkApplication.ua.G_,v.AFrameworkApplication.ua.OEa,v.AFrameworkApplication.ya,v.AFrameworkApplication.uc,oa.resolve("WordEditor.Comments.CommentsState"),oa.Za("WordEditor.Comments.IEditorCommentManager"))).singleInstance();oa.ha("WordEditor.Comments.CommentHighlightActor",()=>new Dc(new P.a(()=>U.App.xa.jb.Yc.zd),
oa.resolve("WordEditor.CommentsInteractive.ICommentEditor"),oa.resolve("WordEditor.Comments.ICommentHighlightOnRestActor"),oa.Za("WordEditor.Comments.IEditorCommentManager"),J.a.instance,oa.resolve("WordEditor.Comments.AllMarkupModeHighlightChangeHandler"),oa.resolve("WordEditor.Comments.DefaultHighlightChangeHandler"),oa.resolve("WordEditor.Comments.CommentHighlightUtils"),oa.resolve("WordEditor.Comments.WordCommentEventsActor"))).as("WordEditor.Comments.ICommentHighlightActor").singleInstance();
oa.ha("WordEditor.Comments.CommentHintActor",()=>new Ud(oa.resolve("WordEditor.Comments.CommentsSettings"),tk.a.instance,$k.a.instance,un.a.instance,v.AFrameworkApplication.ya,Yj.TableCellReader.Dfm,Hi.moveToLastRenderedCellOfTheRow,new Ek.a,oa.Za("Box4.ContentControlConfigSettings"),oa.resolve("WordEditor.Comments.IEditorCommentModel"),oa.resolve("WordEditor.Comments.ICommentHighlightActor"),oa.resolve("WordEditor.Comments.ICommentActionInTypingRecorder"),oa.resolve("WordEditor.Comments.CommentsState"),
oa.resolve("WordEditor.ReviewSuggestionContent.WordContentFilterAPI"))).as("WordEditor.Comments.ICommentHintActor").singleInstance();oa.ha("WordEditor.Comments.CommentMarginEntryPointActor",()=>new Nd(tk.a.instance,$k.a.instance,un.a.instance,v.AFrameworkApplication.ya,oa.resolve("WordEditor.Comments.ICommentHintActor"),oa.Za("Common.IZoomManager"),oa.resolve("WordEditor.Comments.CommentsSettings"))).singleInstance();oa.ha("WordEditor.Comments.ViewContainerAPI",()=>new Po(v.AFrameworkApplication.ya,
"OfficeSharedCommentPaneSurface")).as("WordEditor.Comments.IWordViewContainerAPI").singleInstance();oa.ha("Common.Comments.CommentActivationManager",()=>new bm).as("Common.Comments.ICommentActivationManager").singleInstance();oa.ha("Common.Comments.ViewContainerEventHost",()=>new yh(v.AFrameworkApplication.uc,"OfficeSharedCommentPaneSurface")).as("Common.Comments.IViewContainerEventHost").singleInstance();oa.ha("WordEditor.Comments.CommentSmartReplyProvider",()=>new Th(this.W.resolve("Common.Comments.IOfficeSharedCommentsEventHost"),
this.W.resolve("Box4.AugmentationLoop.IAnnotationStorage"),this.W.resolve("Box4.AugmentationLoop.IUtilsWrapper"),this.W.resolve("Box4.AugmentationLoop.IAlFactoryWrapper"))).as("Common.Comments.ICommentSmartReplyProvider").singleInstance();oa.ha("WordEditor.Comments.WordSharedCommentsAppCapabilities",()=>new Em(oa.resolve("WordEditor.Comments.CommentsSettings"))).as("WordEditor.Comments.IWordSharedCommentsAppCapabilities").singleInstance();this.UV("CPConfigEnd")}init(){this.UV("CPInitStart");this.W.resolve("Box4.IFeatureHelper").Yk.continueWith(()=>
{try{this.Tm(),this.UV("CPInitEnd")}catch(oa){throw a.ULS.lM(524300632,327,10,oa,"Exception threw from Comments Package initialization in onAfterGraphFeaturesNodeLoaded: {0}",oa),this.i1a.yv(nk.a.comments,"CPInitException",oa,!0),oa;}})}Tm(){const oa=this.W.resolve("WordEditor.Comments.CommentsSettings");this.UV("onAfterGFNLoadedStart");this.W.ha("WordEditor.Comments.OfficeSharedCommentPane",()=>new xg(v.AFrameworkApplication.ya,v.AFrameworkApplication.ua.ez,v.AFrameworkApplication.ua.my,v.AFrameworkApplication.ua.$o,
v.AFrameworkApplication.ua.jv,U.App.xa,wg.a.instance,this.W.resolve("Common.Comments.IOfficeSharedCommentsEventHost"),this.W.resolve("WordEditor.Comments.IWordViewContainerAPI"),this.W.resolve("Common.Comments.IViewContainerEventHost"),v.AFrameworkApplication.uc,this.W.resolve("WordEditor.Comments.IFloatingCommentManager"),oa,this.W.resolve("WordEditor.Comments.CommentsState"),this.W.resolve("WordEditor.Comments.ICommentSelectionActor"),this.W.resolve("WordEditor.Comments.WordCommentEventsActor"),
this.W.resolve("WordEditor.Comments.IEditorCommentModel"))).as("Common.Comments.ICommentPane").as("WordEditor.Comments.IOfficeSharedCommentPane").singleInstance();this.W.ha("Common.Comments.OfficeSharedCommentsActionHost",()=>new fl(v.AFrameworkApplication.ya,this.W.resolve("WordEditor.Comments.IOfficeSharedCommentPane").bjc)).as("Common.Comments.IOfficeSharedCommentsActionHost").singleInstance();this.W.ha("WordEditor.Comments.WordEditorSharedCommentAPI",()=>new Al(v.AFrameworkApplication.uc,this.W.resolve("Common.Comments.IOfficeSharedCommentsEventHost"),
this.W.resolve("Common.Comments.IOfficeSharedCommentsActionHost"),this.W.resolve("WordEditor.Comments.IWordEditorSharedCommentModelTranslator"),this.W.resolve("Common.Comments.ICommentSmartReplyProvider"),oa,U.App.xa,v.AFrameworkApplication.ua.$o,this.W.Za("Common.ISystemInitiatedFeedback"),v.AFrameworkApplication.ya,J.a.instance,this.W.resolve("WordEditor.Comments.ICommentSelectionActor"),this.W.resolve("WordEditor.Comments.CommentsState"),this.W.resolve("WordEditor.Comments.CommentMarginEntryPointActor"),
this.W.resolve("WordEditor.Comments.ICommentsUsageAndHealthLogger"))).as("WordEditor.Comments.IWordEditorSharedCommentAPI").singleInstance();gm.a.factory=eo.getInstance;this.W.ha("WordEditor.Comments.EditorCommentManager",eo.getInstance).as("Common.Comments.ICommentManagerCore").as("WordEditor.Comments.IEditorCommentManager").singleInstance();this.W.ha("WordEditor.Comments.CommentFloatingContainerActor",()=>new bf(this.W.resolve("WordEditor.Comments.CommentsState"),oa,this.W.resolve("WordEditor.Comments.IEditorCommentModel"),
v.AFrameworkApplication.uc,this.W.resolve("WordEditor.Comments.ICommentActionInTypingRecorder"),this.W.resolve("WordEditor.Comments.WordCommentEventsActor"),this.W.resolve("WordEditor.Sidetrack.ISidetrackHelper"),()=>document.querySelector(`#${ye.AppFrame.AFa} .${Td.a.R_b}`),this.W.resolve("WordEditor.Comments.IWordSharedCommentsAppCapabilities"),v.AFrameworkApplication.ua.$o)).as("WordEditor.Comments.ICommentFloatingContainerActor").singleInstance();const cb=this.W.resolve("WordEditor.Sidetrack.SidetrackSettings"),
xb=cb.trackChangeInSidetrackEnabled;xb&&this.W.resolve("WordEditor.Sidetrack.IFloatingContainerActorConsumer").$Li(this.W.resolve("WordEditor.Comments.ICommentFloatingContainerActor"));this.W.ha("WordEditor.Comments.FloatingCommentManager",()=>new Yb(this.W.resolve("WordEditor.Comments.IEditorCommentModel"),v.AFrameworkApplication.uc,J.a.instance,this.W.resolve("WordEditor.Comments.ICommentActionInTypingRecorder"),oa,this.W.resolve("WordEditor.Comments.CommentsState"),this.W.resolve("WordEditor.Comments.WordCommentEventsActor"),
this.W.resolve("WordEditor.Sidetrack.ISidetrackHelper"),this.W.resolve("WordEditor.Comments.ICommentFloatingContainerActor"),cb)).singleInstance();this.W.ha("WordEditor.Comments.IFloatingCommentManager",()=>xb?this.W.resolve("WordEditor.Sidetrack.SidetrackManager"):this.W.resolve("WordEditor.Comments.FloatingCommentManager")).as("Box4.IFloatingObjectUpdater").singleInstance();this.W.ha("WordEditor.Comments.CommentSelectionActor",()=>new Hj(v.AFrameworkApplication.ya,this.W.resolve("Common.Comments.ICommentModel"),
this.W.resolve("WordEditor.Comments.ICommentHighlightActor"),pg.getInstance(),this.W.resolve("WordEditor.Comments.IFloatingCommentManager"),this.W.resolve("Common.Comments.IOfficeSharedCommentsEventHost"),v.AFrameworkApplication.ua.$o,this.W.resolve("WordEditor.Comments.CommentsState"),oa,new P.a(()=>cg.a.instance),this.W.resolve("WordEditor.Comments.CommentNodeTracker"),this.W.resolve("WordEditor.Comments.ICommentsUsageAndHealthLogger"),this.W.Za("WordEditor.Extension.RichApiEventManager"))).as("WordEditor.Comments.ICommentSelectionActor").singleInstance();
this.W.ha("WordEditor.Comments.CommentInitActor",()=>new Nk(this.W.resolve("WordEditor.Comments.IEditorCommentManager"),this.W.resolve("WordEditor.Comments.IEditorCommentModel"),this.W.resolve("WordEditor.Comments.IOfficeSharedCommentPane"),this.W.resolve("WordEditor.Comments.ICommentSelectionActor"),oa,this.W.resolve("WordEditor.Comments.CommentsState"),this.W.resolve("WordEditor.Comments.IFloatingCommentManager"),pg.getInstance(),U.App.xa.jq,v.AFrameworkApplication.ya,this.W.resolve("Common.IDynamicScriptLoaderProvider").JE,
this.W.Za("WordEditor.Comments.ICommentRibbonCommandHandler"),v.AFrameworkApplication.ua.$o,this.W.resolve("WordEditor.Comments.IWordSharedCommentsAppCapabilities"),this.W.resolve("Common.Comments.ICommentSmartReplyProvider"),this.W.resolve("Common.Comments.ICommentActivationManager"),this.W.resolve("WordEditor.Comments.IWordViewContainerAPI"),this.W.Za("Common.ISystemInitiatedFeedback"),this.W.resolve("WordEditor.Comments.WordCommentEventsActor"),this.W.Za("Common.App.SafeLinks.ISafeLinksManager"),
this.W.Za("Common.App.People.IExternalPeopleAPI"),this.W.resolve("Common.OfficeSharedCommentsTelemetry"),this.W.resolve("Common.Comments.IViewContainerEventHost"),this.W.resolve("WordEditor.Comments.ICommentsUsageAndHealthLogger"),this.W.resolve("WordEditor.Comments.ICommentFloatingContainerActor"),this.W.resolve("WordEditor.Sidetrack.ISidetrackHelper"),cb,this.W.resolve("WordEditor.ReviewSuggestionContent.WordContentNavigationAPI"),this.W.resolve("Box4.IPackageBootPerfLogger"),this.W.resolve("WordEditor.Comments.ICommentModelBootLoader"),
this.W.resolve("WordEditor.ReviewSuggestionContent.WordContentFilterAPI"))).singleInstance();this.W.ha("WordEditor.Comments.CommentsActionManager",()=>new Hf(this.W.resolve("WordEditor.Comments.EditorCommentManager"),this.W.resolve("WordEditor.Comments.EditorCommentModel"),this.W.resolve("WordEditor.Comments.ICommentHintActor"),this.W.resolve("WordEditor.Comments.ICommentSelectionActor"),this.W.resolve("WordEditor.Comments.WordCommentEventsActor"),this.W.resolve("WordEditor.Comments.CommentsState"),
this.W.resolve("WordEditor.Comments.IFloatingCommentManager"),oa,this.W.resolve("Common.Comments.ICommentPane"),new P.a(()=>U.App.xa.jb.Yc.zd),v.AFrameworkApplication.ya,new P.a(()=>cg.a.instance),xl.FocusManager.instance(),J.a.instance,this.W.resolve("WordEditor.Comments.CommentMarginEntryPointActor"))).as("WordEditor.Comments.CommentsActionManager").singleInstance();this.W.resolve("WordEditor.Comments.CommentInitActor");oa.contentNavigationApiEnabled&&(this.W.ha("WordEditor.Comments.CommentContentProvider",
()=>new Le(this.W.resolve("WordEditor.Comments.ICommentModelBootLoader"))).singleInstance(),this.W.ha("WordEditor.Comments.CommentContentActor",()=>new Dd(this.W.resolve("WordEditor.ReviewSuggestionContent.IReviewSuggestionContentManager"),this.W.resolve("WordEditor.Comments.IEditorCommentModel"),this.W.resolve("WordEditor.Comments.ICommentSelectionActor"),this.W.resolve("WordEditor.Comments.IEditorCommentManager"),this.W.resolve("WordEditor.Comments.CommentsState"))).singleInstance(),this.W.resolve("WordEditor.Comments.CommentContentProvider"),
this.W.resolve("WordEditor.Comments.CommentContentActor"));const Qb=oa.vq,qc=this.W.resolve("WordEditor.Comments.EditorCommentManager");this.W.resolve("WordEditor.Comments.CommentsActionManager");qc&&Qb&&(this.W.resolve("WordEditor.Comments.CommentsState").G$a=vn.PMh(),oa.cyb||this.W.resolve("WordEditor.Comments.WordCommentEventsActor").xna("OnCommentInit"));ej.a.Pzm();oa.JKc&&U.App.xa.jb.PDh();gm.a.instance&&(oa.cyb||Ch.a.get_instance().tl(4,()=>{this.uQm(Qb)},11).continueWith(()=>{this.G2l()}),
this._initialized=!0);this.hkn(this.W.Za("Box4.Accessibility.IAccessibilityContextManager"),this.W.resolve("Box4.IParagraphReader"),this.W.resolve("WordEditor.CommentsInteractive.ICommentEditor"))}G2l(){this.W.resolve("WordEditor.Comments.WordCommentEventsActor").xna("OnCommentInit")}uQm(oa){oa||this.DQl()}DQl(){const oa=vn.PMh();oa&&(a.ULS.sendTraceTag(35149084,327,50,"Comment deep linking starts after boot: {0}",(new Date).getTime()-v.AFrameworkApplication.bW),this.W.resolve("WordEditor.Comments.WordCommentEventsActor").xna("OnCommentInit",
Object.assign(new Qf.a,{UCa:()=>{gm.a.instance.Faa.isVisible||v.AFrameworkApplication.ya.processAction(Dh.a.UX,2);this.W.resolve("WordEditor.Comments.ICommentSelectionActor").TVi(oa,Object.assign(new gi.a,{M_f:!0}))}})),this.W.resolve("WordEditor.Comments.ICommentsUsageAndHealthLogger").TB(Dh.a.$Xe))}hkn(oa,cb,xb){oa&&oa.execute(Qb=>{Qb.i3(new lf.a(cb,xb))})}dispose(){this._initialized&&(gm.a.instance&&gm.a.instance.dispose(),this._initialized=!1)}static PMh(){return v.AFrameworkApplication.K.lb("BootActivityNavigationId")}}
Object(e.a)(vn,"PackageManager",null,[1,2]);const tg=oa=>{const cb=O.a.instance.Za("Box4.IPackageBootPerfLogger"),xb=window.performance.now();cb.execute(Qb=>{Qb.yv(nk.a.comments,"CPMain",xb,!0)});y.a.instance.Oc(new vn,0,oa)};var pm=d(1843);class hn{isComment(oa){return Sh.a.isComment(oa)}SNd(oa){return Sh.a.SNd(oa)}Apf(oa){return Sh.a.Apf(oa)}ZFf(oa,cb){Sh.a.ZFf(oa,cb)}cGf(oa,cb){Sh.a.cGf(oa,cb)}h0e(oa){return Sh.a.h0e(oa)}G0a(oa){return te.a.instance.G0a(oa)}deleteComment(oa,cb){Sh.a.deleteComment(oa,
cb)}Zyd(oa,cb){Sh.a.Zyd(oa,cb)}zjb(oa){Sh.a.zjb(oa)}h$(oa,cb,xb){return Sh.a.h$(oa,cb,xb)}Ssa(oa,cb,xb){return Sh.a.Ssa(oa,cb,xb)}K3b(oa,cb){return Sh.a.K3b(oa,cb)}DHc(oa,cb,xb,Qb=null){return Sh.a.DHc(oa,cb,xb,Qb)}KWb(oa,cb,xb,Qb){Sh.a.KWb(oa,cb,xb,Qb)}vqd(oa,cb,xb,Qb){return Sh.a.vqd(oa,cb,xb,Qb)}get MCb(){return Sh.a.MCb}set MCb(oa){Sh.a.MCb=oa}Z0a(oa,cb){Sh.a.Z0a(oa,cb)}GXc(oa){Sh.a.GXc(oa)}RRf(oa){Sh.a.RRf(oa)}kHd(oa,cb){return Sh.a.kHd(oa,cb)}$Ff(oa,cb){Sh.a.$Ff(oa,cb)}bGf(oa,cb){Sh.a.bGf(oa,
cb)}TWd(oa,cb,xb,Qb,qc,Mc){Sh.a.TWd(oa,cb,xb,Qb,qc,Mc)}$6e(oa,cb){Sh.a.$6e(oa,cb)}zVc(oa,cb,xb,Qb){return Sh.a.zVc(oa,cb,xb,Qb)}DVc(oa,cb,xb,Qb){return Sh.a.DVc(oa,cb,xb,Qb)}}Object(e.a)(hn,"CommentEditorProxy",null,[188]);class Zn{constructor(){this.W=null}get gLb(){return null!=this.$qg?this.$qg:this.$qg=(()=>this.W.Za("WordEditor.ITableEditor"))()}get i1a(){return null!=this.Kog?this.Kog:this.Kog=(()=>this.W.resolve("Box4.IPackageBootPerfLogger"))()}UV(oa){this.i1a.UV(nk.a.comments,oa,!0)}get name(){return"WordEditor.CommentsInteractive"}yc(oa){this.W=
oa;this.UV("CIPConfigStart");oa.ha("WordEditor.CommentsInteractive.CommentEditorProxy",()=>new hn).as("WordEditor.CommentsInteractive.ICommentEditor").singleInstance();this.UV("CIPConfigEnd")}init(){this.UV("CIPInitStart");this.W.resolve("Box4.IFeatureHelper").Yk.continueWith(()=>{this.Tm();this.UV("CIPInitEnd")})}Tm(){this.RYl()}dispose(){}RYl(){Uc.a.HOa(Sh.a.cGf);pm.a.jrd(Sh.a.$Ff);pm.a.pyc(Sh.a.bGf);pm.a.t7j(Sh.a.rQm);this.gLb.execute(oa=>{oa.tPe(Sh.a.Z0a)});U.App.Xj.al.Se(39).lp(Sh.a.ZFf);pm.a.C6j(Sh.a.xPm);
pm.a.v6j(Sh.a.QOm)}}Object(e.a)(Zn,"PackageManager",null,[1,2]);const Ok=oa=>{const cb=O.a.instance.Za("Box4.IPackageBootPerfLogger"),xb=window.performance.now();cb.execute(Qb=>{Qb.yv(nk.a.comments,"CIPMain",xb,!0)});y.a.instance.Oc(new Zn,0,oa)};var rl=d(1939),zm=d(181),il=d(1622);class Pn{constructor(oa,cb,xb,Qb,qc,Mc,Gd){this.SIa=oa;this.h9=cb;this.g5=xb;this.Xc=Qb;this.nFj=qc;this.$ze=Mc;this.hrb=Gd;il.a.s7j((de,Id)=>{this.z5j(Id.graphNode,Id.kAk)});il.a.W7j((de,Id)=>{this.FGk(Id.graphNode,Id.iyk)})}qGd(){var oa=
this.nFj();const cb=this.Xc.Dk();cb.set(oa);if(this.h9.mdo(cb))return cb;cb.set(oa);zm.PageNavigator.instance.zQ(cb);oa=this.g5.ZNk(cb.currentNode);cb.Ei(oa);return cb}xId(oa){const cb=this.qGd();let xb=null;this.h9.CDd(cb,Qb=>{this.g5.B_h(Qb)===oa&&(xb=Qb);return!xb});return xb}x_h(oa){const cb=this.qGd();let xb=null;this.h9.CDd(cb,Qb=>{this.g5.S3b(Qb)===oa&&(xb=Qb);return!xb});return xb}Zmi(oa,cb,xb){a.ULS.sendTraceTag(594928199,3003,50,"History Record Generated. [RecordType: {0}], [TaskID: {1}], [TaskCompletion: {2}]",
oa,cb,xb)}C_h(){const oa=this.qGd(),cb=[];this.h9.CDd(oa,xb=>{cb.push(this.g5.B_h(xb));return!0});return cb}xbb(oa,cb){if(!cb.length)return this.hrb&&a.ULS.sendTraceTag(42812043,3003,10,"A task must always have at least one history record."),null;const xb=this.qGd(),Qb=ci.a.create().toString(),qc=new ie.a;for(let Mc of cb)qc.add(Mc),this.Zmi(Mc.type,Qb,Mc.completion);cb=this.SIa.$Wf(qc);this.g5.xbb(xb.currentNode,Qb,oa,cb);this.$ze();return Qb}We(oa){(oa=this.xId(oa))?(this.g5.We(oa),this.$ze()):
this.hrb&&a.ULS.sendTraceTag(51656714,3003,10,"DeleteTask : Unable to find task with given ID")}S3b(oa){oa=this.xId(oa);return oa?this.g5.S3b(oa):(this.hrb&&a.ULS.sendTraceTag(42812044,3003,10,"GetTaskCommentAnchorId : Unable to find task with given ID"),null)}y_h(oa){return this.g5.S3b(oa)}A_h(oa){oa=this.xId(oa);if(!oa)return this.hrb&&a.ULS.sendTraceTag(42812045,3003,10,"GetTaskHistory : Unable to find task with given ID"),null;oa=this.g5.Ehf(oa);return this.SIa.Z_b(oa).toArray()}nck(oa,cb){if(!cb.length)return this.hrb&&
a.ULS.sendTraceTag(594928198,3003,10,"AppendTaskHistory : New records do not exist"),!1;const xb=this.xId(oa);if(!xb)return this.hrb&&a.ULS.sendTraceTag(42812046,3003,10,"AppendTaskHistory : Unable to find task with given ID"),!1;const Qb=this.g5.Ehf(xb),qc=this.SIa.Z_b(Qb);for(let Mc of cb)qc.add(Mc),this.Zmi(Mc.type,oa,Mc.completion);oa=this.SIa.$Wf(qc);oa!==Qb&&(this.g5.HOn(xb,oa),this.$ze());return!0}z5j(oa,cb){if(cb=this.x_h(cb)){const xb=this.Xc.Dk();xb.set(oa);this.g5.$b(cb.clone(),this.g5.C3k(cb,
xb))}}KKi(oa,cb,xb){if(cb.xb(oa))return cb.J(oa);const Qb=ci.a.create().toString();cb.add(oa,Qb);xb&&this.hrb&&a.ULS.sendTraceTag(593281437,3003,10,"RecordIdFromMapOrGenerateNewIdAndAddToMap : Unexpectedly creating new id.");return Qb}FGk(oa,cb){const xb=new vh.a;var Qb=this.Xc.Dk();Qb.set(oa);Qb.Rb(38)&&this.h9.CDd(Qb,qc=>{const Mc=this.g5.S3b(qc);void 0!==Mc&&null!==Mc&&xb.add(Mc,qc);return!0});for(let qc of cb)if(oa=null,({value:oa}=xb.Dc(qc.key,oa)).returnValue)if(qc.value===qc.key)oa=this.x_h(qc.key),
this.g5.sPn(oa,parseInt(qc.key));else{oa=this.g5.Ehf(oa);if(!oa||""===oa){a.ULS.sendTraceTag(595347466,3003,10,"CopyTaskNodesFromParentNode : History Records not found on taskNode on clipboard");break}oa=this.SIa.Z_b(oa);Qb=new ab.a;for(let Mc=0;Mc<oa.length;Mc++){if(oa.J(Mc).commentId){const Gd=Number.parseInvariant(oa.J(Mc).commentId);cb.xb(Gd)?oa.J(Mc).commentId=cb.J(Gd).toString():oa.J(Mc).commentId=null}oa.J(Mc).recordId=this.KKi(oa.J(Mc).recordId,Qb,!1);-1===oa.J(Mc).type&&(oa.J(Mc).undoId=
this.KKi(oa.J(Mc).undoId,Qb,!0))}this.xbb(qc.value,oa.toArray())}}static mr(){return new Pn(O.a.instance.resolve("WordEditor.Tasks.ITaskHistorySerialization"),O.a.instance.resolve("WordEditor.Tasks.ITaskNavigator"),O.a.instance.resolve("WordEditor.Tasks.ITaskEditor"),new Ek.a,()=>U.App.xa.jb.Yc,()=>{O.a.instance.Za("Common.Interface.IEditNotificationManager").execute(oa=>{oa.oAd()})},!0)}}Object(e.a)(Pn,"TaskActor",null,[276]);var up=d(1093);class Qn{create(){return new up.a}}Object(e.a)(Qn,"TaskContentNodeFactory",
null,[256]);var Rn=d(1023);class Uj{create(){return new Rn.a}}Object(e.a)(Uj,"TaskNodeFactory",null,[256]);class zk{constructor(oa,cb,xb,Qb,qc,Mc){this.h9=oa;this.Hc=cb;this.Xc=xb;this.jXj=Qb;this.mXj=qc;this.WNb=Mc}JMk(oa,cb,xb){const Qb=this.mXj.create(1074135162);Qb.setValue(la.a.taskId,oa);Qb.setValue(la.a.kLb,cb);Qb.setValue(la.a.Wva,xb);return Qb}U3b(oa){const cb=this.Hc.Rc(4);cb.Db(oa);this.WNb();return cb}B_h(oa){return this.h9.UDb(oa)?oa.getValue(la.a.taskId):(a.ULS.sendTraceTag(42812047,
3003,10,"Unexpected node type"),null)}S3b(oa){return this.h9.UDb(oa)?oa.hasProperty(la.a.kLb)?oa.getValue(la.a.kLb):null:(a.ULS.sendTraceTag(42812048,3003,10,"Unexpected node type"),null)}Ehf(oa){return this.h9.UDb(oa)?oa.getValue(la.a.Wva):(a.ULS.sendTraceTag(42812049,3003,10,"Unexpected node type"),null)}ZNk(oa){if(7!==oa.type)return a.ULS.sendTraceTag(42812050,3003,10,"Unexpected node type"),null;const cb=this.U3b(oa);try{const xb=this.jXj.create(1074135161),Qb=this.Xc.Dk();Qb.set(oa);Qb.j1(xb,
38,zk.F6n);return xb}finally{cb&&cb.dispose()}}xbb(oa,cb,xb,Qb){if(!this.h9.Ztf(oa))return a.ULS.sendTraceTag(42812051,3003,10,"Unexpected node type"),null;const qc=this.U3b(oa);try{const Mc=this.JMk(cb,xb,Qb),Gd=this.Xc.Dk();Gd.set(oa);Gd.j1(Mc,1,new ka.a(ci.a.qka(xb.toString()),1));return Mc}finally{qc&&qc.dispose()}}We(oa){if(this.h9.UDb(oa))if(oa.anchor&&oa.anchor.Ip){var cb=oa.anchor.Ip.yr.node;if(this.h9.Ztf(cb)){var xb=this.U3b(cb);try{const Qb=this.Xc.Dk();Qb.set(cb);Qb.Ei(oa.anchor.node);
Qb.Eg()}finally{xb&&xb.dispose()}}else a.ULS.sendTraceTag(51656717,3003,10,"Task node unexpectedly parented to non-content node")}else a.ULS.sendTraceTag(51656716,3003,10,"Cannot delete an unlinked node");else a.ULS.sendTraceTag(51656715,3003,10,"Unexpected node type")}HOn(oa,cb){if(this.h9.UDb(oa)){var xb=this.U3b(oa);try{oa.setValue(la.a.Wva,cb)}finally{xb&&xb.dispose()}}else a.ULS.sendTraceTag(42812052,3003,10,"Unexpected node type")}sPn(oa,cb){if(this.h9.UDb(oa)){var xb=this.U3b(oa);try{const Qb=
oa.hasProperty(la.a.kLb)?oa.getValue(la.a.kLb):null;void 0===Qb||null===Qb||Qb===cb?oa.lh(la.a.kLb,cb):a.ULS.sendTraceTag(595347464,3003,10,"TaskAnchorId is changed.")}finally{xb&&xb.dispose()}}else a.ULS.sendTraceTag(595347465,3003,10,"Unexpected node type")}C3k(oa,cb){if(!cb.aq(38)){const xb=this.Xc.Dk();xb.set(oa);xb.Bb(71);xb.kd(71);oa=eb.a(xb.currentNode,oa.Di().Lc,!0);cb.Sf(oa,38)}return cb.Rb(38)}$b(oa,cb){if(this.h9.Ztf(cb)){var xb=this.U3b(cb);try{const Qb=this.Xc.Dk();Qb.set(cb);Qb.Sf(oa,
1)}finally{xb&&xb.dispose()}}else a.ULS.sendTraceTag(595347463,3003,10,"Unexpected node type")}static mr(){return new zk(O.a.instance.resolve("WordEditor.Tasks.ITaskNavigator"),new $f.a,new Ek.a,new Qn,new Uj,()=>{Zh.App.fm.jb.Yc.AF.y9(10)})}}zk.F6n=new ka.a(ci.a.Of("50f73b87-1d48-4f4a-94a3-4c20e2cf6387"),1);Object(e.a)(zk,"TaskEditor",null,[275]);class cm{constructor(oa,cb){this.yx=oa;this.iTb=cb}UDb(oa){return!!oa&&72===oa.type}Mlm(oa){return!!oa&&71===oa.Qe}Ztf(oa){return!!oa&&71===oa.type}mdo(oa){oa.set(this.yx.value);
this.iTb.zQ(oa);return!!oa.Rb(38)}CDd(oa,cb){if(oa&&cb)if(this.Mlm(oa))for(var xb=!0,Qb=oa.Rb(1);xb&&Qb;)this.UDb(Qb)||a.ULS.sendTraceTag(42812055,3003,10,"Unexpected node type {0}",Qb.type),xb=cb(Qb),Qb=oa.vf(1);else a.ULS.sendTraceTag(42812054,3003,10,"Unexpected iterator type {0}",oa.Qe);else a.ULS.sendTraceTag(42812053,3003,10,"ForEachTaskInTaskContent : Invalid Input")}static mr(){return new cm(new P.a(()=>U.App.xa.jb.Yc),zm.PageNavigator.instance)}}Object(e.a)(cm,"TaskNavigator",null,[187]);
class Wo{constructor(){this.W=null}get name(){return"WordEditor.Tasks"}init(){this.W.resolve("Box4.IFeatureHelper").Yk.continueWith(()=>{this.Tm()})}dispose(){}yc(oa){this.W=oa;oa.ha("WordEditor.Tasks.JsonTaskHistorySerialization",()=>new rl.a).as("WordEditor.Tasks.ITaskHistorySerialization").singleInstance();oa.ha("WordEditor.Tasks.TaskNavigator",()=>cm.mr()).as("WordEditor.Tasks.ITaskNavigator").singleInstance();oa.ha("WordEditor.Tasks.TaskEditor",()=>zk.mr()).as("WordEditor.Tasks.ITaskEditor").singleInstance();
oa.ha("WordEditor.Tasks.TaskActor",()=>Pn.mr()).as("WordEditor.Tasks.ITaskActor").singleInstance()}Tm(){this.W.resolve("Box4.IFeatureHelper").isFeatureEnabled(122)}}Object(e.a)(Wo,"TasksPackage",null,[1,2]);var In=d(68),Ul=d(1619),Ym=d(440),Fm=d(73);class Hk{constructor(){this.onResizeMiddleContainer=this.onTabStripFocus=this.onResizeEnd=this.onResizeStart=this.onOverflowMenuClose=this.onOverflowMenuOpen=this.setFocusCallback=this.onHide=this.onShow=this.onClose=this.onOpen=this.middleContainer=null}}
Object(e.a)(Hk,"TaskPaneGroupAppProps",null,[]);var dm=d(139);class Xo{static BBk(oa,cb){xl.FocusManager.fJ()&&($k.a.instance.Qya(oa,cb,!1),dm.a.instance.Qya(oa,cb,!1),v.AFrameworkApplication.ua.jv.qS(oa))}}Object(e.a)(Xo,"ReactTaskPaneManagerUtils",null,[]);var Si=d(114),rj=d(289);class Gm{constructor(){this.type=null}}Object(e.a)(Gm,"SampleTaskPaneProps",null,[]);var Ik=d(1620);class Yf{constructor(){this.entry=null;this.show=!1}}Object(e.a)(Yf,"AnimationBatchEntry",null,[]);var im=d(280),Zm=d(1109),
qf=d(99);class Wi{constructor(){this.cVg=[];this.dVg=[];this.lja={};this.kGa=this.jGa=null;this.Fnd=!1;this.HY=null;this.Ckd=this.mfd=0;this.tjc=[];this.ive=!!v.AFrameworkApplication.ua&&v.AFrameworkApplication.ua.Sb.lgb;this.ew=!1}initialize(){this.Fnd=!1;(this.ew=!!v.AFrameworkApplication.ua&&v.AFrameworkApplication.ua.Sb.A6)&&this.W0e()}Y0e(oa,cb,xb,Qb){cb=this.zId(cb);a.ULS.sendTraceTag(4290588,320,50,"Create new task pane.");this.W0e();const qc=document.createElement("div");qc.id=cb;qc.className=
Wi.Qqo;qc.style.width="0";this.ive||(this.x2j(xb,cb,qc),this.lja[cb]=oa.Y0e(cb,xb,Qb,qc));return qc}W0e(){this.Fnd||this.nRn()}x2j(oa,cb,xb){let Qb=null,qc=null;0===oa?(Qb=this.jGa,qc=this.cVg):1===oa&&(Qb=this.kGa,qc=this.dVg);if(Qb){oa=!1;for(let Mc=0;Mc<qc.length;Mc++)if(!oa)qc[Mc]===cb&&(oa=!0);else if(qc[Mc]in this.lja){this.N6l(Qb,xb,this.lja[qc[Mc]]);return}Qb.appendChild(xb)}}N6l(oa,cb,xb){oa.insertBefore(cb,xb.element)}jYk(oa){oa=this.zId(oa);if(oa in this.lja){const cb=this.lja[oa];cb.element.parentNode.removeChild(cb.element);
delete this.lja[oa]}}w5i(oa){oa=this.zId(oa);oa in this.lja&&(oa=this.lja[oa])&&!oa.isVisible&&(this.J4i(oa,!0),this.pah(oa.position,!0,this.Yih(oa,!0)),1===oa.position&&1<K.a.count(this.lja)&&this.oCm())}mYl(oa){oa=this.zId(oa);oa in this.lja&&(oa=this.lja[oa])&&oa.isVisible&&(this.J4i(oa,!1),this.pah(oa.position,!1,this.Yih(oa,!1)))}s_b(oa){if(this.HY)return this.HY;const cb=document.createElement("div");document.body.appendChild(cb);cb&&(this.HY=new Ul.a(cb,oa));return this.HY}J4i(oa,cb){oa.element&&
(oa.isVisible=cb,this.tjc.push(Object.assign(new Yf,{entry:oa,show:cb})));0===oa.position?this.mfd+=cb?1:-1:this.Ckd+=cb?1:-1;1===this.tjc.length&&window.setTimeout(Object(fn.a)(this,this.$1n,"startPaneAnimation"),0);this.ew&&oa.element&&oa.element.parentNode&&(0===oa.position&&!this.mfd||1===oa.position&&!this.Ckd?(oa.element.parentNode.style.minHeight="0px",oa.element.parentNode.style.height="0px",oa.element.parentNode.style.overflow="hidden"):(oa.element.parentNode.style.minHeight="",oa.element.parentNode.style.height=
"",oa.element.parentNode.style.overflow=""))}$1n(){this.Ryi();var oa=lc.where(lc.asEnumerable(this.tjc),qc=>0===qc.entry.position),cb=lc.where(oa,qc=>!qc.show);if(lc.any(cb)&&lc.Ct(cb)!==lc.Ct(oa)){for(var xb of cb)xb.entry.element.style.width="0";oa=lc.where(oa,qc=>qc.show)}cb=lc.where(lc.asEnumerable(this.tjc),qc=>1===qc.entry.position);xb=lc.where(cb,qc=>!qc.show);if(lc.any(xb)&&lc.Ct(xb)!==lc.Ct(cb)){for(var Qb of xb)Qb.entry.element.style.width="0";cb=lc.where(cb,qc=>qc.show)}for(let qc of lc.concat(oa,
cb))oa=qc.entry,qf.WacAirSpace.rU(oa.element,im.a.z0f),Qb=new Zm.a(oa.element),qc.show?Qb.zQe(0,oa.width):Qb.zQe(oa.width,0),qf.WacAirSpace.animate(Qb,null,null);this.tjc.length=0}Ryi(){}Yih(oa,cb){let xb=oa.width;oa=0===oa.position?this.mfd:this.Ckd;if(cb&&1===oa||!cb&&!oa)xb+=1;return xb}nRn(){this.Fnd||(this.jGa||(this.jGa=document.createElement("div"),this.jGa.id=Wi.Oqo,this.jGa.className=Wi.dlj,Sys.UI.DomElement.addCssClass(this.jGa,"alignLeft"),v.AFrameworkApplication.ua&&v.AFrameworkApplication.ua.Sb.B6&&
Sys.UI.DomElement.addCssClass(this.jGa,"FlexBoxLayout"),this.ive&&Sys.UI.DomElement.addCssClass(this.jGa,Wi.blj),this.q9g(0,this.jGa)),this.kGa||(this.kGa=document.createElement("div"),this.kGa.id=Wi.Pqo,this.kGa.className=Wi.dlj,Sys.UI.DomElement.addCssClass(this.kGa,"alignRight"),v.AFrameworkApplication.ua&&v.AFrameworkApplication.ua.Sb.B6&&Sys.UI.DomElement.addCssClass(this.kGa,"FlexBoxLayout"),this.ive&&Sys.UI.DomElement.addCssClass(this.kGa,Wi.blj),this.q9g(1,this.kGa)),this.OAi(this.jGa,this.kGa),
this.Fnd=!0)}OAi(){}Uya(oa,cb){Array.add(1===oa?this.dVg:this.cVg,cb)}zId(oa){return oa+"-Entry"}oCm(){let oa=0;for(const cb of K.a.UN(this.lja)){const xb=Object(tc.a)(926,this.lja[cb]);xb&&xb.isVisible&&1===xb.position&&oa++}2===oa?a.ULS.sendTraceTag(595179606,320,50,"2 simultaneous panes open"):2<oa&&a.ULS.sendTraceTag(595179605,320,50,oa+" simultaneous panes open")}}Wi.Oqo="WACTaskPaneContainerLeft";Wi.Pqo="WACTaskPaneContainerRight";Wi.dlj="WACTaskPaneContainer";Wi.Qqo="WACTaskPaneEntry";Wi.blj=
"WACReactTaskPaneContainer";Object(e.a)(Wi,"BaseTaskPaneManager",null,[927]);var jg=d(400),Oj=d(315);class sj extends Wi{constructor(oa,cb){super();this.csc=this.bsc=this.kMe=this.jMe=0;this.ga=oa;this.EJg=cb}q9g(oa,cb){const xb=U.App.xa.lC;xb.parentNode&&(oa?1===oa&&(this.ew?((oa=Object(Oj.a)("FarPane"))&&oa.appendChild(cb),cb.classList.add("regionComposer"),U.App.xa.wu.registerBoundingWindowRectsChanged("farPane",(Qb,qc)=>{"DP"===qc||3===qc?cb.classList.add("DL"):cb.classList.remove("DL")})):xb.parentNode.insertBefore(cb,
xb.nextSibling)):this.ew?((oa=Object(Oj.a)("NearPane"))&&oa.appendChild(cb),cb.classList.add("regionComposer")):xb.parentNode.insertBefore(cb,xb))}pah(oa,cb,xb){this.ew||(cb=cb?xb:-xb,oa?this.csc+=cb:this.bsc+=cb)}Ryi(){if(!this.ew){var oa=U.App.xa.lC;qf.WacAirSpace.rU(oa,im.a.z0f);if(this.jMe!==this.bsc){const cb=new jg.a(oa);cb.Mak(this.jMe,this.bsc,this.EJg);qf.WacAirSpace.animate(cb,null,Object(fn.a)(this,this.ZJh,"forceInteractiveViewRefreshOutline"));this.jMe=this.bsc}this.kMe!==this.csc&&(oa=
new jg.a(oa),oa.Nak(this.kMe,this.csc,this.EJg),qf.WacAirSpace.animate(oa,null,Object(fn.a)(this,this.ZJh,"forceInteractiveViewRefreshOutline")),this.kMe=this.csc)}}ZJh(){Ri.InteractiveViewManager.instance.forEach(oa=>{oa.HDd()})}}Object(e.a)(sj,"TaskPaneManager",Wi,[]);var jl=d(336);class oh extends sj{constructor(oa,cb){super(oa,cb);this.EV=Xh.KeyInputManager.lc(In.a.mx,0);this.FV=Xh.KeyInputManager.lc(In.a.mx,4);this.VEe=this.Orc=null;this.NOg="AccCheckerTaskPane";this.sa=new ra.a;this.isPaneOpen=
!1;this.rge=this.epe=null;this.Uya(0,"SampleTaskPane");this.Uya(0,jl.a.Ncb);this.Uya(1,jl.a.Dfk);this.Uya(1,"CustomTaskPane");this.Uya(1,jl.a.uof);this.Uya(1,Cg.AFrame.gr);this.Uya(1,Cg.AFrame.k7g);this.Uya(1,Cg.AFrame.f7g);this.Uya(1,jl.a.PDd);this.Uya(1,jl.a.ODc);this.Uya(1,jl.a.vFc);this.FJj=(this.Rug=!!v.AFrameworkApplication.ua&&!!v.AFrameworkApplication.ua.Sb)&&v.AFrameworkApplication.ua.Sb.atf;this.HIj=Zh.App.bEb;this.OIj=this.Rug&&v.AFrameworkApplication.ua.Sb.WOc;this.initialize();oa.gb(Tg.a.Q0f,
Af.a.application,oh.Q0f,96)}get Eci(){null==this.rge&&(this.rge=v.AFrameworkApplication.K?v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ExternalContentFloatiePositionIsEnabled",!1):!1);return this.rge}get B4d(){if(!U.App.xa||!U.App.xa.lC)return null;this.VEe||(this.VEe=new Ul.a(U.App.xa.lC,xl.FocusManager.instance()));return this.VEe}Vb(){}OAi(oa,cb){const xb=Ym.a.instance,Qb=xl.FocusManager.instance(),qc=Fm.EventHandlerManager.instance,Mc=this;Fb.UISurfaces.$t().then(Gd=>
{Mc.Orc=Mc.s_b(Qb);let de;Gd.renderTaskPaneGroups(oa,cb,(de=new Hk,de.middleContainer=U.App.xa.lC,de.onTabStripFocus=()=>{Qb.fC(jl.a.Nfc)},de.onOpen=(Id,Xe)=>{Mc.btf(Id)&&Xo.BBk(Id,Xe);qc.aOe(Xe,"focus",Mc.xYh(Id,Qb),!0);var hf=Mc.kei(Id),Ef=Gd.selectors.getTabbedTaskPaneCount(hf?1:2);hf=hf?jl.a.S$d:jl.a.Nfc;1===Ef&&(xb.Rya(hf),this.isPaneOpen=!0,this.pJi({isPaneOpen:this.isPaneOpen,agc:Xe}));Xe=Mc.eef(Id);if(Ef=Qb.re(Xe))Ef.RBc=hf,Mc.EVn(Id)&&(Ef.Dr(Mc.EV),Ef.Dr(Mc.FV)),xb.Wci(Xe)&&xb.Mw(Xe);this.Eci&&
this.PBd&&this.PBd.qw(!0)},de.onClose=(Id,Xe)=>{Mc.btf(Id);const hf=Mc.kei(Id),Ef=hf?jl.a.S$d:jl.a.Nfc;Gd.selectors.getTabbedTaskPaneCount(hf?1:2)||(xb.Mw(Ef),this.isPaneOpen=!1,this.pJi({isPaneOpen:this.isPaneOpen,agc:Xe}));qc.URf(Xe,"focus",Mc.xYh(Id,Qb),!0);this.Eci&&this.PBd&&this.PBd.qw(!0)},de.setFocusCallback=(Id,Xe)=>{Mc.btf(Id)&&Xe&&(Id=Qb.re(Mc.eef(Id)),Id.$wk(),Id.eda(Xe))},de.onOverflowMenuOpen=()=>{if(Mc.Orc)Mc.Orc.onMenuOpen()},de.onOverflowMenuClose=()=>{if(Mc.Orc)Mc.Orc.onMenuClose()},
de.onShow=(Id,Xe)=>{2===Xe&&window.requestAnimationFrame(()=>{window.setTimeout(()=>{Qb.Jg(Id)},0)})},de.onHide=(Id,Xe,hf)=>{hf&&1!==Xe&&Qb.Jg(Qb.HS)},de.onResizeStart=()=>{if(U.App.xa&&(U.App.xa.lC.className=ye.AppFrame.t$f,Mc.B4d))Mc.B4d.onMenuOpen()},de.onResizeEnd=()=>{if(U.App.xa&&(Si.a.ugi()||(U.App.xa.lC.className+=" "+U.App.xa.tkh),Mc.B4d))Mc.B4d.onMenuClose()},de));this.Rga(jl.a.Nfc,Qb,cb,Mc);this.Rga(jl.a.S$d,Qb,oa,Mc);return null})}Rga(oa,cb,xb,Qb){const qc=cb.re(oa);qc.parent=Cg.AFrame.Np;
qc.UL=!0;$k.a.instance.Qya(oa,xb,!1);dm.a.instance.Qya(oa,xb,!1);oa=new rj.DOMFocusListing(()=>xb);oa.Go(3);oa.Go(2);oa.Go(4);oa.Go(1);cb.Pja(()=>xb,qc,oa).mX=!0;qc.Dr(Qb.EV);qc.Dr(Qb.FV)}eef(oa){return oa===this.NOg?jl.a.s6g:oa}xYh(oa,cb){return()=>{cb.fC(this.eef(oa))}}EVn(oa){return oa===this.NOg?!1:!0}Vcm(oa){return oa===jl.a.Ncb}btf(oa){return this.Vcm(oa)||oa===jl.a.s6g||0<=oa.indexOf("AppForOfficePanel")||oa===jl.a.PDd||oa===jl.a.uof&&this.FJj||oa===jl.a.ODc&&this.HIj||oa===jl.a.vFc&&this.OIj||
oa===Ik.a.vzb?!0:!1}kei(oa){return oa===jl.a.Ncb||"SampleTaskPane"===oa}static OLl(){return new oh(v.AFrameworkApplication.ya,v.AFrameworkApplication.isRtl)}static Q0f(oa,cb,xb,Qb,qc){if(1===xb)return 32;Fb.UISurfaces.$t().then(Mc=>{Mc.showTaskPane(qc,Object.assign(new yl.a,{title:"Sample Task Pane",width:320,location:2,contentProps:Object.assign(new Gm,{type:"SampleTaskPaneProps"})}));return null});return 32}nJa(oa){this.sa.addHandler("onPaneToggle",oa)}eYc(oa){this.sa.removeHandler("onPaneToggle",
oa)}pJi(oa){this.sa.raiseEvent("onPaneToggle",oa)}get PBd(){this.epe||(this.epe=O.a.instance.Pa("WordEditor.Actors.ExternalContentFloatieEventManager"));return this.epe}}Object(e.a)(oh,"TaskPaneManager",sj,[186]);class Gl{constructor(){this.lS=null}get name(){return"WordEditor.TaskPaneManager"}yc(){}init(){this.lS=oh.OLl();this.lS.Vb();U.App.xa.Blb=this.lS}dispose(){}}Object(e.a)(Gl,"PackageManager",null,[1,2]);d.d(N,"a",function(){return l})},1843:function(C,N,d){C=d(0);var l=d(22),e=d(2),a=d(720),
k=d(169),n=d(67),v=d(57),u=d(5),t=d(47),y=d(17),B=d(8),G=d(44),F=d(76),K=d(438),O=d(20),H=d(442),I=d(6),J=d(595),L=d(206),S=d(64),E=d(226),P=d(21),T=d(1069),U=d(40),X=d(92),Y=d(43),ca=d(765),da=d(32),ua=d(94),ra=d(23),qa=d(63);class ka{constructor(Ga,Fa,ib,ob){this.hzd=this.fzd=null;this.X0c=Ga;this.bae=Fa;this.G6i=ib;this.H6i=ob}}Object(C.a)(ka,"TableSimplificationInformation",null,[]);var la=d(89),Ha=d(34),wa=d(478),Ca=d(254),Ja=d(907),bb=d(1541),ha=d(297),ia=d(3),va=d(9),Ka=d(138),Xa=d(133),xa=
d(19),Ma=d(271),Na=d(38),pa=d(287),Ra=d(11),Sa=d(646),ab=d(569);class eb extends Sys.EventArgs{constructor(Ga){super();this.xo=Ga}}Object(C.a)(eb,"AfterTrimCompleteOnCopyArgs",Sys.EventArgs,[]);var zb=d(1708);class Ua extends zb.a{constructor(Ga,Fa,ib,ob){super(Ga,Fa,{});this.oPa=[];for(Ga=0;Ga<ib.length;Ga++)this.oPa.push(...ib.J(Ga).toArray());this.Kza=0;this.Sx=ob;this.xo={}}}Object(C.a)(Ua,"BasicInternalCopyArguments",zb.a,[]);class Ab extends Sys.EventArgs{constructor(Ga,Fa){super();this.xo=
Fa;this.oPa=[];for(Fa=0;Fa<Ga.length;Fa++)this.oPa.push(...Ga.J(Fa).toArray())}}Object(C.a)(Ab,"BeforeCopyArguments",Sys.EventArgs,[]);class mb extends Sys.EventArgs{constructor(Ga){super();this.xo=Ga}}Object(C.a)(mb,"BeforePasteArguments",Sys.EventArgs,[]);class Rb extends Sys.EventArgs{constructor(Ga,Fa,ib,ob){super();this.paragraph=Ga;this.cpBegin=Fa;this.cpEnd=ib;this.xo=ob}}Object(C.a)(Rb,"BeforeTrimOnCopyArguments",Sys.EventArgs,[]);var hc=d(1754),Hb=d(1755);class Ta{constructor(Ga,Fa,ib,ob,
fb,Mb,Tb,rc,vb){this.Qfc=Ga;this.source=Fa;this.target=ib;this.EJf=ob;this.rowIndex=fb;this.ao=Mb;this.wAc=Tb;this.UDi=rc;this.ve=vb}}Object(C.a)(Ta,"CoreInternalTablePasteArguments",null,[]);class Aa extends Sys.EventArgs{constructor(Ga,Fa,ib,ob,fb){super();this.operation=Ga;this.JBi=Fa;this.original=ib;this.clone=ob;this.xo=fb}}Object(C.a)(Aa,"ParagraphCopyPasteArguments",Sys.EventArgs,[]);d.d(N,"a",function(){return ma});class ma{constructor(Ga,Fa,ib,ob,fb,Mb,Tb,rc,vb,Ya,wb,jb,Zb,Eb,tc){this.PV=
this.Qs=null;this.Uze=!1;this.z8=this.uxa=null;this.KSb=Mb;this.gp=Tb;this.ij=Ga;this.nJe=Fa;this.BJ=ib;this.Kh=ob;this.uG=fb;this.Oa=rc;this.Hc=Ya;this.hpd=vb.create(2097162);this.bRf(this.hpd);this.$ne=vb.create(2097162);this.bRf(this.$ne);this.mMe=vb.create(2097162);this.bRf(this.mMe);this.Qnd=this.hpd;this.nY=wb;this.c1=jb;this.Hd=Zb;this.vvc=Eb;this.WTj=Eb.substr(0,3);this.G4=tc}get paragraphEditor(){return null!=this.jpg?this.jpg:this.jpg=l.a.instance.resolve("Box4.IParagraphEditor")}get Qb(){return null!=
this.Cjg?this.Cjg:this.Cjg=l.a.instance.Pa("Box4.IFeatureHelper")}get Mu(){return this.Qs?this.Qs.Mu:0}get Wwb(){return this.Qs.kb.Wwb}get ysa(){return this.Qs.kb.ysa}get iha(){return this.Qnd}get raj(){return this.mMe}get jZe(){return this.Qs.zI&&!this.Uze}Y0i(){this.Uze=!0}get mBi(){return!this.Qs.zI}get Coa(){return Sa.a.instance}get Shm(){return this.Oa.$("InternalPasteTableWithReplacingCellIsEnabled")}bRf(Ga){var Fa=new Ja.a(-1);this.KSb.al.kJa(Fa);const ib=new I.GraphIterator;ib.set(Fa);e.AFrameworkApplication.Hl("Microsoft.Office.Web.SessionSettings.IWacWordNoRenderGraphTransactionInternalClipboardSettings");
Fa=3;this.Oa&&this.Oa.$("NoRenderGraphTransactionInternalClipboardIsEnabled")&&(Fa=0);Fa=this.Hc.Rc(Fa);Fa.Ou(ib);ib.Sf(Ga,80);Fa.dispose()}axd(Ga,Fa=null){Ga=Ga.Cb;this.Qs=Ga.hb.clone();this.Uze=!1;Ga=I.GraphIterator.$a(Ga.J_);const ib=I.GraphIterator.$a(this.iha),ob=this.Hc.Rc(3,ia.a.internalCopy);ob.Ou(ib);Ga.Rb(82);do Ga.currentNode.yMb(null);while(Ga.Wi(82));Ga=new a.a(Fa,Object(G.a)(this,this.xwk,"clearInternalClipboard"),new Ua(Ga,ib,this.Qs,ob));Ga.ml("InternalCopy");Ga.eh=!Fa||Fa.eh;Ga.run()}xwk(Ga,
Fa){k.a.mark(5566);Fa=Fa.target;if(Fa.Xd())return Fa.Eg(),!0;Ga.ti(Object(G.a)(this,this.DFc,"executeCopy"));return!0}DFc(Ga,Fa){Fa=new hc.a(Fa,null);const ib=new a.a(Ga,Object(G.a)(this,this.qCc,"coreCopySetup"),Fa);ib.ml("ExecuteCoreCopyToInternalClipboard");this.s9m(Fa);ib.run();Ga.ti(Object(G.a)(this,this.ibo,"trimNewText"));return!0}qCc(Ga,Fa){if(!Fa.source.Xd())return Fa.Vi&&(Fa.Vi.Iud=null),B.ULS.shipAssertTag(6305560,307,!1),!1;Ga.ti(Object(G.a)(this,this.msh,"coreCopyIteration"));return!0}msh(Ga,
Fa){const ib=Fa.insertAfter,ob=Fa.source,fb=Fa.target,Mb=ob.currentNode;var Tb=this.mBi;if(!Mb.lfa)return Ga.ti(Object(G.a)(this,this.pCc,"coreCopyIncrement")),!0;Fa.Vi.dKb&&(Fa.dKb=!0);if(!this.iuk(Fa))return Fa.wha.YBa.c++,Ga.ti(Object(G.a)(this,this.pCc,"coreCopyIncrement")),!0;if(!Fa.dKb&&(Mb.g1b()&&Fa.wha.YBa.c++,Mb.g1b()||Tb&&!Mb.hgb(this.Mu)))return Ga.ti(Object(G.a)(this,this.pCc,"coreCopyIncrement")),!0;if(!Fa.dKb&&Tb&&!Mb.Zy)return ob.bD()&&(Fa.nde=!0,Fa=new a.a(Ga,Object(G.a)(this,this.qCc,
"coreCopySetup"),new hc.a(Fa,ib)),Fa.ml("RecursiveCoreCopyToInternalClipboard"),Fa.run()),Ga.ti(Object(G.a)(this,this.pCc,"coreCopyIncrement")),!0;Tb=fb.currentNode.Di().zd;Tb=J.a(Mb,Tb,!0);Tb.i6b=!0;this.Coa.U2d(Fa.wha.pBb,Tb);fb.cH(Tb,ib,18===ob.parentNode.type?1:ob.role);fb.Ei(Tb);Fa.insertAfter=Tb;Ra.ParagraphReader.nc(Tb)&&(this.G9m(Ga,Object(G.a)(this,this.qCc,"coreCopySetup"),Mb,Tb,Fa),this.F9m(Ga,Mb,Tb));this.BEh(Mb,Tb);ob.bD()&&(B.ULS.shipAssertTag(6305562,307,!Fa.nde),Fa=new a.a(Ga,Object(G.a)(this,
this.qCc,"coreCopySetup"),new hc.a(Fa,null)),Fa.ml("RecursiveCoreCopyToInternalClipboard"),Fa.run());Ga.ti(Object(G.a)(this,this.HGk,"coreCopyIterationPostProcessing"));return!0}HGk(Ga,Fa){var ib=Fa.source;const ob=Fa.target;var fb=ob.currentNode,Mb=ib.currentNode;Ra.ParagraphReader.zh(ob)&&(Fa.pKf[Mb.id.toString()]=fb);if(Ra.ParagraphReader.nc(fb)){if(0<Ra.ParagraphReader.YZh(Mb))if(0<this.gp.wF(Mb).kt)Mb.setValue(u.a.gOa,0);else{const Tb=this.gp.g2(Mb).kt;this.paragraphEditor.qp.$aa(fb,Tb)}if(!this.sNc&&
this.G4.VDi){ib.mc();if(!Na.TableReader.Yw(ob)&&ib.sCa&&!this.ysa)for(const Tb of this.G4.rKf)fb.removeProperty(Tb);ib.Ei(Mb)}}if(O.a.instance.J(6)&&Ra.ParagraphReader.nc(fb)){for(Mb=0;Mb<fb.wordRunProperties.length;Mb++)fb.wordRunProperties.Hq.Z(Mb,pa.CharacterPropertiesEditor.CQ),fb.wordRunProperties.gt.Z(Mb,pa.CharacterPropertiesEditor.aU);B.ULS.shipAssertTag(6305564,307,O.a.instance.J(4));B.ULS.shipAssertTag(6305565,307,!!va.App.ud);(this.Hd.ng||O.a.instance.J(3)&&va.App.Cv.Jgc)&&fb.setValue(u.a.lDb,
!0);fb.Qg(u.a.dzb,u.a.cDi,u.a.jKf);O.a.instance.J(3)&&Ra.ParagraphReader.nc(fb)&&fb.Qg(u.a.IMa)}this.mBi&&(this.AEh(ob),Na.TableReader.isTable(ob)&&(fb=this.Qs.BN(),fb.moveNext(),(fb=da.TableCellReader.RAa(ib,fb.current.node))||(fb=new ca.a(0,0)),ib=new ka(fb,ob,Na.TableReader.tea(ib),Na.TableReader.nhf(ib)),this.nJe.value.Uwn(ib)));Y.OutlineElementReader.Nh(ob)&&!ob.aq(2)&&(this.Kh.zN(ob),ob.mc());ob.mc();Fa.Vi&&(Fa.Vi.Iud=Fa.insertAfter);Ga.ti(Object(G.a)(this,this.pCc,"coreCopyIncrement"));return!0}pCc(Ga,
Fa){Fa.nde&&(Fa.insertAfter=Fa.Iud,Fa.nde=!1);if(!Fa.source.Du()){Fa.Vi&&(Fa.Vi.Iud=Fa.insertAfter);const ib=Fa.source;11!==ib.Qe||ib.RIc(-1)||this.j$m(Ga,ib.currentNode,Fa.target.currentNode,Fa);return!1}Ga.ti(Object(G.a)(this,this.msh,"coreCopyIteration"));return!0}iuk(Ga){const Fa=Ga.source;if(Y.OutlineElementReader.Nh(Fa)&&Fa.Aeb(12)){const ib=Fa.Xd();if(Ra.ParagraphReader.nc(ib)&&ib.ia(u.a.zM,null))return Fa.mc(),Ga.dKb=!1;Fa.mc()}else if(Ra.ParagraphReader.nc(Fa.Cn)&&Fa.Cn.ia(u.a.zM,null))return!1;
return!0}F9m(Ga,Fa,ib){Fa=la.e(Fa);ib=la.e(ib);for(let ob=0;ob<Fa.length;ob++)Fa[ob].DFf(ib[ob],Ga,Object(G.a)(this,this.qCc,"coreCopySetup"))}ibo(Ga,Fa){if(Fa.Kza>=Fa.oPa.length)return ma.sa.raiseEvent("AfterTrimCompleteOnCopy",new eb(Fa.xo)),Ga.ti(Object(G.a)(this,this.GGk,"copyTeardown")),!0;Ga=Fa.oPa[Fa.Kza];var ib=Ga.node,ob=Ga.cpBegin;let fb=Ga.cpEnd;if(!xa.SelectionEditor.du(Ga))if(!Fa.Kza&&xa.SelectionEditor.uk(Ga))fb=ob=Ra.ParagraphReader.textLength(ib);else if(Ra.ParagraphReader.gm(Ga))ob=
0,fb=Ra.ParagraphReader.textLength(ib);else if(xa.SelectionEditor.I$(Ga)){B.ULS.shipAssertTag(6305568,307,!Fa.Kza);var Mb=I.GraphIterator.$a(ib);ob=Mb.Bb(12);B.ULS.shipAssertTag(6305569,307,ob);ib=Mb.origin;fb=ob=Ra.ParagraphReader.textLength(ib)}else{if(X.OutlineReader.CPd(Ga))for(Ga=L.a.Wp(Ga.node);Ga.moveNext();)Mb=Ga.currentNode,Ra.ParagraphReader.nc(Mb)&&Fa.oPa.push(Ha.a.createTextRange(Mb,0,Ra.ParagraphReader.textLength(Mb)));Fa.Kza++;return!0}Mb=Fa.pKf[ib.id.toString()];B.ULS.shipAssertTag(6305570,
307,!!Mb);if(!Mb)return B.ULS.sendTraceTag(21041548,307,15,"TrimNewTextParagraphCloneNull: {0}",{["ContextIndex"]:Fa.Kza,["SelectedContextsLength"]:Fa.oPa.length,["SelectedNodeType"]:ib.type,["ContextId"]:Ga.contextId}),Fa.Kza++,!0;ib=la.e(Mb);let Tb,rc=!1;for(Tb=ib.length-1;0<=Tb;Tb--)if(!ib[Tb].qza)if(4===ib[Tb].si)ib[Tb].Ob.blob=null,ib[Tb].Ob.blob=new wa.a(ib[Tb].Ob),Fa.wha.YBa.e++;else{ib[Tb].Ob.blob=null;if(O.a.instance.J(6)&&-1!==ib[Tb].Ee){var vb=ib[Tb].Ob.formatting,Ya=void 0,wb=void 0;vb&&
-1===vb.Ee?(wb=ib[Tb].Ee+1,Ya=ib[Tb].T2-1,vb.Ee=ib[Tb].Ee):(Ya=ib[Tb].T2,wb=ib[Tb].Ee);for(vb=0;vb<Ya;vb++)Mb.wordRunProperties.removeAt(wb,16);0<Ya&&(rc=!0)}Ya="";ha.f(ib[Tb])?(Ya=" ",Fa.wha.YBa.f++):ha.g(ib[Tb])&&(wb=ha.b(ib[Tb]))&&(Ya=ha.a(wb),Fa.wha.YBa.g++);wb=ib[Tb].Ob.cp;wb>=ob&&wb<fb&&(ma.characterPropertiesEditor.replaceTextRange(Ha.a.createTextRange(Mb,wb,wb+1),Ya,void 0,void 0,void 0,void 0,!0),fb=fb-1+Ya.length,Fa.wha.YBa.i++)}rc&&Mb.wn();this.vqn(Mb);ma.sa.raiseEvent("BeforeTrimOnCopy",
new Rb(Mb,ob,fb,Fa.xo));ib=Ra.ParagraphReader.textLength(Mb);fb<ib&&ma.characterPropertiesEditor.replaceTextRange(Ha.a.createTextRange(Mb,fb,ib),"",void 0,void 0,void 0,void 0,!0);0<ob&&ma.characterPropertiesEditor.replaceTextRange(Ha.a.createTextRange(Mb,0,ob),"",void 0,void 0,void 0,void 0,!0);this.QRl(Mb,Fa.wha.YBa);Ra.ParagraphReader.textLength(Mb)||Fa.Kza!==Fa.oPa.length-1||!xa.SelectionEditor.du(Ga)||Ka.a.jCa&&Mb.vw||(Ga=I.GraphIterator.$a(Mb),Ga.Bb(25)&&(U.OutlineElementNavigator.Zd(Ga),this.Kh.iXa(Ga),
Fa.Kza&&(this.Qs.kb.ysa=!0)));this.Qb.isFeatureEnabled(91)&&Fa.Kza==Fa.oPa.length-1&&!this.ysa&&Mb.Qg(t.a.a7,t.a.cga,t.a.gna,t.a.Tua,t.a.fna);this.Coa.fXc(Fa.wha.f_d,Fa.wha.Bwb,Fa.wha.pab,Mb);Fa.Kza++;return!0}vqn(Ga){const Fa=Ga.qa;if(O.a.instance.J(6)&&Fa){var ib=new F.a,ob=new F.a;for(let fb=0;fb<Fa.length;fb++){const Mb=Fa.J(fb);Mb.pj&&ib.add(Mb);if(!Ka.a.jCa&&Mb.Mb){for(let Tb=0;Tb<Mb.Mb.length;Tb++)ob.add(Mb.Mb.J(Tb).Ee);Mb.Mb=null}}Ga.sga(!0,ob);for(const fb of ib)fb.pj=null}}GGk(Ga,Fa){this.iha.yMb(null);
Fa.Sx.dispose();k.a.mark(5567);this.YLm();this.PV=Fa.wha;this.lmi("Copy");this.L$l&&B.ULS.sendTraceTag(6305600,307,50,"Empty ClipboardRoot");return!1}get L$l(){return!I.GraphIterator.$a(this.iha).Xd()}Gjj(){this.Qnd=this.mMe}Fjj(){this.Qnd=this.hpd}Sno(){this.Qnd=this.$ne}get Fmm(){return this.iha===this.hpd}get Ubm(){return this.iha===this.$ne}Wmh(){const Ga=I.GraphIterator.$a(this.iha);for(;Ga.Xd();)Ga.Eg()}lmi(Ga){const Fa=this.PV.YBa.b;Ga+="-"+Fa;this.PV.YBa.b=Ga;this.PV.pBb.b=Ga;this.PV.f_d.b=
Ga;this.PV.Bwb.b=Ga;this.PV.pab.b=Ga;this.Coa.kym(this.PV.YBa);this.Coa.Dxf(this.PV.pBb);this.Coa.jni(this.PV.f_d);this.Coa.rxf(this.PV.Bwb);this.Coa.pxf(this.PV.pab);this.PV.YBa.b=Fa;this.PV.pBb.b=Fa;this.PV.f_d.b=Fa;this.PV.Bwb.b=Fa;this.PV.pab.b=Fa}QDi(Ga,Fa,ib,ob,fb=null,Mb=null){this.lmi("Paste");Fa=I.GraphIterator.$a(Fa);const Tb=I.GraphIterator.$a(this.iha);var rc=null;fb&&(rc=new H.a(X.OutlineReader.vxh,X.OutlineReader.GRk),rc=fb.equals(new H.a(-1,-1))?new H.a(0,0):fb.t$d(rc));if(this.S9h())if(Tb.Xd(),
P.ImageReader.ww(Tb.currentNode))fb=Tb.currentNode,Tb.mc(),Tb.cH(this.Kh.vxb(),null,1),Tb.Xd(),Tb.cH(fb,null,2),Tb.mc(),Tb.Ei(fb),Tb.Eg(),this.Y0i();else if(E.isFloatingEmbeddedFileNode(Tb.currentNode)){fb=Tb.currentNode;Tb.mc();Tb.cH(this.Kh.vxb(),null,1);Tb.Xd();var vb=this.Kh.zN(Tb);vb=Ha.a.Uc(vb,0);ma.characterPropertiesEditor.replaceTextRange(vb,"<<"+E.getEmbeddedFileName(fb)+">>",void 0,void 0,void 0,void 0,!0);Tb.mc();Tb.mc();Tb.Ei(fb);Tb.Eg();this.Y0i()}this.nY&&this.nY.Dsf(ib)||!this.Shm||
!this.nii(Tb,Fa)?(k.a.mark(5564),Tb.currentNode.yMb(null),Ga={},Ga[ma.tmf]=ob,S.ListReader.w2(ib)&&(Ga[T.a.Y9h]=!0),ib=new Hb.a(Tb,Fa,ib,rc,Ga),ob=new a.a(Mb,Object(G.a)(this,this.sCc,"corePasteSetup"),ib),ob.ml("ExecuteCorePasteFromInternalClipboard"),ob.eh=!Mb||Mb.eh,this.t9m(ib),ob.run()):(Tb.currentNode.yMb(null),B.ULS.sendTraceTag(7869376,307,50,"Begin internal paste table in table"),this.zun(Mb,Tb,Fa,rc,Ga),B.ULS.sendTraceTag(39699553,307,50,"The call to ReplaceTableCellsFromClipboardTable ended."))}Ohi(Ga){if(Ga&&
Ga.Rd){const Fa=I.GraphIterator.$a(this.iha);return this.nii(Fa,Ga)}return!1}nii(Ga,Fa){if(da.TableCellReader.NMa(Fa)&&1===Ga.Jp()){Ga.Rb(1);if(Y.OutlineElementReader.Nh(Ga)){U.OutlineElementNavigator.De(Ga);if(Na.TableReader.isTable(Ga)){Na.TableReader.HA(Ga.currentNode)&&B.ULS.sendTraceTag(17835601,307,50,"Source table is a complex table.");if(Fa.Bb(14)&&!Na.TableReader.HA(ra.getContainingTable(Fa))){if(B.ULS.sendTraceTag(19269659,307,50,"Target table is not a complex table."),!this.F6)return!0}else if(B.ULS.sendTraceTag(19269660,
307,50,"Target table is a complex table."),this.sNc&&!this.F6)return!0;if(this.F6)return!0}U.OutlineElementNavigator.Zd(Ga)}Ga.mc()}return!1}zun(Ga,Fa,ib,ob,fb){let Mb,Tb;let rc;Object(v.a)("ReplaceTableCellsFromClipboardTable",!0);ib.Bb(14);Mb=qa.a.At(ib);Tb=ua.a(ib);ib.kd(14);var vb=Na.TableReader.ag(ib.currentNode);rc=Na.TableReader.kh(ib.currentNode);const Ya=Na.TableReader.ag(Fa.currentNode),wb=Na.TableReader.kh(Fa.currentNode);B.ULS.sendTraceTag(8716373,307,50,"Target and source table row column counts: target: {0},{1}; source: {2},{3};  and target insert index: {5},{6}",
vb,rc,Ya,wb,Mb,Tb);if(this.F6&&Ma.TableBorderSelectionCache.eKc())this.rPn(),vb=Math.min(this.pae+1,vb),rc=Math.min(this.q4f+1,rc),this.q4f-this.D6n==rc-1&&(this.F$i==this.pae?Tb=0:this.pae-this.F$i==vb-1&&(ib.Xd(),Mb=qa.a.At(ib),Tb=ua.a(ib)));else{this.uxa=ab.a.e3b;var jb=Mb+Ya-vb;0<jb&&(ra.moveToLastRow(ib),B.ULS.sendTraceTag(8716374,307,50,"Begin insert rows: "+jb),this.nJe.value.insertRows(ib,!1,jb,this.uxa),B.ULS.sendTraceTag(8716375,307,50,"Completed inserting rows."),ib.kd(14));jb=Tb+wb-rc;
if(0<jb){B.ULS.sendTraceTag(8716376,307,50,"Begin insert columns: "+jb);try{this.nJe.value.insertColumns(ib,rc,!1,jb,this.uxa)}catch(Zb){throw B.ULS.sendTraceTag(19269661,307,10,"Insert columns failed: {0}",Zb.toString()),Zb;}B.ULS.sendTraceTag(8716377,307,50,"Completed inserting columns.")}}vb=this.Ykl(vb,rc,Ya,wb,Mb,Tb);B.ULS.sendTraceTag(8716378,307,50,"Begin paste cell contents");Ga=new a.a(Ga,Object(G.a)(this,this.v3m,"pasteTableOperationRun"),new Ta(null,Fa,ib,ob,Mb,Tb,vb,null,fb));Ga.ml("ExecuteCorePasteTableInTable");
Ga.eh=!1;Ga.run()}v3m(Ga,Fa){if(Fa.Qfc){if(Fa.Qfc.inProgress)return!0;da.TableCellReader.isTableCell(Fa.source)||Fa.source.kd(16);if(this.OJm(Fa))return!1}else Na.TableReader.isTable(Fa.target)||Fa.target.kd(14),Na.TableReader.isTable(Fa.source)||Fa.source.kd(14),ra.moveToCell(Fa.target,Fa.rowIndex,Fa.ao),ra.moveToCell(Fa.source,0,0);if(da.TableCellReader.qg(Fa.source)||da.TableCellReader.qg(Fa.target))return!0;this.l3m(Fa,Ga);return!0}YLm(){if(this.sNc){for(var Ga=I.GraphIterator.$a(this.iha),Fa=
Ga.currentNode;14!==Ga.Qe;)if(Fa=Ga.Xd(),!Fa){B.ULS.sendTraceTag(39716809,307,50,"NormalizeCopiedTable: Couldn't find any Table graph node under this.TheClipboardRoot.");return}this.jui(Fa)}}bMm(Ga){this.sNc&&this.jui(Ga)}g9n(Ga){const Fa=I.GraphIterator.$a(Ga);this.BJ.qfb(Fa,null,!0);Ga.qg=!1;Ga.rowSpan=1;Ga.colSpan=1}jui(Ga){if(Ga&&14===Ga.type){B.ULS.sendTraceTag(39716810,307,50,"NormalizeTable: start to normalize.");var Fa={},ib=Na.TableReader.ag(Ga),ob=Na.TableReader.kh(Ga),fb=I.GraphIterator.$a(Ga);
ra.forEachCellInTable(fb,(Mb,Tb,rc)=>{const vb={};Mb=Mb.currentNode;if(16===Mb.type)if(Mb.qg)ma.Nph(Tb,rc)in Fa||(this.g9n(Mb),vb.IsGhostCell="->false");else{ma.yjn(Ga,Mb,Tb,rc,ib,(wb,jb,Zb)=>{vb.rowSpan=String.format("{0}:{1}->{2}",wb,jb,Zb)});ma.xjn(Ga,Mb,rc,Tb,ob,(wb,jb,Zb)=>{vb.colSpan=String.format("{0}:{1}->{2}",wb,jb,Zb)});const Ya=String.format("{0},{1}-{2},{3}",Tb,rc,Tb+Mb.rowSpan,rc+Mb.colSpan);for(let wb=0;wb<Mb.rowSpan;wb++)for(let jb=0;jb<Mb.colSpan;jb++)if(wb||jb)Fa[ma.Nph(Tb+wb,rc+
jb)]=Ya}if(0<K.a(vb).length){if(void 0===vb.IsGhostCell||null===vb.IsGhostCell){if(void 0===vb.rowSpan||null===vb.rowSpan)vb.rowSpan=Mb.rowSpan;if(void 0===vb.colSpan||null===vb.colSpan)vb.colSpan=Mb.colSpan}B.ULS.sendTraceTag(39175904,307,50,"NormalizeTable: [{0},{1}]: {2}.",Tb,rc,vb)}return!0});ma.z_k(Fa)}}QRl(Ga,Fa){if(Ga&&Ra.ParagraphReader.nc(Ga)){var ib=0,ob=I.GraphIterator.$a(Ga);for(ob.Rb(6);!ob.qr;){var fb=ob.currentNode;ob.Wi(6);P.ImageReader.ww(fb)?P.ImageReader.gtf(fb)?I.GraphIterator.$a(fb).Aeb(59)?
B.ULS.sendTraceTag(590455048,307,50,"HandleAnchoredObjectsForInternalCopy: Not converting anchored image to inline."):(this.paragraphEditor.KZe(fb,Ha.a.Uc(Ga,ib),!0),Fa.d++,ib++):(fb=I.GraphIterator.$a(fb),fb.Bb(12),fb.Eg(),Fa.h++):B.ULS.shipAssertTag(6305571,307,!1)}}}get sNc(){return!!this.Oa&&this.Oa.$("ComplexTableCellPasteWithFormattingIsEnabled")}Ykl(Ga,Fa,ib,ob,fb,Mb){const Tb=[];let rc,vb,Ya,wb;this.F6&&Ma.TableBorderSelectionCache.eKc()?(rc=Math.min(Ga,fb+ib),vb=Math.min(Fa,Mb+ob),wb=fb):
(wb=0,rc=Math.max(fb+ib,Ga));for(;wb<rc;wb++)for(this.F6&&Ma.TableBorderSelectionCache.eKc()?Ya=Mb:(Ya=0,vb=Mb+ob,wb<fb?Ya=Fa:wb>=fb&&wb<Math.min(fb+ib,Ga)?Ya=Mb:wb>=fb+ib&&wb<Ga?Ya=Fa:vb=Math.max(Mb+ob,Fa));Ya<vb;Ya++)Tb.push(Array(2)),Tb[Tb.length-1][0]=wb,Tb[Tb.length-1][1]=Ya;return Tb}sCc(Ga,Fa){if(!Fa.source.Xd())return Ga.ti(Object(G.a)(this,this.Sib,"pasteTeardown")),!0;Ga.ti(Object(G.a)(this,this.osh,"corePasteIteration"));return!0}Kun(Ga,Fa){if(this.sNc)if(!Fa||!Ga)B.ULS.sendTraceTag(39175905,
307,50,"ReplicateTableCellProperties: {0}",{["source"]:Ga,["table"]:Fa});else if(16===Fa.currentNode.type&&16===Ga.parentNode.type){Fa=Fa.currentNode;Ga=Ga.parentNode;var ib={};Fa.qg!==Ga.qg&&(Fa.qg=Ga.qg,ib.IsGhostCell=Fa.qg);Fa.F2!==Ga.F2&&(Fa.F2=Ga.F2,ib.IsSkippedCell=Fa.F2);Fa.Mkb!==Ga.Mkb&&(Fa.Mkb=Ga.Mkb,ib.ShouldRenderCell=Fa.Mkb);Fa.colSpan!==Ga.colSpan&&(ib.ColSpan=String.format("{0}<={1}.",Fa.colSpan,Ga.colSpan),Fa.colSpan=Ga.colSpan);Fa.rowSpan!==Ga.rowSpan&&(ib.RowSpan=String.format("{0}<={1}.",
Fa.rowSpan,Ga.rowSpan),Fa.rowSpan=Ga.rowSpan);K.a(ib)}}osh(Ga,Fa){const ib=Fa.source,ob=Fa.target,fb=ib.currentNode;if(!fb.lfa||!fb.BJa||this.lVn(ib,ob))return Ga.ti(Object(G.a)(this,this.rCc,"corePasteIncrement")),!0;if(O.a.instance.J(3)&&Y.OutlineElementReader.Nh(ib)){if(!U.OutlineElementNavigator.De(ib).BJa)return U.OutlineElementNavigator.Zd(ib),Ga.ti(Object(G.a)(this,this.rCc,"corePasteIncrement")),!0;U.OutlineElementNavigator.Zd(ib)}B.ULS.shipAssertTag(6305608,307,!fb.g1b());var Mb=ob.currentNode.Di().zd;
Mb=J.a(fb,Mb,!0);Mb.QNa();Mb.KPd=!0;this.Kun(ib,ob);ob.cH(Mb,Fa.insertAfter,ib.role);ob.Ei(Mb);Fa.insertAfter=Mb;O.a.instance.J(4)&&va.App.ud.Mp&&va.App.ud.Lq.CG(Mb);this.BEh(fb,Mb);Fa=new a.a(Ga,Object(G.a)(this,this.sCc,"corePasteSetup"),new Hb.a(ib,ob,null,Fa.EJf,Fa.xo));Fa.ml("RecursiveCorePasteOperation");Fa.run();Ga.ti(Object(G.a)(this,this.LGk,"corePasteIterationPostProcessing"));return!0}lVn(Ga,Fa){let ib=!1;Y.OutlineElementReader.Nh(Ga)&&(ib=Y.OutlineElementReader.yP(Ga)&&this.Llm(Fa));return ib}Llm(Ga){if(Ga)return Ga=
Ga.Qe,36===Ga||38===Ga||16===Ga;throw Error.argument("IsTargetNodeInValidForIFrameContent: target iterator is null for paste.");}s$m(Ga,Fa,ib){Fa=la.e(Fa);const ob=la.e(ib);for(let fb=Fa.length-1;0<=fb;fb--){if(!Fa[fb].Cec(ib)){const Mb=Ha.a.createTextRange(ib,Fa[fb].Ob.cp,Fa[fb].Ob.cp+1);ma.characterPropertiesEditor.replaceTextRange(Mb,"",void 0,void 0,void 0,void 0,!0)}Fa[fb].mTc(ob[fb],Ga,Object(G.a)(this,this.sCc,"corePasteSetup"),this.Ubm)}}LGk(Ga,Fa){const ib=Fa.target,ob=ib.currentNode,fb=
Fa.source,Mb=fb.currentNode;let Tb=-1;Fa.xo[ma.tmf]&&(Tb=Fa.xo[ma.tmf]);Ra.ParagraphReader.nc(ob)&&(this.x$m(Ga,Object(G.a)(this,this.sCc,"corePasteSetup"),Mb,ob,Fa),this.s$m(Ga,Mb,ob));ob.YZ();Fa.xo[T.a.Y9h]?22===ob.type&&(da.TableCellReader.MZ(fb)||ob.setValue(u.a.listID,Number.MAX_VALUE)):this.uG.$Pi(ob);if(Ra.ParagraphReader.nc(ob)&&(Fa=la.i(ob,5),0<Fa.length)){for(const rc of Fa)!rc.properties.hasProperty(u.a.ZGb)&&rc.properties.hasProperty(u.a.G_d)&&(Fa=rc.properties.getValue(u.a.G_d),rc.properties.setValue(u.a.ZGb,
Fa)),P.ImageReader.U5b()?P.ImageReader.XDb(rc.properties)&&this.ij.XVf(rc.properties,Tb):P.ImageReader.Wx(rc.properties)||this.ij.XVf(rc.properties,Tb);ob.Di().contentReplicator.forceOutbound(null,null,null)}this.AEh(ib);this.umo(Mb,ob);Na.TableReader.fX(ob)&&B.ULS.sendTraceTag(524919814,3022,50,"TablePasted");this.F6&&da.TableCellReader.NMa(ib)&&bb.a.MUi(ob);ib.mc();Ga.ti(Object(G.a)(this,this.rCc,"corePasteIncrement"));return!0}umo(Ga,Fa){if(O.a.instance.J(3)&&Na.TableReader.fX(Ga)){let ib=0;const ob=
Na.TableReader.ag(Ga);for(const fb of Na.TableReader.Tw(Ga,0,ob-1))fb.lx&&ib++;Ga=this.Hc.Rc(4);Ga.Db(Fa);Fa.properties.setValue(y.a.Sva,ob-ib);Ga.dispose()}}rCc(Ga,Fa){if(!Fa.source.Du())return Ga.ti(Object(G.a)(this,this.Sib,"pasteTeardown")),!0;Ga.ti(Object(G.a)(this,this.osh,"corePasteIteration"));return!0}Sib(){k.a.mark(5565);return!1}get F6(){null==this.z8&&(e.AFrameworkApplication.Hf("he991617;3eed2178"),this.z8=e.AFrameworkApplication.K?e.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.TableCCPNewExperienceIsEnabled",
!1):!1);return this.z8}ZVd(){return!I.GraphIterator.$a(this.iha).Xd()}S9h(){return this.jZe?1===I.GraphIterator.$a(this.iha).Jp():!1}ROh(Ga){try{return this.Jnl(Ga)}catch(Fa){return B.ULS.sendTraceTag(23643968,307,10,"GetCopySourceFromDOMTree failed with exception:{0}",Fa.message),0}}Jnl(Ga){let Fa=0;if(Ga&&(Fa=this.Inl(Ga),!Fa&&Ga.childNodes))for(let ib=0;ib<Ga.childNodes.length&&!(Fa=this.ROh(Ga.childNodes[ib]));ib++);return Fa}Inl(Ga){if(1===Ga.nodeType&&Ga.getAttribute){Ga=(Ga.getAttribute("class")||
"").split(" ");for(const Fa of Ga)if(Fa.startsWith(this.WTj))return Fa.startsWith(this.vvc)?this.Mu&&Fa===this.vvc+this.Mu?3:2:1}return 0}G9m(Ga,Fa,ib,ob,fb){fb.xo||(fb.xo={});ma.sa.raiseEvent("OnParagraphCopy",new Aa(Ga,Fa,ib,ob,fb.xo))}j$m(Ga,Fa,ib,ob){ob.xo||(ob.xo={});ma.sa.raiseEvent("OnCopyComplete",new Aa(Ga,null,Fa,ib,ob.xo))}t9m(Ga){Ga.xo||(Ga.xo={});ma.sa.raiseEvent("BeforePaste",new mb(Ga.xo))}s9m(Ga){Ga.xo||(Ga.xo={});ma.sa.raiseEvent("BeforeCopy",new Ab(this.Qs,Ga.xo))}x$m(Ga,Fa,ib,ob,
fb){ma.sa.raiseEvent("OnParagraphPaste",new Aa(Ga,Fa,ib,ob,fb.xo))}AEh(Ga){da.TableCellReader.isTableCell(Ga)&&(Ga.Rb(1)||this.BJ.r5(Ga,!0),Ga.mc())}BEh(Ga,Fa){this.c1.Zta(Fa)&&(Fa.width=Ga.width)}static jrd(Ga){ma.sa.addHandler("OnParagraphCopy",Ga)}static pyc(Ga){ma.sa.addHandler("OnParagraphPaste",Ga)}static Rrn(Ga){ma.sa.removeHandler("OnParagraphPaste",Ga)}static t7j(Ga){ma.sa.addHandler("OnCopyComplete",Ga)}static B6j(Ga){ma.sa.addHandler("BeforePaste",Ga)}static orn(Ga){ma.sa.removeHandler("BeforePaste",
Ga)}static z6j(Ga){ma.sa.addHandler("BeforeCopy",Ga)}static C6j(Ga){ma.sa.addHandler("BeforeTrimOnCopy",Ga)}static v6j(Ga){ma.sa.addHandler("AfterTrimCompleteOnCopy",Ga)}static get characterPropertiesEditor(){return null!=ma.hhg?ma.hhg:ma.hhg=l.a.instance.resolve("Box4.ICharacterPropertiesEditor")}static get fG(){return Ca.a.instance}static get Te(){return Xa.PageReader.instance}static z_k(Ga){const Fa={};for(const ib of K.a(Ga)){const ob=Ga[ib];Fa[ob]=ob in Fa?String.format("{0}|{1}",Fa[ob],ib):
ib}1<=K.a(Fa).length&&B.ULS.sendTraceTag(39204995,307,50,"NormalizeTable: ghostCells - {0}",Fa)}static xjn(Ga,Fa,ib,ob,fb,Mb){Fa.colSpan>fb-ib&&(Mb&&Mb("A",Fa.colSpan,fb-ib),Fa.colSpan=fb-ib);Ga=ma.mZn(Ga,Fa,ob,ib);Fa.colSpan!==Ga&&(Mb&&Mb("B",Fa.colSpan,Ga),Fa.colSpan=Ga)}static yjn(Ga,Fa,ib,ob,fb,Mb){Fa.rowSpan>fb-ib&&(Mb&&Mb("A",Fa.rowSpan,fb-ib),Fa.rowSpan=fb-ib);Ga=ma.nZn(Ga,Fa,ib,ob);Fa.rowSpan!==Ga&&(Mb&&Mb("B",Fa.rowSpan,Ga),Fa.rowSpan=Ga)}static mZn(Ga,Fa,ib,ob){return ma.I5i(Ga,Fa.colSpan,
(fb,Mb)=>{ra.moveToCell(fb,ib,ob+Mb)})}static nZn(Ga,Fa,ib,ob){return ma.I5i(Ga,Fa.rowSpan,(fb,Mb)=>{ra.moveToCell(fb,ib+Mb,ob)})}static I5i(Ga,Fa,ib){if(14!==Ga.type)throw Error.argument("tableNode is not a Table.");if(!ib)throw Error.argumentNull("MoveToCellAction");for(let fb=1;fb<Fa;fb++){var ob=I.GraphIterator.$a(Ga);ib(ob,fb);ob=ob.currentNode;if(!ob||16!==ob.type||!ob.qg)return fb}return Fa}static Nph(Ga,Fa){return Ga+","+Fa}l3m(Ga,Fa){for(;Ga.target.Xd();)Ga.target.Eg();Ga.Qfc=new a.a(Fa,
Ga.UDi?Ga.UDi:Object(G.a)(this,this.sCc,"corePasteSetup"),new Hb.a(Ga.source,Ga.target,null,Ga.EJf));Ga.Qfc.ml("ExecuteCorePasteCellContentInCell");Ga.Qfc.eh=!1;Ga.Qfc.run()}OJm(Ga){let Fa=!1;if(this.F6&&Ma.TableBorderSelectionCache.eKc()){const ib=ua.a(Ga.target),ob=qa.a.At(Ga.target),fb=Math.min(this.pae,Ga.wAc[Ga.wAc.length-1][0]),Mb=Math.min(this.q4f,Ga.wAc[Ga.wAc.length-1][1]);da.TableCellReader.zMa(Ga.target)||da.TableCellReader.zMa(Ga.source)||ob==fb&&ib==Mb?Fa=!0:(da.TableCellReader.isTableCell(Ga.target)||
Ga.target.kd(16),da.TableCellReader.U$(Ga.source)?(da.TableCellReader.zMa(Ga.target)||(ra.moveToNextRow(Ga.target),ra.moveToColumnByIndex(Ga.target,Ga.ao),B.ULS.sendTraceTag(8716379,307,50,"Move to next row to replace cell contents")),ra.moveToNextOrPreviousCell(Ga.source,!1,!1)):da.TableCellReader.U$(Ga.target)||ib==Mb?(ra.moveToNextRow(Ga.source),ra.moveToColumnByIndex(Ga.source,0),B.ULS.sendTraceTag(537519906,307,50,"Move to next row to replace cell contents"),ra.moveToNextRow(Ga.target),ra.moveToColumnByIndex(Ga.target,
Ga.ao),B.ULS.sendTraceTag(537519907,307,50,"Move to next row to replace cell contents")):(ra.moveToNextOrPreviousCell(Ga.target,!1,!1),ra.moveToNextOrPreviousCell(Ga.source,!1,!1)))}else da.TableCellReader.zMa(Ga.source)?Fa=!0:(da.TableCellReader.isTableCell(Ga.target)||Ga.target.kd(16),da.TableCellReader.U$(Ga.source)?(ra.moveToNextRow(Ga.target),ra.moveToColumnByIndex(Ga.target,Ga.ao),B.ULS.sendTraceTag(537716887,307,50,"Move to next row to replace cell contents")):ra.moveToNextOrPreviousCell(Ga.target,
!1,!1),ra.moveToNextOrPreviousCell(Ga.source,!1,!1));Fa&&(this.nY&&this.nY.u$m(Ga.target,Ga.wAc),Na.TableReader.isTable(Ga.target)||Ga.target.kd(14),this.bMm(Ga.target.currentNode),B.ULS.sendTraceTag(7869377,307,50,"End of internal paste table in table"));return Fa}rPn(){this.pae=Ma.TableBorderSelectionCache.n7.bottomMostRowSelected;this.q4f=Ma.TableBorderSelectionCache.n7.rightMostColumnSelected;this.D6n=Ma.TableBorderSelectionCache.n7.leftMostColumnSelected;this.F$i=Ma.TableBorderSelectionCache.n7.topMostRowSelected}}
ma.sa=new n.a;ma.tmf="PasteConstrainingWidth";Object(C.a)(ma,"InternalClipboard",null,[])},1852:function(C,N,d){C=d(0);var l=d(2),e=d(104),a=d(59),k=d(205),n=d(22),v=d(16),u=d(83),t=d(125),y=d(17),B=d(45),G=d(5),F=d(8),K=d(72),O=d(57),H=d(36),I=d(321),J=d(20),L=d(14),S=d(6),E=d(64),P=d(108),T=d(21),U=d(40),X=d(260),Y=d(43),ca=d(261),da=d(23),ua=d(89),ra=d(173),qa=d(861),ka=d(476),la=d(3),Ha=d(97),wa=d(65),Ca=d(9),Ja=d(105),bb=d(49),ha=d(507),ia=d(596),va=d(228),Ka=d(19),Xa=d(25),xa=d(53),Ma=d(38),
Na=d(247),pa=d(11),Ra=d(1528),Sa=d(1544),ab=d(239),eb=d(169),zb=d(56),Ua=d(530);class Ab extends ab.a{constructor(ma,Ga,Fa,ib,ob,fb,Mb,Tb){super();this.c_g=this.mB=null;this.init(ma);this.ml("FormattingViewOperation");this.lfb(l.AFrameworkApplication.ya,Ga,ib,ob,fb);this._context=Fa;this.$4a=0;this.Pl=!0;this.HDj=Mb;this.Hm=Tb}get a$(){return this.Hm.instance}run(){const ma=this._context.view;var Ga=null;ma.ze&&(Ga=ma.Cb);if(Ga){var Fa=Ga.hb.kb,ib=!Sa.a.Z5b(this.actionId);!Fa||Ab.Zf.utf(Fa,ib)?(Ab.Mc.Zb(Ha.a.zf,
{["Reason"]:wa.a.dE}),this.Pl=!1):this.a$&&this.a$.u6b(Fa)?(Ab.Mc.Zb(Ha.a.zf,{["Reason"]:wa.a.externalSelection}),this.Pl=!1):Ab.Tg.swa(pa.ParagraphReader.UW,Ga.Rg)&&(Ab.Mc.Zb(Ha.a.zf,{["Reason"]:wa.a.uN}),this.Pl=!1)}else Ab.Mc.Zb(Ha.a.zf,{["Reason"]:wa.a.Ifa}),this.Pl=!1;1!==this.behavior&&this.Pl||(this.Pl&&(Fa=Ga.hb.kb,1===Ga.hb.length&&1===Fa.length&&Ka.SelectionEditor.Ek(Fa.Qa)&&ua.b(Fa.Qa)&&(Ab.Mc.Zb(Ha.a.zf,{["Reason"]:wa.a.VBc}),this.Pl=!1)),(Fa=this.Pl)&&this.actionId===la.a.s7&&((Fa=Array.from(Ga.hb.kb).some(P.FormattingReader.Jqh))||
Ab.Mc.Zb(Ha.a.zf,{["Reason"]:wa.a.q5e})),this.ar=Fa?32:8,this.$4a=3);this.$4a||(eb.a.mark(5730),this.c_g=Ua.SelectionReferenceFactory.instance.xxb(),Fa=Ga.hb.kb.Qa,this.mB=new bb.GraphTransaction(15),this.mB.Db(Fa.node),this.mB.Al=this.actionId,this.$4a=1);if(1===this.$4a){this.fF||this.c_c(this._context.vk);if(1===this.C1a())return;this.$4a=2}if(2===this.$4a){if(this.actionId===la.a.s7)if(Ga=Ga.Rg,Ga.Xw)for(Fa=0;Fa<Ga.length;Fa++)ib=Ga.getContext(Fa),this.qej(ib);else this.qej(Ga);this.c_g.Gna(this.actionId===
la.a.IX||this.actionId===la.a.Xja);(Ga=Object(K.a)(17,this.Cd))&&!Ga.T2a||zb.FocusManager.instance().Jg(ma.mI);this.mB.dispose();this.mB=null;Ca.App.xa.updateCommandUI();eb.a.mark(5731);this.$4a=3;this.ar=32}3===this.$4a&&(this.HDj.process(this.actionId,this._context,this.behavior,this.response),this.Una())}qej(ma){(Ka.SelectionEditor.du(ma)||Ka.SelectionEditor.uk(ma))&&Ca.App.zK.lba(ma.node)}static get Zf(){return Na.a.instance}static get Tg(){return va.ContextSetEditor.instance}static get Mc(){return t.a.instance}}
Object(C.a)(Ab,"FormattingViewOperation",ab.a,[]);var mb=d(998),Rb=d(760),hc=d(74),Hb=d(138);d.d(N,"a",function(){return Aa});const Ta=new Set([la.a.JL,la.a.rM,la.a.clearFormatting,la.a.FJa,la.a.GJa,la.a.$Va,la.a.sza,la.a.aWa]);class Aa{constructor(ma,Ga,Fa=null,ib){this.kpiName="ChangeCaseCommandUsage";this.Y5="wwaengidc";this.RT=new Map;this.HPg=new Set;this.Bzb=()=>new qa.a(2);this.eIi=(ob,fb,Mb,Tb,rc)=>{Tb=!0;fb.contextId!==L.a.view&&(Tb=!1);if(1===Mb&&!Tb)return 8;if(ob===la.a.cWc)ob=rc.formatting,
rc=rc.A1f;else{if(!fb.view||!fb.view.ze)return 2;fb=fb.view;if(!fb.Cb||!fb.Cb.hb.kb)return 8;ob=rc;rc=fb.Cb.hb}this.mCk(rc,ob);return 32};this.ZQe=(ob,fb,Mb,Tb,rc,vb)=>new Ab(ob,fb,Mb,Tb,rc,vb,this.rEj,Aa.uw());this.Yrd=(ob,fb,Mb,Tb,rc)=>{var vb,Ya,wb;let jb=!0,Zb=fb;const Eb=!Sa.a.Z5b(ob);fb.contextId!==L.a.Gd&&fb.contextId!==L.a.Wc?jb=!1:(Aa.Zf.T$(Zb,!1,Eb)&&(Aa.Mc.Zb(Ha.a.Sm,{["Reason"]:wa.a.dE}),jb=!1),Aa.uw()&&Aa.uw().instance&&Aa.uw().instance.HT(Zb)&&(jb=!1),jb&&Ka.SelectionEditor.Ek(fb)&&
ua.b(Zb)&&(Aa.Mc.Zb(Ha.a.Sm,{["Reason"]:wa.a.VBc}),jb=!1),pa.ParagraphReader.UW(fb)&&(Aa.Mc.Zb(Ha.a.zf,{["Reason"]:wa.a.uN}),jb=!1));if(1===Mb||!jb)return jb?32:8;if(fb.contextId===L.a.Wc)return 2;Hb.a.pZe&&(fb=null===(vb=this.Co)||void 0===vb?void 0:vb.JWh(Zb))&&(Zb=fb);this.CVn(ob)&&(vb=Ka.SelectionEditor.JLb(Zb),Ka.SelectionEditor.xf(vb)||(Zb=vb));vb="boolean"===typeof rc&&rc;fb=Aa.Qd.ng;(null===(Ya=this.gca)||void 0===Ya?0:Ya.annotateRange)&&(vb||!fb)&&(null===(wb=this.gca)||void 0===wb?0:wb.wDb(Zb.node))?
this.s1(Zb,ob,rc):Aa.I3a.s1(Zb,tc=>{this.Pdc(tc,ob,rc,Zb.cpEnd)},vb);Zb.node.Sr&&(Ya=[Object.assign(new H.a,{name:"Source",string:"CharacterFormatting"})],O.a("TOCFormatting",!0,void 0,Ya));this.y$l(ob)&&this.kud(Zb,ob);Tb&&Ra.a.Clb&&(Tb.Lr|=Ra.a.xdb(Zb.node));return 32};this.u2c=(ob,fb,Mb)=>1!==Mb&&2===Mb?(this.RT.set("Source","Shortcut"),ob=fb.node.characterData.substr(fb.cpBegin,fb.cpEnd-fb.cpBegin),Aa.Ntf(ob,0,ob.length)?this.kud(fb,la.a.FJa):Aa.$km(ob,ob.length)?this.kud(fb,la.a.sza):this.kud(fb,
la.a.GJa)):32;this.Pab=(ob,fb,Mb)=>{let Tb=!0;ob=!Sa.a.Z5b(ob);fb.contextId!==L.a.Gd&&fb.contextId!==L.a.Wc?Tb=!1:(Aa.Zf.T$(fb,!1,ob)&&(Aa.Mc.Zb(Ha.a.Sm,{["Reason"]:wa.a.dE}),Tb=!1),Tb&&Ka.SelectionEditor.Ek(fb)&&ua.b(fb)&&(Aa.Mc.Zb(Ha.a.Sm,{["Reason"]:wa.a.VBc}),Tb=!1),Tb&&pa.ParagraphReader.UW(fb)&&(Aa.Mc.Zb(Ha.a.zf,{["Reason"]:wa.a.uN}),Tb=!1));if(1===Mb||!Tb)return Tb?32:8;fb=fb.node;Aa.paragraphEditor.gZb(fb,!1);fb.Sr&&(fb=[Object.assign(new H.a,{name:"Source",string:"ClearFormatting"})],O.a("TOCFormatting",
!0,void 0,fb));return 32};this.UAc=(ob,fb,Mb,Tb,rc)=>{ob={};ob[mb.a.zFa]=6168;ob[mb.a.yFa]=6169;const vb=fb.view;var Ya=null;vb.wi&&(Ya=vb);var wb=!0;let jb=32;Ya&&(Ya=Ya.Cb.hb.kb)&&(Aa.Zf.utf(Ya)?(Aa.Mc.Zb(Ha.a.zf,{["Reason"]:wa.a.dE}),jb=8,wb=!1):1===Mb&&(jb=32,wb=!1));wb&&(wb=new bb.GraphTransaction(1===Mb?3:15),wb.Db(vb.root),jb=mb.a.kna(la.a.Pab,fb,Mb,Tb,rc,ob,12),wb.dispose());return jb};this.gRe=(ob,fb,Mb,Tb,rc)=>{var vb,Ya=!0,wb=32;const jb=!Sa.a.Z5b(ob);fb.contextId!==L.a.Wc?Ya=!1:Aa.Zf.T$(fb,
!1,jb)&&(Aa.Mc.Zb(Ha.a.Sm,{["Reason"]:wa.a.dE}),Ya=!1);if(1===Mb||!Ya)return Ya?32:8;Mb=fb.node;J.a.instance.J(8)&&ob===la.a.clearFormatting&&(Aa.Ko.VAc(Mb),Aa.paragraphEditor.pnh(Mb),Ya=Aa.SKb.Qx(Mb).xh(Aa.SKb.wordStyleIdNormal),Aa.H7.oM(Ya,Mb,!0));Mb=Aa.Tj.Chf(fb);Hb.a.pZe&&!Mb&&(Ya=null===(vb=this.Co)||void 0===vb?void 0:vb.JWh(fb))&&(fb=Ya,Mb=Xa.SelectionFactory.eo(fb));if(Mb)wb=xa.a.sxb(Mb),wb=l.AFrameworkApplication.ya.Qf(wb,ob,2,!1,Tb,rc);else{Tb=Object(K.a)(17,rc);vb=P.FormattingReader.Pr(fb);
if(!vb)return 16;vb=vb.cache;switch(ob){case la.a.font:if(Tb&&Tb.Cd){const {fontName:Zb,L7:Eb,bold:tc,italic:lc}=Aa.gef(Tb.Cd);Aa.Tj.E6d(Zb);Aa.Tj.lec(Eb);Object(ha.a)()&&(ob=1==tc,rc=1==lc,ob||rc)&&(Aa.Tj.UF(ob),Aa.Tj.setItalic(rc))}break;case la.a.Ls:F.ULS.sendTraceTag(595153824,340,50,"Font color is selected from Standard/Theme colors.");Aa.Tj.Ls(rc);break;case la.a.Kga:Aa.Tj.Ls(rc);this.recentColors.L$a(rc)||F.ULS.sendTraceTag(594899723,340,50,"Color selected from Recent Colors section. Menu: Font");
break;case la.a.G5:Aa.Tj.G5();break;case la.a.IX:F.ULS.sendTraceTag(594899722,340,50,"Font background color is selected from Standard colors.");Aa.Tj.Fva(rc);break;case la.a.r7:Aa.Tj.Fva(rc);this.recentColors.L$a(rc)||F.ULS.sendTraceTag(594899720,340,50,"Color selected from Recent Colors section. Menu: Highlighter");break;case la.a.Xja:Aa.Tj.Uud();break;case la.a.Sv:Aa.Tj.Sv(Tb.Cd);break;case la.a.JL:ob=Aa.Tj.EL(y.a.fontSize,vb.fontSize);Aa.Tj.Sv(Aa.vi.JL(ob));break;case la.a.rM:ob=Aa.Tj.EL(y.a.fontSize,
vb.fontSize);Aa.Tj.Sv(Aa.vi.rM(ob));break;case la.a.bold:ob=Aa.Tj.EL(y.a.bold,vb.isBold);Aa.Tj.UF(!ob);break;case la.a.setItalic:ob=Aa.Tj.EL(y.a.italic,vb.isItalic);Aa.Tj.setItalic(!ob);break;case la.a.underline:ob=Aa.Tj.EL(y.a.underline,vb.isUnderline);Aa.Tj.w3(!ob);break;case la.a.Pga:Aa.Tj.Pga(rc);break;case la.a.superscript:ob=Aa.Tj.EL(y.a.superscript,vb.isSuperscript);Aa.Tj.cba(!ob);break;case la.a.subscript:ob=Aa.Tj.EL(y.a.subscript,vb.isSubscript);Aa.Tj.Yna(!ob);break;case la.a.strikethrough:ob=
Aa.Tj.EL(y.a.strikethrough,vb.isStrikethrough);Aa.Tj.x7(!ob);break;case la.a.Es:ob=Aa.Tj.EL(B.a.Es,vb.isDoubleStrikethrough);Aa.Tj.Tdc(!ob);break;case la.a.clearFormatting:Aa.Tj.f2a();break;case la.a.s7:rc.hasProperty(y.a.pE)&&Aa.Tj.s7(rc.getValue(y.a.pE));rc.hasProperty(G.a.noProof)&&(ob=rc.getValue(G.a.noProof),Aa.Tj.vMn(ob));break;default:this.HPg.has(ob)||(this.HPg.add(ob),(rc=e.ActionManager.ada(ob))&&rc.length||(rc="UnknownAction"),F.ULS.sendTraceTag(523120736,324,15,`TextFormattingActor.applyFormattingIp received unexpected command: ${rc} (${ob})`))}}Ca.App.xa.updateCommandUI();
return wb};this.tS=(ob,fb,Mb,Tb,rc)=>{Tb=Aa.Mc.oo(la.a.pJn);var vb=!0;fb.contextId!==L.a.endOfParagraph&&(vb=!1);if(1===Mb||!vb)return vb?32:8;Mb=fb.node;vb=S.GraphIterator.$a(fb.node);vb.vd();var Ya=vb.k6(4);if((vb=!!Ya&&Aa.hd.V$(Ya))&&!Ca.App.hhb)return 8;var wb=!pa.ParagraphReader.textLength(Mb);Tb.properties.Z("Action",ob.toString());Tb.properties.Z("ListContext",vb.toString());Tb.properties.Z("IsEmptyParagraph",wb.toString());F.ULS.sendTraceTag(8700679,324,50,"Apply format to EOP: Action - {0}, InList - {1}, IsEmpty - {2}.",
ob,vb,wb);vb&&!ka.a.ae.RL&&this.Ahj(ob,rc,Ya);vb=Mb.qa.last;this.Dqn(Mb,ob);wb=!!vb.formatting;const jb=Mb.getValue(G.a.endOfParagraphFormatting);Ya=Aa.characterPropertiesEditor.GKa(Mb);wb=!wb&&jb&&jb.equals(a.a.nil)?new ra.a(vb,a.a.nil):Ya.Yf(Ya.Ob);this.Pdc(Ya,ob,rc,vb.cp);J.a.instance.J(3)&&Aa.Nj.CJb(Mb,vb,fb.cpBegin,fb.cpEnd,wb,Ya,Aa.Qd.ng);Tb.end();return 32};this.Dja=(ob,fb,Mb,Tb,rc)=>{Tb=!0;const vb=S.GraphIterator.$a(fb.node);vb.vd();fb.contextId===L.a.endOfParagraph&&vb.k6(4)||(Aa.Mc.Zb(Ha.a.Sm,
{["Reason"]:wa.a.Lwf}),Tb=!1);fb=vb.currentNode;if(!Aa.hd.V$(fb))return 8;if(1===Mb||!Tb)return Tb?32:8;ka.a.ae.RL||this.Ahj(ob,rc,fb);return 32};this.wna=(ob,fb,Mb,Tb,rc)=>{ob=!0;fb.contextId!==L.a.paragraph&&(ob=!1);if(1===Mb&&!ob)return 8;Mb=fb.node;-1!==rc.Zh?rc.Zh!==pa.ParagraphReader.Hv(Mb)&&(rc.Zh=0):rc.Zh=pa.ParagraphReader.Hv(Mb);J.a.instance.J(7)&&(ob=Aa.ey.Ndb(Mb),rc.Ws?(!rc.tWl&&this.wWl(rc.Ws,ob)&&2===rc.Ws.specialIndentType&&(rc.Ws.specialIndentType=0),rc.Ws.aCb===ob.aCb&&k.a.JZ(rc.Ws.DA,
ob.DA)||(rc.Ws.DA=Number.MAX_VALUE),rc.Ws.bCb===ob.bCb&&k.a.JZ(rc.Ws.Pla,ob.Pla)||(rc.Ws.Pla=Number.MAX_VALUE)):rc.Ws=ob,fb=Aa.Tg.Ceh(fb.vk),void 0!==fb&&null!==fb&&(fb=fb.node,void 0!==fb&&null!==fb&&(fb=X.WordSectionNavigator.instance.$L(fb),void 0!==fb&&null!==fb&&(fb=Aa.Sg.Jv(fb)-(Aa.Sg.BL(fb)+Aa.Sg.CL(fb)+Ca.App.wwa),ob.cMc=fb-ob.DA,ob.bMc=fb-ob.Pla,rc.Ws.bMc=Math.min(rc.Ws.bMc,ob.bMc),rc.Ws.cMc=Math.min(rc.Ws.cMc,ob.cMc)))));J.a.instance.J(7)&&(fb=Aa.WT.fBa(Mb),rc.uM?(rc.uM.beforeSpacing=Aa.xah(fb.beforeSpacing,
rc.uM.beforeSpacing),rc.uM.afterSpacing=Aa.xah(fb.afterSpacing,rc.uM.afterSpacing),rc.uM.lineSpacing.unit===fb.lineSpacing.unit&&k.a.JZ(rc.uM.lineSpacing.value,fb.lineSpacing.value)||(rc.uM.lineSpacing.unit=0,rc.uM.lineSpacing.value=0)):rc.uM=fb);fb=new S.GraphIterator;fb.set(Mb);fb.Bb(11);if(Mb=fb.kd(11))rc.isRtl=Y.OutlineElementReader.hm(Mb);Mb=Aa.hd.Hs(fb);fb=16;void 0!==Mb&&null!==Mb&&(fb=Mb.listType);rc.listType=Aa.rol(rc.listType,fb);rc.zw=16===rc.listType?null:Mb;return 32};this.gcn=(ob,fb,
Mb,Tb,rc)=>{rc.isRtl=Y.OutlineElementReader.hm(U.OutlineElementNavigator.Uk(fb.node));return 32};this.qdh=(ob,fb,Mb)=>{if(ob===la.a.WJb)ob=!0;else if(ob===la.a.VJb)ob=!1;else return 2;ob&&this.xni(fb);if(1===Mb)return 32;Aa.Wg.NJb(U.OutlineElementNavigator.Uk(fb.node),ob);return 32};this.Zbn=(ob,fb,Mb,Tb,rc)=>{ob=fb.node;rc.isRtl=Y.OutlineElementReader.isRtl(U.OutlineElementNavigator.Uk(ob));rc.Zh=T.ImageReader.Hv(ob);return 32};this.bdn=(ob,fb,Mb,Tb,rc)=>{ob=fb.node;rc.isRtl=Y.OutlineElementReader.isRtl(U.OutlineElementNavigator.Uk(ob));
rc.Zh=Ma.TableReader.Hv(ob);-1!==rc.Zh&&rc.Zh||(rc.Zh=rc.isRtl?3:1);return 32};this.oRe=(ob,fb,Mb,Tb,rc)=>{let vb;if(!({Gx:vb}=Sa.a.n_f(Mb,fb)).returnValue)return vb;const Ya=fb.node;switch(ob){case la.a.VJb:Aa.Wg.kec(Ya,!1);break;case la.a.WJb:this.xni(fb);Aa.Wg.kec(Ya,!0);break;case la.a.s7:vb=l.AFrameworkApplication.ya.Qf(fb.vk,ob,Mb,!0,Tb,rc),32===vb&&pa.ParagraphReader.gm(fb)&&Aa.MVc&&Aa.MVc.lba(Ya)}return 32};this.pwk=(ob,fb,Mb,Tb,rc)=>{const vb={};vb[mb.a.zFa]=6168;vb[mb.a.yFa]=6169;var Ya=
fb.view;const wb=new bb.GraphTransaction(1===Mb?3:15);wb.Db(Ya.root);let jb=mb.a.kna(ob,fb,Mb,Tb,rc,vb,0),Zb=null;Ya.wi&&(Zb=Ya);Ya=!0;let Eb=null;Zb&&(Eb=Zb.Cb.hb.kb)&&(ob=!Sa.a.Z5b(ob),Aa.Zf.utf(Eb,ob)?(Aa.Mc.Zb(Ha.a.zf,{["Reason"]:wa.a.dE}),jb=8,Ya=!1):1===Mb&&(jb=32,Ya=!1),Aa.Tg.swa(pa.ParagraphReader.UW,Zb.Cb.Rg)&&(Aa.Mc.Zb(Ha.a.zf,{["Reason"]:wa.a.uN}),jb=8,Ya=!1));Ya&&this.dlm(Eb)&&(jb=mb.a.kna(la.a.Pab,fb,Mb,Tb,rc,vb,12));wb.dispose();return jb};this.owk=(ob,fb,Mb)=>{ob=!0;fb.contextId!==
L.a.paragraph&&fb.contextId!==L.a.Wc?ob=!1:Aa.Zf.C_a(fb)&&(Aa.Mc.Zb(Ha.a.Sm,{["Reason"]:wa.a.dE}),ob=!1);if(1===Mb||!ob)return ob?32:8;fb=fb.node;Mb=new bb.GraphTransaction(15);Mb.Db(fb);Aa.Ko.VAc(fb);Aa.paragraphEditor.gZb(fb,!0);Aa.H7.aXe(fb);Mb.dispose();return 2};this.fSl=(ob,fb,Mb)=>{ob=!0;fb.contextId!==L.a.view&&(ob=!1);if(1===Mb&&!ob)return 8;if(!fb.view||!fb.view.ze)return 2;fb=fb.view;if(!fb.Cb||!fb.Cb.hb.kb)return 8;if(Aa.Tg.swa(pa.ParagraphReader.UW,fb.Cb.Rg))return Aa.Mc.Zb(Ha.a.zf,{["Reason"]:wa.a.uN}),
8;fb=fb.Cb.hb;for(const Tb of fb)for(const rc of Tb)if(rc&&rc.contextId!==L.a.Gd&&rc.contextId!==L.a.Wc&&rc.contextId!==L.a.paragraph&&rc.contextId!==L.a.endOfParagraph)return 2;return 32};this.K1a=(ob,fb,Mb,Tb,rc)=>{ob=!0;fb.contextId!==L.a.paragraph&&(ob=!1);if(1===Mb&&!ob)return 8;rc.Ws||(fb=fb.node,Mb=Aa.ey.Ndb(fb),rc.Ws=Mb,fb=U.OutlineElementNavigator.Uk(fb),rc.isRtl=fb?Y.OutlineElementReader.hm(fb):!1);return 32};this.cdn=(ob,fb,Mb,Tb,rc)=>{fb=fb.node;ob=U.OutlineElementNavigator.Uk(fb);rc.Ws||
(fb=this.aDl(fb),fb=Aa.ey.Ndb(fb),rc.Ws=fb,rc.isRtl=Y.OutlineElementReader.isRtl(ob));return 32};this.rEj=ma;this.gca=Ga;this.E4=Fa;this.Co=ib}get recentColors(){return null!=this.Jpg?this.Jpg:this.Jpg=n.a.instance.Pa("Box4.UI.RecentColorsSectionHandler")}get tDd(){return!!this.E4&&this.E4.enabled}Vb(){const ma=l.AFrameworkApplication.ya,Ga=this.gcn;(Aa.Qb?Aa.Qb.Vx(41):l.AFrameworkApplication.K&&l.AFrameworkApplication.K.$("Box4EndOfParagraphFormattingIsEnabled"))?(ma.pa(la.a.font,L.a.endOfParagraph,
this.tS),ma.pa(la.a.Sv,L.a.endOfParagraph,this.tS),ma.pa(la.a.JL,L.a.endOfParagraph,this.tS),ma.pa(la.a.rM,L.a.endOfParagraph,this.tS),ma.pa(la.a.Ls,L.a.endOfParagraph,this.tS),ma.pa(la.a.Kga,L.a.endOfParagraph,this.tS),ma.pa(la.a.G5,L.a.endOfParagraph,this.tS),ma.pa(la.a.IX,L.a.endOfParagraph,this.tS),ma.pa(la.a.r7,L.a.endOfParagraph,this.tS),ma.pa(la.a.Xja,L.a.endOfParagraph,this.tS),ma.pa(la.a.bold,L.a.endOfParagraph,this.tS),ma.pa(la.a.setItalic,L.a.endOfParagraph,this.tS),ma.pa(la.a.underline,
L.a.endOfParagraph,this.tS),ma.pa(la.a.Pga,L.a.endOfParagraph,this.tS),ma.pa(la.a.superscript,L.a.endOfParagraph,this.tS),ma.pa(la.a.subscript,L.a.endOfParagraph,this.tS),ma.pa(la.a.strikethrough,L.a.endOfParagraph,this.tS),ma.pa(la.a.Es,L.a.endOfParagraph,this.tS),ma.pa(la.a.s7,L.a.endOfParagraph,this.tS),ma.pa(la.a.clearFormatting,L.a.endOfParagraph,this.tS)):Ca.App.hhb&&(ma.pa(la.a.font,L.a.endOfParagraph,this.Dja),ma.pa(la.a.Sv,L.a.endOfParagraph,this.Dja),ma.pa(la.a.Ls,L.a.endOfParagraph,this.Dja),
ma.pa(la.a.Kga,L.a.endOfParagraph,this.Dja),ma.pa(la.a.G5,L.a.endOfParagraph,this.Dja),E.ListReader.rr&&(ma.pa(la.a.bold,L.a.endOfParagraph,this.Dja),ma.pa(la.a.setItalic,L.a.endOfParagraph,this.Dja),ma.pa(la.a.superscript,L.a.endOfParagraph,this.Dja),ma.pa(la.a.subscript,L.a.endOfParagraph,this.Dja),ma.pa(la.a.strikethrough,L.a.endOfParagraph,this.Dja),ma.pa(la.a.Es,L.a.endOfParagraph,this.Dja)),ma.pa(la.a.JL,L.a.endOfParagraph,this.Dja),ma.pa(la.a.rM,L.a.endOfParagraph,this.Dja));const Fa=Ca.App.K3a.vxd(ib=>
ia.OutlineElementGeneralizer.$ka(ib.hb,!0));ma.gb(la.a.ZVe,L.a.view,this.fSl,100);ma.gb(la.a.u2c,L.a.Gd,this.u2c,1028);ma.pa(la.a.H1a,L.a.view,this.eIi);ma.pa(la.a.cWc,L.a.view,this.eIi);ma.pa(la.a.wna,L.a.view,Fa);ma.pa(la.a.wna,L.a.paragraph,this.wna);ma.pa(la.a.wna,L.a.image,this.Zbn);ma.pa(la.a.wna,L.a.unsupportedObject,Ga);ma.pa(la.a.wna,L.a.table,this.bdn);ma.pa(la.a.K1a,L.a.view,Fa);ma.pa(la.a.K1a,L.a.paragraph,this.K1a);ma.pa(la.a.K1a,L.a.table,this.cdn);ma.Vc(la.a.H1a,99);ma.Vc(la.a.cWc,
1127);ma.Vc(la.a.wna,97);ma.Vc(la.a.K1a,97);this.eL(ma,la.a.font);this.eL(ma,la.a.Sv);this.eL(ma,la.a.JL);this.eL(ma,la.a.rM);ma.I$a(la.a.AJh,L.a.view,this.ZQe);ma.Vc(la.a.AJh,1092);this.eL(ma,la.a.Ls);this.eL(ma,la.a.Kga);this.eL(ma,la.a.G5);this.eL(ma,la.a.IX);this.eL(ma,la.a.r7);this.eL(ma,la.a.$Va);this.eL(ma,la.a.FJa);this.eL(ma,la.a.GJa);this.eL(ma,la.a.sza);this.eL(ma,la.a.aWa);this.eL(ma,la.a.Xja);this.eL(ma,la.a.bold);ma.tJb(la.a.bold,this.Bzb);this.eL(ma,la.a.setItalic);ma.tJb(la.a.setItalic,
this.Bzb);this.eL(ma,la.a.underline);ma.tJb(la.a.underline,this.Bzb);this.eL(ma,la.a.Pga);this.eL(ma,la.a.superscript);ma.tJb(la.a.superscript,this.Bzb);this.eL(ma,la.a.subscript);ma.tJb(la.a.subscript,this.Bzb);this.eL(ma,la.a.strikethrough);ma.tJb(la.a.strikethrough,this.Bzb);this.eL(ma,la.a.Es);ma.tJb(la.a.Es,this.Bzb);ma.gb(la.a.UZa,L.a.Gd,this.Yrd,96);ma.I$a(la.a.s7,L.a.view,this.ZQe);ma.pa(la.a.s7,L.a.paragraph,this.oRe);ma.pa(la.a.s7,L.a.Gd,this.Yrd);ma.pa(la.a.s7,L.a.Wc,this.gRe);ma.pa(la.a.clearFormatting,
L.a.view,this.pwk);ma.pa(la.a.clearFormatting,L.a.paragraph,this.owk);ma.pa(la.a.clearFormatting,L.a.Gd,this.Yrd);ma.pa(la.a.clearFormatting,L.a.Wc,this.gRe);ma.Vc(la.a.clearFormatting,1036);ma.pa(la.a.Pab,L.a.Gd,this.Pab);ma.pa(la.a.Pab,L.a.Wc,this.Pab);ma.pa(la.a.UAc,L.a.view,this.UAc);ma.pa(la.a.VJb,L.a.view,Sa.a.Av);ma.pa(la.a.VJb,L.a.paragraph,this.oRe);ma.pa(la.a.VJb,L.a.unsupportedObject,this.qdh);ma.Vc(la.a.VJb,1028);ma.pa(la.a.WJb,L.a.view,Sa.a.Av);ma.pa(la.a.WJb,L.a.paragraph,this.oRe);
ma.pa(la.a.WJb,L.a.unsupportedObject,this.qdh);ma.Vc(la.a.WJb,1028)}eL(ma,Ga){ma.I$a(Ga,L.a.view,this.ZQe);ma.pa(Ga,L.a.Gd,this.Yrd);ma.pa(Ga,L.a.Wc,this.gRe);ma.Vc(Ga,1036)}mCk(ma,Ga){for(const Tb of ma)for(const rc of Tb){ma=null;if(rc.contextId===L.a.Gd){if(ua.b(rc))continue;ma=[];var Fa=rc.node.qa;if(Fa){var ib=Fa.length-1;const vb=rc.cpBegin,Ya=rc.cpEnd;let wb=!1;const jb=rc.node.characterData;if(jb&&""!==jb){var ob=jb.substr(vb,Ya-vb);ob&&""!==ob&&v.a.lZe(ob,0,ob.length)&&(wb=!0)}ob=!1;for(let Zb=
0;Zb<ib;Zb++){var fb=Fa.J(Zb).cp,Mb=Fa.J(Zb+1).cp;if(Fa.J(Zb).formatting&&Math.max(fb,vb)<Math.min(Mb,Ya)){if(jb&&""!==jb&&(fb=fb<vb?vb:fb,Mb=jb.substr(fb,(Mb<Ya?Mb:Ya)-fb),!wb&&v.a.lZe(Mb,0,Mb.length)))continue;ob=!0;ma.push(Fa.J(Zb).formatting)}else if(ob)break}Fa.J(ib).formatting&&rc.cpEnd>Fa.J(ib).cp&&ma.push(Fa.J(ib).formatting)}}else if(rc.contextId===L.a.paragraph&&!pa.ParagraphReader.UW(rc)){if(ma=[],Fa=rc.node.qa)for(ib=0;ib<Fa.length;ib++)Fa.J(ib).formatting&&ma.push(Fa.J(ib).formatting)}else if(rc.contextId===
L.a.endOfParagraph)ma=[P.FormattingReader.Pr(rc)];else if(rc.contextId===L.a.Wc){this.Hbn(rc,Ga);return}if(ma&&0<ma.length)for(const vb of ma)if(P.FormattingReader.a8f(Ga,vb.cache,rc))return}}Hbn(ma,Ga){if(ma=P.FormattingReader.Pr(ma)){ma=ma.cache;var Fa=Aa.Tj.EL(y.a.bold,ma.isBold);Ga.bold=Fa?1:0;Fa=Aa.Tj.EL(y.a.italic,ma.isItalic);Ga.italic=Fa?1:0;Fa=Aa.Tj.EL(y.a.underline,ma.isUnderline);Ga.underline=Fa?1:0;Ga.underlineType=Aa.Tj.EL(y.a.underlineType,ma.underlineType);Fa=Aa.Tj.EL(y.a.superscript,
ma.isSuperscript);Ga.superscript=Fa?1:0;Fa=Aa.Tj.EL(y.a.subscript,ma.isSubscript);Ga.subscript=Fa?1:0;Fa=Aa.Tj.EL(y.a.strikethrough,ma.isStrikethrough);Ga.strikethrough=Fa?1:0;Fa=Aa.Tj.EL(B.a.Es,ma.isDoubleStrikethrough);Ga.Es=Fa?1:0;Fa=Aa.Tj.EL(y.a.font,ma.WG);Ga.fontName=Ja.a.nYa(Fa);Ga.L7=ma.we;Ga.fontSize=Aa.Tj.EL(y.a.fontSize,ma.fontSize);Ga.fontColor=Aa.Tj.EL(y.a.fontColor,ma.fontColor);Ga.highlight=Aa.Tj.EL(y.a.highlight,ma.highlight)}}CVn(ma){return ma===la.a.underline||ma===la.a.Pga||ma===
la.a.strikethrough||ma===la.a.Es||ma===la.a.IX}static gef(ma){return"string"===typeof ma?{fontName:ma,L7:-1,bold:2,italic:2}:ma}s1(ma,Ga,Fa){var ib;const ob=ma.cpBegin,fb=ma.cpEnd,Mb=ma.node;let Tb=P.FormattingReader.Pr(ma),rc=ob;const vb=null===(ib=l.AFrameworkApplication.K)||void 0===ib?void 0:ib.getBooleanFeatureGate("Microsoft.Office.WordOnline.TextFormattingOpEnabled",!1);if(Ta.has(Ga))for(const Ya of Mb.qa)if(!(Ya.cp<=ob)){if(Ya.cp>=fb)break;Ya.formatting&&Ya.formatting.cache.fontSize!=Tb.cache.fontSize&&
(ib=this.mRh(ma.node,Tb,Ga,Fa),this.gca.annotateRange(ma.node,vb?Mb.qa.oXa(rc):rc,vb?Mb.qa.oXa(Ya.cp):Ya.cp,ib),rc=Ya.cp,Tb=Ya.formatting)}Ga=this.mRh(ma.node,Tb,Ga,Fa);this.gca.annotateRange(ma.node,vb?Mb.qa.oXa(rc):rc,vb?Mb.qa.oXa(fb):fb,Ga)}mRh(ma,Ga,Fa,ib){const ob={},fb=Object(K.a)(17,ib),Mb=Ga.cache;switch(Fa){case la.a.bold:2===ib.value&&(ib.value=Mb.isBold?0:1);ob[y.a.bold.id]=1===ib.value;break;case la.a.setItalic:2===ib.value&&(ib.value=Mb.isItalic?0:1);ob[y.a.italic.id]=1===ib.value;break;
case la.a.underline:2===ib.value&&(ib.value=Mb.isUnderline?0:1);ob[y.a.underline.id]=1===ib.value;break;case la.a.Pga:ob[y.a.underlineType.id]=ib.number;break;case la.a.superscript:2===ib.value&&(ib.value=Mb.isSuperscript?0:1);ob[y.a.superscript.id]=1===ib.value;break;case la.a.subscript:2===ib.value&&(ib.value=Mb.isSubscript?0:1);ob[y.a.subscript.id]=1===ib.value;break;case la.a.strikethrough:6!==l.AFrameworkApplication.ya.IG?F.ULS.sendTraceTag(529090079,340,50,"User used strikethrough from ribbon"):
F.ULS.sendTraceTag(529090080,340,50,"User used strikethrough from keyboard shortcut");2===ib.value&&(ib.value=Mb.isStrikethrough?0:1);ob[y.a.strikethrough.id]=1===ib.value;break;case la.a.Es:2===ib.value&&(ib.value=Mb.isDoubleStrikethrough?0:1);ob[B.a.Es.id]=1===ib.value;break;case la.a.font:if(fb&&fb.Cd){const {fontName:rc,L7:vb,bold:Ya,italic:wb}=Aa.gef(fb.Cd);ib=rc.substr(0,Aa.dqi);this.tDd&&(ob[G.a.v5.id]=ib,ob[G.a.oF.id]=ib,ob[G.a.H9.id]=ib,ob[G.a.z$.id]=ib,ob[G.a.Me.id]=vb,ob[G.a.$e.id]=vb,
ob[G.a.Ne.id]=vb,ob[G.a.Oe.id]=vb);ob[y.a.font.id]=ib;ob[G.a.we.id]=vb;if(Object(ha.a)()){ib=1==Ya;var Tb=1==wb;if(ib||Tb)ob[y.a.bold.id]=ib,ob[y.a.italic.id]=Tb}}break;case la.a.Ls:ib=Rb.a.instance.yza(ma,ib);ob[y.a.fontColor.id]=ib;break;case la.a.Kga:Tb=Rb.a.instance.yza(ma,ib);ob[y.a.fontColor.id]=Tb;this.recentColors.L$a(ib)||F.ULS.sendTraceTag(529006977,340,50,"Color selected from Recent Colors section. Menu: Font");break;case la.a.G5:ob[y.a.fontColor.id]=hc.a.auto;break;case la.a.IX:ob[y.a.highlight.id]=
parseInt(ib,16);break;case la.a.r7:ob[y.a.highlight.id]=parseInt(ib,16);this.recentColors.L$a(ib)||F.ULS.sendTraceTag(529006978,340,50,"Color selected from Recent Colors section. Menu: Highlighter");break;case la.a.Xja:ob[y.a.highlight.id]=hc.a.auto;break;case la.a.Sv:ob[y.a.fontSize.id]=Aa.vi.EZb(fb.Cd);break;case la.a.JL:ob[y.a.fontSize.id]=this.Avl(Mb.fontSize);break;case la.a.rM:ob[y.a.fontSize.id]=this.hpl(Mb.fontSize);break;case la.a.UZa:if(ib=null===(Tb=Aa.Gw)||void 0===Tb?void 0:Tb.UZa)for(const rc of ib.Mj())ob[rc.id]=
ib.Og(rc);break;case la.a.clearFormatting:if(ib=Ga.an)for(const rc of ib.Mj())ob[rc.id]=null;ob[G.a.Ewb.id]=!0;break;case la.a.FJa:case la.a.GJa:case la.a.$Va:case la.a.sza:case la.a.aWa:Mb.PLa&&2===Mb.capitalization&&(ob[B.a.capitalization.id]=0)}return ob}Avl(ma){ma=Aa.vi.JL(ma);return Aa.vi.EZb(ma)}hpl(ma){ma=Aa.vi.rM(ma);return Aa.vi.EZb(ma)}Pdc(ma,Ga,Fa,ib){var ob=ma.cache;const fb=Object(K.a)(17,Fa);switch(Ga){case la.a.bold:2===Fa.value&&(Fa.value=ob.isBold?0:1);Aa.vi.UF(ma,1===Fa.value);break;
case la.a.setItalic:2===Fa.value&&(Fa.value=ob.isItalic?0:1);Aa.vi.setItalic(ma,1===Fa.value);break;case la.a.underline:2===Fa.value&&(Fa.value=ob.isUnderline?0:1);Aa.vi.w3(ma,1===Fa.value);break;case la.a.Pga:Aa.vi.Pga(ma,Fa);break;case la.a.superscript:2===Fa.value&&(Fa.value=ob.isSuperscript?0:1);Aa.vi.cba(ma,1===Fa.value);break;case la.a.subscript:2===Fa.value&&(Fa.value=ob.isSubscript?0:1);Aa.vi.Yna(ma,1===Fa.value);break;case la.a.strikethrough:6!==l.AFrameworkApplication.ya.IG?F.ULS.sendTraceTag(539305613,
340,50,"User used strikethrough from ribbon"):F.ULS.sendTraceTag(539305614,340,50,"User used strikethrough from keyboard shortcut");2===Fa.value&&(Fa.value=ob.isStrikethrough?0:1);Aa.vi.x7(ma,1===Fa.value);break;case la.a.Es:2===Fa.value&&(Fa.value=ob.isDoubleStrikethrough?0:1);Aa.vi.Tdc(ma,1===Fa.value);break;case la.a.font:if(fb&&fb.Cd){const {fontName:Mb,L7:Tb,bold:rc,italic:vb}=Aa.gef(fb.Cd);Aa.vi.p_(ma,Mb.substr(0,Aa.dqi));Aa.vi.lec(ma,Tb);Object(ha.a)()&&(Fa=1==rc,ib=1==vb,Fa||ib)&&(Aa.vi.UF(ma,
Fa),Aa.vi.setItalic(ma,ib))}break;case la.a.Ls:F.ULS.sendTraceTag(595153825,340,50,"Font color is selected from Standard/Theme colors.");Aa.vi.Ls(ma,Fa,null);break;case la.a.Kga:Aa.vi.Ls(ma,Fa,null);this.recentColors.L$a(Fa)||F.ULS.sendTraceTag(594899727,340,50,"Color selected from Recent Colors section. Menu: Font");break;case la.a.G5:Aa.vi.G5(ma);break;case la.a.IX:F.ULS.sendTraceTag(594899726,340,50,"Font background color is selected from Standard colors.");Aa.vi.Fva(ma,Fa);break;case la.a.r7:Aa.vi.Fva(ma,
Fa);this.recentColors.L$a(Fa)||F.ULS.sendTraceTag(594899724,340,50,"Color selected from Recent Colors section. Menu: Highlighter");break;case la.a.Xja:Aa.vi.Uud(ma);break;case la.a.Sv:Aa.vi.Sv(ma,fb.Cd);break;case la.a.JL:Aa.vi.y2h(ma);break;case la.a.rM:Aa.vi.G5i(ma);break;case la.a.s7:ob=Fa.ia(G.a.noProof,!1);Aa.vi.qYf(ma,Fa.getValue(y.a.pE),ib,ob);break;case la.a.UZa:Aa.vi.G6d(ma);break;case la.a.clearFormatting:Aa.vi.Wja(ma);break;case la.a.FJa:case la.a.GJa:case la.a.$Va:case la.a.sza:case la.a.aWa:ob.PLa&&
2===ob.capitalization&&Aa.vi.ewk(ma)}}Dqn(ma,Ga){la.a.clearFormatting===Ga&&U.OutlineElementNavigator.Uk(ma).properties.removeProperty(y.a.wX)}Ahj(ma,Ga,Fa){const ib=Object(K.a)(17,Ga);switch(ma){case la.a.Ls:Aa.Dma.Ls(Fa,Ga);break;case la.a.Kga:Aa.Dma.Ls(Fa,Ga);break;case la.a.Sv:Aa.Dma.Sv(Fa,ib.Cd);break;case la.a.G5:Aa.Dma.G5(Fa);break;case la.a.JL:Aa.Dma.JL(Fa);break;case la.a.rM:Aa.Dma.rM(Fa);break;case la.a.font:Aa.Dma.eKn(Fa,ib.Cd);break;case la.a.bold:ma=this.Dcc(Ga,y.a.bold,Fa);Aa.Dma.UF(Fa,
ma);break;case la.a.setItalic:ma=this.Dcc(Ga,y.a.italic,Fa);Aa.Dma.setItalic(Fa,ma);break;case la.a.subscript:ma=this.Dcc(Ga,y.a.subscript,Fa);Aa.Dma.Yna(Fa,ma);break;case la.a.superscript:ma=this.Dcc(Ga,y.a.superscript,Fa);Aa.Dma.cba(Fa,ma);break;case la.a.strikethrough:ma=this.Dcc(Ga,y.a.strikethrough,Fa);Aa.Dma.x7(Fa,ma);break;case la.a.Es:ma=this.Dcc(Ga,B.a.Es,Fa),Aa.Dma.Tdc(Fa,ma)}}Dcc(ma,Ga,Fa){2===ma.value&&(ma.value=Fa?Fa.ia(Ga,!1)?0:1:0);return 1===ma.value}wWl(ma,Ga){return this.Kdh(ma,
Ga)||this.Kdh(Ga,ma)}Kdh(ma,Ga){return(1===ma.specialIndentType||!ma.specialIndentType)&&2===Ga.specialIndentType}aDl(ma){ma=S.GraphIterator.$a(ma);ma.Bb(11);da.moveToCell(ma,0,0);ma.Xd();ma.v$();return ma.currentNode}dlm(ma){return!ma||Ka.SelectionEditor.Qm(ma)||1===ma.length&&Ka.SelectionEditor.Ek(ma.Qa)&&!Ka.SelectionEditor.Qfb(ma.Qa)?!1:!0}xni(ma){Aa.nZg.xb(ma.contextId)||(F.ULS.sendTraceTag(42276747,340,50,"RTL Usage : {0}",ma.contextId),Aa.nZg.Z(ma.contextId,!0))}y$l(ma){return ma===la.a.$Va||
ma===la.a.FJa||ma===la.a.GJa||ma===la.a.sza||ma===la.a.aWa}kud(ma,Ga){const Fa=ma.node,ib=Fa.characterData.substr(ma.cpBegin,ma.cpEnd-ma.cpBegin);this.RT.set("Command",Ga.toString());u.Health.instance.recordKpiUsage(this.kpiName,1,this.Y5,this.RT);Ga=Aa.E7n(ib,Ga);Fa.Dva(Fa.characterData.substr(0,ma.cpBegin)+Ga+Fa.characterData.substr(ma.cpEnd));return 32}static get vi(){return null!=Aa.tkg?Aa.tkg:Aa.tkg=n.a.instance.resolve("Box4.IFormattingEditor")}static get characterPropertiesEditor(){return null!=
Aa.ghg?Aa.ghg:Aa.ghg=n.a.instance.resolve("Box4.ICharacterPropertiesEditor")}static get paragraphEditor(){return null!=Aa.ppg?Aa.ppg:Aa.ppg=n.a.instance.resolve("Box4.IParagraphEditor")}static get WT(){return null!=Aa.zng?Aa.zng:Aa.zng=n.a.instance.resolve("Box4.ILineSpacingHelper")}static get SKb(){return null!=Aa.Fqg?Aa.Fqg:Aa.Fqg=n.a.instance.resolve("Box4.Styles.IWACStyleReader")}static get H7(){return null!=Aa.Bqg?Aa.Bqg:Aa.Bqg=n.a.instance.resolve("Box4.Styles.IWACStyleEditor")}static get Wg(){return null!=
Aa.Hog?Aa.Hog:Aa.Hog=n.a.instance.resolve("Box4.IOutlineElementEditor")}static get Tj(){return Aa.Gw||(Aa.Gw=n.a.instance.resolve("Box4.IInsertionPointFormatting"))}static get Dma(){return null!=Aa.Lng?Aa.Lng:Aa.Lng=n.a.instance.resolve("Box4.List.IListFormattingEditor")}static get ey(){return null!=Aa.wpg?Aa.wpg:Aa.wpg=n.a.instance.resolve("Box4.IParagraphIndentationReader")}static uw(){return Aa.Hm||(Aa.Hm=n.a.instance.Za("Box4.IExternalSelectionManager"))}static get Tg(){return va.ContextSetEditor.instance}static get Zf(){return Na.a.instance}static get Mc(){return t.a.instance}static get Qb(){return null!=
Aa.tjg?Aa.tjg:Aa.tjg=n.a.instance.Pa("Box4.IFeatureHelper")}static get MVc(){return Ca.App.zK}static get Qd(){return null!=Aa.asg?Aa.asg:Aa.asg=n.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance}static get Nj(){return null!=Aa.Frg?Aa.Frg:Aa.Frg=n.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance}static get I3a(){return null!=Aa.qrg?Aa.qrg:Aa.qrg=n.a.instance.resolve("Box4.TextFormattingHelper")}static get hd(){return null!=Aa.Tng?Aa.Tng:Aa.Tng=n.a.instance.resolve("Box4.List.IListReader")}static get Ko(){return null!=
Aa.Eng?Aa.Eng:Aa.Eng=n.a.instance.resolve("Box4.List.IListEditor")}static get Sg(){return ca.a.instance}static rol(ma,Ga){return 42===ma?Ga:ma!==Ga||16===ma?16:ma}static xah(ma,Ga){ma.cOd||(Ga.cOd?Ga=ma:Ga.unit===ma.unit&&k.a.JZ(Ga.value,ma.value)||(Ga.value=-1));return Ga}static E7n(ma,Ga){switch(Ga){case la.a.FJa:return ma.toLowerCase();case la.a.GJa:return 6!==l.AFrameworkApplication.ya.IG?F.ULS.sendTraceTag(539305615,340,50,"User changed the case via ribbon"):F.ULS.sendTraceTag(539305616,340,
50,"User changed the case from keyboard shortcut"),ma.toUpperCase();case la.a.$Va:case la.a.sza:return Aa.Ysk(ma,Ga===la.a.sza);case la.a.aWa:return Aa.L9n(ma);default:return ma}}static L9n(ma){let Ga="";for(let Fa=0;Fa<ma.length;Fa++)Ga=ma.charAt(Fa)===ma.charAt(Fa).toUpperCase()?Ga+ma.charAt(Fa).toLowerCase():Ga+ma.charAt(Fa).toUpperCase();return Ga}static Ysk(ma,Ga){let Fa,ib,ob=!0,fb=ma.length,Mb=0,Tb=Aa.Ntf(ma,Mb,fb);for(;0<fb;){ib=Fa=!1;var rc=fb;let Ya;var vb=void 0;for(vb=0;0<rc&&Aa.qvk(ma.charAt(Mb+
vb));vb++,rc--)ib=Aa.kQd(ma.charAt(Mb+vb));for(Ya=vb;0<rc&&!(Fa=Aa.kQd(ma.charAt(Mb+vb)))&&" "!==ma.charAt(Mb+vb)&&"/"!==ma.charAt(Mb+vb);vb++,rc--);rc=vb-Ya;if(0>=rc)break;Mb+=Ya;vb=ma.substr(Mb,rc);vb=vb===vb.toUpperCase();if(Tb||!vb)ma=ob||ib||Ga?ma.substr(0,Mb)+ma.charAt(Mb).toUpperCase()+ma.substr(Mb+1,rc-1).toLowerCase()+ma.substr(Mb+rc):ma.substr(0,Mb)+ma.substr(Mb,rc).toLowerCase()+ma.substr(Mb+rc);fb-=rc+Ya;Mb+=rc;if(ob=Fa)Mb++,fb--,Tb=Aa.Ntf(ma,Mb,fb)}return ma}static Ntf(ma,Ga,Fa){for(;0<
Fa&&!Aa.kQd(ma.charAt(Ga));){if(ma.charAt(Ga)!==ma.charAt(Ga).toUpperCase())return!1;Ga++;Fa--}return!0}static $km(ma,Ga){for(var Fa=0;0<Ga&&!Aa.kQd(ma.charAt(Fa));){if(ma.charAt(Fa)!==ma.charAt(Fa).toLowerCase())return!1;Fa++;Ga--}return!0}static kQd(ma){return"."===ma||"!"===ma||"?"===ma?!0:!1}static qvk(ma){return-1==="0123456789".indexOf(ma)&&ma.toUpperCase()===ma.toLowerCase()}}Aa.nZg=new I.a;Aa.Gw=null;Aa.Hm=null;Aa.dqi=31;Object(C.a)(Aa,"TextFormattingActor",null,[])},1903:function(C,N,d){d.d(N,
"a",function(){return l});const l=(e,a)=>{var k=e.Buj;if(!k){k=[];for(var n in e)"string"===typeof n&&k.push({key:n,value:e[n]});k.sort((v,u)=>v.value-u.value);e.Buj=k}k=[];for(n=1;0<a;)a&1&&e[n]&&k.push(e[n]),n<<=1,a>>=1;if(k.length&&0===a)return k.reverse().join(", ")}},1905:function(C,N,d){d.d(N,"a",function(){return l});C=d(0);var l;(function(e){e[e.chrome=0]="chrome";e[e.edge=1]="edge";e[e.firefox=2]="firefox";e[e.IE=3]="IE";e[e.safari=4]="safari";e[e.others=5]="others";e[e.unknown=6]="unknown";
e[e.electron=7]="electron";e[e.chromiumEdge=8]="chromiumEdge";e[e.teamsElectron=9]="teamsElectron"})(l||(l={}));Object(C.b)("BrowserCode",l)},1907:function(C,N,d){d.d(N,"a",function(){return l});C=d(0);class l{constructor(){this.email=this.fullName="";this.resolveState=0}}Object(C.a)(l,"AtMentionAttributes",null,[])},1913:function(C,N,d){d.d(N,"a",function(){return l});C=d(0);var l;(function(e){e[e.initial=0]="initial";e[e.startSearch=1]="startSearch";e[e.searching=2]="searching";e[e.searchComplete=
3]="searchComplete";e[e.replaceAllInProgress=4]="replaceAllInProgress";e[e.replaceAllComplete=5]="replaceAllComplete";e[e.tooManyResults=6]="tooManyResults";e[e.noMatchesFound=7]="noMatchesFound"})(l||(l={}));Object(C.b)("FindReplaceViewType",l)},1915:function(C,N,d){d.d(N,"a",function(){return l});var l;(function(e){e[e.initial=0]="initial";e[e.headings=1]="headings";e[e.find=2]="find";e[e.replace=3]="replace";e[e.intelligentPlaceholder=4]="intelligentPlaceholder";e[e.contracts=5]="contracts"})(l||
(l={}))},1929:function(C,N,d){function l(b,h){h=Object.assign(new ca.a,{name:"LinkType",string:h});e(Fb.a.E5l,b,[h])}function e(b,h,r,z=!0){h&&h.UILocation&&Object(Lb.d)(b,z,Lb.e,0,h.UILocation,0,r)}function a(b,h){var r;return b===$q.none?"none":null===(r=Ey[b])||void 0===r?void 0:r[h]}function k(b,h,r){return{type:"ShortcutDiscoverySettingsModel",actionId:b,l2i:h,label:r}}d.r(N);var n=d(0),v=d(8),u=d(44),t=d(2),y=d(35),B=d(16),G=d(163),F=d(87);class K{constructor(b){this.z5f=0;this.RBb=this.sbc=
this.q3a=null;this.PX=t.AFrameworkApplication.ua.jq;this.MW=b;this.MW.xv(F.a.CYi);this.MW.cC(F.a.CYi,Object(u.a)(this,this.VVm,"onReceivedCustomAuthConfig"))}getCustomAuthConfig(){if(this.RBb)return v.ULS.sendTraceTag(589050652,344,100,"Returning existing promise"),this.RBb;this.q3a=this.PX.hg("ComponentAttach","getCustomAuthConfig");return this.RBb=new Promise((b,h)=>{const r={};let z=!1,R=!1,ba=0;this.z5f=window.setInterval(()=>{4>ba?(ba++,this.MW.sendMessage(F.a.getCustomAuthConfig,r)):(window.clearInterval(this.z5f),
z=!0,v.ULS.sendTraceTag(588087303,344,10,y.c({["error"]:"Request timeout after 4 retries."})),h("Request timeout."))},1E3);this.sbc=(ta,Wa)=>{window.clearInterval(this.z5f);z||R||(R=!0,ta?(v.ULS.sendTraceTag(589050653,344,50,"Resolving Promise with authConfig"),b(ta)):(v.ULS.sendTraceTag(589050654,369,10,y.c({["error"]:Wa.toString()})),h(Wa)))};this.MW.sendMessage(F.a.getCustomAuthConfig,r)})}VVm(b){try{const h=y.a(b.Values[G.a.uok]);let r=t.AFrameworkApplication.K.lb("Application")||"";r=B.a.mh(r);
h.appSignInUrl="https://www.office.com/login?ru=%2Flaunch%2F"+r+"%3Facctsw%3D1&prompt=select_account";h.appSignInToUrl="https://www.office.com/login?ru=%2Flaunch%2F"+r+"%3Facctsw%3D1";h.appSwitchUrl="https://www.office.com/login?ru=%2Flaunch%2F"+r+"%3Facctsw%3D1&prompt=select_account";h.appSwitchToUrl="https://www.office.com/login?ru=%2Flaunch%2F"+r+"%3Facctsw%3D1";this.q3a&&(this.q3a.stop(),this.q3a=null);this.sbc(h,"")}catch(h){v.ULS.sendTraceTag(589050655,344,10,y.c({["error"]:h.message,["stack"]:h.stack})),
this.sbc(null,h.message)}}}Object(n.a)(K,"AccountSwitchingManager",null,[152]);var O=d(178);class H{get name(){return"Common.App.AccountSwitching"}yc(b){b.register(K,"Common.App.AccountSwitching.AccountSwitchingManager").as("Common.App.AccountSwitching.IAccountSwitching").singleInstance().Yd(()=>new K(b.resolve("Postmessage.IHostPostmessenger")))}init(){}dispose(){}static main(){O.a.instance.Oc(new H)}}Object(n.a)(H,"AccountSwitchingPackage",null,[1,2]);var I;(function(b){b[b.generalException=0]=
"generalException";b[b.invalidArgument=1]="invalidArgument";b[b.notAllowed=2]="notAllowed";b[b.apiNotAvailable=3]="apiNotAvailable";b[b.unresolvedPendingRequest=4]="unresolvedPendingRequest";b[b.timeout=5]="timeout";b[b.adalTimeout=6]="adalTimeout";b[b.userNotSignedIn=7]="userNotSignedIn";b[b.userAborted=8]="userAborted";b[b.silentSignInFailed=9]="silentSignInFailed";b[b.invalidResourceUrl=10]="invalidResourceUrl";b[b.invalidGrant=11]="invalidGrant";b[b.connectionLost=12]="connectionLost";b[b.clientError=
13]="clientError";b[b.serverError=14]="serverError"})(I||(I={}));Object(n.b)("ErrorCodes",I);d(1743);class J{constructor(b,h){this.requestCallback=this.requestParameters=null;this.requestParameters=b;this.requestCallback=h}}Object(n.a)(J,"OutstandingRequest",null,[]);class L{}L.KLm="AADSTS50058";L.invalidResourceUrl="AADSTS50001";L.DLm="AADSTS65001";L.kMm="AADSTS70011";L.userAborted="13002";L.n6m="Popup Window is null";L.m6m="Popup Window closed";L.adalTimeout="Token renewal operation failed due to timeout";
L.T9n="tokenRevoked";Object(n.a)(L,"WopiHostErrorType",null,[]);var S=d(1494),E=d(59),P=d(1742);class T{constructor(){this.authority=this.email=this.displayName=null;this.authority=this.email=this.displayName=""}}Object(n.a)(T,"WopiIdentityInfo",null,[726]);class U{constructor(b,h,r){this.expiration=this.authority=this.accessToken=null;this.accessToken=b;this.authority=h;this.expiration=r}}Object(n.a)(U,"WopiIdentityToken",null,[725]);var X=d(15),Y=d(137),ca=d(36),da=d(179);class ua{constructor(b){this._initialized=
!1;this.qac={};this.i$d={};this.PX=t.AFrameworkApplication.ua.jq;this.Nlf=b}l7e(b){this._initialized||(b.xv(F.a.xFi),b.cC(F.a.xFi,Object(u.a)(this,this.UVm,"onReceivedAccessToken")),this._initialized=!0)}getAccessToken(b,h,r=null){this.LCa(b,h);return new Promise((z,R)=>{if(this.cpf(h))if(h in this.qac)R("unresolvedPendingRequest");else{var ba=window.setTimeout(()=>{v.ULS.sendTraceTag(37856032,344,10,y.c({["error"]:"Request timeout.",["callerId"]:h}));R("timeout")},12E4);this.Saf(b,h,r,(ta,Wa)=>{window.clearTimeout(ba);
ta?z(ta):(v.ULS.sendTraceTag(37856033,369,15,y.c({["error"]:I[Wa]})),R(Wa))})}else v.ULS.sendTraceTag(37856034,344,10,y.c({["error"]:"Caller is not allowed."})),R("notAllowed")})}getPrimaryIdentityInfo(b){return new Promise((h,r)=>{this.cpf(b)?this.aFl((z,R)=>{z?h(z):(v.ULS.sendTraceTag(37856064,369,10,y.c({["error"]:R.toString()})),r(R))}):(v.ULS.sendTraceTag(37856065,344,10,y.c({["error"]:"Caller is not allowed."})),r("notAllowed"))})}getAuthContext(b){return new Promise((h,r)=>{const z=this.getAuthContextSync(b);
z?h(z):r("notAllowed")})}getAuthContextSync(b){if(this.cpf(b)){const h=new P.a;h.upn=t.AFrameworkApplication.K.lb("UserPrincipalName");h.userId=t.AFrameworkApplication.K.lb("LoggableUserId");h.authority=t.AFrameworkApplication.K.lb("HostAuthAuthority");h.tenantId=t.AFrameworkApplication.K.lb("TenantId");h.isAnonymous=t.AFrameworkApplication.K.$("IsAnonymousUser");h.supportsAuthToken=this.kZl(b);b=t.AFrameworkApplication.K.lb("HostAuthType");h.authorityType="aad"===b.toLowerCase()?2:"msa"===b.toLowerCase()?
1:0;return h}v.ULS.sendTraceTag(40751647,344,10,y.c({["error"]:"Caller is not allowed."}));return null}kZl(b){const h=S.a.mLc;return X.a.OMa?h&&S.a.P$i?Array.contains(S.a.P$i,b.toLowerCase()):!1:h}Saf(b,h,r,z){var R=[];Array.add(R,Object.assign(new ca.a,{name:"CallerId",string:h}));Array.add(R,Object.assign(new ca.a,{name:G.a.d2f,string:b.correlationId}));Y.a.sendTelemetryEvent(Object.assign(new da.a,{name:"Office.Online.Extensibility.SSO.FirstPartyRequestTokenFromHost",dataFields:R}));R=E.a.create().toString();
const ba="getAccessToken_"+R,ta=this.PX.hg("ComponentAttach",ba);this.i$d[ba]=ta;const Wa={};Wa[G.a.e2f]=R;Wa[G.a.k1n]=b.resource;Wa[G.a.l1n]=b.scope;Wa[G.a.r7i]=t.AFrameworkApplication.K.lb("HostAuthType");Wa[G.a.o1n]=t.AFrameworkApplication.K.lb("UserPrincipalName");Wa[G.a.m1n]=b.silentLogin;Wa[G.a.h1n]=b.options;Wa[G.a.d2f]=b.correlationId;Wa[G.a.i1n]=h;r&&(Wa[G.a.addinName]=r.AddinName,Wa[G.a.g1n]=r.AddinTrustId);this.Nlf.execute(ub=>{this.l7e(ub);ub.sendMessage(F.a.getAuthToken,Wa)});this.qac[R]=
new J(b,z)}aFl(b){const h=t.AFrameworkApplication.K.lb("UserName"),r=t.AFrameworkApplication.K.lb("UserPrincipalName"),z=t.AFrameworkApplication.K.lb("LoggableUserIdSpace"),R=new T;R.email=r;R.displayName=h;switch(z){case "OrgIdPuid":R.authority="AzureActiveDirectoryAccount";break;case "MsaCid":case "MsaPuid":R.authority="MicrosoftAccount";break;default:R.authority=z}b(R,null)}UVm(b){let h=null;try{let z=b.Values[G.a.e2f];const R=b.Values[G.a.f1n],ba=b.Values[G.a.r7i],ta=b.Values[G.a.n1n];let Wa=
null,ub=null;const Ib=this.qac[z];if("undefined"!==typeof Ib&&Ib){var r=[];Array.add(r,Object.assign(new ca.a,{name:G.a.d2f,string:Ib.requestParameters.correlationId}));Y.a.sendTelemetryEvent(Object.assign(new da.a,{name:"Office.Online.Extensibility.SSO.FirstPartyResponseTokenFromHost",dataFields:r}));h=Ib.requestCallback;delete this.qac[z];"undefined"!==typeof R&&R&&R.length?ub=new U(R,ba,ta):Wa=I[this.kEm(b)];r="getAccessToken_"+z;r in this.i$d&&(this.i$d[r].stop(),delete this.i$d[r]);h(ub,Wa)}else v.ULS.sendTraceTag(37856066,
344,10,y.c({["error"]:"No matching outstanding request for request ID.",["requestId"]:z}))}catch(z){b=b.Values[G.a.e2f],b in this.qac&&delete this.qac[b],this.hTd(),v.ULS.sendTraceTag(37856067,344,10,y.c({["error"]:z.message,["stack"]:z.stack})),h&&h(null,"generalException")}}cpf(b){var h=t.AFrameworkApplication.tQl();b=b.toLowerCase();for(const r of h)if(b===r.toLowerCase())return!0;h=S.a.JQe;for(let r in h)if(b===h[r].toLowerCase())return!0;return!1}kEm(b){b=b.Values[G.a.j1n];this.hTd();v.ULS.sendTraceTag(39068821,
344,15,y.c({["error"]:b}));return b?-1<b.indexOf(L.KLm)?9:-1<b.indexOf(L.n6m)||-1<b.indexOf(L.m6m)?12:-1<b.indexOf(L.invalidResourceUrl)?10:-1<b.indexOf(L.userAborted)?8:-1<b.indexOf(L.kMm)||-1<b.indexOf(L.DLm)||b===L.T9n?11:-1<b.indexOf(L.adalTimeout)?6:0:13}LCa(b,h){b=this.ujn(b.resource);v.ULS.sendTraceTag(39921882,344,50,y.c({["callerId"]:h,["resource"]:b}))}hTd(){v.ULS.sendTraceTag(39068822,344,50,y.c({["userAgent"]:window.navigator.userAgent}))}ujn(b){return(b?b:"").replace("://","__").replace(RegExp("\\.",
"g"),"_dot_").replace("/","\\")}}Object(n.a)(ua,"WopiIdentityManager",null,[695]);class ra{constructor(){this.W=null}get name(){return"Common.App.WopiIdentity"}yc(b){this.W=b;b.register(ua,"Common.App.WopiIdentity.WopiIdentityManager").as("Common.App.WopiIdentity.IWopiIdentity").singleInstance().Yd(()=>new ua(b.Za("Postmessage.IHostPostmessenger")))}init(){t.AFrameworkApplication.K&&t.AFrameworkApplication.K.zq(Object(u.a)(this,this.ax,"onFullAppSettingsReady"))}ax(){try{this.W.resolve("Common.App.WopiIdentity.IWopiIdentity")}catch(b){v.ULS.sendTraceTag(571074327,
383,10,"Failed to initialize WopiIdentityPackage with exception: "+b)}}dispose(){}static main(){O.a.instance.Oc(new ra)}}Object(n.a)(ra,"WopiIdentityPackage",null,[1,2]);var qa=d(546),ka=d(375),la=d(72),Ha;(function(b){b[b.applicationFeatureHelperHandler=0]="applicationFeatureHelperHandler";b[b.cloudPolicySettings=1]="cloudPolicySettings";b[b.alternateAuthToken=2]="alternateAuthToken"})(Ha||(Ha={}));Object(n.b)("ApplicationFeatureHelperRequestType",Ha);class wa{constructor(){this.message=null;this.httpStatusCode=
0}}Object(n.a)(wa,"HttpRequstToPromiseRejectData",null,[]);var Ca=d(83),Ja=d(185);class bb{constructor(b,h){this.Oa=b;this.rg=h}a0e(b,h,r,z=null,R=null,ba=null,ta=null,Wa=null){const ub=Ha[r],Ib=ub+"RequestFailure";Ca.Health.instance.recordKpiUsage(Ib,0,"jpittsdirects",null);return new Promise(($b,fc)=>{v.ULS.sendTraceTag(50622688,3004,50,"HttpRequestToPromiseUtility.CreateHttpResponsePromise: Initializing HttpRequest {0}.",ub);const Kc=null!=ta?ta:this.Oa.rc("ApplicationFeatureHelperRequestQueueTimeout",
15E3),ed=null!=Wa?Wa:this.Oa.rc("ApplicationFeatureHelperRequestSentTimeout",3E4);this.rg.WWb(b,1,null,this.dul(r,z),ba,1,Jd=>{v.ULS.sendTraceTag(50622689,3004,50,"HttpRequestToPromiseUtility.CreateHttpResponsePromise: HttpRequest {0} Succeeded.",ub);try{if(void 0===Jd||null===Jd||void 0===Jd.data||null===Jd.data||void 0===Jd.data.Ge||null===Jd.data.Ge){Ca.Health.instance.recordKpiFailure(Ib,"Invalid RequestSucceededEventArgs",!1,!0,null);let qe=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: args or args.Data or args.Data.ResponseData is null or undefined request {0}",
ub);fc(this.xJc(qe,Jd))}else if(Jd.data.wf!==Ja.a.xD){Ca.Health.instance.recordKpiFailure(Ib,"HttpStatusCode_"+Jd.data.wf.toString(),!1,!0,null);let qe=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: ApplicationFeatureHelper Service token generation returned unexpected response code {0}, request {1}",Jd.data.wf,ub);fc(this.xJc(qe,Jd))}else{void 0!==R&&null!==R&&void 0!==Jd.data.rj&&null!==Jd.data.rj&&R(Jd.data.rj);var ge=h(Jd.data.Ge);if(ge)v.ULS.sendTraceTag(50622690,3004,50,
"HttpRequestToPromiseUtility.CreateHttpResponsePromise: Successfully parsed response for request {0}",ub),$b(ge);else{Ca.Health.instance.recordKpiFailure(Ib,"Parse Failure",!1,!0,null);let qe=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: Failed to parse response for request {0}",ub);fc(this.xJc(qe,Jd))}}}catch(qe){Ca.Health.instance.recordKpiFailure(Ib,"Unexpected Failure",!1,!0,null),ge=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: Exception {0} for request {1}",
qe,ub),fc(this.xJc(ge,Jd))}},Jd=>{let ge;Jd.data?(Ca.Health.instance.recordKpiFailure(Ib,"HttpStatusCode_"+Jd.data.wf.toString(),!1,!0,null),ge=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: Request Failed: HttpStatus - {0}, ResponseData - {1} for Request - {2}",Jd.data.wf,Jd.data.Ge||"No Data",ub)):(Ca.Health.instance.recordKpiFailure(Ib,"Invalid RequestFailedEventArgs",!1,!0,null),ge=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: args or args.Data is null or undefined for request {0}",
ub));fc(this.xJc(ge,Jd))},void 0,void 0,Kc,ed)})}xJc(b,h){const r=new wa;r.message=b;r.httpStatusCode=h&&h.data?h.data.wf:-1;return r}dul(b,h){const r={};r["x-UserDataSignature"]=this.Oa.lb("UserDataSignature");r["x-LicensingIsEnabled"]=this.Oa.$("LicensingIsEnabled").toString();r["x-CacheIsEnabled"]=this.Oa.$("LicensingRedisIsEnabled").toString();r["x-OcpsIsEnabled"]=this.Oa.$("OcpsIsEnabled").toString();r["x-LicensingAADIdIsEnabled"]=this.Oa.$("LicensingAadIdIsEnabled").toString();0===b&&(r["x-LicenseCheckOnTenantEnabled"]=
this.Oa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SafeLinksLicenseCheck",!1).toString(),r["x-SupportUserConsentDependentFeatures"]="true",r["x-AFHUserConsentGroupValue"]="0",r["x-UseShellServiceForUserConsentGroup"]="true",r["x-SMBUserLicensingEnabled"]="true");if(h)for(let z of h.keys)r[z]=h.J(z);return r}}Object(n.a)(bb,"HttpRequestToPromiseUtility",null,[]);var ha;(function(b){b[b.loki=0]="loki";b[b.augloopACLP=1]="augloopACLP"})(ha||(ha={}));Object(n.b)("AlternateAuthSupportApp",ha);
class ia{constructor(){this.Token=null;this.ExpirationTime=0}}Object(n.a)(ia,"WacAlternateAuthToken",null,[]);class va{constructor(b,h){this.R9n=3E5;if(void 0===b||null===b||void 0===h||null===h)throw Error.argumentNull("appSettingsManager/clientRequestManager");this.Oa=b;this.I6c=new qa.a(ka.a.Rj());this.Ioc=new bb(b,h);void 0!==S.a.jyf&&null!==S.a.jyf&&void 0!==S.a.KTd&&null!==S.a.KTd&&0<S.a.KTd&&(b=new ia,b.Token=S.a.jyf,b.ExpirationTime=S.a.KTd,this.I6c.Z("loki",b))}Uhl(){let b=null;this.I6c.xb(ha[0])&&
(b=this.I6c.J(ha[0]));return void 0===b||null===b||this.isTokenExpired(b)?this.A7k():Promise.resolve(b.Token)}isTokenExpired(b){return b.ExpirationTime-Date.now()<this.R9n}A7k(){const b=new qa.a(ka.a.Rj());b.Z("X-AlternateAuthApp",ha[0]);return this.Ioc.a0e(this.Ddb("/afhs/AlternateAuthHelperHandler.ashx"),Object(u.a)(this,this.m2m,"parseAlternateAuthTokenResponse"),2,b).then(h=>{v.ULS.sendTraceTag(545821456,3004,50,"AlternateAuthHelper:FetchNewUserDataSignatureToken: Retrieved WacAlternateAuthToken for {0}",
ha[0]);this.I6c.Z(ha[0],h);return h.Token},h=>{h=Object(la.a)(wa,h);v.ULS.sendTraceTag(545604827,3004,10,"AlternateAuthHelper:FetchNewUserDataSignatureToken: Error: {0}, status code: {1}",h.message,h.httpStatusCode);return null})}m2m(b){let h=null;({Fv:h}=y.d(b));v.ULS.sendTraceTag(545821457,3004,h?50:10,"ParseAlternateAuthTokenResponse: fetched WacAlternateAuthToken from {0}",b);return h}Ddb(b){return String.format("{0}{1}?{2}",this.Oa.lb("WebServiceBase"),b,t.AFrameworkApplication.xm)}}Object(n.a)(va,
"AlternateAuthHelper",null,[664]);var Ka=d(485);class Xa{constructor(b,h,r){this.featureName=null;this.isEnabled=!1;this.tierName=0;this.featureName=b;this.isEnabled=h;this.tierName=r}}Object(n.a)(Xa,"FeatureStateChangeArgs",null,[]);var xa=d(112),Ma=d(192),Na=d(77),pa=d(121),Ra;(function(b){b[b.Enabled=0]="Enabled";b[b.Disabled=1]="Disabled"})(Ra||(Ra={}));Object(n.b)("FeatureState",Ra);var Sa=d(22),ab=d(13),eb=d(161);class zb{constructor(b,h,r=null,z=null,R=null){this.Kcb=this.Aqa=this.lYg=this.f8a=
this.Mmd=null;this.Ioc=new bb(b,h);this.Oa=b;this.qLj=b.rc("LicensingMaxRetryAttempts",0);this.Uue=b.$("IsO365ConsumerHost");this.Tue=b.$("IsO365CommercialHost");this.Ldd=b.$("PremiumUpsellIsEnabled");this.nyg=r;this.c5g=z;this.ga=R;this.e8a=b.$("LicensingIsEnabled");this.Jrb=b.$("OcpsIsEnabled")&&this.Tue;this.ULe=b.$("ShowPrivacyDialog")&&!!z;this.tpc=b.$("IsAnonymousUser");this.B8e=new Promise(ba=>{ba(!1)});this.Xlb=new Promise(ba=>{ba(!0)});this.Jcb=new qa.a(ka.a.Rj());this.ipd=!0;this.QOg=this.txl();
this.ksf()&&!this.tpc?(void 0!==t.AFrameworkApplication.ua&&null!==t.AFrameworkApplication.ua&&(this.Mmd=t.AFrameworkApplication.ua.jq,void 0!==this.Mmd&&null!==this.Mmd&&(this.f8a=this.Mmd.vNa("WebServiceCall","ApplicationFeatureHelperService"))),this.Kcb=this.T6f()):this.Kcb=new Promise(ba=>{ba({})});this.Kcb.catch(ba=>{v.ULS.sendTraceTag(42513088,3004,10,JSON.stringify(ba))});this.ipd&&(this.Ldd=!1,this.isFeatureEnabled("FreemiumUpsell",!0).then(ba=>{this.Ldd=this.Oa.$("PremiumUpsellIsEnabled")&&
ba;return null}))}txl(){const b=this.Oa.yu("AllLicensedFeatures")?this.Oa.KB("AllLicensedFeatures"):[],h=new Ka.a;for(let r=0;r<b.length;r++)h.add(b[r]);return h}ksf(){return this.Tue||this.Uue}T6f(b=0,h=!1){v.ULS.sendTraceTag(51185368,3004,50,"ApplicationFeatureHelper_TryInitializeLicensing: forceRefresh = {0}",h);const r=xa.a.iF();r&&(r.set("retryAttempt",b.toString()),r.set("forceRefresh",h.toString()),r.set("isO365ConsumerHost",this.Uue.toString()),r.set("isO365CommercialHost",this.Tue.toString()),
r.set("isFreemiumUpsellEnabled",this.Ldd.toString()));Ca.Health.instance.recordKpiUsageForAlertableKpi("AFHSLicensingFailedRequest","waclicensing",r);Ca.Health.instance.recordKpiUsage("AFHSLicensingSuccessfulRequest",1,"waclicensing",r);void 0!==this.f8a&&null!==this.f8a&&this.f8a.start();let z=null;h&&(z=new qa.a(ka.a.Rj()),z.Z("x-LicensingForceRefresh","true"));this.lYg=new Date;return(this.e8a?this.Ioc.a0e(this.Ddb("/afhs/ApplicationFeatureHelperHandler.ashx"),Object(u.a)(this,this.q2m,"parseApplicationFeatureHelperResponse"),
0,z,Object(u.a)(this,this.q9m,"processApplicationFeatureHelperResponseHeaders"),["Date"]):Promise.resolve({})).then(R=>{const ba=Object.assign(new eb.a,{durationMs:this.l8i()});ba.extendedProperties=r;ba.extendedProperties&&R&&(ba.extendedProperties.set("featureCount",Na.a.count(R).toString()),ba.extendedProperties.set("licensingTestFeatureEnabled",("LicensingTestFeature"in R).toString()),ba.extendedProperties.set("msoPremiumBadgeEnabled",("MsoPremiumBadge"in R).toString()),this.Aqa&&ba.extendedProperties.set("fromCache",
(this.Aqa<this.lYg).toString()));Ca.Health.instance.recordKpiSuccess("AFHSLicensingSuccessfulRequest",ba);return R},R=>{const ba=Object.assign(new eb.a,{durationMs:this.l8i()}),ta=Object(la.a)(wa,R);if(!ta)return v.ULS.sendTraceTag(51491471,3004,10,"ApplicationFeatureHelper_TryInitializeLicensing: Invalid cast to HttpRequestToPromiseRejectData"),Ca.Health.instance.recordKpiFailure("AFHSLicensingFailedRequest","InvalidCastToHttpRequestToPromiseRejectData",!1,!0,ba),new Promise((Wa,ub)=>{ub(R)});ba.extendedProperties=
r;ba.extendedProperties&&ba.extendedProperties.set("status",ta.httpStatusCode.toString());Ca.Health.instance.recordKpiFailure("AFHSLicensingFailedRequest","RequestFailed",!1,!0,ba);return 408===ta.httpStatusCode&&++b<=this.qLj?this.T6f(b):new Promise((Wa,ub)=>{ub(ta)})})}q2m(b){(b=y.b(b))?(v.ULS.sendTraceTag(50436170,3004,50,"ParseApplicationFeatureHelperResponse: Successfully fetched features"),v.ULS.sendTraceTag(50938594,3004,50,"{0}",b)):v.ULS.sendTraceTag(50436171,3004,10,"ParseApplicationFeatureHelperResponse: ApplicationFeatureHelper Service returned a null feature set");
return b.Features}Ddb(b){var h=String.format("{0}{1}",this.Oa.lb("WebServiceBase"),b);this.Oa.yu("ApplicationFeatureHelperHttpCachingEnabled")&&this.Oa.$("ApplicationFeatureHelperHttpCachingEnabled")&&(b=zb.JGd(this.Oa))&&0<b.length&&(this.ipd&&(b+="ucbf"),h=new Ma.QueryStringBuilder(h),h.Ie("afhskey",b),h=h.toString());return h}isFeatureEnabled(b,h){if(!this.Jrb&&!this.ULe&&!this.e8a)return this.Xlb;v.ULS.sendTraceTag(42513091,3004,50,"ApplicationFeatureHelper.IsFeatureEnabled: Call made to check if feature: {0} is enabled.",
b);if("ConnectedServices"===b){var r=this.Jrb?this.nyg.qea("ControllerConnectedServicesEnabled"):this.Xlb;const ba=this.ULe?this.c5g.getSettings().then(ta=>2!==ta.cI,()=>h):this.Xlb;return r.then(ta=>ta?ba:this.B8e)}r=null;r=this.Jrb?this.nyg.isFeatureEnabled(b):this.Xlb;let z=null;z=this.e8a?this.Mcm(b,h):this.Xlb;let R=null;R=this.ULe?this.c5g.isFeatureEnabled(b):this.Xlb;return r.then(ba=>ba?R.then(ta=>ta?z:this.B8e):this.B8e).then(ba=>{this.Cmi(b,ba,!0);return ba},()=>{this.Cmi(b,h,!1);return h})}Cmi(b,
h,r){v.ULS.sendTraceTag(526713106,3004,50,"FeatureName={0}, IsEnabled={1}, IsSuccess={2}",b,h,r)}getFeatureTier(b,h){if(!this.e8a)return new Promise(r=>{r(2)});v.ULS.sendTraceTag(42804871,3004,50,"ApplicationFeatureHelper.GetFeatureTier: Call made to get Feature's Tier.",b);return this.Kcb.then(r=>this.EId(b,r,h),()=>h)}isFreemiumUpsellEnabled(){return this.Ldd&&this.Uue&&!this.tpc}launchUpsellExperience(b,h=null){v.ULS.sendTraceTag(594564814,3004,50,String.format("ApplicationFeatureHelper_LaunchUpsellExperience: Launching upsell experience for experienceId: {0}",
b));var r=xa.a.iF();r&&(r.set("experienceId",b),h&&r.set("campaignId",h));Ca.Health.instance.recordKpiUsage("AFHCLaunchUpsellSuccess",1,"waclicensing",r);if(r=Sa.a.instance.Pa("Common.IInProductMessagingUIManager")){const z=Object(u.a)(this,this.HSl,"handleDimeTaskComplete");r.qki(b,z,h)}else v.ULS.sendTraceTag(594367561,3004,15,"InProductMessaging was not initialized"),Ca.Health.instance.recordKpiFailure("AFHCLaunchUpsellSuccess","InProductMessagingNotInitialized",!1,!0,null),this.ga.Xb(ab.a.UDd,
2,{["experience"]:b})}lva(b,h){if(!this.e8a)return null;if(!b||!h)return v.ULS.sendTraceTag(594564813,3004,10,"ApplicationFeatureHelper_RegisterFeatureStateChangeCallback: Invalid input."),null;const r=pa.a.create().toString();this.Jcb.xb(b)||this.Jcb.Z(b,new qa.a(ka.a.Rj()));this.Jcb.J(b).add(r,h);v.ULS.sendTraceTag(594564812,3004,50,String.format("ApplicationFeatureHelper_RegisterFeatureStateChangeCallback: registered callback {0} for feature {1}",r,b));return r}gcc(b,h){this.e8a&&(b&&this.Jcb.xb(b)?
h&&pa.a.Rd(h)?this.Jcb.J(b).xb(h)?(v.ULS.sendTraceTag(594564808,3004,50,String.format("ApplicationFeatureHelper_RemoveFeatureStateChangeCallback: Removing callback {0} for feature {1}",h,b)),this.Jcb.J(b).remove(h)):v.ULS.sendTraceTag(594564809,3004,15,String.format("ApplicationFeatureHelper_RemoveFeatureStateChangeCallback: callbackId {0} not registered for feature {1} ",h,b)):v.ULS.sendTraceTag(594564810,3004,10,String.format("ApplicationFeatureHelper_RemoveFeatureStateChangeCallback: invalid callbackId {0} for feature {1}",
h,b)):v.ULS.sendTraceTag(594564811,3004,10,String.format("ApplicationFeatureHelper_RemoveFeatureStateChangeCallback: invalid or non registered featureName {0}",b)))}EId(b,h,r){return this.ipd?b in h?h[b].LicenseTier:r:b in h?this.a3m(h[b],r):r}a3m(b,h){switch(b.toLowerCase()){case "unknown":return 0;case "basic":return 1;case "premium":return 2;default:return h}}HSl(){v.ULS.sendTraceTag(594367560,3004,50,"ApplicationFeatureHelper_HandleDimeTaskComplete");this.Kcb.then(b=>{this.xLi(b)}).catch(()=>
{this.xLi({})})}xLi(b){v.ULS.sendTraceTag(594051087,3004,50,"ApplicationFeatureHelper_RefreshLicensingAndNotifyUpdatedFeatures");const h=this.T6f(0,!0);h.then(r=>{this.Kcb=h;Na.a.count(r)>Na.a.count(b)?Ca.Health.instance.recordKpiSuccess("AFHCLaunchUpsellSuccess",null):Ca.Health.instance.recordKpiFailure("AFHCLaunchUpsellSuccess","FeatureCountNotIncreased",!1,!0,null);for(let z of this.Jcb.keys)if(z in r){const R=this.EId(z,r,0);z in b?this.EId(z,b,0)!==R&&this.nEf(z,!0,R):this.nEf(z,!0,R)}else z in
b&&this.nEf(z,!1,this.EId(z,b,0))}).catch(r=>{Ca.Health.instance.recordKpiFailure("AFHCLaunchUpsellSuccess","LicensingRefreshFailed",!1,!0,null);v.ULS.sendTraceTag(594051086,3004,10,JSON.stringify(r))})}nEf(b,h,r){v.ULS.sendTraceTag(594051085,3004,50,"ApplicationFeatureHelper_NotifyFeatureStateChanged: Notify feature state changed callbacks for feature {0}, {1}, {2}",b,h,r);h=new Xa(b,h,r);r=this.Jcb.J(b);for(let z of r)try{z.value(h)}catch(R){v.ULS.sendTraceTag(594051084,3004,10,String.format("ApplicationFeatureHelper_NotifyFeatureStateChanged: Exception when calling registered callback: feature: {0} callbackId: {1}, exception {2}",
b,z.key,R.message))}}Lcm(b,h){if(this.e8a){const r=this.QOg.contains(b);let z=!0,R="",ba=!1;return this.Kcb.then(ta=>{b in ta?(ta=ta[b],R=Ra[ta.FeatureState],z=1!==ta.FeatureState):z=!r;this.Qmi(b,r,R,ba,h,z);return z},()=>{ba=!0;r&&(z=h);this.Qmi(b,r,R,ba,h,z);return z})}return this.Xlb}Qmi(b,h,r,z,R,ba){v.ULS.sendTraceTag(557389507,3004,50,"featureName : {0}, isLicenseControlledFeature={1}, encounteredError = {2}, featureData={3}, fallbackValue={4}, isAllowed={5}",b,h,z,r,R,ba)}Mcm(b,h){if(this.ipd)return this.Lcm(b,
h);if(this.e8a){if(this.QOg.contains(b))return this.Kcb.then(r=>b in r,()=>h);v.ULS.sendTraceTag(590385821,3004,50,"ApplicationFeatureHelper_IsFeatureAllowedByUserLicense: Feature '{0}' requested while not in the licensed features set.",b)}return this.Xlb}q9m(b){try{b&&"Date"in b&&(this.Aqa=new Date(b.Date),v.ULS.sendTraceTag(578863817,3004,50,"ProcessApplicationFeatureHelperResponseHeaders Date {0}",this.Aqa.toString()))}catch(h){v.ULS.sendTraceTag(578863818,3004,10,"ProcessApplicationFeatureHelperResponseHeaders Exception {0}",
h)}}l8i(){if(void 0!==this.f8a&&null!==this.f8a){const b=this.f8a.oi;this.f8a.stop();return b}return null}static JGd(b){try{if(X.a.I$d){const h=b.lb("UserDataSignature").split(".");if(1<h.length){const r=window.self.atob(h[1]),z=JSON.parse(r).LocalStorageKey;if(void 0!==z&&null!==z&&0<z.length)return z}}}catch(h){v.ULS.sendTraceTag(578863816,3004,10,"GetLocalStorageCacheKey exception {0}",h.toString())}return null}}Object(n.a)(zb,"ApplicationFeatureHelper",null,[665]);var Ua=d(76);class Ab{constructor(b,
h){this.PolicySettings=null;this.ExpirationTime=0;this.PolicySettings=b.PolicySettings;b=new Date;b.setMinutes(b.getMinutes()+h);this.ExpirationTime=b.getTime()}}Object(n.a)(Ab,"CloudPolicySettingsCacheData",null,[]);var mb=d(1360),Rb=d(378),hc=d(238);class Hb{static M5i(){return t.AFrameworkApplication.K.$("SideCarIsEnabled")?Hb.C5d&&Hb.ENc?new Promise(b=>{b(!0)}):new Promise((b,h)=>{Hb.C5d=hc.a.create(t.AFrameworkApplication.K.lb("SideCarUrl"));Rb.a.XS(Hb.C5d);Hb.C5d.VV((r,z)=>{(Hb.ENc=z.succeeded)?
b(z.succeeded):h(z.succeeded)})}):new Promise(b=>{b(!1)})}}Hb.ENc=!1;Hb.C5d=null;Object(n.a)(Hb,"SideCarLoader",null,[]);class Ta{constructor(){this.ControllerConnectedServicesFeatureNames=this.PolicySettings=null}}Object(n.a)(Ta,"CloudPolicySettingsData",null,[]);class Aa{constructor(b,h){this.Tje=0;this.pvd=null;this.Ioc=new bb(b,h);this.Oa=b;h=b.lb("HostAuthType");this.Jrb=b.$("OcpsIsEnabled")&&b.$("IsO365CommercialHost")&&!(void 0===h||null===h)&&"aad"===h.toLowerCase();this.ESg=y.b(b.lb("OcpsDefaultSettings")||
"{}");this.brc=this.JGd();h=this.Oa.yu("ServicesControlsMicrosoftControllerServicesList")?this.Oa.KB("ServicesControlsMicrosoftControllerServicesList")||[]:[];this.Q8c=new Ka.a;for(let r=0;r<h.length;r++)this.Q8c.add(h[r]);this.Jrb&&!b.$("IsAnonymousUser")&&b.$("SideCarIsEnabled")?this.pvd=this.sco():this.pvd=this.S6f(this.Jrb,this.Ddb("/afhs/CloudPolicySettings.ashx"),Object(u.a)(this,this.u2m,"parseCloudPolicySettingsResponse"));this.pvd.then(()=>null).catch(r=>{v.ULS.sendTraceTag(50622685,3004,
10,JSON.stringify(r))})}qea(b,h=!0){if(!this.Jrb){const ba=this;return new Promise(ta=>{ta(ba.XIc(b))})}let r=this,z=this;const R=this.pvd.then(ba=>{try{let ta=null;ba.PolicySettings&&"unknown"in ba.PolicySettings&&(ta=ba.PolicySettings.unknown);if(ta){if(b in ta&&void 0!==ta[b]&&null!==ta[b])return new Promise(ub=>{ub("0"!==ta[b])});const Wa=b.toLowerCase();if(Wa in ta&&void 0!==ta[Wa]&&null!==ta[Wa])return new Promise(ub=>{ub("0"!==ta[Wa])});v.ULS.sendTraceTag(51512667,3004,50,"Policy"+b+" not found, using default");
return new Promise(ub=>{ub(r.XIc(b))})}return new Promise(Wa=>{Wa(r.XIc(b))})}catch(ta){return v.ULS.sendTraceTag(50622686,3004,10,"Failed to get "+b+" policy value. Error Message: {0}",ta.message),r.handleError(ta.toString(),h,r.XIc(b))}},ba=>z.handleError(ba,h,z.XIc(b)));R.then(ba=>{v.ULS.sendTraceTag(50651667,3004,50,"CloudPolicySettingsHelper.GetBooleanPolicySetting: policy: {0}, value: {1}",b,ba);return null});return R}isFeatureEnabled(b,h=!0){if(this.Oa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseApplicationFeatureHelperAPIForFeedbackAndSurvey",
!1))return this.Ocm(b,h);let r=new Promise(R=>{R(!0)}),z="";this.Q8c.contains(b)&&(z="ControllerConnectedServicesEnabled",r=this.qea(z,h));r.then(R=>{v.ULS.sendTraceTag(50651668,3004,50,"CloudPolicySettingsHelper.IsFeatureEnabled: Feature: {0}, enabled or not: {1}, by policy: {2}",b,R,z);return null});return r}Ocm(b,h=!0){let r=new Promise(R=>{R(!0)}),z="";"mso_sendASmile"===b?z="Enabled":"Survey"===b||"FloodgateSurvey"===b?z="SurveyEnabled":this.Q8c.contains(b)&&(z="ControllerConnectedServicesEnabled");
""!==z&&(r=this.qea(z,h));r.then(R=>{v.ULS.sendTraceTag(558187080,3004,50,"CloudPolicySettingsHelper.IsFeatureEnabledV2: Feature: {0}, enabled or not: {1}, by policy: {2}",b,R,z);return null});return r}handleError(b,h,r){return h?new Promise(z=>{z(r)}):new Promise((z,R)=>{R(b)})}S6f(b,h,r){if(!b)return Promise.resolve(new Ta);let z=!1,R=null;Ca.Health.instance.recordKpiUsage("GetCloudPolicySettings",1,"jpittsdirects",null);let ba=this.n_e("GetCloudPolicySettings");return(new Promise((ta,Wa)=>{if(void 0!==
this.brc&&null!==this.brc&&0<this.brc.length){const ub=this.Xbo();if(void 0!==ub&&null!==ub){z=!0;ta(ub);return}}this.Ioc.a0e(h,r,1,null,Object(u.a)(this,this.C9m,"processCloudPolicySettingsResponseHeaders"),["CheckIn-Interval"],this.Oa.rc("CloudPolicySettingsRequestQueueTimeout",15E3),this.Oa.rc("CloudPolicySettingsRequestSentTimeout",3E4)).then(ub=>{v.ULS.sendTraceTag(51662933,3004,50,"Retrieved CloudPolicySettingsData from OCPS");this.bdo(ub);ta(ub);return ub},ub=>{Wa(ub);return null})})).then(ta=>
{({hx:ba,returnValue:R}=this.e$d(ba));var Wa=xa.a.iF();Wa&&Wa.set("FromCache",z.toString());Wa=Object.assign(new eb.a,{durationMs:R,extendedProperties:Wa});Ca.Health.instance.recordKpiSuccess("GetCloudPolicySettings",Wa);return ta})}sco(){return Hb.M5i().then(()=>{v.ULS.sendTraceTag(593282845,3004,50,"CloudPolicySettingsHelper - Retrieving CloudPolicySettingsData Promise from Sidecar");return sidecar.cloudPolicy.GetCloudPolicySettingsData()})}Ddb(b){return String.format("{0}{1}",this.Oa.lb("WebServiceBase"),
b)}u2m(b){let h=null;({Fv:h}=y.d(b));v.ULS.sendTraceTag(50622687,3004,h?50:10,"ParseCloudPolicySettingsResponse: fetched CloudPolicySettingsData from {0}",b);return h}C9m(b){try{if(void 0!==b&&null!==b&&"CheckIn-Interval"in b){const h=parseInt(b["CheckIn-Interval"]);void 0!==h&&null!==h&&0<h&&(this.Tje=h)}}catch(h){v.ULS.sendTraceTag(51662934,3004,10,"ProcessCloudPolicySettingsResponseHeaders Exception {0}",h)}}XIc(b){return b in this.ESg?"0"!==this.ESg[b]:!0}Xbo(){try{const b=mb.a.instance.getItem(this.brc);
if(void 0===b||null===b)return v.ULS.sendTraceTag(51662936,3004,50,"TryGetCloudPolicySettingsDataFromCache data from LocalStorage is null"),null;v.ULS.sendTraceTag(51662937,3004,50,"TryGetCloudPolicySettingsDataFromCache retrieved data {0} from LocalStorage",b);const h=JSON.parse(b);if(void 0===h||null===h)return v.ULS.sendTraceTag(51662938,3004,15,"TryGetCloudPolicySettingsDataFromCache data from LocalStorage is null after parsing"),null;if(void 0===h.ExpirationTime||null===h.ExpirationTime)return v.ULS.sendTraceTag(51662939,
3004,15,"TryGetCloudPolicySettingsDataFromCache ExpirationTime from LocalStorage is null after parsing"),null;if((new Date(h.ExpirationTime)).getTime()<Date.now())return v.ULS.sendTraceTag(51662940,3004,50,"TryGetCloudPolicySettingsDataFromCache Cache is expired"),null;const r=new Ta;r.PolicySettings=h.PolicySettings;r.ControllerConnectedServicesFeatureNames=new Ua.a;this.Oa.yu("ServicesControlsMicrosoftControllerServicesList")&&this.Oa.KB("ServicesControlsMicrosoftControllerServicesList");for(let z of this.Q8c)r.ControllerConnectedServicesFeatureNames.add(z);
v.ULS.sendTraceTag(51662941,3004,50,"TryGetCloudPolicySettingsDataFromCache data from LocalStorage retrieved");return r}catch(b){return v.ULS.sendTraceTag(51662942,3004,10,"TryGetCloudPolicySettingsDataFromCache exception {0}",b.toString()),null}}bdo(b){try{if(void 0===b||null===b||void 0===b.PolicySettings||null===b.PolicySettings)v.ULS.sendTraceTag(51662944,3004,15,"TrySetCloudPolicySettingsDataIntoCache data/PolicySettings is null");else if(0>=this.Tje)v.ULS.sendTraceTag(51662945,3004,15,"TrySetCloudPolicySettingsDataIntoCache _checkInInterval is Invalid");
else{const h=new Ab(b,this.Tje),r=JSON.stringify(h);v.ULS.sendTraceTag(51662946,3004,50,"TrySetCloudPolicySettingsDataIntoCache data to cache {0}",r);mb.a.instance.setItem(this.brc,r);v.ULS.sendTraceTag(51662947,3004,50,"TrySetCloudPolicySettingsDataIntoCache set data to cache")}}catch(h){v.ULS.sendTraceTag(51662976,3004,10,"TrySetCloudPolicySettingsDataIntoCache exception {0}",h.toString())}}JGd(){const b=zb.JGd(this.Oa);return b&&0<b.length?"OCPS"+b:null}n_e(b){const h=Sa.a.instance.Pa("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder");
return void 0!==h&&null!==h?h.hg("WebServiceCall",b):null}e$d(b){if(void 0!==b&&null!==b){const h=b.oi;b.stop();return{returnValue:h,hx:null}}return{returnValue:null,hx:b}}}Object(n.a)(Aa,"CloudPolicySettingsHelper",null,[662]);class ma{constructor(){this.OBh=this.Mjj=this.cI=0;this.PBh=this.Njj=this.bxb="";this.$He=this.JQa=2}clone(){const b=new ma;b.cI=this.cI;b.Mjj=this.Mjj;b.OBh=this.OBh;b.bxb=this.bxb;b.Njj=this.Njj;b.PBh=this.PBh;b.JQa=this.JQa;b.$He=this.src;return b}get src(){return this.$He}serialize(b=
null){const h={};if(!b||b.contains(ma.UFb))h[ma.UFb]=this.cI;if(!b||b.contains(ma.aTc))h[ma.aTc]=this.bxb;if(!b||b.contains(ma.bTc))h[ma.bTc]=this.JQa;return JSON.stringify(h)}static create(b,h=null){const r=new ma;r.$He=b;void 0!==h&&null!==h&&(ma.UFb in h&&(r.cI=h[ma.UFb]),ma.aTc in h&&(r.bxb=h[ma.aTc]),ma.bTc in h&&(r.JQa=h[ma.bTc]));return r}static deserialize(b,h){try{const r=JSON.parse(b);if(void 0!==r&&null!==r)return ma.create(h,r);v.ULS.sendTraceTag(50860946,306,10,"UserPrivacySettings Deserialize: Unable to convert {0} to dict",
b);throw Error.argument("settingsData");}catch(r){throw v.ULS.sendTraceTag(50860947,306,10,"UserPrivacySettings Deserialize Exception = {0}",r.toString()),r;}}}ma.UFb="CCS";ma.aTc="CCSTime";ma.bTc="OfficePrivacyRoamedNoticeShown";Object(n.a)(ma,"UserPrivacySettings",null,[]);var Ga=d(141);class Fa{constructor(b,h){if(void 0===b||null===b||void 0===h||null===h)throw Error.argumentNull("appSettingsManager/clientRequestManager");this.Oa=b;this.rg=h;this.QGe=this.Md=null}Ddb(b){var h=String.format("{0}RoamingServiceHandler.ashx?action=",
this.Oa.appSettings.RoamingServiceHandlerWebServiceBase||"");h=new Sys.StringBuilder(h);h.append(b);h.append("&");h.append(t.AFrameworkApplication.xm);return h.toString()}executeRequest(b,h,r,z=null){return this.rg.XWb(b,h,z,null,r,"33",!1,null,6E4)}saveSettings(b){return new Promise((h,r)=>{try{if(void 0===this.Md||null===this.Md||void 0===b||null===b)v.ULS.sendTraceTag(51258443,3004,15,"SaveUserPrivacySettings: Can't determine setting changes to save"),r("Can't determine setting changes to save");
else{var z=this.Md.cI!==b.cI;if(2===this.Md.src&&z)this.dCn(b),h(!0);else{var R=this.GGn(b);if(void 0===R||null===R||!R.length)v.ULS.sendTraceTag(50917389,3004,15,"SaveUserPrivacySettings: returning since nothing changed"),r("No changes to save");else if(1===this.Md.src)h(this.lej(R));else if(0===this.Md.src){v.ULS.sendTraceTag(51258444,3004,50,"UserPrivacySettingsHelper: SaveSettings to Roaming {0}",R);const ba=this.executeRequest(this.Ddb("saveUserPrivacySettings"),2,"SaveUserPrivacySettingsRequest",
R);ba.continueWith(()=>{if(ba.ho||ba.Ji)v.ULS.sendTraceTag(50860929,3004,10,"SaveUserPrivacySettings: Roaming Request Cancelled/Failed"),h(!1);else{var ta=ba.result;void 0!==ta.args&&null!==ta.args&&void 0!==ta.args.data&&null!==ta.args.data&&ta.args.data.wf===Ja.a.xD?(v.ULS.sendTraceTag(51258445,3004,50,"SaveUserPrivacySettings: Roaming Request Succeeded"),h(!0)):(v.ULS.sendTraceTag(51258446,3004,10,"SaveUserPrivacySettings: Roaming Request Failed"),h(!1))}})}}}}catch(ba){v.ULS.sendTraceTag(50860930,
3004,10,"SaveUserPrivacySettings: Exception = {0}",ba.toString()),h(!1)}})}GGn(b){if(void 0===this.Md||null===this.Md||void 0===b||null===b)throw Error.invalidOperation("User Privacy settings have not been initialized");const h=new Ua.a;0===b.src?(this.Md.cI!==b.cI&&(h.add(ma.UFb),h.add(ma.aTc)),this.Md.JQa!==b.JQa&&h.add(ma.bTc)):1===b.src&&this.Md.cI!==b.cI&&h.add(ma.UFb);return h.count?b.serialize(h):(v.ULS.sendTraceTag(50860931,3004,50,"SaveUserPrivacySettings: returning since nothing changed"),
null)}getSettings(){if(!this.QGe){const b=this;this.QGe=new Promise(h=>{try{b.Md?h(b.Md.clone()):b.mco().then(r=>{b.Md=r;h(b.Md.clone());return null},()=>{b.kco().then(r=>{b.Md=r;h(b.Md.clone());return null},()=>{b.lco().then(r=>{b.Md=r;h(b.Md.clone());return null},()=>{v.ULS.sendTraceTag(50967430,3004,10,"UserPrivacySettings TryGetSettingsFromQueryParams returned an error)");b.Md=new ma;h(b.Md.clone());return null});return null});return null})}catch(r){v.ULS.sendTraceTag(50860932,3004,10,"UserPrivacySettings GetSettings: Exception = {0}",
r.toString()),b.Md=new ma,h(b.Md.clone())}})}return this.QGe}mco(){return new Promise((b,h)=>{try{const z=-1!==window.location.href.indexOf("&wd_pn=2");if(this.Oa.$("PrivacyDialogShouldCheckRoaming")||z){var r=this.executeRequest(this.Ddb("getUserPrivacySettings"),1,"GetUserPrivacySettingsRequest");r.continueWith(()=>{try{if(r.ho||r.Ji)v.ULS.sendTraceTag(50860934,3004,10,"UserPrivacySettings TryGetSettingsFromRoaming: Request failure");else{const R=r.result;if(R&&R.args&&R.args.data)if(R.args.data.wf!==
Ja.a.xD)v.ULS.sendTraceTag(50860936,3004,10,"UserPrivacySettings TryGetSettingsFromRoaming: Received error response {0}",R.args.data.wf);else{if(R.args.data.Ge){b(Fa.parse(R.args.data.Ge,0));v.ULS.sendTraceTag(51258447,3004,50,"UserPrivacySettings TryGetSettingsFromRoaming: Success, Settings {0}",R.args.data.Ge);return}v.ULS.sendTraceTag(50860937,3004,10,"UserPrivacySettings TryGetSettingsFromRoaming: ResponseData is null")}else v.ULS.sendTraceTag(50860935,3004,10,"UserPrivacySettings TryGetSettingsFromRoaming: Data is null");
h("UserPrivacySettings TryGetSettingsFromRoaming Request Faillure")}}catch(R){v.ULS.sendTraceTag(50860938,3004,10,"UserPrivacySettings TryGetSettingsFromRoaming Exception handling request {0}",R.toString()),h("UserPrivacySettings TryGetSettingsFromRoaming Request Exception")}})}else v.ULS.sendTraceTag(50860933,3004,50,"UserPrivacySettings TryGetSettingsFromRoaming: Roaming should not be used"),h("Roaming should not be used")}catch(z){v.ULS.sendTraceTag(50860939,3004,10,"TryGetSettingsFromRoaming Exception = {0}",
z.toString()),h("UserPrivacySettings TryGetSettingsFromRoaming Exception")}})}kco(){return new Promise((b,h)=>{try{const r=Ga.a.get("WacUPToggleState");let z=null;void 0!==r&&null!==r&&0<r.length&&(z=decodeURIComponent(r));if(void 0!==z&&null!==z&&0<z.length){const R=Fa.parse(z,1);v.ULS.sendTraceTag(51258448,3004,50,"TryGetSettingsFromCookie: UserPrivacySettings retrieved from cookie {0}",R.toString());b(R)}else{const R=ma.create(1),ba=new Ua.a;ba.add(ma.UFb);const ta=R.serialize(ba);this.lej(ta)?
(v.ULS.sendTraceTag(51258449,3004,50,"TryGetSettingsFromCookie: UserPrivacySettings initialized and retrieved from cookie {0}",ta),b(R)):(v.ULS.sendTraceTag(51258450,3004,15,"TryGetSettingsFromCookie: Failure initializing cookie with settings {0}",ta),h("UserPrivacySettings TryGetSettingsFromCookie Failure in TrySaveSettingsToCookie"))}}catch(r){v.ULS.sendTraceTag(50860941,3004,10,"TryGetSettingsFromCookie from Cookie Exception = {0}",r.toString()),h("UserPrivacySettings TryGetSettingsFromCookie Eception")}})}lco(){return new Promise(b=>
{try{var h=-1!==window.location.href.indexOf("&wdccsoff=1");let r=ma.create(2);h?(r.cI=2,t.AFrameworkApplication.Tzh(),v.ULS.sendTraceTag(51258451,3004,50,"TryGetSettingsFromQueryParams: Retrieved from query param {0}",r.toString())):(r.cI=1,v.ULS.sendTraceTag(51258452,3004,50,"TryGetSettingsFromQueryParams: Initialized with query param as data source for {0}",r.toString()));b(r)}catch(r){v.ULS.sendTraceTag(50967431,3004,50,"TryGetSettingsFromCookie from Query Params Exception = {0}",r.toString()),
h=ma.create(2),h.cI=1,b(h)}})}dCn(b){v.ULS.sendTraceTag(51258453,3004,50,"UserPrivacySettingsHelper: SaveSettingsToQueryParam");2===b.cI?t.AFrameworkApplication.Tzh():t.AFrameworkApplication.q1k();v.ULS.sendTraceTag(51258454,3004,50,"SaveSettingsToQueryParam saved settings = {0}",b)}lej(b){try{v.ULS.sendTraceTag(51258455,3004,50,"UserPrivacySettingsHelper: TrySaveSettingsToCookie Saving settings {0}",b);const h=this.Oa.lb("PrivacyCookieDomain")||"";if(!h||!h.length)throw Error.invalidOperation("PrivacyCookieDomain is null or empty");
v.ULS.sendTraceTag(51258456,3004,50,"SaveUserPrivacySettings to Cookie {0}",b);return Ga.a.V0i("WacUPToggleState",b,Ga.a.zNa,h)}catch(h){return v.ULS.sendTraceTag(50860942,3004,50,"SaveUserPrivacySettings to Cookie Exception = {0}",h.toString()),!1}}isFeatureEnabled(b){return this.getSettings().then(h=>{const r=this.Oa.yu("ServicesControlsMicrosoftControllerServicesList")?this.Oa.KB("ServicesControlsMicrosoftControllerServicesList"):[],z=new Ka.a;for(let R=0;R<r.length;R++)z.add(r[R]);return z.contains(b)?
2!==h.cI:!0},()=>{v.ULS.sendTraceTag(50860945,3004,10,"Failed to get privacy setting for feature {0}",b);return!0})}static parse(b,h){try{return v.ULS.sendTraceTag(50860943,3004,50,"Parsing user privacy settings {0} from {1}",b,h),ma.deserialize(b,h)}catch(r){throw v.ULS.sendTraceTag(50860944,3004,10,"GetUserPrivacySettings Exception = {0}",r.toString()),r;}}}Object(n.a)(Fa,"UserPrivacySettingsHelper",null,[663]);class ib{constructor(){this.W=null}get name(){return"Common.App.ApplicationFeatureHelper.ApplicationFeatureHelperPackage"}yc(b){this.W=
b;this.W.register(662,"Common.App.ApplicationFeatureHelper.ICloudPolicySettingsHelper").singleInstance().Yd(()=>new Aa(t.AFrameworkApplication.K,t.AFrameworkApplication.Xe));this.W.register(663,"Common.App.ApplicationFeatureHelper.IUserPrivacySettingsHelper").singleInstance().Yd(()=>new Fa(t.AFrameworkApplication.K,t.AFrameworkApplication.Xe));this.W.register(664,"Common.App.ApplicationFeatureHelper.IAlternateAuthHelper").singleInstance().Yd(()=>new va(t.AFrameworkApplication.K,t.AFrameworkApplication.Xe));
this.W.register(665,"Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").singleInstance().Yd(()=>new zb(t.AFrameworkApplication.K,t.AFrameworkApplication.Xe,this.W.resolve("Common.App.ApplicationFeatureHelper.ICloudPolicySettingsHelper"),this.W.resolve("Common.App.ApplicationFeatureHelper.IUserPrivacySettingsHelper"),t.AFrameworkApplication.ya))}init(){t.AFrameworkApplication.K.zq(()=>{const b=this.W.resolve("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper");t.AFrameworkApplication.K.$("LicensingIsEnabled")&&
(b.isFeatureEnabled("LicensingTestFeature",!1).then(h=>{v.ULS.sendTraceTag(42513092,3004,50,"ApplicationFeatureHelperPackage.Init: LicensingTestFeature returned IsFeatureEnabled as {0}. IsAnonymousUser : {1}.",h,t.AFrameworkApplication.K.lb("IsAnonymousUser"));return null}),b.getFeatureTier("LicensingTestFeature",0).then(h=>{v.ULS.sendTraceTag(42804872,3004,50,"ApplicationFeatureHelperPackage.Init: LicensingTestFeature returned GetFeatureTier as {0}. IsAnonymousUser : {1}.",h,t.AFrameworkApplication.K.lb("IsAnonymousUser"));
return null}));this.W.resolve("Common.App.ApplicationFeatureHelper.IAlternateAuthHelper");this.t7n()})}dispose(){}t7n(){try{t.AFrameworkApplication.K.$("SideCarIsEnabled")&&Hb.M5i().then(b=>{v.ULS.sendTraceTag(594057429,3004,50,"Sidecar Loader attempted to load Sidecar.  SideCarIsAvailable:{0}",b);return b})}catch(b){}}static main(){O.a.instance.Oc(new ib)}}Object(n.a)(ib,"ApplicationFeatureHelperPackage",null,[1,2]);var ob=d(183);class fb{OGd(b,h){let r;const z=[];for(;r=h.exec(b);){const R=r.index;
z.push(new ob.a(R,R+r[0].length))}return z}isEndPuncSpecialCase(b){const h=this.OGd(b,fb.c0n);for(const r of h)if(r.end===b.length)return!0;return!1}HFc(b){for(const h of fb.y5k){const r=this.OGd(b,h);if(0<r.length&&!r[0].begin)return r[0].end-1}return 0}findBeginBoundary(b,h,r){var z=b.substring(r,h);b=this.OGd(z,fb.GDh);for(h=b.length-1;0<=h;h--){const R=z.substring(0,b[h].end);if(!this.isEndPuncSpecialCase(R))return z=z.substring(b[h].begin,z.length),r+b[h].end+this.HFc(z)}return r}findEndBoundary(b,
h,r){var z=b.substring(h,r);b=this.OGd(z,fb.GDh);for(r=0;r<b.length;r++){const R=z.substring(0,b[r].end);if(!this.isEndPuncSpecialCase(R))return z=z.substring(b[r].begin,z.length),h+b[r].end+this.HFc(z)}return-1}}fb.c8e="([?!.\u0589\u06d4\u0701\u0702\u0964\u0965\u1362\u166e\u1803\u1809\u2cf9\u2cfe\u3002\ua4ff\ua60e\ua6f3\ufe12\ufe52\uff0e\uff61]([)]}\u0f3b\u0f3d\u2046\u3009\u300b\u300d\u300f\u3011\u3015\u3017\u3019\u301b\u301e\u301f\uff09\uff3d\uff5d\uff60\uff63]|[\u2639\u263a\u263b]|[\u00bb\u2019\u201d\u203a\"']|[ \u00a0\u2000-\u200a\u202f\u205f\u3000\t])*[\u2028\u2029\n\r])";
fb.d8e="([?!.\u0589\u06d4\u0701\u0702\u0964\u0965\u1362\u166e\u1803\u1809\u2cf9\u2cfe\u3002\ua4ff\ua60e\ua6f3\ufe12\ufe52\uff0e\uff61]([)]}\u0f3b\u0f3d\u2046\u3009\u300b\u300d\u300f\u3011\u3015\u3017\u3019\u301b\u301e\u301f\uff09\uff3d\uff5d\uff60\uff63]|[\u2639\u263a\u263b])*([ \u00a0\u2000-\u200a\u202f\u205f\u3000\t])+)";fb.e8e="([\u3002\uff61]([)]}\u0f3b\u0f3d\u2046\u3009\u300b\u300d\u300f\u3011\u3015\u3017\u3019\u301b\u301e\u301f\uff09\uff3d\uff5d\uff60\uff63]|[\u2639\u263a\u263b])*)";fb.y5k=
[new RegExp(fb.c8e,"ig"),new RegExp(fb.d8e,"ig"),new RegExp(fb.e8e,"ig")];fb.G1f="[.\u3002\ufe52\uff0e\uff61]{2,6}|[.]([ ][.]){1,5}";fb.J1f="(((L?X{1,3}|X[LC]|L)?(V?I{1,3}|I[VX]|V))|(L?X{1,3}|X[LC]|L)|((l?x{1,3}|x[lc]|l)?(v?i{1,3}|i[vx]|v))|(l?x{1,3}|x[lc]|l))[.]";fb.I1f="((([\uff2c]?[\uff38]{1,3}|[\uff38][\uff2c\uff23]|[\uff2c])?([\uff36]?[\uff29]{1,3}|[\uff29][\uff36\uff38]|[\uff36]))|([\uff2c]?[\uff38]{1,3}|[\uff38][\uff2c\uff23]|[\uff2c])|(([\uff4c]?[\uff58]{1,3}|[\uff58][\uff4c\uff43]|[\uff4c])?([\uff56]?[\uff49]{1,3}|[\uff49][\uff56\uff58]|[\uff56]))|([\uff4c]?[\uff58]{1,3}|[\uff58][\uff4c\uff43]|[\uff4c]))[.\ufe52\uff0e]";
fb.H1f=fb.J1f+"|"+fb.I1f;fb.K1f="([0-9]{1,4}[.]|[\uff10-\uff19]{1,4}[.\ufe52\uff0e])";fb.L1f="([0-9]+(([ao\u00aa\u00ba\u1d43\u1d52])|((er)[ao]?)|(([\u1d49][\u02b3])[\u1d43\u1d52]?)|([mdtvn][ao])|([\u1d50\u1d48\u1d57\u1d5b\u207f][\u1d43\u02b3]))[.]|[A-Za-z\u00c0\u00c4\u00c8\u00c9\u00d4\u00d6\u00dc\u00df\u00e0\u00e4\u00e8\u00e9\u00f4\u00f6\u00fc]+[.]((NR)|(Nr)|(nr))[.]|[A-Za-z\u00c0\u00c4\u00c8\u00c9\u00d4\u00d6\u00dc\u00df\u00e0\u00e4\u00e8\u00e9\u00f4\u00f6\u00fc]+((STR)|(str))[.])";fb.M1f="(([A-Za-z\u00aa\u00b5\u00ba\u00c0-\u00d0\u00d1-\u00d6\u00d8-\u00f6\u00f8-\u01ba\u01bc-\u01bf\u01c4-\u0293\u0295-\u0373\u0376\u0377\u037b\u037c\u037d\u0386\u0388\u0389\u038a\u038c\u038e-\u03a1\u03a3-\u03f5\u03f7-\u0481\u048a-\u0523\u0531-\u0556\u0561-\u0587\u10a0-\u10c5]|[\u01bb\u01c0-\u01c3\u0294\u05d0-\u05ea\u05f0\u05f1\u05f2\u0621-\u063f\u0641-\u064a\u066e\u066f-\u06d3\u0671\u06d5\u06ee\u06ef\u06fa\u06fb\u06fc\u06ff\u0904-\u0939\u093d\u0950\u0958-\u0961\u0972\u097b-\u097f\u0985-\u098c\u098f\u0990\u0993-\u09a8\u09aa-\u09b0\u09b2\u09b6-\u09b9\u09bd\u09ce\u09dc\u09dd\u09df\u09e0\u09e1\u09f0\u09f1\u0a05-\u0a0a\u0a0f\u0a10\u0a13-\u0a19\u0a1a-\u0a28\u0a2a-\u0a30\u0a32\u0a33\u0a35\u0a36\u0a38\u0a39\u0a59-\u0a5c\u0a5e\u0a72-\u0a74\u0a85-\u0a8d\u0a8f-\u0a91\u0a93-\u0aa8\u0aaa-\u0ab0\u0ab2\u0ab3\u0ab5-\u0ab9\u0abd\u0ad0\u0ae0\u0ae1\u0b05-\u0b0c\u0b0f\u0b10\u0b13-\u0b28\u0b2a-\u0b30\u0b32\u0b33\u0b35-\u0b39\u0b3d\u0b5c\u0b5d\u0b5f-\u0b61\u0b71\u0b83\u0b85-\u0b8a\u0b8e-\u0b90\u0b92-\u0b95\u0b99\u0b9a\u0b9c\u0b9e\u0b9f\u0ba3\u0ba4\u0ba8-\u0baa\u0bae-\u0bb9\u0bd0\u0c05-\u0c0c\u0c0e-\u0c10\u0c12-\u0c28\u0c2a-\u0c33\u0c35-\u0c39\u0c3d\u0c58\u0c59\u0c60\u0c61\u0c85-\u0c8c\u0c8e-\u0c90\u0c92-\u0ca8\u0caa-\u0cb3\u0cb5-\u0cb9\u0cbd\u0cde\u0ce0\u0ce1\u0cf1\u0cf2\u0d05-\u0d0c\u0d0e-\u0d10\u0d12-\u0d28\u0d2a-\u0d39\u0d3d\u0d60\u0d61\u0d7a-\u0d7f\u0d85-\u0d96\u0d9a-\u0db1\u0db3-\u0dbb\u0dbd\u0dc0-\u0dc6\u0e81\u0e82\u0e84\u0e87\u0e88\u0e8a\u0e8d\u0e94-\u0e97\u0e99-\u0e9f\u0ea1-\u0ea3\u0ea5\u0ea7\u0eaa\u0eab\u0ead-\u0eb0\u0eb2\u0eb3\u0ebd\u0ec0-\u0ec4\u0ec6\u0edc\u0edd\u0f00\u0f40-\u0f47\u0f49-\u0f6c\u0f88-\u0f8b\u1780-\u17b3\u17d7\u17dc\u1000-\u102a\u103f\u1050-\u1055\u105a-\u105d\u1061\u1065\u1066\u106e-\u1070\u1075-\u1081\u108e\u10d0-\u10fa\u1100-\u1159\u115f\u1160-\u11a2\u11a8-\u11f9\u1200-\u1248\u124a-\u124d\u1250-\u1256\u1258\u125a-\u125d\u1260-\u1288\u128a-\u128d\u1290-\u12b0\u12b2-\u12b5\u12b8-\u12be\u12c0\u12c2-\u12c5\u12c8-\u12d6\u12d8-\u1310\u1312-\u1315\u1318-\u135a\u1380-\u138f\u13a0-\u13f4\u1401-\u166c\u166f-\u1676\u1820-\u1877\u1880-\u18a8\u18aa\u3006\u303c\uac00-\ud7a3\uffa0-\uffbe\uffc2-\uffc7\uffca-\uffcf\uffd2-\uffd7\uffda-\uffdc]|[\u0e01-\u0e30\u0e32\u0e33\u0e40-\u0e45])[.])+|(([\u3041-\u3096\u309f\u30a1-\u30fa\u30ff\uf900-\ufa2d\ufa30-\ufa6a\ufa70-\ufad9\uff66-\uff9d])[.\ufe52\uff0e])+";
fb.N1f="([\uff21-\uff3a\uff41-\uff5a])[.\ufe52\uff0e]";fb.YWf="([ \u00a0\u2000-\u200a\u202f\u205f\u3000\t]|[\x00-\b\n-\u0019\u007f-\u009f\u2028-\u2029\u202f\u205f]|[!-#%-*,-/:-;?-@[-]_{}\u00a1\u00ab\u00ac\u00b7\u00bb\u00bf\u037e\u0387\u055a-\u055f\u0589-\u058a\u05be\u05c0\u05c3\u05c6\u05f3-\u05f4\u0609-\u060a\u060c-\u060d\u061b\u061e-\u061f\u066a-\u066d\u06d4\u0964-\u0965\u0970\u0df4\u0e4f\u0e5a-\u0e5b\u0f04-\u0f12\u0f3a-\u0f3d\u0f85\u0fd0-\u0fd4\u104a-\u104f\u10fb\u1361-\u1368\u166d-\u166e\u17d4-\u17d6\u17d8-\u17da\u1800-\u180a\u2010-\u2027\u2030-\u2043\u2045-\u2051\u2053-\u205e\u3001-\u3003\u3008-\u3011\u3014-\u301f\u3030\u303d\u30a0\u30fb\uff01-\uff03\uff05-\uff0a\uff0c-\uff0f\uff1a-\uff1b\uff1f-\uff20\uff3b-\uff3d\uff3f\uff5b\uff5d\uff5f-\uff65]|[$+<=>^`|~\u00a2\u00a3\u00a4\u00a5-\u00a9\u00ac\u00ae\u00af\u00b0\u00b1\u00b4\u00b6\u00b8\u00d7\u00f7\u02c2-\u02c5\u02d2-\u02df\u02e5-\u02eb\u02ed\u02ef-\u02ff\u0375\u0384\u0385\u03f6\u0482\u0606\u0607\u0608\u060b\u060e\u060f\u06de\u06e9\u06fd\u06fe\u09f2\u09f3\u09fa\u0af1\u0b70\u0bf3-\u0bfa\u0c7f\u0d79\u0e3f\u0f01\u0f02\u0f03\u0f13\u0f15\u0f16\u0f17\u0f1a-\u0f1f\u0f34\u0f36\u0f38\u0fbe-\u0fc5\u0fc7-\u0fcc\u0fce\u0fcf\u109e\u109f\u1390-\u1399\u17db\u2044\u2052\u3004\u3012\u3013\u3020\u3036\u3037\u303e\u303f\u309b\u309c\uff04\uff0b\uff1c\uff1d\uff1e\uff3e\uff40\uff5c\uff5e\uffe0-\uffe6\uffe8-\uffee]|[\u0600-\u0603\u06dd\u180e\u200b-\u200d\u2060-\u2064\u206a-\u206f])("+
fb.H1f+"|"+fb.K1f+"|"+fb.L1f+")";fb.XWf="([ \u00a0\u2000-\u200a\u202f\u205f\u3000\t]|[\x00-\b\n-\u0019\u007f-\u009f\u2028-\u2029\u202f\u205f]|[!-#%-*,-/:-;?-@[-]_{}\u00a1\u00ab\u00ac\u00b7\u00bb\u00bf\u037e\u0387\u055a-\u055f\u0589-\u058a\u05be\u05c0\u05c3\u05c6\u05f3-\u05f4\u0609-\u060a\u060c-\u060d\u061b\u061e-\u061f\u066a-\u066d\u06d4\u0964-\u0965\u0970\u0df4\u0e4f\u0e5a-\u0e5b\u0f04-\u0f12\u0f3a-\u0f3d\u0f85\u0fd0-\u0fd4\u104a-\u104f\u10fb\u1361-\u1368\u166d-\u166e\u17d4-\u17d6\u17d8-\u17da\u1800-\u180a\u2010-\u2027\u2030-\u2043\u2045-\u2051\u2053-\u205e\u3001-\u3003\u3008-\u3011\u3014-\u301f\u3030\u303d\u30a0\u30fb\uff01-\uff03\uff05-\uff0a\uff0c-\uff0f\uff1a-\uff1b\uff1f-\uff20\uff3b-\uff3d\uff3f\uff5b\uff5d\uff5f-\uff65]|[$+<=>^`|~\u00a2\u00a3\u00a4\u00a5-\u00a9\u00ac\u00ae\u00af\u00b0\u00b1\u00b4\u00b6\u00b8\u00d7\u00f7\u02c2-\u02c5\u02d2-\u02df\u02e5-\u02eb\u02ed\u02ef-\u02ff\u0375\u0384\u0385\u03f6\u0482\u0606\u0607\u0608\u060b\u060e\u060f\u06de\u06e9\u06fd\u06fe\u09f2\u09f3\u09fa\u0af1\u0b70\u0bf3-\u0bfa\u0c7f\u0d79\u0e3f\u0f01\u0f02\u0f03\u0f13\u0f15\u0f16\u0f17\u0f1a-\u0f1f\u0f34\u0f36\u0f38\u0fbe-\u0fc5\u0fc7-\u0fcc\u0fce\u0fcf\u109e\u109f\u1390-\u1399\u17db\u2044\u2052\u3004\u3012\u3013\u3020\u3036\u3037\u303e\u303f\u309b\u309c\uff04\uff0b\uff1c\uff1d\uff1e\uff3e\uff40\uff5c\uff5e\uffe0-\uffe6\uffe8-\uffee]|[\u0600-\u0603\u06dd\u180e\u200b-\u200d\u2060-\u2064\u206a-\u206f]|[0-9\u0660-\u0669\u06f0-\u06f9\u0966-\u096f\u09e6-\u09ef\u0a66-\u0a6f\u0ae6-\u0aef\u0b66-\u0b6f\u0be6-\u0bef\u0c66-\u0c6f\u0ce6-\u0cef\u0d66-\u0d6f\u0e50-\u0e59\u0ed0-\u0ed9\u0f20-\u0f29\u1040-\u1049\u1090-\u1099\u17e0-\u17e9\u1810-\u1819\uff10-\uff19]|[\u00b2\u00b3\u00b9\u00bc\u00bd\u00be\u09f4-\u09f9\u0bf0\u0bf1\u0bf2\u0c78-\u0c7e\u0d70-\u0d75\u0f2a-\u0f33\u1369-\u137c\u17f0-\u17f9\u3007\u3021-\u3029\u3038\u3039\u303a])("+
fb.M1f+")";fb.XDf=fb.G1f+"|"+fb.N1f;fb.F1f=fb.XDf+"|"+fb.YWf+"|"+fb.XWf;fb.GDh=RegExp("[?!.\u0589\u06d4\u0701\u0702\u0964\u0965\u1362\u166e\u1803\u1809\u2cf9\u2cfe\u3002\ua4ff\ua60e\ua6f3\ufe12\ufe52\uff0e\uff61]|[\u3002\uff61]","ig");fb.c0n=new RegExp(fb.F1f,"g");Object(n.a)(fb,"ProofingSentenceSeparatorScriptSharp",null,[661]);class Mb{B5c(b,h){const r=[];let z;for(;null!=(z=h.exec(b));){const R=z.index;r.push({begin:R,end:R+z[0].length})}return r}isEndPuncSpecialCase(b){return this.B5c(b,Mb.isj).some(h=>
h.end==b.length)}HFc(b){for(const h of Mb.bpj){const r=this.B5c(b,h);if(0<r.length&&0==r[0].begin)return r[0].end-1}return 0}findBeginBoundary(b,h,r){var z=b.substring(r,h);b=this.B5c(z,Mb.Kbg);for(h=b.length-1;0<=h;h--){const R=z.substring(0,b[h].end);if(!this.isEndPuncSpecialCase(R))return z=z.substring(b[h].begin,z.length),r+b[h].end+this.HFc(z)}return r}findEndBoundary(b,h,r){var z=b.substring(h,r);b=this.B5c(z,Mb.Kbg);for(r=0;r<b.length;r++){const R=z.substring(0,b[r].end);if(!this.isEndPuncSpecialCase(R))return z=
z.substring(b[r].begin,z.length),h+b[r].end+this.HFc(z)}return-1}}Mb.Unj="[)]}\u0f3b\u0f3d\u2046\u3009\u300b\u300d\u300f\u3011\u3015\u3017\u3019\u301b\u301e\u301f\uff09\uff3d\uff5d\uff60\uff63]";Mb.dsj="[\u2639\u263a\u263b]";Mb.Pdg="[\x00-\b\n-\u0019\u007f-\u009f\u2028-\u2029\u202f\u205f]";Mb.Qoj="[0-9\u0660-\u0669\u06f0-\u06f9\u0966-\u096f\u09e6-\u09ef\u0a66-\u0a6f\u0ae6-\u0aef\u0b66-\u0b6f\u0be6-\u0bef\u0c66-\u0c6f\u0ce6-\u0cef\u0d66-\u0d6f\u0e50-\u0e59\u0ed0-\u0ed9\u0f20-\u0f29\u1040-\u1049\u1090-\u1099\u17e0-\u17e9\u1810-\u1819\uff10-\uff19]";
Mb.erj="[\u00b2\u00b3\u00b9\u00bc\u00bd\u00be\u09f4-\u09f9\u0bf0\u0bf1\u0bf2\u0c78-\u0c7e\u0d70-\u0d75\u0f2a-\u0f33\u1369-\u137c\u17f0-\u17f9\u3007\u3021-\u3029\u3038\u3039\u303a]";Mb.veg="[!-#%-*,-/:-;?-@[-]_{}\u00a1\u00ab\u00ac\u00b7\u00bb\u00bf\u037e\u0387\u055a-\u055f\u0589-\u058a\u05be\u05c0\u05c3\u05c6\u05f3-\u05f4\u0609-\u060a\u060c-\u060d\u061b\u061e-\u061f\u066a-\u066d\u06d4\u0964-\u0965\u0970\u0df4\u0e4f\u0e5a-\u0e5b\u0f04-\u0f12\u0f3a-\u0f3d\u0f85\u0fd0-\u0fd4\u104a-\u104f\u10fb\u1361-\u1368\u166d-\u166e\u17d4-\u17d6\u17d8-\u17da\u1800-\u180a\u2010-\u2027\u2030-\u2043\u2045-\u2051\u2053-\u205e\u3001-\u3003\u3008-\u3011\u3014-\u301f\u3030\u303d\u30a0\u30fb\uff01-\uff03\uff05-\uff0a\uff0c-\uff0f\uff1a-\uff1b\uff1f-\uff20\uff3b-\uff3d\uff3f\uff5b\uff5d\uff5f-\uff65]";
Mb.Symbol="[$+<=>^`|~\u00a2\u00a3\u00a4\u00a5-\u00a9\u00ac\u00ae\u00af\u00b0\u00b1\u00b4\u00b6\u00b8\u00d7\u00f7\u02c2-\u02c5\u02d2-\u02df\u02e5-\u02eb\u02ed\u02ef-\u02ff\u0375\u0384\u0385\u03f6\u0482\u0606\u0607\u0608\u060b\u060e\u060f\u06de\u06e9\u06fd\u06fe\u09f2\u09f3\u09fa\u0af1\u0b70\u0bf3-\u0bfa\u0c7f\u0d79\u0e3f\u0f01\u0f02\u0f03\u0f13\u0f15\u0f16\u0f17\u0f1a-\u0f1f\u0f34\u0f36\u0f38\u0fbe-\u0fc5\u0fc7-\u0fcc\u0fce\u0fcf\u109e\u109f\u1390-\u1399\u17db\u2044\u2052\u3004\u3012\u3013\u3020\u3036\u3037\u303e\u303f\u309b\u309c\uff04\uff0b\uff1c\uff1d\uff1e\uff3e\uff40\uff5c\uff5e\uffe0-\uffe6\uffe8-\uffee]";
Mb.Odg="[\u0600-\u0603\u06dd\u180e\u200b-\u200d\u2060-\u2064\u206a-\u206f]";Mb.jqj="[A-Za-z\u00aa\u00b5\u00ba\u00c0-\u00d0\u00d1-\u00d6\u00d8-\u00f6\u00f8-\u01ba\u01bc-\u01bf\u01c4-\u0293\u0295-\u0373\u0376\u0377\u037b\u037c\u037d\u0386\u0388\u0389\u038a\u038c\u038e-\u03a1\u03a3-\u03f5\u03f7-\u0481\u048a-\u0523\u0531-\u0556\u0561-\u0587\u10a0-\u10c5]";Mb.iqj="[\uff21-\uff3a\uff41-\uff5a]";Mb.gqj="[\u01bb\u01c0-\u01c3\u0294\u05d0-\u05ea\u05f0\u05f1\u05f2\u0621-\u063f\u0641-\u064a\u066e\u066f-\u06d3\u0671\u06d5\u06ee\u06ef\u06fa\u06fb\u06fc\u06ff\u0904-\u0939\u093d\u0950\u0958-\u0961\u0972\u097b-\u097f\u0985-\u098c\u098f\u0990\u0993-\u09a8\u09aa-\u09b0\u09b2\u09b6-\u09b9\u09bd\u09ce\u09dc\u09dd\u09df\u09e0\u09e1\u09f0\u09f1\u0a05-\u0a0a\u0a0f\u0a10\u0a13-\u0a19\u0a1a-\u0a28\u0a2a-\u0a30\u0a32\u0a33\u0a35\u0a36\u0a38\u0a39\u0a59-\u0a5c\u0a5e\u0a72-\u0a74\u0a85-\u0a8d\u0a8f-\u0a91\u0a93-\u0aa8\u0aaa-\u0ab0\u0ab2\u0ab3\u0ab5-\u0ab9\u0abd\u0ad0\u0ae0\u0ae1\u0b05-\u0b0c\u0b0f\u0b10\u0b13-\u0b28\u0b2a-\u0b30\u0b32\u0b33\u0b35-\u0b39\u0b3d\u0b5c\u0b5d\u0b5f-\u0b61\u0b71\u0b83\u0b85-\u0b8a\u0b8e-\u0b90\u0b92-\u0b95\u0b99\u0b9a\u0b9c\u0b9e\u0b9f\u0ba3\u0ba4\u0ba8-\u0baa\u0bae-\u0bb9\u0bd0\u0c05-\u0c0c\u0c0e-\u0c10\u0c12-\u0c28\u0c2a-\u0c33\u0c35-\u0c39\u0c3d\u0c58\u0c59\u0c60\u0c61\u0c85-\u0c8c\u0c8e-\u0c90\u0c92-\u0ca8\u0caa-\u0cb3\u0cb5-\u0cb9\u0cbd\u0cde\u0ce0\u0ce1\u0cf1\u0cf2\u0d05-\u0d0c\u0d0e-\u0d10\u0d12-\u0d28\u0d2a-\u0d39\u0d3d\u0d60\u0d61\u0d7a-\u0d7f\u0d85-\u0d96\u0d9a-\u0db1\u0db3-\u0dbb\u0dbd\u0dc0-\u0dc6\u0e81\u0e82\u0e84\u0e87\u0e88\u0e8a\u0e8d\u0e94-\u0e97\u0e99-\u0e9f\u0ea1-\u0ea3\u0ea5\u0ea7\u0eaa\u0eab\u0ead-\u0eb0\u0eb2\u0eb3\u0ebd\u0ec0-\u0ec4\u0ec6\u0edc\u0edd\u0f00\u0f40-\u0f47\u0f49-\u0f6c\u0f88-\u0f8b\u1780-\u17b3\u17d7\u17dc\u1000-\u102a\u103f\u1050-\u1055\u105a-\u105d\u1061\u1065\u1066\u106e-\u1070\u1075-\u1081\u108e\u10d0-\u10fa\u1100-\u1159\u115f\u1160-\u11a2\u11a8-\u11f9\u1200-\u1248\u124a-\u124d\u1250-\u1256\u1258\u125a-\u125d\u1260-\u1288\u128a-\u128d\u1290-\u12b0\u12b2-\u12b5\u12b8-\u12be\u12c0\u12c2-\u12c5\u12c8-\u12d6\u12d8-\u1310\u1312-\u1315\u1318-\u135a\u1380-\u138f\u13a0-\u13f4\u1401-\u166c\u166f-\u1676\u1820-\u1877\u1880-\u18a8\u18aa\u3006\u303c\uac00-\ud7a3\uffa0-\uffbe\uffc2-\uffc7\uffca-\uffcf\uffd2-\uffd7\uffda-\uffdc]";
Mb.fqj="[\u3041-\u3096\u309f\u30a1-\u30fa\u30ff\uf900-\ufa2d\ufa30-\ufa6a\ufa70-\ufad9\uff66-\uff9d]";Mb.hqj="[\u0e01-\u0e30\u0e32\u0e33\u0e40-\u0e45]";Mb.afe="[?!.\u0589\u06d4\u0701\u0702\u0964\u0965\u1362\u166e\u1803\u1809\u2cf9\u2cfe\u3002\ua4ff\ua60e\ua6f3\ufe12\ufe52\uff0e\uff61]";Mb.Jbg="[\u3002\uff61]";Mb.V5c="[ \u00a0\u2000-\u200a\u202f\u205f\u3000\t]";Mb.hpj="[\u00bb\u2019\u201d\u203a\"']";Mb.tfe=Mb.Unj+"|"+Mb.dsj;Mb.kqj="[\u2028\u2029\n\r]";Mb.eqj="("+Mb.V5c+"|"+Mb.Pdg+"|"+Mb.veg+"|"+Mb.Odg+
")";Mb.dqj="("+Mb.V5c+"|"+Mb.Pdg+"|"+Mb.veg+"|"+Mb.Symbol+"|"+Mb.Odg+"|"+Mb.Qoj+"|"+Mb.erj+")";Mb.c8e="("+Mb.afe+"("+Mb.tfe+"|"+Mb.hpj+"|"+Mb.V5c+")*"+Mb.kqj+")";Mb.d8e="("+Mb.afe+"("+Mb.tfe+")*("+Mb.V5c+")+)";Mb.e8e="("+Mb.Jbg+"("+Mb.tfe+")*)";Mb.bpj=[new RegExp(Mb.c8e,"ig"),new RegExp(Mb.d8e,"ig"),new RegExp(Mb.e8e,"ig")];Mb.G1f="[.\u3002\ufe52\uff0e\uff61]{2,6}|[.]([ ][.]){1,5}";Mb.J1f="(((L?X{1,3}|X[LC]|L)?(V?I{1,3}|I[VX]|V))|(L?X{1,3}|X[LC]|L)|((l?x{1,3}|x[lc]|l)?(v?i{1,3}|i[vx]|v))|(l?x{1,3}|x[lc]|l))[.]";
Mb.I1f="((([\uff2c]?[\uff38]{1,3}|[\uff38][\uff2c\uff23]|[\uff2c])?([\uff36]?[\uff29]{1,3}|[\uff29][\uff36\uff38]|[\uff36]))|([\uff2c]?[\uff38]{1,3}|[\uff38][\uff2c\uff23]|[\uff2c])|(([\uff4c]?[\uff58]{1,3}|[\uff58][\uff4c\uff43]|[\uff4c])?([\uff56]?[\uff49]{1,3}|[\uff49][\uff56\uff58]|[\uff56]))|([\uff4c]?[\uff58]{1,3}|[\uff58][\uff4c\uff43]|[\uff4c]))[.\ufe52\uff0e]";Mb.H1f=Mb.J1f+"|"+Mb.I1f;Mb.K1f="([0-9]{1,4}[.]|[\uff10-\uff19]{1,4}[.\ufe52\uff0e])";Mb.L1f="([0-9]+(([ao\u00aa\u00ba\u1d43\u1d52])|((er)[ao]?)|(([\u1d49][\u02b3])[\u1d43\u1d52]?)|([mdtvn][ao])|([\u1d50\u1d48\u1d57\u1d5b\u207f][\u1d43\u02b3]))[.]|[A-Za-z\u00c0\u00c4\u00c8\u00c9\u00d4\u00d6\u00dc\u00df\u00e0\u00e4\u00e8\u00e9\u00f4\u00f6\u00fc]+[.]((NR)|(Nr)|(nr))[.]|[A-Za-z\u00c0\u00c4\u00c8\u00c9\u00d4\u00d6\u00dc\u00df\u00e0\u00e4\u00e8\u00e9\u00f4\u00f6\u00fc]+((STR)|(str))[.])";
Mb.M1f="(("+Mb.jqj+"|"+Mb.gqj+"|"+Mb.hqj+")[.])+|(("+Mb.fqj+")[.\ufe52\uff0e])+";Mb.N1f="("+Mb.iqj+")[.\ufe52\uff0e]";Mb.YWf=Mb.eqj+"("+Mb.H1f+"|"+Mb.K1f+"|"+Mb.L1f+")";Mb.XWf=Mb.dqj+"("+Mb.M1f+")";Mb.XDf=Mb.G1f+"|"+Mb.N1f;Mb.F1f=Mb.XDf+"|"+Mb.YWf+"|"+Mb.XWf;Mb.Kbg=new RegExp(Mb.afe+"|"+Mb.Jbg,"ig");Mb.isj=new RegExp(Mb.F1f,"g");Object(n.a)(Mb,"ProofingSentenceSeparator",null,[661]);class Tb{constructor(){this.W=null}get name(){return"Box4.ProofingGrammarCheck"}yc(b){this.W=b;t.AFrameworkApplication.K.$("ProofingSentenceSeparatorTypeScriptIsEnabled")?
b.ha("Box4.Proofing.IProofingSentenceSeparator",()=>new Mb).singleInstance():b.ha("Box4.Proofing.IProofingSentenceSeparator",()=>new fb).singleInstance()}init(){this.W.resolve("Box4.Proofing.IProofingSentenceSeparator")}dispose(){}static main(){O.a.instance.Oc(new Tb)}}Object(n.a)(Tb,"Box4GrammarCheckPackage",null,[1,2]);var rc=d(84),vb=d(9),Ya=d(78),wb=d(68),jb=d(7);class Zb{constructor(b,h,r,z){var R;this.SEe=this.Aed=this.fte=this.ke=null;this.jNg=this.nqb=this.wia=this.aqa=this.Gie=!1;this.xca=
0;this.U_f=!1;this.DGb=()=>{this.reset()};this.lab=ba=>{this.xca=ba.Ib.keyCode;if(this.D2i){var ta=ba.Ib.rawEvent.key;ta&&ta!==Zb.LJ||(this.U_f=!0)}return this.wia&&this.Aed?ba.Ib.keyCode===wb.a.X_||ba.Ib.keyCode===wb.a.es||ba.Ib.keyCode===wb.a.mx?(ta=!1,ba.Ib.keyCode===wb.a.X_?(v.ULS.sendTraceTag(41178049,324,50,"@ mention People Picker dismissed via escape"),ta=!0):ba.Ib.keyCode===wb.a.es?v.ULS.sendTraceTag(41178050,324,50,"@ mention People Picker enter pressed while picker is up"):ba.Ib.keyCode===
wb.a.mx&&v.ULS.sendTraceTag(51451662,324,50,"@ mention People Picker tab pressed while picker is up"),this.Aed(ba),ta&&this.reset(),!0):ba.Ib.keyCode===wb.a.xha||ba.Ib.keyCode===wb.a.U7||ba.Ib.keyCode===wb.a.Y_||ba.Ib.keyCode===wb.a.Z_||ba.Ib.keyCode===wb.a.R3||ba.Ib.keyCode===wb.a.FK?(this.Aed(ba),!0):!1:!1};this.poa=ba=>{if(!this.D2i||this.U_f||this.wia){this.U_f=!1;var ta=this.iJc(),Wa=this.QHc(ba.Ib.target),ub=ba.Ib.rawEvent.inputType;return(void 0!==ub&&null!==ub||this.xca!==wb.a.bB&&this.xca!==
wb.a.W_)&&"deleteContentBackward"!==ub&&"deleteContentForward"!==ub?this.r3h(ta,Wa,ba.Ib.target):!1}};this.tfh=ba=>{if(1!==ba.Ib.rawEvent.key.length)return!1;const ta=this.iJc(),Wa=this.QHc(ba.Ib.target);return this.r3h(ta,Wa,ba.Ib.target)};this.ZMa=ba=>{if(!this.wia)return!1;const ta=this.iJc(),Wa=this.QHc(ba.Ib.target);(ba.Ib.keyCode===wb.a.bB||ba.Ib.keyCode===wb.a.W_||(ba.Ib.keyCode===wb.a.ZQa||ba.Ib.keyCode===wb.a.Ric)&&ba.Ib.ctrlKey)&&this.gkf(ta,Wa,ba.Ib.target);return!1};this.HSe=(ba,ta)=>
{this.xca=ta.jpf?wb.a.bB:ta.isDelete?wb.a.W_:this.xca;this.wia&&(ta.jpf?this.XRl(ta.wji):ta.isDelete&&this.zSl(ta.wji))};this.Ud=b;this.sj=h;this.Kjc=r;this.Zc=z;this.D2i=null===(R=t.AFrameworkApplication.K)||void 0===R?void 0:R.getBooleanFeatureGate("Microsoft.Office.WordOnline.InteractivePerfEarlyExitAtMentions",!1);this.reset()}uzc(b,h){this.aqa||(this.aqa=!0,b.Ata?this.mab(h):b.hda(()=>{this.aqa||this.mab(h)}))}dispose(){this.nqb&&(vb.App.xa.ogc.sc(jb.a.input,this.Zc.editingView.editingElement,
this.poa),this.nqb=!1);this.Gie&&(this.ke.sc(jb.a.rzc,this.Zc.editingView.editingElement,this.tfh),this.Gie=!1);this.jNg&&(this.ke.sc(jb.a.WH,this.Zc.editingView.editingElement,this.lab),this.ke.sc(jb.a.oh,this.Zc.editingView.editingElement,this.ZMa));vb.App.xa.tga(this.DGb);this.m8i()}hMi(b){this.fte=b}uMi(b){this.SEe=b}iMi(b){this.Aed=b}Ihk(){this.wia=!0;t.AFrameworkApplication.Hf("ContextIQAtMentionEntryPoint-Treatment;ContextIQAtMentionEntryPoint-Control")}m8i(){this.wia=!1}bO(){return this.wia}mab(b){this.ke=
b;this.Zc.xd?this.Zc.xd.wi&&(vb.App.Izc&&X.a.E$d||X.a.Ys?(vb.App.xa.ogc.mb(jb.a.input,this.Zc.editingView.editingElement,this.poa,null),this.nqb=!0):this.ke&&X.a.Ak&&(this.ke.mb(jb.a.rzc,this.Zc.editingView.editingElement,this.tfh),this.Gie=!0),this.ke&&(this.ke.mb(jb.a.WH,this.Zc.editingView.editingElement,this.lab),this.ke.mb(jb.a.oh,this.Zc.editingView.editingElement,this.ZMa),this.jNg=!0),this.Kjc.j$g(this.HSe),vb.App.xa.o1(this.DGb)):v.ULS.sendTraceTag(593376530,324,10,"SelectionView is null. AtMentions will not work in this session")}r3h(b,
h,r){if(1>h)return!1;b=b.replace(new RegExp(Zb.VB,"g"),"");const z=b.charAt(h-1);this.wia&&z!==Zb.LJ?this.gkf(b,h,r):this.wia||z!==Zb.LJ?this.wia&&z===Zb.LJ&&v.ULS.sendTraceTag(41178052,324,50,"Tried to type @ while already in at mention mode"):this.fte&&(this.reset(),this.H8m(h,b)&&(this.Ihk(),this.gkf(b,h,r),v.ULS.sendTraceTag(41178051,324,50,"@ typed.  Beginning of paragraph?: {0}",1===h?"true":"false")));return this.wia}reset(){this.aqa=!1;this.m8i();this.SEe&&this.SEe()}QHc(b){return this.sj.j2b(2,
b)}iJc(){return this.Ud.pp().innerText}H8m(b,h){return 0>b-2||this.ctk(h.charAt(b-2))?!0:!1}ctk(b){return B.a.daa(b)||"("===b}gkf(b,h,r){if(!b||""===b||0>h)this.reset();else{const {GVi:z,wsd:R}=this.Zom(b,h);this.fte(z,r,R)}}Zom(b,h){let r=this.Fil(b,h);if(0<=r&&h<=b.length)return{GVi:b.substring(r,h),wsd:r};this.reset();return{GVi:"",wsd:r}}Fil(b,h){let r=-1;for(let z=h;0<=z&&63>=h-z;z--)if(b.charAt(z)===Zb.LJ){r=z;break}return r}XRl(b){b=this.QHc(b.Ib.target);b=this.iJc().charAt(b-1);this.wia&&
b===Zb.LJ&&this.reset()}zSl(b){b=this.QHc(b.Ib.target);b=this.iJc().charAt(b);this.wia&&b===Zb.LJ&&this.reset()}}Zb.LJ="@";Zb.VB="\n";Object(n.a)(Zb,"AtMentionsListener",null,[660]);class Eb{constructor(){this.W=null}get name(){return"Box4.AtMentions"}yc(b){this.W=b;this.W.ha("Box4.AtMentions.IAtMentionsListener",()=>new Zb(this.W.resolve("Box4.IEditingDomManager"),this.W.resolve("Box4.ICaretPositionManager"),this.W.resolve("Box4.BackspaceDeleteEventSource"),Ya.InteractiveViewManager.instance)).singleInstance()}init(){t.AFrameworkApplication.K.$("CanvasAtMentionDetectionIsEnabled")&&
t.AFrameworkApplication.K.zq(()=>{this.W.resolve("Box4.AtMentions.IAtMentionsListener").uzc(vb.App.xa.jb,rc.KeyInputManager.instance)})}dispose(){this.W.resolve("Box4.AtMentions.IAtMentionsListener").dispose()}static main(){O.a.instance.Oc(new Eb)}}Object(n.a)(Eb,"Box4AtMentionsPackage",null,[1,2]);class tc{get name(){return"Box4.Workers"}yc(){}init(){}dispose(){}static main(){O.a.instance.Oc(new tc)}}Object(n.a)(tc,"Box4WorkersPackage",null,[1,2]);var lc=d(321),Lc=d(86);class Bb{constructor(){this.MFa=
new Lc.a}t3(b,h){this.MFa.Z(b,h)}Waf(b){({value:b}=this.MFa.Dc(b));return b}}Object(n.a)(Bb,"AggregationMethodsForActivityName",null,[]);var jc=d(249);class dc{constructor(){this.gjd=new lc.a;this.MFa=new lc.a}t3(b,h,r){this.MFa.xb(b)&&this.MFa.J(b)||this.MFa.Z(b,new Bb);this.MFa.J(b).t3(h,r)}Waf(b,h){return this.MFa.xb(b)&&this.MFa.J(b)?this.MFa.J(b).Waf(h):null}qJc(b){this.gjd.xb(b)&&this.gjd.J(b)||this.gjd.Z(b,new jc.a);return this.gjd.J(b)}Wwh(b,h){this.qJc(b).add(h)}}Object(n.a)(dc,"ActivityAggregationInfo",
null,[740]);var nb=d(120),Gb=d(963),lb=d(980);class Kb extends Gb.a{constructor(b,h){super(b);this.pLe=(this.Vuj=h)?h.Bsl():lb.a.Jaf()}get Nya(){return this.Vuj}get activityName(){return this.Nya.name}get startTime(){return this.Nya.startTime}get endTime(){return this.Nya.endTime}end(){}cancel(){}D$e(){}Iio(){this.W1b.Z("AM",this.Nya.mode.toString());this.W1b.Z("C",this.Nya.count.toString());this.W1b.Z("DA",this.Nya.aCh.toFixed(2));this.W1b.Z("DV",this.Nya.C_k.toFixed(2))}Wgf(b){return this.Nya.Wgf(b)}vhf(){return this.Nya.vhf()}$Wb(){for(let b of this.Nya.Oya)b.$Wb()}}
Object(n.a)(Kb,"AggregatedActivity",Gb.a,[]);class Vb{constructor(b,h){this.whe=0;this.Cwa=b;this.aRa=h}M$j(b,h){this.whe=h;for(h=0;h<b.count;h++){const r=b.J(h);this.N$j(r)}}N$j(b){const h=Object(la.a)(Kb,b);if(h)if(1===this.whe)this.L$j(h);else if(2===this.whe){this.O$j(h);for(let r of this.aRa.qJc(this.Cwa)){const z=h.Nya.Oya.J(0);z.properties.xb(r)&&b.properties.Z(r,z.properties.J(r))}}}L$j(b){for(let h of this.aRa.qJc(this.Cwa))this.STi(b,h)}O$j(b){for(let h of b.vhf())this.STi(b,h)}STi(b,h){const r=
this.aRa.Waf(this.Cwa,h);if(r){const z=b.Wgf(h);b.properties.Z(h,r(z))}}}Object(n.a)(Vb,"PropertyAggregationHelper",null,[]);var vc=d(1052);class Fc{constructor(b,h,r,z,R){this.ENb=b;this.aRa=h;this.Ryg=R;this.ehe=z;this.KKj=r}get d7g(){return this.KKj.value}ABc(b){if(Object(nb.a)(vc.a,b))b.ABc();else if(Object(nb.a)(Kb,b)&&this.ehe.Rjh(b.activityName.toString())){b=Object(la.a)(Kb,b);b.Iio();b=b.vpi();var h=[];Array.add(h,b);b=y.c(h);v.ULS.sendTraceTag(6907266,213,50,b)}}Xya(b,h){const r=(new Date).getTime();
var z=this.Ryg.list.J(b);const R=({Q$j:z}=this.fhl(z)).returnValue;this.Ryg.list.Z(b,new Ua.a);h&&(z=this.QGk(z,r,this.ENb.b2h));0<z.count&&(new Vb(b,this.aRa)).M$j(z,R)}QGk(b,h,r){const z=new Ua.a;for(let R=0;R<b.count;R++){const ba=b.J(R);ba.startTime>h-r?ba.$Wb():z.add(ba)}return z}fhl(b){const h=this.d7g.Oaj(b);b=this.d7g.H8n(b);const r=this.R$j(h,b);return{returnValue:r,Q$j:1===r?h:b}}R$j(b,h){return b.count*this.ENb.Kri<h.count?1:2}get enabled(){return this.ENb.enabled}$Wb(){}}Object(n.a)(Fc,
"ActivityAggregationManager",null,[738]);class Zc{constructor(b){this.enabled=!1;this.hqi=500;this.nri=2;this.Kri=5;this.b2h=3E4;this.PFc(b.appSettings)}PFc(b){this.enabled=Boolean.parse(b[Zc.C6e]||"false");this.hqi=parseInt(b[Zc.PFm]||"500");this.nri=parseInt(b[Zc.vIm]||"2");this.Kri=parseInt(b[Zc.SIm]||"5");this.b2h=parseInt(b[Zc.OQl]||"30000")}}Zc.C6e="ActivityAggregationEnabled";Zc.PFm="ActivityAggregationMaxInterval";Zc.vIm="ActivityAggregationMinChain";Zc.SIm="ActivityAggregationModeFactor";
Zc.OQl="ActivityAggregationGraceWindow";Object(n.a)(Zc,"ActivityAggregationParams",null,[]);class td{constructor(b,h){this.aRa=b;this.dug=h}Oaj(b,h=1){if(!b||!b.count)return b;const r=new Ua.a;var z=null;for(let R=0;R<b.count;R++){const ba=b.J(R);if(!ba)continue;const ta=ba.activityName;z?z.Cnm(ba)?z.add(ba):(z=z.process(),r.addRange(z),z=this.dug(ta,h),z.add(ba)):(z=this.dug(ta,h),z.add(ba))}z&&(b=z.process(),r.addRange(b));return r}H8n(b){if(!b||!b.count)return b;const h={};var r=null;for(let R=
0;R<b.count;R++){const ba=b.J(R);if(ba){if(!r){r=new Ua.a;var z=this.aRa.qJc(ba.activityName);for(let ta of z)r.add(ta)}z=this.xFl(ba,r);null!==z&&(z in h&&h[z]||(h[z]=new Ua.a),h[z].add(ba))}}b=new Ua.a;for(const R of Na.a.UN(h))r=this.Oaj(h[R],2),b.addRange(r);return b}xFl(b,h){let r="";for(let z of h)r+=z,r=b.properties.xb(z)&&void 0!==b.properties.J(z)&&null!==b.properties.J(z)?r+b.properties.J(z):r+"null";return r}}Object(n.a)(td,"ActivityAggregationSchemes",null,[741]);class xd{constructor(b,
h,r,z,R){this.Fr=this.Gi=0;this.ENb=r;this.hjc=z;this.aRa=R;this.name=b;this.xy=h;this.Oya=new Ua.a}get mode(){return this.xy}get count(){return this.Oya.count}get startTime(){return this.Gi}get endTime(){return this.Fr}get aCh(){if(!this.count)return 0;let b=0;for(let h of this.Oya)b+=h.endTime-h.startTime;return b/this.count}get C_k(){if(!this.count)return 0;let b=0;const h=this.aCh;for(let r of this.Oya){const z=r.endTime-r.startTime;b+=(z-h)*(z-h)}return b/this.count}add(b){this.count?this.Fr=
b.endTime>this.endTime?b.endTime:this.endTime:(this.Gi=b.startTime,this.Fr=b.endTime);this.Oya.add(b)}Cnm(b){return 0>=this.count?!1:b.startTime-this.endTime<=this.ENb.hqi}process(){if(this.count>=this.ENb.nri){const b=new Ua.a,h=this.hjc(this);b.add(h);return b}return this.Oya}Wgf(b){const h=new Ua.a;for(let r of this.Oya)if(r.properties.xb(b)){const z=r.properties.J(b);h.add(z)}else h.add(null);return h}vhf(){const b=this.aRa.qJc(this.name),h=new jc.a;for(let r of this.Hhl())b.contains(r)||h.add(r);
return h}Hhl(){const b=new jc.a;if(!this.Oya)return b;for(let h of this.Oya)for(let r of h.properties.keys)b.add(r);return b}Bsl(){return this.Oya.J(0).uniqueID}}Object(n.a)(xd,"ActivityCollection",null,[739]);class le{constructor(){this.Wnb=new lc.a}get list(){return this.Wnb}add(b){const h=b.activityName;if(this.Wnb.xb(h)&&this.Wnb.J(h)){const r=this.Cvl(this.Wnb.J(h),b);this.Wnb.J(h).insert(r,b)}else this.Wnb.Z(h,new Ua.a),this.Wnb.J(h).add(b)}Cvl(b,h){for(let r=b.count-1;0<=r;r--)if(h.startTime>
b.J(r).startTime)return r+1;return 0}}Object(n.a)(le,"CompletedActivitiesHelper",null,[685]);class Yc{constructor(){this.W=null}get name(){return"Common.App.ActivityAggregator"}init(){t.AFrameworkApplication.xK(()=>{this.W.resolve("Common.App.ActivityAggregator.ActivityAggregationManager")})}dispose(){}yc(b){this.W=b;const h=z=>new Kb(()=>b.Pa("Common.App.Activities.IActivityAggregationManager"),z),r=(z,R)=>new xd(z,R,b.resolve("Common.App.ActivityAggregator.ActivityAggregationParams"),h,b.resolve("Common.IActivityAggregationInfo"));
b.register(Fc,"Common.App.ActivityAggregator.ActivityAggregationManager").as("Common.App.Activities.IActivityAggregationManager").singleInstance().Yd(()=>new Fc(b.resolve("Common.App.ActivityAggregator.ActivityAggregationParams"),b.resolve("Common.IActivityAggregationInfo"),b.ef("Common.App.ActivityAggregator.IActivityAggregationSchemes"),b.resolve("Common.App.Activities.IActivityThrottler"),b.resolve("Common.App.ActivityAggregator.CompletedActivitiesHelper")));b.register(Zc,"Common.App.ActivityAggregator.ActivityAggregationParams").singleInstance().Yd(()=>
new Zc(t.AFrameworkApplication.K));b.register(dc,"Common.App.ActivityAggregator.ActivityAggregationInfo").as("Common.IActivityAggregationInfo").singleInstance().Yd(()=>new dc);b.register(td,"Common.App.ActivityAggregator.ActivityAggregationSchemes").as("Common.App.ActivityAggregator.IActivityAggregationSchemes").singleInstance().Yd(()=>new td(b.resolve("Common.IActivityAggregationInfo"),r));b.register(le,"Common.App.ActivityAggregator.CompletedActivitiesHelper").singleInstance().Yd(()=>new le)}static main(){O.a.instance.Oc(new Yc)}}
Object(n.a)(Yc,"ActivityAggregatorPackage",null,[1,2]);var xc=d(471),md=d(1369);class Ie{constructor(b){this.BWg=0;this.Qje=null;this.ORj=b}get chat(){return window.swc}get isInitialized(){return!!this.chat}get WZf(){return this.ORj.value}Vb(){this.isInitialized?this.Xbc():this.mmn(Object(u.a)(this,this.Xbc,"registerActionsInternal"))}Xbc(){v.ULS.sendTraceTag(50595938,333,50,"Registering for chat events");try{this.isInitialized&&(this.chat.getContainerProvider().then(b=>{b.getChatsContainer(Object(u.a)(this,
this.UPm,"onChatContainerReady"))}).catch(b=>{v.ULS.sendTraceTag(50960143,333,10,"Failed to register for chat container {0}",b)}),this.chat.getChatsCounter().then(b=>{b.onChatsCountChange(Object(u.a)(this,this.htk,"chatCountChanged"))}).catch(b=>{v.ULS.sendTraceTag(50595939,333,10,"Failed to register chat counter callback {0}",b)}),this.chat.getKeyboard().then(b=>{b.onKeyDown(Object(u.a)(this,this.XPm,"onChatKeyPress"))}).catch(b=>{v.ULS.sendTraceTag(50595968,333,10,"Failed to register chat ctrlF6 callback {0}",
b)}))}catch(b){v.ULS.sendTraceTag(50595969,333,10,"Failed to register chat events: {0}",b)}}htk(b){v.ULS.sendTraceTag(50595970,333,50,"Chat count:{0}",b);if(!b)this.WZf.TPm();else if(1===b&&!this.BWg){const h=document.getElementById(this.Qje?this.Qje:md.a.zwb);h?this.WZf.YPm(h,Object(u.a)(this,this.iao,"transferFocusToChat")):v.ULS.sendTraceTag(50595971,333,10,"Chat parent is null")}this.BWg=b}UPm(b){this.Qje=b}XPm(b){b.ctrlKey&&"f6"===b.key.toLowerCase()&&this.hao(b.shiftKey)}mmn(b){xc.a.instance.mb(jb.a.T4n,
window.self,()=>{b();return!0})}iao(){v.ULS.sendTraceTag(50595972,333,50,"Transferring focus to chat");try{this.isInitialized&&this.chat.getFocuser().then(b=>{b.focusConversationInput()}).catch(b=>{v.ULS.sendTraceTag(50595973,333,10,"Failed to transfer focus to chat: {0}",b)})}catch(b){v.ULS.sendTraceTag(50595974,333,10,"Failed to transfer focus to chat: {0}",b)}}hao(b){v.ULS.sendTraceTag(50595975,333,50,"Transferring focus from chat");this.WZf.VPm(b)}}Object(n.a)(Ie,"ChatManager",null,[674]);var Te=
d(67);class rf{constructor(){this.sa=new Te.a;this.hYj=!1}s8j(b){this.sa.addHandler("OnTopRowControlsCreatedEvent",b)}b8j(b){this.sa.addHandler("OnRenameTextboxStatusChangedEventKey",b)}get i$n(){return this.hYj}uJi(b){this.sa.raiseEvent("OnRenameTextboxStatusChangedEventKey",b?"true":"false")}}Object(n.a)(rf,"HeaderEventSource",null,[]);var ke=d(159),xe=d(289);class zf{constructor(b,h,r,z,R){this.uod=null;this.Wb=b;this.Oo=h;this.Kj=r;this.kYj=z;this.ga=R}YLi(b,h,r,z=null){const R=this.Wb.re(h);
R.parent=r;R.UL=!0;z&&R.dda(z);this.Kj.Qya(h,b,!1);this.kYj.Qya(h,b,!1);h=new xe.DOMFocusListing(()=>b);h.Go(2);h.Go(1);h.Go(8);h.Go(5);h.Go(3);h.Go(6);this.Wb.Pja(()=>b,R,h).mX=!0;h=rc.KeyInputManager.lc(wb.a.mx,0);r=rc.KeyInputManager.lc(wb.a.mx,4);R.Dr(h);R.Dr(r)}onFlexPaneOpen(b){this.YLi(b,md.a.x9b,md.a.ULa);this.Wb.Jg(md.a.x9b);this.Oo.Rya(md.a.x9b)}onFlexPaneClose(){this.Oo.Mw(md.a.x9b);this.Wb.Jg(md.a.ULa)}YPm(b,h){this.uod||(this.uod=h,this.YLi(b,md.a.zwb,ke.AFrame.iL,Object(u.a)(this,this.WPm,
"onChatFocus")));this.Wb.Jg(md.a.zwb);this.Oo.Rya(md.a.zwb)}WPm(){this.uod&&this.uod()}TPm(){this.Oo.Mw(md.a.zwb);this.Wb.IDd(ke.AFrame.Zp)}VPm(b){this.ga.processAction(b?ab.a.v8e:ab.a.cfe,2)}}Object(n.a)(zf,"ReactSharedHeaderFocusManager",null,[673]);var $c=d(104),Hg=d(1013),Rc=d(46),Ed=d(37),Yd=d(60);class Zf{constructor(b){this.ga=b}Vb(){this.ga.pa(ab.a.UDd,Yd.a.frame,Object(u.a)(this,this.Xsi,"navigateToUpsellPage"));this.ga.pa(ab.a.zel,Yd.a.frame,Object(u.a)(this,this.launchUpsellExperience,
"launchUpsellExperience"));this.ga.pa(ab.a.cvn,Yd.a.frame,$c.ActionManager.Nf);this.ga.pa(ab.a.zQi,Yd.a.frame,$c.ActionManager.Nf)}Xsi(b,h,r,z,R){if(1===r)return 32;b=8;2===r&&(r=this.hcf(R,"experience","gopremiumribbon"),R=Rc.a.i6("2116536"),R=Rc.a.Pn(R,"ocid",Hg.b(t.AFrameworkApplication.ua.Sb.jo,t.AFrameworkApplication.ua.Sb.Mfa,r)),Ed.a.Cm(R,"_blank",void 0,"NavigateToUpsellPage"),b=32,this.ga.processAction(ab.a.zQi,2),v.ULS.sendTraceTag(38929747,340,50,"User directed to POC"));return b}launchUpsellExperience(b,
h,r,z,R){if(1===r)return 32;var ba=8;2===r&&(v.ULS.sendTraceTag(592721857,340,50,"LaunchUpsellExperience from Ribbon"),(ba=Sa.a.instance.Pa("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"))?(b=this.hcf(R,"experience","gopremium"),R=this.hcf(R,"dimeCampaignId",null),ba.launchUpsellExperience(b,R),ba=32):(v.ULS.sendTraceTag(594874952,340,15,"ApplicationFeatureHelper not available"),ba=this.Xsi(b,h,r,z,R)));return ba}hcf(b,h,r){b&&b[h]&&(r=Object(la.a)(String,b[h]));return r}}Object(n.a)(Zf,
"UpsellActor",null,[672]);class Hc{constructor(){this.W=null}get name(){return"Common.App.Header"}init(){Sa.a.instance.resolve("Common.App.Header.IUpsellActor").Vb();Sa.a.instance.resolve("Common.App.Header.IChatManager").Vb()}dispose(){}yc(b){this.W=b;this.W.register(rf,"Common.App.Header.HeaderEventSource").singleInstance();this.W.register(Zf,"Common.App.Header.UpsellActor").as("Common.App.Header.IUpsellActor").singleInstance().Yd(()=>new Zf(t.AFrameworkApplication.ya));this.W.register(zf,"Common.App.Header.ReactSharedHeaderFocusManager").as("Common.App.Header.IReactSharedHeaderFocusManager").singleInstance().Yd(()=>
new zf(t.AFrameworkApplication.ua.$o,t.AFrameworkApplication.ua.jv,t.AFrameworkApplication.ua.G_,t.AFrameworkApplication.ua.Fae,t.AFrameworkApplication.ya));this.W.register(Ie,"Common.App.Header.ChatManager").as("Common.App.Header.IChatManager").singleInstance().Yd(()=>new Ie(this.W.ef("Common.App.Header.IReactSharedHeaderFocusManager")))}static main(){O.a.instance.Oc(new Hc)}}Object(n.a)(Hc,"CommonAppHeaderPackage",null,[1,2]);var sc=d(1512);class pd{static oMh(b,h){switch(b){case 3:return pd.KPl(h);
case 2:return pd.hCl(h);case 1:return pd.krl(h)}return""}static KPl(b){switch(b){case 1:return t.AFrameworkApplication.K.appSettings.WildFireAdjustLinkWordWac.toString();case 2:return t.AFrameworkApplication.K.appSettings.WildFireAdjustLinkWordWac.toString()}return""}static hCl(b){switch(b){case 1:return t.AFrameworkApplication.K.appSettings.WildFireAdjustLinkPptWac.toString();case 2:return t.AFrameworkApplication.K.appSettings.WildFireAdjustLinkPptWac.toString()}return""}static krl(b){switch(b){case 1:return t.AFrameworkApplication.K.appSettings.WildFireAdjustLinkExcelWac.toString();
case 2:return t.AFrameworkApplication.K.appSettings.WildFireAdjustLinkExcelWac.toString()}return""}static openInClient(b,h,r){if(X.a.ki||X.a.ML)window.setTimeout(()=>{pd.nLi(r,pd.TId())},500),MSOJS.ClientUtils.OpenDocumentWithProtocolHandlerNoCallBack(pd.Pbh(r),b,0,!1)}static Exk(b,h,r,z){h&&z&&z();pd.openInClient(b,h,r)}static TId(){return X.a.ki?1:X.a.ML?2:X.a.TMa?3:X.a.xl?4:0}static vPl(b){switch(b){case 3:return"WildFireWordBizBar";case 2:return"WildFirePowerPointBizBar";case 1:return"WildFireExcelBizBar";
default:return""}}static wPl(b){switch(b){case 3:return"WildFireWordBizBarFlight";case 2:return"WildFirePowerPointBizBarFlight";case 1:return"WildFireExcelBizBarFlight";default:return""}}static get Qrf(){return"zh-CN"===window.navigator.language}static nLi(b,h){1===h?(v.ULS.sendTraceTag(17151569,306,50,"User Directed to App Store"),b=pd.oMh(b,h),8<X.a.rZa?Ed.a.Cm(b,void 0,void 0,"RedirectToAppStore"):Ed.a.tzb(b)):document.hidden||(pd.Qrf?(b=t.AFrameworkApplication.K.appSettings.WildFireUrlChinaStoreAndroid.toString())?
(v.ULS.sendTraceTag(18088018,306,50,"User Directed to China Proxy Page"),Ed.a.tzb(b)):v.ULS.sendTraceTag(18088019,306,50,"Empty Url in China Proxy Page BRS Setting"):(v.ULS.sendTraceTag(18088020,306,50,"User Directed to Play Store"),MSOJS.ClientUtils.NavigateToUrlUsingClickingOnATag(pd.oMh(b,h),null,null)))}static Pbh(b){switch(b){case 3:return 5;case 2:return 3;case 1:return 1;default:return 0}}static get p8d(){return(X.a.TMa||X.a.xl)&&X.a.rp}static get dVn(){return X.a.ki||X.a.ML}static HMh(b){switch(b){case 3:return"WordBizBarDismiss";
case 2:return"PptBizBarDismiss";case 1:return"ExcelBizBarDismiss";default:return""}}static vei(b){return(b=pd.swl(b))&&""!==b?Boolean.parse(b):!1}static rZf(b){pd.mLn(b)}static swl(b){try{return localStorage.getItem(b)}catch(h){return v.ULS.sendTraceTag(18416668,306,50,"WildFire LocalStorage GetItem Failed with NullReferenceException : "+h.message),null}}static mLn(b){try{localStorage.setItem(b,"true")}catch(h){v.ULS.sendTraceTag(18416669,306,50,"WildFire LocalStorage SetItem Failed with exception : "+
h.message)}}}pd.pmh="ChromeExtensionBarDismiss";Object(n.a)(pd,"WildFireUtilities",null,[]);var Ub=d(387);class uc{constructor(){this.Lhe=new Ub.a;this.Jhe=new Ub.a;this.Ihe=new Ub.a;this.Ikk(this.Lhe);this.Hkk(this.Jhe);this.Gkk(this.Ihe);this.jse=new Ub.a;this.ise=new Ub.a;this.hse=new Ub.a;this.Nnk(this.jse);this.Mnk(this.ise);this.Lnk(this.hse);this.ike=new Ub.a;this.Ukk(this.ike);this.Tub(this.ike);this.Tub(this.Ihe);this.Tub(this.Jhe);this.Tub(this.Lhe);this.Tub(this.ise);this.Tub(this.jse);
this.Tub(this.hse)}lId(b,h){switch(b){case 1:return this.yQl(h);case 2:return this.cil(h)}return pd.p8d?this.ike:null}Ikk(b){b.add("Headline",CommonUIStrings.l_WildFireWordBizBarHeadline);b.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);b.add("CallToAction",CommonUIStrings.l_WildFireWordBizBarAndroidCallToAction)}Hkk(b){b.add("Headline",CommonUIStrings.l_WildFirePPTBizBarHeadline);b.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);b.add("CallToAction",CommonUIStrings.l_WildFirePPTBizBarAndroidCallToAction)}Gkk(b){b.add("Headline",
CommonUIStrings.l_WildFireExcelBizBarHeadline);b.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);b.add("CallToAction",CommonUIStrings.l_WildFireExcelBizBarAndroidCallToAction)}Nnk(b){b.add("Headline",CommonUIStrings.l_WildFireWordBizBarHeadline);b.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);b.add("InstallButton",CommonUIStrings.l_WildFireBizBarInstallButtonText);b.add("OpenAppButton",CommonUIStrings.l_WildFireBizBarOpenAppButtonText);b.add("CallToAction",
CommonUIStrings.l_WildFireWordBizBarIPadCallToAction);b.add("OverlayBig","Get the Word app");b.add("OverlaySmall","Built for the iPad\u2014for when you're working on the go, even offline.");b.add("OverlaySmallSplit1","Discover Word");b.add("OverlaySmallSplit2","designed for the iPad.");b.add("SkipButton","Skip for now")}Ukk(b){b.add("Headline","Get the Office Online extension for Chrome");b.add("UseAppButton","Get the extension");b.add("CallToAction","The quickest way to view, edit, and share Office files in Chrome.")}Mnk(b){b.add("Headline",
CommonUIStrings.l_WildFirePPTBizBarHeadline);b.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);b.add("InstallButton",CommonUIStrings.l_WildFireBizBarInstallButtonText);b.add("OpenAppButton",CommonUIStrings.l_WildFireBizBarOpenAppButtonText);b.add("CallToAction",CommonUIStrings.l_WildFirePPTBizBarIPadCallToAction);b.add("OverlayBig","Get the PowerPoint app");b.add("OverlaySmall","Built for the iPad\u2014for when you're working on the go, even offline.");b.add("OverlaySmallSplit1",
"Discover PowerPoint");b.add("OverlaySmallSplit2","designed for the iPad.");b.add("SkipButton","Skip for now")}Lnk(b){b.add("Headline",CommonUIStrings.l_WildFireExcelBizBarHeadline);b.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);b.add("InstallButton",CommonUIStrings.l_WildFireBizBarInstallButtonText);b.add("OpenAppButton",CommonUIStrings.l_WildFireBizBarOpenAppButtonText);b.add("CallToAction",CommonUIStrings.l_WildFireExcelBizBarIPadCallToAction)}Tub(b){b.add("Corporation",
"Microsoft Corporation")}yQl(b){switch(b){case 3:return this.jse;case 2:return this.ise;case 1:return this.hse}return null}cil(b){switch(b){case 3:return this.Lhe;case 2:return this.Jhe;case 1:return this.Ihe}return null}static get instance(){uc._instance||(uc._instance=new uc);return uc._instance}}uc._instance=null;Object(n.a)(uc,"WildFireStringFactory",null,[]);class Tc{constructor(b,h,r,z,R=null,ba=null){this.gBe=null;this._id=b;this.OCe=h;this.BFj=R;this.Fpc=z;this.Wuc=ba;this.q5a=null;this.lxc=
r;this.ewc=uc.instance.lId(h,b)}eIk(){this.q5a=new sc.a(this.title,this.message,null);this.q5a.addButton(this.aok,Object(u.a)(this,this.CPm,"onButtonOneClick"),"");this.lxc&&this.q5a.i9g(this.gok,Object(u.a)(this,this.HPm,"onButtonTwoClick"));this.q5a.aka=Object(u.a)(this,this.bXk,"dismissBar");this.q5a.image=3;this.q5a.id=16;this.q5a.closeable=!0}get title(){return this.ewc.J("Headline")}get message(){return this.ewc.J("CallToAction")}get aok(){return this.lxc?this.ewc.J("InstallButton"):this.ewc.J("UseAppButton")}get gok(){return this.lxc?
this.ewc.J("OpenAppButton"):""}CPm(){this.lxc?this.$6l():this.Qno()}HPm(){this.lxc&&this.yZm()}get bih(){return this.q5a}get f1a(){this.gBe||(this.gBe=this.BFj());return this.gBe}$6l(){v.ULS.sendTraceTag(17932829,306,50,"Install App Button of BusinessBar Clicked");this.Fpc&&this.Wuc&&this.Wuc();pd.nLi(this._id,this.OCe)}yZm(){this.f1a&&(v.ULS.sendTraceTag(17932830,306,50,"Open App Button of BusinessBar Clicked"),this.Fpc&&this.Wuc&&this.Wuc(),MSOJS.ClientUtils.OpenDocumentWithProtocolHandlerNoCallBack(pd.Pbh(this._id),
this.f1a,0,!1))}Qno(){pd.p8d?this.Xnk():(v.ULS.sendTraceTag(17109255,306,50,"AppBusinessBarNav"),pd.rZf("BizBarClicked"),1!==this.OCe&&2!==this.OCe||pd.Exk(this.f1a,this.Fpc,this._id,this.Wuc))}Xnk(){this.Fpc?v.ULS.sendTraceTag(17571974,323,50,"ChromeExtBannerClicked"):v.ULS.sendTraceTag(17571975,301,50,"ChromeExtBannerClicked");Ed.a.tzb(t.AFrameworkApplication.K.appSettings.WildFireChromeExtensionUrl.toString())}cXk(){this.Fpc?v.ULS.sendTraceTag(17571976,323,50,"ChromeExtBannerDismissed"):v.ULS.sendTraceTag(17571977,
301,50,"ChromeExtBannerDismissed");pd.rZf(pd.pmh)}bXk(){pd.p8d?this.cXk():(pd.rZf(pd.HMh(this._id)),v.ULS.sendTraceTag(17109256,306,50,"AppBusinessBarDismissed"))}static c1e(){const b=t.AFrameworkApplication.ua.Sb;new Tc(b.jo,pd.TId(),8<X.a.rZa,1===b.Mfa,()=>b.yda,b.KVf());v.ULS.sendTraceTag(9208407,306,50,"AppBusinessBarDisplayed")}}Object(n.a)(Tc,"WildFireBusinessBar",null,[]);class qd{get name(){return"Common.App.WildFire"}MNe(b){const h=t.AFrameworkApplication.ua.Sb;let r=!1;b&&(b.eIk(),b.bih&&
(r=h.lVa(b.bih,!0)));return r}lIk(){var b=t.AFrameworkApplication.ua.Sb;b=new Tc(b.jo,pd.TId(),!1,1===b.Mfa);this.MNe(b)&&v.ULS.sendTraceTag(17571982,306,50,"ChromeExtBannerDisplayed")}c1e(b,h,r,z,R,ba){b=new Tc(b,r,z,h,R,ba);this.MNe(b)&&v.ULS.sendTraceTag(9208407,306,50,"AppBusinessBarDisplayed")}KOk(){const b=t.AFrameworkApplication.ua.Sb;var h=t.AFrameworkApplication.K;const r=b.jo,z=1===b.Mfa;if(h.$(pd.vPl(r))){var R=pd.TId(),ba=8<X.a.rZa;if(2!==r||2!==R||!z){h=h.$(pd.wPl(r));var ta=b.KVf(),
Wa=()=>b.yda;h&&!pd.vei(pd.HMh(r))&&this.c1e(r,z,R,ba,Wa,ta)}}}init(){var b=t.AFrameworkApplication.K;const h=b.$("WildFireChromeExtensionEnabled");b=b.$("WildFireChromeExtensionBar")&&h;pd.p8d&&b&&!pd.vei(pd.pmh)?this.lIk():(document.body&&pd.dVn&&this.KOk(),t.AFrameworkApplication.ya.pa(ab.a.Xvf,Yd.a.frame,Object(u.a)(this,this.Xvf,"launchWildFireBusinessBar")))}Xvf(b,h,r,z,R){if(1===r)return 32;if(!R)return 8;this.c1e(R.app,R.mode,R.platform,R.useTwoButton,null,null);return 32}dispose(){}yc(){}static main(){O.a.instance.Oc(new qd)}}
Object(n.a)(qd,"PackageManager",null,[1,2]);class re{constructor(){this.WinOrientation=this.DocElemClientHeight=this.DocElemClientWidth=this.DocElemOffsetHeight=this.DocElemOffsetWidth=this.ScreenAvailWidth=this.ScreenAvailHeight=this.ScreenLogicalYdpi=this.ScreenLogicalXdpi=this.ScreenDeviceYdpi=this.ScreenDeviceXdpi=this.CalculatedDevicePixelRatio=this.WinDevicePixelRatio=this.WinOuterWidth=this.WinOuterHeight=this.WinInnerHeight=this.WinInnerWidth=this.ScreenHeight=this.ScreenWidth=0;this.SupportsTouch=
!1;this.Error=this.NavLanguage=this.NavAppVersion=this.NavAppName=this.NavPlatform=this.NavUserAgent=this.NavPlugins=null}}Object(n.a)(re,"BrowserInfo",null,[]);class Je{constructor(){this.Version=this.Name=null}}Object(n.a)(Je,"PluginInfo",null,[]);class Jf{static jua(){if(t.AFrameworkApplication.K.$("LogBrowserInfoIsEnabled")){var b=Jf.Rel();try{const h=JSON.stringify(b);v.ULS.sendTraceTag(6903563,102,50,h)}catch(h){v.ULS.sendTraceTag(6903564,102,15,h.message)}}else v.ULS.sendTraceTag(6903562,102,
50,"Detailed browser info logging is turned off")}static jEl(){const b=window.navigator.plugins;if(!b||!b.length)return null;const h=[];for(let r=0;r<b.length;r++){const z=b[r].name,R=b[r].version;Array.add(h,Object.assign(new Je,{Name:z,Version:R}))}return h}static Rel(){const b=new re,h=new Sys.StringBuilder;Jf.$G(r=>{b.DocElemClientHeight=r},()=>document.documentElement.clientHeight,h);Jf.$G(r=>{b.DocElemClientWidth=r},()=>document.documentElement.clientWidth,h);Jf.$G(r=>{b.DocElemOffsetHeight=
r},()=>document.documentElement.offsetHeight,h);Jf.$G(r=>{b.DocElemOffsetWidth=r},()=>document.documentElement.offsetWidth,h);Jf.$G(r=>{b.ScreenAvailHeight=r},()=>window.screen.availHeight,h);Jf.$G(r=>{b.ScreenAvailWidth=r},()=>window.screen.availWidth,h);Jf.$G(r=>{b.ScreenWidth=r},()=>window.screen.width,h);Jf.$G(r=>{b.ScreenHeight=r},()=>window.screen.height,h);Jf.$G(r=>{b.ScreenLogicalXdpi=r},()=>window.screen.logicalXDPI,h);Jf.$G(r=>{b.ScreenLogicalYdpi=r},()=>window.screen.logicalYDPI,h);Jf.$G(r=>
{b.ScreenDeviceXdpi=r},()=>window.screen.deviceXDPI,h);Jf.$G(r=>{b.ScreenDeviceYdpi=r},()=>window.screen.deviceYDPI,h);Jf.$G(r=>{b.WinInnerHeight=r},()=>window.self.innerHeight,h);Jf.$G(r=>{b.WinInnerWidth=r},()=>window.self.innerWidth,h);Jf.$G(r=>{b.WinOuterHeight=r},()=>window.self.outerHeight,h);Jf.$G(r=>{b.WinOuterWidth=r},()=>window.self.outerWidth,h);Jf.$G(r=>{b.WinOrientation=r},()=>window.self.orientation,h);Jf.$G(r=>{b.WinDevicePixelRatio=r},()=>window.self.devicePixelRatio,h);Jf.$G(r=>{b.SupportsTouch=
r},()=>X.a.C1c,h);Jf.$G(r=>{b.NavAppName=r},()=>window.navigator.appName,h);Jf.$G(r=>{b.NavAppVersion=r},()=>window.navigator.appVersion,h);Jf.$G(r=>{b.NavLanguage=r},()=>window.navigator.browserLanguage||window.navigator.language,h);Jf.$G(r=>{b.NavUserAgent=r},()=>window.navigator.userAgent,h);Jf.$G(r=>{b.NavPlatform=r},()=>window.navigator.platform,h);Jf.$G(r=>{b.NavPlugins=r},Jf.jEl,h);Jf.$G(r=>{b.CalculatedDevicePixelRatio=r},()=>Jf.devicePixelRatio,h);b.Error=h.toString();return b}static get devicePixelRatio(){const b=
window.devicePixelRatio;return isNaN(b)?window.screen.deviceXDPI/window.screen.logicalXDPI:b}static $G(b,h,r){try{const z=h();b(z)}catch(z){r.isEmpty()||r.append(" | "),r.append(z.message||"null")}}}Object(n.a)(Jf,"BrowserInfoLogger",null,[]);class Ig{get name(){return"Common.App.BrowserInfoLogger"}yc(){}init(){Jf.jua()}dispose(){}static main(){O.a.instance.Oc(new Ig)}}Object(n.a)(Ig,"BrowserInfoLoggerPackage",null,[1,2]);class pb{constructor(){this.sa=new Te.a}lvb(b){this.sa.addHandler("OnEditHappenedEvent",
b)}O3d(b){this.sa.removeHandler("OnEditHappenedEvent",b)}Xdn(){this.sa.raiseEvent("OnEditHappenedEvent")}}Object(n.a)(pb,"EditNotificationEventSource",null,[]);var Lb=d(57),Ic=d(80);class Ad{constructor(b,h,r,z,R,ba,ta=0){this.ioe=!1;this.hoe=this.Hrb=null;this.Z4g=!1;this.Hb=h;this.Kgd=b;this.v7a=r;this.v4=z;this.X4g=R;this.fCj=ba;this.l$c=0;this.tbd=!1;try{0<ta&&(this.l$c=ta,3E5>this.l$c&&(this.l$c=3E5),this.Hb&&!this.hoe&&(this.hoe=new Ic.a(3,2,this.l$c,Object(u.a)(this,this.Xun,"reportEditDocumentUserActionTelemetryIfNecessary")),
this.Hb.$b(this.hoe)))}catch(Wa){v.ULS.sendTraceTag(51246176,383,50,"Hit an exception while trying to queue up the EditDocument user action reporting interval: "+Wa)}}get Rjj(){return this.Z4g}oAd(){this.Rjj?this.tbd=!0:(this.Z4g=!0,Ca.Health.instance.addQosPillar("Save"),Ca.Health.instance.addQosPillar("ContentCreation"),Lb.c(ab.a.editDocument));this.ioe=!0;this.X4g&&this.X4g.g7g();this.v4&&this.v4.Xdn();t.AFrameworkApplication.jh&&t.AFrameworkApplication.jh.AEm();this.fCj&&!this.Hrb&&(this.QZc(null),
this.Hrb=new Ic.a(3,2,this.Kgd,Object(u.a)(this,this.QZc,"sendPostMessageIfNecessary"),113),this.Hb.$b(this.Hrb))}QZc(){this.ioe&&(this.v7a.CWR(()=>this.v7a.result.sendMessage(F.a.editNotification,null)),v.ULS.sendTraceTag(38086292,209,50,"EditNotificationManager: sending post message to the host."),this.ioe=!1)}Xun(){try{this.tbd&&(Lb.c(ab.a.editDocument),this.tbd=!1)}catch(b){this.tbd=!1,v.ULS.sendTraceTag(51246177,383,50,"Hit an exception while trying to send the EditDocument user action: "+b)}}}
Object(n.a)(Ad,"EditNotificationManager",null,[684]);class oe{constructor(b,h,r,z,R){this.kre=this.Hrb=null;this.tSa=this.ahe=!1;this.Hb=h;this.Kgd=b;this.v7a=r;this.Kj=z;this.BAe=R;this.dMi(null)}dMi(){const b=document.getElementById(t.AFrameworkApplication.FXb);!this.tSa&&this.Kj&&b&&(this.Kj.mb(jb.a.rX,b,Object(u.a)(this,this.zAf,"mouseActivityHandler"),null),this.tSa=!0);this.BAe(()=>{this.dispose()})}zAf(){this.tSa&&(this.Kj.sc(jb.a.rX,document.getElementById(t.AFrameworkApplication.FXb),Object(u.a)(this,
this.zAf,"mouseActivityHandler")),this.tSa=!1);this.g7g();return!1}g7g(){this.ahe=!0;this.kre||(this.kre=new Ic.a(3,2,this.Kgd,Object(u.a)(this,this.dMi,"registerHandlerTask"),112),this.Hb.$b(this.kre));this.Hrb||(this.QZc(null),this.Hrb=new Ic.a(3,2,this.Kgd,Object(u.a)(this,this.QZc,"sendPostMessageIfNecessary"),111),this.Hb.$b(this.Hrb))}QZc(){this.ahe&&(this.v7a.CWR(()=>this.v7a.result.sendMessage(F.a.noo,null)),v.ULS.sendTraceTag(38405446,209,50,"UserActivityHostNotificationManager: sending post message to the host."),
this.ahe=!1)}dispose(){this.tSa&&(this.Kj.sc(jb.a.rX,document.getElementById(t.AFrameworkApplication.FXb),Object(u.a)(this,this.zAf,"mouseActivityHandler")),this.tSa=!1)}}Object(n.a)(oe,"UserActivityHostNotificationManager",null,[683,9]);var gf=d(166),Oe=d(82),Sg=d(741);class Ng{constructor(){this.W=null}get name(){return"Common.App.EditNotification"}init(){t.AFrameworkApplication.K&&t.AFrameworkApplication.K.zq(Object(u.a)(this,this.ax,"onFullAppSettingsReady"))}ax(){Ng.U_k&&0<Ng.V5e&&(this.W.register(pb,
"Common.App.HostNotification.EditNotificationEventSource").singleInstance(),this.W.register(oe,"Common.App.HostNotification.UserActivityHostNotificationManager").as("Common.Interface.IUserActivityHostNotificationManager").singleInstance().Yd(()=>new oe(6E4,Oe.a.instance,Sg.a.Kq(this.W.Za("Postmessage.IHostPostmessenger")),gf.a.instance,t.AFrameworkApplication.xK)),this.W.register(Ad,"Common.App.HostNotification.EditNotificationManager").as("Common.Interface.IEditNotificationManager").singleInstance().Yd(()=>
new Ad(Ng.V5e,Oe.a.instance,Sg.a.Kq(this.W.Za("Postmessage.IHostPostmessenger")),this.W.resolve("Common.App.HostNotification.EditNotificationEventSource"),this.W.Pa("Common.Interface.IUserActivityHostNotificationManager"),Ng.V_k,Ng.P_k)),this.W.resolve("Common.Interface.IEditNotificationManager"),v.ULS.shipAssertTag(38086291,209,0<Ng.V5e,"EditNotification Interval is less than or equal to 0."))}yc(b){this.W=b}dispose(){}static get V5e(){return t.AFrameworkApplication.K?parseInt(t.AFrameworkApplication.K.appSettings.EditNotificationTimeIntervalMs||
"300000"):3E5}static get P_k(){return t.AFrameworkApplication.K?parseInt(t.AFrameworkApplication.K.appSettings.EditDocumentUserActionTelemetryReportingIntervalInMilliseconds||"0"):0}static get U_k(){return!!t.AFrameworkApplication.K&&t.AFrameworkApplication.K.$("EditNotificationIsEnabled")}static get V_k(){return!!t.AFrameworkApplication.K&&t.AFrameworkApplication.K.$("EditNotificationPostMessageIsEnabled")}static main(){O.a.instance.Oc(new Ng)}}Object(n.a)(Ng,"CommonHostNotificationPackage",null,
[1,2]);class Nh{constructor(b,h,r){this.ytb=null;this.Hb=b;this.ga=h;this.UEg=r.create()}wjb(){this.ytb?v.ULS.sendTraceTag(23674911,207,50,"The current task is not null, re-use it."):(v.ULS.sendTraceTag(23674910,207,50,"The current sho pane task is null, create new one."),this.ytb=new Ic.a(2,1,3E4,Object(u.a)(this,this.A8d,"showFloatPane"),67),this.Hb.$b(this.ytb))}A8d(){this.ytb=null;v.ULS.sendTraceTag(23674912,207,50,"The float pane is shown after the task is executed.");this.UEg.display()}GOa(){this.ga.pa(ab.a.A8d,
Yd.a.frame,Object(u.a)(this,this.lXn,"showFloatPaneHandler"))}lXn(b,h,r,z,R){return b!==ab.a.A8d?2:1===r?32:2===r&&R?(v.ULS.sendTraceTag(23674913,207,50,"The application wants to show or hide float pane with argument {0}.",R),R?this.wjb():(this.ytb?(v.ULS.sendTraceTag(23674914,207,50,"Hide float pane via removing show task!"),this.Hb.We(this.ytb)):(v.ULS.sendTraceTag(23674915,207,50,"Hide float pane immediately!"),this.UEg.remove(null)),this.ytb=null),32):8}}Object(n.a)(Nh,"FloatPaneActor",null,[680]);
var Eg=d(90),Wh=d(96),Bf=d(29),vf=d(27);class Fj{constructor(b,h,r,z,R){this.Rxe=this.xoc=this.Vjd=this.UTa=this.Eca=this.mRa=this.$ie=this.J8=this.gtc=this.Wqc=this.Xqc=this.Tpe=null;this.Hb=h;this.Oa=b;this.ig=r;this.W=R;this.Hwa=z}nth(){this.J8=document.createElement("div");this.J8.className=String.format("{0} {1}","WACFloatPane","WACFloatPaneFadeIn");this.J8.style.width=this.Eca.width+"px";(this.Rxe=this.gBl(this.Hwa))?(this.UTa=document.createElement("a"),this.UTa.setAttribute(vf.a.Ch,vf.a.Az),
this.ig.mb(jb.a.click,this.UTa,Object(u.a)(this,this.vzi,"onRedirectClick")),this.UTa.href=this.Rxe,this.UTa.target="_blank",this.UTa.appendChild(this.Eca),this.J8.appendChild(this.UTa)):this.J8.appendChild(this.Eca);this.mRa=document.createElement("a");this.mRa.setAttribute(vf.a.Ch,vf.a.t1);this.mRa.className="StandardButton WACFloatPaneCloseButton";this.mRa.title=CommonUIStrings.l_Close;this.mRa.tabIndex=-1;this.$ie=Wh.createClusteredImage(16,16,"ClosePaneGlyph_16x16x32","StandardButtonImage clip16x16 StandardButtonImageNoText",
!0,null);this.$ie.setAttribute(vf.a.Ch,vf.a.Az);this.mRa.appendChild(this.$ie);this.ig.mb(jb.a.click,this.mRa,Object(u.a)(this,this.onClose,"onClose"));this.J8.appendChild(this.mRa);this.gtc.appendChild(this.J8)}mvl(b){const h=this.Oa.$("O365PromotionHasStarted");switch(b){case 2:return Eg.a.G9(String.format("adppt{0}.png",h?"sale":""));case 1:return Eg.a.G9(String.format("adxls{0}.png",h?"sale":""));case 3:return Eg.a.G9(String.format("addoc{0}.png",h?"sale":""))}return null}gBl(b){const h=this.Oa.lb("O365AdPaneRedirectedURL");
switch(b){case 1:return String.format(h,"Excel");case 2:return String.format(h,"PowerPoint");case 3:return String.format(h,"Word")}return null}hide(b=null){this.xoc=null;this.J8&&!this.Vjd&&(b?v.ULS.sendTraceTag(23674904,207,50,"The float pane is closed automatically."):v.ULS.sendTraceTag(23674903,207,50,"User clicks button to close the float pane."),this.J8.className=String.format("{0} {1}","WACFloatPane","WACFloatPaneFadeOut"),this.J8.style.height="0px",this.Vjd=new Ic.a(2,1,1E3,Object(u.a)(this,
this.remove,"remove"),67),this.Hb.$b(this.Vjd))}remove(){this.J8&&this.gtc&&(this.UTa&&this.ig.sc(jb.a.click,this.UTa,Object(u.a)(this,this.vzi,"onRedirectClick")),this.ig.sc(jb.a.click,this.mRa,Object(u.a)(this,this.onClose,"onClose")),this.gtc.removeChild(this.J8),this.J8=null);this.Vjd=null}display(){if(this.Tpe=this.W.Pa("Common.IFloatPaneContainer"))if(this.gtc=this.Tpe.container){var b=this.mvl(this.Hwa);b?(v.ULS.sendTraceTag(23674908,207,50,"Begin downloading image from server: {0}.",b),this.Eca=
document.createElement("img"),this.Eca.className="WACFloatPaneImage",this.Xqc=Object(u.a)(this,this.bUm,"onLoadImageFinish"),Bf.a.addHandler(this.Eca,jb.a.load,this.Xqc),this.Wqc=Object(u.a)(this,this.aUm,"onLoadImageError"),Bf.a.addHandler(this.Eca,jb.a.error,this.Wqc),this.Eca.src=b):v.ULS.sendTraceTag(23674907,207,15,"The target image is empty, can't show the float pane.")}else v.ULS.sendTraceTag(23674906,207,15,"The container is empty, so the float pane can't be shown.");else v.ULS.sendTraceTag(23674905,
207,50,"The IFloatPaneContainer is not registered and the float pane can't be shown.")}bUm(){const b=this.Oa.rc("O365AdPaneShowingDuration",60);this.nth();this.J8.style.display="block";this.J8.style.height=this.Eca.height+"px";this.xoc=new Ic.a(2,1,1E3*b,Object(u.a)(this,this.hide,"hide"),67);this.Hb.$b(this.xoc);this.KNi()}aUm(){v.ULS.sendTraceTag(23674909,207,15,"The image can't be downloaded, the float pane can't be shown.");this.KNi();this.Eca=null}KNi(){this.Xqc&&this.Eca&&Bf.a.removeHandler(this.Eca,
jb.a.load,this.Xqc);this.Xqc=null;this.Wqc&&this.Eca&&Bf.a.removeHandler(this.Eca,jb.a.error,this.Wqc);this.Wqc=null}vzi(){v.ULS.sendTraceTag(35698659,207,50,"User click the float pane and a new web page will be opened.");return!1}onClose(){this.xoc&&this.Hb.We(this.xoc);this.hide();return!0}dispose(){this.hide()}}Object(n.a)(Fj,"FloatPane",null,[702]);class Pe{constructor(b,h,r,z,R){this.Hb=h;this.Oa=b;this.ig=r;this.W=R;this.Hwa=z}create(){return new Fj(this.Oa,this.Hb,this.ig,this.Hwa,this.W)}}
Object(n.a)(Pe,"FloatPaneFactory",null,[678]);var sf=d(204);class Xf{constructor(){this.W=null}get name(){return"Common.App.FloatPane"}get Rci(){return t.AFrameworkApplication.K.$("O365AdvertisementIsEnabled")&&t.AFrameworkApplication.K.$("IsShowAdvertisementPaneEnabled")}init(){this.Rci&&(v.ULS.sendTraceTag(23674944,207,50,"Setup task to show the float pane."),this.W.resolve("Common.App.FloatPane.IFloatPaneActor").wjb(),v.ULS.sendTraceTag(23674945,207,50,"Setup action for excel to show the float pane."),
this.W.resolve("Common.App.FloatPane.IFloatPaneActor").GOa())}yc(b){this.W=b;this.Rci&&(this.W.register(Pe,"Common.App.FloatPane.FloatPaneFactory").as("Common.App.FloatPane.IFloatPaneFactory").Yd(()=>new Pe(t.AFrameworkApplication.K,t.AFrameworkApplication.uc,sf.a.instance,t.AFrameworkApplication.ua.Sb.jo,this.W)).singleInstance(),this.W.register(Nh,"Common.App.FloatPane.FloatPaneActor").as("Common.App.FloatPane.IFloatPaneActor").Yd(()=>new Nh(t.AFrameworkApplication.uc,t.AFrameworkApplication.ya,
this.W.resolve("Common.App.FloatPane.IFloatPaneFactory"))).singleInstance())}dispose(){}static main(){O.a.instance.Oc(new Xf)}}Object(n.a)(Xf,"FloatPanePackage",null,[1,2]);var Se=d(1606);class $f{}Object(n.a)($f,"LokiTokenResult",null,[]);class Jg{constructor(b){this.Ugd=b}uff(){const b=this.uyl();return b?Jg.ksf?new Promise((h,r)=>{this.Ugd.continueWith(()=>{this.Ugd.ho||this.Ugd.Ji?r(Error.create("Error downloading auth library")):this.Ugd.result.uoa("Loki",b).then(z=>{z=t.AFrameworkApplication.K.$("ForceLokiFallbackToACLPTokenIsEnabled")?
this.xyl():z.IsSuccess&&z.Token?Object.assign(new $f,{isSuccess:!0,token:z.Token,errorMessage:null}):Object.assign(new $f,{isSuccess:!1,token:null,errorMessage:JSON.stringify(z)});h(z);return z})})}):Promise.resolve(Object.assign(new $f,{isSuccess:!1,token:null,errorMessage:"Not attempting to fetch token because host is not an O365 host."})):Promise.resolve(Object.assign(new $f,{isSuccess:!1,token:null,errorMessage:String.format("Could not get Loki App Id for HostAuthorityType: [{0}]",Se.a.vMh())}))}xyl(){const b=
t.AFrameworkApplication.K.lb("LokiUserDataSignature")||"";return Object.assign(new $f,{isSuccess:!0,token:b,errorMessage:null})}uyl(){let b=null;const h=Se.a.oEd();2===h?b=t.AFrameworkApplication.K.lb("LokiAADAppId"):1===h&&(b=t.AFrameworkApplication.K.lb("LokiMSAAppId"));return b}static get ksf(){return t.AFrameworkApplication.K.$("IsO365CommercialHost")||t.AFrameworkApplication.K.$("IsO365ConsumerHost")}}Object(n.a)(Jg,"LokiTokenManager",null,[676]);class fg{get name(){return"Common.App.LivePersonaUtils"}init(){Sa.a.instance.resolve("Common.ILokiTokenManager")}dispose(){}yc(b){b.register(Jg,
"Common.App.LivePersonaUtils.LokiTokenManager").as("Common.ILokiTokenManager").singleInstance().Yd(()=>new Jg(Sg.a.Kq(b.Za("Common.App.OAuth.IOAuthManager"))))}static main(){O.a.instance.Oc(new fg)}}Object(n.a)(fg,"LivePersonaUtilsPackage",null,[1,2]);class Lg{constructor(b){this.Ehe=b}bci(b){if(!this.Ehe)return!0;b=Rc.a.Cef(b);if(!b)return!1;b=b.toLowerCase();for(let h=0;h<this.Ehe.length;h++)if(b.endsWith(this.Ehe[h]))return!0;return!1}}Object(n.a)(Lg,"DomainAllowListManager",null,[]);class Af{constructor(b,
h){this.Y1e=null;this.mKe=b;this.url=h}get t9f(){return Rc.a.nva(this.url)}get Cr(){return this.mKe}I5f(){const b={},h=this.Cr;b.a=this.t9f;b.b=this.round(h.navigationStart);b.c=this.round(h.unloadEventStart);b.d=this.round(h.unloadEventEnd);b.e=this.round(h.redirectStart);b.f=this.round(h.redirectEnd);b.g=this.round(h.fetchStart);b.h=this.round(h.domainLookupStart);b.i=this.round(h.domainLookupEnd);b.j=this.round(h.connectStart);b.k=this.round(h.connectEnd);b.l=void 0!==h.secureConnectionStart&&
null!==h.secureConnectionStart?this.round(h.secureConnectionStart):0;b.m=this.round(h.requestStart);b.n=this.round(h.responseStart);b.o=this.round(h.responseEnd);b.q=this.round(h.domInteractive);b.r=this.round(h.domContentLoadedEventStart);b.s=this.round(h.domContentLoadedEventEnd);b.t=this.round(h.domComplete);b.u=this.round(h.loadEventStart);b.v=this.round(h.loadEventEnd);b.w=this.Y1e;return b}round(b){return Math.round(1E3*b)/1E3}}Object(n.a)(Af,"PerformanceTimingEntry",null,[]);const Jh=(b,h)=>
{const r={};let z=null;switch(b){case 0:z="ResourceTiming";b=h.a;null!=b&&(r.Url=b);b=h.b;null!=b&&(r.InitiatorType=b);b=null==h.c?null:h.c.toString();null!=b&&(r.RedirectStart=b);b=null==h.d?null:h.d.toString();null!=b&&(r.RedirectEnd=b);b=null==h.e?null:h.e.toString();null!=b&&(r.FetchStart=b);b=null==h.f?null:h.f.toString();null!=b&&(r.DomainLookupStart=b);b=null==h.g?null:h.g.toString();null!=b&&(r.DomainLookupEnd=b);b=null==h.h?null:h.h.toString();null!=b&&(r.ConnectStart=b);b=null==h.i?null:
h.i.toString();null!=b&&(r.ConnectEnd=b);b=null==h.j?null:h.j.toString();null!=b&&(r.SecureConnectionStart=b);b=null==h.k?null:h.k.toString();null!=b&&(r.RequestStart=b);b=null==h.l?null:h.l.toString();null!=b&&(r.ResponseStart=b);b=null==h.m?null:h.m.toString();null!=b&&(r.ResponseEnd=b);b=h.n;null!=b&&(r.CustomText=b);b=null==h.o?null:h.o.toString();null!=b&&(r.DecodedBodySize=b);b=null==h.p?null:h.p.toString();null!=b&&(r.EncodedBodySize=b);h=null==h.q?null:h.q.toString();null!=h&&(r.TransferSize=
h);break;case 1:z="PerformanceTiming",b=h.a,null!=b&&(r.Url=b),b=null==h.b?null:h.b.toString(),null!=b&&(r.NavigationStart=b),b=null==h.c?null:h.c.toString(),null!=b&&(r.UnloadEventStart=b),b=null==h.d?null:h.d.toString(),null!=b&&(r.UnloadEventEnd=b),b=null==h.e?null:h.e.toString(),null!=b&&(r.RedirectStart=b),b=null==h.f?null:h.f.toString(),null!=b&&(r.RedirectEnd=b),b=null==h.g?null:h.g.toString(),null!=b&&(r.FetchStart=b),b=null==h.h?null:h.h.toString(),null!=b&&(r.DomainLookupStart=b),b=null==
h.i?null:h.i.toString(),null!=b&&(r.DomainLookupEnd=b),b=null==h.j?null:h.j.toString(),null!=b&&(r.ConnectStart=b),b=null==h.k?null:h.k.toString(),null!=b&&(r.ConnectEnd=b),b=null==h.l?null:h.l.toString(),null!=b&&(r.SecureConnectionStart=b),b=null==h.m?null:h.m.toString(),null!=b&&(r.RequestStart=b),b=null==h.n?null:h.n.toString(),null!=b&&(r.ResponseStart=b),b=null==h.o?null:h.o.toString(),null!=b&&(r.ResponseEnd=b),b=null==h.p?null:h.p.toString(),null!=b&&(r.DomLoading=b),b=null==h.q?null:h.q.toString(),
null!=b&&(r.DomInteractive=b),b=null==h.r?null:h.r.toString(),null!=b&&(r.DomContentLoadedEventStart=b),b=null==h.s?null:h.s.toString(),null!=b&&(r.DomContentLoadedEventEnd=b),b=null==h.t?null:h.t.toString(),null!=b&&(r.DomComplete=b),b=null==h.u?null:h.u.toString(),null!=b&&(r.LoadEventStart=b),b=null==h.v?null:h.v.toString(),null!=b&&(r.LoadEventEnd=b),h=h.w,null!=h&&(r.CustomText=h)}r.Table=z;return Sys.Serialization.JavaScriptSerializer.serialize(r)};var Vi=d(39),Ze=d(199),sd=d(155);class fh{constructor(b,
h=null,r=null){this.Mg=b;this.s9f=this;this.IEj=h||(()=>window.location.href);this.Qne=new Lg(r)}run(){if(fh.zab(window.performance))try{const R=this.IEj();if(fh.sYj.exec(R)&&this.Qne.bci(R)){var b=new Af(window.performance.timing,R);sd.a.instance.Ygn(b.Cr.fetchStart);sd.a.instance.Zgn(b.Cr.navigationStart);sd.a.instance.pX(Vi.a.gel,"connectStart","requestStart");sd.a.instance.pX(Vi.a.oel,"requestStart","responseStart");sd.a.instance.pX(Vi.a.sel,"responseStart","responseEnd");this.s9f.UEb(1,b.I5f());
this.Mg.Tf(Vi.a.adb,b.Cr.fetchStart);this.Mg.Tf(Vi.a.lel,b.Cr.domainLookupStart);this.Mg.Tf(Vi.a.kel,b.Cr.domainLookupEnd);this.Mg.Tf(Vi.a.iel,b.Cr.connectStart);this.Mg.Tf(Vi.a.vel,b.Cr.secureConnectionStart);this.Mg.Tf(Vi.a.hel,b.Cr.connectEnd);this.Mg.Tf(Vi.a.pel,b.Cr.requestStart);this.Mg.Tf(Vi.a.caf,b.Cr.responseStart);this.Mg.Tf(Vi.a.mel,b.Cr.responseEnd-b.Cr.responseStart);this.Mg.Tf(Vi.a.qel,b.Cr.responseStart-b.Cr.requestStart);var h=0,r=0,z=0;({transferSize:h,D6e:r,u2e:z}=this.Ico(R)).returnValue&&
(this.Mg.Tf(Vi.a.xel,h),this.Mg.Tf(Vi.a.jel,z),this.Mg.Tf(Vi.a.nel,r));this.Mg.Tf(Vi.a.NGc,b.Cr.navigationStart)}}catch(R){v.ULS.sendTraceTag(4551814,306,10,"Exception caught in PerformanceTimingLogger.Run: {0}",R)}}Ico(b){let h,r,z;z=r=h=-1;if(void 0===window.performance.getEntriesByName||null===window.performance.getEntriesByName)return{returnValue:!1,transferSize:h,D6e:r,u2e:z};b=window.performance.getEntriesByName(b,"navigation");if(void 0===b||null===b||1!==b.length)return{returnValue:!1,transferSize:h,
D6e:r,u2e:z};b=b[0];var R=b.transferSize;void 0!==h&&null!==h&&(h=R);R=b.decodedBodySize;void 0!==R&&null!==R&&(z=R);b=b.encodedBodySize;void 0!==b&&null!==b&&(r=b);return{returnValue:!0,transferSize:h,D6e:r,u2e:z}}UEb(b,h){v.ULS.sendTraceTag(4551815,306,50,Jh(b,h))}static get instance(){return fh._instance||(fh._instance=new fh(Ze.a.instance,null,t.AFrameworkApplication.K.$("PerfTimingLoggerFilterDomainsIsEnabled")?t.AFrameworkApplication.K.KB("ResourceLoggerDomainAllowList"):null))}static zab(b){return!(void 0===
b||null===b)&&!(void 0===b.timing||null===b.timing)}}fh._instance=null;fh.sYj=RegExp("^https?://.*","i");Object(n.a)(fh,"PerformanceTimingLogger",null,[677]);class vh{constructor(b,h){this.Y1e=null;this.mKe=b;this.behavior=h;this.url=this.Cr.name}get t9f(){return 2===this.behavior?this.url:Rc.a.nva(this.url)}get Cr(){return this.mKe}I5f(){const b={},h=this.Cr;b.a=this.t9f;b.b=h.initiatorType;b.c=this.round(h.redirectStart);b.d=this.round(h.redirectEnd);b.e=this.round(h.fetchStart);b.f=this.round(h.domainLookupStart);
b.g=this.round(h.domainLookupEnd);b.h=this.round(h.connectStart);b.i=this.round(h.connectEnd);b.j=void 0!==h.secureConnectionStart&&null!==h.secureConnectionStart?this.round(h.secureConnectionStart):0;b.k=this.round(h.requestStart);b.l=this.round(h.responseStart);b.m=this.round(h.responseEnd);b.o=this.round(vh.v3b(h,"decodedBodySize"));b.p=this.round(vh.v3b(h,"encodedBodySize"));b.q=this.round(vh.v3b(h,"transferSize"));b.n=this.Y1e;return b}round(b){return Math.round(1E3*b)/1E3}static v3b(b,h){return b[h]}}
Object(n.a)(vh,"ResourceTimingEntry",null,[719]);class am{constructor(b,h=null,r=100){this.Uug=b;this.Jmd=h;this.pjc={};this.cyj=r}sbo(b){var h=b.name.toLowerCase();const r=Rc.a.ugf(h);this.Qxn(r,h)&&(r in this.pjc?v.ULS.sendTraceTag(51652509,306,50,"AppStaticResourceManager: file downloaded multiple times {0}",r):(h={},h.fetchstart=b.fetchStart,h.responseend=b.responseEnd,h.iscached=this.fmm(b),h.encodedsize=vh.v3b(b,"encodedBodySize"),h.decodedsize=vh.v3b(b,"decodedBodySize"),this.pjc[r]=h))}Qxn(b,
h){if(this.Uug)return Array.contains(this.Uug,b);if(this.Jmd)for(b=Rc.a.i2(h),h=0;h<this.Jmd.length;h++)if(this.Jmd[h]&&b.endsWith(this.Jmd[h]))return!0;return!1}fmm(b){try{const h=vh.v3b(b,"transferSize");if(void 0!==h&&null!==h)return!h;v.ULS.sendTraceTag(51652510,306,50,"AppStaticResourceManager: No transfersize found, basing cache status from duration");return b.responseEnd-b.fetchStart<this.cyj}catch(h){v.ULS.sendTraceTag(51652511,306,50,"AppStaticResourceManager: Error attempting to get cache value of resource [error: {0}]",
h.message)}return!1}Zin(){if(Na.a.mf(this.pjc))v.ULS.sendTraceTag(575931855,306,15,"Aggregated Static Resource Metric Dictionary is null or empty");else{var b=t.AFrameworkApplication.Z1?t.AFrameworkApplication.Z1.split(";"):[],h=Object.assign(new eb.a,{extendedProperties:xa.a.iF()});h.extendedProperties.set("Flights",y.c(b));this.Smi(h,this.pjc,Ca.Health.instance)}}Smi(b,h,r){if(h){var z=0,R=0,ba=0,ta=0,Wa=0,ub=0,Ib=0,$b=0,fc=0,Kc=0,ed=0;for(let ge in h){var Jd=h[ge];try{const qe=Object(la.a)(Object,
Jd);if(!qe)continue;const Ve=qe.iscached?Boolean.parse(qe.iscached.toString()):!1,Bd=qe.fetchstart?this.parseFloat(qe.fetchstart.toString()):0,he=(qe.responseend?this.parseFloat(qe.responseend.toString()):0)-Bd,we=qe.encodedsize?this.parseFloat(qe.encodedsize.toString()):0,hg=qe.decodedsize?this.parseFloat(qe.decodedsize.toString()):0;z+=he;ta+=we;Ib+=hg;Kc++;Ve?(ba+=he,ub+=we,fc+=hg,ed++):(R+=he,Wa+=we,$b+=hg)}catch(qe){v.ULS.sendTraceTag(575931856,306,10,"AppStaticResourceManager: Error attempting to log KPI [error: {0}]",
qe.message)}}b.extendedProperties.set("StaticResources",y.c(h));b.extendedProperties.set("TotalResourceDownloadLatency",z.toString());b.extendedProperties.set("TotalResourceDownloadLatencyForCacheMiss",R.toString());b.extendedProperties.set("TotalResourceDownloadLatencyForCacheHit",ba.toString());b.extendedProperties.set("TotalSizeOfEncodedDataDownloaded",ta.toString());b.extendedProperties.set("TotalSizeOfEncodedDataDownloadedForCacheMiss",Wa.toString());b.extendedProperties.set("TotalSizeOfEncodedDataDownloadedForCacheHit",
ub.toString());b.extendedProperties.set("TotalSizeOfDecodedDataDownloaded",Ib.toString());b.extendedProperties.set("TotalSizeOfDecodedDataDownloadedForCacheMiss",$b.toString());b.extendedProperties.set("TotalSizeOfDecodedDataDownloadedForCacheHit",fc.toString());b.extendedProperties.set("TotalNumberOfResourcesDownloaded",Kc.toString());b.extendedProperties.set("TotalNumberOfCachedResourcesDownloaded",ed.toString());r.recordKpiUsageForAlertableKpi("StaticResourceDownloadLatencyAggregated","wacbootmonitoring",
null);r.recordKpiSuccess("StaticResourceDownloadLatencyAggregated",b)}}parseFloat(b){if(!b)return 0;b=parseFloat(b);return isNaN(b)?0:b}}Object(n.a)(am,"AppStaticResourceManager",null,[]);class aj extends Sys.EventArgs{constructor(b){super();this.entries=b}}Object(n.a)(aj,"EntriesAvailableEventArgs",Sys.EventArgs,[]);class nk{constructor(b,h,r=null,z=null,R=100){this.$ve=!1;this.$n=null;this.wlc=0;this.sa=new Te.a;this.zjc=null;this.CY=!1;this.n3g=0;this.Hb=b;this.IAg=0;this.s9f=this;this.Qne=new Lg(r);
this.DJ=h;z&&(this.zjc=new am(null,z,R))}get fhh(){try{return!(void 0===this.DJ||null===this.DJ)&&!(void 0===this.DJ.getEntriesByType||null===this.DJ.getEntriesByType)}catch(b){return v.ULS.sendTraceTag(50873240,306,10,"Exception caught in ResourceTimingLogger.BrowserSupportsPerformanceTimeline: {0}",b),!1}}get QQk(){return this.IAg}get isActive(){return this.CY}get A5f(){return this.n3g}U9g(b){this.sa.addHandler(nk.z7e,b)}POi(b){this.sa.removeHandler(nk.z7e,b)}yc(b,h){const r=this.A5f!==b;this.n3g=
b;this.isActive&&this.Hb&&r&&(this.We(),this.$b());this.IAg=h}activate(){!this.isActive&&this.fhh&&(this.$b(),this.CY=!0)}deactivate(b){this.isActive&&(this.We(),b&&this.flush(),this.CY=!1)}flush(){if(this.isActive&&this.fhh)try{var b=window.performance.getEntriesByType("resource");0<b.length-this.wlc&&v.ULS.sendTraceTag(19506833,306,100,"ResourceTimingLogger.Flush: Start executing command. Number of new entries to flash: {0}",b.length-this.wlc);const h=!(void 0===window.performance.clearResourceTimings||
null===window.performance.clearResourceTimings);h&&(window.performance.clearResourceTimings(),this.wlc=0);const r=[];for(let z=this.wlc;z<b.length;z++)this.Qne.bci(b[z].name)&&(this.zjc&&this.zjc.sbo(b[z]),r.push(new vh(b[z],this.QQk)));h||(this.wlc=b.length);this.sa.raiseEvent(nk.z7e,new aj(r));for(b=0;b<r.length;b++)0!==r[b].behavior&&2!==r[b].behavior||this.s9f.UEb(0,r[b].I5f());0<r.length&&v.ULS.sendTraceTag(19506834,306,100,"ResourceTimingLogger.Flush: Successfully ended. Number of new logged entries: {0}",
r.length)}catch(h){v.ULS.sendTraceTag(4310803,306,10,"Exception caught in ResourceTimingLogger.Flush: {0}",h)}}UEb(b,h){v.ULS.sendTraceTag(4310804,306,50,Jh(b,h))}Sgn(){this.zjc.Zin()}$b(){this.Hb&&0<this.A5f&&(this.$n=new Ic.a(3,2,1E3*this.A5f,()=>{this.flush()},5),this.Hb.$b(this.$n),this.$ve=!0)}We(){this.$ve&&(this.Hb.We(this.$n),this.$n=null,this.$ve=!1)}}nk.z7e="EntriesAvailable";Object(n.a)(nk,"ResourceTimingLogger",null,[656,677]);class sk{constructor(){this.W=null}get name(){return"Common.ResourceTiming"}init(){this.W.resolve("Common.NetworkTiming.IResourceTimingLogger");
fh.instance.run()}dispose(){}yc(b){this.W=b;let h=null;if(t.AFrameworkApplication.K.$("ResourceLoggerFilterDomainsIsEnabled"))try{h=t.AFrameworkApplication.K.KB("ResourceLoggerDomainAllowList")}catch(R){v.ULS.sendTraceTag(51652512,306,50,"ResourceTimingPackage - failed to get logger domain allowlist")}const r=[];r.push(Rc.a.i2(Eg.a.E7).toLowerCase());r.push(Rc.a.i2(Eg.a.a0c).toLowerCase());const z=t.AFrameworkApplication.K.rc("AppStaticResourceMonitorCacheThresholdInMs",100);b.register(656,"Common.NetworkTiming.IResourceTimingLogger").singleInstance().Yd(()=>
new nk(t.AFrameworkApplication.uc,window.performance,h,r,z))}static main(){O.a.instance.Oc(new sk)}}Object(n.a)(sk,"ResourceTimingPackage",null,[1,2]);var De=d(244);class Ai{constructor(){this.Xge={}}z0j(b){this.Xge[b.id.toString()]=b}DMm(b){const h=this.Xge;for(let r in h)h[r].notify(b,!1);this.Xge={}}Sbn(b,h){h&&this.z0j(h);return this.Hzi(b,h)}p6e(b){this.DMm(b)}TCh(b,h){b.notify(h,!0)}}Object(n.a)(Ai,"AEventEmitter",null,[603]);var Mk;(function(b){b[b.notStarted=0]="notStarted";b[b.waiting=1]=
"waiting";b[b.shouldRetry=2]="shouldRetry";b[b.complete=3]="complete"})(Mk||(Mk={}));Object(n.b)("EventResultState",Mk);class pl{constructor(){this._state=0}get state(){return this._state}set state(b){v.ULS.sendTraceTag(5849616,202,50,"Changing event result state. {0}",{["OldState"]:Mk[this._state],["NewState"]:Mk[b]},"ResultType",this.cYh());this._state=b}}Object(n.a)(pl,"AEventResult",null,[602]);class Og extends pl{constructor(){super();this.DIe=this.Btc=null;this.state=0;this.ute=this.jJg=!1}get Kaa(){return this.Btc}get r3a(){return this.DIe}get f7l(){return this.jJg}cYh(){return"GetMoreInfo Result"}}
Object(n.a)(Og,"GetMoreInfoResult",pl,[731,602]);var Rk=d(1362),xf=d(1524),Ql=d(1014);class yd{constructor(b,h,r,z,R,ba,ta,Wa){this.ga=b;this.rg=h;this.Eh=r;this.Hwa=z;this.Hb=R;this.dA=ba;this.ZFj=ta;this.fnd=Wa}jkn(){this.Y9b.pa(ab.a.jac,Yd.a.frame,Object(u.a)(this,this.jac,"openUrlInNewTab"));this.Y9b.pa(ab.a.lJf,Yd.a.frame,Object(u.a)(this,this.lJf,"openDocumentUrl"));t.AFrameworkApplication.Wda?this.Ymi():this.Y9b.gb(ab.a.Vzd,Yd.a.frame,Object(u.a)(this,this.Vzd,"documentLoaded"),96)}jac(b,h,
r,z,R){R&&R.MenuItemId&&(v.ULS.sendTraceTag(5849678,202,50,"Opening new tab {0}",{["Id"]:R.SourceControlId,["AppType"]:Ql.a[this.JNa]}),Ed.a.Cm(R.MenuItemId.toString(),"_blank",void 0,"NewAndOpenCommonHelpers:OpenUrlInNewTab"));return 32}lJf(b,h,r,z,R){if(R&&R.MenuItemId){const ba=t.AFrameworkApplication.K.$("WacInTabOpenMRUIsEnabledForUiHost"),ta=t.AFrameworkApplication.K.$("UiHostSupportsDocRebootFeatures");v.ULS.sendTraceTag(592237459,202,50,"[InTabOpenMRUIsEnabledForUiEmbed: {0}][UiEmbedSupportsDocReboot: {1}]",
ba,ta);if(ba&&ta){v.ULS.sendTraceTag(592237458,202,50,"Opening new tab {0}",{["Id"]:R.SourceControlId,["AppType"]:Ql.a[this.JNa]});b=R.MenuItemId.toString();const Wa={};Wa[G.a.Vbc]="1";Wa[G.a.documentUrl]=b;Wa[G.a.reason]=xf.a.open;v.ULS.sendTraceTag(592237460,202,50,"Send PostMessage to the Ui host to reboot a document");t.AFrameworkApplication.bQ().execute(ub=>{ub.sendMessage(F.a.ryb,Wa)})}else this.jac(b,h,r,z,R)}return 32}Vzd(){this.Ymi();return 32}nNa(b,h,r=""){if(h&&h.eH){const z=Rk.a[h.status];
h=h.eH.getTime();const R=this.tw()-h;v.ULS.sendTraceTag(5849679,202,50,"Making request to the WAC server {0}",{["Caller"]:b,["RequestStatus"]:z,["ElapsedMs"]:R,["StartTime"]:h,["Notes"]:r})}else v.ULS.sendTraceTag(5849680,202,50,"Attempted to make a request to the WAC server with null request item {0}",{["Caller"]:b})}Ymi(){var b=t.AFrameworkApplication.K.$("QPGVCI"),h=Rc.a.rT(document.URL,"wdNewAndOpenCt",b);if(h){h=parseInt(h);var r=Rc.a.rT(document.URL,"wdPreviousSession",b);b=Rc.a.rT(document.URL,
"wdPreviousCorrelation",b);var z=t.AFrameworkApplication.K.$("NAOPLP");if(t.AFrameworkApplication.Wda){var R=t.AFrameworkApplication.Wda.getTime();!h||h>R?v.ULS.sendTraceTag(5849682,202,15,"NewAndOpenCommonHelpers.LogNewAndOpenPerfStats: Invalid timestamp {0}",{["ClickTimestamp"]:h,["DocumentLoadedTime"]:R,["SessionId"]:r,["Correlation"]:b}):v.ULS.sendTraceTag(5849683,202,z?15:50,"NewAndOpenCommonHelpers.LogNewAndOpenPerfStats: Click-to-load perf {0}",{["ClickToLoadTime"]:R-h,["ClickTimestamp"]:h,
["SessionId"]:r,["Correlation"]:b})}else v.ULS.sendTraceTag(5849681,202,z?15:50,"NewAndOpenCommonHelpers.LogNewAndOpenPerfStats: Not logging because document loaded time has not been set {0}",{["ClickTimestamp"]:h,["SessionId"]:r,["Correlation"]:b})}}get Y9b(){return this.ga.value}get ASc(){return this.rg.value}get jti(){return this.Eh.value}get JNa(){return this.Hwa.value}get GVd(){return this.Hb.value}get tw(){return this.dA}get INa(){return this.ZFj.value}get u3a(){return this.fnd.value}static get instance(){return yd._instance||
(yd._instance=yd.mr())}static mr(){return new yd(new De.a(()=>t.AFrameworkApplication.ya),new De.a(()=>t.AFrameworkApplication.Xe),new De.a(()=>t.AFrameworkApplication.ua),new De.a(()=>t.AFrameworkApplication.ua.Sb.jo),new De.a(()=>t.AFrameworkApplication.uc),()=>(new Date).getTime(),new De.a(()=>t.AFrameworkApplication.ua.Sb.INa),new De.a(()=>t.AFrameworkApplication.u3a))}}yd._instance=null;Object(n.a)(yd,"NewAndOpenCommonHelpers",null,[600]);class Zk{constructor(b,h,r){this.Ald=this.$n=null;this.eFe=
0;this.YTj=b;this.Hb=h;this.hBg=r}v$j(){this.eFe=this.Lcc+1}kUf(b){this.$n&&(this.Hb.We(this.$n),this.$n=null);b&&(this.eFe=0)}X1n(b){const h=this.S8n;0<=h?(this.v$j(),this.kUf(!1),this.$n=new Ic.a(4,1,h,b,107),this.Hb.$b(this.$n)):(this.kUf(!0),v.ULS.sendTraceTag(5849676,202,50,"Retries exhausted {0}",{["Action"]:this.hBg}))}get Lcc(){return this.eFe}get S8n(){return this.Lcc>=this.rXi.length?-1:this.rXi[this.Lcc]}get rXi(){if(!this.Ald){const b=(this.YTj.value||"0").split(",");this.Ald=[];for(let h=
0;h<b.length;h++){const r=parseInt(b[h]);isNaN(r)?v.ULS.sendTraceTag(5849677,202,15,"Retry interval list contains non-number element {0}",{["Action"]:this.hBg,["Entry"]:b[h]}):Array.add(this.Ald,r)}}return this.Ald}}Object(n.a)(Zk,"RetryHelper",null,[]);class Kl extends Ai{constructor(b,h){super();this.Sxa=b;this.Fuc=new Zk(h,this.lSc.GVd,"GetMoreInfo");this.Tp=new Og}LDm(){this.Xyf("Document opened")}eLk(b){return()=>{this.Xyf(b,!0)}}Hzi(b,h=null){v.ULS.sendTraceTag(5849617,202,50,"Attempting to get GetMoreInfo properties {0}",
{["Trigger"]:b});3===this.Tp.state?(h&&this.TCh(h,this.Tp),v.ULS.sendTraceTag(5849619,202,50,"GetMoreInfo already populated. {0}",{["Trigger"]:b})):this.Xyf(b);return this.Tp}Xyf(b,h=!1){this.Fuc.kUf(!h);1===this.Tp.state?v.ULS.sendTraceTag(5849620,202,50,"Not starting new request, because one is already in progress {0}",{["Trigger"]:b,["RetryIndex"]:this.Fuc.Lcc}):(v.ULS.sendTraceTag(5849621,202,50,"Making GetMoreInfo request {0}",{["Trigger"]:b,["RetryIndex"]:this.Fuc.Lcc}),this.Tp.state=1,h=String.format("{0}GetMoreInfoHandler.ashx?{1}",
this.lSc.INa,t.AFrameworkApplication.xm),this.lSc.ASc.WWb(h,1,null,null,[Kl.PVg,Kl.J1g],5,this.ZJk(),this.YJk(b)))}ZJk(){return b=>{var h=!1;let r=!1;var z=!1,R;t.AFrameworkApplication.K.$("GetMoreInfoDataFromResponseBody")&&(b.data.Ge?({Fv:R}=y.d(b.data.Ge)).returnValue?R?(z=!0,this.Tp.DIe=R.StorageServiceDisplayName,this.Tp.Btc=Kl.Vii(R.PersonalFileStorageUrl)?R.PersonalFileStorageUrl:"",""===this.Tp.Kaa&&"SharePointOnlineConsumer"===t.AFrameworkApplication.K.lb("FileSource")&&(this.Tp.Btc=Rc.a.nva(t.AFrameworkApplication.breadcrumbFolderUrl)),
h=""===this.Tp.Kaa&&""!==this.Tp.r3a):v.ULS.sendTraceTag(25298113,202,15,"Response body could not be casted into a GetMoreInfoResponseData type. Will fallback to reading the data from the headers"):v.ULS.sendTraceTag(25298112,202,15,"Failed to deserialize GetMoreInfo response body. Will fallback to reading the data from the headers"):v.ULS.sendTraceTag(25298083,202,15,"Could not find GetMoreInfo data on the response body. Will fallback to reading the data from the headers"));z||((R=b.data.rj)?(this.Tp.DIe=
(R[Kl.J1g]||"").toString(),h=(R[Kl.PVg]||"").toString(),this.Tp.Btc=Kl.Vii(h)?h:"",""===this.Tp.Kaa&&"SharePointOnlineConsumer"===t.AFrameworkApplication.K.lb("FileSource")?(this.Tp.Btc=Rc.a.nva(t.AFrameworkApplication.breadcrumbFolderUrl),h=""===this.Tp.Kaa&&""!==this.Tp.r3a):h=""===h&&""!==this.Tp.r3a):(v.ULS.sendTraceTag(5849622,202,50,"Null response headers received."),r=!0));z=String.format("Success at RetryIndex: {0}, InvalidResponse: {1}, InstantiatingPersonalStorage: {2}, InfoFoundInResponseBody: {3}",
this.Fuc.Lcc,r,h,z);this.lSc.nNa("GetMoreInfoActor.CreateGetMoreInfoFromServerSuccessCallback",b.data,z);this.HXi(3,h,r)}}YJk(b){return h=>{this.lSc.nNa("GetMoreInfoActor.CreateGetMoreInfoFromServerFailureCallback",h.data,"Failure");this.HXi(2);this.Fuc.X1n(this.eLk(b))}}HXi(b,h=!1,r=!1){this.Tp.state=b;this.Tp.jJg=h;this.Tp.ute=r;this.p6e(this.Tp)}get lSc(){return this.Sxa.value}static get instance(){return Kl._instance||(Kl._instance=Kl.mr())}static mr(){return new Kl(new De.a(()=>yd.instance),
new De.a(()=>t.AFrameworkApplication.Dzl))}static Vii(b){if(!b)return v.ULS.sendTraceTag(5849624,202,50,"Attempted to check an empty url for validity as a StorageHostUrl."),!1;if(B.a.mh(b).startsWith("https://"))return!0;v.ULS.sendTraceTag(5849625,202,10,"StorageUrl has invalid scheme.");return!1}}Kl.PVg="PersonalFileStorageUrl";Kl.J1g="StorageServiceDisplayName";Kl._instance=null;Object(n.a)(Kl,"GetMoreInfoActor",Ai,[]);class tk{constructor(b,h,r,z,R){this.jHj=6E4;this.c7h="inactive";this.Y6g="active";
this.CY=!0;this.Hb=b;this.hFj=h;this.dA=r;this.bod=z;this.sa=new Te.a;R&&this.O1n();this.uNg=this.yTh()}JNe(b){this.sa.addHandler(this.Y6g,b)}F3j(b){this.sa.addHandler(this.c7h,b)}O1n(){const b=new Ic.a(5,2,this.jHj,Object(u.a)(this,this.q0l,"inactiveLoop"),108);this.r0l.$b(b)}q0l(){const b=this.yTh(),h=this.tw()-b;h>this.Qae&&this.CY&&(v.ULS.sendTraceTag(5849626,202,50,"User went inactive {0}",{["TimeSinceLastActive"]:h}),this.CY=!1,this.sa.raiseEvent(this.c7h));b-this.uNg>this.Qae&&(this.CY=!0,
this.sa.raiseEvent(this.Y6g));this.uNg=b}get r0l(){return this.Hb.value}get yTh(){return this.hFj}get tw(){return this.dA}get Qae(){return this.bod.value}static get instance(){return tk._instance||(tk._instance=tk.mr())}static mr(){return new tk(new De.a(()=>Oe.a.instance),()=>t.AFrameworkApplication.Kvf.getTime(),()=>(new Date).getTime(),new De.a(()=>t.AFrameworkApplication.Qae),!0)}}tk._instance=null;Object(n.a)(tk,"InactivityManager",null,[]);var $k=d(1626);class un extends pl{constructor(){super();
this.OMj=this.vRg=this.uRg=null;this.state=this.o3g=0;this.ute=!1}get VAf(){return this.uRg}get zsi(){return this.vRg}get W8n(){return this.o3g}cYh(){return"MruActor Result"}}Object(n.a)(un,"MruResult",pl,[601,602]);class bm{constructor(b,h,r){this.task=null;this.eCb=b;this.maxRetries=h;this.taskManager=r;this.retryCount=this.TMc=0;this.qDe=this.jQc=null}$hm(b,h){return b===Ja.a.P1b||20===h||18===h||3===h}wjm(b){return 3===b||5===b||6===b||7===b||9===b||10===b||11===b||12===b||13===b||14===b||15===
b||16===b||23===b||26===b||27===b||28===b}get y0d(){return this.qDe}reset(){this.TMc=this.retryCount=0;this.qDe=this.jQc=null;this.task&&(this.taskManager.We(this.task),this.task=null)}C4l(b,h,r,z){this.qDe=String.format("{0}_{1}",r,z);if(this.retryCount>=this.maxRetries)return v.ULS.sendTraceTag(562656907,202,50,"Max retries exceeded"),!1;if(this.$hm(r,z))return v.ULS.sendTraceTag(562656908,202,50,"Encountered permanent error. Not retrying"),!1;if(this.wjm(z)&&1<=this.TMc)return this.jQc=r,!1;h=
Math.max(h,this.eCb*Math.pow(2,this.TMc));if(26===z)h=Math.max(h,3E4);else if(27===z||28===z)h=Math.max(h,6E4);9===z||412===r&&(null==this.jQc||412!==this.jQc)?h=500:this.TMc+=1;this.jQc=r;this.retryCount+=1;this.task&&this.taskManager.We(this.task);v.ULS.sendTraceTag(562656909,202,50,"Scheduling next retry after {0} ms.",h);this.task=new Ic.a(2,1,h,b,107);this.taskManager.$b(this.task);return!0}}Object(n.a)(bm,"RetryManager",null,[]);var yh=d(158);class fn{constructor(){this.mruItemId=this.app=this.documentExt=
this.documentName=this.folderName=this.documentUrl=null}}Object(n.a)(fn,"WriteOptions",null,[]);var Sj=d(594);class qg extends Ai{constructor(b,h,r,z,R,ba,ta){super();this.Sxa=b;this.ELj=h;this.p9a=new bm(t.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.SharedOnline.MruReadRetryIntervalMs",5E3),t.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.SharedOnline.MruMaxReadRetry",3),this.cM.GVd);this.A$a=new bm(t.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.SharedOnline.MruWriteRetryIntervalMs",
15E3),t.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.SharedOnline.MruMaxWriteRetry",3),this.cM.GVd);this.RRj=r;this.d6g=z;this.w_j={};this.Fia=new un;this.EEj=R;this.ogd="";this.MK=ba;this.bDg=ta;this.Ijd="";this.WRj=t.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.WordOnline.recentLinksCount",25)}get Eee(){return this.w_j}Pnn(){this.cM.Y9b.pa(ab.a.uPi,Yd.a.frame,Object(u.a)(this,this.zsn,"renameMruEntry"))}zsn(){return this.Iag("Rename")}ZDm(){this.ypi("File Opened")}$Dm(){this.ypi("IntervalUpdate")}ypi(b){v.ULS.sendTraceTag(5849670,
202,50,"Starting update of MRU entry {0}",{["Trigger"]:b});this.Iag(b)}rLa(b){(b=B.a.rLa(b))&&b.startsWith(".")&&(b=b.substring(1,b.length));return b}kMh(){switch(this.cM.JNa){case 3:return"Word";case 1:return"Excel";case 2:return"PowerPoint";case 5:return"Visio";case 4:return"OneNote";default:return"Unknown"}}EOl(b){var h=this.EEj();if(!h)return null;const r=new fn;r.documentUrl=this.bDg.value?encodeURI(h):h;r.mruItemId=this.ogd;r.app=this.kMh();if(h=this.MK())r.folderName=h.breadcrumbFolderName,
h=h.Bz,r.documentName=B.a.qI(h),r.documentExt=this.rLa(h);b&&(r.documentName?r.documentName.length?255<=r.documentName.length?b.set("DocumentNameLength","Long"):2084<=r.documentName.length&&b.set("DocumentNameLength","VeryLong"):b.set("DocumentNameLength","0"):b.set("DocumentNameLength","Null"));return JSON.stringify(r)}Iag(b,h=!1){if(4===this.cM.JNa&&!t.AFrameworkApplication.vEc)return 2;var r=xa.a.iF();r&&(r.set("Trigger",b),r.set("IsRetry",h?"true":"false"),r.set("MruIdSent",this.ogd?"true":"false"),
r.set("URLEncoded",this.bDg.value?"true":"false"));Ca.Health.instance.recordKpiUsage("WriteMru",0,"smartfio",r);b=this.EOl(r);if(!b)return h=!t.AFrameworkApplication.KMb,r&&(r.set("WebEditingIsEnabled",t.AFrameworkApplication.KMb?"true":"false"),r.set("ProtectedFile",t.AFrameworkApplication.protectFile?"true":"false")),Ca.Health.instance.recordKpiFailure("WriteMru","MissingDocumentUrl",h,!1,Object.assign(new eb.a,{extendedProperties:r})),2;this.A$a&&!h&&this.A$a.reset();r=String.format("{0}MruV2ServiceHandler.ashx?rs={1}",
this.cM.INa,this.ixf);this.d6g?this.Eee["X-FileId"]=t.AFrameworkApplication.xm:r+=String.format("&{0}",t.AFrameworkApplication.xm);t.AFrameworkApplication.sessionStartInfoSettings&&(this.Eee["X-Office-AudienceGroup"]=Object(la.a)(String,t.AFrameworkApplication.sessionStartInfoSettings.AudienceGroup)||"");this.Eee["X-Timeout"]=15E3;return this.cM.ASc.Lj(r,2,b,this.Eee,!0,5,Object(u.a)(this,this.gvo,"writeMruV2EntryOnServerSuccessCallback"),Object(u.a)(this,this.POk,"createWriteMruV2EntryOnServerFailureCallback"),
null,void 0,void 0,void 0,void 0,"4")}gvo(b){this.W2h(b.data)}W2h(b){const h=xa.a.iF();this.A$a&&(h&&this.A$a.y0d&&(h.set("LastError",this.A$a.y0d),h.set("NumRetries",this.A$a.retryCount.toString())),this.A$a.reset());const r=$k.c(b.Ge);r&&r.diagnostics_data&&(this.ogd=r.diagnostics_data.mru_id);b=+b.AS-+b.eH;h&&h.set("RequestDuration",b.toString());Ca.Health.instance.recordKpiSuccess("WriteMru",Object.assign(new eb.a,{extendedProperties:h}))}POk(b){if(b.data.wf===Ja.a.bDc)this.W2h(b.data);else{var h=
b.data.wf===Ja.a.kga,r=xa.a.iF();this.e3h(this.A$a,b,this.xOk(),r);r&&(r.set("StatusCode",b.data.wf.toString()),h||this.ZNe(b.data,r));Ca.Health.instance.recordKpiFailure("WriteMru",String.format("RequestFailed_{0}",b.data.wf),h,!1,Object.assign(new eb.a,{extendedProperties:r}))}}xOk(){return()=>{this.Iag("Retry",!0)}}Lzl(){this.k9b("Polling")}Kzl(){this.k9b("Retry",!0)}ODm(){this.k9b("Open")}NDm(){this.k9b("Activity")}MDm(){this.k9b("OpenRecentLinks",!1,!0)}rpi(){this.k9b("ActivityRecentLinks",!1,
!0)}k9b(b,h=!1,r=!1){v.ULS.sendTraceTag(5849674,202,50,"Making GetMru request {0}",{["Trigger"]:b});const z=xa.a.iF();z&&(z.set("Trigger",b),z.set("IsRetry",h?"true":"false"),r&&z.set("RecentLinks","true"));Ca.Health.instance.recordKpiUsage("GetMru",0,"smartfio",z);this.p9a&&!h&&this.p9a.reset();r?this.Oth(Object(u.a)(this,this.Mzl,"getMruV2ForRecentLinksFromServerSuccessCallback"),Object(u.a)(this,this.Hzl,"getMruForRecentLinksFromServerFailureCallback"),!0):this.Oth(Object(u.a)(this,this.Nzl,"getMruV2FromServerSuccessCallback"),
Object(u.a)(this,this.Jzl,"getMruFromServerFailureCallback"))}ZNe(b,h){b&&b.rj&&(b=b.rj["X-CorrelationId"])&&h.set("ServerCorrelationId",b)}Exm(b,h){b&&(h&&h.set("RequestDuration",(+b.AS-+b.eH).toString()),Ca.Health.instance.recordKpiSuccess("GetMru",Object.assign(new eb.a,{extendedProperties:h})))}Nzl(b){this.BUh(b)}BUh(b,h=!1){var r="";let z=null,R=null,ba=null;const ta=$k.c(b.data.Ge);ta&&(z=ta.places?ta.places.items:[],R=ta.documents?ta.documents.items:[],(ba=$k.a(ta,h))&&(r=y.c(ba)));t.AFrameworkApplication.ua&&
t.AFrameworkApplication.ua.Sb.GMa&&yh.c()&&(h?this.Ijd=r:appChrome.api.dispatch(appChrome.actions.setFileMenuMRUJson(r,!0)));r=xa.a.iF();this.p9a&&(r&&this.p9a.y0d&&(r.set("LastError",this.p9a.y0d),r.set("NumRetries",this.p9a.retryCount.toString())),this.p9a.reset());h&&r&&r.set("RecentLinks","true");ba||z||R?(h?this.cM.nNa("MruActor.GetMruV2ForRecentLinksFromServerSuccessCallback",b.data,"Success"):this.cM.nNa("MruActor.GetMruV2FromServerSuccessCallback",b.data,"Success"),this.Vce(3,ba,z,R),this.Exm(b.data,
r)):(h?this.cM.nNa("MruActor.GetMruV2ForRecentLinksFromServerSuccessCallback",b.data,"Failure: Invalid JSON"):this.cM.nNa("MruActor.GetMruV2FromServerSuccessCallback",b.data,"Failure: Invalid JSON"),r&&this.ZNe(b.data,r),Ca.Health.instance.recordKpiFailure("GetMru","JsonParseFailed",!1,!1,Object.assign(new eb.a,{extendedProperties:r})),this.Vce(3,null,null,null,!0));this.p6e(this.Fia)}Mzl(b){this.BUh(b,!0)}e3h(b,h,r,z){let R=0,ba=0;const ta=$k.c(h.data.Ge);ta&&(null!=ta.response_code&&(R=ta.response_code,
z&&z.set("MruResponseCode",R.toString()),9===R&&(this.ogd="")),ta.error_data&&null!=ta.error_data.retry_after_ms&&(ba=ta.error_data.retry_after_ms,z&&z.set("ExpectedRetryAfter",ba.toString())));b&&(h=b.C4l(r,ba,h.data.wf,R),z&&(z.set("CurrentRetryCount",b.retryCount.toString()),z.set("RetryScheduled",h?"true":"false")))}Jzl(b){this.AUh(b)}AUh(b,h=!1){const r=b.data.wf===Ja.a.kga,z=xa.a.iF();z&&(z.set("StatusCode",b.data.wf.toString()),h&&z.set("RecentLinks","true"),r||this.ZNe(b.data,z));h?this.cM.nNa("MruActor.GetMruForRecentLinksFromServerFailureCallback",
b.data,"Failure"):this.cM.nNa("MruActor.GetMruFromServerFailureCallback",b.data,"Failure");this.Vce(2);this.e3h(this.p9a,b,Object(u.a)(this,this.Kzl,"getMruFromServerRetryTask"),z);Ca.Health.instance.recordKpiFailure("GetMru",String.format("RequestFailed_{0}",b.data.wf),r,!1,Object.assign(new eb.a,{extendedProperties:z}));this.p6e(this.Fia);t.AFrameworkApplication.ua&&t.AFrameworkApplication.ua.Sb.GMa&&yh.c()&&(appChrome.api.dispatch(appChrome.actions.setFileMenuMRUJson("",!1)),h?this.Ijd=null:appChrome.api.dispatch(appChrome.actions.setFileMenuMRUJson("",
!1)))}Hzl(b){this.AUh(b,!0)}Vce(b,h=null,r=null,z=null,R=!1){if(3!==this.Fia.state||3===b)this.Fia.uRg=h,this.Fia.vRg=r,this.Fia.OMj=z,this.Fia.state=b,this.Fia.ute=R,this.Fia.o3g=this.cM.tw()}Hzi(b,h){v.ULS.sendTraceTag(6029918,202,50,"MRU result requested {0}",{["Trigger"]:b,["ResultState"]:this.Fia.state});h&&3===this.Fia.state&&this.TCh(h,this.Fia);return this.Fia}Oth(b,h,r=!1){this.Vce(1);let z;const R={};z=r?String.format(this.cM.INa+"MruV2ServiceHandler.ashx?sort=Date&show={0}&apps={1}&rs={2}&cap={3}",
this.WRj,"OfficeSuite",this.ixf,"ClassicMru"):String.format(this.cM.INa+"MruV2ServiceHandler.ashx?sort=Date&show={0}&apps={1}&rs={2}",10,this.kMh(),this.ixf);this.RRj.value||(z+="&entity=docs");t.AFrameworkApplication.sessionStartInfoSettings&&(R["X-Office-AudienceGroup"]=Object(la.a)(String,t.AFrameworkApplication.sessionStartInfoSettings.AudienceGroup)||"");r&&(R["X-Office-Application"]="147");this.d6g?R["X-FileId"]=t.AFrameworkApplication.xm:z+=String.format("&{0}",t.AFrameworkApplication.xm);
this.cM.ASc.Lj(z,1,null,R,!0,5,b,h,null)}get cM(){return this.Sxa.value}get ixf(){return this.ELj.value}static get instance(){return qg._instance||(qg._instance=qg.mr())}static mr(){return new qg(new De.a(()=>yd.instance),new De.a(()=>Sj.a.pg(t.AFrameworkApplication.lcid).name),new De.a(()=>t.AFrameworkApplication.ua.Sb.KA),t.AFrameworkApplication.K.$("MruWriteFileIdInHeader"),()=>t.AFrameworkApplication.ua.Sb.yda,()=>t.AFrameworkApplication.zt,new De.a(()=>t.AFrameworkApplication.K.$("OICEncodeUrlIsEnabled")))}}
qg._instance=null;Object(n.a)(qg,"MruActor",Ai,[]);class fl{constructor(){this.dxc=this.mXg=this.W=null;this.uh=!1}get name(){return"Common.App.NewAndOpen.Core"}yc(b){this.W=b;b.register(600,"Common.INewAndOpenCommonHelpers").singleInstance().Yd(()=>yd.instance);b.register(603,"Common.IEventEmitter<Common.IGetMoreInfoResult>").singleInstance().Yd(()=>Kl.instance);b.register(603,"Common.IEventEmitter<Common.IMruResult>").singleInstance().Yd(()=>qg.instance)}init(){t.AFrameworkApplication.K.zq(()=>
{this.EZa()})}EZa(){this.W.resolve("Common.INewAndOpenCommonHelpers");this.W.resolve("Common.IEventEmitter<Common.IGetMoreInfoResult>");this.W.resolve("Common.IEventEmitter<Common.IMruResult>");var b=!1;yd.instance.jkn();t.AFrameworkApplication.TCa&&(b=!0);t.AFrameworkApplication.ZPf&&(qg.instance.ODm(),t.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.recentLinksIsEnabled",!1)&&qg.instance.MDm(),0<t.AFrameworkApplication.Asi&&this.k8g(),this.iRn(),b=!0);t.AFrameworkApplication.u3a&&
b&&Kl.instance.LDm();t.AFrameworkApplication.qko&&(b=qg.instance,b.Pnn(),b.ZDm(),Oe.a.instance.$b(this.rko))}iRn(){tk.instance.JNe(Object(u.a)(qg.instance,qg.instance.NDm,"makeGetMruRequestActivityTrigger"));t.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.recentLinksIsEnabled",!1)&&tk.instance.JNe(Object(u.a)(qg.instance,qg.instance.rpi,"makeGetMruForRecentLinksRequestActivityTrigger"));tk.instance.JNe(Object(u.a)(this,this.k8g,"addGetMruFromServerTask"));tk.instance.F3j(Object(u.a)(this,
this.SSk,"deleteGetMruFromServerTask"))}SSk(){Oe.a.instance.We(this.Bsi)}k8g(){Oe.a.instance.$b(this.Bsi)}get Bsi(){return this.mXg||(this.mXg=new Ic.a(5,2,t.AFrameworkApplication.Asi,Object(u.a)(qg.instance,qg.instance.Lzl,"getMruFromServerTask"),109))}get rko(){return this.dxc||(this.dxc=new Ic.a(2,2,6E4*t.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.SharedOnline.MruUpdateIntervalInMinutes",1440),Object(u.a)(qg.instance,qg.instance.$Dm,"makeUpdateMruTask"),197))}dispose(){this.uh||
(this.uh=!0,this.dxc&&(Oe.a.instance.We(this.dxc),this.dxc=null))}}Object(n.a)(fl,"CorePackageManager",null,[1,2,9]);var gm=d(1521),xl=d(107);class Ch{static C1k(b){return Ch.Qhh("New",b)}static D1k(b){return Ch.Qhh("Open",b)}static vhh(b,h){return Ch.QVa("LoadingMenuSection",Ch.qvm,b,Ch.Pzc("lblLoading",h))}static Qzc(b,h,r=null,z=null){return Ch.QVa("MessageMenuSection",Ch.ysi,h,Ch.Pzc("lblMessage",b,r,z))}static pmk(b){return Ch.vhh(b,CommonUIStrings.l_VoicedLoadingText)}static qmk(b,h){return Ch.Qzc(CommonUIStrings.l_NewCreationLocationMessage,
b.labelText,h.Kaa,h.r3a)}static omk(b,h){return Ch.Qzc(String.format(CommonUIStrings.l_NewProvisioningStorageMessage,h.r3a,"\n\n"),b.labelText)}static zhh(b){return Ch.Qzc(CommonUIStrings.l_NewGenericErrorMessage,b.labelText)}static mmk(b,h,r){return Ch.QVa("menuNewBlank",Ch.pXl,r?b.labelText:null,Ch.Mzc(b.D4h,b.E4h,b.F4h,null,b.sZa,b.ELc,h,"blank"))}static tnk(){return Ch.Pzc("lblTemplatesLoading",CommonUIStrings.l_VoicedLoadingText)}static Ohh(){return Ch.Pzc("lblTemplatesError",CommonUIStrings.l_NewTemplateErrorMessage)}static unk(b,
h){return Ch.QVa("menuNewTemplates",b,null,h)}static kmk(b,h){return Ch.QVa("menuNewMoreTemplates",Ch.KJh,null,Ch.Mzc("menuNewMoreTemplatesButton",CommonUIStrings.l_NewMoreTemplates,CommonUIStrings.l_NewMoreTemplates,null,null,null,b,h))}static Mkk(b,h,r){let z="";r&&h&&(z=Ch.QVa("BrowseMoreMenuSection",Ch.KJh,null,Ch.Mzc("btnBrowseMore",h,h,null,null,null,b||"1959943459",r)));return z}static Pzc(b,h,r=null,z=null){let R=z;h&&0<h.length&&(R=Ch.uti.t1a(h).trimEnd(),R=0<=R.indexOf("{0}")?String.format(R,
z):String.format("{0} {1}",R,z));r=r&&z?String.format('\r\n\t\t\t\t\tInnerLink="{0}"\r\n\t\t\t\t\tInnerLinkText="{1}"\r\n\t\t\t\t\tInnerLinkTitle="{2}"',B.a.If(r),B.a.If(z),B.a.If(R)):"";return String.format('\r\n\t\t\t\t<Label\r\n\t\t\t\t\tId="{0}"\r\n\t\t\t\t\tLabelText="{1}"\r\n\t\t\t\t\t{2}/>',B.a.If(b||""),Ch.uti.t1a(B.a.If(h||"")),r)}static Mzc(b,h,r,z,R,ba,ta,Wa){return String.format('\r\n\t\t\t\t<Button\r\n\t\t\t\t\tId="{0}"\r\n\t\t\t\t\tLabelText="{1}"\r\n\t\t\t\t\tDescription="{2}"\r\n\t\t\t\t\tImage{3}Class="{4}"\r\n\t\t\t\t\tImage{3}="{5}"\r\n\t\t\t\t\tCommand="{6}"\r\n\t\t\t\t\tMenuItemId="{7}"/>',
B.a.If(b||""),B.a.If(h||""),B.a.If(r||""),z||"32by32",B.a.If(R||""),B.a.If(ba||""),ta,B.a.If(Wa||""))}static Qhh(b,h){return String.format('\r\n\t\t\t\t<Menu Id="menuJewel{0}">{1}\r\n\t\t\t\t</Menu>',b,h)}static QVa(b,h,r,z){r=r?String.format('Title="{0}"',B.a.If(r)):"";return String.format('\r\n\t\t\t\t<MenuSection\r\n\t\t\t\t\tId="{0}"\r\n\t\t\t\t\tDisplayMode="{1}"\r\n\t\t\t\t\t{2}\r\n\t\t\t\t\tShowMenuSectionSeparator="false">\r\n\t\t\t\t\t<Controls>{3}\r\n\t\t\t\t\t</Controls>\r\n\t\t\t\t</MenuSection>',
B.a.If(b||""),B.a.If(h||""),r,z)}}Ch.ysi="MenuMru";Ch.qvm="MenuLoading";Ch.pXl="MenuHeader";Ch.KJh="MenuFooter";Ch.uti=xl.a.vB("\n","&#10;");Object(n.a)(Ch,"NewAndOpenXmlUtilities",null,[]);class gi{constructor(){this.folderName=this.folderUrl=this.hostName=this.hostUrl=null}}Object(n.a)(gi,"HostInformation",null,[]);class Dh{constructor(b,h,r,z,R,ba){this.FJe=this.Xv=this.B7c=null;this.jmd=this.xHe=!1;this.FQg=0;this.cHe=this.nve=!1;this.Sxa=b;this.unc=h;this.qSa=new De.a(()=>new gm.a(r.value,Object(u.a)(this,
this.BAb,"getMoreInfoEventReceived")));this.MMj=z;this.B8a=R;this.gVj=ba;this.Evc=this.l8d;2===this.Q6.JNa&&(this.cHe=!0)}get kda(){switch(this.Q6.JNa){case 3:return"WordWAC";case 1:return"ExcelWAC";case 2:return"PowerPointWAC";case 5:return"VisioWAC"}return null}Vb(){const b=this.Q6.Y9b;b.pa(ab.a.newDocument,Yd.a.frame,Object(u.a)(this,this.newDocument,"newDocument"));b.gb(ab.a.$_d,Yd.a.frame,Object(u.a)(this,this.$_d,"populateNewMenu"),96)}newDocument(b,h,r,z,R){return 1===r?32:2===r&&R&&R.MenuItemId&&
R.SourceControlId?this.QCc(R.MenuItemId,R.SourceControlId):8}QCc(b,h){var r=this.LVd.suh;if(null===r)return 8;var z=t.AFrameworkApplication.K.$("UihostSupportsCreateNewDocumentFeatureIsEnbaledInWAC");if(t.AFrameworkApplication.WDb&&z){v.ULS.sendTraceTag(51455198,202,50,"CreateNewActor.CreateNewDocument: Sending CreateNewDocument post message.");const R={};R[G.a.template]=b;R[G.a.kda]=this.kda;R[G.a.lcid]=t.AFrameworkApplication.lcid.toString();R[G.a.reason]=xf.a.s0e;t.AFrameworkApplication.bQ().execute(ba=>
{ba.sendMessage(F.a.QCc,R)})}else z=(new Date).getTime(),h=String.format("{0}CreateNewDocument.aspx?dest={1}&tpl={2}&app={3}&lcid={4}&ct={5}&so=4&or=wacFileNew&bid={6}&Canary={7}&{8}",r,B.a.Ij(this.TCa),B.a.Ij(b),B.a.Ij(this.kda),B.a.Ij(t.AFrameworkApplication.lcid.toString()),B.a.Ij(z.toString()),B.a.Ij(h),B.a.Ij(t.AFrameworkApplication.canary),t.AFrameworkApplication.xm),(r=t.AFrameworkApplication.K.lb("ScenarioId"))&&""!==r&&(h+="&wdscenarioid="+B.a.Ij(r)),h+="&"+t.AFrameworkApplication.dId(),
t.AFrameworkApplication.z_a&&(h+="&"+t.AFrameworkApplication.LGd()),(r=this.Xv?this.Xv.Kaa:null)&&(h+="&DestinationUrl="+B.a.Ij(r)),Ed.a.Cm(h,"_blank",void 0,"CreateNewDocument");2===this.Q6.JNa&&v.ULS.sendTraceTag(24700384,202,50,"CreateNewDocument from New Menu {0}",{["AppType"]:Ql.a[this.Q6.JNa],["Template"]:b});return 32}BBm(b){let h=Number.MAX_VALUE,r=Number.MIN_VALUE;const z=window.performance;if(z&&"undefined"!==typeof z.getEntriesByName){for(let ba=0;ba<b.length;ba++){var R=z.getEntriesByName(b[ba]);
R&&0<R.length&&(R=R[0],h=Math.min(parseInt(String(R.fetchStart)),h),r=Math.max(parseInt(String(R.responseEnd)),r))}r>h&&v.ULS.sendTraceTag(5849601,202,50,"Total time to download template thumbnails {0}",{["TotalElapsedMs"]:r-h,["MinFetchStart"]:h,["MaxResponseEnd"]:r})}}$_d(b,h,r,z,R){if(1===r)return this.cHe&&(t.AFrameworkApplication.naa("Microsoft.Office.Server.Powerpoint.Web.IPptMoreThemesInNewMenuSettings"),this.cHe=!1),32;2!==r||this.nve||(this.FQg=(new Date).getTime(),v.ULS.sendTraceTag(5849602,
202,50,"File New menu flyout opened by user {0}",{["ShouldShowTemplates"]:this.l8d,["CachedNewMenuXmlExists"]:!!this.B7c,["ShouldCallGetMoreInfo"]:this.Q6.u3a}));return this.a6m(R)}a6m(b){b&&(this.B7c?b.PopulationXML=this.B7c:(this.Q6.u3a&&!this.Xv&&this.hLm.fk("Opened New menu",!0),b.PopulationXML=this.hgl(this.getTemplateListJson())));return 32}qgi(){return!this.Q6.u3a||!!this.Xv&&3===this.Xv.state&&!!this.Xv.r3a&&!!this.Xv.Kaa}Xim(){return t.AFrameworkApplication.ua&&t.AFrameworkApplication.ua.Sb.GMa?
!0:this.qgi()}getTemplateListJson(){if(!this.l8d||!this.Xim())return null;if(this.Evc&&!this.jmd){var b="9";const h=t.AFrameworkApplication.K.appSettings;"NumberOfTemplatesInBackstage"in h&&(b=h.NumberOfTemplatesInBackstage);let r=this.kda;"TemplateCollectionId"in h&&(r=h.TemplateCollectionId);b=String.format(this.Q6.INa+"TemplateServiceProxy.ashx?lcid={0}&apps={1}&show={2}",B.a.Ij(t.AFrameworkApplication.lcid.toString()),B.a.Ij(r),b);Boolean.parse(h.AppendOriginQueryParam||"false")&&(b+="&org=backstage");
b+="&"+t.AFrameworkApplication.dId();t.AFrameworkApplication.z_a&&(b+="&"+t.AFrameworkApplication.LGd());this.Q6.ASc.Lj(b,1,null,null,!1,2,z=>{this.Q6.nNa("CreateNewActor.GetTemplateListJson",z.data);this.s7n(z.data.Ge)},z=>{this.Q6.nNa("CreateNewActor.GetTemplateListJson",z.data);this.r7n()},null,void 0,void 0,void 0,void 0,"5");this.Evc=!1}return this.FJe}s7n(b){this.FJe=b;this.Evc=!1;this.nXc();if(t.AFrameworkApplication.ua&&t.AFrameworkApplication.ua.Sb.GMa&&yh.c()){b=t.AFrameworkApplication.K.$("UihostSupportsCreateNewDocumentFeatureIsEnbaledInWAC");
const h=t.AFrameworkApplication.WDb;appChrome.api.dispatch(appChrome.actions.setFileMenuTemplateJson(this.FJe,!0,b&&h))}}r7n(){this.jmd=this.Evc=!0;this.nXc();t.AFrameworkApplication.ua&&t.AFrameworkApplication.ua.Sb.GMa&&yh.c()&&appChrome.api.dispatch(appChrome.actions.setFileMenuTemplateJson("",!1,!1));Ca.Health.instance.recordQosError("TemplateServiceReturnedFailure",["TemplateServiceFailed"],!1,!0,!0,!1,null)}Hif(b){var h=0;for(var r=0;r<b.length;r++)if("ST"===b[r].ImageType){h=r;break}const z=
b.length?b[h]:null;b=z?z.Url||"":"";var R;let ba=r=h=!1;if(z&&(R=z.AspectRatio))R=parseFloat(R),1>R?h=!0:1.5<R?r=!0:1===R&&(ba=!0);else switch(v.ULS.sendTraceTag(5849603,202,10,"Thumbnail aspect ratio missing {0}",{["Url"]:b}),this.Q6.JNa){case 3:h=!0;break;case 2:r=!0;break;case 5:ba=!0}return{returnValue:b,Z_l:h?"95by123":r?"123by69":ba?"100by100":"123by95"}}hgl(b){b=({Y7d:h}=this.nmk(b,this.LVd,this.LVd.Tzc||"1056925771")).returnValue;if(h){this.B7c=b;var h=(new Date).getTime()-this.FQg;v.ULS.sendTraceTag(5849604,
202,50,"New menu rendering completed by GenerateXMLFromJSON {0}",{["ElapsedMsSinceMenuOpened"]:h})}return b}BAb(b,h){v.ULS.sendTraceTag(590964757,202,50,"GetMoreInfoEventReceived");this.Xv||3!==b.state?2===b.state&&(v.ULS.sendTraceTag(590964759,202,50,"GetMoreInfoResult was bad, need to retry"),this.xHe=!0,this.nXc()):(this.Xv=b,h||this.nXc(),t.AFrameworkApplication.ua&&t.AFrameworkApplication.ua.Sb.GMa&&yh.c()&&yh.d("setFileMenuHostInformation")&&(b=Object.assign(new gi,{hostUrl:this.Xv.Kaa,hostName:this.Xv.r3a,
folderUrl:t.AFrameworkApplication.breadcrumbFolderUrl,folderName:t.AFrameworkApplication.breadcrumbFolderName}),v.ULS.sendTraceTag(590964758,202,50,"Sending HostInformation to FileMenu"),appChrome.api.dispatch(appChrome.actions.setFileMenuHostInformation(b))))}nmk(b,h,r){let z;z=!1;const R=this.qgi();let ba="";this.Q6.u3a&&(this.xHe?(ba=Ch.zhh(h),this.xHe=!1,v.ULS.sendTraceTag(5849605,202,10,"Rendering File>New with error message due to GetMoreInfo request failure")):this.Xv?R?ba=Ch.qmk(h,this.Xv):
this.Xv.f7l?(z=!0,this.Evc=!1,ba=Ch.omk(h,this.Xv),v.ULS.sendTraceTag(5849607,202,50,"Rendering File>New with personal storage instantiation message")):(z=!0,ba=Ch.zhh(h),v.ULS.sendTraceTag(5849608,202,10,"Rendering File>New with error message due to GetMoreInfo invalid response. {0}",{["PersonalFileStorageUrlIsSet"]:!!this.Xv.Kaa,["StorageServiceDisplayNameIsSet"]:!!this.Xv.r3a})):(ba=Ch.pmk(h.labelText),v.ULS.sendTraceTag(5849606,202,50,"Rendering File>New with loading spinner")));R&&(ba+=Ch.mmk(h,
r,!ba)+({Y7d:z}=this.snk(b,r)).returnValue);return{returnValue:Ch.C1k(ba),Y7d:z}}snk(b,h){let r;r=!1;if(!this.l8d)return r=!0,v.ULS.sendTraceTag(5849609,202,50,"Rendering File>New without template buttons due to BRS"),{returnValue:"",Y7d:r};let z="",R="",ba="MenuTemplate";if(this.jmd)z=Ch.Ohh(),this.jmd=!1,v.ULS.sendTraceTag(5849610,202,10,"Rendering File>New with template error message");else if(b){try{const ta=Sys.Serialization.JavaScriptSerializer.deserialize(b,!0);z=this.rnk(ta,h);v.ULS.sendTraceTag(5849612,
202,50,"Rendering File>New with template buttons");t.AFrameworkApplication.vti&&"OneDrive"===this.TCa&&(R=Ch.kmk(this.iLm,t.AFrameworkApplication.vti))}catch(ta){v.ULS.sendTraceTag(5849613,202,10,"Failed to parse JSON response from template service {0}",{["JsonToConvert"]:b}),z=Ch.Ohh()}r=!0}else ba="MenuLoading",z=Ch.tnk(),v.ULS.sendTraceTag(5849611,202,50,"Rendering File>New with template loading spinner");return{returnValue:Ch.unk(ba,z)+R,Y7d:r}}rnk(b,h){let r="";const z=[];for(let ba=0;ba<b.length;ba++){var R=
b[ba];let ta="";if(R){const Wa=R.Title,ub=R.AssetId;R=R.Thumbnails;ub&&Wa&&R&&({Z_l:R,returnValue:ta}=this.Hif(R),r+=Ch.Mzc("jbtnNewTemplate"+ba,Wa,null,R,null,ta,h,ub))}z[ba]=ta}b=new Ic.a(4,1,5E3,()=>{this.BBm(z)},106);this.Q6.GVd.$b(b);return r}nXc(){this.nve=!0;this.Q6.jti.mFa(this.LVd.CGc);this.nve=!1}get Q6(){return this.Sxa.value}get LVd(){return this.unc.value}get hLm(){return this.qSa.value}get iLm(){return this.MMj.value}get TCa(){return this.B8a.value}get l8d(){return this.gVj.value}}Object(n.a)(Dh,
"CreateNewActor",null,[]);class Yj{constructor(){this._initialized=!1;this.HIe={}}nE(b){this.yEh();return this.get(b)}contains(b){this.yEh();return b.toString()in this.HIe}yEh(){this._initialized||(this.o5j(),this._initialized=!0)}M$a(b,h){this.HIe[b.toString()]=h}get(b){return this.HIe[b.toString()]}}Object(n.a)(Yj,"AIntlHelper",null,[]);class Ek extends Yj{constructor(){super()}o5j(){this.M$a(0,CommonUIStrings.l_OpenMenuEmptyMruMessage);this.M$a(1,CommonUIStrings.l_OpenMenuServerErrorMessage);this.M$a(2,
CommonUIStrings.l_Open);this.M$a(3,CommonUIStrings.l_OpenMenuRecentDocuments);this.M$a(4,CommonUIStrings.l_OpenMenuMoreOnHost);this.M$a(5,CommonUIStrings.l_VoicedLoadingText)}static get instance(){return Ek._instance||(Ek._instance=new Ek)}static a_m(b){return Ek.instance.nE(b)}}Ek._instance=null;Object(n.a)(Ek,"MruActorIntlHelper",Yj,[]);var wg;(function(b){b[b.success=0]="success";b[b.failure=1]="failure";b[b.spinner=2]="spinner";b[b.none=3]="none"})(wg||(wg={}));Object(n.b)("DisplayState",wg);
class ye{constructor(b,h,r,z,R,ba,ta,Wa){this.lje=null;this.tMe=!0;this.A7c="";this.bYj=0;this.gSb=null;this.Wwe=3;this.Oa=Wa;this.Sxa=b;this.Nqa=h;this.pDj=r;this.Gxj=z;this.Fxj=R;this.qSa=new De.a(()=>new gm.a(ba.value,null));this.kFj=new De.a(()=>new gm.a(ta.value,Object(u.a)(this,this.eKm,"mruEventResultReceived")));this.Oa.$("WacInTabOpenMRUIsEnabledForUiHost");this.Oa.$("UiHostSupportsDocRebootFeatures")}eKm(b,h){this.gSb=b;h||this.BLi()}Umn(){this.cM.Y9b.gb(ab.a.aMf,Yd.a.frame,Object(u.a)(this,
this.aMf,"populateMruMenu"),96)}aMf(b,h,r,z,R){return 1!==r&&R?this.$5m(R):32}$5m(b){this.j2k();this.i2k();b.PopulationXML=Ch.D1k(this.A7c+this.lje);return 32}j2k(){var b=3;let h=!1;if(this.A7c&&this.bYj===this.gSb.W8n)v.ULS.sendTraceTag(5849627,202,50,"Open menu MRU entries to XML conversion not required {0}",{["CacheRefresh"]:"Not Dirty"}),b=this.Wwe;else{v.ULS.sendTraceTag(5849628,202,50,"Open menu MRU entries to XML conversion started {0}",{["CacheRefresh"]:"Starting"});var r=this.cM.tw();this.gSb=
this.dKm.fk("File Open opened",!0);this.A7c&&2!==this.Wwe&&3!==this.gSb.state?h=!0:(b=this.NIl(this.gSb),t.AFrameworkApplication.ua&&t.AFrameworkApplication.ua.Sb.GMa&&yh.c()&&b&&appChrome.api.dispatch(appChrome.actions.setFileMenuMRUJson(b,!0)),this.A7c=({$Km:b}=this.igl(this.gSb)).returnValue);r=this.cM.tw()-r;v.ULS.sendTraceTag(5849629,202,50,"Open menu MRU entries to XML conversion ended {0}",{["CacheRefresh"]:"Complete",["ElapsedMs"]:r})}2!==b&&(r={["DisplayState"]:wg[b]},1!==b&&(r.IsStale=h),
v.ULS.sendTraceTag(5849630,202,50,"MRU section display state {0}",r));this.Wwe=b}NIl(b){let h;try{h=y.c(b.VAf)}catch(r){h=null,v.ULS.sendTraceTag(0,202,10,"MruActor.Serialize: Exception thrown from JsonSerializer.Serialize Exception: {0}",r)}return h}i2k(){this.tMe?(v.ULS.sendTraceTag(5849632,202,50,"Open menu Browse More Link creation necessary."),this.lje=({Zqo:this.tMe}=this.IDm()).returnValue):v.ULS.sendTraceTag(5849631,202,50,"Open menu Browse More Link creation not required.");v.ULS.sendTraceTag(5849633,
202,50,"Browse More link display state {0}",{["WaitingOnLinkInfo"]:this.tMe,["NotDisplayingLink"]:!this.lje})}igl(b){let h;1===b.state||0===b.state?(v.ULS.sendTraceTag(5849635,202,50,"Open menu XML built {0}",{["Display"]:"Spinner"}),b=2,h=Ch.vhh(this.RYa(2),this.RYa(5))):3===b.state&&b.VAf?(h=this.lmk(b.VAf),b=0):(v.ULS.sendTraceTag(5849634,202,50,"Open menu XML built {0}",{["Display"]:"Server Error"}),h=Ch.Qzc(this.RYa(1),this.RYa(2)),b=1);return{returnValue:h,$Km:b}}lmk(b){let h;const r=this.$Rc.Tzc||
"2155708348";if(b.length){h=Ch.Pzc("lblRecentDocuments",this.RYa(3));let z=0;for(let R=0;R<b.length;R++){const ba=b[R];"FileName"in ba&&"DocumentUrl"in ba&&"Path"in ba&&(h+=Ch.Mzc("MruButton"+R,ba.FileName.toString(),ba.Path.toString(),null,this.$Rc.sZa,this.$Rc.ELc,r,ba.DocumentUrl.toString()),ba.IsPinned&&z++)}h=Ch.QVa("RecentDocumentsMenuSection",Ch.ysi,this.RYa(2),h);v.ULS.sendTraceTag(5849665,202,50,"Open menu XML built {0}",{["Display"]:"MRU List",["TotalDocuments"]:b.length,["NumPinnedDocuments"]:z})}else h=
Ch.Qzc(this.RYa(0),this.RYa(2)),v.ULS.sendTraceTag(5849664,202,50,"Open menu XML built {0}",{["Display"]:"Empty MRU"});return h}IDm(){let b;b=!0;let h=this.bkk;var r=this.akk;if(h&&r||!this.cM.u3a)b=!1;else{const z=this.QGd.fk("File Open",!1);3===z.state&&(h=z.Kaa,r=z.r3a,b=!1)}r=r?String.format(this.RYa(4),r):null;return{returnValue:Ch.Mkk(this.$Rc.Tzc,r,h),Zqo:b}}BLi(){this.cM.jti.mFa(this.$Rc.CGc)}get cM(){return this.Sxa.value}get RYa(){return this.Nqa.value}get $Rc(){return this.pDj.value}get bkk(){return this.Gxj.value}get akk(){return this.Fxj.value}get QGd(){return this.qSa.value}get dKm(){return this.kFj.value}}
Object(n.a)(ye,"MruRenderer",null,[]);var Td=d(1525);class cg{constructor(b,h,r,z,R,ba,ta){this.Xv=null;this.NZg=!1;this.Dpa=this.k0=0;this.aNj=b;this.HSb=h;this.vgd=r;this.unc=z;this.B8a=R;this.Sxa=ba;this.qSa=new De.a(()=>new gm.a(ta.value,Object(u.a)(this,this.BAb,"getMoreInfoEventReceived")))}QCc(){!this.Xv&&this.yDf.u3a?this.QGd.fk("NewDocumentFromStream",!0):this.createNewDocumentFromStream()}BAb(b){if(!this.Xv&&3===b.state)this.Xv=b;else if(2===b.state){this.NZg?v.ULS.sendTraceTag(24904471,
202,10,"After second try GetMoreResult still fail."):(this.QGd.fk("NewDocumentFromStream",!0),this.NZg=!0);return}this.createNewDocumentFromStream()}createNewDocumentFromStream(){this.k0=(new Date).getTime();var b=this.X7k.suh;if(null===b)this.HSb(null);else{var h=this.vgd.menuItemId,r=this.vgd.xEa,z=this.vgd.u3n,R=this.vgd.e8k;this.Dpa="streamBase64"===z?R.length/1024:0;v.ULS.sendTraceTag(35156358,202,50,"FileType:{0}, FileSize:{1}",this.kda,this.Dpa);var ba=(new Date).getTime();b=String.format("{0}CreateNewDocument.aspx?dest={1}&tpl={2}&app={3}&lcid={4}&ct={5}&so=4&bid={6}&Canary={7}&{8}&sa={9}",
b,B.a.Ij(this.TCa),B.a.Ij(h),B.a.Ij(this.kda),B.a.Ij(t.AFrameworkApplication.lcid.toString()),B.a.Ij(ba.toString()),B.a.Ij(r),B.a.Ij(t.AFrameworkApplication.canary),t.AFrameworkApplication.xm,B.a.Ij(z));b+="&"+t.AFrameworkApplication.dId();t.AFrameworkApplication.z_a&&(b+="&"+t.AFrameworkApplication.LGd());(h=this.Xv?this.Xv.Kaa:null)&&(b+="&DestinationUrl="+B.a.Ij(h));this.yDf.ASc.Lj(b,2,R,{"Content-Type":"application/json; charset=utf-8"},!0,2,Object(u.a)(this,this.cLm,"newDocumentFromStreamSuccessHandler"),
Object(u.a)(this,this.bLm,"newDocumentFromStreamFailureHandler"),null,void 0,void 0,void 0,void 0,"31")}}cLm(b){if(b&&b.data&&b.data.Ge)if(({Fv:h}=y.d(b.data.Ge)).returnValue)if(b=h,b.StatusCode!==Ja.a.xD&&b.StatusCode!==Ja.a.bDc)v.ULS.sendTraceTag(24904475,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: StatusCode: {2}",this.kda,this.Dpa,b.StatusCode),this.HSb(null);else if(b.NewDocumentUrl&&""!==b.NewDocumentUrl){var h=(new Date).getTime()-this.k0;v.ULS.sendTraceTag(35156359,
202,50,"FileType:{0}, FileSize:{1}, TimeConsumed:{2}",this.kda,this.Dpa,h);this.aNj(b.NewDocumentUrl)}else v.ULS.sendTraceTag(24904476,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: Response data do not have NewDocumentUrl.",this.kda,this.Dpa),this.HSb(null);else v.ULS.sendTraceTag(24904474,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: Failed to deserialize: {2}",this.kda,this.Dpa,{["ResponseData"]:Td.a.X2c(b.data.Ge)}),this.HSb(null);else v.ULS.sendTraceTag(24904473,
202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: Response data is null",this.kda,this.Dpa),this.HSb(null)}bLm(b){b&&b.data&&v.ULS.sendTraceTag(24904477,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: ErrorStatus: {2}",this.kda,this.Dpa,b.data.status);this.HSb(null)}get kda(){switch(this.yDf.JNa){case 3:return"WordWAC";case 1:return"ExcelWAC";case 2:return"PowerPointWAC";case 5:return"VisioWAC"}return null}get X7k(){return this.unc.value}get TCa(){return this.B8a.value}get yDf(){return this.Sxa.value}get QGd(){return this.qSa.value}}
Object(n.a)(cg,"NewDocumentFromStreamOperation",null,[]);class Hi{constructor(b,h,r,z){this.unc=b;this.B8a=h;this.Sxa=r;this.jFj=z}create(b,h,r){return new cg(b,h,r,this.unc,this.B8a,this.Sxa,this.jFj)}}Object(n.a)(Hi,"NewDocumentFromStreamOperationFactory",null,[701]);var ee=d(122);class Fk{get name(){return"Common.App.NewAndOpen.UX"}yc(b){b.register(Hi,"Common.App.NewAndOpen.UX.NewDocumentFromStreamOperationFactory").as("Common.App.NewAndOpen.UX.INewDocumentFromStreamOperationFactory").singleInstance().Yd(()=>
new Hi(new De.a(()=>t.AFrameworkApplication.ua.Sb.Sdf()),new De.a(()=>t.AFrameworkApplication.TCa),new De.a(()=>b.Pa("Common.INewAndOpenCommonHelpers")),new De.a(()=>b.Pa("Common.IEventEmitter<Common.IGetMoreInfoResult>"))))}init(){t.AFrameworkApplication.K.zq(()=>{this.EZa()})}EZa(){const b=Sg.a.Kq(Sa.a.instance.Za("Common.INewAndOpenCommonHelpers")),h=Sg.a.Kq(Sa.a.instance.Za("Common.IEventEmitter<Common.IGetMoreInfoResult>"));t.AFrameworkApplication.TCa&&ee.Task.WAA.call(null,b,h).continueWith(()=>
{const r=new Dh(new De.a(()=>b.result),new De.a(()=>t.AFrameworkApplication.ua.Sb.Sdf()),new De.a(()=>h.result),new De.a(()=>t.AFrameworkApplication.ua.Sb.Tdf().Tzc||"1959943459"),new De.a(()=>t.AFrameworkApplication.TCa),new De.a(()=>t.AFrameworkApplication.Bgm));r.Vb();r.nXc()});if(t.AFrameworkApplication.ZPf){const r=Sg.a.Kq(Sa.a.instance.Za("Common.IEventEmitter<Common.IMruResult>"));ee.Task.WAA.call(null,b,h,r).continueWith(()=>{const z=new ye(new De.a(()=>b.result),new De.a(()=>Ek.a_m),new De.a(()=>
t.AFrameworkApplication.ua.Sb.Tdf()),new De.a(()=>t.AFrameworkApplication.$Zm),new De.a(()=>t.AFrameworkApplication.ZZm),new De.a(()=>h.result),new De.a(()=>r.result),t.AFrameworkApplication.K);z.Umn();z.BLi()})}}dispose(){}}Object(n.a)(Fk,"UXPackageManager",null,[1,2,9]);var te=d(142);class Cg extends te.StandardDialog{constructor(){super();this.Fd=0;this.Ve(1,CommonUIStrings.l_DialogClose)}MS(b){this.jy(b,CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_OneDriveContactError,null)}R4e(b){this.jy(b,
CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_OneDriveContactError,null,!0)}}Object(n.a)(Cg,"ErrorDialog",te.StandardDialog,[742]);var cc=d(433);class rh{fMh(){v.ULS.sendTraceTag(24134234,352,50,"Returning endpoint for ODC");const b=new cc.a;b.Gg("api.onedrive.com");return b.task}}Object(n.a)(rh,"OneDriveConsumerEndpointHelper",null,[654]);var pe=d(41);class ah{constructor(b,h,r,z){this.Orb=this.WCa=null;this.PGe=this.RGe=!1;this.VSb=null;this.Oa=b;this.S6c=h;this.Yqb=r;this.pG=z}get xbh(){return this.S6c}get K(){return this.Oa}i3b(){this.VSb||
(this.VSb=this.hac?hc.a.create(this.hac,null,null,null,!1):null);return this.VSb}setup(b){this.Orb=b;this.RGe||this.PGe?this.RGe&&this.Orb&&this.Orb(!0):(b=this.i3b())?(this.PGe=!0,b.h0a.continueWith(h=>{this.LUm(h)}),Rb.a.XS(b)):(v.ULS.sendTraceTag(20509837,352,15,"Failure with OneDrive API download as the onedrive url received is empty."),this.Orb(!1))}gHf(b){v.ULS.sendTraceTag(20509838,352,15,"Failure during OneDrive API download: {0}",b.exception?b.exception.toString():"No error detail.")}LUm(b){this.PGe=
!1;if(b.Ji)this.gHf(b),this.Orb(!1);else try{this.RGe=!0,v.ULS.sendTraceTag(17909022,352,50,"Initializing OneDrive API"),this.mnf(),v.ULS.sendTraceTag(17909023,352,50,"OneDrive API is initialized."),this.Orb(!0)}catch(h){v.ULS.sendTraceTag(20555412,352,10,"Failed during OneDrive API init: {0}",h.toString()),this.Orb(!1)}}k1c(b){this.WCa=b;this.Yqb?v.ULS.sendTraceTag(23881878,216,50,"In limited edit mode, will not show Picker."):(v.ULS.sendTraceTag(23881877,216,50,"Not in limited edit mode, will show file picker."),
this.setup(Object(u.a)(this,this.mFf,"onApiReady")))}mFf(b){b?this.DRd():this.xp()}xp(){this.pG().MS(pe.a.nZm)}onSuccess(b){v.ULS.sendTraceTag(17909057,352,50,"Success Callback called. Calling callback function.");this.WCa&&this.WCa(!0,b)}dispose(){this.VSb&&this.VSb.dispose()}}Object(n.a)(ah,"AOneDriveFilePickerApiManager",null,[710,9]);class Tg extends ah{constructor(b,h,r,z,R,ba){super(h,r,z,ba);this.Km=null;this.Jqa=b;this.oVj=R}get hac(){return this.K.lb("OneDriveApiUrl")}start(b,h){this.Km=
b;this.k1c(h)}mnf(){WL.init(1===this.xbh||2===this.xbh?{["client_id"]:this.K.appSettings.UploadToSkyDriveClientId}:{["client_id"]:this.K.appSettings.UploadToSkyDriveClientId,["env"]:"INT"})}k1c(b){this.WCa=b;!this.Yqb&&this.Jqa.dNc?(v.ULS.sendTraceTag(17909025,352,50,"User is signed in. We will show file picker."),this.setup(Object(u.a)(this,this.mFf,"onApiReady"))):(v.ULS.sendTraceTag(17909026,352,50,"User is not signed in. show need to sign in dialog."),this.oVj())}DRd(){try{v.ULS.sendTraceTag(17909027,
352,50,"Launching file dialogue"),WL.fileDialog(this.Km).then(Object(u.a)(this,this.onSuccess,"onSuccess"),Object(u.a)(this,this.onFailure,"onFailure"))}catch(b){v.ULS.sendTraceTag(17909056,352,10,"OneDrive API Failure. [Exception:{0}] [Stack:{1}]",b,b.stack),this.xp()}}onFailure(b){if(b&&b.error){if("user_canceled"===b.error.code){v.ULS.sendTraceTag(17909058,352,50,"User canceled.");return}v.ULS.sendTraceTag(17909059,352,50,"File Dialog returned with error code:{0}, and error message: {1}",b.error.code,
b.error.message)}else v.ULS.sendTraceTag(17909060,352,50,"File Dialog returned with no response");this.WCa&&this.WCa(!1,b);this.xp()}}Object(n.a)(Tg,"OneDriveFilePickerApiManagerV5",ah,[]);class ri extends ah{constructor(b,h,r,z,R){super(b,h,r,z);this.Pbd=this.UTg=null;this.ACj=R;this.options={};this.options.clientId=this.K.lb("OneDriveApiV7ClientId");this.options.cancel=Object(u.a)(this,this.abe,"toggleHostDivVisibility")}get hac(){return this.K.lb("OneDriveApiV72Url")}start(b,h){this.Pbd=h;const r=
this.ACj.fMh();r.continueWith(()=>{v.ULS.sendTraceTag(24134241,352,50,"Fetch endpoint task completed, attempting to start OneDrive picker");this.UTg=r.result;this.k1c((z,R)=>{this.abe();b(z,R)})},3);r.continueWith(()=>{v.ULS.sendTraceTag(24134242,352,15,r.exception.message);this.abe()},5)}mnf(){this.options.success=b=>{const h={};h.data=b;this.onSuccess(h)};this.options.error=b=>{const h={};h.error=b;this.onFailure(h)};this.options.advanced={};this.options.advanced.linkType="share";this.options.advanced.endpointHint=
this.UTg;this.options.advanced.iframeParentDiv=this.Pbd}DRd(){try{v.ULS.sendTraceTag(22090007,352,50,"Launching OneDrive file picker dialog"),this.abe(),OneDrive.open(this.options)}catch(b){v.ULS.sendTraceTag(22090008,352,10,"Opening OneDrive file picker threw an exception: {0}",b.message),this.xp()}}onFailure(b){this.WCa&&this.WCa(!1,b);this.xp()}abe(){this.Pbd.style.visibility="hidden"===this.Pbd.style.visibility?"":"hidden"}}Object(n.a)(ri,"OneDriveFilePickerApiManagerV7",ah,[]);class Rl extends ah{constructor(b,
h,r,z){super(b,h,r,z);this.Wvj=b;this.options={};this.options.advanced={};this.options.action="query";this.options.clientId=this.K.lb("OneDriveApiV72ClientId");this.options.advanced.trapFocus=!0}get hac(){return this.K.lb("OneDriveApiV72Url")}start(b,h,r,z){this.options.advanced.iframeParentDiv=r;this.options.advanced.endpointHint=z;this.options.cancel=h;this.Wvj.$("OneDriveApiV72RecentsViewEnabled")&&(this.options.advanced.navigation={},this.options.advanced.navigation.entryLocation={},this.options.advanced.navigation.entryLocation.oneDrive=
{},this.options.advanced.navigation.entryLocation.oneDrive.recent={});this.k1c(b)}k1c(b){this.WCa=b;this.Yqb?v.ULS.sendTraceTag(24391838,216,50,"In limited edit mode, will not show Picker."):(v.ULS.sendTraceTag(24391837,216,50,"Not in limited edit mode, will show file picker."),this.setup(Object(u.a)(this,this.mFf,"onApiReady")))}mnf(){this.options.success=b=>{const h={};h.data=b;this.onSuccess(h)};this.options.error=b=>{const h={};h.error=b;this.onFailure(h)}}DRd(){try{v.ULS.sendTraceTag(23881879,
216,50,"Launching OneDrive file picker dialog"),OneDrive.save(this.options)}catch(b){v.ULS.sendTraceTag(23881880,216,10,"Opening OneDrive file picker fail. Exception: {0}, Callstack: {1}.",b.message,b.stack),this.xp()}}gHf(b){v.ULS.sendTraceTag(25180160,216,15,"Failure during OneDrive API download: {0}",b.exception?b.exception.toString():"No error detail.");Rb.a.Eqn(this.hac);this.VSb=null}xp(){this.pG().R4e(pe.a.xBn)}onFailure(b){this.WCa&&this.WCa(!1,b)}}Object(n.a)(Rl,"OneDriveFilePickerApiManagerV72",
ah,[]);class Tf{constructor(b){this.olsSessionId=this.value=this.key=null;this.olsSessionId=b}}Object(n.a)(Tf,"IExtraData",null,[]);class hm extends Rl{constructor(b,h,r,z){super(b,h,r,z);this.options.advanced.filter=b.lb("OneDriveApiV72Filter")||"folder,photo";this.options.advanced.linkType="download";this.options.multiSelect=t.AFrameworkApplication.Jbh;b.$("OneDriveApiV72CommandModeEnabled")&&(this.options.commandMode=b.lb("OneDriveApiV72CommandMode")||"none");b.$("OneDriveApiV72QosExtraDataEnabled")&&
(this.options.qosExtradata=new Tf(t.AFrameworkApplication.userSessionId))}get hac(){return this.K.lb("OneDriveApiV72Url")}DRd(){try{v.ULS.sendTraceTag(26071182,352,50,"Launching OneDrive file picker dialog with filter: {0}, commandMode: {1}, QosExtraData: {2} officeSessionId: {3}",this.options.advanced.filter,this.options.commandMode,this.options.qosExtradata?this.options.qosExtradata.olsSessionId:"",t.AFrameworkApplication.userSessionId),OneDrive.open(this.options)}catch(b){v.ULS.sendTraceTag(26071183,
352,10,"Opening OneDrive file picker fail. Exception: {0}, Callstack: {1}.",b.message,b.stack),this.xp()}}}Object(n.a)(hm,"OneDriveFilePickerApiOpenManagerV72",Rl,[]);class mh{constructor(b){this.fr=null;this.rg=b;this.cFe=3}fMh(){this.fr=new cc.a;v.ULS.sendTraceTag(24134235,352,50,"Sending initial request for OneDrive for Business Endpoint");this.IWf();return this.fr.task}IWf(b=null){const h=String.format("GetMoreInfoHandler.ashx?{0}",t.AFrameworkApplication.Gxb);this.rg.WWb(h,1,null,b,["PersonalFileStorageUrl",
"X-NewKey"],2,Object(u.a)(this,this.Ezl,"getMoreInfoSucceeded"),Object(u.a)(this,this.Czl,"getMoreInfoFailed"),void 0,void 0,void 0,void 0,"21")}Czl(b){if(b.data.wf===Ja.a.kga&&"X-NewKey"in b.data.rj){v.ULS.sendTraceTag(24134236,352,50,"GetMoreInfo request failed due to bad canary. Updating with new canary and resending");const h={};h["X-Key"]=b.data.rj["X-NewKey"];this.IWf(h)}else 0<this.cFe?(v.ULS.sendTraceTag(24134237,352,50,"GetMoreInfo request failed, attmepting again. {0} retries remaining",
this.cFe),this.cFe--,this.IWf()):(v.ULS.sendTraceTag(24134238,352,50,"GetMoreInfo request failed, and no more retries remaining. Faulting task"),this.fr.setException(Error.create("GetMoreInfo request failed and no more retries remain")))}Ezl(b){"PersonalFileStorageUrl"in b.data.rj&&""!==b.data.rj.PersonalFileStorageUrl?(v.ULS.sendTraceTag(24134239,352,50,"Successfully received an ODB endpoint"),this.fr.Gg(b.data.rj.PersonalFileStorageUrl)):(v.ULS.sendTraceTag(24134240,352,50,"GetMoreInfo request was successful but didn't return an ODB endpoint"),
this.fr.setException(Error.create("GetMoreInfo request succeeded but did not have ODB endpoint")))}}Object(n.a)(mh,"OneDriveForBusinessEndpointHelper",null,[654]);var ck=d(744);class Uf{constructor(){this.W=null}get name(){return"Common.App.OneDriveFilePickerApi"}init(){}dispose(){}yc(b){this.W=b;this.W.register(Tg,"Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV5").as("Common.App.OneDriveFilePickerApi.IOneDriveFilePickerApiManager").singleInstance().Yd(()=>new Tg(ck.a.instance,t.AFrameworkApplication.K,
t.AFrameworkApplication.eea,t.AFrameworkApplication.Ama,t.AFrameworkApplication.T0f,()=>new Cg));t.AFrameworkApplication.F7b?this.W.register(654,"Common.App.OneDriveFilePickerApi.IOneDriveApiEndpointHelper").singleInstance().Yd(()=>new rh):this.W.register(654,"Common.App.OneDriveFilePickerApi.IOneDriveApiEndpointHelper").singleInstance().Yd(()=>new mh(t.AFrameworkApplication.Xe));this.W.register(ri,"Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV7").singleInstance().Yd(()=>new ri(t.AFrameworkApplication.K,
t.AFrameworkApplication.eea,t.AFrameworkApplication.Ama,()=>new Cg,this.W.resolve("Common.App.OneDriveFilePickerApi.IOneDriveApiEndpointHelper")));this.W.register(Rl,"Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV72").singleInstance().Yd(()=>new Rl(t.AFrameworkApplication.K,t.AFrameworkApplication.eea,t.AFrameworkApplication.Ama,()=>new Cg));this.W.register(hm,"Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiOpenManagerV72").singleInstance().Yd(()=>new hm(t.AFrameworkApplication.K,
t.AFrameworkApplication.eea,t.AFrameworkApplication.Ama,()=>new Cg))}static main(){O.a.instance.Oc(new Uf)}}Object(n.a)(Uf,"PackageManager",null,[1,2]);class al{constructor(b,h,r,z,R,ba){this.PolicyCookie=this.WebAffinitizedUrl=this.IsSafeLinksEnabled=null;this.PolicyCookieTTL=0;this.WasServiceDown=!1;this.AffinitizedUrl=null;this.IsSafeLinksEnabled=b;this.WebAffinitizedUrl=h;this.PolicyCookie=r;this.PolicyCookieTTL=z;this.WasServiceDown=R;this.AffinitizedUrl=ba}}Object(n.a)(al,"SafeLinksData",null,
[]);class gl{constructor(b,h){this.qae=b;this.hx=h}}Object(n.a)(gl,"SafeLinksGetUrlReputationRequestData",null,[]);class nm{constructor(b,h,r,z){this.Oa=b;this.rg=h;this.CFj=r;nm.le=z}ahc(b,h,r){try{var z=null;nm.le&&(z=nm.le.hg("WebServiceCall","SafeLinksGetUrlReputation"));const R=new gl(h,z);z={};z.AffinitizedUrl=b;z.TargetUrl=h;z.PolicyCookie=r;const ba=y.c(z);this.rg.Lj(this.CFj,2,ba,null,!1,2,Object(u.a)(this,this.KSm,"onGetUrlReputationSuccessCallback"),Object(u.a)(this,this.JSm,"onGetUrlReputationFailureCallback"),
R,void 0,void 0,3E3,3E3,"36");return!0}catch(R){v.ULS.sendTraceTag(588788033,378,10,R.message)}return!1}KSm(b){let h="OnGetUrlReputationSuccessCallback: ",r=10;const z=b.data.state;try{const R=y.b(b.data.Ge).reputationResults[0],ba=R.navigateUrl.length,ta=z.qae.length,Wa=R.navigateUrl===z.qae;R.navigateUrl&&0<R.navigateUrl.length&&(z.qae=R.navigateUrl);h+=String.format("HttpStatus {0}, verdict {1}, clickedUrlLength = {2} navigateUrlLength {3}, navigateUrlSameAsClickedUrl {4}",b.data.wf,R.verdict,
ta.toString(),ba.toString(),Wa.toString());r=50}catch(R){h+=String.format("Exception {0}",R.message)}this.Q2h(z,h,r)}JSm(b){let h="OnGetUrlReputationFailureCallback: ";const r=b.data.state;try{h+=String.format("HttpStatus {0}",b.data.wf)}catch(z){h+=String.format("Exception {0}",z.message)}this.Q2h(r,h,10)}Q2h(b,h,r){b.hx&&(b.hx.stop(),b.hx=null);v.ULS.sendTraceTag(588788034,378,r,h);Ed.a.Cm(b.qae,void 0,"noopener,noreferrer","SafeLinksNav")}}nm.le=null;Object(n.a)(nm,"SafeLinksNavigationHelper",
null,[]);var dj;(function(b){b[b.enabledByPolicy=0]="enabledByPolicy";b[b.disabledByPolicy=1]="disabledByPolicy";b[b.disabled_GetPolicyFailure=2]="disabled_GetPolicyFailure";b[b.disabled_PendingGetPolicyRequest=3]="disabled_PendingGetPolicyRequest"})(dj||(dj={}));Object(n.b)("SafeLinksNavigationState",dj);class bi{constructor(b,h,r,z=!1,R=null,ba=null){this.Hpb=this.Gpb=0;this.UNc=this.ibd=!1;this.X8a=null;this.PRb=!0;this.Bld=null;v.ULS.sendTraceTag(26019598,378,100,"Initializing SafeLinksManager.");
this.Oa=b;this.rg=h;this.tnb=r;bi.le=ba;this.e_j=z?this.Oa.lb("SafeLinksHandlerWebServiceBase"):this.Oa.lb("WebServiceBase");this.vZj=this.Oa.lb("SafeLinksHashedUserId");this.Wuo=this.Oa.lb("SafeLinksWorkloadIdHeaderValue");this.Lfd=this.Oa.rc("SafeLinksMaxGetPolicyBootRetries",2);this.Mfd=this.Oa.rc("SafeLinksMaxGetPolicyOnLinkClickRetries",1);this.Cdd=this.Jjm();this.Bdd=this.Ijm();v.ULS.sendTraceTag(26019599,378,50,"SafeLinksManager _isEnabledForUser={0}, _isEnabledForBrowser={1}",this.Cdd,this.Bdd);
if(this.Cdd&&this.Bdd){h=(b=this.i2b())?b.IsSafeLinksEnabled.toLowerCase():"";r=this.Jsf();v.ULS.sendTraceTag(36231312,378,50,"Cached values for IsSafeLinksEnabled: {0}, IsPolicyCookieExpired: {1}.",h,r);var ta=!b||"unknown"===h||b.WasServiceDown||r,Wa=xa.a.iF();Wa&&(Wa.set("shouldGetSafeLinksDataFromServer",ta.toString()),Wa.set("isSafeLinksEnabledCacheValue",h.toString()));this.Oa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SafeLinksLicenseCheck",!1)&&R?(this.PRb=!1,R.execute(ub=>{ub.isFeatureEnabled("MsoUrlreputation",
!0).then(Ib=>{this.PRb=Ib;Wa.set("isUserLicensedForSafeLinks",this.PRb.toString());Ca.Health.instance.recordKpiUsage("SafeLinksGetPolicy1",0,"jpittsdirects",Wa);this.PRb&&ta&&this.YHd(!0);return null})})):(Ca.Health.instance.recordKpiUsage("SafeLinksGetPolicy1",0,"jpittsdirects",Wa),ta&&this.YHd(!0))}}get appName(){return this.tnb}get $de(){return this.e_j}get userId(){return this.vZj}get lEl(){const b=this.$de?this.$de+"/":"",h=new Ma.QueryStringBuilder("SafeLinksHandler.ashx");h.Ie("app",this.appName);
this.Oa.$("SafeLinksUseDebugHeader")&&h.Ie("action","debug");this.Oa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SafeLinksS2SAuthAATPOP",!1)&&h.Ie("s2satpop","1");this.Oa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SafeLinksS2SAuthAAT",!1)&&h.Ie("s2saat","1");this.Oa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SafeLinksS2SAuthUseE03App",!1)&&h.Ie("s2se03","1");return String.format("{0}{1}&{2}",b,h.toString(),t.AFrameworkApplication.xm)}get hOl(){const b=this.$de?this.$de+
"/":"",h=new Ma.QueryStringBuilder("SafeLinksHandler.ashx");h.Ie("app",this.appName);this.Oa.$("SafeLinksUseDebugHeader")&&h.Ie("action","debug");this.Oa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SafeLinksS2SAuthAATPOP",!1)&&h.Ie("s2satpop","1");this.Oa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SafeLinksS2SAuthAAT",!1)&&h.Ie("s2saat","1");this.Oa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SafeLinksS2SAuthUseE03App",!1)&&h.Ie("s2se03","1");h.Ie("slrt","GetUrlReputation");
return String.format("{0}{1}&{2}",b,h.toString(),t.AFrameworkApplication.xm)}get HKm(){bi.PFe||(bi.PFe=new nm(this.Oa,this.rg,this.hOl,bi.le));return bi.PFe}ahc(b){if(!b)return v.ULS.sendTraceTag(593367827,378,10,"SafeLinksManager.TryNavigate: Null/Empty targetUrl"),!1;var h=this.nem(b);v.ULS.sendTraceTag(594830615,378,50,"SafeLinksManager.TryNavigate: isSupportedHyperLinkType={0},_isEnabledForUser={1},_isEnabledForBrowser={2},_isUserLicensedForSafeLinks={3}",h,this.Cdd,this.Bdd,this.PRb);if(!(h&&
this.Cdd&&this.Bdd&&this.PRb))return!1;h=0;const r=({state:h}=this.DVn()).returnValue;v.ULS.sendTraceTag(595079385,378,50,"ShouldTryUsingSafeLinksService returned NavigationState={0}",dj[h]);const z=xa.a.iF();z&&z.set("SafeLinksNavigationState",dj[h]);Ca.Health.instance.recordKpiUsage("SafeLinksNavigations",0,"jpittsdirects",z);if(!r)return 2!==h&&3!==h||Ca.Health.instance.recordKpiFailure("SafeLinksNavigations",dj[h],!1,!0,null),!1;v.ULS.sendTraceTag(26019601,378,50,"Using safelinks to navigate hyperlink");
if(this.cWn())return this.Jsf()?!1:this.HKm.ahc(this.ehl(),b,this.LWh());if(!this.Jsf())return this.$dj(b),!0;this.X8a=b;v.ULS.sendTraceTag(24462627,378,50,"Refreshing the cache as policy cookie expired.");this.UNc=!1;this.YHd();return!0}nem(b){b=b.toLowerCase();const h=this.Oa.KB("SafeLinksUnsupportedProtocols");if(h)for(let r=0;r<h.length;r++)if(b.startsWith(h[r]))return!1;return!0}YHd(b=!1){var h=xa.a.iF();h&&h.set("isOnBootRequest",b.toString());Ca.Health.instance.recordKpiUsage("SafeLinksGetPolicySuccessfulRequest",
1,"jpittsdirects",h);Ca.Health.instance.recordKpiUsage("SafeLinksGetPolicyFailedRequest",0,"jpittsdirects",h);h=this.n_e("SafeLinksGetPolicy");this.rg.Lj(this.lEl,1,null,null,!0,2,Object(u.a)(this,this.EHl,"getSafeLinksDataFromServer_OnSuccessCallback"),Object(u.a)(this,this.DHl,"getSafeLinksDataFromServer_OnFailureCallback"),h,void 0,void 0,void 0,void 0,"23");this.UNc=b;this.ibd=!0;b?this.Gpb++:this.Hpb++}EHl(b){let h=Ja.a.iMm,r="";try{this.ibd=this.UNc=!1;var z=b.data.state;const Kc=({hx:z}=this.e$d(z)).returnValue,
ed=Object.assign(new eb.a,{durationMs:Kc});Ca.Health.instance.recordKpiSuccess("SafeLinksGetPolicySuccessfulRequest",ed);v.ULS.sendTraceTag(594830614,378,50,"GetSafeLinksDataFromServer_OnSuccessCallback: HttpStatus {0}, data length {1}, Duration {2}",b.data.wf,b.data.Ge.length,Kc);if(b.data.wf!==Ja.a.xD)r="Unexpected httpStatus: "+b.data.wf.toString();else{z=null;try{z=y.b(b.data.Ge)}catch(Jd){r="Exception:"+Jd.toString()+" deserializing response";return}if(z){var R=z.IsSafeLinksEnabled;if(void 0===
R||null===R||0>=R.length)r="Invalid isSafeLinksEnabledString";else{v.ULS.sendTraceTag(594830613,378,50,"Retrieved isSafeLinksEnabledString {0}",R);var ba=bi.LKf(R);if(void 0===z.WebAffinitizedUrl||null===z.WebAffinitizedUrl||0>=z.WebAffinitizedUrl.length)r="Invalid WebAffinitizedUrl";else if(void 0===z.PolicyCookie||null===z.PolicyCookie||0>=z.PolicyCookie.length)r="Invalid PolicyCookie";else if(void 0===z.PolicyCookieTTL||null===z.PolicyCookieTTL)r="Invalid PolicyCookieTTL";else{var ta=z.WebAffinitizedUrl,
Wa=z.PolicyCookie,ub=z.AffinitizedUrl,Ib=new Date;Ib.setMinutes(Ib.getMinutes()+(5<z.PolicyCookieTTL?z.PolicyCookieTTL-5:0));var $b=Ib.getTime(),fc=new al(R,ta,Wa,$b,!1,ub);this.YXi(fc);h=b.data.wf;this.X8a&&(ba?(this.$dj(this.X8a),this.Hpb=this.Gpb=0):(v.ULS.sendTraceTag(26019602,378,50,"SafeLinks is disabled by admin; Navigating without SafeLinks"),Ca.Health.instance.recordKpiFailure("SafeLinksNavigations","disabledByPolicy",!0,!0,null),Ed.a.tzb(this.X8a)),this.X8a=null)}}}else r="Error when serializing response into SafeLinksData. SafeLinksData is null."}}catch(Kc){r=
"GetSafeLinksDataFromServer_OnSuccessCallback: Exception:  "+Kc.toString()}finally{h!==Ja.a.xD&&this.P2h(h,r)}}DHl(b){this.ibd=!1;let h=500,r="";try{let z=b.data.state;const R=({hx:z}=this.e$d(z)).returnValue,ba=Object.assign(new eb.a,{durationMs:R});h=b.data.wf;Ca.Health.instance.recordKpiFailure("SafeLinksGetPolicyFailedRequest","HttpStatusCode_"+h.toString(),!1,!0,ba);r="Request Failed, Status="+Rk.a[b.data.status]+" Duration: "+R}catch(z){r="GetSafeLinksDataFromServer_OnFailureCallback Exception: "+
z.toString()}finally{this.P2h(h,r)}}P2h(b,h=""){try{if(v.ULS.sendTraceTag(594830612,378,10,"HandleGetPolicyRequestError: HttpStatus {0}, Error {1}",b,h),this.Gpb<this.Lfd&&this.Hpb<this.Mfd)this.YHd(this.UNc);else{this.UNc=!1;v.ULS.sendTraceTag(24462656,378,10,"Exhausted all retries for SafeLinks GetPolicy call. OnBootRetries: {0}, OnClickRetries: {1}, HttpStatus: {2}, Error: {3}",this.Gpb,this.Hpb,b,h);h=null;const r=xa.a.iF();r&&(r.set("HttpStatus",b.toString()),h=Object.assign(new eb.a,{extendedProperties:r}));
Ca.Health.instance.recordKpiFailure("SafeLinksGetPolicy1","GetPolicyRequestError",!1,!0,h);const z=new al("false","","",0,!0,"");this.YXi(z);this.X8a&&(v.ULS.sendTraceTag(26019603,378,50,"Error occurred during at-click GetPolicy call, NavigationState = {0}","disabled_GetPolicyFailure"),Ca.Health.instance.recordKpiFailure("SafeLinksNavigations","disabled_GetPolicyFailure",!1,!0,null),Ed.a.tzb(this.X8a),this.X8a=null)}}catch(r){v.ULS.sendTraceTag(594830611,378,10,"HandleGetPolicyRequestError: Exception {0}",
r.toString())}}$dj(b){const h=this.LWh(),r=this.oPl(),z={};z.Url=b;z.SafeLinksCookie=h;z.CorrelationId=pa.a.create().toString();z.WorkloadId=this.Wuo;z.UserAgentInfo=X.a.dF+"|"+this.appName;v.ULS.sendTraceTag(23900187,378,50,"Validating hyperlink with request correlation: {0}",z.CorrelationId);Ed.a.lMf(Ed.a.Ioa(4),r,z)}Jjm(){const b=this.Oa.lb("IsSafeLinksEnabledForUser");return b?bi.LKf(b):!1}Ijm(){const b=this.Oa.KB("SafeLinksDisabledBrowsers");if(X.a.s2){if(this.Oa.yu("SafeLinksForTeamsIsEnabled")&&
this.Oa.$("SafeLinksForTeamsIsEnabled"))return!0;if(Array.contains(b,"Electron"))return!1}else if(Array.contains(b,X.a.dF))return!1;return"officecomhwa"===(this.Oa.lb(t.AFrameworkApplication.pha)||"").toLowerCase()?!1:!0}cWn(){return-1!==window.location.href.indexOf("&wd_slnh=1")||this.Oa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SafeLinksUseNavigationHelperForMobile",!1)&&X.a.Yrf?!0:X.a.s2}DVn(){let b;b=0;const h=this.i2b(),r=h?h.IsSafeLinksEnabled:"";if(""!==r)return h.WasServiceDown?
(v.ULS.sendTraceTag(51663971,378,50,"Failed to retrieve policy data"),{returnValue:!1,state:2}):"false"===r.toLowerCase()?(v.ULS.sendTraceTag(51664E3,378,50,"SafeLinks disabled for the user"),{returnValue:!1,state:1}):{returnValue:bi.LKf(r),state:b};if(this.ibd)return b=3,v.ULS.sendTraceTag(595079384,378,50,"Currently getting SafeLinks policy"),{returnValue:!1,state:b};if(this.Gpb>=this.Lfd||this.Hpb>=this.Mfd)return b=2,v.ULS.sendTraceTag(51664001,378,50,"Exhausted all retries- Failure in GetPolicy for SafeLinks ({0}/{1} boot, {2}/{3} onClick)",
this.Gpb,this.Lfd,this.Hpb,this.Mfd),{returnValue:!1,state:b};v.ULS.sendTraceTag(23900182,378,10,"Inconsistent SafeLinks state: SafeLinks cache data is null with no on boot request pending, and {0} retries left over. Perhaps LocalStorage is inaccessable.",this.Lfd+this.Mfd-(this.Gpb+this.Hpb));return{returnValue:!0,state:b}}LWh(){const b=this.i2b();return b?b.PolicyCookie:""}oPl(){const b=this.i2b();return b?b.WebAffinitizedUrl:""}ehl(){const b=this.i2b();return b?b.AffinitizedUrl:""}mrl(){const b=
new Date;try{const h=this.i2b();b.setTime(h?h.PolicyCookieTTL:0)}catch(h){v.ULS.sendTraceTag(24462658,378,10,"Exception occured while fetching expiration time from cache: {0}",h)}return b}Jsf(){const b=this.mrl();return!!b&&b.getTime()<Date.now()}i2b(){if(!this.Bld){const b=mb.a.instance.getItem(this.userId);if(!b||""===b)return null;this.Bld=JSON.parse(b)}return this.Bld}YXi(b){if(void 0===b||null===b)throw Error.argumentNull("safeLinksData");if(void 0===b.IsSafeLinksEnabled||null===b.IsSafeLinksEnabled||
0>=b.IsSafeLinksEnabled.length)throw Error.argumentNull("safeLinksData.IsSafeLinksEnabled");this.Bld=b;b.WasServiceDown||this.jvo(b)}jvo(b){b=JSON.stringify(b);mb.a.instance.setItem(this.userId,b)}n_e(b){return void 0!==bi.le&&null!==bi.le?bi.le.hg("WebServiceCall",b):null}e$d(b){if(void 0!==b&&null!==b){const h=b.oi;b.stop();return{returnValue:h,hx:null}}return{returnValue:null,hx:b}}static LKf(b){return"false"!==b.toLowerCase()?!0:!1}}bi.le=null;bi.PFe=null;Object(n.a)(bi,"SafeLinksManager",null,
[682]);const Qd=b=>{switch(b){case 3:return"Word";case 1:return"Excel";case 2:return"PowerPoint";case 4:return"OneNote";case 5:return"Visio";default:return"Unknown"}},Mi=b=>{switch(b){case 1:return"Edit";case 2:return"View";case 3:return"InstantView";default:return"Unknown"}};class Hn{constructor(){this.W=null}get name(){return"Common.App.SafeLinks"}yc(b){this.W=b}init(){t.AFrameworkApplication.K&&t.AFrameworkApplication.K.zq(Object(u.a)(this,this.ax,"onFullAppSettingsReady"))}dispose(){}ax(){t.AFrameworkApplication.K.$("WACSafeLinksIsEnabled")&&
(this.W.register(bi,"Common.App.SafeLinks.SafeLinksManager").as("Common.App.SafeLinks.ISafeLinksManager").singleInstance().Yd(()=>new bi(t.AFrameworkApplication.K,t.AFrameworkApplication.Xe,String.format("{0}-{1}",Qd(t.AFrameworkApplication.ua.Sb.jo),Mi(t.AFrameworkApplication.ua.Sb.Mfa)),!1,this.W.Za("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"),t.AFrameworkApplication.ua.jq)),this.W.Pa("Common.App.SafeLinks.ISafeLinksManager"))}static main(){O.a.instance.Oc(new Hn)}}Object(n.a)(Hn,
"SafeLinksPackage",null,[1,2]);var Df=d(182);class ci{constructor(b){this.sa=new Te.a;this.Eh=b}N$a(b){this.sa.addHandler(ci.Ava,b)}dYc(b){this.sa.removeHandler(ci.Ava,b)}O$a(b){this.sa.addHandler(ci.tQa,b)}occ(b){this.sa.removeHandler(ci.tQa,b)}xPe(b){this.sa.addHandler(ci.Agc,b)}o0f(){this.sa.raiseEvent(ci.Ava)}Skf(){return Df.a.instance.JMa(t.AFrameworkApplication.Cy)}}ci.Ava="SE";ci.WZc="SEP";ci.tQa="SER";ci.Agc="TRP";Object(n.a)(ci,"NullSessionExpirationManager",null,[645,646]);class Ll{constructor(){this.xvc=
this.M9a=!1;const b=t.AFrameworkApplication.Cy;0>=b||(this.Cy=b,v.ULS.sendTraceTag(17581890,217,50,"Initializing SessionExpirationManager. {0}",{["AccessTokenTtl"]:this.Cy,["NowGetTime"]:(new Date).getTime(),["BootTime"]:t.AFrameworkApplication.bW}),Df.a.instance.W$g(Object(u.a)(this,this.Y$b,"onSessionExpiredDetected")),Df.a.instance.V$g(Object(u.a)(this,this.sYd,"onSessionExpiringDetected")))}Y$b(){Df.a.instance.qPi(Object(u.a)(this,this.Y$b,"onSessionExpiredDetected"));v.ULS.sendTraceTag(19247381,
217,50,"SessionExpiredDetected");this.okf()}sYd(){Df.a.instance.osn(Object(u.a)(this,this.sYd,"onSessionExpiringDetected"));this.xvc||this.M9a||(v.ULS.sendTraceTag(20492680,217,50,"SessionExpiringDetected - Showing expiring dialog."),this.xvc=!0,this.V0f())}okf(){this.M9a||(t.AFrameworkApplication.SQ(pe.a.Hdc),this.M9a=!0,this.V8d())}}Object(n.a)(Ll,"ASessionExpirationManager",null,[]);var Wc=d(153),dk=d(264);class Ni{constructor(b,h,r,z){this.n5f="";this.k6c=b;this.B_g=r;this.x_g=z;this.BKg=h;b=
(new Date(this.k6c)).format(t.AFrameworkApplication.k2i);this.n5f=this.BKg?String.format(CommonUIStrings.l_SessionExpiredMessage):String.format(CommonUIStrings.l_SessionExpiringMessage,b)}Idc(b){1===b?this.B_g&&this.B_g(this.BKg):0===b&&t.AFrameworkApplication.ya.Xb(ab.a.close,2,dk.g)}dispose(){this.x_g&&this.x_g()}}Ni.id="SessionExpirationDialog";Object(n.a)(Ni,"SessionExpirationDialogSharedProperties",null,[]);class Ld{}Ld.vg="<div class='WACDialogRow' id='SessionExpirationBlock'> <label id='WACSessionExpirationText' class='WACDialogLabel' >Session Expiration</label> </div>";
Object(n.a)(Ld,"SessionExpirationDialogHtml",null,[]);class Gk extends Wc.a{constructor(b,h,r,z){super(h);const R={};this.sUa=new Ni(b,h,r,z);this.kg=Ni.id;t.AFrameworkApplication.Njh?(this.Fd=1,this.Ve(0,CommonUIStrings.l_DialogClose)):(this.Fd=0,this.Bt=!1);h||1===t.AFrameworkApplication.ua.mode?this.Ve(1,CommonUIStrings.l_SessionExpirationRefreshButton):this.Ve(1,CommonUIStrings.l_SessionExpiringSaveAndRefreshButton);this.vg=Ld.vg;R.WACSessionExpirationText=this.sUa.n5f;this.Wh(CommonUIStrings.l_DefaultDialogTitle,
Object(u.a)(this,this.Idc,"sessionExpirationDialogHandler"),R);this.u3(this.qj("WACSessionExpirationText"))}Idc(b){this.sUa.Idc(b)}klf(){this.hide()}dispose(){super.dispose();this.sUa&&this.sUa.dispose()}}Object(n.a)(Gk,"LegacySessionExpirationDialog",Wc.a,[781]);class bl extends te.StandardDialog{constructor(b,h,r,z){super(h);this.sUa=new Ni(b,h,r,z);this.kg=Ni.id;t.AFrameworkApplication.Njh?(this.Fd=1,this.Ve(0,CommonUIStrings.l_DialogClose)):(this.Fd=0,this.Bt=!1);h||1===t.AFrameworkApplication.ua.mode?
this.Ve(1,CommonUIStrings.l_SessionExpirationRefreshButton):this.Ve(1,CommonUIStrings.l_SessionExpiringSaveAndRefreshButton);this.Pv(CommonUIStrings.l_DefaultDialogTitle,this.sUa.n5f,0,Object(u.a)(this,this.Idc,"sessionExpirationDialogHandler"))}Idc(b){this.sUa.Idc(b)}klf(){this.hide()}dispose(){super.dispose();this.sUa&&this.sUa.dispose()}}Object(n.a)(bl,"SessionExpirationDialog",te.StandardDialog,[781]);const Ae=(b,h,r,z)=>t.AFrameworkApplication.ua&&t.AFrameworkApplication.ua.Sb.KA&&t.AFrameworkApplication.K.$("ReactStandardSessionExpirationDialogIsEnabled")?
new bl(b,h,r,z):new Gk(b,h,r,z);var mg=d(154);class xk extends Ll{constructor(b){super();this.gmd=this.VUb=!0;this.OY=null;this.sa=new Te.a;this.Eh=b}N$a(b){this.sa.addHandler(xk.Ava,b)}dYc(b){this.sa.removeHandler(xk.Ava,b)}O$a(b){this.sa.addHandler(xk.tQa,b)}occ(b){this.sa.removeHandler(xk.tQa,b)}xPe(b){this.sa.addHandler(xk.Agc,b)}Skf(){return Df.a.instance.JMa(t.AFrameworkApplication.Cy)}o0f(b){this.VUb=b}V0f(){if(!this.OY&&!mg.a.qL){if(this.gmd){const b=Object(u.a)(this,this.i0b,"disposeCallback");
this.OY=Ae(this.Cy,!1,Object(u.a)(this,this.Jdc,"sessionExpirationHandler"),b)}this.sa.raiseEvent(xk.WZc)}}V8d(){this.OY&&(this.OY.mma&&this.OY.klf(),this.OY=null);if(this.VUb){const b=Object(u.a)(this,this.i0b,"disposeCallback");this.OY=Ae(this.Cy,!0,Object(u.a)(this,this.Jdc,"sessionExpirationHandler"),b)}this.sa.raiseEvent(xk.Ava)}i0b(){this.OY=null}Jdc(b){(b||this.Eh.tzc())&&this.Eh.refreshDocument(null)}}xk.Ava="SE";xk.WZc="SEP";xk.tQa="SER";xk.Agc="TRP";Object(n.a)(xk,"SessionExpirationManager",
Ll,[645,646]);class lf{}lf.J_j="Aborting";lf.nqd="ActivityDuration";lf.error="Error";lf.l4k="Errors";lf.failed="Failed";lf.kzb="FirstActivity";lf.initialized="Initialized";lf.kickedOut="KickedOut";lf.vpm="LastActivity";lf.Wyn="RetryOverride";lf.s4d="RequestGroups";lf.e2a="Requests";lf.D4d="Responses";lf.e6d="SessionDuration";lf.status="Status";lf.success="Success";lf.X3n="Successful";lf.tokens="Tokens";lf.MLf="PollingDuration";Object(n.a)(lf,"SessionExpirationStrings",null,[]);class ej{constructor(b){this.dB=
{};this.Fha={};this.DTa={};this.Omi=15;this.zMg=!1;this.$Tj=new Date;this.Led=new Date;this.Hb=b;this.XD=new Ic.a(2,2,6E4*this.Omi,Object(u.a)(this,this.Emj,"writeMeasures"),135,"SL",!1);this.Hb.$b(this.XD);this.B3l()}Emj(){v.ULS.sendTraceTag(41964821,217,50,v.ULS.bQc({["Aggregate"]:this.Fha,["Current"]:this.dB}))}B3l(){this.Fha[lf.s4d]=0;this.Fha[lf.e2a]=0;this.Fha[lf.D4d]=0;this.Fha[lf.status]=lf.initialized;this.Fha[lf.kzb]=new Date;this.Fha[lf.e6d]=0;this.Fha[lf.nqd]=0;this.Fha[lf.e6d]=0;this.dB[lf.e6d]=
0;this.Fha[lf.nqd]=0;this.dB[lf.nqd]=0}get v5m(){this.DTa[lf.MLf]=+new Date-+this.DTa[lf.kzb];return this.DTa}Smf(b,h){var r=b[h];r=r?r:0;r++;b[h]=r;this.rYf(b)}rYf(b){const h=new Date;b[lf.nqd]=+h-+this.Led;this.Led=h;b[lf.e6d]=+this.Led-+this.$Tj;b[lf.vpm]=this.Led}wPa(b,h){this.dB[b]=h;this.rYf(this.dB)}xYi(b,h){this.dB[b]=h;this.rYf(this.dB)}i5b(b){this.Smf(this.dB,b);this.Smf(this.Fha,b);this.Smf(this.DTa,b)}flush(){this.zMg||(this.Fha[lf.status]=this.dB[lf.status],this.Emj(this.XD),this.Hb.m3(this.XD,
6E4*this.Omi))}vwn(){const b=this.dB[lf.status];b&&(this.Fha[lf.status]=b);this.dB={}}Mwn(){this.DTa={};this.DTa[lf.MLf]=0;this.DTa[lf.kzb]=new Date}stop(){v.ULS.sendTraceTag(41964822,217,100,"Stopping logger. Flushing one last time");this.flush();this.zMg=!0;this.Hb.We(this.XD)}}Object(n.a)(ej,"SessionLogger",null,[641]);class hl{constructor(b,h){this.hod=b;this.Q6a=h}get tokens(){return this.hod}get errors(){return this.Q6a}}Object(n.a)(hl,"TokenRefreshArgs",null,[720]);var Xh=d(390);class Cd extends Sys.EventArgs{constructor(b,
h,r,z,R,ba,ta){super();this.DTa=b;this.eFi=h;this.s4d=z;this.failed=R;this.e2a=ba;this.D4d=ta}}Object(n.a)(Cd,"WaitingForTokenRefreshPollingArgs",Sys.EventArgs,[]);class db{constructor(b,h=null,r=null){this.xvc=this.M9a=!1;this.gmd=this.VUb=!0;this.sa=new Te.a;this.zvc=this.Oed=this.Kjd=!1;this.rsb=null;this.ZVg=10;this.ced=!1;this.uKe=b;this.bwe=t.AFrameworkApplication.Enm;this.Hb=Oe.a.instance;v.ULS.sendTraceTag(39408093,217,50,"Initializing SessionExpirationManagerWithRefresh. {0}",{["AccessTokenTtl"]:t.AFrameworkApplication.Cy,
["NowGetTime"]:(new Date).getTime(),["BootTime"]:t.AFrameworkApplication.bW});this.Wd=h||new ej(Oe.a.instance);this.eja=r;Df.a.instance.W$g(Object(u.a)(this,this.E_j,"aSessionExpirationManagerWithRefresh_OnSessionExpired"));Df.a.instance.V$g(Object(u.a)(this,this.o6g,"aSessionExpirationManagerWithRefresh_OnSessionExpiring"));Xh.SessionStatusManager.instance.i8j(Object(u.a)(this,this.o6g,"aSessionExpirationManagerWithRefresh_OnSessionExpiring"));Xh.SessionStatusManager.instance.J8j(Object(u.a)(this,
this.b7m,"preemptiveTokenRefresh"));this.SNg=new Date;t.AFrameworkApplication.Dnm&&(Df.a.instance.GVe=Object(u.a)(this,this.vjn,"refreshAccessTokenWhenSessionExpired"));t.AFrameworkApplication.K&&(t.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.TokenRefreshPollingIsEnabled",!1),this.ZVg=t.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.WordOnline.TokenRefreshPollInterval",10),t.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ReportLastKnownTokenRefreshError",
!1))}N$a(b){this.sa.addHandler(db.Ava,b)}dYc(b){this.sa.removeHandler(db.Ava,b)}O$a(b){this.sa.addHandler(db.tQa,b)}occ(b){this.sa.removeHandler(db.tQa,b)}xPe(b){this.sa.addHandler(db.Agc,b)}Skf(){return Df.a.instance.JMa(t.AFrameworkApplication.Cy)}vjn(){this.EKd(!1);return!Df.a.instance.JMa(t.AFrameworkApplication.Cy)}E_j(b,h){Df.a.instance.oQd?this.Y$b(b,h):this.bwe?(this.Oed=!1,this.EKd(!1)):(this.M9a||v.ULS.sendTraceTag(520954892,217,15,"Detected session expiry before token refresh got blocked"),
this.Y$b(b,h))}o6g(b,h){Df.a.instance.xtf?this.sYd(b,h):this.EKd(!0)}EKd(b){if(!this.Kjd&&!this.Oed)if(this.eja&&this.eja.io)this.zvc=!0,this.Wd.wPa(lf.status,lf.kickedOut),this.Wd.flush(),this.Wd.stop();else if(v.ULS.sendTraceTag(40420955,217,50,"HandleTokenRefresh, IsExpiring:{0}. ShouldAbort: {1}",b,this.zvc),this.zvc)this.V8d();else{this.Wd.flush();this.Wd.vwn();this.Wd.i5b(lf.s4d);this.Kjd=!0;this.ced||(this.Wd.Mwn(),this.ced=!0,this.IHk());const h=this.uKe.Ljn(b);h.continueWith(()=>{if(this.uKe.aan(h))this.Wd.i5b(lf.X3n),
this.Wd.wPa(lf.status,lf.success),this.gmd=!1,this.bwe&&(this.VUb=!1),this.Oed=!1,this.SNg=new Date,this.a3n(),this.sa.raiseEvent(db.tQa,new hl(h.result.tokens,null));else{const r=h.result.errors;this.Wd.i5b(lf.failed);this.Wd.wPa(lf.status,lf.failed);b||(this.zvc=this.uKe.LPd(r));this.zvc&&(this.Wd.wPa(lf.J_j,JSON.stringify(r)),v.ULS.sendTraceTag(520954891,217,15,"Aborting token refresh"));this.Oed=!0;this.sa.raiseEvent(db.tQa,new hl(null,r))}this.Wd.flush();this.Kjd=!1})}}Y$b(){this.bwe||Df.a.instance.qPi(Object(u.a)(this,
this.Y$b,"onSessionExpiredDetected"));v.ULS.sendTraceTag(39408094,217,50,"SessionExpiredDetected");this.okf(Df.a.instance.oQd)}sYd(){this.xvc||this.M9a||(v.ULS.sendTraceTag(39408095,217,50,"SessionExpiringDetected - Showing expiring dialog."),this.xvc=!0,this.V0f(Df.a.instance.xtf))}okf(b){if(!this.M9a){var h=b?pe.a.PGn:pe.a.Hdc;const r=Object.assign(new eb.a,{extendedProperties:new Map});r.extendedProperties.set("ErrorCode",String.format("{0}",h));t.AFrameworkApplication.SQ(h,void 0,["SessionExpired"],
r);b||(b=new Date,h=new Date(t.AFrameworkApplication.bW),v.ULS.sendTraceTag(51642974,217,50,"Sending data to QoS. BootTime=[{0}], Now=[{1}], Duration=[{2}]",h,b,+b-+h),864E5>+b-+h&&Ca.Health.instance.recordQosError("SessionAccessTokenExpiredInLessThanOneDay",["SessionExpired"],!0,!0,!1,!0,r),2592E5>+b-+h&&Ca.Health.instance.recordQosError("SessionAccessTokenExpiredInLessThanThreeDays",["SessionExpired"],!0,!0,!1,!0,r));this.M9a=!0;this.V8d()}}a3n(){this.ced&&(this.Hb.We(this.rsb),this.ced=!1)}IHk(){this.rsb=
new Ic.a(2,2,1E3*this.ZVg,Object(u.a)(this,this.Q9n,"tokenRefreshPolling"),135);this.Hb.$b(this.rsb)}Q9n(){const b=this.Wd.v5m;v.ULS.sendTraceTag(555255521,217,50,"{0}",y.c(b));this.sa.raiseEvent(db.Agc,new Cd(b,b[lf.MLf],b[lf.kzb],b[lf.s4d],b[lf.failed],b[lf.e2a],b[lf.D4d]))}b7m(){3E5<+new Date-+this.SNg?(v.ULS.sendTraceTag(528867867,217,50,"Attempting pre-emptive token refresh."),this.EKd(!1)):v.ULS.sendTraceTag(528867868,217,50,"Last Token Refresh was performed less than 5 mins ago. Not refreshing token.")}}
db.Ava="SE";db.WZc="SEP";db.tQa="SER";db.Agc="TRP";Object(n.a)(db,"ASessionExpirationManagerWithRefresh",null,[]);class Db extends db{constructor(b,h,r=null,z=null){super(h,r,z);this.OY=null;this.Eh=b}o0f(b){this.VUb=b}V0f(b){if(!this.OY&&!mg.a.qL){if(b){var h=Object(u.a)(this,this.i0b,"disposeCallback");this.OY=Ae(t.AFrameworkApplication.Vjb,!1,Object(u.a)(this,this.Jdc,"sessionExpirationHandler"),h)}else if(this.gmd){if(this.Kjd)return;h=Object(u.a)(this,this.i0b,"disposeCallback");this.OY=Ae(t.AFrameworkApplication.Cy,
!1,Object(u.a)(this,this.Jdc,"sessionExpirationHandler"),h)}v.ULS.sendTraceTag(39408096,217,50,"Raising event: [{0}] IsScheduledShutdown: [{1}]",db.WZc,b);this.sa.raiseEvent(db.WZc)}}V8d(){this.OY&&(this.OY.mma&&this.OY.klf(),this.OY=null);if(this.VUb){this.Wd.stop();if(this.eja&&this.eja.io)return;const b=Object(u.a)(this,this.i0b,"disposeCallback");this.OY=Ae(t.AFrameworkApplication.Cy,!0,Object(u.a)(this,this.Jdc,"sessionExpirationHandler"),b)}v.ULS.sendTraceTag(39408097,217,50,"Raising event {0}",
db.Ava);this.sa.raiseEvent(db.Ava)}i0b(){this.OY=null}Jdc(b){(b||this.Eh.tzc())&&this.Eh.refreshDocument(null)}}Object(n.a)(Db,"SessionExpirationManagerWithRefresh",db,[645,646]);class Yb{constructor(b,h,r=null,z=null){this.K4g=!1;this._instance=null;this._frame=b;this.um=h;this.Wd=r||new ej(Oe.a.instance);this.eja=z}create(){this.K4g=t.AFrameworkApplication.P_a;if(!this.K4g)return new xk(this._frame);t.AFrameworkApplication.Hl("WOPITokenRefreshIsEnabled");v.ULS.sendTraceTag(39408088,217,50,"App has requested custom Session Expiration Manager");
if(!this._instance)switch(t.AFrameworkApplication.Iro){case 1:v.ULS.sendTraceTag(39408090,217,50,"Creating new NullSessionExpirationManager");this._instance=new ci(this._frame);break;case 2:v.ULS.sendTraceTag(39408091,217,50,"Creating new SessionExpirationManagerWithRefresh");this._instance=new Db(this._frame,this.um,this.Wd,this.eja);break;default:v.ULS.sendTraceTag(39408092,217,50,"Creating new legacy SessionExpirationManager"),this._instance=new xk(this._frame)}v.ULS.sendTraceTag(39408089,217,
50,"Returning instance of Session Expiration Manager: {0}",Object.getType(this._instance).getName());return this._instance}}Object(n.a)(Yb,"SessionExpirationManagerFactory",null,[644]);class zc{}Object(n.a)(zc,"Error",null,[]);class Vc{}Object(n.a)(Vc,"NamedResult",null,[]);class bd extends Vc{}Object(n.a)(bd,"ErrorInfo",Vc,[]);var ce=d(1037),ud=d(31);class Sb{constructor(b,h,r,z=null,R=!1,ba=null,ta=!1){this.cUa=0;this.e$a=this.$n=null;this.hod=new Ua.a;this.Q6a=new Ua.a;this.fr=null;this.awe=!1;
this.Hb=b;this.cWg=h;this.cWg.execute(Wa=>{Wa.cC(F.a.Olf,Object(u.a)(this,this.YSm,"onHostResponseReceived"))});this.sIa=r;this.u3g=new ce.a("WebServiceCall","TokenRefresh");this.Wd=z||new ej(b);this.TTj=R;this.ff=ba?ba:Xh.SessionStatusManager.instance;this.ZCg=ta}YSm(b){if(b.MessageId!==F.a.Olf)ud.b(39408099,306,15,"Unexpected message.");else{var h=new Ua.a,r=new Ua.a;this.Wd.i5b(lf.D4d);var z=b.Values[G.a.xXi];if(!z||0>=z.length)ud.b(40122317,306,15,"Found no tokens in the dictionary"),z=b.Values;
ud.b(40122318,306,100,"The Tokens array contains {0} tokens",z.length);this.Wd.wPa("Correlation",b.CorrelationId);var R="";for(let Wa=0;Wa<z.length;Wa++){this.Wd.xYi(lf.tokens,z.length);var ba=z[Wa],ta=ba;if(!ta||!ta.Name)continue;this.Wd.i5b(ta.Name);const ub=ba;if(ub&&ub.Value)ud.b(39408128,306,100,"Received token with name: {0}",ub.Name),h.add(ub),this.hod.add(ub),this.Wd.wPa(lf.status,lf.success),this.ZCg&&this.ff&&this.ff.dxn();else if(ba=this.QHl(ba),ud.b(39408129,306,15,"Received error for token {0}. Creating error object from {1}, TaskId {2}",
ta.Name,JSON.stringify(ba),this.e$a),r.add(ba),this.Q6a.add(ba),R=JSON.stringify(ba),this.Wd.wPa(lf.error,JSON.stringify(ba)),this.Wd.wPa(lf.status,lf.failed),this.ZCg)for(const Ib of ba.Errors)ta=this.drl(Ib),this.ff&&this.ff.S5j(ta)}0<r.count&&""!==R?(z=Object.assign(new eb.a,{extendedProperties:new Map}),z.extendedProperties.set("Errors",R),Ca.Health.instance.recordKpiFailure("WACTokenRefresh","TokenRefreshFailed",!1,!1,z)):Ca.Health.instance.recordKpiSuccess("WACTokenRefresh",null);ud.b(39408130,
306,50,"Received new tokens response. {0} tokens and {1} errors. Correlation {2}, TaskId {3}",h.count,r.count,b.CorrelationId,this.e$a);0<r.count&&!this.LPd(r)?(b=this.sIa.HGl(r),b!==this.sIa.OUf&&(this.Wd.xYi(lf.Wyn,b),this.Hb.m3(this.$n,b))):(this.Wd.flush(),this.$n&&(ud.b(39408131,306,100,"Deleting task {0} from task manager",this.$n.name),this.Hb.We(this.$n)),this.fr&&!this.fr.task.isCompleted&&this.fr.Gg(new hl(h,r)))}}QHl(b){if(!b)return null;const h=Object.assign(new bd,{Name:b.Name,Errors:[]});
for(const r of b.Errors)b=new zc,b.Id=r.Id,b.Details=this.PHl(r.Details),h.Errors.push(b);return h}PHl(b){if(!b)return"";const h=b.toString().toLowerCase();return 0<h.indexOf("<!doctype")?this.chf("Seems to contain HTML - Contains <!DOCTYPE"):0<h.indexOf("<html")?this.chf("Seems to contain HTML - Contains <html>"):500<h.length?this.chf(String.format("Error details content too long: Length: {0}",h.length)):b}chf(b){return String.format("{0} - Reason: [{1}]","### REDACTED ###",b)}requestTokensOnce(){this.mRi()}mRi(){t.AFrameworkApplication.Hf("SendSynchronousPostMessage;SendSynchronousPostMessageIsEnabledCf");
this.cUa>=this.sIa.vzf?(ud.b(39408132,306,15,"Too many attempts to refresh tokens. Aborting. TaskId {0}",this.e$a),this.uJk(this.fr)):(Ca.Health.instance.recordKpiUsage("WACTokenRefresh",1,"wwrelfc",null),this.LEn())}LEn(){const b={};b[G.a.xXi]=this.sIa.tokens;const h=pa.a.create().toString();ud.b(39408133,306,50,"Refreshing tokens {0}. Attempt {1}. Correlation {2}. TaskId {3}.",JSON.stringify(this.sIa.tokens),this.cUa+1,h,this.e$a);this.cWg.execute(r=>{r.sendMessage(F.a.OQe,b,h)});this.cUa++;this.Wd.i5b(lf.e2a)}uJk(b){const h=
new Ua.a;for(let r=0;r<this.sIa.tokens.length;r++){const z=Object.assign(new bd,{Name:this.sIa.tokens[r],Errors:[Object.assign(new zc,{Id:"TOO_MANY_ATTEMPTS",Details:"We did not receive a new token from the host after the maximum allowed number of attempts"})]});h.add(z);this.Q6a.add(z)}this.Hb.We(this.$n);this.Wd.wPa(lf.l4k,JSON.stringify(this.Q6a));this.Wd.wPa(lf.status,lf.failed);b&&!b.task.isCompleted&&b.Gg(new hl(new Ua.a,this.Q6a))}Ljn(b){this.u3g.start();this.awe=b;this.e$a=pa.a.create().toString();
ud.b(41755338,306,50,"RefreshTokens Start, TaskId: [{0}]. IsTokenExpiring: [{1}].",this.e$a,this.awe);this.cUa=0;this.Q6a.clear();this.hod.clear();this.fr=new cc.a;this.$n=new Ic.a(this.sIa.priority,2,this.sIa.OUf,Object(u.a)(this,this.requestTokensOnce,"requestTokensOnce"),98,F.a.OQe,!0);this.TTj&&this.mRi();this.Hb.$b(this.$n);return this.fr.task}aan(b){this.u3g.stop();const h=this.XVl(b.result.errors);v.ULS.sendTraceTag(41755339,217,50,"ProcessTokensOrErrors: TokenRefreshResult:{0},TaskId:{1},IsTriggerByTokenExpiring:{2},RetryCount:{3},TotalErrorCount:{4},LastErrorName:{5},LastErrorId:{6},LastErrorDetail:{7}",
!h,this.e$a,this.awe,this.cUa,this.Q6a.count,0<b.result.errors.count?b.result.errors.J(0).Name:"",0<b.result.errors.count&&0<b.result.errors.J(0).Errors.length?b.result.errors.J(0).Errors[0].Id:"",0<b.result.errors.count&&0<b.result.errors.J(0).Errors.length?b.result.errors.J(0).Errors[0].Details:"");return h?!1:this.$$m(b.result.tokens)}LPd(b){return this.sIa.LPd(b)}$$m(b){for(let h=0;h<b.count;h++){const r=b.J(h);if(r.Name===G.a.accessToken){const z=(new Date).getTime();r.Expiry>t.AFrameworkApplication.Cy?
(v.ULS.sendTraceTag(39706827,217,50,"Updating AccessToken: {0}",{["AccessTokenTtl"]:r.Expiry,["NowGetTime"]:z,["BootTime"]:t.AFrameworkApplication.bW},"PreviousAccessTokenTtl",t.AFrameworkApplication.Cy),t.AFrameworkApplication.accessToken=r.Value,t.AFrameworkApplication.Cy=Math.floor(r.Expiry),t.AFrameworkApplication.Y$f=z,t.AFrameworkApplication.fJa=Math.floor(r.Expiry)):v.ULS.sendTraceTag(39706828,217,15,"Ignoring AccessToken because it expires sooner than the current one: {0}",{["AccessTokenTtl"]:r.Expiry,
["NowGetTime"]:z,["BootTime"]:t.AFrameworkApplication.bW},"PreviousAccessTokenTtl",t.AFrameworkApplication.Cy)}}return!0}XVl(b){let h=!1;for(let r=0;r<b.count;r++){h=!0;const z=b.J(r);v.ULS.sendTraceTag(39706829,217,15,"Received error for token {0}. Errors: {1}. TaskId: {2} ",z.Name,JSON.stringify(z.Errors),this.e$a)}return h}drl(b){let h=pe.a.Hdc;b=parseInt(b.Id);if(isNaN(b))h=pe.a.Jlj;else{switch(b){case 401:h=pe.a.Z$f;break;case 403:h=pe.a.Hlj;break;case 500:h=pe.a.Ilj;break;case 503:h=pe.a.Llj}h===
pe.a.Hdc&&(h=500<b?pe.a.Klj:pe.a.Glj)}return h}}Object(n.a)(Sb,"TokenRefreshManager",null,[643]);class Gf{constructor(){this.OUf=t.AFrameworkApplication.Lro;this.vzf=t.AFrameworkApplication.Jro;this.tokens=t.AFrameworkApplication.vQl();this.priority=t.AFrameworkApplication.Mro;this.DYg=this.VNn();this.GMe=t.AFrameworkApplication.uQl()}LPd(b){b=JSON.stringify(b);if(this.GMe&&0<this.GMe.length)for(const h of this.GMe)if(0<h.length&&0<=b.indexOf(h))return!0;return!1}HGl(b){try{if(b)for(let h of b)if(h.Errors)for(const r of h.Errors)if(r.Id in
this.DYg)return Number.parseInvariant(this.DYg[r.Id].toString())}catch(h){v.ULS.sendTraceTag(41501720,217,50,"TokenRefreshPolicy:GetRetryIntervalOverride, exception:{0}",h.toString())}return this.OUf}VNn(){const b={};try{if(!t.AFrameworkApplication.$Id()||0>=t.AFrameworkApplication.$Id().length||""===t.AFrameworkApplication.$Id()[0])return b;for(const h of t.AFrameworkApplication.$Id())0<h.length&&(b[h]=t.AFrameworkApplication.Kro)}catch(h){v.ULS.sendTraceTag(41755340,217,50,"TokenRefreshPolicy:SetRetryIntervalForNetworkIssue, exception:{0}",
h.toString())}return b}}Object(n.a)(Gf,"TokenRefreshPolicy",null,[642]);class gg{constructor(){this.W=null}get name(){return"Common.App.SessionExpiration"}init(){t.AFrameworkApplication.K.zq(()=>{this.EZa()})}EZa(){this.W.resolve("Common.ISessionExpirationManagerFactory");this.W.resolve("Common.ISessionExpirationManager");this.W.resolve("Common.ISessionExpirationManagerWithDialog")}dispose(){}yc(b){this.W=b;b.register(641,"Common.App.SessionExpiration.ISessionLogger").singleInstance().Yd(()=>new ej(Oe.a.instance));
b.register(642,"Common.App.SessionExpiration.ITokenRefreshPolicy").singleInstance().Yd(()=>new Gf);b.register(643,"Common.App.SessionExpiration.ITokenRefreshManager").singleInstance().Yd(()=>new Sb(Oe.a.instance,t.AFrameworkApplication.bQ(),b.resolve("Common.App.SessionExpiration.ITokenRefreshPolicy"),b.resolve("Common.App.SessionExpiration.ISessionLogger"),t.AFrameworkApplication.K.$("WopiTokenRefreshSendTokenRequestWithoutTasks"),b.Pa("Common.ISessionStatus"),t.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ReportLastKnownTokenRefreshError",
!1)));b.register(644,"Common.ISessionExpirationManagerFactory").singleInstance().Yd(()=>new Yb(t.AFrameworkApplication.ua,b.resolve("Common.App.SessionExpiration.ITokenRefreshManager"),b.resolve("Common.App.SessionExpiration.ISessionLogger"),b.Pa("Common.ISessionStatus")));b.register(645,"Common.ISessionExpirationManagerWithDialog").singleInstance().Yd(()=>b.resolve("Common.ISessionExpirationManagerFactory").create());b.register(646,"Common.ISessionExpirationManager").singleInstance().Yd(()=>b.resolve("Common.ISessionExpirationManagerWithDialog"))}static main(){O.a.instance.Oc(new gg)}}
Object(n.a)(gg,"SessionExpirationPackage",null,[1,2]);var mi=d(746),ni=d(443),hi=d(359),nh=d(213);class Da extends nh.a{constructor(){super();this.PersonaId=this.DisplayName=null;this.IsAnonymous=!1}get ControlType(){return 4}}Object(n.a)(Da,"PersonaButtonProps",nh.a,[]);class sb{m_b(b,h){if(b&&!(1>b.length)&&h){var r=Object.assign(new hi.a,{ExternalId:"msPresenceOuter",ControlList:[]});this.IJk(b,r.ControlList);h.push(r)}}IJk(b,h){const r=Object.assign(new mi.a,{ExternalId:"ContextCoauthors",LabelText:CommonUIStrings.l_PresenceMenuSectionTitle,
Menu:Object.assign(new ni.a,{ExternalId:"msPresenceInner",UpdateDynamically:!0,ShouldAutoOpen:!1,MenuSectionList:[]})});Array.add(h,r);h=Object.assign(new hi.a,{Title:"",ControlList:[]});Array.add(r.Menu.MenuSectionList,h);this.tMk(b,h.ControlList)}tMk(b,h){for(let r=0;r<b.length;r++){const z=Object.assign(new Da,{ExternalId:String.format("CoauthorPersona_{0}",r),Command:"336231556",DisplayName:b[r].userName,LabelText:b[r].userName,ImageBackColor:b[r].color,PersonaId:b[r].email,IsAnonymous:b[r].isAnonymous});
Array.add(h,z)}}}Object(n.a)(sb,"PresenceContextMenuSectionBuilder",null,[743]);var ec=d(81);class Jc{constructor(b,h,r,z){this.Woa=this.ks=this.$n=this.jg=this.VFa=null;this.mmd=b;this.lVj=z;this.mmd.dNc&&(this.$n=new Ic.a(3,2,5E3,Object(u.a)(this,this.igk,"authenticationCheckTask"),2),t.AFrameworkApplication.uc.$b(this.$n),this.Vb(h,r));this.mmd.w6j(()=>{this.aGb()});this.mmd.P9g(()=>{this.bGb()})}get tP(){return this.ks||(this.ks=Sa.a.instance.Pa("CommonUI.IBusinessBar"))}get cih(){return this.Woa||
(this.Woa=Sa.a.instance.Pa("CommonUI.IBusinessBarEntryFactory"))}Vb(b,h){const r=t.AFrameworkApplication.ya;r.gb(ab.a.Teh,Yd.a.frame,b,96);r.gb(ab.a.Ueh,Yd.a.frame,h,96);r.pa(ab.a.mkh,Yd.a.frame,$c.ActionManager.qZ);r.pa(ab.a.nkh,Yd.a.frame,$c.ActionManager.qZ);r.pa(ab.a.Wvf,Yd.a.frame,$c.ActionManager.qZ)}aGb(){this.showDialog(CommonUIStrings.l_AuthenticationLostMessage);t.AFrameworkApplication.ya.processAction(ab.a.Teh,2)}bGb(){this.c7n();t.AFrameworkApplication.ya.processAction(ab.a.Ueh,2)}igk(){this.mmd.authenticationCheck()}c7n(){this.jg&&
(this.jg.hide(),this.jg.dispose(),this.jg=null);this.VFa&&this.tP&&(t.AFrameworkApplication.Mk||this.tP.removeEntry(this.VFa),this.VFa.dispose(),this.VFa=null)}showDialog(b){ec.a.VA(this.jg);this.jg=new te.StandardDialog;this.lVj||(this.jg.Bt=!1,this.jg.Fd=0);this.jg.Ve(1,CommonUIStrings.l_SignIn);this.jg.vU(CommonUIStrings.l_DefaultDialogTitle,b,Object(u.a)(this,this.S9,"dialogHandler"))}S9(b){1===b?(ck.a.D_d(),this.showDialog(CommonUIStrings.l_AuthenticationLostSigninInProgressMessage),t.AFrameworkApplication.ya.processAction(ab.a.Wvf,
2)):(this.sWn(),t.AFrameworkApplication.ya.processAction(ab.a.nkh,2))}sWn(){this.tP&&this.cih&&(this.VFa=this.cih.create(CommonUIStrings.l_AuthenticationLostTitle,CommonUIStrings.l_AuthenticationLostMessage,null),this.VFa.closeable=!0,this.VFa.addButton(CommonUIStrings.l_SignIn,Jc.dwb,""),this.VFa.aka=Object(u.a)(this,this.Tnk,"businessBarEntryCloseHandler"),this.tP.mA(this.VFa,!1))}Tnk(){this.MWk();t.AFrameworkApplication.ya.processAction(ab.a.mkh,2)}MWk(){this.$n&&(t.AFrameworkApplication.uc.We(this.$n),
this.$n=null)}dispose(){this.$n=this.jg=this.VFa=null}static dwb(){ck.a.D_d();t.AFrameworkApplication.ya.processAction(ab.a.Wvf,2)}}Object(n.a)(Jc,"SignOutResponseUI",null,[9]);class jd{get name(){return"Common.App.UI"}yc(b){b.register(sb,"Common.App.UI.PresenceContextMenuSectionBuilder").as("Common.App.UI.IPresenceContextMenuSectionBuilder").singleInstance()}init(){}dispose(){ec.a.VA(jd.Jqa);jd.Jqa=null}static main(){O.a.instance.Oc(new jd)}static U1l(b,h,r){jd.fWn()&&(jd.Jqa=new Jc(ck.a.instance,
b,h,r))}static fWn(){return t.AFrameworkApplication.DVd&&!t.AFrameworkApplication.Eta}}jd.Jqa=null;Object(n.a)(jd,"CommonAppUIPackage",null,[1,2]);class Ud{get name(){return"Common.App.DialogWithLinkToResource"}yc(){}init(){}dispose(){}static main(){O.a.instance.Oc(new Ud)}}Object(n.a)(Ud,"CommonAppDialogWithLinkToResourcePackage",null,[1,2]);var ve=d(56);class bf{constructor(b){this.Fx=b;this.rx=Array.indexOf(this.Fx,this.lea)}dispose(){this.Fx=null}get N1(){return this.Fx[this.rx]}oy(b){this.b_c(b,
!1);return!0}R1b(b){this.b_c(b,!0)}b_c(b,h){b&&(this.N1!==b||h)&&(b.tabIndex=0,ve.FocusManager.AK(b));Array.contains(this.Fx,b)&&(this.rx=Array.indexOf(this.Fx,b))}get rGi(){let b=this.rx;do if(b)if(0<b&&b<this.Fx.length)b--;else break;else b=this.Fx.length-1;while(!xe.DOMFocusListing.sXa(this.Fx[b])&&b!==this.rx);return this.Fx[b]}get Dti(){let b=this.rx;do if(b===this.Fx.length-1)b=0;else if(0<=b&&b<this.Fx.length-1)b++;else break;while(!xe.DOMFocusListing.sXa(this.Fx[b])&&b!==this.rx);return this.Fx[b]}get lea(){let b=
0;for(;!xe.DOMFocusListing.sXa(this.Fx[b])&&b<this.Fx.length;)b++;return xe.DOMFocusListing.sXa(this.Fx[b])?this.Fx[b]:null}get w8b(){let b=this.Fx.length-1;for(;!xe.DOMFocusListing.sXa(this.Fx[b])&&0<b;)b--;return xe.DOMFocusListing.sXa(this.Fx[b])?this.Fx[b]:null}}Object(n.a)(bf,"DialogFocusListing",null,[102]);var $e=d(50);class cf extends te.StandardDialog{constructor(b,h,r,z=null){super();this.Fca=this.fw=this.V6a=null;this.Fx=[];this.pid=h;this.Kj=b;this.pGj=r;this.yld=z;this.Sl=new ce.a("LoadResource",
"LoadPrintablePdf")}qAa(){this.Fd=5;this.width=40;const b=document.createElement("span");b.id=this.qj("DirectPrintHeaderContent");const h=document.createElement("span");h.innerText=CommonUIStrings.l_DirectPrintDialogHeader;Sys.UI.DomElement.addCssClass(h,"DirectPrintHeader");this.Fca=document.createElement("iframe");this.Fca.name="pdfObjectFrame";this.Fca.title=CommonUIStrings.l_DirectPrintDialogIFrame;this.Fca.onload=Object(u.a)(this,this.P8m,"printablePdfLoaded");if(this.yld&&0<this.yld.count){var r=
Rc.a.Dgf(this.pid,this.yld);const z=Rc.a.kSf(this.pid,this.yld);this.fw=document.createElement("form");this.fw.id="printPreviewPostForm";this.fw.method="POST";this.fw.target=this.Fca.name;this.fw.action=z;for(let R of r)r=document.createElement("input"),r.type="hidden",r.name=R.key,r.value=R.value,this.fw.appendChild(r)}else this.Fca.setAttribute("src",this.pid);Sys.UI.DomElement.addCssClass(this.Fca,mg.a.BSg);this.pGj?(Sys.UI.DomElement.addCssClass(this.Fca,"DirectPrintPdfObjectHidden"),h.innerText=
CommonUIStrings.l_DirectPrintDialogSuccessText,vf.a.Iq(this.Fca,vf.a.zz,vf.a.Ho)):(Sys.UI.DomElement.addCssClass(this.Fca,"DirectPrintPdfObject"),this.Fx.push(this.Fca));b.appendChild(h);b.appendChild(document.createElement("br"));b.appendChild(this.Fca);this.fw&&b.appendChild(this.fw);b.appendChild(document.createElement("br"));b.appendChild(this.hDk(this.fw?"#":this.pid));this.Sl.start();this.xhb(CommonUIStrings.l_AppTitle,null,null,null,null,b);this.u3(this.qj("DirectPrintHeaderContent"));this.fw&&
this.fw.submit();this.JJk();v.ULS.sendTraceTag(4771852,328,50,"Direct Print Dialog launched.")}hDk(b){const h=document.createElement("span");var r=document.createElement("span");r.innerText=CommonUIStrings.l_DirectPrintDialogDownloadPDFHeader;h.appendChild(r);t.AFrameworkApplication.K&&(2===t.AFrameworkApplication.ua.Sb.jo&&t.AFrameworkApplication.K.$("PPTDisableDirectPrintDialogDownloadPDFLink")||1===t.AFrameworkApplication.ua.Sb.jo&&t.AFrameworkApplication.K.$("XLODisableDirectPrintDialogOpenPDFLink"))?
(b=document.createElement("span"),2===t.AFrameworkApplication.ua.Sb.jo?b.innerText=CommonUIStrings.l_DirectPrintDialogDownloadPDFLabel:1===t.AFrameworkApplication.ua.Sb.jo&&(b.innerText=CommonUIStrings.l_InternalError_Directive,v.ULS.sendTraceTag(573691527,328,50,"Hyperlink removed from DirectPrintDialog in XLO.")),this.V6a=b,h.appendChild(document.createElement("br")),h.appendChild(b)):(r=document.createElement("a"),r.innerText=CommonUIStrings.l_DirectPrintDialogDownloadPDFLink,r.href=b,r.target=
"_blank",r.id="PrintPDFLink",r.className="AllowBrowserClick",this.V6a=r,h.appendChild(document.createElement("br")),h.appendChild(r),this.fw&&Bf.a.addHandler(r,"click",Object(u.a)(this,this.OXm,"onSubmit")),this.Kj.mb(jb.a.click,this.V6a,Object(u.a)(this,this.SBh,"downloadPDFLinkClicked"),null));this.Fx.push(this.V6a);return h}OXm(b){this.fw&&(this.fw.target="_blank",this.fw.submit());b.preventDefault()}JJk(){if(0<this.Fx.length){const b=new bf(this.Fx),h=ve.FocusManager.instance().Gs();h&&(this.V6a.focus(),
h.Vj=b,h.mX=!0)}}SBh(){v.ULS.sendTraceTag(4585050,328,50,"Download PDF from Direct Print dialog clicked.");return!1}jRc(){v.ULS.sendTraceTag(21031114,328,50,"Download PDF from Direct Print dialog button clicked")}P8m(){v.ULS.sendTraceTag(51426332,328,50,"PDF content loaded successfully");this.Sl&&this.Sl.stop()}dispose(){this.V6a&&(this.Kj.sc(jb.a.click,this.V6a,Object(u.a)(this,this.SBh,"downloadPDFLinkClicked")),this.V6a=null);$e.a.gv(this.Fca);this.Fca=null;super.dispose()}}Object(n.a)(cf,"DirectPrintDialog",
te.StandardDialog,[737]);class oi{constructor(b){this.Kj=b}Tpl(b,h,r=null){return new cf(this.Kj,b,h,r)}}Object(n.a)(oi,"DirectPrintDialogFactory",null,[730]);class Dc{constructor(b,h){this._url=b;this.gPj=h}HAh(){this.gPj?Ed.a.downloadFile(this._url):Ed.a.Cm(this._url,"_blank",void 0,"OpenUrlInTabDialogDownloadBehavior:DoDownload")}dispose(){}}Object(n.a)(Dc,"OpenUrlInTabDialogDownloadBehavior",null,[746,9]);class Ag extends te.StandardDialog{constructor(b,h=!0,r=!1,z=null,R=null,ba=!1){super();
this.DQb=this.CQb=this.fw=this.R0=null;var ta=this.D5f?this.D5f:CommonUIStrings.l_DefaultDialogTitle;Ag.H4b=ba;this.Vne=z||new Dc(b,!0);const Wa=[],ub=[];Ag.EK&&(this.trd&&this.trd.forEach(fc=>{Array.add(Wa,fc)}),this.nah&&this.nah.forEach(fc=>{Array.add(ub,fc)}));h?r?(this.Fd=4,this.Ve(1,this.buttonText),this.Ve(2,CommonUIStrings.l_DialogClose)):(this.Fd=6,this.Ve(0,CommonUIStrings.l_DialogClose)):this.Fd=5;ba=document.createElement("span");this.cDc&&(ba.className=this.cDc);z=document.createElement("a");
z.innerText=this.O8b;z.href=b;z.target="_blank";z.id=this.SQc;z.className=ke.AFrame.nQe;var Ib=!X.a.s2&&!!R&&0<R.count;if(Ib){const fc=Rc.a.Dgf(b,R);R=Rc.a.kSf(b,R);z.href="#";z.target="_self";this.fw=document.createElement("form");this.fw.id="printPreviewPostForm1";this.fw.method="post";this.fw.target="_blank";this.fw.action=R;for(var $b of fc)R=document.createElement("input"),R.type="hidden",R.name=$b.key,R.value=$b.value,this.fw.appendChild(R)}else this.fw=null;this.fw||Ag.H4b?Ag.H4b||Array.add(ub,
{["type"]:"AppLinkProps",["id"]:this.SQc,["text"]:this.O8b,["onExecute"]:()=>{this.UJi()}}):Array.add(ub,{["type"]:"AppLinkProps",["id"]:this.SQc,["text"]:this.O8b,["handler"]:{["href"]:Ib?"#":b,["target"]:Ib?"_self":"_blank"}});this.C0a&&Array.add(Wa,this.C0a);r?(b=document.createElement("span"),b.innerText=this.C0a.replace("{0}",""),ba.appendChild(b)):this.dri?(b=document.createElement("span"),b.id=this.qj("message"),$b=document.createElement("span"),R=document.createElement("span"),Ib=this.C0a.split("{0}"),
$b.innerText=Ib[0],R.innerText=Ib[1],b.appendChild($b),b.appendChild(z),b.appendChild(R),ba.appendChild(b)):(b=document.createElement("span"),b.innerText=this.C0a,ba.appendChild(b),ba.appendChild(document.createElement("br")),ba.appendChild(document.createElement("br")),ba.appendChild(z),Ag.H4b||Array.add(Wa,"{0}"));this.fw&&ba.appendChild(this.fw);Ag.EK&&(this.Zgb&&(this.BQc?this.Z7g(this.Zgb,this.BQc):(Array.add(Wa,"{0}"),Array.add(ub,{["type"]:"AppLinkProps",["id"]:"LearnMoreLinkId",["text"]:this.Zgb,
["onExecute"]:()=>{}}))),this.Zxc(Wa,ub));this.xhb(ta,null,this.Ylf,null,Object(u.a)(this,this.S9,"dialogHandler"),Ag.EK?null:ba);this.u3(this.qj("message"));!Ag.EK&&this.BQc&&this.Zgb&&(ta=document.createElement("div"),ta.className="WACDialogLearnMoreLinkContainer",this.R0=document.createElement("a"),this.R0.innerText=this.Zgb,this.R0.href=this.BQc,this.R0.target="_blank",this.R0.id=this.qj("LearnMoreLinkId"),this.R0.className=ke.AFrame.nQe,ta.appendChild(this.R0),h?this.ed.insertBefore(ta,this.ed.lastChild):
this.ed.appendChild(ta),this.u3(String.format("{0} {1}",this.qj("message"),this.qj("LearnMoreLinkId"))));this.Emc=z;r?this.uU(this.kG):this.uU(this.Emc);this.txf();t.AFrameworkApplication.ua.G_.mb(jb.a.click,this.Emc,Object(u.a)(this,this.RBh,"downloadLinkClicked"),null);this.R0&&t.AFrameworkApplication.ua.G_.mb(jb.a.click,this.R0,Object(u.a)(this,this.Jki,"learnMoreLinkClicked"),null);this.zR=!1}get Ylf(){return null}get D5f(){return null}get C0a(){return null}get BQc(){return null}get Zgb(){return null}get dri(){return!1}get buttonText(){return CommonUIStrings.l_Open}get cDc(){return null}get trd(){return null}get nah(){return null}Kja(){this.fw&&
(this.CQb||(this.CQb=Object(u.a)(this,this.nOm,"onActionButtonClicked"),this.mq.mb(jb.a.click,this.kG,this.CQb)),this.DQb||(this.DQb=Object(u.a)(this,this.oOm,"onActionButtonKeyUp"),this.ke.mb(jb.a.oh,this.kG,this.DQb)));super.Kja()}nOm(b){this.tFh(b);return!0}oOm(b){return this.dQc(b,Object(u.a)(this,this.tFh,"executeDismissActionButtonFromArgs"))}tFh(b){this.fw&&this.fw.submit();this.Qyb(b.Af)}jRc(){}RBh(){this.uxf();this.fw?this.fw.submit():this.Vne.HAh();return!0}Jki(){return!1}dispose(){this.Vne.dispose();
this.Emc&&(t.AFrameworkApplication.ua.G_.sc(jb.a.click,this.Emc,Object(u.a)(this,this.RBh,"downloadLinkClicked")),this.Emc=null);this.R0&&(t.AFrameworkApplication.ua.G_.sc(jb.a.click,this.R0,Object(u.a)(this,this.Jki,"learnMoreLinkClicked")),this.R0=null);this.mq&&this.CQb&&(this.mq.sc(jb.a.click,this.kG,this.CQb),this.CQb=null);this.ke&&this.DQb&&(this.ke.sc(jb.a.oh,this.kG,this.DQb),this.DQb=null);super.dispose()}UJi(){this.fw&&(document.body.appendChild(this.fw),this.fw.submit(),document.body.removeChild(this.fw))}S9(b){1===
b&&(this.jRc(),this.fw?Ag.EK&&this.UJi():this.Vne.HAh());this.dispose()}static get EK(){return t.AFrameworkApplication.ua.Sb.KA&&t.AFrameworkApplication.ua.Sb.mgi}static get H4b(){return Ag.AHg}static set H4b(b){Ag.AHg=b}}Ag.AHg=!1;Object(n.a)(Ag,"ADialogWithLinkToResource",te.StandardDialog,[]);class Uc extends Ag{constructor(b,h,r=null,z=!0,R=!1){super(b,!0,!(Uc.rmb&&z),new Dc(b,h),r,R);Uc.rmb=Uc.rmb&&z;if(Uc.rmb){h=document.createElement("iframe");z=null;R=this.HVk;h.name="pdfObjectFrame";h.id=
"pdfObjectIFrame";if(r&&0<r.count){const ba=Rc.a.Dgf(b,r);b=Rc.a.kSf(b,r);z=document.createElement("form");z.id="printPreviewPostForm";z.method="POST";z.target=h.name;z.action=b;for(let ta of ba)b=document.createElement("input"),b.type="hidden",b.name=ta.key,b.value=ta.value,z.appendChild(b)}else h.src=b;R.appendChild(h);z&&(R.appendChild(z),z.submit());Sys.UI.DomElement.addCssClass(h,"DirectPrintPdfObjectHidden");vf.a.Iq(h,vf.a.zz,vf.a.Ho)}}get Ylf(){return"Print_32x32x32"}get D5f(){return Uc.rmb?
CommonUIStrings.l_PrintDialogDocumentIsReadyToPrint:null}get C0a(){return Uc.rmb?null:CommonUIStrings.l_PrintDialogDocumentIsReadyToPrint}get trd(){const b=[];Array.add(b,CommonUIStrings.l_PrintDialogCanCloseDocument);if(Ag.H4b){let h=CommonUIStrings.l_DirectPrintDialogFallbackSuggestion;""!==t.AFrameworkApplication.ua.Sb.Ewh&&(h=t.AFrameworkApplication.ua.Sb.Ewh);Array.add(b,h)}return Uc.rmb?b:null}get O8b(){return CommonUIStrings.l_DirectPrintDialogDownloadPDFLink}get SQc(){return"PrintPDFLink"}get buttonText(){return CommonUIStrings.l_PrintDialogOpenPDF}get cDc(){return t.AFrameworkApplication.bXa?
"UIFontDialogTextLarge":null}txf(){v.ULS.sendTraceTag(7690390,324,50,"Legacy print dialog displayed")}uxf(){t.AFrameworkApplication.Dm.AZa(9540);v.ULS.sendTraceTag(7690391,324,50,"Legacy print dialog clicked")}jRc(){v.ULS.sendTraceTag(19462215,324,50,"Legacy print dialog button clicked")}static get rmb(){return!!t.AFrameworkApplication.ua&&t.AFrameworkApplication.ua.Sb.KA&&t.AFrameworkApplication.K.$("DirectPrintDialogAsStandardDialogIsEnabled")&&!(X.a.s2||X.a.Ak||X.a.gj||X.a.u7b)&&!t.AFrameworkApplication.JPc&&
t.AFrameworkApplication.K.$("ShouldHostDefaultToNativeBrowserPrintExperience")}static set rmb(b){}}Object(n.a)(Uc,"PrintDialogWithLinkToPdf",Ag,[]);class cl{constructor(b){this.isEnabled=Boolean.parse(b.DirectPrintIsEnabled||"false");this.wim=Boolean.parse(b.DirectPrintProbeIsEnabled||"false");this.gfm=Boolean.parse(b.DirectPrintEnabledForInternetExplorer||"false");this.UKb=(b.DirectPrintSupportedMimeTypes||"").split(cl.l4e);this.jlb=(b.DirectPrintSupportedPlugins||"").split(cl.l4e);this.h0l=(b.DirectPrintImmersivePreviewPlugins||
"").split(cl.l4e);this.ici=Boolean.parse(b.DirectPrintEnabledForEdge||"false");this.E$l=Boolean.parse(b.ChromePrintLayoutFixIsEnabled||"false");this.uvk=parseInt(b.ChromeVersionFromWhichPrintLayoutIsEnabled||"76");this.kAf=14;this.rri=14394;if(b=b.DirectPrintMinimalSupportedEdgeVersion){const h=b.split(".");2===h.length?(this.kAf=parseInt(h[0]),this.rri=parseInt(h[1])):v.ULS.sendTraceTag(20734112,208,15,"DirectPrintBrsSettings:: DirectPrintMinimalSupportedEdgeVersion is invalid: {0}",b)}else v.ULS.sendTraceTag(20734113,
208,15,"DirectPrintBrsSettings:: DirectPrintMinimalSupportedEdgeVersion is not set in BRS")}}cl.l4e=",";Object(n.a)(cl,"DirectPrintBrsSettings",null,[]);class Sh{constructor(b,h){this.r3f=b;this.jlb=h}}Object(n.a)(Sh,"DirectPrintProbeResults",null,[]);var Kh=d(195);class uk{constructor(b,h,r,z,R,ba,ta,Wa,ub,Ib){this.fpd=null;this.zBj=b;this.Yrc=h;this.Gze=r;this.NIj=z;this.VJj=R;this.Rtc=new De.a(Object(u.a)(this,this.eFl,"getProbeResults"));this.hmc=ba;this.OOg=ub;this.BV=ta;this.Ypc=Wa;this.nKj=
Ib}get JP(){return this.zBj}start(){}k9m(){this.JP.wim&&this.jAm()}Ycn(){const b=Array(this.JP.UKb.length);if(void 0!==this.Yrc&&null!==this.Yrc)for(let h=0;h<this.JP.UKb.length;h++)b[h]=this.JP.UKb[h]in this.Yrc&&this.NIj(this.Yrc[this.JP.UKb[h]]);return b}Zcn(){const b=Array(this.JP.jlb.length),h=!(void 0===this.Gze||null===this.Gze);for(let r=0;r<this.JP.jlb.length;r++){const z=this.JP.jlb[r];b[r]=h&&z in this.Gze?!0:this.VJj(z)}return b}MKl(){const b=this.Ycn(),h=Array(b.length);for(let r=0;r<
b.length;r++)h[r]=b[r]?this.x6k(this.Yrc[this.JP.UKb[r]]):null;return h}x6k(b){if(void 0===b||null===b)return null;b=b.enabledPlugin;return void 0===b||null===b?null:b.name}jAm(){v.ULS.sendTraceTag(4535643,328,50,"[MimeTypes: {0}] [Plugins: {1}]",this.Rtc.value.r3f,this.Rtc.value.jlb)}eFl(){var b=this.MKl();const h=this.Zcn(),r={},z={};for(let R=0;R<this.JP.UKb.length;R++)r[this.JP.UKb[R]]=b[R];for(b=0;b<this.JP.jlb.length;b++)z[this.JP.jlb[b]]=h[b];return new Sh(r,z)}WVn(){return this.nKj||!this.JP.isEnabled||
t.AFrameworkApplication.JPc?!1:this.i4n()}bWn(){if(null!=this.fpd)return this.fpd;const b=uk.hci(this.JP);return this.fpd=this.JP.ici&&b||this.D$l()}D$l(){return X.a.rp&&this.JP.E$l&&X.a.tvk>=this.JP.uvk?!0:!1}i4n(){if(!this.Ypc(this.JP))return!1;var b=Na.a.SId(this.Rtc.value.r3f);for(const h of b)if(void 0!==h&&null!==h)return!0;b=Na.a.SId(this.Rtc.value.jlb);for(const h of b)if(h)return!0;return!1}hWl(){const b=Na.a.SId(this.Rtc.value.r3f);for(const h of b)if(Kh.a.contains(this.JP.h0l,h))return!0;
return!1}oYn(b,h=null){t.AFrameworkApplication.ua&&t.AFrameworkApplication.K.$("DirectPrintDialogAsStandardDialogIsEnabled")?this.OOg(b,h):this.WVn()?this.OXk(b,this.hWl()&&!0,h):this.OOg(b,h)}OXk(b,h,r=null){const z=this.BV.hg("UserAction","OpenDirectPrintDialog");this.hmc.Tpl(b,h,r).qAa();z.stop()}static elm(b){try{return new ActiveXObject(b),!0}catch(h){v.ULS.sendTraceTag(4535642,328,100,"Failed to instantiate {0} as an ActiveX control.",b)}return!1}static tcm(b){return void 0===b||null===b?!1:
!(void 0===b.enabledPlugin||null===b.enabledPlugin)}static create(b){const h=new cl(t.AFrameworkApplication.K.appSettings);let r=null;try{r=window.navigator.mimeTypes}catch(Ib){v.ULS.sendTraceTag(573923532,328,15,"Failed to get Window.Navigator.mimeTypes")}let z=null;try{z=window.navigator.plugins}catch(Ib){v.ULS.sendTraceTag(573923533,328,15,"Failed to get Window.Navigator.plugins")}const R=uk.tcm,ba=uk.elm;b=b.resolve("Common.App.DirectPrint.DirectPrintDialogFactory");const ta=t.AFrameworkApplication.ua.jq,
Wa=uk.glm,ub=!!t.AFrameworkApplication.ua&&t.AFrameworkApplication.ua.Sb.KA&&!t.AFrameworkApplication.K.$("PrintDialogFallbackLinkEnabled");return new uk(h,r,z,R,ba,b,ta,Wa,(Ib,$b)=>new Uc(Ib,!1,$b,!0,ub),t.AFrameworkApplication.Eta)}static glm(b){return X.a.rp||X.a.Ak&&b.gfm||b.ici&&uk.hci(b)?!0:!1}static hci(b){var h=X.a.A0b;if(h){var r=h.split(".");if(2===r.length)return h=parseInt(r[0]),r=parseInt(r[1]),h>b.kAf||h===b.kAf&&r>=b.rri}return!1}}Object(n.a)(uk,"DirectPrintManager",null,[675]);class Xg{constructor(){this.Kob=
this.W=null}get name(){return"Common.App.DirectPrint"}yc(b){this.W=b;b.register(oi,"Common.App.DirectPrint.DirectPrintDialogFactory").singleInstance().Yd(()=>new oi(t.AFrameworkApplication.ua.G_));b.register(675,"Common.App.DirectPrint.IDirectPrintManager").singleInstance().Yd(()=>uk.create(this.W))}init(){this.Kob=this.W.resolve("Common.App.DirectPrint.IDirectPrintManager");this.Kob.start()}dispose(){}}Object(n.a)(Xg,"PackageManager",null,[1,2]);class nj{constructor(b,h=3E4){this.S5f=9E5;this.U5f=
1E4;this.zoi=this.j9b=null;this.yyf=0;this.Jbb=Date.now;this.GId=b;this.ibe=h;this.kEd()}f0h(b=!0){const h=this.Jbb();if(h<this.yyf+this.S5f)return h>this.yyf+this.U5f&&this.kEd(),this.zoi;b&&this.kEd();return null}getToken(b=!0){return(b=this.f0h(b))?Promise.resolve(b):this.kEd()}kEd(){return this.j9b=this.j9b||new Promise(b=>{this.GId().then(h=>{this.j9b=null;""!==h&&h&&(this.zoi=h,this.yyf=this.Jbb(),b(h));b(null)}).catch(()=>{this.j9b=null;b(null)});window.setTimeout(()=>{this.j9b=null;b(null)},
this.ibe)})}}Object(n.a)(nj,"OAuthCacheManager",null,[]);class qj{static Osa(b){return""!==b&&b?qj.Cbk[b.toLowerCase()]:""}static HMl(b,h){const r=Date.now();var z=qj.xDk();const R=t.AFrameworkApplication.K.lb("UserPrincipalName"),ba=qj.Osa(b);v.ULS.sendTraceTag(593862986,1300,50,"Begin SSO Request for app: "+b);if(""===R||!R)return v.ULS.sendTraceTag(593862985,1300,10,"Missing login hint for silent oAuth"),Promise.resolve("");if(""===ba||!ba)return v.ULS.sendTraceTag(593862984,1300,10,"Missing AAD appId for appName: "+
b),Promise.resolve("");const ta=pa.a.create().toString();z=String.format("{0}/common/oauth2/authorize?response_type=token&scope=openid&domain_hint=organizations&client_id={1}&resource={2}&login_hint={3}&redirect_uri={4}&state={5}&prompt=none","https://login.microsoftonline.com",ba,encodeURIComponent(h),encodeURIComponent(R),encodeURIComponent(z),ta);const Wa=document.createElement("iframe");Wa.style.display="none";Wa.setAttribute("sandbox","allow-forms allow-scripts allow-same-origin");Wa.src=z;document.body.appendChild(Wa);
return new Promise(ub=>{qj.lJm(Wa.contentWindow).then(Ib=>{document.body.removeChild(Wa);const $b=new Lc.a,fc=RegExp("[#?&]+([^=&]+)=([^&]*)","gi");let Kc;for(;Kc=fc.exec(Ib);)3!==Kc.length&&(v.ULS.sendTraceTag(593862983,1300,10,"Unexpected Hash respones in OAuth header! Match length: {0}",Kc.length),ub("")),$b.Z(Kc[1],Kc[2]);$b.xb("access_token")?(v.ULS.sendTraceTag(593862982,1300,50,"SSO Request successful for resource: {0} for app: {1} Latency: {2}",h,b,Date.now()-r),ub($b.J("access_token"))):
(v.ULS.sendTraceTag(526668183,1300,10,"SSO Request failure for resource: {0} for app: {1}. Latency: {2}",h,b,(Date.now()-r).toString()),ub(""))}).catch(Ib=>{try{document.body.removeChild(Wa)}catch($b){}v.ULS.sendTraceTag(593862980,1300,10,"SSO Request failure for resource: {0} for app: {1} Error: {2} Latency: {3}",h,b,JSON.stringify(Ib),(Date.now()-r).toString());ub("")})})}static xDk(){const b=window.location.protocol,h=window.location.host;var r=t.AFrameworkApplication.K.lb("OAuthManagerHostPathOverride");
if(void 0===r||null===r){r=window.location.pathname;const z=r.lastIndexOf("/");r=0<=z?r.substring(0,z+1):""}return b+"//"+h+r+"WacOAuth.html"}static lJm(b){return new Promise((h,r)=>{let z=0,R=0;R=window.setInterval(()=>{if(200<z++)window.clearInterval(R),r("Exceeded 10000ms timeout after 200 polls");else{var ba=null,ta=null;try{if(!b||b.closed){window.clearInterval(R);r("Window or Frame is closed before completion");return}ba=b.location.href;ta=b.location.hash}catch(Wa){}ba&&"about:blank"!==ba&&
ta&&""!==ta&&(window.clearInterval(R),h(ta))}},50)})}}qj.Cbk={["smartlookup"]:"4d5c2d63-cf83-4365-853c-925fd1a64357",["search"]:"a9b49b65-0a12-430b-9540-c80b3332c127"};Object(n.a)(qj,"OAuthHelper",null,[]);class Lj{constructor(b,h){this.token=b;this.source=h}}Object(n.a)(Lj,"TokenResult",null,[]);var bh=d(103),si=d(248);class nf{constructor(){this.N6=null;this.gDg={};this.tokenCache=new qa.a(ka.a.Rj())}getToken(b,h,r=!1){if(this.tokenCache.xb(h))return this.tokenCache.J(h).getToken();const z=new nj(()=>
r?this.g0h(b,h):this.GId(b,h));this.tokenCache.Z(h,z);return z.getToken()}FMl(b,h,r=!1){if(this.tokenCache.xb(h))return this.tokenCache.J(h).f0h();const z=new nj(()=>r?this.g0h(b,h):this.GId(b,h));this.tokenCache.Z(h,z);return null}GId(b,h){const r=Date.now();return qj.HMl(b,h).then(z=>new Lj(z,"SSOStack")).then(z=>new Promise(R=>{z.token&&""!==z.token?(v.ULS.sendTraceTag(593862979,1300,50,"{0}: SSO Token resolved from {1}. Latency: {2}",b,z.source,Date.now()-r),this.ckb("GetTokenInternal",!0,Date.now()-
r,b,"","",h),R(z.token)):(v.ULS.sendTraceTag(593862978,1300,50,"{0}: SSO Token provider failed! Latency: {1}",b,Date.now()-r),this.ckb("GetTokenInternal",!1,Date.now()-r,b,"GetTokenSilent Failed","SSO Token provider failed!",h),R(""))}))}g0h(b,h){if(!this.N6)try{this.N6=Sa.a.instance.resolve("Common.App.OAuth.IOAuthManager")}catch(r){v.ULS.sendTraceTag(51689675,1300,10,"Unable to resolve IOAuthManager: "+r)}return this.N6?new Promise(r=>{const z=Date.now();this.N6.uoa(b,h).then(R=>{const ba=R.Token;
!R.IsSuccess||this.hmm(ba)?(this.ckb("GetTokenInternalImplicitJS",!1,Date.now()-z,b,R.ErrorCode,R.ErrorMessage,h),r(null)):(this.ckb("GetTokenInternalImplicitJS",!0,Date.now()-z,b,R.ErrorCode,R.ErrorMessage,h),r(ba))}).catch(R=>{R=R?y.c(R):"";this.ckb("GetTokenInternalImplicitJS",!1,Date.now()-z,b,"Caught Exception",R,h);r(null)})}):new Promise(r=>{this.ckb("GetTokenInternalImplicitJS",!1,0,b,"Null OAuthManager","OAuthManager not set");r(null)})}ckb(b,h,r,z,R="",ba="",ta=""){var Wa="Search"===z;const ub=
[];b=bh.a.uea(Wa?"Event":"EventName",b,2);z=bh.a.uea("AppName",z,2);Array.add(ub,b);Array.add(ub,z);Wa&&(z=bh.a.uea("LatencyType","FetchToken",2),Array.add(ub,z));R&&""!==R&&(R=bh.a.uea("ErrorCode",R,2),Array.add(ub,R));ba&&""!==ba&&(ba=bh.a.uea("ErrorMessage",ba,2),Array.add(ub,ba));ta&&""!==ta&&(ba=!(ta in this.gDg),this.gDg[ta]=ba,ba=bh.a.uea("WarmUpCall",ba.toString(),1),Array.add(ub,ba),ta=bh.a.uea("Service",this.RIl(ta),2),Array.add(ub,ta));Wa=Wa?"Office.TellMe.TellMeWAC.Latency":"Office.Insights.SmartLookup.Authentication";
h=Object.assign(new si.a,{name:Wa,samplingPolicy:2,dataFields:ub,succeeded:h,durationMs:r});Y.a.sendActivityEvent(h)}RIl(b){return b===t.AFrameworkApplication.kyf?"Loki":b===t.AFrameworkApplication.j3f?"Substrate":t.AFrameworkApplication.K&&b===t.AFrameworkApplication.K.lb("SmartLookupShredderServiceEndpoint")?"Shredder":"Other"}hmm(b){return!b||!b.length}}Object(n.a)(nf,"SearchOAuthManager",null,[653]);class ig{constructor(){this.W=null}get name(){return"Common.App.SearchOAuthManager"}yc(b){this.W=
b;this.W.register(653,"Common.App.SearchCommon.ISearchOAuthManager").singleInstance().Yd(()=>new nf)}init(){}dispose(){}static main(){O.a.instance.Oc(new ig)}}Object(n.a)(ig,"SearchOAuthPackage",null,[1,2]);var Nk=d(216),Nd=d(6),$d=d(21),Xd=d(19),ie=d(11);class Wk{constructor(b,h,r){this.xAe=this.Rsb=this.uAe=this.Qsb=this.kxe=null;this.MSl=z=>{try{this.LSl(z)}catch(R){z=String.format("Accessibility Manager failed to handle the EditingView event. Message: {0}. Stack: {1}",R.message,R.stack),v.ULS.sendTraceTag(5285580,
334,10,z)}};this.zp=b;this.jCj=h;this.ib=r;this.init()}init(){this.jCj.mb(this.MSl);this.Qsb=new Ub.a;this.uAe=new Ub.a;this.Rsb=new Ub.a;this.xAe=new Nk.a}i3(b){this.Qsb.add(b.key,b)}acc(b){this.Rsb.add(b.key,b)}LSl(b){let h;({L1e:h}=Wk.oco(this.ib.hb.kb)).returnValue&&(b=Wk.unl(b,this.kxe,h),this.E9m(b,h),this.kxe=h)}E9m(b,h){b=this.ihl(b,h);let r;({notification:r}=Wk.fco(b)).returnValue&&this.zp.sendNotification(r,!1)}ihl(b,h){const r=new Ub.a;r.Z(1,new Nk.a);r.Z(0,new Nk.a);b.forEach(z=>{3===
z?(Wk.D_f(h.node)||this.cwn(h),this.YCl(r,h)):z||this.Tnl(r,h);return!0});return r}cwn(b){this.Qsb.forEach((h,r)=>{r.reset(b);return!0})}Tnl(b,h){let r=new Ub.a;Wk.D_f(h.node)||(r=this.Rnl(h.cpBegin));this.Snl(b,this.uAe,r,Wk.uWi(this.kxe,h));this.uAe=r}Rnl(b){const h=new Ub.a;this.Qsb.forEach((r,z)=>{r=null;({XE:r}=z.ZEa(b)).returnValue&&h.Z(z.key,r);return!0});return h}Snl(b,h,r,z){const R=Box4Intl.Box4Strings.l_AccessibleContentDetailsFormat;h.forEach((ba,ta)=>{const Wa=this.Qsb.J(ba).mw||ta.title;
let ub;({value:ub}=r.Dc(ba)).returnValue?z&&ub.contentObject!==ta.contentObject&&(Wa&&b.J(1).add(Wa),ba=this.Qsb.J(ba).mw,ba=String.format(R,ub.title,ba),ub.description&&(ba+=", "+ub.description),b.J(0).add(ba)):Wa&&b.J(1).add(Wa);return!0});r.forEach((ba,ta)=>{h.xb(ba)||(ba=this.Qsb.J(ba).mw,ba=String.format(R,ta.title,ba),ta.description&&(ba+=", "+ta.description),b.J(0).add(ba));return!0})}YCl(b,h){h=this.eKl(h.node);h=this.Yyk(h);this.fKl(b,this.xAe,h);this.xAe=h}eKl(b){const h=new Nd.GraphIterator;
h.set(b);if(!h.Bb(1))return null;const r=new Nk.a;for(;1!==h.Qe;)this.Rsb.forEach((z,R)=>{let ba;({ika:ba}=R.Ygc(h)).returnValue&&r.add(ba);return!0}),h.mc();r.reverse();return r}Yyk(b){b=b.toArray();let h=0;for(;h<b.length-1;){var r=b[h];if(r.QF===b[h+1].QF&&(this.Rsb.J(r.QF),({azk:r}={returnValue:!1,azk:null}).returnValue)){b.splice(h,2,r);continue}h++}return new Nk.a(b)}fKl(b,h,r){var z;for(z=0;z<Math.min(r.length,h.length)&&r.J(z).contentId.equals(h.J(z).contentId);z++){var R=this.Rsb.J(r.J(z).QF).Zzb(r.J(z),
h.J(z));R&&(r.J(z).description&&(R+=", "+r.J(z).description),b.J(0).add(R))}for(R=z;R<r.length;R++){let ba=this.Rsb.J(r.J(R).QF).Zzb(r.J(R),null);ba&&(r.J(R).description&&(ba+=", "+r.J(R).description),b.J(0).add(ba))}for(r=z;r<h.length;r++)(z=this.Rsb.J(h.J(r).QF).mw)&&b.J(1).add(z)}static unl(b,h,r){const z=new Nk.a;(b=b||Wk.zEn(h,r))?(z.add(3),z.add(0)):Wk.uWi(h,r)&&z.add(0);return z}static zEn(b,h){return!b||!b.node.id.equals(h.node.id)}static uWi(b,h){return!b||!b.equals(h)}static oco(b){let h=
null;if(!b||!(Xd.SelectionEditor.Qm(b)||(b=Xd.SelectionEditor.Pj(b,!0,!1),Xd.SelectionEditor.Qm(b)||b.Qa&&Wk.D_f(b.Qa.node))))return{returnValue:!1,L1e:h};h=b.Qa;return{returnValue:!!h,L1e:h}}static fco(b){const h=new Nk.a;b.J(1).forEach(r=>{r=String.format(Box4Intl.Box4Strings.l_ContentTypeLeavingNotificationFormat,r);h.add(r);return!0});b.J(0).forEach(r=>{r=String.format(Box4Intl.Box4Strings.l_ContentTypeEnteringNotificationFormat,r);h.add(r);return!0});b=h.toArray().join(" ");return{returnValue:0<
h.length,notification:b}}static D_f(b){return $d.ImageReader.ww(b)||ie.ParagraphReader.hka(b)}}Object(n.a)(Wk,"AccessibilityContextManager",null,[647]);class nd{constructor(b,h){this.dMg=!1;this.bvc=null;this.uld=this.Xod=!1;this.CCg=null;this.xrd=(r,z)=>{(z.bR||z.Pna)&&this.NMm(z.bR,z.Pna)};this.Hb=b;this.KM=h}get SWl(){return!!this.bvc}mb(b){this.dMg||(this.KM.g$g(this.xrd),this.dMg=!0);this.CCg=b}NMm(b,h){this.SWl&&this.Hb.We(this.bvc);this.Xod=this.Xod||b;this.uld=this.uld||h;this.bvc=new Ic.a(5,
1,nd.B4k,()=>{this.CCg(this.Xod,this.uld);this.reset()},126);this.Hb.$b(this.bvc)}reset(){this.bvc=null;this.uld=this.Xod=!1}}nd.B4k=100;Object(n.a)(nd,"EditingViewOnAfterValidateEventsConsolidator",null,[640]);var di=d(53);class Cb{constructor(){this.W=null}get name(){return"Box4.Accessibility"}init(){vb.App.beh&&this.W.resolve("Box4.Accessibility.IAccessibilityContextManager")}dispose(){}yc(b){this.W=b;b.ha("Box4.Accessibility.EditingViewOnAfterValidateEventsConsolidator",()=>new nd(t.AFrameworkApplication.uc,
b.resolve("Box4.ContentEditableViewEventSource"))).as("Box4.Accessibility.IEditingViewOnAfterValidateEventsConsolidator").singleInstance();b.ha("Box4.Accessibility.AccessibilityContextManager",()=>new Wk(b.resolve("Common.Utils.IAriaNotifier"),b.resolve("Box4.Accessibility.IEditingViewOnAfterValidateEventsConsolidator"),di.a.instance)).as("Box4.Accessibility.IAccessibilityContextManager").singleInstance()}static main(){O.a.instance.Oc(new Cb)}}Object(n.a)(Cb,"Box4AccessibilityPackage",null,[1,2]);
var wc=d(125),Dd=d(1019),Le=d(1597),ff=d(874),mf=d(169),Qf=d(1504),yf=d(49),Hf=d(25),Pg=d(140),Qe=d(34),Fb=d(3);class af extends Qf.a{get zta(){return null!=this.$mg?this.$mg:this.$mg=Sa.a.instance.Pa("Box4.IInternalLinkManager")}get AFi(){return null!=this.Epg?this.Epg:this.Epg=Sa.a.instance.Pa("Box4.AutoCorrect.IPostHyperlinkAutoCorrectStrategy")}get OB(){return!0}get commandId(){return Fb.a.rgk}Eka(b){mf.a.mark(7012);const h=new yf.GraphTransaction(15);h.Db(b);var r=this.JF,z=this.VZ,R=ie.ParagraphReader.text(b),
ba=R.substring(r,z);const ta=({ESc:Wa}=B.a.T2f(ba)).returnValue;ba!==ta&&(r+=Wa,z=r+ta.length);ba=Qe.a.createTextRange(b,r,z);var Wa=R.substring(r,z);af.afm(R,r,z)&&(this.Vd.replaceTextRange(Qe.a.createTextRange(b,r-1,z+1),Wa,!0,!1),--r,--z,ba=Qe.a.createTextRange(b,r,z),r=Hf.SelectionFactory.xe(b,z),di.a.instance.setSelection(r));r=Pg.HyperlinkReader.FLa(Wa);af.hyperlinkEditor.NG(ba,r,!1);R=Wa="";z=!1;this.zta&&({CRf:Wa,xKh:R}=this.zta.K6f(r)).returnValue&&(r=Wa,z=!0,Wa=Pg.HyperlinkReader.ZC(ba,
!1),af.hyperlinkEditor.RQ(Wa[0].paragraph,Wa[0].hyperlink),""!==R&&(this.Vd.replaceTextRange(ba,R,!0,!1),ba=Qe.a.createTextRange(b,this.JF,this.JF+R.length),b=Hf.SelectionFactory.xe(b,this.JF+this.JF+R.length),di.a.instance.setSelection(b)),af.hyperlinkEditor.NG(ba,r,!1));h.dispose();!z&&this.AFi&&this.AFi.D6m(ba,r);mf.a.mark(7013)}set OB(b){super.OB=b}static get hyperlinkEditor(){return null!=af.Xkg?af.Xkg:af.Xkg=Sa.a.instance.resolve("Box4.IHyperlinkEditor")}static afm(b,h,r){r=r!==b.length&&('"'===
b.charAt(r)||"\u201d"===b.charAt(r));return!!h&&('"'===b.charAt(h-1)||"\u201c"===b.charAt(h-1))&&r}}Object(n.a)(af,"HyperlinkAction",Qf.a,[]);class Ih{constructor(b){this.Vd=b}lKk(b,h,r){return new af(null,b,h,r,this.Vd)}}Object(n.a)(Ih,"HyperlinkActionFactory",null,[635]);var Yh=d(247);class ql{constructor(){this.W=null}get name(){return"Box4.AutoCorrect"}yc(b){this.W=b;b.ha("Box4.AutoCorrect.AutoCorrectRules",()=>new Le.a(b.resolve("Box4.IHyperlinkActionFactory"),b.resolve("Box4.ICharacterPropertiesEditor"),
Yh.a.instance,t.AFrameworkApplication.ya,t.AFrameworkApplication.K,b.resolve("Box4.IAutoCorrectOptionsInfo"),b.resolve("Box4.TrackChange.ITrackChangeReaderFactory").instance)).as("Box4.IAutoCorrectRules").singleInstance();b.ha("Box4.AutoCorrect.AutoCorrectOptionsInfo",()=>new Dd.a(b.resolve("Box4.IRoamingServiceRequestManager"),t.AFrameworkApplication.K.$("ReplaceQuoteWithSmartQuoteIsEnabled"))).as("Box4.IAutoCorrectOptionsInfo").singleInstance();b.ha("Box4.AutoCorrect.AutoCorrectScheduler",()=>new ff.a(b.resolve("Box4.IAutoCorrectRules"),
di.a.instance,wc.a.instance,t.AFrameworkApplication.K,b.resolve("Box4.IAutoCorrectOptionsInfo"),b.resolve("Box4.IUndoManager"),b.resolve("Box4.AugmentationLoop.TileView<AugLoop.Deprecated.Tiling.TextTile,Box4.AViewableGraphNode>"))).as("Box4.IAutoCorrectScheduler").singleInstance();b.ha("Box4.AutoCorrect.HyperlinkAction.Factory",()=>new Ih(b.resolve("Box4.ICharacterPropertiesEditor"))).as("Box4.IHyperlinkActionFactory").singleInstance()}init(){this.W.resolve("Box4.IAutoCorrectRules").zsm();const b=
t.AFrameworkApplication.K;b.$("AutoCorrectOptionSettingIsEnabledForWordOnline")&&b.$("IsRoamingServiceEnabled")&&this.W.resolve("Box4.IAutoCorrectOptionsInfo").Kil()}dispose(){}static main(){O.a.instance.Oc(new ql)}}Object(n.a)(ql,"Box4AutoCorrectPackage",null,[1,2]);class Hj{get name(){return"Box4.Clipboard"}init(){}dispose(){}yc(){}static main(){O.a.instance.Oc(new Hj)}}Object(n.a)(Hj,"Box4ClipboardPackage",null,[1,2]);class Di{get name(){return"Box4.ImageEditors"}yc(){}init(){}dispose(){}static main(){O.a.instance.Oc(new Di)}}
Object(n.a)(Di,"Box4ImageEditorsPackage",null,[1,2]);class Mj{e3i(){return{d3i:!0,Blj:!1}}}Object(n.a)(Mj,"CursorMovementValidator",null,[638]);class Bi{VGi(b,h,r,z,R,ba){return b?t.AFrameworkApplication.ya.Qf(b,h,r,!0,R,ba):8}}Object(n.a)(Bi,"ListContextManager",null,[639]);class zh{get name(){return"Box4.ListEditors"}yc(b){b.ha("Box4.ListEditors.CursorMovementValidator",()=>new Mj).as("Box4.List.ICursorMovementValidator").singleInstance();b.ha("Box4.ListEditors.ListContextManager",()=>new Bi).as("Box4.ListEditors.IListContextManager")}init(){}dispose(){}static main(){O.a.instance.Oc(new zh)}}
Object(n.a)(zh,"Box4ListEditorsPackage",null,[1,2]);class Th{get name(){return"Box4.NotebookLevelEditors"}yc(){}init(){}dispose(){}static main(){O.a.instance.Oc(new Th)}}Object(n.a)(Th,"Box4NotebookLevelEditorsPackage",null,[1,2]);var Ci=d(1515),tf=d(128),Zh=d(768),kc=d(14);const Nm=(b,h,r,z,R)=>{if(h.contextId===kc.a.view)switch(b){case Fb.a.search:return vb.App.xa.jb.qua.Hbo(),vb.App.xM.e_i(),32;case Fb.a.findOnPage:return 1!==r&&(vb.App.xa.jb.qua.Hbo(),vb.App.xM.DYf()),32;case Fb.a.GRi:return vb.App.xa.jb.Ic&&
vb.App.xa.jb.Ic.wi?(1!==r&&(Zh.a.iJb?vb.App.xM.Gwn():vb.App.xM.DYf()),b=32):b=8,b;case Fb.a.rwb:case Fb.a.fkh:return 1===r?b=Zh.a.iJb?32:8:(vb.App.xM.Gwn(),b=32),b;case Fb.a.z0d:return 1!==r&&vb.App.xM.eJd(),32;case Fb.a.tGi:return(b=Ed.a.bLa(document.body.ownerDocument))&&b.id===tf.AppFrame.BVi&&vb.App.xM.eJd(),32;case Fb.a.QVd:return 1!==r&&vb.App.xM.dJd(),32;case Fb.a.Fti:return(b=Ed.a.bLa(document.body.ownerDocument))&&b.id===tf.AppFrame.BVi&&vb.App.xM.dJd(),32;case Fb.a.$Yi:return vb.App.xM.MKo(),
32;case Fb.a.PYc:return vb.App.xM.PYc(),32;case Fb.a.Plf:return 1!==r&&"string"===typeof R&&vb.App.xM.Plf(R),32;case Fb.a.iVi:return 1!==r&&vb.App.xM.DYf(),32;case Fb.a.jVi:return 1!==r&&vb.App.xM.e_i(),32;case Fb.a.c7g:return vb.App.xM.GFo(),32;case Fb.a.DVi:return vb.App.xM.e_i(),"string"===typeof R&&(vb.App.xM.Gbn(R),Zh.a.iJb=!0),32;case Fb.a.ICd:return vb.App.xM.DYf(),"string"===typeof R&&(vb.App.xM.Gbn(R),Zh.a.iJb=!0),32}return 2};class Nj{get name(){return"Box4.Search"}yc(b){b.ha("Box4.Search.FindManagerHelper",
()=>Ci.FindManagerHelper.instance).as("Box4.Search.IFindManagerHelper").singleInstance()}init(){Rb.a.pXc(Nm)}dispose(){}}Object(n.a)(Nj,"PackageManager",null,[1,2]);class Sd{get name(){return"Box4.TableEditors"}yc(){}init(){}dispose(){}static main(){O.a.instance.Oc(new Sd)}}Object(n.a)(Sd,"Box4TableEditorsPackage",null,[1,2]);class ue{get name(){return"Box4.TextLevelEditors"}yc(){}init(){}dispose(){}static main(){O.a.instance.Oc(new ue)}}Object(n.a)(ue,"Box4TextLevelEditorsPackage",null,[1,2]);var Ri=
d(100),Ei=d(374),od=d(106),co=d(625),cd=d(1526);class ii{constructor(b,h,r){this.qv=this.JGa=this.LIa=null;this.zD=this.pme=this.bGa=0;this.Aia=this.Odd=this.mSa=this.lSa=!1;this.xcd=this.yIg=this.BIg=0;this.Dxa=b;this.ga=h;this.Mm=r}$N(b){return!vb.App.xa.jb.isEditingAllowed||Xh.SessionStatusManager.instance.Sj?!1:""!==this.pIc(b.Af)}qK(b){if(!this.$N(b))return!1;this.ZKn(b);this.zD=this.Dxa.A2b();this.ONn(b);this.PNn();({D6b:this.Odd,a8b:this.Aia}=this.H_i(this.pme));this.QNn();this.LIa=b.lH;this.qv=
new Sys.UI.Point(0,0);[this.BIg,this.yIg]=this.Dxa.getDimensions();v.ULS.sendTraceTag(16802335,322,50,"Image resize drag started");return!0}bU(b){this.JGa=b.lH;this.Lok();this.xcd=cd.b(this.qv.x,this.qv.y,this.BIg,this.yIg,this.Odd,this.Aia,this.xcd,t.AFrameworkApplication.K.$("SmoothImageHelperGetScaleIsEnabled"));this.Dxa.R8f(this.xcd,this.Odd,this.Aia);return!0}lD(){this.setSize();v.ULS.sendTraceTag(16802336,322,50,"Image resize drag succeeded")}uX(){this.Dxa.jUf();v.ULS.sendTraceTag(16802337,
322,50,"Image resize drag canceled")}ZKn(b){this.Dxa=Ri.a.Eb(b.Af,co.a)}PNn(){this.pme=(Math.floor((this.zD+22)/45)%8+this.bGa)%8}H_i(b){let h,r;if(this.zD&&90!==this.zD&&180!==this.zD&&270!==this.zD&&360!==this.zD||this.dfm(b))return{D6b:!0,a8b:!0};h=r=!1;switch(b){case 1:case 5:h=!0;break;case 3:case 7:r=!0}return{D6b:r,a8b:h}}QNn(){this.mSa=this.lSa=!1;switch(this.pme){case 0:this.mSa=this.lSa=!0;break;case 1:case 2:this.mSa=!0;break;case 7:case 6:this.lSa=!0}}dfm(b){return!(b%2)}pIc(b){var h=
b.classList.toString();-1===h.indexOf("WACImageResizeHandle")&&b.parentNode&&(h=b.parentNode.classList.toString());b=h.split(" ");for(h=0;h<b.length;h++){const r=b[h].toString();if(r.startsWith("WACImageResizeHandle")&&"WACImageResizeHandles"!==r)return r}return""}ONn(b){switch(this.pIc(b.Af)){case "WACImageResizeHandleNW":this.bGa=0;break;case "WACImageResizeHandleN":this.bGa=1;break;case "WACImageResizeHandleNE":this.bGa=2;break;case "WACImageResizeHandleE":this.bGa=3;break;case "WACImageResizeHandleSE":this.bGa=
4;break;case "WACImageResizeHandleS":this.bGa=5;break;case "WACImageResizeHandleSW":this.bGa=6;break;case "WACImageResizeHandleW":this.bGa=7}}Lok(){var b=1;this.Mm.instance&&(b=this.Mm.instance.vj);const h=(this.JGa.x-this.LIa.x)/b;b=(this.JGa.y-this.LIa.y)/b;this.qv.x=this.lSa?-h:h;this.qv.y=this.mSa?-b:b}setSize(){const b=new Ei.DictionaryPropertySet;b.setValue(od.a.VLc,100*this.xcd);b.setValue(od.a.Q6h,!0);if(90===this.zD||270===this.zD){let h,r;({D6b:h,a8b:r}=this.H_i(this.bGa));b.setValue(od.a.umf,
h);b.setValue(od.a.vmf,r)}else b.setValue(od.a.umf,this.Odd),b.setValue(od.a.vmf,this.Aia);this.ga.Xb(Fb.a.c5b,2,b)}}Object(n.a)(ii,"ImageResizeDragAdapter",null,[181]);var pg=d(130),qn=d(863);class yk{constructor(b,h,r,z){this.Nse=this.JGa=this.LIa=this.Lkd=null;this.Dhd=this.Gpd=0;this.Gb=null;this.ga=b;this.ib=h;this.Mm=r;this.cPg=this.mya=0;this.Zc=z}$N(b){return vb.App.xa.jb.isEditingAllowed&&!Xh.SessionStatusManager.instance.Sj&&b&&this.Ejm(b.Af)?(this.Lkd=this.ib.Rg)?!0:!1:!1}eDd(){}lhf(){return null}qK(b){if(!this.$N(b))return!1;
this.Dxa=Ri.a.Eb(b.Af,co.a);if(!this.Dxa)return!1;this.lld=this.Dxa.o7;if(!this.lld)return!1;this.Lkd=this.ib.Rg;this.Gb=$d.ImageReader.Xl(this.Lkd);if(!this.Gb)return!1;this.LIa=this.iLa(b);this.Nse=Sys.UI.DomElement.getBounds(this.lld);this.Gpd=0<$d.ImageReader.fGd(this.Gb)?$d.ImageReader.fGd(this.Gb):0;this.Dhd=$d.ImageReader.Mef(this.Gb);return!0}bU(b){this.JGa=this.iLa(b);this.Tok();if(this.Dxa)return this.Dxa.cde(this.mya,this.cPg),!0;v.ULS.sendTraceTag(538809933,322,50,"Image rotate drag move aborted because img presenter is null.");
return!1}lD(){this.Gpd=this.mya=cd.c(this.mya);this.JX()}uX(){this.Dxa.cde(this.Dhd,0)}Ejm(b){return b.classList.contains(qn.c)||b.classList.contains(qn.b)||b.classList.contains(qn.a)||!!b.parentElement&&b.parentElement.classList.contains(qn.a)}iLa(b){return this.Zc.xd.bYa(b)}Tok(){var b=1;this.Mm&&this.Mm.instance&&(b=this.Mm.instance.vj);var h=new Sys.UI.Point(this.Nse.x+this.lld.clientWidth/2*b,this.Nse.y+this.lld.clientHeight/2*b);b=cd.a(this.LIa,h);h=cd.a(this.JGa,h);this.mya=Math.round(pg.a.Cdn(h-
b));0<this.Gpd&&(this.mya+=this.Gpd-this.Dhd);this.cPg=this.mya;this.mya+=this.Dhd}JX(){const b=new Ei.DictionaryPropertySet;b.setValue(od.a.SLc,0);b.setValue(od.a.dK,this.mya);this.ga.Xb(Fb.a.imageRotate,2,b)}}Object(n.a)(yk,"ImageRotateDragAdapterSimplified",null,[633,181]);class xj{constructor(){this.W=null}get name(){return"Box4.Images"}yc(b){this.W=b;this.W.ha("Box4.Images.ImageResizeDragAdapter",()=>new ii(null,t.AFrameworkApplication.ya,Sa.a.instance.Za("Common.IZoomManager"))).as("Box4.Images.IImageResizeDragAdapter").singleInstance();
this.W.ha("Box4.Images.ImageRotateDragAdapterUpdated",()=>new yk(t.AFrameworkApplication.ya,di.a.instance,Sa.a.instance.Za("Common.IZoomManager"),Ya.InteractiveViewManager.instance)).as("Box4.Images.IImageRotateDragAdapter").singleInstance()}init(){this.W.resolve("Box4.Images.IImageResizeDragAdapter");this.W.resolve("Box4.Images.IImageRotateDragAdapter")}dispose(){}static main(){O.a.instance.Oc(new xj)}}Object(n.a)(xj,"Box4ImagesPackage",null,[1,2]);var eo=d(285),ui=d(110),yc=d(5),rg=d(629),Tj=d(311),
yl=d(684),xg=d(20),zl=d(263),Sl=d(256),Po=d(1709),gn=d(1764),Om=d(1183);class om extends gn.a{constructor(b,h,r){super(b,h,r);this.Jid=this.r$a=null}get PX(){return t.AFrameworkApplication.ua.jq}yFd(b){switch(b){case 1:return CommonUIStrings.l_ImageUploadNoFileSpecified;case 2:return CommonUIStrings.l_ImageUploadUnsupportedFileType;default:return""}}Hde(b){return om.rwa(b,this.L0h())}L0h(){return om.XLe}rwa(b,h=null){b=this.Hde(b);return 0!==b?(h&&h.Cqd(),2===b&&(h=this.yFd(b),this.xp(this.iQh(b),
h)),!1):!0}VKa(b,h){v.ULS.sendTraceTag(36783360,322,50,"PictureUploader.FinalizeUpload");this.XIf=h;mf.a.mark(5576);this.Jid=this.PX.hg("LoadResource","PictureUploadTime");this.LMd()?this.l4d(b):this.YTc()}xp(b,h){const r=new te.StandardDialog;r.Fd=0;r.jy(b,CommonUIStrings.l_ImageUploadFailedTitle,h,null)}YTc(){v.ULS.sendTraceTag(36783361,322,50,"PictureUploader.OnUploadComplete");super.YTc();this.Jid&&(this.Jid.stop(),this.Jid=null)}AKb(){this.r$a=(new Om.a).create();this.r$a.message=CommonUIStrings.l_ImageUploadWait;
this.r$a.Fd=5;this.r$a.Bt=!1;this.r$a.qM(null,null,null)}mvd(){this.r$a&&(this.r$a.close(),this.r$a=null)}static gXl(b,h){b=B.a.mh(b);for(let r=0;r<h.length;++r)if(b.endsWith(h[r]))return!0;return!1}static rwa(b,h=null){h||(h=om.XLe);return b?om.gXl(b,h)?0:2:1}}om.XLe=".jpg .jpeg .png .gif .bmp .tif .tiff".split(" ");Object(n.a)(om,"PictureUploader",gn.a,[]);var lk;(function(b){b[b.validPicture=0]="validPicture";b[b.noPictureSpecified=1]="noPictureSpecified";b[b.invalidExtension=2]="invalidExtension";
b[b.pictureTooLarge=3]="pictureTooLarge"})(lk||(lk={}));Object(n.b)("PictureValidationResult",lk);var Rf=d(58),We=d(17),Ij=d(45);class Al{constructor(){this.bT=null}}Object(n.a)(Al,"ImageData",null,[]);var fj=d(54),gj=d(1710),Tl=d(1572),Em=d(1602);class vn extends Wc.a{constructor(b,h=!0){super(!1,!1,vn.EK);this.RTb=null;this.oEg=!1;this.Fx=[];this.$r=null;this.t$a=b;this.gUj=h;this.q8=this.m2g=!1;this.VUa=null;this.upe=!1;this.vg=this.FVk;this.kg="InsertFileDialog";this.Ve(1,this.Xpd);vn.EK?(this.RTb=
{["id"]:this.kg,["bodyControls"]:{["uploadButtonProps"]:{["label"]:CommonUIStrings.l_DialogChooseFile,["onExecute"]:Object(u.a)(this,this.PYm,"onUploadButtonClick")}},["uploadStatusLabel"]:CommonUIStrings.l_DialogNoFileChosen,["onFrameReady"]:Object(u.a)(this,this.wSm,"onFrameReady")},this.Wh(this.titleText,Object(u.a)(this,this.AMd,"insertDialogHandler"),this.RTb),this.zR=!0):(this.showDialog(this.titleText,Object(u.a)(this,this.AMd,"insertDialogHandler")),h&&this.VPn(),(b=this.rEd(1))&&this.Fx.push(b),
(b=this.rEd(0))&&this.Fx.push(b),this.Ghj(),this.zR=!1)}get ojj(){return this.t$a}validate(){this.$r.bT||v.ULS.sendTraceTag(25798091,322,10,"UploadFrame.FileInputElement is null");return this.$r.bT.value?!0:(vn.jy(CommonUIStrings.l_FileUploadNoFileSpecified),!1)}wSm(b){this.gUj&&(this.$r=this.J0i(b,this.t$a))}PYm(){this.$r&&this.$r.bT&&(this.oEg||(this.$r.omn(Object(u.a)(this,this.uGf,"onFileChosen")),this.oEg=!0),this.$r.XGh())}uGf(b){this.RTb.uploadStatusLabel=b;this.R7(this.titleText,Object(u.a)(this,
this.AMd,"insertDialogHandler"),this.RTb)}AMd(b){1===b&&this.isEnabled()?vn.EK&&this.$r.bT&&!this.$r.bT.value?(this.RTb.uploadStatusLabel=CommonUIStrings.l_FileUploadNoFileSpecified,this.R7(this.titleText,Object(u.a)(this,this.AMd,"insertDialogHandler"),this.RTb)):(this.lLd(),this.t$a.VKa(this.$r,Object(u.a)(this,this.dispose,"dispose"))):0===b&&this.hide()}VPn(){this.upe=!1;this.$r=this.J0i(document.getElementById("uploadFrameContainer"),this.t$a);t.AFrameworkApplication.K.$("InsertPictureDialogFocusLoopFixIsEnabled")&&
(this.VUa=Object(u.a)(this,this.YIf,"onUploadFrameLoad"),Bf.a.addHandler(this.$r.iFrame,"load",this.VUa));this.$r.bT||v.ULS.sendTraceTag(25798092,322,15,"UploadFrame.FileInputElement is null");this.bHi()}YIf(){this.bHi()}bHi(){if(this.$r&&!this.upe){var b=this.$r.bT;b&&(Bf.a.addHandler(b,jb.a.li,Object(u.a)(this,this.onKeyDown,"onKeyDown")),b=[b],this.Fx=b.concat.apply(b,this.Fx),this.Ghj(),this.upe=!0)}}dispose(){if(this.$r&&!vn.EK){const b=this.$r.bT;b&&Bf.a.removeHandler(b,jb.a.li,Object(u.a)(this,
this.onKeyDown,"onKeyDown"));this.VUa&&Bf.a.removeHandler(this.$r.iFrame,"load",this.VUa)}this.$r=null;super.dispose()}Ghj(){if(0<this.Fx.length){const b=new bf(this.Fx),h=ve.FocusManager.instance().Gs();h&&(this.Fx[0].focus(),h.Vj=b,h.mX=!0)}}onKeyDown(b){4!==ve.FocusManager.instance().fHi(b)&&b.preventDefault()}static get EK(){return t.AFrameworkApplication.ua.Sb.KA&&t.AFrameworkApplication.ua.Sb.ogi}static jy(b){const h=document.getElementById("errorText");h.innerText=b;h.style.display="inline-block"}}
Object(n.a)(vn,"InsertFileDialog",Wc.a,[]);class tg{static get vg(){return Wc.a.Px(tg.sl,CommonUIStrings.l_ImageUploadDialogText,CommonUIStrings.l_ImageUploadNoFileSpecified)}}tg.sl="<div class='WACDialogRow' id='block1'> <label id='labelText' class='WACDialogLabel' >{0}</label> </div> <div class='WACDialogRowNoBreak' id='block2'> <div id='uploadFrameContainer'></div> <div class='WACDialogError' id='errorText' role='alert'>{1}</div> </div>";Object(n.a)(tg,"InsertImageDialogHtml",null,[]);class pm extends vn{constructor(b,
h=!0){super(b,h)}get Xpd(){return CommonUIStrings.l_ImageUploadButtonText}get titleText(){return CommonUIStrings.l_ImageUploadingTitle}get FVk(){return tg.vg}validate(){this.$r.bT||v.ULS.sendTraceTag(25798095,322,10,"UploadFrame.FileInputElement is null");var b=Object(la.a)(om,this.ojj);const h=b.Hde(this.$r.bT.value);return 0!==h?(b=b.yFd(h),vn.jy(b),!1):!0}}Object(n.a)(pm,"InsertImageDialog",vn,[]);class hn extends pm{constructor(b){super(b)}J0i(b,h){const r=t.AFrameworkApplication.ua.Sb.KA&&t.AFrameworkApplication.ua.Sb.ogi;
return new Em.a(b,Object(u.a)(h,h.dac,"onUploadFrameInitialized"),Object(u.a)(h,h.kwa,"uploadResponseReceived"),t.AFrameworkApplication.K,!r)}isEnabled(){return hn.zT.vda(this.ojj.context)}static get zT(){return null!=hn.klg?hn.klg:hn.klg=Sa.a.instance.resolve("Box4.Images.IImageEditor")}}Object(n.a)(hn,"Box4InsertImageDialog",pm,[]);class Zn{kFk(b){return new Promise((h,r)=>{this.lFk(b).then(z=>{h(z)},z=>{r(z)})})}wrh(b){return new Promise((h,r)=>{const z=new FileReader;z.addEventListener("load",
()=>{h(z.result)},!1);z.addEventListener("error",()=>{r("FileReader exception ("+z.error.name+")")});z.readAsDataURL(b)})}lFk(b){return new Promise((h,r)=>{this.wrh(b).then(z=>{this.MZe(z,"image/jpeg").then(R=>{h(R)},R=>{r(R)})},z=>{r(z)})})}MZe(b,h){return new Promise((r,z)=>{let R=new Image;R.addEventListener("load",()=>{const ba=document.createElement("canvas"),ta=ba.getContext("2d");ba.width=R.width;ba.height=R.height;ta.drawImage(R,0,0);r(ba.toDataURL(h))});R.addEventListener("error",()=>{z("Image failed to load")});
R.src=b})}}Object(n.a)(Zn,"ImageFormatConverter",null,[]);const Ok=["ImageInsertFailed"];class rl extends om{constructor(b,h,r,z,R,ba,ta=!0){super(b,h,r);this.zxa=this.em=this.jG=this.Pe=null;this.p1b="wwaengidc";this.kpiName="ImageFileExtension";this.nqc="LocalDeviceUpload";this.RT=new Map;this.dHh=0;this.s$a=null;this.spe="";this.Dpa=0;this.zp=null;this.bpc="";this.fQg=50;this.MFg=this.jnc=this.Qvc=this.nsc=!1;this.aMj=19922944;this.wSg=0;this.wpe=[];this.nEg=[];this.xSg=0;this.gf=z;this.wm=R;this.ga=
ba;this.dPg=r.$("WACLocalRenderingForInsertLocalImageIsEnabled");this.uQg=r.rc("ImageUploadMaxByteSize",Number.MAX_VALUE);ta&&this.showDialog();vb.App.mgc.addHandler(this)}get aei(){return this.K.$("JfifImageInsertIsEnabled")}get J2(){return this.nqc}get fileExtension(){return this.spe}get fileSize(){return this.Dpa}get njj(){return this.s$a}get jw(){return this.zp||(this.zp=Sa.a.instance.resolve("Common.Utils.IAriaNotifier"))}get Ynf(){return this.J2===this.nqc}showDialog(){Tl.a(this.K)?(this.b0b=
!1,this.$r=new Em.a(document.body,Object(u.a)(this,this.dac,"onUploadFrameInitialized"),Object(u.a)(this,this.kwa,"uploadResponseReceived"),this.K,!1,void 0,!0)):Tl.b()||this.IFb&&X.a.gH?(this.b0b=!1,this.$r=new Em.a(document.body,Object(u.a)(this,this.dac,"onUploadFrameInitialized"),Object(u.a)(this,this.kwa,"uploadResponseReceived"),this.K,!1)):(this.b0b=!0,this.$r=(new hn(this)).$r)}iQh(b){switch(b){case lk.noPictureSpecified:return fj.a.noPictureSpecified;case lk.invalidExtension:return fj.a.t6l;
case lk.pictureTooLarge:return fj.a.Rli}return pe.a.unknown}l4d(b){this.Ynf||(this.Pe.Di()?(v.ULS.sendTraceTag(36783362,322,50,"Box4PictureUploader.ReplicatePlaceholder"),gj.a.instance.q9f(this.Pe.Di()),this.Pe.Di().contentReplicator.forceOutbound(Object(u.a)(this,this.SHf,"onPlaceholderNodeSaved"),Object(u.a)(this,this.D1a,"processFailure"),b)):this.D1a(b,157))}iim(){return Tl.c(this.Pe)}SHf(b){v.ULS.sendTraceTag(36783363,322,50,"Box4PictureUploader.OnPlaceholderNodeSaved");if(b){var h={},r=this.jG?
this.jG.properties.Qc.toString():this.Pe.Qc.toString();h[Tj.a.nodeId]=this.jG?this.jG.id.toString():this.Pe.id.toString();h[Tj.a.classId]=r;this.gf.hasProperty(yc.a.imageType)&&(h[rg.a.imageType]=this.gf.getValue(yc.a.imageType));this.gf.hasProperty(yc.a.yT)&&(h[rg.a.yT]=this.gf.getValue(yc.a.yT));this.gf.hasProperty(ui.a.Zda)&&(h[rg.a.Zda]=this.gf.getValue(ui.a.Zda));xg.a.instance.J(4)&&this.gf.hasProperty(yc.a.lhb)&&(h[rg.a.lhb]=this.gf.getValue(yc.a.lhb));Tl.d(b,this.Pe,this.em,h)&&(this.v1c(b),
rl.n$b++)}else v.ULS.sendTraceTag(16869584,352,15,"InsertPicture:UploadFrame is null")}v1c(b){b.v1c();this.s$a=b.s$a}kwa(b){this.dHh=+new Date-+this.njj;this.qTd();v.ULS.sendTraceTag(36783364,322,50,"Box4PictureUploader.UploadResponseReceived");Tl.e(this,b,this.Pe)}nno(){v.ULS.sendTraceTag(36783365,322,50,"Box4PictureUploader.UploadComplete");this.YTc();rl.n$b--;this.ga.processAction(ab.a.m4a,2);this.Pe?gj.a.instance.yhc(this.Pe.Di(),0):v.ULS.sendTraceTag(42468439,339,50,"Not able to notify upload notifier for completion");
this.jw.sendNotification(Box4Intl.Box4Strings.l_ImageUploaded,!0)}D1a(b,h){if(this.Xyn(b))v.ULS.sendTraceTag(16798870,352,50,"InsertPicture:OutboundRetry:Retry={0}:Error={1}",this.retryCount,h.toLocaleString());else{b=Object.assign(new eb.a,{extendedProperties:new Map});b.extendedProperties.set("result",h.toLocaleString());Ca.Health.instance.recordQosError("PictureFromLocalUploadRequestFailed",Ok,!1,!0,!1,!1,b);b=this.G7e(h);v.ULS.sendTraceTag(16798871,352,10,"InsertPicture:Failure:Retries={0}:Error={1}",
this.retryCount,h.toLocaleString());var r=this.Pe.YG(),z=new yf.GraphTransaction(15,Fb.a.lQ);z.Db(this.Pe);rl.zT.vPa(this.gf,b);rl.zT.eOi(this.Pe,this.jG);$d.ImageReader.wZi(this.gf);z.dispose();this.U4i(b);this.wm.iZb(r,!1);this.YTc();rl.n$b--;gj.a.instance.yhc(this.Pe.Di(),h)}}U4i(b){const h=new te.StandardDialog;h.Fd=0;h.jy(fj.a.invalidImageFile,CommonUIStrings.l_ImageUploadFailedTitle,b,null)}G7e(b){switch(b){case 23:return Box4Intl.Box4Strings.l_ImageUploadSizeError;default:return Box4Intl.Box4Strings.l_ImageUploadFailedMsgWord}}Hpj(){if(this.bpc&&
0<this.bpc.length){const b=new Ei.DictionaryPropertySet;b.setValue(od.a.hU,this.bpc);b.setValue(od.a.P$,!0);this.ga.Xb(Fb.a.C1,2,b)}this.bXn()}bXn(){let b="";this.MFg?b=Box4Intl.Box4Strings.l_ImageUploadFailedMsgWord:this.nsc&&this.jnc&&this.Qvc?b=Box4Intl.Box4Strings.l_MultipleImageUploadFormatSizeAndMaxNumberExceededError:this.nsc&&this.jnc?b=Box4Intl.Box4Strings.l_MultipleImageUploadFormatAndMaxNumberExceededError:this.nsc&&this.Qvc?b=Box4Intl.Box4Strings.l_MultipleImageUploadSizeAndMaxNumberExceededError:
this.Qvc&&this.jnc?b=Box4Intl.Box4Strings.l_MultipleImageUploadSizeAndFormatError:this.Qvc?b=Box4Intl.Box4Strings.l_MultipleImageUploadSizeError:this.jnc?b=Box4Intl.Box4Strings.l_MultipleImageUploadFormatError:this.nsc&&(b=Box4Intl.Box4Strings.l_MultipleImageUploadMaxNumberExceededError);""!==b&&(this.U4i(b),this.qqj())}J5j(b){this.bpc+=String.format('<img src="{0}"></img>',b);this.xSg++}eym(){this.Qvc=!0;v.ULS.sendTraceTag(524873990,322,10,"Image too large");const b=Object.assign(new eb.a,{extendedProperties:new Map});
b.extendedProperties.set("type","Image too large");Ca.Health.instance.recordQosError("PictureFromLocalInvalid",Ok,!0,!0,!1,!1,b)}dym(){this.jnc=!0;v.ULS.sendTraceTag(545093781,322,10,"Image filetype not supported");const b=Object.assign(new eb.a,{extendedProperties:new Map});b.extendedProperties.set("type","Filetype invalid");Ca.Health.instance.recordQosError("PictureFromLocalInvalid",Ok,!0,!0,!1,!1,b)}Fmi(b){this.MFg=!0;v.ULS.sendTraceTag(524873991,322,15,"Something went wrong during paste with format conversion: {0}",
b)}z1n(b){const h=new Zn;if(this.Hde(b.name)===lk.validPicture)return h.wrh(b);if(om.rwa(b.name,Em.a.YLe)===lk.validPicture)return h.kFk(b)}tFk(b){return new Promise(h=>{const r=this.z1n(b);void 0===r&&(this.Fmi("Failed starting conversion work"),h());r.then(z=>{z.length>this.aMj?this.eym():this.J5j(z);h()},z=>{this.Fmi(z);h()})})}Smm(b){return this.Hde(b.name)===lk.validPicture||om.rwa(b.name,Em.a.YLe)===lk.validPicture}I5l(){const b=[];if(this.$r.bT.files){this.wSg=this.$r.bT.files.length;this.$r.bT.files.length>
this.fQg&&(this.nsc=!0);this.AKb();for(let h=0;h<this.$r.bT.files.length&&this.fQg;h++){const r=this.$r.bT.files[h];this.wpe.push(r.name);this.nEg.push(r.size);r&&(this.Smm(r)?b.push(this.tFk(r)):this.dym())}}Promise.all(b).then(()=>{this.mvd();this.Hpj()});return!0}v6l(){this.em=pa.a.create();this.gf||(this.gf=new Ei.DictionaryPropertySet);this.dPg&&this.zxa&&this.gf.setValue(ui.a.Yli,this.zxa);var b=480;let h=320;var r=this.context.view;this.K.$("WordEditorAutoResizeImageIsEnabled")&&(r=r.Ug.editingElement.clientWidth,
0<r&&r<b&&(h=Math.floor(1*r/b*h),b=r,this.gf.setValue(ui.a.Zda,r)));this.gf.setValue(We.a.rfa,Rf.a.pn(b,0));this.gf.setValue(We.a.yma,Rf.a.pn(h,1));this.gf.setValue(Ij.a.CZ,1);this.gf.setValue(od.a.P$,!0);xg.a.instance.J(4)&&this.gf.setValue(yc.a.lhb,Box4Intl.Box4Strings.l_Picture);b=rl.zT.JAh(this.context,this.gf,this.em);if(!b)return!1;this.Pe=b.node;this.gf=(this.jG=b.blob)?this.jG.properties:this.Pe.properties;xg.a.instance.J(4)&&vb.App.ud.Mp&&vb.App.ud.Lq.CG(this.Pe);return!0}LMd(){return this.Ynf?
this.I5l():this.v6l()}qqj(){this.RT.set("FileExtensions",this.Bml());this.RT.set("FileSizeInBytes",this.nEg.toString());this.RT.set("Source",this.J2);this.RT.set("NumberOfImagesAttemptedToInsert",this.wSg.toString());this.RT.set("NumberOfImagesPasted",this.xSg.toString());Ca.Health.instance.recordKpiUsage("MultipleImageInsert",0,this.p1b,this.RT)}Bml(){let b="";for(let h=0;h<this.wpe.length;++h)b=b+this.zQh(this.wpe[h])+",";return b}VKa(b,h){this.dPg&&(this.zxa=new Al,this.zxa.bT=b.bT);super.VKa(b,
h)}dac(b){this.$r=b;if(!this.b0b){if(this.rde){if(Tl.a(this.K)||this.IFb&&X.a.gH){b.Nzd(Object(u.a)(this,this.gSm,"onFileChosen$2"));return}const h=b.Nzd(null),r=this.AQh(b);r&&(this.spe=r.name,this.Dpa=r.size);if(!this.rwa(h,b)||!this.d$f(r,b)){b=Object.assign(new eb.a,{extendedProperties:new Map});b.extendedProperties.set("type",this.rwa(h,this.$r)?"Image too large":"FileType invalid");Ca.Health.instance.recordQosError("PictureFromLocalInvalid",Ok,!0,!0,!1,!1,b);this.qTd();return}}this.VKa(b,null)}}gSm(b){if(!this.Ynf){var h=
this.AQh(this.$r);h&&(this.spe=h.name,this.Dpa=h.size);if(!this.rwa(b,this.$r)||!this.d$f(h,this.$r)){h=Object.assign(new eb.a,{extendedProperties:new Map});h.extendedProperties.set("type",this.rwa(b,this.$r)?"Image too large":"FileType invalid");Ca.Health.instance.recordQosError("PictureFromLocalInvalid",Ok,!0,!0,!1,!1,h);this.qTd();return}}this.VKa(this.$r,null)}ZKd(){return!!rl.n$b}qTd(){this.RT.set("FileExtension",this.zQh(this.fileExtension));this.RT.set("Source",this.J2);this.RT.set("FileSizeInBytes",
this.fileSize.toString());this.RT.set("RequestTimeInMs",this.dHh.toString());Ca.Health.instance.recordKpiUsage(this.kpiName,0,this.p1b,this.RT)}zQh(b){return b&&(b=b.split("."),1<b.length)?b[b.length-1].substring(0,4):""}L0h(){return this.aei?Em.a.f5g:om.XLe}AQh(b){return(b=b.bT)?b.files[0]:null}d$f(b,h){return b&&b.size>this.uQg?(h&&h.Cqd(),b=this.yFd(lk.pictureTooLarge),this.xp(this.iQh(lk.pictureTooLarge),b),!1):!0}yFd(b){switch(b){case lk.noPictureSpecified:return CommonUIStrings.l_ImageUploadNoFileSpecified;
case lk.invalidExtension:return this.aei?CommonUIStrings.l_WordImageUploadUnsupportedFileType:CommonUIStrings.l_ImageUploadUnsupportedFileType;case lk.pictureTooLarge:return String.format(CommonUIStrings.l_ImageUploadSizeErrorWithLimit,Math.round(this.uQg/1E6));default:return""}}static get zT(){return null!=rl.jlg?rl.jlg:rl.jlg=Sa.a.instance.resolve("Box4.Images.IImageEditor")}}rl.n$b=0;Object(n.a)(rl,"Box4PictureUploader",om,[744,598]);var zm=d(690),il=d(164);class Pn{constructor(){this.Zq=this.Bp=
this.vsb=this.c3g=this.c7c=this.Jyj=null;this.WEe=0;this.ppa=this.gAe=this.Ksb=null;this.hzg=0;this.hie=this.Q8=this.Ewe=null;this.LJg=!1;this.rhe=this.nhe=this.she=null}get assetId(){return this.c7c}get thumbnailUrl(){return this.c3g}get G8m(){return this.vsb}get displayName(){return this.ppa}get dimensions(){return String.format(Box4Intl.Box4Strings.l_ClipartDimensionsDisplay,this.Bp,this.Zq)}get L9j(){if(this.nhe&&this.rhe&&this.she){const b=document.createElement("a");b.setAttribute("href",this.she);
b.setAttribute("target","_blank");b.innerText=this.rhe;return b}return null}get lah(){return this.nhe}get fileSize(){return String.format(Box4Intl.Box4Strings.l_ClipartFileSizeDisplay,this.hzg)}get qfn(){const b=document.createElement("span");var h=0;if(this.Ksb&&0<this.Ksb.length){var r=this.Ksb.indexOf("."),z=0>r?this.Ksb:this.Ksb.substring(0,r);for(z=Number.parseInvariant(z);h<z&&5>h;h++)b.appendChild(Wh.createClusteredImageFromCluster(13,13,"RsFull_13x13x8","box42",il.a.Sh("box42.png"),"","",
!0,""));0<r&&(r=Number.parseInvariant(this.Ksb.substr(r+1)),3>r?b.appendChild(Wh.createClusteredImageFromCluster(13,13,"RsEmpty_13x13x8","box42",il.a.Sh("box42.png"),"","",!0,"")):8>r?b.appendChild(Wh.createClusteredImageFromCluster(13,13,"RsHalf_13x13x8","box42",il.a.Sh("box42.png"),"","",!0,"")):b.appendChild(Wh.createClusteredImageFromCluster(13,13,"RsFull_13x13x8","box42",il.a.Sh("box42.png"),"","",!0,"")),h++)}for(;5>h;h++)b.appendChild(Wh.createClusteredImageFromCluster(13,13,"RsEmpty_13x13x8",
"box42",il.a.Sh("box42.png"),"","",!0,""));this.gAe&&(h=document.createElement("span"),h.innerText=String.format(Box4Intl.Box4Strings.l_ClipartRatingVotes,this.gAe),b.appendChild(h));return b}get qxn(){return 0<this.WEe?String.format(Box4Intl.Box4Strings.l_ClipartResolutionDisplay,this.WEe):""}get fgk(){if(this.LJg){var b=document.createElement("span");b.innerText=Box4Intl.Box4Strings.l_ClipartProvidedByCommunity;return b}if(this.hie&&this.Q8)return Pn.QKk(this.hie,this.Q8);b=document.createElement("span");
b.innerText=Box4Intl.Box4Strings.l_ClipartProvidedByMicrosoft;return b}get keywords(){let b;if(this.Ewe){const h=this.Ewe.split(",");b=Array(h.length);for(let r=0;r<h.length;r++)b[r]=h[r].trim()}else b=[];return b}static Jel(b){const h=new Pn;for(let r=0;r<b.childNodes.length;r++){const z=b.childNodes[r];if(1===z.nodeType)try{const R=z.firstChild.nodeValue;switch(z.nodeName){case "src":h.Jyj=R;break;case "assetid":h.c7c=R;break;case "thumb":"64x64"===z.attributes.getNamedItem("size").nodeValue?h.c3g=
Pn.bdj(R):"192x192"===z.attributes.getNamedItem("size").nodeValue&&(h.vsb=Pn.bdj(R));break;case "imagedim":if(R){const ta=R.indexOf("x");0<ta&&ta<R.length&&(h.Bp=R.substr(0,ta),h.Zq=R.substr(ta+1))}break;case "resolution":h.WEe=Number.parseInvariant(R);break;case "rating":h.Ksb=R;break;case "numofratings":h.gAe=R;break;case "displayname":h.ppa=R;break;case "contentlength":h.hzg=Number.parseInvariant(R)/1024;break;case "subject":h.Ewe=R;break;case "provider":h.Q8=R;break;case "attributionlink":h.hie=
R;break;case "iscsc":h.LJg=1===Number.parseInvariant(R);break;case "additional":const ba=z.firstChild;if(z.hasChildNodes()&&ba&&"id"===ba.nodeName&&1===Number.parseInvariant(ba.text))for(let ta=0;ta<z.childNodes.length;ta++){const Wa=z.childNodes[ta];switch(Wa.nodeName){case "caption":h.nhe=Wa.text;break;case "value":h.she=Wa.text;break;case "string":h.rhe=Wa.text}}}}catch(R){}}return h}static QKk(b,h){const r=document.createElement("a");r.setAttribute("href",b);r.setAttribute("target","_blank");
r.innerText=h;return r}static bdj(b){let h;return b&&0<(h=b.indexOf("://"))?b.substr(h+1):b}}Object(n.a)(Pn,"ClipArtSearchResult",null,[]);class up{static get vg(){return Wc.a.Px(up.sl,Box4Intl.Box4Strings.l_ClipartSearchButtonText,Box4Intl.Box4Strings.l_ClipartDefaultText)}}up.sl="<div class='ClipartDialog' id='clipartdialog'> <div class='ClipartResultsPane' id='clipartresultspane'> <div class='ClipartSearchHeader' id='clipartsearchheader'> <input type='text' id='textInput' class='ClipartSearchInput' title='{0}' autocomplete=\"off\"/> <input type='image' id='btnSearch' class='WACButton ClipartSearchButton' title='{0}' alt='{0}'/> </div> <div class='ClipartSearchResults' id='clipartsearchresults'> {1} </div> </div> <div class='ClipartPreviewPane' id='clipartpreviewpane'> <div class='ClipartDisplayName UIFontBold' id='clipartattributedisplayname'> </div> <div class='ClipartSeeSimilar' id='clipartseesimilar'> </div> <div class='ClipartPreviewImage' id='clipartpreviewimage'> </div> <div class='ClipartPreviewDetails' id='clipartpreviewdetails'> <div class='ClipartAttributeContainer' id='clipartattribution'> <div class='ClipartAttributeName' id='clipartattributionname'> </div> <div class='ClipartAttributeValue' id='clipartattributionvalue'> </div> </div> <div class='ClipartAttributeContainer' id='clipartadditional'> <div class='ClipartAttributeName' id='clipartadditionalname'> </div> <div class='ClipartAttributeValue' id='clipartadditionalvalue'> </div> </div> <div class='ClipartAttributeContainer' id='clipartrating'> <div class='ClipartAttributeName' id='clipartratingname'> </div> <div class='ClipartAttributeValue' id='clipartratingvalue'> </div> </div> <div class='ClipartDimensions' id='clipartdimensions'> </div> <div class='ClipartAttributeContainer' id='clipartkeywords'> </div> </div> </div> </div>";
Object(n.a)(up,"InsertClipartDialogHtml",null,[]);class Qn extends Wc.a{constructor(b){super();this.xxa=this.Ypb=0;this.rWg=null;this.jDe=!1;this.BTb=this.KTa=this.XM=null;this.Zzi=h=>{const r=this.IV.value;r&&0<r.trim().length&&(this.search(this.IV.value),this.Iga(1,!1));h.preventDefault();h.stopPropagation()};this.aXm=h=>{(h?h.keyCode:window.event.keyCode)===Sys.UI.Key.enter&&(this.Zzi(h),h.preventDefault(),h.stopPropagation())};this.$zi=h=>{100<=this.IV.value.length&&(h.preventDefault(),h.stopPropagation())};
this.GVm=h=>{h=Number.parseInvariant(h.target.parentNode.id.substr(4));this.oGi(h);this.ZXf(h)};this.onScroll=()=>{if(this.dr&&this.dr.children&&!(2>this.dr.children.length)){var h=this.dr.children[0].children[0],r=this.dr.clientHeight-(h.clientHeight-h.children[0].clientHeight+2)+this.dr.scrollTop,z=h.clientHeight+2,R=parseInt(String(this.dr.scrollTop/z));h=parseInt(String(r/z));var ba=parseInt(String(this.dr.clientWidth/z));h<r/z&&h<parseInt(String(this.XM.length/ba))&&h++;for(r=R;r<h;r++)for(z=
0;z<ba;z++){var ta=r*ba+z;R=this.XM[ta];(ta=document.getElementById("clip"+ta))&&!ta.childNodes.length&&(R=this.Jvh(R),ta.appendChild(R))}}};this.fYm=h=>{h.target.setAttribute("src",il.a.Sh("phthumb.64x64x32.png"))};this.HVm=h=>{h.target.setAttribute("src",il.a.Sh("phpreview.96x96x32.png"))};this.Ixi=h=>{Ed.a.Cm(h.target.attributes.getNamedItem("href").value,h.target.attributes.getNamedItem("target").value,void 0,"InsertClipartDialog");h.stopPropagation();h.preventDefault()};this.dTm=h=>{(h?h.keyCode:
window.event.keyCode)===Sys.UI.Key.enter&&this.Ixi(h)};this.ayi=h=>{const r=h.target.innerText;this.IV&&(this.IV.value=r);this.search(r);h.stopPropagation();h.preventDefault();this.Iga(1,!1)};this.MTm=h=>{(h?h.keyCode:window.event.keyCode)===Sys.UI.Key.enter&&this.ayi(h)};this.bAi=h=>{this.XM&&(this.uDn(this.XM[this.Ypb]),h.stopPropagation(),h.preventDefault(),this.IV.value="",this.Iga(1,!1))};this.bXm=h=>{(h?h.keyCode:window.event.keyCode)===Sys.UI.Key.enter&&this.bAi(h)};this.onKeyDown=h=>{if(h.keyCode>=
Sys.UI.Key.left&&h.keyCode<=Sys.UI.Key.down){let r=0;switch(h.keyCode){case Sys.UI.Key.up:r=-5;break;case Sys.UI.Key.down:r=5;break;case Sys.UI.Key.left:r=-1;break;case Sys.UI.Key.right:r=1}this.xxa=this.xxa+r<this.dr.children.length-1?0>this.xxa+r?0:this.xxa+r:this.dr.children.length-1;this.ZXf(this.xxa);h.preventDefault();h.stopPropagation()}else h.keyCode===Sys.UI.Key.enter?(h=Number.parseInvariant(h.target.id.substr(4)),0<=h&&h<this.dr.children.length&&this.eWi(h)):h.keyCode===Sys.UI.Key.tab&&
(this.xxa=h.shiftKey?Math.max(0,this.xxa-1):Math.min(this.xxa+1,this.dr.children.length-1))};this.onError=()=>{this.dr&&(this.dr.innerText=Box4Intl.Box4Strings.l_ClipartCannotConnect)};this.vHi=h=>{if(this.dr)if(h.data.wga){var r=h.data.wga.lastChild.childNodes;this.XM||(this.XM=[]);for(h=0;h<r.length&&100>this.XM.length;h++){var z=r[h];1===z.nodeType&&"image"===z.nodeName&&(z=Pn.Jel(z),this.XM.push(z))}this.vAh();this.XM.length||(this.dr.innerText=Box4Intl.Box4Strings.l_ClipartNoResultsFound)}else if(h.data.Ge){h=
B.a.O8i(h.data.Ge);try{r=parseInt(h)}catch(R){r=14}this.dr.innerText=26===r?Box4Intl.Box4Strings.l_ClipartCannotConnect:Box4Intl.Box4Strings.l_ClipartNoResultsFound}};this.vAh=()=>{if(this.XM){$e.a.eZ(this.dr);this.KTa&&(this.KTa.dispose(),this.KTa=null);this.dr.focus();this.dr.classList.remove("ClipartSearchInProgress");for(let r=0;r<this.XM.length;r++){var h=document.createElement("a");h.setAttribute("href","#");h.id="itab"+r;const z=document.createElement("span");z.id="clip"+r;z.classList.add("ClipartImageContainer");
h.appendChild(z);this.dr.appendChild(h);r<parseInt(String(this.dr.clientHeight/z.clientHeight))*parseInt(String(this.dr.clientWidth/z.clientWidth))&&(h=this.Jvh(this.XM[r]),z.appendChild(h))}this.jDe&&(this.eWi(this.Ypb),this.ZXf(this.Ypb))}};this.d5l=h=>{1===h&&this.XM&&Qn.zT.vda(this.fyg.context)&&(h=this.XM[this.Ypb])&&this.fyg.BEa(h)};this.fyg=b;this.vg=up.vg;this.kg="InsertClipartDialog";this.Ve(1,Box4Intl.Box4Strings.l_ClipartUploadButtonText);this.showDialog(Box4Intl.Box4Strings.l_ClipartUploadDialogTitle,
this.d5l);this.dr=document.getElementById("clipartsearchresults");this.gld=this.onKeyDown;Bf.a.addHandler(this.dr,"keydown",this.gld);this.eld=this.onScroll;Bf.a.addHandler(this.dr,"scroll",this.eld);this.IV=document.getElementById("textInput");this.Mnd=this.aXm;Bf.a.addHandler(this.IV,"keydown",this.Mnd);this.Nnd=this.$zi;Bf.a.addHandler(this.IV,"keypress",this.Nnd);this.Ond=this.$zi;Bf.a.addHandler(this.IV,"paste",this.Ond);this.Zjc=document.getElementById("btnSearch");this.Zjc.setAttribute("src",
il.a.Sh("search.16x16x32.png"));this.cld=this.Zzi;Bf.a.addHandler(this.Zjc,"click",this.cld);this.HPb=document.getElementById("clipartpreviewimage");this.Ane=document.getElementById("clipartattributedisplayname");this.E6a=document.getElementById("clipartseesimilar");this.zne=document.getElementById("clipartdimensions");this.umc=document.getElementById("clipartadditionalvalue");this.Dne=document.getElementById("clipartratingvalue");this.SRa=document.getElementById("clipartattributionvalue");this.TRa=
document.getElementById("clipartkeywords");this.xne=document.getElementById("clipartadditionalname");this.Ene=document.getElementById("clipartratingname");this.yne=document.getElementById("clipartattributionname");this.lDe=this.GVm;this.$Je=this.fYm;this.$bd=this.Ixi;this.acd=this.dTm;this.Cwe=this.ayi;this.Dwe=this.MTm;this.ild=this.bAi;this.jld=this.bXm;this.IV.focus();this.Iga(1,!1)}dispose(){this.dr&&this.Hmh();this.dr&&this.gld&&(Bf.a.removeHandler(this.dr,"keydown",this.gld),this.gld=null);
this.dr&&this.eld&&(Bf.a.removeHandler(this.dr,"scroll",this.eld),this.eld=null);this.dr=null;this.IV&&this.Mnd&&(Bf.a.removeHandler(this.IV,"keydown",this.Mnd),this.Mnd=null);this.IV&&this.Nnd&&(Bf.a.removeHandler(this.IV,"keypress",this.Nnd),this.Nnd=null);this.IV&&this.Ond&&(Bf.a.removeHandler(this.IV,"paste",this.Ond),this.Ond=null);this.IV=null;this.Zjc&&this.cld&&(Bf.a.removeHandler(this.Zjc,"click",this.cld),this.Zjc=this.cld=null);this.yne=this.Ene=this.xne=this.TRa=this.SRa=this.Dne=this.umc=
this.zne=this.E6a=this.Ane=this.HPb=this.jld=this.ild=this.Dwe=this.Cwe=this.acd=this.$bd=this.BTb=this.$Je=this.lDe=null;this.KTa&&(this.KTa.dispose(),this.KTa=null);super.dispose()}rO(){super.rO();document.getElementById(this.qj("WACDialogPanel")).style.width=String.format("{0}px",656)}search(b){this.qJb(b,!1,this.vHi)}qJb(b,h,r){this.xxa=this.Ypb=0;this.Hmh();if(this.XM&&b===this.rWg&&this.jDe===h)window.setTimeout(this.vAh,500);else{this.XM&&(Array.clear(this.XM),this.XM=null);this.rWg=b;this.jDe=
h;var z=new Sys.StringBuilder('<search xmlns="urn:schema-microsoft-com:office:office">');z.append("<query>");z.append(B.a.If(b));z.append("</query>");z.append("<mediatype>Illustration</mediatype>");z.append("<mediatype>Photo</mediatype>");z.append("<filetype>jpg</filetype>");z.append("<filetype>jpeg</filetype>");z.append("<filetype>gif</filetype>");z.append("<filetype>bmp</filetype>");z.append("<filetype>tif</filetype>");z.append("<filetype>tiff</filetype>");z.append("<filetype>png</filetype>");z.append("</search>");
b=t.AFrameworkApplication.lcid.toString(16).toUpperCase();for(let R=b.length;4>R;R++)b="0"+b;t.AFrameworkApplication.Xe.Lj(String.format("{0}OfficeOnlineProxy.ashx?lidhelp={1}&liduser={1}&lidui={1}&{2}={3}",vb.App.webServiceBase,b,rg.a.wZn,h.toString()),2,z.toString(),{"Content-Type":"text/xml; charset=utf-8"},!0,2,r,this.onError,null)}}uDn(b){this.qJb(b.assetId,!0,this.vHi);this.XM||(this.XM=[],this.XM.push(b))}Jvh(b){const h=document.createElement("img");h.classList.add("ClipartThumbImage");h.setAttribute("src",
b.thumbnailUrl);b=b.displayName?b.displayName:Box4Intl.Box4Strings.l_ClipartImageAltNoCaption;h.setAttribute("title",b);h.setAttribute("alt",b);Bf.a.addHandler(h,"click",this.lDe);Bf.a.addHandler(h,"error",this.$Je);return h}yTk(b){1===b.childNodes.length&&(b=b.childNodes[0],Bf.a.removeHandler(b,"click",this.lDe),Bf.a.removeHandler(b,"error",this.$Je))}oGi(b){const h=this.XM[b];var r=h.G8m;this.Fmh();this.BTb=this.HVm;var z=document.createElement("img");z.setAttribute("src",r);if(h.displayName)r=
String.format(Box4Intl.Box4Strings.l_ClipartPreviewAltWithCaption,h.displayName);else{r=new Sys.StringBuilder;for(let R=0;R<h.keywords.length&&5>R;R++)R&&r.append(", "),r.append(h.keywords[R]);r=String.format(Box4Intl.Box4Strings.l_ClipartPreviewAltNoCaption,r.toString())}z.setAttribute("title",r);z.setAttribute("alt",r);Bf.a.addHandler(z,"error",this.BTb);this.HPb.appendChild(z);z=document.getElementById("clip"+this.Ypb);z.classList.remove("ClipartSelectedImage");z=document.getElementById("clip"+
b);z.classList.add("ClipartSelectedImage");this.Ypb=b;h.displayName&&(this.Ane.innerText=h.displayName);b=document.createElement("a");b.innerText=Box4Intl.Box4Strings.l_ClipartSeeSimilarLink;b.setAttribute("href",'""');Bf.a.addHandler(b,"click",this.ild);Bf.a.addHandler(b,"keydown",this.jld);this.E6a.appendChild(b);this.zne.innerText=String.format("{0} | {1} | {2}",h.dimensions,h.qxn,h.fileSize);(b=h.L9j)&&h.lah?(this.umc.parentNode.style.display="block",this.xne.innerText=h.lah,this.umc.appendChild(b)):
this.umc.parentNode.style.display="none";this.Dne.appendChild(h.qfn);$e.a.eZ(this.SRa);if(b=h.fgk)this.SRa.appendChild(b),"a"===b.nodeName.toLowerCase()&&(Bf.a.addHandler(b,"click",this.$bd),Bf.a.addHandler(b,"keydown",this.acd));this.TRa.innerText=Box4Intl.Box4Strings.l_ClipartKeywords;for(b=0;b<h.keywords.length;b++)z=h.keywords[b],r=document.createElement("a"),r.innerText=z,r.setAttribute("href",'""'),Bf.a.addHandler(r,"click",this.Cwe),Bf.a.addHandler(r,"keydown",this.Dwe),this.TRa.appendChild(r),
b<h.keywords.length-1&&(z=document.createElement("span"),z.innerText=", ",this.TRa.appendChild(z));this.Ene.innerText=Box4Intl.Box4Strings.l_ClipartRating;this.yne.innerText=Box4Intl.Box4Strings.l_ClipartProvidedBy;this.Iga(1,!0)}Fmh(){this.HPb&&1===this.HPb.childNodes.length&&(this.BTb&&(Bf.a.removeHandler(this.HPb.childNodes[0],"error",this.BTb),this.BTb=null),$e.a.eZ(this.HPb));this.SRa&&0<this.SRa.childNodes.length&&"a"===this.SRa.childNodes[0].nodeName.toLowerCase()&&(this.$bd&&Bf.a.removeHandler(this.SRa.childNodes[0],
"click",this.$bd),this.acd&&Bf.a.removeHandler(this.SRa.childNodes[0],"keydown",this.acd));this.E6a&&0<this.E6a.children.length&&"a"===this.E6a.children[0].nodeName.toLowerCase()&&(this.ild&&Bf.a.removeHandler(this.E6a.children[0],"click",this.ild),this.jld&&Bf.a.removeHandler(this.E6a.children[0],"keydown",this.jld),$e.a.eZ(this.E6a));if(this.TRa){for(let b=0;b<this.TRa.childNodes.length;b++){const h=this.TRa.childNodes[b];"a"===h.nodeName.toLowerCase()&&(Bf.a.removeHandler(h,"click",this.Cwe),Bf.a.removeHandler(h,
"keydown",this.Dwe))}$e.a.eZ(this.TRa)}this.Ane.innerText="";this.zne.innerText="";$e.a.eZ(this.umc);$e.a.eZ(this.Dne);$e.a.eZ(this.SRa);this.TRa.innerText="";this.xne.innerText="";this.Ene.innerText="";this.yne.innerText=""}eWi(b){if(!(this.dr.children.length<=b||0>b)){var h=this.dr.children[b],r=this.dr.children[0];r=r.clientHeight-r.children[0].clientHeight+2;this.dr.scrollTop+this.dr.clientHeight<h.offsetTop+h.clientHeight?this.dr.scrollTop=h.offsetTop-3*h.clientHeight-r:this.dr.scrollTop>h.offsetTop&&
(this.dr.scrollTop=h.offsetTop-r/2);this.oGi(b)}}validate(){return!0}Hmh(){if(ve.FocusManager.fJ()){var b=ve.FocusManager.instance().getRegion(this.UJ);b&&b.Vj.oy(this.IV)}else this.IV.focus();for(b=0;b<this.dr.childNodes.length;b++){const h=this.dr.childNodes[b];1===h.childNodes.length&&this.yTk(h.childNodes[0])}$e.a.eZ(this.dr);this.Fmh();this.Iga(1,!1);this.KTa=new zm.a(Box4Intl.Box4Strings.l_ClipartSearching);this.KTa.ohi=!1;this.dr.appendChild(this.KTa.element);this.dr.classList.add("ClipartSearchInProgress")}ZXf(b){this.xxa=
b;b=this.dr.children[this.xxa];ve.FocusManager.fJ()?ve.FocusManager.instance().getRegion(this.UJ).Vj.oy(b):b.focus()}static get zT(){return Qn.ij=Qn.ij||Sa.a.instance.resolve("Box4.Images.IImageEditor")}}Qn.ij=null;Object(n.a)(Qn,"InsertClipartDialog",Wc.a,[]);class Rn extends rl{constructor(b,h,r,z,R,ba){super(b,h,r,z,R,ba,!1);this.vVm=ta=>{if(this.iim()){var Wa=this.Pe.Di(),ub=Wa.contentReplicator.eu.toString(),Ib=new Sys.Net.WebRequest;Ib.set_url("ClipArtUpload.ashx");Ib=new Sys.StringBuilder(Ib.getResolvedUrl());
this.TV(Ib,rg.a.assetId,ta.assetId,!0);this.TV(Ib,Tj.a.lcid,t.AFrameworkApplication.lcid.toString());this.TV(Ib,Tj.a.nodeId,this.jG?this.jG.id.toString():this.Pe.id.toString());this.TV(Ib,Tj.a.cellId,Wa.Zl.toString());this.TV(Ib,Tj.a.fileId,Wa.Fs);this.TV(Ib,Tj.a.Ara,ub);this.TV(Ib,Tj.a.R1,this.em.toString());ta=Sl.a.Cq;xg.a.instance.J(4)&&(ta=this.Pe.ia(ui.a.mK,Sl.a.Cq));this.TV(Ib,Tj.a.mK,ta.toString());this.TV(Ib,Tj.a.Emb,"1");Wa.jI&&this.TV(Ib,Tj.a.jI,Wa.jI);this.TV(Ib,Tj.a.classId,this.jG?this.jG.properties.Qc.toString():
this.Pe.Qc.toString());this.gf.hasProperty(yc.a.imageType)&&this.TV(Ib,rg.a.imageType,this.gf.getValue(yc.a.imageType).toString());zl.a.instance.R5j(Ib);t.AFrameworkApplication.Xe.Lj(Ib.toString(),2,"",{},!1,2,this.ono,this.uploadFailed,null);rl.n$b++}};this.ono=ta=>{if(({group:Wa}=yl.a.M7(ta.data.Ge)).returnValue){var Wa=Wa.Responses[0];Wa.Gjb=ta.data.eH;Wa.Vt=ta.data.rj?ta.data.rj[eo.a.N5]:"";this.kwa(Wa)}else this.uploadFailed(null)};this.uploadFailed=()=>{const ta=new Po.a;ta.StatusCode=14;this.kwa(ta)};
new Qn(this)}BEa(b){this.LMd()&&this.Pe.Di().contentReplicator.forceOutbound(this.vVm,null,b)}TV(b,h,r,z){b.append(z?"?":"&");b.append(B.a.Ij(h));b.append("=");b.append(B.a.Ij(r))}G7e(b){switch(b){case 26:return Box4Intl.Box4Strings.l_ClipartCannotConnect;case 27:return Box4Intl.Box4Strings.l_ClipartCannotDownload;default:return super.G7e(b)}}kwa(b){super.kwa(b);rl.n$b--}}Object(n.a)(Rn,"ClipartUploader",rl,[]);class Uj{constructor(b,h,r){this.e5l=(z,R,ba,ta,Wa)=>{if(!this.ij||!this.ij.value)return v.ULS.sendTraceTag(524109267,
306,15,"ImageEditor not available"),8;z=this.ij.value.vda(R);return 2===ba&&z?(new Rn(R,Oe.a.instance,t.AFrameworkApplication.K,Wa,this.wm,this.ga),32):1===ba?z&&vb.App.wnh?32:8:2};this.ij=b;this.wm=h;this.ga=r}Vb(){this.ga.gb(Fb.a.J8h,kc.a.view,this.e5l,260)}}Object(n.a)(Uj,"ClipArtActor",null,[]);class zk{constructor(){this.W=null}get name(){return"Box4.ClipArt"}yc(b){this.W=b;b.ha("Box4.ClipArt.ClipArtActor",()=>new Uj(b.ef("Box4.Images.IImageEditor"),b.resolve("Box4.IUndoManager"),t.AFrameworkApplication.ya)).singleInstance()}init(){this.W.resolve("Box4.ClipArt.ClipArtActor").Vb();
const b=vb.App.xa;b&&b.updateCommandUI()}dispose(){}}Object(n.a)(zk,"ClipartPackage",null,[1,2]);class cm{constructor(b){this.gUa=this.RTa=this.lUa=this.kUa=null;this.aHg=this.LNg=this.Bh=this.y8=!1;this.JEe=this.pOg=null;this.bOg=0;this.Oa=this.kOg=null;this.v4=b;this.kR=3;this.zpc=!0}initialize(b,h,r){this.kUa=this.thf(b,h);this.lUa=CommonUIStrings.l_SavingStatus;this.RTa=CommonUIStrings.l_ReadOnlyStatus;this.gUa=CommonUIStrings.l_ReviewModeStatus;this.v4&&this.v4.execute(z=>{z.lvb(Object(u.a)(this,
this.W3c,"updateToSavingStatus"))});this.Bh=!0;this.Oa=r;return!0}pmb(b,h){this.y8=b;this.kR=h;this.FQa(this.zpc)}FQa(b){!this.zpc&&b&&(this.kOg=new Date);this.zpc=b;b=null;3===this.kR&&(b=this.zpc?this.kUa:this.lUa);this.DXk(b)}thf(b,h){return b?String.format(CommonUIStrings.l_SavedToStatus,CommonUIStrings.l_OneDriveName):h&&h.length?String.format(CommonUIStrings.l_SavedToStatus,h):CommonUIStrings.l_SavedStatus}W3c(){this.FQa(!1)}ozl(){switch(this.kR){case 1:return this.RTa;case 2:return this.gUa;
default:return null}}Mbm(b){return this.LNg===this.y8&&this.bOg===this.kR&&this.pOg===b}F4e(b){appChrome.getHeaderApi().then(h=>{h.updateDocumentTitleStatus(this.y8,b,this.ozl(),this.kOg,this.zpc);this.aHg=!0;return null});this.JEe=null}DXk(b){this.Bh&&yh.c()&&!this.Mbm(b)&&(!this.aHg&&this.Oa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ExpediteFirstSaveStatusAction",!1)?this.F4e(b):Ed.a.TTf()?(this.JEe&&v.ULS.sendTraceTag(595146389,340,50,"Previous UpdateDocumentTitleStatus idle callback can be cancelled."),
this.JEe=window.requestIdleCallback(()=>{this.F4e(b)})):window.requestAnimationFrame(()=>{this.F4e(b)}),this.LNg=this.y8,this.pOg=b,this.bOg=this.kR)}}Object(n.a)(cm,"ReactSaveStatusUIHandler",null,[699]);class Wo{constructor(b,h){this.MW=null;this.kUa=CommonUIStrings.l_SavedStatus;this.lUa=CommonUIStrings.l_SavingStatus;this.RTa=CommonUIStrings.l_ReadOnlyStatus;this.gUa=CommonUIStrings.l_ReviewModeStatus;this.u7a=h;this.v4=b;this.kR=3;this.D9a=!0}QA(){this.v4&&this.v4.execute(b=>{b.lvb(Object(u.a)(this,
this.W3c,"updateToSavingStatus"))});this.u7a.execute(b=>{this.MW=b})}pmb(b,h){this.kR=h;3===h?this.FQa(this.D9a):2===h?this.f7f(this.gUa):this.f7f(this.RTa)}W3c(){this.FQa(!1)}FQa(b){this.D9a=b;this.f7f(this.D9a?this.kUa:this.lUa)}f7f(b){this.MW&&this.MW.sendMessage(F.a.Edo,this.uDk(b))}uDk(b){const h={};h.StatusText=b;return h}}Object(n.a)(Wo,"SaveStatusPostMessageHandler",null,[699]);var In=d(221),Ul=d(114);class Ym{constructor(b,h,r,z){this.gUa=this.RTa=this.lUa=this.kUa=null;this.orb=0;this.NY=
this.VFe=this.snb=this.Vhe=this.nKe=null;this.tg=b;this.p7a=h;this.v4=r;this.Ql=z;this.KKg=!0;this.y8=!1;this.kR=3;this.D9a=!0}initialize(b,h){if(!this.tg)return!1;this.kUa=this.thf(b,h);this.lUa=CommonUIStrings.l_SavingStatus;this.RTa=CommonUIStrings.l_ReadOnlyStatus;this.gUa=CommonUIStrings.l_ReviewModeStatus;this.QA();return!0}thf(b,h){return b?String.format(CommonUIStrings.l_SavedToStatus,CommonUIStrings.l_OneDriveName):h&&h.length?String.format(CommonUIStrings.l_SavedToStatus,h):CommonUIStrings.l_SavedStatus}QA(){this.p7a&&
this.p7a.execute(b=>{b.s8j(Object(u.a)(this,this.svh,"createStatusAndModeElements"));b.b8j(Object(u.a)(this,this.BXn,"showHideSaveStatusElement"));b.i$n&&this.svh(null,null)});this.v4&&this.v4.execute(b=>{b.lvb(Object(u.a)(this,this.W3c,"updateToSavingStatus"))})}qha(){this.NY&&this.tg&&this.tg.gwa(this.NY)}BXn(b,h){this.pmb("true"===h,this.kR)}pmb(b,h){this.y8=b;this.kR=h;this.Vhe&&(this.Vhe.style.display=this.y8||3===this.kR||!this.nKe?"none":"");this.snb&&(this.snb.style.display=this.y8||3===this.kR?
"none":"",this.snb.innerText=1===this.kR?this.RTa:this.gUa,this.snb.title=1===this.kR?CommonUIStrings.l_ReadOnlyStatusTooltip:CommonUIStrings.l_ReviewModeStatusTooltip);this.VFe&&(this.VFe.style.display=this.y8||1===this.kR||!this.nKe&&!this.snb?"none":"");this.NY&&(this.NY.style.display=this.y8||1===this.kR?"none":"",this.FQa(this.D9a),this.NY.title=CommonUIStrings.l_SaveStatusTooltip)}svh(b,h){b=document.getElementById(In.CuiHelper.qXl);h&&h.Cro||!b||""===this.kUa||""===this.lUa||""===this.RTa||
""===this.gUa||(this.nKe=document.getElementById(In.CuiHelper.eUe),this.Vhe=In.CuiHelper.rxd(b,"BreadcrumbAppModeDash","-"),this.snb=In.CuiHelper.rxd(b,"BreadcrumbAppModeStatus",1===this.kR?this.RTa:this.gUa),this.Rgj(this.snb),this.VFe=In.CuiHelper.rxd(b,"BreadcrumbSaveStatusDash","-"),this.NY=In.CuiHelper.rxd(b,"BreadcrumbSaveStatus",this.kUa),this.Rgj(this.NY),this.pmb(this.y8,this.kR))}W3c(){this.FQa(!1)}FQa(b){this.D9a=b;this.Clo(this.D9a?this.kUa:this.lUa)}Clo(b){!this.NY||3!==this.kR&&2!==
this.kR||(this.KKg&&!this.D9a?(this.orb=this.NY.offsetWidth<this.orb?this.orb:this.NY.offsetWidth,this.ogo(this.lUa),this.KKg=!1):this.NY.innerText=b)}Rgj(b){b.style.direction=this.Ql?"rtl":"ltr";b.style.width="auto";b.style.textAlign=this.Ql?"right":"left";b.style.display=this.y8?"none":"";b.setAttribute("Unselectable","on")}ogo(b){this.NY&&(this.NY.style.width="",this.NY.innerText=b,this.orb=this.NY.offsetWidth<this.orb?this.orb:this.NY.offsetWidth,b=Ul.a.IB(this.NY),this.NY.style.width=this.orb-
$e.a.eM(b.paddingLeft)-$e.a.eM(b.paddingRight)+1+"px")}}Object(n.a)(Ym,"SaveStatusUIHandler",null,[699]);var Fm=d(73);class Hk{constructor(){this.WFe=this.$De=this.CIa=this.W=null}get name(){return"Common.App.SaveStatus"}yc(b){this.W=b;t.AFrameworkApplication.K.$("PostMessageEmbedded")&&t.AFrameworkApplication.eQ?this.W.register(Wo,"Common.App.SaveStatus.SaveStatusPostMessageHandler").as("Common.App.SaveStatus.ISaveStatusUIHandler").singleInstance().Yd(()=>new Wo(this.W.Za("Common.App.HostNotification.EditNotificationEventSource"),
this.W.Za("Postmessage.IHostPostmessenger"))):t.AFrameworkApplication.ua.Sb.Rtf||(t.AFrameworkApplication.ua.Sb.BI?this.W.register(cm,"Common.App.SaveStatus.ReactSaveStatusUIHandler").as("Common.App.SaveStatus.ISaveStatusUIHandler").singleInstance().Yd(()=>new cm(this.W.Za("Common.App.HostNotification.EditNotificationEventSource"))):this.W.register(Ym,"Common.App.SaveStatus.SaveStatusUIHandler").as("Common.App.SaveStatus.ISaveStatusUIHandler").singleInstance().Yd(()=>new Ym(Fm.EventHandlerManager.instance,
this.W.Za("Common.App.Header.HeaderEventSource"),this.W.Za("Common.App.HostNotification.EditNotificationEventSource"),t.AFrameworkApplication.isRtl)))}init(){t.AFrameworkApplication.K.zq(Object(u.a)(this,this.ax,"onFullAppSettingsReady"))}ax(){const b=t.AFrameworkApplication.K,h=!!t.AFrameworkApplication.ua.Sb&&4===t.AFrameworkApplication.ua.Sb.jo;if(b.$("WordEditorAutoSaveImprovementIsEnabled")||b.$("PptEditorSaveStatusInHeaderEnabled")||h&&b.$("SimplifiedReactRibbonUxIsEnabled")||b.$("ExcelSaveStatusInHeaderEnabled")||
b.$("VisioSaveStatusInHeaderEnabled"))t.AFrameworkApplication.K.$("PostMessageEmbedded")&&t.AFrameworkApplication.eQ?(this.WFe=this.W.resolve("Common.App.SaveStatus.SaveStatusPostMessageHandler"))&&this.WFe.QA():t.AFrameworkApplication.ua.Sb.Rtf||(t.AFrameworkApplication.ua.Sb.BI?(this.$De=this.W.resolve("Common.App.SaveStatus.ReactSaveStatusUIHandler"))&&this.$De.initialize(b.$("IsSkyDrive"),b.lb("HostNameToIncludeInSavedStatus"),t.AFrameworkApplication.K):(this.CIa=this.W.resolve("Common.App.SaveStatus.SaveStatusUIHandler"))&&
this.CIa.initialize(b.$("IsSkyDrive"),b.lb("HostNameToIncludeInSavedStatus")))}dispose(){this.CIa&&this.CIa.qha()}}Object(n.a)(Hk,"PackageManager",null,[1,2]);var dm=d(1604);class Xo{get name(){return"Common.App.EventsCachePackage"}yc(){}init(){dm.a.instance.init()}dispose(){}static main(){O.a.instance.Oc(new Xo)}}Object(n.a)(Xo,"EventsCachePackage",null,[1,2]);var Si=d(124),rj=d(143),Gm=d(95),Ik=d(635),Yf=d(333),im=d(479),Zm=d(304),qf=d(28),Wi=d(257),jg=d(24);class Oj{constructor(b){this.TJg=!1;
this.q6c=this.am=null;this.Wge=!1;this.HD=b}get control(){return this.HD}get Nd(){return this.control.Nd}get root(){return this.control.root}get hH(){return this.control.hH}get eVa(){return this.control.eVa}get mk(){return this.control.mk}get gE(){return this.control.gE}VH(){}initialize(){}rw(b,h,r){this.control.wYk(b,h,r)}yl(){qf.c(this.control.Gh.Command)||this.Ht(this.control.Gh.Command,null,null)}Ht(b,h,r){let z=0;this.root&&(z=this.root.ona(b,h,r));this.control.enabled=0<(z&1);return z}p4a(){let b=
this.control.visible;this.root.YPa&&(b=this.Nd[Wi.a.visible],b!==this.control.visible&&(this.control.visible=b,this.root.X9b=!0));return b}D8f(){const b=jg.a.Eoa(this.Nd[Wi.a.labelText],this.control.Gh.LabelText);this.T6d(b)}T6d(b){this.control.labelText!==b&&(this.gE.forEach(h=>{h.T6d(b)}),this.control.labelText=b,this.root.I0a=!0)}jMb(){const b=jg.a.Eoa(this.Nd[Wi.a.alt],this.control.Gh.Alt);this.mec(b)}mec(b){this.control.tooltip!==b&&(this.gE.forEach(h=>{h.mec(b)}),this.control.tooltip=b)}uha(){const b=
jg.a.Eoa(this.Nd[Ik.a.Image16by16Class],this.control.Gh.Image16by16Class),h=jg.a.Eoa(this.Nd[Ik.a.Image32by32Class],this.control.Gh.Image32by32Class);var r=jg.a.Eoa(this.Nd[Ik.a.Image48by48Class],this.control.Gh.Image48by48Class);r=qf.b(r)?h:r;this.Tyc(this.gE.small,b);this.Tyc(this.gE.medium,b);this.Tyc(this.gE.large,h);this.Tyc(this.gE.n_n,b);this.Tyc(this.gE.u8b,r)}Tyc(b,h){!b||qf.c(b.KP)||qf.c(h)||b.KP.className===h||(b.KP.className=h)}Yho(b){if(!qf.b(b)&&this.root.v3f){for(const h of this.control.AYe){const r=
h.NS===b;r&&(this.control.wNe=h);this.control.visible&&(h.Yz=r)}this.control.visible&&(this.root.I0a=!0)}}e$j(){if(this.gE.u8b&&this.gE.u8b.JN&&this.gE.u8b.kcb){const b=this.gE.u8b.JN,h=jg.a.Eoa(this.Nd[Yf.a.Description],this.control.Gh.Description);qf.b(h)&&(b.style.position="relative",b.style.top=(b.parentNode.offsetHeight-b.offsetHeight)/2+"px",b.style.padding="0px")}}onFocus(){const b=this.mk;Object(nb.a)(im.a,b)?this.hH.imb(b):this.root.axb=this.control;return!1}onBlur(){const b=this.mk;this.control.LDb()&&
jg.a.Lu(b.Kc,"cui-ctl-menu-hovered-without-focus");this.root.axb=null;return!1}vX(b){if(this.control.LDb()){var h=this.hH.joa;const r=h===this.root.sFb-1;h=r?null:this.root.UB[h+1];this.wXe(!1);r||this.control===h||jg.a.Lu(h.xEb,Zm.MenuLauncher.YRc);this.control.enabled&&this.control.Zt?r?this.control.HX():(jg.a.Pf(this.mk.Kc,"cui-ctl-menu-hovered-without-focus"),h.$da=this.control.Zt):r?this.hH.setFocus(b.gg):(h.$da=this.hH.Kc,this.hH.Ena())}return!1}gO(){this.control.LDb()&&jg.a.Lu(this.mk.Kc,"cui-ctl-menu-hovered-without-focus");
return!1}onKeyDown(b){let h=!1;if(!qf.c(b.Ib)&&!qf.c(b.Ib.rawEvent)){const r=b.Ib.keyCode;b=b.Ib.rawEvent.shiftKey;r===Sys.UI.Key.enter&&(h=!0);if(Object(nb.a)(im.a,this.mk)){const z=this.hH;if(!qf.c(z)){const R=z.joa,ba=0===this.root.C_,ta=!qf.c(this.control.h2m);if(r!==Sys.UI.Key.tab&&r!==Sys.UI.Key.left&&r!==Sys.UI.Key.right&&r!==Sys.UI.Key.up&&r!==Sys.UI.Key.down&&r!==Sys.UI.Key.esc)return h;Ed.a.YWe();r!==Sys.UI.Key.tab||b?r===Sys.UI.Key.tab&&b?(z.TJ(1),h=!0):r===Sys.UI.Key.left&&ba||r===Sys.UI.Key.right&&
!ba?(ta?z.TJ(2):0<R&&this.root.kWa(R,!0,!1),h=!0):r===Sys.UI.Key.right&&ba||r===Sys.UI.Key.left&&!ba?(ta&&z.TJ(4),h=!0):r===Sys.UI.Key.up?(z.TJ(5),h=!0):r===Sys.UI.Key.down?(z.TJ(6),h=!0):r===Sys.UI.Key.esc&&(this.root.kWa(R,!0,!1),h=!0):(z.TJ(0),h=!0)}}}return h}ex(b){let h=!1;if(!qf.c(b.Ib)&&!qf.c(b.Ib.rawEvent)){const r=b.Ib.keyCode;rc.KeyInputManager.X3h(b)||r!==Sys.UI.Key.enter&&r!==Sys.UI.Key.space||(h=this.$jf(b),h||(this.rw(b.Af,1,b.Ib),h=!0))}return h}XB(b){this.oYe();if(this.eVa){let h=
!0;2===b.gg&&(h=b.paa===Sys.UI.MouseButton.leftButton);h&&this.mk&&this.iqd(this.mk.Kc)}(b.Ib.type.toLowerCase()!==jb.a.yO||this.eVa)&&b.Ib.preventDefault();return!1}get Bpf(){return this.TJg}o1k(){this.TJg=!0}oYe(){this.Bpf&&this.control.root.abb()}Iua(b){Object(nb.a)(im.a,this.mk)&&!this.eVa&&2===b.gg&&b.paa===Sys.UI.MouseButton.leftButton?(this.rw(b.Af,b.gg,b.Ib),b=!0):b=this.control.fsa(b);return b}onClick(b){let h=!1;Object(nb.a)(im.a,this.mk)&&!this.eVa&&3===b.gg&&(this.rw(b.Af,b.gg,b.Ib),h=
!0);return X.a.ki?!1:h}wib(b){return this.wWd(b)}iDa(b){this.fsa(b);return!1}wWd(b){return qf.c(this.am)?!1:(this.iXf(Ed.a.MPd(this.a7g,b.clientPoint)),!0)}J$b(b){let h=!1;this.fsa(b)&&(h=!0);3!==b.gg&&(b=!0,!this.root&&Oj.uEf&&(v.ULS.sendTraceTag(588084884,207,50,"Root is null"),b=!1),b&&this.root.zda(),h=!0);return h}M$b(b){return this.fsa(b)}K$b(b){return this.wWd(b)}L$b(b){return this.fsa(b)}H$b(b){return 3===b.gg?(this.root.zda(),!0):!1}I$b(){return!1}get a7g(){!qf.c(this.am)&&qf.c(this.q6c)&&
(this.q6c=Ed.a.getElementBounds(this.am));return this.q6c}iXf(b){this.Wge!==b&&(this.Wge=b,this.xNe(this.Wge))}xNe(b){qf.c(this.am)||jg.a.K3(this.am,Gm.Control.lqd,b)}iqd(b){this.control.enabled&&(this.am=b,this.root.Vxc=this.control,this.iXf(!0),this.root.pda(this.control,!1))}fsa(b){if(!qf.c(this.am)){this.iXf(!1);let h=!!this.root;if(Oj.uEf){const r=$c.ActionManager.ada(parseInt(this.control.Gh.Command))||"";v.ULS.sendTraceTag(588084885,207,50,"Root not null: {0}, Action: {1}",h,r)}h&&this.root.Y9(this.control,
!1);qf.c(b)||Ed.a.MPd(this.a7g,b.clientPoint)&&this.rw(this.am,b.gg,b.Ib);h=!!this.root;Oj.uEf&&v.ULS.sendTraceTag(588084886,207,50,"Root not null: {0}",h);h&&(this.root.Vxc=null);this.q6c=this.am=null;return!0}return!1}TJ(b){return Object(nb.a)(im.a,this.mk)&&2!==b&&4!==b&&!Ed.a.I5b(this.control.Zt)?this.HX():!1}HX(){try{if(this.control.visible){const b=this.control.Zt;if(!qf.c(b))return b.focus(),!0}}catch(b){}return!1}wXe(b){const h=this.hH;qf.c(h)||this.root.kWa(h.joa+1,b)}Sma(){}$jf(){return!1}Jea(b){let h=
null;b&&b.rawEvent&&(h={},h[Oj.triggerTime]=b.rawEvent.timeStamp);return h}static get uEf(){null==Oj.bAe&&(Oj.bAe=!!t.AFrameworkApplication.K&&t.AFrameworkApplication.K.$("NullCheckRootInOnModalBodyPointerDownIsEnabled"));return Oj.bAe}}Oj.triggerTime="TriggerTime";Oj.bAe=null;Object(n.a)(Oj,"ControlBehavior",null,[715]);var sj=d(139);class jl extends Oj{constructor(b){super(b)}get button(){return this.control}get properties(){return this.control.Gh}VH(b){const h=b.zm;b=b.NS;qf.c(h)||(xc.a.instance.mb(jb.a.focus,
h,Object(u.a)(this,this.onFocus,"onFocus")),xc.a.instance.mb(jb.a.blur,h,Object(u.a)(this,this.onBlur,"onBlur")),rj.a.instance.mb(jb.a.pointerOver,h,Object(u.a)(this,this.vX,"onPointerOver")),rj.a.instance.mb(jb.a.pointerOut,h,Object(u.a)(this,this.gO,"onPointerOut")),rc.KeyInputManager.instance.uE(jb.a.li,h,Object(u.a)(this,this.onKeyDown,"onKeyDown"),b),rc.KeyInputManager.instance.uE(jb.a.Ft,h,Object(u.a)(this,this.KF,"onKeyPress"),b),rc.KeyInputManager.instance.uE(jb.a.oh,h,Object(u.a)(this,this.ex,
"onKeyUp"),b),rj.a.instance.mb(jb.a.pointerDown,h,Object(u.a)(this,this.XB,"onPointerDown")),rj.a.instance.mb(jb.a.fM,h,Object(u.a)(this,this.Iua,"onPointerUp")),sf.a.instance.mb(jb.a.click,h,Object(u.a)(this,this.onClick,"onClick")),sj.a.instance.mb(jb.a.xO,h,Object(u.a)(this,this.wib,"onTouchMove")),sj.a.instance.mb(jb.a.bJ,h,Object(u.a)(this,this.iDa,"onTouchEnd")))}rw(b,h,r){this.control.enabled&&(b=null,this.mk&&this.mk.sOc()&&this.hH&&(b=this.root.UB[this.hH.joa])&&!this.Bpf&&(b.nPa(this.button),
b=null),this.executeCommand(this.control.Gh.Command,h,!0,r),b&&b.nPa(this.button))}executeCommand(b,h,r,z){if(!qf.c(b)){const R=this.Nd;R.CommandValueId=this.button.Rzb();R.MenuItemId=this.button.Gh.MenuItemId;R.SourceControlId=this.control.id;this.root.executeCommand(b,R,this.mk,h,r,null,this.Jea(z))}}yl(){qf.c(this.control.Gh.Command)||0<(this.Ht(this.properties.Command,this.properties.QueryCommand,this.Nd)&2)&&this.p4a()&&this.EQa()}EQa(){this.D8f();this.jMb();this.uha()}onFocus(b){super.onFocus(b);
this.p2f();return!1}onBlur(b){super.onBlur(b);this.I6e();return!1}onKeyDown(b){let h=super.onKeyDown(b);qf.c(b.Ib)||this.i_f(b.yp,b.Ib.keyCode)&&(h=!1);return h}KF(b){let h=!1;qf.c(b.Ib)||qf.c(b.Ib.rawEvent)||(this.i_f(b.yp,b.Ib.rawEvent.keyCode)?(this.rw(b.Af,b.gg,b.Ib),h=!0):b.Ib.preventDefault());return h}i_f(b,h){if(X.a.Ak&&h===Sys.UI.Key.enter)switch(b){case "MenuMru":case "MenuTemplate":case "MenuHeader":case "MenuFooter":return!0}return!1}ex(b){let h=!1;qf.c(b.Ib)||this.i_f(b.yp,b.Ib.keyCode)||
(h=super.ex(b));return h}p2f(){this.control.enabled&&this.executeCommand(this.properties.CommandPreview,0,!1,null)}I6e(){this.control.enabled&&this.executeCommand(this.properties.CommandRevert,0,!1,null)}}Object(n.a)(jl,"ButtonBehavior",Oj,[]);var oh=d(955);class Gl{}Gl.Color="Color";Gl.IndexColorSelected="ColorSelected";Object(n.a)(Gl,"ColorPickerCommandProperties",null,[]);class oa extends Oj{constructor(b){super(b);this.lvc=this.Tu=-1}get colorPicker(){return this.control}get SJa(){return this.colorPicker.uzk.SJa}get properties(){return this.colorPicker.Gh}rw(b,
h,r){if(this.control.enabled){const z=this.Nd;z.Color=oa.SGd(b)[oh.ColorPicker.Bvd];b=null;jg.a.ur(this.properties.Stateful)&&this.mk&&this.mk.sOc()&&this.hH&&(b=this.root.UB[this.hH.joa]);this.root.executeCommand(this.properties.Command,z,this.mk,h,!0,null,this.Jea(r));b&&b.nPa(this.colorPicker)}}yl(){var b=this.Nd;b.SourceControlId=this.properties.Id;if(0<(this.Ht(this.properties.Command,this.properties.QueryCommand,b)&2)&&(b=-1,Gl.IndexColorSelected in this.Nd&&(b=this.Nd[Gl.IndexColorSelected]),
b!==this.lvc)){const h=this.SJa;0<=b&&b<h.length&&this.hgj(h[b],!0);0<=this.lvc&&this.lvc<h.length&&this.hgj(h[this.lvc],!1);this.lvc=b}}hgj(b,h){h?jg.a.Pf(b,"cui-colorpicker-selected"):jg.a.Lu(b,"cui-colorpicker-selected")}VH(b){for(let h=0;h<b.cNe.length;++h){const r=b.cNe[h];xc.a.instance.mb(jb.a.focus,r,Object(u.a)(this,this.JFf,"onCellFocus"));xc.a.instance.mb(jb.a.blur,r,Object(u.a)(this,this.PPm,"onCellBlur"));rc.KeyInputManager.instance.mb(jb.a.li,r,Object(u.a)(this,this.onKeyDown,"onKeyDown"));
rc.KeyInputManager.instance.mb(jb.a.oh,r,Object(u.a)(this,this.ex,"onKeyUp"));sf.a.instance.mb(jb.a.click,r,Object(u.a)(this,this.QPm,"onCellClick"));rj.a.instance.mb(jb.a.fM,r,Object(u.a)(this,this.LFf,"onCellPointerUp"));rj.a.instance.mb(jb.a.pointerOver,r,Object(u.a)(this,this.KFf,"onCellPointerOver"));rj.a.instance.mb(jb.a.pointerDown,r,Object(u.a)(this,this.RPm,"onCellPointerDown"))}}JFf(b){b=oa.SGd(b.Af);this.hH.imb(this.mk);this.Fce(b,!0);return!0}PPm(b){this.Fce(oa.SGd(b.Af),!1);return!0}Fce(b,
h){h?(this.Tu=parseInt(b.getAttribute("arrayPosition")),jg.a.Pf(b,"cui-colorpicker-hoveredOver"),this.p2f(b)):(this.Tu=-1,this.I6e(b),jg.a.Lu(b,"cui-colorpicker-hoveredOver"))}QPm(b){3===b.gg&&this.rw(b.Af,b.gg,b.Ib);return!0}LFf(b){3!==b.gg&&this.rw(b.Af,b.gg,b.Ib);return!0}KFf(b){this.wXe(!1);b=parseInt(oa.SGd(b.Af).getAttribute("arrayPosition"));this.h_c(b);return!0}RPm(){return!1}p2f(b){if(this.control.enabled){const h=this.properties.CommandPreview;if(!qf.b(h)){const r=this.Nd;r.Color=b[oh.ColorPicker.Bvd];
this.root.executeCommand(h,r,this.mk,0,!1)}}}I6e(b){if(this.control.enabled){const h=this.properties.CommandRevert;if(!qf.b(h)){const r=this.Nd;r.Color=b[oh.ColorPicker.Bvd];this.root.executeCommand(h,r,this.mk,0,!1)}}}TJ(b){b=Gm.Control.i$e(this.Tu,this.colorPicker.width,this.SJa.length,b);if(b!==this.Tu&&this.h_c(b))return!0;this.Fce(this.SJa[this.Tu],!1);return!1}HX(){return this.h_c(0)}h_c(b){return this.SJa&&this.SJa.length>b&&(b=this.SJa[b],b.firstChild)?(b.firstChild.focus(),!0):!1}Sma(){-1!==
this.Tu&&this.Fce(this.SJa[this.Tu],!1)}static SGd(b){return oa.Tzl(b)}static Tzl(b){var h=["td"];const r=h.length;if(!b)return null;for(var z=0;z<r;z++)if(b.tagName.toLowerCase()===h[z].toLowerCase())return b;for(b=b.parentNode;b;){for(z=0;z<r;z++)if(b.tagName.toLowerCase()===h[z].toLowerCase())return b;b=b.parentNode}return null}}Object(n.a)(oa,"ColorPickerBehavior",Oj,[]);var cb=d(278),xb=d(280),Qb=d(1627),qc=d(689),Mc=d(393),Gd=d(1100);class de{constructor(b,h){this.FXj=b;this.CJg=h}C6d(b,h,r,
z){if(qf.c(b)||qf.c(h))return null;const R=new Gd.a;const ba=z.x;var ta=z.y;const Wa=z.width;var ub=z.height;let Ib;de.c0b(h,"flyoutWidth");z=de.c0b(h,"flyoutRealHeight");const $b=de.c0b(h,"viewportWidth");var fc=de.c0b(h,"viewportHeight"),Kc=de.c0b(h,"viewableLeft");const ed=de.c0b(h,"viewableTop"),Jd=this.FXj;let ge=!1,qe=!1;const Ve=1===r,Bd=4===r,he=this.CJg;b.style.maxHeight="none";b.style.top="0px";b.style.overflowY="visible";b.style.width="auto";Ib=this.Bqi(b);R.Ukj=fc;R.u$f=$b;if(Ve)Jd?h=
ba+Wa:(h=ba-Ib,R.Xgb=!0),ub=ta;else{var we="";Wa>Ib&&(Ib=Wa,we=(Ib-2*Mc.Menu.HUd).toString());Jd?h=ba:(h=ba+Wa-Ib,R.Xgb=!0);ub=ta+ub;""!==we&&(b.style.minWidth=we+"px")}he&&(ub+=ed,h+=Kc);b.style.top=ub+"px";b.style.left=h+"px";let hg=!1;we=!1;Ib<=$b?h+Ib>Kc+$b?(Ve&&Jd&&ba-Ib>Kc||Bd&&ba-Ib>Kc?(h=ba-Ib,he&&(h+=Kc),we=R.Xgb=!0):(h=Kc+$b-Ib,ge=!0),hg=!0):h<Kc&&(Ve&&!Jd&&ba+Wa+Ib<Kc+$b?(h=ba+Wa,he&&(h+=Kc),R.Xgb=!1,we=!0):(h=Kc,qe=!0,R.Xgb=!0),hg=!0):Jd?(h=Kc,hg=!0,R.Xgb=!0):(h=Kc+$b-Ib,hg=!0,R.Xgb=!1);
hg&&(b.style.left=h+"px");R.I1b=ub;ub+z<=ed+fc&&3!==r||(R.Zvf=!0,{eLm:r,bcl:ta,jdm:fc,Rjm:Kc}=this.M9e(r,ub,z,ta,ed,fc),ub!==r&&(b.style.top=r+"px",R.I1b=r),-1<ta&&(b.style.maxHeight=ta+"px"),fc&&(b.style.bottom="0px",b.style.height="auto"),Kc&&this.KDm(b,Jd,Ve,we,qe,ge,$b,ba,Wa));R.DGc=h;R.h$e=Ib;R.e$e=z;return R}M9e(b,h,r,z,R,ba){let ta,Wa,ub;ta=-1;ub=Wa=!1;const Ib=h,$b=R+ba-h;h=z-r;const fc=this.CJg;let Kc=!1;0>h&&(h=R);fc||(z-=R);r<=z&&1!==b||(4===b||1===b?r<ba?(h=ba-r,Wa=!0):(h=R,Kc=ub=Wa=!0):
(z<$b&&3!==b?(h=Ib,Wa=!0):ta=z,ub=!0));fc&&(Wa=!1,Kc?ta=ba:h+=R);return{eLm:h,bcl:ta,jdm:Wa,Rjm:ub}}KDm(b,h,r,z,R,ba,ta,Wa,ub){b.style.overflowY="scroll";b.style.width="auto";if(h){if(ba||z)b.style.left="",b.style.right=(ba?0:ta-Wa)+"px"}else R||z||(b.style.left="",b.style.right=(r?ta-Wa:ta-Wa-ub)+"px")}Spl(b){const h={};if(qf.c(b))return h;h.viewportWidth=$e.a.hBb();h.viewportHeight=$e.a.l2();qf.c(h.viewportWidth)&&(h.viewportWidth=document.documentElement.clientWidth,h.viewportHeight=document.documentElement.clientHeight);
qf.c(h.viewportWidth)&&(h.viewportWidth=document.body.clientWidth,h.viewportHeight=document.body.clientHeight);h.viewableTop=window.pageYOffset;h.viewableLeft=window.pageXOffset;qf.c(h.viewableTop)&&(h.viewableTop=document.documentElement.scrollTop,h.viewableLeft=document.documentElement.scrollLeft);qf.c(h.viewableTop)&&(h.viewableTop=document.body.scrollTop,h.viewableLeft=document.body.scrollLeft);h.flyoutRealHeight=b.scrollHeight!==b.offsetHeight?b.scrollHeight+2*Mc.Menu.HUd:b.scrollHeight;const r=
b.style.overflowY;b.style.overflowY="visible";h.flyoutWidth=this.Bqi(b);b.style.overflowY=r;return h}Bqi(b){return b.offsetWidth}static c0b(b,h){return qf.c(b)?0:b[h]}}Object(n.a)(de,"MenuPositioner",null,[]);var Id=d(532),Xe=d(618),hf=d(1102),Ef=d(1101),ng=d(1098),Bh=d(1099),fi=d(1104),jj=d(412),Qg=d(953);class sh extends Oj{constructor(b){super(b);this.Zye=0;this.GNg=null;this.xCe=-1;this.o$c=null;this.LLf=this.JGg=!1;this.wMj=new de(0===this.root.C_,jg.a.ur(this.root.properties.DivSyndicated))}get Nqi(){return this.wMj}get iu(){return this.control}get properties(){return this.control.Gh}get menu(){return this.iu.menu}set menu(b){this.iu.menu=
b}get nK(){return this.iu.nK}set nK(b){this.iu.nK=b}get ifh(){qf.c(this.o$c)&&(this.o$c=sh.gKk());return this.o$c}get x3i(){let b=!this.root.Gmf;Object(nb.a)(389,this.root)&&1===this.root.sFb&&(b=!0);return b}rw(b,h){Object(nb.a)(389,this.root)&&this.root.a7e();this.iu.OZ(h)}OZ(b){if(this.iu.enabled&&!this.nK){var h=wc.a.instance.oo(ab.a.OZ);h.properties.add("Id",this.iu.Gh.Id);h.properties.add("InputMethod",cb.a[b]);h.end();mf.a.mark(10326);Ed.a.EUd(this.iu.Gh.Id,"MenuOpen");this.iu.Zt&&(this.iu.$da=
Ed.a.bLa(this.iu.Zt.ownerDocument));this.Zye=b;this.jFi(b);this.Y5d();this.iu.f4a(this.iu.Zt,!0)}}Y5d(){qf.c(this.properties.PopulateAsyncTriggerCommand)||this.JGg||(this.EMm(),this.JGg=!0)}EMm(){const b={};b[Qb.a.Callback]=Object(u.a)(this,this.zLi,"refreshMenuCallback");this.root.executeCommand(this.properties.PopulateAsyncTriggerCommand,b,this.mk,0,!1)}zLi(){this.iu.FOa()}FOa(){this.nK&&this.jFi(this.Zye,!0)}jFi(b,h=!1){var r=!0;if(jg.a.ur(this.properties.PopulateDynamically)){r=!1;const z=this.aVc(b);
z!==this.GNg&&(r=this.$Lf(z,h));r=r||!this.nK}r&&(h=t.AFrameworkApplication.ua.jq,r=null,h&&(r=h.hg("LoadResource","Menu Initialization")),this.GZa(b),r&&r.stop(),this.KXd())}GZa(b){if(!qf.c(this.menu)){if(this.iu.o1a){var h=this.iu.mk;if(h&&h.keytip){var r=h.keytip.key.toLocaleLowerCase();this.menu.bNn(String.format("{0} {1}",this.iu.o1a,h.keytip.h6e),this.iu.iOa&&""!==this.iu.iOa?String.format("{0}-{1}",this.iu.iOa,r):r)}}this.menu.Mka();jg.a.Pf(this.menu.Kc,this.iu.PPe);jg.a.K3(this.menu.Kc,"cui-touch",
3===b||this.root.nbe);if(this.menu.hasItems()){this.menu.VH();h=this.mk;h.YDh();h.CLc=!0;h.Sf(this.menu);h.CLc=!1;this.menu.hFi();r=Object(nb.a)(Qg.a,this.root);var z=null,R=!1;r&&(z=this.root,R=z.U2a,z.U2a=!1);var ba=this.menu.Kc;ba.style.visibility="hidden";ba.style.position="absolute";ba.style.top="0px";ba.style.left="0px";X.a.Ak&&!X.a.agb&&(ba.style.maxHeight="100px",ba.style.overflowY="scroll");document.body.appendChild(ba);this.h$j();this.t6m(ba);Sys.Browser.agent===Sys.Browser.InternetExplorer&&
this.O0j();jg.a.Pf(this.iu.xEb,Zm.MenuLauncher.YRc);var ta=this.root.sFb;this.uTn&&this.root.pda(this.control,!0);ba.style.zIndex=String(t.AFrameworkApplication.ua.jra);this.root.p3j(this.iu);this.menu.joa=ta;ba.style.visibility="visible";ta=this.GNh();if(Object(nb.a)(Bh.a,this.menu)){ba.style.position="fixed";const Wa=this.root.UB[0];Wa&&Wa.menu&&Wa.menu.Kc?100!==Ed.a.ZIc(this.root.UB[0].menu.Kc)&&xb.a.G0f(ba,ta,Object(u.a)(this,this.ZPe,"afterShowMenu")):xb.a.G0f(ba,ta,Object(u.a)(this,this.ZPe,
"afterShowMenu"))}else xb.a.G0f(ba,ta,Object(u.a)(this,this.ZPe,"afterShowMenu"));this.nK=!0;this.menu.Yvf=!0;!X.a.ki&&this.iu.hFn&&this.menu.setFocus(b);r&&(z.U2a=R);r=this.properties.CommandMenuOpen;qf.b(r)||this.root.executeCommand(r,null,h,b,!1)}}mf.a.mark(10327)}KXd(){}O0j(){this.xCe=jg.a.swb(this.xCe);this.xCe=window.setTimeout(Object(u.a)(this,this.P0j,"addAndPositionBackFrameInternal"),50)}P0j(){this.menu&&this.menu.Kc&&(document.body.appendChild(this.ifh),this.p6m())}p6m(){const b=this.ifh;
var h=this.menu.Kc;b.style.position="absolute";b.style.visibility="hidden";b.style.left=h.style.left;b.style.right=h.style.right;b.style.top=h.style.top;b.style.bottom=h.style.bottom;let r=h.offsetWidth;h=h.offsetHeight;X.a.agb&&(r-=4,h-=4);b.style.width=r.toString()+"px";b.style.height=h.toString()+"px";b.style.visibility="visible"}get uTn(){return this.root.sFb?!1:!0}ZPe(b){b.element&&(b.element.style.filter="",b.element.style.opacity="",this.menu&&this.menu.Kc===b.element&&Object(nb.a)(ng.a,this.menu)&&
xb.a.Hak(this.GNh()))}GNh(){const b=this.menu.children,h=[];if(Object(nb.a)(ng.a,this.menu))for(let r=0;r<b.count;r++){const z=b.J(r);Array.add(h,z.separator);for(let R=0;R<z.children.count;R++){const ba=z.children.J(R);Array.add(h,ba.Kc)}}return h}h$j(){var b=this.menu.children;for(let r=0;r<b.count;r++){const z=b.J(r).children;for(let R=0;R<z.count;R++){var h=z.J(R);if(Object(nb.a)(im.a,h)){const ba=h;if("Menu32"===ba.NS||"Menu48"===ba.NS)h=h.control,h.behavior&&(Object(nb.a)(Xe.a,h)||Object(nb.a)(Ef.a,
h))&&h.behavior.e$j()}}}0<b.count&&(b=b.J(0),qf.c(b.separator)||(b.separator.style.display="none"),qf.c(b.Tae)||jg.a.Pf(b.Tae,"cui-menusection-titleAtTop"))}t6m(b){if(!qf.c(b)){b.style.top="0px";b.style.left="0px";b.style.bottom="";b.style.right="";b.style.width="";b.style.minWidth="";var h=qc.a.create();try{const r=this.Nqi.Spl(b),z=this.HIc();let R=this.root.C6d(b,r,this.iu.IUd,z);R||(R=this.Nqi.C6d(b,r,this.iu.IUd,z));this.root.Oqi=R}finally{h&&h.dispose()}}}HIc(){const b=Ed.a.getElementBounds(this.iu.xEb);
var h=this.hH;qf.c(h)||qf.c(h.Kc)||(h=Ed.a.getElementBounds(h.Kc),b.x=h.x+Mc.Menu.HUd,b.width=h.width-2*Mc.Menu.HUd);Object(nb.a)(jj.a,this.iu.HRd)&&(b.height=0);return b}Mra(){if(this.iu.nK){v.ULS.sendTraceTag(6688860,207,50,"Menu closing {0}",{["Id"]:this.iu.Gh.Id});this.menu.Sma();this.WNi();this.nK=!1;this.menu.Yvf=!1;this.root.Y9(this.control,!0);this.x3i?t.AFrameworkApplication.ua.RYc(this.iu.$da,this.Zye):this.byn();this.iu.$da=null;var b=this.iu.xEb;jg.a.Lu(b,Zm.MenuLauncher.YRc);this.iu.f4a(this.iu.Zt,
!1);jg.a.Lu(b,"cui-ctl-menu-hovered-without-focus");this.menu.Ena();qf.b(this.properties.CommandMenuClose)||this.root.executeCommand(this.properties.CommandMenuClose,null,this.mk,0,!1);this.VNi()}}byn(){const b=this.iu.$da;if(b)try{b.focus()}catch(h){}}VNi(){$e.a.gv(this.menu.Kc);$e.a.gv(this.o$c);jg.a.gwa(this.menu.Kc)}aVc(b){if(this.LLf&&jg.a.ur(this.properties.PopulateOnlyOnce)||qf.c(this.properties.PopulateQueryCommand))return null;if(void 0===b||null===b)b=0;const h=this.iu.icf();return 0<(this.root.ona(this.properties.PopulateQueryCommand,
this.properties.PopulateQueryCommand,h,b)&1)?h.PopulationXML:null}$Lf(b,h=!1){if(this.LLf&&jg.a.ur(this.properties.PopulateOnlyOnce))return!0;let r=null;this.GNg=b;qf.c(b)||(r=this.jLk(b));qf.c(r)||(this.LLf=!0);if(h){this.root.Ewk(this.iu);if(qf.c(r)||!r.hasItems())return this.Mra(),!1;this.WNi();this.VNi()}this.dMn(r);return!0}$wi(){}jLk(b){b=Id.Builder.Vrh(b);if(!qf.c(b)){const h=new fi.a;h.Cnh=!0;h.parentId=this.control.id;let r;r=Object(nb.a)(hf.a,this.control);return this.root.rN.PVa(b,h,r)}return null}dMn(b){qf.c(b)||
(qf.c(this.menu)||this.menu.dispose(),this.menu=b,this.$wi())}WNi(){const b=this.menu.parent;b?(b.CLc=!0,b.removeChild(this.menu.id),b.CLc=!1):v.ULS.sendTraceTag(572330335,207,10,"Parent not found for the Menu component {0}",this.menu.id)}onKeyDown(b){let h=!1;qf.c(b.Ib)||qf.c(b.Ib.rawEvent)||Object(nb.a)(im.a,this.mk)||!b.Ib.rawEvent.altKey||b.Ib.keyCode!==Sys.UI.Key.down||(this.rw(b.Af,1,b.Ib),h=!0);h||(h=super.onKeyDown(b));return h}XB(b){this.oYe();2===b.gg&&b.paa!==Sys.UI.MouseButton.leftButton||
this.rw(b.Af,b.gg,b.Ib);b.Ib.preventDefault();return!1}$jf(b){if(!this.hH||!this.hH.inKeytipMode||!this.iu.lyi)return!1;this.iu.lyi(this.mk,b);return!0}static gKk(){const b=jg.a.createElement("iframe");b.style.position="absolute";b.style.visibility="hidden";b.style.borderWidth="0px";return b}}Object(n.a)(sh,"MenuLauncherBehavior",Oj,[734,715]);var Sk=d(902);class Vf extends sh{constructor(b){super(b)}get Js(){return this.GEc.properties}get GEc(){return this.control}get wKa(){return this.GEc.wKa}VH(){rj.a.instance.mb(jb.a.pointerDown,
this.wKa.zm,Object(u.a)(this,this.XB,"onPointerDown"));rc.KeyInputManager.instance.mb(jb.a.li,this.wKa.zm,Object(u.a)(this,this.onKeyDown,"onKeyDown"));rc.KeyInputManager.instance.mb(jb.a.oh,this.wKa.zm,Object(u.a)(this,this.ex,"onKeyUp"))}yl(){const b=this.Nd[Sk.a.SelectedItemId];if(0<(this.Ht(this.Js.Command,this.Js.QueryCommand,this.Nd)&2)){const h=this.Nd[Sk.a.SelectedItemId];qf.c(h)||b===h||this.GEc.BZc(h)||(this.Nd[Sk.a.SelectedItemId]=null)}}}Object(n.a)(Vf,"DropDownBehavior",sh,[]);var Pk=
d(543),oj=d(698);class vi extends Vf{constructor(b){super(b);this.bSa=null;this.Hze=this.mqb=this.Pxa=!1;this.ttc=null;this.rtc=-1}get F1(){return this.control}get vP(){return this.F1.vP}get GG(){return this.F1.GG}get IOd(){return this.Nd[Pk.a.IsFreeForm]}set IOd(b){this.Nd[Pk.a.IsFreeForm]=b}VH(b){rj.a.instance.mb(jb.a.pointerDown,b.zm,Object(u.a)(this,this.XB,"onPointerDown"));const h=b.Tq;xc.a.instance.mb(jb.a.focus,h,Object(u.a)(this,this.kib,"onInputFocus"));xc.a.instance.mb(jb.a.blur,h,Object(u.a)(this,
this.Hua,"onInputBlur"));rc.KeyInputManager.instance.mb(jb.a.li,h,Object(u.a)(this,this.sTm,"onInputKeyDown"));rc.KeyInputManager.instance.mb(jb.a.Ft,h,Object(u.a)(this,this.tTm,"onInputKeyPress"));gf.a.instance.mb(jb.a.raa,h,Object(u.a)(this,this.UGf,"onInputMouseUp"));rj.a.instance.mb(jb.a.pointerDown,h,Object(u.a)(this,this.vTm,"onInputPointerDown"));rj.a.instance.mb(jb.a.pointerDown,b.ECh,Object(u.a)(this,this.sHf,"onMenuButtonPointerDown"))}yl(){0<(this.Ht(this.GG.Command,this.GG.QueryCommand,
this.Nd)&2)&&(this.mqb||this.cjj(),this.Aio())}$wi(){this.F1.menuItems=null;var b;var h=b=null;if(!qf.c(this.menu)){this.l6d();for(let z of this.menu.children)for(let R of z.children)if(Object(nb.a)(im.a,R)){var r=R;r=r.control;Object(nb.a)(718,r)&&(b=r,b=b.Gh.MenuItemId);Object(nb.a)(708,r)&&(h=r,h=h.QYa());qf.c(b)||qf.c(h)||(this.F1.menuItems[h]=b,b=h=null)}}}vTm(b){Object(nb.a)(389,this.root)&&2===b.gg&&(this.bSa=Ed.a.bLa(this.control.Zt.ownerDocument),this.control.Zt.focus());return!1}XB(b){this.oYe();
let h=!1;3===b.gg&&(h=super.XB(b),this.l6d());h&&b.Ib.preventDefault();return!1}sHf(b){let h=!1;if(2!==b.gg||b.paa===Sys.UI.MouseButton.leftButton)this.rw(b.Af,b.gg,b.Ib),this.l6d(),h=!0;h&&b.Ib.preventDefault();return!1}sTm(b){let h=!1;if(!qf.c(b.Ib)&&!qf.c(b.Ib.rawEvent)){const r=b.Ib.keyCode;b=b.Ib.rawEvent.shiftKey;jg.a.ur(this.GG.AutoComplete);if(r===Sys.UI.Key.enter)this.zS(),this.vUf(),Object(nb.a)(oj.Ribbon,this.root)&&this.root.oZ(),h=!0;else if(r===Sys.UI.Key.tab){if(this.zS(),this.vUf(),
Object(nb.a)(oj.Ribbon,this.root)&&(h=this.root.xee(this.mk.Kc,!b)),Object(nb.a)(389,this.root))return!0}else r===Sys.UI.Key.backspace||r===Sys.UI.Key.del?this.control.enabled?(this.DVe(),this.ttc=null):h=!0:r===Sys.UI.Key.esc?(this.AUf(),this.vUf(),Object(nb.a)(oj.Ribbon,this.root)&&this.root.oZ(),h=!0):r===Sys.UI.Key.down&&(this.OZ(1),this.l6d(),h=!0)}return h}tTm(b){if(!this.control.enabled)return!0;!qf.c(b.Ib)&&b.Ib.charCode&&this.QRk();return!1}UGf(){return this.Pxa?!1:this.Pxa=!0}J4k(){this.rtc=
-1;const b=this.vP.Tq,h=b.value,r=this.msl(h);if(r){b.value=r.key;if(b.setSelectionRange)b.setSelectionRange(h.length,b.value.length);else if(b.createTextRange){const z=b.createTextRange();z.moveStart("character",h.length);z.moveEnd("character",b.value.length);z.select()}this.ttc=r.value}else this.ttc=null}msl(b){const h=this.F1.menuItems;for(let r in h){const z={key:r,value:h[r]};if(z.key.toLowerCase().startsWith(b.toLowerCase()))return z}return null}QRk(){jg.a.ur(this.GG.AutoComplete)&&-1===this.rtc&&
(this.Hze&&(this.aVc(0),this.Hze=!1),this.rtc=window.setTimeout(Object(u.a)(this,this.J4k,"executeAutoComplete"),this.F1.mgk))}DVe(){jg.a.ur(this.GG.AutoComplete)&&(this.rtc=jg.a.swb(this.rtc))}kib(b){if(this.nK)return this.menu.setFocus(0),!0;Object(nb.a)(389,this.root)&&(ve.FocusManager.instance().fC("ribbon"),this.root.SKc=!1);this.onFocus(b);this.mqb=!0;jg.a.Pf(this.vP.zm,"cui-cb-focus");jg.a.ur(this.GG.PopulateDynamically)&&(this.Hze=!0);Ed.a.xZc(this.vP.Tq);qf.c(this.menu)||this.menu.km();return this.Pxa=
!1}Hua(){this.mqb=!1;this.zS();jg.a.Lu(this.vP.zm,"cui-cb-focus");return!1}vUf(){Object(nb.a)(389,this.root)&&(void 0!==this.bSa&&null!==this.bSa&&t.AFrameworkApplication.ua.RYc(this.bSa,2),this.bSa=null)}zS(){if(this.control.enabled){this.DVe();var b=this.vP.Tq;if(void 0===this.Nd[Pk.a.Value]||null===this.Nd[Pk.a.Value]||b.value!==this.Nd[Pk.a.Value].toString())if(this.F1.BZc(this.ttc))this.IOd=!1,this.Nd[Pk.a.Value]=b.value,b={["IsFreeForm"]:!1,["CommandValueId"]:this.F1.GZc.Rzb(),["MenuItemId"]:this.F1.GZc.Gh.MenuItemId},
this.root.executeCommand(this.GG.Command,b,this.mk,0,!1);else{if(!jg.a.ur(this.GG.AutoComplete)){var h=this.F1.menuItems[b.value];if(!qf.b(h)&&this.F1.BZc(h)){this.IOd=!1;this.Nd[Pk.a.Value]=b.value;b={["IsFreeForm"]:!1,["CommandValueId"]:this.F1.GZc.Rzb(),["MenuItemId"]:h};this.root.executeCommand(this.GG.Command,b,this.mk,0,!1);return}}h=!qf.b(b.value)&&""!==B.a.ova(b.value);this.F1.Wah&&h?(this.IOd=!0,this.Nd[Pk.a.Value]=b.value,this.root.executeCommand(this.GG.Command,{["IsFreeForm"]:!0,["Value"]:b.value},
this.mk,0,!1)):this.AUf()}}else this.AUf()}AUf(){this.DVe();this.ttc=null;this.cjj()}cjj(){const b=this.Nd[Pk.a.Value]||"";b!==this.vP.Tq.value&&(this.vP.Tq.value=b);this.F1.BZc(this.F1.menuItems[b])}Aio(){const b=this.Nd[Pk.a.FontStyle]||"normal";b!==this.vP.Tq.style.fontStyle&&(this.vP.Tq.style.fontStyle=b)}l6d(){this.control.Zt&&this.menu&&this.control.Zt.setAttribute(vf.a.deh,this.menu.id)}}Object(n.a)(vi,"ComboBoxBehavior",Vf,[]);class kj extends sh{constructor(b){super(b)}get Gwd(){return this.control}HIc(){let b=
0;this.menu&&this.menu.Kc&&2===this.menu.horizontalAlignment&&(b=this.menu.Kc.clientWidth);return new Sys.UI.Bounds(this.Gwd.x-b,this.Gwd.y,this.Gwd.awf,this.Gwd.$vf)}}Object(n.a)(kj,"ContextMenuLauncherBehavior",sh,[]);class Vl extends sh{constructor(b){super(b)}get rzd(){return this.control}HIc(){return new Sys.UI.Bounds(this.rzd.x,this.rzd.y,this.rzd.awf,this.rzd.$vf)}}Object(n.a)(Vl,"DialogMenuLauncherBehavior",sh,[]);var lh=d(617);class Yg extends sh{constructor(b){super(b);this.Kze=!1;this.aVj=
!jg.a.dfa(this.Js.ShouldRefreshWhenDropped)}get KAa(){return this.control}get Js(){return this.control.Gh}VH(b){b=b.zm;qf.c(b)||(xc.a.instance.mb(jb.a.focus,b,Object(u.a)(this,this.onFocus,"onFocus")),xc.a.instance.mb(jb.a.blur,b,Object(u.a)(this,this.onBlur,"onBlur")),rj.a.instance.mb(jb.a.pointerOver,b,Object(u.a)(this,this.vX,"onPointerOver")),rc.KeyInputManager.instance.mb(jb.a.li,b,Object(u.a)(this,this.onKeyDown,"onKeyDown")),rc.KeyInputManager.instance.mb(jb.a.oh,b,Object(u.a)(this,this.ex,
"onKeyUp")),rj.a.instance.mb(jb.a.pointerDown,b,Object(u.a)(this,this.XB,"onPointerDown")))}yl(){qf.c(this.control.Gh.Command)||(this.KAa.nK&&!this.aVj?this.Kze=!0:(0<(this.Ht(this.Js.Command,this.Js.QueryCommand,this.Nd)&2)&&this.p4a()&&this.EQa(),jg.a.ur(this.Js.RefreshableMenu)&&this.nK&&this.menu.p5m()))}EQa(){this.xio();this.uha();this.kjo();this.KAa.pmf=this.Nd[lh.a.ImageIsVisible]}xio(){const b=jg.a.Eoa(this.Nd[lh.a.LabelText],this.Js.LabelText),h=this.Nd[lh.a.LabelTextUserGeneratedPlaceholderReplacements];
if(this.control.labelText!==b||this.Js.LabelTextUserGeneratedPlaceholderReplacements!==h)this.gE.medium&&this.yio(this.gE.medium.JN,b,h),this.root.I0a=!0,this.control.labelText=b,this.Js.LabelTextUserGeneratedPlaceholderReplacements=h}yio(b,h,r){const z=b.lastChild;jg.a.wYi(b,h+" ",r);h=qf.c(z);v.ULS.sendTraceTag(38535884,207,50,"FlyoutAnchorBehaviorUpdate.FlyoutLabelTextDom: arrow type: {0}",h?"":z.nodeType.toString());h||b.appendChild(z)}kjo(){const b=this.Nd[lh.a.ImageBackColor];this.gE.forEach(h=>
{Yg.Ick(h.KP,b)})}OZ(b){"faPrint"===this.control.id&&"jewelWordEditor"===this.control.root.id&&(t.AFrameworkApplication.naa("Microsoft.Office.Web.SessionSettings.IWacWordPrintToWebSettings"),t.AFrameworkApplication.ya.processAction(ab.a.xzd,2));"faRemix"!==this.control.id&&"faTransform"!==this.control.id&&"faPublish"!==this.control.id||"jewelWordEditor"!==this.control.root.id||t.AFrameworkApplication.ya.processAction(ab.a.xzd,2);Object(nb.a)(im.a,this.mk)&&(this.nK||this.wXe(!0),this.control.enabled&&
this.HX());super.OZ(b)}Mra(){super.Mra();this.Kze&&(this.Kze=!1,this.yl())}vX(b){return this.control.LDb()?(this.KAa.nK?(this.root.hkh(),jg.a.Pf(this.KAa.xEb,Zm.MenuLauncher.YRc),this.KAa.$da=this.control.Zt):(super.vX(b),this.rw(b.Af,b.gg,b.Ib)),!1):super.vX(b)}onKeyDown(b){let h=!1;if(!qf.c(b.Ib)&&!qf.c(b.Ib.rawEvent)){if(Object(nb.a)(im.a,this.mk)){const r=b.Ib.rawEvent,z=b.Ib.keyCode,R=0===this.root.C_;r.shiftKey||r.ctrlKey||!(z===Sys.UI.Key.right&&R||z===Sys.UI.Key.left&&!R)||(h=this.$jf(b),
h||(this.rw(b.Af,1,b.Ib),h=!0))}h||(h=super.onKeyDown(b))}return h}static Ick(b,h){qf.c(b)||qf.c(h)||b.style.backgroundColor===h||(b.style.backgroundColor=h)}}Object(n.a)(Yg,"FlyoutAnchorBehavior",sh,[]);var Fi=d(932);class Zj extends Oj{constructor(b){super(b)}get $1b(){return this.control}get properties(){return this.$1b.properties}get Dda(){return this.$1b.Dda}VH(b){b=b.Fyb;xc.a.instance.mb(jb.a.focus,b,Object(u.a)(this,this.onFocus,"onFocus"));xc.a.instance.mb(jb.a.blur,b,Object(u.a)(this,this.onBlur,
"onBlur"));rj.a.instance.mb(jb.a.pointerOver,b,Object(u.a)(this,this.vX,"onPointerOver"));rj.a.instance.mb(jb.a.pointerOut,b,Object(u.a)(this,this.gO,"onPointerOut"));rc.KeyInputManager.instance.mb(jb.a.li,b,Object(u.a)(this,this.onKeyDown,"onKeyDown"));rc.KeyInputManager.instance.mb(jb.a.oh,b,Object(u.a)(this,this.ex,"onKeyUp"));rj.a.instance.mb(jb.a.pointerDown,b,Object(u.a)(this,this.XB,"onPointerDown"));rj.a.instance.mb(jb.a.fM,b,Object(u.a)(this,this.Iua,"onPointerUp"));sj.a.instance.mb(jb.a.xO,
b,Object(u.a)(this,this.wib,"onTouchMove"));sj.a.instance.mb(jb.a.bJ,b,Object(u.a)(this,this.iDa,"onTouchEnd"))}yl(){const b=this.Nd[Fi.a.On],h=this.Nd[Fi.a.IsRtl];this.Mij();if(0<(this.Ht(this.properties.Command,this.properties.QueryCommand,this.Nd)&2)){var r=!qf.c(this.Nd[Fi.a.InnerHTML])||!qf.c(this.properties.InnerHTML),z=!qf.c(this.properties.Image);r||z||(this.control.enabled=!1);z=this.Dda.Fyb;if(!qf.c(z)){if(r){r=jg.a.Eoa(this.Nd[Fi.a.InnerHTML],this.properties.InnerHTML);if(null===z.innerHTML||
null===r||B.a.mh(z.innerHTML)!==B.a.mh(r))z.innerHTML=r;""===r&&(this.control.enabled=!1)}r=z.title;const R=jg.a.Eoa(this.Nd[Fi.a.Alt],this.properties.Alt);R===r||this.control.v_f||(z.title=R)}z=this.Nd[Fi.a.IsRtl];b===this.Nd[Fi.a.On]&&h===z||this.control.AGb()}}Mij(){const b=this.Nd;b[Fi.a.CommandValueId]=this.control.Rzb();b.MenuItemId=this.control.Gh.MenuItemId;b.SourceControlId=this.properties.Id}rw(b,h,r){if((b=this.mk)&&this.control.enabled){const z=this.root;if(t.AFrameworkApplication.K&&
t.AFrameworkApplication.K.$("ExcelBorderMenuCompactionEnabled")&&b.sOc()&&this.hH){const R=z.UB[this.hH.joa];R?R.nPa(this.$1b):v.ULS.sendTraceTag(41034837,207,15,"GalleryButtonBehavior.DoDefaultAction: Did not get Menulauncher for the menu item.")}this.Mij();this.Nd[Fi.a.On]||(this.Nd[Fi.a.On]=!0,this.control.AGb());"Menu"===b.NS&&jg.a.Lu(this.Dda.zm,"cui-gallerybutton-focused");z.executeCommand(this.properties.Command,this.Nd,b,h,!0,null,this.Jea(r))}}onFocus(b){super.onFocus(b);jg.a.Pf(this.Dda.zm,
"cui-gallerybutton-focused");return!1}onBlur(b){super.onBlur(b);jg.a.Lu(this.Dda.zm,"cui-gallerybutton-focused");return!1}}Object(n.a)(Zj,"GalleryButtonBehavior",Oj,[]);var Um=d(1105),kb=d(1372),nc=d(650);class Qc extends Oj{constructor(b){super(b);this.lTa=-1}get w5b(){return this.control}get properties(){return this.w5b.Gh}get qBc(){return this.w5b.qBc}get Llf(){var b=null;if(this.mk&&(b=this.mk.parent,!Object(nb.a)(nc.a,b)))throw Error.create("InsertTable must live inside of a MenuSection.");return b}get iCb(){return this.w5b.NMd.iCb}get jUc(){return this.w5b.NMd.jUc}rw(b,
h,r){if(this.control.enabled){b=this.Qef(this.k2b(b));const z=this.CEd(b);this.qBc[kb.a.Rows]=this.VHd(b)+1;this.qBc[kb.a.Columns]=z+1;this.root.executeCommand(this.properties.Command,this.qBc,this.mk,h,!0,null,this.Jea(r))}}VH(b){var h=b.zm;const r=b.Vkh;b=b.cells;rj.a.instance.mb(jb.a.pointerOut,h,Object(u.a)(this,this.VQm,"onControlPointerOut"));sj.a.instance.mb(jb.a.xO,h,Object(u.a)(this,this.XQm,"onControlTouchMove"));sj.a.instance.mb(jb.a.bJ,h,Object(u.a)(this,this.WQm,"onControlTouchEnd"));
for(h=0;h<b.length;++h)this.Kfk(r[h],b[h])}Kfk(b,h){xc.a.instance.mb(jb.a.focus,b,Object(u.a)(this,this.JFf,"onCellFocus"));rj.a.instance.mb(jb.a.pointerOver,h,Object(u.a)(this,this.KFf,"onCellPointerOver"));rj.a.instance.mb(jb.a.fM,h,Object(u.a)(this,this.LFf,"onCellPointerUp"));rc.KeyInputManager.instance.mb(jb.a.li,h,Object(u.a)(this,this.onKeyDown,"onKeyDown"));rc.KeyInputManager.instance.mb(jb.a.oh,h,Object(u.a)(this,this.ex,"onKeyUp"));sj.a.instance.mb(jb.a.yO,h,Object(u.a)(this,this.SPm,"onCellTouchStart"))}Qef(b){return parseInt(b.id.substr(this.w5b.id.length+
1))}S2h(b){this.R2h(this.Qef(b))}VHd(b){return Math.floor(b/Um.a.TSc)}CEd(b){return b%Um.a.TSc}R2h(b){if(b!==this.lTa){var h=this.CEd(b),r=this.VHd(b),z=-1;let R=-1;-1!==this.lTa&&(z=this.VHd(this.lTa),R=this.CEd(this.lTa));for(;z!==r||R!==h;)z<r?this.N_i(++z,R,!0):z>r?(this.N_i(z,R,!1),z--):R<h?this.kYi(++R,z,!0):R>h&&(this.kYi(R,z,!1),R--);this.Llf?this.Llf.B0i(this.qNh(r+1,h+1)):(r=(h=this.control.AYe)&&0<h.length?h[0]:null,z=this.mk,v.ULS.sendTraceTag(19748692,207,15,"Insert table menu is NULL. {0}",
{["CtrlComps"]:!!h,["FirstComp"]:!!r,["FirstCompPar"]:!!r&&!!r.parent,["DispComp"]:!!z,["DispCompPar"]:!!z&&!!z.parent}));this.lTa=b}}N_i(b,h,r){for(let z=0;z<=h;z++)this.bYi(b,z,r)}kYi(b,h,r){for(let z=0;z<=h;z++)this.bYi(z,b,r)}bYi(b,h,r){h=b*Um.a.TSc+h;b=this.iCb[h];h=this.jUc[h];r?(b.className="cui-it-activeCell",h.className="cui-it-activeCellOuter"):(b.className="cui-it-inactiveCell",h.className="cui-it-inactiveCellOuter")}LFf(b){this.rw(b.Af,b.gg,b.Ib);return!0}k2b(b){for(;b.hasChildNodes();)b=
b.childNodes[0];return qf.c(b.tagName)||"a"!==b.tagName.toLowerCase()?null:b.parentNode.parentNode}C0i(b){const h=this.Qef(b);b.childNodes[0].childNodes[0].title=this.qNh(this.VHd(h)+1,this.CEd(h)+1)}qNh(b,h){let r=this.properties.Alt;qf.c(r)&&(r=this.properties.MenuSectionTitle);return r=String.format(r,h.toString(),b.toString())}vcc(){if(this.mk){for(var b=0;b<Um.a.j$b;b++)this.iCb[b].className="cui-it-inactiveCell",this.jUc[b].className="cui-it-inactiveCellOuter";this.lTa=-1;b=this.properties.MenuSectionInitialTitle;
qf.c(b)&&(b="");this.Llf.B0i(b)}}KFf(b){this.control.enabled&&(b=this.k2b(b.Af),this.h_c(b),this.X4e(b));return!1}X4e(b){this.C0i(b);this.S2h(b)}JFf(b){if(!this.control.enabled)return!1;b=this.k2b(b.Af);this.C0i(b);this.S2h(b);return!1}VQm(b){Ed.a.Isf(this.w5b.NMd.zm,b.clientPoint)||this.vcc();return!1}SPm(b){if(!this.control.enabled)return!1;b=this.k2b(b.Af);this.X4e(b);return!0}XQm(b){if(!this.control.enabled)return!1;b=Ed.a.sFd(b.clientPoint);if(!b||"table"===b.tagName.toLowerCase())return!1;(b=
this.k2b(b))?this.X4e(b):this.vcc();return!0}WQm(b){if(!this.control.enabled)return!1;var h=Ed.a.sFd(b.clientPoint);if(!h||"table"===h.tagName.toLowerCase())return this.vcc(),!0;(h=this.k2b(h))?this.rw(h,3,b.Ib):this.vcc();return!0}TJ(b){b=Gm.Control.i$e(this.lTa,Um.a.TSc,Um.a.j$b,b);if(b!==this.lTa)return this.iCb[b].firstChild.focus(),this.R2h(b),!0;this.vcc();this.lTa=-1;return!1}HX(){const b=this.iCb[0];if(qf.c(b))return!1;b.firstChild.focus();return!0}h_c(b){if(qf.c(b))return!1;b.firstChild.firstChild.focus();
return!0}Sma(){this.vcc()}}Object(n.a)(Qc,"InsertTableBehavior",Oj,[]);class rd extends sh{constructor(b){super(b)}yl(){this.control.enabled=!!this.menu}rw(b,h,r){t.AFrameworkApplication.ya.Xb(ab.a.eNa,2,h,this.Jea(r))}}Object(n.a)(rd,"JewelMenuLauncherBehavior",sh,[]);var fe=d(1027);class df extends Oj{constructor(b){super(b)}get properties(){return this.control.Gh}yl(){0<(this.Ht(this.properties.Command,this.properties.QueryCommand,this.Nd)&2)&&this.p4a()&&this.EQa()}EQa(){this.zmo();this.uha();
this.jMb()}zmo(){const b=this.control.labelText;let h=this.Nd[fe.a.Value];qf.c(h)&&(h=this.properties.LabelText,qf.c(h)&&(h=""));h!==b&&this.T6d(h)}VH(b){b=b.zm;qf.c(b)||(rj.a.instance.mb(jb.a.pointerDown,b,Object(u.a)(this,this.XB,"onPointerDown")),rj.a.instance.mb(jb.a.pointerOver,b,Object(u.a)(this,this.vX,"onPointerOver")),rj.a.instance.mb(jb.a.pointerOut,b,Object(u.a)(this,this.gO,"onPointerOut")))}}Object(n.a)(df,"LabelBehavior",Oj,[]);var wf=d(857),ea=d(217),Qa=d(319);class qb extends sh{constructor(b){super(b);
this.Ose=this.zke=!1;this.cRb=this.yNb=null;if(this.CRb=t.AFrameworkApplication.K.$("TellMeRedesignIsEnabled"))this.yNb=this.It.Bga.LightImage16by16Class,this.cRb=this.It.Bga.DarkImage16by16Class}get It(){return this.control}$Vd(b,h,r,z){h&&(this.It.$da=r,t.AFrameworkApplication.ua.lkb());if(Object(nb.a)(ea.a,b)&&z){r=new wf.a;r.CommandLocation=this.root.l7;r.InvocationMethod=0;const R={};(b=b.control)&&b.Gh&&(R.CommandId=b.Gh.Command,R.ControlId=b.Gh.Id,R.CloseAllMenus=h,b.hH&&b.hH.parent&&b.hH.parent.id&&
(R.ParentControlId=b.hH.parent.id.split("-")[0]),this.root.vE&&this.root.vE.MKa(z,R,r))}}Mra(){this.It.$da||(this.It.$da=this.It.Ux);!this.It.pJm&&this.CRb&&(jg.a.Lu(this.It.Ux,"cui-sb-focus"),jg.a.Lu(this.It.N_,"cui-sb-focus"),jg.a.Lu(this.It.xva,this.yNb),jg.a.Pf(this.It.xva,this.cRb));this.zke=!0;super.Mra();this.zke=!1;this.HPf()}get x3i(){return!this.It.qOa}KXd(){this.It.KXd()}A2d(){this.Ose||this.zke||(this.Ose=!0,this.It.raiseEvent(Qa.a.TZa,null))}HPf(){this.nK||this.It.Mnf||(this.Ose=!1,this.It.raiseEvent(Qa.a.zCb,
null))}RGf(b){jg.a.Lu(this.It.Ux,"cui-sb-focus");jg.a.Lu(this.It.N_,"cui-sb-focus");this.CRb&&!this.It.nK&&(jg.a.Lu(this.It.xva,this.yNb),jg.a.Pf(this.It.xva,this.cRb));this.It.raiseEvent(Qa.a.blur,b);this.HPf();this.It.$da=this.It.Ux;return!1}SGf(b){jg.a.Pf(this.It.Ux,"cui-sb-focus");jg.a.Pf(this.It.N_,"cui-sb-focus");this.CRb&&(jg.a.Lu(this.It.xva,this.cRb),jg.a.Pf(this.It.xva,this.yNb));this.It.raiseEvent(Qa.a.focus,b);this.A2d();return!1}tIf(){this.CRb&&(jg.a.Pf(this.It.N_,"cui-sb-hover"),jg.a.Pf(this.It.Ux,
"cui-sb-hover"),jg.a.Lu(this.It.xva,this.cRb),jg.a.Pf(this.It.xva,this.yNb));return!1}sIf(){this.CRb&&(jg.a.Lu(this.It.N_,"cui-sb-hover"),jg.a.Lu(this.It.Ux,"cui-sb-hover"),this.It.nK||this.It.Mnf||(jg.a.Lu(this.It.xva,this.yNb),jg.a.Pf(this.It.xva,this.cRb)));return!1}}Object(n.a)(qb,"SearchBoxBehavior",sh,[716,715]);class bc{}bc.Value="value";bc.MinValue="MinValue";bc.MaxValue="MaxValue";bc.Text="Text";Object(n.a)(bc,"SliderCommandProperties",null,[]);class Xb extends Oj{constructor(b){super(b)}get w1f(){return this.control}get A3(){return this.w1f.A3}get properties(){return this.control.Gh}initialize(){}rw(){}VH(b){b=
b.Tq;xc.a.instance.mb(jb.a.focus,b,Object(u.a)(this,this.onFocus,"onFocus"));xc.a.instance.mb(jb.a.blur,b,Object(u.a)(this,this.onBlur,"onBlur"));xc.a.instance.mb(jb.a.change,b,Object(u.a)(this,this.uaa,"onChange"));xc.a.instance.mb(jb.a.input,b,Object(u.a)(this,this.uaa,"onChange"))}onFocus(b){this.A3.zm&&Sys.UI.DomElement.addCssClass(this.A3.zm,"cui-sldr-onfocus");return super.onFocus(b)}onBlur(b){this.A3.zm&&Sys.UI.DomElement.removeCssClass(this.A3.zm,"cui-sldr-onfocus");return super.onBlur(b)}uaa(){this.yBk(this.A3.Tq.value);
return!0}yBk(b){this.Nd[bc.Value]=parseFloat(b);this.root.executeCommand(this.properties.Command,this.Nd,this.mk,0,!1)}yl(){const b=this.Nd[bc.Value],h=this.Nd[bc.MaxValue],r=this.Nd[bc.Text];var z=this.Ht(this.properties.Command,this.properties.QueryCommand,this.Nd);this.A3&&this.A3.Tq&&(this.A3.Tq.disabled=!this.control.enabled);if(0<(z&2)){z=this.Nd[bc.Value];const R=this.Nd[bc.MaxValue],ba=this.Nd[bc.Text];(R!==h||z!==b||r!==ba)&&this.A3&&this.A3.Tq&&(this.A3.Tq.setAttribute(vf.a.rsd,String.format("{0}",
R)),this.A3.Tq.setAttribute("max",String.format("{0}",R)),this.A3.Tq.value=z,this.A3.JN.innerText=this.Nd[bc.Text])}}}Object(n.a)(Xb,"SliderBehavior",Oj,[]);var Cc=d(1365);class kd extends Oj{constructor(b){super(b);this.Sgd=0;this.p$a=null;this.oed=!1;this.h5g=null;this.YHe=!1;this.akd=this.wid=-1;this.Pxa=!1}get spinner(){return this.control}get WF(){return this.spinner.WF}get properties(){return this.control.Gh}initialize(){const b=this.spinner.Y9f;this.h5g=this.veo(b);this.Sgd=b[0].min;this.p$a=
b[0];this.oed=!1}rw(){}VH(b){const h=b.Tq,r=b.L0b;b=b.QEc;xc.a.instance.mb(jb.a.focus,h,Object(u.a)(this,this.onFocus,"onFocus"));xc.a.instance.mb(jb.a.blur,h,Object(u.a)(this,this.onBlur,"onBlur"));rc.KeyInputManager.instance.mb(jb.a.li,h,Object(u.a)(this,this.onKeyDown,"onKeyDown"));rc.KeyInputManager.instance.mb(jb.a.Ft,h,Object(u.a)(this,this.KF,"onKeyPress"));rc.KeyInputManager.instance.mb(jb.a.oh,h,Object(u.a)(this,this.ex,"onKeyUp"));xc.a.instance.mb(jb.a.change,h,Object(u.a)(this,this.uaa,
"onChange"));gf.a.instance.mb(jb.a.raa,h,Object(u.a)(this,this.UGf,"onInputMouseUp"));rj.a.instance.mb(jb.a.pointerDown,r,Object(u.a)(this,this.Svi,"onArrowPointerDown"));rj.a.instance.mb(jb.a.pointerDown,b,Object(u.a)(this,this.Svi,"onArrowPointerDown"));rj.a.instance.mb(jb.a.fM,r,Object(u.a)(this,this.Tvi,"onArrowPointerUp"));rj.a.instance.mb(jb.a.fM,b,Object(u.a)(this,this.Tvi,"onArrowPointerUp"));sj.a.instance.mb(jb.a.xO,r,Object(u.a)(this,this.Vvi,"onArrowTouchMove"));sj.a.instance.mb(jb.a.xO,
b,Object(u.a)(this,this.Vvi,"onArrowTouchMove"));sj.a.instance.mb(jb.a.bJ,r,Object(u.a)(this,this.Uvi,"onArrowTouchEnd"));sj.a.instance.mb(jb.a.bJ,b,Object(u.a)(this,this.Uvi,"onArrowTouchEnd"))}onFocus(b){super.onFocus(b);jg.a.Pf(this.WF.zm,"cui-spn-focus");this.control.enabled&&Ed.a.xZc(this.WF.Tq);return this.Pxa=!1}onBlur(b){super.onBlur(b);jg.a.Lu(this.WF.zm,"cui-spn-focus");return!1}onKeyDown(b){let h=!1;if(!qf.c(b.Ib)&&!qf.c(b.Ib.rawEvent)){const r=b.Ib.keyCode,z=b.Ib.rawEvent.shiftKey;if(r===
Sys.UI.Key.up||r===Sys.UI.Key.down)this.root.Upf(this.control)||this.V7i(r===Sys.UI.Key.up,b.gg),h=!0;else if(r===Sys.UI.Key.enter)this.zS(),Object(nb.a)(oj.Ribbon,this.root)&&this.root.oZ(),h=!0;else if(r===Sys.UI.Key.tab)this.zS(),Object(nb.a)(oj.Ribbon,this.root)&&(h=this.root.xee(this.mk.Kc,!z));else if(r===Sys.UI.Key.esc)this.xcc(),Object(nb.a)(oj.Ribbon,this.root)&&this.root.oZ(),h=!0;else if(r===Sys.UI.Key.backspace||r===Sys.UI.Key.del)h=!this.control.enabled}return h}KF(){return!this.control.enabled}ex(){this.BQk();
return!1}uaa(){this.zS();return!1}UGf(){return this.Pxa?!1:this.Pxa=!0}Svi(b){var h=!1;let r=!0;2===b.gg&&(r=b.paa===Sys.UI.MouseButton.leftButton);r&&(h=b.Af,this.V7i(h===this.WF.L0b||h===this.WF.PCh||h===this.WF.OCh,b.gg),h=!0);return h}Tvi(b){return this.fsa(b)}Vvi(b){return this.wWd(b)}Uvi(b){return this.fsa(b)}v0l(b){if(this.control.enabled){var h=!1;if(!this.oed){var r=this.zvl(b);r=b?r+this.p$a.step:r-this.p$a.step;r=Math.min(r,this.p$a.max);r=Math.max(r,this.p$a.min);r!==this.Sgd&&(this.nYe(r,
this.p$a),this.root.executeCommand(this.properties.Command,this.Nd,this.mk,0,!1),h=!0)}h||(h=this.properties.SpinCommand,r=this.Nd,r.Increment=b,qf.c(h)||this.root.executeCommand(h,r,this.mk,0,!1))}}zvl(b){const h=Math.pow(10,t.AFrameworkApplication.numberFormat.gWd),r=Math.round(this.p$a.step*h);let z=Math.round(this.Sgd*h)/r;z=b?Math.floor(z):Math.ceil(z);return z*r/h}V7i(b,h){if(this.control.enabled){this.zS();const r=b?this.WF.L0b:this.WF.QEc;switch(h){case 2:case 3:this.YHe=b;this.iqd(r);break;
case 1:this.YHe=b,this.y0j(r)}}}y8i(){this.ikh();this.Prk()}Wxh(){-1===this.wid&&(this.wid=window.setTimeout(Object(u.a)(this,this.Wtn,"repeatSpin"),500))}ikh(){this.wid=jg.a.swb(this.wid)}Wtn(){this.ikh();-1===this.akd&&(this.F9d(),this.akd=window.setInterval(Object(u.a)(this,this.F9d,"spin"),50))}Prk(){this.akd=jg.a.Lrk(this.akd)}F9d(){this.v0l(this.YHe)}y0j(b){this.root.pda(this.control,!1);jg.a.Pf(b,Gm.Control.lqd);this.F9d();this.Wxh()}BQk(){this.root.Y9(this.control,!1);this.y8i();jg.a.Lu(this.WF.L0b,
Gm.Control.lqd);jg.a.Lu(this.WF.QEc,Gm.Control.lqd)}Wdc(b){this.WF.Tq.value!==b&&(this.WF.Tq.value=b)}xcc(){this.Wdc(this.Nd[Cc.a.Text])}AYi(b){this.Wdc(b);this.Nd[Cc.a.Text]=b;this.oed=!0}HIn(b,h,r){this.Wdc(r);this.Nd[Cc.a.Text]=r;this.Nd[Cc.a.Number]=b;this.Nd[Cc.a.UnitType]=h.type;this.Sgd=b;this.p$a=h;this.WF.Tq.setAttribute(vf.a.aSe,r);this.WF.Tq.setAttribute(vf.a.keh,String.format("{0}",h.min));this.WF.Tq.setAttribute(vf.a.rsd,String.format("{0}",h.max));this.oed=!1}uph(b){var h;if(({hMm:h}=
this.Mkm(b)).returnValue)this.AYi(h);else{({number:b,b4a:h}=B.a.FDi(b,this.h5g,t.AFrameworkApplication.numberFormat));let r=this.pce(h);0===h&&qf.c(r)&&(r=this.pce(this.Nd[Cc.a.UnitType]));this.nYe(b,r)}}nYe(b,h){b=this.dEf(b,h);if(isNaN(b)||qf.c(h))this.xcc();else{const r=t.AFrameworkApplication.numberFormat;let z;z=B.a.NAa(b,h.type,r);z=z.replace(6===h.type?r.hWd:r.hLf,"");this.HIn(b,h,z)}}Mkm(b){let h,r=!1;h="";b=b.trim();const z=this.spinner.ikj;if(!qf.c(z))for(let R=0;R<z.length;R++)if(z[R].toLowerCase()===
b.toLowerCase()){h=z[R];r=!0;break}return{returnValue:r,hMm:h}}dEf(b,h){return isNaN(b)||qf.c(h)?Number.NaN:h.dEf(b)}pce(b){let h=null;const r=this.spinner.Y9f;for(let z=0;z<r.length;z++)if(r[z].type===b){h=r[z];break}return h}veo(b){const h=b.length,r=Array(h);for(let z=0;z<h;z++)r[z]=b[z].type;return r}zS(){if(this.control.enabled){const b=this.Nd[Cc.a.Text],h=this.WF.Tq.value;h!==b&&(this.uph(h),this.Nd[Cc.a.Text]!==b&&this.root.executeCommand(this.properties.Command,this.Nd,this.mk,0,!1))}else this.xcc()}yl(){var b=
this.Nd[Cc.a.Text],h=this.Nd[Cc.a.Number];const r=this.Nd[Cc.a.UnitType],z=this.Nd[Cc.a.MaxValue];if(0<(this.Ht(this.properties.Command,this.properties.QueryCommand,this.Nd)&2)){const R=this.Nd[Cc.a.Text],ba=this.Nd[Cc.a.Number],ta=this.Nd[Cc.a.UnitType],Wa=this.Nd[Cc.a.MaxValue];Wa!==z&&(this.pce(ta).max=Wa,this.WF.Tq.setAttribute(vf.a.rsd,String.format("{0}",Wa)));R!==b?""===R?this.AYi(R):this.uph(R):isNaN(ba)||ba===h&&ta===r||this.nYe(ba,this.pce(ta));b=this.WF.zm.title;h=jg.a.Eoa(this.Nd[Cc.a.Alt],
this.properties.Alt);h!==b&&(this.WF.Tq.title=h,this.WF.L0b.title=h,this.WF.QEc.title=h)}}xNe(b){super.xNe(b);b?(this.F9d(),this.Wxh()):this.y8i()}}Object(n.a)(kd,"SpinnerBehavior",Oj,[717,715]);var Vd=d(324),be=d(868);class je extends sh{constructor(b){super(b);this.ASb=!0;this.Inb=!1}get B3(){return this.control}get Js(){return this.B3.properties}VH(b){const h=b.zm,r=b.jcb;b=b.SEc;xc.a.instance.mb(jb.a.focus,h,Object(u.a)(this,this.onFocus,"onFocus"));xc.a.instance.mb(jb.a.blur,h,Object(u.a)(this,
this.onBlur,"onBlur"));rc.KeyInputManager.instance.mb(jb.a.li,h,Object(u.a)(this,this.onKeyDown,"onKeyDown"));rc.KeyInputManager.instance.mb(jb.a.oh,h,Object(u.a)(this,this.ex,"onKeyUp"));X.a.Ys&&16>this.yql()&&(rj.a.instance.mb(jb.a.pointerDown,h,Object(u.a)(this,this.vAi,"onSplitbuttonPointerDownPointerUp")),rj.a.instance.mb(jb.a.fM,h,Object(u.a)(this,this.vAi,"onSplitbuttonPointerDownPointerUp")));rj.a.instance.mb(jb.a.pointerOver,r,Object(u.a)(this,this.EPm,"onButtonPointerOver"));rj.a.instance.mb(jb.a.pointerOut,
r,Object(u.a)(this,this.DPm,"onButtonPointerOut"));rj.a.instance.mb(jb.a.pointerDown,r,Object(u.a)(this,this.jwi,"onButtonPointerDown"));rj.a.instance.mb(jb.a.fM,r,Object(u.a)(this,this.kwi,"onButtonPointerUp"));sj.a.instance.mb(jb.a.xO,r,Object(u.a)(this,this.GPm,"onButtonTouchMove"));sj.a.instance.mb(jb.a.bJ,r,Object(u.a)(this,this.FPm,"onButtonTouchEnd"));rj.a.instance.mb(jb.a.pointerDown,b,Object(u.a)(this,this.sHf,"onMenuButtonPointerDown"));rj.a.instance.mb(jb.a.pointerOver,b,Object(u.a)(this,
this.kUm,"onMenuButtonPointerOver"));rj.a.instance.mb(jb.a.pointerOut,b,Object(u.a)(this,this.jUm,"onMenuButtonPointerOut"))}rw(b,h,r){Sys.UI.DomElement.containsCssClass(b,"cui-ctl-a1")?this.Inb&&(this.B3.on=!this.B3.on,b=this.Nd,b.CommandValueId=this.control.Rzb(),this.root.executeCommand(this.Js.Command,b,this.mk,h,!0,null,this.Jea(r))):this.ASb&&super.rw(b,h,r)}ex(b){const h=b.Ib.keyCode;return h===Sys.UI.Key.enter||h===Sys.UI.Key.space?(b=this.Nd,b.CommandValueId=this.control.Rzb(),this.root.executeCommand(this.Js.Command,
b,this.mk,1,!0),!0):super.ex(b)}yl(){const b=this.root.ona(this.Js.Command,this.Js.QueryCommand,this.Nd),h=0<(b&1);let r=!0;r=qf.c(this.Js.CommandMenuOpen)?h:0<(this.root.ona(this.Js.CommandMenuOpen,null,null)&1);if(r!==this.ASb||h!==this.Inb||(r||h)!==this.control.enabled)this.control.enabled=r||h,h!==this.Inb&&this.ORm(h),r!==this.ASb&&this.PRm(r),this.ASb=r,this.Inb=h;if(0<(b&2)){this.uha();const z=jg.a.Eoa(this.Nd[be.a.LabelText],this.Js.LabelText);this.Nd[be.a.ApplyLabelTextToControlOnly]?this.B3.O1b(R=>
{R.zm.title=z;R.jcb.removeAttribute("title");R.SEc.removeAttribute("title")}):this.B3.O1b(R=>{R.jcb.title=z});this.Nd[be.a.EnsureControlRoleIsButton]&&this.B3.O1b(R=>{vf.a.Iq(R.zm,vf.a.Ch,vf.a.t1)});qf.c(this.Nd[be.a.Visible])||this.p4a()&&this.EQa()}this.B3.setState(this.B3.on&&h)}EQa(){this.D8f();this.jMb();this.uha()}PRm(b){this.B3.O1b(h=>{jg.a.kkb(h.SEc,b)});this.JXc();this.ASb=b}ORm(b){this.B3.O1b(h=>{jg.a.kkb(h.jcb,b)});this.JXc();this.Inb=b}JXc(){const b=this.B3.Cdb();qf.c(b)||(jg.a.Lu(b.childNodes[0],
"cui-ctl-split-hovered-primary"),jg.a.Lu(b.childNodes[0],"cui-ctl-split-hovered-secondary"),jg.a.Lu(b.childNodes[1],"cui-ctl-split-hovered-primary"),jg.a.Lu(b.childNodes[1],"cui-ctl-split-hovered-secondary"))}vAi(b){if(0!==Vd.a(b.Ib))return!1;let h=!1;b.eventName===jb.a.pointerDown?h=this.jwi(b):b.eventName===jb.a.fM&&(h=this.kwi(b));return h}jwi(b){let h=!1;const r=b.gg;switch(r){case 3:this.ZVn()?this.rw(this.mk.Kc,r,b.Ib):this.iqd(this.B3.xAh);h=!0;break;case 2:b.paa===Sys.UI.MouseButton.leftButton&&
(this.iqd(this.B3.xAh),h=!0)}h&&b.Ib.preventDefault();return!1}ZVn(){const b=this.mk.NS;return"Small"===b||"Medium"===b||"Menu16"===b||"MenuTellMe"===b}kwi(b){return this.fsa(b)}GPm(b){return this.wWd(b)}FPm(b){return this.fsa(b)}onFocus(b){super.onFocus(b);this.xlf(!0,!0);return!1}onBlur(b){super.onFocus(b);this.JXc();return!1}EPm(){this.control.enabled&&this.Inb&&this.xlf(!0,this.B3.on);return!1}DPm(){this.control.enabled&&this.Inb&&this.JXc();return!1}sHf(b){let h=!1;if(2!==b.gg||b.paa===Sys.UI.MouseButton.leftButton)this.rw(b.Af,
b.gg,b.Ib),h=!0;h&&b.Ib.preventDefault();return!1}kUm(){this.control.enabled&&this.ASb&&this.xlf(this.B3.on,!0);return!1}jUm(){this.JXc();return!1}xlf(b,h){const r=this.control.Cdb();qf.c(r)||(jg.a.Pf(r.childNodes[0],b?"cui-ctl-split-hovered-primary":"cui-ctl-split-hovered-secondary"),jg.a.Pf(r.childNodes[1],h?"cui-ctl-split-hovered-primary":"cui-ctl-split-hovered-secondary"))}yql(){var b=X.a.A0b;return b&&(b=b.split("."),2===b.length)?parseInt(b[0]):0}}Object(n.a)(je,"SplitButtonBehavior",sh,[]);
var Be=d(1371);class Lf extends Oj{constructor(b){super(b);this.mqb=this.Pxa=!1;this.NCj=!!t.AFrameworkApplication.K&&t.AFrameworkApplication.K.$("ExcelTableRenameEnabled")}get textBox(){return this.control}get Aba(){return this.textBox.Aba}get x4f(){return this.textBox.Gh}VH(b){b=b.Tq;xc.a.instance.mb(jb.a.focus,b,Object(u.a)(this,this.onFocus,"onFocus"));xc.a.instance.mb(jb.a.blur,b,Object(u.a)(this,this.onBlur,"onBlur"));rc.KeyInputManager.instance.mb(jb.a.li,b,Object(u.a)(this,this.onKeyDown,
"onKeyDown"));rc.KeyInputManager.instance.mb(jb.a.Ft,b,Object(u.a)(this,this.KF,"onKeyPress"));rc.KeyInputManager.instance.mb(jb.a.oh,b,Object(u.a)(this,this.ex,"onKeyUp"));xc.a.instance.mb(jb.a.change,b,Object(u.a)(this,this.uaa,"onChange"));gf.a.instance.mb(jb.a.raa,b,Object(u.a)(this,this.VNa,"onMouseUp"))}onFocus(b){super.onFocus(b);this.mqb=!0;jg.a.Pf(this.Aba.zm,"cui-tb-focus");this.control.enabled&&Ed.a.xZc(this.Aba.Tq);return this.Pxa=!1}onBlur(b){this.mqb=!1;super.onBlur(b);jg.a.Lu(this.Aba.zm,
"cui-tb-focus");return!1}onKeyDown(b){let h=super.onKeyDown(b);if(!qf.c(b.Ib)&&!qf.c(b.Ib.rawEvent)){const r=b.Ib.keyCode,z=b.Ib.rawEvent.shiftKey;r===Sys.UI.Key.tab?(this.zS(),Object(nb.a)(oj.Ribbon,this.root)&&(h=this.root.xee(this.mk.Kc,!z))):r===Sys.UI.Key.enter?this.NCj&&(this.zS(),Object(nb.a)(oj.Ribbon,this.root)&&this.root.oZ(),h=!0):r===Sys.UI.Key.esc?(this.xcc(),Object(nb.a)(oj.Ribbon,this.root)&&this.root.oZ(),h=!0):r===Sys.UI.Key.backspace||r===Sys.UI.Key.del?h=!this.control.enabled:b.dka&&
(Bf.a.ekh(b.Ib),h=!1)}return h}KF(){return!this.control.enabled}ex(){return!1}uaa(){this.zS();return!1}VNa(){return this.Aba.isEditable?this.Pxa?!1:this.Pxa=!0:(Ed.a.xZc(this.Aba.Tq),!0)}Wdc(b){this.Aba.Tq.value!==b&&(this.Aba.Tq.value=b)}xcc(){this.Wdc(this.Nd[Be.a.Text])}zS(){if(this.control.enabled&&this.Aba.isEditable){const b=this.Aba.Tq.value;b!==this.Nd[Be.a.Text]&&(this.Nd[Be.a.Text]=b,this.root.executeCommand(this.x4f.Command,this.Nd,this.mk,0,!1))}else this.xcc()}yl(){const b=this.Nd[Be.a.Text];
if(0<(this.Ht(this.x4f.Command,this.x4f.QueryCommand,this.Nd)&2)&&!this.mqb){const h=this.Nd[Be.a.Text];h!==b&&this.Wdc(h)}}}Object(n.a)(Lf,"TextBoxBehavior",Oj,[714,715]);var ph=d(423);class ji extends Oj{constructor(b){super(b)}get toggleButton(){return this.control}get properties(){return this.control.Gh}rw(b,h,r){this.control.enabled&&(jg.a.dfa(this.properties.TogglesWhenExecuted)||this.toggle(),this.Nd.CommandValueId=this.toggleButton.Rzb(),this.Nd.MenuItemId=this.toggleButton.Gh.MenuItemId,
this.Nd.SourceControlId=this.control.id,this.root.executeCommand(this.properties.Command,this.Nd,this.mk,h,!jg.a.dfa(this.properties.CloseMenuWhenExecuted),z=>{jg.a.ur(this.properties.UpdateHtmlPostToggle)&&(32===z?this.tbj():this.rbj())},this.Jea(r)))}rbj(){this.Nd[Yf.a.On]=!this.Nd[Yf.a.On]}tbj(){this.toggleButton.setState(this.Nd[Yf.a.On]);(this.toggleButton.mwa&&this.toggleButton.vde||jg.a.ur(this.properties.UpdateHtmlPostToggle))&&this.EQa()}toggle(){this.rbj();jg.a.ur(this.properties.UpdateHtmlPostToggle)||
this.tbj()}onKeyDown(b){const h=super.onKeyDown(b);if(!h&&!qf.c(b.Ib)&&this.hH){const r=b.Ib.keyCode;r!==Sys.UI.Key.enter&&r!==Sys.UI.Key.space||b.Ib.preventDefault()}return h}yl(){qf.c(this.properties.MenuItemId)||(this.Nd.MenuItemId=this.properties.MenuItemId);0<(this.Ht(this.properties.Command,this.properties.QueryCommand,this.Nd)&2)&&this.p4a()&&this.EQa()}EQa(){this.toggleButton.setState(this.Nd[Yf.a.On]);this.Yho(jg.a.Eoa(this.Nd[Yf.a.DisplayMode],""));this.D8f();this.uha();this.Fjo();Yf.a.Alt in
this.Nd&&this.jMb()}Fjo(){const b=this.gE.u8b;if(b&&b.kcb){var h=jg.a.Eoa(this.Nd[Yf.a.Description],this.properties.Description);h!==b.kcb.innerText&&(b.kcb.innerText=h,b.JN&&!Object(nb.a)(ph.Jewel,this.root)&&(h=!qf.b(h),jg.a.K3(b.JN,"UIFontBold",h),jg.a.K3(b.JN,"cui-ctl-mediumlabel-nodescription",!h)))}}VH(b){b=b.zm;xc.a.instance.mb(jb.a.focus,b,Object(u.a)(this,this.onFocus,"onFocus"));xc.a.instance.mb(jb.a.blur,b,Object(u.a)(this,this.onBlur,"onBlur"));rj.a.instance.mb(jb.a.pointerOver,b,Object(u.a)(this,
this.vX,"onPointerOver"));rj.a.instance.mb(jb.a.pointerOut,b,Object(u.a)(this,this.gO,"onPointerOut"));rc.KeyInputManager.instance.mb(jb.a.li,b,Object(u.a)(this,this.onKeyDown,"onKeyDown"));rc.KeyInputManager.instance.mb(jb.a.oh,b,Object(u.a)(this,this.ex,"onKeyUp"));rj.a.instance.mb(jb.a.pointerDown,b,Object(u.a)(this,this.XB,"onPointerDown"));rj.a.instance.mb(jb.a.fM,b,Object(u.a)(this,this.Iua,"onPointerUp"));sf.a.instance.mb(jb.a.click,b,Object(u.a)(this,this.onClick,"onClick"));sj.a.instance.mb(jb.a.xO,
b,Object(u.a)(this,this.wib,"onTouchMove"));sj.a.instance.mb(jb.a.bJ,b,Object(u.a)(this,this.iDa,"onTouchEnd"))}}Object(n.a)(ji,"ToggleButtonBehavior",Oj,[]);class tj{constructor(b){this.qzj=b;this.lpe={["Button"]:h=>new jl(h),["FileMenuButton"]:h=>new jl(h),["ColorPicker"]:h=>new oa(h),["ComboBox"]:h=>new vi(h),["ContextMenuControl"]:h=>new kj(h),["ContextMenuLauncher"]:h=>new kj(h),["DialogMenuLauncher"]:h=>new Vl(h),["DropDown"]:h=>new Vf(h),["FlyoutAnchor"]:h=>new Yg(h),["GalleryButton"]:h=>new Zj(h),
["StatefulColorFlyoutAnchor"]:h=>new Yg(h),["JewelMenuLauncher"]:h=>new rd(h),["Label"]:h=>new df(h),["Placeholder"]:h=>new Oj(h),["SearchBox"]:h=>new qb(h),["Separator"]:h=>new Oj(h),["SplitButton"]:h=>new je(h),["StatefulColorSplitButton"]:h=>new je(h),["StatefulImageSplitButton"]:h=>new je(h),["TextBox"]:h=>new Lf(h),["ToggleButton"]:h=>new ji(h)}}kDh(){this.lpe[Gm.Control.m9h]=b=>new Qc(b)}A6e(){this.lpe[Gm.Control.S6i]=b=>new kd(b)}ajl(b){const h=this.lpe[b.controlType];(b=h?h(b):null)&&this.qzj&&
b.o1k();return b}static get instance(){return tj._instance||(tj._instance=new tj(!!t.AFrameworkApplication.K&&t.AFrameworkApplication.K.$("CUICommitChangeFixIsEnabled")))}}tj._instance=null;Object(n.a)(tj,"ControlBehaviorFactory",null,[681]);var hj=d(954),Cj=d(167);class em extends Zm.MenuLauncher{constructor(b,h,r,z){super(b,h,r,z);this.DOg=null;this.eJa=this.Exc=0;this.vE=null;this.Lqc=this.Kqc=0;this.ih("Menu");this.enabled=!0}get x(){return this.Exc}get y(){return this.eJa}get $vf(){return this.Kqc}get awf(){return this.Lqc}get controlType(){return"DialogMenuLauncher"}G2a(){}f4a(){}icf(){const b=
{};b.MenuId=this.id;b.DialogMoveCommand=this.Js.DialogMoveCommand;b.DialogCloseCommand=this.Js.DialogCloseCommand;return b}bqm(b,h){this.Exc=b.x;this.eJa=b.y;this.Kqc=b.height;this.Lqc=b.width;this.OZ(h)}EP(b){this.DOg=jg.a.createElement("span");return new Cj.a(b,this.DOg)}get Js(){return this.Gh}Sra(b,h,r){return new em(b,this.id,h,r)}}Object(n.a)(em,"DialogMenuLauncher",Zm.MenuLauncher,[]);var Bm=d(806);class dl extends hj.a{constructor(b,h){super(b,h);this.h5a=null}get ANe(){return this.h5a}get pzh(){return this.properties}get l7(){return 20}km(){super.km();
qf.c(this.Kc)&&this.DB();this.Kc=jg.a.NOa(this.Kc);this.ZV(this.Kc);this.dirty=!1}LN(b){if(!Object(nb.a)(Bm.a,b))throw Error.create("Only children of type StandaloneDock can be added to a DialogMenuRoot");}H_e(b,h,r,z){r=new Mc.Menu(this,h,r,z,null);b||(b={});b.CommandMenuOpen=this.pzh.CommandMenuOpen;b.CommandMenuClose=this.pzh.CommandMenuClose;b=new em(this,h,b,r);this.Bxb[h]=b;h=new Bm.a(this,"dock"+h);h.Sf(b.GP("Menu"));this.Sf(h);this.refresh()}n0f(b,h,r,z){const R=this.Bxb[b];if(qf.c(R))throw Error.create('The dialog menu "'+
b+'" does not exist');R.bqm(new Sys.UI.Bounds(h,r,0,0),z);this.h5a=R.menu}xXe(b){b=this.Bxb[b];qf.c(b)||(b.Mra(),this.h5a=null)}LXd(){this.h5a=null}dispose(){const b=this.Bxb;for(let h in b)b[h].dispose();super.dispose()}}Object(n.a)(dl,"DialogMenuRoot",hj.a,[]);class fo{constructor(){this.LabelText=this.TextDirection=this.ImageSpinner=this.ImageExpandedArrowClass=this.ImageExpandedArrow=this.ImageCollapsedArrowClass=this.ImageCollapsedArrow=this.ImageUncheckMarkClass=this.ImageUncheckMark=this.ImageCheckMarkClass=
this.ImageCheckMark=this.ImageUpArrow8by8Class=this.ImageUpArrow8by8=this.ImageUpArrowClass=this.ImageUpArrow=this.ImageSideArrowClass=this.ImageSideArrow=this.ImageDownArrow8by8Class=this.ImageDownArrow8by8=this.ImageDownArrowClass=this.ImageDownArrow=this.DivSyndicated=null}}Object(n.a)(fo,"RootProperties",null,[]);class bj extends fo{constructor(){super()}}Object(n.a)(bj,"StandaloneRootProperties",fo,[]);class Pm extends bj{constructor(){super();this.CommandMenuClose=this.CommandMenuOpen=null}}
Object(n.a)(Pm,"DialogMenuRootProperties",bj,[]);class Bl{constructor(){const b=new Pm;b.ImageSideArrow=t.AFrameworkApplication.pr;b.ImageSideArrowClass=Wh.getImageClass("SubmenuFlyoutArrow_13x13x32");b.TextDirection=t.AFrameworkApplication.isRtl?"rtl":"ltr";this.yd=new dl("DialogMenuRootId",b);this.yd.vE=this;this.yd.refresh();t.AFrameworkApplication.ya.gb(ab.a.SLf,Yd.a.frame,Object(u.a)(this,this.SLf,"populateDialogMenu"),96)}get I_(){return this.yd}MKa(b,h,r,z,R=null){b=parseInt(b);z=t.AFrameworkApplication.ya;
r&&(z.IG=r.CommandLocation,z.q6=r.InvocationMethod);h=z.Xb(b,2,h,R);this.yd.refresh();return 32===h}uCa(b){return b?32===t.AFrameworkApplication.ya.processAction(parseInt(b),1):!0}Ht(){this.I_.root.yl()}H_e(b,h,r){const z={PopulateDynamically:"true",PopulateOnlyOnce:"false",PopulateQueryCommand:"3675896289",Command:"798637440"};z.DialogMoveCommand=h;z.DialogCloseCommand=r;this.I_.H_e(z,b,"","")}n0f(b,h,r,z){this.I_.n0f(b,h,r,z)}xXe(b){this.I_.xXe(b)}SLf(b,h,r,z,R){if(1===r)return 32;b=new Sys.StringBuilder;
b.append('<Menu Id="dialogMenu">');b.append('<MenuSection Id="dialogMenuSection" DisplayMode="Menu"><Controls>');b.append(String.format('<Button Id="DialogMenuMoveControl" Command="{0}" LabelText="{1}"/>',R.DialogMoveCommand,CommonUIStrings.l_DialogMove));b.append(String.format('<Button Id="DialogMenuCloseControl" Command="{0}" LabelText="{1}"/>',R.DialogCloseCommand,CommonUIStrings.l_DialogClose));b.append("</Controls></MenuSection>");b.append("</Menu>");R.PopulationXML=b.toString();return 32}dispose(){this.yd&&
(this.yd.dispose(),this.yd=null)}}Object(n.a)(Bl,"DialogMenuRootUser",null,[333,9,648]);class Tk{constructor(b,h,r){this.qob=this.Fmd=this.Urc=this.Tl=null;this.Sse=this.Rld=!1;this.Snc=b;this.ke=h;this.Gr=r;this.BRb=t.AFrameworkApplication.isRtl}get Hmf(){return this.Sse}Q3k(b){b?(this.Tl=b,this.Sse=!0,this.Rld=!1,this.ke.capture(Object(u.a)(this,this.Mom,"keyEventHandler"),null),this.Gr.mb(jb.a.pointerDown,this.Snc,Object(u.a)(this,this.Xac,"pointerDownHandler")),this.Urc||this.sLk(),this.Tl.appendChild(this.Urc),
this.O2l()):v.ULS.sendTraceTag(21516492,201,10,"Cannot move null element")}b8e(){this.Sse=!1;this.Fmd=this.qob=null;this.fqn();this.ERf();this.Tl=null}ERf(){this.ke.releaseCapture();this.Gr.sc(jb.a.pointerDown,this.Snc,Object(u.a)(this,this.Xac,"pointerDownHandler"))}O2l(){if(this.Tl.style.left.endsWith("px")&&this.Tl.style.right.endsWith("px"))this.qob=new Sys.UI.Point(Ul.a.yX(this.BRb?this.Tl.style.right:this.Tl.style.left),Ul.a.yX(this.Tl.style.top));else{const b=this.BRb?this.Snc.offsetWidth-
(this.Tl.offsetLeft+this.Tl.offsetWidth+Ul.a.yX(this.Tl.style.marginRight)):this.Tl.offsetLeft-Ul.a.yX(this.Tl.style.marginLeft),h=this.Tl.offsetTop-Ul.a.yX(this.Tl.style.marginTop);this.k0i(b,h);this.qob=new Sys.UI.Point(b,h)}this.Fmd=this.qob}sLk(){this.Urc=Wh.createClusteredImage(24,24,"ShapeQuadArrow_24x24x32","WACMoveArrowIcon",!0,"")}fqn(){this.Urc.parentNode===this.Tl&&this.Tl.removeChild(this.Urc)}Mom(b){if(!this.Hmf)return!1;b.Ib.preventDefault();if(b.eventName===jb.a.li){const h=b.Ib.ctrlKey?
1:10;let r;switch(b.Ib.keyCode){case wb.a.U7:this.O9b(0,-1*h);break;case wb.a.xha:this.O9b(0,1*h);break;case wb.a.uMb:r=this.BRb?1:-1;this.O9b(r*h,0);break;case wb.a.vMb:r=this.BRb?-1:1;this.O9b(r*h,0);break;case wb.a.u4a:this.asi(this.Fmd.x,this.Fmd.y);this.Rld=!0;break;case wb.a.es:this.Rld=!0}}b.eventName===jb.a.oh&&this.Rld&&this.b8e();return!0}Xac(b){if(!this.Hmf)return!1;b.Ib.preventDefault();this.b8e();return!0}O9b(b,h){this.asi(this.qob.x+b,this.qob.y+h)}asi(b,h){b=this.i$j(b,h);this.k0i(b.x,
b.y);this.qob=b}k0i(b,h){this.BRb?this.Tl.style.right=b+"px":this.Tl.style.left=b+"px";this.Tl.style.top=h+"px"}i$j(b,h){const r=this.BRb?Ul.a.yX(this.Tl.style.marginRight):Ul.a.yX(this.Tl.style.marginLeft),z=Ul.a.yX(this.Tl.style.marginTop);return new Sys.UI.Point(Math.min(Math.max(-r,b),this.Snc.offsetWidth-this.Tl.offsetWidth-r),Math.min(Math.max(-z,h),this.Snc.offsetHeight-this.Tl.offsetHeight-z))}}Object(n.a)(Tk,"KeyMoveAdapter",null,[649]);var Vm=d(1094),vp=d(568);class Hr{get name(){return"CUI.Behavior"}yc(b){t.AFrameworkApplication.K&&
t.AFrameworkApplication.K.$("AccessibleMovingDialogsEnabled")&&(b.register(648,"Common.UI.IDialogMenuRootUser").singleInstance().Yd(()=>new Bl),b.register(649,"Common.IKeyMoveAdapter").singleInstance().Yd(()=>new Tk(t.AFrameworkApplication.ua.hla(),rc.KeyInputManager.instance,rj.a.instance)));b.register(vp.a,"CommandUI.RootManager").as("Common.IRootManager").singleInstance().Yd(()=>vp.a.instance)}init(){Vm.a.GZe=tj.instance;const b=vp.a.instance.wTi;for(let h=0;h<b.length;++h){const r=Object(la.a)(650,
b[h]);r&&r.FKa()}Si.a.get_instance().XI(6)}dispose(){}static main(){O.a.instance.Oc(new Hr,5)}}Object(n.a)(Hr,"CuiBehaviorPackage",null,[1,2]);class qm{constructor(b){const h=new bj;h.ImageUpArrow=h.ImageDownArrow=h.ImageSideArrow=h.ImageCheckMark=h.ImageUncheckMark=h.ImageDownArrow8by8=h.ImageUpArrow8by8=b;h.ImageUpArrowClass=Wh.getImageClass("RibbonUpArrow_5x3x32");h.ImageDownArrowClass=Wh.getImageClass("SplitButtonArrow_5x3x32");h.ImageUpArrow8by8Class=Wh.getImageClass("RibbonUpArrow_8x8x32");
h.ImageDownArrow8by8Class=Wh.getImageClass("SplitButtonArrow_8x8x32");h.ImageSideArrowClass=Wh.getImageClass("SubmenuFlyoutArrow_13x13x32");h.ImageCheckMarkClass=Wh.getImageClass("CheckboxChecked_16x16x32");h.ImageUncheckMarkClass=Wh.getImageClass("CheckboxUnchecked_16x16x32");h.TextDirection=t.AFrameworkApplication.isRtl?"rtl":"ltr";this.gw=hj.a.HNk(h);this.gw.refresh()}get y3(){return this.gw}dispose(){this.gw.dispose()}}Object(n.a)(qm,"StandaloneRootController",null,[840,9]);var jn=d(1122),Kf=
d(236);class pq{constructor(b){this.tuc=b}create(b,h){const r=new Sys.StringBuilder;this.WCc(r,b,h);this.d0e(r,b);return r.toString()}rxb(b,h){const r=[];this.Q0e(r,b,h);this.e0e(r,b);return r}WCc(b,h,r){switch(h.errorType){case 0:b.append(this.tuc.build());break;case 1:case 2:b.append(this.sUe(h,r))}}Q0e(b,h,r){switch(h.errorType){case 0:b.push(this.tuc.Ghh());break;case 1:case 2:b.push(this.glk(h,r))}}d0e(b,h){b.append('<MenuSection Id="msIgnoreSpellingError" DisplayMode="Menu16"><Controls>');b.append(Kf.a("btnIgrnoreSpellingError",
(2===h.errorType?Fb.a.gFa:Fb.a.ota).toString(),Box4Intl.Box4Strings.l_IgnoreSpellingError,null));b.append("</Controls></MenuSection>")}e0e(b,h){const r=Object.assign(new hi.a,{ControlList:[]});h=2===h.errorType?"UnknownSpellingError":"IgnoreSpellingError";r.ControlList.push(Object.assign(new nh.a,{ExternalId:h}));b.push(r)}sUe(b,h){b=this.Rfl(b.suggestions,h);return 0<b.length?Kf.h("msUnknownWord",Kf.d(null,b),"Menu16"):Kf.h("msUnknownWord",Kf.d(null,[Kf.a("btnNoSuggestions",Fb.a.gFa.toString(),Box4Intl.Box4Strings.l_NoSuggestions,
null)]),"Menu16")}Rfl(b,h){const r=[];if(b){const z=Math.min(h.length,b.length);for(let R=0;R<z;++R)b[R]&&r.push(Kf.a("btnCorrectWord"+R,h[R].toString(),b[R]))}return r}glk(b,h){const r=Object.assign(new hi.a,{Id:"Suggestions",ControlList:[]});this.Qfl(b.suggestions,h,r.ControlList);0>=r.ControlList.length&&(b=Object.assign(new nh.a,{ExternalId:"NoSuggestions"}),r.ControlList.push(b));return r}Qfl(b,h,r){if(b){const z=Math.min(h.length,b.length);for(let R=0;R<z;++R){if(!b[R])continue;const ba=Object.assign(new nh.a,
{ExternalId:"btnCorrectWord"+R,Command:h[R].toString(),LabelText:b[R]});r.push(ba)}}}}Object(n.a)(pq,"DefaultProofingContextMenuCreator",null,[]);var pi=d(702);class ok{constructor(b,h){this.JAg=b;this.GCg=h;this.hja=[Fb.a.ylb,Fb.a.zlb,Fb.a.Alb,Fb.a.iLb,Fb.a.jLb]}create(b,h){return h?Object(nb.a)(pi.a,h)?this.GCg.create(b,h,this.hja):this.JAg.create(h,this.hja):""}m_b(b,h){return h?Object(nb.a)(pi.a,h)?this.GCg.rxb(b,h,this.hja):this.JAg.rxb(h,this.hja):null}}Object(n.a)(ok,"ProofingContextMenuSectionFactory",
null,[658]);class xo{build(){const b=[Kf.a("btnDeleteRepeatedWord",Fb.a.iAa.toString(),Box4Intl.Box4Strings.l_DeleteRepeatedWord,null)];return Kf.h("msRepeatedWord",Kf.d(null,b),"Menu16")}Ghh(){const b=Object.assign(new hi.a,{ControlList:[]}),h=Object.assign(new nh.a,{ExternalId:"DeleteRepeatedWord"});b.ControlList.push(h);return b}}Object(n.a)(xo,"ProofingRepeatedWordSectionBuilder",null,[657]);var Eh=d(615);class fr{static get vg(){return Wc.a.Px(fr.sl,Box4Intl.Box4Strings.l_AutoCorrectCorrectAndCapitalize,
Box4Intl.Box4Strings.l_ReplaceTextAsYouType,Box4Intl.Box4Strings.l_ReplaceTextAsYouTypeTooltip,Box4Intl.Box4Strings.l_CapitalizeFirstLetterOfSentences,Box4Intl.Box4Strings.l_AutoCorrectFormat,Box4Intl.Box4Strings.l_ReplaceOrdianalsWithSuperscript,Box4Intl.Box4Strings.l_ReplaceHyphensWithDash,Box4Intl.Box4Strings.l_ReplaceFractionsWithFractionCharacter)}}fr.sl="<div class='WACDialogRow' id='AutoCorrectCorrectAndCapitalizeDiv'> <div class='WACDialogSectionTitle UIFontBold'>{0}</div> </div> <div class='WACDialogGroupBox' id='AutoCorrectOptionsDiv'> <table cellpadding=5 cellspacing=5> <tr> <td> <input type='checkbox' id='ReplaceTextAsYouType' class='WACDialogCheckBox' title='{2}'></input> <label id='ReplaceTextAsYouTypeLabel' class='\"WACDialogInlineLabel\"' for='ReplaceTextAsYouType'>{1}</label> </td> </tr> <tr> <td> <input type='checkbox' id='CapitalizeFirstLetterOfSentences' class='WACDialogCheckBox' title='{3}'></input> <label id='CapitalizeFirstLetterOfSentencesLabel' class='\"WACDialogInlineLabel\"' for='CapitalizeFirstLetterOfSentences'>{3}</label> </td> </tr> </table> </div> <div class='WACDialogRow' id='AutoCorrectFormatTitleDiv'> <div class='WACDialogSectionTitle UIFontBold'>{4}</div> </div> <div class='WACDialogGroupBox' id='AutoCorrectFormatDiv'> <table cellpadding=5 cellspacing=5> <tr> <td> <input type='checkbox' id='ReplaceOrdianalsWithSuperscript' class='WACDialogCheckBox' title='{5}'></input> <label id='ReplaceOrdianalsWithSuperscriptLabel' class='\"WACDialogInlineLabel\"' for='ReplaceOrdianalsWithSuperscript'>{5}</label> </td> </tr> <tr> <td> <input type='checkbox' id='ReplaceHyphensWithDash' class='WACDialogCheckBox' title='{6}'></input> <label id='ReplaceHyphensWithDashLabel' class='\"WACDialogInlineLabel\"' for='ReplaceHyphensWithDash'>{6}</label> </td> </tr> <tr> <td> <input type='checkbox' id='ReplaceFractionsWithFractionCharacter' class='WACDialogCheckBox' title='{7}'></input> <label id='ReplaceFractionsWithFractionCharacterLabel' class='\"WACDialogInlineLabel\"' for='ReplaceFractionsWithFractionCharacter'>{7}</label> </td> </tr> </table> </div>";
Object(n.a)(fr,"AutoCorrectOptionsDialogHTML",null,[]);class Qo{static get vg(){return Wc.a.Px(Qo.sl,Box4Intl.Box4Strings.l_AutoCorrectCorrectAndCapitalize,Box4Intl.Box4Strings.l_ReplaceTextAsYouType,Box4Intl.Box4Strings.l_ReplaceTextAsYouTypeTooltip,Box4Intl.Box4Strings.l_CapitalizeFirstLetterOfSentences,Box4Intl.Box4Strings.l_AutoCorrectFormat,Box4Intl.Box4Strings.l_ReplaceOrdianalsWithSuperscript,Box4Intl.Box4Strings.l_ReplaceHyphensWithDash,Box4Intl.Box4Strings.l_ReplaceFractionsWithFractionCharacter,
Box4Intl.Box4Strings.l_ReplaceQuoteWithSmartQuote)}}Qo.sl="<div class='WACDialogRow' id='AutoCorrectCorrectAndCapitalizeDiv'> <div class='WACDialogSectionTitle UIFontBold'>{0}</div> </div> <div class='WACDialogGroupBox' id='AutoCorrectOptionsDiv'> <table cellpadding=5 cellspacing=5> <tr> <td> <input type='checkbox' id='ReplaceTextAsYouType' class='WACDialogCheckBox' title='{2}'></input> <label id='ReplaceTextAsYouTypeLabel' class='\"WACDialogInlineLabel\"' for='ReplaceTextAsYouType'>{1}</label> </td> </tr> <tr> <td> <input type='checkbox' id='CapitalizeFirstLetterOfSentences' class='WACDialogCheckBox' title='{3}'></input> <label id='CapitalizeFirstLetterOfSentencesLabel' class='\"WACDialogInlineLabel\"' for='CapitalizeFirstLetterOfSentences'>{3}</label> </td> </tr> </table> </div> <div class='WACDialogRow' id='AutoCorrectFormatTitleDiv'> <div class='WACDialogSectionTitle UIFontBold'>{4}</div> </div> <div class='WACDialogGroupBox' id='AutoCorrectFormatDiv'> <table cellpadding=5 cellspacing=5> <tr> <td> <input type='checkbox' id='ReplaceOrdianalsWithSuperscript' class='WACDialogCheckBox' title='{5}'></input> <label id='ReplaceOrdianalsWithSuperscriptLabel' class='\"WACDialogInlineLabel\"' for='ReplaceOrdianalsWithSuperscript'>{5}</label> </td> </tr> <tr> <td> <input type='checkbox' id='ReplaceHyphensWithDash' class='WACDialogCheckBox' title='{6}'></input> <label id='ReplaceHyphensWithDashLabel' class='\"WACDialogInlineLabel\"' for='ReplaceHyphensWithDash'>{6}</label> </td> </tr> <tr> <td> <input type='checkbox' id='ReplaceFractionsWithFractionCharacter' class='WACDialogCheckBox' title='{7}'></input> <label id='ReplaceFractionsWithFractionCharacterLabel' class='\"WACDialogInlineLabel\"' for='ReplaceFractionsWithFractionCharacter'>{7}</label> </td> </tr> <tr> <td> <input type='checkbox' id='ReplaceQuoteWithSmartQuote' class='WACDialogCheckBox' title='{8}'></input> <label id='ReplaceQuoteWithSmartQuoteLabel' class='\"WACDialogInlineLabel\"' for='ReplaceQuoteWithSmartQuote'>{8}</label> </td> </tr> </table> </div>";
Object(n.a)(Qo,"AutoCorrectOptionsDialogHTML2",null,[]);class qq extends Wc.a{constructor(b,h){super();this.yHn=(r,z)=>{xg.a.instance.J(9)&&(1!==r?v.ULS.sendTraceTag(24417874,324,50,"User close the option dialog or cancle it without save any changes."):z.ReplaceTextAsYouType!==this.NU.QOa||z.CapitalizeFirstLetterOfSentences!==this.NU.Std||z.ReplaceOrdianalsWithSuperscript!==this.NU.g4d||z.ReplaceHyphensWithDash!==this.NU.mYc||z.ReplaceFractionsWithFractionCharacter!==this.NU.f4d||this.Kca&&z.ReplaceQuoteWithSmartQuote!==
this.NU.xTf?(r={},r.ReplaceTextAsYouType=z.ReplaceTextAsYouType,r.CapitalizeFirstLetterOfSentences=z.CapitalizeFirstLetterOfSentences,r.ReplaceOrdianalsWithSuperscript=z.ReplaceOrdianalsWithSuperscript,r.ReplaceHyphensWithDash=z.ReplaceHyphensWithDash,r.ReplaceFractionsWithFractionCharacter=z.ReplaceFractionsWithFractionCharacter,this.Kca&&(r.ReplaceQuoteWithSmartQuote=z.ReplaceQuoteWithSmartQuote),this.NU.CBn(r),v.ULS.sendTraceTag(24523524,324,50,"User close the option dialog and trigger to save the setting: {0}"+
{["ReplaceTextAsYouType"]:z.ReplaceTextAsYouType,["CapitalizeFirstLetterOfSentences"]:z.CapitalizeFirstLetterOfSentences,["ReplaceOrdianalsWithSuperscript"]:z.ReplaceOrdianalsWithSuperscript,["ReplaceHyphensWithDash"]:z.ReplaceHyphensWithDash,["ReplaceFractionsWithFractionCharacter"]:z.ReplaceFractionsWithFractionCharacter,["ReplaceQuoteWIthSmartQuoteIsEnabled"]:this.Kca,["ReplaceQuoteWithSmartQuote"]:this.Kca&&z.ReplaceQuoteWithSmartQuote}),vb.App.xa.updateCommandUI(!0)):v.ULS.sendTraceTag(24523523,
324,50,"User close the option dialog or cancle it without do any changes."))};this.NU=b;this.Kca=h;this.kg="AutoCorrectOptionsDialog"}E0f(){v.ULS.sendTraceTag(24417873,324,50,"Autocorrect options dialog opens.");this.vg=this.Kca?Qo.vg:fr.vg;const b={};b.ReplaceTextAsYouType=this.NU.QOa;b.CapitalizeFirstLetterOfSentences=this.NU.Std;b.ReplaceOrdianalsWithSuperscript=this.NU.g4d;b.ReplaceHyphensWithDash=this.NU.mYc;b.ReplaceFractionsWithFractionCharacter=this.NU.f4d;this.Kca&&(b.ReplaceQuoteWithSmartQuote=
this.NU.xTf);this.Wh(Box4Intl.Box4Strings.l_AutoCorrectOptions,this.yHn,b)}}Object(n.a)(qq,"AutoCorrectOptionsDialog",Wc.a,[655]);class dh{static get vg(){return Wc.a.Px(dh.sl,CommonUIStrings.l_AlternativeTextTitleCaption,CommonUIStrings.l_AlternativeTextDescriptionCaption)}}dh.sl="<div class='WACDialogRow' id='block3'> <label id='label3' class='WACDialogLabel' for='titleText' aria-hidden='true' >{0}</label> </div> <div class='WACDialogRow' id='block1'> <input type='text' id='titleText' class='WACAltTextInput' maxlength='65536' aria-labelledby='label3' role='textbox' aria-multiline='false' autocomplete=\"off\"/> </div> <div class='WACDialogRow' id='block4'> <label id='label4' class='WACDialogLabel' for='descriptionText' aria-hidden='true' >{1}</label> </div> <div class='WACDialogRow' id='block5'> <textarea id='descriptionText' class='WACAltTextTextArea' maxlength='65536' aria-labelledby='label4' role='textbox' aria-multiline='true' autocomplete=\"off\"></textarea> </div>";
Object(n.a)(dh,"AltTextDialogWithDescriptionHtml",null,[]);class Pj extends Wc.a{constructor(b=!1){super(!1,!1,b);this.vg=dh.vg;this.kg=b?"AltTextDialog":"BaseAltTextDialogWithDescription"}l_e(b){this.Wh(CommonUIStrings.l_AlternativeTextDialogTitle,Object(u.a)(this,this.wak,"altTextDialogHandler"),this.ndf(b));b=document.getElementById(Pj.tQe);b.focus();b.select()}ndf(b){const h={};h[Pj.tQe]=this.gbf(b);h[Pj.sQe]=this.Bpl(b)||"";return h}S1(b){return b.Af.id===Pj.sQe?!1:super.S1(b)}}Pj.tQe="titleText";
Pj.sQe="descriptionText";Object(n.a)(Pj,"BaseAltTextDialogWithDescription",Wc.a,[]);var Ii=d(38);class Yo extends Pj{constructor(b,h,r,z,R){super();this.b$a=this.y8c=null;this.Kw=h;this.Zj=r;this.Hc=z;this.Hd=R;this.l_e(b)}Bpl(b){this.y8c=b.node;this.b$a=Ii.TableReader.j_h(b);return Ii.TableReader.iif(this.b$a)}gbf(b){this.y8c=b.node;this.b$a=Ii.TableReader.j_h(b);return Ii.TableReader.jif(this.b$a)}wak(b,h){if(1===b){b=Ii.TableReader.jif(this.b$a);const r=Ii.TableReader.iif(this.b$a),z=h[Pj.tQe];
h=h[Pj.sQe];this.hide();const R=this.Hc.Rc(15);try{R.Db(this.y8c),this.Kw.hZf(this.b$a,z),this.Kw.p0i(this.b$a,h)}finally{R&&R.dispose()}z===b&&h===r||this.Hd.zs(16)}xg.a.instance.J(4)&&this.Zj.Mp&&this.Zj.Lq.CG(this.y8c)}}Object(n.a)(Yo,"TableAltTextDialog",Pj,[]);class wp{constructor(b,h,r){this.Kw=b;this.Hc=h;this.Hd=r}create(b){return new Yo(b,this.Kw,vb.App.ud,this.Hc,this.Hd)}}Object(n.a)(wp,"TableAltTextDialogFactory",null,[]);const Eq=()=>{vb.App.Yah=!0;return 32},Up=(b,h,r,z,R)=>{if(1===
r)return 32;if(!({point:b,Ww:h}=Wl(R)).returnValue)return 16;vb.App.xa.Iec(b,h);return 32},yo=(b,h,r,z,R)=>{if(1===r)return 32;if(!({point:b,Ww:h}=Wl(R)).returnValue)return 16;vb.App.xa.hba(b,h);return 32},Wl=b=>{let h=null,r=0;if(!b)return{returnValue:!1,point:h,Ww:r};b=b.split(",");if(3>b.length)return{returnValue:!1,point:h,Ww:r};h=new Sys.UI.Point(parseInt(b[0]),parseInt(b[1]));r=parseInt(b[2]);return{returnValue:!0,point:h,Ww:r}};var ek=d(1765);class go extends Sys.EventArgs{constructor(b,h,
r,z,R,ba=0,ta=0,Wa=null){super();this.controlId=b;this.commandId=z;this.time=R;this.commandSurface=ba;this.Ww=ta;this.contentType=Wa}}Object(n.a)(go,"CommandClickEventArgs",Sys.EventArgs,[]);class wn{constructor(b,h){this.Ppa=b.Ycf();this.tlc=b;this.c5a=h}MKa(b,h,r,z=null,R=null){r&&(this.c5a.IG=r.CommandLocation,this.c5a.q6=r.InvocationMethod,this.c5a.Xab=r.CommandTabName);b=parseInt(b);let ba=this.tlc.mQh(b,h,r);ba.cDf&&(ba=this.tlc.mQh(ba.cL,h,r));if(void 0!==ba.rXa&&null!==ba.rXa)return ba.rXa;
if(ba.EBb)R=32;else{var ta=null;this.Ppa&&this.Ppa.mMf&&(ta=this.Ppa.mMf(ba,R));ba.mfa||ba.UOc?ba.EAa?R=16:(R=this.c5a.Xb(ba.cL,ba.m7b?2:1,ba.Cd,R),2===R&&(R=32)):ba.EAa?R=this.c5a.tna(null,ba.cL,ba.Cd,Wa=>{z&&z(Wa.response)},R):(R=this.c5a.Xb(ba.cL,2,ba.Cd,R),z&&z(R));this.Ppa&&this.Ppa.hMf&&this.Ppa.hMf(ba,R,ta);if(h&&r&&-1!==r.InvocationMethod&&r.InvocationMethod){r=h.LegacyId;if(void 0===r||null===r)r="";ta=h.ParentMenuId;void 0!==ta&&null!==ta||!h.MenuId||(ta=h.MenuId);let Wa=h.SqmControlId;
void 0!==Wa&&null!==Wa||!h.SourceControlId||(Wa=h.SourceControlId);(void 0!==Wa&&null!==Wa||void 0!==ta&&null!==ta)&&ek.a.Pdn(new go(Wa,r,ta,$c.ActionManager.ada(b),Date.now()))}}ba.mfa&&32===R&&this.Ppa&&this.Ppa.aza&&this.Ppa.aza(ba,h);ba.UOc&&32===R&&this.Ppa&&this.Ppa.AVa&&this.Ppa.AVa(ba,h);return 32===R||1===R}uCa(b,h=null){if(t.AFrameworkApplication.Mk||Oe.a.instance.Mv)return!1;null!=h&&null!=h.UILocation&&(this.c5a.IG=h.UILocation);const r=parseInt(b);if(!b||r===$c.ActionManager.r6e)return!0;
b=this.tlc.dQh(r,h);b.cDf&&(b=this.tlc.dQh(b.cL,h));if(void 0!==b.rXa&&null!==b.rXa)return b.rXa;r===ab.a.QWb&&h&&(b.Cd=h);return 32===this.c5a.Xb(b.cL,1,b.Cd)}clearCache(){this.tlc.clearCache()}}Object(n.a)(wn,"GeneralCuiUser",null,[332,333]);var zo=d(187),uj=d(61),ki=d(48),Tn=d(1380);class Yr{constructor(b,h,r,z){this.XBg="DocumentProofingFailed";this.QJe=b;this.J2g=h;this.i7c=r;this.LH=z}get eR(){return null!=this.Gsg?this.Gsg:this.Gsg=Sa.a.instance.resolve("Box4.Styles.IWACStyleEditor")}cIl(){let b=
this.LH.kFl(this.QJe);return{returnValue:this.LH.xYa(this.QJe),Ban:b}}Ejo(b,h){const r=uj.a.Rw();if(r){var z=new zo.ScriptSharpLegacyMap;z.add(We.a.pE,b);z.add(yc.a.noProof,h);b=new yf.GraphTransaction(15);b.Db(r);this.eR.L9b(ki.StyleReader.wordStyleIdNormal,z,r)?Tn.a.Jcj():(v.ULS.sendTraceTag(555775183,375,10,"Style could not be modified"),Tn.a.recordQosError(this.XBg,[Tn.a.Utc],"Style could not be modified"));b.dispose()}else v.ULS.sendTraceTag(555775182,375,10,"PageContentNode not found"),Tn.a.recordQosError(this.XBg,
[Tn.a.Utc],"PageContentNode not found")}cJn(b,h){this.Ejo(b,h)}rOn(b,h){if(this.J2g){var r=new Ei.DictionaryPropertySet;this.i7c.execute(z=>{z.kFc(b)});r.setValue(We.a.pE,b);r.setValue(yc.a.noProof,h);h=new yf.GraphTransaction(15);h.set(vb.App.Xj.al);this.J2g.s7(r);h.dispose()}}xf(){return Xd.SelectionEditor.xf(this.QJe)}}Object(n.a)(Yr,"LanguageEditor",null,[652]);var kn=d(619),kl=d(229),rm=d(91);class Ao{constructor(b=!1,h=0){this.languages=Ao.lZh(Sj.a.qol());this.hfd=new kl.a;this.AOa=[];this.TTb=
new kn.a;this.mKi=b;this.sXg=0>=h?7:h;this.rXg=this.gEe=0;this.UGg=!1;b&&(this.X3l(),t.AFrameworkApplication.xK(()=>{this.FAm()}))}X3l(){for(var b of this.languages)this.hfd.Z(b.LCID,b);b=[];try{const z=Ga.a.get("RecentlyUsedLcids");if(z&&""!==z){const R=decodeURIComponent(z).split(",").slice(0,this.sXg);for(const ba of R){let ta;({value:ta}=this.hfd.Dc(parseInt(ba),ta)).returnValue&&b.push(ta)}}}catch(z){v.ULS.sendTraceTag(38385057,324,15,"Error occurred while loading LCIDs from cookie, loading default LCID. Message: {0}",
z.message),Array.clear(b)}if(b.length)for(var h of b){var r=h.LCID;this.TTb.contains(r)||(this.AOa.push(h),this.TTb.add(r))}else h=t.AFrameworkApplication.lcid,({value:r}=this.hfd.Dc(h,r)).returnValue&&(this.AOa.push(r),this.TTb.add(h));this.zUi()}zUi(){const b=rm.toArray(rm.select(rm.asEnumerable(this.AOa),h=>h.LCID)).join(",");Ga.a.DPa("RecentlyUsedLcids",b,180)}Mwl(b){let h,r=-1,z=null;var R=Ao.lZh(this.AOa);this.mKi&&0<R.length&&(z=rm.toArray(rm.Si(rm.asEnumerable(R),(Wa,ub)=>{b===Wa.LCID&&-1===
r&&(r=ub);return{["key"]:ub,["text"]:Wa.displayName,["value"]:Wa.LCID.toString()}})));let ba=0;z&&(ba=z.length);R=ba;const ta=rm.toArray(rm.Si(rm.asEnumerable(this.languages),(Wa,ub)=>{b===Wa.LCID&&-1===r&&(r=ba+ub);return{["key"]:ba+ub,["text"]:Wa.displayName,["value"]:Wa.LCID.toString()}}));h=r;return 0<ba?{returnValue:z.concat.apply(z,ta),selectedIndex:h,j7i:R}:{returnValue:ta,selectedIndex:h,j7i:R}}oLn(b,h){if(this.mKi&&({value:r}=this.hfd.Dc(b,r)).returnValue){h=b!==h;if(this.TTb.contains(b))b=
Array.indexOf(this.AOa,r),0<=b&&(Array.removeAt(this.AOa,b),this.AOa.push(r)),h&&this.gEe++;else{this.TTb.add(b);this.AOa.push(r);if(this.AOa.length>this.sXg){var r=this.AOa.shift();this.TTb.remove(r.LCID)}h&&this.rXg++}this.zUi()}}FAm(){const b=this.gEe+this.rXg;!this.UGg&&0<b&&(v.ULS.sendTraceTag(39662593,324,50,"Recently Used Languages Hit Rate: {0}%",100*this.gEe/b),this.UGg=!0)}static lZh(b){b=Array.clone(b);b.sort((h,r)=>h.displayName.localeCompare(r.displayName));return b}}Object(n.a)(Ao,"LanguageListHelper",
null,[651]);var fk=d(193);class Ho extends fk.a{constructor(){super();this.Type=this.Number=0}get ControlType(){return 10}}Object(n.a)(Ho,"NumberButtonProps",fk.a,[]);var sm=d(228);class vk{static get NX(){return null!=vk.rqg?vk.rqg:vk.rqg=Sa.a.instance.Pa("Box4.ISpacingCommands")}static get Tg(){return sm.ContextSetEditor.instance}static get WT(){return null!=vk.xng?vk.xng:vk.xng=Sa.a.instance.Pa("Box4.ILineSpacingHelper")}static get k3i(){return!!vk.NX}static Vb(){const b=t.AFrameworkApplication.ya;
b.pa(Fb.a.cbc,kc.a.view,vk.cbc);b.Vc(Fb.a.cbc,1124);b.pa(Fb.a.cbc,kc.a.paragraph,vk.Kjo)}static cbc(b,h,r,z,R){if(1===r||!vk.k3i)return vk.k3i?32:8;if(!vk.Iei){var ba=[];ba.push(Object.assign(new Ho,{ExternalId:"LineSpacing1_00",Number:1,Type:0}));ba.push(Object.assign(new Ho,{ExternalId:"LineSpacing1_15",Number:1.15,Type:0}));ba.push(Object.assign(new Ho,{ExternalId:"LineSpacing1_50",Number:1.5,Type:0}));ba.push(Object.assign(new Ho,{ExternalId:"LineSpacing2_00",Number:2,Type:0}));ba.push(Object.assign(new Ho,
{ExternalId:"LineSpacing2_50",Number:2.5,Type:0}));ba.push(Object.assign(new Ho,{ExternalId:"LineSpacing3_00",Number:3,Type:0}));R.MenuItems=Kf.f(ba);vk.Iei=!0}v.ULS.sendTraceTag(588394560,340,50,"Line Spacing Menu is opened");h=h.view.Cb;ba=null;h&&h.hb.kb&&(ba=h.hb.kb);h=vk.Tg.RKh(ba.Qa);t.AFrameworkApplication.ya.Qf(h,b,r,!0,z,R);return 32}static Kjo(b,h){let r=b=!0;h=vk.WT.fBa(h.node);var z=h.beforeSpacing;let R=!1;1===z.unit&&(R=!0);if(R||0<z.value)b=!1;h=h.afterSpacing;z=!1;1===h.unit&&(z=!0);
if(z||0<h.value)r=!1;appChrome.api.dispatch(appChrome.actions.updateControlHiddenState(vk.k5j,!b));appChrome.api.dispatch(appChrome.actions.updateControlHiddenState(vk.Rqn,b));appChrome.api.dispatch(appChrome.actions.updateControlHiddenState(vk.j5j,!r));appChrome.api.dispatch(appChrome.actions.updateControlHiddenState(vk.Qqn,r));return 32}}vk.k5j="AddSpaceBeforeParagraph";vk.j5j="AddSpaceAfterParagraph";vk.Rqn="RemoveSpaceBeforeParagraph";vk.Qqn="RemoveSpaceAfterParagraph";vk.Iei=!1;Object(n.a)(vk,
"LineSpacingRibbonMenu",null,[]);var Uk=d(171),vs=d(1389),Fq=d(1366);const Qq=(b,h,r)=>{if(1===r)return 32;b=vb.App.xa.notificationBar.Yra("Automation test",!1);b.image=3;vb.App.xa.notificationBar.mA(b);return 32},xn=(b,h,r,z,R)=>{let ba;if(!({Ejj:ba}=Un(R)).returnValue)return 16;Uk.UISurfaces.bK().then(ta=>{let Wa=null;var ub=Object.assign(new vs.a,{label:"OK",onExecute:()=>{Wa&&ta.removeNotification(Wa)}});ub=Object.assign(new Fq.a,{target:"#"+tf.AppFrame.iVf,content:"Here's the text for the callout",
title:"Your title",primaryButtonProps:ub,useTeachingStyles:ba});ub=ta.callout(ub);Wa=ta.addNotification(ub);return null},ta=>{v.ULS.sendTraceTag(593352341,383,15,"Failed to GetNotificationsAPIAsync: {0}",ta);return null});return 32},Un=b=>{let h=!1;if(!b)return{returnValue:!1,Ejj:h};h=Boolean.parse(b);return{returnValue:!0,Ejj:h}};var Gq=d(1442);let Jn,Vn,Hh,Rq;class yn{constructor(){this.hya=new Ua.a;this.cMg=!1}L$a(b){const h=this.hya.indexOf(b);let r=!0;if(-1!==h){r=!1;if(!h)return r;this.hya.removeAt(h)}this.hya.insert(0,
b);v.ULS.sendTraceTag(594899716,340,50,"{0} is added at the start of recent color list.",b);11===this.hya.count&&(v.ULS.sendTraceTag(594899715,340,50,"Removing {0} from the recent color list.",this.hya.J(10)),this.hya.removeAt(10));this.ilo();return r}ilo(){v.ULS.sendTraceTag(594899714,340,50,"Sending a redux action to populate the recent colors menu section");const b=[];for(let r=0;r<this.hya.count;r++){var h="#"+this.hya.J(r).substring(4,6)+this.hya.J(r).substring(2,4)+this.hya.J(r).substring(0,
2);h=Object.assign(new Gq.a,{Color:this.hya.J(r),Alt:h,DisplayColor:h});b.push(appChrome.api.colorPickerCell(h.Color,h.DisplayColor,h.Alt))}for(const r of yn.VRj)appChrome.api.dispatch(appChrome.actions.populateColorPickerCells(r,b));this.cMg||this.hko();this.cMg=!0}hko(){for(const b of Object.keys(yn.GQg)){v.ULS.sendTraceTag(594899713,340,50,"Sending a redux action to update the {0} menu",b);const h=yn.GQg[b],r=[];for(const z of h)r.push(appChrome.api.menuSection([z],z in yn.$ye?yn.$ye[z].toString():
null));appChrome.api.dispatch(appChrome.actions.updateMenu(b,r,yn.$ye[b].toString()))}}}yn.GQg={["FontColor"]:(Rq=new Ua.a,Rq.add("AutomaticFontColor"),Rq.add("ThemeFontColorPickerMCU"),Rq.add("ThemeFontColorPicker"),Rq.add("StandardFontColorPicker"),Rq.add("RecentFontColorPicker"),Rq.add("MoreFontColors"),Rq),["CellShading"]:(Hh=new Ua.a,Hh.add("ThemeShadingColorPickerMCU"),Hh.add("ThemeShadingColorPicker"),Hh.add("StandardShadingColorPicker"),Hh.add("RecentCellShadingColorPicker"),Hh.add("ClearShadingColor"),
Hh.add("MoreCellShadingColors"),Hh),["PictureBorders"]:(Vn=new Ua.a,Vn.add("ThemePictureBorderColorPickerMCU"),Vn.add("ThemePictureBorderColorPicker"),Vn.add("StandardPictureBorderColorPicker"),Vn.add("RecentPictureBorderColorPicker"),Vn.add("MorePictureBorderColors"),Vn.add("NoPictureBorder"),Vn.add("PictureBorderWeightOptions"),Vn.add("PictureBorderStyleOptions"),Vn)};yn.$ye={["StandardFontColorPicker"]:Box4Intl.Box4Strings.L_MenuStandardColors,["StandardShadingColorPicker"]:Box4Intl.Box4Strings.L_MenuStandardColors,
["RecentFontColorPicker"]:Box4Intl.Box4Strings.L_MenuRecentColors,["RecentHighlighterColorPicker"]:Box4Intl.Box4Strings.L_MenuRecentColors,["RecentCellShadingColorPicker"]:Box4Intl.Box4Strings.L_MenuRecentColors,["RecentPictureBorderColorPicker"]:Box4Intl.Box4Strings.L_MenuRecentColors,["FontColor"]:Box4Intl.Box4Strings.L_FontColor,["Highlighter"]:Box4Intl.Box4Strings.L_HighlightColor,["CellShading"]:Box4Intl.Box4Strings.L_CellShadingColor,["PictureBorders"]:"Picture Border"};yn.VRj=(Jn=new Ua.a,
Jn.add("RecentFontColorPicker"),Jn.add("RecentCellShadingColorPicker"),Jn.add("RecentPictureBorderColorPicker"),Jn);Object(n.a)(yn,"RecentColorsSectionHandler",null,[]);var Ip=d(1388),Io=d(1016);class Hq{constructor(b){this.ZPj=b}T6(){}S6(b){this.ZPj.AMm(b)}}Object(n.a)(Hq,"DataBuddyActionListener",null,[33]);class Vp{constructor(){this.type="DataBuddyTaskPaneProps";this.onClearClick=this.clearButtonLabel=this.actions=null}}Object(n.a)(Vp,"DataBuddyTaskPaneProps",null,[]);class Zo{constructor(b){this.isVisible=
!1;this.ZX=new Ua.a;this.Qge=null;this.lP=b;this.iA=new Ip.a;this.Wb=ve.FocusManager.instance()}initialize(){this.Qge=new Hq(this);this.lP.iKa();this.iA.vK(this.n4j());this.iA.vK(this.y1j())}toggle(){this.isVisible?this.hide():this.show()}AMm(b){if(2===b.behavior){const h=$c.ActionManager.ada(b.actionId)||b.actionId.toString();h.startsWith("Query")||(this.ZX.add(h+": "+Zo.Bgl(b.response)),this.Vm())}}hide(){Uk.UISurfaces.$t().then(b=>{b.hideTaskPane(Zo.ly,2);return null})}show(){Uk.UISurfaces.$t().then(b=>
{b.showTaskPane(Zo.ly,this.wB());return null});this.isVisible&&Uk.UISurfaces.$t().then(b=>{b.setSelectedTaskPane(Zo.ly);return null})}n4j(){return b=>{b.actions=this.ZX.toArray();b.clearButtonLabel=CommonUIStrings.l_WAC_DataBuddyClearButtonLabel}}y1j(){return b=>{b.onClearClick=()=>{this.ZX.clear();this.Vm()}}}Vb(){t.AFrameworkApplication.ya.j3(this.Qge)}c4a(){t.AFrameworkApplication.ya.khc(this.Qge)}wB(){const b=new Vp;this.iA.KJb(b);return Object.assign(new Io.a,{title:"Data Buddy",hideHeader:!1,
width:Zo.width,location:2,contentProps:b,onOpen:()=>{this.q7();this.Vb();this.isVisible=!0;t.AFrameworkApplication.ua.updateCommandUI()},onClose:()=>{this.aba();this.c4a();this.isVisible=!1;this.Vm();t.AFrameworkApplication.ua.updateCommandUI()},isModernPane:!0})}Vm(){Uk.UISurfaces.$t().then(b=>{b.updateTaskPane(Zo.ly,this.wB());return null})}q7(){this.Wb.Jg(Zo.ly)}aba(){this.K_a()&&this.Wb.Jg(this.Wb.HS)}K_a(){return!!this.Wb.og&&this.Wb.og.name===Zo.ly}static Bgl(b){switch(b){case 0:return"Unattempted";
case 1:return"In Progress";case 2:return"Not Handled";case 4:return"Handle Externally";case 8:return"Failed";case 16:return"Error";case 32:return"Succeeded";case 64:return"Delayed";default:return b.toString()}}}Zo.ly="DataBuddyTaskPane";Zo.width=300;Object(n.a)(Zo,"Box4DataBuddyTaskPane",null,[634]);class gr{constructor(b){this.Eh=b}jFa(b){this.Eh&&this.Eh.hG(b)}z3c(){this.Eh&&this.Eh.Q3c(void 0)}}Object(n.a)(gr,"RibbonButtonUpdater",null,[632]);var $m=d(391);class gp{constructor(){this.cIe=this.W=
null}get name(){return"Box4.UI"}yc(b){this.W=b;b.ha("Box4.IGeneralCuiUser",()=>new wn(b.resolve("Box4.UI.CuiActionBridge"),t.AFrameworkApplication.ya)).singleInstance();b.ha("Box4.UI.TableAltTextDialogFactory",()=>new wp(b.resolve("Box4.ITableEditor"),new $m.a,b.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance)).singleInstance();b.ha("Box4.UI.ILanguageEditor",()=>new Yr(di.a.instance.Rg,b.Pa("Box4.ITextFormattingCommands"),b.Za("Box4.IAutoCorrectRules"),b.resolve("Box4.ILanguageReader")));
b.ha("CommandUI.StandaloneRootController",()=>new qm(t.AFrameworkApplication.pr)).as("Common.IStandaloneRootController").singleInstance();b.ha("Box4.UI.IAutoCorrectOptionsDialog",()=>new qq(b.resolve("Box4.IAutoCorrectOptionsInfo"),t.AFrameworkApplication.K.$("ReplaceQuoteWithSmartQuoteIsEnabled")));b.ha("Box4.UI.LanguageListHelper",()=>new Ao(t.AFrameworkApplication.K.$("RecentlyUsedLanguagesListIsEnabled"))).as("Box4.UI.ILanguageListHelper").singleInstance();b.register(xo,"Box4.UI.ProofingRepeatedWordSectionBuilder").as("Box4.UI.IProofingRepeatedWordSectionBuilder").singleInstance();
b.ha("Box4.UI.DefaultProofingContextMenuCreator",()=>new pq(b.resolve("Box4.UI.IProofingRepeatedWordSectionBuilder"))).singleInstance();b.ha("Box4.UI.ProofingContextMenuSectionFactory",()=>new ok(b.resolve("Box4.UI.DefaultProofingContextMenuCreator"),b.resolve("Box4.UI.EditorServiceProofingContextMenuCreator"))).as("Box4.UI.IProofingContextMenuSectionFactory").singleInstance();b.ha("Box4.RibbonButtonUpdater",()=>new gr(this.W.resolve("Box4.IAppFrame"))).as("Common.IRibbonButtonUpdater").singleInstance();
b.ha("Box4.UI.RecentColorsSectionHandler",()=>new yn).singleInstance();b.ha("Common.IDataBuddyTaskPane",()=>new Zo(jn.a.instance)).singleInstance()}init(){var b=vb.App.xa;const h=b.Sb;jd.U1l(Object(u.a)(h,h.aGb,"onAuthenticationLost"),Object(u.a)(h,h.bGb,"onAuthenticationRestored"),b.Crk);Eh.a.Vb();b=t.AFrameworkApplication.ya;b.pa(Fb.a.u8m,kc.a.application,Eq);b.gb(Fb.a.GWn,kc.a.application,Up,96);b.gb(Fb.a.mXn,kc.a.application,yo,96);b=t.AFrameworkApplication.ya;b.gb(Fb.a.SYn,kc.a.application,Qq,
96);b.gb(Fb.a.yWn,kc.a.application,xn,96);vk.Vb();this.b4l();this.cIe=this.W.resolve("Common.IStandaloneRootController")}b4l(){this.W.Za("Box4.IGeneralCuiUser").execute(b=>{this.W.Za("Common.IStandaloneRootController").execute(h=>{h.y3.vE=b})})}dispose(){this.cIe.dispose();this.cIe=null}static main(){O.a.instance.Oc(new gp,6)}}Object(n.a)(gp,"Box4UIPackage",null,[1,2]);var Iq=window.InsightsTaskPaneData={name:"CommandUI",attrs:{xmlns:"http://schemas.microsoft.com/sharepoint/"},children:[{name:"TaskPane",
attrs:{Id:"InsightsTaskPane",Title:"STR@L_SmartLookupPaneTitle",Width:"400"},children:[{name:"Groups",attrs:{},children:[{name:"Group",attrs:{Id:"InsightsIFrameContainer",IsStretched:"true"}}]}]}]},Wm=d(1780);class Jp{get name(){return"Box4.Insights"}init(){}dispose(){}yc(b){b.ha("Box4.Insights.Box4InsightsSelection",()=>new Wm.a).as("Common.App.Insights.IInsightsSelection").as("Box4.Insights.IBox4InsightsSelection").singleInstance()}}Object(n.a)(Jp,"Box4InsightsPackage",null,[1,2]);const ln=b=>{window.performance&&
"function"===typeof window.performance.mark&&window.performance.mark("CatchUpInit."+b)};var mn=d(440),an=d(348),Ro=d(1745);class xp{Hhb(){return!1}reset(){}update(){}}Object(n.a)(xp,"NullTaskYieldStrategy",null,[283]);var Xl=d(1394);class sl{constructor(){this.flyoutAnchorTarget=this.useCompactSummaryString=this.disableDismissOnClick=this.customDynamicEntryPointEnabled=this.dynamicEntryPointEnabled=this.activityFeedDataEnabled=this.includeRelevantAuthorsInSummaryString=this.summaryStringEnabled=this.flyoutEnabled=
this.featuredActivityGroupsEnabled=null}}Object(n.a)(sl,"CatchUpConfiguration",null,[]);class V{constructor(){this.ulsLogger=this.uiCulture=this.flyoutRibbonButton=this.flyoutFocus=this.dataCulture=this.changeSummariesDataProvider=this.appColorUpdateIsEnabled=this.activityRequestManager=this.activityNavigationManager=this.activityContentManager=null}}Object(n.a)(V,"SharedControllerFactoryParameters",null,[]);var ja=d(157),Oa=d(18);class Nb{constructor(b,h,r,z){this.oYm=(R,ba)=>{(this.edd=!this.edd)&&
ba.vk&&ba.vk.contextId===kc.a.Wc&&this.Slh(ba.vk.node,ba.vk.hl);return 32};this.px=b;this.zp=h;this.ga=r;this.Wb=z;this.Med=this.Ned=null;this.edd=!1;this.ga.pa(Oa.a.abj,kc.a.view,this.oYm);this.Wb.re(ke.AFrame.Np).bindAction(rc.KeyInputManager.lc(wb.a.Ric,6),Oa.a.abj)}a_(b,h){this.edd&&this.zp&&h&&h.ll&&h.ll.kb&&h.ll.kb.Qa&&h.ll.kb.Qa.node&&h.ll.kb.Qa.contextId===kc.a.Wc&&this.Slh(h.ll.kb.Qa.node,h.ll.kb.Qa.hl)}Slh(b,h){b&&(this.Yti(b)?(this.Ned&&this.Ned.id.equals(b.id)||(this.zp.sendNotification(WordEditorIntl.WordEditorStrings.L_CatchUpActivityParagraphAnnouncementTemplate,
!1),this.Ned=b),this.HDm(b,h)):this.Med=this.Ned=null)}Yti(b){return 0<this.px.CAb(b).count}HDm(b,h){if(b){var r=-1,z=null,R=null;for(let ba=0;ba<b.qa.length;ba++){const ta=b.qa.J(ba);if(!(null==R||ta.changeStart&&ta.changeStart.equals(z))&&h>=r&&h<=ta.cp&&!z.equals(this.Med))if(this.px.kDb(z)){(b=this.px.$Gc(z,b.id))&&0<b.actors.length&&b.displayTimestamp&&(b=String.format(WordEditorIntl.WordEditorStrings.L_CatchUpActivityChangeAnnouncementTemplate,b.actors[0].displayName,b.displayTimestamp.toLocaleString()),
this.zp.sendNotification(b,!1),this.Med=z);break}else this.Med=null;ta.changeStart&&!ta.changeStart.equals(z)&&(r=ta.cp,z=ta.changeStart);R=ta.changeStart}}}}Object(n.a)(Nb,"ActivityAnnouncementManager",null,[]);var oc=d(1367),Oc=d(472),Fd=d(477),zd=d(524);class Re{constructor(){this.activityId=null;this.type=0;this.priorityId=this.navigationId=this.relevancy=this.displayTimestamp=this.location=this.actors=null}}Object(n.a)(Re,"Activity",null,[]);var dg=d(428);class ih extends Re{constructor(){super();
this.Wu=this.objectId=null}static cG(b){const h=new zd.a(new dg.a);if(b.Wu)for(let r of b.Wu)h.add(r);return h}}Object(n.a)(ih,"RevisionSetActivity",Re,[]);class Dg{constructor(b,h,r){this.ile=null;this.dismiss=()=>{this.qui.then(z=>{z.removeNotification(this.ile);return this.ile=null})};this.dW=b;this.zc=h;this.qui=r}Jco(b){if(b)switch(b.type){case 2:case 3:case 4:case 6:case 8:case 9:case 7:case 10:this.zc.Xb(ab.a.L0a,2,null);break;default:this.FMm()}else v.ULS.sendTraceTag(593049027,3012,10,"Null activity: TryNotifyContentDoesNotExist. Unable to notify.")}FMm(){this.qui.then(b=>
{var h=Object.assign(new Fq.a,{target:'[data-unique-id~="CatchUpWithChanges"]',showCloseIcon:!0,content:CommonUIStrings.l_ChangeDoesNotExistNotification,calloutProps:Object.assign(new oc.a,{directionalHint:6,gapSpace:4,isBeakVisible:!1})});h=b.callout(h);const r=Object.assign(new Oc.a,{expirationOptions:Object.assign(new Fd.a,{displayTimeoutSeconds:10,onExpire:this.dismiss})});this.ile=b.addNotification(h,r)})}doesContentExist(b){if(!b)return v.ULS.sendTraceTag(593049026,3012,10,"Null activity: DoesContentExist. Default to false."),
!1;switch(b.type){case 2:case 3:case 4:case 6:case 8:case 9:case 7:case 10:if(!b.navigationId)return v.ULS.sendTraceTag(593049025,3012,10,"Null activity.NavigationId: DoesContentExist. Default to false."),!1;const h={};h.NavigationId=atob(b.navigationId);if(8===this.zc.Xb(ab.a.cAd,2,h))return!1;break;case 1:return this.XYk(b)}return!0}XYk(b){b=ih.cG(b);return b?0<this.dW.WFd(b).count:(v.ULS.sendTraceTag(593049024,3012,10,"Null changeIds: DoRevisionsExist. Default to false."),!1)}}Object(n.a)(Dg,"ActivityContentManager",
null,[618]);var Mf=d(1454),$g=d(1910),eh=d(1140),Qj=d(697);class ij{constructor(){this.Wu=this.KW=null}compare(b){if(!b)return!1;if(this.KW&&b.KW){if(this.KW.count!==b.KW.count)return!1;for(let h of this.KW)if(!b.KW.contains(h))return!1}else if(!b.KW&&this.KW||!this.KW&&b.KW)return!1;if(b.Wu&&this.Wu){if(b.Wu.count!==this.Wu.count)return!1;for(let h of this.Wu)if(!b.Wu.contains(h))return!1}else if(!this.Wu&&b.Wu||!b.Wu&&this.Wu)return!1;return!0}}Object(n.a)(ij,"ActivityHighlightableObject",null,
[]);class bn extends Mf.a{constructor(b,h){super();this.oDe=this.FTb=null;this.u6c=b;this.px=h;this.Opa=[new $g.a(eh.a.Hkh,eh.a.Gkh),new $g.a(eh.a.Ekh,eh.a.Dkh),new $g.a(eh.a.Xtd,eh.a.Ytd),new $g.a(eh.a.Ztd,eh.a.LVe)]}get PBb(){return 1}get Qeb(){return this.Opa}get Ila(){return!0}Zdb(b,h){if(b=Object(la.a)(ij,b))if(b.KW)for(let r of b.KW)h.add(r);else v.ULS.sendTraceTag(594900750,377,15,"Activity Highlight: no highlightable paragraphs")}WNa(b,h){if(this.Ky.mKa){var r=this.u6c.w2a,z=this.u6c.Seb,
R=!!r&&r.compare(z),ba=this.Ky.mKa,ta=ba.action,Wa=this.yTn(ba,b),ub=!1;2!==ta&&ta&&(ub=(ub=this.Ky.wRd)?1===ub.type:!!r||!!z);h=h.L1a("*");for(let Ib=0,$b=h.length;Ib<$b;Ib++){const fc=h[Ib],Kc=this.Lql(fc,eh.a.aud);if(Kc&&Kc.xt)if(this.Hpn(fc),1===ba.type)switch(ta){case 0:Wa&&r.Wu.contains(Kc.xt)&&this.bsd(fc,2,Kc,!1);break;case 2:Wa&&z.Wu.contains(Kc.xt)&&this.bsd(fc,R?2:1,Kc,!1);break;default:this.L4b(b,fc,Kc,!1)}else ub?this.L4b(b,fc,Kc,!1):this.L4b(b,fc,Kc,!0)}this.FTb&&(this.FTb.classList.add(eh.a.Ztd),
this.oDe=this.FTb=null)}}Lql(b,h){return Ri.a.Eb(b,h)}yTn(b,h){if(b&&b.DF){const r=b.DF,z=b.action;if(1===b.type&&(2===z||!z)&&r.KW)return r.KW.contains(h);if(r.Wu)for(let R of r.Wu){b=this.px.nIc(R);for(let ba of b)if(ba===h)return!0}}return!1}L4b(b,h,r,z){const R=this.u6c.w2a,ba=this.u6c.Seb;R&&R.Wu.contains(r.xt)&&(!R.KW||R.KW.contains(b))?this.bsd(h,2,r,z):ba&&ba.Wu.contains(r.xt)&&(!ba.KW||ba.KW.contains(b))&&this.bsd(h,1,r,z)}bsd(b,h,r,z){b&&Qj.a(b)&&(b.classList.add(this.yul(2===h,z)),this.DKn(b,
r,z))}DKn(b,h,r){this.FTb?-1!==h.cpEnd&&this.oDe.cpEnd!==h.cpBegin&&(this.FTb.classList.add(r?eh.a.LVe:eh.a.Ztd),b.classList.add(r?eh.a.Ytd:eh.a.Xtd)):b.classList.add(r?eh.a.Ytd:eh.a.Xtd);b.classList.add(eh.a.Fkh);this.FTb=b;this.oDe=h}Hpn(b){this.Ky.W1a(b);this.Bon(b)}Bon(b){b.classList.remove(eh.a.Xtd,eh.a.Ytd,eh.a.Fkh,eh.a.Ztd,eh.a.LVe)}yul(b,h){return h?b?eh.a.Dkh:eh.a.Gkh:b?eh.a.Ekh:eh.a.Hkh}}Object(n.a)(bn,"ActivityHighlightActor",Mf.a,[]);var Yl=d(1911),tm=d(184);class zn{constructor(b,h,r,
z,R,ba,ta,Wa){this.J4=b;this.fN=h;this.px=r;this.SPj=R;this.ib=ba;this.zp=Wa;this.Wb=ta;this.fN.QPd=!1}dAi(b,h,r){b?this.xYl(b,h,r):this.fN.w2a&&(b=Object.assign(new Yl.a,{action:1,type:1,DF:null,iO:this.fN.w2a}),this.fN.w2a=null,this.J4.nH(b))}xYl(b,h,r){if(h){b=new zd.a(new dg.a);for(R of h){var z=this.px.yHc(R);for(let ba=0;ba<z.length;ba++){const ta=z[ba];this.px.kDb(ta)&&b.add(ta)}}var R=this.px.WFd(b);R=this.Ksh(R,b);z=this.fN.w2a;this.fN.w2a=R;R=Object.assign(new Yl.a,{action:0,type:1,DF:this.fN.w2a,
iO:z});this.J4.nH(R);r&&!this.cDn(h.J(0),b)||this.MEn(h.J(0),b)}else v.ULS.sendTraceTag(589345503,377,10,"HighlightActivity: no target nodes for activityId {0}",b.activityId)}cDn(b,h){if(!b)return v.ULS.sendTraceTag(587239560,377,10,"ScrollToHighlightParagraph: No target node from activity"),!1;if(12!==b.type)return v.ULS.sendTraceTag(587239561,377,10,"ScrollToHighlightParagraph: target node is not a paragraph"),!1;h=this.Unl(b,h);return this.SPj.mdc(b.id,h)?this.setSelection(b,h)?!0:!1:(v.ULS.sendTraceTag(587239563,
377,10,"ScrollToHighlightParagraph: call to ScrollToParagraphMatchingNodeId failed"),!1)}MEn(b,h){b=this.zul(b,h);h=new Sys.StringBuilder;for(let r=0;r<b.count;r++)h.append(String.format(WordEditorIntl.WordEditorStrings.L_CatchUpActivityHighlightReadoutTemplate,r+1,b.count,b.J(r)));this.zp.sendNotification(h.toString(),!0)}setSelection(b,h){if(!b||!ie.ParagraphReader.nc(b))return v.ULS.sendTraceTag(579396806,377,10,"SetSelection: Invalid node provided"),!1;if(0>h)return v.ULS.sendTraceTag(579396807,
377,10,"SetSelection: Invalid cp provided"),!1;this.fN.QPd=!0;b=Qe.a.Uc(b,h);b=new tm.Selection([b],!0);this.ib.setSelection(b);ve.FocusManager.fJ()&&this.Wb.Jg(ke.AFrame.Zp);return!0}Unl(b,h){if(h&&0<h.count)for(let r=0;r<b.qa.length;r++){const z=b.qa.J(r);if(z.changeStart&&h.contains(z.changeStart))return z.cp}v.ULS.sendTraceTag(36824330,377,15,"Could not find the matching change in the paragraph, return default cp 0");return 0}zul(b,h){const r=new Ua.a;if(h&&0<h.count&&b){let z=-1;for(let R=0;R<
b.qa.length;R++){const ba=b.qa.J(R);if(-1!==z&&ba.isChangeEnd)if(ba.changeStart&&h.contains(ba.changeStart))continue;else r.add(b.characterData.substring(z,ba.cp)),z=-1;ba.changeStart&&h.contains(ba.changeStart)&&(z=ba.cp)}}return r}pzi(b,h){if(b)switch(b.type){case 1:if(h){b=new zd.a(new dg.a);for(var r of h){h=this.px.yHc(r);for(let z=0;z<h.length;z++){const R=h[z];this.px.kDb(R)&&b.add(R)}}}else b=ih.cG(b);h=this.px.WFd(b);this.fN.Seb=this.Ksh(h,b);r=Object.assign(new Yl.a,{action:2,type:1,DF:this.fN.Seb,
iO:null});this.J4.nH(r)}else this.fN.Seb&&(r=Object.assign(new Yl.a,{action:3,type:1,DF:null,iO:this.fN.Seb}),this.fN.Seb=null,this.J4.nH(r))}Ksh(b,h){var r=null;if(b){r=new Ka.a;for(let z of b)12===z.type&&r.add(z)}b=new ij;b.KW=r;b.Wu=h?h:this.Zzl(r);return b}Zzl(b){const h=new zd.a(new dg.a);if(!b)return h;for(let r of b)for(let z of this.px.CAb(r))h.add(z);return h}}Object(n.a)(zn,"ActivityHighlightManager",null,[]);var um=d(526),Xk=d(469),ro=d(1452),qi=d(126),cn=d(70);class Rg{constructor(){this.activityIds=
this.container=this.target=null;this.isSticky=!1;this.dirHint=0}}Object(n.a)(Rg,"CreateIndicatorTooltipParameters",null,[]);class An{constructor(){this.clearSticky=!1}}Object(n.a)(An,"DismissIndicatorTooltipParameters",null,[]);class Sq{constructor(){this.target=null;this.isSticky=!1}}Object(n.a)(Sq,"UpdateIndicatorTooltipParameters",null,[]);class rq extends Sys.EventArgs{constructor(b,h,r){super();this.kzb=b;this.w7h=h;this.wUn=r}}Object(n.a)(rq,"ActivityIndicatorEventArg",Sys.EventArgs,[]);class Wn{constructor(){this.x7h=
new Map;this.y7h=new Set}Y$n(b,h){this.y7h.add(b);this.x7h.set(b,h)}Nem(b){return Ed.a.qci(b.htmlElement)}fPl(){let b=new Set;for(let h of this.y7h){const r=this.x7h.get(h);r&&this.Mem(r)&&b.add(h)}return b}Mem(b){return b.parentElement&&Ed.a.qci(b.parentElement)}}Object(n.a)(Wn,"IndicatorVisibilityTracker",null,[]);class hp extends ro.a{constructor(b,h,r,z,R,ba,ta,Wa,ub,Ib,$b){super();this.sa=new Te.a;this.jqb=this.v8=null;this.CUl=(fc,Kc,ed,Jd,ge)=>{if(!ge)return v.ULS.sendTraceTag(592540299,377,
50,"Null actionData: HandleShowIndicatorFlyoutForActivity"),8;Kc=ih.cG(ge.Activity);fc=null;if(ge.NodeId&&(ge=qi.b(ge.NodeId),!E.a.Fp(ge,E.a.nil)&&(ge=this.px.BRh(ge),this.Y6f(ge,!1))))return 32;for(let qe of Kc)if(this.px.kDb(qe)){ge=this.px.L2b(qe);if(this.Y6f(ge,!0))return 32;ge&&!fc&&(fc=ge)}if(this.Y6f(fc,!1))return 32;v.ULS.sendTraceTag(589866521,377,15,"Unable to find indicator from ShowIndicatorFlyoutForActivity");return 8};this.AUl=(fc,Kc,ed,Jd,ge)=>{v.ULS.sendTraceTag(595126290,377,50,"User requested to Show Catch-Up Activities for a Paragraph from the Context Menu.");
ge&&Kc&&Kc.vl&&(fc=Kc.node)&&((fc=this.ijc.hGd(fc))?this.hqd(fc,!1,!1):v.ULS.sendTraceTag(595126289,377,50,"Unable to obtain indicator container for node after context menu action."));return 32};this.UYn=fc=>{(fc=this.ijc.hGd(fc.customData))&&this.hqd(fc,!1,!1)};this.onMouseEnter=fc=>this.yyi(fc.Dv,!0);this.Tma=fc=>{fc=fc.Dv;if(fc===this.v8)return!0;this.uNi(fc);return!0};this.S0a=fc=>{this.jqb=null;return this.yyi(fc.Dv,!1)};this.ZZ=()=>{this.j1f();this.Vud(!0);return!1};this.Wr=()=>{this.ZCi()};
this.MZd=()=>{this.v8&&this.ohj(this.v8);this.jqb&&this.uNi(this.jqb);this.pTm()};this.ZCi=()=>{this.v8?this.ohj(this.v8):this.PWe()};this.px=b;this.bhe=h;this.NIg=r;this.vHj=z;this.sk=R;this.D4=null;this.Hb=ta;this.ijc=Wa;this.Wse=new Wn;this.Hw=ub;this.QE=Ib;this.KH=$b;this.jf&&(this.jf.yja(this.MZd),this.jf.E$g(this.ZCi));ba&&ba.execute(fc=>{fc.h7(this.Wr)})}get jf(){return this.sk&&this.sk.wi?this.sk:(v.ULS.sendTraceTag(579396804,377,15,"Could not obtain valid PageView."),null)}IWa(b,h,r){if(this.v8){var z=
cn.a(this.v8);if(b===z)return this.v8}const R=b.Ig.ownerDocument;z=um.a.createElement(R,Xk.a.div);z.className=eh.a.ksk;z.style.left=h+"px";z.style.top=r+"px";h=um.a.createElement(R,Xk.a.div);h.className=this.Hw?eh.a.Nkh:eh.a.Ikh;z.style.cursor="pointer";h.style.cursor="pointer";this.KH&&(h.style.backgroundColor=this.QE.Akl(),h.style.outlineWidth="1px",h.style.outlineStyle="solid",h.style.outlineColor=this.QE.Bkl());z.appendChild(h);gf.a.instance.mb(jb.a.yQ,z,this.onMouseEnter);gf.a.instance.mb(jb.a.oK,
z,this.Tma);sf.a.instance.mb(jb.a.click,z,this.S0a);gf.a.instance.mb(jb.a.contextMenu,z,this.ZZ);v.ULS.sendTraceTag(41457152,377,50,"An activity indicator has been created!");this.hym(b);h=this.QAl(b);this.Wse.Y$n(h,z);this.Wse.Nem(b)&&this.Nxi(h);return z}eKb(b){return this.wSn(b)}oxb(b){const h=this.rpk(b),r=[];r.push(this.IWa(b.Y6,h,b.D4c[0].y-b.E$[0].y));return r}rpk(b){let h=eh.a.c1l+(0>b.CQc?-b.CQc:0);const r=Rf.a.Pi(b.leftMargin,0)/2;1>=r&&v.ULS.sendTraceTag(578082778,377,50,"Margin is too small to show indicators");
h=h>r?r:h;h=h<eh.a.Jkh?eh.a.Jkh:h;return t.AFrameworkApplication.isRtl?b.E$[0].width/this.zoom+h:-h}x2i(b){if(b&&393230===b.Qc||393251===b.Qc){const h=this.px.CAb(b);if(h)for(let r of h)if(b===this.px.L2b(r))return!0}return!1}wSn(b){for(let h of ie.ParagraphReader.Sw(b.zb,!0,!1))if(this.x2i(h))return!0;return!1}Vb(b){b.pa(Oa.a.k4i,kc.a.Wc,this.AUl);b.pa(Oa.a.A0f,kc.a.Wc,this.CUl)}Y6f(b,h){if(!b)return!1;const r=this.ijc.hGd(b);if(r)return this.hqd(r,!1,!0),!0;if(!h){let z;this.NWc((z=new Ua.a,z.add(b),
z),!1,!0,!0);h=new Ic.a(3,1,0,this.UYn,181);h.customData=b;this.Hb.$b(h);return!0}return!1}sKk(b,h=!1){h&&this.Vud(!0);if(b&&b.parentNode){var r=this.sif(b);r=this.Lgl(r);this.D4||(this.D4=document.createElement("Div"),document.getElementById(t.AFrameworkApplication.FXb).appendChild(this.D4));this.bhe.createActivityIndicatorTooltip(Object.assign(new Rg,{target:b,container:this.D4,activityIds:r,isSticky:h,dirHint:9}));h&&(this.v8=b)}else v.ULS.sendTraceTag(36794392,377,50,"Activity Indicator is gone (probably due to co-auth change on paragraph), so don't re-render the sticky flyout for it.")}Y1k(b){b&&
b.classList.add(eh.a.$td)}yyi(b,h){return this.hqd(b,h,!1)}hqd(b,h,r){if(h&&b===this.v8)return!0;const z=this.sif(b);h||this.j1f();this.sKk(b,!h);this.Y1k(b.getElementsByClassName(this.Hw?eh.a.Nkh:eh.a.Ikh)[0]);this.NWc(z,h,!0,r);this.Kmi(z,h?1:2);this.vHj.FTd();h&&(this.jqb=b);return!0}Vud(b=!1){this.bhe.dismissActivityIndicatorTooltips(Object.assign(new An,{clearSticky:b}));this.jqb=null;b&&(this.v8=null)}H5i(b){b&&b.classList.remove(eh.a.$td)}j1f(){this.v8&&this.H5i(this.v8.getElementsByClassName(eh.a.$td)[0])}uNi(b){const h=
this.sif(b);this.NWc(h,!0,!1,!1);this.H5i(b.getElementsByClassName(eh.a.$td)[0]);this.Vud(!1);this.jqb=null}sif(b){let h=null;(b=(b=cn.a(b))?b.zb:null)&&11===b.type&&(h=ie.ParagraphReader.Sw(b,!0,!1));return h}PWe(){const b=!!this.jqb;if(this.v8||b)this.j1f(),this.Vud(!0),this.NWc(null,!1,!1,!1),this.NWc(null,!0,!1,!1)}m6j(b){this.sa.addHandler(hp.i7g,b)}n6j(b){this.sa.addHandler(hp.j7g,b)}NWc(b,h,r,z){let R=null;if(r&&b){for(let ba of b)if(r=this.px.yHc(ba))for(let ta=0;ta<r.length;ta++){const Wa=
r[ta];if(this.px.kDb(Wa)){R=this.px.$Gc(Wa,ba.id);break}}if(!R){v.ULS.sendTraceTag(36717344,377,15,"Activity Indicator unable to obtain associated Activity for changeIds in this GraphNode.");return}}h?this.sa.raiseEvent(hp.i7g,new rq(R,b,!1)):this.sa.raiseEvent(hp.j7g,new rq(R,b,z))}Lgl(b){const h=[];if(b)for(let z of b){var r=this.px.CAb(z);for(let R of r)(r=this.px.$Gc(R,z.id))&&h.push(r.activityId)}!h.length&&b&&b.count&&v.ULS.sendTraceTag(36844643,377,15,"Activity Indicator unable to obtain associated Activity for changeIds in these Nodes.");
return h}ohj(b){b&&b.parentNode?(this.bhe.updateActivityIndicatorTooltip(Object.assign(new Sq,{target:b,isSticky:!0})),this.v8=b):v.ULS.sendTraceTag(40935511,377,50,"Activity Indicator is gone (probably due to co-auth change on paragraph), so don't re-render the sticky flyout for it.")}pTm(){let b=this.Wse.fPl();for(let h of b)this.Nxi(h)}Nxi(b){this.NIg.Jmi(b,3)}QAl(b){return(b=ie.ParagraphReader.Sw(b.zb,!0,!1))&&b.count?b.J(0).id:null}hym(b){b=ie.ParagraphReader.Sw(b.zb,!0,!1);this.Kmi(b,0)}Kmi(b,
h){b&&b.count&&this.gym(b.J(0).id,h)}gym(b,h){this.NIg.Jmi(b,h)}}hp.i7g="ActivityIndicatorPreviewed";hp.j7g="ActivityIndicatorSelected";Object(n.a)(hp,"ActivityIndicatorActor",ro.a,[]);var ag=d(40);class Tq{constructor(b,h,r){this.px=b;this.dod=h;this.sk=r}get jf(){return this.sk&&this.sk.wi?this.sk:(v.ULS.sendTraceTag(555356833,377,15,"Could not obtain valid PageView."),null)}hGd(b){v.ULS.sendTraceTag(555356834,377,50,"Attempting to find the indicator container related to changes in a given node.");
const h=this.BSh(b);if(!h){v.ULS.sendTraceTag(555356835,377,50,"Looking in different nodes to find the indicator container related to grouped changes on the desired node.");b=this.px.CAb(b);for(let r of b)if(b=this.px.L2b(r),b=this.BSh(b))return b}return h}BSh(b){if(!b||12!==b.type)return v.ULS.sendTraceTag(539779146,377,100,"ActivityIndicatorHelper.GetIndicatorForNode: invalid node provided."),null;if(!b)return v.ULS.sendTraceTag(539779147,377,100,"ActivityIndicatorHelper.GetIndicatorForNode: invalid paragraph node."),
null;var h=this.dod.HId(b);if(!h||11!==h.type)return v.ULS.sendTraceTag(539779148,377,100,"ActivityIndicatorHelper.GetIndicatorForNode: could not find top level outline element."),null;h=h.Ce(this.jf.Tb);if(!h||!h.htmlElement)return v.ULS.sendTraceTag(539779149,377,100,"ActivityIndicatorHelper.GetIndicatorForNode: invalid view element."),null;var r=$e.a.Ozb(h.htmlElement,Tq.h7g);if(r)return r;h=h.l9e();if(!h)return v.ULS.sendTraceTag(539779150,377,100,"ActivityIndicatorHelper.GetIndicatorForNode: invalid list container wrapper."),
null;h=$e.a.rll(h,Tq.h7g);if(!h)return v.ULS.sendTraceTag(539779151,377,100,"ActivityIndicatorHelper.GetIndicatorForNode: invalid indicators array."),null;for(r=0;r<h.length;r++){const z=cn.a(h[r]),R=ag.OutlineElementNavigator.Uk(b);if(z&&z.zb&&R&&z.zb.id.equals(R.id))return h[r]}v.ULS.sendTraceTag(539779152,377,100,"ActivityIndicatorHelper.GetIndicatorForNode: could not find indicator.");return null}Lvl(b){b=this.px.BRh(b);if(!b||12!==b.type)return v.ULS.sendTraceTag(555356864,377,10,"ActivityIndicatorHelper.GetIndicatorIdForNodeId: could not get paragraph node from node Id."),
E.a.nil;b=this.hGd(b);if(!b)return v.ULS.sendTraceTag(541888733,377,15,"ActivityIndicatorHelper.GetIndicatorIdForNodeId: could not get indicator from paragraph node."),E.a.nil;b=cn.a(b);return b?b.zb.id:(v.ULS.sendTraceTag(555356865,377,10,"ActivityIndicatorHelper.GetIndicatorIdForNodeId: could not get view element from paragraph node."),E.a.nil)}}Tq.h7g="CatchUpActivityIndicatorContainer";Object(n.a)(Tq,"ActivityIndicatorHelper",null,[]);var Wp=d(1632);class Xp{constructor(b,h,r,z,R,ba,ta){this.DZa=
b;this.pageContentNode=h;this.ENe=r;this.zc=z;this.dW=R;this.Ye=ba;this.jNc=ta;this.BEm=(Wa,ub,Ib)=>{if(1===Ib)return this.$3h?32:8;2===Ib&&(this.$3h&&(this.ENe.PWe(),this.Wvk()),v.ULS.sendTraceTag(38138719,377,50,y.c({["MarkAsRead invoked"]:!0})));vb.App.xa.updateCommandUI();return 8};this.DZa.ujb(this.ENe)}initialize(){this.zc.pa(Oa.a.Gpi,Yd.a.frame,this.BEm)}get $3h(){return!!this.dW.BQ&&0<this.dW.BQ.count||!!this.dW.Z9b&&0<this.dW.Z9b.count}eJf(b){const h=b&&b.wywaActivities?b.wywaActivities.length:
0;if(!this.jNc||0<h||!b){const r=new Map;r.set("activityCount",h.toString());this.Ye.logKpiUsage("CatchUpActivitiesReady",0,{extendedProperties:r})}b?this.jNc&&0==b.wywaActivities.length||this.qOm(b.wywaActivities):(v.ULS.shipAssertTag(36538305,377,!1),this.jNc||Object(Wp.a)(),this.Ye.logKpiFailure("CatchUpActivitiesReady","CatchUpActivitiesPayloadIsInvalid",{isIntentional:!1},{name:"CatchUpExperienceDegraded"}))}qOm(b){b?(v.ULS.sendTraceTag(36509256,377,50,"Catch-Up Activities are Ready and Indicators should be created."),
this.RQn(b),b=this.dW.K5j(b),this.SQn(b)):v.ULS.sendTraceTag(50959501,377,10,"activities passed in is null!")}RQn(b){if(b){var h=new Ua.a;for(let r of b)switch(r.type){case 2:case 3:case 4:case 10:b=4===r.type?r.vDi:r.contentId,h.add(b),this.dW.Z9b.add(b)}0<h.count&&(v.ULS.sendTraceTag(51196435,377,50,"{0}",h.count),this.zc.Xb(ab.a.lti,2,h.toArray()))}}SQn(b){const h=new zd.a(new dg.a),r=new yf.GraphTransaction(3);try{r.Db(this.pageContentNode);for(let z of b){const R=this.dW.L2b(z);R&&this.ENe.x2i(R)&&
(h.add(R.id),this.DZa.D5b(R,!0))}}finally{r&&r.dispose()}0<b.count&&vb.App.xa.updateCommandUI();b={};b.highlightedNodeCount=h.count;v.ULS.sendTraceTag(36509257,377,50,"{0}",y.c(b))}Wvk(){v.ULS.sendTraceTag(36509258,377,50,"Catch-Up Activity Indicators requested to be cleared.");0<this.dW.Z9b.count&&(this.zc.Xb(ab.a.lAh,2,this.dW.Z9b.toArray()),this.dW.Z9b.clear());const b=this.Sxk(this.dW.BQ);this.uon(b)}uon(b){v.ULS.sendTraceTag(36509259,377,50,"Catch-Up Activities some Indicators requested to be removed.");
const h=new yf.GraphTransaction(3);try{h.Db(this.pageContentNode);for(let r of b){this.dW.BQ.remove(r);for(let z of this.dW.nIc(r))this.DZa.D5b(z,!0)}this.dW.ymh()}finally{h&&h.dispose()}}Sxk(b){const h=new zd.a(new dg.a);for(let r of b)h.add(r);return h}}Object(n.a)(Xp,"ActivityIndicatorManager",null,[]);class so{constructor(){this.Seb=this.w2a=null;this.isFirstDocumentOpen=this.QPd=!1}}Object(n.a)(so,"ActivityStateManager",null,[587]);class Zr{constructor(b,h){this.N7c={};this.jOb=b;this.qz=h;this.Z9b=
new Ua.a}get BQ(){return this.jOb.BQ}CAb(b){const h=new zd.a(new dg.a);if(!b)return h;b=this.jOb.uEd(b);for(let r=0;r<b.length;r++){const z=b[r];this.kDb(z)&&h.add(z)}return h}nIc(b){return this.jOb.nIc(b)}WFd(b){const h=new Ua.a;if(b)for(let r of b)h.addRange(this.nIc(r));return h}K5j(b){const h=new zd.a(new dg.a);if(b)for(let r of b)if(1===r.type&&(b=r))for(let z of b.Wu){h.add(z);this.BQ.add(z);const R=z.toString();this.N7c[R]||(this.N7c[R]=new Ua.a);this.N7c[R].add(b)}this.ymh();return h}kDb(b){return this.BQ&&
b?this.BQ.contains(b):!1}$Gc(b,h){if(b&&(b=this.N7c[b.toString()])&&0<b.count){for(let r of b)if(r.objectId.equals(h))return r;return b.J(0)}return null}L2b(b){return this.jOb.L2b(b)}ymh(){this.jOb.Hvk()}yHc(b){return this.jOb.yHc(b)}BRh(b){if(!this.qz)return null;const h=this.qz.Lc;return h?h.Eb(b):null}}Object(n.a)(Zr,"ChangeIdCache",null,[]);var $n=d(174),Zg=d(111);class Bn extends $n.a{constructor(){super();this.activityClassifications=this.inferences=this.correspondingRequest=null;this.H_=Object.assign(new Zg.a,
{T_:Bn.getTypeName(),B_:Bn.getBaseTypes()})}static getTypeName(){return"AugLoop_ChangeSummaries_ChangeSummariesResponse"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}}Object(n.a)(Bn,"ChangeSummariesResponse",$n.a,[]);var ho=d(474);class Xn extends ho.a{constructor(){super();this.activityChanges=this.documentContent=this.requestId=null;this.H_=Object.assign(new Zg.a,{T_:Xn.getTypeName(),B_:Xn.getBaseTypes()})}static getTypeName(){return"AugLoop_ChangeSummaries_ChangeSummariesRequest"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}}
Object(n.a)(Xn,"ChangeSummariesRequest",ho.a,[]);var ip=d(410),Uq=d(436),to=d(230),$r=d(437);class Yp{constructor(){this.ccc=this.KYc=null}}Object(n.a)(Yp,"ActionPair",null,[]);class Kp{constructor(b,h,r,z){this.R1k=R=>{R=R.customData;const ba=this.UMi(R);ba&&(v.ULS.sendTraceTag(579745163,377,15,"ChangeSummariesAugloopProvider.EndRequestWithTimeout: augloop request timed out, time since request = {0}",this.Iff(R)),ba.ccc("Request timeout"))};this.HJ=b;this.Z3=h;this.Jf=r;this.Hb=z;this.Yse=null;this.zDe=
new Lc.a;this.mYg=new Lc.a}R3n(b){const h=Object.assign(new ip.a,{parentPath:["Signal",Xn.getTypeName()],items:[Object.assign(new Uq.a,{body:b})]});return this.initialize().then(()=>{const r=new Promise((z,R)=>{this.zDe.Z(b.requestId,Object.assign(new Yp,{KYc:z,ccc:R}))});this.mYg.Z(b.requestId,new Date);v.ULS.sendTraceTag(561111456,377,50,"ChangeSummariesAugloopProvider.SubmitRequest: submitting request to aug-loop, timeout duration = {0}",Kp.lRi);this.Z3.getAugLoopRuntimeManager().submitOperation(Object.assign(new $r.a,
{operation:h}));this.MNn(b.requestId);return r})}initialize(){this.Yse||(this.Yse=this.HJ.En().then(()=>{this.Jf.mb(this,Bn.getTypeName())}));return this.Yse}wI(b,h){if(b&&to.a.getTypeNameFor(b.content)===Bn.getTypeName())if(b=b.content){var r=this.UMi(b.correspondingRequest);r?h!==ip.a.getTypeName()?r.ccc("Invalid operation type"):(v.ULS.sendTraceTag(579745162,377,50,"ChangeSummariesAugloopProvider.HandleAnnotationEvent: resolving augloop request, time since request = {0}",this.Iff(b.correspondingRequest)),
r.KYc(b)):v.ULS.sendTraceTag(589083081,377,15,"ChangeSummariesAugloopProvider.HandleAnnotationEvent: cannot find action pair to resolve promise, time since request = {0}",this.Iff(b.correspondingRequest))}else v.ULS.sendTraceTag(589083080,377,10,"ChangeSummariesAugloopProvider.HandleAnnotationEvent: null response from ChangeSummariesRequest");else v.ULS.sendTraceTag(589600964,377,10,"ChangeSummariesAugloopProvider.HandleAnnotationEvent: invalid annotation event")}MNn(b){const h=new Ic.a(3,1,Kp.lRi,
this.R1k,176);h.Upd=0;h.customData=b;this.Hb.$b(h)}UMi(b){if(!b)return null;let h;if(!({value:h}=this.zDe.Dc(b,h)).returnValue)return null;this.zDe.remove(b);return h}Iff(b){if(!b)return-1;let h;return({value:h}=this.mYg.Dc(b,h)).returnValue?(new Date).getTime()-h.getTime():-1}static get lRi(){return t.AFrameworkApplication.K.rc("ChangeSummariesRequestTimeoutMs",5E3)}}Object(n.a)(Kp,"ChangeSummariesAugloopProvider",null,[250]);class ll{constructor(){this.activityGroups=null}}Object(n.a)(ll,"FeaturedActivityGroupPayload",
null,[]);class Vq{constructor(b,h,r,z,R){this.DSj=b;this.Jwj=h;this.wyj=r;this.WBj=z;this.fnb=R}getFeaturedActivityGroups(b){return b&&b.wywaActivities&&b.wywaActivities.length?this.WBj.Bsb.then(()=>this.Frl(b)):Vq.s6e}gSl(b,h,r){if(!h)return v.ULS.sendTraceTag(574103583,377,15,"ChangeSummariesDataProvider.HandleChangeSummariesResponse: response is null"),null;ln("TranslateFeaturedActivityGroups");r=this.wyj.Bao(b,h,r.wywaActivities);v.ULS.sendTraceTag(542942800,377,50,"ChangeSummariesDataProvider.HandleChangeSummariesResponse: sent changes to aug-loop = {0}, received inferences from aug-loop = {1}, provided items to the flyout = {2}",
0<b.activityChanges.length,0<h.inferences.length,0<r.length);this.fnb.set(h.correspondingRequest,r);return Object.assign(new ll,{activityGroups:r})}Frl(b){ln("BuildFeaturedActivityGroupRequest");const h=this.DSj.Tkk();if(!h||!h.documentContent||!h.activityChanges)return v.ULS.sendTraceTag(588379905,377,15,"ChangeSummariesDataProvider.GetFeaturedActivityGroupsInternal: ChangeSummariesRequest is null"),Vq.s6e;if(!h.documentContent.length||!h.activityChanges.length)return Vq.s6e;v.ULS.sendTraceTag(578954499,
377,50,"ChangeSummariesDataProvider.GetFeaturedActivityGroupsInternal: ChangeSummaries Request Id: "+h.requestId);ln("SubmitFeaturedActivityGroupRequest");return this.Jwj.R3n(h).then(r=>this.gSl(h,r,b))}}Vq.s6e=Promise.resolve(Object.assign(new ll,{activityGroups:[]}));Object(n.a)(Vq,"ChangeSummariesDataProvider",null,[594]);class ur{constructor(b,h){this.px=b;this.rXj=h}Tkk(){const b=new Ua.a,h=new Ua.a,r=new zd.a(new dg.a);var z=this.px.BQ;if(!z||!z.count)return ur.v6e;z=this.px.WFd(z);if(!z||!z.count)return v.ULS.sendTraceTag(592056450,
377,15,"ChangeSummariesRequestBuilder.BuildChangeSummariesRequest: no GraphNodes exist for the new changeIds"),ur.v6e;for(let R of z)r.contains(R.id)||(r.add(R.id),this.p$m(R,b,h));return h.count&&b.count?Object.assign(new Xn,{activityChanges:h.toArray(),documentContent:b.toArray(),requestId:qi.a(E.a.create())}):ur.v6e}p$m(b,h,r){if(ie.ParagraphReader.nc(b)){var z=ie.ParagraphReader.plainText(b);if(z&&z.length){h.add(z);z=this.px.CAb(b);z=this.sRl(z);for(let R of z){z=new Ua.a;const ba=this.getTextRanges(b,
R);for(let ta of ba)z.add({changeEnd:ta.endIndex,changeSpanId:ta.IGn,changeStart:ta.startIndex,contentIndex:h.count-1,locationId:qi.a(b.id)});(z=this.rHk(R,z.toArray()))&&r.add(z)}}else v.ULS.sendTraceTag(591975071,377,15,"ChangeSummariesRequestBuilder.ProcessParagraph: no content available")}else v.ULS.sendTraceTag(592056452,377,15,"ChangeSummariesRequestBuilder.ProcessParagraph: node did not cast to AParagraphNode")}sRl(b){const h=new Lc.a;for(let r of b)(b=this.yWh(r))?(h.xb(b)||h.Z(b,new zd.a(new dg.a)),
h.J(b).add(r)):v.ULS.sendTraceTag(579712270,377,15,"ChangeSummariesRequestBuilder.GroupChangeIdsByUser: unable to get person id from change id");return h.values}rHk(b,h){const r=[];let z=null;for(let R of b)if(b=this.px.$Gc(R,E.a.nil)){if(!z){const ba=this.yWh(R);if(!ba||!ba.length){v.ULS.sendTraceTag(579712272,377,15,"ChangeSummariesRequestBuilder.CreateActivityChange: unable to get person id from change id");continue}z=ba}r.push(b)}else v.ULS.sendTraceTag(579712271,377,15,"ChangeSummariesRequestBuilder.CreateActivityChange: unable to get activity from change id");
return r.length?z?h.length?{activityId:r[0].activityId,changes:h,personId:z,timestamp:r[0].displayTimestamp.toISOString()}:(v.ULS.sendTraceTag(579712273,377,15,"ChangeSummariesRequestBuilder.CreateActivityChange: no changes provided for ActivityChange"),null):(v.ULS.sendTraceTag(579605389,377,15,"ChangeSummariesRequestBuilder.CreateActivityChange: could not get personId for ActivityChange"),null):(v.ULS.sendTraceTag(579605388,377,15,"ChangeSummariesRequestBuilder.CreateActivityChange: no activities exist for ActivityChange"),
null)}yWh(b){b=this.px.$Gc(b,E.a.nil);if(!b)return v.ULS.sendTraceTag(579712274,377,15,"ChangeSummariesRequestBuilder.GetPersonIdResponsibleForChangeId: unable to get activity from change id"),null;b=b.actors;if(!b||!b.length||!b[0])return v.ULS.sendTraceTag(592056451,377,15,"ChangeSummariesRequestBuilder.GetPersonIdResponsibleForChangeId: no people are associated with this Activity in ChangeSummariesRequest"),null;let h=b[0].id;h&&h.length||(h=b[0].email);return h}getTextRanges(b,h){const r=new Ua.a;
if(!h||!h.count||!b)return r;let z=-1,R=new zd.a(new dg.a);for(let ba=0;ba<b.qa.length;ba++){const ta=b.qa.J(ba);if(-1!==z&&ta.isChangeEnd){if(ta.changeStart&&h.contains(ta.changeStart)){R.add(ta.changeStart);continue}r.add({startIndex:z,endIndex:ta.cp,IGn:this.rXj.jXi(R)});z=-1;R=new zd.a(new dg.a)}ta.changeStart&&h.contains(ta.changeStart)&&(z=ta.cp,R.add(ta.changeStart))}return r}}ur.v6e=Object.assign(new Xn,{activityChanges:[],documentContent:[],requestId:qi.a(E.a.nil)});Object(n.a)(ur,"ChangeSummariesRequestBuilder",
null,[]);class sq{constructor(){this.changes=this.content=null}}Object(n.a)(sq,"ContentChange",null,[]);class ws{constructor(){this.ranking=0;this.reasons=this.contentChanges=this.locationId=this.activities=null}}Object(n.a)(ws,"FeaturedActivityGroup",null,[]);class tq{constructor(){this.end=this.start=0}}Object(n.a)(tq,"TextRange",null,[]);class yp{constructor(b){this.ijc=b}Bao(b,h,r){if(!h)return v.ULS.sendTraceTag(588379906,377,10,"ChangeSummariesResponseTranslator.TranslateResponseToActivityGroups: response is null"),
yp.BAd;if(!h.inferences)return v.ULS.sendTraceTag(588379907,377,10,"ChangeSummariesResponseTranslator.TranslateResponseToActivityGroups: response.Inferences is null"),yp.BAd;if(!h.activityClassifications)return v.ULS.sendTraceTag(588379908,377,10,"ChangeSummariesResponseTranslator.TranslateResponseToActivityGroups: response.ActivityClassifications is null"),yp.BAd;if(!h.inferences.length||!h.activityClassifications.length)return v.ULS.sendTraceTag(561111455,377,50,"ChangeSummariesResponseTranslator.TranslateResponseToActivityGroups: response is empty"),
yp.BAd;const z=[],R=new qa.a(new dg.a);for(let ba of h.inferences){const ta=this.Aao(ba,b,h,r);if(!ta)continue;const Wa=this.ijc.Lvl(qi.b(ta.locationId));Wa.equals(E.a.nil)?z.push(ta):R.xb(Wa)?R.J(Wa).ranking>ta.ranking&&R.Z(Wa,ta):R.add(Wa,ta)}b=[...Array.from(R.values),...z];b.sort((ba,ta)=>ba.ranking-ta.ranking);return b.slice(0,yp.KFm)}Aao(b,h,r,z){if(!b||Kh.a.mf(b.activitiesInGroup))return v.ULS.sendTraceTag(588379909,377,10,"ChangeSummariesResponseTranslator.TranslateInferenceToGroup: inference is empty"),
null;const R=new Ua.a,ba=new Lc.a;let ta=null;for(let ub of b.activitiesInGroup){if(!ub){v.ULS.sendTraceTag(588379910,377,15,"ChangeSummariesResponseTranslator.TranslateInferenceToGroup: groupActivity is null");continue}if(0>ub.activityIndex||ub.activityIndex>=r.activityClassifications.length){v.ULS.sendTraceTag(588379911,377,15,"ChangeSummariesResponseTranslator.TranslateInferenceToGroup: groupActivity.ActivityIndex is invalid");continue}const Ib=r.activityClassifications[ub.activityIndex];if(!Ib||
Kh.a.mf(Ib.contents))v.ULS.sendTraceTag(588379912,377,10,"ChangeSummariesResponseTranslator.TranslateInferenceToGroup: activityClassification is empty");else{var Wa=this.O8k(z,Ib.activityId);if(Wa){R.add(Wa);for(let $b of ub.changes){if(!$b){v.ULS.sendTraceTag(576251591,377,15,"ChangeSummariesResponseTranslator.TranslateInferenceToGroup: changeContentRef is null");continue}Wa=$b.value;if(0>Wa||Wa>=Ib.contents.length){v.ULS.sendTraceTag(576251592,377,15,"ChangeSummariesResponseTranslator.TranslateInferenceToGroup: changeContentRef index is invalid");
continue}Wa=Ib.contents[Wa];if(!Wa){v.ULS.sendTraceTag(576251593,377,15,"ChangeSummariesResponseTranslator.TranslateInferenceToGroup: changeContent is null");continue}const fc=h.documentContent[Wa.contentIndex],Kc=Object.assign(new tq,{start:Wa.changeStart,end:Wa.changeEnd});if(ba.xb(fc))ba.J(fc).add(Kc);else{let ed;ba.Z(fc,(ed=new Ua.a,ed.add(Kc),ed))}ta||(ta=Wa.locationId)}}else v.ULS.sendTraceTag(588379913,377,10,"ChangeSummariesResponseTranslator.TranslateInferenceToGroup: activity is null")}}if(!R.count)return v.ULS.sendTraceTag(588379914,
377,15,"ChangeSummariesResponseTranslator.TranslateInferenceToGroup: no activities for ActivityGroup"),null;h=this.wNl(ba);return h.count?Object.assign(new ws,{ranking:b.ranking.value,reasons:[1],activities:R.toArray(),contentChanges:h.toArray(),locationId:ta}):(v.ULS.sendTraceTag(588379915,377,15,"ChangeSummariesResponseTranslator.TranslateInferenceToGroup: no content change for ActivityGroup"),null)}O8k(b,h){for(let r of b)if(r&&r.activityId&&r.activityId===h)return r;return null}wNl(b){const h=
new Ua.a;for(let z of b){b=z.key;const R=z.value;R.Sc((ba,ta)=>ba.start-ta.start);var r=R.J(0).start;if(r>yp.iqi){r-=yp.iqi;b=b.substring(r,b.length);for(let ba of R)ba.start-=r,ba.end-=r}h.add(Object.assign(new sq,{content:b,changes:R.toArray()}))}return h}}yp.BAd=[];yp.iqi=10;yp.KFm=4;Object(n.a)(yp,"ChangeSummariesResponseTranslator",null,[]);class Zp{constructor(){this.fnb=new Lc.a;this.IEe=new Lc.a}set(b,h){if(h.length&&b){this.fnb.Z(b,h);for(let r of h)if(r.activities)for(let z of r.activities)z&&
z.activityId?this.IEe.Z(z.activityId,b):v.ULS.sendTraceTag(573920657,377,15,"FeaturedActivityGroupCache.Set: null activity in group");else v.ULS.sendTraceTag(573920656,377,15,"FeaturedActivityGroupCache.Set: null activities for group")}}get(b){return b&&this.fnb.xb(b)?this.fnb.J(b):null}NCm(b){return b&&this.IEe.xb(b)?this.IEe.J(b):null}}Object(n.a)(Zp,"FeaturedActivityGroupCache",null,[]);class tl{constructor(b){this.fTd=(h,r,z,R,ba)=>{if(!ba)return v.ULS.sendTraceTag(574103576,377,15,"FeaturedActivityGroupTelemetryActor.LogActivityNavigationDetails: null actionData"),
8;h=ba.Activity;if(!h)return v.ULS.sendTraceTag(574103577,377,15,"FeaturedActivityGroupTelemetryActor.LogActivityNavigationDetails: null activity"),8;r=this.fnb.NCm(h.activityId);if(!r)return v.ULS.sendTraceTag(574103578,377,15,"FeaturedActivityGroupTelemetryActor.LogActivityNavigationDetails: No matching request Id found"),8;z=ih.cG(h);v.ULS.sendTraceTag(574103579,377,50,"FeaturedActivityGroupTelemetryActor.LogActivityNavigationDetails: [RequestId={0};ActivityId={1};ChangeIds={2}]",r,h.activityId,
this.jXi(z));return 32};this.fnb=b;this.xxg=new Map}Vb(b){b.pa(Oa.a.fTd,Yd.a.frame,this.fTd)}jXi(b){let h=0;const r=Array(b.count);for(let z of b)b=this.EBl(z),r[h]=qi.a(b),h++;return r.join(",")}EBl(b){let h=this.xxg.get(b);if(h&&h!=E.a.nil)return h;h=E.a.create();this.xxg.set(b,h);return h}}Object(n.a)(tl,"FeaturedActivityGroupTelemetryActor",null,[]);var Cn=d(93);class Jq extends Sys.EventArgs{constructor(b){super();this.node=b}}Object(n.a)(Jq,"OnParagraphVisitedArgs",Sys.EventArgs,[]);class Lp{constructor(b,
h,r){this.bS=null;this.Hao=z=>{this.aVa.reset();z=this.nNl(z.customData);let R=null;for(;z.moveNext();){const ba=z.currentNode;if(ba&&(ie.ParagraphReader.nc(ba)&&this.sa.raiseEvent("OPV",new Jq(ba)),this.aVa.update(),this.aVa.Hhb())){R=ba;break}}R?this.C9g(R):this.bS(!0)};this.Hb=b;this.aVa=h;this.qz=r;this.sa=new Te.a;this.Bsb=new Promise(z=>{this.bS=z})}V7j(b){this.sa.addHandler("OPV",b)}Mhk(){this.C9g(null)}C9g(b){const h=new Ic.a(3,1,0,this.Hao,182);h.customData=b;this.Hb.$b(h)}nNl(b){if(!b)return Cn.a.Wp(this.qz);
b=Nd.GraphIterator.$a(b);b.Bb(7);return Cn.a.Kr(b,this.qz)}}Object(n.a)(Lp,"DocumentTraverser",null,[]);class uq{constructor(b,h){this.mcl=()=>{const r=document.getElementById("flyoutItem0");r&&(v.ULS.sendTraceTag(588129371,3012,50,"Focused on the catch-up flyout via ctrl+F6"),r.focus())};this.Oo=b;this.Wb=h}initialize(){const b=this.Wb.re(ke.AFrame.SYb);b.UL=!0;b.parent=ke.AFrame.Np;b.eda(this.mcl);this.Oo.qS(ke.AFrame.SYb)}enableF6Focus(){this.Oo.DG(ke.AFrame.SYb)}disableF6Focus(){this.Oo.Mw(ke.AFrame.SYb)}}
Object(n.a)(uq,"FlyoutFocus",null,[586]);var xs=d(349);class Qm{constructor(b,h,r){this.Cwg=this.LGg=this.Jpc=this.Hdd=!1;this.Xpe=this.x7c=null;this.MVm=(z,R,ba,ta,Wa)=>{Wa[Yf.a.Visible]=!0;Wa[Yf.a.On]=this.Jpc&&this.Hdd;return 32};this.pYm=(z,R,ba)=>{if(1===ba)return this.Hdd?(this.LGg||(this.LGg=!0,v.ULS.sendTraceTag(588129368,3012,50,"Catch Up Button Is Enabled.")),32):8;if(!this.x7c)return v.ULS.sendTraceTag(588129369,3012,10,"OnToggleCatchUpFlyout: User clicked the button before the buttonClickedCallback was registered."),
8;this.Cwg=!0;this.x7c();return 32};this.ga=b;this.VEg=h;this.Wb=r}get g$e(){return this.Xpe?this.Xpe:(v.ULS.sendTraceTag(578401728,3012,15,"Attempted to get _flyoutShowTimestamp before the value was set."),new Date)}set g$e(b){this.Xpe=b}initialize(){this.Vb()}registerButtonClickedEvent(b){this.x7c&&v.ULS.sendTraceTag(588129366,3012,15,"RegisterButtonClickedEvent: Button clicked callback should only be registered once.");this.x7c=b.buttonClickedCallback}onFlyoutInitialized(){var b;this.Hdd&&v.ULS.sendTraceTag(588129367,
3012,15,"OnFlyoutInitialized: Flyout should only be initialized once.");const h=(new Date).getTime()-this.g$e.getTime();v.ULS.sendTraceTag(593601546,3012,50,"Time from retrieve activities to initialize Flyout: {0}",h);this.Hdd=!0;(null===(b=t.AFrameworkApplication.K)||void 0===b?0:b.getBooleanFeatureGate("Microsoft.Office.SharedOnline.GeneralizedRibbonTTVRReporting",!1))||xs.a.M0a("ribbon","catchUp");Lb.c(ab.a.msk,!0,void 0,void 0,void 0,h)}onFlyoutVisibilityChanged(b){this.Jpc!==b.flyoutIsVisible&&
(this.Jpc=b.flyoutIsVisible,vb.App.xa&&vb.App.xa.updateCommandUI(!0),this.Jpc&&this.Cwg&&this.Wb.Jg(ke.AFrame.SYb),this.Jpc||this.VEg&&this.VEg.iwm())}logFlightTriggers(b){b.hasFlyoutData&&t.AFrameworkApplication.Hf("WoCha187;WoCha187cf")}Vb(){this.ga.pa(ab.a.ebj,Yd.a.frame,this.pYm);this.ga.gb(ab.a.GIi,Yd.a.frame,this.MVm,96)}}Object(n.a)(Qm,"FlyoutRibbonButton",null,[585]);var Hl=d(151);class Ia{constructor(b,h){this.BQ=null;this.sNd=this.Lfi=!1;this.dW=b;this.Ye=h;this.Afb=new Hl.a;this.ZMd=new Map;
this.Afb.Z(1,new zd.a(new dg.a));this.Afb.Z(0,new zd.a(new dg.a));this.Afb.Z(2,new zd.a(new dg.a));this.Afb.Z(3,new zd.a(new dg.a));this.ZMd.set(3,"CatchUpIndicatorVisible");this.ZMd.set(1,"CatchUpIndicatorPreviewed");this.ZMd.set(2,"CatchUpIndicatorSelected");this.a4d=0}Jmi(b,h){if(this.Afb.J(h).add(b)){this.iym(h);switch(h){case 0:v.ULS.sendTraceTag(592545740,377,50,"LogIndicatorTelemetry: indicator rendered");break;case 1:v.ULS.sendTraceTag(592545739,377,50,"LogIndicatorTelemetry: indicator hovered");
break;case 2:v.ULS.sendTraceTag(592545738,377,50,"LogIndicatorTelemetry: indicator clicked");break;case 3:v.ULS.sendTraceTag(528593420,377,50,"LogIndicatorTelemetry: indicator visible")}this.Olh()}}kVm(b){this.b3k();b=this.dW.CAb(b);for(let h of b)if(this.BQ.remove(h)){this.a4d++;break}}b3k(){if(!this.BQ){this.BQ=new zd.a(new dg.a);for(let b of this.dW.BQ)this.BQ.add(b)}}fak(){v.ULS.sendTraceTag(590890074,377,50,"Total number of renderable indicators: {0}",this.a4d);this.Olh()}Olh(){this.a4d&&(this.Ztk(),
this.Ktk())}Ztk(){!this.Lfi&&.5<=this.Afb.J(0).count/this.a4d&&(this.Lfi=!0,Lb.c(ab.a.osk),v.ULS.sendTraceTag(590926531,377,50,"User started Catch Up Passive Session"))}Ktk(){if(!this.sNd){var b="";1<=this.Afb.J(1).count&&(this.sNd=!0,b="previews");1<=this.Afb.J(2).count&&(this.sNd=!0,b="selections");this.sNd&&(Lb.c(ab.a.gsk),v.ULS.sendTraceTag(590926532,377,50,"User started Catch Up Active Session due to {0}",b))}}iym(b){(b=this.ZMd.get(b))&&this.Ye.logKpiUsage(b,0)}}Object(n.a)(Ia,"IndicatorTelemetryActor",
null,[]);var Za=d(511);d(1033);class tb{constructor(b,h){this.$_c=b;this.pAc=h}hPl(){return this.pAc.promise.then(b=>b.getWywaActivitiesResponse)}getActivities(b,h){return Za.b(this.$_c.requestActivities(b,h))}getRelevantActivities(b,h){return this.pAc.promise.then(r=>r.getWywaActivitiesResponse.WywaWaterline===b?Promise.resolve(r.getRelevantActivitiesResponse):Za.b(this.$_c.requestRelevantActivities(b,h)))}updateActivityState(b){return Za.b(this.$_c.updateActivityState(b))}getActivityFeed(){return this.pAc.promise.then(b=>
void 0!==b.activityFeed?Promise.resolve(b.activityFeed):Za.b(this.$_c.requestActivityFeed()))}updateWaterline(){return Za.b(this.$_c.Qvn())}}Object(n.a)(tb,"ActivityRepository",null,[]);var gc=d(1035);class Ac{constructor(b){this.rl=b}get jf(){return this.rl&&this.rl.wi?this.rl:null}mdc(b,h){return this.jf?this.jf.sVe(b,!0)?this.jf.mdc(b,h,!0,!0):(v.ULS.sendTraceTag(579396803,377,15,"ScrollToHighlightParagraph: unable to scroll to desired paragraph"),null):null}}Object(n.a)(Ac,"PageViewWrapper",null,
[]);class ad{constructor(b,h,r,z,R){this.activityContentManager=b;this.zc=h;this.IZk=r;this.Ye=z;this.d1l=R}dyf(b){let h=new Map;h.set("activityType",b.type.toString());this.Ye.logKpiUsage("CatchUpNavigateToActivity",0,{extendedProperties:h})}wxf(b){this.Ye.logKpiFailure("CatchUpNavigateToActivity",b,{},{name:"CatchUpExperienceDegraded",errorNameOverride:"NavigateToActivityFailed"})}AKm(b){try{const h=b.activity;this.dyf(b.activity);1==h.type&&this.d1l.FTd();if(!this.activityContentManager.doesContentExist(h))return this.activityContentManager.Jco(h),
this.wxf("Content does not exist"),Promise.resolve(2);const r={};let z=0;switch(h.type){case 2:case 3:case 4:case 6:case 8:case 9:case 7:case 10:r.ActivityId=h.activityId;r.NavigationId=atob(h.navigationId);z=this.zc.Xb(ab.a.XXe,2,r);break;case 1:r.Activity=h,r.NodeId=b.locationId,z=this.zc.Xb(Oa.a.A0f,2,r),r.NodeId&&this.zc.Xb(Oa.a.fTd,2,r)}8==z&&this.wxf("Action failed")}catch(h){return v.ULS.sendTraceTag(592237846,3012,10,"Exception thrown trying to navigate to an activity. {0}",h),this.wxf("Exception was thrown"),
Promise.resolve(3)}return Promise.resolve(1)}navigateToActivity(b){return this.IZk.Bsb.then(()=>this.AKm(b))}}Object(n.a)(ad,"WordActivityNavigationManager",null,[584]);var vd;(function(b){b[b.default=0]="default";b[b.D48X48=1]="D48X48";b[b.D64X64=2]="D64X64";b[b.D96X96=3]="D96X96";b[b.D120X120=4]="D120X120";b[b.D240X240=5]="D240X240";b[b.D360X360=6]="D360X360";b[b.D432X432=7]="D432X432";b[b.D504X504=8]="D504X504";b[b.D648X648=9]="D648X648"})(vd||(vd={}));Object(n.b)("ProfilePhotoDimension",vd);var Kd=
d(781),Ne=d(1453),Of=d(529);class gh{constructor(){this.lowWaterline=this.highWaterline=this.wywaWaterline=this.actors=this.activities=null;this.hasMore=!1;this.isFirstDocumentOpen=null}}Object(n.a)(gh,"ActivityRequestPayload",null,[]);class Yi{constructor(){this.color=this.imageUrl=this.email=this.displayName=this.provider=this.id=null}}Object(n.a)(Yi,"Person",null,[]);class og extends Re{constructor(){super();this.relationship=0}}Object(n.a)(og,"TaskActivity",Re,[]);class Ji extends Re{constructor(){super();
this.contentId=null}}Object(n.a)(Ji,"CommentActivity",Re,[]);class Jk extends Ji{constructor(){super()}}Object(n.a)(Jk,"CommentReplyActivity",Ji,[]);class Ph extends Ji{constructor(){super();this.vDi=null}}Object(n.a)(Ph,"MentionActivity",Ji,[]);class ef{constructor(b,h,r,z){this.gnb=b;this.Y8a=h;this.xDe=r;this.fN=z;this.fN.isFirstDocumentOpen=!1}requestWYWAActivities(){return this.gnb.hPl().then(b=>{if(!b||b.StatusCode&&155!==b.StatusCode)throw this.r0e("GetWYWAActivities",b);155===b.StatusCode&&
(v.ULS.sendTraceTag(40433563,377,50,"No waterline is found on GetWywaActivities request."),this.fN.isFirstDocumentOpen=!0);const h=this.u6f(b.People);return Object.assign(new gh,{activities:this.vbe(b.Activities,h),actors:h,hasMore:!b.AllWYWA,highWaterline:b.HighWaterline,lowWaterline:b.LowWaterline,wywaWaterline:b.WywaWaterline,isFirstDocumentOpen:155===b.StatusCode})})}requestActivities(b,h){return this.gnb.getActivities(b,h).then(r=>{if(!r||r.StatusCode)throw this.r0e("GetActivities",r);const z=
this.u6f(r.People);return Object.assign(new gh,{activities:this.vbe(r.Activities,z),actors:z,hasMore:!r.RequestedRetrieved,highWaterline:r.HighWaterline,lowWaterline:r.LowWaterline})})}requestRelevantActivities(b){return this.gnb.getRelevantActivities(b,this.fN.isFirstDocumentOpen).then(h=>{if(!h||h.StatusCode)throw this.r0e("GetRelevantActivities",h);const r=this.u6f(h.People),z=this.vbe(h.NewActivities,r,2);h=this.vbe(h.OutstandingActivities,r,3);for(let R of h)z.push(R);return Object.assign(new gh,
{activities:z,actors:r})})}updateActivityState(b){return this.gnb.updateActivityState(b)}requestActivityFeed(){return this.gnb.getActivityFeed().then(b=>({activityFeedItems:b}))}vbe(b,h,r=1){const z=[];if(!b)return z;for(let ta of b){var R=null;b=[];b.push(h[ta.CreatorIndex]);switch(ta.ActivityType){case 1:R=ta;var ba=new ih;ba.Wu=new Ua.a;for(let Wa of R.ChangeIds)ba.Wu.add(qi.b(Wa));ba.objectId=qi.b(R.ObjectId);R=ba;break;case 2:R=ta;ba=new Ji;ba.contentId=R.ContentId;ba.navigationId=R.NavigationId;
R=ba;break;case 4:R=ta;ba=new Ph;b.push(h[R.MentioneeIndex]);ba.vDi=R.ParentContentId;ba.navigationId=R.NavigationId;R=ba;break;case 3:case 10:R=ta;ba=new Jk;b.push(h[R.RepliedIndex]);ba.contentId=R.ContentId;ba.navigationId=R.NavigationId;R=ba;break;case 6:case 7:case 8:case 9:R=ta,ba=new og,b.push(h[R.MentioneeIndex]),ba.navigationId=R.NavigationId,ba.relationship=R.Relationship,R=ba}R&&(R.actors=b,R.displayTimestamp=new Date(ta.DisplayTimestamp),R.activityId=qi.b(ta.ActivityId).toString(),R.type=
ta.ActivityType,1!==r&&(R.relevancy=r),z.push(R))}return z}Hyn(b,h,r){return this.xDe&&!qf.b(b)&&this.xDe.OQd?this.xDe.t_b(h,r,t.AFrameworkApplication.xm,vd.default):b}u6f(b){if(!b)return null;const h=Array(b.length);for(let r=0;r<b.length;r++){if(!b[r])continue;const z=new Yi;z.id=b[r].Id;z.provider=b[r].Provider;z.displayName=b[r].DisplayName;z.email=b[r].Email;z.imageUrl=this.Hyn(b[r].PictureUrl,b[r].Email,b[r].Provider);this.Y8a&&(z.color=this.Y8a.WJc(new Kd.a(z.email,void 0,z.displayName),Ne.a.catchUpFlyout));
h[r]=z}return h}r0e(b,h){let r="null";h&&(r=Of.a[h.StatusCode]);return Error.create(String.format("{0} failed with status code: {1}.",b,r))}}Object(n.a)(ef,"WordActivityRequestManager",null,[579]);class Me{constructor(b,h,r){this.ugd=0;this.buc=!1;this.MNg=null;this.updateWaterline=()=>{if(vb.App.lostSession)v.ULS.sendTraceTag(51217553,391,100,"The session is lost. Stop fetching new activities.");else if(this.buc||3>=this.ugd){this.buc?this.buc=!1:this.ugd++;const z=Math.max(this.Oa.rc("WordEditorActivityManagementMaturityMiliSeconds",
30001)+5E3-(+new Date-+this.MNg),0);v.ULS.sendTraceTag(39396256,391,100,"Requesting new activities in {0}ms",z);ee.Task.delay(z).continueWith(()=>{this.gnb.updateWaterline().then(()=>{this.x5d();return null}).catch(()=>{this.x5d();this.buc=!0;this.ugd=0})})}else this.x5d()};this.Oa=b;this.gnb=r;h.vPe(()=>{this.buc=!0;this.MNg=new Date;this.ugd=0})}start(){this.x5d()}x5d(){window.setTimeout(this.updateWaterline,6E4)}}Object(n.a)(Me,"WordEditorActivityScheduler",null,[]);class kf{constructor(){this.resolve=
null;this.promise=new Promise(b=>{this.resolve=b})}RHn(b){this.resolve(b)}}Object(n.a)(kf,"CatchUpNetworkRequestWorkerCache",null,[]);class Nf{constructor(b,h,r){this.KPk=b;this.K=h;this.Ye=r}eJf(b){b&&b.authors&&this.cym(b.authors)}cym(b){for(let h of b)h&&h.displayName===this.KPk&&(this.Ye.logKpiFailure("CatchUpActivitiesReady","CatchUpShowsChangesFromCurrentAuthor",{isIntentional:!1},{name:"CatchUpExperienceDegraded"}),v.ULS.sendTraceTag(571745507,377,15,"LogIfWywaAuthorMatchesCurrentUser: WYWA author has same name as current user [same id={0},same email={1}]",
h.id===this.K.lb("PresenceUserId"),h.email===this.K.lb("UserPrincipalName")))}}Object(n.a)(Nf,"WywaAuthorComparator",null,[]);class Fg{constructor(b){this.t_=b}FTd(){this.t_&&this.t_.execute(b=>b.logActivity("CatchUpIndicatorSurveyNomination",null))}}Object(n.a)(Fg,"IndicatorSurveyActor",null,[]);var gk=d(1007),yi=d(1E3);class hk{constructor(){this.psk={crewAlias:"webasynccollabeng",featureName:"CatchUp",topLevelKpiName:"CatchUpFeatureUsage",vetoPillar:7}}get name(){return"WordEditor.CatchUpActivity"}get isk(){return t.AFrameworkApplication.K.$("CatchUpActivityIsEnabled")}get upf(){return t.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ChangeSummariesEnabled",
!1)}get eci(){return t.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CatchUpDynamicEntryPointEnabled",!1)}get Abi(){return t.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CatchUpCustomDynamicEntryPointEnabled",!1)}get Zof(){return t.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ActivityFeedIsEnabled",!1)}get jNc(){return t.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.isCatchUpActivitiesReadyTelemetryFixEnabled",
!1)}get Gmm(){return t.AFrameworkApplication.K.$("IsUserFromDifferentTenant")}yc(b){ln("Configure");this.container=b;b.ha("WordEditor.CatchUpActivity.Worker.CatchUpNetworkRequestWorkerCache",()=>new kf).singleInstance()}init(){ln("Init");this.isk&&(O.a.instance.registerOnPackageInit("WordEditor.Workers",()=>{this.container.resolve("Box4.Workers.IWebWorkerRouter").sendMessage(2,4,t.AFrameworkApplication.rootQuerySignature,vb.App.webServiceBase+"OneNote.ashx",2,this.Zof)}),ln("HotStore"),vb.App.jha.dCb.execute(()=>
{ln("ChromeReady");Si.a.get_instance().tl(7,()=>{ln("ScriptDownload");(t.AFrameworkApplication.K.$("DynamicBundlesIsEnabled")?appResourceLoader.loadChunk("catchUpActivity"):this.container.resolve("Common.IDynamicScriptLoaderProvider").JE.loadScript("catchUpActivity")).catch(b=>{v.ULS.sendTraceTag(592233361,377,10,"Failed to load the resources for the CatchUpActivity feature: {0}",b)}).then(()=>this.OPm()).catch(b=>{v.ULS.sendTraceTag(36548867,377,10,"Failed to initialize the CatchUpActivity feature: {0}",
b)})})}))}OPm(){ln("CreateObjectsAndInitializeState");this.fxm();this.FHk();return this.Z2l()}fxm(){v.ULS.sendTraceTag(592217358,377,50,"CatchUpActivity feature enabled successfully");v.ULS.sendTraceTag(589608192,3012,50,"Catch Up script is loaded and Flyout is enabled.");v.ULS.sendTraceTag(594401288,3012,50,"Tasks and outstanding data is enabled");this.upf&&v.ULS.sendTraceTag(588130079,3012,50,"ChangeSummaries is enabled");this.eci&&v.ULS.sendTraceTag(553911650,3012,50,"DynamicEntryPoint is enabled");
this.Abi&&v.ULS.sendTraceTag(553769042,3012,50,"CustomDynamicEntryPoint is enabled");v.ULS.sendTraceTag(545036493,3012,50,"IsUserFromDifferentTenant: {0}",this.Gmm);this.Zof&&v.ULS.sendTraceTag(526718752,3012,50,"ActivityFeedData is enabled")}Z2l(){this.E3l();this.container.resolve("WordEditor.CatchUpActivity.FlyoutRibbonButton").g$e=new Date;ln("InitializeCatchUpApp");return this.RYb.initialize(Object.assign(new sl,{featuredActivityGroupsEnabled:this.upf,summaryStringEnabled:!0,dynamicEntryPointEnabled:this.eci,
customDynamicEntryPointEnabled:this.Abi,activityFeedDataEnabled:this.Zof})).then(()=>{this.container.resolve("WordEditor.CatchUpActivity.WordEditorActivityScheduler").start()})}FHk(){this.container.ha("WordEditor.CatchUpActivity.ChangeIdCache",()=>new Zr(this.container.resolve("WordEditor.CatchUpActivity.IChangeIdObjectIdCache"),ja.App.fm.jb.Ic.rd)).singleInstance();this.container.ha("WordEditor.CatchUpActivity.IFeatureUsageAndHealthLogger",()=>new gk.a(Ca.Health.instance,new yi.a,this.psk)).singleInstance();
this.container.ha("WordEditor.CatchUpActivity.IActivityStateManager",()=>new so).singleInstance();this.container.ha("WordEditor.CatchUpActivity.ActivityContentManager",()=>new Dg(this.container.resolve("WordEditor.CatchUpActivity.ChangeIdCache"),t.AFrameworkApplication.ya,Uk.UISurfaces.bK(),t.AFrameworkApplication.K.$("CatchUpFlyoutMockDataIsEnabled"))).as("Common.App.CatchUpActivity.IActivityContentManager").singleInstance();this.container.ha("WordEditor.CatchUpActivity.Network.ActivityRepository",
()=>new tb(new gc.a(Sg.a.$aj(this.container.Za("Common.App.CatchUpActivity.ICatchUpNetworkingWrapper")),()=>t.AFrameworkApplication.rootQuerySignature,vb.App.webServiceBase+"OneNote.ashx",2,Sg.a.$aj(this.container.Za("Common.App.CatchUpActivity.ICatchUpRequestHandler"))),this.container.resolve("WordEditor.CatchUpActivity.Worker.CatchUpNetworkRequestWorkerCache"))).singleInstance();this.container.ha("Common.App.CatchUpActivity.IActivityRequestManager",()=>new ef(this.container.resolve("WordEditor.CatchUpActivity.Network.ActivityRepository"),
this.container.resolve("Common.App.People.IPeopleColorUtils"),this.container.resolve("Common.App.People.IUserProfilePictureUtilsV2"),this.container.resolve("WordEditor.CatchUpActivity.IActivityStateManager"),t.AFrameworkApplication.K.$("CatchUpFlyoutMockDataIsEnabled"))).singleInstance();this.container.ha("WordEditor.CatchUpActivity.ActivityHighlightManager",()=>new zn(this.container.resolve("Box4.Highlight.IHighlightManager"),this.container.resolve("WordEditor.CatchUpActivity.IActivityStateManager"),
this.container.resolve("WordEditor.CatchUpActivity.ChangeIdCache"),ja.App.fm.jb.Ic,new Ac(ja.App.fm.jb.Ic),di.a.instance,ve.FocusManager.instance(),this.container.resolve("Common.Utils.IAriaNotifier"))).singleInstance();this.container.ha("WordEditor.CatchUpActivity.DocumentTraverser",()=>{let b;b=t.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.InteractivePerfYieldableDocumentTraversalIsEnabled",!1)?new Ro.a(50,Ed.a.lf):new xp;return new Lp(t.AFrameworkApplication.uc,b,
ja.App.fm.jb.Ic.rd)}).singleInstance();this.container.ha("WordEditor.CatchUpActivity.IndicatorSurveyActor",()=>new Fg(this.container.Za("Common.ISystemInitiatedFeedback"))).singleInstance();this.container.ha("Common.App.CatchUpActivity.IActivityNavigationManager",()=>new ad(this.container.resolve("WordEditor.CatchUpActivity.ActivityContentManager"),t.AFrameworkApplication.ya,this.container.resolve("WordEditor.CatchUpActivity.DocumentTraverser"),this.container.resolve("WordEditor.CatchUpActivity.IFeatureUsageAndHealthLogger"),
this.container.resolve("WordEditor.CatchUpActivity.IndicatorSurveyActor"),t.AFrameworkApplication.K.$("CatchUpFlyoutMockDataIsEnabled"))).singleInstance();this.container.ha("WordEditor.CatchUpActivity.FlyoutRibbonButton",()=>new Qm(t.AFrameworkApplication.ya,this.container.resolve("Common.App.CatchUpActivity.FloodgateEventLogger"),ve.FocusManager.instance())).as("Common.App.CatchUpActivity.IFlyoutRibbonButton").singleInstance();this.container.ha("WordEditor.CatchUpActivity.FlyoutFocus",()=>new uq(mn.a.instance,
ve.FocusManager.instance())).as("Common.App.CatchUpActivity.IFlyoutFocus").singleInstance();this.container.ha("WordEditor.CatchUpActivity.FeaturedActivityGroupCache",()=>new Zp).singleInstance();this.container.ha("WordEditor.CatchUpActivity.ActivityIndicatorHelper",()=>new Tq(this.container.resolve("WordEditor.CatchUpActivity.ChangeIdCache"),this.container.resolve("WordEditor.Indicator.TopLevelOutlineElementCache"),ja.App.fm.jb.Ic)).singleInstance();this.container.ha("WordEditor.CatchUpActivity.FeaturedActivityGroupTelemetryActor",
()=>new tl(this.container.resolve("WordEditor.CatchUpActivity.FeaturedActivityGroupCache"))).singleInstance();this.container.ha("Common.App.CatchUpActivity.IChangeSummariesDataProvider",()=>new Vq(new ur(this.container.resolve("WordEditor.CatchUpActivity.ChangeIdCache"),this.container.resolve("WordEditor.CatchUpActivity.FeaturedActivityGroupTelemetryActor")),new Kp(this.container.resolve("Box4.AugmentationLoop.IUtilsWrapper"),this.container.resolve("Box4.AugmentationLoop.IAlFactoryWrapper"),this.container.resolve("Box4.AugmentationLoop.IAnnotationStorage"),
t.AFrameworkApplication.uc),new yp(this.container.resolve("WordEditor.CatchUpActivity.ActivityIndicatorHelper")),this.container.resolve("WordEditor.CatchUpActivity.DocumentTraverser"),this.container.resolve("WordEditor.CatchUpActivity.FeaturedActivityGroupCache"),t.AFrameworkApplication.K.$("CatchUpFlyoutMockDataIsEnabled"))).singleInstance();this.RYb=catchUpActivity.FactoryGlobal.getWordCatchUpAppInstance(Object.assign(new V,{activityContentManager:this.container.resolve("Common.App.CatchUpActivity.IActivityContentManager"),
activityNavigationManager:this.container.resolve("Common.App.CatchUpActivity.IActivityNavigationManager"),activityRequestManager:this.container.resolve("Common.App.CatchUpActivity.IActivityRequestManager"),appColorUpdateIsEnabled:t.AFrameworkApplication.K.$("AppColorUpdateIsEnabled"),changeSummariesDataProvider:this.container.resolve("Common.App.CatchUpActivity.IChangeSummariesDataProvider"),dataCulture:t.AFrameworkApplication.dataCulture,flyoutRibbonButton:this.container.resolve("Common.App.CatchUpActivity.IFlyoutRibbonButton"),
flyoutFocus:this.container.resolve("Common.App.CatchUpActivity.IFlyoutFocus"),uiCulture:t.AFrameworkApplication.uiCulture,ulsLogger:new an.a}));this.RYb.setWebpackPublicPath(t.AFrameworkApplication.C3);this.container.ha("WordEditor.CatchUpActivity.ActivityHighlightActor",()=>new bn(this.container.resolve("WordEditor.CatchUpActivity.IActivityStateManager"),this.container.resolve("WordEditor.CatchUpActivity.ChangeIdCache"))).singleInstance();this.container.ha("WordEditor.CatchUpActivity.WordEditorActivityScheduler",
()=>new Me(t.AFrameworkApplication.K,Xl.a.instance,this.container.resolve("WordEditor.CatchUpActivity.Network.ActivityRepository"))).singleInstance();this.container.ha("WordEditor.CatchUpActivity.IndicatorTelemetryActor",()=>new Ia(this.container.resolve("WordEditor.CatchUpActivity.ChangeIdCache"),this.container.resolve("WordEditor.CatchUpActivity.IFeatureUsageAndHealthLogger"))).singleInstance();this.container.ha("WordEditor.CatchUpActivity.ActivityIndicatorActor",()=>new hp(this.container.resolve("WordEditor.CatchUpActivity.ChangeIdCache"),
this.RYb.getActivityIndicatorTooltipManager(),this.container.resolve("WordEditor.CatchUpActivity.IndicatorTelemetryActor"),this.container.resolve("WordEditor.CatchUpActivity.IndicatorSurveyActor"),ja.App.fm.jb.Ic,this.container.Za("Common.IZoomManager"),t.AFrameworkApplication.uc,this.container.resolve("WordEditor.CatchUpActivity.ActivityIndicatorHelper"),!!vb.App.instance&&vb.App.instance.gma,this.container.resolve("WordEditor.PageBackground.PageBackgroundColorHandler"),!!vb.App.instance&&vb.App.instance.JA)).singleInstance();
this.container.ha("WordEditor.CatchUpActivity.ActivityIndicatorManager",()=>new Xp(this.container.resolve("Box4.Indicator.IIndicatorManagerFactory").instance,ja.App.fm.jb.Ic.rd,this.container.resolve("WordEditor.CatchUpActivity.ActivityIndicatorActor"),t.AFrameworkApplication.ya,this.container.resolve("WordEditor.CatchUpActivity.ChangeIdCache"),this.container.resolve("WordEditor.CatchUpActivity.IFeatureUsageAndHealthLogger"),this.jNc)).singleInstance();this.container.ha("WordEditor.CatchUpActivity.ActivityAnnouncementManager",
()=>new Nb(this.container.resolve("WordEditor.CatchUpActivity.ChangeIdCache"),this.container.resolve("Common.Utils.IAriaNotifier"),t.AFrameworkApplication.ya,ve.FocusManager.instance())).singleInstance();this.container.ha("WordEditor.CatchUpActivity.WywaAuthorComparator",()=>new Nf(t.AFrameworkApplication.userName,t.AFrameworkApplication.K,this.container.resolve("WordEditor.CatchUpActivity.IFeatureUsageAndHealthLogger"))).singleInstance()}E3l(){var b=this.container.resolve("Box4.Highlight.IHighlightManager"),
h=this.container.resolve("WordEditor.CatchUpActivity.ActivityHighlightActor");b.tjb(h);const r=this.container.resolve("WordEditor.CatchUpActivity.ActivityHighlightManager");b=this.container.resolve("WordEditor.CatchUpActivity.ActivityIndicatorManager");const z=this.container.resolve("WordEditor.CatchUpActivity.ActivityIndicatorActor");h=this.container.resolve("WordEditor.CatchUpActivity.ActivityAnnouncementManager");const R=this.container.resolve("WordEditor.CatchUpActivity.IActivityStateManager"),
ba=di.a.instance,ta=this.container.resolve("WordEditor.CatchUpActivity.DocumentTraverser");ba.oB(()=>{R.QPd?R.QPd=!1:(R.w2a&&r.dAi(null,null,!1),R.Seb&&r.pzi(null,null),z.PWe())});ba.oB(Object(u.a)(h,h.a_,"onSelectionChanged"));this.RYb.getWywaEvent().addListener(Object(u.a)(b,b.eJf,"onWywaActivityReady"));b=this.container.resolve("WordEditor.CatchUpActivity.WywaAuthorComparator");this.RYb.getWywaEvent().addListener(Object(u.a)(b,b.eJf,"onWywaActivityReady"));const Wa=this.container.resolve("WordEditor.CatchUpActivity.IndicatorTelemetryActor");
ta.V7j((ub,Ib)=>{Ib&&Wa.kVm(Ib.node)});ta.Bsb.then(()=>{Wa.fak()});this.RYb.getWywaEvent().addListener(()=>{ta.Mhk()});z.m6j((ub,Ib)=>{Ib&&r.pzi(Ib.kzb,Ib.w7h)});z.n6j((ub,Ib)=>{Ib&&r.dAi(Ib.kzb,Ib.w7h,Ib.wUn)});z.Vb(t.AFrameworkApplication.ya);this.upf&&this.container.resolve("WordEditor.CatchUpActivity.FeaturedActivityGroupTelemetryActor").Vb(t.AFrameworkApplication.ya);this.container.resolve("WordEditor.CatchUpActivity.FlyoutRibbonButton").initialize();this.container.resolve("WordEditor.CatchUpActivity.FlyoutFocus").initialize();
this.container.resolve("WordEditor.CatchUpActivity.ActivityIndicatorManager").initialize();this.zYn()}zYn(){yh.c()&&(v.ULS.sendTraceTag(591673372,3012,50,"WordEditorCatchUpActivityPackageManager.ShowRibbonControls"),appChrome.api.dispatch([appChrome.actions.updateControlHiddenState("MarkCatchUpChangeAsRead",!1)]))}dispose(){}}Object(n.a)(hk,"WordEditorCatchUpActivityPackageManager",null,[1,2]);var Vj=d(148),pk=d(439),vq=d(1480),io=d(489),ru=d(1573),zp=d(1488),Il=d(1628),jp=d(1629),ys=d(648),Ir=d(1630),
Wt=d(843),Kq=d(144),Dn=d(1495);class Ml{constructor(){this.ft=this.annotation=null}}Object(n.a)(Ml,"AnnotationChangedData",null,[]);class kp{constructor(b,h,r,z,R,ba,ta,Wa=!1,ub){this.annotationType=b;this.xVa=h;this.iq=r;this.r$d=z;this.s4c=R;this.Doo=ba;this.jb=ta;this.u2i=Wa;this.K=ub;this.hx=null;this.Ofi=!1;this.me=new Te.a;this.WSc=0}YE(b){this.me.addHandler("AnnotationChangedEvent",b)}jH(b){this.me.removeHandler("AnnotationChangedEvent",b)}register(){return this.s4c().then(()=>{0===this.WSc&&
(this.u2i&&(this.hx=this.iq.hg("WebServiceCall",this.annotationType)),this.xVa.mb(this,this.annotationType));this.WSc++})}unregister(){return this.s4c().then(()=>(new Promise(b=>setTimeout(b,this.K.rc(Kq.a.LUk,3E3)))).then(()=>{0<this.WSc&&(this.WSc--,0===this.WSc&&this.xVa.sc(this,this.annotationType))}))}c2b(){return this.s4c().then(()=>this.xVa.getAnnotationsByType(this.annotationType))}eMh(b){b=pk.a.aK(b);return(b=this.xVa.dMh(b))&&0<b.count?b.toArray().filter(h=>to.a.matchesTypesFor(h.content,
[this.annotationType])):[]}getParent(b){return b?b.parent?b.parent:b.parentPath?this.Doo(this.jb.Yc.zd,b.parentPath):null:(v.ULS.shipAssertTag(575930380,3016,!1),null)}tsa(b){b.timestamp||(b.timestamp=Date.now());b=Object.assign(new Wt.a,{parentPath:["Signal",to.a.getTypeNameFor(b)],items:[Object.assign(new Uq.a,{body:b})]});this.r$d.submitOperation(b)}b1k(b,h,r,z){b=Object.assign(new ip.a,{parentPath:["Signal",h,r,z],items:[Object.assign(new Uq.a,{body:b})]});this.r$d.submitOperation(b)}wI(b,h){b?
h?(this.u2i&&!this.Ofi&&(this.hx.stop(),this.Ofi=!0),this.me.Oea&&(b=new Dn.a(Object.assign(new Ml,{annotation:b,ft:h})),this.me.raiseEvent("AnnotationChangedEvent",b))):v.ULS.shipAssertTag(575930382,3016,!1):v.ULS.shipAssertTag(575930381,3016,!1)}}Object(n.a)(kp,"AnnotationManager",null,[624,250]);class $p{constructor(b,h,r,z,R,ba,ta,Wa,ub,Ib,$b){this.hI=b;this.$4d=h;this.zzb=r;this.WXa=z;this.T5=R;this.uaj=ba;this.K_=ta;this.qLb=Wa;this.t0b=ub;this.EHb=Ib;this.t6n=$b}}Object(n.a)($p,"AnnotationManagerHolder",
null,[623]);class Q{constructor(b,h){this.S$j=b;this.s4c=h}submitOperation(b){return this.s4c().then(()=>{this.S$j.getAugLoopRuntimeManager().submitOperation(Object.assign(new $r.a,{operation:b}))})}}Object(n.a)(Q,"SubmitOperationHelper",null,[]);var ya=d(858),gb=d(1631),Ob=d(1031),mc=d(64),dd=d(134),Md=d(89),He=d(1058);class Ue{constructor(b,h,r){this.T5=b;this.jn=h;this.OCi=r;this.rAa={};this.ZAh=!1;this.cib=(z,R)=>{R.data.ft!==ip.a.getTypeName()&&R.data.ft!==He.n.getTypeName()||!R.data.annotation||
R.data.annotation.annotationType!==gb.a.getTypeName()||(z=R.data.annotation.content)&&z.documentTypeConfidences.length&&(this.YAh=z.documentTypeConfidences[0].documentTypeLabel,v.ULS.sendTraceTag(541078657,3016,50,"Document type obtained: {0}",this.YAh))};this.T5.YE(this.cib);this.T5.register();this.rAa={["docType"]:null,["characterCount"]:null,["paragraphCount"]:null,["imageCount"]:null,["tableCount"]:null,["listElementsCount"]:null,["blobsCount"]:null,["pageCount"]:null,["currentPage"]:null}}AIc(){this.ZAh||
(this.T5.tsa(new Ob.a),v.ULS.sendTraceTag(541078658,3016,50,"Document type classifier signal sent"),this.ZAh=!0);this.QYk();this.rAa.docType=this.YAh;this.rAa.characterCount=this.characterCount;this.rAa.paragraphCount=this.f_;this.rAa.imageCount=this.iQ;this.rAa.tableCount=this.moa;this.rAa.listElementsCount=this.eli;this.rAa.blobsCount=this.Efh;this.rAa.pageCount=this.OCi.TJc();this.rAa.currentPage=this.OCi.VVh();return this.rAa}QYk(){this.f_=this.Efh=this.eli=this.moa=this.iQ=this.characterCount=
0;var b=this.jn.WAa(ja.App.fm.jb.Ic.rd,7,7).currentNode,h=Nd.GraphIterator.$a(b);for(b=Cn.a.Kr(h,b);b.moveNext();)if(h=b.currentNode)if($d.ImageReader.ww(h))this.iQ++;else if(Ii.TableReader.fX(h))this.moa++;else if(mc.ListReader.w2(h))this.eli++;else if(ie.ParagraphReader.nc(h)){var r=Md.e(h);for(let z=0;z<r.length;z++)5===r[z].si?this.iQ++:this.Efh++;r=dd.AParagraphNode.lU(h.characterData);r=r.trim();this.characterCount+=r.length;0<r.length&&!ie.ParagraphReader.O$(h)&&!ie.ParagraphReader.iK(h)&&
this.f_++}}}Object(n.a)(Ue,"LoggingDocumentInfo",null,[621]);class Sf{constructor(){this.sa=new Te.a}p8j(b){this.sa.addHandler("OnTaskPaneReviewStateChanged",b)}Zrn(b){this.sa.removeHandler("OnTaskPaneReviewStateChanged",b)}o7j(b){this.sa.addHandler("BlueDotClickedEvent",b)}Hrn(b){this.sa.removeHandler("BlueDotClickedEvent",b)}D7j(b){this.sa.addHandler("OnFormattingMarkedForReview",b)}F7j(b){this.sa.addHandler("OnFormattingReviewCompleted",b)}C7j(b){this.sa.addHandler("OnFormattingAccept",b)}E7j(b){this.sa.addHandler("OnFormattingReject",
b)}e8j(b){this.sa.addHandler("OnReviewInvalidated",b)}N$g(b){this.sa.addHandler("OnTraigeAction",b)}uPe(b){this.sa.addHandler("OnReviewVisibilityChanged",b)}Trn(b){this.sa.removeHandler("OnReviewVisibilityChanged",b)}m7j(b){this.sa.addHandler("OnBeforeReviewNavigation",b)}a8j(b){this.sa.addHandler("OnRegisterEnhancement",b)}r8j(b){this.sa.addHandler("onTooltipVisibilityChanged",b)}$rn(b){this.sa.removeHandler("onTooltipVisibilityChanged",b)}RWc(b){b?this.sa.raiseEvent("OnTaskPaneReviewStateChanged",
new Dn.a(b)):v.ULS.shipAssertTag(575930374,3016,!1)}uen(b){b?this.sa.raiseEvent("BlueDotClickedEvent",new Dn.a(b)):v.ULS.shipAssertTag(575930375,3016,!1)}xen(b){b?this.sa.raiseEvent("OnFormattingMarkedForReview",new Dn.a(b)):v.ULS.shipAssertTag(575930376,3016,!1)}lJi(b){b?this.sa.raiseEvent("OnFormattingReviewCompleted",new Dn.a(b)):v.ULS.shipAssertTag(573850377,3016,!1)}wen(b){b?this.sa.raiseEvent("OnFormattingAccept",new Dn.a(b)):v.ULS.shipAssertTag(575930377,3016,!1)}yen(b){b?this.sa.raiseEvent("OnFormattingReject",
new Dn.a(b)):v.ULS.shipAssertTag(575930378,3016,!1)}zen(b){b?this.sa.raiseEvent("OnReviewInvalidated",new Dn.a(b)):v.ULS.shipAssertTag(575930379,3016,!1)}JPf(b){b?this.sa.raiseEvent("OnTraigeAction",new Dn.a(b)):v.ULS.shipAssertTag(573850378,3016,!1)}mJi(b){b?this.sa.raiseEvent("OnReviewVisibilityChanged",new Dn.a(b)):v.ULS.shipAssertTag(573850379,3016,!1)}ten(b){b?this.sa.raiseEvent("OnBeforeReviewNavigation",new Dn.a(b)):v.ULS.shipAssertTag(573687395,3016,!1)}Qbc(b){b?this.sa.raiseEvent("OnRegisterEnhancement",
new Dn.a(b)):v.ULS.shipAssertTag(555055117,3016,!1)}EJi(b){b?this.sa.raiseEvent("onTooltipVisibilityChanged",new Dn.a(b)):v.ULS.shipAssertTag(540587343,3016,!1)}}Object(n.a)(Sf,"ReviewEvents",null,[578]);class of{constructor(b){this.W=null;if(!b)throw Vj.a.argument("Workspace is null");this.rt=b}get name(){return"WordEditor.Designer.Common"}init(){}yc(b){b?(this.W=b,b.ha("WordEditor.Designer.Common.AL.ISubmitOperationHelper",()=>new Q(this.W.resolve("Box4.AugmentationLoop.IAlFactoryWrapper"),pk.a.En)).singleInstance(),
b.ha("WordEditor.Designer.IDesignerControl",()=>new ya.a(b.resolve("Box4.IFeatureHelper"),b.resolve("Common.IAppSettingsManager"),t.AFrameworkApplication.uiCulture)).singleInstance(),b.ha("WordEditor.Designer.Common.Review.IReviewEvents",()=>new Sf).singleInstance(),b.ha("WordEditor.Designer.Common.AL.IAnnotationManagerHolder",()=>new $p(this.Oza(zp.DocumentRoleDetectionAnnotation.getTypeName()),this.Oza(zp.RoleDetectionAnnotation.getTypeName()),this.Oza(vq.FormattingSuggestionsSummaryAnnotation.getTypeName(),
!0),this.Oza(vq.FormattingSuggestionsAnnotation.getTypeName()),this.Oza(io.DocumentTypeClassifierAnnotation.getTypeName()),this.Oza(jp.ThemeExtractorAnnotation.getTypeName()),this.Oza(ys.ThemeGeneratorAnnotation.getTypeName()),this.Oza(Il.TextToImageAnnotation.getTypeName()),this.Oza(ru.DocumentPullQuoteAnnotation.getTypeName()),this.Oza(ru.PullQuoteAnnotation.getTypeName()),this.Oza(Ir.TableTypeAnnotation.getTypeName()))).singleInstance(),b.ha("WordEditor.Designer.DocumentInfo",()=>new Ue(b.resolve("WordEditor.Designer.Common.AL.IAnnotationManagerHolder").T5,
b.resolve("Box4.Graph.IGraphIteratorFactory"),b.resolve("WordEditor.IPageNumberFinder"))).singleInstance()):v.ULS.shipAssertTag(575767060,3016,!1)}dispose(){}Oza(b,h=!1){return new kp(b,this.W.resolve("Box4.AugmentationLoop.IAnnotationStorage"),this.W.resolve("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder"),this.W.resolve("WordEditor.Designer.Common.AL.ISubmitOperationHelper"),pk.a.En,pk.a.Rdb,this.rt,h,this.W.resolve("Common.IAppSettingsManager"))}}Object(n.a)(of,"PackageManager",null,[1,2]);
var cj=d(1498),el=d(1481),qk=d(1633);class jm extends Sys.EventArgs{constructor(b,h){super();this.node=b;this.KDf=h}}Object(n.a)(jm,"RoleChangeArgs",Sys.EventArgs,[]);class Qk{constructor(b){this.uh=!1;this.eP=b;this.eP.cdd++}dispose(){this.uh||(this.uh=!0,this.eP.cdd--)}}Object(n.a)(Qk,"InvalidationSuspension",null,[9]);class Kn{constructor(){this.F1c=null;this.role=this.WUd=0;this.Evb=this.ZPd=this.bma=this.W7b=!1;this.jUd=this.ERc=this.YKa=null;this.removed=this.placeholder=!1;this.Xrd=this.aDc=
null;this.Wrd=0}get k_a(){return!this.role||!this.YKa||!this.YKa.length}N7l(){this.Evb=this.ZPd=!0}Vmm(){return!!this.role||!!this.YKa||!!this.F1c}}Object(n.a)(Kn,"RoleState",null,[608]);class yj{constructor(b,h,r,z,R,ba){this.Bh=!1;this.gNd=null;this.bzf=new Ub.a;this.EHg=0;this.Xzn=(ta,Wa)=>{Wa.data.ft===ip.a.getTypeName()&&(Wa=Wa.data.annotation,(ta=Wa.content)?(Wa=this.iUb.getParent(Wa))&&this.u_c(Wa,el.e(ta.roleType),!1,void 0,null!=ta.listID?ta.listID:0,ta.listItemlevel,ta.listItemPrefix):v.ULS.shipAssertTag(575813856,
3016,!1))};this.vZk=(ta,Wa)=>{if(Wa.data.ft===ip.a.getTypeName())if(ta=Wa.data.annotation.content)for(v.ULS.sendTraceTag(556074199,3016,50,ta.confidence.toString()),this.bzf=new Ub.a,Wa=0;ta.listInfos&&Wa<ta.listInfos.length;Wa++){const ub=ta.listInfos[Wa];this.bzf.Z(ub.listID,ub)}else v.ULS.shipAssertTag(556323522,3016,!1)};this.Fei=(ta,Wa)=>{ta=ta.gJ;if(!ta||ta.ia(yc.a.yB,!1))return!1;ta=ta.getValue(yc.a.la);if(!ta)return!1;ta=el.f(ta);return 1!=ta&&ta!=Wa.role};this.Vdl=(ta,Wa)=>{ta=Wa.data.annotation;
const ub=this.Vad.getParent(ta);if(ub)if(Wa.data.ft===ip.a.getTypeName()){const Ib=Wa.data.annotation.content;Ib?this.bba(ub,$b=>{this.gNd&&$b.aDc&&this.gNd>$b.aDc&&!$b.Evb||$b.role!==$b.WUd||this.Fei(ub,$b)?(v.ULS.sendTraceTag(572301727,3016,50,"InvalidationTimestamp: {0} | InvalidatedFlag: {1} | RlmRole==ModelRole: {2}",this.gNd,$b.Evb,$b.role===$b.WUd),$b.F1c=Ib.suggestions):($b.YKa=Ib.suggestions,$b.Evb=!1)}):v.ULS.shipAssertTag(575813859,3016,!1)}else Wa.data.ft===cj.a.getTypeName()&&this.bba(ub,
Ib=>{Ib.YKa=null;Ib.F1c=null});else v.ULS.shipAssertTag(575813858,3016,!1,`Parent not found for annotation id: ${ta.id} parentPath: ${ta.parentPath}`)};this.sSm=(ta,Wa)=>{(ta=Wa.data.paragraphNode)?this.bba(ta,ub=>{Wa.data.Wjj?(ub.Xrd=ub.YKa,ub.Wrd=ub.role):(ub.Xrd=null,ub.Wrd=0);ub.bma=!0}):v.ULS.shipAssertTag(575930368,3016,!1)};this.uSm=(ta,Wa)=>{(ta=Wa.data.paragraphNode)?this.bba(ta,ub=>{ub.bma=!1;ub.Xrd=null;ub.Wrd=0;5!==Wa.data.state&&(ub.YKa=null)}):v.ULS.shipAssertTag(573850380,3016,!1)};
this.qSm=(ta,Wa)=>{(ta=Wa.data.paragraphNode)?this.bba(ta,ub=>{ub.bma=!0}):v.ULS.shipAssertTag(575930369,3016,!1)};this.tSm=(ta,Wa)=>{(ta=Wa.data.paragraphNode)?this.u_c(ta,1,!0,!0):v.ULS.shipAssertTag(575930370,3016,!1)};this.PIf=(ta,Wa)=>{(ta=Wa.data.paragraphNode)?this.u_c(ta,Wa.data.KDf,!0,!0):v.ULS.shipAssertTag(575484484,3016,!1)};this.VQl=(ta,Wa)=>{if(Wa.node){var ub=Wa.node;ta=this.wA(ub);27==ta.role&&v.ULS.sendTraceTag(541435078,3016,50,"Pull Quote node deleted.");ta.bma&&27!==ta.role&&28!==
ta.role&&this.p1i(this.Vcc-1);ta.k_a||27===ta.role||28===ta.role||this.i1i(this.inconsistenciesCount-1);this.bba(ub,Ib=>{Ib.removed=!0});this.ZU.Lbi()||setTimeout(()=>this.removeNode(ub),1E4)}else v.ULS.shipAssertTag(575930371,3016,!1)};this.removeNode=ta=>{this.YNi(ta.id)};this.YNi=ta=>{let Wa;({value:Wa}=this.nq.Dc(ta));(null===Wa||void 0===Wa?0:Wa.removed)&&this.nq.remove(ta)};this.jqn=()=>{const ta=this.nq.keys.toArray().filter(Wa=>this.nq.J(Wa).removed);ta.sort((Wa,ub)=>this.nq.J(Wa).aDc.getTime()-
this.nq.J(ub).aDc.getTime());ta.slice(0,10).forEach(Wa=>{this.YNi(Wa)})};this.UQl=(ta,Wa)=>{Wa.node?(ta=Wa.node,this.IOc(ta)?this.bba(ta,ub=>{ub.removed=!1}):this.bba(ta,ub=>{ub.Evb=!1})):v.ULS.shipAssertTag(540672206,3016,!1)};this.WQl=(ta,Wa)=>{Wa.node?this.r_f(Wa.property,Wa.node)&&(ta=Wa.node,this.cdd||ta.r0d?this.bba(ta,ub=>{ub.Evb=!1}):this.bba(ta,ub=>{ub.N7l();ub.F1c&&(ub.YKa=ub.F1c,ub.role=ub.WUd)}).bma&&this.fUa.zen(new qk.a(Wa.node))):v.ULS.shipAssertTag(575930372,3016,!1)};this.bWm=(ta,
Wa)=>{switch(Wa.data.role){case 27:const ub=Wa.data;this.bba(Wa.data.paragraphNode,$b=>{$b.role=27;$b.W7b=!0;$b.placeholder=ub.placeholder});break;case 28:const Ib=Wa.data;this.bba(Wa.data.paragraphNode,$b=>{$b.role=28;$b.W7b=!0;$b.placeholder=Ib.placeholder;$b.FLc=Ib.FLc});break;case 2:this.bba(Wa.data.paragraphNode,$b=>{$b.role=2})}};this.Vad=b;this.iUb=h;this.Jne=r;this.ZU=ba;this.Jm=z;this.fUa=R;this.nq=new Ub.a;this.sa=new Te.a;this.cdd=this.Ekd=this.Hcd=0}get i8l(){return this.cdd}H7j(b){this.sa.addHandler(yj.Mxi,
b)}f8j(b){this.sa.addHandler(yj.Ozi,b)}J$g(b){this.sa.addHandler(yj.kIf,b)}Urn(b){this.sa.removeHandler(yj.kIf,b)}get inconsistenciesCount(){return this.Hcd}i1i(b){this.Hcd!==b&&(this.Hcd=b,this.sa.raiseEvent(yj.Mxi,new Dn.a(this.Hcd)))}get Vcc(){return this.Ekd}p1i(b){this.Ekd!==b&&(this.Ekd=b,this.sa.raiseEvent(yj.Ozi,new Dn.a(this.Ekd)))}get wlf(){return this.EHg}IOc(b){return this.nq.xb(b.id)}Gyl(b){var h,r;return null===(r=null===(h=this.bzf)||void 0===h?void 0:h.Dc(b))||void 0===r?void 0:r.value}kWh(b,
h){var r,z,R;const ba=new Map;for(const ta of h)if((h=ta)&&h.isConnected){const Wa=null!==(R=null===(z=null===(r=this.nq.Dc(h.id))||void 0===r?void 0:r.value)||void 0===z?void 0:z.role)&&void 0!==R?R:1;b.has(Wa)&&(ba.has(Wa)?ba.get(Wa).add(h):ba.set(Wa,new Ua.a([h])))}return ba}wA(b){if(!b)return v.ULS.shipAssertTag(575813855,3016,!1),null;let h;return({value:h}=this.nq.Dc(b.id)).returnValue?h:Object.assign(new Kn,{role:1,W7b:!1})}Bvn(){this.gNd=new Date;return new Qk(this)}register(){this.Vad.register();
this.iUb.register();this.Jne.register()}unregister(){this.Vad.unregister();this.iUb.unregister();this.Jne.unregister()}initialize(){if(!this.Bh){const b=this.Jm.Se(12);b.zv(this.VQl);b.ys(this.UQl);b.lp(this.WQl);this.Vad.YE(this.Vdl);this.iUb.YE(this.Xzn);this.Jne.YE(this.vZk);this.fUa.E7j(this.tSm);this.fUa.C7j(this.qSm);this.fUa.D7j(this.sSm);this.fUa.F7j(this.uSm);this.fUa.N$g(this.PIf);this.fUa.a8j(this.bWm);this.Bh=!0}}qe(){}u_c(b,h,r,z=!1,R=0,ba=0,ta){let Wa=0,ub=!1;this.bba(b,Ib=>{const $b=
Ib.ZPd||!Ib.role||1==Ib.role;r||(Ib.WUd=h);if(z||$b)ub=Ib.role!==h,Wa=Ib.role,Ib.role=h,Ib.W7b=r,Ib.ZPd=!1,Ib.ERc=R,Ib.jUd=ba,Ib.listItemPrefix=ta,Ib.aDc=new Date});if(ub){const Ib=h-4;Ib>this.wlf&&8>Ib&&(this.EHg=Ib);1===h&&this.bba(b,$b=>{$b.YKa=null});this.sa.raiseEvent(yj.kIf,new Dn.a(new jm(b,h,Wa)))}}bba(b,h){let r;if(({value:r}=this.nq.Dc(b.id)).returnValue){b=r.k_a;const z=r.bma;h(r);if(27!==r.role&&28!==r.role){if(r.removed)return r;b!==r.k_a&&this.i1i(this.inconsistenciesCount+(b?1:-1));
z!==r.bma&&this.p1i(this.Vcc+(z?-1:1))}}else h(r=new Kn),r.Vmm()&&(this.ZU.Lbi()&&this.nq.count>Kq.a.Zzn&&(v.ULS.sendTraceTag(525165656,3016,50,this.nq.count.toString()),this.jqn()),this.nq.add(b.id,r));return r}r_f(b,h){({value:h}=this.nq.Dc(h.id));return 28===(null===h||void 0===h?void 0:h.role)?!(null===h||void 0===h?0:h.placeholder)&&b===We.a.lo:!(null===h||void 0===h?0:h.placeholder)&&(b===We.a.lo||b===We.a.un||Array.contains(dd.AParagraphNode.Kea(),b))}}yj.Mxi="OnInconsistenciesChanged";yj.Ozi=
"OnRoleReviewCount";yj.kIf="OnRoleChanged";Object(n.a)(yj,"RoleLifecycleManager",null,[581,582,583]);class Mg{constructor(b,h,r,z,R){this.fUa=b;this.iUb=h;this.Jf=r;this.Jm=z;this.eP=R;this.Bh=!1;this.PIf=(ba,ta)=>{(ba=ta.data.paragraphNode)?this.Fgj(ba,()=>!0,Wa=>Wa.userSetRole=el.d(ta.data.KDf)):v.ULS.shipAssertTag(557057378,3016,!1)};this.hVm=(ba,ta)=>{0<this.eP.i8l||this.r_f(ta.property)&&this.Fgj(ta.node,Wa=>!(Wa&&Wa.isInvalidated),Wa=>Wa.isInvalidated=!0)}}initialize(){this.Bh||(this.fUa.N$g(this.PIf),
this.Jm.Se(12).lp(this.hVm),this.Bh=!0)}qe(){}Fgj(b,h,r){if(b=(b=this.iUb.eMh(b))&&1===b.length&&b[0]){var z=b.content;z=z&&z.M_&&z.M_.customMetadata;h(z)&&(h=new zp.RoleDetectionCustomMetadata,h.isInvalidated=z&&z.isInvalidated,h.userSetRole=z&&z.userSetRole,r(h),this.Jf.sgo(b,h))}}r_f(b){return b===We.a.lo||b===We.a.un||Array.contains(dd.AParagraphNode.Kea(),b)}}Object(n.a)(Mg,"RoleDetectionMetadataUpdater",null,[580]);class aq{constructor(b,h){this.r$d=b;this.syb=h;this.xTc=(r,z)=>{r=z.data;if(r.ft==
He.a.getTypeName()||r.ft==He.n.getTypeName())if(r=r.annotation&&r.annotation.content)this.runId=r.runId};this.revisionId=0}initialize(){this.syb.YE(this.xTc)}qe(){this.syb.jH(this.xTc)}cPm(){if(void 0===this.runId)Promise.resolve();else{var b=new zp.RoleDetectionSettings({acceptedRunId:this.runId});b=new He.a({parentPath:["session","doc","main"],items:[{id:"RoleDetectionSettings",body:b,revId:(this.revisionId++).toString()}]});this.r$d.submitOperation(b)}}}Object(n.a)(aq,"RoleDetectionSettingsUpdater",
null,[]);class as{constructor(b,h,r){this.c7l=b;this.xVa=h;this.Re=r;this.u9h=this.initialized=!1;this.Qvi=()=>{this.W2i()&&(this.d8h(),this.xVa.Arn(this.Qvi))}}initialize(){this.initialized||(this.ynf(),this.initialized=!0)}qe(){}ynf(){this.W2i()?this.d8h():this.xVa.$6j(this.Qvi)}W2i(){return!this.u9h&&(this.Re.Kbi()||this.xVa.K5b(zp.DocumentRoleDetectionAnnotation.getTypeName())||this.xVa.K5b(zp.RoleDetectionAnnotation.getTypeName()))}d8h(){for(const b of this.c7l)b.initialize();this.u9h=!0}}Object(n.a)(as,
"RLMInitializer",null,[]);class zj{constructor(b,h,r){this.b4=b;this.rt=h;this.V6c=r;this.W=null;this.Vga=()=>{this.RMc();this.rt.Cjb(this.Vga)};if(!b)throw Vj.a.argument("AppLifecycleManager is null");if(!h)throw Vj.a.argument("Workspace is null");if(!r)throw Vj.a.argument("ApplicationInstance is null");}get name(){return"WordEditor.DocumentUnderstanding.RLM"}init(){this.W.resolve("Box4.IFeatureHelper").Yk.continueWith(()=>this.Tm())}yc(b){this.W=b;b.ha("WordEditor.DocumentUnderstanding.RLM.IRoleDetectionSettingsUpdater",
()=>new aq(this.W.resolve("WordEditor.Designer.Common.AL.ISubmitOperationHelper"),b.resolve("WordEditor.Designer.Common.AL.IAnnotationManagerHolder").hI)).singleInstance();b.ha("WordEditor.DocumentUnderstanding.RLM.IRoleDetectionMetadataUpdater",()=>new Mg(b.resolve("WordEditor.Designer.Common.Review.IReviewEvents"),b.resolve("WordEditor.Designer.Common.AL.IAnnotationManagerHolder").$4d,b.resolve("Box4.AugmentationLoop.IAnnotationStorage"),b.resolve("Box4.Graph.IGraphInstance"),b.resolve("WordEditor.DocumentUnderstanding.RLM.IRoleLifecycleManager"))).singleInstance();
b.ha("WordEditor.DocumentUnderstanding.RLM.IRoleLifecycleManager",()=>new yj(b.resolve("WordEditor.Designer.Common.AL.IAnnotationManagerHolder").WXa,b.resolve("WordEditor.Designer.Common.AL.IAnnotationManagerHolder").$4d,b.resolve("WordEditor.Designer.Common.AL.IAnnotationManagerHolder").hI,b.resolve("Box4.Graph.IGraphInstance"),b.resolve("WordEditor.Designer.Common.Review.IReviewEvents"),b.resolve("WordEditor.Designer.IDesignerControl"))).singleInstance();b.ha("WordEditor.DocumentUnderstanding.RLM.IDesignerRoleReader",
()=>b.resolve("WordEditor.DocumentUnderstanding.RLM.IRoleLifecycleManager")).singleInstance();b.ha("WordEditor.DocumentUnderstanding.RLM.IRLMInitializer",()=>new as([this.W.resolve("WordEditor.DocumentUnderstanding.RLM.IRoleLifecycleManager"),this.W.resolve("WordEditor.DocumentUnderstanding.RLM.IRoleDetectionMetadataUpdater")],b.resolve("Box4.AugmentationLoop.IAnnotationStorage"),b.resolve("WordEditor.Designer.IDesignerControl"))).singleInstance()}dispose(){}Tm(){this.V6c.BI?this.b4.tl(16,()=>this.kMc()):
this.kMc()}kMc(){this.rt.Ata?this.RMc():this.rt.hda(this.Vga)}RMc(){this.W.resolve("WordEditor.DocumentUnderstanding.RLM.IRoleDetectionSettingsUpdater").initialize();this.W.resolve("WordEditor.DocumentUnderstanding.RLM.IRLMInitializer").initialize()}}Object(n.a)(zj,"PackageManager",null,[1,2]);class Rm{constructor(){this.ContractVersion=0;this.FileName=this.Paragraphs=null}static construct(b,h){const r=new Rm;r.ContractVersion=b;r.FileName=h;r.Paragraphs=[];return r}}Object(n.a)(Rm,"DocumentSwayPreviewContent",
null,[]);class Lq{constructor(){this.TextRuns=this.ParagraphFormatting=this.RawText=null;this.ParagraphIndex=0;this.IsRTL=!1}static hFk(b,h,r,z){const R=new Lq;R.RawText=b;R.ParagraphFormatting=h;R.TextRuns=r;R.IsRTL=z;R.ParagraphIndex=0;return R}}Object(n.a)(Lq,"ParagraphContent",null,[]);var Cl=d(105),Qu=d(1180);class Jr{constructor(){this.Name=null;this.Size=0}static construct(b,h){const r=new Jr;r.Name=b;r.Size=h;return r}}Object(n.a)(Jr,"FontData",null,[]);class vr{constructor(){this.IsUppercase=
this.IsUnderline=this.IsBold=!1;this.Font=null;this.LeftIndent=this.Alignment=0}static construct(b,h,r,z,R,ba){const ta=new vr;ta.IsBold=b;ta.IsUnderline=h;ta.IsUppercase=r;ta.Font=z;ta.Alignment=R;ta.LeftIndent=ba;return ta}}Object(n.a)(vr,"TextFormatting",null,[]);class ug{constructor(){this.RunFormatting=this.RawText=null}static construct(b,h){const r=new ug;r.RawText=b;r.RunFormatting=h;return r}}Object(n.a)(ug,"TextRunContent",null,[]);var Aj=d(108),vg=d(43);class hr{constructor(b,h){this.ROb=
null;this.aLj=b;this.RM=h||""}get W0m(){return this.aLj.value}q6k(){const b=Date.now(),h=Rm.construct(2,this.RM);h.Paragraphs=this.Chl();const r={};r.ExtractionDurationInMs=(Date.now()-b).toString();v.ULS.sendTraceTag(25268374,382,50,"{0}",r);return h}Chl(){const b=new Ua.a;var h=0;let r=0,z=!1;var R=new Nd.GraphIterator;R.set(this.W0m);R=Cn.a.Wp(R.currentNode);const ba=new Ub.a(0);for(;R.moveNext()&&2100>r&&25>h;){var ta=R.currentNode;if(ie.ParagraphReader.nc(ta)&&!ie.ParagraphReader.O$(ta)){!z&&
ie.ParagraphReader.iK(ta)&&(z=!0);let Wa=dd.AParagraphNode.lU(ta.characterData);Wa=Wa.trim();if(0<Wa.length){const ub=this.QCl(ta);ub.ParagraphIndex=h;h++;r+=Wa.length;b.add(ub);this.Djo(ba,ie.ParagraphReader.language(ta))}}}this.ROb=this.pol(ba);h={};h.documentHasList=z;v.ULS.sendTraceTag(25776736,382,50,"{0}",h);return b.toArray()}pol(b){let h=-1,r=1033;for(let z of b.keys.toArray())z&&b.J(z)>h&&(h=b.J(z),r=z);return Sj.a.pg(r)}Djo(b,h){b.xb(h)?b.Z(h,b.J(h)+1):b.Z(h,1)}QCl(b){const h=dd.AParagraphNode.lU(b.characterData),
r=this.UCl(b),z=this.gMl(b);b=this.Jhm(b);return Lq.hFk(h,r,z,b)}UCl(b){const h=ie.ParagraphReader.Gn(b,We.a.bold,!1),r=ie.ParagraphReader.Gn(b,We.a.underline,!1);var z=ie.ParagraphReader.Gn(b,We.a.fontSize,Cl.a.OJ);const R=ie.ParagraphReader.Gn(b,We.a.font,Cl.a.QG);var ba=ie.ParagraphReader.Hv(b);ba=this.Xaf(ba);const ta=!!ie.ParagraphReader.Gn(b,Ij.a.capitalization,0);b=(new Qu.a).mT(b).value/20;z=Jr.construct(R,z);return vr.construct(h,r,ta,z,ba,b)}gMl(b){const h=new Ua.a;for(let R=0;R<b.qa.length-
1;R++){var r=b.qa.J(R),z=b.qa.J(R+1);r.formatting&&(z=dd.AParagraphNode.lU(b.characterData.substr(r.cp,z.cp-r.cp)),r=this.hMl(r.formatting),r=ug.construct(z,r),h.add(r))}return h.toArray()}hMl(b){const h=Aj.FormattingReader.IJc(b,We.a.bold,!1),r=Aj.FormattingReader.IJc(b,We.a.underline,!1);var z=Aj.FormattingReader.IJc(b,We.a.fontSize,Cl.a.OJ);const R=Aj.FormattingReader.IJc(b,We.a.font,Cl.a.QG);z=Jr.construct(R,z);b=!!Aj.FormattingReader.IJc(b,Ij.a.capitalization,0);return vr.construct(h,r,b,z,5,
0)}Xaf(b){switch(b){case 1:return 0;case 3:return 1;case 2:return 2;case 6:return 3;case 0:return 5;default:return 4}}Jhm(b){const h=new Nd.GraphIterator;h.set(b);h.Bb(11);return(b=h.kd(11))?vg.OutlineElementReader.hm(b):!1}}Object(n.a)(hr,"DocumentContentExtractor",null,[553]);class Ap{get name(){return"WordEditor.DocumentContentExtractor"}init(){}dispose(){}yc(b){b.ha("WordEditor.DocumentContentExtractor.DocumentContentExtractor",()=>new hr(new De.a(()=>ja.App.fm.jb.Ic.rd),t.AFrameworkApplication.zt.Bz)).as("Box4.DocumentContentExtractor.IDocumentContentExtractor").singleInstance()}static main(){O.a.instance.Oc(new Ap)}}
Object(n.a)(Ap,"DocumentContentExtractorPackage",null,[1,2]);class Mp{}Mp.vg="<div class='EmbedDialog' id='embeddialog'> <div class='EmbedPreviewPane' id='embedpreviewpane'> </div> <div class='EmbedOptionPane' id='embedoptionpane'> </div> </div>";Object(n.a)(Mp,"EmbedDialogHtml",null,[]);class Kr{constructor(b,h,r,z){this.lac=b;this.uZa=h;this.nZd=r;this.value=z}}Object(n.a)(Kr,"OptionInfo",null,[]);class iw{constructor(b,h,r){this.lWf=b;this.a5b=h;this.uZa=r}}Object(n.a)(iw,"SectionInfo",null,[]);
var Pw=d(233);class Fh extends Wc.a{constructor(b,h=!1){super(!1,!1,h);this.x$c=476;this.$Pb=288;this.bne=798;this.ZQj=476;this.YQj=288;this.QUc={};this.Zjb=[];this.aV=this.FTa=this.Vrb=this.Job=this.Bhd=this.CTb=null;this.Smc=t.AFrameworkApplication.lLc;this.vsb=b;this.lBe=Object(u.a)(this,this.n_m,"optionClickHandler");this.Osc=Object(u.a)(this,this.o_m,"optionKeyHandler");this.die=Object(u.a)(this,this.rfk,"arrowClickHandler");this.PNb=Object(u.a)(this,this.sfk,"arrowKeyHandler");this.Lnd=Object(u.a)(this,
this.C7n,"textAreaOnFocusHandler");this.DJj=h;this.vg=Mp.vg;this.Fd=0;this.kg="EmbedDialog"}get Zq(){return this.$Pb}set Zq(b){this.$Pb=b}m5i(b){const h={["id"]:this.kg,["bodyControls"]:{},["embedPreviewSectionTitle"]:CommonUIStrings.l_Preview,["embedCodeSectionTitle"]:CommonUIStrings.l_EmbedCode,["dimensionsSectionTitle"]:CommonUIStrings.l_Dimensions,["interactionSectionTitle"]:CommonUIStrings.l_Interaction,["initialPreviewUrl"]:Rc.a.Ep(this.vsb,"wdPreview","1"),["initialEmbedUrl"]:this.Smc,["getEmbedCode"]:Fh.bQh,
["codeCopiedText"]:CommonUIStrings.l_EmbedCodeCopied};for(const r of Object.keys(b))h[r]=b[r];this.Fd=1;this.Ve(1,CommonUIStrings.l_CopyAction);this.Ve(0,CommonUIStrings.l_Close);this.Wh(CommonUIStrings.l_Embed,null,h)}Lec(){if(this.DJj)this.m5i({});else{this.showDialog(CommonUIStrings.l_Embed,null);this.CTb=document.getElementById("embedpreviewpane");this.Bhd=document.getElementById("embedoptionpane");this.CTb.style.width=String.format("{0}px",this.ZQj);this.FTa=document.createElement("iframe");
this.FTa.className=Fh.XQj;this.FTa.frameBorder="0";this.FTa.style.height=String.format("{0}px",this.YQj);this.FTa.tabIndex=-1;this.CTb.appendChild(this.Vxd(CommonUIStrings.l_Preview,this.FTa,Fh.uWg,Fh.tWg,Fh.uWg,!0));this.aV=document.createElement("textarea");this.aV.className=Fh.qCj;Sys.UI.DomElement.addCssClass(this.aV,Pw.a.oQe);this.aV.id=Fh.PCg;X.a.ki||(this.aV.readOnly=!0);this.aV.rows=4;this.aV.style.fontFamily=CommonUIStrings.l_UserInterfaceFontName;this.aV.style.fontSize=CommonUIStrings.l_UserInterfaceFontSize;
this.aV.setAttribute(vf.a.mda,String.format("{0} {1}",Fh.OCg,Fh.NCg));this.CTb.appendChild(this.Vxd(CommonUIStrings.l_EmbedCode,this.aV,Fh.OCg));Bf.a.addHandler(this.aV,"focus",this.Lnd);var b=document.createElement("span");b.className=Fh.fEj;b.innerText=CommonUIStrings.l_CopyText;b.id=Fh.NCg;this.CTb.appendChild(b);this.Job=document.createElement("div");this.Job.className=Fh.yBj;this.Bhd.appendChild(this.Vxd(CommonUIStrings.l_Dimensions,this.Job));this.Vrb=document.createElement("div");this.Bhd.appendChild(this.tIk(Fh.dUg,
this.Vrb));this.Fd=0;this.Ve(1,CommonUIStrings.l_Close);this.j8f();this.mij();X.a.ki||this.aV.focus()}}dispose(){if(this.QUc){var b=this.QUc;for(let h in b){const r=b[h];this.mq.sc(jb.a.click,r.lac,this.lBe);this.ke.sc(jb.a.li,r.lac,this.Osc);this.ke.sc(jb.a.oh,r.lac,this.Osc)}this.Osc=this.lBe=this.QUc=null}if(this.Zjb){for(b=0;b<this.Zjb.length;++b)this.mq.sc(jb.a.click,this.Zjb[b].a5b,this.die),this.ke.sc(jb.a.li,this.Zjb[b].a5b,this.PNb),this.ke.sc(jb.a.Ft,this.Zjb[b].a5b,this.PNb),this.ke.sc(jb.a.oh,
this.Zjb[b].a5b,this.PNb);this.ke=this.die=this.Zjb=null}this.Lnd&&this.aV&&(Bf.a.removeHandler(this.aV,"focus",this.Lnd),this.Lnd=null);this.aV=this.FTa=this.Vrb=this.Job=this.Bhd=this.CTb=null;super.dispose()}nga(){super.nga();this.ed.style.width=String.format("{0}px",this.bne);this.YVa()}fio(b,h){const r=Rc.a.Ep(this.Smc,b,h);return this.Smc!==r?(this.Smc=r,this.vsb=Rc.a.Ep(this.vsb,b,h),!0):!1}j8f(){this.aV&&(this.aV.innerText=Fh.bQh(this.Smc,this.x$c,this.$Pb))}mij(){this.FTa&&this.FTa.contentWindow.location.replace(Rc.a.Ep(this.vsb,
"wdPreview","1"))}Mce(b,h){this.fio(b,h)&&(this.j8f(),this.mij())}Vxd(b,h,r=null,z=null,R=null,ba=!1){const ta=document.createElement("div");ta.className=Fh.FTj;z&&(ta.id=z);R&&ta.setAttribute(vf.a.mda,R);ba&&(ta.tabIndex=0);z=document.createElement("span");z.className=Fh.GTj;z.innerText=b;r&&(z.id=r);ta.appendChild(z);ta.appendChild(h);return ta}tIk(b,h){const r=this.Vxd(CommonUIStrings.l_Interaction,h),z=this.Hk.createElement("div");z.className=Fh.owj;z.id=Fh.gvg+b;z.setAttribute(vf.a.Ch,vf.a.t1);
z.tabIndex=0;r.insertBefore(z,h);b=Wh.createClusteredImage(16,16,Fh.pwj,Fh.qwj,!0,"");z.appendChild(b);b=b.childNodes[0];b.className=Wh.getImageClass(Fh.fCg);b.title=CommonUIStrings.l_Expand;z.title=CommonUIStrings.l_Expand;h.style.visibility="hidden";h=new iw(h,z,b);Array.add(this.Zjb,h);this.mq.uE(jb.a.click,z,this.die,h);this.ke.uE(jb.a.li,z,this.PNb,h);this.ke.uE(jb.a.Ft,z,this.PNb,h);this.ke.uE(jb.a.oh,z,this.PNb,h);return r}rfk(b){this.clh(b);return!0}sfk(b){return this.dQc(b,Object(u.a)(this,
this.clh,"changeArrowState"))}clh(b){b=b.yp;"visible"===b.lWf.style.visibility?(b.lWf.style.visibility="hidden",b.uZa.className=Wh.getImageClass(Fh.fCg),b.uZa.title=CommonUIStrings.l_Expand,b.a5b.title=CommonUIStrings.l_Expand):(b.lWf.style.visibility="visible",b.uZa.className=Wh.getImageClass(Fh.SYj),b.uZa.title=CommonUIStrings.l_Collapse,b.a5b.title=CommonUIStrings.l_Collapse)}eth(b,h){const r=document.createElement("div");r.className=Fh.aUg;r.id=b+Fh.bUg;var z=this.Hk.createElement("div");z.tabIndex=
0;z.className=Fh.Cxg;z.id=b+Fh.ykc;z.setAttribute(vf.a.Ch,vf.a.RRe);z.setAttribute(vf.a.eza,vf.a.Ho);z.setAttribute(vf.a.mda,b+Fh.uPb);r.appendChild(z);r.setAttribute(vf.a.Ch,vf.a.Az);var R=Wh.createClusteredImage(16,16,Fh.Ixg,Fh.Hxg,!0,"");z.appendChild(R);R=R.childNodes[0];R.id=b+Fh.cUg;R.className=Wh.getImageClass(Fh.Yje);z=new Kr(r,R,z,1);this.QUc[b]=z;this.mq.uE(jb.a.click,r,this.lBe,b);z=document.createElement("span");z.className=Fh.uPb;z.innerText=h;z.id=b+Fh.uPb;r.appendChild(z);this.ke.uE(jb.a.li,
r,this.Osc,b);this.ke.uE(jb.a.oh,r,this.Osc,b);return r}n_m(b){this.NBi(b);return!0}o_m(b){return this.dQc(b,Object(u.a)(this,this.NBi,"optionHandler"))}NBi(b){const h=this.QUc[b.yp.toString()];h.value?(h.value=0,h.uZa.className=Wh.getImageClass(Fh.kLe),h.nZd.setAttribute(vf.a.eza,vf.a.jL)):(h.value=1,h.uZa.className=Wh.getImageClass(Fh.Yje),h.nZd.setAttribute(vf.a.eza,vf.a.Ho));this.Mce(b.yp.toString(),h.value.toString())}C7n(){this.aV.select()}static bQh(b,h,r){if(!Fh.Tze){const z=String.format('<a target="_blank" href="{0}">{1}</a>',
B.a.sLc("https://office.com"),CommonUIStrings.l_Office),R=String.format('<a target="_blank" href="{0}">{1}</a>',B.a.sLc("https://office.com/webapps"),CommonUIStrings.l_WebAppName);Fh.Tze=String.format(CommonUIStrings.l_NoFrames,z,R)}return String.format('<iframe src="{0}" width="{1}px" height="{2}px" frameborder="0">{3}</iframe>',B.a.sLc(b),h,r,Fh.Tze)}}Fh.Tze=null;Fh.Yje="CheckboxChecked_16x16x32";Fh.kLe="CheckboxUnchecked_16x16x32";Fh.SYj="OutlookSearchChevronUp_16x16x32";Fh.fCg="OutlookSearchChevronDown_16x16x32";
Fh.Ixg="CommentChecked";Fh.pwj="UpArrowServer";Fh.uPb="EmbedDescription";Fh.FTj="EmbedSectionHeader";Fh.GTj="EmbedSectionName UIFontBold";Fh.fEj="EmbedCodeFooter";Fh.Hxg="EmbedOptionImage";Fh.XQj="EmbedPreviewFrame";Fh.qCj="EmbedCodeTextArea";Fh.aUg="EmbedOption";Fh.yBj="EmbedDimensionSection";Fh.qwj="EmbedArrowIcon";Fh.owj="WACGlyph EmbedArrowHolder";Fh.Cxg="EmbedCheckBoxHolder";Fh.bUg="Option";Fh.cUg="OptionImage";Fh.PCg="EmbedCode";Fh.OCg="EmbedCodeHeader";Fh.uWg="Preview";Fh.tWg="PreviewHeader";
Fh.dUg="Options";Fh.gvg="Arrow";Fh.ykc="Check";Fh.NCg="EmbedCodeFooter";Object(n.a)(Fh,"EmbedDialog",Wc.a,[]);class Ru extends Kr{constructor(b,h,r,z,R){super(b,h,r,z);this.HZa=R}}Object(n.a)(Ru,"OptionInputInfo",Kr,[]);class st extends Fh{constructor(b,h){super(b,st.EK);this.b9=null;this.mmc=[];this.Emd=Object(u.a)(this,this.Y1n,"startOnOptionClickHandler");this.fVb=Object(u.a)(this,this.Z1n,"startOnOptionKeyHandler");this.Shd=Object(u.a)(this,this.$Um,"onPageNumberChanged");this.nne=Object(u.a)(this,
this.vRm,"onDimensionChanged");this.oG=h}Lec(){if(st.EK){var b=st.Xfn,h=[];h.push({["id"]:"wdPrint",["checkboxInitialValue"]:!0,["checkboxLabel"]:this.oG.yGi,["urlTransformFunctionOnChange"]:b},{["id"]:"wdEmbedCode",["checkboxInitialValue"]:!0,["checkboxLabel"]:this.oG.pLi,["urlTransformFunctionOnChange"]:b},{["id"]:"wdStartOn",["checkboxInitialValue"]:!1,["checkboxLabel"]:this.oG.Q7i,["urlTransformFunctionOnChange"]:b,["textInputProps"]:{["title"]:this.oG.R7i}});this.m5i({["dimensionsOptions"]:{["isMultipleChoice"]:!1,
["defaultWidth"]:this.x$c,["defaultHeight"]:this.$Pb,["minWidth"]:375,["minHeight"]:250,["widthLabel"]:this.oG.zlj,["heightLabel"]:this.oG.P4h},["interactionOptions"]:h})}else super.Lec(),this.S7g(this.oG.zlj,"EmbedWidthInput",this.x$c),this.S7g(this.oG.P4h,"EmbedHeightInput",this.$Pb),this.Vrb.appendChild(this.eth("wdPrint",this.oG.yGi)),this.Vrb.appendChild(this.eth("wdEmbedCode",this.oG.pLi)),this.t1j(this.oG.Q7i),this.YVa(),ve.FocusManager.fJ()&&(b=ve.FocusManager.instance(),h=[document.getElementById(Fh.PCg),
document.getElementById("EmbedWidthInput"),document.getElementById("EmbedHeightInput"),document.getElementById(Fh.gvg+Fh.dUg),document.getElementById("wdPrint"+Fh.ykc),document.getElementById("wdEmbedCode"+Fh.ykc),document.getElementById("wdStartOn"+Fh.ykc),document.getElementById("wdStartOnText"),document.getElementById(mg.a.o6c),document.getElementById(Fh.tWg)],h=new bf(h),b.Gs().Vj=h,X.a.ki?this.uU(document.getElementById(mg.a.o6c)):this.aV.select())}dispose(){if(!st.EK){if(this.mmc){for(let b=
0;b<this.mmc.length;++b)Bf.a.removeHandler(this.mmc[b],"change",this.nne);this.mmc=this.nne=null}this.Shd&&(Bf.a.removeHandler(this.b9.HZa,"change",this.Shd),this.Shd=null);this.Emd&&(this.mq.sc(jb.a.click,this.b9.lac,this.Emd),this.Emd=null);this.fVb&&(this.ke.sc(jb.a.li,this.b9.lac,this.fVb),this.ke.sc(jb.a.oh,this.b9.lac,this.fVb),this.fVb=null);this.b9=null}super.dispose()}S7g(b,h,r){const z=document.createElement("label");z.className="EmbedInputPrefix";z.innerText=b;this.Job.appendChild(z);b=
document.createElement("input");b.className=h;b.id=h;b.value=r.toString();b.type="text";b.setAttribute("data-lpignore","true");z.setAttribute("for",h);this.Job.appendChild(b);this.mmc.push(b);Bf.a.addHandler(b,"change",this.nne);this.Job.appendChild(document.createElement("br"))}vRm(b){"EmbedWidthInput"===b.target.id?this.x$c=this.ZAd(b.target,375):this.$Pb=this.ZAd(b.target,250);this.j8f()}ZAd(b,h){let r=parseInt(b.value);if(isNaN(r)||r<h)r=h;b.value=r.toString();return r}$Um(b){b=this.ZAd(b.target,
1);1===this.b9.value&&this.Mce("wdStartOn",b.toString())}t1j(b){const h=document.createElement("div");h.className=Fh.aUg+" EmbedInlineOption";h.id="wdStartOn"+Fh.bUg;const r=this.Hk.createElement("div");r.tabIndex=0;r.className=Fh.Cxg;r.id="wdStartOn"+Fh.ykc;r.setAttribute(vf.a.Ch,vf.a.RRe);r.setAttribute(vf.a.eza,vf.a.jL);r.setAttribute(vf.a.mda,"wdStartOn"+Fh.uPb);h.appendChild(r);h.setAttribute(vf.a.Ch,vf.a.Az);var z=Wh.createClusteredImage(16,16,Fh.Ixg,Fh.Hxg,!0,"");r.appendChild(z);z=z.childNodes[0];
z.id="wdStartOn"+Fh.cUg;z.className=Wh.getImageClass(Fh.kLe);const R=document.createElement("span");R.className=Fh.uPb;R.innerText=b;R.id="wdStartOn"+Fh.uPb;h.appendChild(R);this.Vrb.appendChild(h);b=document.createElement("input");b.className="EmbedPageNumberInput";b.id="wdStartOnText";b.type="text";b.title=this.oG.R7i;b.setAttribute("data-lpignore","true");this.Vrb.appendChild(b);Bf.a.addHandler(b,"change",this.Shd);this.b9=new Ru(h,z,r,0,b);this.Mce("wdStartOn","1");this.mq.mb(jb.a.click,h,this.Emd);
this.ke.mb(jb.a.li,h,this.fVb);this.ke.mb(jb.a.oh,h,this.fVb)}Y1n(b){this.O7i(b);return!0}Z1n(b){return this.dQc(b,Object(u.a)(this,this.O7i,"startOnOptionHandler"))}O7i(){let b=1;this.b9.value?(this.b9.value=0,this.b9.uZa.className=Wh.getImageClass(Fh.kLe),this.b9.nZd.setAttribute(vf.a.eza,vf.a.jL)):(this.b9.value=1,this.b9.uZa.className=Wh.getImageClass(Fh.Yje),b=this.ZAd(this.b9.HZa,1),this.b9.nZd.setAttribute(vf.a.eza,vf.a.Ho));this.Mce("wdStartOn",b.toString())}static get EK(){return t.AFrameworkApplication.ua.Sb.KA}static Xfn(b,
h,r,z=null){if("wdPrint"===h||"wdEmbedCode"===h)return Rc.a.Ep(b,h,r?"1":"0");if("wdStartOn"===h){let R="1";r&&z&&(z=parseInt(z),!isNaN(z)&&1<=z&&(R=z.toString()));return Rc.a.Ep(b,h,r?R:"1")}return b}}Object(n.a)(st,"WordEmbedDialog",Fh,[]);class Lr{constructor(b,h,r,z,R){this.lca=null;this.ga=b;this.u7a=h;this.EO=r;this.oG=z;this.Toa=R}Vb(){this.ga.pa(this.EO,Yd.a.frame,Object(u.a)(this,this.XWn,"showEmbedCode"));this.u7a.execute(Object(u.a)(this,this.NGf,"onHostPostmessengerCreated"))}NGf(b){v.ULS.shipAssertTag(4994850,
332,!!b);this.lca=b;t.AFrameworkApplication.Eta||(this.lca.xv(F.a.Mjh),this.lca.cC(F.a.Mjh,Object(u.a)(this,this.Lec,"showEmbedDialog")))}Lec(b){b=b.Values.HostEmbeddedViewUrl.toString();t.AFrameworkApplication.lLc=b;this.Toa.o6e=b;(new st(b,this.oG)).Lec()}XWn(b,h,r){if(2===r)if(t.AFrameworkApplication.lLc)(new st(this.Toa.o6e,this.oG)).Lec();else return t.AFrameworkApplication.Dm.AZa(Lr.Foj),t.AFrameworkApplication.x9f&&this.lca.sendMessage(F.a.T7k,null)?32:t.AFrameworkApplication.ua.S2(!0,t.AFrameworkApplication.N8e);
return 32}}Lr.Foj=10381;Object(n.a)(Lr,"EmbedActor",null,[]);class Ba{}Object(n.a)(Ba,"WordEmbedDialogStrings",null,[]);var Pa=d(267);class Ea extends Lr{constructor(b,h){super(b,h,Oa.a.s0f,Object.assign(new Ba,{zlj:WordEditorIntl.WordEditorStrings.l_Width,P4h:WordEditorIntl.WordEditorStrings.l_Height,yGi:WordEditorIntl.WordEditorStrings.l_PrintOption,pLi:WordEditorIntl.WordEditorStrings.l_ReembedOption,Q7i:WordEditorIntl.WordEditorStrings.l_StartOnOption,R7i:WordEditorIntl.WordEditorStrings.l_StartPage}),
Pa.WoncaApp.instance)}}Object(n.a)(Ea,"EmbedActor",Lr,[]);class za{constructor(){this.W=null}get name(){return"WordEditor.Embed"}yc(b){this.W=b;b.ha("WordEditor.Embed.EmbedActor",()=>new Ea(t.AFrameworkApplication.ya,b.Za("Postmessage.IHostPostmessenger"))).singleInstance()}init(){this.W.resolve("WordEditor.Embed.EmbedActor").Vb()}dispose(){}}Object(n.a)(za,"EmbedPackage",null,[1,2]);class $a{constructor(b,h,r){this.qv=this.JGa=this.LIa=null;this.wGa=0;this.FRb=this.xRb=this.oRb=this.ORb=this.mSa=
this.lSa=!1;this.ij=b;this.Mm=r}$N(b){return vb.App.xa.jb.isEditingAllowed?""!==this.pIc(b.Af):!1}qK(b){if(!this.$N(b))return!1;this.BIn(b);this.CIn();this.DIn();this.LIa=b.lH;this.qv=new Sys.UI.Point(0,0);v.ULS.sendTraceTag(22381023,322,50,"Image Crop drag started");return!0}bU(b){this.JGa=b.lH;this.$ok();this.ij.nhj(this.qv.x,this.qv.y,this.ORb,this.oRb,this.xRb,this.FRb,!1);return!0}lD(){this.ij.nhj(this.qv.x,this.qv.y,this.ORb,this.oRb,this.xRb,this.FRb,!0);v.ULS.sendTraceTag(22381024,322,50,
"Image Crop drag succeeded")}uX(){this.ij.Rrk();v.ULS.sendTraceTag(22381025,322,50,"Image Crop drag canceled")}CIn(){this.FRb=this.xRb=this.oRb=this.ORb=!1;switch(this.wGa){case 1:this.ORb=!0;break;case 5:this.oRb=!0;break;case 3:this.FRb=!0;break;case 7:this.xRb=!0;break;case 0:this.xRb=this.ORb=!0;break;case 2:this.FRb=this.ORb=!0;break;case 6:this.xRb=this.oRb=!0;break;case 4:this.FRb=this.oRb=!0}}DIn(){this.mSa=this.lSa=!1;switch(this.wGa){case 0:this.mSa=this.lSa=!0;break;case 1:case 2:this.mSa=
!0;break;case 7:case 6:this.lSa=!0}}pIc(b){var h=b.className;-1===h.indexOf("WACImageCropHandle")&&b.parentNode&&(h=b.parentNode.className);b=h.split(" ");for(h=0;h<b.length;h++){const r=b[h].toString();if(r.startsWith("WACImageCropHandle")&&"WACImageCropHandles"!==r)return r}return""}BIn(b){switch(this.pIc(b.Af)){case "WACImageCropHandleNW":this.wGa=0;break;case "WACImageCropHandleN":this.wGa=1;break;case "WACImageCropHandleNE":this.wGa=2;break;case "WACImageCropHandleE":this.wGa=3;break;case "WACImageCropHandleSE":this.wGa=
4;break;case "WACImageCropHandleS":this.wGa=5;break;case "WACImageCropHandleSW":this.wGa=6;break;case "WACImageCropHandleW":this.wGa=7}}$ok(){var b=1;this.Mm.instance&&(b=this.Mm.instance.vj);const h=(this.JGa.x-this.LIa.x)/b;b=(this.JGa.y-this.LIa.y)/b;this.qv.x=this.lSa?-h:h;this.qv.y=this.mSa?-b:b}}Object(n.a)($a,"ImageCropDragAdapter",null,[181]);class yb{constructor(b,h){this.ga=b;this.Mm=h}bvl(b){return new $a(b,this.ga,this.Mm)}}Object(n.a)(yb,"ImageCropDragAdapterFactory",null,[549]);var Pb=
d(241),ac=d(205),Ec=d(468),Gc=d(694),Sc=d(97),Xc=d(65),id=d(441),wd=d(950),Ce=d(570),me=d(884),ne=d(133),Fe=d(383),ze=d(270),Ee=d(853),uf=d(211),Ff=d(92),Ke=d(23),kg=d(297),Uh=d(395),eg=d(131);class Vg{constructor(b,h,r,z,R,ba,ta,Wa,ub=null){this.Qb=ub;this.IMc=null;this.BJ=b;this.Kh=h;this.Hc=r;this.su=z;this.Vd=R;this.ib=ba;this.Hm=ta;this.kA=Wa}get eW(){return null!=this.Sgg?this.Sgg:this.Sgg=Sa.a.instance.resolve("Box4.CatchUpActivity.IChangeIdEditor")}get oc(){return null!=this.etg?this.etg:
this.etg=Sa.a.instance.resolve("Box4.Styles.IWACStyleReader")}get Te(){return ne.PageReader.instance}RKn(b,h,r){const z=this.Hc.Rc(15);z.Db(h.node);this.vPa(b,r);z.dispose()}QKn(b,h,r){const z=this.Hc.Rc(15);z.Db(h.node);this.DJb(b,r);z.dispose()}vPa(b,h){b.setValue(We.a.imageAltText,h)}DJb(b,h){b.setValue(yc.a.PW,h)}YKn(b,h){b.setValue(We.a.Teb,h)}vZi(b,h){b.setValue(yc.a.QW,h)}UKn(b,h,r,z,R){let ba=0;var ta=0;({width:ba,height:ta}=$d.ImageReader.lAb(b));ta-=(h+r)/1E5*ta;this.mEa(b,ba-(z+R)/1E5*
ba);this.lEa(b,ta);this.OZi(b);b.setValue(yc.a.MLc,h);b.setValue(yc.a.JLc,r);b.setValue(yc.a.KLc,z);b.setValue(yc.a.LLc,R)}d0i(b,h,r,z){const R=this.Hc.Rc(15);R.Db(h.node);this.x6d(b,r,z);R.dispose()}x6d(b,h,r){this.mEa(b,h);this.lEa(b,r);this.OZi(b);b.removeProperty(od.a.M_d);b.removeProperty(od.a.L_d)}mEa(b,h){b.setValue(We.a.rfa,h);b.setValue(od.a.FBa,-1)}lEa(b,h){b.setValue(We.a.yma,h);b.setValue(od.a.EBa,-1)}sD(b,h){b.setValue(yc.a.gLc,h);b.setValue(We.a.Zh,h);b.setValue(We.a.Bq,h)}zPn(b,h){b.setValue(yc.a.rLb,
h)}BHn(b,h){b.setValue(yc.a.YSe,h)}CPn(b){if(!$d.ImageReader.Q$(b)&&b.vl){var h=b.node;if($d.ImageReader.s6(h)){const R=this.Hc.Rc(15);R.Db(b.node);b=Nd.GraphIterator.$a(h);b.Bb(12);b=b.parentNode;var r=b.properties.Og(yc.a.Hq),z=h.properties.getValue(yc.a.runId);h.ia(yc.a.Nc,Sl.a.fR);const ba=b.qa;h.Qg.apply(h,[yc.a.gLc,We.a.Zh,We.a.Bq,yc.a.YSe,yc.a.rLb,yc.a.R$a]);r=this.Pcf(z,r,ba);z=Qe.a.Uc(b,r);this.su.KZe(h,z);(h=this.kA.DN(b,r,r+1))&&this.ib.setSelection(h);this.eW.Sna(b,r,r+1);R.dispose()}}}nXf(b,
h){if(b.properties.hasProperty(yc.a.q5)){const r=b.properties.Og(yc.a.q5);r.push(h);b.properties.setValue(yc.a.q5,Array.clone(r))}else b.properties.setValue(yc.a.q5,[h])}G7d(b,h,r=0,z=!1){if(b.vl){var R=this.Hc.Rc(15),ba=b.node;R.Db(ba);if($d.ImageReader.Q$(b)){const Ib=this.Qb&&this.Qb.isFeatureEnabled(46)?new me.a:new Ce.a;Ib.Cs($d.ImageReader.Xl(b));var ta=ba.qa,Wa=this.C9k(b.cpBegin,ta);this.Gek(b.cpEnd,ta,Wa)&&v.ULS.sendTraceTag(594392136,322,50,"[ImageEditor][SetToAnchor]Comment will be lost");
ta=ta.J(Wa).blob;Wa=ta.Ee;var ub=ba.properties.Og(yc.a.Hq);ub=this.vfn(ub);Wa=ub[Wa];ub=ba.ia(yc.a.Nc,Sl.a.fR);if(ta=Object(la.a)(wd.ImageBlobObject,ta))ta.cKb=!1;this.Vd.replaceTextRange(b,"");ta&&(ta.cKb=!0);Ib.properties.setValue(yc.a.runId,Wa);Ib.properties.setValue(yc.a.Nc,ub);b=Nd.GraphIterator.$a(ba);b.Bb(12);b.Sf(Ib,6);this.nXf(b.currentNode,Ib.anchor.node.id);ba=Ib}r&&this.sD(ba.properties,r);this.BHn(ba.properties,z);this.zPn(ba.properties,h);this.eW.Odc(ba);(h=this.kA.jr(ba))&&this.ib.setSelection(h);
R.dispose()}}XVf(b,h){if(!(0>=h)){var r=Rf.a.pn(h,0),z=$d.ImageReader.tA(b),R=$d.ImageReader.JB(b);z>r&&(R*=r/z,this.mEa(b,r),this.lEa(b,R),v.ULS.sendTraceTag(37843205,322,50,"Scale image width and height to fit constraining width {0} : ",h))}}Gek(b,h,r){const z=h.length;if(r>=z||!h.J(r).Ff)return!1;const R=new kn.a;for(;r<z;r++){const ba=h.J(r);if(ba.cp>b||!ba.Ff)break;for(let ta=0;ta<ba.Ff.length;ta++){if(R.contains(ba.Ff.J(ta).Qj))return!0;R.add(ba.Ff.J(ta).Qj)}}return!1}vfn(b){for(var h=0;h<b.length&&
!b[h];)h++;if(h===b.length)for(var r=0;r<b.length;)b[r]=r+1,r++;else{var z=b[h];r=h-1;for(var R=z-1;0<=r;)b[r]=R,r--,R--;R=0;for(r=h+1;r<b.length;)(h=b[r])?h<z?(z=h+R,b[r]=z):z=h:(R+=2,z++,b[r]=z),r++}return b}x9e(b,h){let r=0;for(;r<h.length&&!(b<h[r]);)r++;return r}Pcf(b,h,r){let z=0;const R=this.x9e(b,h);let ba=0;if(R===h.length)ba=r.length-1;else for(;ba<r.length;){h=r.J(ba);if(h.formatting&&h.formatting.Ee===R)break;ba++}ba<r.length?z=r.J(ba).cp:v.ULS.sendTraceTag(21248159,322,15,"GetCpForRunId index out of bound. {0}",
{["Index"]:ba,["RunId"]:b,["CharacterPropertiesArrayLength"]:r.length});return z}C9k(b,h){let r=0;for(;r<h.length&&h.J(r).cp!==b;)r++;r===h.length&&v.ULS.sendTraceTag(21248160,322,15,"FindImageBlobIndexInCharacterPropertiesArray index out of bound. {0}",{["Index"]:r,["CharacterPropertiesArrayLength"]:h.length});return r}OZi(b){b.setValue(We.a.ifa,!0)}o0d(b,h,r,z=!1){h&&r?(h=Math.max(h,Gc.a.tri),r=Math.max(r,Gc.a.tri)):r=h=Gc.a.wxh;b.setValue(We.a.rfa,Rf.a.pn(h,0));b.setValue(We.a.yma,Rf.a.pn(r,1));
b.setValue(We.a.imageAltText,Box4Intl.Box4Strings.l_PastedImageLoading);b.setValue(Ij.a.CZ,1);b.setValue(yc.a.hfa,z)}KMd(){return null}JAh(b,h,r){let z=null;h=({MFb:z}=this.KAh(b,h,r)).returnValue;z&&b.view.Cb.setSelection(z);return h}KAh(b,h,r){var z=null;if(!this.vda(b))return{returnValue:null,MFb:z};var R=b.view;const ba=this.Hc.Rc(15,Fb.a.pCb);ba.Db(R.rd);h||(h=new Ei.DictionaryPropertySet);h.setValue(od.a.$Zk,!0);let ta=R.Cb.Rg;var Wa=new Ee.a;if(!Xd.SelectionEditor.xf(ta)){if(2===t.AFrameworkApplication.ya.processAction(Fb.a.Aka,
2))return ba.dispose(),{returnValue:null,MFb:z};ta=R.Cb.Rg}else if(ta.vl&&ie.ParagraphReader.nc(ta.node)){xg.a.instance.J(4)&&vb.App.ud.Mp&&vb.App.ud.Lq.CG(ta.node);R=Aj.FormattingReader.Pr(ta);if(!R)return ba.dispose(),{returnValue:null,MFb:z};R.cache.IA&&(R=R.Yf(null),Vg.vi.DX(R));Wa.formatting=R.Bj;Wa.languageId=Aj.FormattingReader.language(R);xg.a.instance.J(10)&&(Wa.uwa=this.oc.yo(ta.node))}if(!ta.vl)return ba.dispose(),{returnValue:null,MFb:z};if(!this.jof(b.vk,h))return ba.dispose(),this.IMc=
null,{returnValue:null,MFb:z};b=this.IMc;this.IMc=null;1===b.location?(z=b.node,h=Uh.a.instance.Wif(z),ag.OutlineElementNavigator.Vr(h,!1,!1)||(uf.OutlineNavigator.M4d(h),this.BJ.r5(h,!0,Wa)),ag.OutlineElementNavigator.De(h),Ii.TableReader.isTable(h)&&(Object(nb.a)(eg.a,h)||Object(nb.a)(Fe.a,h)?(Wa=new Nd.GraphIterator,Wa.set(h.currentNode),Ke.moveToCellContent(Wa,0,0),h.set(Wa.currentNode)):Ke.moveToCellContent(h,0,0),vg.OutlineElementReader.Nh(h)?ag.OutlineElementNavigator.De(h):h=Uh.a.instance.Wif(z)),
z=ie.ParagraphReader.xu(h.currentNode)?this.kA.xe(h.currentNode,0):this.kA.jr(h.currentNode)):b.location||(Wa=b.blob.Ob.cp+1,z=this.kA.DN(b.node,Wa-1,Wa));ba.NCa(r,1);ba.Al=Fb.a.pCb;ba.dispose();return{returnValue:b,MFb:z}}jof(){return!1}vda(b){b.contextId===kc.a.view&&b.view.ze&&b.view.Cb&&(b=b.view.Cb.Rg);if(!b)return Vg.Mc.Zb(Sc.a.zf,{["Reason"]:Xc.a.noSelection}),!1;if(Vg.Zf.iZ(b))return Vg.Mc.Zb(Sc.a.zf,{["Reason"]:Xc.a.dE}),!1;if(Vg.Zf.Jta(b))return Vg.Mc.Zb(Sc.a.zf,{["Reason"]:Xc.a.Y8h}),!1;
if(this.Hm&&this.Hm.instance&&this.Hm.instance.HT(b))return Vg.Mc.Zb(Sc.a.zf,{["Reason"]:Xc.a.externalSelection}),!1;if(this.Te.r2)return Vg.Mc.Zb(Sc.a.zf,{["Reason"]:Xc.a.compatMode}),!1;if(b.vl)return Ff.OutlineReader.CPd(b)?(Vg.Mc.Zb(Sc.a.zf,{["Reason"]:Xc.a.iZe}),!1):$d.ImageReader.BOd(b)?(Vg.Mc.Zb(Sc.a.zf,{["Reason"]:Xc.a.aZe}),!1):kg.c(b)?(Vg.Mc.Zb(Sc.a.zf,{["Reason"]:Xc.a.bZe}),!1):ze.a.Lqf(b)?(Vg.Mc.Zb(Sc.a.zf,{["Reason"]:Xc.a.$Ye}),!1):ie.ParagraphReader.UW(b)||$d.ImageReader.s9l(b)?(Vg.Mc.Zb(Sc.a.zf,
{["Reason"]:Xc.a.uN}),!1):!0;if(id.a.csf(b)){let h=!0;for(let r=0;r<b.length;++r){const z=b.getContext(r);if(!z.vl)return!1;h&&!ie.ParagraphReader.UW(z)&&(h=!1)}return h?(Vg.Mc.Zb(Sc.a.zf,{["Reason"]:Xc.a.uN}),!1):!0}return!1}eOi(b,h){const r=this.Hc.Rc(7);r.Db(b);if(12===b.type){h=h.Ob.cp;var z=ie.ParagraphReader.textLength(b);z=Qe.a.pL(h,h+1,h+1===z?!0:!1,b);this.Vd.replaceTextRange(z,"");b=Qe.a.Uc(b,h);this.ib.setSelection(Hf.SelectionFactory.eo(b))}else this.Kh.QDa(b);r.dispose()}static get vi(){return null!=
Vg.vkg?Vg.vkg:Vg.vkg=Sa.a.instance.resolve("Box4.IFormattingEditor")}static get Zf(){return Yh.a.instance}static get Mc(){return wc.a.instance}}Object(n.a)(Vg,"ImageEditor",null,[548]);class pj{constructor(b,h,r,z=0){this.node=b;this.blob=h;this.location=r;this.yT=z}}Object(n.a)(pj,"InsertPictureResult",null,[]);var qh=d(808),ik=d(298),Hm=d(1165);class jk extends Vg{constructor(b,h,r,z,R,ba,ta,Wa,ub,Ib,$b,fc,Kc,ed){super(b,h,r,z,R,ba,ta,Wa,ed);this.xAj="WACImageCropHandleNW WACImageCropHandleN WACImageCropHandleNE WACImageCropHandleW WACImageCropHandleE WACImageCropHandleSW WACImageCropHandleS WACImageCropHandleSE".split(" ");
this.i6a="WACImageCropInnerHandleTop WACImageCropInnerHandleTopBorder WACImageCropInnerHandleBottom WACImageCropInnerHandleBottomBorder WACImageCropInnerHandleLeft WACImageCropInnerHandleLeftBorder WACImageCropInnerHandleRight WACImageCropInnerHandleRightBorder".split(" ");this.nJ=this.nHa=this.kxa=null;this.Tha=Array(8);this.ucd=this.Bxa=null;this.oHa=!1;this.tcd=this.Ise=null;this.$8c=this.f$c=!1;this.QR=this.NR=this.MR=this.TR=this.XU=this.WU=this.VU=this.YU=this.nV=this.oV=0;this.a_=()=>{this.oHa&&
this.G6e()};this.Dua=Jd=>{this.oHa&&Jd.Ib.keyCode!==wb.a.es&&this.G6e(!0);return!1};this.wIg=Kc;ba.oB(this.a_);this.ke=fc;this.z0=Pb.a.instance;this.ga=t.AFrameworkApplication.ya;this.Hd=Ib;this.Ym=ub;this.Ac=ed}M6d(b,h,r,z,R){b.hasProperty(od.a.kNa)&&b.removeProperty(od.a.kNa);const ba=Array(4);ba[0]=h;ba[1]=r;ba[2]=z;ba[3]=R;b.setValue(yc.a.f3,ba)}ppn(b){b.setValue(yc.a.GBa,0);b.setValue(yc.a.ZGb,"");this.M6d(b,0,0,0,0)}kYf(b,h,r,z,R){b.setValue(yc.a.MLc,h);b.setValue(yc.a.JLc,r);b.setValue(yc.a.KLc,
z);b.setValue(yc.a.LLc,R)}O6d(b,h,r,z){b.setValue(yc.a.dK,h);b.setValue(yc.a.MKc,r);b.setValue(yc.a.VKc,z);b.setValue(od.a.dK,-1)}IMd(b,h){b=b.node;const r=Nd.GraphIterator.$a(b);if(ie.ParagraphReader.nc(b)&&ie.ParagraphReader.isEmpty(r)){var z=b.properties.Og(yc.a.Nc);h.setValue(yc.a.Nc,z);h.setValue(yc.a.runId,1);z=new Hm.a;h&&z.Cs(h);r.Sf(z,6);this.nXf(b,z.anchor.node.id);this.eW.Odc(z);return new pj(z,null,3)}return null}KMd(b,h){var r=qh.a.instance.H5c;h&&r.Cs(h);r.setValue(yc.a.imageType,1);
let z=0;xg.a.instance.J(5)&&(z=ac.a.RF(),r.setValue(yc.a.yT,z));const R=b.node.Lc.Ku(r,r.id);r=this.Vd.Uea(b,ba=>new wd.ImageBlobObject(ba,R));ik.GraphTransactionManager.instance.vGf(b.node);if(this.Hd.ng){const ba=new yf.GraphTransaction(15);ba.Db(b.node);this.Ym.Zna(b.node,b.cpBegin,b.cpBegin+1,1,null);ba.dispose()}this.eW.DJa&&!h.ia(yc.a.hfa,!1)&&this.eW.Sna(b.node,b.cpBegin,b.cpBegin+1);return new pj(b.node,r,0,z)}jof(b,h){if(!this.vda(b))return!1;const r=this.Hc.Rc(7);r.Db(b.node);t.AFrameworkApplication.K.$("ContentAppIsEnabled")&&
h.ia(yc.a.V$h,!1)?this.IMc=this.IMd(b,h):this.IMc=this.KMd(b,h);r.dispose();return!0}icc(b,h,r,z){if(!r.nc(b))return!1;r=this.Hc.Rc(7,Fb.a.iRl);r.Db(b);var R=b.properties.ia(We.a.mm,[]);R.push(0);for(let ba of R)if((R=z.Abf(b,ba))&&5===R.si&&R.id.equals(h))return this.Vd.replaceTextRange(Qe.a.createTextRange(b,ba,ba+1),""),r.dispose(),!0;r.dispose();v.ULS.sendTraceTag(588817112,3001,10,"RemoveInlineImageFromParagraph: Failed to remove image.");return!1}Eon(b,h,r,z){if(!$d.ImageReader.s6(b))return!1;
h.set(b);h.Bb(12);const R=h.ap(12);if(!R)return v.ULS.sendTraceTag(588817114,3001,10,"RemoveAnchoredImageFromParagraph: Failed to remove anchored image because unable to acquire containing graph node."),!1;if(r.GOc(R))return v.ULS.sendTraceTag(588817115,3001,10,"RemoveAnchoredImageFromParagraph: Failed to remove anchored image."),!1;z(b);r=this.Hc.Rc(7);r.Db(b);h.Eg();r.dispose();return!0}oun(b,h,r,z){return $d.ImageReader.WZa(b)?this.aun(b,r):$d.ImageReader.Q$(b)?this.tun(b,h,r,z):null}tun(b,h,r,
z){const R=qh.a.instance.H5c;r&&R.Cs(r);r=0;xg.a.instance.J(5)&&(r=ac.a.RF(),R.setValue(yc.a.yT,r));r=b.node.Lc;b=b.node;z=z.pHc(b,5);for(let ba of z)if(ba.id.equals(h)){this.Vd.replaceTextRange(Qe.a.createTextRange(b,ba.Ob.cp,ba.Ob.cp+1),"");const ta=r.Ku(R,R.id);h=Qe.a.Uc(b,ba.Ob.cp);this.Vd.Uea(h,Wa=>new wd.ImageBlobObject(Wa,ta));return R}return null}aun(b,h){if(!$d.ImageReader.WZa(b))return null;xg.a.instance.J(5)&&h.setValue(yc.a.yT,ac.a.RF());b=b.node;var r=b.anchor.node.id;b=Nd.GraphIterator.$a(b);
b.Bb(12);const z=b.parentNode;let R;z.properties.hasProperty(yc.a.q5)?(R=z.properties.Og(yc.a.q5),r=E.a.indexOf(R,r),-1!==r&&Array.removeAt(R,r)):R=[];z.properties.setValue(yc.a.q5,Array.clone(R));b.Eg();r=this.Ac&&this.Ac.isFeatureEnabled(46)?new me.a:new Ce.a;r.Cs(h);b.Sf(r,6);this.nXf(z,r.anchor.node.id);return r}v2c(b,h){this.oHa?this.G6e():this.B1n(b,h)}$Kn(b,h){b.setValue(od.a.dK,h)}gvl(b){let h=null,r=null;if(!b)return v.ULS.sendTraceTag(22381026,322,15,"Unable to obtain Image Element Container for Crop due to null Context."),
{returnValue:null,view:h,Ui:r};if(!Ya.InteractiveViewManager.instance.xd)return v.ULS.sendTraceTag(22381027,322,15,"Unable to obtain Image Element Container for Crop due to null SelectionView."),{returnValue:null,view:h,Ui:r};const z=b.node;if(!z)return v.ULS.sendTraceTag(22381056,322,15,"Unable to obtain Image Element Container for Crop due to null Context Node."),{returnValue:null,view:h,Ui:r};r=z.Lc;const R=z.Ce(Ya.InteractiveViewManager.instance.xd.Tb);if(!R)return v.ULS.sendTraceTag(23961792,
322,15,"Unable to obtain Image Element Container for Crop due to null Html View Element."),{returnValue:null,view:h,Ui:r};h=R.Ig;if(b.vl&&$d.ImageReader.Q$(b)){b=$d.ImageReader.$Aa(b);if(!b)return v.ULS.sendTraceTag(22381057,322,15,"Unable to obtain Image Element Container for Crop due to null Blob from Context."),{returnValue:null,view:h,Ui:r};b=b.HYa(h);if(!b)return v.ULS.sendTraceTag(22381058,322,15,"Unable to obtain Image Element Container for Crop due to null Presenter from Blob."),{returnValue:null,
view:h,Ui:r};b=b.element}else if($d.ImageReader.ww(z))b=R.htmlElement;else return v.ULS.sendTraceTag(22381059,322,15,"Unable to obtain Image Element Container for Crop due to context not being Image blob nor Image node."),{returnValue:null,view:h,Ui:r};return{returnValue:b,view:h,Ui:r}}WQn(b){for(let z=0;z<this.Tha.length;z++){this.Tha[z]=b.xk(Xk.a.span);this.Tha[z].className="WACImageCropHandles "+this.xAj[z];if(2>=z){var h=b.xk(Xk.a.span);h.className=this.i6a[0];var r=b.xk(Xk.a.span);r.className=
this.i6a[1];this.Tha[z].appendChild(h);this.Tha[z].appendChild(r)}else 4<z&&(h=b.xk(Xk.a.span),h.className=this.i6a[2],r=b.xk(Xk.a.span),r.className=this.i6a[3],this.Tha[z].appendChild(h),this.Tha[z].appendChild(r));if(!z||3===z||5===z)h=b.xk(Xk.a.span),h.className=this.i6a[4],r=b.xk(Xk.a.span),r.className=this.i6a[5],this.Tha[z].appendChild(h),this.Tha[z].appendChild(r);else if(2===z||4===z||7===z)h=b.xk(Xk.a.span),h.className=this.i6a[6],r=b.xk(Xk.a.span),r.className=this.i6a[7],this.Tha[z].appendChild(h),
this.Tha[z].appendChild(r)}}B1n(b,h){v.ULS.sendTraceTag(22381060,322,50,"Starting Image Cropping Mode.");if(this.oHa)v.ULS.sendTraceTag(22381061,322,100,"Attempted to start Crop Mode when it was already On.");else{var r=null,z=null;if((this.Bxa=({view:r,Ui:z}=this.gvl(h)).returnValue)&&r){this.Bxa.classList.add("ImageCropMode");this.kxa=r.xk(Xk.a.div);this.kxa.className="WACImageCropMode";this.nHa=r.xk(Xk.a.vZa);this.nHa.className="WACImageCropBase";this.nJ=r.xk(Xk.a.span);this.nJ.className="WACImageCropSrcRect";
this.WQn(r);this.kxa.appendChild(this.nJ);for(r=0;r<this.Tha.length;r++)this.nJ.appendChild(this.Tha[r]);this.kxa.appendChild(this.nHa);this.nHa.style.visibility="";this.nHa.style.display="";this.Bxa.appendChild(this.kxa);this.s6m(b);z=$d.ImageReader.hBa(b,z);r=$d.ImageReader.N3(b,od.a.ana,null);this.nHa.src=r?r:$d.ImageReader.nAb(z);this.wIg&&this.wIg.execute(R=>{this.ucd||(this.ucd=R.bvl(this))});this.f$c||(this.z0.kO(this.Bxa,this.ucd),this.f$c=!0);this.ke&&this.ke.mb(jb.a.WH,Ya.InteractiveViewManager.instance.editingView.editingElement,
this.Dua);this.oHa=!0;this.Ise=b;this.tcd=h;this.$8c=!1;b=new yf.GraphTransaction(4);b.Db(this.tcd.node);this.Ise.setValue(od.a.Hta,this.oHa);b.dispose()}else v.ULS.sendTraceTag(22381062,322,15,"Unable to start Crop Mode because unable to obtain Image Element Container from given Context.")}}s6m(b){const h=Rf.a.yf($d.ImageReader.tA(b),0),r=Rf.a.yf($d.ImageReader.JB(b),1),z=Math.max($d.ImageReader.pla(b),0),R=Math.max($d.ImageReader.lla(b),0),ba=Math.max($d.ImageReader.nla(b),0),ta=Math.max($d.ImageReader.ola(b),
0);this.oV=1E5*h/(1E5-(ba+ta));this.nV=1E5*r/(1E5-(z+R));this.YU=Math.floor(z*this.nV/1E5);this.VU=Math.floor(R*this.nV/1E5);this.WU=Math.floor(ba*this.oV/1E5);this.XU=Math.floor(ta*this.oV/1E5);this.nJ.style.top=this.YU+"px";this.nJ.style.bottom=this.VU+"px";this.nJ.style.left=this.WU+"px";this.nJ.style.right=this.XU+"px";this.nHa.style.width=this.oV+"px";this.nHa.style.height=this.nV+"px";$d.ImageReader.Wx(b)&&(this.kxa.style.width=this.oV+"px",this.kxa.style.height=this.nV+"px");this.TR=this.YU;
this.MR=this.VU;this.NR=this.WU;this.QR=this.XU}G6e(b=!1){v.ULS.sendTraceTag(22381063,322,50,"Ending Image Cropping Mode.");this.oHa?(b||this.tBk(),this.nHa?$e.a.nA(this.nHa):v.ULS.sendTraceTag(23961793,322,15,"Unable to clear imageCropBase dom element because it was already null."),this.Bxa?(this.kxa?this.kxa.parentNode===this.Bxa?this.Bxa.removeChild(this.kxa):v.ULS.sendTraceTag(24174606,322,15,"Unable to Remove child divImageCropMode from imageElementContainer, because it was no longer a child of it."):
v.ULS.sendTraceTag(23961794,322,15,"Unable to clear Crop mode div because it was already null."),this.Bxa.classList.remove("ImageCropMode"),this.oHa=!1,b=new yf.GraphTransaction(4),b.Db(this.tcd.node),this.Ise.setValue(od.a.Hta,this.oHa),b.dispose(),this.f$c&&(this.z0.zO(this.Bxa,this.ucd),this.f$c=!1),this.ke&&this.ke.sc(jb.a.WH,Ya.InteractiveViewManager.instance.editingView.editingElement,this.Dua),this.Bxa=this.kxa=null):v.ULS.sendTraceTag(22381065,322,15,"Unable to finish Image Crop clean-up because unable to obtain Image Element Container from Context.")):
v.ULS.sendTraceTag(22381064,322,100,"Attempted to End Image Crop Mode when it was already off.")}nhj(b,h,r,z,R,ba,ta){if(r){r=Math.max(this.YU-h,0);let Wa=Math.floor(this.nV)-this.VU-r;5<=Wa?(this.TR=r,this.MR=this.VU):5>Wa&&0<=Wa||0>Wa&&!this.VU?(this.TR=r-(5-Wa),this.MR=this.VU):0>Wa&&5>=Math.abs(Wa)?(this.TR=Math.floor(this.nV)-this.VU,this.MR=Math.max(this.VU-(r-(this.nV-this.VU))-(5-Math.abs(Wa)),0)):(this.TR=Math.floor(this.nV)-this.VU,this.MR=Math.max(this.VU-(r-(this.nV-this.VU)),0));this.nJ.style.top=
this.TR+"px";this.nJ.style.bottom=this.MR+"px";ta&&(this.YU=this.TR,this.VU=this.MR)}z&&(h=Math.max(this.VU-h,0),z=Math.floor(this.nV)-this.YU-h,5<=z?(this.MR=h,this.TR=this.YU):5>z&&0<=z||0>z&&!this.YU?(this.MR=h-(5-z),this.TR=this.YU):0>z&&5>=Math.abs(z)?(this.MR=Math.floor(this.nV)-this.YU,this.TR=Math.max(this.YU-(h-(this.nV-this.YU))-(5-Math.abs(z)),0)):(this.MR=Math.floor(this.nV)-this.YU,this.TR=Math.max(this.YU-(h-(this.nV-this.YU)),0)),this.nJ.style.top=this.TR+"px",this.nJ.style.bottom=
this.MR+"px",ta&&(this.YU=this.TR,this.VU=this.MR));R&&(R=Math.max(this.WU-b,0),h=Math.floor(this.oV)-this.XU-R,5<=h?(this.NR=R,this.QR=this.XU):5>h&&0<=h||0>h&&!this.XU?(this.NR=R-(5-h),this.QR=this.XU):0>h&&5>=Math.abs(h)?(this.NR=Math.floor(this.oV)-this.XU,this.QR=Math.max(this.XU-(R-(this.oV-this.XU))-(5-Math.abs(h)),0)):(this.NR=Math.floor(this.oV)-this.XU,this.QR=Math.max(this.XU-(R-(this.oV-this.XU)),0)),this.nJ.style.left=this.NR+"px",this.nJ.style.right=this.QR+"px",ta&&(this.WU=this.NR,
this.XU=this.QR));ba&&(b=Math.max(this.XU-b,0),ba=Math.floor(this.oV)-this.WU-b,5<=ba?(this.QR=b,this.NR=this.WU):5>ba&&0<=ba||0>ba&&!this.WU?(this.QR=b-(5-ba),this.NR=this.WU):0>ba&&5>=Math.abs(ba)?(this.QR=Math.floor(this.oV)-this.WU,this.NR=Math.max(this.WU-(b-(this.oV-this.WU))-(5-Math.abs(ba)),0)):(this.QR=Math.floor(this.oV)-this.WU,this.NR=Math.max(this.WU-(b-(this.oV-this.WU)),0)),this.nJ.style.left=this.NR+"px",this.nJ.style.right=this.QR+"px",ta&&(this.WU=this.NR,this.XU=this.QR));ta&&(this.$8c=
!0,vb.App.xa.updateCommandUI())}Rrk(){this.TR=this.YU;this.MR=this.VU;this.NR=this.WU;this.QR=this.XU;this.nJ.style.top=this.TR+"px";this.nJ.style.bottom=this.MR+"px";this.nJ.style.left=this.NR+"px";this.nJ.style.right=this.QR+"px"}tBk(){if(this.$8c){v.ULS.sendTraceTag(22381066,322,50,"Commiting new Image Cropping Properties.");var b=Math.floor(1E5*this.YU/this.nV),h=Math.floor(1E5*this.VU/this.nV),r=Math.floor(1E5*this.WU/this.oV),z=Math.floor(1E5*this.XU/this.oV),R=new Ei.DictionaryPropertySet;
R.setValue(od.a.bfb,b);R.setValue(od.a.Zeb,h);R.setValue(od.a.$eb,r);R.setValue(od.a.afb,z);this.ga.Qf(this.tcd,Oa.a.K6h,2,!1,null,R)}else v.ULS.sendTraceTag(23070481,322,50,"No New Cropping Properties To Commit.")}Hta(){return this.oHa}uol(){return{top:this.TR,bottom:this.MR,left:this.NR,right:this.QR}}mjo(b,h){if(0>b)v.ULS.sendTraceTag(22552777,322,15,"Unexpected negative value for new Crop properties.");else{switch(h){case 0:this.YU=this.TR=Math.min(Math.floor(this.nV)-this.MR-5,b);this.nJ.style.top=
this.TR+"px";break;case 1:this.VU=this.MR=Math.min(Math.floor(this.nV)-this.TR-5,b);this.nJ.style.bottom=this.MR+"px";break;case 2:this.WU=this.NR=Math.min(Math.floor(this.oV)-this.QR-5,b);this.nJ.style.left=this.NR+"px";break;case 3:this.XU=this.QR=Math.min(Math.floor(this.oV)-this.NR-5,b),this.nJ.style.right=this.QR+"px"}this.$8c=!0}}}Object(n.a)(jk,"ImageEditor",Vg,[547,548]);class wi{constructor(){this.W=null}get name(){return"WordEditor.ImageEditors"}yc(b){this.W=b;this.W.ha("WordEditor.ImageEditors.ImageCropDragAdapterFactory",
()=>new yb(t.AFrameworkApplication.ya,Sa.a.instance.Za("Common.IZoomManager"))).as("WordEditor.IImageCropDragAdapterFactory").singleInstance();this.W.ha("WordEditor.ImageEditors.ImageEditor",()=>new jk(b.resolve("Box4.IOutlineEditor"),b.resolve("Box4.IOutlineElementEditor"),b.resolve("Box4.Graph.IGraphTransactionFactory"),b.resolve("Box4.IParagraphEditor"),b.resolve("Box4.ICharacterPropertiesEditor"),b.resolve("Box4.ISelectionManager"),b.Za("Box4.IExternalSelectionManager"),b.resolve("Box4.ISelectionFactory"),
b.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance,b.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,b.resolve("Box4.CatchUpActivity.IChangeIdEditor"),rc.KeyInputManager.instance,b.Za("WordEditor.IImageCropDragAdapterFactory"),b.Pa("Box4.IFeatureHelper"))).as("WordEditor.IImageEditor").as("Box4.Images.IImageEditor").singleInstance()}init(){this.W.resolve("WordEditor.IImageCropDragAdapterFactory")}dispose(){}static main(){O.a.instance.Oc(new wi)}}Object(n.a)(wi,"WordEditorImageEditorsPackage",
null,[1,2]);class dn{}Object(n.a)(dn,"FolderContentEditor",null,[1392]);class jo{}Object(n.a)(jo,"PageEditor",null,[1317]);var ml=d(181);class Sm extends jo{constructor(){super()}get qh(){return ml.PageNavigator.instance}}Object(n.a)(Sm,"PageEditor",jo,[]);class Ln{get name(){return"WordEditor.NotebookLevelEditors"}yc(b){b.ha("Box4.NotebookLevelEditors.FolderContentEditor",()=>new dn).as("Box4.Folder.IFolderContentEditor").singleInstance();b.ha("WordEditor.NotebookLevelEditors.PageEditor",()=>new Sm).as("Box4.Pages.IPageEditor").singleInstance()}init(){}dispose(){}static main(){O.a.instance.Oc(new Ln)}}
Object(n.a)(Ln,"WordEditorNotebookLevelEditorsPackage",null,[1,2]);class nn{get vHb(){return t.AFrameworkApplication.bjb}xda(){v.ULS.sendTraceTag(37034014,342,50,"User clicked on the Privacy statement.");Ed.a.Cm(this.vHb,"_blank",void 0,"SendUsYourFileDialog.PrivacyLink");return!0}}Object(n.a)(nn,"PrivacyLinkHandler",null,[787]);class Np{constructor(b,h){this.HAe=null;this.VTj=b;this.UTj=h}showDialog(b){this.HAe=b;this.UTj.create().Wh(Object(u.a)(this,this.GSl,"handleDialog"))}GSl(b){1===b&&this.VTj.aXi();
this.HAe();this.HAe.prototype}}Object(n.a)(Np,"SendUsYourFileController",null,[770]);class Bo extends te.StandardDialog{constructor(b,h,r){super();this.ITb=null;this.ig=b;this.Qtc=h;this.oG=r}Wh(b){this.Fd=1;this.Ve(1,this.oG.send);this.Ve(0,this.oG.JLm);v.ULS.shipAssertTag(37034013,342,!this.ITb,"privacy anchor should be null before initializing it.");const h=this.BVk();this.xhb(this.oG.Jbk,null,"CancelRequest_32x32x32",null,b,h);this.u3(this.qj(Bo.hXi))}BVk(){const b=document.createElement("span");
b.innerText=this.oG.l9m;const h=document.createElement("span");h.innerText=this.oG.p7n;h.style.fontWeight=this.oG.xoo;const r=document.createElement("span");r.innerText=this.oG.nGn;const z=this.vDk(),R=document.createElement("span");R.id=this.qj(Bo.hXi);R.appendChild(b);R.appendChild(document.createElement("br"));R.appendChild(document.createElement("br"));R.appendChild(h);R.appendChild(document.createElement("br"));R.appendChild(r);R.appendChild(document.createElement("br"));R.appendChild(document.createElement("br"));
R.appendChild(document.createElement("br"));R.appendChild(z);return R}vDk(){const b=document.createElement("span"),h=document.createElement("a");h.innerText=this.oG.U8m;h.href=this.Qtc.vHb||"";b.appendChild(h);this.ITb=h;this.ig.mb(jb.a.click,this.ITb,Object(u.a)(this.Qtc,this.Qtc.xda,"clickHandler"));return b}dispose(){this.ITb&&(this.ig.sc(jb.a.click,this.ITb,Object(u.a)(this.Qtc,this.Qtc.xda,"clickHandler")),this.ITb=null);super.dispose()}}Bo.hXi="sendUsYourFileId";Object(n.a)(Bo,"SendUsYourFileDialog",
te.StandardDialog,[786]);class wq{create(){return Sa.a.instance.resolve("Wac.Common.SendUsYourFile.ISendUsYourFileDialog")}}Object(n.a)(wq,"Factory",null,[785]);var rn=d(590);class $o extends rn.a{constructor(){super();this.FileId=null}Wl(){return 38}static construct(b){const h=new $o;h.FileId=b;return h}}Object(n.a)($o,"CreateSendUsYourFileRequest",rn.a,[]);var ko=d(1054);class zs{constructor(b,h,r){this.Qba=b;this.HR=h;this.LLj=r}aXi(b=!1){if(this.HR){const h=$o.construct(this.HR()),r=new ko.a;
r.Yr=h;r.status=1;r.iH="BootErrorReport";b=b?this.Qba(null):this.Qba(z=>{this.NYc(r,z)});b.JJ(r);b.qW();this.LLj()}}NYc(b){5===b.statusCode&&this.aXi(!0)}}Object(n.a)(zs,"SendUsYourFileManager",null,[769]);class lp{constructor(b,h){this.W=null;this.oG=b;this.HR=h}yc(b){this.W=b;this.W.ha("Wac.Common.SendUsYourFile.ISendUsYourFileDialogStrings",()=>this.oG).singleInstance();this.W.ha("Wac.Common.SendUsYourFile.ISendUsYourFileDialog",()=>new Bo(sf.a.instance,new nn,this.W.resolve("Wac.Common.SendUsYourFile.ISendUsYourFileDialogStrings")));
this.W.ha("Wac.Common.SendUsYourFile.ISendUsYourFileManager",()=>new zs(h=>this.bla(0,h),this.HR,()=>{v.ULS.sendTraceTag(42022664,342,50,"send us your file request is now sent.")}));this.W.ha("Wac.Common.SendUsYourFile.ISendUsYourFileController",()=>{const h=new wq;return new Np(this.W.resolve("Wac.Common.SendUsYourFile.ISendUsYourFileManager"),h)}).singleInstance()}init(){this.W.resolve("Wac.Common.SendUsYourFile.ISendUsYourFileController")}dispose(){}}Object(n.a)(lp,"SendUsYourFilePackageManager",
null,[]);var Wq=d(565),su=d(995),Xq;(function(b){b[b.none=0]="none";b[b.oneNote=1]="oneNote";b[b.word=2]="word";b[b.wordViewer=3]="wordViewer";b[b.powerPoint=4]="powerPoint"})(Xq||(Xq={}));Object(n.b)("AppMode",Xq);class As{get Jbk(){return CommonUIStrings.l_AppTitle}get send(){return CommonUIStrings.l_Send}get JLm(){return CommonUIStrings.l_NoThanks}get l9m(){return WordEditorIntl.WordEditorStrings.L_ProblemOpeningDocument}get p7n(){return WoncaIntl.WoncaStrings.l_SaveErrorReportTitle}get xoo(){return CommonUIStrings.l_UserInterfaceFontWeightBold}get nGn(){return WordEditorIntl.WordEditorStrings.L_SendUsYourFileDialogText}get U8m(){return CommonUIStrings.l_PrivacyStatement}}
Object(n.a)(As,"WordEditorSendUsYourFileDialogStrings",null,["__INTERFACE__@1js/wac-common:ISendUsYourFileDialogStrings"]);class Mr extends lp{constructor(){super(new As,()=>t.AFrameworkApplication.rootQuerySignature)}bla(b,h){return new su.a(b,h,"SendUsYourFile.ashx",Xq.word,vb.App.webServiceBase,void 0,void 0,Wq.a.amIAlone,Wq.a.dSi,Wq.a.gRi)}get name(){return"WordEditor.SendUsYourFile"}static main(){O.a.instance.Oc(new Mr)}}Object(n.a)(Mr,"PackageManager",lp,["__INTERFACE__@1js/msoserviceplatform:IPackage",
"__INTERFACE__@1js/msoserviceplatform:IContainerConfiguration"]);var sn=d(658),lo=d(663),ap=d(444);class wr extends ap.a{constructor(){super();this.LargePreviewIconStyle=this.PreviewIconStyle=this.FullIconStyle=this.Icon=null}get Type(){return 4}}Object(n.a)(wr,"IconGalleryButtonProps",ap.a,[]);var Im=d(129),Gi=d(32),bq=d(165),cq=d(74),xq=d(760),sg=d(156),th=d(971);class Bj{constructor(b,h,r,z,R,ba){this.LKh=b;this.gallerySectionId=h;this.Y5k=r;this.bak=z;this.commandId=R;this.queryCommandId=ba}}
Object(n.a)(Bj,"BorderStyleMenuPropsArguments",null,[]);class lj{constructor(b,h,r,z,R,ba,ta){this.lYb=b;this.P8i=h;this.width=r;this.Qui=z;this.height=R;this.Zki=ba;this.altText=ta}}Object(n.a)(lj,"TableBorderStyleProperties",null,[]);class Wd{constructor(){this.lgh=[new lj(Wd.B6i,"","2",1,8,0,"Solid Line"),new lj(Wd.Pwh,"5,3","1",1,8,0,"Dashed Line"),new lj(Wd.GBh,"1,1","1",1,8,0,"Dotted Line"),new lj(Wd.IBh,"","1",2,8,3,"Double Line")];this.mgh=[new lj(Wd.tgh,"","1",1,8,0,"0.25pt"),new lj(Wd.qgh,
"","1",1,8,0,"0.5pt"),new lj(Wd.wgh,"","2",1,8,0,"0.75pt"),new lj(Wd.rgh,"","2",1,8,0,"1pt"),new lj(Wd.pgh,"","3",1,8,0,"1.5pt"),new lj(Wd.xgh,"","4",1,8,0,"2.25pt"),new lj(Wd.vgh,"","4",1,8,0,"3pt"),new lj(Wd.ogh,"","5",1,8,0,"4.5pt"),new lj(Wd.ugh,"","6",1,8,0,"6pt")]}initialize(){this.Iln()}tfl(){const b=new Bj("Line Style gallery","DefaultLineStyleOptions","LineStyleOptionsGallery",this.lgh,Fb.a.wkb,Fb.a.rPf);return this.eLh(b)}ufl(){const b=new Bj("Line Weight gallery","DefaultLineWeightOptions",
"LineWeightOptionsGallery",this.mgh,Fb.a.xkb,Fb.a.sPf);return this.eLh(b)}QMh(b){switch(b){case Wd.B6i:return sg.a.mYb;case Wd.Pwh:return sg.a.vab;case Wd.GBh:return sg.a.Hzc;case Wd.IBh:return sg.a.B1;default:return sg.a.Bra}}RMh(b){switch(b){case Wd.tgh:return sg.a.sgh;case Wd.qgh:return sg.a.ETe;case Wd.wgh:return sg.a.jYb;case Wd.rgh:return sg.a.uab;case Wd.pgh:return sg.a.Nja;case Wd.xgh:return sg.a.lza;case Wd.vgh:return sg.a.rda;case Wd.ogh:return sg.a.JVa;case Wd.ugh:return sg.a.kza;default:return sg.a.bF}}eLh(b){const h=
new ni.a,r=new hi.a,z=Object.assign(new lo.a,{Id:b.LKh,ExternalId:b.gallerySectionId,ExternalGalleryId:b.Y5k,Type:4,Width:1,GalleryItems:[]});for(let ba of b.bak){var R={};const ta={};ta.width=Wd.yrm;ta.height=Wd.xrm;R.root=ta;R=Object.assign(new wr,{Id:ba.lYb,ExternalId:String.format("{0}_GalleryButton",ba.lYb),Icon:ba.lYb,Command:b.commandId.toString(),QueryCommand:b.queryCommandId.toString(),MenuItemId:ba.lYb,FullIconStyle:R,ShouldSetTitle:"true",Alt:ba.altText});z.GalleryItems.push(R)}r.ControlList=
[];h.MenuSectionList=[];r.ControlList.push(z);h.MenuSectionList.push(r);h.UpdateDynamically=!0;return h}Iln(){const b={};for(let h of this.lgh)b[h.lYb]=appChrome.buildBorderStyleIcon(h.P8i,h.width,h.Qui,h.height,h.Zki);for(let h of this.mgh)b[h.lYb]=appChrome.buildBorderStyleIcon(h.P8i,h.width,h.Qui,h.height,h.Zki);appChrome.api.registerIconProvider(()=>b)}KHn(b,h,r){if(!b)return v.ULS.sendTraceTag(578073118,306,15,"table border context should not be null."),!1;if(b.contextId!==kc.a.E3)return v.ULS.sendTraceTag(577910617,
306,15,"Context should be of type table border. Getting context of type: {0}",b.contextId),!1;switch(b.border){case 2:this.s_(Im.a.kT(b),b.node,5,r,h);break;case 0:this.s_(Im.a.kT(b),b.node,3,r,h);break;case 1:this.s_(Im.a.kT(b),b.node,4,r,h);break;case 3:this.s_(Im.a.kT(b),b.node,0,r,h);break;case 7:this.s_(Im.a.kT(b),b.node,1,r,h);break;case 8:this.s_(Im.a.kT(b),b.node,2,r,h);break;case 6:this.s_(Im.a.kT(b),b.node,1,r,h);this.s_(Im.a.kT(b),b.node,2,r,h);break;case 5:this.s_(Im.a.kT(b),b.node,3,
r,h);this.s_(Im.a.kT(b),b.node,5,r,h);this.s_(Im.a.kT(b),b.node,4,r,h);this.s_(Im.a.kT(b),b.node,0,r,h);break;case 4:this.s_(Im.a.kT(b),b.node,3,r,h),this.s_(Im.a.kT(b),b.node,5,r,h),this.s_(Im.a.kT(b),b.node,4,r,h),this.s_(Im.a.kT(b),b.node,0,r,h),this.s_(Im.a.kT(b),b.node,1,r,h),this.s_(Im.a.kT(b),b.node,2,r,h)}return!0}yXf(b,h,r,z){if(!h)return v.ULS.sendTraceTag(578073119,306,15,"cell border context should not be null."),!1;if(h.contextId!==kc.a.y_)return v.ULS.sendTraceTag(577910656,306,15,"Context should be of type cell border. Getting context of type: {0}",
h.contextId),!1;var R=h.node;const ba=new Nd.GraphIterator;ba.set(R);ba.Bb(14);R=Gi.TableCellReader.hLa(ba);switch(h.border){case 2:this.rPa(b,h.node,5,z,r,R);this.f7d(h.node,5,r);this.k6d(b,h.ZXa(),3,r,z,R);break;case 0:this.rPa(b,h.node,3,z,r,R);this.f7d(h.node,3,r);this.k6d(b,h.ZXa(),1,r,z,R);break;case 1:this.rPa(b,h.node,4,z,r,R);this.f7d(h.node,4,r);this.k6d(b,h.ZXa(),0,r,z,R);break;case 3:this.rPa(b,h.node,0,z,r,R),this.f7d(h.node,0,r),this.k6d(b,h.ZXa(),2,r,z,R)}return!0}$cn(b,h){if(Xd.SelectionEditor.xPc(b)&&
h)switch(b=Object(la.a)(bq.TableNodeBorderContext,b),b.border){case 2:this.WN(b.node,Wd.vo.HL(5),h);break;case 0:this.WN(b.node,Wd.vo.HL(3),h);break;case 3:this.WN(b.node,Wd.vo.HL(0),h);break;case 1:this.WN(b.node,Wd.vo.HL(4),h);break;case 7:this.WN(b.node,Wd.vo.HL(1),h);break;case 8:this.WN(b.node,Wd.vo.HL(2),h);break;case 5:h=this.WN(b.node,Wd.vo.HL(5),h);h=this.WN(b.node,Wd.vo.HL(3),h);h=this.WN(b.node,Wd.vo.HL(0),h);this.WN(b.node,Wd.vo.HL(4),h);break;case 6:h=this.WN(b.node,Wd.vo.HL(1),h);this.WN(b.node,
Wd.vo.HL(2),h);break;case 4:h=this.WN(b.node,Wd.vo.HL(5),h),h=this.WN(b.node,Wd.vo.HL(3),h),h=this.WN(b.node,Wd.vo.HL(0),h),h=this.WN(b.node,Wd.vo.HL(4),h),h=this.WN(b.node,Wd.vo.HL(1),h),this.WN(b.node,Wd.vo.HL(2),h)}}Ebn(b,h){if(Xd.SelectionEditor.yPc(b)&&h)switch(b=Object(la.a)(bq.TableNodeBorderContext,b),b.border){case 2:this.WN(b.node,Wd.vo.QN(5),h);break;case 0:this.WN(b.node,Wd.vo.QN(3),h);break;case 3:this.WN(b.node,Wd.vo.QN(0),h);break;case 1:this.WN(b.node,Wd.vo.QN(4),h)}}Jbf(b,h,r){r=
null;if(!b)return v.ULS.sendTraceTag(575980876,306,15,"Node should not be null"),r;b.properties.hasProperty(h.size)&&(r=new th.a,r.weight=b.properties.ia(h.size,sg.a.bF),r.style=b.properties.ia(h.style,sg.a.Bra),r.color=b.properties.ia(h.color,0));return r}xXf(b,h,r){b?r?(b.properties.setValue(h.size,r.weight),b.properties.setValue(h.style,r.style),b.properties.setValue(h.color,r.color)):v.ULS.sendTraceTag(575980878,306,15,"Property Value object should not be null"):v.ULS.sendTraceTag(575980877,306,
15,"Node should not be null")}rIb(b,h){b?(b.properties.removeProperty(h.size),b.properties.removeProperty(h.style),b.properties.removeProperty(h.color)):v.ULS.sendTraceTag(575980879,306,15,"Node should not be null")}s_(b,h,r,z,R){R=this.omo(b,h,r,z,R);this.Ldc(h,Wd.vo.HL(r),R);switch(r){case 5:this.MOa(h,2,z,R);break;case 4:this.MOa(h,1,z,R);break;case 0:this.MOa(h,3,z,R);break;case 3:this.MOa(h,0,z,R);break;case 1:this.MOa(h,7,z,R);break;case 2:this.MOa(h,8,z,R)}}omo(b,h,r,z,R){if(3!==z){var ba=
Wd.Yg.qFd(b,h,r,3);void 0!==ba&&null!==ba&&ba!==sg.a.$Y&&(ba=cq.a.Tcc(ba),R.color=Wd.pgc.yza(h,ba))}1!==z&&(ba=Wd.Yg.qFd(b,h,r,1),void 0!==ba&&null!==ba&&ba!==sg.a.aF&&(R.weight=parseFloat(ba)*sg.a.kYb));2!==z&&(b=Wd.Yg.qFd(b,h,r,2),void 0!==b&&null!==b&&b!==sg.a.aF&&(R.style=b));return R}rPa(b,h,r,z,R,ba){z&&(R=this.Wgo(b,h,ba,r,z,R));this.Ldc(h,Wd.vo.QN(r),R)}Wgo(b,h,r,z,R,ba){if(3!==R){var ta="",Wa=Wd.Yg.dAb(b,h,z,!1,!0,r,3);Wa&&(ta=Wa.Zvb);void 0!==ta&&null!==ta&&ta!==sg.a.$Y&&(ta=cq.a.Tcc(ta),
ba.color=Wd.pgc.yza(h,ta))}if(1!==R){ta="";if(Wa=Wd.Yg.dAb(b,h,z,!1,!0,r,1))ta=Wa.Zvb;void 0!==ta&&null!==ta&&ta!==sg.a.aF&&(ba.weight=parseFloat(ta)*sg.a.kYb)}if(2!==R){R="";if(b=Wd.Yg.dAb(b,h,z,!1,!0,r,2))R=b.Zvb;void 0!==R&&null!==R&&R!==sg.a.aF&&(ba.style=R)}return ba}iJm(b){let h=0,r=0;({IIm:h,oGm:r}=this.jzl(b.style,h,r));b.weight<h&&(b.weight=h);b.weight>r&&(b.weight=r);return b}jzl(b,h,r){switch(b){case sg.a.mYb:case sg.a.vab:case sg.a.Hzc:h=2;r=48;break;case sg.a.B1:h=2;r=24;break;default:h=
2,r=48}return{IIm:h,oGm:r}}k6d(b,h,r,z,R,ba){if(h)if(z)for(let ta=0;ta<h.length;ta++)switch(r){case 2:this.rPa(b,h[ta],5,R,z,ba);break;case 0:this.rPa(b,h[ta],3,R,z,ba);break;case 1:this.rPa(b,h[ta],4,R,z,ba);break;case 3:this.rPa(b,h[ta],0,R,z,ba)}else v.ULS.sendTraceTag(578073121,306,15,"tableBorderPropertyValue should not be null");else v.ULS.sendTraceTag(578073120,306,15,"Adjacent cell array should not be null")}f7d(b,h,r){const z=new Nd.GraphIterator;z.set(b);z.Bb(14);const R=Gi.TableCellReader.dta(b);
b=Gi.TableCellReader.WP(b);Ke.forEachCell(z,R,b,(ba,ta,Wa)=>{ba=ba.currentNode;Gi.TableCellReader.Rr(ba)&&0==Wa&&0<ta&&this.Ldc(ba,Wd.vo.QN(h),r)})}Ldc(b,h,r){b?(r=this.iJm(r),b.properties.setValue(h.color,r.color),b.properties.setValue(h.size,r.weight),b.properties.setValue(h.style,r.style)):v.ULS.sendTraceTag(578073122,306,15,"Graph node should not be null")}MOa(b,h,r,z){if(b){var R=Ii.TableReader.ag(b),ba=Ii.TableReader.kh(b),ta=new Nd.GraphIterator,Wa=[];for(let ub=0;ub<R;ub++)for(let Ib=0;Ib<
ba;Ib++)if(ta.set(b),Ke.moveToCell(ta,ub,Ib),ta&&ta.currentNode&&!Gi.TableCellReader.qg(ta))switch(h){case 2:Gi.TableCellReader.efa(ta)&&Wa.push(bq.TableNodeBorderContext.P5(ta.currentNode,2));break;case 0:Gi.TableCellReader.ffa(ta)&&Wa.push(bq.TableNodeBorderContext.P5(ta.currentNode,0));break;case 3:Gi.TableCellReader.Frf(b,ta.currentNode)&&Wa.push(bq.TableNodeBorderContext.P5(ta.currentNode,3));break;case 1:Gi.TableCellReader.Grf(b,ta.currentNode)&&Wa.push(bq.TableNodeBorderContext.P5(ta.currentNode,
1));break;case 7:Gi.TableCellReader.Grf(b,ta.currentNode)||Wa.push(bq.TableNodeBorderContext.P5(ta.currentNode,1));break;case 8:Gi.TableCellReader.Frf(b,ta.currentNode)||Wa.push(bq.TableNodeBorderContext.P5(ta.currentNode,3))}for(b=0;b<Wa.length;b++)switch(h=Wa[b],h.border){case 2:this.FXc(h.node,Wd.vo.QN(5),r,z);this.q3d(h.ZXa(),Wd.vo.QN(0),r,z);break;case 0:this.FXc(h.node,Wd.vo.QN(3),r,z);this.q3d(h.ZXa(),Wd.vo.QN(4),r,z);break;case 1:this.FXc(h.node,Wd.vo.QN(4),r,z);this.q3d(h.ZXa(),Wd.vo.QN(3),
r,z);break;case 3:this.FXc(h.node,Wd.vo.QN(0),r,z),this.q3d(h.ZXa(),Wd.vo.QN(5),r,z)}}else v.ULS.sendTraceTag(578073123,306,15,"Table node should not be null")}q3d(b,h,r,z){if(b)for(let R=0;R<b.length;R++)this.FXc(b[R],h,r,z);else v.ULS.sendTraceTag(578062292,306,15,"Adjacent cell array should not be null")}FXc(b,h,r,z){if(b){var R=b.ia(h.color,Wd.y2e),ba=b.ia(h.size,Wd.A2e),ta=b.ia(h.style,Wd.z2e),Wa=new th.a;Wa.weight=z.weight;Wa.style=z.style;Wa.color=z.color;2!==r||R===Wd.y2e&&ba===Wd.A2e?3!==
r||ta===Wd.z2e&&ba===Wd.A2e?1!==r||R===Wd.y2e&&ta===Wd.z2e?(b.properties.removeProperty(h.color),b.properties.removeProperty(h.size),b.properties.removeProperty(h.style)):(Wa.color=R,Wa.style=ta,this.Ldc(b,h,Wa)):(Wa.style=ta,Wa.weight=ba,this.Ldc(b,h,Wa)):(Wa.color=R,Wa.weight=ba,this.Ldc(b,h,Wa))}else v.ULS.sendTraceTag(578073152,306,15,"Graph node should not be null")}WN(b,h,r){var z=b.properties.ia(h.style,sg.a.aF);z!==sg.a.aF&&(r.lineStyle!==sg.a.aF?r.lineStyle!==z&&(r.lineStyle=sg.a.Ijk):r.lineStyle=
z);z=b.properties.ia(h.size,sg.a.bF);z!==sg.a.bF&&(r.PQc!==sg.a.bF?r.PQc!==z&&(r.PQc=sg.a.Ajk):r.PQc=z);b=b.properties.ia(h.color,0);b=cq.a.MC(b);b!==sg.a.$Y&&(r.borderColor!==sg.a.$Y?r.borderColor!==b&&(r.borderColor=sg.a.sjk):r.borderColor=b);return r}static get vo(){return null!=Wd.Jgg?Wd.Jgg:Wd.Jgg=sg.a.instance}static get Yg(){return null!=Wd.ztg?Wd.ztg:Wd.ztg=Sa.a.instance.Pa("WordEditor.IWACTableStyleReader")}static get pgc(){return null!=Wd.yrg?Wd.yrg:Wd.yrg=xq.a.instance}}Wd.yrm="110px";
Wd.xrm="20px";Wd.B6i="SolidLineStyle";Wd.Pwh="DashedLineStyle";Wd.GBh="DottedLineStyle";Wd.IBh="DoubleLineStyle";Wd.tgh="BorderPointSizeOneQuarter";Wd.qgh="BorderPointSizeOneHalf";Wd.wgh="BorderPointSizeThreeQuarters";Wd.rgh="BorderPointSizeOne";Wd.pgh="BorderPointSizeOneAndHalf";Wd.xgh="BorderPointSizeTwoAndQuarter";Wd.vgh="BorderPointSizeThree";Wd.ogh="BorderPointSizeFourAndHalf";Wd.ugh="BorderPointSizeSix";Wd.z2e="single";Wd.A2e=4;Wd.y2e=0;Object(n.a)(Wd,"TableBorderManager",null,[531]);var Cm=
d(909),Jm=d(63),bp=d(197);class Op{constructor(b,h){this.AXg=this.$Rg=null;this.EJa=b;this.yUg=h}get cCi(){return this.yUg}get Oma(){return this.$Rg}get OQf(){return this.AXg}E_i(b,h){this.AXg=b;this.$Rg=h}PMn(b){this.yUg=b}}Object(n.a)(Op,"CellNodeAndOutlineElementInfoForInsertion",null,[]);var zi=d(101),xi=d(206),Wj=d(386),vm=d(152),km=d(261),Pi=d(595),dq=d(94),nl=d(445),mp=d(931);class Ak extends Cm.a{constructor(b,h,r,z,R,ba,ta,Wa,ub,Ib,$b=null,fc=null){super(b,h,r,fc,$b);this.V5a=mp.a.instance;
this.sa=new Te.a;this.PVe=[yc.a.ulb,yc.a.eQa,yc.a.C3a,yc.a.slb,yc.a.cQa,yc.a.A3a,yc.a.rlb,yc.a.bQa,yc.a.z3a,yc.a.tlb,yc.a.dQa,yc.a.B3a];this.uyj=[yc.a.va,yc.a.ta,We.a.Zh,We.a.Bq];this.Bi=z;this.Ltb=R;this.Xc=ba;this.ib=ta;this.C4=Wa;this.qm=ub;this.Xnc=Ib;this.H3g=$b;this.lYj=fc}get Ui(){return this.Bi.value}get Or(){return this.C4?this.C4.instance:null}tPe(b){this.sa.addHandler("OnParagraphDelete",b)}get yh(){return!!this.Xnc.instance&&this.Xnc.instance.yh}EMc(b,h,r,z,R){h.setValue(yc.a.Nc,ac.a.RF());
h.setValue(yc.a.eam,R);Pi.b(z,h,[yc.a.A_]);super.EMc(b,h,r,z,R)}vMd(b,h,r,z,R){const ba=this.AKc(h,r,z,R);this.Wwd(ba,h,!1);return super.vMd(b,h,r,z,R)}tqd(b,h,r,z,R){const ba=this.AKc(h,r,z,R);this.Wwd(ba,h,!0);super.tqd(b,h,r,z,R);return ba}XZe(b,h,r,z){h=this.AKc(b,h,r,z);this.Wwd(h,b,!0);return h}insertRows(b,h,r,z){const R=Jm.a.At(b),ba=new Nd.GraphIterator;ba.fd(b);const ta=ba.currentNode;ba.Rb(1);let Wa;Wa=h?b.aD(1):b.currentNode;const ub=b.mc();if(!ub)throw Error.create("table row insertion cannot be performed on a null tableNode");
const Ib=Ii.TableReader.ag(ub),$b=ub.CS.Yg;let fc=!1;try{ub.Lna=1;const Kc=this.V5a.sdb(ub,$b.Nz(ub));this.BPa(b.currentNode);this.Boa(b);this.A3j(r,b,Wa,ba,ta,h,z);const ed=this.V5a.sdb(ub,$b.Nz(ub));this.P2a(ub,Ii.TableReader.ag(ub)+r);fc=!0;this.eNd(ub,Kc,ed)}finally{ub.Lna=0,fc||this.P2a(ub,Ii.TableReader.ag(ub)+r)}R+1!==Ib||h?!R&&h&&Ak.Cof(ub,r):Ak.Cof(ub,R);h=R+r+(h?0:1);h<Ib+r&&this.t$h(ub,h);return b.currentNode}A3j(b,h,r,z,R,ba,ta){let Wa=null,ub=null;for(var Ib=0;Ib<b;++Ib){var $b=bp.a.instance.createInstance(393251);
ub||(ub=$b);Wa=$b;this.EMc(h,$b,r,R,ba)}b=Ii.TableReader.kh(h.currentNode);r=!0;do{r?(h.Ei(Wa),r=!1):h.vf(1);R=Array(b);for(Ib=0;Ib<b;++Ib){$b=this.jKa();const fc=this.XZe($b,z.currentNode,ba,!0);let Kc=null;fc.qg||(Kc=ta(fc));R[Ib]=new Op($b,Kc);R[Ib].E_i(fc,null);z.vf(1)}for(Ib=0;Ib<b;++Ib)$b=R[Ib].EJa,h.j1($b,1,Cm.a.cHa?Cm.a.cHa():null),Gi.TableCellReader.Rr($b)||(this.wvb(h,$b,R[Ib].cCi),this.bsh(R[Ib].OQf,$b,!0));z.k6(1)}while(h.currentNode!==ub)}insertColumns(b,h,r,z,R){let ba=b.currentNode,
ta=!1,Wa=Ii.TableReader.kh(b.currentNode);const ub=Wa;try{this.BPa(b.currentNode);this.Boa(b);const Ib=ba.CS.Yg;ba.Lna=1;const $b=this.V5a.sdb(ba,Ib.Nz(ba));Wa=Ii.TableReader.kh(b.currentNode);-1===h&&(h=Wa);this.y3j(b,z,r,h,R);ba=b.currentNode;Wa+=z;this.hQf(b,Wa,z,h);ta=!0;const fc=this.V5a.sdb(ba,Ib.Nz(ba));this.eNd(ba,$b,fc)}finally{ba.Lna=0,ta||this.hQf(b,Wa,z,h)}h!==ub||r?!h&&r&&Ak.Bof(ba,z):Ak.Bof(ba,h-1)}y3j(b,h,r,z,R){var ba=b.currentNode;z=r?z:z-1;b.Rb(1);var ta=new Ua.a;do{var Wa=b.$C(z,
1);b.mc();var ub=Array(h);for(let $b=0;$b<h;++$b){var Ib=this.jKa();const fc=this.RAl(b,Wa,r),Kc=this.XZe(Ib,Wa,r,!1);Ib=new Op(Ib,null);Ib.E_i(Kc,fc);ub[$b]=Ib}ta.add(ub)}while(b.Wi(1));r=ta.toArray();for(z=0;z<r.length;z++)for(ta=0;ta<h;ta++)Wa=r[z][ta],ub=Wa.OQf,ub.qg||Wa.PMn(R(ub));b.set(ba);b.Rb(1);R=0;do{for(ba=0;ba<h;++ba)z=r[R][ba],ta=z.EJa,b.lCb(ta,z.Oma,1,Cm.a.cHa?Cm.a.cHa():null),Gi.TableCellReader.Rr(ta)||(this.wvb(b,ta,z.cCi),this.bsh(z.OQf,ta,!1));R++}while(b.Wi(1))}eNd(b,h,r){if(h){var z=
2===b.Lna,R=[],ba=new Nd.GraphIterator;ba.set(b);for(var ta=ba.Rb(1);ta;){for(ta=ba.Rb(1);ta;){const Wa=ta.id.toString();Wa in h&&h[Wa]===r[Wa]&&(!z||!Gi.TableCellReader.ffa(ba)&&!Gi.TableCellReader.efa(ba))||R.push(ta);ta=ba.Wi(1)}ta=ba.Wi(1)}if(0<R.length){h=new yf.GraphTransaction(3);try{h.set(b.Qi);for(let Wa of R)Wa.cNd()}finally{h&&h.dispose()}}}}deleteRows(b,h){const r=Jm.a.At(b),z=r+h;let R=b.mc();const ba=R.CS.Yg;let ta=!1;v.ULS.sendTraceTag(579479247,341,50,"Performing DeleteRows. Table node Id: {0}, Table Node Type: {1},  Row index: {2}, Row count to delete: {3}",
R.id.toString(),R.type,r,h);const Wa=Ii.TableReader.ag(R);try{R.Lna=2;const ub=this.V5a.sdb(R,ba.Nz(R));this.BPa(b.currentNode);this.Boa(b);for(let $b=z-1;$b>=r;--$b){b.$C($b,1);let fc=b.Rb(1);for(;fc;)this.pTc(fc,!0),fc=b.Wi(1);this.cZa(b);v.ULS.sendTraceTag(579479248,341,50,"Deleting table row node: ID:{0}, Type:{1}",b.currentNode.id.toString(),b.Qe);b.Eg()}R=b.currentNode;const Ib=this.V5a.sdb(R,ba.Nz(R));this.P2a(R,Ii.TableReader.ag(R)-h);this.YWd(b);ta=!0;this.eNd(R,ub,Ib)}finally{R.Lna=0,ta||
(this.P2a(b.currentNode,Ii.TableReader.ag(b.currentNode)-h),this.YWd(b))}Wa===z&&0<=r-1&&Ak.Cof(R,r-1);r<Wa-h&&this.t$h(R,r)}deleteColumns(b,h,r){b=Object(la.a)(Nd.GraphIterator,b);let z=Object(la.a)(nl.a,b.currentNode),R=Ii.TableReader.kh(b.currentNode);const ba=z.CS.Yg;let ta=!1;v.ULS.sendTraceTag(579479249,341,50,"Performing DeleteColumns. Table Node Id:{0}, Table Node type:{1}, Column Index: {2}, Column count to delete: {3}",z.id.toString(),z.type,h,r);const Wa=R;try{z.Lna=2;const ub=this.V5a.sdb(z,
ba.Nz(z));this.BPa(b.currentNode);this.Boa(b);-1===h&&(h=R-r);b.Rb(1);do for(let $b=h+r-1;$b>=h;--$b)b.$C($b,1),this.pTc(b.currentNode,!1),this.cZa(b),b.Eg();while(b.Wi(1));R-=r;this.gQf(b,R,h,r);ta=!0;z=Object(la.a)(nl.a,b.currentNode);const Ib=this.V5a.sdb(z,ba.Nz(z));this.eNd(z,ub,Ib);this.XWd(b)}finally{z&&(z.Lna=0),ta||(this.gQf(b,R,h,r),this.XWd(b))}Wa===h+r&&0<=h-1&&Ak.Bof(z,h-1)}mergeCells(b,h,r){if(b&&(1!==h||1!==r)){var z=new Nd.GraphIterator;z.fd(b);z.Bb(14);this.q0e(z,h,r);this.Ego(z,
h,r);z.mc();z.mc();this.myi(z)}}e7i(b,h,r){if(b&&(1!==h||1!==r)){var z=new Nd.GraphIterator;z.fd(b);z.Bb(14);this.FNk(z,h,r);z.mc();z.mc();this.uAi(z)}}pTc(b,h){v.ULS.sendTraceTag(579479250,341,50,"Table cell getting deleted. ID:{0}, Type:{1}",b.id.toString(),b.type);this.xSl(b,h,Object(u.a)(this,this.$Nf,"promoteToNonGhostCellImpl"))}$Nf(b,h){const r=b.currentNode;r.qg=!1;this.Wwd(h.currentNode,b.currentNode,!0);r.removeProperty(yc.a.skippedCell);r.removeProperty(yc.a.renderCell);1===r.colSpan&&
1===r.rowSpan&&r.TAc();Cm.a.BJ.r5(b,!0,Cm.a.GVh(h.currentNode));Ke.returnToCell(b);this.wGk(h,b)}dkf(b,h,r){super.dkf(b,h,r);1===h.controlCell.colSpan&&1===h.controlCell.rowSpan?h.controlCell.TAc():!r&&h.b5d&&(b.QLa?1<b.colSpan&&(h=new Nd.GraphIterator,h.set(b),h.Bb(15),Ke.moveToNextColumn(h),h.currentNode.colSpan=b.colSpan-1):(r=new Nd.GraphIterator,r.set(h.controlCell),r.Bb(15),h=dq.a(r),r=new Nd.GraphIterator,r.set(b),r.Bb(15),Ke.moveToColumnByIndex(r,h),--r.currentNode.colSpan))}AKc(b,h,r,z){const R=
super.AKc(b,h,r,z);if(b.qg&&!z){var ba=h.pua;ba.b5d&&(z=Cm.a.l2b(ba.controlCell,z),!ba.uvd&&r||ba.uvd===z-1&&!r?b.colSpan=1:(r=new Nd.GraphIterator,r.set(ba.controlCell),r.Bb(15),ba=dq.a(r),r=new Nd.GraphIterator,r.set(h),r.Bb(15),Ke.moveToColumnByIndex(r,ba),r.currentNode.colSpan+=1))}R.ia(yc.a.skippedCell,!1)&&(b.qg=!0,b.F2=!0,b.Mkb=!0);return R}YWd(b){this.eMb(b,yc.a.complexTable)}XWd(b){this.eMb(b,yc.a.complexTable)}myi(b){this.eMb(b,yc.a.complexTable)}uAi(b){this.eMb(b,yc.a.complexTable)}wGk(b,
h){if(b&&h){let r;b=Nd.GraphIterator.$a(b.currentNode);uf.OutlineNavigator.P6(b)&&(b.Rb(2),b=b.currentNode,12==b.type&&(r=b.Og(We.a.Zh)));r&&(b=new Nd.GraphIterator,b.fd(h),uf.OutlineNavigator.P6(b)&&b.Rb(2)&&(h=b.currentNode,12==h.type&&h.lh(We.a.Zh,r)))}}Wwd(b,h,r){b&&(Pi.b(b,h,this.PVe),Pi.b(b,h,[We.a.ZH]),r&&Pi.b(b,h,[yc.a.vM,yc.a.vO,yc.a.JEa,yc.a.HEa,yc.a.cha,yc.a.skippedCell,yc.a.renderCell]))}bsh(b,h,r){b&&(b=Nd.GraphIterator.$a(b),b.vd(),b.Xd(),h=Nd.GraphIterator.$a(h),h.vd(),h.Xd(),vg.OutlineElementReader.Nh(b)&&
ag.OutlineElementNavigator.De(b)&&vg.OutlineElementReader.Nh(h)&&ag.OutlineElementNavigator.De(h)&&Pi.b(b.currentNode,h.currentNode,this.uyj),r&&(ag.OutlineElementNavigator.Zd(b),ag.OutlineElementNavigator.Zd(h),mc.ListReader.ai(b)&&(r=Ak.csm.Hs(b),r.Tz=zi.a.Yi,{LBa:r}=Ak.Ko.ura(r.propertySet,h,r))))}cZa(b){this.yh&&this.qm.gon(b.currentNode);for(b=xi.a.Xp(b);b.moveNext();)if(ie.ParagraphReader.nc(b.currentNode)){const h=Md.e(b.currentNode);for(let r of h)r.Qfa();this.sa.raiseEvent("OnParagraphDelete",
b.currentNode)}else mc.ListReader.ai(b.iterator)&&this.Or&&this.Or.RDa(b.iterator)}sD(b,h){let r=null;if(this.H3g.ng){const z=Object(la.a)(nl.a,b);z&&(r=z.OQ())}Ii.TableReader.hm(b)&&(1===h?h=3:3===h&&(h=1));super.sD(b,h);this.H3g.ng&&this.lYj.dba(b,r);Object(nb.a)(nl.a,b)&&Cm.a.Kh.s0i(Object(la.a)(nl.a,b),(new Wj.a(1,0)).kt)}FYf(b,h){const r=Array(h),z=this.r_h(b)/h;for(let R=0;R<h;R++)r[R]=Math.max(Rf.a.pn(vm.a.uba,0),z);b.setValue(We.a.az,r)}i_i(b){b.setValue(yc.a.tableLayout,0)}vah(b,h,r,z,R){const ba=
Array(r);for(var ta=0,Wa=0;ta<z;++ta)ba[ta]=h[ta],Wa+=ba[ta];for(;ta<r;++ta)ba[ta]=0>ta-R?h[0]:h[ta-R],Wa+=ba[ta];ta=this.r_h(b.currentNode);if(Wa>ta)for(Wa=ta/Wa,ta=0;ta<r;++ta)ba[ta]=Math.max(Rf.a.pn(vm.a.uba,0),ba[ta]*Wa);return ba}r_h(b){var h=Nd.GraphIterator.$a(b);b=Rf.a.pn(Rf.a.Pi(Ii.TableReader.c_h(h),0),0);if(h.Bb(16))return Ke.returnToCell(h),h=vm.a.Ggc(h.currentNode),Rf.a.pn(Rf.a.Pi(h,0),0)-b;h=km.a.C2c(h);return Rf.a.pn(Rf.a.Pi(h,0),0)-b}WP(b,h,r){const z=new Nd.GraphIterator;z.set(b);
Ke.moveToCell(z,h,r);return z.currentNode.ia(yc.a.colSpan,1)}Qdc(b){var h=vb.App.xa.jb.wv;if(h.ze&&(h=b.Ce(h.Tb))){var r=!1,z=Ii.TableReader.kh(b),R=b.ia(We.a.az,Array(z));for(var ba of R)if(!ba){r=!0;break}if(r){R=Kh.a.clone(R);ba=b.ia(yc.a.complexTable,!1);v.ULS.sendTraceTag(36726403,341,50,"Performing set column widths: columnCount {0} | columnWidths: {1} | isComplexTable: {2}",z,R,ba);r=1;var ta=0;for(let ub=0;ub<z;)if(ba&&(r=this.WP(b,0,ub)),1<r){for(var Wa=0;Wa<r;Wa++)R[ub]||(R[ub]=this.mUh(0)),
ub++;ta+=r-1}else(Wa=h.tol(ub-ta))||v.ULS.sendTraceTag(36726404,341,50,"Got no width for graph column {0} (ghost cells {1})",ub,ta),R[ub]||(R[ub]=this.mUh(Wa)),ub++;b.setValue(We.a.az,R)}}}mUh(b){return Rf.a.pn(Math.max(b,vm.a.uba),0)}BPa(b){b=Nd.GraphIterator.$a(b);this.Qdc(b.currentNode);b.Bb(14)&&(Ke.returnToContainingTable(b),this.Qdc(b.currentNode))}p0i(b,h){h&&b.setValue(yc.a.J7,h)}hZf(b,h){h&&b.setValue(yc.a.Ofc,h)}Qmh(b,h){const r=Ii.TableReader.kh(b);Cm.a.hwk(b,h,r)}PIn(b,h,r){let z;if(!({tableNode:z}=
this.N7b(b)).returnValue)return!1;if(h&&r&&h.length===r.length){if(!this.sYk(z,h))return!1;for(let R=0;R<h.length;++R){const ba=this.Ltb.e_c(b,h[R],r[R]);if(ba)return v.ULS.sendTraceTag(17584922,341,10,"Unexpected failure to set data into table content control cell. error code is {0}",ba),!1}this.eVd(z);return!0}return!1}ick(b,h){let r;if(!({tableNode:r}=this.N7b(b)).returnValue||Ii.TableReader.HA(r))return!1;var z=Object(la.a)(Nd.GraphIterator,this.Xc.fg(r));Ke.moveToLastRow(z);var R=Ii.TableReader.ag(r);
if(h&&0<h.length){this.insertRows(z,!1,h.length,()=>null);z=Ii.TableReader.ag(r);var ba=this.Xc.fg(r);R=this.ZZh(ba,R,z-1);for(z=0;z<R.length;++z){ba=R[z];const ta=h[z];for(let Wa=0;Wa<ba.length;++Wa){let ub;if(ub=ta&&ta[Wa]?this.Ltb.e_c(b,ba[Wa],ta[Wa].toString()):this.Ltb.e_c(b,ba[Wa],""))return v.ULS.sendTraceTag(17584923,341,10,"Unexpected failure to set data into table content control cell. error code is {0}",ub),!1}}}this.eVd(r);return!0}Rbk(b,h){let r;if(!({tableNode:r}=this.N7b(b)).returnValue||
Ii.TableReader.HA(r))return!1;var z=this.Xc.fg(r),R=Ii.TableReader.kh(r);if(h&&0<h.length){this.insertColumns(Object(la.a)(Nd.GraphIterator,z),R,!1,h[1].length,()=>null);var ba=Ii.TableReader.kh(r);z=this.fLl(z,R,ba-1);for(R=0;R<z.length;++R){ba=h[R];const ta=z[R];for(let Wa=0;Wa<ta.length;++Wa){let ub;if(ub=ba&&ba[Wa]?this.Ltb.e_c(b,ta[Wa],ba[Wa].toString()):this.Ltb.e_c(b,ta[Wa],""))return v.ULS.sendTraceTag(17584924,341,10,"Unexpected failure to set data into table content control cell. error code is {0}",
ub),!1}}}this.eVd(r);return!0}iSk(b){let h;if(!({tableNode:h}=this.N7b(b)).returnValue)return!1;let r=this.rYa(h);const z=Ii.TableReader.ag(h);var R=this.Xc.fg(h);R=this.ZZh(R,r,z-1);for(let ba=0;ba<R.length;++ba){const ta=R[ba];for(let Wa=0;Wa<ta.length;++Wa){const ub=this.Ltb.IMi(b,ta[Wa]);if(ub)return v.ULS.sendTraceTag(17584925,341,10,"Unexpected failure to release content control in table cell. error code is {0}",ub),!1}}r=r?r:1;b=this.Xc.fg(h);b.uI(r)&&15===b.Qe&&this.deleteRows(Object(la.a)(Nd.GraphIterator,
b),z-r);this.eVd(h);return!0}rYa(b){let h=0;const r=this.Xc.fg(b);let z=r.Xd();for(;z&&z.ia(yc.a.zgb,!1);)h++,z=r.Du();return!h&&ki.StyleReader.E3a.nT(b)&32?1:h}Ego(b,h,r){var z,R;const ba=b.currentNode,ta=new Nd.GraphIterator;ta.fd(b);let Wa=null,ub=null,Ib=null;const $b=sg.a.instance.QN(3),fc=sg.a.instance.QN(4),Kc=sg.a.instance.QN(5),ed=sg.a.instance.QN(0);Ke.forEachCell(ta,h,r,(Jd,ge,qe)=>{Jd=Jd.currentNode;ge||qe||(Wa=Ak.$y.Jbf(Jd,$b,Wa));ge||qe!==r-1||(ub=Ak.$y.Jbf(Jd,fc,ub));0<ge&&!qe&&(Wa?
Ak.$y.xXf(Jd,$b,Wa):Ak.$y.rIb(Jd,$b),ub?Ak.$y.xXf(Jd,fc,ub):Ak.$y.rIb(Jd,fc),Ak.$y.rIb(Jd,Kc),ge!==h-1&&Ak.$y.rIb(Jd,ed));qe||ge!==h-1||(Ib=Ak.$y.Jbf(Jd,ed,Ib))});b=null===(R=null===(z=null===vb.App||void 0===vb.App?void 0:vb.App.xa)||void 0===z?void 0:z.jb)||void 0===R?void 0:R.wv;ub?(z=bq.TableNodeBorderContext.P5(ba,1),Ak.$y.yXf(Im.a.Uo(b),z,ub,0)):Ak.$y.rIb(ba,fc);z=bq.TableNodeBorderContext.P5(ba,0);if(Wa)Ak.$y.yXf(Im.a.Uo(b),z,Wa,0);else for(z=Object(la.a)(bq.TableNodeBorderContext,z).ZXa(),
R=0;R<z.length;R++)Ak.$y.rIb(z[R],fc);Ib?Ak.$y.xXf(ba,ed,Ib):Ak.$y.rIb(ba,ed)}sYk(b,h){for(let z=0;z<h.length;++z){var r=this.Xc.fg(h[z]);if(r.Bb(14)&&(r=r.kd(14),b.id===r.id))continue;return!1}return!0}N7b(b){let h=null;if(b&&b.mu.toString()!==b.Iz.toString())return{returnValue:!1,tableNode:h};h=this.Ui.Eb(b.mu);return 14===h.type&&this.Ltb.N7b(b)?{returnValue:!0,tableNode:h}:{returnValue:!1,tableNode:h}}ZZh(b,h,r){const z=[];Ke.forEachCellInTable(Object(la.a)(Nd.GraphIterator,b),(R,ba,ta)=>{if(ba>=
h&&ba<=r)ta||z.push([]),Gi.TableCellReader.qg(R)||Array.add(z[ba-h],R.currentNode);else if(ba>r)return!1;return!0});return z}fLl(b,h,r){const z=[];Ke.forEachCellInTable(Object(la.a)(Nd.GraphIterator,b),(R,ba,ta)=>{ta>=h&&ta<=r&&(ta===h&&z.push([]),Gi.TableCellReader.qg(R)||Array.add(z[ba],R.currentNode));return!0});return z}eVd(b){if(b&&14===b.type){b=Object(la.a)(Nd.GraphIterator,this.Xc.fg(b));const h=new Ua.a;ie.ParagraphReader.$db(b,!0,!1,h);b=Hf.SelectionFactory.xe(h.J(h.count-1),0);this.ib.setSelection(b)}}static get characterPropertiesEditor(){return null!=
Ak.Wgg?Ak.Wgg:Ak.Wgg=Sa.a.instance.resolve("Box4.ICharacterPropertiesEditor")}static get $y(){Ak.Qqa||(Ak.Qqa=Sa.a.instance.Pa("WordEditor.ITableBorderManager"));return Ak.Qqa}static get csm(){return null!=Ak.Mng?Ak.Mng:Ak.Mng=Sa.a.instance.resolve("Box4.List.IListReader")}static get Ko(){return null!=Ak.Hng?Ak.Hng:Ak.Hng=Sa.a.instance.resolve("Box4.List.IListEditor")}t$h(b,h){const r=new Nd.GraphIterator;r.set(b);Ke.moveToFirstRow(r);Ke.moveToRowByIndex(r,h);do r.currentNode.gk(4,!0);while(Ke.moveToNextRow(r))}static Cof(b,
h){if(b){var r=Ii.TableReader.ag(b),z=Ii.TableReader.kh(b);if(!(!vb.App.xa.jb.wv.ze||0>h||h>=r))for(r=new Nd.GraphIterator,r.set(b),b=0;b<z;b++){b?Ke.moveToNextColumn(r):Ke.moveToCell(r,h,b);if(!r||!r.currentNode||16!==r.currentNode.type)continue;let R=r.currentNode;Gi.TableCellReader.Rr(R)&&(R=Gi.TableCellReader.Vka(R));R&&R.gk(4,!0)}}else v.ULS.sendTraceTag(577868247,306,15,"Can not invalidate row when there is no table node")}static Bof(b,h){if(b){var r=Ii.TableReader.ag(b),z=Ii.TableReader.kh(b),
R=new Nd.GraphIterator;if(!(!vb.App.xa.jb.wv.ze||0>h||h>=z))for(z=0;z<r;z++){R.set(b);Ke.moveToCell(R,z,h);if(!R||!R.currentNode)continue;let ba=R.currentNode;Gi.TableCellReader.Rr(ba)&&(ba=Gi.TableCellReader.Vka(ba));ba&&ba.gk(4,!0)}}else v.ULS.sendTraceTag(577868248,306,15,"Can not invalidate column when there is no table node")}}Ak.Qqa=null;Object(n.a)(Ak,"TableEditor",Cm.a,[529,530]);class Pp{get name(){return"WordEditor.TableEditors"}yc(b){t.AFrameworkApplication.K.$("TableEditorsDelayInitializationEnabled")&&
(b.ha("WordEditor.TableEditors.TableEditor",()=>new Ak(b.resolve("Box4.IOutlineEditor"),b.resolve("Box4.IOutlineElementEditor"),b.resolve("WordEditor.IWACTableStyleReader"),new De.a(()=>vb.App.xa.jb.Yc.zd),b.resolve("WordEditor.ContentControl.ITableContentControlEditor"),new sn.a,di.a.instance,b.Za("WordEditor.IFlatListEditor"),b.resolve("Box4.ContentControl.IContentControlOperator"),b.Za("Box4.ContentControlConfigSettings"),b.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,b.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance)).as("WordEditor.ITableEditor").as("Box4.ITableEditor").singleInstance(),
b.ha("WordEditor.TableEditors.TableBorderManager",()=>new Wd).as("WordEditor.ITableBorderManager").singleInstance())}init(){}dispose(){}static main(){O.a.instance.Oc(new Pp)}}Object(n.a)(Pp,"WordEditorTableEditorsPackage",null,[1,2]);class Bs{get name(){return"WordEditor.TextLevelEditors"}yc(){}init(){}dispose(){}static main(){O.a.instance.Oc(new Bs)}}Object(n.a)(Bs,"WordEditorTextLevelEditorsPackage",null,[1,2]);var mo=d(1844);d(442);var Cs=d(759),cp=d(223),Co=d(260);class En{constructor(b){this.xPj=
b}cMk(){const b=bp.a.instance.createInstance(393228);b.setValue(We.a.sK,cp.a.first);b.setValue(We.a.Pfh,0);b.setValue(We.a.rfa,Ff.OutlineReader.Exh);(new Cs.OutlineIndentInfo(!0)).HUi(b);return b}r5(b,h,r=null){const z=b.currentNode;if(!b.oE(1))return this.qfb(b,null,h,r);vg.OutlineElementReader.kK(b)&&ag.OutlineElementNavigator.TAf(b,!0);return vg.OutlineElementReader.Nh(b)?En.Wg.eD(b,!1,h,r):(b.UYc(z),null)}erk(b){return Ff.OutlineReader.wsf(b.currentNode)||vg.OutlineElementReader.Nh(b)||vg.OutlineElementReader.kK(b)||
Gi.TableCellReader.isTableCell(b)}qfb(b,h=null,r=!1,z=null){if(!this.erk(b))return null;const R=En.Wg.vxb();this.hOn(R,b);b.lCb(R,h,1,null);b.Ei(R);r&&(En.Wg.zN(b,z),ag.OutlineElementNavigator.Zd(b));return R}hOn(b,h){if(h=this.pHl(h))switch(h.type){case 11:En.Wg.N5e(h,b,!0);break;case 8:h=En.Te.isRtl(h),En.Wg.OJb(b,h)}}pHl(b){return this.xPj.qHl(b)}NJb(b,h){b.setValue(We.a.Bq,h?11:9)}VIn(b,h){const r=Co.WordSectionNavigator.instance.$L(b);return r?Ff.OutlineReader.yL(b)!==h?(r.setValue(yc.a.L2e,
h),!0):!1:null}static get Te(){return ne.PageReader.instance}static get Wg(){return En.Kh||(En.Kh=Sa.a.instance.resolve("Box4.IOutlineElementEditor"))}static set Wg(b){En.Kh=b}}En.Kh=null;En.mg=null;Object(n.a)(En,"OutlineEditor",null,[537]);const Jx=b=>{b.ha("Box4.OutlineLevelEditors.OutlineEditor",()=>new En(b.resolve("Box4.IOutlineElementNodeIdFactory"))).as("Box4.IOutlineEditor").singleInstance();b.ha("Box4.OutlineLevelEditors.OutlineElementEditor",()=>new mo.a(b.ef("Box4.IOutlineEditor"),b.ef("Box4.List.IListEditor"),
b.ef("Box4.List.IListReader"),b.resolve("Box4.ICreateParagraphStrategy"),b.resolve("Box4.IMergeListEditorInOutlineElementStrategy"),b.resolve("Box4.IBox4GraphWriter"),b.resolve("Box4.IFormattingPropertyTransitStrategy"),b.resolve("Box4.Styles.IWACStyleEditor"),b.resolve("Box4.Styles.IWACStyleReader"))).as("Box4.IOutlineElementEditor").singleInstance()};class Us{get name(){return"Box4.OutlineLevelEditors"}yc(b){Jx(b)}init(){}dispose(){}static main(){O.a.instance.Oc(new Us)}}Object(n.a)(Us,"Box4OutlineLevelEditorsPackage",
null,[1,2]);class Bv{constructor(b){this.qyd=null;this.ivi=b.lb("OfficeOnlineChromeExtensionId");this.ovi=b.lb("ChromeClipboardAccessExtensionId");this.n$l=b.$("OfficeOnlineChromeExtensionIsEnabled");this.$_g=!this.$gm();this.qyd=this.Hkb?this.ovi:this.ivi}qwn(){this.qyd===this.ivi&&this.tei&&(localStorage.removeItem("IsOfficeOnlineExtensionInstalled"),localStorage.removeItem("IsCopyPasteSupported"));this.qyd=this.ovi;this.$_g=!0}get Hkb(){return this.$_g}$gm(){if(this.n$l&&this.tei){var b=localStorage.getItem("IsOfficeOnlineExtensionInstalled");
if(b&&"true"===b)return b=localStorage.getItem("IsCopyPasteSupported"),!!b&&"true"===b}return!1}get tei(){let b=!1;try{localStorage.setItem("LocalStorageAccessiblityTest","LocalStorageAccessiblityTest"),b="LocalStorageAccessiblityTest"===localStorage.getItem("LocalStorageAccessiblityTest"),localStorage.removeItem("LocalStorageAccessiblityTest")}catch(h){v.ULS.sendTraceTag(19452045,307,50,h.toString())}return b}}Object(n.a)(Bv,"ChromeExtensionHelper",null,[940]);var Dl=d(1424),Xt=d(516),tt=d(1381);
class Vs{create(b){return new tt.a(b)}}Object(n.a)(Vs,"Factory",null,[574]);var Zl=d(118);class bs{constructor(b,h,r){this.cZj=b;this.He=h;this.KUa=r}Vb(){this.KUa.gb(Fb.a.c0d,kc.a.application,this.c0d.bind(this),96);this.KUa.pa(Fb.a.uhc,kc.a.view,this.gmo.bind(this));this.KUa.gb(Fb.a.KIi,kc.a.view,this.hmo.bind(this),96)}c0d(b,h,r,z,R){if(1===r)return 32;b=Object.assign(new ni.a,{ExternalId:"StylesGalleryContextMenu",UpdateDynamically:!0,MenuSectionList:[]});h=[];r=Object.assign(new hi.a,{ControlList:[]});
r.ControlList.push(Object.assign(new nh.a,{ExternalId:"UpdateStyle",QueryCommand:"QueryUpdateStyle"}));h.push(r);Array.addRange(b.MenuSectionList,h);R.MenuItems=b;return 32}hmo(b,h,r,z,R){if(1===r)return 32;b=uj.a.Y8i();null==b&&8;b=this.He.zF(b);R[Ik.a.LabelText]=String.format(B.a.If(Box4Intl.Box4Strings.l_UpdateStyleCommand),b);return 32}gmo(b,h,r){b=uj.a.NDb(h);if(1===r||b)return b?8:32;r=new Map;r.set("Source","StyleContextMenuActor");r.set("Action","UpdateStyle");Ca.Health.instance.recordKpiUsage(Zl.a.Imb,
0,Zl.a.EB,r);this.cZj.kmo(h)?ud.b(539842578,3018,50,"User Successfully Updated styles from UI"):(h=new Map,h.set("Source","StyleContextMenuActor"),h.set("Action","UpdateStyle"),h=Object.assign(new eb.a,{extendedProperties:h}),Ca.Health.instance.recordKpiFailure(Zl.a.Imb,"UpdateStyleFailed",!1,!0,h),ud.b(539842780,3018,50,"User tried to update a style via UI, but we were unable to update it."));return 32}}Object(n.a)(bs,"StyleContextMenuActor",null,[]);var ao=d(997),ir=d(1490),jr=d(478),xh=d(1698);
class ut extends xh.a{constructor(b,h,r,z,R,ba,ta=null,Wa=null){super(b,ba,ta,Wa);this._formatting=null;this.XGa=!1;this.rpb=t.AFrameworkApplication.K.$("FollowDestinationFormattingPasteIsEnabled");this.Brb=0;this.twc=new Ua.a;ud.a(8128527,307,vg.OutlineElementReader.Nh(b));this.$K=h;this.$K.cYb(this);this.qp=r;this.Ko=z;this.hd=R;this.ZTe=Wa;this.uCe=mc.ListReader.ai(this.Bc)}get paragraphEditor(){return null!=this.ipg?this.ipg:this.ipg=Sa.a.instance.resolve("Box4.IParagraphEditor")}get kyd(){return null}get SZb(){return this.uCe&&
!this.$K.bAa}get Qxb(){return 0<this.Brb}Baa(b,h){if(!this.j0.R6f(this.Bc,h,!0)){ud.a(8701077,307,ie.ParagraphReader.zh(this.Bc));var r=this.Bc.currentNode,z=Qe.a.ow(r);this.rpb&&this._formatting.QP&&(r=r.qa.last,this.XGa&&(r.formatting=this._formatting.QP.Yf(r),this.XGa=!1),b=this.j0.kkf(b,h),this.j0.oEa(this.Bc.currentNode,this._formatting.Iaa,h));this.characterPropertiesEditor.replaceTextRange(z,b)}}aDa(){ud.a(8701078,307,ie.ParagraphReader.zh(this.Bc));const b=Qe.a.ow(this.Bc.currentNode);this.characterPropertiesEditor.Uea(b,
h=>new jr.a(h))}tib(){this.j0.pkf(this.Bc)}XCa(){this.rpb&&(this.XGa=!0)}PNa(){ud.a(8701079,307,ie.ParagraphReader.zh(this.Bc))}ONa(){ud.a(8701080,307,ie.ParagraphReader.zh(this.Bc))}MF(b){this.$K.bAa||(this.rpb?(this.TQe(b),this._formatting.Hbe(this.Bc.currentNode),b&&"P"===b.Z6.zLd&&this.ZTe.Mga(this.Bc.currentNode,this._formatting.uDa),this.j0.oEa(this.Bc.currentNode,this._formatting.Iaa,b)):this.Ohk(b))}LF(){this.$K.bAa||this.cFc()}UNa(){}Y0a(){}dDa(){ud.a(8701081,307,vg.OutlineElementReader.Nh(this.Bc)||
Ff.OutlineReader.xw(this.Bc)||ie.ParagraphReader.zh(this.Bc)&&this.$K.bAa);let b=!1;this.Qxb||(b=this.SZb||!0);b||(this.iU+=1);this.Brb++}bDa(){this.Brb--;let b=!1;this.Qxb||(b=this.SZb||!0,this.Ko.fSf(this.twc));b||--this.iU}TNa(b){ud.a(8701082,307,vg.OutlineElementReader.Nh(this.Bc)||Ff.OutlineReader.xw(this.Bc)||ie.ParagraphReader.zh(this.Bc)&&this.$K.bAa);ud.a(8701083,307,!!b.listStyleType)}cDa(){ud.a(8701084,307,vg.OutlineElementReader.Nh(this.Bc)||ie.ParagraphReader.zh(this.Bc)&&this.$K.bAa);
this.$K.bAa||ud.a(8701085,307,this.Bc.aq(2))}Aaa(b){this.$K.Aaa(b)}xaa(){this.$K.xaa()}sbe(b){this.twc.add(b)}zaa(b){this.$K.zaa(b)}yaa(){this.$K.yaa()}waa(b){this.$K.waa(b)}vaa(){this.$K.vaa()}Ohk(b){this.S9b(!1);(new Nd.GraphIterator).fd(this.Bc);b=xh.a.Wg.zN(this.Bc,this.PIc(b));ud.a(8128534,307,b===this.Bc.currentNode);ud.a(8128535,307,ie.ParagraphReader.nc(b))}cFc(){ud.a(8128536,307,ie.ParagraphReader.zh(this.Bc));ag.OutlineElementNavigator.Zd(this.Bc)}reset(){this.rpb&&(super.reset(),this._formatting=
this.idf(!0))}TQe(b){this.S9b(!1);(new Nd.GraphIterator).fd(this.Bc);b=xh.a.Wg.zN(this.Bc,this.PIc(b));ud.a(36577367,307,b===this.Bc.currentNode);ud.a(36577368,307,ie.ParagraphReader.nc(b));-1!==this._formatting.Zs&&this.paragraphEditor.sD(b,this._formatting.Zs);this._formatting.lineSpacing&&this.ZTe.hC(b,this._formatting.lineSpacing);this._formatting.ZI&&this.ZTe.t7d(b,this._formatting.ZI);this.XGa=!0;this._formatting.paragraph=b}static Swd(b,h){let r=0;switch(h){case 3:r=pg.a.BA(b);break;case 7:r=
Rf.a.Wy(b,0);break;case 1:r=pg.a.XVe(b);break;case 5:r=pg.a.BA(pg.a.FLf(b));break;default:v.ULS.sendTraceTag(36577369,307,50,"ConvertToTwips unable to convert inputValue {0} and inputUnit {1} to twips, returning 0",b,h)}return r}}Object(n.a)(ut,"TextOnlyBox4PasteSteward",xh.a,[]);class Qw{constructor(b,h,r,z){this.Jhd=b;this.uG=h;this.Cf=r;this.j0=z}create(b,h,r,z,R=null,ba=null,ta=null){return 1===b?new ut(h,z,this.Jhd,this.uG,this.Cf,R,ba,this.j0):new ir.Box4PasteSteward(h,r,z,this.Jhd,this.uG,
this.Cf,R,ba,this.j0,ta)}}Object(n.a)(Qw,"Box4PasteStewardFactory",null,[573]);var Su=d(237),yq=d(392),eq=d(1541);class np{constructor(b,h,r){this.ry=null;this.Crb=0;this.z8=null;this.Bc=b;this.Gk=r}cYb(b){this.ry=b}get bAa(){return 0<this.Crb}Aaa(b){ud.a(7869459,307,!!this.ry);ud.a(7869460,307,vg.OutlineElementReader.Nh(this.Bc)||Ff.OutlineReader.xw(this.Bc));ud.b(38563978,307,50,"Table pasting started");this.ry.S9b(!0);const h=new Nd.GraphIterator;h.fd(this.Bc);var r=eq.a.zZl[b.styleId];r||(r=eq.a.Lxh);
r=this.Gk.mjn(this.Bc,b.rowCount,b.Wab,r,b.tableLook,this.ry.PIc(b),b.zai);b.U3f&&(ud.b(573691298,3022,100,"Applying table border properties"),eq.a.Ach(b.U3f,this.Bc,!1,!0));b.iMd&&(ud.b(573691299,3022,100,"Applying indentation properties"),eq.a.bdk(this.Bc,b.iMd.spaceBefore,b.iMd.spaceAfter));b.vvd&&(ud.b(573691328,3022,100,"Applying column widths"),eq.a.Jck(b.vvd,this.Bc,Object(la.a)(yq.TableNode,r),b.D_a));this.ry.dsd(h,!1);this.Crb++;mc.ListReader.ai(h)&&this.ry.sbe(h.currentNode);ud.a(7869461,
307,Ii.TableReader.isTable(this.Bc))}xaa(){ud.a(7869462,307,!!this.ry);ud.a(7869463,307,Jm.a.isTableRow(this.Bc));ud.b(38563979,307,50,"Table pasting finished");this.F6&&this.Bc.it(14)&&eq.a.MUi(this.Bc.Cn);ag.OutlineElementNavigator.Zd(this.Bc);this.Crb--}zaa(b){ud.a(7869464,307,!!this.ry);ud.b(573691329,3022,100,"Table row pasting started");Ii.TableReader.isTable(this.Bc)?Ke.moveToFirstRow(this.Bc):Jm.a.isTableRow(this.Bc)&&Ke.moveToNextRow(this.Bc);b.height&&(ud.b(573691330,3022,100,"Applying table row height"),
eq.a.Pdk(this.Bc,b.height));ud.a(7869465,307,Jm.a.isTableRow(this.Bc))}yaa(){ud.a(7869466,307,!!this.ry);ud.a(7869467,307,Gi.TableCellReader.isTableCell(this.Bc));Ke.returnToContainingRow(this.Bc)}waa(b){ud.a(7869468,307,!!this.ry);ud.a(7869469,307,!this.ry.iU);Jm.a.isTableRow(this.Bc)?Ke.moveToFirstColumn(this.Bc):Gi.TableCellReader.isTableCell(this.Bc)?Ke.moveToNextColumn(this.Bc):ud.a(7869471,307,!1);if(this.Bc.currentNode){ud.b(573691331,3022,100,"Table cell pasting started");var h=Object(la.a)(Su.TableCellNode,
this.Bc.currentNode);ud.a(50689760,307,!h&&16!==this.Bc.currentNode.type||!!h&&16===this.Bc.currentNode.type);if(h){var r=new Nd.GraphIterator;r.fd(this.Bc);if(b.E7b)ud.b(573691332,3022,100,"Processing skipped cell"),eq.a.P$m(r,b);else{if(1<b.colSpan||1<b.rowSpan){const z=Ke.returnToContainingTable(r);if(!z)return;z.setValue(yc.a.complexTable,!0);r.fd(this.Bc);ud.b(573691333,3022,100,"Processing merged cell");eq.a.d$m(r,b);h.rowSpan=b.rowSpan;h.colSpan=b.colSpan}eq.a.Tdk(this.Bc,b.shadingColor);eq.a.vek(this.Bc,
b.verticalAlignment);eq.a.yck(this.Bc,b.X$d);eq.a.Ach(b.bha,this.Bc,!b.colSpan&&!b.rowSpan,!1);(new Nd.GraphIterator).fd(this.Bc);Ke.forEachCell(r,b.rowSpan,b.colSpan,(z,R,ba)=>{ud.b(573691334,3022,100,"Setting ghost cell borders");eq.a.gZi(z,b.bha,R,ba,b.rowSpan,b.colSpan)});eq.a.xek(this.Bc,b.width,b.D_a);ud.a(7869472,307,Ff.OutlineReader.xw(this.Bc))}}}}vaa(){ud.a(7869473,307,!!this.ry);ud.a(7869474,307,vg.OutlineElementReader.Nh(this.Bc)||Gi.TableCellReader.isTableCell(this.Bc));Ke.returnToCell(this.Bc);
ud.a(7869475,307,0>=this.ry.iU);this.ry.WWe()}get F6(){null==this.z8&&(t.AFrameworkApplication.Hf("he991617;3eed2178"),this.z8=t.AFrameworkApplication.K?t.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.TableCCPNewExperienceIsEnabled",!1):!1);return this.z8}}Object(n.a)(np,"Box4TableSteward",null,[599,205]);class Ws{constructor(b,h,r){this.ry=null;this.Crb=0;this.Bc=b;this.Gk=r}cYb(b){this.ry=b}get bAa(){return 0<this.Crb}Aaa(){this.bAa&&(ud.a(8787101,307,ie.ParagraphReader.zh(this.Bc)),
ag.OutlineElementNavigator.Zd(this.Bc));ud.a(8701086,307,!!this.ry);ud.a(8701087,307,vg.OutlineElementReader.Nh(this.Bc)||Ff.OutlineReader.xw(this.Bc));this.Crb++}xaa(){ud.a(8701088,307,!!this.ry);ag.OutlineElementNavigator.Zd(this.Bc);this.Crb--;if(this.bAa){this.ry.S9b(!0);const b=Ws.Wg.zN(this.Bc);ud.a(8787102,307,b===this.Bc.currentNode);ud.a(8787103,307,ie.ParagraphReader.zh(this.Bc))}}zaa(b){ud.a(8701089,307,!!this.ry);this.ry.S9b(!0);const h=new Nd.GraphIterator;h.fd(this.Bc);this.ry.dsd(h,
!1);mc.ListReader.ai(h)&&this.ry.sbe(h.currentNode);b=Ws.Wg.zN(this.Bc,this.ry.PIc(b));ud.a(8701090,307,b===this.Bc.currentNode);ud.a(8701091,307,ie.ParagraphReader.zh(this.Bc))}yaa(){ud.a(8701120,307,!!this.ry);ud.a(8701121,307,ie.ParagraphReader.zh(this.Bc));ag.OutlineElementNavigator.Zd(this.Bc)}waa(){ud.a(8701122,307,!!this.ry);ud.a(8701123,307,ie.ParagraphReader.zh(this.Bc));ud.a(8701124,307,!this.ry.iU);var b=this.Bc.currentNode;ie.ParagraphReader.textLength(b)&&(b=Qe.a.ow(b),this.ry.characterPropertiesEditor.replaceTextRange(b,
", "))}vaa(){ud.a(8701125,307,!!this.ry);ud.a(8701126,307,ie.ParagraphReader.zh(this.Bc));ud.a(8701127,307,0>=this.ry.iU);this.ry.WWe()}static get Wg(){return null!=Ws.xog?Ws.xog:Ws.xog=Sa.a.instance.resolve("Box4.IOutlineElementEditor")}}Object(n.a)(Ws,"TextOnlyBox4TableSteward",null,[599,205]);class Do{constructor(b,h,r=!1,z=!1){this.uG=b;this.Kw=h;this.hQj=r;this.pQj=z}create(b,h){return 1===b?new Ws(h,this.uG,this.Kw):new np(h,this.uG,this.Kw,this.hQj,this.pQj)}}Object(n.a)(Do,"Box4TableStewardFactory",
null,[572]);class tu{create(){return new eg.a}}Object(n.a)(tu,"Factory",null,[569]);class Ds{constructor(b){this.ga=b}yJm(b){if(4===b)b=Fb.a.FCa;else if(2===b)b=Fb.a.zga;else if(1===b)b=Fb.a.ZLb;else if(3===b)b=Fb.a.pXa;else return;this.ga.processAction(b,2)}zcb(){this.ga.processAction(Fb.a.zcb,2)}}Object(n.a)(Ds,"SelectionCommands",null,[570]);var Xs=d(262),Ys=d(1063),cs=d(147),uu=d(646);class Cv{constructor(){this.WPc=!1;this.Aqo=t.AFrameworkApplication.K.lb("WordEditorVisiFontFileUri");this.Cqo=
t.AFrameworkApplication.K.lb("WordEditorVisiRtlFontFileUri");this.Bqo=t.AFrameworkApplication.K.lb("WordEditorVisiPilcrowFontFileUri");this.xqo=t.AFrameworkApplication.K.lb("WordEditorVisiCarriageReturnFontFileUri");this.zqo=t.AFrameworkApplication.K.lb("WordEditorVisiCarriageReturnRtlFontFileUri")}O9n(){this.WPc=!this.WPc}N9n(b){this.O9n();let h=b.getElementsByClassName("VisiFontStyle")[0],r=b.getElementsByClassName("VisiFontRtlStyle")[0],z=b.getElementsByClassName("VisiFontPilcrowStyle")[0],R=b.getElementsByClassName("VisiFontCarriageReturnStyle")[0],
ba=b.getElementsByClassName("VisiFontCarriageReturnRtlStyle")[0];h||(h=document.createElement("Style"),h.className="VisiFontStyle",$e.a.iy(h,""),b.appendChild(h));r||(r=document.createElement("Style"),r.className="VisiFontRtlStyle",$e.a.iy(r,""),b.appendChild(r));z||(z=document.createElement("Style"),z.className="VisiFontPilcrowStyle",$e.a.iy(z,""),b.appendChild(z));R||(R=document.createElement("Style"),R.className="VisiFontCarriageReturnStyle",$e.a.iy(R,""),b.appendChild(R));ba||(ba=document.createElement("Style"),
ba.className="VisiFontCarriageReturnRtlStyle",$e.a.iy(ba,""),b.appendChild(ba));if(this.WPc)return v.ULS.sendTraceTag(593294047,324,50,"Formatting markers are inserted"),this.Vyc(h)&&this.Vyc(r)&&this.Vyc(z)&&this.Vyc(R)&&this.Vyc(ba);v.ULS.sendTraceTag(593294046,324,50,"Formatting markers are removed");return this.YXc(h)&&this.YXc(r)&&this.YXc(z)&&this.YXc(R)&&this.YXc(ba)}Vyc(b){return""===$e.a.Lz(b)?("VisiFontStyle"===b.className?$e.a.iy(b,this.fIc("WordVisi_MSFontService",this.Aqo)):"VisiFontRtlStyle"===
b.className?$e.a.iy(b,this.fIc("WordVisiRtl_MSFontService",this.Cqo)):"VisiFontPilcrowStyle"===b.className?$e.a.iy(b,this.fIc("WordVisiPilcrow_MSFontService",this.Bqo)):"VisiFontCarriageReturnStyle"===b.className?$e.a.iy(b,this.fIc("WordVisiCarriageReturn_MSFontService",this.xqo)):"VisiFontCarriageReturnRtlStyle"===b.className&&$e.a.iy(b,this.fIc("WordVisiCarriageReturnRtl_MSFontService",this.zqo)),!0):!1}YXc(b){return""!==$e.a.Lz(b)?($e.a.iy(b,""),!0):!1}fIc(b,h){return"@font-face { font-family: "+
b+"; src: url('"+h+"'); unicode-range: U+0020, U+00A0, U+200B, U+2003; font-display: swap; }"}}Object(n.a)(Cv,"VisiMarkersOperation",null,[571]);var Zs=d(486),kr=d(396);class $s extends Zs.a{constructor(b,h){super(b,h);this.$se=-1;this.ppb=0;this.Upe=null;this.DIg=!1;this.dre=[];this.Xdd=!1;this.HRg=!0;this.MAe=this.Jbd=null;this.preventDismissOnScroll=this.t0d=this.jbc=!1;this.L5=null;this.sod=!1;this.SKc=!0;this.ru=!1;this.NKg=t.AFrameworkApplication.K.$("FloatieLightDismissIsEnabled");$s.HXg||
(t.AFrameworkApplication.ya.pa(ab.a.showFloatie,Yd.a.frame,$c.ActionManager.Nf),$s.HXg=!0)}get RIh(){return this.rN}set RIh(b){this.rN=b}get Pbj(){return this.sod}get XLc(){return this.DIg}set XLc(b){this.DIg=b;this.ppb=0}get Yz(){return!0}get cssClass(){return t.AFrameworkApplication.ua&&t.AFrameworkApplication.ua.Sb.C6?"cui-floatie MLRVisualRefresh":"cui-floatie"}get isVisible(){return this.ru}tPa(){for(let b of this.children)if(b.tPa())return!0;return!1}get l7(){return 9}Sf(b){this.dre[this.dre.length]=
b;super.Sf(b)}km(){super.km();qf.c(this.Kc)&&this.DB();this.Kc=jg.a.NOa(this.Kc);this.ZV(this.Kc);this.dirty=!1}J$b(b){3===b.gg||this.t0d||this.qw(b);return!1}M$b(){return!1}K$b(b){3!==b.gg&&this.SKc&&!this.jbc&&this.yko(b);return!1}L$b(){return!1}H$b(b){3===b.gg&&this.qw(b);return!1}I$b(b){void 0!==this.L5&&null!==this.L5||this.preventDismissOnScroll||this.qw(b);return!1}XB(){this.a7e();return!1}LXd(){this.XLc=!0}yko(b){if(b=ac.a.j0b(b.clientPoint,this.Upe)){if(this.XLc){if(!this.ppb||b<this.ppb)this.ppb=
b;b-=this.ppb}b-=this.$se;0>b&&(b=0);const h=255-4*b;0>=h&&63.75<=b?this.qw():X.a.setOpacity(this.Kc,Math.max(h/255,0))}else this.XLc=!1,this.ppb=0,X.a.setOpacity(this.Kc,1)}Uio(b){let h=null;void 0!==this.Jbd&&null!==this.Jbd&&(h=this.Jbd(b));b=null;for(const r of this.dre){let z=!this.Pbj&&r.rii;if(!z&&void 0!==h&&null!==h)for(let R=0;R<h.length;R++)if(r.id===h[R]){z=!0;break}r.Kc.style.display=z?"none":"";r.h0b=!z;z||(b=r)}b&&(b.h0b=!1)}YQh(){const b=this.Kc.style.top,h=this.Kc.style.left;this.Kc.style.top=
"0px";this.Kc.style.left="0px";const r=this.gAb();this.Kc.style.top=b;this.Kc.style.left=h;return r}gAb(){const b=this.Kc.style.visibility,h=this.Kc.style.display;this.Kc.style.visibility="hidden";this.Kc.style.display="";const r=Ed.a.getElementBounds(this.Kc);this.Kc.style.display=h;this.Kc.style.visibility=b;return r}vLi(b){3===b||this.nbe?(Sys.UI.DomElement.addCssClass(this.Kc,kr.a.R3a),this.sod=!0):(Sys.UI.DomElement.removeCssClass(this.Kc,kr.a.R3a),this.sod=!1);this.Uio(b)}$2a(b,h,r,z=!1){this.isVisible||
(this.L5||!this.HRg&&this.preventDismissOnScroll||(this.HRg=!1,Ed.a.EUd("ShowLegacyFloatie",""),t.AFrameworkApplication.ya.processAction(ab.a.showFloatie,2)),this.vLi(r),this.SKc=!0,this.ppb=0,this.XLc=!1,!this.NKg||void 0!==this.L5&&null!==this.L5?(this.Xdd=!1,this.pda(this,!1)):(this.Xdd=!0,this.Nhk(this)),h=z?b:this.q6m(b,h),this.Kc.style.top=h.y.toString()+"px",this.Kc.style.left=h.x.toString()+"px",this.Ht(),this.Upe=this.gAb(),this.$se=ac.a.j0b(b,this.Upe),X.a.setOpacity(this.Kc,1),this.Kc.style.zIndex=
String(t.AFrameworkApplication.ua.jra),this.Kc.style.display="",this.ru=!0)}q6m(b,h){const r=this.Pbj?30:17,z=this.YQh(),R=$e.a.hBb(),ba=$e.a.l2();b=new Sys.UI.Point(b.x,b.y);1===h?b.y-=z.height:3===h?(b.y-=z.height,b.x-=z.width):2===h&&(b.x-=z.width);b.x+z.width>R&&(b.x=Math.floor(R-z.width));0>b.x&&(b.x=0);b.y=3===h||1===h?b.y-r:b.y+r;0>b.y&&(b.y=0);b.y+z.height>ba&&(b.y=ba-z.height);return b}r6m(b,h){const r=b.Oqi;if(r){this.vLi(h);var z=this.YQh();this.L5=b;b=r.u$f-r.DGc>z.width;var R=r.DGc+r.h$e>
z.width,ba=r.I1b>z.height+17,ta=r.Ukj-(r.I1b+r.e$e)>z.height+17;z=new Sys.UI.Point(r.DGc,r.I1b);R||b||(R=!0,z.x=r.u$f);b=r.Xgb?r.Zvf?ta?R?2:0:R?3:1:ba?R?3:1:R?2:0:r.Zvf?ta?b?0:2:b?1:3:ba?b?1:3:b?0:2;if(3===b||2===b)z.x=r.DGc+r.h$e;if(2===b||0===b)z.y=r.I1b+r.e$e;this.$2a(z,b,h);this.SKc=!1;h=this.L5.ANe.Kc;void 0!==h&&null!==h&&(h.style.zIndex=String(t.AFrameworkApplication.ua.jra))}}T1(){let b=super.T1();this.qw()&&(b=!0);return b}qw(b=null){if(!this.isVisible)return!1;void 0!==this.Vxc&&null!==
this.Vxc&&this.Vxc.fsa(null);void 0!==this.L5&&null!==this.L5&&this.L5.zda();this.zda();this.NKg&&this.Xdd?this.L1k(this):this.Y9(this,!1);this.Xdd=!1;this.$se=-1;this.L5=null;this.Kc.style.display="none";this.ru=!1;this.MAe&&this.MAe(b);return!0}a7e(){void 0!==this.L5&&null!==this.L5&&(this.L5.fVa=null,this.L5.zda(),this.L5=null,this.VUd.style.zIndex=String(t.AFrameworkApplication.ua.Mya),this.Kc.style.zIndex=String(t.AFrameworkApplication.ua.jra))}Cln(b){this.Jbd=b}pmn(b){this.MAe=b}set Yz(b){super.Yz=
b}}$s.HXg=!1;Object(n.a)($s,"Floatie",Zs.a,[706,389,390]);class Dj{constructor(b,h){this.Su=this.UGa=null;this.joi=b;this.OTi=h}get TIh(){return this.UGa}xQn(b){this.UGa=b}gAb(){return this.Su.gAb()}KZ(){return this.Su?this.Su.isVisible:!1}zfh(b){this.xQn(b)}showFloatie(b,h){this.$2a(h.location,h.Ww,h.isRtl)}$2a(b,h,r){r=r?this.OTi:this.joi;this.YAd();this.Su&&this.Su.$2a(b,r,h)}qw(){this.Su&&this.Su.qw()}YAd(){this.UGa&&!this.Su&&(this.Su=Object(la.a)($s,this.UGa()))}MBd(){}}Object(n.a)(Dj,"AFloatieManager",
null,[597]);class Kj extends Dj{constructor(){super(1,3);this.eaj=!1;this.Xyh=""}$2a(b,h,r){r=r?this.OTi:this.joi;this.YAd();this.Su&&(this.Su.isVisible&&this.Su.qw(),this.eaj||this.Su.yl(),this.Su.$2a(b,r,h,!0))}YAd(){this.TIh&&!this.Su&&(this.Su=this.UGa())}MBd(){if(this.Su&&this.Su.isVisible){const b=Object(la.a)(Gm.Control,this.Su.controls["PasteFloatie.FlyoutAnchor"]);b.behavior.rw(b.Cdb(),1,null)}}cZf(b){this.Xyh=b}Osn(b){b=b.fdf("Menu16",null);yh.a("renderIcon")&&b&&appChrome.api.renderIcon(Kj.oBj,
b.firstElementChild)}thc(b,h,r){if(this.Su){const z=this.Su.controls[this.Xyh];z&&(Kj.lKg||(this.Osn(z),Kj.lKg=!0),z.Nd[Wi.a.labelText]=b,z.Nd[Wi.a.alt]=h,r&&z.behavior.yl())}}}Kj.lKg=!1;Kj.oBj="Designer_20";Object(n.a)(Kj,"PasteFloatieManager",Dj,[]);var Mm=d(1004);class tp{constructor(){this.Jd=null}get mw(){return null}getTitle(){return null}APh(){return null}reset(b){this.Jd=b.node}ZEa(b){b=Md.d(this.Jd,b);let h=null;if(!b||b.si!==this.si)return{returnValue:!1,XE:h};h=Object.assign(new Mm.a,{QF:this.key,
contentObject:b,title:this.getTitle(b),description:this.APh(b)});return{returnValue:!0,XE:h}}}Object(n.a)(tp,"BlobDetailsProvider",null,[268,269]);class ss extends tp{constructor(){super()}get key(){return"EQUATION"}get si(){return 11}get mw(){return Box4Intl.Box4Strings.l_EquationContentTitle}}Object(n.a)(ss,"EquationDetailsProvider",tp,[]);class Dk{constructor(){this.kIg=null}get key(){return"LINK"}get mw(){return Box4Intl.Box4Strings.l_HyperlinkContentTitle}reset(b){this.kIg=Pg.HyperlinkReader.tIc(b.node)}ZEa(b){let h=
null;for(const r of this.kIg)if(r.cpBegin<=b&&b<r.cpEnd)return h=Object.assign(new Mm.a,{QF:this.key,contentObject:r.hyperlink}),{returnValue:!0,XE:h};return{returnValue:!1,XE:h}}}Object(n.a)(Dk,"HyperlinkDetailsProvider",null,[268,269]);var Rs=d(1361),fw=d(886);class Dx{constructor(){this.XMg=!1}get key(){return"IFRAMENODE"}get mw(){return this.XMg?Box4Intl.Box4Strings.l_IFrameVideoTitle:Box4Intl.Box4Strings.l_IFrameWebContentTitle}Ygc(b){let h=null;b=b?ie.ParagraphReader.Kdb(b.currentNode):null;
if(!b)return{returnValue:!1,ika:h};h=Object.assign(new Rs.a,{QF:this.key,contentId:b.id,contentObject:b});return{returnValue:!0,ika:h}}Zzb(b,h){b=b?Object(la.a)(fw.a,b.contentObject):null;h=h?Object(la.a)(fw.a,h.contentObject):null;let r="";h&&b.id===h.id||(this.XMg=b.O_a,r=String.format(Box4Intl.Box4Strings.l_AccessibleContentDetailsFormat,b.mw,this.mw));return r}}Object(n.a)(Dx,"IFrameDetailsProvider",null,[596,269]);class Ss extends tp{constructor(){super()}get key(){return"IMAGE"}get si(){return 5}get mw(){return Box4Intl.Box4Strings.l_ImageContentTitle}getTitle(b){return $d.ImageReader.lT(b.properties)}APh(b){return $d.ImageReader.ZAa(b.properties)}}
Object(n.a)(Ss,"ImageDetailsProvider",tp,[]);class Nu{get key(){return"IMAGENODE"}get mw(){return Box4Intl.Box4Strings.l_ImageContentTitle}Ygc(b){let h=null;if(!b||!$d.ImageReader.ww(b.currentNode))return{returnValue:!1,ika:h};h=Object.assign(new Rs.a,{QF:this.key,contentId:b.currentNode.id,contentObject:b.currentNode});return{returnValue:!0,ika:h}}Zzb(b,h){b=b.contentObject;const r=Box4Intl.Box4Strings.l_AccessibleContentDetailsFormat;let z="";h&&b.id===h.contentObject.id||(z=String.format(r,$d.ImageReader.lT(b.properties),
Box4Intl.Box4Strings.l_ImageContentTitle));return z}}Object(n.a)(Nu,"ImageNodeDetailsProvider",null,[596,269]);let Bg,Qi;class Kg{constructor(b,h){this.oDg=null;this.Xm=h;this.FDe=b;this.key=Kg.keys.J(b);this.mw=Kg.FEk.J(b)}reset(b){this.oDg=this.Xm.f2(b.node)}ZEa(b){var h=Kg.fal(this.oDg||[],r=>this.Mam(b,r));h=this.LIk(h);return{returnValue:!!h,XE:h}}Mam(b,h){return h.begin<=b&&b<h.end&&(!h.errorDetails||this.FDe===h.errorDetails.proofingType)}LIk(b){return b?Object.assign(new Mm.a,{QF:this.key,
contentObject:b.errorDetails,description:this.zdb()}):null}zdb(){return t.AFrameworkApplication.K&&t.AFrameworkApplication.K.$("WordEditorIdeasCardsIsEnabled")?Box4Intl.Box4Strings.l_ShowIntentSuggestionTooltipClickOrPress:null}static fal(b,h){for(const r of b)if(h(r))return r;return null}}Kg.keys=(Qi=new Hl.a,Qi.add(1,"SPELLINGERROR"),Qi.add(2,"GRAMMATICALERROR"),Qi.add(3,"ADVANCEDERROR"),Qi);Kg.FEk=(Bg=new Hl.a,Bg.add(1,Box4Intl.Box4Strings.l_SpellingErrorContentTitle),Bg.add(2,Box4Intl.Box4Strings.l_GrammaticalErrorContentTitle),
Bg.add(3,Box4Intl.Box4Strings.l_AdvancedProofingIssueContentTitle),Bg);Object(n.a)(Kg,"ProofingDetailsProvider",null,[268,269]);class Oo{constructor(){this.tableNode=null;this.tvd=this.a5d=this.columns=this.rows=0}}Object(n.a)(Oo,"TableInfo",null,[]);class qr{get key(){return"TABLE"}get mw(){return Box4Intl.Box4Strings.l_TableContentTitle}Ygc(b){var h=null;if(!Gi.TableCellReader.isTableCell(b))return{returnValue:!1,ika:h};h=new Nd.GraphIterator;h.fd(b);b=new Oo;b.a5d=Jm.a.At(h)+1;b.tvd=dq.a(h)+1;
Ke.returnToContainingTable(h);b.tableNode=h.currentNode;b.columns=Ii.TableReader.kh(b.tableNode);b.rows=Ii.TableReader.ag(b.tableNode);h=Object.assign(new Rs.a,{QF:this.key,contentId:b.tableNode.id,contentObject:b});return{returnValue:!0,ika:h}}Zzb(b,h){b=b.contentObject;const r=new Nk.a;h||r.add(String.format(Box4Intl.Box4Strings.l_TableContentDetailsFormat,b.columns,b.rows));h&&h.contentObject.tvd===b.tvd||r.add(String.format(Box4Intl.Box4Strings.l_TableContentDetailsColumnFormat,b.tvd));h&&h.contentObject.a5d===
b.a5d||r.add(String.format(Box4Intl.Box4Strings.l_TableContentDetailsRowFormat,b.a5d));return r.toArray().join(" ")}}Object(n.a)(qr,"TableDetailsProvider",null,[596,269]);class po{constructor(b,h){this.ZGa=b;this.Xm=h}dRf(){this.ZGa.execute(b=>{b.i3(new Dk);b.i3(new Kg(1,this.Xm));b.i3(new Kg(2,this.Xm));b.i3(new Kg(3,this.Xm));b.i3(new ss);b.i3(new Ss);b.acc(new qr);b.acc(new Nu);b.acc(new Dx)})}}Object(n.a)(po,"AccessibilityActor",null,[]);class St{constructor(b,h,r){this.zZm=(z,R,ba)=>{if(1===
ba)return 32;this.Pwj().E0f();return 32};this.KUa=b;this.Pwj=r}Vb(){this.KUa.gb(Fb.a.pBi,kc.a.view,this.zZm,1028)}}Object(n.a)(St,"AutoCorrectActor",null,[]);var Ts=d(1845);class Tt{constructor(){this.BUd=!0}Gua(){}a1a(){}cYb(){}NHf(){}N6d(){}get Sac(){return!1}get Rhb(){return 0}get oqi(){return!1}get R1(){return pa.a.nil}}Object(n.a)(Tt,"TextOnlyBox4ImageSteward",null,[595]);class Zi{constructor(b,h,r,z,R,ba,ta=!1,Wa=!1,ub=!1,Ib=!1){this.ij=b;this.Hb=h;this.wm=r;this.cpc=z;this.JY=R;this.T8a=ta;
this.qCe=Wa;this.Ase=ub;this.lye=Ib;this.Ac=ba}create(b,h,r,z){return 1===b?new Tt:new Ts.a(h,this.ij,this.Hb,this.wm,this.Ac,this.cpc,this.JY,this.T8a,this.qCe,this.Ase,this.lye,r,z)}}Object(n.a)(Zi,"Box4ImageStewardFactory",null,[567]);var wj=d(42);class qu{constructor(b){this.JPd=b}whm(b){if(!b||!b.zA||1>b.zA.count)return!1;const h=[wj.a.cwh,wj.a.bwh];return!!this.BEd(b.zA,1,r=>this.owd(r,h))}fci(b){return!b||!b.zA||1>b.zA.count?!1:!!this.BEd(b.zA,1,h=>this.owd(h,[wj.a.kI]))}Fem(b){return!b||!b.zA||
1>b.zA.count?!1:!!this.BEd(b.zA,2,h=>this.owd(h,[wj.a.RRd]))}zh(b){return!b||!b.zA||1>b.zA.count?!1:!!this.BEd(b.zA,1,h=>this.owd(h,[wj.a.e3]))}HOd(b){if(!b||!b.zA)return!1;b=b.zA;for(let h=0;h<b.count;++h)if(!b.J(h)||0<b.J(h).egk)return!1;return!0}m4k(b,h){return this.fci(h)||this.Fem(h)?"":b}BEd(b,h,r){if(b&&0<b.count)for(let z=b.count-1;0<=z;--z){if(r(b.J(z)))return b.J(z);if(b.count-z>=h)break}return null}owd(b,h){b=b&&b.e6h?b.e6h.split(" "):null;if(!b)return!1;for(const r of h)if(0<=Array.indexOf(b,
r))return!0;return!1}}Object(n.a)(qu,"Box4PasteStewardUtils",null,[565]);var Bq=d(720);class Cq{constructor(){this.uli={};this.pyd=-1}}Object(n.a)(Cq,"LevelLists",null,[]);class Lw{constructor(b,h,r){this.P7=this.level=0;this.sGh=null;this.Jac=!1;this.level=b;this.fic=h;this.UBi=r}}Object(n.a)(Lw,"ListItemMetadata",null,[]);class Dq{constructor(){this.P7=0;this.tagName="UL";this.qGc=null;this.ignore=!1;this.VSc=0}}Object(n.a)(Dq,"ListMetadata",null,[]);class Rh{constructor(b){this.nodes=b;this.O1=
0;this.lists={};this.Fma=[];this.z8b=null;this.Wza=[];this.Wza[0]=new Cq}}Object(n.a)(Rh,"WordConverterArguments",null,[]);var Eo=d(1513);class wm{constructor(b=null){this.Agd=1;this.OV=b||Eo.a.ojf("")}get Jc(){return this.OV}process(b,h){b&&b.querySelectorAll&&(b=b.querySelectorAll("p"))&&0<b.length&&(b=new Bq.a(h,Object(u.a)(this,this.xNf,"processNodesDiscovery"),new Rh(b)),b.ml("Word Converter Operation"),b.eh=!h||h.eh,b.run())}xNf(b,h){const r=h.nodes[h.O1];var z=wm.hff(r);if(z){let R=h.Wza[z.level-
1];R||(R=new Cq,h.Wza[z.level-1]=R);h.z8b&&wm.uJc(r)!==h.z8b&&wm.lwn(h);let ba=R.uli[z.fic];if(!ba)ba=new Dq,ba.P7=this.Agd++,ba.qGc=wm.Mdf(r,5),ba.ignore=!ba.qGc||!ba.qGc.length,ba.tagName=wm.CFd(ba.qGc),R.uli[z.fic]=ba,h.lists[ba.P7.toString()]=ba;else if(!ba.ignore&&1===ba.VSc){const ta=wm.Mdf(r,5);ba.tagName=ba.qGc===ta?"UL":"OL"}z.P7=ba.P7;ba.ignore||"OL"===ba.tagName&&0<ba.VSc&&R.pyd!==z.P7?(ba.ignore=!0,h.Wza[0].pyd=-1,h.Wza=h.Wza.slice(0,1)):(h.Wza.length>z.level&&(h.Wza=h.Wza.slice(0,z.level)),
R.pyd=z.P7,h.Fma[h.Fma.length]=z,ba.VSc++);h.z8b=r}else if((z=h.z8b)&&wm.uJc(r)===z&&r.tagName===z.tagName&&r.className===z.className){z.appendChild(z.ownerDocument.createElement("BR"));for(z.appendChild(z.ownerDocument.createElement("BR"));r.firstChild;)z.appendChild(r.firstChild);r.parentNode.removeChild(r)}h.O1++;if(h.nodes.length<=h.O1){if(!h.Fma.length)return!1;h.O1=0;b.ti(Object(u.a)(this,this.wNf,"processNodeConvert"))}return!0}wNf(b,h){var r=h.Fma[h.O1];b=r.UBi;const z=h.lists[r.P7.toString()];
if(!z.ignore&&(r=wm.GBl(b,r,z))){wm.SAc(b,5);const R=b.ownerDocument.createElement("LI");for(;b.firstChild;)R.appendChild(b.firstChild);r.appendChild(R);b.parentNode.removeChild(b);"UL"===z.tagName?this.Jc.b++:this.Jc.c++}h.O1++;return h.O1<h.Fma.length}static GBl(b,h,r){let z=wm.hLi(b,h.level,r);const R=Ri.a.Eb(z,"UniqueListId");if(R&&R!==h.P7||!R&&z.firstChild)b=b.ownerDocument.createElement(r.tagName),z.parentNode.insertBefore(b,z.nextSibling),z=b;Ri.a.Il(z,"UniqueListId",h.P7);return wm.QZe(z,
r)}static QZe(b,h){if(h.tagName!==b.tagName){h=b.ownerDocument.createElement(h.tagName);for(Ri.a.Il(h,"UniqueListId",Ri.a.Eb(b,"UniqueListId"));b.firstChild;)h.appendChild(b.firstChild);b.parentNode.insertBefore(h,b);b.parentNode.removeChild(b);b=h}return b}static hLi(b,h,r){let z=null,R;1===h?R=wm.uJc(b):(z=wm.hLi(b,h-1,null),R=z.lastChild);if(R&&1===R.nodeType){const ba=R.tagName.toUpperCase();if("UL"===ba||"OL"===ba)return R}r=b.ownerDocument.createElement(r?r.tagName:"UL");1===h?b.parentNode.insertBefore(r,
b):z.appendChild(r);return r}static SAc(b,h){for(let r=0;r<b.childNodes.length;r++){const z=b.childNodes[r];1===z.nodeType&&1<h&&wm.SAc(z,h-1);if(wm.uqf(z)||wm.bOc(z))b.removeChild(z),r--}}static hff(b){if(1===b.nodeType){const h=wm.N3b(b,"mso-list");if(h&&0<h.length)try{const r=h.split(" ");if(3===r.length){const z=Number.parseInvariant(r[1].substr(5));return new Lw(z,h,b)}}catch(r){}}return null}static CFd(b){return"o"!==b&&"\u00b7"!==b&&"\u00a7"!==b&&"-"!==b?"OL":"UL"}static Mdf(b,h){let r=null;
for(let z=0;!r&&z<b.childNodes.length;z++){const R=b.childNodes[z];wm.bOc(R)?(r="string"===typeof R.innerText?R.innerText.trim():R.textContent.trim(),r.length||(r="o")):1===R.nodeType&&1<h&&(r=wm.Mdf(R,h-1))}return r}static bOc(b){return 1===b.nodeType&&(b=wm.N3b(b,"mso-list"))&&0<b.length&&"ignore"===b.trim().toLowerCase()?!0:!1}static uqf(b){return 1===b.nodeType&&!b.firstChild&&"SPAN"===b.tagName.toUpperCase()}static N3b(b,h){if((b=b.getAttribute("style"))&&0<b.length&&-1!==b.indexOf(h)){b=b.split(";");
for(let r=0;r<b.length;r++){const z=b[r].split(":");if(2===z.length&&z[0].trim()===h)return z[1].trim()}}return null}static uJc(b){do b=b.previousSibling;while(b&&wm.HNc(b));return b}static HNc(b){return b?3===b.nodeType?(b=b.nodeValue,b=b.replace(wm.Pxe,""),!b.trim().length):1!==b.nodeType||b.firstChild!==b.lastChild||"SPAN"!==b.tagName&&"FONT"!==b.tagName?!1:wm.HNc(b.firstChild):!0}static lwn(b){for(let h=0;h<b.Wza.length;h++){const r=b.Wza[h];r&&(r.pyd=-1)}}}wm.Pxe=RegExp("[\n|\r]","gi");Object(n.a)(wm,
"WordConverter",null,[209]);class Rj{constructor(){this.P7=0;this.S8b=Array(9)}}Object(n.a)(Rj,"FullListMetadata",null,[]);var rr=d(1011);class qo{constructor(){this.level=0;this.tagName="UL";this.Ahb=null;this.ignore=!1;this.VSc=0;this.listStyle="BulletListStyle1";this.Fma=new rr.a;this.font=this.levelText=""}}Object(n.a)(qo,"ListLevelMetadata",null,[]);var bk=d(1393),oq=d(588);class $l{constructor(b=null){this.OV=b||Eo.a.ojf("");this.Agd=Number.parseInvariant((new Date).format("HHmmss"))}get Jc(){return this.OV}process(b,
h){if(b&&b.querySelectorAll){const ba=b.querySelectorAll("p");if(ba&&0<ba.length){for(var r=0,z=!1,R=ba[0].parentNode;5>r&&R&&R!==b;){r++;const ta=R.id.toLowerCase();if(ta&&ta.length&&-1!==ta.indexOf("_editingelement")&&Sys.UI.DomElement.containsCssClass(R,"WACEditing")&&Sys.UI.DomElement.containsCssClass(R,"EditingSurfaceBody")){z=!0;break}R=R.parentNode}if(z&&R!==b){r=b.firstChild;for(z=!1;0<R.children.length&&R.children[0]!==r;)b.insertBefore(R.children[0],r),z=!0;if(z)for(;r;)R=r.nextSibling,
b.removeChild(r),r=R}b=new Bq.a(h,Object(u.a)(this,this.xNf,"processNodesDiscovery"),new Rh(ba));b.ml("Word Converter Operation");b.eh=!h||h.eh;b.run()}}}xNf(b,h){const r=h.nodes[h.O1];var z=$l.hff(r);if(z){let ba=z.fic.replace(RegExp("level[0-9]"),"").trim();ba=ba&&ba.length?ba:z.fic;let ta=h.lists[ba];ta||(ta=new Rj,ta.P7=this.Agd++);let Wa=ta.S8b[z.level-1];Wa||(Wa=new qo,Wa.level=z.level);var R=r.parentNode;if(R&&"li"===R.tagName.toLowerCase()){if(R=R.parentNode)!(R=R.tagName.toUpperCase())||
"OL"!==R&&"UL"!==R||(Wa.tagName=R)}else Wa.Ahb=$l.tQh(r,5),Wa.Ahb&&Wa.Ahb.length||(Wa.Ahb=$l.cif(r,5)),Wa.ignore=!Wa.Ahb||!Wa.Ahb.length,Wa.tagName=$l.CFd(Wa.Ahb),"UL"===Wa.tagName&&(Wa.font=this.fRh(r,5));z.P7=ta.P7;Wa.VSc++;Wa.ignore||"li"===r.parentNode.tagName.toLowerCase()||(R=(R=$l.cif(r,5))?R:Wa.Ahb)&&R.length&&(z.sGh=R,(R=$l.ULn(r,R,Wa.listStyle,z.level-1))&&R.length&&(Wa.listStyle=R));h.Fma[h.Fma.length]=z;Wa.Fma.contains(z)||Wa.Fma.add(z);if(void 0===ta.S8b[z.level-1]||null===ta.S8b[z.level-
1]||ta.S8b[z.level-1]!==Wa)ta.S8b[z.level-1]=Wa;h.lists[ba]&&h.lists[ba]===ta||(h.lists[ba]=ta);h.z8b=r}else if((z=h.z8b)&&$l.uJc(r)===z&&r.tagName===z.tagName&&r.className===z.className){z.appendChild(z.ownerDocument.createElement("BR"));for(z.appendChild(z.ownerDocument.createElement("BR"));r.firstChild;)z.appendChild(r.firstChild);r.parentNode.removeChild(r)}h.O1++;if(h.nodes.length<=h.O1){if(!h.Fma.length)return!1;h.O1=0;b.ti(Object(u.a)(this,this.wNf,"processNodeConvert"))}return!0}wNf(b,h){b=
h.Fma[h.O1];var r=b.UBi,z=b.fic.replace(RegExp("level[0-9]"),"").trim();z=z&&z.length?z:b.fic;z=h.lists[z];var R=z.S8b[b.level-1],ba=r.parentNode.tagName.toLowerCase();if(!R.ignore&&r.parentNode&&"li"!==ba){if(ba=$l.TKk(r,R)){$l.SAc(r,5);const ta=r.ownerDocument.createElement("LI");ta.setAttribute("data-aria-level",String.format("{0}",b.level));ta.setAttribute(oq.a.VQc,String.format("{0}",z.P7));"UL"===R.tagName&&(ta.setAttribute(oq.a.$Rd,String.format("{0}",b.sGh)),ta.setAttribute(oq.a.Gwf,String.format("{0}",
R.font)));for(;r.firstChild;)ta.appendChild(r.firstChild);ba.appendChild(ta);r.parentNode.removeChild(r);"UL"===R.tagName?this.Jc.b++:this.Jc.c++}}else"li"===ba&&(R=R.tagName,r=r.parentNode,b.Jac&&(b=r.parentNode)&&b.tagName.toUpperCase()===R&&b.setAttribute("data-pasteFromRc","true"),r.setAttribute(oq.a.VQc,String.format("{0}",z.P7)),"UL"===R?this.Jc.b++:this.Jc.c++);h.O1++;return h.O1<h.Fma.length}fRh(b,h){let r=null;for(let z=0;!r&&z<b.childNodes.length;z++){const R=b.childNodes[z];r=$l.Psl(R);
!r&&1===R.nodeType&&1<h&&(r=this.fRh(R,h-1))}return r}static TKk(b,h){b=$l.RKk(b,h.tagName);return $l.QZe(b,h)}static QZe(b,h){if(h.tagName!==b.tagName){for(h=b.ownerDocument.createElement(h.tagName);b.firstChild;)h.appendChild(b.firstChild);b.parentNode.insertBefore(h,b);b.parentNode.removeChild(b);b=h}return b}static RKk(b,h){h=b.ownerDocument.createElement(h?h:"UL");var r=b.getAttribute("start");r&&0<r.length&&(h.setAttribute("start",r),b.removeAttribute("start"));(r=b.className)&&0<r.length&&
(r="OL"===h.tagName?bk.a.OId(r,"NumberListStyle"):bk.a.OId(r,"BulletListStyle"),0<r.length&&(Sys.UI.DomElement.addCssClass(h,r),Sys.UI.DomElement.removeCssClass(b,r)));b.parentNode.insertBefore(h,b);return h}static SAc(b,h){for(let r=0;r<b.childNodes.length;r++){const z=b.childNodes[r];1===z.nodeType&&1<h&&$l.SAc(z,h-1);if($l.uqf(z)||$l.bOc(z))b.removeChild(z),r--}}static hff(b){if(1===b.nodeType){var h=$l.N3b(b,"mso-list");if(h&&0<h.length)try{var r=h.split(" ");if(3===r.length){const z=Number.parseInvariant(r[1].substr(5)),
R=new Lw(z,h,b);R.Jac=!0;return R}}catch(z){}else if((r=b.parentNode)&&"li"===r.tagName.toLocaleLowerCase()&&(h=r.getAttribute("data-"+vf.a.psd),r=r.getAttribute(oq.a.VQc),h&&r&&0<h.length&&0<r.length))return b=new Lw(Number.parseInvariant(h),r+" level"+h,b),b.Jac=!1,b}return null}static ULn(b,h,r,z){if("p"===b.tagName.toLowerCase()&&h&&h.length){if("UL"===$l.CFd(h))return r=$l.$jl(h),Sys.UI.DomElement.addCssClass(b,r),r;var R=h.match(RegExp("^[0-9]+"));return R&&R.length?(r="NumberListStyle1",Sys.UI.DomElement.addCssClass(b,
r),b.setAttribute("start",R[0]),r):(R=h.match(RegExp("^[a-zA-Z]+")))&&R.length&&(R=R[0],z=(h=R.match(RegExp("^[ivxlcdmIVXLCDM]+")))&&h.length?$l.bHl(r,z):1,1!==z&&((r=$l.Lwd(b,R,RegExp("^[ivxlcdm]+"),B.a.Crh,"NumberListStyle3"))||(r=$l.Lwd(b,R,RegExp("^[IVXLCDM]+"),B.a.Crh,"NumberListStyle5")))||z&&((r=$l.Lwd(b,R,RegExp("^[a-z]+"),B.a.Brh,"NumberListStyle2"))||(r=$l.Lwd(b,R,RegExp("^[A-Z]+"),B.a.Brh,"NumberListStyle4"))))?r:"NumberListStyle1"}return null}static $jl(b){switch(b){case "o":return"BulletListStyle2";
case "\u00a7":return"BulletListStyle3";default:return"BulletListStyle1"}}static bHl(b,h){b&&b.length||(b="");switch(b){case "NumberListStyle2":case "NumberListStyle4":b=1;break;case "NumberListStyle3":case "NumberListStyle5":b=0;break;default:b=-1}if(0>b)switch(h%3){case 0:b=0;break;case 1:b=1;break;case 2:b=0;break;default:b=0}return b}static Lwd(b,h,r,z,R){return(h=h.match(r))&&h.length?(z=z(h[0]),z=1>z?1:z,Sys.UI.DomElement.addCssClass(b,R),b.setAttribute("start",z+""),R):null}static CFd(b){return $l.o$l(b)?
"UL":"OL"}static o$l(b){return!b||"\u00a7"===b||"\u00b7"===b||"o"===b||"-"===b||"\u00d8"===b||"v"===b||"\u00fc"===b||"\u2666"===b||"\u00a8"===b}static cif(b,h){let r=null;var z;let R,ba;for(let ta=-1;!r&&ta<b.childNodes.length;ta++){const Wa=-1===ta?b:b.childNodes[ta];if(Wa)if((z=Wa.innerHTML)&&0<z.length){if(R=z.indexOf("\x3c!--[if !supportLists]--\x3e"),0<=R&&(ba=z.indexOf("\x3c!--[endif]--\x3e"),0<=ba)){z=z.substring(R,ba+14);Wa.innerHTML=Wa.innerHTML.replace(z,"");if(z.length){b=b.ownerDocument.createElement("span");
b.innerHTML=z;r=b.innerText.trim();break}r&&r.length||(r="o")}}else 0<=ta&&1===Wa.nodeType&&1<h&&(r=$l.cif(Wa,h-1))}return r}static Psl(b){let h=null;1===b.nodeType&&((h=$l.eRh(b,"font-family"))||(h=$l.eRh(b,"mso-ascii-font-family")));return h}static eRh(b,h){return(b=$l.N3b(b,h))&&0<b.length?b.trim():null}static tQh(b,h){let r=null;for(let z=0;!r&&z<b.childNodes.length;z++){const R=b.childNodes[z];$l.bOc(R)?(r="string"===typeof R.innerText?R.innerText.trim():R.textContent.trim(),r.length||(r="o"),
R.parentNode.removeChild(R)):1===R.nodeType&&1<h&&(r=$l.tQh(R,h-1))}return r}static bOc(b){return 1===b.nodeType&&(b=$l.N3b(b,"mso-list"))&&0<b.length&&"ignore"===b.trim().toLowerCase()?!0:!1}static uqf(b){return 1===b.nodeType&&!b.firstChild&&"SPAN"===b.tagName.toUpperCase()}static N3b(b,h){if((b=b.getAttribute("style"))&&0<b.length&&-1!==b.indexOf(h)){b=b.split(";");for(let r=0;r<b.length;r++){const z=b[r].split(":");if(2===z.length&&z[0].trim()===h)return z[1].trim()}}return null}static uJc(b){do b=
b.previousSibling;while(b&&$l.HNc(b));return b}static HNc(b){return b?3===b.nodeType?(b=b.nodeValue,b=b.replace($l.Pxe,""),!b.trim().length):1!==b.nodeType||b.firstChild!==b.lastChild||"SPAN"!==b.tagName&&"FONT"!==b.tagName?!1:$l.HNc(b.firstChild):!0}}$l.Pxe=RegExp("[\n|\r]","gi");Object(n.a)($l,"WacAndRichClientWordConverter",null,[209]);class vo{constructor(b){this.sZ=b.$("ExternalPasteImprovementsEnabled")&&b.$("ListMarkerIsEnabled")}create(b=null){return this.sZ?new $l(b):new wm(b)}}Object(n.a)(vo,
"Box4WordConverterFactory",null,[566]);var Yt=d(1701);class Kx{constructor(b,h,r,z,R){this.iDg=0;this.Yqo=ba=>{let ta=!0;const Wa=this.Rca.e3k;null!=Wa?(ba.Vfa=Wa,ta=!1):Date.now()-this.iDg>this.hke&&(v.ULS.sendTraceTag(18354843,307,50,null),this.ld.Zb(Sc.a.Ska,{["Reason"]:Xc.a.KBi}),ta=ba.Vfa=!1);return ta};this.ld=b;this.te=h;this.hke=R;this.Rca=r;this.IIa=z}Wuk(b,h,r){v.ULS.sendTraceTag(9037318,307,50,"ClipboardOperation ran into Setup: {0}; {1}; {2}",h,r,this.te.dF);b.eh&&this.te.rp&&window.chrome&&
v.ULS.sendTraceTag(18354842,307,15,"ClipboardOperation isn't called async when using system clipboard and Chrome extension: {0}",h);this.Rca.rFc(!!(h&16));this.IIa.create(b,this.Yqo,null).ml("ClipboardPreProcess");this.iDg=Date.now()}$wn(){this.Rca.reset()}}Object(n.a)(Kx,"ClipboardOperationClipboardAccessHelper",null,[564]);class vy{constructor(b,h,r,z,R,ba,ta,Wa,ub,Ib,$b,fc,Kc,ed,Jd,ge){this.ISa=null;this.ga=b;this.ld=h;this.lz=r;this.Kh=z;this.ib=R;this.Rca=ba;this.fb=ta;this.Fe=Wa;this.zn=ub;
this.Xc=Ib;this.M8a=$b;this.uEe=fc;this.kA=Kc;this.Yj=Jd;this.bRb=ed?ed.$("ImageDataURLSkippedForSafari12IsEnabled"):!1;this.bed=ed?ed.$("PasteKeepSourceFontSizeFixIsEnabled"):!1;this.Ac=ge}get Wg(){return this.Kh}get Mc(){return this.ld}get xNc(){if(null==this.ISa)if(this.Ac)if(this.Ac.Yk.isCompleted)this.ISa=this.Ac.isFeatureEnabled(30)&&this.Ac.isFeatureEnabled(2);else return!1;else this.ISa=!1;return this.ISa}Tqo(b){b.a0();return!0}esh(b,h){b=h.lA;v.ULS.shipAssertTag(18130960,307,!!(b&16));if(b&
256){let z=!1,R;X.a.wCa&&t.AFrameworkApplication.Hl("Microsoft.Office.Web.SessionSettings.IWacWoncaImageDataURLSkippedSettings");this.xNc&&h.ve&&h.ve.Ug&&(z=this.Yj.u8g(h.ve.Ug.editingElement));R=this.Yj.skf(h.ve.Ug.editingElement,!1);var r=h.ve.Ug.editingElement;this.Yj.Qof(r,!1,1);this.bRb&&X.a.wCa?(r=h.ve.Ug.editingElement,this.Yj.vTf(r,"data-src","data-srcurl"),b=this.Rca.copy(),this.Yj.vTf(r,"data-srcurl","data-src")):this.bed&&h.ve&&h.ve.Ug?(r=this.Yj.aWe(h.ve.Ug.editingElement,h.ve.Nw,!0),
b=this.Rca.copy(),r&&this.Yj.aWe(h.ve.Ug.editingElement,h.ve.Nw,!1)):(this.Yj.KOi(h.ve.Ug.editingElement),b=this.Rca.copy());this.xNc&&z&&this.Yj.Tqn(h.ve.Ug.editingElement);R&&this.Yj.skf(h.ve.Ug.editingElement,!0);r=h.ve.Ug.editingElement;this.Yj.Qof(r,!1,0);if(!b)return v.ULS.sendTraceTag(6305540,307,50,"SystemClipboard didn't copy"),this.Mc.Zb(Sc.a.Xyb,{["Reason"]:Xc.a.Q3f}),h.FQ&&h.FQ.fail("SystemClipboard did not copy",!1),h.failed=!0,!1}return!0}$Ze(b,h){const r=h.ve;v.ULS.shipAssertTag(18130961,
307,!!(h.lA&16));h.SZn?this.lz.Wmh():this.lz.axd(r,b);return!0}pyh(b,h){var r=h.context,z=h.Cd;const R=h.k7;var ba=!1;b=this.ib.hb.kb.Tc;if(this.fb.gm(b)||this.Fe.uk(b)){const ta=this.Xc.fg(b.node),Wa=ta.vd();v.ULS.shipAssertTag(18130962,307,Wa);this.zn.Zd(ta);this.M8a.bgb(ta)&&(ba=!0)}z=h.lA&64?new Ei.DictionaryPropertySet:z||new Ei.DictionaryPropertySet;z.setValue(od.a.pEc,!1);r=this.ga.Qf(r,Fb.a.SG,2,!0,R,z);8===r&&(v.ULS.sendTraceTag(18130963,307,50,"DeleteKey failed"),this.Mc.Zb(Sc.a.Ska,{["Reason"]:Xc.a.oyh}),
h.FQ&&h.FQ.fail("DeleteKey failed",!1),h.failed=!0);32===r&&ba&&(h=this.ib.hb.kb,this.Fe.Qm(h)&&h.Qa.node===b.node&&!this.fb.textLength(h.Qa.node)&&(h=this.Xc.fg(h.Qa.node),b=this.Fe.Jt(h),v.ULS.shipAssertTag(18130964,307,b),this.zn.Zd(h),this.M8a.wOd(h)||(b=this.uEe.create(),b.fd(h),this.zn.R2(b,!1,!1),ba=this.zn.De(b),this.fb.nc(ba)&&(this.zn.Zd(b),this.Wg.merge(b,h,!1,!1),this.ib.setSelection(this.kA.xe(ba,this.fb.textLength(ba)))))));return!0}}Object(n.a)(vy,"ClipboardOperationCutCopy",null,[591]);
class Lx{constructor(b,h,r,z,R,ba,ta,Wa,ub,Ib,$b,fc,Kc,ed,Jd,ge){this.ga=b;this.ld=h;this.lz=r;this.Rca=ba;this.ib=R;this.Kh=z;this.fb=ta;this.Fe=Wa;this.zn=ub;this.Xc=Ib;this.M8a=$b;this.uEe=fc;this.kA=Kc;this.Oa=ed;this.Yj=Jd;this.Ac=ge}create(){return new vy(this.ga,this.ld,this.lz,this.Kh,this.ib,this.Rca,this.fb,this.Fe,this.zn,this.Xc,this.M8a,this.uEe,this.kA,this.Oa,this.Yj,this.Ac)}}Object(n.a)(Lx,"Factory",null,[563]);var Ex=d(1635);class Mw{constructor(b,h){this.B8c=null;this.pGk=(r,z)=>
{if(!Object(nb.a)(93,z.Cd))return!1;const R=Object(la.a)(93,z.Cd);if(!R.hasProperty(od.a.wjf))return!1;const ba=R.getValue(od.a.wjf),ta=z.ve,Wa=ta.Cb;this.lz.Gjj();Wa.bJb(()=>{Wa.setSelection(ba,void 0,!0);this.lz.axd(ta,r)},!0);return!0};this.lz=b;this.i4=h;this.DH=0}process(b,h){this.DH||(this.B8c=[this.pGk,Object(u.a)(this.i4,this.i4.o3m,"pasteGlossaryPlaceholder")]);let r=!0;this.DH<this.B8c.length&&(r=this.B8c[this.DH++](b,h));return r?this.DH<this.B8c.length:!1}}Object(n.a)(Mw,"ClipboardOperationContentControlShowPlaceholderProcessor",
null,[607]);var Ut=d(643);class Ou{constructor(b){this.vob=null;this.m0=b;this.DH=-1}process(b,h){-1===this.DH&&(this.dQk(b,h),this.DH=0);let r=!1;this.DH<this.vob.length&&(r=this.vob[this.DH++](b,h));return r?this.DH<this.vob.length:!1}dQk(b,h){X.a.z2||h.lA&512?(this.vob=[Object(u.a)(this.m0,this.m0.$Ze,"copyInternal")],v.ULS.sendTraceTag(18158306,307,50,"ClipboardOperationCutCopyProcessor: setup actions as CopyInternal.")):!b.eh&&h.lA&256?(this.vob=[Object(u.a)(this.m0,this.m0.Tqo,"waitBeforeCopy"),
Object(u.a)(this.m0,this.m0.esh,"copyExternal"),Object(u.a)(this.m0,this.m0.$Ze,"copyInternal")],v.ULS.sendTraceTag(18158307,307,50,"ClipboardOperationCutCopyProcessor: setup actions as WaitBeforeCopy, CopyExternal, CopyInternal.")):(this.vob=[Object(u.a)(this.m0,this.m0.esh,"copyExternal"),Object(u.a)(this.m0,this.m0.$Ze,"copyInternal")],v.ULS.sendTraceTag(18158336,307,50,"ClipboardOperationCutCopyProcessor: setup actions as CopyExternal, CopyInternal."));h.lA&32&&(b=Object(u.a)(this.m0,this.m0.pyh,
"deleteForCut"),this.vob.push(b),v.ULS.sendTraceTag(18158337,307,50,"ClipboardOperationCutCopyProcessor: setup actions add DeleteForCut for cut."));Ut.a.xwm(h)}}Object(n.a)(Ou,"ClipboardOperationCutCopyProcessor",null,[590]);class Nw{constructor(b,h,r,z){this.mgd=null;this.sGk=(R,ba)=>{ba=ba.ve;this.lz.Sno();this.lz.axd(ba,R);return!0};this.nSc=(R,ba)=>{ba=new tm.Selection([ba.Cd],!0);this.ib.setSelection(ba,R);return!0};this.lz=b;this.ib=h;this.m0=r;this.i4=z;this.DH=0}process(b,h){this.DH||(this.mgd=
[this.sGk,Object(u.a)(this.m0,this.m0.pyh,"deleteForCut"),this.nSc,Object(u.a)(this.i4,this.i4.TDi,"pasteInternal"),Object(u.a)(this.i4,this.i4.X_i,"setSelectionAfterPaste")]);let r=!0;this.DH<this.mgd.length&&(r=this.mgd[this.DH++](b,h));return r?this.DH<this.mgd.length:!1}}Object(n.a)(Nw,"ClipboardOperationMoveProcessor",null,[592]);var Fx=d(1634);class Gx{constructor(b,h,r,z,R,ba,ta,Wa,ub,Ib,$b,fc,Kc,ed,Jd,ge,qe,Ve){this.lz=b;this.ga=h;this.Bkc=r;this.ld=z;this.Fe=R;this.te=ba;this.Hc=ta;this.X7c=
Wa;this.Oyj=ub;this.vOb=Ib;this.vke=$b;this.qkc=fc;this.IIa=Kc;this.GC=ed;this.Hd=Jd;this.wm=ge;this.RD=qe;this.Tca=Ve}create(b,h,r,z,R,ba,ta,Wa,ub=!0){const Ib=this.X7c.create(z,Object(la.a)(93,Wa));var $b=this.Oyj.create();const fc=new Mw(this.lz,Ib),Kc=new Nw(this.lz,di.a.instance,$b,Ib);$b=new Ou($b);z=new Fx.a(t.AFrameworkApplication.K,Dl.a.instance,z,wc.a.instance,Ib,this.vOb);return new Ex.a(b,h,r,R,ba,ta,Wa,this.Bkc,this.ga,this.ld,this.Fe,this.te,this.Hc,fc,Kc,$b,z,this.vOb,this.vke,this.qkc,
this.IIa,this.GC,this.Hd,this.wm,this.RD,this.Tca,t.AFrameworkApplication.a0f(),ub)}}Object(n.a)(Gx,"Factory",null,[562]);var Hx=d(271);class xv{constructor(b,h){this.pBb=b.tef(h);this.g_e=b.Xnl(h);this.Bwb=b.bcf(h);this.pab=b.Bbf(h)}static sF(b){return xv.mr(b)}static mr(b){return new xv(uu.a.instance,b)}}Object(n.a)(xv,"CpUsageHelper",null,[]);class Rd{constructor(b,h,r,z,R,ba,ta,Wa,ub,Ib,$b,fc){this.z8=null;this.ld=b;this.lz=h;this.ptc=r;this.ara=z;this.ib=R;this.ga=ba;this.dse=ta;this.lLe=ub;
this.rCe=Wa;this.Mne=Ib;this.tke=$b;this.Hd=fc;this.wVg=!!t.AFrameworkApplication.K&&t.AFrameworkApplication.K.$("WordEditorPasteFailuresImprovementIsEnabled")}get xi(){return this.lLe.value}get Coa(){return this.ara}get Mc(){return this.ld}get jOa(){return this.rCe.jOa}paste(b,h){const r=this.Hd.HVa();try{const z=h.ve,R=h.lA;this.F6&&(this.ib&&this.ib.hb&&this.ib.hb.kb&&Hx.TableBorderSelectionCache.AQn(this.ib.hb.kb.yw||this.ib.hb.kb.TDb),eq.a.COn(this.ib));v.ULS.shipAssertTag(18131010,307,!!(R&
1));Object(nb.a)(93,h.Cd)&&h.Cd.setValue(ui.a.Zda,z.Ug.editingElement.clientWidth);this.tke.fdo(b,h);let ba;if(!({Cwd:ba}=this.dse.value.Bdj()).returnValue)return this.nRc(h,"HTML import strategy failed",!1),Ca.Health.instance.recordQosError("HtmlImportStrategyFailed",[Ut.a.t_d],!1,!0,!0,!1,null),!1;this.xi.EF();let ta=!0,Wa=null;const ub=this.Mne.create(ba),Ib=h.Djj;if((!z||!z.Cb)&&this.wVg)return this.nRc(h,"Fail to set selection.",!1),Ca.Health.instance.recordQosError("SetSelectionFailed",[Ut.a.t_d],
!1,!0,!0,!1,null),!1;z.Cb.bJb(()=>{Ib&&2===this.ga.processAction(Fb.a.Aka,2)?ta=!1:(Wa=Ib?this.ib&&this.ib.hb&&this.ib.hb.kb?this.ib.hb.kb.Qa:null:h.Cd)?(v.ULS.shipAssertTag(18158338,307,Xd.SelectionEditor.xf(Wa)),this.Umi(Wa,"paste")):v.ULS.sendTraceTag(591958036,307,15,"ipContext is null. useSelection: {0}; ",Ib)},this.rCe.Nfi);if(!ta)return this.nRc(h,"fail to deleteForReplace.",!0),!1;if(!Wa&&this.wVg)return this.nRc(h,"null ipContext after RunAgainstSelectionCollection.",!0),!1;if(!Wa.node||
!Wa.node.isConnected)return this.nRc(h,"node is null or not connected in ip context.",!0),!1;z.editingView.disable(!0,25);ub.restore();this.ptc.k3m(ba,Wa,b);return!0}finally{r&&r.dispose()}}nRc(b,h,r){b.failed=!0;b.FQ&&b.FQ.fail(h,r)}o3m(b,h){const r=Object(la.a)(93,h.Cd).getValue(od.a.M1h);v.ULS.shipAssertTag(20492440,307,Xd.SelectionEditor.xf(r));if(!this.fmh(r,h))return!1;this.xi.EF();h=(new $m.a).Rc(15);h.Db(this.lz.iha);this.ptc.Z9h(r,b);this.lz.Wmh();h.dispose();return!0}TDi(b,h){const r=this.ib.hb.kb.Qa;
if(!this.fmh(r,h))return!1;this.xi.EF();this.ga.processAction(Fb.a.Aka,2);this.Umi(r,"intPaste");this.ptc.Z9h(r,b);return!0}fmh(b,h){if(t.AFrameworkApplication.K&&t.AFrameworkApplication.K.$("AbortClipboardOperationForInvalidIpContext")){if(!b||!b.Rd)return v.ULS.sendTraceTag(595142426,307,15,"Invalid ip context. IsTouch: {0}",!!h&&h.euf),h.FQ&&(h.FQ.fail("Invalid ipContext before InternalPasteAtIp",!0),h.failed=!0),!1;if(!Xd.SelectionEditor.xf(b))return v.ULS.sendTraceTag(587843167,307,15,"Ip context is not insertion point. IsTouch: {0}; contextId: {1}; ipContext.Node: {2}; ipContext.Node.Anchor: {3};",
!!h&&h.euf,b.contextId,!!b.node,!!b.node&&!!b.node.anchor),h.FQ&&(h.FQ.fail("ipContext is not insertion point in InternalPasteAtIp",!0),h.failed=!0),!1}return!0}Umi(b,h){h=xv.sF(h);this.Coa.nhn(h,b.node,b.cpBegin);this.Coa.zwm(h.g_e);this.Coa.Dxf(h.pBb);this.Coa.rxf(h.Bwb);this.Coa.pxf(h.pab)}X_i(b,h){if(!h.Djj)return!1;h.lA&64&&this.lz.Fjj();if(!h.IXa)return v.ULS.sendTraceTag(3994450,307,50,"No selection after paste"),this.Mc.Zb(Sc.a.P_,{["Reason"]:Xc.a.Cfb}),h.FQ&&h.FQ.fail("No selection after paste",
!1),h.failed=!0,!1;this.rCe.lno(h);this.xi.EF();return!1}get F6(){null==this.z8&&(t.AFrameworkApplication.Hf("he991617;3eed2178"),this.z8=t.AFrameworkApplication.K?t.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.TableCCPNewExperienceIsEnabled",!1):!1);return this.z8}}Object(n.a)(Rd,"ClipboardOperationPaste",null,[588]);class yv{constructor(b,h,r,z,R,ba,ta,Wa,ub,Ib,$b){this.ld=b;this.lz=h;this.ptc=r;this.ara=z;this.ib=R;this.ga=ba;this.lLe=Wa;this.nQj=ta;this.Mne=ub;this.tke=
Ib;this.Hd=$b}create(b,h){h=this.nQj.create(this.ib,h);return new Rd(this.ld,this.lz,this.ptc,this.ara,this.ib,this.ga,b,h,this.lLe,this.Mne,this.tke,this.Hd)}}Object(n.a)(yv,"Factory",null,[561]);var $i=d(1575);class Ow{constructor(b,h){this.F3n=b;this.k2m=h}}Object(n.a)(Ow,"ParagraphFormatStore",null,[]);class Hp{constructor(b,h,r,z){this.ib=b;this.fb=h;this.He=r;this.Tve=z}fdo(b,h){if(h.d7b&&this.Tve){h=b.Vfa;var r=this.ib.hb.kb.Qa.node,z=null;this.fb.nc(r)&&(z=this.He.yo(r),r=this.fb.GYa(r),z=
new Ow(z,r));h=new $i.a(h.context,h.lA,h.FQ,h.k7,h.Cd,z);b.Vfa=h}}}Object(n.a)(Hp,"ClipboardOperationPasteOvertypeStrategy",null,[560]);class Tu{constructor(b){this.cye=null;this.ib=b;b.bJb(h=>{this.cye=h},!1)}get Nfi(){return!1}lno(b){b=this.WPe(b);this.setSelection(this.ib,b)}WPe(b){let h=b.IXa;(b.IQa||b.eEa)&&b.V9d&&(h=Hf.SelectionFactory.XC(b.V9d,h.Qa));return h}setSelection(b,h){b.setSelection(h)}}Object(n.a)(Tu,"AClipboardOperationPasteStrategy",null,[609]);class uh extends Tu{constructor(b){super(b)}get jOa(){return this.cye}}
Object(n.a)(uh,"ClipboardOperationPasteToLiveSelectionStrategy",Tu,[]);class Es extends Tu{constructor(b,h){super(b);this.oMe=null;this.AMj=h;b.bJb(r=>{this.oMe=r},!0)}get Nfi(){return!0}get jOa(){return this.oMe}WPe(b){let h=super.WPe(b);b.Cd.setValue(od.a.XDi,h);return h=this.AMj.uUh(this.cye.kb,this.oMe.kb,h)}}Object(n.a)(Es,"ClipboardOperationPasteToVirtualSelectionStrategy",Tu,[]);class Jo{constructor(b){this.nMe=b.$("EnableVirtualSelectionInSelectionManager")}create(b,h){return h&&h.ia(od.a.IQa,
!1)&&this.nMe?new Es(b,this.uqo):new uh(b)}get uqo(){return null!=this.Fsg?this.Fsg:this.Fsg=Sa.a.instance.Pa("Box4.Actors.IVirtualSelectionMerger")}}Object(n.a)(Jo,"ClipboardOperationPasteStrategyFactory",null,[559]);class Yn{constructor(b,h,r,z,R){this.ld=b;this.ib=h;this.Zj=r;this.Ok=z;this.mKj=R}C7m(b){this.mKj&&(b&1||b&32)&&this.Zj.Mp&&this.ib.zWb()}K$l(b,h){return b&1&&this.Ok.iZ(h,!0)?(this.ld.Zb(Sc.a.zf,{["Reason"]:Xc.a.dE}),!1):!0}}Object(n.a)(Yn,"ClipboardOperationWordStrategy",null,[]);
class Dv{constructor(){}TFk(b,h){if(h)if(h=h.sheet)if(h=h.cssRules){var r=Array.clone(h);r.reverse();var z=h=0,R=0,ba=0;for(const Wa of r){r=Wa.style;var ta=Wa.selectorText;r=r?r.cssText:null;ta=ta?ta.split(","):null;if(r&&ta&&Wa.type===Wa.STYLE_RULE){ba+=ta.length;for(const ub of ta){0<=ub.indexOf("#")&&h++;0<=ub.indexOf(".")&&z++;0>ub.indexOf("#")&&0>ub.indexOf(".")&&R++;ta=null;try{ta=b.querySelectorAll(ub)}catch(Ib){v.ULS.sendTraceTag(41427107,307,10,"ConvertStyleDomToInlineStyle failed to query selector: {0}. Exception: {1}",
ub,Ib.message)}if(ta)for(let Ib=0;Ib<ta.length;Ib++)ta[Ib].setAttribute("style",r+(ta[Ib].getAttribute("style")||""))}}}v.ULS.sendTraceTag(51245663,307,50,"selectorCount: {0}; idSelectorCount: {1}; classSelectorCount: {2}; tagSelectorCount: {3}",ba,h,z,R)}else this.Dni();else this.Dni()}Dni(){v.ULS.sendTraceTag(41211202,307,15,"Could not access {0} for Style DOMElement in ConvertStyleDomToInlineStyle and abort the conversion. Browser: {1} ",X.a.dF)}}Object(n.a)(Dv,"ExternalPasteCssConverter",null,
[558]);var en=d(632),wy=d(1076);class vu{constructor(b){this.O1=0;this.vnh=null;this.node=b}}Object(n.a)(vu,"ChartConverterArguments",null,[]);class Mx{constructor(b=null){this._imgNodesConverted=0;this.OV=b||Eo.a.ANh("")}get Jc(){return this.OV}process(b,h){b&&(this._imgNodesConverted=0,b.querySelectorAll&&(b=b.querySelectorAll("div"),1===b.length&&(b=new Bq.a(h,this.k6k.bind(this),new vu(b[0])),b.ml("Chart Converter Operation"),b.eh=!h||h.eh,b.run())))}k6k(b,h){var r=h.node;if(1<h.O1)return!1;if(1===
r.nodeType&&"DIV"===r.tagName){const z=r.getAttribute(en.a.Byd);if(z){const R=r.getAttribute(en.a.k2e),ba=r.getAttribute(en.a.l2e),ta=r.getAttribute(en.a.i2e),Wa=r.getAttribute(en.a.j2e),ub=r.getAttribute(en.a.pDc);r=r.getAttribute(en.a.m2e);R&&Wa&&ba&&"chart"===ba&&ub&&"XLO"===ub&&(h.vnh=new wy.a(z,R,ba,ta,Wa,ub,r))}}b.ti(this.bJm.bind(this));return!0}bJm(b,h){var r=h.node;if(b=h.vnh)1===r.childElementCount&&1===r.firstChild.nodeType&&"IMG"===r.firstChild.tagName?(r=r.firstChild,r.setAttribute(en.a.Byd,
b.ccpId),r.setAttribute(en.a.k2e,b.pKey),r.setAttribute(en.a.l2e,b.type),r.setAttribute(en.a.j2e,b.dc),r.setAttribute(en.a.pDc,b.client),b.version&&r.setAttribute(en.a.m2e,b.version),b.count&&r.setAttribute(en.a.i2e,b.count),this._imgNodesConverted++):v.ULS.sendTraceTag(541361690,307,15,"Invalid html received"),this.OV._imgNodesConverted=this._imgNodesConverted;h.O1++;return!1}}Object(n.a)(Mx,"ChartConverter",null,[]);var lz=d(1160);class Nx{constructor(b,h=null,r=null){this.nf=b;this.OV=h||Eo.a.OYh("");
this.fXj=r||Eo.a.PYh("")}get Jc(){return this.OV}get j4f(){return this.fXj}Aaa(b){this.j4f.b++;this.nf.Aaa(b)}xaa(){this.nf.xaa()}zaa(b){this.j4f.c++;this.nf.zaa(b)}yaa(){this.nf.yaa()}waa(b){this.j4f.d++;this.nf.waa(b)}vaa(){this.nf.vaa()}reset(){this.nf.reset()}get yDc(){return this.nf.yDc}Baa(b,h){this.Jc.b++;this.nf.Baa(b,h)}aDa(b){this.Jc.c++;this.nf.aDa(b)}tib(b){this.Jc.b++;this.nf.tib(b)}Gua(b){this.Jc.d++;this.nf.Gua(b)}XCa(b){this.Jc.f++;this.nf.XCa(b)}PNa(b,h){this.Jc.g++;this.nf.PNa(b,
h)}ONa(){this.nf.ONa()}MF(b){this.Jc.h++;this.nf.MF(b)}LF(){this.nf.LF()}qib(){this.nf.qib()}pib(){this.nf.pib()}UNa(b,h){this.Jc.i++;this.nf.UNa(b,h)}Y0a(){this.nf.Y0a()}dDa(b){this.Jc.j++;this.nf.dDa(b)}bDa(){this.nf.bDa()}TNa(b){this.Jc.k++;this.nf.TNa(b)}cDa(){this.nf.cDa()}a1a(b){this.Jc.l++;this.nf.a1a(b)}}Object(n.a)(Nx,"SemanticEventUsageCollector",null,[204,205]);class Zt{constructor(b,h=null,r=null,z=null){this.uzj="span p div br a img label b font i strong u em h1 h2 h3 h4 h5 h6 table tbody td tr li ol ul".split(" ");
this.nf=b;this.OV=h||Eo.a.eSh(X.a.$vb,"");this.qu=r;this.UUj=z?z.$("ParseStyleForHtmlTagEventIsEnabled"):!1;this.VUj=z?z.$("ParseStyleForUncommonHtmlTagEventIsEnabled"):!1;this.Oyg=new zd.a(ka.a.Rj());for(const R of this.uzj)this.Oyg.add(R)}get Jc(){return this.OV}get Io(){return this.qu}Hh(b){return b?b+1:1}reset(){this.nf.reset()}EWd(){this.nf.EWd()}Yjf(b){if(b&&this.Io&&(b.getAttribute&&(b.getAttribute(en.a.sQk)&&(this.Io.rKh=!0),b.getAttribute(en.a.Byd)&&(this.Io.Xdl=!0),b.getAttribute(en.a.pDc)&&
(this.Io.oXe=b.getAttribute(en.a.pDc)),b.getAttribute(en.a.wQk)&&(this.Io.sKh=!0)),b.id&&b.id.startsWith&&b.id.startsWith(en.a.LQl)&&(this.Io.Zdl=!0),b.className&&b.className.split))for(const h of b.className.split(" ")){h.startsWith(en.a.qZm)&&(this.Io.ael=!0);h.startsWith(en.a.O6m)&&(this.Io.uKh=!0);h.startsWith(en.a.Cso)&&(this.Io.vKh=!0);if(h.startsWith(X.a.hUe)&&h.length===X.a.hUe.length+1){const r=parseInt(B.a.substring(h,h.length-1,h.length));isNaN(r)||(this.Io.oCc=r)}if(h===en.a.lKm||h===
en.a.mKm)this.Io.RDd=!0}return this.nf.Yjf(b)}onClose(){this.nf.onClose()}Baa(b,h){this.Io&&(this.Io.bel=!0);this.Jc.d=this.Hh(this.Jc.d);this.nf.Baa(b,h)}vWd(b){this.Jc.e=this.Hh(this.Jc.e);this.hi(b);return this.nf.vWd(b)}UEf(b){this.Jc.f=this.Hh(this.Jc.f);this.hi(b);return this.nf.UEf(b)}VEf(b){this.Jc.g=this.Hh(this.Jc.g);this.hi(b);return this.nf.VEf(b)}YEf(b){this.Jc.h=this.Hh(this.Jc.h);this.hi(b);return this.nf.YEf(b)}nFf(b){this.Jc.i=this.Hh(this.Jc.i);this.hi(b);return this.nf.nFf(b)}oFf(b){this.Jc.j=
this.Hh(this.Jc.j);this.hi(b);this.nf.oFf(b)}DWd(b){this.Jc.k=this.Hh(this.Jc.k);this.hi(b);return this.nf.DWd(b)}pFf(b){this.Jc.l=this.Hh(this.Jc.l);this.hi(b);this.nf.pFf(b)}qFf(b){this.Jc.m=this.Hh(this.Jc.m);this.hi(b);this.nf.qFf(b)}rFf(b){this.Jc.n=this.Hh(this.Jc.n);this.hi(b);return this.nf.rFf(b)}HWd(b){this.Jc.o=this.Hh(this.Jc.o);this.hi(b);return this.nf.HWd(b)}IWd(b){this.Jc.p=this.Hh(this.Jc.p);this.hi(b);return this.nf.IWd(b)}FFf(b){this.Jc.q=this.Hh(this.Jc.q);this.hi(b);return this.nf.FFf(b)}JWd(b){this.Jc.r=
this.Hh(this.Jc.r);this.hi(b);this.nf.JWd(b)}HFf(b){this.Jc.s=this.Hh(this.Jc.s);this.hi(b);return this.nf.HFf(b)}LWd(b){this.Jc.t=this.Hh(this.Jc.t);this.hi(b);return this.nf.LWd(b)}MWd(b){this.Jc.u=this.Hh(this.Jc.u);this.hi(b);return this.nf.MWd(b)}PWd(b){this.Jc.v=this.Hh(this.Jc.v);this.hi(b);return this.nf.PWd(b)}QWd(b){this.Jc.w=this.Hh(this.Jc.w);this.hi(b);return this.nf.QWd(b)}TFf(b){this.Jc.x=this.Hh(this.Jc.x);this.hi(b);this.nf.TFf(b)}UFf(b){this.Jc.y=this.Hh(this.Jc.y);this.hi(b);return this.nf.UFf(b)}VWd(b){this.Jc.z=
this.Hh(this.Jc.z);this.hi(b);return this.nf.VWd(b)}WWd(b){this.Jc.ba=this.Hh(this.Jc.ba);this.hi(b);return this.nf.WWd(b)}$Wd(b){this.Jc.bb=this.Hh(this.Jc.bb);this.hi(b);return this.nf.$Wd(b)}aXd(b){this.Jc.bc=this.Hh(this.Jc.bc);this.hi(b);return this.nf.aXd(b)}cXd(b){this.Jc.bd=this.Hh(this.Jc.bd);this.hi(b);return this.nf.cXd(b)}dXd(b){this.Jc.be=this.Hh(this.Jc.be);this.hi(b);return this.nf.dXd(b)}gXd(b){this.Jc.bf=this.Hh(this.Jc.bf);this.hi(b);return this.nf.gXd(b)}iXd(b){this.Jc.bg=this.Hh(this.Jc.bg);
this.hi(b);return this.nf.iXd(b)}tGf(b){this.Jc.bh=this.Hh(this.Jc.bh);this.hi(b);return this.nf.tGf(b)}mXd(b){this.Jc.bi=this.Hh(this.Jc.bi);this.hi(b);return this.nf.mXd(b)}AGf(b){this.Jc.bj=this.Hh(this.Jc.bj);this.hi(b);return this.nf.AGf(b)}CGf(b){this.Jc.bk=this.Hh(this.Jc.bk);this.hi(b);this.nf.CGf(b)}DGf(b){this.Jc.bl=this.Hh(this.Jc.bl);this.hi(b);return this.nf.DGf(b)}pXd(b){this.Jc.bm=this.Hh(this.Jc.bm);this.hi(b);return this.nf.pXd(b)}qXd(b){this.Jc.bm=this.Hh(this.Jc.bm);this.hi(b);
return this.nf.qXd(b)}rXd(b){this.Jc.bm=this.Hh(this.Jc.bm);this.hi(b);return this.nf.rXd(b)}sXd(b){this.Jc.bm=this.Hh(this.Jc.bm);this.hi(b);return this.nf.sXd(b)}tXd(b){this.Jc.bm=this.Hh(this.Jc.bm);this.hi(b);return this.nf.tXd(b)}uXd(b){this.Jc.bm=this.Hh(this.Jc.bm);this.hi(b);return this.nf.uXd(b)}IGf(b){this.Jc.bn=this.Hh(this.Jc.bn);return this.nf.IGf(b)}vXd(b){this.Jc.bo=this.Hh(this.Jc.bo);this.hi(b);this.nf.vXd(b)}OGf(b){this.Jc.bp=this.Hh(this.Jc.bp);return this.nf.OGf(b)}wXd(b){this.Jc.bq=
this.Hh(this.Jc.bq);this.hi(b);return this.nf.wXd(b)}PGf(b){this.Jc.br=this.Hh(this.Jc.br);this.hi(b);return this.nf.PGf(b)}zXd(b){this.Io&&(this.Io.$dl=!0);this.hi(b);this.Jc.bs=this.Hh(this.Jc.bs);this.nf.zXd(b)}VGf(b){this.Jc.bt=this.Hh(this.Jc.bt);this.hi(b);this.nf.VGf(b)}AXd(b){this.Jc.bu=this.Hh(this.Jc.bu);this.hi(b);return this.nf.AXd(b)}aHf(b){this.Jc.bv=this.Hh(this.Jc.bv);this.hi(b);return this.nf.aHf(b)}DXd(b){this.Jc.bw=this.Hh(this.Jc.bw);this.hi(b);return this.nf.DXd(b)}FXd(b){this.Jc.bx=
this.Hh(this.Jc.bx);this.hi(b);return this.nf.FXd(b)}HXd(b){this.Jc.by=this.Hh(this.Jc.by);this.hi(b);return this.nf.HXd(b)}IXd(b){this.Io&&(this.Io.RDd=!0);this.Jc.bz=this.Hh(this.Jc.bz);this.hi(b);return this.nf.IXd(b)}nHf(b){this.Jc.ca=this.Hh(this.Jc.ca);this.hi(b);this.nf.nHf(b)}qHf(b){this.Jc.cb=this.Hh(this.Jc.cb);this.hi(b);return this.nf.qHf(b)}JXd(b){this.Io&&(this.Io.Ydl=!0);this.Jc.cc=this.Hh(this.Jc.cc);this.hi(b);return this.nf.JXd(b)}onMenuOpen(b){this.Jc.cd=this.Hh(this.Jc.cd);this.hi(b);
return this.nf.onMenuOpen(b)}uHf(b){this.Jc.ce=this.Hh(this.Jc.ce);this.nf.uHf(b)}CHf(b){this.Jc.cf=this.Hh(this.Jc.cf);this.hi(b);return this.nf.CHf(b)}DHf(b){this.Jc.cg=this.Hh(this.Jc.cg);this.hi(b);return this.nf.DHf(b)}EHf(b){this.Jc.ch=this.Hh(this.Jc.ch);this.hi(b);return this.nf.EHf(b)}VXd(b){this.Io&&(this.Io.RDd=!0);this.Jc.ci=this.Hh(this.Jc.ci);this.hi(b);return this.nf.VXd(b)}GHf(b){this.Jc.cj=this.Hh(this.Jc.cj);this.hi(b);return this.nf.GHf(b)}WXd(b){this.Jc.ck=this.Hh(this.Jc.ck);
this.hi(b);return this.nf.WXd(b)}ZXd(b){this.Jc.cl=this.Hh(this.Jc.cl);this.hi(b);return this.nf.ZXd(b)}MHf(b){this.Jc.cm=this.Hh(this.Jc.cm);this.hi(b);this.nf.MHf(b)}eYd(b){this.Jc.cn=this.Hh(this.Jc.cn);this.hi(b);return this.nf.eYd(b)}WHf(b){this.Jc.co=this.Hh(this.Jc.co);this.hi(b);return this.nf.WHf(b)}lYd(b){this.Jc.cp=this.Hh(this.Jc.cp);this.hi(b);return this.nf.lYd(b)}mYd(b){this.Jc.cq=this.Hh(this.Jc.cq);this.hi(b);return this.nf.mYd(b)}qIf(b){this.Jc.cr=this.Hh(this.Jc.cr);return this.nf.qIf(b)}wIf(b){this.Jc.cs=
this.Hh(this.Jc.cs);this.hi(b);return this.nf.wIf(b)}vYd(b){this.Jc.ct=this.Hh(this.Jc.ct);this.hi(b);return this.nf.vYd(b)}wYd(b){this.Jc.cu=this.Hh(this.Jc.cu);this.hi(b);return this.nf.wYd(b)}yYd(b){this.Jc.cv=this.Hh(this.Jc.cv);this.hi(b);return this.nf.yYd(b)}zYd(b){this.Jc.cw=this.Hh(this.Jc.cw);this.hi(b);return this.nf.zYd(b)}AIf(b){this.Jc.cx=this.Hh(this.Jc.cx);return this.nf.AIf(b)}AYd(b){this.Jc.cy=this.Hh(this.Jc.cy);this.hi(b);return this.nf.AYd(b)}CYd(b){this.Jc.cz=this.Hh(this.Jc.cz);
this.hi(b);return this.nf.CYd(b)}EYd(b){this.Io&&(this.Io.V1b=!0);this.Jc.da=this.Hh(this.Jc.da);this.hi(b);return this.nf.EYd(b)}EIf(b){this.Io&&(this.Io.V1b=!0);this.Jc.db=this.Hh(this.Jc.db);this.hi(b);return this.nf.EIf(b)}WTc(b){this.Io&&(this.Io.V1b=!0);this.Jc.dc=this.Hh(this.Jc.dc);this.hi(b);return this.nf.WTc(b)}GIf(b){this.Jc.dd=this.Hh(this.Jc.dd);this.hi(b);return this.nf.GIf(b)}HIf(b){this.Jc.de=this.Hh(this.Jc.de);this.hi(b);return this.nf.HIf(b)}HYd(b){this.Io&&(this.Io.V1b=!0);this.Jc.df=
this.Hh(this.Jc.df);this.hi(b);return this.nf.HYd(b)}IIf(b){this.Io&&(this.Io.V1b=!0);this.Jc.dg=this.Hh(this.Jc.dg);this.hi(b);return this.nf.IIf(b)}LIf(b){this.Jc.dh=this.Hh(this.Jc.dh);this.hi(b);return this.nf.LIf(b)}LYd(b){this.Io&&(this.Io.V1b=!0);this.Jc.di=this.Hh(this.Jc.di);this.hi(b);return this.nf.LYd(b)}MYd(b){this.Jc.dj=this.Hh(this.Jc.dj);this.hi(b);return this.nf.MYd(b)}NYd(b){this.Jc.dk=this.Hh(this.Jc.dk);this.hi(b);return this.nf.NYd(b)}OYd(b){this.Io&&(this.Io.RDd=!0);this.Jc.dl=
this.Hh(this.Jc.dl);this.hi(b);return this.nf.OYd(b)}RYd(b){this.Jc.dm=this.Hh(this.Jc.dm);this.hi(b);return this.nf.RYd(b)}hi(b){const h=b.pf;if(h&&this.Io){var r=h.tagName.toLowerCase();if(this.UUj&&this.abi(r)||this.VUj&&!this.abi(r))if("font"===r&&this.$2m(b),h.style&&(b=h.style))for(const z of b)z&&0<z.length&&this.Io.dMd(h.tagName,z)}}$2m(b){if((b=b.pf)&&"font"===b.tagName.toLowerCase()&&this.Io){var h=b.getAttribute("face");h&&0<h.length&&this.Io.dMd(b.tagName,"font-attr-face");(h=b.getAttribute("color"))&&
0<h.length&&this.Io.dMd(b.tagName,"font-attr-color");(h=b.getAttribute("size"))&&0<h.length&&this.Io.dMd(b.tagName,"font-attr-size")}}abi(b){return this.Oyg.contains(b)}}Object(n.a)(Zt,"HtmlEventUsageCollector",null,[223]);class Rw{constructor(b,h,r=!1){this.pf=b;this.zA=h;this.vck=r}}Object(n.a)(Rw,"TagEventParam",null,[]);class xm{constructor(b,h=null){this.a$c=this._prunedElements=this.ZKe=this._voidElements=null;this.qd=b;this.OV=h||Eo.a.fSh("");this.UPn()}get Jc(){return this.OV}dNm(b,h,r){this.ZKe[h]?
this.Cui():(this.Jc.e++,(h=this.a$c[h])&&h(new Rw(b,r,!1)),this.Jc.b++)}Cui(){this.Jc.d++}ZMm(){this.Jc.c++}OMm(b,h,r){if(this.ZKe[h])this.Cui();else{if(h=this.a$c[h])return this.Jc.b++,h(new Rw(b,r,!1));this.Jc.f++}return 2}UPn(){this._voidElements=Na.a.I3("AREA",!0,"BASE",!0,"BASEFONT",!0,"BR",!0,"COL",!0,"FRAME",!0,"HR",!0,"IMG",!0,"INPUT",!0,"LINK",!0,"META",!0,"PARAM",!0);this.ZKe=Na.a.I3("ABBR",!0,"ACRONYM",!0,"ADDRESS",!0,"BDO",!0,"BODY",!0,"BUTTON",!0,"FIELDSET",!0,"FORM",!0,"FRAMESET",!0,
"HTML",!0,"NOFRAMES",!0,"NOSCRIPT",!0,"OPTGROUP",!0,"Q",!0,"SELECT",!0,"TEXTAREA",!0);this._prunedElements=Na.a.I3("APPLET",!0,"AREA",!0,"BASE",!0,"BASEFONT",!0,"FRAME",!0,"HEAD",!0,"IFRAME",!0,"INPUT",!0,"ISINDEX",!0,"LINK",!0,"MAP",!0,"META",!0,"OBJECT",!0,"PARAM",!0,"SCRIPT",!0,"STYLE",!0,"TITLE",!0);const b=this.qd,h=this.qd,r=this.qd,z=this.qd,R=this.qd,ba=this.qd,ta=this.qd,Wa=this.qd,ub=this.qd,Ib=this.qd,$b=this.qd,fc=this.qd,Kc=this.qd,ed=this.qd,Jd=this.qd,ge=this.qd,qe=this.qd,Ve=this.qd,
Bd=this.qd,he=this.qd;this.a$c=Na.a.I3("A",Object(u.a)(this.qd,this.qd.vWd,"onAOpen"),"ABBR",Object(u.a)(this.qd,this.qd.UEf,"onAbbrOpen"),"ACRONYM",Object(u.a)(this.qd,this.qd.VEf,"onAcronymOpen"),"ADDRESS",Object(u.a)(this.qd,this.qd.YEf,"onAddressOpen"),"APPLET",Object(u.a)(this.qd,this.qd.nFf,"onAppletOpen"),"AREA",Object(u.a)(this.qd,this.qd.oFf,"onAreaTag"),"B",Object(u.a)(this.qd,this.qd.DWd,"onBOpen"),"BASE",Object(u.a)(this.qd,this.qd.pFf,"onBaseTag"),"BASEFONT",Object(u.a)(this.qd,this.qd.qFf,
"onBasefontTag"),"BDO",Object(u.a)(this.qd,this.qd.rFf,"onBdoOpen"),"BIG",Object(u.a)(this.qd,this.qd.HWd,"onBigOpen"),"BLOCKQUOTE",Object(u.a)(this.qd,this.qd.IWd,"onBlockquoteOpen"),"BODY",Object(u.a)(this.qd,this.qd.FFf,"onBodyOpen"),"BR",Object(u.a)(this.qd,this.qd.JWd,"onBrTag"),"BUTTON",Object(u.a)(this.qd,this.qd.HFf,"onButtonOpen"),"CAPTION",Object(u.a)(this.qd,this.qd.LWd,"onCaptionOpen"),"CENTER",Object(u.a)(this.qd,this.qd.MWd,"onCenterOpen"),"CITE",Object(u.a)(this.qd,this.qd.PWd,"onCiteOpen"),
"CODE",Object(u.a)(this.qd,this.qd.QWd,"onCodeOpen"),"COL",Object(u.a)(this.qd,this.qd.TFf,"onColTag"),"COLGROUP",Object(u.a)(this.qd,this.qd.UFf,"onColgroupOpen"),"DD",Object(u.a)(this.qd,this.qd.VWd,"onDdOpen"),"DEL",Object(u.a)(this.qd,this.qd.WWd,"onDelOpen"),"DFN",Object(u.a)(this.qd,this.qd.$Wd,"onDfnOpen"),"DIR",Object(u.a)(this.qd,this.qd.aXd,"onDirOpen"),"DIV",Object(u.a)(this.qd,this.qd.cXd,"onDivOpen"),"DL",Object(u.a)(this.qd,this.qd.dXd,"onDlOpen"),"DT",Object(u.a)(this.qd,this.qd.gXd,
"onDtOpen"),"EM",Object(u.a)(this.qd,this.qd.iXd,"onEmOpen"),"FIELDSET",Object(u.a)(this.qd,this.qd.tGf,"onFieldsetOpen"),"FONT",Object(u.a)(this.qd,this.qd.mXd,"onFontOpen"),"FORM",Object(u.a)(this.qd,this.qd.AGf,"onFormOpen"),"FRAME",Object(u.a)(this.qd,this.qd.CGf,"onFrameTag"),"FRAMESET",Object(u.a)(this.qd,this.qd.DGf,"onFramesetOpen"),"H1",Object(u.a)(this.qd,this.qd.pXd,"onH1Open"),"H2",Object(u.a)(this.qd,this.qd.qXd,"onH2Open"),"H3",Object(u.a)(this.qd,this.qd.rXd,"onH3Open"),"H4",Object(u.a)(this.qd,
this.qd.sXd,"onH4Open"),"H5",Object(u.a)(this.qd,this.qd.tXd,"onH5Open"),"H6",Object(u.a)(this.qd,this.qd.uXd,"onH6Open"),"HEAD",Object(u.a)(this.qd,this.qd.IGf,"onHeadOpen"),"HR",Object(u.a)(this.qd,this.qd.vXd,"onHrTag"),"HTML",Object(u.a)(this.qd,this.qd.OGf,"onHtmlOpen"),"I",Object(u.a)(this.qd,this.qd.wXd,"onIOpen"),"IFRAME",Object(u.a)(this.qd,this.qd.PGf,"onIframeOpen"),"IMG",Object(u.a)(this.qd,this.qd.zXd,"onImgTag"),"INPUT",Object(u.a)(this.qd,this.qd.VGf,"onInputTag"),"INS",Object(u.a)(this.qd,
this.qd.AXd,"onInsOpen"),"ISINDEX",Object(u.a)(this.qd,this.qd.aHf,"onIsindexOpen"),"KBD",Object(u.a)(this.qd,this.qd.DXd,"onKbdOpen"),"LABEL",Object(u.a)(this.qd,this.qd.FXd,"onLabelOpen"),"LEGEND",Object(u.a)(this.qd,this.qd.HXd,"onLegendOpen"),"LI",Object(u.a)(this.qd,this.qd.IXd,"onLiOpen"),"LINK",Object(u.a)(this.qd,this.qd.nHf,"onLinkTag"),"MAP",Object(u.a)(this.qd,this.qd.qHf,"onMapOpen"),"MATH",Object(u.a)(this.qd,this.qd.JXd,"onMathOpen"),"MENU",Object(u.a)(this.qd,this.qd.onMenuOpen,"onMenuOpen"),
"META",Object(u.a)(this.qd,this.qd.uHf,"onMetaTag"),"NOFRAMES",Object(u.a)(this.qd,this.qd.CHf,"onNoframesOpen"),"NOSCRIPT",Object(u.a)(this.qd,this.qd.DHf,"onNoscriptOpen"),"OBJECT",Object(u.a)(this.qd,this.qd.EHf,"onObjectOpen"),"OL",Object(u.a)(this.qd,this.qd.VXd,"onOlOpen"),"OPTGROUP",Object(u.a)(this.qd,this.qd.GHf,"onOptgroupOpen"),"OPTION",Object(u.a)(this.qd,this.qd.WXd,"onOptionOpen"),"P",Object(u.a)(this.qd,this.qd.ZXd,"onPOpen"),"PARAM",Object(u.a)(this.qd,this.qd.MHf,"onParamTag"),"PRE",
Object(u.a)(this.qd,this.qd.eYd,"onPreOpen"),"Q",Object(u.a)(this.qd,this.qd.WHf,"onQOpen"),"S",Object(u.a)(this.qd,this.qd.lYd,"onSOpen"),"SAMP",Object(u.a)(this.qd,this.qd.mYd,"onSampOpen"),"SCRIPT",Object(u.a)(this.qd,this.qd.qIf,"onScriptOpen"),"SELECT",Object(u.a)(this.qd,this.qd.wIf,"onSelectOpen"),"SMALL",Object(u.a)(b,b.vYd,"onSmallOpen"),"SPAN",Object(u.a)(h,h.wYd,"onSpanOpen"),"STRIKE",Object(u.a)(r,r.yYd,"onStrikeOpen"),"STRONG",Object(u.a)(z,z.zYd,"onStrongOpen"),"STYLE",Object(u.a)(R,
R.AIf,"onStyleOpen"),"SUB",Object(u.a)(ba,ba.AYd,"onSubOpen"),"SUP",Object(u.a)(ta,ta.CYd,"onSupOpen"),"TABLE",Object(u.a)(Wa,Wa.EYd,"onTableOpen"),"TBODY",Object(u.a)(ub,ub.EIf,"onTbodyOpen"),"TD",Object(u.a)(Ib,Ib.WTc,"onTdOpen"),"TEXTAREA",Object(u.a)($b,$b.GIf,"onTextareaOpen"),"TFOOT",Object(u.a)(fc,fc.HIf,"onTfootOpen"),"TH",Object(u.a)(Kc,Kc.HYd,"onThOpen"),"THEAD",Object(u.a)(ed,ed.IIf,"onTheadOpen"),"TITLE",Object(u.a)(Jd,Jd.LIf,"onTitleOpen"),"TR",Object(u.a)(ge,ge.LYd,"onTrOpen"),"TT",
Object(u.a)(qe,qe.MYd,"onTtOpen"),"U",Object(u.a)(Ve,Ve.NYd,"onUOpen"),"UL",Object(u.a)(Bd,Bd.OYd,"onUlOpen"),"VAR",Object(u.a)(he,he.RYd,"onVarOpen"))}}Object(n.a)(xm,"AHtmlProcessor",null,[]);class jw{constructor(b,h){this.childNodes=b.childNodes;this.zA=h;this.w1e=0;this.hOd=!1}}Object(n.a)(jw,"HtmlProcessorArguments",null,[]);var Uu=d(1010);class at extends xm{constructor(b,h=null){super(b,h);this.ave=null}get Thm(){null==this.ave&&(this.ave=t.AFrameworkApplication.K?t.AFrameworkApplication.K.$("CopyAndPasteTextFromWordWin32FixIsEnabled"):
!1);return this.ave}process(b,h=null){b&&(this.qd.reset(),this.RGi(new jw(b,new rr.a),h))}RGi(b,h){b.childNodes.length&&(b=new Bq.a(h,Object(u.a)(this,this.B9m,"processChild"),b),b.ml("HTML Processing Operation"),h||(b.eh=!0),b.run())}B9m(b,h){const r=h.childNodes[h.w1e];if(3===r.nodeType)return this.qd.EWd(),this.qd.Baa(r.nodeValue,new Rw(r,h.zA.POh())),at.fhc(h);if(1!==r.nodeType)return at.fhc(h);if(!h.hOd){const R=B.a.Wz(r.tagName);if(!at.EVl(r))if(this._prunedElements[R])this.ZMm();else{at.xEm(r);
this.qd.EWd();var z=r.id;const ba=r.tagName,ta=h.zA.POh(),Wa=r.getAttribute?r.getAttribute("class"):null;z=new Uu.a(z,ba,Wa?Wa:"",r.attributes?r.attributes.length:0);z.Rd&&ta.add(z);if(this._voidElements[R])return this.dNm(r,R,ta),at.fhc(h);z=!1;switch(this.OMm(r,R,ta)){case 1:z=!0;break;case 3:return at.fhc(h)}switch(this.qd.Yjf(r)){case 1:z=!0}h.hOd=z;this.RGi(new jw(r,ta),b);if(!b.eh)return!0}}if(h.hOd){if(this.Thm&&!this.a$c[B.a.Wz(r.tagName)])return at.fhc(h);this.qd.onClose()}return at.fhc(h)}static xEm(b){3!==
b.nodeType&&Ri.a.Il(b,"alreadyPasted",!0)}static EVl(b){return 3!==b.nodeType&&Ri.a.Eb(b,"alreadyPasted")}static fhc(b){b.w1e++;b.hOd=!1;return b.w1e<b.childNodes.length}}Object(n.a)(at,"HtmlProcessor",xm,[]);var mz=d(1905);class kw{constructor(){this.lA=0;this.oCc=6;this.Xdl=this.rKh=!1;this.oXe=null;this.vKh=this.uKh=this.ael=this.Zdl=this.sKh=!1;this.progId=null;this.$dl=this.V1b=this.RDd=this.Ydl=this.bel=!1;this.A3m=this.Hac=0;this.sJf=this.platform=null;this.Wpb={}}get z1f(){if(null!==this.oXe)switch(this.oXe){case "XLO":return"Excel Online"}if(this.vKh)return"Word Online";
if(this.uKh||this.sKh)return"PowerPoint Online";if(this.rKh)return"Excel Online";switch(this.progId){case "Word.Document":return"Word";case "OneNote.File":return"OneNote";case "Excel.Sheet":return"Excel";case "PowerPoint.Slide":return"PowerPoint"}return"Other"}Rxm(){v.ULS.sendTraceTag(51406241,307,50,JSON.stringify(this.Llk()))}Sxm(){const b=this.Wpb;for(const r in b){var h=r;const z=b[r];z&&(z.SourceApp=this.z1f,z.Browser=mz.a[this.Hac],z.TagName=h,z.OperationId=this.sJf,v.ULS.sendTraceTag(51406242,
307,50,JSON.stringify(z)))}}dMd(b,h){b&&b.length&&h&&h.length&&(b=b.toLowerCase(),h=h.toLowerCase(),b in this.Wpb||(this.Wpb[b]={}),this.Wpb[b][h]=this.kKl(b,h)+1)}kKl(b,h){if(!(b&&b.length&&h&&h.length&&this.Wpb&&b in this.Wpb))return 0;b=b.toLowerCase();h=h.toLowerCase();return(b=this.Wpb[b])&&h in b?b[h]:0}Llk(){const b={};b.ActionIdFlags=this.lA;b.SourceApp=this.z1f;b.CopySourceBrowser=this.oCc;b.PasteBrowser=this.Hac;b.IsSameBrowserPaste=this.Kjm(this.oCc,this.Hac);b.IsCrossBrowserPaste=this.Qam(this.oCc,
this.Hac);b.IsUncategorizedBrowserPaste=this.umm(this.oCc,this.Hac);b.Platform=this.platform;b.OperationId=this.sJf;return b}Kjm(b,h){return 5===b||6===b?!1:b===h}Qam(b,h){return 6===b?!1:b!==h}umm(b,h){return 5===b&&5===h}}Object(n.a)(kw,"HtmlContentMetadata",null,[]);var Ox=d(1903),xy=d(1020),fq=d(312),bt=d(231),Ev=d(1636),Nr=d(138);class Km{constructor(b,h,r,z,R,ba){this.sMg=!1;this.zbj=this.gue=null;this.eCa=b;this.m$e=this.nOa=null;this.Vi=h;this.transaction=r;this.nY=z;this.rt=R;this.G4=ba}get Gj(){return null!=
this.Iqg?this.Iqg:this.Iqg=Sa.a.instance.Pa("Box4.Styles.StyleSettings")}get K(){return t.AFrameworkApplication.K}get sCe(){return!!this.K&&this.K.$("PasteTextOnlyKeepDestinationStyleIsEnabled")}get UQj(){return!!this.K&&this.K.$("PreserveEopFormattingPasteIsEnabled")}get rF(){return null!=this.dkg?this.dkg:this.dkg=Sa.a.instance.resolve("Box4.IFontStylesGalleryCache")}get isProgressiveStyleEnabled(){return this.Gj&&this.Gj.isProgressiveStyleEnabled}get eR(){return null!=this.Ksg?this.Ksg:this.Ksg=
Sa.a.instance.resolve("Box4.Styles.IWACStyleEditor")}get oc(){return null!=this.ptg?this.ptg:this.ptg=Sa.a.instance.resolve("Box4.Styles.IWACStyleReader")}get paragraphEditor(){return null!=this.qpg?this.qpg:this.qpg=Sa.a.instance.resolve("Box4.IParagraphEditor")}get hd(){return null!=this.$ng?this.$ng:this.$ng=Sa.a.instance.resolve("Box4.List.IListReader")}get Ko(){return null!=this.Kng?this.Kng:this.Kng=Sa.a.instance.resolve("Box4.List.IListEditor")}get Tkb(){return null!=this.mqg?this.mqg:this.mqg=
Sa.a.instance.Pa("Box4.List.ISingleLevelListEditor")}get Nj(){return null!=this.Prg?this.Prg:this.Prg=Sa.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance}get Ph(){return null!=this.usg?this.usg:this.usg=Sa.a.instance.resolve("Box4.TrackChange.ITrackChangeReaderFactory").instance}get Qd(){return null!=this.$rg?this.$rg:this.$rg=Sa.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance}get eW(){return null!=this.Tgg?this.Tgg:this.Tgg=Sa.a.instance.resolve("Box4.CatchUpActivity.IChangeIdEditor")}get TKf(){return null!=
this.Dpg?this.Dpg:this.Dpg=Sa.a.instance.Pa("Box4.IPastedParagraphSpaceHandler")}get gEi(){return!1}get N2i(){return this.K.$("WordEditorAutoResizeImageIsEnabled")}BFh(){}get KNc(){return!1}WDi(b){var h=void 0===this.Vi.lA||null===this.Vi.lA?"not available":Object(Ox.a)(Ev.a,this.Vi.lA);v.ULS.sendTraceTag(8765522,307,50,"PasteSetup: {0} [{1}].",this.Vi.lA,h);v.ULS.shipAssertTag(6305487,307,Xd.SelectionEditor.xf(this.eCa));if(this.ZVd)return v.ULS.sendTraceTag(6305488,307,50,"NothingToPaste"),this.Vi.IXa=
Hf.SelectionFactory.eo(this.eCa),b.ti(Object(u.a)(this,this.Sib,"pasteTeardown")),!0;if(!this.eCa.node)return v.ULS.sendTraceTag(572330334,307,10,"Something's wrong! The IP is pointing to a null node. Aborting paste"),!1;h=new Nd.GraphIterator;h.set(this.eCa.node);Xd.SelectionEditor.Jt(h);ag.OutlineElementNavigator.Zd(h);this.zbj=h.origin;if(this.gEi)return h.it(10),this.BFh(h,b),b.ti(Object(u.a)(this,this.AOn,"setSelectionAfterPastingOutlines")),!0;this.nY&&this.nY.vPm(this.eCa);if(!this.W0n(this.eCa))return this.Vi.FQ&&
(this.Vi.FQ.fail("SplitLine Failed",!0),this.Vi.failed=!0),this.Vi.IXa=Hf.SelectionFactory.eo(this.eCa),b.ti(Object(u.a)(this,this.Sib,"pasteTeardown")),!0;const r=new eg.a;r.fd(h);ag.OutlineElementNavigator.Vr(r,!1,!1);this.nOa=new xy.a(h);this.m$e=new xy.a(r);b.ti(Object(u.a)(this,this.n3m,"pasteExecution"));return!0}n3m(b){mf.a.mark(5568);this.AFh(b);let h=Object(u.a)(this,this.RGm,"mergeAfterPaste");if(this.Jei){const r=this.M3i();r&&(h=Object(u.a)(this,this.Sib,"pasteTeardown"));v.ULS.sendTraceTag(40387030,
307,50,"ExecutePaste: shouldSkipMerge: {0}.",r)}b.ti(h);return!0}M3i(){return!1}get Jei(){return this.K.$("PptCcpFix2IsEnabled")}get oTn(){return this.K.$("CopyAndPasteOneParagraphIndentationFixIsEnabled")}RGm(b){mf.a.mark(5569);var h=new Nd.GraphIterator;this.nOa.restore(h);Km.F6||(this.nOa=null);var r=new Nd.GraphIterator;this.m$e.restore(r);this.m$e=null;v.ULS.shipAssertTag(6305489,307,vg.OutlineElementReader.Nh(h));v.ULS.shipAssertTag(6305490,307,vg.OutlineElementReader.Nh(r));ag.OutlineElementNavigator.De(h);
var z=ie.ParagraphReader.zh(h)?ie.ParagraphReader.textLength(h.currentNode):0;ag.OutlineElementNavigator.Zd(h);ag.OutlineElementNavigator.De(r);v.ULS.shipAssertTag(6305491,307,ie.ParagraphReader.zh(r));var R=ie.ParagraphReader.textLength(r.currentNode);ag.OutlineElementNavigator.Zd(r);let ba=this.l0c;var ta=new eg.a;ta.fd(h);ag.OutlineElementNavigator.Vr(ta,!1,!1);var Wa=ta.currentNode===r.currentNode,ub=!!this.Vi&&!!(this.Vi.lA&8192);let Ib=!1;!ub&&this.Vi.Cd&&Object(nb.a)(Ei.DictionaryPropertySet,
this.Vi.Cd)&&(ub=(ub=this.Vi.Cd.Og(od.a.Oac))&&""!==ub?!0:!1);if(Wa){z=Nd.GraphIterator.$a(h.currentNode);ie.ParagraphReader.xu(ag.OutlineElementNavigator.De(z))||(h=r);h.currentNode.id!==r.currentNode.id&&(v.ULS.sendTraceTag(40691869,307,50,"MergeAfterPaste NothingPasted: precedingIteratorIsList: {0}, followingIteratorIsList: {1}",mc.ListReader.ai(h),mc.ListReader.ai(r)),ub=Km.Wg.merge(h,r,!0,ub),v.ULS.shipAssertTag(6305492,307,ub));r=h;var $b=!0}else{Wa=!!(this.Vi.lA&4);$b=this.Qd.ng&&Wa&&this.Vi.f_a;
this.TKf&&this.Vi&&!Wa&&(this.TKf.j3h(h,!1),this.TKf.j3h(r,!0));ag.OutlineElementNavigator.De(ta);Wa=ie.ParagraphReader.zh(ta)?ie.ParagraphReader.textLength(ta.currentNode):0;ag.OutlineElementNavigator.Zd(ta);this.qek(ta,h,r);var fc=new eg.a;fc.fd(ta);ag.OutlineElementNavigator.Vr(fc,!1,!1);Km.F6&&fc.currentNode.id===r.currentNode.id&&(this.sMg=!0);if(this.eW.DJa||this.oTn)if(fc.Cn.id!==r.Cn.id){for(;ta.currentNode.id!==r.currentNode.id;)ag.OutlineElementNavigator.De(ta,!1),this.eW.kEa(Qe.a.create(ta.currentNode)),
ta.mc(),ag.OutlineElementNavigator.Vr(ta,!1,!1);ta.fd(h);ag.OutlineElementNavigator.Vr(ta,!1,!1)}else Ib=!0;this.nY&&({l0c:ba,Jsa:ta}=this.nY.v$m(h,r,ba,ta));if(this.Vi.j4d&&(v.ULS.shipAssertTag(6305493,307,this.Vi.d7b),fc=new Nd.GraphIterator,fc.fd(ta),fc=ag.OutlineElementNavigator.De(fc))){var Kc=this.Vi.j4d.Yf(fc.qa.J(0));fc.qa.J(0).formatting=Kc}fc=0;ub&&this.sCe&&(fc=1);Kc=this.LTn(h,ta,fc);this.Vi.V9d=null;if(this.Vi.eEa||this.Vi.IQa)this.Vi.V9d=this.RJl(Kc?h.currentNode:ta.currentNode,Kc);
var ed=!1;Kc&&(ed=mc.ListReader.ai(h),v.ULS.sendTraceTag(40691870,307,50,"MergeAfterPaste MergeBeforeContent, precedingIsList: {0}, firstPastedOeIsList: {1}",ed,mc.ListReader.ai(r)),this.gue=ed=Km.Wg.merge(h,ta,!0,ub,r,void 0,Ib,$b,this.sCe),this.MTn(h,fc)&&this.oHm(h,r,fc,ub));fc=Km.z3m.O3l(h,ta,r,z,ed,this.KNc);var Jd=!1;if(ba){const ge=new eg.a;ge.fd(r);ag.OutlineElementNavigator.R2(ge,!1,!1);Jd=mc.ListReader.ai(ge);const qe=mc.ListReader.ai(r);$b=Km.Wg.merge(ge,r,!0,ub,void 0,!0,void 0,$b,this.sCe,
this.UQj);v.ULS.sendTraceTag(40691871,307,50,"MergeAfterPaste MergeAfterContent, lastPastedOeIsList: {0}, followingIteratorIsList: {1}, MergeSucceeded: {2}",Jd,qe,$b?"True":"False, will cause IP to reset to zero.");r=(Jd=$b)?ge:r}else $b=!1,v.ULS.sendTraceTag(51463189,307,50,"No merge, will cause IP to reset to zero.");this.eW.DJa&&Ib&&(Kc&&!this.gdm(fc,ed)?(ta=new Nd.GraphIterator,ta.fd(h),h=ag.OutlineElementNavigator.De(ta),this.eW.Sna(h,z,z+Wa)):ba&&!this.Cfm(fc,Jd)?(h=new Nd.GraphIterator,h.fd(ta),
h=ag.OutlineElementNavigator.De(h),this.eW.Sna(h,0,Wa)):(h=new Nd.GraphIterator,h.fd(ta),h=ag.OutlineElementNavigator.De(h),this.eW.kEa(Qe.a.create(h))));this.F6m(fc);this.isProgressiveStyleEnabled&&!ub&&this.rF.y$m(fc)}v.ULS.shipAssertTag(6305494,307,r.Rd);ub=ag.OutlineElementNavigator.De(r);R=$b?ie.ParagraphReader.textLength(ub)-R:0;h=!1;Object(nb.a)(93,this.Vi.Cd)&&(h=this.Vi.Cd.ia(od.a.P$,!1));this.Vi.IXa=h?Hf.SelectionFactory.DN(ub,R-1,R):Hf.SelectionFactory.xe(ub,R);xg.a.instance.J(10)&&this.Vi&&
this.Vi.d7b&&ie.ParagraphReader.nc(ub)&&this.Vi.pZd&&((R=this.Vi.pZd.F3n)&&this.eR.oM(R,ub,!0),(R=this.Vi.pZd.k2m)&&this.paragraphEditor.cdh(ub,R));b.ti(Object(u.a)(this,this.Sib,"pasteTeardown"));return!0}gdm(b,h){return!h&&!!b&&vg.OutlineElementReader.Nh(b.Jsa)&&vg.OutlineElementReader.gbb(b.Jsa)}Cfm(b,h){return!h&&!!b&&vg.OutlineElementReader.Nh(b.Rgb)&&vg.OutlineElementReader.gbb(b.Rgb)}F6m(b){Km.HFi&&b&&Km.HFi.t$m(b)}LTn(b,h,r){mc.ListReader.ai(b)?(Km.ae.IDb&&this.Tkb&&this.Tkb.Ymf(b),h=mc.ListReader.ai(h)?
this.c3i:!0):vg.OutlineElementReader.isEmpty(b,!0)&&!r?(Km.Wg.iXa(b),h=!1):h=mc.ListReader.rr||!mc.ListReader.ai(h);this.nY&&(h=this.nY.Ouk(b,h));return h}MTn(b,h){return mc.ListReader.ai(b)||1===h?!0:!1}oHm(b,h,r,z){const R=mc.ListReader.ai(b);if(R){if(z=new eg.a,z.fd(b),ag.OutlineElementNavigator.Vr(z,!1,!1),z.Cn.id!==h.Cn.id){r=this.hd.Hs(b);this.hd.jD(b);var ba=b.currentNode.ia(yc.a.listID,0);b.mc();var ta=this.hd.g6i,Wa=!0;for(r.Tz=zi.a.Yi;z.currentNode.id!==h.currentNode.id;){if(!ta||!vg.OutlineElementReader.kVn(z))if(!mc.ListReader.ai(z))({LBa:r}=
this.Ko.ura(r.propertySet,z,r)),Wa=!1;else if(R){Wa=this.hd.kff(z);var ub=this.hd.Pw(b.currentNode,ba,Wa);ub=ub?fq.a.M1(ub,null):r;Wa=fq.a.HP(ub.listType,r.listStyle,null,0,Wa,"","");Wa.Uhb=b.currentNode;this.Ko.iNn(Wa);this.Ko.a7d(z,!0);Wa=!1}ag.OutlineElementNavigator.Vr(z,!1,!1)}ta&&Wa&&this.Ko.Zeh()}}else if(1===r)for(r=new eg.a,r.fd(b),ag.OutlineElementNavigator.De(r),b=ie.ParagraphReader.zh(r)?r.currentNode:null,ba=this.oc.nId(r),ag.OutlineElementNavigator.Zd(r),ag.OutlineElementNavigator.Vr(r,
!1,!1);r.currentNode.id!==h.currentNode.id;)ag.OutlineElementNavigator.De(r),ta=ie.ParagraphReader.zh(r)?r.currentNode:null,ag.OutlineElementNavigator.Zd(r),ta&&b&&z&&(ba&&this.eR.oM(ba,ta,!0),this.G4.Zqi(b,ta,R),this.G4.z0a(b,ta,1,!0)),ag.OutlineElementNavigator.Vr(r,!1,!1)}qek(b,h,r){var z=!1;if(this.Qd.ng)if(Nr.a.fE)z=!0;else{var R=!1;this.nY&&(R=h.currentNode,R=this.nY.Whm(R)||this.nY.Dsf(R));R?this.Qd.r1a=4:z=!0}if(z){for(;b.currentNode!==r.currentNode;){ag.OutlineElementNavigator.De(b,!1);z=
this.Ph.$0c(Qe.a.create(b.currentNode));let ba;({type:ba}=z.PId()).returnValue&&this.Qd.zs(ba);for(R=0;R<z.length;R++){let ta;const Wa=({IQd:ta}=z.getContext(R)).returnValue;ta&&(Km.hyperlinkEditor.Ohb(Wa,1),this.Nj.zkb(Wa,1,null,!0))}b.mc();ag.OutlineElementNavigator.Vr(b,!1,!1)}b.fd(h);ag.OutlineElementNavigator.Vr(b,!1,!1)}}RJl(b,h){b=Nd.GraphIterator.$a(b);ag.OutlineElementNavigator.De(b);return ie.ParagraphReader.nc(b.currentNode)?(h=h?ie.ParagraphReader.textLength(b.currentNode):0,Hf.SelectionFactory.xe(b.currentNode,
h)):Ii.TableReader.fX(b.currentNode)?Hf.SelectionFactory.jr(b.currentNode):null}AOn(b){const h=Nd.GraphIterator.$a(this.zbj);h.oE(1);this.Vi.IXa=Hf.SelectionFactory.wo(h.currentNode,!1);b.ti(Object(u.a)(this,this.Sib,"pasteTeardown"));return!0}Sib(){var b=void 0===this.Vi.lA||null===this.Vi.lA?"not available":Object(Ox.a)(Ev.a,this.Vi.lA);v.ULS.sendTraceTag(8765523,307,50,"PasteTeardown: {0} [{1}].",this.Vi.lA,b);v.ULS.shipAssertTag(6305497,307,!!this.Vi.IXa);this.KNc?Object(Lb.a)("ExternalPasteAction",
!0):Object(Lb.a)("InternalPasteAction",!0);Km.F6&&this.nOa&&(b=new Nd.GraphIterator,this.nOa.restore(b),this.nOa=null,this.TUl(b));this.transaction.dispose();b=this.rt.wv;if(!b.ze||!b.editingView.Dj)return!1;b.editingView.$6n();return!1}TUl(b){if(b){if(this.KNc&&Ii.TableReader.Yw(b)&&this.sMg){if(null!=this.gue&&0==this.gue){var h=new eg.a;h.fd(b);ag.OutlineElementNavigator.Vr(h,!1,!1);b.fd(h)}h=eq.a.Aun(b);let r=ie.ParagraphReader.en(h);h&&r&&(this.Vi.IXa=Hf.SelectionFactory.xe(r,0),b=Nd.GraphIterator.$a(h))}else Km.Rhm&&
eq.a.t3m(b);b&&Ii.TableReader.Yw(b)&&Ke.returnToContainingCell(b)&&eq.a.Y9j(b.currentNode)}else v.ULS.sendTraceTag(525361991,3022,50,"Preceding iterator should not be null.")}rSn(b,h){const r=new Nd.GraphIterator;r.fd(b);b=ag.OutlineElementNavigator.De(r);h=ie.ParagraphReader.nc(b)&&h===ie.ParagraphReader.textLength(b);v.ULS.sendTraceTag(50384992,307,50,"IsPasteAtEndofParagraph: {0}",h);return h}W0n(b){v.ULS.shipAssertTag(6305498,307,Xd.SelectionEditor.xf(b));const h=Nd.GraphIterator.$a(b.node);var r=
h.vd();ag.OutlineElementNavigator.Zd(h);r&&b.Rd||v.ULS.sendTraceTag(40425481,307,15,"sourceOE GraphIterator setup. {0}",{["tryToRootAtOutlineAncestorSuccess"]:r,["ipContextNodeType"]:b.node.type,["isValidIpContext"]:b.Rd});if(!vg.OutlineElementReader.Nh(h)&&(v.ULS.sendTraceTag(594072134,307,10,"sourceOE is not an OutlineElement"),this.K.$("AbortClipboardOperationWhenFailToRootAtOEIsEnabled")))return!1;r=Km.Wg.xta(h,!0);const z=this.rSn(h,b.cpBegin);Km.Wg.mba(h,r,b,!1,!1,!0,z);return!0}static get hyperlinkEditor(){return null!=
Km.Rkg?Km.Rkg:Km.Rkg=Sa.a.instance.resolve("Box4.IHyperlinkEditor")}static get Te(){return ne.PageReader.instance}static get Wg(){return null!=Km.Bog?Km.Bog:Km.Bog=Sa.a.instance.resolve("Box4.IOutlineElementEditor")}static get ae(){return bt.a.getInstance()}static get Qb(){return null!=Km.ujg?Km.ujg:Km.ujg=Sa.a.instance.Pa("Box4.IFeatureHelper")}static get HFi(){return null!=Km.Fpg?Km.Fpg:Km.Fpg=Sa.a.instance.resolve("Box4.Actors.IPastedContentsProcessorPostMergeAfterPaste")}static get z3m(){return null!=
Km.Cpg?Km.Cpg:Km.Cpg=Sa.a.instance.resolve("Box4.Actors.PastedContentsPostProcessorHelper")}static get F6(){null==this.z8&&(t.AFrameworkApplication.Hf("he991617;3eed2178"),this.z8=t.AFrameworkApplication.K?t.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.TableCCPNewExperienceIsEnabled",!1):!1);return this.z8}static get Rhm(){null==this.$ue&&(t.AFrameworkApplication.Hf("PasteTableBelowTableNewExperience;PasteTableBelowTableNewExperienceCf"),this.$ue=t.AFrameworkApplication.K?
t.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.PasteTableBelowTableNewExperienceIsEnabled",!1):!1);return this.$ue}}Km.z8=null;Km.$ue=null;Object(n.a)(Km,"APasteExecutionManager",null,[]);class Sw{constructor(b){this.Fj=b}reset(){this.Fj.reset()}get yDc(){return this.Fj.yDc}Baa(b,h){this.Fj.Baa(b,h)}aDa(b){this.Fj.aDa(b)}tib(b){this.Fj.tib(b)}Gua(b){this.Fj.Gua(b)}XCa(b){this.Fj.XCa(b)}PNa(b,h){this.Fj.PNa(b,h)}ONa(){this.Fj.ONa()}MF(b){this.Fj.MF(b)}LF(){this.Fj.LF()}qib(){this.Fj.qib()}pib(){this.Fj.pib()}dDa(b){this.Fj.dDa(b)}bDa(){this.Fj.bDa()}TNa(b){this.Fj.TNa(b)}cDa(){this.Fj.cDa()}a1a(b){this.Fj.a1a(b)}Aaa(b){this.Fj.Aaa(b)}xaa(){this.Fj.xaa()}zaa(b){this.Fj.zaa(b)}yaa(){this.Fj.yaa()}waa(b){this.Fj.waa(b)}vaa(){this.Fj.vaa()}UNa(b,
h){this.Fj.UNa(b,h)}Y0a(){this.Fj.Y0a()}}Object(n.a)(Sw,"AHtmlNormalizer",null,[204,205]);class Tw extends Sw{constructor(b){super(b);this.NI=!1}Baa(b,h){this.NI?this.iM.wL(()=>{this.ONf(b,h)}):this.ONf(b,h)}ONf(b,h){this.Fj.Baa(b,h)}aDa(b){this.NI?this.iM.wL(()=>{this.qNf(b)}):this.qNf(b)}qNf(b){this.Fj.aDa(b)}Gua(b){this.NI?this.iM.wL(()=>{this.AVc(b)}):this.AVc(b)}AVc(b){this.Fj.Gua(b)}XCa(b){this.NI?this.iM.wL(()=>{this.pNf(b)}):this.pNf(b)}pNf(b){this.Fj.XCa(b)}PNa(b,h){this.NI?this.iM.wL(()=>
{this.lNf(b,h)}):this.lNf(b,h)}lNf(b,h){this.Fj.PNa(b,h)}ONa(){this.NI?this.iM.wL(Object(u.a)(this,this.kNf,"processAnchorEnd")):this.kNf()}kNf(){this.Fj.ONa()}MF(b){this.NI?this.iM.wL(()=>{this.ANf(b)}):this.ANf(b)}ANf(b){this.Fj.MF(b)}LF(){this.NI?this.iM.wL(Object(u.a)(this,this.zNf,"processParagraphEnd")):this.zNf()}zNf(){this.Fj.LF()}qib(){this.NI?this.iM.wL(Object(u.a)(this,this.CNf,"processPreFormattedTextStart")):this.CNf()}CNf(){this.Fj.qib()}pib(){this.NI?this.iM.wL(Object(u.a)(this,this.BNf,
"processPreFormattedTextEnd")):this.BNf()}BNf(){this.Fj.pib()}dDa(b){this.NI?this.iM.wL(()=>{this.uNf(b)}):this.uNf(b)}uNf(b){this.Fj.dDa(b)}bDa(){this.NI?this.iM.wL(Object(u.a)(this,this.rNf,"processListEnd")):this.rNf()}rNf(){this.Fj.bDa()}TNa(b){this.NI?this.iM.wL(()=>{this.tNf(b)}):this.tNf(b)}tNf(b){this.Fj.TNa(b)}cDa(){this.NI?this.iM.wL(Object(u.a)(this,this.sNf,"processListItemEnd")):this.sNf()}sNf(){this.Fj.cDa()}Aaa(b){this.NI?this.iM.wL(()=>{this.NNf(b)}):this.NNf(b)}NNf(b){this.Fj.Aaa(b)}xaa(){this.NI?
this.iM.wL(Object(u.a)(this,this.KNf,"processTableEnd")):this.KNf()}KNf(){this.Fj.xaa()}zaa(b){this.NI?this.iM.wL(()=>{this.MNf(b)}):this.MNf(b)}MNf(b){this.Fj.zaa(b)}yaa(){this.NI?this.iM.wL(Object(u.a)(this,this.LNf,"processTableRowEnd")):this.LNf()}LNf(){this.Fj.yaa()}waa(b){this.NI?this.iM.wL(()=>{this.JNf(b)}):this.JNf(b)}JNf(b){this.Fj.waa(b)}vaa(){this.NI?this.iM.wL(Object(u.a)(this,this.INf,"processTableCellEnd")):this.INf()}INf(){this.Fj.vaa()}UNa(b,h){this.NI?this.iM.wL(()=>{this.vNf(b,
h)}):this.vNf(b,h)}vNf(b,h){this.Fj.UNa(b,h)}Y0a(){this.NI?this.iM.wL(Object(u.a)(this,this.kHi,"processMathEnd")):this.kHi()}kHi(){this.Fj.Y0a()}}Object(n.a)(Tw,"AQueuingHtmlNormalizer",Sw,[]);var Fv=d(1853);class Fo{constructor(){this.RDe=new Fv.a}wL(b){this.RDe.enqueue(b)}flush(b=!1){for(b&&this.t6d();!this.RDe.isEmpty;)this.RDe.dequeue()();b&&this.w4d()}t6d(){}w4d(){}}Object(n.a)(Fo,"QueuedEventManager",null,[]);class no extends Fo{constructor(b){super();this.id=void 0;this.J1e=null;this.aPd=
!1;this.Uua="";this.$Od=this.NPd=!1;this.z1e=this.B_b=null;this.ySc=0;this.oOc=this.HPc=this.luf=!1;this.table=null;this.tDf=0;this.IY=b}get Fyc(){return!!this.table}t6d(){this.IY.pac.push(this.IY.currentState);this.IY.currentState=this}w4d(){this.IY.currentState=this.IY.pac.pop()}}no.nextId=void 0;Object(n.a)(no,"ContentState",Fo,[]);var vt=d(314);class mA{constructor(b,h,r){this.colSpan=b.colSpan;this.rowSpan=b.rowSpan;this.width=b.width;this.height=b.height;this.D_a=b.D_a;this.shadingColor=b.shadingColor;
this.verticalAlignment=b.verticalAlignment;this.bha=b.bha;this.X$d=b.X$d;this.E7b=b.E7b;this.B5=b.B5;this.contents=r;this.zQl=h}}Object(n.a)(mA,"TableCell",null,[]);var nA=d(1074),nz=d(1075),Fs=d(1078),Gs=d(1079),Vu=d(1077);class oz extends Fo{constructor(b,h){super();this.IY=b;this.t2g=new rr.a;this.Zoa=new rr.a;this.aze=[];this.Mkd=[];this.sGa=-1;this.zRa=0;this.tIj=h.zai;this.sIj=h.g$l;this.WWj=h.U3f;this.Bp=h.width;this.eMg=h.D_a;this.KFj=new vt.a(new Uu.a(h.Z6.h6h,h.Z6.zLd),h.zA,h.bna,h.cultureName,
h.Kya);this.rHj=h.iMd;this.wnd=h.styleId;this.bXj=h.tableLook}get Fj(){return this.IY.Fj}S7m(b){this.sGa++;this.t2g.add(b);this.Mkd[this.sGa]=b.height;this.zRa=0}get tPk(){for(;this.zRa>=this.Zoa.count;)this.Zoa.add(Array(this.sGa+1));return this.Zoa.J(this.zRa)}p1j(b,h,r,z,R,ba,ta){if(0>this.sGa)return!1;for(;this.aze[this.zRa]>=this.sGa;)this.zRa++;b=new mA(b,new vt.a(h,r,z,R,ba),ta);this.tPk[this.sGa]=b;if(1<b.rowSpan)for(h=this.sGa+b.rowSpan-1,z=this.zRa,r=this.zRa+b.colSpan-1;z<=r;z++)this.aze[z]>=
h||(this.aze[z]=h);this.zRa+=b.colSpan;this.Mkd[this.sGa]<b.height&&(this.Mkd[this.sGa]=b.height);return!0}t6d(){this.IY.currentState.table=this}w4d(){this.IY.currentState.table=null}fJh(){this.flush(!0);const b=this.sGa+1;var h=Array(b);for(var r=0;r<b;r++)h[r]=Array(this.Zoa.count);r=!0;var z=0;for(var R=0;R<this.Zoa.count;R++){var ba=this.Zoa.J(R),ta=!0;for(var Wa=0;Wa<b;Wa++){var ub=ba[Wa];ub&&(ta=!1,h[Wa][R+z]=new Fs.a(ub.colSpan,ub.rowSpan,ub.width,ub.height,void 0,void 0,void 0,void 0,ub.D_a,
ub.E7b))}ta?(this.Zoa.removeAt(R),R--,++z):r=!1}if(!r){(h=this.eMg?this.IY.qjh(h,this.Bp/100):this.IY.qjh(h))&&h.length!==this.Zoa.count&&(h=null);this.IY.tcb(!0);this.IY.lvd();this.Fj.Aaa(new Vu.a(b,this.Zoa.count,this.Bp,this.eMg,h,this.tIj,this.sIj,this.WWj,this.rHj,this.wnd,this.bXj,this.KFj));for(h=0;h<b;h++){r=this.t2g.J(h);this.Fj.zaa(new Gs.a(this.Mkd[h],new vt.a(r.Z6,r.zA,r.bna,r.cultureName,r.Kya)));for(r=0;r<this.Zoa.count;r++){z=this.Zoa.J(r)[h];var Ib=!!this.wnd&&""!==this.wnd&&"Custom"!==
this.wnd;R=z?z.colSpan:0;ba=z?z.rowSpan:0;ta=z?z.width:0;Wa=z?z.height:0;ub=z?z.B5:0;const $b=z?z.D_a:!1,fc=z&&(65536&ub||!Ib)?z.shadingColor:"",Kc=z?z.verticalAlignment:0,ed=z?z.E7b:!1;Ib=z?this.IY.YAl(z.bha,r,h,this.Zoa,Ib,z.B5):new nA.a;const Jd=z?z.X$d:new nz.a,ge=z?z.zQl:null;this.Fj.waa(new Fs.a(R,ba,ta,Wa,fc,Kc,Ib,Jd,$b,ed,ub,new vt.a(ge?ge.Z6:null,ge?ge.zA:null,ge?ge.bna:null,ge?ge.cultureName:null,ge?ge.Kya:null)));z&&!z.E7b&&(z.contents.t6d(),z.contents.flush(),this.IY.tcb(!1),this.IY.lvd(),
z.contents.w4d());this.Fj.vaa()}this.Fj.yaa()}this.Fj.xaa();this.IY.currentState.oOc=!1;this.IY.rEh(!1)}}}Object(n.a)(oz,"NormalizedTable",Fo,[]);class wt{constructor(b=!1,h=!1){this.dJj=b;this.Z0=h}get Rem(){return this.dJj}get nba(){return this.Z0}}Object(n.a)(wt,"HtmlNormalizerSettings",null,[234]);var yy=d(819);class lg extends Tw{constructor(b,h=null){super(b);this.pac=new yy.a;this.$Qb=h||new wt}reset(){super.reset();this.currentState=new no(this);this.pac.clear();this.NI=!1}get iM(){return this.currentState&&
this.currentState.Fyc?this.currentState.table:this.currentState}cBd(b=!1){this.currentState.aPd||(this.lvd(),this.Fj.MF(this.currentState.J1e),this.currentState.aPd=!0,this.currentState.oOc=!1);b||!this.currentState.B_b||this.currentState.$Od||(this.Fj.PNa(this.currentState.B_b,this.currentState.z1e),this.currentState.$Od=!0)}qFc(){this.currentState.$Od&&(this.Fj.ONa(),this.currentState.$Od=!1)}f3k(){this.currentState.aPd&&(this.Fj.LF(),this.currentState.aPd=!1,this.currentState.Uua="")}rEh(b){this.currentState.HPc&&
(this.currentState.oOc?b||(this.Fj.MF(null),this.Fj.LF(),this.Fj.cDa(),this.currentState.HPc=!1):(this.Fj.cDa(),this.currentState.HPc=!1,this.currentState.oOc=!0))}tcb(b){this.qFc();this.f3k();this.rEh(b)}b_m(b){this.Fj.dDa(new oq.a(2,1,b));this.currentState.ySc++;this.currentState.luf=!0}lvd(){!this.currentState.HPc&&this.currentState.luf&&(this.Fj.bDa(),this.currentState.ySc--,this.currentState.luf=!1)}ONf(b,h){b=this.gMm(b);if(""!==b)if(this.cBd(),this.currentState.NPd)this.PNf(b,h);else{b=b.split(lg.qok);
for(let r=0;r<b.length-1;r++)this.PNf(b[r],h),this.Fj.tib(h);this.PNf(b[b.length-1],h)}}vNf(b,h){""!==b&&(this.cBd(),this.Fj.UNa(b,h))}qNf(b){this.$Qb.nba||this.qFc();this.cBd(!0);this.Fj.aDa(b)}pNf(b){this.currentState.Fyc||this.Fj.XCa(b)}AVc(b){this.currentState.B_b&&(b.href=this.currentState.B_b);super.AVc(b)}lNf(b,h){this.qFc();this.currentState.B_b=b;this.currentState.z1e=h}kNf(){this.qFc();this.currentState.B_b=null;this.currentState.z1e=null}ANf(b){this.currentState.J1e=b;this.tcb(!0)}zNf(){this.currentState.J1e=
null;this.tcb(!0)}CNf(){this.currentState.NPd=!0}BNf(){this.currentState.NPd=!1}uNf(b){this.tcb(!1);this.lvd();this.Fj.dDa(b);this.currentState.ySc++}rNf(){this.tcb(!1);this.Fj.bDa();this.currentState.ySc--}tNf(b){this.tcb(!1);this.currentState.ySc||this.b_m(b);this.Fj.TNa(b);this.currentState.HPc=!0;this.currentState.oOc=!0}sNf(){this.tcb(!1)}Aaa(b){this.currentState.Fyc||(this.NI=!0,this.currentState.table=new oz(this,b))}NNf(){}xaa(){if(this.currentState.table){var b=this.currentState.table;this.currentState.table=
null;this.pac.isEmpty?(this.NI=!1,b.fJh()):this.iM.wL(Object(u.a)(b,b.fJh,"flushTable"))}}KNf(){}zaa(b){this.currentState.Fyc&&this.currentState.table.S7m(b)}MNf(){}yaa(){}LNf(){}waa(b){let h=!1;if(this.currentState.Fyc){const r=new no(this);this.currentState.table.p1j(b,new Uu.a(b.Z6.h6h,b.Z6.zLd),b.zA,b.bna,b.cultureName,b.Kya,r)?(this.pac.push(this.currentState),this.currentState=r):h=!0}else h=!0;h&&this.currentState.tDf++}JNf(){}vaa(){0<this.currentState.tDf?this.currentState.tDf--:this.currentState=
this.pac.pop()}INf(){}qjh(b,h=1){if(!b)return null;const r=b.length;if(!r)return null;const z=b[0].length;for(var R=1;R<r;R++)if(b[R].length!==z)return null;R=Array(z+1);R[0]=0;const ba=Array(z+1);for(var ta=0;ta<ba.length;ta++)ba[ta]=!1;ta=new Ua.a;for(let ub=0;ub<z;ub++){for(var Wa=0;Wa<r;Wa++){const Ib=b[Wa][ub];if(Ib&&0<Ib.width){const $b=Math.min(ub+Ib.colSpan,z);R[$b]=R[ub]+Ib.width*(Ib.D_a?h:1);ba[$b]=!0}}if(ba[ub+1]){Wa=R[ub+1]-R[ub];if(0>=Wa)return null;ta.add(Wa)}else R[ub+1]=R[ub]}return ta.toArray()}gFm(b,
h){1&h||(b.borderTopStyle=12);16&h||(b.borderRightStyle=12);256&h||(b.borderBottomStyle=12);4096&h||(b.borderLeftStyle=12);return b}YAl(b,h,r,z,R,ba){if(!b)return null;R&&(b=this.gFm(b,ba));if(0>r||0>h||h>z.count-1)return b;0<=h-1&&r<=z.J(h-1).length-1&&1===b.borderLeftStyle&&(R=z.J(h-1)[r])&&1!==R.bha.borderRightStyle&&(b.borderLeftStyle=R.bha.borderRightStyle,b.borderLeftColor=R.bha.borderRightColor,b.borderLeftWidth=R.bha.borderRightWidth);0<=r-1&&r<=z.J(h).length-1&&1===b.borderTopStyle&&(h=z.J(h)[r-
1])&&1!==h.bha.borderBottomStyle&&(b.borderTopStyle=h.bha.borderBottomStyle,b.borderTopColor=h.bha.borderBottomColor,b.borderTopWidth=h.bha.borderBottomWidth);return b}gMm(b){this.currentState.NPd||(b=this.$Qb.Rem?b.replace(lg.IZl," "):b.replace(lg.HZl," "));b.startsWith(" ")&&(this.currentState.Uua.endsWith(" ")||""===this.currentState.Uua)&&(b=B.a.substring(b,1,b.length));return b}PNf(b,h){""!==b&&(this.Fj.Baa(b,h),this.currentState.Uua+=b)}}lg.HZl=RegExp("[ \t\f\u200b\r\n]+","g");lg.IZl=RegExp("[ \f\u200b\r\n]+",
"g");lg.qok="\t";Object(n.a)(lg,"DefaultHtmlNormalizer",Tw,[]);class ct extends lg{constructor(b,h,r){super(b,r);this.qHg=!1;this.aqb=h}static vbm(b){return t.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.DesignerImageUrl",!1)&&b?(b=ct.lUk.exec(b))&&0<b.length:!1}AVc(b){this.aqb.Sac&&(t.AFrameworkApplication.Ama?this.qHg||(b=new te.StandardDialog,b.Fd=0,b.Ve(1,CommonUIStrings.l_DialogClose),b.Pv(CommonUIStrings.l_DefaultDialogTitle,Box4Intl.Box4Strings.l_SignInToPasteImages,
1,null),this.qHg=!0):this.aqb.oqi?this.aqb.BUd=!0:b.src&&""!==b.src?Rc.a.p$(b.src)!==Rc.a.p$(window.location.href)||ct.vbm(b.src)?b.src.startsWith("data:")&&19922944<b.src.length?t.AFrameworkApplication.ya.processAction(Fb.a.bEi,2):b.src.startsWith("webkit-fake-url")?t.AFrameworkApplication.ya.processAction(Fb.a.aEi,2):(this.qFc(),this.cBd(!0),this.Fj.Gua(b)):t.AFrameworkApplication.ya.processAction(Fb.a.dEi,2):t.AFrameworkApplication.ya.processAction(Fb.a.cEi,2))}}ct.lUk=RegExp(".\\/we\\/s\\/\\d+_resources\\/\\d+\\/\\D.+(.png|.jpg)");
Object(n.a)(ct,"Box4HtmlNormalizer",lg,[]);class zy{constructor(b,h,r,z,R,ba,ta,Wa,ub,Ib,$b){this.htmlProcessor=b;this.wmf=h;this.ftk=r;this.Qlj=z;this.Udl=R;this.EEn=ba;this.FEn=ta;this.yLd=Wa;this.BZl=ub;this.DZl=Ib;this.jsm=$b}}Object(n.a)(zy,"ExecutePasteArguments",null,[]);class Px extends Km{constructor(b,h,r,z,R,ba,ta,Wa,ub,Ib,$b,fc,Kc,ed,Jd,ge){super(h,r,z,Ib,fc,Jd);this.via=null;this.$Lm=qe=>{this.Xbd.Jji(this.Lia)&&t.AFrameworkApplication.Hl("Microsoft.Office.Web.SessionSettings.IWacWordRemoveSpacesAfterEndFragmentSettings");
this.bVj&&this.Xbd.kbo(this.Lia);qe.ti(this.W7m);return!0};this.W7m=qe=>{if(this.nUj){const Ve=this.Lia.getElementsByTagName("style");if(Ve&&0<Ve.length){v.ULS.sendTraceTag(41211203,307,50,"Detect <style> tags in pasted content and start converting to inline style.");for(let Bd=0;Bd<Ve.length;Bd++)this.fpe.TFk(this.Lia,Ve[Bd]),Ve[Bd]&&(Ve[Bd].parentNode.removeChild(Ve[Bd]),Bd--)}}qe.ti(this.hGk);return!0};this.hGk=(qe,Ve)=>{this.HMe.value.create(Ve.Qlj).process(this.Lia,qe);(Ve=Sa.a.instance.Pa("Box4.IFeatureHelper"))&&
Ve.isFeatureEnabled(11)?qe.ti(this.mFk):qe.ti(this.dHi);return!0};this.mFk=(qe,Ve)=>{(new Mx(Ve.ftk)).process(this.Lia,qe);qe.ti(this.dHi);return!0};this.dHi=(qe,Ve)=>{Ve.htmlProcessor.process(this.Lia,qe);qe.ti(Ve.wmf&&Ve.wmf.Sac?this.DIb:this.EDh);return!0};this.DIb=(qe,Ve)=>{if(Ve=Ve.wmf){let Bd=!1,he=!1,we=!1,hg=!1,Pf=-1;const Ej=new Ei.DictionaryPropertySet,pn=RegExp('imagedata\\s+src="file:.*AppData\\/Local\\/Temp');if(Object(nb.a)(93,this.Vi.Cd)){Bd=this.Vi.Cd.ia(yc.a.hfa,!1);const Ol=this.Vi.Cd.ia(od.a.hU,
"");we=this.Vi.Cd.ia(od.a.P$,!1);hg=this.Vi.Cd.ia(We.a.ifa,!1);pn.test(Ol)&&(he=!0);this.N2i&&(Pf=this.Vi.Cd.ia(ui.a.Zda,-1))}else this.Vi.lA&256&&this.Lia&&(Bd=!0,pn.test(this.Lia.innerHTML)&&(he=!0));Ej.setValue(yc.a.hfa,Bd);Ej.setValue(od.a.OPc,he);Ej.setValue(od.a.P$,we);Ej.setValue(ui.a.Zda,Pf);Ej.setValue(We.a.ifa,hg);Ve.N6d(Ej);Ve.NHf();Ve.Rhb&&(this.Vi.fOc=!0,this.Vi.Tmf=Ve.R1,this.Vi.EEf=Ve.Rhb,Bd&&!we&&Lb.c(Fb.a.d6k),t.AFrameworkApplication.ya.processAction(Fb.a.DIb,2))}qe.ti(this.EDh);
return!0};this.EDh=(qe,Ve)=>{Eo.a.yCm(Ve.Qlj);Eo.a.Uxm(Ve.DZl);Eo.a.bBm(Ve.EEn);Eo.a.cBm(Ve.FEn);Eo.a.yym(Ve.jsm);qe="Others";Ve.yLd&&(Ve.yLd.Rxm(),Ve.yLd.Sxm(),qe=Ve.yLd.z1f);Eo.a.Txm(Ve.BZl,qe);Eo.a.xxm(Ve.Udl,qe);return!1};this.Lia=b;this.Uie=R;this.Kse=ba;this.rJe=ta;this.HMe=Wa;this.Hoc=ub;this.$Qb=ed;this.Oa=$b;this.dIg=Object.assign(new lz.a,{h6b:2===this.Vi.XZb||3===this.Vi.XZb});this.fpe=Kc;this.Xbd=ge;this.PUb=$b.$("GatherMetadataAboutExternalPastedHTMLContentIsEnabled");this.nUj=$b.$("ParseStyleFromRawHtmlHeadIsEnabled");
this.bVj=$b.$("RemoveSpacesAfterEndFragmentIsEnabled")}get ZVd(){return!1}get KNc(){return!0}AFh(b){this.via=new Nd.GraphIterator;this.nOa.restore(this.via);v.ULS.shipAssertTag(6305550,307,vg.OutlineElementReader.Nh(this.via));this.Vi.FQ&&this.Vi.FQ.EXb("external");var h=this.Vi.lA&8192?1:0,r=this.Kse.value.create(h,this.via,this.Vi.dBc,this.Vi.Ojb);const z=this.rJe.value.create(h,this.via),R=Eo.a.ANh(t.AFrameworkApplication.userSessionId),ba=Eo.a.ojf(t.AFrameworkApplication.userSessionId),ta=Eo.a.lef(X.a.$vb,
this.Vi.dBc),Wa=Eo.a.OYh(t.AFrameworkApplication.userSessionId),ub=Eo.a.PYh(t.AFrameworkApplication.userSessionId),Ib=this.PUb?this.t3l():null,$b=Eo.a.eSh(X.a.$vb,this.Vi.dBc),fc=Eo.a.fSh(t.AFrameworkApplication.userSessionId),Kc=this.Hoc.L2i?Eo.a.jyl(t.AFrameworkApplication.userSessionId):null;h=this.Uie.value.create(h,this.via,r,z,null,ta,this.Eak);h=new Nx(h,Wa,ub);h=new ct(h,r,this.$Qb);h=new bk.a(h,this.Hoc,this.dIg,Kc);h=new Zt(h,$b,Ib,this.Oa);h=new at(h,fc);r=new zy(h,r,R,ba,ta,Wa,ub,Ib,$b,
fc,Kc);r=new Bq.a(b,this.$Lm,r);r.ml("paste and request pictures");r.eh=!b||b.eh;r.run()}get Eak(){return this.Lia.getElementsByTagName("a").length}t3l(){const b=new kw;b.Hac=X.a.$vb;this.Vi&&(b.lA=this.Vi.lA,b.sJf=this.Vi.dBc,this.Vi.Cd&&(b.progId=this.Vi.Cd.ia(od.a.$Di,"")));this.Lia&&this.Lia.innerHTML&&(b.A3m=this.Lia.innerHTML.length);t.AFrameworkApplication.sessionStartInfoSettings&&(b.platform=t.AFrameworkApplication.sessionStartInfoSettings.Platform);return b}get c3i(){return!0}get l0c(){v.ULS.shipAssertTag(6305551,
307,!!this.via);if(this.Hoc.M2i(this.dIg)){let b=!1;vg.OutlineElementReader.Nh(this.via)&&(this.via.v$(),b=!0);const h=ie.ParagraphReader.zh(this.via)&&!this.via.currentNode.ia(od.a.wci,!1);b&&this.via.mc();return h}return ie.ParagraphReader.zh(this.via)}}Object(n.a)(Px,"ExternalPasteExecutionManager",Km,[]);class Ay{constructor(b,h,r,z,R,ba,ta,Wa,ub,Ib,$b){this.Uie=b;this.Kse=h;this.rJe=r;this.HMe=z;this.Hoc=R;this.nY=ba;this.Oa=ta;this.fpe=Wa;this.$Qb=ub;this.G4=Ib;this.Xbd=$b}create(b,h,r,z){return new Px(b,
h,r,z,this.Uie,this.Kse,this.rJe,this.HMe,this.Hoc.value,this.nY,this.Oa,vb.App.xa.jb,this.fpe,this.$Qb,this.G4,this.Xbd)}}Object(n.a)(Ay,"Factory",null,[556]);class pz{Jji(b){if(!b||!b.childNodes)return!1;const h=b.childNodes.length;return 2>h?!1:this.vcm(b.childNodes[h-2])&&this.Anm(b.childNodes[h-1])}kbo(b){this.Jji(b)&&(b.removeChild(b.lastChild),v.ULS.sendTraceTag(579371169,307,50,"Remove spaces after end fragment"))}Z$l(b){return!!b&&8===b.nodeType}Vlm(b){return!!b&&3===b.nodeType}vcm(b){return this.Z$l(b)&&
"EndFragment"===b.nodeValue}Anm(b){if(!this.Vlm(b))return!1;b=b.nodeValue;return!!b&&!b.trim().length}}Object(n.a)(pz,"HtmlNormalizerHelper",null,[557]);var dt=d(1843),qz=d(647);class rz extends Km{constructor(b,h,r,z,R,ba,ta,Wa){super(b,h,r,R,ba,Wa);this.lz=z;this.MH=ta}get sk(){return this.MH.value}get ZVd(){return this.lz.ZVd()}get gEi(){const b=this.lz;return b.jZe&&!b.S9h()}BFh(b,h){v.ULS.shipAssertTag(6305616,307,Ff.OutlineReader.xw(b));const r=qz.a(b.currentNode);if(Ff.OutlineReader.isEmpty(b)){var z=
Qe.a.create(b.currentNode);b.it(8);t.AFrameworkApplication.ya.Qf(z,Fb.a.SG,2,!0,null,null)}else b.it(8);(z=b.oE(1))&&b.mc();this.lz.QDi(this.Vi.ve,b.currentNode,z,-1,r,h)}AFh(b){const h=new Nd.GraphIterator;this.nOa.restore(h);v.ULS.shipAssertTag(6305618,307,vg.OutlineElementReader.Nh(h));this.Vi.FQ&&this.Vi.FQ.EXb("internal");let r=-1;if(this.N2i&&Object(nb.a)(93,this.Vi.Cd))r=this.Vi.Cd.ia(ui.a.Zda,-1);else{const z=this.Zol(h.currentNode);r=z?z.clientWidth:r}this.lz.QDi(this.Vi.ve,h.parentNode,
h.currentNode,r,null,b);this.Jei&&(this.nOa.restore(h),vg.OutlineElementReader.Nh(h)&&this.lz.Ohi(h)&&(b=ag.OutlineElementNavigator.De(h)))&&(this.Vi.IXa=Hf.SelectionFactory.xe(b,0))}Zol(b){return b?(b=b?b.Ce(this.sk.Tb):null)?b.htmlElement:null:null}M3i(){const b=new Nd.GraphIterator;this.nOa.restore(b);return this.lz.Ohi(b)}get c3i(){return mc.ListReader.rr}get l0c(){return!this.lz.ysa&&!this.lz.jZe}}Object(n.a)(rz,"InternalPasteExecutionManager",Km,[]);class Wu{constructor(b,h,r,z){this.lz=b;this.nY=
h;this.MH=r;this.G4=z}create(b,h,r){return new rz(b,h,r,this.lz,this.nY,vb.App.xa.jb,this.MH,this.G4)}}Object(n.a)(Wu,"Factory",null,[552]);var op;(function(b){b[b.unknown=0]="unknown";b[b.differentBox4App=1]="differentBox4App";b[b.sameBox4AppDifferentSession=2]="sameBox4AppDifferentSession";b[b.sameBox4AppSameSession=3]="sameBox4AppSameSession"})(op||(op={}));Object(n.b)("CopySource",op);class wu{constructor(b,h,r){this.lz=b;this.nJg=h;this.UCj=r}k3m(b,h,r){v.ULS.shipAssertTag(6305620,307,!!b);v.ULS.shipAssertTag(6305621,
307,Xd.SelectionEditor.xf(h));v.ULS.shipAssertTag(6305622,307,!!r);v.ULS.shipAssertTag(6305623,307,Object(nb.a)($i.a,r.Vfa));const z=r.Vfa;z.XZb=this.lz.ROh(b);this.jym(b,z);const R=this.ffm(z);var ba=new yf.GraphTransaction(7,Fb.a.paste);ba.Db(h.node);h.node.YG().AF.y9(8);R?(v.ULS.sendTraceTag(40706500,307,50,"Internal paste operation starts. {0}; {1}",z.lA,z.browserName),b=this.nJg.create(h,z,ba)):(v.ULS.sendTraceTag(40706501,307,50,"External paste operation starts. {0}; {1}; {2}",z.lA,z.XZb,z.browserName),
wu.aym(b),b=this.UCj.create(b,h,z,ba));r=new Bq.a(r,Object(u.a)(b,b.WDi,"pasteSetup"),null);r.ml("Paste");r.run()}ffm(b){return!this.Uhm(b)&&3===b.XZb}Uhm(b){return 1===(b.lA&8192?1:0)}Z9h(b,h){v.ULS.shipAssertTag(6305624,307,Xd.SelectionEditor.xf(b));v.ULS.shipAssertTag(6305625,307,!!h);v.ULS.shipAssertTag(6305626,307,Object(nb.a)($i.a,h.Vfa));const r=new yf.GraphTransaction(7,Fb.a.aNd);r.Db(b.node);b=this.nJg.create(b,h.Vfa,r);h=new Bq.a(h,Object(u.a)(b,b.WDi,"pasteSetup"),null);h.ml("InternalPasteAtIp");
h.run()}jym(b,h){if(b){let r=!1,z=!1;b.innerHTML&&0<=b.innerHTML.indexOf("mso-tab-count")?z=!0:b.innerText&&0<=b.innerText.indexOf("\t")&&(r=!0);(r||z)&&v.ULS.sendTraceTag(42471960,307,50,"User pasted InlineTabs. Source: {0}, Contains tab character (u0009): {1}, IsFromRichClient: {2}",op[h.XZb],r,z)}}static aym(b){b&&wu.f_j.test(b.innerText)&&v.ULS.sendTraceTag(6350173,307,50,"External paste operation starts on WebUrl")}}wu.f_j=RegExp("^[\\s]*(((http|https):\\/\\/)|(www\\.))[\\w\\-_]+(\\.[\\w\\-_]+)+[\\w\\-\\.,@?^=%&amp;:/~\\+#]*[\\s]*$");
Object(n.a)(wu,"PasteCoordinator",null,[]);class lw{constructor(b,h,r,z,R){this.Jsa=b;this.Rgb=h;this.y3m=r;this.x3m=z;this.KNc=R}}Object(n.a)(lw,"PastedContentsPostProcessorParams",null,[]);class Uw{O3l(b,h,r,z,R,ba){b=this.xsl(b,h,R);r=this.Ywl(r);if(!b||!r)return null;z=this.SDl(b,z,R);R=this.RDl(r);return new lw(b,r,z,R,ba)}xsl(b,h,r){b=r?b:h;if(!vg.OutlineElementReader.Nh(b))return null;h=new eg.a;h.fd(b);return h}Ywl(b){if(!vg.OutlineElementReader.Nh(b))return null;const h=new eg.a;h.fd(b);
ag.OutlineElementNavigator.R2(h,!1,!1);return h}SDl(b,h,r){ag.OutlineElementNavigator.De(b);let z=-1;ie.ParagraphReader.zh(b)&&(z=r?h:0);ag.OutlineElementNavigator.Zd(b);return z}RDl(b){ag.OutlineElementNavigator.De(b);const h=ie.ParagraphReader.zh(b)?ie.ParagraphReader.textLength(b.currentNode):-1;ag.OutlineElementNavigator.Zd(b);return h}}Object(n.a)(Uw,"PastedContentsPostProcessorHelper",null,[]);var Qx=d(610),Xu=d(1059),Yu=d(1057);class Vw{constructor(b,h,r,z,R,ba,ta,Wa,ub,Ib,$b,fc=null){this.Uwh=
100;this.U7b=!1;this.$le=null;this.Iue=!1;this.kid=null;this.yed=this.xHa=!1;this.sqa=b;this.RD=h;this.Zc=r;this.Vid=z;this.zi=R;this.bya=ba;this.Oa=ta;this.jQj=Wa;this.rv=ub;this.fV=Ib;this.Zv=$b;this.zHa=fc;this.I1n()}I1n(){this.RD.L$g(Object(u.a)(this,this.nXn,"showFloatieHandler"));this.RD.s$g(Object(u.a)(this,this.Ebl,"floatieDismissedHandler"))}GJk(b,h){var r;this.bya.Aof();1===this.jQj.TJk(h.VUc)?v.ULS.sendTraceTag(575255107,307,50,"Box4 Paste floatie not created. CorrelationId: {0}",h.correlationId):
this.showFloatie(b,h)?(this.xHa?this.xHa=!1:this.Lnn(),this.rXc(),b="Box4 Paste floatie created."+String.format(" PasteCommand: {0}, CorrelationId: {1}",Fb.a.oT(h.KQ)||"Unknown",h.correlationId),v.ULS.sendTraceTag(40379588,307,50,b),Lb.a("Box4PasteFloatieCreated",!0,void 0,[Object.assign(new ca.a,{name:"PasteCommand",int64:Fb.a.oT(h.KQ)||"Unknown"}),Object.assign(new ca.a,{name:"CorrelationId",string:null===(r=h.correlationId)||void 0===r?void 0:r.toString()})]),this.cMb()):v.ULS.sendTraceTag(575255108,
307,50,"Box4 Paste floatie not created. CorrelationId: {0}",h.correlationId)}qw(b){var h;!this.Iue&&(this.xHa||(this.zHa?null===(h=this.Zv)||void 0===h?0:h.KZ:this.sqa.KZ()))&&(b&&(this.bya.Aof(),this.ofj(),v.ULS.sendTraceTag(50685514,307,50,"Last paste command before dimiss or hiding the floatie. Command: {0}",this.kid)),this.xHa=!b,this.tce(),this.zHa?t.AFrameworkApplication.ya.processAction(Fb.a.KBb,2):this.sqa.qw())}Lnn(){this.yed||(this.$le=this.Zc.xd,Bf.a.addHandler(this.$le.container,"scroll",
Object(u.a)(this,this.hJb,"scrollHandler")),this.zi.o1(Object(u.a)(this,this.vga,"resizeHandler")),this.yed=!0)}ofj(){this.yed&&(Bf.a.removeHandler(this.$le.container,"scroll",Object(u.a)(this,this.hJb,"scrollHandler")),this.zi.tga(Object(u.a)(this,this.vga,"resizeHandler")),this.yed=!1)}cMb(){if(this.zHa)this.Zv.KZ&&t.AFrameworkApplication.ya.processAction(Fb.a.KBb,2),t.AFrameworkApplication.ya.processAction(Fb.a.E0c,2),this.U7b=!1;else{const b=new Yu.a(0,t.AFrameworkApplication.isRtl);b.location=
this.bya.wLa();this.bya.ndm(b.location)?this.showFloatie(null,b):this.RD.HDa(new Xu.a(!1))}}vga(){this.zHa?(t.AFrameworkApplication.ya.processAction(Fb.a.KBb,2),this.sDc()):this.cMb()}hJb(){this.zHa?(t.AFrameworkApplication.ya.processAction(Fb.a.KBb,2),this.sDc()):this.cMb()}Ebl(b,h){this.qw(h.K8k)}nXn(b,h){this.GJk(b,h)}rXc(){this.Vid.J7j(Object(u.a)(this,this.Jyi,"onOnlyKeyPressed"));this.RD.w$g(Object(u.a)(this.sqa,this.sqa.MBd,"expandFloatie"));this.RD.H$g(Object(u.a)(this,this.YDi,"pastedFloatieStatusChange"));
this.rv.ys(Object(u.a)(this,this.Sfa,"onParagraphConnect"));this.rv.zv(Object(u.a)(this,this.vGb,"onParagraphDisconnected"));this.rv.lp(Object(u.a)(this,this.Y2,"onParagraphPropertyChanged"))}tce(){this.Vid.Orn(Object(u.a)(this,this.Jyi,"onOnlyKeyPressed"));this.RD.cPi(Object(u.a)(this.sqa,this.sqa.MBd,"expandFloatie"));this.RD.jPi(Object(u.a)(this,this.YDi,"pastedFloatieStatusChange"));this.rv.jM(Object(u.a)(this,this.Sfa,"onParagraphConnect"));this.rv.Saa(Object(u.a)(this,this.vGb,"onParagraphDisconnected"));
this.rv.EX(Object(u.a)(this,this.Y2,"onParagraphPropertyChanged"))}YDi(b,h){this.Iue=h.ONc;h.KQ&&(this.kid=h.KQ);h.V_f&&this.sqa.KZ()&&this.cMb()}Y2(b,h){h.property===We.a.lastModifiedTime?(v.ULS.sendTraceTag(520734533,307,50,"Last Modified Time was used "),this.fV.G1e.contains(Fb.a.P8f)||this.FPf(h)):v.ULS.sendTraceTag(520734532,307,50,"Last Modified Time was NOT used but theoretically would be if we remove Last Modified was removed.")}vGb(b,h){this.FPf(h)}Sfa(b,h){h.Zpf||this.FPf(h)}FPf(b){b.node.loading||
this.RD.HDa(new Xu.a(!0))}showFloatie(b,h){h||(h=new Yu.a(0,t.AFrameworkApplication.isRtl));h.location||(h.location=this.bya.wLa());if(!h.location)return!1;this.xHa&&(this.xHa=!1,this.rXc());this.zHa?t.AFrameworkApplication.ya.processAction(Fb.a.E0c,2):this.sqa.showFloatie(b,h);return!0}sDc(){if(!this.U7b){const b=new Ic.a(3,1,this.Uwh,()=>{this.cMb()},215);Oe.a.instance.$b(b);this.U7b=!0}}Jyi(){Qx.a.instance.keyCode===wb.a.qwa&&this.RD.fJi()}}Object(n.a)(Vw,"PasteFloatieEventManager",null,[]);class Ww{constructor(b,
h){this.Yj=b;this.yH=h}TJk(b){return rm.any(rm.where(rm.asEnumerable(Ww.k4n),h=>this.yH.cPc(h)))?(b=this.Yj.Oib(b))&&(b=b.innerText)&&0<b.trim().length?0:1:1}}Ww.k4n=[Fb.a.reformatPastedContent.toString(),Fb.a.EOa.toString(),Fb.a.jva.toString()];Object(n.a)(Ww,"PasteFloatieFeatureSetBuilder",null,[]);class Xw{constructor(){this.Xua=null;this.Lac=0}}Object(n.a)(Xw,"PasteFloatieAnchorData",null,[]);class ym{constructor(b,h,r,z,R,ba=!1){this.ksb=null;this.ib=b;this.Sqa=h;this.Zc=r;this.NEj=z;this.sqa=
R;this.zHa=ba}Aof(){this.ksb=null}wLa(){const b=this.bef(this.ksb)||this.cjh();if(!b){let h="null",r="null";if(this.ksb&&this.ksb.Xua){if(!this.Zc.xd)return v.ULS.sendTraceTag(51143187,307,15,"SelectoinView is null when we try to get floatie position"),null;h=Object.getType(this.ksb.Xua).getName();const z=this.ksb.Xua.Ni(this.Zc.xd.Tb);z&&(r=Object.getType(z).getName())}v.ULS.shipAssertTag(40641054,307,!1,"Failed to calculate position for pasted node type {0}, view element type {1}",h,r)}return b}ndm(b){if(!b)return!1;
const h=this.sqa.gAb(),r=this.NEj(this.Zc.xd.container);b=new Sys.UI.Bounds(b.x,b.y,h.width,h.height);return b.y>=r.y&&b.y+b.height<=r.y+r.height}cjh(){if(!this.ib||!this.ib.hb||!this.ib.hb.kb)return v.ULS.sendTraceTag(51431265,307,15,"Selection is null when we try to calculate floatie position"),null;var b=this.ib.hb.kb.Qa,h=!b.cpBegin&&!b.cpEnd;let r=b.node;if(r&&h){do r=this.$Wh(r);while(r&&Object(nb.a)(dd.AParagraphNode,r)&&!r.characterData.trim().length)}let z="";const R=Object(la.a)(dd.AParagraphNode,
r);R&&(z=R.characterData.length===b.cpBegin||h?R.characterData.trimEnd():R.characterData.substring(0,b.cpBegin).trimEnd());h=R?z.length:b.cpBegin;b=Object.assign(new Xw,{Xua:Object(la.a)(200,(R?Object(la.a)(200,R):Object(la.a)(200,r))||b.node),Lac:h});return this.bef(b)}$Wh(b){const h=new Nd.GraphIterator;if(!b.anchor)return null;h.set(b);if(!h.vd())return null;h.kd(11);return h.bH()?h.Rb(2):null}bef(b){if(!b||!b.Xua)return null;this.ksb=b;const h=this.Zc.xd;if(!h)return v.ULS.sendTraceTag(51143188,
307,15,"SelectoinView is null when we try to get floatie position"),null;b=this.gSh(b,h);if(!b)return null;t.AFrameworkApplication.isRtl&&this.sqa.KZ()&&(b.x-=this.sqa.gAb().width);return new Sys.UI.Point(b.x+b.width,b.y+b.height)}gSh(b,h){h=Object(la.a)(213,b.Xua.Ni(h.Tb));if(!h)return null;let r=null;if(Object(nb.a)(dd.AParagraphNode,b.Xua)){const z=Object(la.a)(86,h);if(!z)return null;try{r=this.Sqa.aZ(b.Lac,z,0<b.Lac,!1,!1,!1),r.height+=this.zHa?ym.Ifn:ym.Hbl}catch(R){v.ULS.sendTraceTag(40953486,
307,15,"Failed to get ip bound due to exception {0}, will use fallback value.",R),r=null}}else Object(nb.a)(yq.TableNode,b.Xua)&&(r=Object(la.a)(138,h).nif());r||(r=h.getBounds());return r}}ym.Hbl=2;ym.Ifn=60;Object(n.a)(ym,"PasteFloatiePositionProvider",null,[]);class hh{constructor(b,h){this.imc=b;this.Kyj=h}get titleText(){return CommonUIStrings.l_ClipboardUseShortcutTitle}get qKh(){return CommonUIStrings.l_ClipboardUseShortcutMessage}get d2e(){return CommonUIStrings.l_ClipboardCut}get Uyf(){return CommonUIStrings.l_ClipboardCut_Mac}get b_e(){return CommonUIStrings.l_ClipboardCopy}get Tyf(){return CommonUIStrings.l_ClipboardCopy_Mac}get QKf(){return CommonUIStrings.l_ClipboardPaste}get Vyf(){return CommonUIStrings.l_ClipboardPaste_Mac}get b7(){return CommonUIStrings.l_ClipboardPasteText}get Wyf(){return CommonUIStrings.l_ClipboardPasteText_Mac}get pXe(){return this.Kyj}get xnh(){return CommonUIStrings.l_ClipboardExtensionLink}get Sab(){return CommonUIStrings.l_ClipboardExtensionSuggestion}SFh(){v.ULS.sendTraceTag(8716421,
307,50,null);Ed.a.Cm(this.pXe,"_blank",void 0,"ClipboardAccessExtensionLink")}Taa(b,h){let r=X.a.xl;t.AFrameworkApplication.K.$("CcpFixIPadShortcutStringsIsEnabled")&&(r=X.a.ki||r);return r?String.format(h,"\u2318"):b}dispose(){this.imc=null}TPf(b){this.jsh(b)}brm(b){this.jsh(b)}jsh(b){this.imc&&this.imc(b)}}hh.id="CopyPasteShortcutDialog";hh.gaj="CopyPasteText";Object(n.a)(hh,"ACopyPasteShortcutDialog",null,[9]);class gq extends hh{constructor(b,h,r){super(b,h);b=document.createElement("span");b.className=
"WACCopyPasteShortcutDialogTextPanel";h=document.createElement("span");h.id=hh.gaj;var z=document.createElement("span");z.innerText=this.qKh;var R=document.createElement("span");R.className="UIFontBold";R.innerText=this.Taa(this.d2e,this.Uyf);const ba=document.createElement("span");ba.className="UIFontBold";ba.innerText=this.Taa(this.b_e,this.Tyf);const ta=document.createElement("span");ta.className="UIFontBold";ta.innerText=this.Taa(this.QKf,this.Vyf);h.appendChild(z);h.appendChild(document.createElement("br"));
h.appendChild(R);h.appendChild(ba);h.appendChild(ta);r.$("PasteTextOnlyShortcutDialogIsEnabled")&&(X.a.rp||X.a.gj)&&(r=document.createElement("span"),r.className="UIFontBold",r.innerText=this.Taa(this.b7,this.Wyf),h.appendChild(r));b.appendChild(h);this.pXe?(v.ULS.sendTraceTag(8716420,307,50,null),r=document.createElement("span"),h=document.createElement("a"),h.href="#",h.innerText=this.xnh,Bf.a.addHandler(h,"click",Object(u.a)(this,this.SFh,"extensionLinkHandler")),r.appendChild(h),R=this.Sab.indexOf("{0}"),
-1!==R&&(z=this.Sab.substring(0,R),R=this.Sab.substring(R+3,this.Sab.length),z=document.createTextNode(z),R=document.createTextNode(R),r.insertBefore(z,h),r.appendChild(R)),b.appendChild(document.createElement("br")),b.appendChild(r)):v.ULS.sendTraceTag(8716422,307,50,null);r=new te.StandardDialog;r.Fd=0;r.kg=hh.id;r.Pv(this.titleText,null,0,Object(u.a)(this,this.brm,"legacyCopyPasteShortcutDialogHandler"),b);r.u3(hh.gaj)}}Object(n.a)(gq,"CopyPasteShortcutDialog",hh,[]);class mw extends hh{constructor(b,
h){super(b,h);h={};b=this.b7l;h.extensionStartText=this.R5k;h.extensionLink=null;h.extensionEndText=null;h.shortcutsMessageText=this.ZRn;h.cutText=this.Taa(this.d2e,this.Uyf);h.copyText=this.Taa(this.b_e,this.Tyf);h.pasteText=this.Taa(this.QKf,this.Vyf);4!==t.AFrameworkApplication.ua.Sb.jo&&(h.pasteTextOnly=this.Taa(this.b7,this.Wyf));h={["id"]:"CopyPasteInstallDialog",["bodyControls"]:h};const r=new Wc.a(!1,!1,!0);r.kg="CopyPasteInstallDialog";r.Fd=0;r.Ve(1,this.a7l);r.tU(1);r.Wh(b,Object(u.a)(this,
this.TPf,"reactCopyPasteShortcutDialogHandler"),h)}get ZRn(){return CommonUIStrings.l_ClipboardInstallDialogShortcutsMessage}get a7l(){return CommonUIStrings.l_ClipboardInstallDialogInstallButton}get b7l(){return CommonUIStrings.l_ClipboardInstallDialogTitle}get R5k(){return CommonUIStrings.l_ClipboardInstallDialogExtensionMessage}static $Vn(){var b=window.location.origin;return b?RegExp("^https:\\/\\/((.*?(word-edit|powerpoint|onenote|excel|visio)\\.(officeapps\\.live\\.com|partner\\.officewebapps\\.cn|gov\\.online\\.office365\\.us|dod\\.online\\.office365\\.us))|(project\\.microsoft\\.com))$",
"g").test(b):!1}}Object(n.a)(mw,"ReactCopyPasteInstallDialog",hh,[]);class Yw extends hh{constructor(b){super(b,null);this.Iki="https://prod.support.services.microsoft.com/en-us/office/troubleshoot-copy-and-paste-errors-in-powerpoint-for-the-web-0dc01da6-6988-40e5-96ea-0567c151ae2f?preview=true";var h={};b=this.zLm;var r="";let z="";this.messageText&&(r=this.messageText.split(" {")[0],z=this.messageText.split("} ")[1]);h.startText=r;h.endText=z;h.cutText=this.eQk;h.copyText=this.rGk;h.pasteText=this.p3m;
h.cutShortcutText=this.Taa(this.fQk,this.wDm);h.copyShortcutText=this.Taa(this.CGk,this.vDm);h.pasteShortcutText=this.Taa(this.s3m,this.yDm);h.imageSrc=Eg.a.G9("NoClipboardAccessDialogImage.svg");h.imageAltText=this.imageAltText;h.primaryButtonLabel=this.L8m;this.Iki&&(v.ULS.sendTraceTag(527986756,307,50,"Learn more link is available"),h.learnMoreLink={["type"]:"AppLinkProps",["id"]:"learnMoreLink",["text"]:this.Zgb,["onExecute"]:()=>{this.Xqm()}});h={["id"]:"CopyPasteNoClipboardAccessDialog",["bodyControls"]:h};
r=new Wc.a(!1,!1,!0);r.Fd=0;r.kg="CopyPasteNoClipboardAccessDialog";r.Wh(b,Object(u.a)(this,this.TPf,"reactCopyPasteShortcutDialogHandler"),h)}get zLm(){return CommonUIStrings.l_NoClipboardAccessDialogTitle}get messageText(){return CommonUIStrings.l_NoClipboardAccessDialogMessage}get Zgb(){return CommonUIStrings.l_NoClipboardAccessDialogLearnMoreMessage}get imageAltText(){return CommonUIStrings.l_NoClipboardAccessDialogImageAltText}get L8m(){return CommonUIStrings.l_DialogOk}get eQk(){return CommonUIStrings.l_CutString}get fQk(){return CommonUIStrings.l_CutShortcut}get wDm(){return CommonUIStrings.l_CutShortcut_Mac}get rGk(){return CommonUIStrings.l_CopyString}get CGk(){return CommonUIStrings.l_CopyShortcut}get vDm(){return CommonUIStrings.l_CopyShortcut_Mac}get p3m(){return CommonUIStrings.l_PasteString}get s3m(){return CommonUIStrings.l_PasteShortcut}get yDm(){return CommonUIStrings.l_PasteShortcut_Mac}Xqm(){v.ULS.sendTraceTag(527986757,
307,50,"Learn more link is clicked");Ed.a.Cm(this.Iki,"_blank",void 0,"learnMoreLink")}}Object(n.a)(Yw,"ReactCopyPasteNoClipboardAccessDialog",hh,[]);class Gh extends hh{constructor(b,h,r){super(b,h);b={};b.forwardElementText=this.qKh;b.cutText=this.Taa(this.d2e,this.Uyf);b.copyText=this.Taa(this.b_e,this.Tyf);b.pasteText=this.Taa(this.QKf,this.Vyf);r.$("PasteTextOnlyShortcutDialogIsEnabled")&&(X.a.rp||X.a.gj)&&(b.pasteTextOnly=this.Taa(this.b7,this.Wyf));this.pXe?(v.ULS.sendTraceTag(40726914,307,
50,null),b.extensionLink={["type"]:"AppLinkProps",["id"]:"extensionLink",["text"]:this.xnh,["onExecute"]:z=>{this.SFh(z)}},r=this.Sab.indexOf("{0}"),-1!==r&&(b.suggestionPrefixElement=this.Sab.substring(0,r),b.suggestionSuffixElement=this.Sab.substring(r+3,this.Sab.length))):v.ULS.sendTraceTag(40726915,307,50,null);r={["id"]:hh.id,["bodyControls"]:b};b=new Wc.a(!1,!1,!0);b.Fd=0;b.kg=hh.id;b.Wh(this.titleText,Object(u.a)(this,this.TPf,"reactCopyPasteShortcutDialogHandler"),r)}}Object(n.a)(Gh,"ReactCopyPasteShortcutDialog",
hh,[]);class et{constructor(){this.bqa=!!t.AFrameworkApplication.ua&&t.AFrameworkApplication.ua.Sb.KA}A_e(b,h,r=!1){v.ULS.sendTraceTag(594882645,307,50,String.format("_isReactDialogEnabled={0}, useInstallDialog={1}",this.bqa,r));this.bqa?r?new mw(b,h):new Gh(b,h,t.AFrameworkApplication.K):new gq(b,h,t.AFrameworkApplication.K)}static get instance(){return et._instance||(et._instance=new et)}}et._instance=null;Object(n.a)(et,"CopyPasteShortcutDialogFactory",null,[951]);class sz{constructor(b,h,r,z,
R,ba,ta,Wa){this.j0g=this.fLg=this.vIe=!1;this.PWj=b;this.Zc=h;this.rt=r;this.Wb=z;this.Ud=R;this.$f=ba;this.te=ta;Wa&&(this.j0g=Wa.$("ShouldLogExecCommandCopySuccess"))}get $Pa(){return this.PWj}get v_a(){return this.fLg}set v_a(b){this.fLg=b;this.$f.ignoreClipboardEvents=b}rFc(b){this.$Pa.rFc(b);b||this.a2c(!0)}get e3k(){return this.$Pa.DUf}prepareForPaste(b){this.v_a=!0;this.$Pa.prepareForPaste(b,this.o4f)}reset(){this.v_a=!1}paste(){var b=null;let h=null;if(!this.$Pa.LMb){(b=this.Zc.xd)&&this.Wb.Jg(b.mI);
var r=this.rt.wv;if(!r.ze||!r.editingView.Dj)return null;h=r.editingView;b=this.Ud.pp();this.v_a=!0;r.wFa()}r=null;try{h&&h.z7m(),r=b=this.$Pa.EFc(this.o4f,b)}catch(z){v.ULS.shipAssertTag(6305672,307,!1),this.D2h()}this.v_a=!1;return r}copy(){var b=this.Zc.xd;b&&this.Wb.Jg(b.mI);b=this.rt.wv;if(!b.ze||1!==b.editingView.mode)return!1;this.v_a=!0;let h;try{const r=new Map;r.set("View","ContentEditableView");Ca.Health.instance.recordKpiUsage(Ut.a.dud,0,Ut.a.OVe,r);const z=this.$Pa.V7e(this.o4f);h=!0;
this.j0g&&v.ULS.sendTraceTag(558384097,307,50,"execCommandCopySuccess, {0}, browser: {1}",z,this.te.dF);if(!z){const R=Object.assign(new eb.a,{extendedProperties:r});Ca.Health.instance.recordKpiFailure(Ut.a.dud,Ut.a.Tkh,!0,!0,R)}}catch(r){v.ULS.shipAssertTag(6305673,307,X.a.gj),v.ULS.sendTraceTag(17148117,307,50,"Known blocked access attempt handle in SystemClipboard: copy, {0}",X.a.dF),h=!1}this.v_a=!1;return h?!0:!1}a2c(){if(this.vIe)return!0;var b=this.rt.wv;if(!b.ze||!b.editingView.Dj)return!1;
const h=b.editingView;b=this.Ud.pp();this.v_a=!0;const r=new tt.a(b);let z=!1;try{z=this.$Pa.a2c(b,()=>{h.Yud()},()=>{h.cEa()})}catch(R){v.ULS.shipAssertTag(6305674,307,!X.a.Ak)}r.restore();this.v_a=!1;z?this.vIe=!0:(v.ULS.sendTraceTag(42517522,307,50,"Known blocked access attempt handle in SystemClipboard: paste, {0}",X.a.dF),X.a.Ak||this.D2h());return z}D2h(){this.vIe=!1;if(t.AFrameworkApplication.Iqo)et.instance.A_e(null,null);else{const b=new te.StandardDialog;b.Fd=0;b.vU(CommonUIStrings.l_ClipboardAccessDeniedTitle,
CommonUIStrings.l_ClipboardAccessDenied,null)}}get o4f(){const b=this.Ud.pLa();return b?b.Dn:null}}Object(n.a)(sz,"SystemClipboard",null,[551]);class xt{constructor(b,h,r){this.dpd=!1;this.Hpd=this.cS=this.aOg=this.ske=this.W7c=null;this.l6m=z=>{1===z?(v.ULS.sendTraceTag(9013382,307,50,String.format("SuggestionEnabled={0}",this.gke)),this.gWb&&(v.ULS.sendTraceTag(594882642,307,50,String.format("_useInstallDialog={0}",this.gWb)),Ed.a.Cm(this.Yqe+this.sAe,"_blank",void 0,"ChromeCCPInstallDialog"))):
z||v.ULS.sendTraceTag(9013383,307,50,String.format("SuggestionEnabled={0}",this.gke))};this.gke=b.$("ChromeClipboardAccessExtensionSuggestionIsEnabled");this.Yqe=b.lb("ChromeClipboardAccessExtensionLink");this.S6a=h;this.Yj=r;this.sAe=b.lb("ChromeClipboardAccessExtensionId");this.lZj=b.$("UseGetClipboardDataIsEnabled");this.uXg=b.$("RecordExtensionInstallStatusKpiIsEnabled");this.gWb=!1;b.$("CcpInstallDialogIsEnabled")&&t.AFrameworkApplication.ua&&t.AFrameworkApplication.ua.Sb.KA&&(this.gWb=mw.$Vn()||
b.$("IgnoreDomainCheckCcpInstallDialog"),v.ULS.sendTraceTag(587314304,307,50,"_useInstallDialog: {0}",this.gWb));this.inc=null}rFc(b){b?this.cS=!0:(this.cS=null,chrome.runtime&&chrome.runtime.sendMessage?(this.inc=this.S6a.qyd,this.S6a.Hkb?(this.dpd=this.lZj,this.Mlh()):(this.dpd=!0,this.Mlh(),v.ULS.sendTraceTag(19256732,307,50,E.a.create().toString()))):(this.yKb(),this.cS=!1))}get DUf(){return this.cS}get LMb(){return this.Hpd}a2c(){return!0}V7e(b){v.ULS.sendTraceTag(24402115,307,50,"Execute chrome copy");
(b=Ed.a.Ryb(b,"copy"))||v.ULS.sendTraceTag(24402116,307,10,String.format("In Chrome {0} execute copy failed",window.navigator.userAgent.split("/")[3].substring(0,2)));return b}dcf(b){if(!b)return null;var h=b.img;const r=b.text;b=b.html;const z=this.Yj.XVi(!!h,!!r,b);let R=null;if(3===z){if(!b)return null;h=this.Yj.aGh(b);(h=this.Yj.hGh(h))&&(b+=h);R=this.Yj.Oib(b)}else 2===z?R=this.Yj.GKf(r,!0):1===z&&(R=this.Yj.Oib(h));return R}EFc(b,h){if(this.LMb)h=this.dcf(this.ske),this.ske=null;else{if(!this.W7c)return h;
b=document.implementation.createHTMLDocument("doc");b.body.innerHTML=this.W7c;h=b.body;this.W7c=null}return h}prepareForPaste(b){const h=E.a.create();this.aOg=h;this.S6a.Hkb?v.ULS.sendTraceTag(7377737,307,50,h.toString()):v.ULS.sendTraceTag(19256735,307,50,h.toString());const r={};r.command=this.LMb?"getClipboardData":"paste";chrome.runtime.sendMessage(this.inc,r,z=>{h.equals(this.aOg)?this.LMb?this.ske=z:this.W7c=z:v.ULS.sendTraceTag(7385868,307,50,null);v.ULS.sendTraceTag(7377738,307,50,h.toString());
chrome.runtime.lastError&&(this.s_k(),this.S6a.Hkb?v.ULS.sendTraceTag(7377739,307,10,chrome.runtime.lastError.message):v.ULS.sendTraceTag(19256737,307,10,chrome.runtime.lastError.message));b()})}yKb(){v.ULS.sendTraceTag(8716423,307,50,null);let b=null;this.gWb?b=this.Yqe+this.sAe:this.gke&&(b=this.Yqe+this.inc);et.instance.A_e(this.l6m,b,this.gWb)}s_k(){this.S6a.qwn();this.yKb()}eXi(b,h){chrome.runtime.sendMessage(b,{command:"test",object:"ping"},h)}rtk(){const b=E.a.create();this.S6a.Hkb?v.ULS.sendTraceTag(592491466,
307,50,b.toString()):v.ULS.sendTraceTag(591984031,307,50,b.toString());chrome.runtime.sendMessage(this.inc,{command:"getAvailableCommands"},h=>{v.ULS.sendTraceTag(592491467,307,50,b.toString());h?Object(nb.a)(Array,h)?(v.ULS.sendTraceTag(592491470,307,50,"Extension responded: {0}",h),this.Hpd=-1!==Array.indexOf(h,"getClipboardData")):(v.ULS.sendTraceTag(592491469,307,15,"ChromeApi has non-string[] response. o: {0}",h),this.Hpd=!1):(v.ULS.sendTraceTag(592491468,307,15,"ChromeApi has null response. ErrorMsg: {0}",
chrome.runtime.lastError?chrome.runtime.lastError.message:null),this.Hpd=!1)})}Mlh(){const b=E.a.create();this.S6a.Hkb?v.ULS.sendTraceTag(7726105,307,50,b.toString()):v.ULS.sendTraceTag(591984032,307,50,b.toString());this.dpd&&this.rtk();this.eXi(this.inc,h=>{v.ULS.sendTraceTag(7726106,307,50,b.toString());h&&"ping"===h?this.cS=!0:(h?"ping"!==h&&v.ULS.sendTraceTag(7726107,307,10,"ChromeApi has unexpected response: {0}. ErrorMsg: {1}",h,chrome.runtime.lastError?chrome.runtime.lastError.message:null):
v.ULS.sendTraceTag(39190680,307,50,"ChromeApi has null response. ErrorMsg: {0}",chrome.runtime.lastError?chrome.runtime.lastError.message:null),this.yKb(),this.cS=!1);this.dpd&&!this.LMb&&v.ULS.sendTraceTag(592491471,307,50,"No response for CheckGetClipboardDataExistenceAsync")})}Nmi(b,h){const r={};r.OfficeOnlineExtensionInstallationStatus=b;r.OfficeClipboardExtensionInstallationStatus=h;v.ULS.sendTraceTag(51144839,307,50,JSON.stringify(r));this.uXg&&(b&&Ca.Health.instance.recordKpiSuccess(xt.KSg,
null),h&&Ca.Health.instance.recordKpiSuccess(xt.HSg,null))}Zwm(){this.uXg&&(Ca.Health.instance.recordKpiUsage(xt.KSg,1,xt.EDg,null),Ca.Health.instance.recordKpiUsage(xt.HSg,1,xt.EDg,null));if(chrome.runtime&&chrome.runtime.sendMessage){var b=!this.S6a.Hkb;this.eXi(this.sAe,h=>{this.Nmi(b,!!h)})}else this.Nmi(!1,!1)}}xt.KSg="OfficeOnlineExtensionInstallationStatus";xt.HSg="OfficeClipboardExtensionInstallationStatus";xt.EDg="wwccp";Object(n.a)(xt,"ChromeSystemClipboardAccessManager",null,[577]);class ds{constructor(b,
h){this.cS=null;this.te=b;this.Oa=h;this.exj=!this.Oa.$("UseSyncCopyCutCommandOnFirefoxIsEnabled")&&this.Oa.$("BlockCopyCutOnFirefoxIsEnabled");this.fUj=h.$("SetResultForEnsureAccessOperationForElectronIsEnabled")}rFc(b){this.exj&&b&&this.te.gj?(this.yKb(),this.cS=!1):this.cS=!0}get DUf(){return this.cS}get LMb(){return!1}V7e(b){return Ed.a.Ryb(b,"copy")}EFc(b,h){Ed.a.Ryb(b,"paste");return h}prepareForPaste(b){b()}a2c(b,h,r){if(this.te.s2)return this.fUj&&(this.cS=!1),!1;h();r();b=this.EFc(b.ownerDocument,
b);h=b.innerHTML;b.innerHTML=pa.a.create().toString();r();b=this.EFc(b.ownerDocument,b);return this.cS=b=h===b.innerHTML}yKb(){et.instance.A_e(null,null)}}Object(n.a)(ds,"DefaultSystemClipboardAccessManager",null,[577]);class By{constructor(b,h,r){this.cS=this.t8=this.sTb=this.Mia=this.yTa=this.S7c=null;this.Yj=h;this.JTa=r;this.eMj=b.rc("ClipboardDataImageBlobLimitaton",10);b.$("EdgeSystemClipboardSelectionEnsureStrategyIsEnabled");this.LUj=b.$("ShouldGrantEdgeSystemClipboardAccessForCopyCut")}rFc(b){this.LUj&&
b&&(this.cS=!0)}get DUf(){return this.cS}get LMb(){return!1}V7e(b){return b?Ed.a.Ryb(b,jb.a.copy):!1}EFc(b,h){this.yTa&&(h=this.yTa,this.yTa=null);return h}prepareForPaste(b,h=null){if(b&&h){this.S7c=b;this.sTb=h;$addHandler(this.sTb,jb.a.paste,Object(u.a)(this,this.Zyi,"onPasteEvent"));this.t8=this.Mia=null;if(this.fej(this.sTb)){if(this.t8&&0<this.t8.length&&(!this.Mia||this.Yj.sde(this.Mia))){this.JTa.Drh(this.t8,Object(u.a)(this,this.fTm,"onImageConverted"));this.yTa&&!this.yTa.hasChildNodes()&&
v.ULS.sendTraceTag(42592151,307,50,"pastedContentDom has no child nodes.");return}this.Mia&&this.Mia.innerHTML&&((this.yTa=this.i6h(this.Mia.innerHTML))&&!this.yTa.hasChildNodes()&&v.ULS.sendTraceTag(42592152,307,50,"pastedContentDom has no child nodes."),$e.a.nA(this.Mia))}this.lIh()}else b&&b()}a2c(b){return this.cS=b=this.fej(b.ownerDocument)}Zyi(b){try{b&&b.rawEvent&&((this.Mia=b.rawEvent.target)&&this.Mia.id&&-1<this.Mia.id.indexOf("Paste")?(v.ULS.sendTraceTag(40690080,307,15,"The pasted target element of paste event: "+
this.Mia.id),this.Mia=null):this.t8=this.Zul(b.rawEvent))}catch(h){v.ULS.sendTraceTag(22073952,307,15,"Exception while processing context menu paste event: "+h.toString())}}fTm(b){b&&(this.JTa.j3i&&(b=String.format('<img src="{0}">',b)),this.yTa=this.i6h(b));this.lIh()}lIh(){this.sTb&&($removeHandler(this.sTb,jb.a.paste,Object(u.a)(this,this.Zyi,"onPasteEvent")),this.sTb=null);this.S7c&&(this.S7c(),this.S7c=null)}Zul(b){let h=null;(b=this.Yj.TNh(b))&&({nmf:h}=this.Yj.Jdj(b,this.eMj,this.JTa.fqi));
return h}fej(b){return Ed.a.Ryb(b,jb.a.paste)}i6h(b){const h=document.implementation.createHTMLDocument("doc");h.body.innerHTML=b;return h.body}yKb(){}}Object(n.a)(By,"EdgeSystemClipboardAccessManager",null,[577]);class tz{constructor(b,h,r,z){this.Oa=b;this.Byj=h;this.Yj=r;this.te=z}create(){let b=null;t.AFrameworkApplication.Y_f()&&this.te.rp&&window.chrome?(v.ULS.sendTraceTag(7377743,307,50,"ChromeSystemClipboardAccessManager"),b=new xt(this.Oa,this.Byj,this.Yj),this.Oa.$("LogChromeExtensionInstallationStatusIsEnabled")&&
b.Zwm()):this.Oa.$("EdgeContextMenuPasteFixIsEnabled")&&this.te.Ys?(v.ULS.sendTraceTag(22073953,307,50,"EdgeSystemClipboardAccessManager"),b=new By(this.Oa,Sa.a.instance.resolve("Box4.IClipboardDataHelper"),Sa.a.instance.resolve("Box4.IProcessImageStrategy"),Sa.a.instance.resolve("Box4.Clipboard.IEdgeSystemClipboardSelectionEnsureStrategy"))):(v.ULS.sendTraceTag(7377744,307,50,"DefaultSystemClipboardAccessManager"),b=new ds(this.te,this.Oa));return b}}Object(n.a)(tz,"SystemClipboardAccessManagerFactory",
null,[550]);class Cy{G4k(b){return b}}Object(n.a)(Cy,"DeleteTableSegmentStrategy",null,[546]);var nw=d(596),hq=d(998);class Dy{get qp(){return ao.a.GAb}get paragraphEditor(){return null!=this.hpg?this.hpg:this.hpg=Sa.a.instance.resolve("Box4.IParagraphEditor")}get g_(){return this.paragraphEditor.qp}get Mc(){return wc.a.instance}get ey(){return null!=this.tpg?this.tpg:this.tpg=Sa.a.instance.resolve("Box4.IParagraphIndentationReader")}Uyc(b,h,r,z,R,ba,ta){let Wa=2;if(!b.ze)return 2;const ub=b.Cb;if(!ub)return this.Mc.Zb(Sc.a.zf,
{["Reason"]:Xc.a.Ifa}),8;if(t.AFrameworkApplication.K.$("Box4PartialPromoteDemoteIsEnabled")){b=this.Tjh(h===Fb.a.OF,r,!0);if(1===z)return b?32:8;b&&(Wa=hq.a.Qac(h,r,z,R,ba,ta))}else Wa=hq.a.Qac(h,r,1,R,ba,ta),1!==z&&32===Wa?(b.Cb.qYd(),b=new yf.GraphTransaction(15),b.Db(r.view.rd),Wa=this.Tjh(h===Fb.a.OF,r,!1)?hq.a.Qac(h,r,z,R,ba,ta):8,b.dispose()):1!==z&&8===Wa&&(b.Cb.qYd(),this.ZBk(h,r,ub));return Wa}Tjh(b,h,r){h=h.view.Cb;if(!h||!h.hb.kb)return this.Mc.Zb(Sc.a.zf,{["Reason"]:Xc.a.QFb}),!1;if(h.hb.zI)return this.Mc.Zb(Sc.a.zf,
{["Reason"]:Xc.a.iZe}),!1;h=nw.OutlineElementGeneralizer.$ka(h.hb,!1);if(!h)return this.Mc.Zb(Sc.a.zf,{["Reason"]:Xc.a.ZBd}),!1;let z=!1;for(let R=0;R<h.length;R++){const ba=h.getContext(R),ta=new Nd.GraphIterator;ta.set(ba.node);Xd.SelectionEditor.Jt(ta);if(!vg.OutlineElementReader.Nh(ta))if(r)continue;else return this.Mc.Zb(Sc.a.zf,{["Reason"]:Xc.a.nXa}),!1;if(b?!this.qp.pwb(ta):!this.qp.JYb(ta))if(r)continue;else return this.Mc.Zb(Sc.a.o0b,{["Reason"]:Xc.a.HVe}),!1;z=!0}return r?z:!0}ZBk(b,h,r){const z=
new yf.GraphTransaction(15);try{z.Db(h.view.rd);h=!0;const R=nw.OutlineElementGeneralizer.$ka(r.hb,!1);for(let ba=0;ba<R.length;ba++){const ta=R.getContext(ba),Wa=new Nd.GraphIterator;Wa.set(ta.node);Xd.SelectionEditor.Jt(Wa);if(!vg.OutlineElementReader.Nh(Wa))h=!1;else if(b===Fb.a.OF?this.qp.pwb(Wa):this.qp.JYb(Wa))switch(h=!1,b){case Fb.a.OF:this.qp.rOa(Wa,-1,0);break;case Fb.a.FN:this.qp.KDc(Wa,1)}}if(h){const ba=r.hb.kb;for(r=0;r<ba.length;r++){const ta=ba.J(r);if(ta.vl){const Wa=this.ey.Ndb(ta.node),
ub=Wa.kba;if(b===Fb.a.OF?Wa.DA>ub:Wa.DA<18*ub){const Ib=new Nd.GraphIterator;Ib.set(ta.node);this.g_.Hva(Ib,1,b===Fb.a.OF?Wa.DA>=2.5*ub?Wa.DA-2*ub:ub:Wa.DA<16*ub?Wa.DA+2*ub:18*ub)}}}}}finally{z&&z.dispose()}}}Object(n.a)(Dy,"IndentationActorExtension",null,[545]);var Zw=d(738),tn=d(1202);class xu{constructor(b,h){this.Eo=new Ei.DictionaryPropertySet;this.zqb=!1;this.aya=this.cob=null;this.E4=b;this.dFg=h}get Elb(){return null!=this.mrg?this.mrg:this.mrg=Sa.a.instance.Pa("Box4.ITextFormattingCommands")}get vi(){return null!=
this.skg?this.skg:this.skg=Sa.a.instance.resolve("Box4.IFormattingEditor")}get oc(){return null!=this.htg?this.htg:this.htg=Sa.a.instance.resolve("Box4.Styles.IWACStyleReader")}f2a(){this.zqb||(this.Eo.LRf(),this.cob=null,this.Vpn())}BGk(b){var h;const r=null!==(h=Aj.FormattingReader.Pr(b))&&void 0!==h?h:Aj.FormattingReader.KFd(b.node,b.cpBegin,-1);!r.cache.IA&&(b=r.an)&&(h=new Ei.DictionaryPropertySet,h.Cs(b),h.Cs(this.Eo),h.hasProperty(Ij.a.tB)&&(this.cob=r.paragraph.Lc),this.Eo=h)}hasProperty(b){return this.Eo.hasProperty(b)}PKc(){return 0<
this.Eo.fI()}get UZa(){return this.Eo}freeze(){this.zqb=!0}MEa(){this.zqb=!1}EL(b,h){return this.UZa.ia(b,h)}Sv(b){this.Eo.setValue(We.a.fontSize,this.vi.EZb(b));this.q_()}fontSize(){return this.Eo.ia(We.a.fontSize,Cl.a.OJ)}E6d(b){this.Eo.setValue(We.a.font,b);this.dFg&&this.dFg.execute(h=>{null==h?v.ULS.sendTraceTag(527029267,324,10,"IFontNameFormattingStrategy is null after future execution"):h.E6d(this.Eo)});this.E4&&this.E4.enabled&&(ud.b(40506690,306,50,"InsertionPointFomatting: Set font slot values"),
this.E4.hKn(this.Eo,b));this.q_()}lec(b){this.Eo.setValue(yc.a.we,b);this.E4&&this.E4.enabled&&(ud.b(40506691,306,50,"InsertionPointFomatting: Set font theme slot values"),this.E4.APn(this.Eo,b));this.q_()}Ls(b){b=xq.a.instance.yza(di.a.instance.hb.kb.Qa.node,b);this.Eo.setValue(We.a.fontColor,b);this.q_()}G5(){this.Eo.setValue(We.a.fontColor,cq.a.auto);this.q_()}fontColor(){return this.Eo.ia(We.a.fontColor,cq.a.nil)}Fva(b){this.Eo.setValue(We.a.highlight,parseInt(b,16));this.q_()}Uud(){this.Eo.setValue(We.a.highlight,
cq.a.auto);this.q_()}isBold(){return this.Eo.ia(We.a.bold,!1)}UF(b){this.Eo.setValue(We.a.bold,b);this.q_()}isItalic(){return this.Eo.ia(We.a.italic,!1)}setItalic(b){this.Eo.setValue(We.a.italic,b);this.q_()}isUnderline(){return this.Eo.ia(We.a.underline,!1)}w3(b){this.Eo.setValue(We.a.underline,b);this.Eo.setValue(We.a.underlineType,b?Cl.a.VLb:Cl.a.XX);this.q_()}underlineType(){return this.Eo.ia(We.a.underlineType,Cl.a.XX)}Pga(b){b<Cl.a.VLb||b>Cl.a.XX||(this.Eo.setValue(We.a.underline,b!==Cl.a.XX),
this.Eo.setValue(We.a.underlineType,b),this.q_())}isSuperscript(){return this.Eo.ia(We.a.superscript,!1)}cba(b){this.Eo.setValue(We.a.superscript,b);b&&this.isSuperscript()&&this.Eo.setValue(We.a.subscript,!1);this.q_()}isSubscript(){return this.Eo.ia(We.a.subscript,!1)}Yna(b){this.Eo.setValue(We.a.subscript,b);b&&this.isSubscript()&&this.Eo.setValue(We.a.superscript,!1);this.q_()}isStrikethrough(){return this.Eo.ia(We.a.strikethrough,!1)}x7(b){this.Eo.setValue(We.a.strikethrough,b);this.q_()}isDoubleStrikethrough(){return this.Eo.ia(Ij.a.Es,
!1)}Tdc(b){this.Eo.setValue(Ij.a.Es,b);this.q_()}zNh(){return this.Eo.ia(Ij.a.tB,null)}Ckb(b,h){this.Eo.LRf();this.Eo.setValue(Ij.a.tB,b.id);this.cob=h.Lc;this.q_()}s7(b){let h=We.a.pE;if(xg.a.instance.J(1)){const r=Zw.a.MRd(b);switch(r){case 1:h=yc.a.jEb;break;case 2:h=yc.a.kEb}this.Eo.setValue(yc.a.languageHint,r)}this.Eo.setValue(h,b);this.q_()}language(){let b=We.a.pE;if(xg.a.instance.J(1))switch(this.Eo.ia(yc.a.languageHint,0)){case 1:b=yc.a.jEb;break;case 2:b=yc.a.kEb}return this.Eo.ia(b,0)}vMn(b){this.Eo.setValue(yc.a.noProof,
b);this.q_()}nDb(){return this.Eo.ia(yc.a.noProof,!1)}Ogm(){return this.Eo.hasProperty(yc.a.noProof)}yfm(){return xg.a.instance.J(1)?this.Eo.hasProperty(We.a.pE)||this.Eo.hasProperty(yc.a.jEb)||this.Eo.hasProperty(yc.a.kEb):this.Eo.hasProperty(We.a.pE)}q_(){if(X.a.Ifc){var b=di.a.instance.hb.kb.Qa,h=b.node;if(h===this.aya)this.aya.gk(16,!0);else{this.aya=h;h=this.aya.QX();try{this.aya.Z9(b.cpBegin).Lta=!0}finally{h&&h.dispose()}}}}Vpn(){if(X.a.Ifc&&this.aya){var b=0,h=this.aya.QX();try{for(let r=
this.aya.qa.length-1;0<=r;r--){const z=this.aya.qa.J(r);z.Lta&&(z.Lta=!1,b++,z.isEmpty&&this.aya.qa.removeAt(r))}}finally{h&&h.dispose()}this.aya=null}}IEk(b){if(b.cpBegin!==b.cpEnd)return!1;b=b.node.qa.ji(b.cpBegin);return!!b&&b.Lta}iRe(b){if(this.Elb){this.freeze();var h=new yf.GraphTransaction(7);h.Db(b.node);this.Elb.G6d(b);this.MEa();this.f2a();h.dispose()}}Chf(b){const h=ie.ParagraphReader.text(b.node);return b.cpBegin&&b.cpBegin!==h.length&&!B.a.$u(h.charCodeAt(b.cpBegin))&&tn.a.instance.oYa(h,
b.cpBegin-1)!==b.cpBegin&&Xd.SelectionEditor.ugb(b)?(b=Xd.SelectionEditor.X1(b,!1))?1<b.length||Xd.SelectionEditor.Ek(b.Qa)?b:null:null:null}}Object(n.a)(xu,"InsertionPointFormatting",null,[544]);class $t{constructor(b){this.ga=b}get zc(){return this.ga}Rnk(b,h,r=null){const z=new Ei.DictionaryPropertySet;z.setValue(od.a.Nv,b);z.setValue(od.a.eua,h);r&&z.Cs(r);z.CommandSource="autobulleting";this.zc.Xb(Fb.a.Xz,2,z)}numbering(b,h,r,z,R){const ba=new Ei.DictionaryPropertySet;ba.setValue(od.a.Nv,b);
ba.setValue(od.a.eua,h);ba.setValue(od.a.hNa,r);R&&ba.setValue(ui.a.qP,R);z&&ba.setValue(yc.a.Ur,z);bt.a.bX&&(ba.setValue(ui.a.Bma,"autocorrect"),R&&ba.setValue(ui.a.tfa,R));ba.CommandSource="autonumbering";return 32===this.zc.Xb(Fb.a.tH,2,ba)}}Object(n.a)($t,"ListCommands",null,[543]);var Bp=d(239);class Hs extends Bp.a{constructor(b,h,r,z,R,ba,ta,Wa,ub,Ib,$b){super();this.MTb=this.Fo=this.qGa=null;this.I9m=(fc,Kc)=>{Kc=this.wqa.E0d(this.qGa,Kc);fc.ti(this.Hel);return Kc};this.Hel=(fc,Kc)=>{if(this.Fo.moveNext())return fc=
this.Fo.currentNode,12!==fc.type||fc===this.qGa.node?!0:this.wqa.CVc(fc,Kc);this.gnk();fc.ti(this.Iel);return!0};this.Iel=(fc,Kc)=>{if(this.Fo.moveNext()){const ed=this.Fo.currentNode;return 12!==ed.type?!0:ed===this.qGa.node?(fc.ti(this.J9m),!0):this.wqa.CVc(ed,Kc)}return!1};this.J9m=(fc,Kc)=>{this.wqa.F0d(this.qGa,Kc);return!1};this.init(b);this.ml($b);this.lfb(Wa,h,z,R,ba);this.yD=ba;this._context=r;this.ib=ub;this.Fe=Ib;this.wqa=ta;this.pz=0}run(){this.rWe();this.pz||this.kRn();1===this.pz&&this.Q$m();
2===this.pz&&this.b7n();3===this.pz&&this.T$k()}rWe(){this.ib.hb&&this.ib.hb.kb?1===this.behavior&&(this.wqa.rWe(this._context)?this.ar=32:this.ar=2,this.pz=3):(v.ULS.sendTraceTag(20321351,324,15,"No selection for ignore all"),this.ar=2,this.pz=3)}kRn(){this.Bmk();this.wqa.NZf(this.qGa)?(this.Jlk(),this.pz=1):(this.ar=8,this.pz=3)}Q$m(){this.fF||new Bq.a(this,this.I9m,this.yD);do if(this.fF.run(),this.fF.inProgress&&!this.eh)return;while(this.fF.inProgress);this.Qud();this.pz=2}b7n(){this.wqa.A4f(this)?
this.ar=32:this.ar=8;this.pz=3}T$k(){this.Una()}Bmk(){let b=this.ib.hb.kb;if(b=this.Fe.Pj(b,!0,!1))this.qGa=b.Qa;this.qGa&&this.qGa.node&&(this.MTb=this.wqa.qXh(this.qGa.node))}Jlk(){if(!this.MTb)throw Error.argumentNull("_proofingWholeDocumentRootNode");const b=new eg.a;b.set(this.qGa.node);b.Bb(this.MTb.type);this.Fo=xi.a.Kr(b,this.MTb);this.Fo.Um(Object(u.a)(this.wqa,this.wqa.jfc,"spellErrorFilter"),null)}gnk(){if(!this.MTb)throw Error.argumentNull("_proofingWholeDocumentRootNode");const b=new eg.a;
b.set(this.MTb);this.Fo=xi.a.Xp(b);this.Fo.Um(Object(u.a)(this.wqa,this.wqa.jfc,"spellErrorFilter"),null)}}Object(n.a)(Hs,"ProofingWholeDocumentOperation",Bp.a,[]);var ul=d(293);class Or extends bj{constructor(){super();this.CommandMenuClose=this.CommandMenuOpen=null}}Object(n.a)(Or,"ContextMenuRootProperties",bj,[]);var yt=d(1348);class ft{constructor(b){const h=new Or;h.ImageSideArrow=t.AFrameworkApplication.pr;h.ImageSideArrowClass=Wh.getImageClass("SubmenuFlyoutArrow_13x13x32");h.TextDirection=
Box4Intl.Box4Strings.L_RibbonOptionTextDirection;h.CommandMenuOpen=Fb.a.a0d.toString();this.U2g=new yt.ContextMenuRoot("ContextMenuRootName",h);b.execute(r=>{this.I_.vE=r});this.I_.refresh();t.AFrameworkApplication.ya.pa(ab.a.showContextMenu,Yd.a.frame,$c.ActionManager.Nf);t.AFrameworkApplication.ya.pa(ab.a.Jec,Yd.a.frame,$c.ActionManager.Nf)}get I_(){return this.U2g}dispose(){this.I_&&(this.I_.dispose(),this.U2g=null)}showContextMenu(b,h){this.vKb(b,h.clientPoint,h.gg)}$Zb(b,h,r,z,R){this.I_.$Zb(b,
h,r,z,R)}X2a(b,h,r){Ed.a.EUd(this.I_.fVa?"ShowLegacyContextMenuAndFloatie":"ShowLegacyContextMenu","");vb.App.xa.xdl();this.Ht();this.I_.X2a(b,h,r);this.I_.fVa?t.AFrameworkApplication.ya.processAction(ab.a.Jec,2):t.AFrameworkApplication.ya.processAction(ab.a.showContextMenu,2)}vKb(b,h,r){this.X2a(b,new Sys.UI.Bounds(h.x,h.y,0,0),r)}Ht(){this.I_.root.yl()}T1(){return this.I_.T1()}Jec(b,h,r,z){const R=this.I_;let ba=!1;r=Object(la.a)($s,r);R.fVa=r;z.Kva(b,h);R.ANe?r&&(r.r6m(R,h),ba=!0):(v.ULS.sendTraceTag(4801985,
324,15,"Failed to launch the context menu!  Menu type:  {0}.",z.GPk()),R.fVa=null);return ba}}Object(n.a)(ft,"AContextMenuController",null,[576,9]);class es{}es.tbc="faProofing";es.qCh="EditorMenuSection";Object(n.a)(es,"ContextMenuControlId",null,[]);var ow=d(549);class Xm{constructor(b){this.Fe=b}rWe(b){b=Object(la.a)(ow.a,b);return!!b&&!!b.view&&b.view.ze}NZf(){return!0}E0d(){return!0}CVc(){return!0}F0d(){}A4f(){return!0}jfc(b){if(b.qr)return!0;b=b.role;return 1===b||2===b||3===b||4===b||5===b}qXh(b){if(!b||
!this.Fe)return b;const h=new eg.a;h.set(b);if(this.Fe.Jt(h)){for(;!h.qr;)h.mc();return h.currentNode}return b}}Object(n.a)(Xm,"SimpleProofingWholeDocumentCallBacks",null,[554]);class pp{constructor(b){this.value=b}}Object(n.a)(pp,"RefBool",null,[]);class au{constructor(){this.yFc=this.NFb=null;this.Sej=new pp(!1)}}Object(n.a)(au,"FindNextErrorOperationParam",null,[]);class fs{constructor(){this.Priority=0;this.Context=null;this.Length=this.StartInContext=this.Start=0;this.Metadata=fs.j1k;this.Suggestions=
this.TypeId=this.TraceId=null;this.CritiqueActions=this.SupportedActions=0;this.RevisionId=this.TileId=this.Explanation=this.ExplanationLabel=this.ExplanationTitle=this.CategoryTitle=null;this.Tag=this.Status=this.BucketId=0}}fs.j1k=[];Object(n.a)(fs,"Critique",null,[]);class Rx{constructor(){this.Text=null;this.Level=0;this.Source=null;this.BucketId=this.Action=0;this.Description=null;this.NumberOfInstances=0}}Object(n.a)(Rx,"Suggestion",null,[]);var uz=d(614);class Qh extends Sys.EventArgs{constructor(b,
h,r,z,R,ba){super();this.QFj=b;this.OHj=h;this.PHj=r;this.Pge=z;this.gz=R;this.bnb=ba}}Object(n.a)(Qh,"AugloopProofingContextMenuArgs",Sys.EventArgs,[]);var A=d(338);class W{constructor(b,h,r){this.Noe=b;this.Ns=h;this.sa=r}Erh(b){const [h,r,z]=this.M0h(b);return this.jQh(h,r,z)}Oam(b){return to.a.getTypeNameFor(b.content)===A.a.getTypeName()}jQh(b,h,r){if(r&&this.Oam(r)){const R=r.content;var z=new fs;z.ExplanationTitle=R.explanationTitle;z.Suggestions=this.HKl(r);z.CategoryTitle=R.categoryName;
z.TypeId=R.typeId;z.CritiqueActions=R.critiqueActions;z.Priority=R.priority;r=this.Noe.create(z);z=R.context;r.token=z.substring(R.range.start,R.range.start+R.range.length);r.lcid=Sj.a.pg(R.language).LCID;r.originalText=z;return new uz.a(b,h,r)}return null}HKl(b){var h=b.content.suggestions;b=[];for(const r of h)h=new Rx,h.Action=r.suggestionActions,h.Text=r.text,h.Description=r.description,b.push(h);return b}M0h(b){const h=this.Ns.DIc(b,0),r=b.cpBegin,z=b.cpEnd,R=Xd.SelectionEditor.xf(b);b=ie.ParagraphReader.text(b.node,
0);for(const ba of h)if(R){if(ba.begin<=r&&ba.end>=z)return[ba.begin,ba.end,ba.intent]}else if(ba.begin<=r&&ba.end>=r&&B.a.Uqh(b,ba.end,z))return[ba.begin,ba.end,ba.intent];return[null,null,null]}static GA(){return!!t.AFrameworkApplication.K&&t.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ProofingALV2Migration",!1)}Zjf(b,h,r){const [z,R,ba]=this.M0h(b);ba&&this.sa.raiseEvent(W.Peh,new Qh(b,z,R,h,ba,r))}d7j(b){this.sa.addHandler(W.Peh,b)}B7k(b,h,r){b=this.Ns.RSh(b,0,0,
b.characterData.length);for(let z=0;z<b.count;z++){const R=b.J(z);if(R.intent){const ba=R.intent;if(ba.content&&(0==ba.content.priority||1==ba.content.priority)&&R.begin>=h&&(!r||r(R.intent)))return this.jQh(R.begin,R.end,R.intent)}}return null}}W.Peh="augloopProofingContextMenuActionEventKey";Object(n.a)(W,"AugLoopProofingErrorDetailHelper",null,[]);class fa extends Xm{constructor(b,h,r,z){super(h);this.Xm=b;this.Cvc=r;this.Hwj=z}E0d(b,h){return!this.jxf(b.node,b.cpBegin,h)}CVc(b,h){return!this.jxf(b,
0,h)}F0d(b,h){this.jxf(b.node,0,h);Object(la.a)(au,h)}jxf(b,h,r){r=Object(la.a)(au,r);if(ie.ParagraphReader.nc(b)&&!b.yI)if(Aj.FormattingReader.Pr(Qe.a.Uc(b,h)).cache.nDb)r.Sej.value=!0;else{if(W.GA())return h=this.Hwj.B7k(b,h,this.Cvc),null!=h?(r.NFb=h,r.yFc=b,!0):!1;const z=this.Xm.f2(b);for(let R=0;R<z.length;R++){const ba=z[R];if(ba.begin>=h&&!ba.errorDetails.q_a()&&(!this.Cvc||this.Cvc(ba.errorDetails)))return r.NFb=ba,r.yFc=b,!0}return!1}}}Object(n.a)(fa,"FindNextErrorCallbackSteps",Xm,[]);
var La=d(495);class hb{constructor(b,h,r,z,R,ba,ta,Wa,ub,Ib,$b,fc,Kc,ed,Jd,ge,qe){this.Xyk=(Ve,Bd,he,we,hg)=>{Bd=this.ib.hb.kb;if(!Bd)return this.ld.Zb(Sc.a.zf,{["Reason"]:Xc.a.noSelection}),2;Bd=this.Fe.Pj(Bd,!0,!1);return this.ga.Qf(Bd.Qa,Ve,he,!1,we,hg)};this.YZm=(Ve,Bd,he)=>{if(1===he)return this.ga.processAction(Fb.a.s7,1);this.FKj().E0f();return 32};this.iAa=(Ve,Bd,he)=>{if(1===he)return 32;mf.a.mark(4670);he=this.Xm.jla(Bd);if(this.Qbe(he))return 8;Bd=Bd.node;const we=this.Hc.Rc(15);let hg=
he.begin;" "===ie.ParagraphReader.text(Bd).charAt(hg-1)&&hg--;we.Db(Bd);const Pf=this.Vd.replaceTextRange(Qe.a.createTextRange(Bd,0<he.begin?he.begin-1:0,he.end),"",!0,!1);this.ib.setSelection(Hf.SelectionFactory.xe(Bd,Pf+hg));we.dispose();he.errorDetails.Qlb(Ve);mf.a.mark(4671);return 32};this.ota=(Ve,Bd,he)=>{if(1===he)return 32;v.ULS.sendTraceTag(7660830,324,50,"Ignore spelling error triggerred");if(W.GA())return this.u5a.Zjf(Bd,null,La.b.IgnoreOnce),32;mf.a.mark(4670);he=this.Xm.jla(Bd);if(this.Qbe(he))return 8;
Bd=Bd.node;const we=this.Hc.Rc(15);we.Db(Bd);this.Xm.Ajb(Bd,[he],!0);Bd.setValue(We.a.eZe,!0);we.dispose();he.errorDetails.Qlb(Ve);mf.a.mark(4671);v.ULS.sendTraceTag(7692317,324,50,"Ignore spelling error action succeeded");this.GAm(he);this.NTa.C6h(he,Bd,!0);return 32};this.PGk=(Ve,Bd,he)=>{var we=!this.Ok.T$(Bd);this.Hm&&this.Hm.instance&&this.Hm.instance.HT(Bd)&&(we=!1);if(1===he||!we)return we?32:8;this.ga.processAction(Fb.a.Uva,2);mf.a.mark(4670);we=this.Mnl(Ve);if(0>we)return 8;if(W.GA())return this.u5a.Zjf(Bd,
we,La.b.Apply),32;he=this.Xm.jla(Bd);if(this.Qbe(he))return 8;Bd=Bd.node;var hg=he.errorDetails.suggestions;if(!hg)return this.ld.Zb(Sc.a.Xyb,{["Reason"]:"NoSuggestionsFound"}),mf.a.mark(4671),8;we=we<hg.length?hg[we]:null;if(!we)return this.ld.Zb(Sc.a.Xyb,{["Reason"]:"RequestedSuggestionIsNull"}),mf.a.mark(4671),8;this.qnb.J(4)&&vb.App.ud.Mp&&vb.App.ud.Lq.CG(Bd);we=we.replace("  "," \u00a0");hg=this.Hc.Rc(15);hg.Db(Bd);const Pf=this.Vd.replaceTextRange(Qe.a.createTextRange(Bd,he.begin,he.end),we,
!0,!1,Fb.a.Uva);this.ib.setSelection(Hf.SelectionFactory.xe(Bd,he.begin+we.length+Pf));hg.dispose();he.errorDetails.Qlb(Ve);mf.a.mark(4671);this.Gvm(he);return 32};this.SEn=(Ve,Bd)=>{Bd=this.Xm.jla(Bd);if(this.Qbe(Bd))return 8;Bd.errorDetails.Qlb(Ve);return 32};this.Z9k=(Ve,Bd,he,we,hg)=>{if(!Bd.view.ze)return 2;const Pf=Bd.view;if(!this.ib.hb.kb)return this.ld.Zb(Sc.a.zf,{["Reason"]:Xc.a.noSelection}),2;if(1===he)return 32;const Ej=new au,pn=new fa(this.Xm,this.Fe,this.Cvc,this.u5a);Bd=new Hs(null,
Ve,Bd,he,we,Ej,pn,this.ga,this.ib,this.Fe,null);Bd.eh=!0;Bd.run();if(Bd.isCompleted&&Ej.NFb){if(Bd=Hf.SelectionFactory.xe(Ej.yFc,Ej.NFb.begin),Bd=Hf.SelectionFactory.XC(Bd,Qe.a.Uc(Ej.yFc,Ej.NFb.end)),!this.OWg.instance||!this.OWg.instance.e8m(Ej.NFb,Bd,Pf)){this.ib.setSelection(Bd);let Ol=0;hg&&(Ol=hg.Ww);Pf.g8d=!1;Oe.a.instance.$b(new Ic.a(1,1,1,()=>{this.aDn(Pf,Ol,Ej.yFc,Ej.NFb)}))}}else{const Ol=new te.StandardDialog;Ol.Fd=0;vb.App.zK.rPc?Ol.Sga(CommonUIStrings.l_DefaultDialogTitle,Ej.Sej.value?
Box4Intl.Box4Strings.l_ProofingCompleteNoErrorsWithIgnoredRanges:Box4Intl.Box4Strings.l_ProofingCompleteNoErrors,null):(Ol.Sga(CommonUIStrings.l_DefaultDialogTitle,Box4Intl.Box4Strings.l_ProofingInProgress,null),vb.App.zK.Rqd(()=>{Ol.mma&&(Ol.hide(),this.ga.processAction(Ve,2))}))}return 32};this.a0d=(Ve,Bd,he)=>{if(1===he)return 32;this.Yba&&this.Yba.I_&&(Ve=this.Yba.I_.cjf(es.tbc))&&!Ve.nK&&(Ve.OZ(0),Ve.menu.TJ(0));return 32};this.ga=h;this.Xm=b;this.FKj=r;this.Vd=z;this.Hc=R;this.ib=ba;this.Hm=
ta;this.Fe=Wa;this.NTj=ub;this.Ok=Ib;this.ld=$b;this.u5a=qe;this.Yba=Object(la.a)(ft,fc);this.ARb=Kc.SOc;this.OWg=ed;this.qnb=Jd;this.NTa=ge;this.i6c=new Hl.a;this.i6c.Z(1,Fb.a.S1f);this.i6c.Z(2,Fb.a.Ejf);this.i6c.Z(3,Fb.a.U2f);this.Pjd=new Hl.a;this.Pjd.Z(1,Fb.a.T1f);this.Pjd.Z(2,Fb.a.Fjf);this.Pjd.Z(3,Fb.a.V2f)}Vb(){const b=this.ga,h=this.PGk,r=this.Xyk;b.gb(Fb.a.aZd,kc.a.view,this.YZm,1028);b.pa(Fb.a.iAa,kc.a.Wc,this.iAa);b.pa(Fb.a.ota,kc.a.Wc,this.ota);b.pa(Fb.a.ylb,kc.a.Wc,h);b.pa(Fb.a.zlb,kc.a.Wc,
h);b.pa(Fb.a.Alb,kc.a.Wc,h);b.pa(Fb.a.iLb,kc.a.Wc,h);b.pa(Fb.a.jLb,kc.a.Wc,h);b.pa(Fb.a.iAa,kc.a.view,r);b.pa(Fb.a.ota,kc.a.view,r);b.pa(Fb.a.ylb,kc.a.view,r);b.pa(Fb.a.zlb,kc.a.view,r);b.pa(Fb.a.Alb,kc.a.view,r);b.pa(Fb.a.iLb,kc.a.view,r);b.pa(Fb.a.jLb,kc.a.view,r);b.Vc(Fb.a.iAa,1028);b.Vc(Fb.a.ota,1028);b.Vc(Fb.a.ylb,1028);b.Vc(Fb.a.zlb,1028);b.Vc(Fb.a.Alb,1028);b.Vc(Fb.a.iLb,1028);b.Vc(Fb.a.jLb,1028);b.pa(Fb.a.Uva,Yd.a.frame,$c.ActionManager.Nf);this.ARb&&b.gb(Fb.a.a0d,kc.a.view,this.a0d,1124);
b.gb(Fb.a.FSc,kc.a.view,this.Z9k,1028);b.gb(Fb.a.aOf,kc.a.Gd,this.SEn,1124);this.amn([Fb.a.E9d,Fb.a.S1f,Fb.a.T1f,Fb.a.hJd,Fb.a.Ejf,Fb.a.Fjf,Fb.a.l$d,Fb.a.U2f,Fb.a.V2f,Fb.a.KHi,Fb.a.Lsi,Fb.a.R6i])}amn(b){for(let h=0;h<b.length;h++)this.ga.gb(b[h],kc.a.view,$c.ActionManager.qZ,1028)}nnn(b){this.Cvc=b}Qbe(b){return b?b.errorDetails?!1:(v.ULS.sendTraceTag(7660829,324,10,"Ignore Spelling Error: No suggestions on flagged word"),this.ld.Zb(Sc.a.Xyb,{["Reason"]:"ErrorRangeMissingErrorDetails"}),mf.a.mark(4671),
!0):(v.ULS.sendTraceTag(7660828,324,10,"Ignore Spelling Error: No flagged word"),this.ld.Zb(Sc.a.Xyb,{["Reason"]:"RequestedErrorRangeNotFound"}),mf.a.mark(4671),!0)}GAm(b){let h;({value:h}=this.Pjd.Dc(b.errorDetails.proofingType,0)).returnValue&&(this.ga.processAction(h,2),v.ULS.sendTraceTag(527799886,375,50,"ProofingActor: Logging {0} command for {1} proofingType.",h,b.errorDetails.proofingType))}Mnl(b){switch(b){case Fb.a.ylb:return 0;case Fb.a.zlb:return 1;case Fb.a.Alb:return 2;case Fb.a.iLb:return 3;
case Fb.a.jLb:return 4;default:return-1}}Gvm(b){let h;({value:h}=this.i6c.Dc(b.errorDetails.proofingType,0)).returnValue&&(this.ga.processAction(h,2),v.ULS.sendTraceTag(527799887,375,50,"ProofingActor: Logging {0} command for {1} proofingType.",h,b.errorDetails.proofingType))}aDn(b,h,r,z){b.Waa();(b=r.Ce(b.Tb))?(z=ul.a.rq(b,t.AFrameworkApplication.isRtl?z.begin:z.end),this.NTj.Kva(new Sys.UI.Point(z.x,z.y+z.height),h)):v.ULS.sendTraceTag(5902807,324,50,"Failed to pop up proofing context menu")}}Object(n.a)(hb,
"ProofingActor",null,[]);var Jb=d(339),pc=d(1528);class Pc{constructor(b,h,r,z,R,ba,ta,Wa,ub,Ib){this.Afc=null;this.Nbl="StyleUsageActivity";this.Obl="StylesFloodgateSurveyIsEnabled";this.vJa=($b,fc,Kc,ed)=>{$b=this.jKl($b);return 0>$b||$b>this.Afc.length?2:($b=this.Afc[$b])?t.AFrameworkApplication.ya.Qf(fc,Fb.a.applyStyle,Kc,!0,ed,$b):2};this.iHb=($b,fc,Kc,ed,Jd)=>{$b=!0;fc.contextId!==kc.a.paragraph&&fc.contextId!==kc.a.Gd&&fc.contextId!==kc.a.Wc&&($b=!1);if(1===Kc||!$b)return $b?32:8;if(2===Kc&&
!Jd)return 8;fc=this.oc.Qx(fc.node);Kc=xg.a.instance.J(8);Jd.MenuItems=Jb.a.Fzl(fc,Kc);return 32};this.Vcn=($b,fc,Kc,ed,Jd)=>{$b=!0;fc.contextId!==kc.a.paragraph&&($b=!1);if(1===Kc&&!$b)return 8;fc=fc.node;Kc=this.oc.yo(fc);if(!Kc||!Jd)return v.ULS.sendTraceTag(51218391,324,10,"actionData : {}, graphNode : {}, paragraphStyle : {}",Jd,fc,Kc),8;Jd.WPa.Cs(Kc.$h());return 32};this.cek=($b,fc,Kc,ed,Jd)=>{if(fc.contextId!==kc.a.paragraph)return 8;if(this.Zf.C_a(fc,!1))return this.Mc.Zb(Sc.a.Sm,{["Reason"]:Xc.a.dE}),
8;if(1===Kc)return 32;Kc=fc.node;if(ie.ParagraphReader.hka(Kc)||!Jd)return 8;const ge=this.Zhf(Jd,Kc);if(!ge)return this.Mc.Zb(Sc.a.P_,{["Reason"]:Xc.a.Yyb}),8;if(2!==this.oc.Uw(ge))return 2;$b=new yf.GraphTransaction(15);this.Gj&&this.Gj.isProgressiveStyleEnabled&&this.rF.Uec(Jd);$b.Db(Kc);this.Tj.f2a();this.H7.oM(ge,Kc,!1);const qe=this.oc.Qx(Kc);qe&&this.oc.oe(ge,qe)&&ud.b(593078098,3017,50,"Custom linked style applied by user");Kc.Sr&&(Kc=[Object.assign(new ca.a,{name:"Source",string:"ApplyStyle"})],
Lb.a("TOCFormatting",!0,void 0,Kc));$b.dispose();Jd=B.a.cW(Jd);ed.Lr=Jd>>>16^Jd&65535;ed&&pc.a.Clb&&(ed.xB|=pc.a.xdb(fc.node));return 32};this.Wcn=($b,fc,Kc,ed,Jd)=>{$b=!0;fc.contextId!==kc.a.Gd&&($b=!1);if(1===Kc&&!$b)return 2;fc=Aj.FormattingReader.Pr(fc);fc=Aj.FormattingReader.gta(fc);if(!fc)return 2;if(!Jd)return 8;Jd.WPa.Cs(fc.$h());return 32};this.dek=($b,fc,Kc,ed,Jd)=>{if(fc.contextId!==kc.a.Gd||!xg.a.instance.J(8))return 8;this.Zf.C_a(fc);if(1===Kc)return 32;$b=fc.node;if(!Jd)return 8;const ge=
this.Zhf(Jd,fc.node);if(!ge)return this.Mc.Zb(Sc.a.P_,{["Reason"]:Xc.a.Yyb}),8;if(1!==this.oc.Uw(ge))return 2;Kc=this.oc.Qx($b);if(!Kc)return this.Mc.Zb(Sc.a.P_,{["Reason"]:Xc.a.oGh}),8;if(!Kc.xh(this.oc.rf(ge)))return this.Mc.Zb(Sc.a.P_,{["Reason"]:Xc.a.Yyb}),8;const qe=new yf.GraphTransaction(7);try{if(this.Gj&&this.Gj.isProgressiveStyleEnabled&&this.rF.Uec(Jd),qe.Db($b),this.H7.a9f($b,Kc),this.I3a.s1(fc,Ve=>{this.vi.Wja(Ve);this.vi.Ckb(Ve,ge)}),$b.Sr){const Ve=[Object.assign(new ca.a,{name:"Source",
string:"ApplyStyle"})];Lb.a("TOCFormatting",!0,void 0,Ve)}}finally{qe&&qe.dispose()}Kc&&this.oc.oe(ge,Kc)&&ud.b(593078097,3017,50,"Custom linked style applied by user");Jd=B.a.cW(Jd);ed.Lr=Jd>>>16^Jd&65535;ed&&pc.a.Clb&&(ed.xB|=pc.a.xdb(fc.node));return 32};this.Ucn=($b,fc,Kc,ed,Jd)=>{$b=!0;fc.contextId!==kc.a.Wc&&($b=!1);if(1===Kc&&!$b)return 2;fc=this.H7.oKl(fc);if(!fc)return 2;if(!Jd)return 8;Jd.WPa.Cs(fc.$h());return 32};this.bek=($b,fc,Kc,ed,Jd)=>{if(fc.contextId!==kc.a.Wc||!xg.a.instance.J(8))return 8;
if(this.Zf.C_a(fc,!1))return this.Mc.Zb(Sc.a.Sm,{["Reason"]:Xc.a.dE}),8;if(1===Kc)return 32;var ge=fc.node;if(!Jd)return 8;Kc=this.Zhf(Jd,fc.node);if(!Kc)return this.Mc.Zb(Sc.a.P_,{["Reason"]:Xc.a.Yyb}),8;const qe=this.oc.Uw(Kc);if(1!==qe&&2!==qe)return 2;(fc=this.Tj.Chf(fc))?(fc=di.a.sxb(fc),$b=t.AFrameworkApplication.ya.Qf(fc,$b,2,!1,ed,Jd)):($b=new yf.GraphTransaction(7),this.Gj&&this.Gj.isProgressiveStyleEnabled&&this.rF.Uec(Jd),$b.Db(ge),this.H7.$On(Kc,ge),$b.dispose(),$b=32);ge.Sr&&(fc=[Object.assign(new ca.a,
{name:"Source",string:"ApplyStyle"})],Lb.a("TOCFormatting",!0,void 0,fc));(ge=this.oc.Qx(ge))&&this.oc.oe(Kc,ge)&&ud.b(593078096,3017,50,"Custom linked style applied by user");Jd=B.a.cW(Jd);ed.Lr=Jd>>>16^Jd&65535;return $b};this.Xcn=($b,fc,Kc,ed,Jd)=>{if(xg.a.instance.J(8)){const ge=this.C4c.kna($b,fc,Kc,ed,Jd,null,0);if(2!==ge)return ge}return this.C4c.kna($b,fc,Kc,ed,Jd,null,12)};this.eek=($b,fc,Kc,ed,Jd)=>{const ge={};ge[this.C4c.zFa]=6168;ge[this.C4c.yFa]=6169;let qe=12;if(xg.a.instance.J(8)){if(!fc.view.ze)return 2;
var Ve=fc.view.Cb,Bd=Ve?Ve.Rg:null;if(!Bd)return this.Mc.Zb(Sc.a.zf,{["Reason"]:Xc.a.noSelection}),8;if(this.Tg.Jza($d.ImageReader.WZa,Bd))return this.Mc.Zb(Sc.a.zf,{["Reason"]:Xc.a.SBc}),8;if(this.Tg.swa(ie.ParagraphReader.UW,Bd))return this.Mc.Zb(Sc.a.zf,{["Reason"]:Xc.a.uN}),8;if(this.Zf.g6b(Bd,!1))return this.Mc.Zb(Sc.a.zf,{["Reason"]:Xc.a.dE}),8;Bd=this.oc.Kp();if(Jd&&Bd){const he=Bd.xh(Jd);if(he){const we=this.oc.j2(he,Bd);let hg=this.oc.Uw(he);we&&(Ve=Ve.hb.J(0),Ve.eE&&Ve.Qa.contextId===kc.a.Gd||
2===Ve.length&&Ve.Qa.contextId===kc.a.Gd&&Ve.Tc.contextId===kc.a.endOfParagraph)&&(hg=1,Jd=we.getValue(Ij.a.ja));1===hg?qe=0:3===hg&&(qe=14);!this.oc.oe(he,Bd)&&this.oc.Ad(he)&&(Ve=this.oc.rf(he),ud.b(562317522,3017,50,String.format("{0}: style applied by user",Ve)));this.XEa(this.Nbl,this.Obl)}}}return this.C4c.kna($b,fc,Kc,ed,Jd,ge,qe)};this.iS=h;this.mg=r;this.LM=z;this.Gw=R;this.Ok=ba;this.ld=ta;this.HV=Wa;this.RZj=ub;this.He=Ib}get Gj(){return null!=this.Lqg?this.Lqg:this.Lqg=Sa.a.instance.Pa("Box4.Styles.StyleSettings")}get H7(){return this.iS}get Tg(){return this.LM}get Tj(){return this.Gw}get vi(){return this.mg}get Zf(){return this.Ok}get Mc(){return this.ld}get I3a(){return this.HV}get C4c(){return this.RZj}get oc(){return this.He}Vb(){const b=
t.AFrameworkApplication.ya,h=vb.App.K3a.qth(12);xg.a.instance.J(8)&&(b.pa(Fb.a.applyStyle,kc.a.Gd,this.dek),b.pa(Fb.a.GDa,kc.a.Gd,this.Wcn),b.pa(Fb.a.applyStyle,kc.a.Wc,this.bek),b.pa(Fb.a.GDa,kc.a.Wc,this.Ucn));b.pa(Fb.a.applyStyle,kc.a.paragraph,this.cek);b.pa(Fb.a.applyStyle,kc.a.view,this.eek);b.Vc(Fb.a.applyStyle,1036);b.pa(Fb.a.GDa,kc.a.view,this.Xcn);b.pa(Fb.a.GDa,kc.a.paragraph,this.Vcn);b.Vc(Fb.a.GDa,99);b.pa(Fb.a.iHb,kc.a.view,h);b.pa(Fb.a.iHb,kc.a.paragraph,this.iHb);b.Vc(Fb.a.iHb,1127);
b.gb(Fb.a.rRe,kc.a.view,this.vJa,4);b.gb(Fb.a.sRe,kc.a.view,this.vJa,4);b.gb(Fb.a.tRe,kc.a.view,this.vJa,4);b.gb(Fb.a.uRe,kc.a.view,this.vJa,4);b.gb(Fb.a.vRe,kc.a.view,this.vJa,4);b.gb(Fb.a.wRe,kc.a.view,this.vJa,4);b.gb(Fb.a.xRe,kc.a.view,this.vJa,4);b.gb(Fb.a.mdh,kc.a.view,this.vJa,4);b.gb(Fb.a.ndh,kc.a.view,this.vJa,4);b.gb(Fb.a.odh,kc.a.view,this.vJa,4);this.Afc=Array(10);ki.StyleReader.v7d(this.Afc)}jKl(b){switch(b){case Fb.a.rRe:return 0;case Fb.a.sRe:return 1;case Fb.a.tRe:return 2;case Fb.a.uRe:return 3;
case Fb.a.vRe:return 4;case Fb.a.wRe:return 5;case Fb.a.xRe:return 6;case Fb.a.mdh:return 7;case Fb.a.ndh:return 8;case Fb.a.odh:return 9;default:return-1}}XEa(b,h){t.AFrameworkApplication.K&&t.AFrameworkApplication.K.$(h)&&window.setTimeout(()=>{const r=Sa.a.instance.Za("Common.ISystemInitiatedFeedback");r&&r.execute(z=>{z.logActivity(b,h)})},Pc.zka)}Zhf(b,h){if(b&&h&&ie.ParagraphReader.nc(h))h=this.oc.Qx(h);else return null;return h.xh(b)}get rF(){return null!=this.fkg?this.fkg:this.fkg=Sa.a.instance.resolve("Box4.IFontStylesGalleryCache")}}
Pc.zka=5E3;Object(n.a)(Pc,"StyleActor",null,[]);var hd=d(1852);class Zd{constructor(b){this.ga=b}get zc(){return this.ga}G6d(b,h=!1){this.zc.Qf(b,Fb.a.UZa,2,!0,null,h)}s7(b){this.zc.Xb(Fb.a.s7,2,b)}}Object(n.a)(Zd,"TextFormattingCommands",null,[542]);class Pd{constructor(b,h,r,z){this.LKe=this.D3g=!1;this.w$n=(R,ba,ta)=>{if(2!==ta)return 2;this.D3g||(this.D3g=!0);t.AFrameworkApplication.Hl("Microsoft.Office.Web.SessionSettings.IWacWordPinchZoomSettings");t.AFrameworkApplication.Hl("Microsoft.Office.Web.SessionSettings.IWacWordViewerPinchZoomSettings");
return 32};this.V9m=(R,ba,ta,Wa,ub)=>{if(2!==ta)return 2;this.eHi(ub,!0);return 32};this.U9m=(R,ba,ta,Wa,ub)=>{if(2!==ta)return 2;this.eHi(ub,!1);return 32};this.R$m=(R,ba,ta)=>{if(2!==ta)return 2;if(!this.n7a)return 8;this.n7a.$Xl();return 32};this.Q9m=(R,ba,ta)=>{if(2!==ta)return 2;if(!this.n7a)return 8;this.n7a.cyn();return 32};this.Vma=(R,ba)=>{3===ba.Ww&&Xd.SelectionEditor.Qm(ba.ll.kb)&&(Lb.c(Fb.a.r$n),t.AFrameworkApplication.Hl("Microsoft.Office.Web.SessionSettings.IWacWordExtendPageHeightInTouchSettings"),
this.LKe=!0)};this.ga=b;this.Oa=h;this.n7a=r;this.ib=z}get v$n(){return this.LKe}Vb(){this.ga.gb(ab.a.yO,kc.a.view,this.w$n,4);this.ga&&this.Oa&&(this.Oa.$("TouchImageGrippiesResizedIsEnabled")&&(this.ga.gb(Fb.a.i6f,kc.a.view,this.V9m,4),this.ga.gb(Fb.a.k6f,kc.a.view,this.U9m,4)),this.Oa.$("HideGrippersWhenPinchingIsEnabled")&&(this.ga.gb(ab.a.T7i,kc.a.application,this.R$m,4),this.ga.gb(ab.a.M6e,kc.a.application,this.Q9m,4)),Fm.EventHandlerManager.instance.tmn(()=>{this.vYm()}));vb.App.xa.jb.Ic&&
vb.App.xa.jb.Ic.ze&&vb.App.xa.jb.Ic.yja(()=>{this.dDn()});this.ib&&this.ib.oB(this.Vma)}nfn(){Lb.c(Fb.a.u$n);this.LKe=!0}dDn(){const b=window.performance.now();Pd.sxe&&250>b-Pd.sxe&&1E3<b-Pd.lOg&&(Lb.c(Fb.a.t$n),Pd.lOg=b);this.n7a&&Pd.Qb&&Pd.Qb.Vx(123)&&this.n7a.showFloatie()}L8l(b,h){if(h){var r=null;X.a.aJ&&b&&(r=b.getSelection());b=null;r&&"Caret"===r.type&&(b=r.getRangeAt(0))&&this.n7a&&this.n7a.Sio(b.getBoundingClientRect(),h)}}vYm(){Pd.sxe=window.performance.now()}eHi(b,h){if(b)for(b=b.firstChild;b;){if("SPAN"===
b.tagName&&b.classList.contains(Pd.X_l)){for(b=b.firstChild;b;)this.d$j(b,h),b=b.nextSibling;break}b=b.nextSibling}}d$j(b,h){if(b.classList.contains(Pd.O6h)){const r="WACImageResizeHandleTouch"+this.Ttl(b);h?b.classList.add(Pd.P6h,r):b.classList.remove(Pd.P6h,r)}}Ttl(b){for(const h of b.className.split(" "))if(h.startsWith("WACImageResizeHandle")&&h!==Pd.O6h)return B.a.substring(h,20,h.length);return""}static get Qb(){return null!=Pd.gjg?Pd.gjg:Pd.gjg=Sa.a.instance.Pa("Box4.IFeatureHelper")}}Pd.O6h=
"WACImageResizeHandles";Pd.P6h="WACImageResizeHandlesTouch";Pd.X_l="WACImgSelection";Pd.sxe=0;Pd.lOg=0;Object(n.a)(Pd,"TouchInputActor",null,[541]);class Ye{get zFa(){return hq.a.zFa}get yFa(){return hq.a.yFa}get Xhc(){return hq.a.Xhc}kna(b,h,r,z,R,ba,ta){return hq.a.kna(b,h,r,z,R,ba,ta)}Qac(b,h,r,z,R,ba){return hq.a.Qac(b,h,r,z,R,ba)}static get instance(){Ye._instance||(Ye._instance=new Ye);return Ye._instance}}Ye._instance=null;Object(n.a)(Ye,"ViewActionHandlerProxy",null,[540]);class zg{constructor(b,
h){this.kpiName="VisiMarkersUsage";this.Y5="wwaengidc";this.RT=new Map;this.iZn=(r,z,R,ba,ta)=>{if(1===R)return 32;if(!ta)return 2;this.RT.set("Source",cb.a[this.ga.q6]);this.pMe.WPc?this.RT.set("Action","Removed"):this.RT.set("Action","Applied");Ca.Health.instance.recordKpiUsage(this.kpiName,1,this.Y5,this.RT);r=document.getElementsByTagName("head")[0];if(!this.pMe.N9n(r))return v.ULS.sendTraceTag(593294045,324,15,"Toggling Formatting markers failed"),8;vb.App.xa.hG({ShowVisiMarkers:"ToggleButtonModel"});
return 32};this.qcn=(r,z,R,ba,ta)=>{if(1===R)return 32;ta[Yf.a.On]=this.pMe.WPc;return 32};this.ga=b;this.pMe=h}Vb(){this.ga.gb(Fb.a.d9d,kc.a.application,this.iZn,1);this.ga.gb(Fb.a.CIi,kc.a.application,this.qcn,96)}}Object(n.a)(zg,"VisiMarkersActor",null,[]);class jh{yc(b){b.ha("Box4.Actors.Box4PasteStewardFactory",()=>new Qw(ao.a.GAb,b.resolve("Box4.List.IListEditor"),b.resolve("Box4.List.IListReader"),b.resolve("Box4.Actors.IBox4PasteStewardBridge"))).as("Box4.Actors.IBox4PasteStewardFactory").singleInstance();
b.ha("Box4.Actors.Box4PasteStewardUtils",()=>new qu(t.AFrameworkApplication.K.$("WacPasteBrAsNewParagraphIsEnabled"))).as("Box4.Actors.IBox4PasteStewardUtils").singleInstance();b.ha("Box4.Actors.ClipboardActor",()=>new Yt.ClipboardActor(b.ef("Box4.Actors.IClipboardOperationFactory"),b.resolve("Box4.Actors.ISystemClipboard"),wc.a.instance,b.resolve("Box4.IClipboardDataHelper"),di.a.instance,t.AFrameworkApplication.ya,b.resolve("Box4.IUndoManager"),t.AFrameworkApplication.K,ve.FocusManager.instance(),
b.resolve("Box4.Actors.IClipboardOperationPasteFactory"),b.resolve("Box4.Actors.IClipboardOperationClipboardAccessHelper"),b.resolve("Box4.IEditingDomManager"),b.resolve("Box4.IEditViewStateManager"),t.AFrameworkApplication.a0f(),t.AFrameworkApplication.b4i(),b.resolve("Box4.Actors.PasteFloatiePositionProvider"),Sa.a.instance.resolve("Common.IReactContextualUILauncher"),!!vb.App.instance&&vb.App.instance.BDb)).singleInstance();b.ha("Common.App.ChromeExtensionHelper.IChromeExtensionHelper",()=>new Bv(t.AFrameworkApplication.K)).singleInstance();
b.ha("Box4.Clipboard.ISystemClipboardAccessManagerFactory",()=>new tz(t.AFrameworkApplication.K,b.resolve("Common.App.ChromeExtensionHelper.IChromeExtensionHelper"),b.resolve("Box4.IClipboardDataHelper"),Dl.a.instance)).singleInstance();b.ha("Box4.Clipboard.ISystemClipboardAccessManager",()=>b.resolve("Box4.Clipboard.ISystemClipboardAccessManagerFactory").create()).singleInstance();b.ha("Box4.Actors.ISystemClipboard",()=>new sz(b.resolve("Box4.Clipboard.ISystemClipboardAccessManager"),Ya.InteractiveViewManager.instance,
vb.App.xa.jb,ve.FocusManager.instance(),b.resolve("Box4.IEditingDomManager"),b.resolve("Box4.IEditViewStateManager"),Dl.a.instance,t.AFrameworkApplication.K)).singleInstance();b.ha("Box4.Actors.IDeleteTableSegmentStrategy",()=>new Cy).singleInstance();b.ha("Box4.ISelectionFactory",()=>new Ys.a).singleInstance();b.ha("Box4.IRenderOrderGraphIteratorFactory",()=>new tu).singleInstance();b.ha("Common.IDomElementContentStateFactory",()=>new Vs).singleInstance();b.ha("Box4.Actors.IClipboardOperationPasteOvertypeStrategy",
()=>new Hp(di.a.instance,b.resolve("Box4.IParagraphReader"),b.resolve("Box4.Styles.IWACStyleReader"),xg.a.instance.J(10))).singleInstance();b.ha("Box4.Actors.PastedContentsPostProcessorHelper",()=>new Uw).singleInstance();b.ha("Box4.Actors.PasteFloatiePositionProvider",()=>new ym(di.a.instance,b.resolve("Box4.ITextMetricsAdapter"),Ya.InteractiveViewManager.instance,Ed.a.getElementBounds,b.resolve("Box4.UI.PasteFloatieManager"),!!vb.App.instance&&vb.App.instance.BDb)).singleInstance();b.ha("Box4.Actors.PasteFloatieFeatureSetBuilder",
()=>new Ww(b.resolve("Box4.IClipboardDataHelper"),vb.App.Cv.aI)).singleInstance();b.ha("Box4.Actors.PasteFloatieEventManager",()=>new Vw(b.resolve("Box4.UI.PasteFloatieManager"),b.resolve("Box4.IPasteFloatieEventSource"),Ya.InteractiveViewManager.instance,Xt.a.instance(),t.AFrameworkApplication.ua,b.resolve("Box4.Actors.PasteFloatiePositionProvider"),b.resolve("Common.IAppSettingsManager"),b.resolve("Box4.Actors.PasteFloatieFeatureSetBuilder"),vb.App.Xj.al.Se(12),b.resolve("Box4.Graph.IGraphTransactionManager"),
b.resolve("Common.IReactContextualUILauncher"),!!vb.App.instance&&vb.App.instance.BDb)).singleInstance();b.ha("Box4.Actors.IClipboardOperationPasteFactory",()=>new yv(wc.a.instance,b.resolve("Box4.Actors.InternalClipboard"),b.resolve("Box4.Actors.PasteCoordinator"),uu.a.instance,di.a.instance,t.AFrameworkApplication.ya,b.resolve("Box4.Actors.IClipboardOperationPasteStrategyFactory"),b.ef("Box4.IUndoManager"),b.resolve("Common.IDomElementContentStateFactory"),b.resolve("Box4.Actors.IClipboardOperationPasteOvertypeStrategy"),
b.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance)).singleInstance();b.ha("Box4.Actors.IClipboardOperationCutCopyFactory",()=>new Lx(t.AFrameworkApplication.ya,wc.a.instance,b.resolve("Box4.Actors.InternalClipboard"),b.resolve("Box4.IOutlineElementEditor"),di.a.instance,b.resolve("Box4.Actors.ISystemClipboard"),b.resolve("Box4.IParagraphReader"),Xs.a.instance,b.resolve("Box4.IOutlineElementNavigator"),b.resolve("Box4.Graph.IGraphIteratorFactory"),b.resolve("Box4.IOutlineElementReader"),
b.resolve("Box4.IRenderOrderGraphIteratorFactory"),b.resolve("Box4.ISelectionFactory"),b.resolve("Common.IAppSettingsManager"),b.resolve("Box4.IClipboardDataHelper"),b.Pa("Box4.IFeatureHelper"))).singleInstance();b.ha("Box4.Actors.IClipboardOperationClipboardAccessHelper",()=>new Kx(wc.a.instance,Dl.a.instance,b.resolve("Box4.Actors.ISystemClipboard"),b.resolve("Common.ISimpleOperationFactory"),t.AFrameworkApplication.K.appSettings.ChromeClipboardAccessOperationTimeout)).singleInstance();b.ha("Box4.Actors.IClipboardOperationPasteStrategyFactory",
()=>new Jo(t.AFrameworkApplication.K)).singleInstance();b.ha("Box4.Actors.IClipboardOperationFactory",()=>new Gx(b.resolve("Box4.Actors.InternalClipboard"),t.AFrameworkApplication.ya,t.AFrameworkApplication.Y_f(),wc.a.instance,Xs.a.instance,Dl.a.instance,b.resolve("Box4.Graph.IGraphTransactionFactory"),b.resolve("Box4.Actors.IClipboardOperationPasteFactory"),b.resolve("Box4.Actors.IClipboardOperationCutCopyFactory"),b.resolve("Box4.Actors.IClipboardOperationClipboardAccessHelper"),b.resolve("Box4.Actors.ClipboardOperationWordStrategy"),
b.resolve("Box4.ICannotCutDialog"),b.resolve("Common.ISimpleOperationFactory"),b.resolve("Box4.TrackChange.ITrackChangeReaderFactory").instance,b.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,b.resolve("Box4.IUndoManager"),b.resolve("Box4.IPasteFloatieEventSource"),b.resolve("Common.Utils.Telemetry.ITelemetry"))).singleInstance();b.ha("Box4.Actors.IExternalPasteExecutionManagerFactory",()=>new Ay(b.ef("Box4.Actors.IBox4PasteStewardFactory"),b.ef("Box4.Actors.IBox4ImageStewardFactory"),
b.ef("Box4.Actors.IBox4TableStewardFactory"),b.ef("Box4.Actors.IBox4WordConverterFactory"),b.ef("HtmlImport.IHtmlTranslatorSettings"),b.Pa("Box4.IContentControlCopyPasteHelper"),b.resolve("Common.IAppSettingsManager"),b.resolve("Box4.Actors.IExternalPasteCssConverter"),b.resolve("HtmlImport.IHtmlNormalizerSettings"),b.resolve("Box4.IFormattingPropertyTransitStrategy"),b.resolve("Box4.Actors.IHtmlNormalizerHelper"))).singleInstance();b.ha("Box4.Actors.InternalClipboard",()=>new dt.a(b.resolve("Box4.Images.IImageEditor"),
b.ef("Box4.ITableEditor"),b.resolve("Box4.IOutlineEditor"),b.resolve("Box4.IOutlineElementEditor"),b.resolve("Box4.List.IListEditor"),vb.App.Xj,b.resolve("Box4.IParagraphIndentationReader"),t.AFrameworkApplication.K,b.resolve("Box4.Graph.IGraphNodeFactory"),b.resolve("Box4.Graph.IGraphTransactionFactory"),b.Pa("Box4.IContentControlCopyPasteHelper"),b.resolve("Box4.ITableCellReader"),b.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,b.resolve("Box4.IConstantsProvider").iXi,b.resolve("Box4.IFormattingPropertyTransitStrategy"))).singleInstance();
b.ha("Box4.Actors.IInternalPasteExecutionManagerFactory",()=>new Wu(b.resolve("Box4.Actors.InternalClipboard"),b.Pa("Box4.IContentControlCopyPasteHelper"),new De.a(()=>vb.App.xa.jb.Ic),b.resolve("Box4.IFormattingPropertyTransitStrategy"))).singleInstance();b.ha("Box4.List.IListCommands",()=>new $t(t.AFrameworkApplication.ya)).singleInstance();b.ha("Box4.Actors.PasteCoordinator",()=>new wu(b.resolve("Box4.Actors.InternalClipboard"),b.resolve("Box4.Actors.IInternalPasteExecutionManagerFactory"),b.resolve("Box4.Actors.IExternalPasteExecutionManagerFactory"))).singleInstance();
b.ha("Box4.Actors.Box4ImageStewardFactory",()=>new Zi(b.resolve("Box4.Images.IImageEditor"),t.AFrameworkApplication.uc,b.resolve("Box4.IUndoManager"),b.Pa("Box4.Actors.IImageStewardBridge"),vb.App.xa.notificationBar,b.Pa("Box4.IFeatureHelper"),b.resolve("Common.IAppSettingsManager").$("WordEditorPastePictureFailedImprovementIsEnabled"),b.resolve("Common.IAppSettingsManager").$("NotificationBarImageErrorIsEnabled"),b.resolve("Common.IAppSettingsManager").$("ImageAccessibilityAltTextOnlyIsEnabled"),
b.resolve("Common.IAppSettingsManager").$("LogActionForFailedLocalImagePasteIsEnabled"))).as("Box4.Actors.IBox4ImageStewardFactory").singleInstance();b.ha("Box4.Actors.Box4TableStewardFactory",()=>new Do(Sa.a.instance.resolve("Box4.List.IListEditor"),Sa.a.instance.resolve("Box4.ITableEditor"),b.resolve("Common.IAppSettingsManager").$("PasteComplexTablesIsEnabled"),b.resolve("Common.IAppSettingsManager").$("PasteTableCellMarginImprovementsIsEnabled"))).as("Box4.Actors.IBox4TableStewardFactory").singleInstance();
b.ha("Box4.Actors.ClipboardOperationWordStrategy",()=>new Yn(wc.a.instance,di.a.instance,vb.App.ud,Yh.a.instance,xg.a.instance.J(4))).singleInstance();b.ha("Box4.Actors.Box4WordConverterFactory",()=>new vo(t.AFrameworkApplication.K)).as("Box4.Actors.IBox4WordConverterFactory").singleInstance();b.ha("Box4.Actors.IExternalPasteCssConverter",()=>new Dv(t.AFrameworkApplication.K)).singleInstance();b.ha("Box4.Actors.IHtmlNormalizerHelper",()=>new pz).singleInstance();b.ha("Box4.ISelectionCommands",()=>
new Ds(t.AFrameworkApplication.ya)).singleInstance();b.ha("Box4.ITextFormattingCommands",()=>new Zd(t.AFrameworkApplication.ya)).singleInstance();b.ha("Box4.Actors.AccessibilityActor",()=>new po(b.Za("Box4.Accessibility.IAccessibilityContextManager"),b.resolve("Box4.Proofing.IErrorRangeEditor"))).singleInstance();b.ha("Box4.Actors.InsertionPointFormatting",()=>new xu(b.Pa("Box4.IFontSlotProvider"),b.Za("Box4.Actors.IFontNameFormattingStrategy"))).as("Box4.IInsertionPointFormatting").singleInstance();
b.ha("Box4.UI.PasteFloatieManager",()=>new Kj).as("Box4.UI.IFloatieManager").singleInstance();b.ha("Box4.Actors.ProofingActor",()=>new hb(Sa.a.instance.resolve("Box4.Proofing.IErrorRangeEditor"),t.AFrameworkApplication.ya,()=>Sa.a.instance.resolve("Box4.UI.ILanguageDialog"),Sa.a.instance.resolve("Box4.ICharacterPropertiesEditor"),Sa.a.instance.resolve("Box4.Graph.IGraphTransactionFactory"),di.a.instance,Sa.a.instance.Za("Box4.IExternalSelectionManager"),Xs.a.instance,Sa.a.instance.resolve("Box4.ISelectionContextMenuProvider"),
Yh.a.instance,wc.a.instance,Sa.a.instance.resolve("Box4.IContextMenuController"),Sa.a.instance.resolve("Box4.Proofing.IProofingFeatureConfiguration"),Sa.a.instance.Za("Box4.Actors.IProofingErrorPresenter"),xg.a.instance,Sa.a.instance.resolve("Box4.Proofing.IProofingIgnorePersistenceHelper"),Sa.a.instance.resolve("Box4.UI.AugLoopProofingErrorDetailHelper"))).singleInstance();b.ha("Box4.Actors.StyleActor",()=>new Pc(Sa.a.instance.resolve("Box4.ICharacterPropertiesEditor"),Sa.a.instance.resolve("Box4.Styles.IWACStyleEditor"),
Sa.a.instance.resolve("Box4.IFormattingEditor"),sm.ContextSetEditor.instance,Sa.a.instance.resolve("Box4.IInsertionPointFormatting"),Yh.a.instance,wc.a.instance,Sa.a.instance.resolve("Box4.TextFormattingHelper"),Ye.instance,Sa.a.instance.resolve("Box4.Styles.IWACStyleReader"))).singleInstance();b.ha("Box4.Actors.StyleContextMenuActor",()=>new bs(Sa.a.instance.resolve("Box4.IUpdateStyleManager"),Sa.a.instance.resolve("Box4.Styles.IWACStyleReader"),t.AFrameworkApplication.ya)).singleInstance();b.ha("Box4.Actors.TextFormattingActor",
()=>new hd.a(b.resolve("Box4.Actors.IFormattingViewOperationFinishedStageProcessor"),b.resolve("Box4.IBox4GraphWriter"),b.Pa("Box4.IFontSlotProvider"),b.Pa("Box4.IContentControlChpHelper"))).singleInstance();b.ha("Box4.Actors.AutoCorrectActor",()=>new St(t.AFrameworkApplication.ya,wc.a.instance,()=>Sa.a.instance.resolve("Box4.UI.IAutoCorrectOptionsDialog"))).singleInstance();b.ha("Box4.Actors.TouchInputActor",()=>new Pd(t.AFrameworkApplication.ya,t.AFrameworkApplication.K,cs.GrippersManager.instance,
di.a.instance)).as("Box4.ITouchInputActor").singleInstance();b.register(Cv,"Box4.VisiMarkersOperation").as("Box4.IVisiMarkersOperation").singleInstance();b.ha("Box4.Actors.VisiMarkersActor",()=>new zg(t.AFrameworkApplication.ya,b.resolve("Box4.IVisiMarkersOperation"))).singleInstance();b.ha("Box4.Actors.IndentationActorExtension",()=>new Dy).as("Box4.Actors.IIndentationActorExtension").singleInstance()}}Object(n.a)(jh,"Box4ActorsComponentConfiguration",null,[2]);var Gj=d(226),vj=d(1060);const uo=
()=>{const b=Fn;t.AFrameworkApplication.ya.pa(Fb.a.y5e,kc.a.embeddedFile,b);t.AFrameworkApplication.ya.pa(Fb.a.y5e,kc.a.H1b,b);t.AFrameworkApplication.ya.pa(Fb.a.x5e,kc.a.embeddedFile,Fl);t.AFrameworkApplication.ya.pa(Fb.a.x5e,kc.a.H1b,Fl)},Fn=(b,h,r)=>vb.App.Bzd?8:2===r?(b=new te.StandardDialog,b.Fd=4,b.tU(1),b.Ve(1,Box4Intl.Box4Strings.l_DownloadEmbeddedFileYesButton),b.Ve(2,Box4Intl.Box4Strings.l_DownloadEmbeddedFileNoButton),b.P0f(Box4Intl.Box4Strings.l_DownloadEmbeddedFileTitle,Box4Intl.Box4Strings.l_DownloadEmbeddedFileMessage,
cr),32):2,cr=b=>{1===b&&t.AFrameworkApplication.ya.processAction(Fb.a.x5e,2)},Fl=(b,h,r)=>{if(vb.App.Bzd)return 8;if(1===r)return h.node.hasProperty(We.a.embeddedFileContainer)?32:2;if(2===r&&(h.contextId===kc.a.view&&h.view.Cb&&(h=h.view.Cb.Rg),Gj.isEmbeddedFileOrFloatingEmbeddedFileContext(h))){b=vj.a.Orl(h.node);Ga.a.kQn();try{zt(b)}catch(z){v.ULS.sendTraceTag(37515617,339,15,"Window.Open failed with error: {0}",z)}}return 32},zt=b=>{Ed.a.Cm(b,void 0,void 0,"EmbeddedFileActor.SaveFile")};var Gv=
d(762),gs=d(509),yu=d(1188),Zu=d(1203);class xr{constructor(b){this.RU=null;this.Ufa=(h,r,z,R,ba)=>{if(1===z)return 32;t.AFrameworkApplication.ya.Xb(Fb.a.H1a,2,ba);h=ba&&0<=ba.fontColor&&16777215>=ba.fontColor?ba.fontColor:0;vb.App.xa.qw();(new yu.a(xr.qoh,Fb.a.Kga)).y0c(h);return 32};this.hHb=(h,r,z,R,ba)=>{if(1===z)return 32;if(2===z&&!ba)return 8;h=xr.Te.eHd(r);r=new Gv.a;z=null;32===t.AFrameworkApplication.ya.Xb(Fb.a.H1a,2,r)&&r&&(z=r.fontColor);R="";z&&!r.L1b&&(R=cq.a.MC(z)||"");this.zJh.vdc=
R;h=this.zJh.XDd(h,vb.App.rZb);if(!h)return 8;ba.MenuItems=h;v.ULS.sendTraceTag(595153826,340,50,"Font color dropdown menu is opened.");return 32};this.Xye=b}get zJh(){this.RU||(this.RU=new Zu.a(xr.qoh),this.GZa(this.RU));return this.RU}GZa(b){b.cda(1,Fb.a.G5);b.cda(3,Fb.a.Ls);b.cda(4,Fb.a.Ls);b.cda(5,Fb.a.Kga);b.cda(6,Fb.a.Ufa);b.aXb(this.Xye,1)}Vb(){const b=t.AFrameworkApplication.ya;b.pa(Fb.a.Ufa,kc.a.view,this.Ufa);b.pa(Fb.a.hHb,kc.a.view,this.hHb);b.Vc(Fb.a.hHb,1127)}static Lsl(){return new xr(gs.a.instance)}static get instance(){return null!=
xr.$lg?xr.$lg:xr.$lg=xr.Lsl()}static get Te(){return ne.PageReader.instance}}xr.qoh="Font";Object(n.a)(xr,"FontColorActor",null,[]);class gt{constructor(b){this.Ufa=(h,r,z,R,ba)=>{if(1===z)return 32;t.AFrameworkApplication.ya.Xb(Fb.a.H1a,2,ba);h=ba&&0<=ba.highlight&&16777215>=ba.highlight?ba.highlight:0;vb.App.xa.qw();(new yu.a("Highlighter",Fb.a.r7)).y0c(h);return 32};this.ga=b}Vb(){this.ga.pa(Fb.a.BBi,kc.a.view,this.Ufa)}static Aul(){return new gt(t.AFrameworkApplication.ya)}static get instance(){return null!=
gt.Lmg?gt.Lmg:gt.Lmg=gt.Aul()}}Object(n.a)(gt,"HighlighterColorActor",null,[]);var Cp=d(299),bu;(function(b){b.Heading="Heading";b.Bookmark="Bookmark";b.Url="Url";b.RecentLinks="RecentLinks"})(bu||(bu={}));Object(n.b)("InsertLinkUserActivitySource",bu);class ai{constructor(b,h,r){this.wpb=this.Ym=this.nl=null;this.Epc=!1;this.yD=null;this.Ef=Ya.InteractiveViewManager.instance.xd;this.Wk=b;this.nl=r;this.yD=h;ai.m1&&Xd.SelectionEditor.Ek(b)&&(b=Xd.SelectionEditor.V2c(this.Wk),Xd.SelectionEditor.Ek(b)?
this.Wk=b:v.ULS.sendTraceTag(41522313,324,15,"Should not reach here, the selectedContext should be textRangeContext after trimleadinglinebreak."));b=Xd.SelectionEditor.JLb(this.Wk);Xd.SelectionEditor.Ek(b)&&(this.Wk=b)}get zta(){return null!=this.Zmg?this.Zmg:this.Zmg=Sa.a.instance.Pa("Box4.IInternalLinkManager")}get Nj(){return this.Ym||(this.Ym=Sa.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance)}get titleText(){return Box4Intl.Box4Strings.l_InsertLinkTitle}get H8h(){return Box4Intl.Box4Strings.l_InsertLinkButtonText}dispose(){}NFh(b,
h,r){if(h!==this.Wk.cpEnd||b!==this.Wk.cpBegin)b=Hf.SelectionFactory.DN(r,b,h),this.Ef.Cb.setSelection(b),this.Wk=Xd.SelectionEditor.JLb(b.Qa.clone())}FPh(b){const h=Pg.HyperlinkReader.E3b(this.Wk);let r=this.Wk.cpBegin,z=this.Wk.cpEnd,R="";if(!h.length)return this.wpb=b.substring(this.Wk.cpBegin,this.Wk.cpEnd),{returnValue:!0,M5d:R,KBd:r,LBd:z,ELd:h};if(h[0].hyperlink){let ba,ta=0,Wa=Math.max(0,b.length-1),ub=0;for(let Ib=0;Ib<h.length;Ib++)h[Ib].cpBegin>=ta&&({cpBegin:ba,cpEnd:ta}=ai.xI.k$(this.Wk,
h[Ib]),Wa=Math.min(ba,Wa),ub=Math.max(ta,ub));r=Math.min(Wa,r);z=Math.max(ub,z);this.wpb=b.substring(r,z);r===Wa&&(R=h[0].hyperlink.url);return{returnValue:!0,M5d:R,KBd:r,LBd:z,ELd:h}}return{returnValue:!1,M5d:R,KBd:r,LBd:z,ELd:h}}E6f(b){xg.a.instance.J(3)&&ai.Qd.D6f(b)}FMd(b,h){if(this.Ef.Qr){var r=Pg.HyperlinkReader.E3b(this.Wk);var z=this.Ef.Cb.hb.kb;if(z){z=z.Qa;ie.ParagraphReader.gm(z)&&(z=Qe.a.createTextRange(z.node,0,ie.ParagraphReader.textLength(z.node)));if(ai.m1&&Xd.SelectionEditor.Ek(z)){var R=
Xd.SelectionEditor.V2c(z);Xd.SelectionEditor.Ek(R)?z=R:v.ULS.sendTraceTag(41522316,324,15,"Should not reach here, the selectedContext should be textRangeContext after trimleadinglinebreak.")}R=Xd.SelectionEditor.JLb(z);Xd.SelectionEditor.Ek(R)&&(z=R);if(0!==b&&32===t.AFrameworkApplication.ya.Qf(z,Fb.a.insertHyperlink,1,!0,null,null)&&this.Wk.equals(z)){mf.a.mark(5562);xg.a.instance.J(4)&&vb.App.ud&&vb.App.ud.Mp&&this.Ef.Cb.zWb();b=new yf.GraphTransaction(15);b.Db(this.Wk.node);this.Wk.node.YG().AF.y9(4);
z=h.txtDisplay;R=!1;if(null!=h.linkurl)if(R=!0,h.isHeading){l(this.yD,"Heading");const ba=h.paragraphNode,ta=h.startCp,Wa=h.endCp;h=this.nl.NMh(ba);this.nl.HWb(h,ta,Wa,ba,ba,!1)}else l(this.yD,"Bookmark"),h=h.linkurl;else l(this.yD,"Url"),h=h.txtLink.trim();this.insertLink(z,h,r,R);b.Al=Fb.a.insertHyperlink;b.dispose();mf.a.mark(5563);this.Wk.node.ucb();this.vS()}else this.Ef.RX()}else v.ULS.sendTraceTag(41522314,324,50,"InsertLinkDialog:InsertLinkDialogHandler - CurrentSelection is null.")}}jcj(b,
h,r,z,R,ba=!1){z?(z=Qe.a.createTextRange(this.Wk.node,this.Wk.cpBegin,this.Wk.cpBegin+b.length),ai.hyperlinkEditor.iCh(z,r,h),b=Hf.SelectionFactory.xe(this.Wk.node,this.Wk.cpBegin+b.length)):(ai.hyperlinkEditor.Ohb(this.Wk,2),this.Nj.zkb(this.Wk,2),r=Qe.a.Uc(this.Wk.node,this.Wk.cpEnd),ai.characterPropertiesEditor.replaceTextRange(r,b,!0),z=Qe.a.createTextRange(this.Wk.node,this.Wk.cpEnd,this.Wk.cpEnd+b.length),ai.hyperlinkEditor.NG(z,h,R,!1,!0,ba),b=Hf.SelectionFactory.xe(this.Wk.node,this.Wk.cpEnd+
b.length));b&&this.Ef.Cb.setSelection(b)}insertLink(b,h,r,z=!1){var R=null;b||(b=h,t.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.RemoveLinkUrlLineBreak",!0)&&(b=b.replace(/[\r\n\v]/g,"")));if(h&&(!r.length||h!==r[0].hyperlink.url)&&!z){h=Pg.HyperlinkReader.FLa(h);var ba="";this.zta&&({CRf:ba}=this.zta.K6f(h)).returnValue&&(h=ba)}this.Epc||(b=ai.hyperlinkEditor.Fun(b));let ta=!1;ba=!1;if(h){R=0<r.length;var Wa=!0;ai.tfm&&(Wa=ie.ParagraphReader.text(this.Wk.node).substring(this.Wk.cpBegin,
this.Wk.cpEnd)!==b);if(ai.Qd.ng&&1===r.length&&!r[0].hyperlink.GF&&!(r[0].cpBegin>this.Wk.cpBegin&&r[0].cpEnd<=this.Wk.cpEnd)){this.jcj(b,h,r[0].hyperlink,!Wa,R,z);return}if(R)for(var ub=0;ub<r.length;ub++)r[ub].hyperlink.GF&&(ba=!0),ai.hyperlinkEditor.RQ(this.Wk.node,r[ub].hyperlink,!1);Wa&&ai.characterPropertiesEditor.replaceTextRange(this.Wk,b,!ba);Wa||!ai.Qd.ng||ba||this.Nj.zkb(this.Wk,1);r=Qe.a.createTextRange(this.Wk.node,this.Wk.cpBegin,this.Wk.cpBegin+b.length);ai.hyperlinkEditor.NG(r,h,R,
ba,!0,z);R=Hf.SelectionFactory.xe(this.Wk.node,this.Wk.cpBegin+b.length)}else if(0<r.length){Wa=r[0];const Ib=({cpBegin:z,cpEnd:ub}=ai.xI.k$(this.Wk,Wa)).returnValue;Wa.hyperlink.GF&&(ba=!0);h?Wa.hyperlink.Ceb?(h!==Wa.hyperlink.url&&(ai.Qd.ng&&!ba?(r=Qe.a.createTextRange(this.Wk.node,z,z+b.length),ai.hyperlinkEditor.iCh(r,Wa.hyperlink,h)):ai.xI.hjo(h,Ib)),b!==this.wpb&&(ai.characterPropertiesEditor.replaceTextRange(Qe.a.createTextRange(this.Wk.node,z,ub),b,!0),h=Qe.a.createTextRange(this.Wk.node,
z,z+b.length),this.E6f(h),R=Hf.SelectionFactory.xe(this.Wk.node,z+b.length),ta=!0)):ai.Qd.ng&&!ba?(z=ie.ParagraphReader.text(this.Wk.node).substring(this.Wk.cpBegin,this.Wk.cpEnd)===b,this.jcj(b,h,r[0].hyperlink,z,!1)):(ai.xI.dSf(this.Wk,Ib),ai.characterPropertiesEditor.replaceTextRange(Qe.a.createTextRange(this.Wk.node,z,ub),b,!ba),r=Qe.a.createTextRange(this.Wk.node,z,z+b.length),ai.hyperlinkEditor.NG(r,h,!1,ba),R=Hf.SelectionFactory.xe(this.Wk.node,z+b.length)):ai.hyperlinkEditor.RQ(Wa.paragraph,
Wa.hyperlink)}(ta||ba)&&ai.Qd.zs(ba?2:7);R&&this.Ef.Cb.setSelection(R);vb.App.$ao()}static get hyperlinkEditor(){return ai.tC||(ai.tC=Sa.a.instance.resolve("Box4.IHyperlinkEditor"))}static get characterPropertiesEditor(){return ai.Vd||(ai.Vd=Sa.a.instance.resolve("Box4.ICharacterPropertiesEditor"))}static get Qd(){return ai.Hd||(ai.Hd=Sa.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance)}static get xI(){return ai.lIg||(ai.lIg=Sa.a.instance.resolve("Box4.IHyperlinkStrategy"))}static get tfm(){null==
ai.Bue&&(ai.Bue=t.AFrameworkApplication.K?t.AFrameworkApplication.K.$("KeepHyperlinkFormatFixIsEnabled"):!1);return ai.Bue}static get aDb(){null==ai.Bqb&&(ai.Bqb=t.AFrameworkApplication.K?t.AFrameworkApplication.K.$("HyperlinkUrlValidationIsEnabled"):!1);return ai.Bqb}static get m1(){null==ai.HU&&(ai.HU=t.AFrameworkApplication.K?t.AFrameworkApplication.K.$("AddHyperlinkWhenSelectionContainsLineBreak"):!1);return ai.HU}}ai.tC=null;ai.Vd=null;ai.Hd=null;ai.lIg=null;ai.Bue=null;ai.Bqb=null;ai.HU=null;
ai.source="Source";ai.Hoh="CommandingInterface";ai.lyb="DisplayText";ai.url="Url";ai.id="InsertLinkDialog";Object(n.a)(ai,"AInsertLinkDialog",null,[9]);class Pr{static get vg(){return Wc.a.Px(Pr.sl,Box4Intl.Box4Strings.l_InsertLinkDisplayText,Box4Intl.Box4Strings.l_InsertLinkAddress)}}Pr.sl="<div class='WACDialogRow' id='block2'> <label id='label2' class='WACDialogLabel' for='txtDisplay' >{0}</label> <input type='text' id='txtDisplay' class='WACDialogInput' autocomplete=\"off\"/> </div> <div class='WACDialogRow' id='block1'> <label id='label1' class='WACDialogLabel' for='txtLink' >{1}</label> <input type='text' id='txtLink' class='WACDialogInput' autocomplete=\"off\"/> </div>";
Object(n.a)(Pr,"InsertLinkDialogHtml",null,[]);class Qr extends ai{constructor(b,h){super(b,h);this.jg=new Wc.a;this.jg.kg=ai.id;let r=this.wpb="";var z=ie.ParagraphReader.text(this.Wk.node);let R=this.Wk.cpBegin,ba=this.Wk.cpEnd;({M5d:r,KBd:R,LBd:ba,ELd:z}=this.FPh(z));(h="object"===typeof h?h:null)&&(h[ai.source]&&h[ai.source]===ai.Hoh||h[ai.url]&&h[ai.lyb])?this.insertLink(h[ai.lyb],h[ai.url],z):(z[0]&&this.NFh(R,ba,z[0].paragraph),this.jg.vg=Pr.vg,""===r.trim()&&this.jg.Ve(1,this.H8h),h={["txtLink"]:r,
["txtDisplay"]:this.wpb},this.jg.tzd=Object(u.a)(this,this.S1,"dialogDefaultEnterKeyHandler"),this.jg.szd=Object(u.a)(this,this.S1,"dialogDefaultEnterKeyHandler"),this.jg.Wh(this.titleText,Object(u.a)(this,this.FMd,"insertLinkDialogHandler"),h),ai.aDb&&(h=document.getElementById("txtLink"),Bf.a.addHandler(h,jb.a.input,Object(u.a)(this,this.X0a,"onLinkChanged")),Bf.a.addHandler(h,jb.a.change,Object(u.a)(this,this.X0a,"onLinkChanged"))),document.getElementById("txtLink").focus(),ai.m1?0<Md.g(Qe.a.pL(R,
ba,!1,this.Wk.node)).length&&(this.Epc=!0,document.getElementById("txtDisplay").disabled=!0):1>=z.length&&ai.xI.Fqh(b,z[0],1===z.length)&&(this.Epc=!0,document.getElementById("txtDisplay").disabled=!0))}X0a(){if(this.jg){const b=document.getElementById("txtLink");this.jg.Iga(1,!b||!b.value.length||Pg.HyperlinkReader.QMa(b.value))}}S1(b){return this.jg?ai.aDb?this.jg.ZMh(this.jg.oPb)?this.jg.S1(b):!1:this.jg.S1(b):!1}vS(){if(ai.aDb){const b=document.getElementById("txtLink");b&&(Bf.a.removeHandler(b,
jb.a.change,Object(u.a)(this,this.X0a,"onLinkChanged")),Bf.a.removeHandler(b,jb.a.input,Object(u.a)(this,this.X0a,"onLinkChanged")))}this.jg&&(this.jg=null)}}Object(n.a)(Qr,"InsertLinkDialog",ai,[]);class Tm{constructor(b,h,r,z,R){this.linkurl=b;this.isHeading=h;this.startCp=r;this.endCp=z;this.paragraphNode=R}}Object(n.a)(Tm,"HeadingDataForLinkDialog",null,[]);class $w{constructor(b,h){this.linkurl=b;this.isHeading=h}}Object(n.a)($w,"BookmarkDataForLinkDialog",null,[]);class ax{constructor(b,h,r,
z,R,ba){this.key=b;this.name=h;this.startIndex=r;this.count=z;this.level=R;this.isCollapsed=ba}}Object(n.a)(ax,"GroupHeaderDataForLinkDialog",null,[]);class Sx{constructor(b,h){this.selectedIndex=b;this.selectedGroupId=h}}Object(n.a)(Sx,"SelectedItemFromLinkDialogGroupedList",null,[]);class bx extends ai{constructor(b,h,r,z,R){super(b,h,z);this.Gne=r;this.Ih=R;const ba=new Wc.a(!1,!1,!0);r={};r.displayTextLabel=Box4Intl.Box4Strings.l_InsertLinkDisplayText;r.addressLabel=Box4Intl.Box4Strings.l_InsertLinkAddress;
r.insertInternalLinkEnabled=!0;r.enterLinkTabLabel=Box4Intl.Box4Strings.l_EnterLinkText;r.thisDocumentTabLabel=Box4Intl.Box4Strings.l_ThisDocumentText;r.groupedList=this.Ktl();var ta=this.wpb="";ta=ie.ParagraphReader.text(this.Wk.node);z=this.Wk.cpBegin;R=this.Wk.cpEnd;let Wa;({M5d:ta,KBd:z,LBd:R,ELd:Wa}=this.FPh(ta));if((h="object"===typeof h?h:null)&&(h[ai.source]&&h[ai.source]===ai.Hoh||h[ai.url]&&h[ai.lyb]))this.insertLink(h[ai.lyb],h[ai.url],Wa);else{Wa[0]&&this.NFh(z,R,Wa[0].paragraph);h=CommonUIStrings.l_DialogOk;
""===ta.trim()&&(h=this.H8h);ba.Ve(1,h);ta&&ta.startsWith(B.a.qab)?(h=this.jIl(ta,r.groupedList))?r.groupedList.selectedItem=h:r.txtLink=ta:r.txtLink=ta;r.txtDisplay=this.wpb;ai.m1?0<Md.g(Qe.a.pL(z,R,!1,this.Wk.node)).length&&(this.Epc=!0,r.textDisplayDisabled=!0):1>=Wa.length&&ai.xI.Fqh(b,Wa[0],1===Wa.length)&&(this.Epc=!0,r.textDisplayDisabled=!0);var ub={["id"]:ai.id,["bodyControls"]:r};this.Ih.Pd(()=>{ba.Wh(this.titleText,Object(u.a)(this,this.FMd,"insertLinkDialogHandler"),ub)},"RILD:IAS")}}jIl(b,
h){h=h.items;const r=b.substring(B.a.qab.length),z=this.nl.xgf(r);b=-1;let R=0;for(let ba=0;ba<h.length;ba++)if(h[ba].isHeading&&0!=z.count&&h[ba].paragraphNode.id==z.J(0).id){b=ba;break}else if(!h[ba].isHeading&&h[ba].linkurl==r){b=ba;R=1;break}h=new Sx(b,R);return-1!=b?h:null}Ktl(){const b={};let h=[],r=0,z=0;var R=this.Gne.PRh();null!=R&&(r=R.count,h=h.concat(this.pul(R)));R=this.nl.eHc(!1);null!=R&&(z=R.count,h=h.concat(this.zjl(R)));b.groups=this.gul(r,z);b.items=h;return b}gul(b,h){const r=
[];let z=new ax("ThisDocumentTabHeadings",Box4Intl.Box4Strings.l_InsertLinkHeadings,0,b,0,!0);r.push(z);b=new ax("ThisDocumentTabBookmarks",Box4Intl.Box4Strings.l_InsertLinkBookmarks,b,h,0,!0);r.push(b);return r}pul(b){const h=[];for(const r of b)b=new Tm(r.characterData,!0,r.begin,r.end,r.paragraphNode),h.push(b);return h}zjl(b){const h=[];for(const r of b)b=r.Og(yc.a.Ts).toString(),b=new $w(b,!1),h.push(b);return h}vS(){}}Object(n.a)(bx,"ReactInsertLinkDialog",ai,[]);class lr{constructor(){this.bqa=
!!t.AFrameworkApplication.ua&&t.AFrameworkApplication.ua.Sb.KA}auh(b,h,r,z){this.bqa?new bx(b,h,r,z,Cp.a.instance):new Qr(b,h)}static get instance(){return null!=lr.Flg?lr.Flg:lr.Flg=new lr}}Object(n.a)(lr,"InsertLinkDialogFactory",null,[575]);class Mn extends Wc.a{constructor(b){super();this.X0a=()=>{const h=document.getElementById("txtLink");this.Iga(1,!h||!h.value.length||Pg.HyperlinkReader.QMa(h.value))};this.FMd=(h,r)=>{if(this.Ef.Qr){var z=this.Ef.Cb.hb.kb;if(z)if(z.equals(this.Ps)&&0!==h){h=
new yf.GraphTransaction(15);h.Db(this.gS[0].node);for(z=0;z<this.gS.length;z++)this.gS[z].node.YG().AF.y9(4);z=r.txtLink.trim();r=this.jSk();z=this.F5l(z);(r||z)&&Mn.Qd.zs(7);this.hide();h.dispose()}else this.Ef.RX()}};this.gS=b;this.Ef=Ya.InteractiveViewManager.instance.xd;this.Ps=this.Ef.Cb.hb.kb;this.E9e=b[0].cpBegin;this.tvf=b[b.length-1].cpEnd;this.kg="InsertMultiParagraphLinkDialog";b=this.oio();this.showDialog("",b)}showDialog(b,h){v.ULS.sendTraceTag(41261264,324,50,"Insert multiple paragraph link dialog shows.");
this.vg=Pr.vg;""===h.trim()&&this.Ve(1,Box4Intl.Box4Strings.l_InsertLinkButtonText);this.Wh(Box4Intl.Box4Strings.l_InsertLinkTitle,this.FMd,{["txtLink"]:h,["txtDisplay"]:b});document.getElementById("txtLink").focus();document.getElementById("txtDisplay").disabled=!0;Mn.aDb&&(b=document.getElementById("txtLink"),Bf.a.addHandler(b,jb.a.input,this.X0a),Bf.a.addHandler(b,jb.a.change,this.X0a))}hide(){if(Mn.aDb){const b=document.getElementById("txtLink");b&&(Bf.a.removeHandler(b,jb.a.change,this.X0a),
Bf.a.removeHandler(b,jb.a.input,this.X0a))}super.hide()}S1(b){return Mn.aDb?this.ZMh(this.oPb)?super.S1(b):!1:super.S1(b)}oio(){let b;var h="";const r=this.gS.length,z=Pg.HyperlinkReader.ZC(this.gS[0],!1);0<z.length&&({cpBegin:R,cpEnd:b}=Mn.xI.k$(this.gS[0],z[0]),R<=this.gS[0].cpBegin&&(h=z[0].hyperlink.url),this.E9e=Math.min(this.E9e,R));var R=Pg.HyperlinkReader.ZC(this.gS[r-1],!1);0<R.length&&({cpBegin:R,cpEnd:b}=Mn.xI.k$(this.gS[r-1],R[R.length-1]),this.tvf=Math.max(this.tvf,b));this.Gbo(this.E9e,
this.tvf);return h}Gbo(b,h){const r=this.gS.length;if(b!==this.gS[0].cpBegin||h!==this.gS[r-1].cpEnd){b=Qe.a.Uc(this.gS[0].node,b);b=Hf.SelectionFactory.eo(b);h=Qe.a.Uc(this.gS[r-1].node,h);h=Hf.SelectionFactory.XC(b,h);b=this.P_h(h.Qa.clone());const z=this.P_h(h.Tc.clone());b&&z&&(this.gS[0]=b,this.gS[r-1]=z,this.Ef.Cb.setSelection(h),this.Ps=h)}}F5l(b){if(!b)return!1;b=Pg.HyperlinkReader.FLa(b);for(let r=0;r<this.gS.length;r++){var h=this.gS[r];if(Mn.m1&&Xd.SelectionEditor.Ek(h)&&(h=Xd.SelectionEditor.V2c(h),
!Xd.SelectionEditor.Ek(h)))continue;h=Qe.a.createTextRange(this.gS[r].node,h.cpBegin,h.cpEnd);this.E6f(h);Mn.hyperlinkEditor.NG(h,b,!1)}return!0}E6f(b){xg.a.instance.J(3)&&Mn.Qd.D6f(b)}P_h(b){return ie.ParagraphReader.gm(b)&&!Xd.SelectionEditor.v6(b)&&ie.ParagraphReader.textLength(b.node)?Qe.a.createTextRange(b.node,0,ie.ParagraphReader.textLength(b.node)):Xd.SelectionEditor.Ek(b)?b:null}jSk(){let b=!1;for(const h of this.gS){const r=Pg.HyperlinkReader.ZC(h,!1);r&&(b=Mn.xI.dSf(h,r)||b)}return b}static get xI(){return null!=
Mn.elg?Mn.elg:Mn.elg=Sa.a.instance.resolve("Box4.IHyperlinkStrategy")}static get Qd(){return null!=Mn.bsg?Mn.bsg:Mn.bsg=Sa.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance}static get hyperlinkEditor(){return null!=Mn.Vkg?Mn.Vkg:Mn.Vkg=Sa.a.instance.resolve("Box4.IHyperlinkEditor")}static get m1(){null==Mn.HU&&(Mn.HU=t.AFrameworkApplication.K?t.AFrameworkApplication.K.$("AddHyperlinkWhenSelectionContainsLineBreak"):!1);return Mn.HU}static get aDb(){null==Mn.Bqb&&(Mn.Bqb=t.AFrameworkApplication.K?
t.AFrameworkApplication.K.$("HyperlinkUrlValidationIsEnabled"):!1);return Mn.Bqb}}Mn.HU=null;Mn.Bqb=null;Object(n.a)(Mn,"InsertMultiParagraphLinkDialog",Wc.a,[]);class jf{static get bookmarkManager(){return null!=jf.Igg?jf.Igg:jf.Igg=Sa.a.instance.ef("WordEditor.Bookmark.FullBookmarkManager").value}static get r0b(){return null!=jf.sig?jf.sig:jf.sig=Sa.a.instance.ef("WordEditor.TableOfContents.StyleBasedDocumentHeadings").value}static get Zf(){return Yh.a.instance}static get Fda(){return null!=jf.thg?
jf.thg:jf.thg=Sa.a.instance.Pa("Box4.IContentControlChpHelper")}static get xI(){return null!=jf.glg?jf.glg:jf.glg=Sa.a.instance.resolve("Box4.IHyperlinkStrategy")}static uw(){return jf.Hm||(jf.Hm=Sa.a.instance.Za("Box4.IExternalSelectionManager"))}static get Qd(){return null!=jf.nsg?jf.nsg:jf.nsg=Sa.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance}static get Ph(){return null!=jf.tsg?jf.tsg:jf.tsg=Sa.a.instance.resolve("Box4.TrackChange.ITrackChangeReaderFactory").instance}static get Tg(){return sm.ContextSetEditor.instance}static get Mc(){return wc.a.instance}static get qSc(){null==
jf.Ymb&&(jf.Ymb=t.AFrameworkApplication.K?t.AFrameworkApplication.K.$("MultiParagraphHyperlinkEditEnabled"):!1);return jf.Ymb}static get m1(){null==jf.HU&&(jf.HU=t.AFrameworkApplication.K?t.AFrameworkApplication.K.$("AddHyperlinkWhenSelectionContainsLineBreak"):!1);return jf.HU}static get hyperlinkEditor(){return null!=jf.clg?jf.clg:jf.clg=Sa.a.instance.resolve("Box4.IHyperlinkEditor")}static get characterPropertiesEditor(){return null!=jf.lhg?jf.lhg:jf.lhg=Sa.a.instance.resolve("Box4.ICharacterPropertiesEditor")}static get XOc(){t.AFrameworkApplication.Hf("recentLinks;recentLinkscf");
jf.lve||(jf.lve=t.AFrameworkApplication.K?t.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.recentLinksIsEnabled",!1)&&(t.AFrameworkApplication.K.$("IsO365CommercialHost")||t.AFrameworkApplication.K.$("IsO365ConsumerHost")):!1);return jf.lve}static get C8n(){jf.g3g||(jf.g3g=t.AFrameworkApplication.K?t.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.WordOnline.timeInMillisBetweenTwoMRUCalls",6E4):6E4);return jf.g3g}static Vb(){const b=t.AFrameworkApplication.ya;
b.pa(Fb.a.insertHyperlink,kc.a.view,jf.TBb);b.pa(Fb.a.insertHyperlink,kc.a.Wc,jf.insertLink);b.pa(Fb.a.insertHyperlink,kc.a.Gd,jf.insertLink);b.Vc(Fb.a.insertHyperlink,1028);b.pa(Fb.a.C0b,kc.a.view,jf.TBb);b.pa(Fb.a.C0b,kc.a.Wc,jf.insertLink);b.pa(Fb.a.C0b,kc.a.Gd,jf.insertLink);b.Vc(Fb.a.C0b,1028);b.pa(Fb.a.RQ,kc.a.view,jf.TBb);b.pa(Fb.a.RQ,kc.a.Wc,jf.RNi);b.pa(Fb.a.RQ,kc.a.Gd,jf.RNi);b.Vc(Fb.a.RQ,1028);b.pa(Fb.a.H5d,kc.a.view,jf.TBb);b.pa(Fb.a.H5d,kc.a.Wc,jf.aWi);b.pa(Fb.a.H5d,kc.a.Gd,jf.aWi);b.pa(Fb.a.ZNa,
kc.a.view,jf.TBb);b.pa(Fb.a.ZNa,kc.a.Wc,jf.EBi);b.pa(Fb.a.ZNa,kc.a.Gd,jf.EBi);b.pa(Fb.a.ZNa,kc.a.image,jf.mJf);b.pa(Fb.a.ZNa,kc.a.ozb,jf.mJf);xg.a.instance.J(5)&&b.pa(Fb.a.ZNa,kc.a.anchoredObject,jf.mJf);b.pa(Fb.a.YAc,kc.a.application,jf.YAc);b.pa(Fb.a.Zwd,kc.a.view,jf.TBb);jf.XOc&&(b.gb(ab.a.Q1a,kc.a.view,this.TBb.bind(this),1028),b.pa(ab.a.Q1a,kc.a.Wc,this.Q1a.bind(this)),b.pa(ab.a.Q1a,kc.a.Gd,this.Q1a.bind(this)),b.Vc(ab.a.Q1a,1028),b.pa(ab.a.$nf,kc.a.Wc,this.Q1a.bind(this)),b.pa(ab.a.$nf,kc.a.Gd,
this.Q1a.bind(this)),b.Vc(ab.a.$nf,1028),b.pa(ab.a.bMf,kc.a.view,this.bMf.bind(this)),b.pa(ab.a.WLf,kc.a.view,this.WLf.bind(this)),b.gb(ab.a.rfb,kc.a.Wc,this.rfb.bind(this),1028),b.gb(ab.a.rfb,kc.a.Gd,this.rfb.bind(this),1028))}static YAc(){return 32}static Q1a(b,h){if(!jf.XOc)return 2;b=jf.pkj(h);return 32!=b?b:!jf.PMa(h,!0).returnValue||jf.HZb(h)?8:32}static bMf(b,h,r,z,R){if(!jf.XOc)return 2;if(1===r)return 32;jf.S2d(jf.JQj,jf.KQj,jf.qXg);Cp.a.instance.Pd(()=>{jf.Q8f();R.MenuItems=Object.assign(new ni.a,
{Id:"RecentLinksList",MenuSectionList:[],UpdateDynamically:!0});const ba=this.Yuh();ba?(v.ULS.sendTraceTag(526242130,324,50,"Recent Links data load success in ribbon"),R.MenuItems.MenuSectionList.push(ba)):jf.nFi(R,jf.qXg)},"HA:PRLF");return 32}static WLf(b,h,r,z,R){if(!jf.XOc)return 2;if(1===r)return 32;jf.S2d(jf.HQj,jf.IQj,jf.pXg);Cp.a.instance.Pd(()=>{jf.Q8f();R.MenuItems=Object.assign(new ni.a,{Id:"InsertLinkFlyoutList",MenuSectionList:[],UpdateDynamically:!0});R.MenuItems.MenuSectionList.push(this.xKk());
const ba=this.Yuh(!0);ba?(v.ULS.sendTraceTag(526242132,324,50,"Recent Links data load success in context menu"),R.MenuItems.MenuSectionList.push(ba)):jf.nFi(R,jf.pXg)},"HA:PILF");return 32}static nFi(b,h){v.ULS.sendTraceTag(524911777,324,50,"Recent Links could not load in "+h);jf.S2d(jf.mNj,jf.nNj,h);b.MenuItems.MenuSectionList.push(this.OMk());jf.Q8f(!0)}static OMk(){const b=this.F0e("RecentLinksNoDataSection",!1);b.ControlList.push(Object.assign(new nh.a,{ExternalId:"RecentLinksNoDataSection",LabelText:Box4Intl.Box4Strings.l_RecentLinksErrorString}));
return b}static xKk(){const b=this.F0e("InsertLinkSection");b.ControlList.push(Object.assign(new nh.a,{ExternalId:"InsertLink"}));return b}static Yuh(b=!1){if(qg.instance.Ijd){var h=this.F0e("RecentLinksSection",b);b=JSON.parse(qg.instance.Ijd);this.Hjd.clear();b.forEach((r,z)=>{this.Hjd.set(z,[r.FileName,r.DocumentUrl]);const R=jf.VFl(r.FileName);var ba=jf.itl(r.TimeStamp),ta=h.ControlList,Wa=ta.push,ub=Object,Ib=ub.assign,$b=new nh.a,fc=ab.a.rfb,Kc=ab.a.rfb;ba=R!==r.FileName?r.FileName+"\n"+ba:
ba;var ed=r.FileName;let Jd="SaveAsWordDocx_32";switch(r.App){case "Word":Jd="SaveAsWordDocx_32";break;case "PowerPoint":Jd="SaveAsPowerPointPptx_32";break;case "Excel":Jd="SaveAsExcelXlsx_32"}Wa.call(ta,Ib.call(ub,$b,{ExternalId:z,Command:fc,CommandValueId:Kc,LabelText:R,Alt:ba,AriaDescription:ed,ExternalImageId:Jd,KeyTip:r.FileName}))});return h}}static F0e(b,h=!1){return Object.assign(new hi.a,{Title:h?Box4Intl.Box4Strings.l_RecentLinks:"",Id:b,DisplayMode:"Menu",ShowMenuSectionSeparator:!1,ControlsId:"Ctrl_"+
b,ControlList:[]})}static rfb(b,h,r,z,R){if(!jf.XOc)return 2;if(!R||R.CommandValueId!=ab.a.rfb)return 32;jf.S2d(jf.GHj,jf.HHj,jf.XRj);r=h;h=new yf.GraphTransaction(15);h.Al=b;h.Db(r.node);z=jf.PMa(r,!0).hyperlink;r=Xd.SelectionEditor.JLb(r);if(z)jf.tSf(r),b=Hf.SelectionFactory.DN(r.node,Math.min(r.cpBegin,z.cpBegin),Math.max(r.cpEnd,z.cpEnd)),di.a.instance.setSelection(b),r=b.Qa;else if(Xd.SelectionEditor.xf(r)){var ba;Xd.SelectionEditor.ugb(r)&&(ba=Xd.SelectionEditor.X1(r,!1));ba||(ba=this.Hjd.get(R.SourceControlId)[0],
jf.characterPropertiesEditor.replaceTextRange(r,ba,!0,void 0,b),ba=Hf.SelectionFactory.DN(r.node,r.cpBegin,r.cpBegin+ba.length));if(ba&&(di.a.instance.setSelection(ba),r=ba.Qa,jf.HZb(r)))return jf.Qd.wKb(!1),8}try{jf.hyperlinkEditor.NG(r,this.Hjd.get(R.SourceControlId)[1],0<Pg.HyperlinkReader.E3b(r).length);const ta=Hf.SelectionFactory.xe(r.node,r.cpEnd);ta&&di.a.instance.setSelection(ta);l(R,"RecentLinks")}finally{h&&h.dispose()}v.ULS.sendTraceTag(526242134,324,50,"Recent Links inserted");return 32}static TBb(b,
h,r,z,R){if(jf.qSc)return jf.RZl(b,h,r,z,R);if(!h.view.ze)return 2;var ba=h.view.Cb;if(!ba||!ba.hb||!ba.hb.length)return 8;var ta=ba.hb.kb;let Wa=ta.Qa.clone();if(2===ta.length){if(ta=ta.J(1),!Xd.SelectionEditor.Ek(Wa)||!Xd.SelectionEditor.uk(ta)||Wa.node!==ta.node)return 8}else if(2<ta.length)return 8;if(ba.hb.zI)return 8;if(jf.Tg.swa(ie.ParagraphReader.UW,ba.Rg))return jf.Mc.Zb(Sc.a.zf,{["Reason"]:Xc.a.uN}),8;ie.ParagraphReader.gm(Wa)&&!Xd.SelectionEditor.v6(Wa)&&(ba=Wa.node,Wa=Qe.a.createTextRange(ba,
0,ie.ParagraphReader.textLength(ba)));return b===Fb.a.Zwd?jf.ish(h,Wa,r,z):t.AFrameworkApplication.ya.Qf(Wa,b,r,!0,z,R)}static RZl(b,h,r,z,R){if(!h.view.ze)return 2;var ba=h.view.Cb;if(!ba||!ba.hb||!ba.hb.length||ba.hb.zI)return 8;var ta=ba.hb.kb;if(ba=jf.Dtf(ta))ta=jf.zif(ta.Qa.clone(),!0);else{let Wa=ta.J(0).clone(),ub=1;for(;ub<ta.length&&(!ie.ParagraphReader.textLength(Wa.node)||Xd.SelectionEditor.uk(Wa)||jf.m1&&Md.l(Wa));)Wa=ta.J(ub).clone(),ub++;ta=jf.zif(Wa,!1)}return jf.m1&&Xd.SelectionEditor.Ek(ta)&&
Md.l(ta)||!Xd.SelectionEditor.Ek(ta)&&!ba?8:b===Fb.a.Zwd?jf.ish(h,ta,r,z):t.AFrameworkApplication.ya.Qf(ta,b,r,!0,z,R)}static Dtf(b){if(1===b.length)return!0;if(2===b.length){const h=b.Qa.clone();b=b.J(1);return Xd.SelectionEditor.Ek(h)&&Xd.SelectionEditor.uk(b)&&h.node===b.node?!0:!1}return!1}static Mph(b){let h=null;const r=[];for(let z=0;z<b.length;z++){const R=jf.zif(b.J(z).clone(),!1);if(Xd.SelectionEditor.Ek(R))jf.m1&&Md.l(R)||r.push(R);else if(!Xd.SelectionEditor.uk(R)&&!ie.ParagraphReader.gm(R))return{returnValue:!1,
mbb:h}}h=r;return{returnValue:!jf.m1||0<h.length?!0:!1,mbb:h}}static insertLink(b,h,r,z,R){if(jf.qSc)return jf.L5l(h,r,R);z=jf.pkj(h);if(32!==z)return z;let ba;if(!({hyperlink:ba}=jf.PMa(h,!0)).returnValue||jf.HZb(h)||!ba&&b==Fb.a.C0b)return 8;if(1===r)return 32;if(!ba&&Xd.SelectionEditor.xf(h)&&Xd.SelectionEditor.ugb(h)&&(b=Xd.SelectionEditor.X1(h,!1))&&(di.a.instance.setSelection(b),h=b.Qa,jf.HZb(h)))return jf.Qd.wKb(!1),8;ba&&v.ULS.sendTraceTag(593875799,324,50,"Edit link");lr.instance.auh(h,R,
jf.r0b,jf.bookmarkManager);return 32}static pkj(b){return!jf.oVe()||!jf.Jtd(b)||b.node.Sr||di.a.instance.hb.zI?8:xg.a.instance.J(5)&&Xd.SelectionEditor.Q$(b)||ze.a.Uci(b)?2:32}static L5l(b,h,r){var z=di.a.instance.hb.kb;const R=jf.Dtf(z);if(R)b=[b];else if(!({mbb:b}=jf.Mph(z)).returnValue)return 8;if(!jf.oVe())return 8;for(z=0;z<b.length;z++)if(!jf.Jtd(b[z]))return 8;if(di.a.instance.hb.zI)return 8;z=Array(b.length);let ba=null;for(let ta=0;ta<b.length;ta++)if(z[ta]=b[ta],!({hyperlink:ba}=jf.PMa(z[ta],
!0)).returnValue||jf.HZb(z[ta]))return 8;if(1===h)return 32;if(!ba&&1===z.length&&R&&Xd.SelectionEditor.xf(z[0])&&Xd.SelectionEditor.ugb(z[0])&&(h=Xd.SelectionEditor.X1(z[0],!1))&&(di.a.instance.setSelection(h),z[0]=h.Qa,jf.HZb(z[0])))return jf.Qd.wKb(!1),8;R?lr.instance.auh(z[0],r,jf.r0b,jf.bookmarkManager):new Mn(z,r);return 32}static RNi(b,h,r){if(jf.qSc)return jf.Wpn(b,h,r);if(!jf.Jtd(h)||xg.a.instance.J(5)&&Xd.SelectionEditor.Q$(h))return 2;let z;if(!({hyperlink:z}=jf.PMa(h,!1)).returnValue)return 2;
if(2===r){r=new yf.GraphTransaction(15);try{r.Al=b,r.Db(z.paragraph),jf.tSf(h)}finally{r&&r.dispose()}z.hyperlink.GF&&jf.Qd.zs(2)}return 32}static Wpn(b,h,r){var z=di.a.instance.hb.kb;if(jf.Dtf(z))h=[h];else if(!({mbb:h}=jf.Mph(z)).returnValue)return 8;if(!jf.oVe())return 8;for(z=0;z<h.length;z++)if(!jf.Jtd(h[z]))return 8;if(1===r&&!jf.PMa(h[0],!1).returnValue)return 2;if(2===r){for(r=0;r<h.length;r++)if(!jf.PMa(h[r],!0).returnValue)return 2;r=new yf.GraphTransaction(15);try{const R=h[0];r.Al=b;r.Db(R.node);
for(b=0;b<h.length;b++)jf.tSf(h[b])}finally{r&&r.dispose()}jf.Qd.zs(7)}return 32}static tSf(b){const h=Pg.HyperlinkReader.E3b(b);let r=0;for(let z=0;z<h.length;z++)if(h[z].cpBegin>=r){const R=({cpEnd:r}=jf.xI.k$(b,h[z])).returnValue;jf.xI.dSf(b,R)}}static aWi(b,h,r){if(xg.a.instance.J(5)&&$d.ImageReader.Gfb(h)||!({hyperlink:b}=jf.PMa(h,!1)).returnValue)return 2;2===r&&({cpBegin:h,cpEnd:r}=jf.xI.k$(h,b),di.a.instance.setSelection(Hf.SelectionFactory.DN(b.paragraph,h,r)));return 32}static EBi(b,h,r){let z;
if(xg.a.instance.J(5)&&({hyperlink:z}=jf.Ymm(h)).returnValue)v.ULS.sendTraceTag(50934737,324,50,"Logging for image blob object with hyperlink");else if(!({hyperlink:z}=jf.PMa(h,!1)).returnValue)return 2;2===r&&vb.App.uzb(z.hyperlink.url);return 32}static mJf(b,h,r){b=$d.ImageReader.k$(h.node);if(!b)return 2;2===r&&vb.App.uzb(b);return 32}static ish(b,h,r,z){if(xg.a.instance.J(5)&&$d.ImageReader.Gfb(h)||!Ya.InteractiveViewManager.instance.editingView.Dj)return 2;let R;if(!({hyperlink:R}=jf.PMa(h,!1)).returnValue)return 2;
if(1===r)return 32;({cpBegin:h,cpEnd:r}=jf.xI.k$(h,R));di.a.instance.setSelection(Hf.SelectionFactory.DN(R.paragraph,h,r));h=Ya.InteractiveViewManager.instance.xza.ownerDocument.createElement("span");h.innerText=R.hyperlink.url;h.style.backgroundColor="rgb(255, 255, 255)";return t.AFrameworkApplication.ya.Qf(b,Fb.a.Ywd,2,!0,z,h)}static PMa(b,h){if(Xd.SelectionEditor.Ek(b)){const r=Md.g(b),z=Kh.a.all(r,R=>6===R.si);if(0<r.length&&(!jf.m1||!z)||jf.Zf.yh&&jf.Fda&&0<jf.Fda.TEd(b).count)return{returnValue:!1,
hyperlink:null}}return jf.Omm(b,h)}static Ymm(b){let h=null;return $d.ImageReader.Gfb(b)&&(h=Pg.HyperlinkReader.U2b(b))?{returnValue:!0,hyperlink:h}:{returnValue:!1,hyperlink:h}}static Omm(b,h){let r=null;const z=Pg.HyperlinkReader.E3b(b);return z.length?z[0].hyperlink?(r=z[0],b.cpBegin<z[0].cpBegin?{returnValue:h,hyperlink:r}:{returnValue:!0,hyperlink:r}):{returnValue:!1,hyperlink:r}:{returnValue:h,hyperlink:r}}static HZb(b){if(xg.a.instance.J(3)){b=jf.Ph.ILa(b.node,b.cpBegin,b.cpEnd);for(let h=
0;h<b.count;++h)if(2===b.J(h).Od.changeType)return!0}return!1}static oVe(){return xg.a.instance.J(3)?!0:!xg.a.instance.J(3)||!vb.App.Cv.Jgc}static Jtd(b){return jf.Zf.iZ(b)||jf.Zf.Jta(b)||jf.uw()&&jf.uw().instance&&jf.uw().instance.HT(b)?!1:!0}static zif(b,h){return ie.ParagraphReader.gm(b)&&!Xd.SelectionEditor.v6(b)&&(ie.ParagraphReader.textLength(b.node)||h)?Qe.a.createTextRange(b.node,0,ie.ParagraphReader.textLength(b.node)):b}static VFl(b){return b&&b.length<=jf.lKi?b:b.substring(0,jf.lKi)+"..."}static itl(b){try{const h=
new Date(b);return String.format(Box4Intl.Box4Strings.l_RecentLinksTimeSeparator,h.toLocaleString(void 0,{weekday:"long"}),h.toLocaleString(void 0,{hour:"numeric",minute:"numeric"}))}catch(h){return""}}static Q8f(b=!1){let h=Date.now();if(b||h-jf.Uji>jf.C8n)qg.instance.rpi(),jf.Uji=h}static S2d(b,h,r){const z=new Map;z.set("Source",r);z.set("Action",h);Ca.Health.instance.recordKpiUsage(b,0,this.jSa,z)}}jf.Hm=null;jf.Ymb=null;jf.HU=null;jf.Hjd=new Map;jf.lve=null;jf.lKi=35;jf.Uji=Date.now();jf.jSa=
"wwaengidc";jf.XRj="RecentLinks";jf.qXg="RecentLinksRibbonOptions";jf.pXg="RecentLinksContextMenuOptions";jf.JQj="PopulateRecentLinksRibbon";jf.KQj="PopulateRecentLinksRibbonAction";jf.HQj="PopulateRecentLinksContextMenu";jf.IQj="PopulateRecentLinksContextMenuAction";jf.mNj="PopulateRecentLinksContextMenu";jf.nNj="PopulateRecentLinksContextMenuAction";jf.GHj="InsertRecentLinks";jf.HHj="InsertRecentLinksAction";Object(n.a)(jf,"HyperlinkActor",null,[]);class $u{}$u.gQc=Object.freeze({R0l:"WordIndentationShortcutUsage"});
$u.EB="wwaengidc";Object(n.a)($u,"IndentationConstants",null,[]);class fm{static get qp(){return ao.a.GAb}static get Tg(){return sm.ContextSetEditor.instance}static get Zf(){return Yh.a.instance}static get Mc(){return wc.a.instance}static get Hu(){return Ya.InteractiveViewManager.instance}static uw(){return fm.Hm||(fm.Hm=Sa.a.instance.Za("Box4.IExternalSelectionManager"))}static get Q0l(){return null!=fm.nlg?fm.nlg:fm.nlg=Sa.a.instance.resolve("Box4.Actors.IIndentationActorExtension")}static Vb(){const b=
t.AFrameworkApplication.ya;b.pa(Fb.a.OF,kc.a.view,fm.Uyc);b.pa(Fb.a.OF,kc.a.outlineElement,fm.idh);b.Vc(Fb.a.OF,1036);b.pa(Fb.a.FN,kc.a.view,fm.Uyc);b.pa(Fb.a.FN,kc.a.outlineElement,fm.idh);b.Vc(Fb.a.FN,1036)}static Xhn(b){const h=new Map;b=b?b.ia(ui.a.n7h,"Unknown"):"tab";h.set("actionCallSource",b);Ca.Health.instance.recordKpiUsage($u.gQc.R0l,1,$u.EB,h)}static Uyc(b,h,r,z,R){const ba=h.view;if(!ba.ze)return 2;var ta=ba.Cb;if(!ta)return fm.Mc.Zb(Sc.a.zf,{["Reason"]:Xc.a.Ifa}),8;ta=ta.Rg;if(!ta)return fm.Mc.Zb(Sc.a.zf,
{["Reason"]:Xc.a.noSelection}),8;if(ze.a.gfa(h))return 8;if(t.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.TocFormatting",!1)&&fm.Zf.g6b(ta))return fm.Mc.Zb(Sc.a.zf,{["Reason"]:Xc.a.dE}),8;if(1===r)return 32;if(fm.Tg.Jza(fm.yQe,ta))return fm.Mc.Zb(Sc.a.zf,{["Reason"]:Xc.a.SBc}),8;if(fm.Tg.swa(ie.ParagraphReader.UW,ta))return fm.Mc.Zb(Sc.a.zf,{["Reason"]:Xc.a.uN}),8;if(!t.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.TocFormatting",!1)&&fm.Zf.g6b(ta))return fm.Mc.Zb(Sc.a.zf,
{["Reason"]:Xc.a.dE}),8;if(fm.uw()&&fm.uw().instance&&fm.uw().instance.HT(ta))return fm.Mc.Zb(Sc.a.zf,{["Reason"]:Xc.a.externalSelection}),8;ta={};ta[hq.a.zFa]=5794;ta[hq.a.yFa]=5795;return fm.Q0l.Uyc(ba,b,h,r,z,R,ta)}static idh(b,h,r,z,R){var ba,ta;if(h.contextId!==kc.a.outlineElement)return 2;var Wa=h.clone().O1f();if(Ii.TableReader.Rhi(Wa)){if(fm.Zf.Shi(Wa))return fm.Mc.Zb(Sc.a.Sm,{["Reason"]:Xc.a.dE}),8}else if(fm.Zf.C_a(Wa))return fm.Mc.Zb(Sc.a.Sm,{["Reason"]:Xc.a.dE}),2;Wa=new Nd.GraphIterator;
Wa.set(h.node);Xd.SelectionEditor.Jt(Wa);if(!vg.OutlineElementReader.Nh(Wa))return 2;let ub;switch(b){case Fb.a.OF:ub=fm.qp.pwb(Wa);break;case Fb.a.FN:ub=fm.qp.JYb(Wa);break;default:return 2}if(1===r||!ub)return ub?32:8;r=0;b===Fb.a.FN&&R&&R.ia(od.a.$eh,!1)&&(r|=2);if(vg.OutlineElementReader.yP(Wa))return fm.Mc.Zb(Sc.a.Sm,{["Reason"]:Xc.a.uN}),2;(null===(ta=null===(ba=fm.Hu)||void 0===ba?void 0:ba.xd)||void 0===ta?0:ta.aO)&&fm.Hu.editingView&&(fm.Hu.editingView.qH=!0);switch(b){case Fb.a.OF:fm.qp.rOa(Wa,
-1,r);break;case Fb.a.FN:fm.qp.KDc(Wa,1)}z&&pc.a.Clb&&(z.Lr|=pc.a.xdb(h.node,!0));fm.Xhn(R);return 32}}fm.Hm=null;fm.yQe=$d.ImageReader.WZa;Object(n.a)(fm,"IndentationActor",null,[]);var lm=d(1544);class Kk{static get paragraphEditor(){return null!=Kk.fpg?Kk.fpg:Kk.fpg=Sa.a.instance.resolve("Box4.IParagraphEditor")}static get Gk(){return null!=Kk.hrg?Kk.hrg:Kk.hrg=Sa.a.instance.resolve("Box4.ITableEditor")}static get Zf(){return Yh.a.instance}static get Mc(){return wc.a.instance}static uw(){return Kk.Hm||
(Kk.Hm=Sa.a.instance.Za("Box4.IExternalSelectionManager"))}static Vb(){const b=t.AFrameworkApplication.ya;b.pa(Fb.a.faj,kc.a.view,(h,r)=>ze.a.gfa(r)?8:32);b.pa(Fb.a.leftJustify,kc.a.view,lm.a.Av);b.pa(Fb.a.leftJustify,kc.a.paragraph,Kk.$ya);b.pa(Fb.a.leftJustify,kc.a.table,Kk.yRe);b.Vc(Fb.a.leftJustify,1036);b.pa(Fb.a.centerJustify,kc.a.view,lm.a.Av);b.pa(Fb.a.centerJustify,kc.a.paragraph,Kk.$ya);b.pa(Fb.a.centerJustify,kc.a.table,Kk.yRe);b.Vc(Fb.a.centerJustify,1036);b.pa(Fb.a.rightJustify,kc.a.view,
lm.a.Av);b.pa(Fb.a.rightJustify,kc.a.paragraph,Kk.$ya);b.pa(Fb.a.rightJustify,kc.a.table,Kk.yRe);b.Vc(Fb.a.rightJustify,1036);b.pa(Fb.a.fullJustify,kc.a.view,lm.a.Av);b.pa(Fb.a.fullJustify,kc.a.paragraph,Kk.$ya);b.Vc(Fb.a.fullJustify,1036);b.pa(Fb.a.lEc,kc.a.view,lm.a.Av);b.pa(Fb.a.lEc,kc.a.paragraph,Kk.$ya);b.Vc(Fb.a.lEc,1036);b.pa(Fb.a.hEb,kc.a.view,lm.a.Av);b.pa(Fb.a.hEb,kc.a.paragraph,Kk.$ya);b.Vc(Fb.a.hEb,1036);b.pa(Fb.a.N_c,kc.a.view,lm.a.Av);b.pa(Fb.a.N_c,kc.a.paragraph,Kk.$ya);b.Vc(Fb.a.N_c,
1036);b.pa(Fb.a.L8b,kc.a.view,lm.a.Av);b.pa(Fb.a.L8b,kc.a.paragraph,Kk.$ya);b.Vc(Fb.a.L8b,1036);b.pa(Fb.a.YYb,kc.a.view,lm.a.Av);b.pa(Fb.a.YYb,kc.a.paragraph,Kk.$ya);b.Vc(Fb.a.YYb,1036);b.pa(Fb.a.Ucc,kc.a.view,lm.a.Av);b.pa(Fb.a.Ucc,kc.a.paragraph,Kk.$ya);b.Vc(Fb.a.Ucc,1036);b.pa(Fb.a.Z1b,kc.a.view,lm.a.Av);b.pa(Fb.a.Z1b,kc.a.paragraph,Kk.$ya);b.Vc(Fb.a.Z1b,1036)}static yRe(b,h,r,z){let R=!0;if(!h)return 8;Ii.TableReader.Rhi(h)?Kk.Zf.Shi(h)?(Kk.Mc.Zb(Sc.a.Sm,{["Reason"]:Xc.a.dE}),R=!1):Kk.uw()&&Kk.uw().instance&&
Kk.uw().instance.HT(h)&&(Kk.Mc.Zb(Sc.a.Sm,{["Reason"]:Xc.a.externalSelection}),R=!1):(Kk.Mc.Zb(Sc.a.Sm,{["Reason"]:Xc.a.r5e}),R=!1);if(1===r||!R)return R?32:8;h=h.node;switch(b){case Fb.a.leftJustify:Kk.Gk.sD(h,1);break;case Fb.a.centerJustify:Kk.Gk.sD(h,2);break;case Fb.a.rightJustify:Kk.Gk.sD(h,3)}z&&pc.a.Clb&&(z.Lr|=2);return 32}static $ya(b,h,r,z,R){let ba=!0;h.contextId!==kc.a.paragraph?ba=!1:Kk.Zf.C_a(h)?(Kk.Mc.Zb(Sc.a.Sm,{["Reason"]:Xc.a.dE}),ba=!1):Kk.uw()&&Kk.uw().instance&&Kk.uw().instance.HT(h)&&
(Kk.Mc.Zb(Sc.a.Sm,{["Reason"]:Xc.a.externalSelection}),ba=!1);if(1===r||!ba)return ba?32:8;h=h.node;r=ie.ParagraphReader.Hv(h);switch(b){case Fb.a.leftJustify:case Fb.a.L8b:Kk.paragraphEditor.sD(h,1===r&&Kk.FQd(R)?6:1);break;case Fb.a.centerJustify:case Fb.a.YYb:Kk.paragraphEditor.sD(h,2===r&&Kk.FQd(R)?1:2);break;case Fb.a.rightJustify:case Fb.a.Ucc:Kk.paragraphEditor.sD(h,3===r&&Kk.FQd(R)?1:3);break;case Fb.a.fullJustify:case Fb.a.Z1b:Kk.paragraphEditor.sD(h,6===r&&Kk.FQd(R)?1:6);break;case Fb.a.hEb:Kk.paragraphEditor.sD(h,
11);break;case Fb.a.lEc:Kk.paragraphEditor.sD(h,7);break;case Fb.a.N_c:Kk.paragraphEditor.sD(h,13)}z&&pc.a.Clb&&(z.Lr|=pc.a.xdb(h));return 32}static FQd(b){let h=!1;null!==b&&Object.getType(b)===Object&&b.hasOwnProperty("InContextSet")&&(h=b.InContextSet);return!h}}Kk.Hm=null;Object(n.a)(Kk,"JustificationActor",null,[]);const cu=()=>{const b=t.AFrameworkApplication.ya;b.pa(Fb.a.save,Yd.a.frame,Tx);b.pa(Fb.a.sync,Yd.a.frame,du)},du=(b,h,r)=>{if(1===r)return 32;t.AFrameworkApplication.ya.processAction(Fb.a.rwb,
2);vb.App.Xj.R$d();return 32},Tx=(b,h,r)=>{if(1===r)return 2===vb.App.xa.mode?32:8;t.AFrameworkApplication.ya.processAction(Fb.a.rwb,2);if(2!==vb.App.xa.mode)return 32;vb.App.Xj.wUi(null,null);return 32};class zu{constructor(){this.activateRibbonTab=(b,h,r,z,R)=>{vb.App.Cv.aI.S4d(R.toString());return 32};this.sqm=(b,h,r,z,R)=>{t.AFrameworkApplication.naa("Microsoft.Office.Web.SessionSettings.IWacWordTransformToWebPageSettings");vb.App.Cv.aI.mji(1,R.toString());return 32};this.sYm=(b,h)=>{if(h.contextId!==
Yd.a.frame)return 2;appChrome.onRibbonModeToggle();return 32}}Vb(){const b=t.AFrameworkApplication.ya;b.pa(Fb.a.activateRibbonTab,kc.a.view,this.activateRibbonTab);b.Vc(Fb.a.activateRibbonTab,5);b.pa(Fb.a.nji,kc.a.view,this.sqm);b.pa(Fb.a.pbj,Yd.a.frame,this.sYm)}static get instance(){return null!=zu.Rlg?zu.Rlg:zu.Rlg=zu.Gl()}static Gl(){return new zu}}Object(n.a)(zu,"RibbonActor",null,[]);var hs=d(569);class Is{constructor(b,h){this.wm=null;this.geo=(r,z,R,ba,ta)=>{let Wa;ba=z.view;if(!ba.ze)return Is.Mc.Zb(Sc.a.zf,
{["Reason"]:Xc.a.QFb}),8;Wa=r===Fb.a.undo?this.xi.zZ:this.xi.SLa;if(1===R)return ze.a.gfa(z)&&ze.a.UCb()?8:Wa?32:8;if(!Wa)return v.ULS.sendTraceTag(17069441,365,50,"User attempted {0} without an undo stack",r===Fb.a.undo?"undo":"redo"),this.fGa.value.Vej(),Is.Mc.Zb(Sc.a.zf,{["Reason"]:Xc.a.ceo}),2;z=new yf.GraphTransaction(3);z.Db(ba.rd);z.tXf();r=r===Fb.a.undo?this.xi.undo():this.xi.redo();z.dispose();ta&&cs.GrippersManager.instance.kMb(ta.Ww);if(r)return 32;Is.Mc.Zb(Sc.a.o0b,{["Reason"]:Xc.a.Qti});
return 8};this.pja=b;this.fGa=h}get xi(){return this.wm||(this.wm=this.pja())}Vb(){const b=t.AFrameworkApplication.ya,h=this.geo;b.gb(Fb.a.undo,kc.a.view,h,1028);b.gb(Fb.a.redo,kc.a.view,h,1028)}static get instance(){return null!=Is.zlg?Is.zlg:Is.zlg=Is.Gl()}static Gl(){const b=Sa.a.instance;return new Is(()=>b.resolve("Box4.IUndoManager"),b.ef("Box4.ICoauthCashTelemetry"))}static get Mc(){return wc.a.instance}}Object(n.a)(Is,"UndoActor",null,[]);class At{constructor(){this.W=null}get name(){return"Box4.Actors"}yc(b){this.W=
b;(new jh).yc(b)}init(){var b=this.W.resolve("Box4.Actors.ClipboardActor");b.Vb();b.k3();uo();xr.instance.Vb();jf.Vb();fm.Vb();Kk.Vb();this.W.resolve("Box4.Actors.TouchInputActor").Vb();gt.instance.Vb();this.W.resolve("Box4.ISelectAllHandlers").Vb();cu();xg.a.instance.J(9)&&this.W.resolve("Box4.Actors.ProofingActor").Vb();zu.instance.Vb();(b=this.W.Pa("Box4.IFeatureHelper"))?b.Yk.continueWith(()=>{this.sMi()}):this.sMi();hs.a.Vb(vb.App.K3a);this.W.resolve("Box4.Actors.TextFormattingActor").Vb();Is.instance.Vb();
this.W.resolve("Box4.Actors.AccessibilityActor").dRf();this.W.resolve("Box4.IClipboardCommands");this.W.resolve("Box4.Actors.PasteFloatieEventManager");vb.App.xa.updateCommandUI()}sMi(){xg.a.instance.J(10)&&(t.AFrameworkApplication.K&&t.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.IsUpdateStyleContextMenuEnabled",!1)&&this.W.resolve("Box4.Actors.StyleContextMenuActor").Vb(),this.W.resolve("Box4.Actors.StyleActor").Vb())}dispose(){}static main(){O.a.instance.Oc(new At)}}
Object(n.a)(At,"Box4ActorsPackage",null,[1,2]);class Hv extends Xm{constructor(b,h,r,z){super(b);this.Nka=r;this.Aga=z;this.zag=0;this.hx=h.vNa("UserAction","WordOnlineAddToDictionary")}NZf(b){this.qBd=this.Nka.jla(b);if(!this.Htk())return!1;const h=this.qBd.errorDetails.token;this.Aga.J9g(h);if(!this.Aga.b2c(h))return v.ULS.sendTraceTag(541618644,375,10,"[Add to Dictionary]: Unable to save word to roaming dictionary."),!1;v.ULS.sendTraceTag(541618645,375,50,"[Add to Dictionary]: Starting ProofingWholeDocument operation.");
this.hx.start();this.transaction=new yf.GraphTransaction(15);this.transaction.Db(b.node);return!0}E0d(b){this.yHb(b.node);return!0}CVc(b){this.yHb(b);return!0}F0d(b){this.yHb(b.node)}A4f(b){this.transaction.dispose();this.qBd.errorDetails.Qlb(b.actionId);this.Aga.w5d("unused corelation id.");this.hx.stop();v.ULS.sendTraceTag(541618646,375,50,String.format("[Add to Dictionary]: Actual errors removed: {0}. Duration in milliseconds: {1}. Type: {2}",this.zag,this.hx.oi,this.qBd.errorDetails.proofingType));
return!0}jfc(b,h){const r=b.role;return super.jfc(b,h)||9===r||10===r||13===r||7===r||8===r}yHb(b){if(b){var h=this.Nka.f2(b,r=>this.Aga.b2c(r.errorDetails.token));this.Nka.Ajb(b,h,!0);this.zag+=h.length}}Htk(){var b,h;return null!==(h=null===(b=this.qBd)||void 0===b?void 0:b.errorDetails)&&void 0!==h&&h.token?!0:(v.ULS.sendTraceTag(541618647,375,10,"[Add to Dictionary]: Was not able to get the token from the error range."),!1)}}Object(n.a)(Hv,"AddToDictionaryCallbackSteps",Xm,[]);class Yq{constructor(b,
h,r,z,R,ba,ta){this.zc=b;this.Cb=h;this.IZc=r;this.Nka=z;this.iq=R;this.Aga=ba;this.wan=ta;this.KRl=(Wa,ub,Ib,$b,fc,Kc)=>{const ed=new Hv(this.IZc,this.iq,this.Nka,this.Aga);return new Hs(Wa,ub,Ib,$b,fc,Kc,ed,this.zc,this.Cb,this.IZc,"AddToDictionaryThroughProofingWholeDocumentOperation")}}Vb(){this.zc.pS(Fb.a.addToDictionary,kc.a.view,this.KRl,1124);this.wan.gnn(this.Aga)}}Object(n.a)(Yq,"PersonalDictionaryOrchestrator",null,[]);class Au{get name(){return"Box4.PersonalDictionary"}yc(b){this.container=
b;b.register(Yq,"Box4.PersonalDictionary.PersonalDictionaryOrchestrator").singleInstance().Yd(()=>new Yq(t.AFrameworkApplication.ya,di.a.instance,Xs.a.instance,b.resolve("Box4.Proofing.IErrorRangeEditor"),b.resolve("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder"),b.resolve("IRoamingDictionary"),b.resolve("Box4.Proofing.ProofingCheckOperator")))}init(){this.container.resolve("Box4.PersonalDictionary.PersonalDictionaryOrchestrator").Vb()}dispose(){}static main(){Si.a.get_instance().tl(7,()=>{O.a.instance.Oc(new Au)})}}
Object(n.a)(Au,"PersonalDictionaryPackage",null,[1,2]);class Zq{constructor(b,h,r,z,R,ba){this.Q5a=this.RU=null;this.tAc=(ta,Wa,ub,Ib,$b)=>this.hhi(Wa,ub,$b,!1)?32:8;this.ZH=(ta,Wa,ub,Ib,$b)=>{if(!({Gx:ta}=this.F2i(Wa,ub,$b,!0)).returnValue)return ta;v.ULS.sendTraceTag(594899719,340,50,"Cell shading color is selected from Standard/Theme colors.");$b=this.MXj.yza(Wa.node,$b);this.d4m(Wa.node,$b);this.AO();return 32};this.Dwb=(ta,Wa,ub,Ib,$b)=>{if(!({Gx:ta}=this.F2i(Wa,ub,$b,!1)).returnValue)return ta;
this.$3m(Wa.node);return 32};this.Fbn=(ta,Wa,ub,Ib,$b)=>{if(1===ub)return 32;if(!Wa||!Wa.view.ze)return 2;ta=Wa.view.Cb;if(!ta)return 2;ta=ta.Rg;if(!ta)return 2;ta=Zq.Tg.UP(ta,16);if(!ta||!ta.length)return 2;Wa=null;for(ub=0;ub<ta.length;ub++){Ib=ta.getContext(ub);if(!Ib||Ib.contextId!==kc.a.tableCell)return 2;const fc={};this.d3h(Ib,fc);if(fc.CellShading)if(Wa&&Wa!==fc.CellShading){Wa=null;break}else Wa=fc.CellShading;else{Wa=null;break}}$b.CellShading=Wa;return 32};this.HHb=(ta,Wa,ub,Ib,$b)=>1===
ub?32:this.d3h(Wa,$b);this.fHb=(ta,Wa,ub,Ib,$b)=>{if(1===ub)return 32;ta=Wa.contextId===kc.a.view?this.$xa.eHd(Wa):this.tgf(Wa);ub={};Wa=null;32===t.AFrameworkApplication.ya.Xb(Fb.a.HHb,2,ub)&&ub&&(Wa=ub.CellShading);ub="";Wa&&(ub=cq.a.MC(Wa)||"");this.B1i.vdc=ub;ta=this.B1i.XDd(ta,vb.App.rZb);if(!ta)return 8;$b.MenuItems=ta;v.ULS.sendTraceTag(592996034,340,50,"Cell Shading dropdown menu is opened.");return 32};this.Ufa=(ta,Wa,ub,Ib,$b)=>{if(1===ub)return 32;vb.App.xa.qw();t.AFrameworkApplication.ya.Xb(Fb.a.HHb,
2,$b);this.Q5a=new yu.a("Shading",Fb.a.Ndc);this.Q5a.y0c($b&&$b.CellShading?$b.CellShading:0);return 32};this.Csk=(ta,Wa,ub,Ib,$b)=>{if(1===ub)return 32;t.AFrameworkApplication.ya.Xb(Fb.a.p7,2,$b);this.recentColors.L$a($b)||v.ULS.sendTraceTag(594899717,340,50,"Color selected from Recent Colors section. Menu: {0}","Shading");return 32};this.ga=b;this.MXj=h;this.Xye=r;this.$xa=z;this.Hd=R;this.Ym=ba}get recentColors(){return null!=this.Lpg?this.Lpg:this.Lpg=Sa.a.instance.Pa("Box4.UI.RecentColorsSectionHandler")}get B1i(){this.RU||
(this.RU=new Zu.a("Shading"),this.GZa(this.RU));return this.RU}GZa(b){b.cda(2,Fb.a.Dwb);b.cda(3,Fb.a.p7);b.cda(4,Fb.a.p7);b.aXb(this.Xye,1)}Vb(){this.ga.pa(Fb.a.fHb,kc.a.view,this.fHb);this.ga.pa(Fb.a.fHb,kc.a.tableCell,this.fHb);this.ga.Vc(Fb.a.fHb,1126);this.ga.pa(Fb.a.tAc,kc.a.view,hs.a.VGc);this.ga.pa(Fb.a.tAc,kc.a.tableCell,this.tAc);this.ga.Vc(Fb.a.tAc,1028);this.ga.pa(Fb.a.p7,kc.a.view,hs.a.VGc);this.ga.pa(Fb.a.p7,kc.a.tableCell,this.ZH);this.ga.Vc(Fb.a.p7,1028);this.ga.pa(Fb.a.Dwb,kc.a.view,
hs.a.VGc);this.ga.pa(Fb.a.Dwb,kc.a.tableCell,this.Dwb);this.ga.Vc(Fb.a.Dwb,1028);this.ga.pa(Fb.a.HHb,kc.a.view,this.Fbn);this.ga.pa(Fb.a.HHb,kc.a.tableCell,this.HHb);this.ga.Vc(Fb.a.HHb,1124);this.ga.pa(Fb.a.Ndc,kc.a.view,hs.a.VGc);this.ga.pa(Fb.a.Ndc,kc.a.tableCell,this.Csk);this.ga.Vc(Fb.a.Ndc,1028);this.ga.pa(Fb.a.oJf,kc.a.view,this.Ufa);this.ga.Vc(Fb.a.oJf,1028)}AO(){t.AFrameworkApplication.K&&t.AFrameworkApplication.K.$("WordEditorTablesSupportFloodgateIsEnabled")&&window.setTimeout(()=>{const b=
Sa.a.instance.Za("Common.ISystemInitiatedFeedback");b&&b.execute(h=>{h.logActivity("WordEditorTablesUsageSupport","WordEditorTablesSupportFloodgateIsEnabled")})},5E3)}F2i(b,h,r,z){return this.hhi(b,h,r,z)?{returnValue:2===h,Gx:32}:(2==h&&hs.a.recordQosError("CellShadingButtonClickNoResponse",["TableInteractionFailed"],Xc.a.P6k),{returnValue:!1,Gx:8})}hhi(b,h,r,z){return b.contextId!==kc.a.tableCell||2===h&&(z&&!r||!b.node)?!1:!0}d4m(b,h){const r=new yf.GraphTransaction(15);r.Db(b);this.r0i(b);b.properties.setValue(We.a.ZH,
h);r.dispose()}$3m(b){const h=new yf.GraphTransaction(15);h.Db(b);this.r0i(b);b.properties.removeProperty(We.a.ZH);h.dispose()}tgf(b){return b.contextId!==kc.a.tableCell?null:(b=Zq.qh.ju(b.node))?b:null}r0i(b){if(this.Hd&&this.Hd.ng&&(b=Object(la.a)(Su.TableCellNode,b))){const h=b.OQ();this.Ym.L_c(b,h)}}d3h(b,h){if(b.contextId!==kc.a.tableCell)return 8;(b=b.node)&&b.hasProperty(We.a.ZH)&&(h.CellShading=b.getValue(We.a.ZH));return 32}static Nkl(){return new Zq(t.AFrameworkApplication.ya,xq.a.instance,
gs.a.instance,ne.PageReader.instance,Sa.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,Sa.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance)}static get qh(){return ml.PageNavigator.instance}static get Tg(){return null!=Zq.Qhg?Zq.Qhg:Zq.Qhg=sm.ContextSetEditor.instance}static get instance(){return null!=Zq.Umg?Zq.Umg:Zq.Umg=Zq.Nkl()}}Object(n.a)(Zq,"CellShadingActor",null,[]);class av{constructor(){this.W=null}get name(){return"Box4.CellShading"}yc(b){this.W=
b}init(){const b=this.W.Pa("Box4.IFeatureHelper");b?b.Yk.continueWith(()=>{this.Tm()}):this.Tm()}Tm(){Zq.instance.Vb();vb.App.xa.updateCommandUI()}dispose(){}}Object(n.a)(av,"CellShadingPackage",null,[1,2]);var $q;(function(b){b[b.none=0]="none";b[b.style1=1]="style1";b[b.style2=2]="style2";b[b.style3=3]="style3";b[b.style4=4]="style4";b[b.style5=5]="style5";b[b.bullet=6]="bullet";b[b.invalid=42]="invalid"})($q||($q={}));Object(n.b)("ListStyle",$q);const Ey={[$q.style1]:{[1]:"disc",[0]:"decimal"},
[$q.style2]:{[1]:"circle",[0]:"lower-alpha"},[$q.style3]:{[1]:"square",[0]:"lower-roman"},[$q.style4]:{[0]:"upper-alpha"},[$q.style5]:{[0]:"upper-roman"},[$q.bullet]:{[1]:"bullet"}};var mr;(function(b){b[b.number=0]="number";b[b.bullet=1]="bullet";b[b.lim=13]="lim";b[b.nil=14]="nil";b[b.any=15]="any";b[b.noList=16]="noList";b[b.invalid=42]="invalid"})(mr||(mr={}));Object(n.b)("ListType",mr);var Bu=d(655);class Ko{constructor(b,h){this.LA=this.JQc=null;this.levelText=b;this.font=h}get u0d(){return this.levelText}get listStyle(){return 6}get Zs(){return"left"}}
Object(n.a)(Ko,"ListMarkerBullet",null,[534]);class li{static get Ko(){return null!=li.Cng?li.Cng:li.Cng=Sa.a.instance.resolve("Box4.List.IListEditor")}static get hd(){return li.Cf||(li.Cf=Sa.a.instance.resolve("Box4.List.IListReader"))}static set hd(b){li.Cf=b}static get Tj(){return null!=li.slg?li.slg:li.slg=Sa.a.instance.resolve("Box4.IInsertionPointFormatting")}static uw(){return li.Hm||(li.Hm=Sa.a.instance.Za("Box4.IExternalSelectionManager"))}static get Tg(){return sm.ContextSetEditor.instance}static get Zf(){return Yh.a.instance}static get Mc(){return wc.a.instance}static get ae(){return bt.a.getInstance()}static get Tkb(){return null!=
li.lqg?li.lqg:li.lqg=Sa.a.instance.Pa("Box4.List.ISingleLevelListEditor")}static Vb(){const b=t.AFrameworkApplication.ya;b.pa(Fb.a.Xz,kc.a.view,li.Syc);b.pa(Fb.a.Xz,kc.a.outlineElement,li.ura);b.Vc(Fb.a.Xz,1036);b.pa(Fb.a.tH,kc.a.view,li.Syc);b.pa(Fb.a.tH,kc.a.outlineElement,li.ura);b.Vc(Fb.a.tH,1036);li.hd.xr&&(b.pa(Fb.a.saa,kc.a.view,li.Syc),b.pa(Fb.a.saa,kc.a.outlineElement,li.ura),b.Vc(Fb.a.saa,1036));b.pa(Fb.a.mRe,kc.a.view,$c.ActionManager.Nf);b.pa(Fb.a.Ymh,kc.a.view,$c.ActionManager.Nf);b.pa(Fb.a.joinList,
kc.a.view,li.gwn);b.pa(Fb.a.YQe,kc.a.view,$c.ActionManager.Nf);b.pa(Fb.a.nRe,kc.a.view,$c.ActionManager.Nf);b.pa(Fb.a.J3f,kc.a.view,$c.ActionManager.Nf);b.pa(Fb.a.J9i,kc.a.view,$c.ActionManager.Nf);b.pa(Fb.a.fce,kc.a.view,$c.ActionManager.Nf)}static gwn(){Bu.a.CRi();return 32}static Syc(b,h,r,z,R){var ba,ta;if(!h.view.ze)return 2;const Wa=li.Mc.oo(Fb.a.Syc);z.Lr=42;z.xB=42;const ub={[hq.a.zFa]:5796,[hq.a.yFa]:5797};var Ib=h.view;if(li.Tg.Jza(li.B_l,Ib.Cb.Rg))return li.Mc.Zb(Sc.a.zf,{["Reason"]:Xc.a.fZe}),
Wa.end(),8;if(li.Tg.Jza(li.yQe,Ib.Cb.Rg))return li.Mc.Zb(Sc.a.zf,{["Reason"]:Xc.a.SBc}),Wa.end(),8;if(li.Tg.swa(ie.ParagraphReader.UW,Ib.Cb.Rg))return li.Mc.Zb(Sc.a.zf,{["Reason"]:Xc.a.uN}),Wa.end(),8;if(li.Zf.g6b(Ib.Cb.Rg))return li.Mc.Zb(Sc.a.zf,{["Reason"]:Xc.a.dE}),Wa.end(),8;if(null===(ta=null===(ba=li.uw())||void 0===ba?void 0:ba.instance)||void 0===ta?0:ta.HT(h))return li.Mc.Zb(Sc.a.zf,{["Reason"]:Xc.a.externalSelection}),Wa.end(),8;if(1===r)return Wa.end(),32;R||(R=new Ei.DictionaryPropertySet);
ba=null;if(2===r){ba=new yf.GraphTransaction(15);ba.Db(h.view.rd);li.wPc=!1;ta=nw.OutlineElementGeneralizer.$ka(Ib.Cb.hb,!1);if(!ta)return ba.dispose(),li.Mc.Zb(Sc.a.Ska,{["Reason"]:Xc.a.ZBd}),Wa.end(),8;1<ta.length&&R.setValue(od.a.bDf,null);const fc=R.ia(od.a.EI,-1),Kc=R.ia(od.a.Nv,-1);li.ae.IDb&&li.Tkb&&li.Tkb.Yuk(ta);var $b=li.oSn(fc,Kc,ta);$b&&(R.setValue(od.a.Nv,16),R.setValue(od.a.eua,0));if(!Xd.SelectionEditor.xf(Ib.Cb.Rg)&&!$b&&0<ta.length&&fc){Ib=new Nd.GraphIterator;$b=Array(ta.length);
for(let ed=0;ed<ta.length;ed++)Ib.set(ta.getContext(ed).node),$b[ed]=li.hd.Hs(Ib);li.nSn($b,R)&&(Ib=new Ei.DictionaryPropertySet,Ib.setValue(od.a.Nv,16),Ib.setValue(od.a.eua,0),bt.a.bX&&(Ib.setValue(ui.a.Bma,"clean-list-before-apply-new-list-style"),Ib.setValue(ui.a.tfa,R.ia(ui.a.Bma,"unknown")+"@"+R.ia(ui.a.tfa,"undefined"))),hq.a.kna(b,h,r,z,Ib,ub,11),t.AFrameworkApplication.ya.processAction(Fb.a.J9i,2),v.ULS.sendTraceTag(38544075,393,50,"List Actions: Switch List Style - Range Select"),li.wPc=
!0)}Ib=new Nd.GraphIterator;Ib.set(ta.getContext(0).node);Ib=li.hd.Hs(Ib);li.xym(fc,Kc,Ib,ta.length)}b=hq.a.kna(b,h,r,z,R,ub,11);32===b&&R.ia(od.a.$eh,!1)&&(b=hq.a.kna(Fb.a.FN,h,r,z,R,ub,11));ba&&ba.dispose();Wa.end();return b}static nSn(b,h){let r=null;var z=!1;for(let R=b.length-1;0<=R&&(r?(z=b[R],z=-1!==h.ia(od.a.EI,-3)?z?r.listType!==z.listType||r.listStyle!==z.listStyle:!0:z?r.listType!==z.listType:!0):r=b[R],!z);R--);return r&&(b=!1,z||(b=h.ia(od.a.Nv,42),h=h.ia(od.a.EI,-3),b=b!==r.listType||
0<h),z||b)?!0:!1}static xym(b,h,r,z){0>=z||li.wPc||(b?r?(r=r.listType,-1===b&&h===r?(t.AFrameworkApplication.ya.processAction(Fb.a.fce,2),v.ULS.sendTraceTag(39715535,393,50,"List Actions: Clean List Style - Ribbon button")):0<b&&(!h||1===h)&&(t.AFrameworkApplication.ya.processAction(h?Fb.a.YQe:Fb.a.nRe,2),v.ULS.sendTraceTag(39715536,393,50,"List Actions: Apply {0} List Style",h?"Bullet":"Numbering"))):(t.AFrameworkApplication.ya.processAction(h?Fb.a.YQe:Fb.a.nRe,2),li.abo(),v.ULS.sendTraceTag(39715534,
393,50,"List Actions: Apply {0} List Style",h?"Bullet":"Numbering")):(t.AFrameworkApplication.ya.processAction(Fb.a.fce,2),v.ULS.sendTraceTag(39715533,393,50,"List Actions: Clean List Style - None list style")))}static oSn(b,h,r){if(-1!==b&&b||!r.length)return!1;b=new Nd.GraphIterator;let z=null;for(let R=r.length-1;0<=R&&!(b.set(r.getContext(R).node),z=li.hd.Hs(b));R--);return z&&h===z.listType?!0:!1}static ura(b,h,r,z,R){if(h.contextId!==kc.a.outlineElement)return 2;var ba=h.clone().O1f();if(li.Zf.C_a(ba))return li.Mc.Zb(Sc.a.Sm,
{["Reason"]:Xc.a.dE}),2;const ta=new Nd.GraphIterator;ta.set(h.node);Xd.SelectionEditor.Jt(ta);if(!vg.OutlineElementReader.Nh(ta))return 2;if(1===r)switch(b){case Fb.a.Xz:return 32;case Fb.a.tH:return 32;case Fb.a.saa:return 32;default:return 2}if(vg.OutlineElementReader.yP(ta))return li.Mc.Zb(Sc.a.Sm,{["Reason"]:Xc.a.uN}),2;h=li.hd.Hs(ta);var Wa;bt.a.bX&&(Wa=Object.freeze(null===h||void 0===h?void 0:h.clone()));let ub=R;if(!ub)return 8;!mc.ListReader.rr&&b===Fb.a.tH&&ta.bH()&&(ta.aq(4)||ub.setValue(od.a.hNa,
1),ta.xj());li.hd.xr?(b===Fb.a.tH||b===Fb.a.Xz||b===Fb.a.saa?(ub=li.Ko.$0b(b,ub),ba=fq.a.HP(ub.getValue(od.a.Nv),ub.getValue(od.a.eua))):ba=null,li.RZ(b,ub),li.SLn(ba,ub)):(ub=li.Ko.$0b(b,ub),ba=fq.a.HP(ub.getValue(od.a.Nv),ub.getValue(od.a.eua)));mc.ListReader.rr||(ba.Tz=ub.ia(We.a.kX,zi.a.Yi));let Ib=!1;b===Fb.a.Xz&&ub&&(ub.hasProperty(yc.a.Ur)&&(ba.levelText=ub.ia(yc.a.Ur,"")),ub.hasProperty(We.a.font)&&(ba.font=ub.ia(We.a.font,"")),ub.hasProperty(od.a.G$e)&&(Ib=ub.ia(od.a.G$e,!1)));li.ENn(ub,
ta);ba=li.Ko.ura(ub,ta,ba,Ib);if(!ba.returnValue)return li.Mc.Zb(Sc.a.Sm,{["Reason"]:Xc.a.Lwf}),2;ba=ba.LBa;bt.a.bX&&li.cin(R,Wa,ba);2===r&&(r=R.ia(od.a.Nv,-1),ba&&-1!==r&&((Wa=R.ia(yc.a.vr,"Invalid MultiLevel Type"),b===Fb.a.tH&&v.ULS.sendTraceTag(540313232,393,50,"toggleNumberedList Info - {0}",JSON.stringify({["commandSource"]:(null===R||void 0===R?void 0:R.CommandSource)||"ribbon/keyboard",["autonumberedListsEnabled"]:!0,["listStyle"]:$q[null==(null===h||void 0===h?void 0:h.listStyle)?null===
ba||void 0===ba?void 0:ba.listStyle:null===h||void 0===h?void 0:h.listStyle],["listType"]:mr[null==(null===h||void 0===h?void 0:h.listType)?null===ba||void 0===ba?void 0:ba.listType:null===h||void 0===h?void 0:h.listType],["cleared"]:16===(null===ba||void 0===ba?void 0:ba.listType)})),h)?ba.listType&&1!==ba.listType||li.wPc||(t.AFrameworkApplication.ya.processAction(Fb.a.J3f,2),v.ULS.sendTraceTag(38544078,393,50,"List Actions: Switch Style - IP Select - {0}, {1}",r?"Bullet":"Numbering",Wa)):16===
ba.listType?(t.AFrameworkApplication.ya.processAction(Fb.a.Ymh,2),v.ULS.sendTraceTag(38544076,393,50,"List Actions: ClearList Style - {0}, {1}",r?"Bullet":"Numbering",Wa)):ba.listType&&1!==ba.listType||li.wPc||(t.AFrameworkApplication.ya.processAction(Fb.a.mRe,2),v.ULS.sendTraceTag(38544077,393,50,"List Actions: ApplyList Style - {0}, {1}",r?"Bullet":"Numbering",Wa))),(b=ve.FocusManager.instance())&&b.og&&b.og.name===tf.AppFrame.Jna&&b.fC(ke.AFrame.Zp));z.Lr=ba.listType;z.xB=ba.listStyle;return 32}static cin(b,
h,r){var z,R,ba,ta,Wa,ub,Ib,$b;const fc=new Map;fc.set("actionCallSource",b.ia(ui.a.Bma,"unknown"));fc.set("actionCallSourceTrigger",b.ia(ui.a.tfa,"undefined"));fc.set("fromListType",mr[null!==(z=null===h||void 0===h?void 0:h.listType)&&void 0!==z?z:16]);fc.set("fromListStyle",$q[null!==(R=null===h||void 0===h?void 0:h.listStyle)&&void 0!==R?R:0]);fc.set("fromListMarkerType",null!==(Wa=a(null!==(ba=null===h||void 0===h?void 0:h.listStyle)&&void 0!==ba?ba:0,null!==(ta=null===h||void 0===h?void 0:h.listType)&&
void 0!==ta?ta:16))&&void 0!==Wa?Wa:"undefined");fc.set("fromLevelText",(null===h||void 0===h?0:h.Nea)?h.levelText:"undefined");fc.set("toListType",null!==(ub=mr[null===r||void 0===r?void 0:r.listType])&&void 0!==ub?ub:"undefined");fc.set("toListStyle",null!==(Ib=$q[null===r||void 0===r?void 0:r.listStyle])&&void 0!==Ib?Ib:"undefined");fc.set("toListMarkerType",null!==($b=a(null===r||void 0===r?void 0:r.listStyle,null===r||void 0===r?void 0:r.listType))&&void 0!==$b?$b:"undefined");fc.set("toLevelText",
(null===r||void 0===r?0:r.Nea)?r.levelText:"undefined");Ca.Health.instance.recordKpiUsage(zi.a.gQc.msm,0,zi.a.EB,fc)}static ENn(b,h){var r=new Nd.GraphIterator;r.fd(h);(h=r.Rb(2))&&ie.ParagraphReader.nc(h)&&(r=di.a.instance.hb.kb)&&r.Qa&&r.Qa.node===h&&Xd.SelectionEditor.jQd(r)&&(li.gKn(b),li.dKn(b))}static SLn(b,h){h.hasProperty(yc.a.vr)&&b.b7d(h.getValue(yc.a.vr));h.hasProperty(ui.a.qP)&&(b.qP=h.getValue(ui.a.qP));h.hasProperty(yc.a.Ur)&&(b.levelText=h.getValue(yc.a.Ur));b.EI=h.ia(od.a.EI,-1);let r=
null;b.pma&&(r=li.Mxl(b,h));b.pma&&r?li.zNn(b,r):(b.pma?v.ULS.sendTraceTag(589091597,393,15,"List marker is null, falling back to default list info.List Style {0}, List multi level type {1}, List Ordered : {2}",b.EI,b.vr,b.sr):v.ULS.sendTraceTag(589091596,393,50,"User has not selected a style choosing default properties"),li.TIn(b))}static TIn(b){if(b.sr)b.NKd&&-1===b.EI||(b.levelText="%1.",b.propertySet.hasProperty(We.a.U2)||b.t7(0,1));else if(1===b.listType)b.NKd&&-1===b.EI||(b.font=zi.a.wDc,b.levelText=
zi.a.Iyd,b.propertySet.hasProperty(We.a.U2)||b.t7(1,6));else return;b.Zs="left"}static zNn(b,h){1===b.vr?li.mMn(b,h):li.JKn(b,h)}static mMn(b,h){(b.LA=h.LA)?b.O3=h.LA.O3:h.LA||v.ULS.sendTraceTag(588022422,393,15,"Multi level def info is null for list markerList Style {0}, List multi level type {1}, List Ordered : {2}",b.EI,b.vr,b.sr)}static JKn(b,h){b.levelText=h.levelText;b.sr?b.t7(0,h.listStyle):(b.font=h.font,b.t7(1,1));b.Zs=h.Zs}static Mxl(b,h){let r=null;2===b.vr?r=b.sr?Sa.a.instance.Pa("Box4.ListMarkerGallery.ListMarkerNumberingLoader"):
Sa.a.instance.Pa("Box4.ListMarkerGallery.ListMarkerBulletLoader"):1===b.vr&&(r=Sa.a.instance.Pa("Box4.ListMarkerGallery.ListMarkerMultilevelLoader"));let z=r.HEb.value;const R=b.EI+"";R in z||(z=r.J6,v.ULS.sendTraceTag(588391454,393,50,"List styleId {0} List Multi level type {1} and List Ordered : {2} is not present in default list marker dictionary",R,b.vr,b.sr));if(!(R in z)){v.ULS.sendTraceTag(588391455,393,50,"List styleId {0} List Multi level type {1} and List Ordered : {2} is not present in document list marker dictionary",
R,b.vr,b.sr);if(h.hasProperty(We.a.font))return v.ULS.sendTraceTag(588391456,393,50,"User creating new list marker for List styleId {0} List Multi level type {1} and List Ordered : {2}",R,b.vr,b.sr),b=h.ia(We.a.font,""),new Ko(B.a.fromCharCode(parseInt(R)),b);v.ULS.sendTraceTag(588391457,393,15,"List styleId {0} List Multi level type {1} and List Ordered : {2} not found in any dictionary",R,b.vr,b.sr)}return z[R]}static dKn(b){li.Tj.hasProperty(We.a.fontColor)&&b.setValue(We.a.fontColor,li.Tj.fontColor())}static gKn(b){li.Tj.hasProperty(We.a.fontSize)&&
b.setValue(We.a.fontSize,li.Tj.fontSize())}static RZ(b,h){b=b===Fb.a.Xz?0:b===Fb.a.tH?1:b===Fb.a.saa?2:-1;h=h.ia(od.a.EI,-1);v.ULS.sendTraceTag(22923024,324,50,"ListType: {0}, ListStyleId: {1}",b,h)}static abo(){const b=Sa.a.instance.Za("Common.ISystemInitiatedFeedback");if(b){var h=t.AFrameworkApplication.K.rc("WordDefaultToEditFloodgateDelayInMilliseconds",6E4);b.execute(r=>{window.setTimeout(()=>{r.logActivity("WordListsExperience","WordListsExperienceFloodgateIsEnabled")},h)})}else v.ULS.sendTraceTag(554796489,
301,15,"Word lists floodgate instance SystemInitiatedFeedback was null")}}li.B_l=$d.ImageReader.cOc;li.yQe=$d.ImageReader.WZa;li.Cf=null;li.Hm=null;li.wPc=!1;Object(n.a)(li,"ListActor",null,[]);class Bt{constructor(){this.HEb=new De.a(Object(u.a)(this,this.k0e,"createListMarkerDictionary"));this.J6={}}qLh(b){return b}}Object(n.a)(Bt,"AListMarkerGalleryLoader",null,[535]);var Js=d(1363),ht=d(438);class Dm extends Bt{constructor(){super();this.crb=new zd.a(ka.a.Rj())}qLh(b){Dm.sP||this.OHn();b in Dm.sP&&
(b=Dm.sP[b]);return b}k0e(){const b={};b["0"]=new Ko(Box4Intl.Box4Strings.L_ListStyleNone,Js.a.g$h);b["1"]=new Ko(String.fromCharCode(61623),"Symbol");b["2"]=new Ko(String.fromCharCode(111),"Courier New");b["3"]=new Ko(String.fromCharCode(61607),"Wingdings");b["4"]=new Ko(String.fromCharCode(9643),"Courier New");b["5"]=new Ko(String.fromCharCode(61611),"Wingdings");b["6"]=new Ko(String.fromCharCode(61614),"Symbol");b["7"]=new Ko(String.fromCharCode(61483),"Symbol");b["8"]=new Ko(String.fromCharCode(61485),
"Symbol");b["9"]=new Ko(String.fromCharCode(9830),"Courier New");b["10"]=new Ko(String.fromCharCode(61664),"Symbol");b["11"]=new Ko(String.fromCharCode(61558),"Wingdings");b["12"]=new Ko(String.fromCharCode(61656),"Wingdings");b["13"]=new Ko(String.fromCharCode(61514),"Wingdings");b["14"]=new Ko(String.fromCharCode(61516),"Wingdings");b["15"]=new Ko(String.fromCharCode(61692),"Wingdings");b["16"]=new Ko(String.fromCharCode(61691),"Wingdings");b["17"]=new Ko(String.fromCharCode(61553),"Wingdings");
return b}Tce(b){b&&b.length&&this.yUe(b)}CMf(){if(this.J6){var b=ht.a(this.J6),h=b.length;for(let r=0;r<h;r++){const z=this.J6[b[r]];this.crb.add(z.levelText+"_"+z.font)}}}yUe(b){this.CMf();for(const h of b)if(h&&!h.sr&&h.Nea&&h.r4b&&(b=h.levelText+"_"+h.font,!this.crb.contains(b))){const r=ht.a(this.J6).length+ht.a(this.HEb.value).length+"";this.J6[r]=new Ko(h.levelText,h.font);this.crb.add(b)}}OHn(){Dm.sP={};Dm.sP["Symbol 0x00b7"]=Box4Intl.Box4Strings.L_SolidBullet;Dm.sP["Courier New 0x006f"]=Box4Intl.Box4Strings.L_HollowBullet;
Dm.sP["Wingdings 0x00a7"]=Box4Intl.Box4Strings.L_SmallBlackSquare;Dm.sP["Courier New 0x25ab"]=Box4Intl.Box4Strings.L_SmallWhiteSquare;Dm.sP["Wingdings 0x00ab"]=Box4Intl.Box4Strings.L_Star;Dm.sP["Symbol 0x00ae"]=Box4Intl.Box4Strings.L_RightArrow;Dm.sP["Symbol 0x002b"]=Box4Intl.Box4Strings.L_PlusSign;Dm.sP["Symbol 0x002d"]=Box4Intl.Box4Strings.L_Hyphen;Dm.sP["Courier New 0x2666"]=Box4Intl.Box4Strings.L_BlackDiamond;Dm.sP["Symbol 0x00e0"]=Box4Intl.Box4Strings.L_WhiteDiamond;Dm.sP["Wingdings 0x0076"]=
Box4Intl.Box4Strings.L_BlackDiamondWithMinusX;Dm.sP["Wingdings 0x00d8"]=Box4Intl.Box4Strings.L_3DRightwards;Dm.sP["Wingdings 0x004a"]=Box4Intl.Box4Strings.L_SmilingFace;Dm.sP["Wingdings 0x004c"]=Box4Intl.Box4Strings.L_frowningFace;Dm.sP["Wingdings 0x00fc"]=Box4Intl.Box4Strings.L_CheckMark;Dm.sP["Wingdings 0x00fb"]=Box4Intl.Box4Strings.L_BallotScriptX;Dm.sP["Wingdings 0x0071"]=Box4Intl.Box4Strings.L_ShadowedWhiteSquare}}Dm.sP=null;Object(n.a)(Dm,"ListMarkerBulletLoader",Bt,[]);class qp{constructor(){this.styleAtLevel=
this.textAtLevel=null}}Object(n.a)(qp,"InfoAtLevel",null,[]);class Ct{constructor(b){this.LA=b}get font(){return"Calibri"}get listStyle(){return 42}get Zs(){return"left"}get u0d(){return this.LA?this.A8m():this.C8m()}get JQc(){return this.LA?this.B8m():null}get levelText(){return""}psl(b){switch(b){case 1:return"1";case 2:return"a";case 3:return"i";case 4:return"A";case 5:return"I";case 0:return"";default:return"1"}}A8m(){let b="";for(let h=0;3>h;h++)b+=this.oJc(h);return String.format('<DIV class="ListMultilevelPreview" style="{0}">{1}</DIV>',
Ct.Vcf(),b)}B8m(){const b=[];for(let h=0;3>h;h++)b.push(Object.assign(new qp,{textAtLevel:this.YWh(h),styleAtLevel:this.lKl(h)}));return b}C8m(){return String.format('<DIV class="ListMultilevelPreview" style="{0}">{1}</DIV>',Ct.Wcf(),Box4Intl.Box4Strings.L_ListStyleNone)}YWh(b){b=this.LA.KQc[b];for(let h=0;9>h;h++)b=B.a.replaceAll(b,"%"+(h+1),this.psl(this.LA.JEb[h]));return b}lKl(b){const h={};h.fontFamily=6===this.LA.JEb[b]?this.LA.MAa[b]:this.font;return h}oJc(b){const h=this.YWh(b),r=new Sys.StringBuilder;
6===this.LA.JEb[b]&&r.append(String.format("font-family:{0};",this.LA.MAa[b]));return String.format('<DIV class="level{0}" style="position: relative;">\r\n\t\t\t\t\t<SPAN style="{1}">{2}</SPAN>\r\n\t\t\t\t\t<SPAN style="height: 2px; margin-left: 4px; margin-right: 4px; background-color: #aaaaaa; width: 100%; position: absolute; top: 50%; outline: 1px solid transparent;"></SPAN>\r\n\t\t\t\t</DIV>',b,r.toString(),h)}static Vcf(){const b=new Sys.StringBuilder;b.append("padding-left: 2pt; ");b.append("font-size: 9pt; ");
return b}static Wcf(){const b=new Sys.StringBuilder;b.append("text-align: center; ");b.append("margin-top: 22%; ");b.append("font-size: 12pt; ");return b}}Object(n.a)(Ct,"ListMarkerMultilevel",null,[534]);var cx=d(771);class pw extends Bt{constructor(){super()}k0e(){const b=new cx.a,h={};h["0"]=new Ct(null);h["1"]=new Ct(b.D_e());h["2"]=new Ct(b.w0e("%1) %2) %3) (%4) (%5) (%6) %7. %8. %9.".split(" "),[1,2,3,1,2,3,1,2,3]));h["3"]=new Ct(b.$sh([61558,61656,61607,61623,9830,61656,61607,61623,9830],"Wingdings;Wingdings;Wingdings;Symbol;Courier New;Wingdings;Wingdings;Symbol;Courier New".split(";")));
return h}Tce(){}}Object(n.a)(pw,"ListMarkerMultilevelLoader",Bt,[]);var So=d(146);class iq{constructor(b,h){this.LA=null;this.levelText=b;this.nfd=h}get font(){return"Calibri"}get listStyle(){return this.nfd}get Zs(){switch(this.nfd){case 3:case 5:return"right";default:return"left"}}get u0d(){switch(this.nfd){case 1:return this.kbc("1","2","3");case 2:return this.kbc("a","b","c");case 3:return this.kbc("i","ii","iii");case 4:return this.kbc("A","B","C");case 5:return this.kbc("I","II","III");case 0:return this.D8m();
default:return this.kbc("1","2","3")}}get JQc(){const b=[],h={};h.fontFamily=So.FontUtils.Nza(this.font);switch(this.nfd){case 1:return b.push(Object.assign(new qp,{textAtLevel:this.EW("1"),styleAtLevel:h})),b.push(Object.assign(new qp,{textAtLevel:this.EW("2"),styleAtLevel:h})),b.push(Object.assign(new qp,{textAtLevel:this.EW("3"),styleAtLevel:h})),b;case 2:return b.push(Object.assign(new qp,{textAtLevel:this.EW("a"),styleAtLevel:h})),b.push(Object.assign(new qp,{textAtLevel:this.EW("b"),styleAtLevel:h})),
b.push(Object.assign(new qp,{textAtLevel:this.EW("c"),styleAtLevel:h})),b;case 3:return b.push(Object.assign(new qp,{textAtLevel:this.EW("i"),styleAtLevel:h})),b.push(Object.assign(new qp,{textAtLevel:this.EW("ii"),styleAtLevel:h})),b.push(Object.assign(new qp,{textAtLevel:this.EW("iii"),styleAtLevel:h})),b;case 4:return b.push(Object.assign(new qp,{textAtLevel:this.EW("A"),styleAtLevel:h})),b.push(Object.assign(new qp,{textAtLevel:this.EW("B"),styleAtLevel:h})),b.push(Object.assign(new qp,{textAtLevel:this.EW("C"),
styleAtLevel:h})),b;case 5:return b.push(Object.assign(new qp,{textAtLevel:this.EW("I"),styleAtLevel:h})),b.push(Object.assign(new qp,{textAtLevel:this.EW("II"),styleAtLevel:h})),b.push(Object.assign(new qp,{textAtLevel:this.EW("III"),styleAtLevel:h})),b;case 0:return null;default:return b.push(Object.assign(new qp,{textAtLevel:this.EW("1"),styleAtLevel:h})),b.push(Object.assign(new qp,{textAtLevel:this.EW("2"),styleAtLevel:h})),b.push(Object.assign(new qp,{textAtLevel:this.EW("3"),styleAtLevel:h})),
b}}kbc(b,h,r){return String.format('<DIV class="ListNumberPreview" style="{0}">{1}{2}{3}</DIV>',iq.Vcf(),this.oJc(b),this.oJc(h),this.oJc(r))}D8m(){return String.format('<DIV class="ListNumberPreview" style="{0}">{1}</DIV>',iq.Wcf(),Box4Intl.Box4Strings.L_ListStyleNone)}oJc(b){b=this.EW(b);return String.format('<DIV style="position: relative;"><SPAN>{0}</SPAN><SPAN class="ListMarkerGalleryPreviewLine"></SPAN></DIV>',b)}EW(b){return B.a.replaceAll(this.levelText,"%1",b)}static Vcf(){const b=new Sys.StringBuilder;
b.append("padding-left: 2pt; ");b.append("font-size: 9pt; ");return b}static Wcf(){const b=new Sys.StringBuilder;b.append("text-align: center; ");b.append("margin-top: 22%; ");b.append("font-size: 12pt; ");return b}}Object(n.a)(iq,"ListMarkerNumbering",null,[534]);class Iv extends Bt{constructor(){super();this.crb=new zd.a(ka.a.Rj())}Dkm(b){b=b.match(RegExp("%[1-9]","g"));return!!b&&1===b.length}k0e(){const b={};b["0"]=new iq(Box4Intl.Box4Strings.L_ListStyleNone,0);b["1"]=new iq("%1.",5);b["2"]=new iq("%1.",
4);b["3"]=new iq("%1.",1);b["4"]=new iq("%1.",2);b["5"]=new iq("%1.",3);b["6"]=new iq("%1)",5);b["7"]=new iq("%1)",4);b["8"]=new iq("%1)",1);b["9"]=new iq("%1)",2);b["10"]=new iq("%1)",3);b["11"]=new iq("(%1)",5);b["12"]=new iq("(%1)",4);b["13"]=new iq("(%1)",1);b["14"]=new iq("(%1)",2);b["15"]=new iq("(%1)",3);return b}Tce(b){b&&b.length&&this.yUe(b)}CMf(){if(this.J6){var b=ht.a(this.J6),h=b.length;for(let r=0;r<h;r++){const z=this.J6[b[r]];this.crb.add(z.levelText+"_"+z.listStyle)}}}yUe(b){this.CMf();
for(const h of b)if(h&&h.sr&&h.Nea&&this.Dkm(h.levelText)&&h.listStyle&&(b=Js.a.uaf(h.levelText))){const r=b+"_"+h.listStyle;if(!this.crb.contains(r)){const z=ht.a(this.J6).length+ht.a(this.HEb.value).length+"";this.J6[z]=new iq(b,h.listStyle)}this.crb.add(r)}}}Object(n.a)(Iv,"ListMarkerNumberingLoader",Bt,[]);class bv{constructor(){this.W=null}get name(){return"Box4.ListMarker"}init(){li.Vb()}dispose(){}yc(b){this.W=b;this.W.ha("Box4.ListMarkerGallery.ListMarkerBulletLoader",()=>new Dm).singleInstance();
this.W.ha("Box4.ListMarkerGallery.ListMarkerNumberingLoader",()=>new Iv).singleInstance();this.W.ha("Box4.ListMarkerGallery.ListMarkerMultilevelLoader",()=>new pw).singleInstance()}static main(){O.a.instance.Oc(new bv)}}Object(n.a)(bv,"Box4ListMarkerPackage",null,[1,2]);class cv{static get vg(){return Wc.a.Px(cv.sl,Box4Intl.Box4Strings.L_DefineNewBulletFont,Box4Intl.Box4Strings.L_DefineNewBulletCharacterCode,"")}}cv.sl="<div class='DefineNewBulletDialogFontTitle UIFontBold' id='FontTitle'> <label id='FontTitleLabel' class='WACDialogLabel' for='FontPlaceholder' >{0}</label> </div> <div class='normal' id='FontControl'> <div id='DefineNewBulletFontPlaceholder'></div> </div> <div class='normal' id='ListMarkerTable'> <div id='DefineNewBulletTableContainer' class='DefineNewBulletTableContainer' style='height: 195px; overflow-x: hidden; overflow-y: scroll;'></div> </div> <div class='WACDialogRow' id='CharacterCode'> <label id='CharacterCodeLabel' class='WACDialogLabel' >{1}</label> </div> <div class='WACDialogRow' id='CharacterCodeValue'> <label id='CharacterCodeValueLabel' class='WACDialogLabel' >{2}</label> </div>";
Object(n.a)(cv,"DefineNewBulletDialogHtml",null,[]);class nr extends Wc.a{constructor(b,h,r,z){super();this.Sqc=this.Vxe=this.eSb=this.YRb=null;this.Krb=0;this.hzc=["Symbol","Wingdings","Wingdings 2","Wingdings 3","Webdings"];this.Q7h=!0;this.MRk=R=>{if(this.YRb&&R.target!==this.YRb){const ba=this.Ci.Gs();ba&&ba.Vj&&(ba.Vj.oy(R.target),this.YRb=R.target)}this.dXm(R.target.id)};this.Urm=R=>{R=R.Af;if(!this.Oii(R))return!1;this.Ci.Gs().Vj.oy(R);R.focus();return!0};this.Vrm=R=>{var ba=R.Af;if(!this.Oii(ba))return!1;
var ta=ba.id;ta=parseInt(ta.substr(ta.lastIndexOf("_")+1))-this.Krb;if(R.Ib.ctrlKey||R.Ib.altKey||R.Ib.keyCode>=wb.a.kNb&&R.Ib.keyCode<=wb.a.lNb)return!1;const Wa=R.Ib.keyCode;if(R.eventName===jb.a.li){R=-1;if(Wa===Sys.UI.Key.enter)return this.Ci.Gs().Vj.oy(ba),ba.focus(),this.Sxi(ba.id),this.hide(),!0;Wa===Sys.UI.Key.up?R=ta-17:Wa===Sys.UI.Key.down?R=ta+17:Wa===Sys.UI.Key.left?R=t.AFrameworkApplication.isRtl?ta+1:ta-1:Wa===Sys.UI.Key.right&&(R=t.AFrameworkApplication.isRtl?ta-1:ta+1);0<=R&&(ba=this.PTh(nr.T_b+
"_"+(R+this.Krb)))&&ba.focus()}return!0};this.LRk=R=>{1===R&&this.Sxi(this.eSb);this.hide()};this.kp=b;this.Ci=h;this.ga=r;this.LK=!1;z&&(b=z.indexOf(","),-1!==b&&(z=z.substring(0,b)));this.fontName=z;this.kg="DefineNewBulletDialog";this.vg=cv.vg;this.Ve(1,Box4Intl.Box4Strings.L_SymbolInsertButtonText);this.Ve(0,CommonUIStrings.l_DialogClose);this.Wh(Box4Intl.Box4Strings.L_SymbolSingle,this.LRk,null);this.q8=!1;this.JDa();document.getElementById(nr.uDd).focus()}JDa(){this.Ci.Gs().scope.Dr(ve.FocusManager.instance().EV);
this.Ci.Gs().scope.Dr(ve.FocusManager.instance().FV);this.Ci.Gs().scope.bindAction(ve.FocusManager.instance().EV,Fb.a.Syd);this.Ci.Gs().scope.bindAction(ve.FocusManager.instance().FV,Fb.a.Ryd)}cU(){this.ltd(nr.uDd,"DefineNewBulletFontPlaceholder",Fb.a.Qyd.toString(),Fb.a.LHb.toString(),Fb.a.eVc.toString(),Box4Intl.Box4Strings.L_FontName,"100px");this.jlk()}rO(){super.rO();document.getElementById(this.qj("WACDialogPanel")).style.width="auto"}ltd(b,h,r,z,R,ba,ta){r=Kf.c(b,r,!0,!0,z,R,B.a.If(ba),!0,
ta);this.yxd(b,h,r,"Medium")}jlk(){const b=document.getElementById(nr.T_b);b&&(b.innerHTML=this.wPh(),this.cMi(b))}cMi(b){if(b=b.getElementsByClassName("DefineNewBulletTableCell"))for(let h=0;h<b.length;h++)Bf.a.addHandler(b[h],jb.a.focus,this.MRk)}zio(){var b=document.getElementById(nr.T_b);if(b){let h=this.fontName;const r=Js.a.gpf(this.fontName);r&&61472!==this.Krb||!r&&32!==this.Krb?(b.innerHTML=this.wPh(),this.cMi(b)):(b=b.getElementsByTagName("table"))&&1===b.length&&h&&(h=this.W8g(h),b[0].style.fontFamily=
h)}}dXm(b){this.a_i(this.eSb,!1);this.eSb=b;this.a_i(b,!0);if((b=document.getElementById("CharacterCodeValueLabel"))&&this.eSb){let h=parseInt(this.eSb.substr(this.eSb.lastIndexOf("_")+1));-1!==h&&(h-=61472===this.Krb?61440:0,b.innerText=B.a.dI(h,4))}}a_i(b,h){(b=this.PTh(b))&&(h?b.setAttribute("selected","true"):b.removeAttribute("selected"))}PTh(b){const h=document.getElementById(nr.T_b);return h?h.querySelector("#"+b):null}Kja(){const b=document.getElementById(nr.T_b);b&&(this.Vxe||(this.Vxe=this.Urm,
this.mq.mb(jb.a.click,b,this.Vxe)),this.Sqc||(this.Sqc=this.Vrm,this.ke.mb(jb.a.li,b,this.Sqc),this.ke.mb(jb.a.Ft,b,this.Sqc),this.ke.mb(jb.a.oh,b,this.Sqc)));super.Kja()}Oii(b){return b.classList.contains("DefineNewBulletTableCell")}Sxi(b){if(b){b=b.split("_");const h=new Ei.DictionaryPropertySet;h.setValue(od.a.EI,parseInt(b[1]));h.setValue(We.a.font,this.fontName);h.setValue(od.a.Nv,1);bt.a.bX&&(h.setValue(ui.a.Bma,"command-ui"),h.setValue(ui.a.tfa,"define-new-bullet-dialog"));this.ga.Xb(Fb.a.Xz,
2,h)}this.Ci.uK(this.UJ,!0)}wPh(){const b=new Sys.StringBuilder,h=Js.a.gpf(this.fontName);let r=this.fontName;r=this.W8g(r);b.append(String.format('<table class="DefineNewBulletTable" style="font-family: {0};">',r));h?(this.Krb=61472,b.append('<tbody>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61472" title="0x0020" tabindex="0">\uf020</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61473" title="0x0021" tabindex="0">\uf021</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61474" title="0x0022" tabindex="0">\uf022</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61475" title="0x0023" tabindex="0">\uf023</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61476" title="0x0024" tabindex="0">\uf024</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61477" title="0x0025" tabindex="0">\uf025</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61478" title="0x0026" tabindex="0">\uf026</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61479" title="0x0027" tabindex="0">\uf027</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61480" title="0x0028" tabindex="0">\uf028</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61481" title="0x0029" tabindex="0">\uf029</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61482" title="0x002a" tabindex="0">\uf02a</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61483" title="0x002b" tabindex="0">\uf02b</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61484" title="0x002c" tabindex="0">\uf02c</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61485" title="0x002d" tabindex="0">\uf02d</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61486" title="0x002e" tabindex="0">\uf02e</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61487" title="0x002f" tabindex="0">\uf02f</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61488" title="0x0030" tabindex="0">\uf030</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61489" title="0x0031" tabindex="0">\uf031</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61490" title="0x0032" tabindex="0">\uf032</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61491" title="0x0033" tabindex="0">\uf033</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61492" title="0x0034" tabindex="0">\uf034</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61493" title="0x0035" tabindex="0">\uf035</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61494" title="0x0036" tabindex="0">\uf036</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61495" title="0x0037" tabindex="0">\uf037</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61496" title="0x0038" tabindex="0">\uf038</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61497" title="0x0039" tabindex="0">\uf039</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61498" title="0x003a" tabindex="0">\uf03a</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61499" title="0x003b" tabindex="0">\uf03b</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61500" title="0x003c" tabindex="0">\uf03c</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61501" title="0x003d" tabindex="0">\uf03d</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61502" title="0x003e" tabindex="0">\uf03e</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61503" title="0x003f" tabindex="0">\uf03f</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61504" title="0x0040" tabindex="0">\uf040</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61505" title="0x0041" tabindex="0">\uf041</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61506" title="0x0042" tabindex="0">\uf042</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61507" title="0x0043" tabindex="0">\uf043</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61508" title="0x0044" tabindex="0">\uf044</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61509" title="0x0045" tabindex="0">\uf045</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61510" title="0x0046" tabindex="0">\uf046</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61511" title="0x0047" tabindex="0">\uf047</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61512" title="0x0048" tabindex="0">\uf048</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61513" title="0x0049" tabindex="0">\uf049</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61514" title="0x004a" tabindex="0">\uf04a</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61515" title="0x004b" tabindex="0">\uf04b</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61516" title="0x004c" tabindex="0">\uf04c</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61517" title="0x004d" tabindex="0">\uf04d</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61518" title="0x004e" tabindex="0">\uf04e</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61519" title="0x004f" tabindex="0">\uf04f</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61520" title="0x0050" tabindex="0">\uf050</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61521" title="0x0051" tabindex="0">\uf051</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61522" title="0x0052" tabindex="0">\uf052</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61523" title="0x0053" tabindex="0">\uf053</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61524" title="0x0054" tabindex="0">\uf054</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61525" title="0x0055" tabindex="0">\uf055</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61526" title="0x0056" tabindex="0">\uf056</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61527" title="0x0057" tabindex="0">\uf057</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61528" title="0x0058" tabindex="0">\uf058</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61529" title="0x0059" tabindex="0">\uf059</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61530" title="0x005a" tabindex="0">\uf05a</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61531" title="0x005b" tabindex="0">\uf05b</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61532" title="0x005c" tabindex="0">\uf05c</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61533" title="0x005d" tabindex="0">\uf05d</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61534" title="0x005e" tabindex="0">\uf05e</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61535" title="0x005f" tabindex="0">\uf05f</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61536" title="0x0060" tabindex="0">\uf060</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61537" title="0x0061" tabindex="0">\uf061</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61538" title="0x0062" tabindex="0">\uf062</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61539" title="0x0063" tabindex="0">\uf063</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61540" title="0x0064" tabindex="0">\uf064</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61541" title="0x0065" tabindex="0">\uf065</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61542" title="0x0066" tabindex="0">\uf066</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61543" title="0x0067" tabindex="0">\uf067</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61544" title="0x0068" tabindex="0">\uf068</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61545" title="0x0069" tabindex="0">\uf069</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61546" title="0x006a" tabindex="0">\uf06a</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61547" title="0x006b" tabindex="0">\uf06b</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61548" title="0x006c" tabindex="0">\uf06c</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61549" title="0x006d" tabindex="0">\uf06d</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61550" title="0x006e" tabindex="0">\uf06e</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61551" title="0x006f" tabindex="0">\uf06f</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61552" title="0x0070" tabindex="0">\uf070</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61553" title="0x0071" tabindex="0">\uf071</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61554" title="0x0072" tabindex="0">\uf072</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61555" title="0x0073" tabindex="0">\uf073</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61556" title="0x0074" tabindex="0">\uf074</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61557" title="0x0075" tabindex="0">\uf075</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61558" title="0x0076" tabindex="0">\uf076</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61559" title="0x0077" tabindex="0">\uf077</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61560" title="0x0078" tabindex="0">\uf078</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61561" title="0x0079" tabindex="0">\uf079</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61562" title="0x007a" tabindex="0">\uf07a</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61563" title="0x007b" tabindex="0">\uf07b</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61564" title="0x007c" tabindex="0">\uf07c</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61565" title="0x007d" tabindex="0">\uf07d</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61566" title="0x007e" tabindex="0">\uf07e</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61567" title="0x007f" tabindex="0">\uf07f</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61568" title="0x0080" tabindex="0">\uf080</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61569" title="0x0081" tabindex="0">\uf081</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61570" title="0x0082" tabindex="0">\uf082</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61571" title="0x0083" tabindex="0">\uf083</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61572" title="0x0084" tabindex="0">\uf084</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61573" title="0x0085" tabindex="0">\uf085</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61574" title="0x0086" tabindex="0">\uf086</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61575" title="0x0087" tabindex="0">\uf087</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61576" title="0x0088" tabindex="0">\uf088</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61577" title="0x0089" tabindex="0">\uf089</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61578" title="0x008a" tabindex="0">\uf08a</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61579" title="0x008b" tabindex="0">\uf08b</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61580" title="0x008c" tabindex="0">\uf08c</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61581" title="0x008d" tabindex="0">\uf08d</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61582" title="0x008e" tabindex="0">\uf08e</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61583" title="0x008f" tabindex="0">\uf08f</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61584" title="0x0090" tabindex="0">\uf090</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61585" title="0x0091" tabindex="0">\uf091</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61586" title="0x0092" tabindex="0">\uf092</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61587" title="0x0093" tabindex="0">\uf093</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61588" title="0x0094" tabindex="0">\uf094</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61589" title="0x0095" tabindex="0">\uf095</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61590" title="0x0096" tabindex="0">\uf096</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61591" title="0x0097" tabindex="0">\uf097</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61592" title="0x0098" tabindex="0">\uf098</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61593" title="0x0099" tabindex="0">\uf099</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61594" title="0x009a" tabindex="0">\uf09a</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61595" title="0x009b" tabindex="0">\uf09b</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61596" title="0x009c" tabindex="0">\uf09c</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61597" title="0x009d" tabindex="0">\uf09d</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61598" title="0x009e" tabindex="0">\uf09e</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61599" title="0x009f" tabindex="0">\uf09f</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61600" title="0x00a0" tabindex="0">\uf0a0</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61601" title="0x00a1" tabindex="0">\uf0a1</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61602" title="0x00a2" tabindex="0">\uf0a2</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61603" title="0x00a3" tabindex="0">\uf0a3</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61604" title="0x00a4" tabindex="0">\uf0a4</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61605" title="0x00a5" tabindex="0">\uf0a5</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61606" title="0x00a6" tabindex="0">\uf0a6</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61607" title="0x00a7" tabindex="0">\uf0a7</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61608" title="0x00a8" tabindex="0">\uf0a8</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61609" title="0x00a9" tabindex="0">\uf0a9</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61610" title="0x00aa" tabindex="0">\uf0aa</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61611" title="0x00ab" tabindex="0">\uf0ab</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61612" title="0x00ac" tabindex="0">\uf0ac</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61613" title="0x00ad" tabindex="0">\uf0ad</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61614" title="0x00ae" tabindex="0">\uf0ae</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61615" title="0x00af" tabindex="0">\uf0af</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61616" title="0x00b0" tabindex="0">\uf0b0</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61617" title="0x00b1" tabindex="0">\uf0b1</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61618" title="0x00b2" tabindex="0">\uf0b2</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61619" title="0x00b3" tabindex="0">\uf0b3</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61620" title="0x00b4" tabindex="0">\uf0b4</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61621" title="0x00b5" tabindex="0">\uf0b5</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61622" title="0x00b6" tabindex="0">\uf0b6</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61623" title="0x00b7" tabindex="0">\uf0b7</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61624" title="0x00b8" tabindex="0">\uf0b8</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61625" title="0x00b9" tabindex="0">\uf0b9</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61626" title="0x00ba" tabindex="0">\uf0ba</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61627" title="0x00bb" tabindex="0">\uf0bb</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61628" title="0x00bc" tabindex="0">\uf0bc</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61629" title="0x00bd" tabindex="0">\uf0bd</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61630" title="0x00be" tabindex="0">\uf0be</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61631" title="0x00bf" tabindex="0">\uf0bf</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61632" title="0x00c0" tabindex="0">\uf0c0</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61633" title="0x00c1" tabindex="0">\uf0c1</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61634" title="0x00c2" tabindex="0">\uf0c2</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61635" title="0x00c3" tabindex="0">\uf0c3</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61636" title="0x00c4" tabindex="0">\uf0c4</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61637" title="0x00c5" tabindex="0">\uf0c5</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61638" title="0x00c6" tabindex="0">\uf0c6</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61639" title="0x00c7" tabindex="0">\uf0c7</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61640" title="0x00c8" tabindex="0">\uf0c8</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61641" title="0x00c9" tabindex="0">\uf0c9</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61642" title="0x00ca" tabindex="0">\uf0ca</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61643" title="0x00cb" tabindex="0">\uf0cb</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61644" title="0x00cc" tabindex="0">\uf0cc</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61645" title="0x00cd" tabindex="0">\uf0cd</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61646" title="0x00ce" tabindex="0">\uf0ce</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61647" title="0x00cf" tabindex="0">\uf0cf</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61648" title="0x00d0" tabindex="0">\uf0d0</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61649" title="0x00d1" tabindex="0">\uf0d1</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61650" title="0x00d2" tabindex="0">\uf0d2</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61651" title="0x00d3" tabindex="0">\uf0d3</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61652" title="0x00d4" tabindex="0">\uf0d4</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61653" title="0x00d5" tabindex="0">\uf0d5</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61654" title="0x00d6" tabindex="0">\uf0d6</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61655" title="0x00d7" tabindex="0">\uf0d7</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61656" title="0x00d8" tabindex="0">\uf0d8</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61657" title="0x00d9" tabindex="0">\uf0d9</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61658" title="0x00da" tabindex="0">\uf0da</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61659" title="0x00db" tabindex="0">\uf0db</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61660" title="0x00dc" tabindex="0">\uf0dc</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61661" title="0x00dd" tabindex="0">\uf0dd</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61662" title="0x00de" tabindex="0">\uf0de</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61663" title="0x00df" tabindex="0">\uf0df</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61664" title="0x00e0" tabindex="0">\uf0e0</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61665" title="0x00e1" tabindex="0">\uf0e1</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61666" title="0x00e2" tabindex="0">\uf0e2</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61667" title="0x00e3" tabindex="0">\uf0e3</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61668" title="0x00e4" tabindex="0">\uf0e4</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61669" title="0x00e5" tabindex="0">\uf0e5</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61670" title="0x00e6" tabindex="0">\uf0e6</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61671" title="0x00e7" tabindex="0">\uf0e7</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61672" title="0x00e8" tabindex="0">\uf0e8</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61673" title="0x00e9" tabindex="0">\uf0e9</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61674" title="0x00ea" tabindex="0">\uf0ea</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61675" title="0x00eb" tabindex="0">\uf0eb</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61676" title="0x00ec" tabindex="0">\uf0ec</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61677" title="0x00ed" tabindex="0">\uf0ed</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61678" title="0x00ee" tabindex="0">\uf0ee</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61679" title="0x00ef" tabindex="0">\uf0ef</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61680" title="0x00f0" tabindex="0">\uf0f0</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61681" title="0x00f1" tabindex="0">\uf0f1</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61682" title="0x00f2" tabindex="0">\uf0f2</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61683" title="0x00f3" tabindex="0">\uf0f3</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61684" title="0x00f4" tabindex="0">\uf0f4</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61685" title="0x00f5" tabindex="0">\uf0f5</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61686" title="0x00f6" tabindex="0">\uf0f6</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61687" title="0x00f7" tabindex="0">\uf0f7</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61688" title="0x00f8" tabindex="0">\uf0f8</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61689" title="0x00f9" tabindex="0">\uf0f9</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61690" title="0x00fa" tabindex="0">\uf0fa</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61691" title="0x00fb" tabindex="0">\uf0fb</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61692" title="0x00fc" tabindex="0">\uf0fc</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61693" title="0x00fd" tabindex="0">\uf0fd</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61694" title="0x00fe" tabindex="0">\uf0fe</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61695" title="0x00ff" tabindex="0">\uf0ff</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t</tbody>')):
(this.Krb=32,b.append('<tbody>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_32" title="0x0020" tabindex="0"></div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_33" title="0x0021" tabindex="0">!</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_34" title="0x0022" tabindex="0">"</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_35" title="0x0023" tabindex="0">#</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_36" title="0x0024" tabindex="0">$</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_37" title="0x0025" tabindex="0">%</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_38" title="0x0026" tabindex="0">&amp;</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_39" title="0x0027" tabindex="0">\'</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_40" title="0x0028" tabindex="0">(</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_41" title="0x0029" tabindex="0">)</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_42" title="0x002a" tabindex="0">*</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_43" title="0x002b" tabindex="0">+</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_44" title="0x002c" tabindex="0">,</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_45" title="0x002d" tabindex="0">-</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_46" title="0x002e" tabindex="0">.</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_47" title="0x002f" tabindex="0">/</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_48" title="0x0030" tabindex="0">0</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_49" title="0x0031" tabindex="0">1</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_50" title="0x0032" tabindex="0">2</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_51" title="0x0033" tabindex="0">3</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_52" title="0x0034" tabindex="0">4</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_53" title="0x0035" tabindex="0">5</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_54" title="0x0036" tabindex="0">6</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_55" title="0x0037" tabindex="0">7</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_56" title="0x0038" tabindex="0">8</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_57" title="0x0039" tabindex="0">9</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_58" title="0x003a" tabindex="0">:</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_59" title="0x003b" tabindex="0">;</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_60" title="0x003c" tabindex="0">&lt;</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61" title="0x003d" tabindex="0">=</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_62" title="0x003e" tabindex="0">&gt;</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_63" title="0x003f" tabindex="0">?</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_64" title="0x0040" tabindex="0">@</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_65" title="0x0041" tabindex="0">A</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_66" title="0x0042" tabindex="0">B</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_67" title="0x0043" tabindex="0">C</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_68" title="0x0044" tabindex="0">D</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_69" title="0x0045" tabindex="0">E</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_70" title="0x0046" tabindex="0">F</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_71" title="0x0047" tabindex="0">G</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_72" title="0x0048" tabindex="0">H</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_73" title="0x0049" tabindex="0">I</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_74" title="0x004a" tabindex="0">J</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_75" title="0x004b" tabindex="0">K</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_76" title="0x004c" tabindex="0">L</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_77" title="0x004d" tabindex="0">M</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_78" title="0x004e" tabindex="0">N</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_79" title="0x004f" tabindex="0">O</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_80" title="0x0050" tabindex="0">P</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_81" title="0x0051" tabindex="0">Q</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_82" title="0x0052" tabindex="0">R</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_83" title="0x0053" tabindex="0">S</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_84" title="0x0054" tabindex="0">T</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_85" title="0x0055" tabindex="0">U</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_86" title="0x0056" tabindex="0">V</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_87" title="0x0057" tabindex="0">W</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_88" title="0x0058" tabindex="0">X</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_89" title="0x0059" tabindex="0">Y</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_90" title="0x005a" tabindex="0">Z</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_91" title="0x005b" tabindex="0">[</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_92" title="0x005c" tabindex="0">\\</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_93" title="0x005d" tabindex="0">]</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_94" title="0x005e" tabindex="0">^</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_95" title="0x005f" tabindex="0">_</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_96" title="0x0060" tabindex="0">`</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_97" title="0x0061" tabindex="0">a</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_98" title="0x0062" tabindex="0">b</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_99" title="0x0063" tabindex="0">c</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_100" title="0x0064" tabindex="0">d</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_101" title="0x0065" tabindex="0">e</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_102" title="0x0066" tabindex="0">f</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_103" title="0x0067" tabindex="0">g</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_104" title="0x0068" tabindex="0">h</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_105" title="0x0069" tabindex="0">i</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_106" title="0x006a" tabindex="0">j</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_107" title="0x006b" tabindex="0">k</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_108" title="0x006c" tabindex="0">l</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_109" title="0x006d" tabindex="0">m</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_110" title="0x006e" tabindex="0">n</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_111" title="0x006f" tabindex="0">o</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_112" title="0x0070" tabindex="0">p</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_113" title="0x0071" tabindex="0">q</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_114" title="0x0072" tabindex="0">r</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_115" title="0x0073" tabindex="0">s</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_116" title="0x0074" tabindex="0">t</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_117" title="0x0075" tabindex="0">u</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_118" title="0x0076" tabindex="0">v</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_119" title="0x0077" tabindex="0">w</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_120" title="0x0078" tabindex="0">x</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_121" title="0x0079" tabindex="0">y</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_122" title="0x007a" tabindex="0">z</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_123" title="0x007b" tabindex="0">{</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_124" title="0x007c" tabindex="0">|</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_125" title="0x007d" tabindex="0">}</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_126" title="0x007e" tabindex="0">~</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_127" title="0x007f" tabindex="0">\u007f</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_128" title="0x0080" tabindex="0">\u0080</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_129" title="0x0081" tabindex="0">\u0081</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_130" title="0x0082" tabindex="0">\u0082</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_131" title="0x0083" tabindex="0">\u0083</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_132" title="0x0084" tabindex="0">\u0084</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_133" title="0x0085" tabindex="0"></div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_134" title="0x0086" tabindex="0">\u0086</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_135" title="0x0087" tabindex="0">\u0087</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_136" title="0x0088" tabindex="0">\u0088</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_137" title="0x0089" tabindex="0">\u0089</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_138" title="0x008a" tabindex="0">\u008a</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_139" title="0x008b" tabindex="0">\u008b</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_140" title="0x008c" tabindex="0">\u008c</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_141" title="0x008d" tabindex="0">\u008d</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_142" title="0x008e" tabindex="0">\u008e</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_143" title="0x008f" tabindex="0">\u008f</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_144" title="0x0090" tabindex="0">\u0090</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_145" title="0x0091" tabindex="0">\u0091</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_146" title="0x0092" tabindex="0">\u0092</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_147" title="0x0093" tabindex="0">\u0093</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_148" title="0x0094" tabindex="0">\u0094</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_149" title="0x0095" tabindex="0">\u0095</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_150" title="0x0096" tabindex="0">\u0096</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_151" title="0x0097" tabindex="0">\u0097</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_152" title="0x0098" tabindex="0">\u0098</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_153" title="0x0099" tabindex="0">\u0099</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_154" title="0x009a" tabindex="0">\u009a</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_155" title="0x009b" tabindex="0">\u009b</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_156" title="0x009c" tabindex="0">\u009c</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_157" title="0x009d" tabindex="0">\u009d</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_158" title="0x009e" tabindex="0">\u009e</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_159" title="0x009f" tabindex="0">\u009f</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_160" title="0x00a0" tabindex="0">&nbsp;</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_161" title="0x00a1" tabindex="0">\u00a1</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_162" title="0x00a2" tabindex="0">\u00a2</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_163" title="0x00a3" tabindex="0">\u00a3</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_164" title="0x00a4" tabindex="0">\u00a4</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_165" title="0x00a5" tabindex="0">\u00a5</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_166" title="0x00a6" tabindex="0">\u00a6</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_167" title="0x00a7" tabindex="0">\u00a7</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_168" title="0x00a8" tabindex="0">\u00a8</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_169" title="0x00a9" tabindex="0">\u00a9</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_170" title="0x00aa" tabindex="0">\u00aa</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_171" title="0x00ab" tabindex="0">\u00ab</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_172" title="0x00ac" tabindex="0">\u00ac</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_173" title="0x00ad" tabindex="0">\u00ad</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_174" title="0x00ae" tabindex="0">\u00ae</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_175" title="0x00af" tabindex="0">\u00af</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_176" title="0x00b0" tabindex="0">\u00b0</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_177" title="0x00b1" tabindex="0">\u00b1</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_178" title="0x00b2" tabindex="0">\u00b2</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_179" title="0x00b3" tabindex="0">\u00b3</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_180" title="0x00b4" tabindex="0">\u00b4</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_181" title="0x00b5" tabindex="0">\u00b5</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_182" title="0x00b6" tabindex="0">\u00b6</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_183" title="0x00b7" tabindex="0">\u00b7</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_184" title="0x00b8" tabindex="0">\u00b8</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_185" title="0x00b9" tabindex="0">\u00b9</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_186" title="0x00ba" tabindex="0">\u00ba</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_187" title="0x00bb" tabindex="0">\u00bb</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_188" title="0x00bc" tabindex="0">\u00bc</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_189" title="0x00bd" tabindex="0">\u00bd</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_190" title="0x00be" tabindex="0">\u00be</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_191" title="0x00bf" tabindex="0">\u00bf</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_192" title="0x00c0" tabindex="0">\u00c0</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_193" title="0x00c1" tabindex="0">\u00c1</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_194" title="0x00c2" tabindex="0">\u00c2</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_195" title="0x00c3" tabindex="0">\u00c3</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_196" title="0x00c4" tabindex="0">\u00c4</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_197" title="0x00c5" tabindex="0">\u00c5</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_198" title="0x00c6" tabindex="0">\u00c6</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_199" title="0x00c7" tabindex="0">\u00c7</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_200" title="0x00c8" tabindex="0">\u00c8</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_201" title="0x00c9" tabindex="0">\u00c9</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_202" title="0x00ca" tabindex="0">\u00ca</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_203" title="0x00cb" tabindex="0">\u00cb</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_204" title="0x00cc" tabindex="0">\u00cc</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_205" title="0x00cd" tabindex="0">\u00cd</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_206" title="0x00ce" tabindex="0">\u00ce</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_207" title="0x00cf" tabindex="0">\u00cf</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_208" title="0x00d0" tabindex="0">\u00d0</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_209" title="0x00d1" tabindex="0">\u00d1</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_210" title="0x00d2" tabindex="0">\u00d2</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_211" title="0x00d3" tabindex="0">\u00d3</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_212" title="0x00d4" tabindex="0">\u00d4</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_213" title="0x00d5" tabindex="0">\u00d5</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_214" title="0x00d6" tabindex="0">\u00d6</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_215" title="0x00d7" tabindex="0">\u00d7</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_216" title="0x00d8" tabindex="0">\u00d8</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_217" title="0x00d9" tabindex="0">\u00d9</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_218" title="0x00da" tabindex="0">\u00da</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_219" title="0x00db" tabindex="0">\u00db</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_220" title="0x00dc" tabindex="0">\u00dc</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_221" title="0x00dd" tabindex="0">\u00dd</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_222" title="0x00de" tabindex="0">\u00de</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_223" title="0x00df" tabindex="0">\u00df</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_224" title="0x00e0" tabindex="0">\u00e0</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_225" title="0x00e1" tabindex="0">\u00e1</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_226" title="0x00e2" tabindex="0">\u00e2</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_227" title="0x00e3" tabindex="0">\u00e3</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_228" title="0x00e4" tabindex="0">\u00e4</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_229" title="0x00e5" tabindex="0">\u00e5</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_230" title="0x00e6" tabindex="0">\u00e6</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_231" title="0x00e7" tabindex="0">\u00e7</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_232" title="0x00e8" tabindex="0">\u00e8</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_233" title="0x00e9" tabindex="0">\u00e9</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_234" title="0x00ea" tabindex="0">\u00ea</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_235" title="0x00eb" tabindex="0">\u00eb</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_236" title="0x00ec" tabindex="0">\u00ec</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_237" title="0x00ed" tabindex="0">\u00ed</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_238" title="0x00ee" tabindex="0">\u00ee</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_239" title="0x00ef" tabindex="0">\u00ef</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_240" title="0x00f0" tabindex="0">\u00f0</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_241" title="0x00f1" tabindex="0">\u00f1</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_242" title="0x00f2" tabindex="0">\u00f2</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_243" title="0x00f3" tabindex="0">\u00f3</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_244" title="0x00f4" tabindex="0">\u00f4</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_245" title="0x00f5" tabindex="0">\u00f5</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_246" title="0x00f6" tabindex="0">\u00f6</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_247" title="0x00f7" tabindex="0">\u00f7</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_248" title="0x00f8" tabindex="0">\u00f8</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_249" title="0x00f9" tabindex="0">\u00f9</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_250" title="0x00fa" tabindex="0">\u00fa</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_251" title="0x00fb" tabindex="0">\u00fb</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_252" title="0x00fc" tabindex="0">\u00fc</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_253" title="0x00fd" tabindex="0">\u00fd</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_254" title="0x00fe" tabindex="0">\u00fe</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_255" title="0x00ff" tabindex="0">\u00ff</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t</tbody>'));
b.append("</table>");return b.toString()}W8g(b){b&&-1!==b.indexOf(" ")&&(b="'"+b+"'");return b}yxd(b,h,r,z){h=document.getElementById(h);this.kp.Pya(b,r);r=this.kp.hYa(b,z);h.appendChild(r);this.kp.gM(b)}dispose(){this.LK||(this.kp.RA(nr.uDd),this.LK=!0);super.dispose()}}nr.uDd="DefineNewBulletFontStyleComboBox";nr.T_b="DefineNewBulletTableContainer";Object(n.a)(nr,"DefineNewBulletDialog",Wc.a,[]);class Jv{IIc(){return Fb.a.Prm}nJc(){return Fb.a.XLf}}Object(n.a)(Jv,"ListMarkerGalleryBulletCommands",
null,[538]);class dx{IIc(){return Fb.a.Rrm}nJc(){return Fb.a.V5m}}Object(n.a)(dx,"ListMarkerGalleryMultilevelCommands",null,[538]);class it{IIc(){return Fb.a.Srm}nJc(){return Fb.a.YLf}}Object(n.a)(it,"ListMarkerGalleryNumberingCommands",null,[538]);class Cu{constructor(b,h,r,z,R){this.ixa=this.JHa=null;this.Pxh=ba=>{if(!this.ixa)return 2;if(this.ixa.Ci.Gs().Vj.N1.id.startsWith(nr.T_b)){let ta=null;ba===Fb.a.Syd?ta=this.ixa.NVa:ba===Fb.a.Ryd&&(ta=document.getElementById(nr.uDd));if(!ta)return 2;this.ixa.Ci.Gs().Vj.oy(ta);
ta.focus()}else if(ba===Fb.a.Syd)this.ixa.Ci.Gs().P9b();else if(ba===Fb.a.Ryd)this.ixa.Ci.Gs().N9b();else return 2;return 32};this.lli=(ba,ta)=>{ba=null;ta.view.ze&&(ba=ta.view);return ba&&ba.Cb?32:(ud.b(17887427,315,50,"DefaultActionHandler would have crashed. The context passed in was {0} which does not contain a selection manager",ta.toString()),8)};this.$pm=(ba,ta,Wa)=>1===Wa?32:2===Wa?(ba=this.D3b(ta),ba=Aj.FormattingReader.Pr(ba).cache.WG,this.ixa=new nr(this.bWj,ve.FocusManager.instance(),
t.AFrameworkApplication.ya,ba),32):8;this.eVc=(ba,ta,Wa,ub,Ib)=>{if(1===Wa)return 32;if(2===Wa&&!Ib)return 8;if(this.ixa.Q7h){for(ba=0;ba<Js.a.hzc.length;ba++)So.FontUtils.rej(Js.a.hzc[ba]);this.ixa.Q7h=!1}Cl.a.rMd(ta);Ib.PopulationXML=So.FontUtils.$Kh(Cl.a.m8d,Cl.a.X$e,Fb.a.Qyd);return 32};this.U5m=(ba,ta,Wa,ub,Ib)=>{ba=ta.contextId===kc.a.outlineElement;if(1===Wa||!ba)return ba?32:8;if(2===Wa&&!Ib)return 8;Ib.MenuItems=this.tLj.Qxl();return 32};this.KRk=(ba,ta,Wa,ub,Ib)=>{if(1===Wa)return 32;if(2===
Wa){ba=Object(la.a)(17,Ib);if(!ba||!ba.Cd)return 8;this.ixa.fontName=ba.Cd.fontName;this.ixa.zio();return 32}return 8};this.ga=b;this.Cf=z.resolve("Box4.List.IListReader");this.O4=h;this.bWj=r;switch(this.O4){case 0:b=z.resolve("Box4.ListMarkerGallery.ListMarkerBulletLoader");this.JHa=new Jv;break;case 1:b=z.resolve("Box4.ListMarkerGallery.ListMarkerNumberingLoader");this.JHa=new it;break;case 2:b=z.resolve("Box4.ListMarkerGallery.ListMarkerMultilevelLoader");this.JHa=new dx;break;default:b=z.resolve("Box4.ListMarkerGallery.ListMarkerBulletLoader"),
this.JHa=new Jv}R=this.Cf?this.Cf.Cxl(R):null;b.Tce(R);this.tLj=new Js.a(h,b,R,!!t.AFrameworkApplication.ua&&t.AFrameworkApplication.ua.Sb.HDb)}Vb(){this.ga.pa(this.JHa.nJc(),kc.a.view,vb.App.K3a.qth(11));this.ga.pa(this.JHa.nJc(),kc.a.outlineElement,this.U5m);this.ga.Vc(this.JHa.nJc(),1124);this.O4||(this.ga.gb(Fb.a.Qvf,kc.a.view,this.$pm,1028),this.ga.gb(Fb.a.eVc,kc.a.view,this.eVc,1124),this.ga.gb(Fb.a.Qyd,kc.a.view,this.KRk,1028),this.ga.gb(Fb.a.Syd,Yd.a.frame,this.Pxh,64),this.ga.gb(Fb.a.Ryd,
Yd.a.frame,this.Pxh,64));this.ga.pa(this.JHa.IIc(),kc.a.view,this.lli);this.ga.pa(this.JHa.IIc(),kc.a.outlineElement,this.lli);this.ga.Vc(this.JHa.IIc(),1124)}D3b(b){return this.DEd(b).Qa}DEd(b){let h=null;b=b.view;return b?h=Xd.SelectionEditor.Pj(b.Cb.hb.J(0),!1,!1):h}}Object(n.a)(Cu,"ListMarkerGalleryActor",null,[527]);class dv{constructor(){this.Pe=this.W=null}get name(){return"Box4.ListMarkerGallery"}init(){if(Ya.InteractiveViewManager.instance){var b=Ya.InteractiveViewManager.instance;b.editingView&&
(this.Pe=b.editingView.rd,this.Yln())}}dispose(){}yc(b){this.W=b}Yln(){(new Cu(t.AFrameworkApplication.ya,1,this.W.resolve("Common.IStandaloneRootController").y3,this.W,this.Pe)).Vb();(new Cu(t.AFrameworkApplication.ya,0,this.W.resolve("Common.IStandaloneRootController").y3,this.W,this.Pe)).Vb();(new Cu(t.AFrameworkApplication.ya,2,this.W.resolve("Common.IStandaloneRootController").y3,this.W,this.Pe)).Vb()}static main(){O.a.instance.Oc(new dv)}}Object(n.a)(dv,"Box4ListMarkerGalleryPackage",null,[1,
2]);var Kv=d(342),Lo=d(400),Fy=d(367),or=d(99);const ex=b=>{b.element.style.top=""};var Du=d(1018);class Dt{constructor(b,h,r){this.lN=!1;this.n6a=0;this.Zba=this.oUg=null;this.Tl=b;this.gXj=h;this.ks=r;this.AY=b.ownerDocument.createElement("div");this.htmlElement.className="WACBusinessBar";(this.ew=!!t.AFrameworkApplication.ua&&t.AFrameworkApplication.ua.Sb.A6)&&!this.ks.O4e&&Sys.UI.DomElement.addCssClass(this.htmlElement,"regionComposer");this.htmlElement.id="WACBusinessBar";X.a.gj&&Sys.UI.DomElement.addCssClass(this.htmlElement,
"FireFox")}get htmlElement(){return this.AY}get visible(){return this.lN}set_visible(b){if(this.lN!==b)return(this.lN=b)?this.kSe():this.PDc(),b}dispose(){this.visible&&this.PDc();$e.a.eZ(this.htmlElement);this.Tl=this.AY=null}v4i(b,h){const r=b.htmlElement||b.createElement();h===this.htmlElement.childNodes.length?this.htmlElement.appendChild(r):this.htmlElement.insertBefore(r,this.htmlElement.childNodes[h]);b.TRi();this.n6a+=b.htmlElement.clientHeight;var z=this.htmlElement.childNodes,R=b.fbh,ba=
Object(u.a)(this,this.NOm,"onAfterShowEntry");or.WacAirSpace.rU(r,"Shared_BasicClass");var ta=new Fy.a(r);ta.qra(0,1);const Wa=new Lo.a(r);Wa.Yya(r.clientTop-30,r.clientTop);R?(or.WacAirSpace.Chb(ta,null,null),or.WacAirSpace.Chb(Wa,null,ba)):(or.WacAirSpace.animate(ta,null,null),or.WacAirSpace.animate(Wa,null,ba));for(h+=1;h<z.length;h++)ba=z[h],or.WacAirSpace.rU(ba,"Shared_BasicClass"),ta=new Lo.a(ba),ta.Yya(ba.clientTop-r.clientHeight,ba.clientTop),R?or.WacAirSpace.Chb(ta,null,null):or.WacAirSpace.animate(ta,
null,null);b.ZWn();this.set_visible(!0)}$4h(b){const h=b.htmlElement;if($e.a.dDb(h)){this.n6a-=b.htmlElement.clientHeight;var r=h.parentNode.children;b=b.fbh;var z=Object(u.a)(this,this.EOm,"onAfterHideEntry");or.WacAirSpace.rU(h,"Shared_BasicClass");var R=new Kv.a(h);R.qra(1,0);b?or.WacAirSpace.Chb(R,null,z):or.WacAirSpace.animate(R,null,z);z=!1;for(R=0;R<r.length;R++){if(z){const ba=r[R];or.WacAirSpace.rU(ba,"Shared_BasicClass");const ta=new Lo.a(ba);ta.Yya(ba.clientTop,-h.clientHeight);b?or.WacAirSpace.Chb(ta,
null,ex):or.WacAirSpace.animate(ta,null,ex)}z||r[R]!==h||(z=!0)}}}NOm(b){b.element.style.top="";t.AFrameworkApplication.ua.RSc()}EOm(b){b.element.parentNode.removeChild(b.element);this.htmlElement.hasChildNodes()||this.set_visible(!1);t.AFrameworkApplication.ua.RSc()}kSe(){""===this.Tl.style.top.trim()&&(this.Tl.style.top=this.Tl.offsetTop+"px");this.htmlElement.style.left=this.Tl.style.left;this.htmlElement.style.top=this.Tl.style.top;this.htmlElement.style.height="auto";this.htmlElement.style.visibility=
"visible";var b=Sys.UI.DomElement.getBounds(this.htmlElement);this.oUg=this.Tl.style.top;this.n6a=b.height;this.dde();t.AFrameworkApplication.ua.o1(Object(u.a)(this,this.onResize,"onResize"));Bf.a.addHandler(this.htmlElement,jb.a.tdc,Bf.a.Hab);this.Zba=Object(u.a)(this,this.Lza,"contextMenuHandler");t.AFrameworkApplication.ua.Yva.mb(this.htmlElement,this.Zba,null);if(ve.FocusManager.fJ()){var h=ve.FocusManager.instance();b=h.re(Du.a.zJa);b.parent=ke.AFrame.Np;const r=new xe.DOMFocusListing(()=>this.htmlElement);
r.Go(1);r.Go(2);r.Go(8);h.Pja(()=>this.htmlElement,b,r);h=h.getRegion(Du.a.zJa);h.JOa();h.mX=!0;h.oWa=!0;const z=t.AFrameworkApplication.ua.jv;b.Vub(()=>{z.Mw(Du.a.zJa)});z.qS(Du.a.zJa);(r.lea||t.AFrameworkApplication.K.$("ReactBusinessBarIsEnabled"))&&z.DG(Du.a.zJa)}}PDc(){this.$3i()&&(this.Tl.style.top=this.oUg);this.htmlElement.style.visibility="hidden";t.AFrameworkApplication.ua&&(ve.FocusManager.fJ()&&ve.FocusManager.instance().tIb(Du.a.zJa),this.Zba&&(t.AFrameworkApplication.ua.Yva.sc(this.htmlElement,
this.Zba),this.Zba=null));Bf.a.removeHandler(this.htmlElement,jb.a.tdc,Bf.a.Hab)}dde(){if(this.$3i()&&this.visible){var b=this.Tl,h=this.n6a+this.gXj;const r=$e.a.eM(b.style.top);or.WacAirSpace.rU(b,"Shared_BasicClass");b=new Lo.a(b);b.Yya(r,h);or.WacAirSpace.animate(b,null,null)}}$3i(){return!this.ew&&!this.ks.O4e}onResize(){const b=this.ks.entries.length,h=Sys.UI.DomElement.getBounds(this.htmlElement).height;let r;for(let z=0;z<b;++z)r=this.ks.entries[z],r.htmlElement&&r.TRi();this.n6a=Sys.UI.DomElement.getBounds(this.htmlElement).height;
h!==this.n6a&&this.dde()}Lza(){return!0}}Object(n.a)(Dt,"BusinessBarDom",null,[1082,9]);var jt;(function(b){b[b.none=0]="none";b[b.corruptPage=1]="corruptPage";b[b.currentPageStatus=2]="currentPageStatus";b[b.documentMarkedAsFinal=3]="documentMarkedAsFinal";b[b.documentSigned=4]="documentSigned";b[b.fileAccess=5]="fileAccess";b[b.kickoutWithDataLoss=6]="kickoutWithDataLoss";b[b.lostSession=7]="lostSession";b[b.malformedHyperlinkUris=8]="malformedHyperlinkUris";b[b.odt=9]="odt";b[b.readonlyRecommended=
10]="readonlyRecommended";b[b.saveReplaySuccess=11]="saveReplaySuccess";b[b.saveReplayFailed=12]="saveReplayFailed";b[b.unsupportedObjects=13]="unsupportedObjects";b[b.word11Compat=14]="word11Compat";b[b.unsupportedBrowser=15]="unsupportedBrowser";b[b.applicationNotification=16]="applicationNotification";b[b.skypeDocChatFailed=17]="skypeDocChatFailed";b[b.showDialogInNewWindowInfo=18]="showDialogInNewWindowInfo";b[b.sessionExpired=19]="sessionExpired";b[b.irmPolicyDescription=20]="irmPolicyDescription";
b[b.policyWarningMessage=21]="policyWarningMessage";b[b.thirdPartyAddinDisabled=22]="thirdPartyAddinDisabled";b[b.gdprPrivacyNotice=23]="gdprPrivacyNotice";b[b.datacenterDecommissionWarning=24]="datacenterDecommissionWarning";b[b.graphMergePrompt=25]="graphMergePrompt";b[b.readOnlyDocument=26]="readOnlyDocument";b[b.dictationSilence=27]="dictationSilence";b[b.autoSensitivityLabel=28]="autoSensitivityLabel";b[b.recommendedSensitivityLabel=29]="recommendedSensitivityLabel";b[b.dictationDebugInfo=30]=
"dictationDebugInfo";b[b.oneNoteCovid19Message=31]="oneNoteCovid19Message";b[b.citationStylePrompt=32]="citationStylePrompt";b[b.oneNoteViewModeMessage=33]="oneNoteViewModeMessage";b[b.oneNotePrintImagesDownloading=34]="oneNotePrintImagesDownloading";b[b.oneNotePagePrintReady=35]="oneNotePagePrintReady";b[b.irmPolicyCausedFeatureDisabled=36]="irmPolicyCausedFeatureDisabled";b[b.mandatoryLabel=37]="mandatoryLabel";b[b.policyTip=38]="policyTip";b[b.minorVersionLimit=39]="minorVersionLimit";b[b.testEntry1=
40]="testEntry1";b[b.testEntry2=41]="testEntry2";b[b.testEntry3=42]="testEntry3";b[b.testEntry4=43]="testEntry4";b[b.testEntry5=44]="testEntry5";b[b.testEntry6=45]="testEntry6";b[b.testEntry7=46]="testEntry7"})(jt||(jt={}));Object(n.b)("BusinessBarId",jt);class Ks{constructor(b,h=0,r=null,z=null){this.aMg=this.OBg=!1;this.GTb=null;this.bA=[];this.eRa=z||new Dt(b,h,this);this.P3l(r)}P3l(b){if(b){this.GTb={};b=b.ranking;for(let h=0;h<b.length;h++)this.GTb[jt[b[h]]]=h}}dispose(){this.eRa.dispose();ec.a.GVf(this.bA);
this.bA=null}get htmlElement(){return this.eRa.htmlElement}get visible(){return this.eRa.visible}get O4e(){return this.OBg}set O4e(b){this.OBg=b}get Zsf(){return this.aMg}set Zsf(b){this.aMg=b}get entries(){return this.bA}set entries(b){this.bA=b}bfa(b){for(let h=0;h<this.bA.length;h++)if(this.bA[h].id===b)return!0;return!1}mA(b,h=!1,r=null,z=null,R=null){b.tP=this;let ba=this.Dvl(b.id);h&&!this.GTb&&(ba=0);ba<Ks.qFb&&(this.eRa.v4i(b,ba),this.bA.length>=Ks.qFb&&this.eRa.$4h(this.bA[Ks.qFb-1]),this.eRa.dde());
Array.insert(this.bA,ba,b);v.ULS.sendTraceTag(38111390,207,50,"Add BusinessBar Entry. Id: {0}, ContainerID: {1}.",jt[b.id],void 0===b.pWa||null===b.pWa?"":b.pWa);b.errorCode&&t.AFrameworkApplication.SQ(b.errorCode,r,z,R)}removeEntry(b){const h=Array.indexOf(this.bA,b);-1!==h&&h<Ks.qFb&&(this.bA.length>Ks.qFb&&this.eRa.v4i(this.bA[Ks.qFb],Ks.qFb),this.eRa.$4h(b),this.eRa.dde());Array.remove(this.bA,b);b.tP=null;b.dispose()}Dvl(b){if(!this.GTb||0===b)return this.bA.length;b=this.GTb[jt[b]];if(void 0===
b||null===b)return this.bA.length;for(let h=0;h<this.bA.length;h++)if(b<this.GTb[jt[this.bA[h].id]])return h;return this.bA.length}}Ks.qFb=2;Object(n.a)(Ks,"BusinessBar",null,[1055,9,1056]);class Et{create(b,h,r){return new sc.a(b,h,r)}}Object(n.a)(Et,"Factory",null,[1081]);class qw{static DCk(b,h){b.register(Ks,"CommonUI.BusinessBar").as("CommonUI.IBusinessBar").singleInstance().Yd(()=>new Ks(h.value,0,b.Pa("CommonUI.IBusinessBarRankProvider")));b.register(Et,"CommonUI.BusinessBarEntry.Factory").as("CommonUI.IBusinessBarEntryFactory").singleInstance()}}
Object(n.a)(qw,"CommonUIComponentConfiguration",null,[]);var Ux=d(972);class kt extends Ux.a{constructor(){super()}static get instance(){return kt._instance||kt.Bnf()}static Bnf(){kt._instance=new kt;return kt._instance}}kt._instance=null;Object(n.a)(kt,"ReactRootManager",Ux.a,[509,510]);class fx extends nh.a{constructor(){super()}get ControlType(){return 3}}Object(n.a)(fx,"CompoundButtonProps",nh.a,[]);class Vx{constructor(b,h,r,z,R,ba,ta){this.tV=h;this.tuc=b;this.nKg=h.Nbm;this.ARb=h.SOc;this.uue=
ba;this.rcd=z;this.scd=R;this.lcd=r;this.vx=ta;this.z7a=new Hl.a;this.z7a.Z(1,"SpellingIssue_16x16x32");this.z7a.Z(2,"GrammarIssue_16x16x32");this.z7a.Z(3,"WritingIssue_16x16x32");this.z7a.Z(4,null);this.z7a.Z(0,null)}create(b,h,r){h=Object(la.a)(pi.a,h);if(!h)return v.ULS.sendTraceTag(25007833,375,15,"Expect EditorServiceErrorDetails."),"";const z=new Sys.StringBuilder;b=this.jTh(b);this.WCc(z,h,r,b);this.d0e(z,h);this.EMk(z,h,b);return z.toString()}rxb(b,h,r){const z=Object(la.a)(pi.a,h);if(!z)return v.ULS.sendTraceTag(39188232,
375,15,"Expect EditorServiceErrorDetails."),[];h=[];b=this.jTh(b);this.Q0e(h,z,r,b);this.e0e(h,z);this.FMk(h,z,b);for(r=0;r<h.length;r++)h[r].Id=`${es.qCh}_${r}`;return h}WCc(b,h,r,z=null){h.errorType?1===h.errorType&&(this.c1b(h)||b.append(this.sUe(h,r,z))):b.append(this.tuc.build())}Q0e(b,h,r,z=null){h.errorType?1===h.errorType&&(this.c1b(h)||b.push(this.flk(h,r,z))):b.push(this.tuc.Ghh())}d0e(b,h){const r=new Sys.StringBuilder;this.l5i(h)?r.append(Kf.a("btnIgnoreAllSpellingError",(2===h.errorType?
Fb.a.gFa:Fb.a.Kla).toString(),Box4Intl.Box4Strings.l_IgnoreAllSpellingErrors,null)):this.c1b(h)||r.append(Kf.a("btnIgrnoreSpellingError",this.lSh(h.errorType).toString(),Box4Intl.Box4Strings.l_IgnoreOnceSpellingError,null));this.q5i(h)&&(this.tV.Rbi&&r.append(Kf.a("btnDoNotCheckForThisIssue",Fb.a.oyb.toString(),Box4Intl.Box4Strings.l_DoNotCheckForThisIssue,null)),r.append(Kf.a("btnGrammarOptions",Fb.a.yib.toString(),B.a.If(Box4Intl.Box4Strings.l_GrammarOptions),null)));r.isEmpty()||(b.append('<MenuSection Id="msIgnoreSpellingError" DisplayMode="Menu16"><Controls>'),
b.append(r.toString()),b.append("</Controls></MenuSection>"))}e0e(b,h){const r=Object.assign(new hi.a,{ControlList:[]});if(this.l5i(h)){var z=W.GA()?Object.assign(new nh.a,{ExternalId:"btnIgnoreAllSpellingErrorForAL",Command:Fb.a.Kla,LabelText:Box4Intl.Box4Strings.l_IgnoreAllSpellingErrors}):Object.assign(new nh.a,{ExternalId:2===h.errorType?"UnknownAllSpellingError":"IgnoreAllSpellingError"});r.ControlList.push(z)}else this.c1b(h)||(z=Object.assign(new nh.a,{ExternalId:"btnIgrnoreSpellingError",
Command:this.lSh(h.errorType).toString(),LabelText:Box4Intl.Box4Strings.l_IgnoreOnceSpellingError}),r.ControlList.push(z));this.q5i(h)&&(this.tV.Rbi&&(h=Object.assign(new nh.a,{ExternalId:"DoNotCheckForThisIssue"}),r.ControlList.push(h)),h=Object.assign(new nh.a,{ExternalId:"GrammerSettingsContext"}),r.ControlList.push(h));b.push(r)}jTh(b){if(!this.vx)return null;b=this.vx.language(this.vx.Pr(b.Qa));return Sj.a.pg(b)?Sj.a.pg(b).name:null}lSh(b){return 2===b?Fb.a.gFa:this.tV.vem?Fb.a.o_l:Fb.a.ota}EMk(b,
h,r=null){if(this.h_f(h)){var z=B.a.If(h.Us.CategoryTitle);z=Kf.o(es.tbc,ab.a.Aja,this.z7a.J(h.proofingType),""!==z?z:Box4Intl.Box4Strings.l_AdvancedProofingIssueContentTitle,[b.toString()],this.rcd,this.scd);z=Kf.d("cgProofingOuter",[z]);b.clear();b.append(Kf.h("msProofingOuter",z,"Menu16",void 0,void 0,r,"ariaLabelledById"));v.ULS.sendTraceTag(36508632,375,50,"Show 2-level context menu of type {0}, critique id {1}",h.proofingType,h.typeId)}}FMk(b,h,r=null){if(this.h_f(h)){var z=B.a.If(h.Us.CategoryTitle);
r=Object.assign(new mi.a,{ExternalId:String.format("{0}_{1}",es.tbc,h.proofingType),Command:ab.a.Aja.toString(),Image16by16Class:this.z7a.J(h.proofingType),LabelText:""!==z?z:Box4Intl.Box4Strings.l_AdvancedProofingIssueContentTitle,Lang:r,Menu:Object.assign(new ni.a,{ExternalId:"ProofingSubMenu",UpdateDynamically:!0,ShouldAutoOpen:!0,AriaLabel:this.Cil(h),AriaRoleDescription:Box4Intl.Box4Strings.l_SuggestionsMenuAriaRoleDescription,MenuSectionList:[]})});r.Menu.MenuSectionList.push(...b);Array.clear(b);
z=Object.assign(new hi.a,{ControlList:[]});z.ControlList.push(r);b.push(z);v.ULS.sendTraceTag(39188234,375,50,"Show 2-level context menu of type {0}, critique id {1}",h.proofingType,h.typeId)}}sUe(b,h,r=null){const z=this.Tql(b);var R=[];let ba=!1;var ta=b.Us.Suggestions;if(ta)if(ta=ta.slice(0,Math.min(3,ta.length)),this.nKg&&(ba=!Kh.a.any(ta,Wa=>!Wa||!Wa.Description)),1!==ta.length||ta[0].Action){let Wa=0,ub=null;ba&&(ub="font-weight: bold;");for(const Ib of ta){if(!Ib)continue;ta=null;let $b="";
const fc=B.a.If(Ib.Text);ba&&(ta=this.YMh(Ib.Description),$b=this.XMh(Ib.Description));R.push(Kf.a("btnCorrectWord"+Wa,h[Wa].toString(),fc,null,null,null,null,null,ub,null,ta,null,void 0,void 0,String.format(Box4Intl.Box4Strings.l_SuggestionsAriaLabelFormatForSuggestionDescriptions,z,fc),"ariaLabelledById",String.format(Box4Intl.Box4Strings.l_SuggestionsNotInDictionaryAriaLabelFormat,b.token,this.Nrh(b.token)),"ariaDescribedById",$b));Wa++}}else h=B.a.If(ta[0].Text),R.push(Kf.a("btnCorrectWord0",
Fb.a.gFa.toString(),h,null,null,null,null,null,null,null,void 0,void 0,void 0,void 0,String.format(Box4Intl.Box4Strings.l_SuggestionsAriaLabelFormat,z,h)));h="Menu16";0<R.length?ba&&(h="Menu16DescriptionEnabled"):R=[Kf.a("btnNoSuggestions",Fb.a.gFa.toString(),Box4Intl.Box4Strings.l_NoSuggestions,null)];return Kf.h("msUnknownWord",Kf.d(null,R),h,z,this.Syl(b),r,"ariaLabelledById")}flk(b,h,r=null){var z=1!==b.proofingType&&0!==b.proofingType?b.Us.ExplanationTitle:"";z=Object.assign(new hi.a,{Title:z,
Lang:r,ControlList:[]});let R=!1;var ba=b.Us.Suggestions;if(ba)if(ba=ba.slice(0,Math.min(3,ba.length)),this.nKg&&(R=!Kh.a.any(ba,ta=>!ta||!ta.Description)),1!==ba.length||ba[0].Action){let ta=0;for(const Wa of ba){if(!Wa)continue;ba=null;let ub="";R&&(ba=this.YMh(Wa.Description),ub=this.XMh(Wa.Description));if(ta>=h.length)break;ba?(ba=Object.assign(new fx,{ExternalId:String.format("{0}{1}_{2}_compoundButton","btnCorrectWord",ta,b.proofingType),Command:h[ta].toString(),LabelText:Wa.Text,Description:ba,
Lang:r,AriaDescription:ub}),z.ControlList.push(ba)):(ba=Object.assign(new nh.a,{ExternalId:String.format("{0}{1}_{2}_button","btnCorrectWord",ta,b.proofingType),Command:h[ta].toString(),LabelText:Wa.Text,Lang:r,RoleInMenu:"menuitem"}),z.ControlList.push(ba));ta++}}else b=ba[0],b=Object.assign(new nh.a,{ExternalId:"NoSuggestion",Command:Fb.a.gFa.toString(),LabelText:b.Text}),z.ControlList.push(b);0>=z.ControlList.length&&z.ControlList.push(Object.assign(new nh.a,{ExternalId:"btnNoSuggestions",Command:Fb.a.gFa.toString(),
LabelText:Box4Intl.Box4Strings.l_NoSuggestions}));return z}Tql(b){return B.a.If(0!==b.proofingType?b.Us.ExplanationTitle:"")}Syl(b){return this.h_f(b)?null:this.z7a.J(b.proofingType)}h_f(b){return this.ARb&&2!==b.errorType&&(1!==b.errorType||!this.c1b(b))}l5i(b){return this.uue&&!!b.errorType&&1===b.proofingType&&!this.c1b(b)}Cil(b){return 1===b.proofingType?String.format(Box4Intl.Box4Strings.l_SuggestionsNotInDictionaryAriaLabelFormat,b.token,this.Nrh(b.token)):""}q5i(b){return this.tV.RPd&&this.ARb&&
1===b.errorType&&(2===b.proofingType||3===b.proofingType)}c1b(b){return!!b.errorType&&!!this.lcd&&this.lcd.contains(b.token,b.lcid)}YMh(b){return""===b?String.format(Box4Intl.Box4Strings.l_NoReferenceInformation):b}XMh(b){return""!==b?String.format(Box4Intl.Box4Strings.l_SuggestionDescriptionAriaDescribedByFormat,b):""}Nrh(b){let h="";if(b){let r;for(r=0;r<b.length-1;r++)h=h+b.charAt(r)+",";h+=b.charAt(r)}return h}}Object(n.a)(Vx,"EditorServiceProofingContextMenuCreator",null,[]);class Wx{get ranking(){return[24,
23,7,6,19,1,5,9,22,2,4,3,10,8,14,13,11,12,15,16,17,18,20,21,36,25,26,27,28,29,30,31,32,33,34,35,37,40,41,42,43,44,45,46]}}Object(n.a)(Wx,"BusinessBarRankProvider",null,[525]);class gx{constructor(){this.W=null}get name(){return"Wonca.UI"}yc(b){this.W=b;b.ha("CommonUI.IBusinessBarRankProvider",()=>new Wx).singleInstance();qw.DCk(b,new De.a(()=>vb.App.xa.Xda));b.ha("Box4.UI.EditorServiceProofingContextMenuCreator",()=>new Vx(b.resolve("Box4.UI.IProofingRepeatedWordSectionBuilder"),b.resolve("Box4.Proofing.IProofingFeatureConfiguration"),
b.resolve("Box4.Proofing.IIgnoreAllKeywords"),t.AFrameworkApplication.hQ,t.AFrameworkApplication.pr,t.AFrameworkApplication.K.$("WordEditorProofingIgnoreAll"),b.resolve("Box4.IFormattingReader"))).singleInstance();b.ha("CommandUI.ReactRootManager",()=>kt.instance).as("Common.IReactRootManager").singleInstance()}init(){this.W.resolve("Wonca.IRibbonUserFactory");this.W.resolve("CommonUI.IBusinessBar")}dispose(){}static main(){O.a.instance.Oc(new gx)}}Object(n.a)(gx,"WoncaUIPackage",null,[1,2]);class Xx{constructor(b){this.MM=
this.wsc=null;this.nl=b}get key(){return"BOOKMARK"}get mw(){return WordEditorIntl.WordEditorStrings.L_Bookmark}get ska(){return this.MM}reset(b){this.MM=b.node}ZEa(b){let h=null;t.AFrameworkApplication.Hf("bookmarks-core-ex;bookmarks-core-ex-cf");if(t.AFrameworkApplication.K&&t.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.BookmarksIsEnabled",!1)){if(this.wsc&&this.nl.Mpf(b,this.ska,this.wsc))return h=Object.assign(new Mm.a,{QF:this.key,contentObject:this.wsc}),{returnValue:!0,
XE:h};this.wsc=null;if(!this.ska.hasBookmark)return{returnValue:!1,XE:h};const r=new Nd.GraphIterator;r.set(this.ska.Di());this.nl.R9b(r);if(this.nl.xai(r)){let z=r.Xd();for(;z;){if(this.nl.Mpf(b,this.ska,z))return this.wsc=z,h=Object.assign(new Mm.a,{QF:this.key,contentObject:z,description:this.zdb()}),{returnValue:!0,XE:h};z=r.xj()}}}return{returnValue:!1,XE:h}}zdb(){return null}}Object(n.a)(Xx,"BookmarkDetailsProvider",null,[268,269]);class Yx{constructor(b,h,r,z,R=null){this.JJg=this.Bh=!1;this.pgd=
this.mTb=null;this.gwi=(ba,ta)=>{ba=ta.node;1074135152!==ba.Qc?v.ULS.sendTraceTag(24155018,324,10,"node.RuntimeClassId = {0}",ba.Qc):(v.ULS.sendTraceTag(24155019,324,50,"OnBookmarkContainerNodeLoaded: Refreshing out of date bookmarks"),this.PAd(!0))};this.jB=r;this.Ih=z;this.yx=h;this.bwg=b;this.cB=R}get Sy(){return this.yx.value}initialize(){this.iRf();this.Bh=!0}PAd(b=!1){if(!this.Bh)return v.ULS.sendTraceTag(24262273,324,10,"BookmarkGraphManager not initialized"),!1;if(!b&&this.JJg)return!0;let h=
!1;this.Ih.Pd(()=>{this.mTb={};this.pgd={};if(this.Sy){const r=new Nd.GraphIterator;r.set(this.Sy);if(this.QJm(r)){if(r.Rb(1)){do this.B3j(r.currentNode);while(r.vf(1))}h=this.JJg=!0}}},"BGM:EBGL");return h}OMh(b){var h,r,z,R;if(!this.PAd())return null;const ba=new Ua.a;if(b.toString()in this.mTb){const ta=this.mTb[b.toString()];for(let Wa of ta)this.cB.Mja.has(null===(h=Wa.id)||void 0===h?void 0:h.toString())&&this.cB.Mja.get(null===(r=Wa.id)||void 0===r?void 0:r.toString()).equals(b)&&this.cB.IVa.has(null===
(z=Wa.id)||void 0===z?void 0:z.toString())&&this.cB.IVa.get(null===(R=Wa.id)||void 0===R?void 0:R.toString()).equals(b)?ba.add(Wa):v.ULS.sendTraceTag(24155015,324,100,"GetBookmarksInParagraph: bookmarkNode does not have same paragraph for start and end value (shouldn't happen for TOC)")}return ba}pea(b){return this.PAd()?b in this.pgd?this.pgd[b]:null:null}dispose(){this.Bh?this.Xeo():v.ULS.sendTraceTag(24262275,324,50,"BookmarkGraphManager not initialized")}QJm(b){if(this.jB.zQ(b))return(b=b.Rb(30))||
v.ULS.sendTraceTag(24691921,324,10,"Graph does not contain BookmarkContainer"),b;v.ULS.sendTraceTag(24691922,324,15,"Unable to move to Page Manifest");return null}iRf(){v.ULS.sendTraceTag(24691923,324,50,"Registering OnBookmarkContainerNodeLoaded");this.bwg.F$g(this.gwi)}Xeo(){v.ULS.sendTraceTag(24691924,324,50,"Unregistering OnBookmarkContainerNodeLoaded");this.bwg.gPi(this.gwi)}B3j(b){var h,r,z,R;b?(this.G8g(null!==(r=this.cB.Mja.get(null===(h=b.id)||void 0===h?void 0:h.toString()))&&void 0!==r?
r:E.a.nil,b),this.G8g(null!==(R=this.cB.IVa.get(null===(z=b.id)||void 0===z?void 0:z.toString()))&&void 0!==R?R:E.a.nil,b),(h=b.properties.ia(yc.a.Ts,null))&&(this.pgd[h]=b)):v.ULS.sendTraceTag(24155022,324,50,"Node is null")}G8g(b,h){b===E.a.nil?v.ULS.sendTraceTag(24155023,324,50,"paraNodeId is null"):(b=b.toString(),b in this.mTb||(this.mTb[b]=new Ua.a),b=this.mTb[b],b.contains(h)||b.add(h))}}Object(n.a)(Yx,"BookmarkGraphManager",null,[524]);class jq{constructor(b,h){this.z9=b;this.uxj=h}get cIb(){return this.uxj}}
Object(n.a)(jq,"FoundBookmarkRangeObject",null,[533]);class Ls{constructor(b,h=null){this.cRa=b;this.Uwd={};this.I_b={};this.cB=h}Z0a(b,h){if(b=this.cRa.OMh(h.node.id)){v.ULS.sendTraceTag(24462027,3029,50,String.format("Removing {0} bookmarks from paraId {1}",b.count,h.node.id));for(let r of b)r.id.toString()in this.Uwd&&(h=this.Uwd[r.id.toString()],h.id.toString()in this.I_b?b=this.I_b[h.id.toString()]:(b=new Ua.a,this.I_b[h.id.toString()]=b),b.add(r),delete this.Uwd[r.id.toString()])}else v.ULS.sendTraceTag(24691925,
3029,50,"Failed to get bookmarks on paragraph deletion")}LTc(b,h){if(b=this.cRa.OMh(h.original.id))for(let r of b)this.Uwd[r.id.toString()]=h.clone;else v.ULS.sendTraceTag(24691926,3029,50,"Failed to get bookmarks on paragraph copy")}NTc(b,h){var r,z;if(h.original.id.toString()in this.I_b){b=this.I_b[h.original.id.toString()];for(let R of b)this.cB.Mja.set(null===(r=R.id)||void 0===r?void 0:r.toString(),h.clone.id),this.cB.IVa.set(null===(z=R.id)||void 0===z?void 0:z.toString(),h.clone.id);delete this.I_b[h.original.id.toString()];
v.ULS.sendTraceTag(24691927,3029,50,"OnParagraphPaste: Refreshing out of date bookmarks");this.cRa.PAd(!0)}}Tyi(){v.ULS.sendTraceTag(36820239,3029,10,"New Interface Not Implemented!")}sqd(){v.ULS.sendTraceTag(36471763,3029,10,"New Interface Not Implemented!");return!1}HWb(){v.ULS.sendTraceTag(591730835,3029,10,"New Interface Not Implemented!");return!1}yWd(){v.ULS.sendTraceTag(36209185,3029,10,"New Interface Not Implemented!")}pea(){v.ULS.sendTraceTag(34936480,3029,10,"New interface not implemented");
return null}pdb(){v.ULS.sendTraceTag(34936481,3029,10,"New interface not implemented");return null}cla(){v.ULS.sendTraceTag(35992273,3029,10,"New Interface Not Implemented!");return new jq(null,2)}LHf(){v.ULS.sendTraceTag(35992274,3029,10,"New interface not implemented")}dcc(){v.ULS.sendTraceTag(573673489,3029,10,"New interface not implemented")}eHc(){v.ULS.sendTraceTag(559228954,3029,10,"getAllBookmarks not implemented");return null}Gqh(){v.ULS.sendTraceTag(524321507,3029,10,"containsBookmark not implemented");
return!1}PRf(){v.ULS.sendTraceTag(559228956,3029,10,"removeBookmark not implemented");return!1}xgf(){v.ULS.sendTraceTag(553951760,3029,10,"getParaNodesFromBookmarkName not implemented");return null}NMh(){v.ULS.sendTraceTag(544814809,3029,10,"getBookmarkNameForHeading not implemented");return null}xjf(){v.ULS.sendTraceTag(544777299,3029,10,"goToBookmark not implemented")}YHc(){v.ULS.sendTraceTag(545118154,3029,10,"getEnclosingBookmark not implemented");return null}R9b(){v.ULS.sendTraceTag(540382879,
3029,10,"moveToBookmarkContainer not implemented");return null}xai(){v.ULS.sendTraceTag(540382880,3029,10,"isBookmarkContainer not implemented");return null}Xfj(){v.ULS.sendTraceTag(525133728,3029,10,"updateBookmarkNameOnly not implemented");return!1}XZd(){v.ULS.sendTraceTag(523106501,3029,10,"paragraphContainsAnyBookmarks not implemented");return!1}Hbf(){v.ULS.sendTraceTag(523106502,3029,10,"getBookmarksFromParagraph not implemented");return null}Fbf(){v.ULS.sendTraceTag(522735619,3029,10,"getBookmarkRangeOnly not implemented");
return null}ygf(){v.ULS.sendTraceTag(522735620,3029,10,"getParagraphContainingGivenBookmarkAnchors not implemented");return null}Mpf(){v.ULS.sendTraceTag(521462493,3029,10,"isCpInsideBookmark not implemented");return!1}}Object(n.a)(Ls,"BookmarkManager",null,[522]);var rw=d(791),kB=d(1091);class eu{create(){return new kB.a}}Object(n.a)(eu,"BookmarkContainerNodeFactory",null,[256]);class oA{constructor(b,h,r,z=null){this.Tyi=(R,ba)=>{this.nl.LHf(ba)};this.LTc=(R,ba)=>{var ta=this.pHh(ba.clone);R=ba.original.Lc;
const Wa=new Lc.a;for(let ub of ta)ta=ub.qn.toString(),Wa.xb(ta)||(Wa.add(ta,!0),(ta=R.Eb(ub.qn))&&!ta.anchor&&(ta=this.nl.pdb(ub.qn)),ta?ta.anchor?this.tGk(ta,ba.clone):v.ULS.sendTraceTag(573673488,324,15,String.format("BookmarkNode ObjId:{0} Id:{1} as no anchor",ta.id,ta.ia(yc.a.Xvb,-1))):v.ULS.sendTraceTag(573673487,324,15,"BookmarkNode null"))};this.NTc=(R,ba)=>{R=ba.clone;ba=this.pHh(R);this.nl.dcc(R,ba)};this.Kw=h;this.nl=r;this.jxj=z||new eu}init(){rw.a.Xjn(Object(u.a)(this.nl,this.nl.yWd,
"onAfterFullBookmarkRangeDeleted"));this.Kw.tPe(this.Tyi);dt.a.jrd(this.LTc);dt.a.pyc(this.NTc)}pHh(b){const h=new Ua.a;for(let r=0;r<b.qa.length;r++){const z=b.qa.J(r);if(z.Lh)for(let R=0;R<z.Lh.length;R++)h.add(z.Lh.J(R))}return h}tGk(b,h){var r=h.Di().zd;r=Pi.a(b,r,!0);h=Nd.GraphIterator.$a(h);this.g2k(h);h.Rb(30);h.j1(r,1,b.id);h.Ei(r)}g2k(b){if(b.Bb(25)&&b.kd(25)&&!b.aq(30)){const h=this.jxj.create(1074135152);b.Sf(h,30)}}}Object(n.a)(oA,"BookmarksEventHandler",null,[]);var yr=d(291),Eu=d(287),
pA=d(487),lB=d(1152),wk=d(145),sw=d(1022);class tw{create(){return new sw.a}}Object(n.a)(tw,"BookmarkNodeFactory",null,[256]);class ev{constructor(b,h,r,z,R,ba,ta,Wa=null,ub,Ib=null){this.L0="_";this.ewg=40;this.YVj=" ";this.yx=b;this.jB=h;this.Vd=r;this.Gxe=z;this.Hc=R;this.fb=ba;this.ib=ta;this.txj=Wa||new tw;this.cB=Ib}fJc(b,h){return b?this.cB.Mja.get(null===h||void 0===h?void 0:h.toString()):this.cB.IVa.get(null===h||void 0===h?void 0:h.toString())}get Sy(){return this.yx.value}get BFa(){return this.Gxe.value}sqd(b,
h){if(!h||!h.Qa||!h.Tc)return v.ULS.sendTraceTag(36471765,3029,15,"There is no selection"),!1;const r=h.Qa.node,z=h.Tc.node,R=yr.a.Adb(h,!0);h=yr.a.Adb(h,!1);return this.HWb(b,R,h,r,z)}HWb(b,h,r,z,R,ba=!1){v.ULS.sendTraceTag(545642374,3029,50,String.format("removeExisting value is: {0}",ba));const ta=this.pea(b);if(ta)if(ba)this.dNi(ta);else return v.ULS.sendTraceTag(36471764,3029,50,"Unable to add bookmark because name already exists"),!1;if(!z||!R)return v.ULS.sendTraceTag(591730833,3029,50,"Missing Paragraph info while adding bookmark"),
!1;ba=this.Hc.Rc(15);ba.Db(this.BFa);b=this.f1j(b);if(!b)return!1;this.b1j(z,h,b,R,r);ba.dispose();return!0}pea(b){v.ULS.shipAssertTag(34936482,3029,!!b);return this.sHh(h=>b===h.properties.ia(yc.a.Ts,null))}pdb(b){return b&&b!==E.a.nil?this.sHh(h=>b.equals(h.id)):(v.ULS.sendTraceTag(543424735,3029,10,"Unable to find BookmarkNode when node id is null"),null)}yWd(b){const h=this.pdb(b);h?(v.ULS.sendTraceTag(36844636,3029,50,String.format("Removing bookmark {0}",b.toString())),this.cNi(h),this.EXc(h)):
v.ULS.sendTraceTag(36569436,3029,15,"Unable to find BookmarkNode for full bookmark range deletion")}cla(b,h){var r;const z=null!==(r=this.fJc(h,b.id))&&void 0!==r?r:E.a.nil;if(z===E.a.nil)return v.ULS.sendTraceTag(36218377,3029,10,"ParaId not on Bookmark"),new jq(null,2);r=this.Sy.zd.Eb(z);return r?r.isConnected?this.getBookmarkRange(r,b,h):(v.ULS.sendTraceTag(36766421,3029,50,"Paragraph not loaded"),new jq(null,3)):(v.ULS.sendTraceTag(36766420,3029,10,"Unable to get paragraph from object space"),
new jq(null,2))}LHf(b){const h=this.w$k(b);h[Symbol.iterator]().next().done||this.NJm(b,h)}dcc(b,h){const r=new Ua.a;let z=0,R=!1;for(let ba of h)ba&&ba.Ob.Lh?(z++,ba.Ob.Lh.remove(ba),0<=ba.Ee&&ba.Ee<b.wordRunProperties.length&&(ba.Ob.cp||(R=!0),r.add(ba.Ee))):v.ULS.sendTraceTag(36569441,3029,15,"BookmarkRangeObject to remove is null");b.sga(!0,r);v.ULS.sendTraceTag(36844637,3029,50,String.format("Removed {0} bookmark anchors | idsToRemove: {1}",z,r.count));R&&!b.wordRunProperties.length&&b.wordRunProperties.append(Eu.CharacterPropertiesEditor.CQ,
1024)}eHc(b=!1){v.ULS.sendTraceTag(559228943,3029,50,"Fetching bookmarks with includeHidden: {0}",b);const h=new Ua.a,r=Nd.GraphIterator.$a(this.Sy);if(null!==this.R9b(r)){var z=r.Jp();v.ULS.sendTraceTag(559228944,3029,50,"Bookmarks count: {0}",z);if(0<z)for(z=r.Xd();null!==z;){let R=z.ia(yc.a.Ts,"");B.a.mf(R)||(b?h.add(z):R.startsWith(this.L0)||h.add(z));z=r.xj()}}!b&&0<h.count&&v.ULS.sendTraceTag(556889755,3029,50,"User Bookmarks count: {0}",h.count);return h}Gqh(b=!1){v.ULS.sendTraceTag(524321506,
3029,50,"Finding bookmarks with includeHidden: {0}",b);const h=Nd.GraphIterator.$a(this.Sy);if(null!==this.R9b(h)&&0<h.Jp()){var r=h.Xd();if(b&&r)return!0;for(;null!==r;){r=r.ia(yc.a.Ts,"");if(!B.a.mf(r)&&(b||!r.startsWith(this.L0)))return!0;r=h.xj()}}return!1}xgf(b){var h=this.pea(b);let r=new Ua.a;if(h){b=this.fJc(!0,h.id);h=this.fJc(!1,h.id);var z=this.Sy.zd.Eb(b);z&&r.add(z);if(b.equals(h))return r;b=z;do(b=z=this.fb.Vg(b,!1,!1,!0))&&r.add(z);while(z&&!z.id.equals(h))}else v.ULS.sendTraceTag(553927448,
3029,10,"bookmark not exist with the {0}",b);return r}PRf(b){if(null===b)return v.ULS.sendTraceTag(559228951,3029,50,"Cannot remove bookmark as id is null"),!1;b=this.pdb(b);return this.dNi(b)}NMh(b){let h="",r=b.id;b=b.characterData.split(this.YVj);for(let z=0;3>z&&z<b.length;z++)h+=this.L0+b[z];h.length>this.ewg&&(h=h.substring(0,this.ewg));return this.Mnj(h,r)}Mnj(b,h){const r=this.eHc(!0);let z=[],R;for(let ta=0;ta<r.count;ta++){var ba=r.J(ta);R=ba.ia(yc.a.Ts,"");ba=this.fJc(!0,ba.id);R.startsWith(b)&&
!h.equals(ba)&&z.push(R)}return 0<z.length?(z.sort((ta,Wa)=>ta.localeCompare(Wa,void 0,{numeric:!0})),(h=z[z.length-1].substring(b.length+1))?b+this.L0+(parseInt(h)+1):b+this.L0+1):b}xjf(b){B.a.mf(b)?v.ULS.sendTraceTag(544777296,3029,10,"Cannot navigate to bookmark as name is null"):(b=this.pea(b),null===b?v.ULS.sendTraceTag(544777297,3029,10,"No bookmark with given name exists"):(b=this.cla(b,!0))?(b=Hf.SelectionFactory.xe(b.z9.paragraph,b.z9.Ob.cp))&&this.ib.setSelection(b):v.ULS.sendTraceTag(544777298,
3029,10,"No start found for bookmark. Document is corrupted"))}dNi(b){if(!b)return v.ULS.sendTraceTag(559228888,3029,15,"Could not find bookmark node with given id"),!1;v.ULS.sendTraceTag(559228889,3029,50,String.format("Removing bookmark {0}",b.id));const h=this.Hc.Rc(15);h.Db(this.BFa);this.cNi(b);this.EXc(b);h.dispose();return!0}YHc(b,h){if(!b||0>h)return v.ULS.sendTraceTag(545118153,3029,10,String.format("Got null paragraph or negative cp value")),null;let r=null,z=new Ua.a,R=new Ua.a;var ba=
b.qa;for(var ta=0;ta<ba.length;ta++){var Wa=ba.J(ta);if(Wa.cp>h||Wa.cp===h&&0<z.count)break;if(Wa.Lh){var ub=Wa.Lh;if(2===ub.length&&ub.J(0).qn.equals(ub.J(1).qn)&&Wa.cp===h){z.add(ub.J(0).qn.toString());break}for(let Ib=0,$b=ub.length;Ib<$b;Ib++){Wa=ub.J(Ib);const fc=b.Lc.Eb(Wa.qn).ia(yc.a.Ts,"");B.a.mf(fc)||fc.startsWith(this.L0)||(Wa.Pc?z.add(Wa.qn.toString()):z.contains(Wa.qn.toString())?z.remove(Wa.qn.toString()):R.add(Wa.qn.toString()))}}}0<z.count&&(r=b.Lc.Eb(E.a.Of(z.J(z.count-1))));if(!r)for(h=
ie.ParagraphReader.Vg(b,!0);h&&!r;){for(ba=0;ba<h.qa.length;ba++)if(ta=h.qa.J(ba),ta.Lh){ta=ta.Lh;for(let Ib=0,$b=ta.length;Ib<$b;Ib++)ub=ta.J(Ib),Wa=b.Lc.Eb(ub.qn).ia(yc.a.Ts,""),B.a.mf(Wa)||Wa.startsWith(this.L0)||(ub.Pc?R.contains(ub.qn.toString())?R.remove(ub.qn.toString()):z.add(ub.qn.toString()):z.contains(ub.qn.toString())?z.remove(ub.qn.toString()):R.add(ub.qn.toString()))}0<z.count?r=h.Lc.Eb(E.a.Of(z.J(z.count-1))):h=ie.ParagraphReader.Vg(h,!0)}return r}Xfj(b,h){if(null===b)return v.ULS.sendTraceTag(525111647,
3029,10,"Bookmark node is null"),!1;if(this.c$l(h)||this.NZk(h))return!1;const r=this.Hc.Rc(15);r.Db(this.BFa);this.Cgo(b,h);r.dispose();return!0}sHh(b){if(!this.Sy)return v.ULS.sendTraceTag(34936483,3029,10,"PageNode is null"),null;const h=new Nd.GraphIterator;h.set(this.Sy);if(!this.R9b(h))return v.ULS.sendTraceTag(34936512,3029,10,"Unable to move to BookmarkContainer"),null;if(!h.Rb(1))return null;do{const r=h.currentNode;if(b(r))return r}while(h.vf(1));return null}getBookmarkRange(b,h,r){for(let z=
0;z<b.qa.length;z++){const R=b.qa.J(z);if(R.Lh)for(let ba=0;ba<R.Lh.length;ba++){const ta=R.Lh.J(ba);if(ta.qn.equals(h.id)&&r===ta.Pc)return new jq(ta,0)}}v.ULS.sendTraceTag(36729310,3029,15,"paragraph {0} did not contain bookmarkNode id:{1}, isStart: {2} ({3}), had {4} chps | Path: {5}",b.id,h.ia(yc.a.Xvb,-1),r,h.id,b.qa.length,this.aK(b));return new jq(null,1)}R9b(b){if(this.jB.zQ(b))return b=b.Rb(30),v.ULS.shipAssertTag(34936513,3029,!!b,"Graph does not contain BookmarkContainer"),b;v.ULS.sendTraceTag(34936514,
3029,15,"Unable to move to Page Manifest");return null}w$k(b){const h=new Lc.a;for(let r=0;r<b.qa.length;r++){const z=b.qa.J(r);if(z.Lh)for(let R=0;R<z.Lh.length;R++){const ba=z.Lh.J(R),ta=ba.qn.toString();h.xb(ta)?(v.ULS.shipAssertTag(36218379,3029,ba.Pc!==h.J(ta).Pc),h.remove(ta)):h.add(ta,ba)}}return h.values}NJm(b,h){this.dcc(b,h);this.tJm(b,h)}tJm(b,h){let r=ie.ParagraphReader.Vg(b,!1,!0);b=ie.ParagraphReader.Vg(b,!0,!0);r||b?(r||this.dgh(h,!0)&&v.ULS.sendTraceTag(36320843,3029,15,"No next paragraph but have start bookmarks to move, falling back to prev paragraph."),
b||this.dgh(h,!1)&&v.ULS.sendTraceTag(36320844,3029,15,"No prev paragraph but have end bookmarks to move, falling back to next paragraph."),r=r||b,b=b||r,this.Vri(r,h,0,!0),this.Vri(b,h,b.qa.last.cp,!1)):v.ULS.sendTraceTag(36218381,3029,15,"Both paragraphs are null.")}dgh(b,h){for(let r of b)if(h===r.Pc)return!0;return!1}Vri(b,h,r,z){const R=new Ua.a;r=this.acf(b,r);for(let ba of h)ba.Pc===z&&(r?(h=this.h1j(b,z,r,ba.qn))&&R.add(h):v.ULS.shipAssertTag(36218382,3029,!0,"Null chp. isStart={0}",z));R.count&&
(b.wn(),this.m9f(b,R),v.ULS.sendTraceTag(36844638,3029,50,String.format("Added {0} bookmark anchors | isStart: {1}",R.count,z)))}h1j(b,h,r,z){const R=this.pdb(z);return R?this.LNe(b,h,r,R):(v.ULS.sendTraceTag(40445218,3029,15,String.format("BookmarkNode {0} null while trying to add range",z)),null)}LNe(b,h,r,z){var R;if(!z)return v.ULS.sendTraceTag(591730834,3029,10,String.format("BookmarkNode null while trying to add range")),null;if(!r)return v.ULS.sendTraceTag(543424736,3029,10,String.format("Chp null while trying to add range")),
null;r.Lh||(r.Lh=new pA.a(r));const ba=new lB.a(r,null,z.id,h);r.Lh.add(ba);(h?this.cB.Mja:this.cB.IVa).set(null===(R=z.id)||void 0===R?void 0:R.toString(),b.id);return ba}m9f(b,h){if(h){v.ULS.sendTraceTag(36218384,3029,50,"BookmarksToUpdate.Count:{0}",h.count);h.Sc((r,z)=>r.Ee-z.Ee);for(let r=0;r<h.count;r++){const z=h.J(r);z.Ee?b.wordRunProperties.DZ(z.Ee-1,1024):b.wordRunProperties.wta(z.Ee,1024);b.wordRunProperties.Hq.Z(z.Ee,Eu.CharacterPropertiesEditor.CQ);b.wordRunProperties.gt.Z(z.Ee,Eu.CharacterPropertiesEditor.aU)}}else v.ULS.shipAssertTag(36218383,
3029,!1,"Null BookmarksToUpdate.")}acf(b,h){if(!b||!b.qa||!b.qa.last)return null;v.ULS.shipAssertTag(36471766,3029,h<=b.qa.last.cp,"Cp to split at greater than last Chp.Cp in paragraph");if(b.qa.last.cp===h){var r=b.qa.length-1;if(!b.qa.J(r).formatting)for(var z=r-1;0<=z;z--){var R=b.qa.J(z);if(R.formatting){this.Vd.OX(b,r,h,R.formatting);break}}return b.qa.last}r=null;for(z=0;z<b.qa.length;z++){R=b.qa.J(z);if(R.cp>=h){if(R.cp>h||!R.formatting)this.Vd.OX(b,z,h,r),R=b.qa.J(z);R.Lh||(R.Lh=new pA.a(R));
v.ULS.shipAssertTag(36471768,3029,R!==b.qa.last);return R}R.formatting&&(r=R.formatting)}return null}f1j(b){const h=new Nd.GraphIterator;h.set(this.Sy);if(!this.R9b(h))return v.ULS.sendTraceTag(36471769,3029,10,"Unable to move to BookmarkContainer"),null;b=this.aIk(b);h.j1(b,1,null);h.Ei(b);return b}aIk(b){const h=this.txj.create(1074135153);h.setValue(yc.a.Ts,b);h.setValue(yc.a.Xvb,ac.a.RF());return h}EXc(b){if(b&&b.anchor){v.ULS.sendTraceTag(36729311,3029,100,"Removed bookmark with id:{0}, ({1})",
b.ia(yc.a.Xvb,-1),b.id);var h=new Nd.GraphIterator;h.set(b);h.Bb(64);h.Eg()}}aK(b){const h=[];let r=0;for(;b.anchor.Ip&&7!==b.type;)h[r]=wk.a[b.type],b=b.anchor.Ip.yr.node,r++;h[r]=wk.a[b.type];return h.join(" ")}Cgo(b,h){b.setValue(yc.a.Ts,h)}cNi(b){const h=this.cla(b,!0).z9;b=this.cla(b,!1).z9;if(h&&b&&h.paragraph===b.paragraph){let r;this.dcc(h.paragraph,(r=new Ua.a,r.add(h),r.add(b),r))}else{if(h){let r;this.dcc(h.paragraph,(r=new Ua.a,r.add(h),r))}if(b){let r;this.dcc(b.paragraph,(r=new Ua.a,
r.add(b),r))}}}b1j(b,h,r,z,R){if(h=this.LNe(b,!0,this.acf(b,h),r)){b.wn();var ba;this.m9f(b,(ba=new Ua.a,ba.add(h),ba));(r=this.LNe(z,!1,this.acf(z,R),r))?(z.wn(),this.m9f(b,(ba=new Ua.a,ba.add(r),ba))):v.ULS.sendTraceTag(520646733,3029,10,"FullBookmarkManager.addBookmarkAnchorsInParagraph: Bookmark end range is null")}else v.ULS.sendTraceTag(520646734,3029,10,"FullBookmarkManager.addBookmarkAnchorsInParagraph: Bookmark start range is null")}ygf(b,h){var r;if(!b)return null;h=null!==(r=this.fJc(h,
b.id))&&void 0!==r?r:E.a.nil;return b.Lc.Eb(h)?b.Lc.Eb(h):null}xai(b){return!!b&&64===b.Qe}XZd(b,h){var r;if(0===b.C7)return!1;for(let z=0;z<(null===(r=b.qa)||void 0===r?void 0:r.length);z++){const R=b.qa.J(z);if(null!=R.Lh)for(let ba=0;ba<R.Lh.length;ba++){const ta=R.Lh.J(ba),Wa=b.Lc.Eb(ta.qn).dLa();if(!B.a.mf(Wa)&&(!Wa.startsWith(this.L0)||h)&&ta.Pc)return!0}}return!1}Hbf(b,h){var r;let z=[];if(0===b.C7)return z;for(let R=0;R<(null===(r=b.qa)||void 0===r?void 0:r.length);R++){const ba=b.qa.J(R);
if(null!=ba.Lh)for(let ta=0;ta<ba.Lh.length;ta++){const Wa=ba.Lh.J(ta),ub=b.Lc.Eb(Wa.qn),Ib=ub.dLa();B.a.mf(Ib)||Ib.startsWith(this.L0)&&!h||!Wa.Pc||z.push(ub)}}return z}hVn(b){return b.ia(yc.a.HF,!1)}c$l(b){return B.a.mf(b)?(v.ULS.sendTraceTag(559228948,3029,50,"bookmark name is null or empty"),!0):!1}NZk(b){return null!==this.pea(b)?(v.ULS.sendTraceTag(559228949,3029,50,"Not updating bookmark name as a bookmark node with same name exists."),!0):!1}Fbf(b,h,r){return this.getBookmarkRange(b,h,r).z9}Mpf(b,
h,r){if(this.hVn(r)||this.gem(r))return!1;const z=this.ygf(r,!0),R=this.ygf(r,!1);if(z&&R&&this.fb.HOc(h,z,R)){if(h!==z&&h!==R)return!0;const ba=this.Fbf(z,r,!0);if(ba&&(z!==h||ba.Ob.cp<=b)&&(r=this.Fbf(R,r,!1))&&(R!==h||r.Ob.cp>=b))return!0}return!1}gem(b){b=null===b||void 0===b?void 0:b.ia(yc.a.Ts,"");return!B.a.mf(b)&&b.startsWith(this.L0)?!0:!1}}Object(n.a)(ev,"FullBookmarkManager",null,[522]);class Ms{constructor(){this.cRa=this.Jm=this.W=null}get name(){return"WordEditor.Bookmark"}yc(b){this.W=
b;this.Jm=this.W.resolve("Box4.INotebookManager").al;const h=new ev(new De.a(()=>vb.App.xa.jb.Yc),ml.PageNavigator.instance,this.W.resolve("Box4.ICharacterPropertiesEditor"),new De.a(()=>vb.App.xa.jb.Ic.rd),$m.a.instance,this.W.resolve("Box4.IParagraphReader"),this.W.resolve("Box4.SelectionManager"),null,null,this.W.resolve("Box4.BookmarkParagraphMapping"));this.W.ha("WordEditor.Bookmark.FullBookmarkManager",()=>h).as("WordEditor.Bookmark.IBookmarkManager").singleInstance();this.W.ha("WordEditor.Bookmark.BookmarksEventHandler",
()=>new oA(this.Jm.Se(12),this.W.resolve("WordEditor.ITableEditor"),this.W.resolve("WordEditor.Bookmark.IBookmarkManager"))).singleInstance();ja.App.lee&&(this.cRa=new Yx(this.Jm.Se(64),new De.a(()=>vb.App.xa.jb.Yc),ml.PageNavigator.instance,Cp.a.instance,this.W.resolve("Box4.BookmarkParagraphMapping")),this.W.ha("WordEditor.Bookmark.BookmarkGraphManager",()=>this.cRa).as("WordEditor.Bookmark.IBookmarkGraphManager").singleInstance())}init(){this.W.resolve("Box4.IFeatureHelper").Yk.continueWith(()=>
{this.Tm()})}dispose(){this.cRa.dispose()}Tm(){v.ULS.sendTraceTag(36209186,324,50,"Registering paragraph events");if(ja.App.hee)this.W.resolve("WordEditor.Bookmark.BookmarksEventHandler").init();else if(ja.App.lee){this.cRa.initialize();const b=new Ls(this.cRa,this.W.resolve("Box4.BookmarkParagraphMapping"));this.Jm.Se(12).zv(Object(u.a)(b,b.Z0a,"onParagraphDelete"));dt.a.jrd(Object(u.a)(b,b.LTc,"onParagraphCopy"));dt.a.pyc(Object(u.a)(b,b.NTc,"onParagraphPaste"))}v.ULS.sendTraceTag(24691930,324,
50,"Finish registering paragraph events");this.bkn(this.W.Za("Box4.Accessibility.IAccessibilityContextManager"),this.W.resolve("WordEditor.Bookmark.FullBookmarkManager"))}bkn(b,h){b&&b.execute(r=>{r.i3(new Xx(h))})}static main(){O.a.instance.Oc(new Ms)}}Object(n.a)(Ms,"BookmarkPackage",null,[1,2]);var hx=d(860),Lv=d(1015),fv=d(1517),Rr=d(1386);class Mv extends Rr.a{constructor(b){super();this.TYj=b}get index(){return 3}run(){this.TYj()}pH(){this.tX()}}Object(n.a)(Mv,"FootnoteEndnoteGraphUpdateTracker",
Rr.a,[]);class Fu{constructor(){this.pbd=null}get name(){return"WordEditor.FootnoteEndnoteInteractive"}yc(){}init(){Fu.Qb.Yk.continueWith(()=>{this.Tm()})}Tm(){hx.a.Wcb=fv.a.instance;this.Clf()}dispose(){}Clf(){this.pbd=new Mv(()=>{fv.a.instance.pu()});Lv.a.e3d(Object(u.a)(this.pbd,this.pbd.pH,"setUpdateNeeded"));ik.GraphTransactionManager.instance.Rna(this.pbd,3)}static get Qb(){return Sa.a.instance.resolve("Box4.IFeatureHelper")}}Object(n.a)(Fu,"PackageManager",null,[1,2]);var mB=d(761),Dp=d(550),
Gy=d(502),Zx=d(1600);class is extends tp{constructor(){super()}get mw(){return null}getTitle(b){b=b.xLa();if(!b||!Dp.a.instance.ama(b))return"";const h=new Sys.StringBuilder,r=Dp.a.instance.h6(b);h.append(1===r?WordEditorIntl.WordEditorStrings.l_FootnoteContentTitle:WordEditorIntl.WordEditorStrings.l_EndnoteContentTitle);h.append(" ");h.append(Dp.a.instance.hAb(b));return h.toString()}}Object(n.a)(is,"FootnoteEndnoteBaseDetailsProvider",tp,[]);class vz extends is{constructor(){super()}get key(){return"FOOTNOTE_ENDNOTE"}get si(){return 7}}
Object(n.a)(vz,"FootnoteEndnoteDetailsProvider",is,[]);var Ft=d(1560),$x=d(1576),nB=d(1639);class qA extends is{constructor(){super()}get key(){return"FOOTNOTE_ENDNOTE_REFMARK"}get si(){return 10}}Object(n.a)(qA,"FootnoteEndnoteRefMarkDetailsProvider",is,[]);class ay{constructor(b,h,r,z,R,ba,ta,Wa,ub,Ib,$b,fc,Kc,ed,Jd,ge,qe,Ve){this.S8h=(Bd,he,we,hg,Pf)=>{hg=he.view;if(!hg.features.B$d||this.rC.rbi)return 8;const Ej=hg.Cb.Rg;if(!Ej)return 2;if(this.Ok.iZ(Ej))return 8;hg=Bd===Oa.a.insertFootnote?1:
0;var pn=this.DEd(he);if(!pn)return v.ULS.sendTraceTag(3683158,308,10,"We expected a selection here."),8;he=!0;pn=pn.Qa;Pf&&Pf.s7b&&Pf.eCa&&(pn=Pf.eCa,he=!Pf.keepCurrentFocus);if(1===we&&ze.a.gfa(Ej)||!pn||!Xd.SelectionEditor.xf(pn)||this.czg.instance&&this.czg.instance.nfm(pn)||Pg.HyperlinkReader.cma(pn,!0))return 8;if(1===we)return 32;2===we&&(we=this.BV.hg("UserAction","InsertFootnoteEndnote"),Bd=this.gEj.T5l(pn,hg,Bd),Pf&&Pf.s7b&&(Pf.lui=Bd),he&&this.$Yd(Bd,!0,!0),we.stop(),this.Hd.zs(6));return 32};
this.c$b=(Bd,he,we)=>{const hg=he.view;if(Bd===Oa.a.Okb||Bd===Oa.a.xKb){if(!hg.features.B$d)return 8}else if(!hg.features.x3f)return 8;if(!hg.Cb.Rg)return 2;he=this.D3b(he);return he?Bd!==Oa.a.Okb&&Bd!==Oa.a.xKb||this.WGa.bWl(he.node,Bd===Oa.a.Okb?1:0)?1===we?32:2===we&&32===this.ga.Xb(Oa.a.T9,2,!0)?(this.ga.Xb(Oa.a.Rsi,2,Bd),32):8:8:2};this.Wcl=(Bd,he,we,hg,Pf)=>{if(1===we)return 32;if(2===we){Bd=this.AIl(he);if(!Bd)return 8;we=he=null;switch(Pf){case Oa.a.eDf:we=Bd.Tc;he=this.zQb.gJd(we,1);break;
case Oa.a.dDf:we=Bd.Tc;he=this.zQb.gJd(we,0);break;case Oa.a.gDf:we=Bd.Qa;he=this.zQb.a2h(we,1);break;case Oa.a.fDf:we=Bd.Qa;he=this.zQb.a2h(we,0);break;case Oa.a.Okb:we=Bd.Qa;(he=this.zQb.gJd(we,1,!0))||(he=this.WGa.IQh(we.node,1));break;case Oa.a.xKb:we=Bd.Qa,(he=this.zQb.gJd(we,0,!0))||(he=this.WGa.IQh(we.node,0))}if(he)this.$Yd(he);else{if(!this.rt.Ic)return 8;(Pf=Md.d(we.node,we.cpBegin))&&7===Pf.si&&this.WGa.ZVi(Pf)}}return 32};this.qXn=(Bd,he,we,hg,Pf)=>1===we?32:2===we?(v.ULS.shipAssertTag(4520066,
308,!!Pf),v.ULS.shipAssertTag(4520067,308,!!Pf.vWa),Bd=Pf.vWa,v.ULS.shipAssertTag(4520068,308,this.KE.ama(Bd)),this.$Yd(Bd,Pf.$7d)?32:8):32;this.rXn=(Bd,he,we,hg,Pf)=>{if(1===we)return 32;2===we&&(Bd=Pf.footnoteEndnoteNode,Pf=Pf.Zcl)&&(this.Hpa.Y0b(),he=this.KE.Sfb(Bd),Pf.title=this.KE.gtl(Bd)+(he?WordEditorIntl.WordEditorStrings.l_FootnoteTooltipInstruction:WordEditorIntl.WordEditorStrings.l_EndnoteTooltipInstruction));return 32};this.xib=(Bd,he,we,hg,Pf)=>2===we?(v.ULS.shipAssertTag(4520069,308,
!!Pf),v.ULS.shipAssertTag(4520070,308,!!Pf.vWa),v.ULS.shipAssertTag(4520071,308,ie.ParagraphReader.nc(Pf.vWa)),Bd=this.KE.O2b(Pf.vWa),this.$Yd(Bd,Pf.$7d)?32:8):32;this.QJn=(Bd,he,we)=>{2===we&&this.rC.HX();return 32};this.iXk=(Bd,he,we,hg,Pf)=>{if(1===we)return 32;if(2===we)return void 0!==Pf&&null!==Pf?this.rC.y4e(Pf,Pf):this.rC.y4e(),32;v.ULS.sendTraceTag(4520072,308,10,"{0}",{["Error"]:"FootnoteEndnoteControl not dismissed"});return 8};this.mqm=(Bd,he,we)=>{Bd=this.D3b(he);return Bd&&Xd.SelectionEditor.xf(Bd)?
1===we?32:2===we?(we=0<this.gp.g2(Bd.node).kt,this.rC.N_e(),this.rC.dialog.Deb=we,32):8:(v.ULS.sendTraceTag(4743179,308,10,"Expected an IP context here."),8)};this.Ucl=(Bd,he,we)=>1===we?32:2===we?(this.rC.dialog.Deb=!1,32):8;this.Rbn=(Bd,he,we,hg,Pf)=>this.RJh(Bd,we,Pf);this.Pbn=(Bd,he,we,hg,Pf)=>1===we?32:this.rC.dialog&&this.rC.dialog.fontName?(Pf[Pk.a.Value]=this.rC.dialog.fontName,32):this.yAj.MKa(Fb.a.LHb.toString(),Pf,null)?32:8;this.Tcl=(Bd,he,we)=>1===we?32:2===we?(this.rC.dialog.Deb=!0,
32):8;this.Qbn=(Bd,he,we,hg,Pf)=>this.RJh(Bd,we,Pf);this.Rcl=(Bd,he,we)=>{if(1===we)return 32;if(2===we){Bd=this.D3b(he);if(!Bd)return v.ULS.sendTraceTag(51512524,308,10,"Selected graph node context is null"),8;he=this.KE.O2b(Bd.node);this.KE.ama(he)&&(we=this.Hc.Rc(15),we.Db(he),this.Xgj(Bd),this.WGa.Kch(he,this.rC.dialog),we.dispose());this.rC.GYc();return 32}return 8};this.Qcl=(Bd,he,we)=>{if(1===we)return 32;if(2===we){Bd=this.D3b(he);if(!Bd)return v.ULS.sendTraceTag(51512525,308,10,"Selected graph node context is null"),
8;he=this.KE.O2b(Bd.node);this.KE.ama(he)&&(we=this.Hc.Rc(15),we.Db(he),this.Xgj(Bd),this.WGa.Yck(he,this.rC.dialog),we.dispose());this.rC.GYc();return 32}return 8};this.Scl=(Bd,he,we)=>1===we?32:2===we?(this.rC.GYc(),32):8;this.Ocl=(Bd,he,we,hg,Pf)=>{if(1===we)return 32;if(2===we){Bd=Object(la.a)(17,Pf);if(!Bd||!Bd.Cd)return 8;this.rC.dialog.fontName=Bd.Cd.fontName;return 32}return 8};this.Pcl=(Bd,he,we,hg,Pf)=>{if(1===we)return 32;if(2===we){Bd=Object(la.a)(17,Pf);if(!Bd||!Bd.Cd)return 8;this.rC.dialog.yQb=
Bd.Cd;return 32}return 8};this.ga=b;this.rt=h;this.yAj=r;this.Zc=z;this.KE=R;this.gEj=ba;this.WGa=ta;this.Hpa=Wa;this.rC=ub;this.gp=Ib;this.zQb=$b;this.Hc=fc;this.Ok=Kc;this.Hb=ed;this.BV=Jd;this.Hd=ge;this.Duj=qe;this.czg=Ve}Xgj(b){(b=Aj.FormattingReader.Pr(b))?(this.rC.dialog.fontName||(this.rC.dialog.fontName=b.cache.WG),-1===this.rC.dialog.fontSize&&(this.rC.dialog.yQb=b.cache.fontSize)):v.ULS.sendTraceTag(587790277,308,10,"UpdateFontAndFontSize: Received null formatting object.")}RJh(b,h,r){return 1===
h&&this.rC.dialog?32:2===h&&this.rC.dialog?(r[Fi.a.On]=b===Oa.a.JOf?this.rC.dialog.Deb:!this.rC.dialog.Deb,32):8}Vb(){this.ga.gb(Oa.a.insertFootnote,kc.a.view,this.S8h,4);this.ga.gb(Oa.a.insertEndnote,kc.a.view,this.S8h,4);this.ga.pa(Oa.a.eDf,kc.a.view,this.c$b);this.ga.pa(Oa.a.Rsi,kc.a.view,this.Wcl);this.ga.pa(Oa.a.dDf,kc.a.view,this.c$b);this.ga.pa(Oa.a.gDf,kc.a.view,this.c$b);this.ga.pa(Oa.a.fDf,kc.a.view,this.c$b);this.ga.pa(Oa.a.Okb,kc.a.view,this.c$b);this.ga.pa(Oa.a.xKb,kc.a.view,this.c$b);
this.ga.pa(Oa.a.C4i,kc.a.view,this.qXn);this.ga.gb(Oa.a.PJh,kc.a.view,this.Tcl,4);this.ga.gb(Oa.a.JOf,kc.a.view,this.Qbn,100);this.ga.gb(Oa.a.QJh,kc.a.view,this.Ucl,4);this.ga.gb(Oa.a.lIi,kc.a.view,this.Rbn,100);this.ga.pa(Oa.a.D4i,kc.a.view,this.rXn);this.ga.gb(Oa.a.xib,kc.a.view,this.xib,96);this.ga.gb(Oa.a.u$e,kc.a.view,this.QJn,96);this.ga.pa(Oa.a.T9,kc.a.view,this.iXk);this.ga.gb(Oa.a.vki,kc.a.view,this.mqm,4);this.ga.gb(Oa.a.MJh,kc.a.view,this.Rcl,4);this.ga.gb(Oa.a.NJh,kc.a.view,this.Qcl,4);
this.ga.gb(Oa.a.OJh,kc.a.view,this.Scl,4);this.ga.gb(Oa.a.xDd,kc.a.view,this.Ocl,4);this.ga.gb(Oa.a.kIi,kc.a.view,this.Pbn,100);this.ga.gb(Oa.a.yDd,kc.a.view,this.Pcl,4);this.ga.gb(Oa.a.hVc,kc.a.view,ay.hVc,100);this.ga.gb(Oa.a.iVc,kc.a.view,ay.iVc,100)}cRf(){this.Duj.execute(b=>{b.i3(new vz);b.i3(new qA)})}D3b(b){b=this.DEd(b);return b?b.Qa:(v.ULS.sendTraceTag(51512526,308,10,"GetCollapsedSelectionFromContext is null"),null)}DEd(b){let h=null;b=b.view;if(!b)return v.ULS.sendTraceTag(3486740,308,
10,"We expected a view here."),h;b=b.Cb;if(!b)return v.ULS.sendTraceTag(51512527,308,10,"We expected that we have a selection manager here."),h;b=b.hb;if(!b||!b.length)return v.ULS.sendTraceTag(51512528,308,10,"We expected that we have a selection collection here."),h;b=b.J(0);if(!b)return v.ULS.sendTraceTag(51512529,308,10,"We expected that we have a current selection here."),h;(h=Xd.SelectionEditor.Pj(b,!1,!1))||v.ULS.sendTraceTag(3486741,308,10,"We expected a selection here.");return h}AIl(b){return(b=
b.view)?b.Cb.hb.J(0):null}$Yd(b,h=!0,r=!1){if(b){this.Hpa.Y0b();var z=b.Yka;if(z){var R=z.Ob;const ba=Hf.SelectionFactory.DN(R.paragraph,R.cp,R.cp+1);R=this.rt.Ic;if(!R)return!1;this.Zc.$na(R,ba);R.Wjb=150;R.Waa();b=new Gy.a(b,h);z=z.HYa(R);if(!z)return v.ULS.sendTraceTag(570529814,308,15,"FootnoteEndnote presenter is null"),!1;r||z.element?this.rC.k0f(b):(this.rC.k0f(new Gy.a(b.vWa,!1)),h&&(h=new Ic.a(2,1,10,()=>{this.rC.HX()}),this.Hb.$b(h)));return!0}}return!1}static Ysl(){return new ay(t.AFrameworkApplication.ya,
vb.App.xa.jb,Sa.a.instance.resolve("Box4.IGeneralCuiUser"),Ya.InteractiveViewManager.instance,Dp.a.instance,$x.a.instance,Ft.a.instance,fv.a.instance,Zx.FootnoteEndnoteControlManager.instance,Sa.a.instance.resolve("Box4.IParagraphIndentationReader"),nB.a.instance,new $m.a,Yh.a.instance,Oe.a.instance,t.AFrameworkApplication.ua.jq,Sa.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,Sa.a.instance.Za("Box4.Accessibility.IAccessibilityContextManager"),Sa.a.instance.Za("Box4.IContentControlReader"))}static Xsl(){return ay.Ysl()}static hVc(b,
h,r,z,R){if(1===r)return 32;if(2===r&&!R)return 8;Cl.a.rMd(h);R.PopulationXML=So.FontUtils.$Kh(Cl.a.m8d,Cl.a.X$e,Oa.a.xDd);return 32}static iVc(b,h,r,z,R){if(1===r)return 32;if(2===r&&!R)return 8;R.PopulationXML=So.FontUtils.aLh(Oa.a.yDd);return 32}}Object(n.a)(ay,"FootnoteEndnoteActor",null,[430]);class oB extends Rr.a{constructor(b){super();this.ELe=b}get index(){return 1}run(){this.ELe()}pH(){this.tX()}}Object(n.a)(oB,"FootnoteEndnoteControlUpdateTracker",Rr.a,[]);var gv=d(372);class wv extends gv.a{constructor(b,
h,r,z,R,ba,ta,Wa){super(b,h,r,z);this.Wr=()=>{this.y3c(this.zb)};this.zH=b.container;this.ov=document.createElement("div");b.container.appendChild(this.ov);this.gC(this.ov);this.CSj=R;this.Hn.execute(ub=>{ub.h7(this.Wr)});this.$Ga=ba;this.QE=ta;this.KH=Wa;this.$Ga.execute(ub=>{ub.MZf(this.fc,this.zH)});this.KH&&(this.zH.style.backgroundColor=this.QE.KAb())}dispose(){super.dispose();this.Hn.instance&&this.Hn.instance.Bjb(this.Wr)}get Hn(){return null!=this.Ikg?this.Ikg:this.Ikg=Sa.a.instance.Za("Common.IZoomManager")}fz(b){this.zH.classList.add("FootnoteEndnoteViewElement");
this.y3c(b.currentNode)}y3c(b){this.Hn.instance&&(this.Hn.instance.h5c(this.ov),this.ov.style.width=Math.round(100/this.Hn.instance.vj)+"%");this.CSj(b)}}Object(n.a)(wv,"FootnoteEndnoteViewElement",gv.a,[]);class rA{constructor(){this._initialized=!1;this.O8c=this.aqe=this.W=null;this.adl=(b,h,r,z)=>b.o_a?new wv(b,h,r,z,R=>{Zx.FootnoteEndnoteControlManager.instance.rvn(R)},this.W.Za("Box4.ContentControl.Acetate.IContentControlAcetateDomManager"),this.W.resolve("WordEditor.PageBackground.PageBackgroundColorHandler"),
!!vb.App.instance&&vb.App.instance.JA):null}get name(){return"WordEditor.FootnoteEndnote"}yc(b){this.W=b}init(){this.W.resolve("Box4.IFeatureHelper").Yk.continueWith(()=>{this.Tm()})}Tm(){Co.WordSectionNavigator.instance.lDf=Object(u.a)(Ft.a.instance,Ft.a.instance.FKm,"navigateToWordSectionNodeWithFootnoteEndnote");mB.a.BZf(this.adl);Zx.FootnoteEndnoteControlManager.instance.bind(vb.App.xa.lC);this.aqe=ay.Xsl();this.aqe.Vb();this.aqe.cRf();vb.App.xa.updateCommandUI();this.Clf();this._initialized=
!0}dispose(){this._initialized&&(this._initialized=!1,Zx.FootnoteEndnoteControlManager.instance.dispose())}Clf(){this.O8c=new oB(()=>{Zx.FootnoteEndnoteControlManager.instance.z3c()});Lv.a.e3d(Object(u.a)(this.O8c,this.O8c.pH,"setUpdateNeeded"));ik.GraphTransactionManager.instance.Rna(this.O8c,3)}}Object(n.a)(rA,"PackageManager",null,[1,2]);class uw{constructor(b,h,r,z,R=null){this.NKj=b;this.ib=h;this.vca=z;this.cB=R}get bgh(){return this.NKj.value}get bookmarkManager(){return this.vca.value}efm(b){return ja.App.lee||
ja.App.hee?b.startsWith(B.a.qab):!1}tTl(b){var h,r;try{if(ja.App.hee)this.uTl(b);else if(ja.App.lee&&this.bgh){var z=b.split("/"),R=this.bgh.pea(z[z.length-1]);if(R&&R.anchor)if(this.cB.Mja.has(null===(h=R.id)||void 0===h?void 0:h.toString())){var ba=this.cB.Mja.get(null===(r=R.id)||void 0===r?void 0:r.toString());if(void 0===ba||null===ba)v.ULS.sendTraceTag(24691933,324,50,"Empty StartBookmarkParaId in the bookmark node"),this.dRd();else{var ta=vb.App.xa.jb.Yc.zd.Eb(ba);if(ta&&ta.anchor){var Wa=
Hf.SelectionFactory.xe(ta,0);this.ib.setSelection(Wa)}else v.ULS.sendTraceTag(24691934,324,50,"Paragraph node is invalid for bookmark"),this.dRd()}}else v.ULS.sendTraceTag(24691932,324,50,"Missing StartBookmarkParaId in the bookmark node"),this.dRd();else v.ULS.sendTraceTag(24691931,324,15,"Cannot find bookmark node"),this.dRd()}}catch(ub){v.ULS.sendTraceTag(24691935,324,10,String.format("Error parsing bookmark url. Error: {0}",ub.message))}}K6f(b){return{returnValue:!1,CRf:b,xKh:""}}uTl(b){if(this.bookmarkManager){b=
b.split("/");var h=this.bookmarkManager.pea(b[b.length-1]);h&&h.anchor?(b=this.bookmarkManager.cla(h,!0).z9,h=this.bookmarkManager.cla(h,!1).z9,b||h?b?this.Z_i(b):(v.ULS.sendTraceTag(35992277,324,50,"Start Anchor is missing for Bookmark"),this.Z_i(h)):(v.ULS.sendTraceTag(35992276,324,50,"Bookmark has no anchors, jumping to end"),this.Ouf(!1))):(v.ULS.sendTraceTag(35992275,324,15,"Cannot find bookmark node"),this.Ouf(!0))}}dRd(){this.Ouf(!0)}Ouf(b){b=Hf.SelectionFactory.wo(vb.App.xa.jb.Yc.Hcf(),b);
this.ib.setSelection(b)}Z_i(b){b.paragraph&&b.Ob?(b=Hf.SelectionFactory.xe(b.paragraph,b.Ob.cp),b.yai=!0,this.ib.setSelection(b)):v.ULS.shipAssertTag(35992279,324,!0,"bookmark's Paragraph or Containing Properties are missing")}}Object(n.a)(uw,"InternalLinkManager",null,[386]);class sA{get name(){return"WordEditor.InternalLinks"}init(){}dispose(){}yc(b){b.ha("WordEditor.InternalLinks.InternalLinkManager",()=>new uw(new De.a(()=>b.Pa("WordEditor.Bookmark.IBookmarkGraphManager")),b.resolve("Box4.ISelectionManager"),
b.resolve("Box4.IFeatureHelper"),new De.a(()=>b.Pa("WordEditor.Bookmark.IBookmarkManager")),b.resolve("Box4.BookmarkParagraphMapping"))).as("Box4.IInternalLinkManager").singleInstance()}static main(){O.a.instance.Oc(new sA)}}Object(n.a)(sA,"WordEditorInternalLinksPackage",null,[1,2]);class To{constructor(b){this.EHa=null;this.checkAndDeleteEphemeralOutline=h=>{h=h.customData;if(h.anchor){mf.a.mark(4763);var r=Nd.GraphIterator.$a(h);if(r.Bb(8)&&r.kd(8)&&r.Qdj(h)===h){if(Ff.OutlineReader.isEmpty(r)){let z=
!1;for(let R=0;R<di.a.instance.hb.length;R++){const ba=di.a.instance.hb.J(R);for(let ta=0;ta<ba.length;ta++)if(ba.J(ta).node===h){z=!0;break}}z||this.tyh(r)}mf.a.mark(4764)}}};To.BJ=b}Mxd(b){if(!To.Te.FPd(b))return null;b.Rb(1)&&(b.currentNode.gk(8,!0),b.mc());const h=To.BJ.cMk();To.Te.isRtl(b.currentNode)?h.setValue(We.a.Bq,11):h.setValue(We.a.Bq,9);b.Sf(h,1);b.Ei(h);return h}rLn(b){if(this.EHa&&b!==this.EHa){const h=new Ic.a(2,1,0,this.checkAndDeleteEphemeralOutline,120);h.customData=this.EHa;t.AFrameworkApplication.uc.$b(h)}this.EHa=
b}tyh(b){this.EHa===b.currentNode&&(this.EHa=null);const h=new yf.GraphTransaction(7);h.Ou(b);b.Eg();h.dispose()}wmh(){if(this.EHa&&this.EHa.anchor){const b=Nd.GraphIterator.$a(this.EHa);b.qo()&&Ff.OutlineReader.JNc(b)&&this.tyh(b);this.EHa=null}}static get Te(){return ne.PageReader.instance}}To.BJ=null;Object(n.a)(To,"PageContentEditor",null,[1318]);var wz=d(1147),Nv=d(651);class pB extends Mj{constructor(){super()}e3i(b,h,r,z,R){let ba=!1,ta=!0;Xd.SelectionEditor.xf(R)&&(h=mc.ListReader.ai(b)&&
h,R=vg.OutlineElementReader.Pz(b,R,!1)&&!vg.OutlineElementReader.Pz(b,R,!0),h&&r.qVe(b,z)&&(ba=!0),vb.App.ud.Mp&&(R||h&&!ba)&&(ta=!1));return{d3i:ta,Blj:ba}}}Object(n.a)(pB,"CursorMoveValidator",Mj,[]);class Nn{constructor(b,h,r,z){this.dCe=b;this.C4=z;this.HH=h;this.Kh=r;this.qHj=!!t.AFrameworkApplication.K&&t.AFrameworkApplication.K.$("QoEIndentLeftForListImprovementIsEnabled")}get Qd(){return null!=this.Zrg?this.Zrg:this.Zrg=Sa.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance}get Nj(){return null!=
this.Krg?this.Krg:this.Krg=Sa.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance}get oc(){return null!=this.ntg?this.ntg:this.ntg=Sa.a.instance.resolve("Box4.Styles.IWACStyleReader")}get Or(){return this.C4.value}get Wg(){return this.Kh.value}get Am(){return this.HH}uRl(b){const h=window.performance.now(),r=new zo.ScriptSharpLegacyMap;let z=new kn.a,R=new zo.ScriptSharpLegacyMap;if(b&&b.Xw){var ba=null;for(let ta=0;ta<b.length;ta++){const Wa=b.getContext(ta);ba=ba||Nn.qh.ju(Wa.node);
let ub;if(!({groupId:ub}=this.aco(Wa.node,ba)).returnValue)continue;let Ib;r.xb(ub)||(Ib=[],r.add(ub,Ib));Ib=r.J(ub);Ib.push(Wa)}for(let ta of rm.toArray(r.keys))b=r.J(ta),ba=new Nd.GraphIterator,ba.set(b[0].node),({mSi:b,$s:ba}=this.HH.zbo(ba)).returnValue?(r.Z(ta,b),R.add(ta,ba)):z.add(ta)}v.ULS.sendTraceTag(589592455,338,50,String.format("GroupGraphNodeContextForIndenationDuration: {0} ms;",window.performance.now()-h));return{returnValue:r,xRl:z,wRl:R}}pwb(b){return this.srk(b)}JYb(b){return this.Tqk(b)}Ltd(b,
h,r=!0){return Nd.GraphIterator.Qka(()=>{var z=!1;if(mc.ListReader.ai(b))return this.qVe(b,h,r);z||(ag.OutlineElementNavigator.De(b),z=ie.ParagraphReader.zh(b)||Ii.TableReader.isTable(b),ag.OutlineElementNavigator.Zd(b),z=z&&this.qrk(b,h));return z})}qVe(b,h,r=!0){return Nd.GraphIterator.Qka(()=>{const z=vg.OutlineElementReader.bBa(b),R=Ff.OutlineReader.yL(b.currentNode);if(r?!this.Cgm(b,h):!this.Dgm(b,h))return!1;var ba=Nd.GraphIterator.$a(b.currentNode);if(0<h&&ba.Bb(14)){ba.kd(16);var ta=ba.currentNode;
const Wa=Gi.TableCellReader.lif(ba);ba.kd(14);const ub=ba.currentNode;ba=vm.a.aQ(ta,ub,yc.a.vM,yc.a.za,0);ta=vm.a.aQ(ta,ub,yc.a.vO,yc.a.Aa,0);ba=Rf.a.Wy(ba,0);ta=Rf.a.Wy(ta,0);return z+R<Wa-ba-ta}return!0})}qrk(b,h){const r=vg.OutlineElementReader.bBa(b);var z=vg.OutlineElementReader.wF(b);if(0<h){h=Ff.OutlineReader.yL(b.currentNode);z=0;let Wa,ub;({Lo:ta,marginLeft:Wa,marginRight:ub}=Nn.cHd(b.currentNode));var R=Nd.GraphIterator.$a(b.currentNode);ag.OutlineElementNavigator.De(b);if(Ii.TableReader.isTable(b)){z=
Ii.TableReader.tea(b);let Ib=0;for(var ba of z)Ib+=ba;z=Rf.a.Wy(Rf.a.yf(Ib,0),0)}ag.OutlineElementNavigator.Zd(b);if(R.Bb(14)){R.kd(16);ba=R.currentNode;b=Gi.TableCellReader.lif(R);R.kd(14);var ta=R.currentNode;R=vm.a.aQ(ba,ta,yc.a.vM,yc.a.za,0);ba=vm.a.aQ(ba,ta,yc.a.vO,yc.a.Aa,0);R=Rf.a.Wy(R,0);ba=Rf.a.Wy(ba,0);return r+h<b-R-ba-z}return r+h<ta-Wa-ub-z}return 0<r-z}rOa(b,h){this.dCi(b,-1*Math.abs(h))}KDc(b,h){this.dCi(b,Math.abs(h))}jVk(b,h,r,z,R){let ba=Nn.mri;if(h>=Nn.mri){ba=h-=r;const ta=z*R,
Wa=Math.abs(ta),ub=Math.abs(h)%Wa;ub&&(ba=0>ba?0>z?ba+ub:ba-(Wa-ub):0<z?ba-ub:ba+(Wa-ub));ba+=ta;ba+=r;Nn.a_d&&(r=vg.OutlineElementReader.g2(b),ba=Nn.a_d.UNh(b.currentNode,h+r,ba+r,R,ba<h)-r)}return ba}ork(b,h,r){if(!b||!b.length)return!1;h=r?h?-1:1:this.zPh(b[0].node,h);return this.prk(b,h,r)}V_m(b,h,r){if(!b)return v.ULS.shipAssertTag(589345600,338,!1,"The group of listOEs are null which are sent for indentation."),8;if(!b.length)return v.ULS.shipAssertTag(589345601,338,!!b.length,"The group of listOEs are empty which are sent for indentation."),
8;if(!r)return v.ULS.shipAssertTag(589592458,338,!1,"The listIds are null which are sent for indentation."),8;if(!r.length)return v.ULS.shipAssertTag(589592459,338,!1,"The listIds are empty which are sent for indentation."),8;const z=b[0].node;h=this.zPh(z,h);if(!this.cJm(z,r[0],h)||!this.$Im(b,h))return 8;this.Or.T7();return 32}$Im(b,h){for(let r=0;r<b.length;r++){const z=new Nd.GraphIterator;z.set(b[r].node);let R=null;ag.OutlineElementNavigator.De(z);if(ie.ParagraphReader.zh(z)){if(R=z.currentNode,
!R)return v.ULS.shipAssertTag(589592461,338,!R,"The paraNode is null for the list OE node"),!1}else if(!ie.ParagraphReader.zh(z)&&!Ii.TableReader.isTable(z))return v.ULS.shipAssertTag(589592460,338,!1,"The content of the listOE is neither a paragraph nor a table node"),!1;z.mc();if(R){if(this.iWl(R)){const ba=R.Kz(),ta=vg.OutlineElementReader.bBa(z);this.Wg.Hva(z,1,ta+h);ba&&this.Nj.nM(R,ba,this.Qd.ng)}R.setValue(We.a.UT,new Date)}}return!0}cJm(b,h,r){for(let z=0;z<zi.a.Ffa;z++){const R=this.HH.Pw(b,
h,z);if(!R)return v.ULS.shipAssertTag(589345602,338,!1,"The list defs returned is null for listId : {0}",h),!1;const ba=R.getValue(yc.a.fe);ba&&R.setValue(yc.a.fe,ba+r)}return!0}iWl(b){return b.hasProperty(yc.a.fe)||b.hasProperty(yc.a.ht)||b.hasProperty(yc.a.ZB)}Tqk(b){return this.Ltd(b,1,!0)}srk(b){return this.Ltd(b,-1,!0)}zPh(b,h){var r=new Nd.GraphIterator;r.set(b);const z=vg.OutlineElementReader.bBa(r),R=vg.OutlineElementReader.wF(r),ba=vg.OutlineElementReader.g2(r);r=Ff.OutlineReader.yL(b);Nn.cHd(b);
b=(R?z-R:ba)%r;return h?-1*(b?b:r):r-b>Nn.xxh?Nn.xxh:r-b}aco(b,h){let r;const z=new Nd.GraphIterator;z.set(b);b=z.Rb(4).getValue(yc.a.listID);return({id:r}=this.HH.LLb(b,h)).returnValue?{returnValue:!0,groupId:r}:{returnValue:!1,groupId:r}}prk(b,h,r){var z=!1;for(let R=0;R<b.length;R++){z=b[R];const ba=new Nd.GraphIterator;ba.set(z.node);Xd.SelectionEditor.Jt(ba);if(!vg.OutlineElementReader.Nh(ba))return Nn.Mc.Zb(Sc.a.zf,{["Reason"]:Xc.a.nXa}),!1;if(this.Ltd(ba,h,r))z=!0;else return Nn.Mc.Zb(Sc.a.o0b,
{["Reason"]:Xc.a.HVe}),!1}return z}dCi(b,h){if(this.Ltd(b,h,!0)){var r=!1;if(mc.ListReader.ai(b)){var z=new Nd.GraphIterator;z.fd(b);this.Am.jD(z);var R=z.currentNode;z.mc();const ta=R.getValue(yc.a.listLevel);r=!0;var ba=R.getValue(yc.a.listID);if(ba=this.gKl(ba,ta+h))ag.OutlineElementNavigator.De(z),ie.ParagraphReader.zh(z)&&Nn.eR.oM(ba,z.currentNode,!1),z.mc();else{ba=null;let Wa;ag.OutlineElementNavigator.De(z);ie.ParagraphReader.zh(z)&&(ba=z.currentNode);z.mc();Wa=ba?ba.Kz():null;this.qHj&&(ba||
(ag.OutlineElementNavigator.De(z),ie.ParagraphReader.zh(z)&&(ba=z.currentNode),z.mc()),ba&&(ba.hasProperty(yc.a.fe)&&ba.removeProperty(yc.a.fe),ba.hasProperty(yc.a.ht)&&ba.removeProperty(yc.a.ht)));this.Or.mTf(z,ta,h);R.setValue(yc.a.listLevel,ta+h);R.removeProperty(yc.a.Ema);ba&&Wa&&(this.Nj.nM(ba,Wa,this.Qd.ng),this.Or.T7());this.h5n(b,R)}}r||(r=vg.OutlineElementReader.bBa(b),z=vg.OutlineElementReader.wF(b),R=Ff.OutlineReader.yL(b.currentNode),h=this.jVk(b,r,z,h,R),this.Wg.Hva(b,1,h))}}Dgm(b,h){const r=
vg.OutlineElementReader.bBa(b);var z=vg.OutlineElementReader.wF(b);const R=vg.OutlineElementReader.g2(b);let ba,ta;({Lo:b,marginLeft:ba,marginRight:ta}=Nn.cHd(b.currentNode));if(0<h){if(z=b-ba-ta,R&&R+h+vb.App.wwa>z||r+h+vb.App.wwa>z)return!1}else if(R&&0>r+h||0>r-z+h)return!1;return!0}Cgm(b,h){var r=this.Or.Qw(b),z=r.level;const R=Ff.OutlineReader.yL(b.currentNode),ba=z+h;if(cp.a.zRd<ba||ba<cp.a.L9e)return!1;const ta=b.currentNode;if(!mc.ListReader.rr){var Wa=ag.OutlineElementNavigator.De(b);ag.OutlineElementNavigator.Zd(b);
if(Wa.hasProperty(yc.a.fe)&&(Wa=Wa.getValue(yc.a.fe),R*(z+1)!==Wa))return!1}r=this.Am.Pw(ta,r.listID,ba);return r?0<h&&r.hasProperty(yc.a.fe)&&(h=r.getValue(yc.a.fe),{Lo:b,marginLeft:r,marginRight:z}=Nn.cHd(b.currentNode),h+vb.App.wwa>b-r-z)?!1:!0:(v.ULS.shipAssertTag(590700875,338,!!r),!1)}gKl(b,h){const r=this.oc.Kp();for(let z=0;z<r.yN;z++){const R=r.xla(z);if(this.Am.vyb(R)&&R.ia(yc.a.listID,this.Or.I6+1)===b&&R.ia(yc.a.listLevel,-1)===h)return R}return null}h5n(b,h){ag.OutlineElementNavigator.De(b);
if(ie.ParagraphReader.zh(b)&&b.currentNode.hasProperty(yc.a.fe)&&(h=this.Am.JIc(h))){const z=mc.ListReader.rr;if(z&&h.hasProperty(yc.a.ht)){var r=h.getValue(yc.a.ht);this.dCe.mkb(b.currentNode,r)}h.hasProperty(yc.a.fe)&&(r=h.getValue(yc.a.fe),this.dCe.Hva(b,1,r));z&&h.hasProperty(yc.a.ZB)&&(h=h.getValue(yc.a.ZB),this.dCe.$aa(b.currentNode,h))}ag.OutlineElementNavigator.Zd(b)}static get eR(){return null!=Nn.Lsg?Nn.Lsg:Nn.Lsg=Sa.a.instance.resolve("Box4.Styles.IWACStyleEditor")}static get a_d(){return null!=
Nn.ypg?Nn.ypg:Nn.ypg=Sa.a.instance.Pa("WordEditor.ParagraphIndentationUtility")}static get paragraphEditor(){return Nn.su||(Nn.su=Sa.a.instance.resolve("Box4.IParagraphEditor"))}static set paragraphEditor(b){Nn.su=b}static get Mc(){return wc.a.instance}static get Sg(){return km.a.instance}static get qh(){return ml.PageNavigator.instance}static cHd(b){let h;var r=Co.WordSectionNavigator.instance.$L(b);h=Nn.Sg.Jv(r);b=Nn.Sg.BL(r);r=Nn.Sg.CL(r);return{Lo:h,marginLeft:b,marginRight:r}}}Nn.xxh=pg.a.BA(.25);
Nn.su=null;Nn.mri=pg.a.BA(-11);Object(n.a)(Nn,"OutlineElementIndentationEditor",null,[382,383]);var tA=d(301),Ki=d(476),Jj=d(214),hv;(function(b){b[b.none=0]="none";b[b.character=1]="character";b[b.paragraph=2]="paragraph";b[b.table=3]="table"})(hv||(hv={}));Object(n.b)("StyleTargetType",hv);var uA=d(168);class xz{constructor(b,h){this.JC=null;this.uG=h;this.Cf=b}get paragraphEditor(){return null!=this.epg?this.epg:this.epg=Sa.a.instance.resolve("Box4.IParagraphEditor")}get rF(){return null!=this.bkg?
this.bkg:this.bkg=Sa.a.instance.resolve("Box4.IFontStylesGalleryCache")}get Gj(){return null!=this.Oqg?this.Oqg:this.Oqg=Sa.a.instance.Pa("Box4.Styles.StyleSettings")}get vi(){return null!=this.wkg?this.wkg:this.wkg=Sa.a.instance.resolve("Box4.IFormattingEditor")}get oc(){return null!=this.qtg?this.qtg:this.qtg=Sa.a.instance.resolve("Box4.Styles.IWACStyleReader")}get Jba(){return this.JC||(this.JC=new Nv.WACStyleSet)}set Jba(b){this.JC=b}get Qb(){return null!=this.Njg?this.Njg:this.Njg=Sa.a.instance.Pa("Box4.IFeatureHelper")}get Ko(){return this.uG.value}get Tj(){return null!=
this.vlg?this.vlg:this.vlg=Sa.a.instance.Pa("Box4.IInsertionPointFormatting")}get dSd(){return this.Cf||(this.Cf=Sa.a.instance.resolve("Box4.List.IListReader"))}get characterPropertiesEditor(){return null!=this.khg?this.khg:this.khg=Sa.a.instance.resolve("Box4.ICharacterPropertiesEditor")}get Qd(){return null!=this.psg?this.psg:this.psg=Sa.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance}get Nj(){return null!=this.Rrg?this.Rrg:this.Rrg=Sa.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance}oKl(b){const h=
b.node;var r=this.Tj?this.Tj.zNh():null;if(r&&!r.equals(E.a.nil)){b=h.Lc;if(!b)return null;r=b.Eb(r);if(!r||(r=new uA.a(r),1!==this.oc.Uw(r)))return null}else r=Aj.FormattingReader.Pr(b),r=Aj.FormattingReader.gta(r);return r}$On(b,h){const r=this.oc.Qx(h);r&&r.xh(this.oc.rf(b))&&(this.a9f(h,r),this.Tj&&(this.Tj.f2a(),this.Tj.Ckb(b,h)))}zck(b,h){if(h)if(h.Azb&&0<h.Azb.length){let R=new Ka.a;for(var r of h.Azb)R.add(r);if(h.avf){h=Aj.FormattingReader.shl(b);r=[];for(var z of h)z.formatting&&z.formatting.an&&
r.push(z.formatting.an);if(0<r.length){z=tA.APropertySet.VSh(r);h=new Ka.a;for(const ba of R)z.hasProperty(ba)||h.add(ba);R=h}}this.paragraphEditor.gZb(b,!0,R)}else this.paragraphEditor.gZb(b,!0);else ud.b(576582787,3018,15,"Cannot apply alternate formatting strategy as ClearSpecificFormattingProperties is null")}oM(b,h,r,z=!1,R=!1,ba=!1,ta=null){if(ie.ParagraphReader.nc(h))if(b)if(this.oc.CI(b.$h()))if(2!==this.oc.Uw(b))v.ULS.shipAssertTag(593506381,324,!1);else{var Wa=this.oc.Qx(h);if(Wa){var ub=
this.oc.rf(b);if(!ub)v.ULS.shipAssertTag(593506377,324,!1);else if(Wa.xh(ub)){var Ib=null,$b=xg.a.instance.J(3)&&!z?h.Kz():null;r||(ta&&ta.Kqk&&this.Qb&&this.Qb.isFeatureEnabled(104)?(this.zck(h,ta),this.$jo(h,b,ta)):(Ib=this.Ko.eQf(Ib,h),this.paragraphEditor.gZb(h,!0)));this.a9f(h,Wa);xg.a.instance.J(8)||(b=Wa.xh(this.oc.rf(b)));R&&$b&&$b.hasProperty(Ij.a.paragraphStyle)&&$b.removeProperty(Ij.a.paragraphStyle);h.properties.setValue(Ij.a.paragraphStyle,b.id);null!=Ki.a.ae&&!Ki.a.ae.RL&&this.Qb&&this.Qb.isFeatureEnabled(104)&&
this.Ngj(h,b,ta);h.gJ=b;h.D3=null;for(r=0;r<h.qa.length;r++)h.qa.J(r).formatting&&h.qa.J(r).formatting.C5b();this.dSd.vyb(b)&&(Ib||(Ib=new Nd.GraphIterator,Ib.set(h),Ib.vd(),ag.OutlineElementNavigator.Zd(Ib)),mc.ListReader.ai(Ib)||(h.Qg(yc.a.fe,yc.a.JQ,yc.a.ZB,yc.a.e_,yc.a.gOa,yc.a.Qv),this.csd(Ib,b)));this.Gj&&this.Gj.isProgressiveStyleEnabled&&null!=this.rF&&this.rF.Uec(ub);z||!$b||ba||this.Nj.nM(h,$b,this.Qd.ng)}}else v.ULS.shipAssertTag(593506379,324,!1)}else v.ULS.shipAssertTag(593506382,324,
!1);else v.ULS.shipAssertTag(593506383,324,!1);else v.ULS.shipAssertTag(593506384,324,!1)}$jo(b,h,r){const z=this.dSd.xF(b),R=this.dSd.vyb(h);if(z){if(null!=Ki.a.ae&&Ki.a.ae.RL)this.Ngj(b,h,r);else{r=r&&!r.avf&&r.Azb?r.Azb:null;var ba=this.dSd.VN(z);ba&&this.Ko.Zjo(z,h,r,ba.sr)}R||b.setValue(yc.a.Ema,!1)}else R&&b.setValue(yc.a.Ema,!0)}Ngj(b,h,r){const z=b.Lc;if(b=this.characterPropertiesEditor.GKa(b)){var R=null==b.an?new Jj.a:b.an.clone();uj.a.dlo(R,h,r&&!r.avf&&r.Azb?r.Azb:null);R.lma?h=z.QQ(R,
!0):(z.Ku(R,null),h=R);b.Bj=h.id}else v.ULS.sendTraceTag(574660761,3018,15,"EOP formatting is null, skipping application on EOP.")}csd(){}w7d(b,h){if(h){v.ULS.shipAssertTag(593506371,324,h.isConnected,"paragraphNode not connected");var r=this.oc.Qx(h);r?(b=r.eta(b))?this.oc.CI(b.$h())?this.oM(b,h,!1,void 0,void 0,void 0,null):v.ULS.shipAssertTag(593506368,324,this.oc.CI(b.$h())):v.ULS.shipAssertTag(593506369,324,!!b):v.ULS.shipAssertTag(593506370,324,!1,"StyleReader.GetStyleSetFromParagraphNode==null")}else v.ULS.shipAssertTag(593506372,
324,!1)}aXe(b,h=!1,r=!1){const z=this.oc.Qx(b).xh(xg.a.instance.J(8)?ki.StyleReader.wordStyleIdNormal:ki.StyleReader.styleIdNormal);this.oM(z,b,h,void 0,r)}a9f(b,h){(b=xz.qh.ju(b))&&h.K_c(b,!1)}GSk(b){var h=null;if(this.Qb&&this.Qb.isFeatureEnabled(34)){if(!b||!b.count)return v.ULS.sendTraceTag(592221652,3018,10,"No style IDs provided for delete."),!1;if(!h&&(h=uj.a.Rw(),!h))return v.ULS.sendTraceTag(592221653,3018,15,"Couldn't retreive PageContentNode."),!1;var r=this.Jba.XN(h);if(!r)return v.ULS.sendTraceTag(592221654,
3018,50,"Couldn't retreive WACStyleSet from PageContentNode."),!1;var z=new Map;z.set("NumberOfStyles",b.count.toString());z.set("Source","DeleteStyleAPI");Ca.Health.instance.recordKpiUsage(Zl.a.fee,0,Zl.a.EB,z);z=0;const ta=(new Date).getTime();var R=null;let Wa=null,ub=null,Ib=null;const $b=this.Qb.isFeatureEnabled(33)&&!0;$b&&(R=new Ua.a,Wa=new Ua.a,ub=new Ua.a,Ib=new Ua.a);for(var ba of b){if(!ba)return v.ULS.sendTraceTag(592221655,3018,50,"Style ID is null."),!1;const fc=r.xh(ba);if(!fc||!this.oc.oe(fc,
r))return v.ULS.sendTraceTag(592221656,3018,50,"Provided style is null[{0}] or not a custom style [{1}].",!fc,!!fc&&this.oc.oe(fc,r)),!1;const Kc=this.oc.Uw(fc);if(2!==Kc&&1!==Kc)return v.ULS.sendTraceTag(592221657,3018,50,"Provided style has style type: {0}.",Kc),!1;const ed=this.oc.j2(fc,r);let Jd=0;if(ed){if(!this.oc.oe(ed,r))return v.ULS.sendTraceTag(571074068,3018,15,"Provided custom style's linked style is not a custom style."),!1;Jd=this.oc.Uw(ed);if(2!==Jd&&1!==Jd)return v.ULS.sendTraceTag(592221659,
3018,15,"Provided style's target type: {0}, linked style's target type: {1}. ",Kc,Jd),!1}else v.ULS.sendTraceTag(592221658,3018,50,"Provided style's linked style is null.");let ge=this.dyb(fc,r);if(!ge)return!1;z++;$b&&(1===Kc?(Wa.add(ba),Ib.add(fc.id)):(R.add(ba),ub.add(fc.id)));if(ed){ge=this.dyb(ed,r);if(!ge)return!1;z++;$b&&(1===Jd?(Wa.add(this.oc.rf(ed)),Ib.add(ed.id)):(R.add(this.oc.rf(ed)),ub.add(ed.id)))}}Jb.a.DCb();r=uj.a.Yhf(r);ba=new yf.GraphTransaction(15);ba.Db(h);$b&&this.Vqn(R,Wa,ub,
Ib,h);h.setValue(Ij.a.Xga,r);ud.b(572302817,3018,50,String.format("Style Object Ids - {0}",r));ba.y6d();ba.dispose();h=(new Date).getTime();R=new Map;R.set("Source","DeleteStyleAPI");R.set("NumberOfStyles",b.count.toString());R.set("TrueStyleCount",z.toString());R.set("ShouldRemoveReferences",(!0).toString());b=Object.assign(new eb.a,{extendedProperties:R,durationMs:h-ta});Ca.Health.instance.recordKpiSuccess(Zl.a.fee,b);return!0}return!1}Vqn(b,h,r,z,R){if(b&&b.count||h&&h.count)if(R){var ba=(new Date).getTime();
if(R=this.nql(R)){for(;R.moveNext();){if(!ie.ParagraphReader.zh(R.iterator))continue;const ta=R.currentNode;this.Fqn(ta,b,r);this.Gqn(ta,h,z)}r=(new Date).getTime();v.ULS.sendTraceTag(591148963,3018,50,String.format("RemoveStyleReferences Duration: {0} ms;",r-ba));z=new Map;z.set("Source","DeleteStyleRemoveStylesReferences");z.set("NumberOfStyles",(b.count+h.count).toString());b=Object.assign(new eb.a,{extendedProperties:z,durationMs:r-ba});Ca.Health.instance.recordKpiSuccess(Zl.a.fee,b)}}else ud.b(577520338,
3018,50,"PageContentNode not provided.");else ud.b(577520337,3018,50,"No style IDs provided")}Fqn(b,h,r){if(h&&h.count&&b){var z=b.NA;z&&z.hasProperty(Ij.a.paragraphStyle)&&r.contains(z.getValue(Ij.a.paragraphStyle))&&(z.removeProperty(Ij.a.paragraphStyle),b.NA=z,b.Kz()&&this.Nj.nM(b,b.Kz(),this.Qd.ng));(r=this.oc.yo(b))&&(r=this.oc.rf(r))&&h.contains(r)&&this.aXe(b,!0,!0)}}Gqn(b,h,r){if(b&&b.qa&&b.qa.length&&h&&h.count)for(let ta=0;ta<b.qa.length;ta++){var z=b.qa.J(ta);if(z&&z.formatting&&(z=z.formatting)&&
z.Ob){var R=Aj.FormattingReader.gta(z);R&&(R=this.oc.rf(R))&&h.contains(R)&&this.vi.RWe(z);if(R=z.Ob.nn){var ba=R.an;ba&&(ba=ba.clone(),ba.hasProperty(Ij.a.tB)&&r.contains(ba.getValue(Ij.a.tB))&&this.Ron(b,ba,R,z));xg.a.instance.J(3)&&(ba=ta===b.qa.length-1?b.characterData.length:b.qa.J(ta+1).cp,this.Nj.CJb(b,z.Ob,z.Ob.cp,ba,R,z,this.Qd.ng))}}}}Ron(b,h,r,z){b&&h&&r&&z&&(b=b.Lc)&&(h.removeProperty(Ij.a.tB),h.lma?h=b.QQ(h,!0):b.Ku(h,null),r.Bj=h.id,z.Ob.nn=r)}nql(b){if(!b)return null;b=Nd.GraphIterator.$a(b);
return b.qo()?Cn.a.Kr(b,b.origin):null}dyb(b,h){if(!b)return v.ULS.sendTraceTag(592221660,3018,10,"WACStyle for given style ID is null."),!1;var r=b.$h();return this.oc.CI(r)?h.Uqn(b)?!0:(r=new Map,r.set("Source","DeleteStyle"),r.set("StyleType",hv[this.oc.Uw(b)]),r.set("IsCustomStyle",this.oc.oe(b,h).toString()),r.set("IsLinkedStyle",(!!this.oc.j2(b,h)).toString()),b=Object.assign(new eb.a,{extendedProperties:r}),Ca.Health.instance.recordKpiFailure(Zl.a.fee,"UnableToDeleteStyle",!1,!0,b),v.ULS.sendTraceTag(592221662,
3018,50,"Couldn't remove style from style set."),!1):(v.ULS.sendTraceTag(592221661,3018,50,"Invalid property set inside WACStyle."),!1)}L9b(b,h,r,z){var R,ba,ta;if(this.Qb&&this.Qb.isFeatureEnabled(83)){if(!b)return v.ULS.sendTraceTag(591138959,3018,15,"No style IDs provided for delete."),!1;if(!r&&(r=uj.a.Rw(),!r))return v.ULS.sendTraceTag(591138960,3018,15,"Couldn't retreive PageContentNode."),!1;const ub=this.Jba.XN(r);if(!ub)return v.ULS.sendTraceTag(591138961,3018,50,"Couldn't retreive WACStyleSet from PageContentNode."),
!1;b=ub.xh(b);if(!b)return v.ULS.sendTraceTag(591138962,3018,50,"Provided style is null[{0}].",!b),!1;var Wa=this.oc.Uw(b);if(2!==Wa&&1!==Wa)return v.ULS.sendTraceTag(591138963,3018,50,"Provided style has style type: {0}.",Wa),!1;Ca.Health.instance.recordKpiUsage(Zl.a.mag,0,Zl.a.EB,new Map([["Source","ModifyStyleAPI"]]));Wa=Date.now();const Ib=new yf.GraphTransaction(15);let $b,fc;try{Ib.Db(r);if(!(z&&0!=z.length||h&&0!=h.count))return!1;if(z&&0!=z.length){if(null===(R=Ki.a.ae)||void 0===R?0:R.FOc)$b=
uj.a.zGd(b);if(!ub.rTk(b,z))return this.iua("ModifyStyleAPI",b,ub,Wa,"UnableToDeleteStyleProperties"),!1}if(h&&0!=h.count){const qe=ub.emo(b,h);if(null===(ba=Ki.a.ae)||void 0===ba?0:ba.FOc)fc=uj.a.zGd(b);if(!qe)return this.iua("ModifyStyleAPI",b,ub,Wa,"UnableToModifyStyle"),!1}(null===(ta=Ki.a.ae)||void 0===ta?0:ta.FOc)&&this.eJm(b,r,fc,$b);Jb.a.DCb();const Kc=uj.a.Yhf(ub);r.setValue(Ij.a.Xga,Kc);ud.b(572302818,3018,50,String.format("Style Object Ids - {0}",Kc));const ed=Date.now(),Jd=new Map([["Source",
"ModifyStyleAPI"]]),ge=Object.assign(new eb.a,{extendedProperties:Jd,durationMs:ed-Wa});Ca.Health.instance.recordKpiSuccess(Zl.a.mag,ge);return!0}finally{Ib&&Ib.dispose()}}return!1}eJm(b,h,r,z){var R,ba;if(null!==b){var ta;z&&((ta=null===(R=this.Ko)||void 0===R?void 0:R.Xce(h,z,b,!0))||ud.b(522856385,3018,50,"Cannot able to remove the pstyle property in list def during modify style."));r&&((ta=null===(ba=this.Ko)||void 0===ba?void 0:ba.Xce(h,r,b,!1))||ud.b(522856386,3018,50,"Cannot able to modify the pstyle property in list def during modify style."))}}iua(b,
h,r,z,R){const ba=Date.now();b=new Map([["Source",b],["StyleType",hv[this.oc.Uw(h)]],["IsCustomStyle",this.oc.oe(h,r).toString()],["IsLinkedStyle",(!!this.oc.j2(h,r)).toString()]]);z=Object.assign(new eb.a,{extendedProperties:b,durationMs:ba-z});Ca.Health.instance.recordKpiFailure(Zl.a.mag,R,!1,!0,z)}static get qh(){return ml.PageNavigator.instance}}Object(n.a)(xz,"WACStyleEditor",null,[1188]);class vw extends xz{constructor(b,h,r){super(b,r);this.C4=h}get Or(){return this.C4.value}csd(b,h){this.Or.csd(b,
h)}}Object(n.a)(vw,"WACStyleEditor",xz,[]);var Li=d(47);class yz{L2a(b,h){b.properties.setValue(yc.a.marginTop,h)}J2a(b,h){b.properties.setValue(yc.a.marginBottom,h)}Lga(b,h){b.properties.setValue(yc.a.marginLeft,h)}K2a(b,h){b.properties.setValue(yc.a.marginRight,h)}KYf(b,h){b.properties.setValue(yc.a.Lo,h)}JYf(b,h){b.properties.setValue(yc.a.ay,h)}KZi(b,h){b.properties.setValue(yc.a.Gji,h)}zJb(b,h){b.properties.setValue(Li.a.KC,h)}iIn(b,h){b.properties.setValue(Li.a.iW,h)}Qdc(b,h){b.properties.setValue(Li.a.Kx,
h)}}Object(n.a)(yz,"WordSectionEditor",null,[381]);class zz{get name(){return"WordEditor.OutlineLevelEditors"}yc(b){b.ha("WordEditor.OutlineLevelEditors.WordSectionEditor",()=>new yz).as("Box4.IWordSectionEditor").singleInstance();t.AFrameworkApplication.K.$("OutlineLevelEditorsDelayInitializationEnabled")&&(b.ha("Box4.OutlineLevelEditors.PageContentEditor",()=>new To(b.resolve("Box4.IOutlineEditor"))).as("Box4.Pages.IPageContentEditor").singleInstance(),b.ha("WordEditor.OutlineLevelEditors.OutlineElementIndentationEditor",
()=>new Nn(ao.a.FYa,b.resolve("WordEditor.List.IFlatListReader"),b.ef("Box4.IOutlineElementEditor"),b.ef("WordEditor.IFlatListEditor"))).as("Box4.IOutlineElementIndentationEditor"),b.ha("WordEditor.OutlineLevelEditors.OutlineElementIndentationEditor",()=>new Nn(ao.a.FYa,b.resolve("WordEditor.List.IFlatListReader"),b.ef("Box4.IOutlineElementEditor"),b.ef("WordEditor.IFlatListEditor"))).as("WordEditor.OutlineLevelEditors.IWordOutlineElementIndentationEditor"),b.ha("WordEditor.OutlineLevelEditors.CursorMoveValidator",
()=>new pB).as("Box4.List.ICursorMovementValidator").singleInstance(),b.ha("Box4.Styles.WACStyleReader",()=>new wz.a(b.resolve("WordEditor.ClientPagination.IClientPaginationSettings"),new Nv.WACStyleSet)).as("Box4.Styles.IWACStyleReader").singleInstance(),b.ha("WordEditor.OutlineLevelEditors.WACStyleEditor",()=>new vw(b.resolve("Box4.List.IListReader"),b.ef("WordEditor.IFlatListEditor"),b.ef("Box4.List.IListEditor"))).as("Box4.Styles.IWACStyleEditor").singleInstance())}init(){}dispose(){}static main(){O.a.instance.Oc(new zz)}}
Object(n.a)(zz,"WordEditorOutlineLevelEditorsPackage",null,[1,2]);var vA=d(1182),Ov=d(537),ww=d(796),ix=d(115),iv=d(317);class lt{constructor(b,h,r,z,R,ba){this.Cf=R;this._pageContent=r;this.Erb=Array(lt.Ffa);this.dVb=Array(lt.Ffa);this.o1g=Array(lt.Ffa);this.YEe=Array(lt.Ffa);this.xYg=Array(lt.Ffa);this.uV=z;this.jxc=ba;for(z=0;z<lt.Ffa;z++){var ta=this.CTh(b,z,r,R);ta?(ba=ta.ia(We.a.kX,zi.a.Yi),ta=ta.ia(yc.a.QYc,zi.a.Yi)):ta=ba=zi.a.Yi;this.dVb[z]=ba!==zi.a.Yi?ba:zi.a.ADc;this.YEe[z]=ta===zi.a.Yi?
z-1:ta-1;lt.K6(h)&&(this.o1g[z]=zi.a.Yi,this.xYg[z]=zi.a.Yi);this.Erb[z]=this.dVb[z]}}CTh(b,h,r,z){z.W1(r);return bt.a.getInstance().X5b&&this.jxc?this.Cf.qff(b,h,this.uV,r):this.Cf.b3b(b,h,r.Lc,r)}restart(b){this.Erb[b]=this.dVb[b]}Gti(b){for(var h=0;h<b;h++)this.Erb[h]===this.dVb[h]&&this.Erb[h]++;for(h=b+1;h<lt.Ffa;h++)this.YEe[h]>=b&&this.restart(h);return this.Erb[b]++}static K6(b){return!!b&&b.isFeatureEnabled(71)}}lt.Ffa=9;Object(n.a)(lt,"AWordList",null,[35]);class xw{constructor(b,h,r,z){this.i8a=
new zo.ScriptSharpLegacyMap;this.Cf=b;this.qz=h;this.uV=r;this.jxc=z}Hs(b,h){this.i8a.xb(b)||this.i8a.Z(b,new lt(b,h,this.qz,this.uV,this.Cf,this.jxc));return this.i8a.J(b)}TDf(b,h,r){return this.Hs(b,r).Gti(h)}}Object(n.a)(xw,"AListNumberingMap",null,[1376]);class Az extends lt{constructor(b,h,r,z,R,ba){super(b,h,r,z,R,ba)}gCl(b,h,r,z){z.W1(r);return bt.a.getInstance().X5b&&this.jxc?this.Cf.ayl(b,h,this.uV):this.Cf.$xl(b,h,this._pageContent.Lc)}Hgj(b,h,r){var z=this.gCl(b,h,this._pageContent,this.Cf);
z?(b=z.ia(We.a.kX,zi.a.ADc),z=z.ia(yc.a.QYc,zi.a.Yi),this.Erb[h]=this.o1g[h]=this.dVb[h]=b,z!==zi.a.Yi&&(this.xYg[h]=this.YEe[h]=z-1)):r&&(z=this.CTh(b,h,this._pageContent,this.Cf),b=zi.a.ADc,z&&(b=z.ia(We.a.kX,zi.a.ADc)),this.Erb[h]=this.dVb[h]=b)}}Object(n.a)(Az,"WordList",lt,[]);class Gu extends xw{constructor(b){super(b.hd,b.pageContentNode,b.SIb,b.Bjj);this.LWg=new Ua.a}Axl(b,h,r){let z;bt.a.getInstance().PT?{value:z}=this.Cf.uQ.Dc(b,z):{value:z}=this.Cf.tQ.Dc(b,z);this.i8a.xb(z)||this.i8a.Z(z,
new Az(b,r,this.qz,this.uV,this.Cf,this.jxc));if(!this.LWg.contains(b))for(this.LWg.add(b);h<zi.a.Ffa;h++)this.i8a.J(z).Hgj(b,h,!1);else if(!h)for(h+=1;h<zi.a.Ffa;h++)this.i8a.J(z).Hgj(b,h,!0);return this.i8a.J(z)}TDf(b,h,r){return lt.K6(r)?this.Axl(b,h,r).Gti(h):super.TDf(b,h,r)}}Object(n.a)(Gu,"ListNumberingMap",xw,[]);class fu{constructor(){this.Jfa=0;this.hlj=!1}}Object(n.a)(fu,"LastNumber",null,[]);var wA=d(575),jv=d(715),gu=d(872);class qB{constructor(){this.startAt=this.m_=0}}Object(n.a)(qB,
"WordListRestartInfo",null,[]);class dp{constructor(b,h,r,z){this.WVd=!1;this.Or=b;this.bei=r;this.J5b=z;this.Xr=this.Or.Qw(h);this.outlineElement=new Nd.GraphIterator;this.outlineElement.fd(h)}static get hd(){return dp.Cf||(dp.Cf=Sa.a.instance.resolve("Box4.List.IListReader"))}static set hd(b){dp.Cf=b}static get ae(){return bt.a.getInstance()}static I9k(b,h,r,z=!1,R=!1){var ba=h.currentNode;let ta=null;new Nd.GraphIterator;let Wa=!1,ub=!1;h=h.nwa();const Ib=Cn.a.Wp(h);Ib.moveNext();for(h=Ib.iterator;h.currentNode!==
ba;){let fc=ub=Wa=!1;var $b=!1;mc.ListReader.rr&&($b=dp.SZk(h));if(vg.OutlineElementReader.Nh(h)&&!$b){$b=!1;if(h.aq(4))if(dp.Zui(h,r,!0,z,R))if(mc.ListReader.sZ){if(fc=!0,ta=new dp(b,h,!1,!1),Ib.moveNext(),Ib.iterator===ba&&(Wa=!0),z)break}else ta=new dp(b,h,!1,!1),Wa=!0;else vg.OutlineElementReader.isEmpty(h,!1)||($b=!0),ub=!0;else!vg.OutlineElementReader.isEmpty(h,!1)&&h.Aeb(12)&&(vg.OutlineElementReader.yP(h)||($b=!0));!z&&$b&&ta&&(!r.propertySet.hasProperty(yc.a.listLevel)&&mc.ListReader.rr?
ta=null:ta.Xr.level=0)}fc||Ib.moveNext();h=Ib.iterator}ta&&(ta.J5b=Wa);if(!ta&&h.vf(1))for(ba=!0;h.currentNode;){if(vg.OutlineElementReader.Nh(h)){if(h.aq(4)&&dp.Zui(h,r,!1,z,R)){ta=new dp(b,h,!0,ba);break}if(!vg.OutlineElementReader.isEmpty(h,!1))break}if(!h.vf(1))break;ba=!1}ta&&(ta.WVd=ub);return ta}static SZk(b){var h=b.Rb(2);if(!h)return!1;h=ie.ParagraphReader.zh(b)&&dp.Ihm(h);b.mc();return h}static Ihm(b){return Md.a(b,8)}static Zui(b,h,r,z=!1,R=!1){dp.hd.jD(b);var ba=b.currentNode;b.mc();if(ba.ia(yc.a.Ema,
!1)&&!dp.ae.IDb)return!1;const ta=dp.hd.VN(ba);(b=h.sr===ta.sr)&&h.listStyle&&1!==h.vr&&(b=h.listStyle===ta.listStyle);dp.hd.xr&&b&&(h.pma&&1!==h.vr||h.X1b||R)&&(b=dp.Jfm(h,ta),h.sr||(b=b&&h.font===ta.font));if(1===h.vr)if(1===ta.vr&&ta.propertySet.hasProperty(ui.a.khb))b=h.O3===ta.O3;else return!1;b&&h.sr&&h.Tz!==zi.a.Yi&&(b=ta.hq,r&&(z&&1===h.Tz&&1===b||b++),b=h.Tz===b);b&&(z||h.X1b)&&(h=h.propertySet.ia(yc.a.listID,0),ba=ba.ia(yc.a.listID,0),0<h&&0<ba&&(b=h===ba));return b}static Jfm(b,h){h=h.ORd;
b.pma&&(h=h.replace(RegExp("%\\d"),"%1"));return h.toLocaleLowerCase()===b.ORd.toLocaleLowerCase()}static J9k(b,h,r){var z=h.currentNode;let R=null;const ba=new Nd.GraphIterator,ta=b.GL(z,r);var Wa=!1;let ub=!1;ba.fd(h);ba.mc();for(ba.Rb(1);ba.currentNode!==z;)ub=Wa=!1,vg.OutlineElementReader.Nh(ba)&&ba.aq(4)&&(h=b.Qw(ba),dp.$ui(h,r,!0)?(R=new dp(b,ba,!1,!1),Wa=!0):(ub=!0,h.listID===r.listID&&h.level<=ta.m_&&(R=null))),ba.vf(1);R&&(R.J5b=Wa);if(!R&&ba.vf(1))for(z=!0;ba.currentNode;){if(vg.OutlineElementReader.Nh(ba)&&
ba.aq(4)){Wa=b.Qw(ba);if(Wa.listID===r.listID&&Wa.level<=ta.m_)break;if(dp.$ui(Wa,r,!1)){R=new dp(b,ba,!0,z);break}}if(!ba.vf(1))break;z=!1}R&&(R.WVd=ub);return R}static $ui(b,h,r){let z=b.listID===h.listID&&b.level===h.level;z&&h.hq!==zi.a.Yi&&(b=b.hq,r&&b++,z=h.hq===b);return z}}dp.Cf=null;Object(n.a)(dp,"JoinTargetInfo",null,[]);class cC{constructor(){this.action=0;this.Xr=null}}Object(n.a)(cC,"ApplyListInfoWordResult",null,[]);class Bz{constructor(b,h,r){this.nao=b;this.qfc=r;this.t_m=h;this.l8=
r-h.hq;this.hUc=h.listID}get delta(){-1!==this.l8&&(this.l8=this.qfc-this.t_m.hq);return this.l8}set delta(b){this.l8=b}}Object(n.a)(Bz,"ListTransferInfo",null,[]);class Go extends Ki.a{constructor(b,h,r,z,R,ba,ta,Wa,ub,Ib,$b,fc){super(b,r,ub);this.xUa=!1;this.Tlc=this.E9c=this.qPb=null;this.gp=R;this.HH=b;this.eRb=h;this.Hc=z;this.RKf={};this.Sxe=ba;this.Hd=ta;this.Ym=Wa;this.Ac=Ib;this.BC=$b;this.iS=fc}get K6(){return this.HH.W$}get Am(){return this.HH}get H7(){return this.iS}get oc(){return this.BC}get $s(){return this.Am.$s}get vp(){return this.Am.vp}get n9(){return this.Am.n9}get xr(){return this.hd.xr}get I6(){return this.Am.I6}set I6(b){this.Am.I6=
b}get $Ma(){return this.Am.$Ma}set $Ma(b){this.Am.$Ma=b}get Tkb(){return null!=this.kqg?this.kqg:this.kqg=Sa.a.instance.Pa("Box4.List.ISingleLevelListEditor")}U9j(b,h,r,z){v.ULS.sendTraceTag(17622210,324,50,"AdjustAndSetLevel is called in WordEditor.");const R=r.ia(od.a.MNd,!1);let ba=!1,ta=-1;!R||h.listStyle&&1!==h.vr||(ba=!r.ia(od.a.Muf,!1),ta=r.ia(od.a.wwf,-1));b=this.GXb(b,h,!0,ba,ta,z,r);R||r.setValue(od.a.Muf,2===b.action);3===b.action&&!r.hasProperty(od.a.wwf)&&b.Xr&&r.setValue(od.a.wwf,b.Xr.level)}merge(b,
h,r,z=null){const R=mc.ListReader.ai(b)||mc.ListReader.ai(h);b=super.merge(b,h,r,z);R&&this.T7();return b}lHi(b,h){this.csk(b,h)}csk(b,h){b=this.hd.kff(b);const r=this.hd.kff(h);-1!==b&&-1!==r&&(b-=r,0<b?this.eRb.value.KDc(h,b):0>b&&this.eRb.value.rOa(h,b,0))}ZNi(b){this.hd.jD(b);this.leaveList(b);b.Eg();xg.a.instance.J(3)&&this.T7()}jao(b,h,r,z){var R=Nd.GraphIterator.$a(r);R=this.Qw(R);this.kao(R,b,h,r,z);vb.App.hhb&&!Ki.a.ae.RL&&this.mao(r,z)}Qw(b){this.hd.jD(b);const h=this.Cea(b.currentNode);
b.mc();return h}rMn(b,h){this.hd.jD(b);b.currentNode.setValue(yc.a.listID,h);h=this.Cea(b.currentNode);b.mc();return h}Cea(b){const h=new ww.a;if(xg.a.instance.J(3)){var r=this.hd.AL(b,!1,!0);h.listID=r.listId;h.level=r.listLevel}else h.listID=b.ia(yc.a.listID,0),h.level=b.ia(yc.a.listLevel,-1);h.Ema=b.ia(yc.a.Ema,!1);this.xr&&(r=this.FGd(b),h.bKn(r));h.hq=b.ia(Ki.a.ae.py,zi.a.Yi);h.yEc=b.ia(Ki.a.ae.hJ,zi.a.Yi);return h}HXb(b,h){b||wc.a.instance.Zb("CrashWhenApplyingList",{["Reason"]:"ListNodeIsNull"});
h||wc.a.instance.Zb("CrashWhenApplyingList",{["Reason"]:"RefInfoIsNull"});b.setValue(yc.a.listID,h.listID);b.setValue(yc.a.listLevel,h.level);h.Ema&&b.setValue(yc.a.Ema,!0)}Fhj(b){this.Am.W1(b);b=Go.qh.ju(b);let h=b.ia(yc.a.vp,null);h=h?Array.clone(h):[];b.setValue(yc.a.vp,h);this.Am.CCb()}S8i(b){switch(b){case 0:return 0;case 1:return 1;case 2:return 2;case 3:return 3;case 4:return 4;case 5:return 5;default:return 0}}Jxl(b){b=b.view;if(!b.Cb||!b.Cb.hb)return null;b=nw.OutlineElementGeneralizer.$ka(b.Cb.hb,
!1);if(1!==b.length)return null;b=Nd.GraphIterator.$a(b.getContext(0).node);if(!mc.ListReader.ai(b))if(14===b.Xd().type){const h=this.Am.FQl(b.currentNode);h&&b.set(h)}else ud.b(589177753,393,15,"Encountered an OE of non list type."),b.mc();b.vd();return b}yLk(b,h,r,z){const R=b.YG(),ba=new ww.a;ba.listID=this.yuh(b);this.K6?(ba.WRd=Ki.a.ae.PT?this.zuh(b):this.quh(b),this.MKi(b,ba.listID,ba.WRd)):this.OKi(b,ba.listID);ba.RZi(h.propertySet,this.IQc(r));this.TAd(b);r=this.ITh(b,h);for(let Wa=0;9>Wa;Wa++){const ub=
new ix.a;R.zd.Ku(ub);this.NKi(b,this.K6?E.a.nil:ub.id,this.K6?ub.id:E.a.nil);this.h2j(ub,h.sr,Wa);this.P8g(ub,r,Wa);var ta=z.JEb[Wa];ta=6===ta?fq.a.HP(1,1):fq.a.HP(0,ta);ta.Cma&&ub.setValue(We.a.U2,ta.Cma);h.Tz!==zi.a.Yi&&Wa===ba.level&&ub.setValue(We.a.kX,h.Tz);z.MAa&&z.MAa[Wa]&&ub.setValue(We.a.font,z.MAa[Wa]);ta=z.KQc[Wa];v.ULS.shipAssertTag(22127636,338,!!ta);ub.setValue(yc.a.Ur,ta);ub.setValue(yc.a.jaa,z.eRd[Wa]);iv.a.L7d(z.O3,ub)}return ba}xLk(b,h,r){const z=b.YG(),R=new ww.a;R.listID=this.yuh(b);
this.K6?(R.WRd=Ki.a.ae.PT?this.zuh(b):this.quh(b),this.MKi(b,R.listID,R.WRd)):this.OKi(b,R.listID);R.RZi(h.propertySet,this.IQc(r));if(!h.listStyle)switch(R.level%3){case 0:h.t7(h.listType,1);break;case 1:h.t7(h.listType,2);break;case 2:h.t7(h.listType,3)}this.TAd(b);r=this.ITh(b,h);for(let ba=0;9>ba;ba++){const ta=new ix.a;z.zd.Ku(ta);this.NKi(b,this.K6?E.a.nil:ta.id,this.K6?ta.id:E.a.nil);this.g2j(ta,h.sr,ba);this.P8g(ta,r,ba);this.xr&&(2===ba%3&&h.sr?ta.setValue(yc.a.jaa,"right"):ta.setValue(yc.a.jaa,
"left"));ba===R.level&&(h.Cma&&ta.setValue(We.a.U2,h.Cma),h.Tz!==zi.a.Yi&&ta.setValue(We.a.kX,h.Tz),this.xr&&(h.sr?this.XZi(h,ta,ba):(Go.UZi(h,ta),Go.WZi(h,ta)),Go.VZi(h,ta)),bk.a.pOc&&h.X1b&&ta.eI(h.propertySet,yc.a.listID,yc.a.listLevel))}return R}XZi(b,h,r){b.pma?(b=b.levelText,b=B.a.replaceAll(b,"%1","%"+(r+1))):b=b.aNc||b.Nea?b.levelText:"%"+(r+1)+".";v.ULS.shipAssertTag(22127638,338,!!b);h.setValue(yc.a.Ur,b)}T3i(b,h,r,z){if(b.aNc)return!1;if(1===b.vr)return z;if(z)return!0;if(h){z=b.listType===
h.listType;const R=!b.listStyle&&b.Tz===zi.a.Yi;let ba=b.listStyle===h.listStyle&&b.Tz===h.Tz;this.xr&&(b=(!b.pma||this.JVf(h,b))&&!r,ba=ba&&b);return z&&(R||ba)}return!1}TAd(b){this.qPb||(this.qPb=b.ia(yc.a.hRk,null));this.E9c||(this.E9c=b.ia(yc.a.gRk,null));this.Tlc||(this.Tlc=b.ia(yc.a.iRk,null))}IQc(b){720>b&&(b=0);b=Math.floor(b/720);0>b&&(b=0);8<b&&(b=8);return b}OKi(b,h){const r=b.ia(yc.a.$s,null),z=r?r.length:0,R=Array(z+1);let ba=0;for(;ba<z;ba++)R[ba]=r[ba];R[ba]=h;b.setValue(yc.a.$s,R);
this.Am.CCb()}MKi(b,h,r){this.qOe(yc.a.$s,b,h);if(Ki.a.ae.PT){this.qOe(Li.a.i$b,b,r);var z=this.Am.BGd(b);z.add(h,r);b.setValue(Li.a.uQ,jv.b(vA.a.xgc(z)))}else this.qOe(yc.a.n9,b,r),z=this.Am.AGd(b),z.add(h,r),b.setValue(yc.a.tQ,jv.b(vA.a.xgc(z)))}NKi(b,h,r){this.K6?(this.D8g(yc.a.vp,b,r),this.D8g(yc.a.c3,b,h)):(r=(r=b.ia(yc.a.vp,null))?Array.clone(r):[],r.push(h),b.setValue(yc.a.vp,r),this.Am.CCb())}qOe(b,h,r){const z=h.ia(b,null),R=z?z.length:0,ba=Array(R+1);let ta=0;for(;ta<R;ta++)ba[ta]=z[ta];
ba[ta]=r;h.setValue(b,ba)}D8g(b,h,r){let z=h.ia(b,null);z=z?Array.clone(z):[];z.push(r);h.setValue(b,z)}g2j(b,h,r){var z=r%3+1;if(mc.ListReader.rr){const R=h?this.Tlc:this.E9c;R&&r<R.length?b.setValue(yc.a.ht,R[r]):b.setValue(yc.a.ht,360)}z=mc.ListReader.sZ?fq.a.HP(h?0:1,this.S8i(z),null,0,r):fq.a.HP(h?0:1,this.S8i(z));b.Cs(z.propertySet);b.setValue(yc.a.NSe,h?-1:-2);this.xr&&(h?b.setValue(yc.a.Ur,"%"+(r+1)+"."):(b.setValue(We.a.font,this.vpl(r)),b.setValue(yc.a.Ur,String.fromCharCode(this.lpl(r)))),
iv.a.Ydc(2,b))}h2j(b,h,r){if(mc.ListReader.rr){const z=h?this.Tlc:this.E9c;z&&r<z.length?b.setValue(yc.a.ht,z[r]):b.setValue(yc.a.ht,360)}b.setValue(yc.a.NSe,h?-1:-2);iv.a.Ydc(1,b)}lpl(b){switch(b%3){case 0:return 61623;case 1:return 111;case 2:return 61607;default:return 61623}}vpl(b){switch(b%3){case 0:return"Symbol";case 1:return"Courier New";case 2:return"Wingdings";default:return"Symbol"}}yuh(b){if(this.K6)this.I6<zi.a.WQc&&this.Am.W1(b),this.I6=this.FUh(this.$s,this.I6,zi.a.WQc);else{if(this.I6<
zi.a.WQc&&(this.Am.W1(b),this.$s&&this.vp)){b=this.$s.length;for(let h=0;h<b;h++)this.$s[h]>=this.I6&&(this.I6=this.$s[h])}this.I6+=1}return this.I6}quh(b){this.$Ma<zi.a.Qpd&&this.Am.W1(b);return this.$Ma=this.FUh(this.n9,this.$Ma,zi.a.Qpd)}zuh(b){var h;this.Am.W1(b);do b=Math.floor(Math.random()*(Go.UFm-Go.vri))+Go.vri;while(null===(h=this.Am.SFb)||void 0===h?0:h.includes(b));return b}FUh(b,h,r){if(h<r&&b){r=b.length;for(let z=0;z<r;z++)b[z]>h&&(h=b[z])}h++;return h}nTf(b,h,r){Go.ZOc||this.z$e(b,
h,r,Object(u.a)(this,this.N0c,"siblingMatchesListAndLevel"),Object(u.a)(this,this.qZn,"siblingRenumberSimple"))}Ttn(b,h,r,z=!1){this.z$e(b,h,r,Object(u.a)(this,this.N0c,"siblingMatchesListAndLevel"),Object(u.a)(this,this.L5i,"siblingRenumberAndUpdateSublistsDelta"),null,z)}Stn(b,h,r){this.fdl(b,h,r,Object(u.a)(this,this.N0c,"siblingMatchesListAndLevel"),Object(u.a)(this,this.K5i,"siblingRenumberAndUpdateSublists"))}mTf(b,h,r){const z=wc.a.instance.oo(Fb.a.mTf);1>Math.abs(r)&&wc.a.instance.Zb("PossiblyIncorrectListPromoteDemote",
{["Reason"]:"DepthIsIncorrect"});(h<cp.a.L9e||h>cp.a.zRd)&&wc.a.instance.Zb("PossiblyIncorrectListPromoteDemote",{["Reason"]:"LevelHasInvalidRange"});(h+r<cp.a.L9e||h+r>cp.a.zRd)&&wc.a.instance.Zb("PossiblyIncorrectListPromoteDemote",{["Reason"]:"Level+DepthHasInvalidRange"});const R={};let ba=null;const ta=this.Qw(b);const Wa=b.currentNode,ub=ta.listID,Ib=h+r;let $b,fc=zi.a.Yi,Kc=!0,ed=!0,Jd=!1;const ge=Array(9);let qe=!1,Ve=!1;var Bd=new ww.a;Bd.listID=ta.listID;Bd.level=ta.level+r;Bd=this.Am.Bea(b.currentNode,
Bd);var he=this.hd.Hs(b);Bd=Bd.sr;const we=he.sr,hg=this.xr&&(Bd||we);if(we||Bd){var Pf=new ww.a;Pf.listID=ta.listID;Pf.level=h;R[h.toString()]=this.GL(Wa,Pf);he=R[h.toString()].m_;Pf.level=Ib;R[Ib.toString()]=this.GL(Wa,Pf);$b=R[Ib.toString()].m_;for(var Ej=0;9>Ej;Ej++)ge[Ej]=!1;Ej=new Nd.GraphIterator;Ej.fd(b);Pf=Ej.nwa();var pn=Cn.a.Kr(Ej,Pf);for(pn.moveNext();pn.moveNext();){Ej=pn.iterator;var Ol=void 0;let $v;if(Ej.aq(4)&&(Pf=this.Qw(Ej),Pf.listID===ub)){var qt=this.hd.Hs(Ej);var rt=qt.sr;Pf.level<=
he&&(Kc=!1);Pf.level<=$b&&(ed=!1);if(!Kc&&!ed)break;$v=Pf.level.toString();R[$v]||(R[$v]=this.GL(Wa,Pf));qt=R[$v];this.Xuo(qt,ge)||(qt.m_>=h?(ba||(ba=this.DYe(ta,b,R)),Ol=zi.a.Yi,ba[$v]?Ol=!this.xr||rt?ba[$v]+1:zi.a.Yi:Pf.level===Ib&&(Ol=!this.xr||rt?qt.startAt:zi.a.Yi),Ol!==zi.a.Yi?(Pf.level!==Ib||Jd||(fc=Ol,Jd=!0,this.hd.jD(Ej),Ej.mc(),Ol++),this.wwb(Ej,Ol),ba[$v]=Ol):hg&&this.i8f(Ej,Pf)):qt.m_>=Ib?(ba||(ba=this.DYe(ta,b,R)),Ol=ge[Pf.level]?!this.xr||rt?ba[$v]+1:zi.a.Yi:!this.xr||rt?qt.startAt:
zi.a.Yi,this.xr&&Ol===zi.a.Yi?hg&&this.i8f(Ej,Pf):this.wwb(Ej,Ol),ba[$v]=Ol):Pf.level===h&&we||Pf.level===Ib&&Bd?(this.hd.jD(Ej),Ol=Ej.currentNode,Ej.mc(),Ol=Ol.getValue(Ki.a.ae.py),rt=Ol===(qt.startAt===zi.a.Yi?1:qt.startAt)+1,Pf.level===h?!(0>r)&&rt||qe?qe=!0:Ol--:(Ve?Ol--:0>r&&rt&&this.lrf(Ej,qt,null)&&(Ol--,Ve=!0),Jd||(fc=Ol,Jd=!0),Ol++),this.wwb(Ej,Ol)):Pf.level!==h&&Pf.level!==Ib||!hg||this.i8f(Ej,Pf),ge[Pf.level]=!0)}}Bd&&!Jd&&(h=R[Ib.toString()],ta.level=Ib,fc=this.kQc(ta,b,h).Jfa,fc===zi.a.Yi?
fc=h.startAt:fc++);Bd&&this.wwb(b,fc)}z.end()}Zeh(){this.T7()}T7(){var b=null,h,r;if(xg.a.instance.J(3)){var z=new Nd.GraphIterator;if(b)if(8===b.type)z.set(b);else{v.ULS.sendTraceTag(592535635,393,15,"Unable to update lists number as cannot navigate to page content node.");return}else z.set(vb.App.xa.jb.Yc),Go.qh.X6f(z),b=Go.qh.ju(z.currentNode);if(z.Bb(7)||z.kd(7)){z=Cn.a.Kr(z,z.origin);var R=new Gu({hd:this.Am,pageContentNode:b,SIb:null,Bjj:!1});for(b=new Gu({hd:this.Am,pageContentNode:b,SIb:null,
Bjj:!1});z.moveNext();){var ba=z.iterator;if(!ba.aq(4)&&!ba.aq(31))continue;this.hd.FFb(ba);const Wa=ba.currentNode;ba.mc();if(!Wa){v.ULS.sendTraceTag(575813713,393,15,"List Node comes out to be null while updating numbering. Iterator Valid {0}",ba.Rd);continue}if(!this.K6&&63!==Wa.type&&this.hd.VN(Wa).listType)continue;var ta=this.hd.AL(Wa,!1,!1);if(this.K6&&ta&&this.hd.cPd(ta.listId)){v.ULS.sendTraceTag(592535636,393,50,"Skipping updating list numbers for this list id {0}",ta.listId);continue}const ub=
Object(la.a)(dd.AParagraphNode,ag.OutlineElementNavigator.De(ba,!0));ub&&(ub.qa?(null==ub.qa.last&&v.ULS.sendTraceTag(540374985,393,15,"Unexpected : Encountered last of para character properties null."),ba.mc(),this.K6&&this.Am.W1(ba.currentNode),12===ub.type&&(ub.hj&&ub.NA.hasProperty(yc.a.listID)||null===(h=ub.qa.last)||void 0===h||!h.Zi)&&((ba=this.hd.AL(Wa,!0,!0))?this.ZZi(Wa,b,Ki.a.ae.Dic,ba):v.ULS.shipAssertTag(24475424,376,!0,"The previous number list ID is not found! List Node Type={0}",Wa.type)),
!ta||null!==(r=ub.qa.last)&&void 0!==r&&r.ei||!this.ZZi(Wa,R,Ki.a.ae.py,ta)||(ta=Wa.getValue(Ki.a.ae.py),this.K6&&this.hd.VN(Wa).listType||Wa.setValue(Ki.a.ae.hJ,ta))):v.ULS.shipAssertTag(24975004,376,!0,"The paragraph node has null CharacterProperties! Skipping."))}}else v.ULS.shipAssertTag(593234060,376,7===z.Qe,"Couldnt reach to page manifest node")}}ZZi(b,h,r,z){r||v.ULS.shipAssertTag(571757918,393,!!r,"Prop definition is null");h=h.TDf(z.listId,z.listLevel,this.Ac);z=-1;b.hasProperty(r)&&(z=
b.getValue(r));return h===z||this.K6&&63!==b.type&&this.hd.VN(b).listType&&(!Ki.a.ae.jfa||r!==Ki.a.ae.Dic||1!==this.hd.VN(b).listType)?!1:(b.setValue(r,h),!0)}i8f(b,h){this.hd.jD(b);const r=b.currentNode;b.mc();r&&this.hd.V$(r)&&this.B$e(b,h,Object(u.a)(this,this.jzf,"matchesListId"),Object(u.a)(this,this.b3f,"sublistsUpdateListItem"))}lrf(b,h,r){let z=!1,R=!0,ba=0;const ta=this.Qw(b),Wa=b.currentNode;let ub=null;b=b.nwa();b=Cn.a.Wp(b);for(b.Um(gu.a.d0a,null);b.moveNext();){const Ib=b.iterator.currentNode;
if(Ib===Wa)break;if(!mc.ListReader.w2(Ib))continue;const $b=this.Qw(b.iterator);$b.listID===ta.listID&&($b.level>ta.level?(z=!0,ub=Ib,ba++):$b.level===ta.level?(R=!1,ub=null,ba=0):$b.level<=h.m_&&(R=!0,ub=null,ba=0))}return z&&R&&(!r||1===ba&&ub===r)}Xuo(b,h){for(b=b.m_;0<=b;b--)if(h[b])return!0;return!1}wwb(b,h){this.hd.jD(b);const r=b.currentNode;b.mc();const z=this.Qw(b);z&&this.Am.R8b(r,z.listID,z.level)?this.Stn(b.currentNode,z,h):Go.ZOc||(r.setValue(Ki.a.ae.py,h),r.setValue(Ki.a.ae.hJ,h))}Utn(b,
h,r){const z={};let R=null;const ba=new Nd.GraphIterator;const ta=b.hq===h.startAt;let Wa=!1;var ub=new Nd.GraphIterator;ub.fd(r);var Ib=r.nwa();Ib=Cn.a.Kr(ub,Ib);Ib.Um(gu.a.d0a,null);Ib.moveNext();let $b=!1;for(;Ib.moveNext();)if(ba.fd(Ib.iterator),ba.aq(4)){var fc=this.Qw(ba);if(fc.listID===b.listID)if(fc.level>b.level)Wa=!0,ub=fc.level.toString(),z[ub]||(z[ub]=this.GL(r.currentNode,fc)),fc=z[ub].m_,fc===b.level&&(R||(R=this.DYe(b,r,z)),R[ub]&&(fc=R[ub]+1,this.wwb(ba,fc),R[ub]=fc));else if(fc.level===
b.level||fc.level<=h.m_){$b=!0;break}}return!$b||ta&&Wa?null:ba}Rtn(b){mc.ListReader.ai(b)||wc.a.instance.Zb("PossiblyIncorrectListRenumber",{["Reason"]:Ov.a.uyb});const h=this.Qw(b);var r=this.GL(b.currentNode,h);const z=b.Rb(4);z.removeProperty(Ki.a.ae.Dic);b.mc();const R=this.IGc(b,h,Object(u.a)(this,this.a3f,"sublistsEnsureSameList"),Object(u.a)(this,this.d9i,"sublistsUpdateLevel"));if(this.hd.Hs(b).sr){var ba=null;R&&(ba=this.Qw(R));ba&&ba.listID===h.listID&&ba.level===h.level?r=this.hd.Hs(R).hq:
(ba=this.kQc(h,b,r),r=ba.Jfa===zi.a.Yi?r.startAt:ba.Jfa+1);r!==zi.a.Yi&&(z.setValue(Ki.a.ae.py,r),z.setValue(Ki.a.ae.hJ,r));R&&this.nTf(R.currentNode,h,1)}b.f4b()&&mc.ListReader.ai(b)&&(b=this.hd.Hs(b),b.sr&&(b.Yda=b.hq))}get u3i(){return this.xr}MTh(b){const h=this.hd.Hs(b);if(this.xr){h.X1b=!0;this.hd.jD(b);const r=b.currentNode.ia(yc.a.listID,0);h.propertySet.setValue(yc.a.listID,r);b.kd(11)}return h}DYe(b,h,r){const z={},R=new Nd.GraphIterator,ba=h.currentNode;var ta=h.nwa();const Wa=Cn.a.Wp(ta);
for(Wa.Um(gu.a.d0a,null);Wa.moveNext();){R.fd(Wa.iterator);if(R.currentNode===ba)break;if(R.aq(4)&&(ta=this.Qw(R),ta.listID===b.listID)){if(ta.level>b.level){this.hd.jD(R);var ub=R.currentNode;R.mc();z[ta.level.toString()]=ub.ia(Ki.a.ae.py,zi.a.Yi)}for(ub=ta.level;ub<=cp.a.zRd;ub++){const Ib=ub.toString();z[Ib]&&(r[Ib]||(r[Ib]=this.GL(h.currentNode,ta)),r[Ib].m_>=ta.level&&delete z[Ib])}}}return z}kQc(b,h,r){const z=new Nd.GraphIterator,R=h.currentNode;let ba;var ta=zi.a.Yi;let Wa=!1,ub=!1,Ib=!1,
$b=null;var fc=h.nwa();fc=Cn.a.Wp(fc);for(fc.Um(gu.a.d0a,null);fc.moveNext();){z.fd(fc.iterator);if(z.currentNode===R)break;Wa=!1;z.aq(4)&&(ba=this.Qw(z),ba.listID===b.listID&&(ba.level===b.level?(this.hd.jD(z),ta=z.currentNode,z.mc(),ta=ta.ia(Ki.a.ae.py,zi.a.Yi),Wa=!0,$b=z.Ahc(1),ub=!0):ba.level>b.level?Ib=!0:ba.level<=r.m_&&(ta=zi.a.Yi,Ib=ub=!1)))}!ub&&Ib&&(ta=r.startAt);Wa&&(Wa=h.Ahc(1)===$b);b=new fu;b.Jfa=ta;b.hlj=Wa;return b}ZPi(b,h=!1,r=0){const z=this.Cea(b),R=this.GL(b,z),ba=this.Am.Bea(b,
z);var ta=new Nd.GraphIterator;const Wa=ba.sr;let ub=R.startAt,Ib=!1,$b=!1;v.ULS.shipAssertTag(22127639,338,ba.Nea,"Info does not have a level Text. ListNode.LevelText = {0}",b.ia(yc.a.Ur,null));const fc=ba.listStyle;ta.set(b);if(ta.vd()&&(b=ta.dPa()))for(b=Cn.a.Wp(b),b.Um(gu.a.d0a,z);b.moveNext();){ta=b.iterator.currentNode;if(!mc.ListReader.w2(ta))continue;var Kc=this.Qw(b.iterator);h&&Kc.listID===r&&(Kc=this.rMn(b.iterator,z.listID));if(Kc.listID!==z.listID)continue;const ed=b.iterator.Rb(4);ed&&
b.iterator.mc();Kc.level>z.level?(this.Am.R8b(ed,z.listID,Kc.level)&&this.Gof(ta,ed),$b=!0):(Kc.level<=R.m_?(ub=R.startAt,$b=Ib=!1):(Kc=this.rsi(b,fc),this.xr&&Kc.currentNode.setValue(yc.a.Ur,ba.ORd),{MVi:Ib,Jfa:ub}=this.aQi(Wa,$b,Ib,Kc,ub,ta)),Go.n$h(b))}}Gof(b,h){v.ULS.shipAssertTag(22819227,338,!!b&&!!h);mc.ListReader.Kfa?h.setValue(Ec.a.Iwf,E.a.create().toString()):b.setValue(Ec.a.Iwf,E.a.create().toString())}Ptn(b){if(!Ki.a.ae.kgb){var h=this.Cea(b),r;this.GL(b,h);var z=this.Am.Bea(b,h),R=z.sr,
ba=Array(10),ta=Array(10),Wa=null;v.ULS.shipAssertTag(22127640,338,z.Nea,"Info does not have a level Text. ListNode.LevelText = {0}",b.ia(yc.a.Ur,null));var ub=z.listStyle;var Ib=new Nd.GraphIterator;Ib.set(b);if(Ib.vd()&&(Ib=Ib.dPa()))for(Ib=Cn.a.Wp(Ib),Ib.Um(gu.a.d0a,h);Ib.moveNext();){var $b=Ib.iterator.currentNode;if(!mc.ListReader.w2($b))continue;const fc=this.Qw(Ib.iterator);if(fc.listID!==h.listID)continue;(r=Ib.iterator.Rb(4))&&Ib.iterator.mc();const Kc=fc.level;Wa=Wa?Wa.level:-1;h=this.Cea(r);
r=this.GL(r,h);this.Gof($b,b);if(Wa<Kc||void 0===ba[Kc]||null===ba[Kc])ba[Kc]=r.startAt,ta[Kc]=!1;r=this.rsi(Ib,ub);r.currentNode.setValue(yc.a.Ur,z.ORd);({MVi:ta[void 0],Jfa:ba[void 0]}=this.aQi(R,Wa>Kc,ta[Kc],r,ba[Kc],$b));Wa=fc;Go.n$h(Ib)}}}rsi(b,h){b=b.iterator;this.hd.jD(b);Ki.a.ae.kgb||this.WLn(b.currentNode,h);return b}aQi(b,h,r,z,R,ba){b?(h&&!r&&R++,ag.OutlineElementNavigator.Zd(z),this.wwb(z,R),R++,r=!0,mc.ListReader.rr&&(z.Rb(2),wA.a.T6b(z.currentNode)&&z.currentNode.gk(4,!0))):(z.currentNode.removeProperty(Ki.a.ae.py),
ag.OutlineElementNavigator.Zd(z));ba.gk(4,!0);(b=z.ap(16))&&b.gk(8,!0);return{MVi:r,Jfa:R}}WLn(b,h){b.setValue(yc.a.listStyle,h)}GL(b,h){const r=wc.a.instance.oo(Fb.a.GL),z=new qB;(b=this.Am.Pw(b,h.listID,h.level))?(z.m_=b.ia(yc.a.QYc,h.level-1),z.startAt=b.ia(We.a.kX,1)):wc.a.instance.Zb("PossiblyIncorrectListRestartValue",{["Reason"]:"listPropsIsNull"});r.end();return z}uNk(b){const h=bp.a.instance.createInstance(1074135151);b.Sf(h,31)}kao(b,h,r,z,R){const ba=this.createList(h);h.mc();this.HXb(ba,
b);h=this.Am.Bea(h.currentNode,b);h.listType||(ba.setValue(Ki.a.ae.py,b.hq),ba.setValue(Ki.a.ae.hJ,b.yEc),this.e4d(ba,b,r?z:R,1));switch(h.listType){case 0:r="Numbering";break;case 1:r="Bullet";break;default:r="Invalid List Type"}t.AFrameworkApplication.ya.processAction(Fb.a.joinList,2);v.ULS.sendTraceTag(38544079,393,50,"List Actions : Join List - {0}",r);mc.ListReader.sZ&&(ba.setValue(yc.a.listID,b.listID),ba.setValue(yc.a.listLevel,b.level))}mao(b,h){b=Nd.GraphIterator.$a(b).Rb(4);h=Nd.GraphIterator.$a(h).Rb(4);
b.hasProperty(We.a.fontColor)&&h.setValue(We.a.fontColor,b.getValue(We.a.fontColor));b.hasProperty(We.a.fontSize)&&h.setValue(We.a.fontSize,b.getValue(We.a.fontSize));b.hasProperty(We.a.font)&&h.setValue(We.a.font,b.getValue(We.a.font));b.hasProperty(yc.a.we)&&h.setValue(yc.a.we,b.getValue(yc.a.we));b.hasProperty(We.a.bold)&&h.setValue(We.a.bold,b.getValue(We.a.bold));b.hasProperty(We.a.italic)&&h.setValue(We.a.italic,b.getValue(We.a.italic));b.hasProperty(We.a.superscript)&&h.setValue(We.a.superscript,
b.getValue(We.a.superscript));b.hasProperty(We.a.subscript)&&h.setValue(We.a.subscript,b.getValue(We.a.subscript));b.hasProperty(We.a.strikethrough)&&h.setValue(We.a.strikethrough,b.getValue(We.a.strikethrough))}TNi(b){if(xg.a.instance.J(10)){var h=this.oc.yo(b);h?this.oc.rf(h)===ki.StyleReader.wordStyleIdListParagraph&&(h=this.oc.Qx(b),this.H7.oM(h.xh(ki.StyleReader.wordStyleIdNormal),b,!0,!1,!1,this.xUa&&t.AFrameworkApplication.K.$("WordEditorSkipTrackingChangeForList"))):v.ULS.shipAssertTag(8271188,
315,!1)}}QLn(b){if(xg.a.instance.J(10)){if(this.oc.rf(this.oc.yo(b))===ki.StyleReader.wordStyleIdNormal){const h=this.oc.Qx(b);this.H7.oM(h.xh(ki.StyleReader.wordStyleIdListParagraph),b,!0,!0)}b.Qg(yc.a.fe,yc.a.JQ,yc.a.ZB,yc.a.e_,yc.a.ht,yc.a.aga);b.setValue(yc.a.gOa,0)}}Ssk(b,h){const r=b.getValue(yc.a.listID),z=b.getValue(yc.a.listLevel);for(let ba=0;9>ba;ba++){const ta=this.Am.Pw(b,r,ba);if(!ta)return wc.a.instance.Zb("PossiblyIncorrectListStyle",{["Reason"]:"ListDefIsNull"}),null;var R=h.JEb[ba];
R=6===R?fq.a.HP(1,1):fq.a.HP(0,R);R.Cma&&ta.setValue(We.a.U2,R.Cma);ta.hasProperty(We.a.font)&&ta.removeProperty(We.a.font);h.MAa&&h.MAa[ba]&&ta.setValue(We.a.font,h.MAa[ba]);R=h.KQc[ba];v.ULS.shipAssertTag(22127641,338,!!R);ta.setValue(yc.a.Ur,R);ta.setValue(yc.a.vr,iv.a.U9b);iv.a.L7d(h.O3,ta);ta.setValue(yc.a.jaa,h.eRd[ba]);ta.Qg(yc.a.QYc,We.a.kX);this.Fhj(b)}this.Ptn(b);b=new ww.a;b.listID=r;b.level=z;return b}flh(b,h,r,z=null){if(this.xr&&z)return this.Ssk(b,z);z=b.getValue(yc.a.listID);const R=
b.getValue(yc.a.listLevel),ba=this.Am.Pw(b,z,R);if(!ba)return wc.a.instance.Zb("PossiblyIncorrectListStyle",{["Reason"]:"ListDefIsNull"}),h&&v.ULS.sendTraceTag(588022420,393,15,"List def is null for List Style {0}, List type {1}, ListId {2} and level {3}",h.listStyle,h.listType,z,R),null;bk.a.pOc&&h.X1b&&(ba instanceof tA.APropertySet?ba.eI(h.propertySet,yc.a.listID,yc.a.listLevel):v.ULS.sendTraceTag(527991759,393,15,"ListDefintion was not an instance of APropertySet, it is an instance of {0}",null===
ba||void 0===ba?void 0:ba.constructor.name));var ta=ba.ia(yc.a.vr,null);ta&&ta===iv.a.U9b&&this.Qsk(b,z);if(!h.listStyle){ta=0;if(-1!==r){for(ta+=R-r;0>ta;)ta+=3;ta%=3}switch(ta){default:r=1;break;case 1:r=2;break;case 2:r=3}h.t7(h.listType,r)}h.Cma&&ba.setValue(We.a.U2,h.Cma);this.xr&&(h.sr?(this.XZi(h,ba,R),ba.hasProperty(We.a.font)&&ba.removeProperty(We.a.font)):(Go.UZi(h,ba),Go.WZi(h,ba)),Go.VZi(h,ba));ba.Qg(yc.a.QYc,We.a.kX,yc.a.NOc);this.Fhj(b);Ki.a.ae.kgb||this.ZPi(b);b=new ww.a;b.listID=z;
b.level=R;return b}Qsk(b,h){let r;for(let z=0;9>z;z++){r=this.Am.Pw(b,h,z);if(!r){v.ULS.sendTraceTag(588022421,393,15,"List def is null for List id {0}, List level {1}",h,z);break}r.setValue(yc.a.vr,iv.a.CLd);r.removeProperty(ui.a.khb)}}a7d(b,h){const r=wc.a.instance.oo(Fb.a.a7d);this.eRb.value||wc.a.instance.Zb("PossibleIncorrectListIndentation",{["Reason"]:"IOutlineElementIndentationEditorIsNull"});this.ATa?(r.properties.Z("PendingListInfo","true"),mc.ListReader.ai(b)&&(r.properties.Z("RemoveCurrentListInfo",
"true"),this.xUa=!0,this.uJa(b,null,!0,!1,-1),this.eRb.value.rOa(b,-1,0),this.xUa=!1),this.GXb(b,this.ATa,!1,!0,-1,!1,null,mc.ListReader.sZ),this.ATa=null):h||(r.properties.Z("CurrentlyUnderPastedList","true"),this.uJa(b,null,!1,!1,-1));r.end()}uYf(b,h,r,z){const R=wc.a.instance.oo(Fb.a.uYf);if(mc.ListReader.ai(b)&&vg.OutlineElementReader.isEmpty(b,!1))this.eRb.value.qVe(b,-1)?this.eRb.value.rOa(b,-1,0):this.uJa(b,null,!1,!1,-1);else{const ba=!r.cpBegin,ta=r.cpBegin===ie.ParagraphReader.textLength(z),
Wa=xg.a.instance.J(4)&&vb.App.ud.Mp;let ub=!0;Wa&&ba&&!ta?(ub=!1,z=new Nd.GraphIterator,z.fd(b),z.vd(),this.Kh.eD(z,!0,!1)):z=this.Kh.xta(b);this.Kh.mba(b,z,r,!1,!0,ub,!1,h);!Wa||ba||ta||(h=Go.Tg.ucf(r),vb.App.ud.Lq.CG(h));this.xUa||(ag.OutlineElementNavigator.De(b),h=b.currentNode,ag.OutlineElementNavigator.Zd(b),mc.ListReader.ai(b)&&h.hj&&!h.NA.hasProperty(yc.a.listID)&&(ag.OutlineElementNavigator.De(z),b=z.currentNode,z=new ix.a,b.Lc.Ku(z),this.Ym.nM(b,z,this.Hd.ng)),this.T7())}R.end()}W7d(b,h){var r;
if(mc.ListReader.ai(b))return!1;b.Rb(2);var z=Le.a.Rgk;const R=[!0,!1].map(ba=>ie.ParagraphReader.Vg(b.currentNode,ba,void 0,!1));b.mc();for(let ba=0;ba<R.length;ba++){const ta=R[ba];if(ta&&!mc.ListReader.dma(ta))for(const Wa of z)if(Wa.test(ta.characterData))return z=null===(r=Wa.exec(ta.characterData))||void 0===r?void 0:r[0],this.uin(h,ba?"nextPara":"prevPara",z),!1}return!0}uin(b,h,r){const z=new Map;z.set("CurrentAutoListPreventedAutoListText",b);z.set("UndoAutoListPreferenceFoundIn",h);z.set("UndoAutoListPreferenceAutoListText",
r);Ca.Health.instance.recordKpiUsage(zi.a.gQc.pon,0,zi.a.EB,z)}xVn(b,h){return b&&h}fSf(b){for(let h=0;h<b.count;h++){const r=Nd.GraphIterator.$a(b.J(h));r.qo();this.RDa(r)}b.clear()}$Pi(b){if(mc.ListReader.w2(b)){if(!Go.ZOc){const h=new Nd.GraphIterator;h.set(b);h.vd();this.Rtn(h)}this.T7()}}eQf(b,h){b=new Nd.GraphIterator;b.set(h);b.vd();ag.OutlineElementNavigator.Zd(b);b.zeb(h)||wc.a.instance.Zb("PossibleLossOfDirectFormatting",{["Reason"]:"OeDoesNotContainParagraph"});this.uJa(b,null,!0,!1,-1);
return super.eQf(b,h)}PZi(b,h,r){this.Kh.Hva(b,h,r,!0)}TZi(b){b.t7(1,1)}csd(b,h){const r=wc.a.instance.oo(Fb.a.rdk);if(this.oc.CI(h.$h())){if(mc.ListReader.ai(b)&&this.GXb(b,null,!0,!1,-1),h=this.Am.UTh(h)){r.properties.Z("EarlyReturn","False");this.Am.Bea(b.currentNode,h);var z=dp.J9k(this,b,h),R=this.createList(b);b.mc();if(z)this.joinList(R,z,!0);else{if(z=this.IGc(b,h,Object(u.a)(this,this.a3f,"sublistsEnsureSameList"),Object(u.a)(this,this.d9i,"sublistsUpdateLevel"))){const ba=this.Qw(z);if(ba.listID===
h.listID&&ba.level<h.level&&this.hd.Hs(z).sr){const ta=this.GL(z.currentNode,ba);ba.hq===(ta.startAt===zi.a.Yi?1:ta.startAt)&&(ba.yEc=ba.hq,this.e4d(R,ba,z.currentNode,1))}}z=this.GL(R,h);b=this.kQc(h,b,z);b=b.Jfa!==zi.a.Yi?b.Jfa+1:z.startAt===zi.a.Yi?1:z.startAt;this.HXb(R,h);R.setValue(Ki.a.ae.py,b);R.setValue(Ki.a.ae.hJ,b)}R.setValue(yc.a.Ema,!0);r.end()}}else wc.a.instance.Zb("PossiblyIncorrectListStyle",{["Reason"]:"StyleContainerNotValid"})}e4d(b,h,r,z,R=!1){this.Am.R8b(b,h.listID,h.level)?
this.Ttn(r,h,z,R):this.nTf(r,h,z)}$ch(b,h,r,z,R=null){b=this.xr&&R?this.yLk(b,r,z,R):this.xLk(b,r,z);this.HXb(h,b);r.listType||(z=r.Tz,z===zi.a.Yi&&(z=1),h.setValue(Ki.a.ae.py,z),h.setValue(Ki.a.ae.hJ,z));this.xr&&(r.Nea?(r=r.levelText,R||(r=r.replace("%1","%"+(b.level+1))),h.setValue(yc.a.Ur,r)):(v.ULS.sendTraceTag(22127642,338,15,"desiredInfo does not have a levelText. Replacing with an emtpy string."),h.setValue(yc.a.Ur,"")));return b}leaveList(b){const h=this.Cea(b.currentNode);var r=this.Am.Bea(b.currentNode,
h);const z=new Nd.GraphIterator;z.fd(b);z.mc();mc.ListReader.ai(z)||wc.a.instance.Zb("PossibleErrorInLeaveList",{["Reason"]:Ov.a.uyb});var R=this.GL(z.currentNode,h),ba=h.hq===R.startAt;mc.ListReader.Kfa&&Go.M7l(z);if(R=this.Utn(h,R,z)){const ta=this.hd.Hs(R);ta.Yda=ta.sr?ta.hq:zi.a.Yi}r.sr&&R&&this.e4d(b.currentNode,h,R.currentNode,-1);ba&&R&&(r=this.Qw(R),this.Am.Bea(R.currentNode,r).sr&&(ba=this.GL(R.currentNode,r),r.hq===(ba.startAt===zi.a.Yi?1:ba.startAt)+1&&this.lrf(R,ba,z.currentNode)&&this.e4d(b.currentNode,
h,R.currentNode,-1,!0)));!R&&this.Am.R8b(b.currentNode,h.listID,h.level)&&this.B$e(z,h,Object(u.a)(this,this.jzf,"matchesListId"),Object(u.a)(this,this.b3f,"sublistsUpdateListItem"))}joinList(b,h,r,z=null){let R=null,ba=null;if(b)if(22!==b.type&&63!==b.type)v.ULS.sendTraceTag(587851670,393,15,"Graph node {0} received is not list node : skipping join list action.",b.type);else{xg.a.instance.J(3)&&(R=this.Am.yYa(b),ba=R.Kz());(xg.a.instance.J(3)||Ki.a.ae.zDb)&&this.HXb(b,h.Xr);if(this.Am.Bea(b,h.Xr).sr){var ta=
new Nd.GraphIterator;ta.set(b);ta.vd();ta.mc();let Wa=null;Ki.a.ae.Kim&&z&&!z.nao&&(Wa=this.Am.VUh(ta.currentNode,h.Xr));const ub=this.ubl(ta,h,z);ta=this.lbl(ta,b,h,r,z,ub);this.qbl(h,r,z,ub,ta);Wa&&ub&&this.nTf(Wa,h.Xr,this.pom(ub,Wa)-(h.Xr.hq-1))}xg.a.instance.J(3)||Ki.a.ae.zDb||this.HXb(b,h.Xr);xg.a.instance.J(3)&&R&&ba&&!this.xUa&&(this.Ym.nM(R,ba,this.Hd.ng),this.T7())}else v.ULS.sendTraceTag(587747659,393,15,"List node received is null : skipping join list action.")}pom(b,h){let r=0;const z=
this.Qw(b),R=new Nd.GraphIterator;R.set(b.currentNode);R.vd();b=xi.a.Kr(R,R.nwa());for(b.Um(gu.a.d0a,null);b.moveNext();){if(!mc.ListReader.ai(R))continue;this.hd.jD(R);const ba=this.Cea(R.currentNode);R.mc();if(R.currentNode.id===h.id)break;ba.listID===z.listID&&ba.level===z.level&&r++}return r}ubl(b,h,r){if(h.bei)h=h.outlineElement;else{let z,R;r?(z=Object(u.a)(this,this.c9i,"sublistsEnsureSameListAsOriginal"),R=Object(u.a)(this,this.p$d,"sublistsUpdateId")):h.J5b?(z=Object(u.a)(this,this.a3f,"sublistsEnsureSameList"),
R=Object(u.a)(this,this.p$d,"sublistsUpdateId")):(z=Object(u.a)(this,this.P3n,"sublistsEnsureLevelHigherThanOrEqualTo"),R=Object(u.a)(this,this.Q3n,"sublistsUpdateLevelAndId"));h=this.IGc(b,h.Xr,z,R,r)}!h&&r&&(r=new Nd.GraphIterator,r.fd(b),r.f4b()&&mc.ListReader.ai(r)&&(h=r));return h}lbl(b,h,r,z,R,ba){z?(R?b=R.qfc:(ba=this.GL(h,r.Xr),r=this.kQc(r.Xr,b,ba),b=r.Jfa!==zi.a.Yi?r.Jfa+1:ba.startAt===zi.a.Yi?1:ba.startAt),h.setValue(Ki.a.ae.py,b),h.setValue(Ki.a.ae.hJ,b)):(b=zi.a.Yi,this.xMn(h,ba,r));
return b}qbl(b,h,r,z,R){if(z){var ba=!1,ta=this.Qw(z),Wa=ta.level===b.Xr.level,ub=!!r&&ta.listID===r.hUc;(ta.listID===b.Xr.listID||ub)&&Wa&&(Wa=this.GL(z.currentNode,ta),ub=Wa.startAt===zi.a.Yi?1:Wa.startAt,ta.hq===ub+1&&(ba=h?R===ub:this.lrf(z,Wa,null)));if(!ba||r)r?(h=r.delta,R=Object(u.a)(this,this.oZn,"siblingMatchesLevel"),ba=Object(u.a)(this,this.pZn,"siblingRenumberAndUpdateListID")):(h=1,R=Object(u.a)(this,this.N0c,"siblingMatchesListAndLevel"),ba=Object(u.a)(this,this.L5i,"siblingRenumberAndUpdateSublistsDelta")),
ta=new Nd.GraphIterator,ta.set(z.currentNode),ta.vd(),this.hd.jD(ta),ta.mc(),this.z$e(z.currentNode,b.Xr,h,R,ba,r)}}xMn(b,h,r){let z=null;h&&(z=this.Qw(h));if(z&&z.listID===r.Xr.listID&&z.level===r.Xr.level){const R=this.hd.Hs(h);let ba=R.hq;b.setValue(Ki.a.ae.py,ba);b.setValue(Ki.a.ae.hJ,ba);mc.ListReader.sZ&&(R.propertySet.setValue(yc.a.listID,z.listID),R.propertySet.setValue(yc.a.listLevel,z.level));if(!r.J5b||r.WVd)r.bei&&!r.WVd&&(this.hd.jD(h),b=h.currentNode,ag.OutlineElementNavigator.Zd(h)),
b.setValue(Ki.a.ae.hJ,b.getValue(Ki.a.ae.py))}else h=r.Xr.hq+1,b.setValue(Ki.a.ae.py,h),b.setValue(Ki.a.ae.hJ,h)}uJa(b,h,r=!0,z=!1,R=-1){this.GXb(b,h,r,z,R)}GXb(b,h,r=!0,z=!1,R=-1,ba=!1,ta=null,Wa=!1){const ub=wc.a.instance.oo(Fb.a.GXb),Ib=new cC;Ib.Xr=null;Ib.action=0;if(!vg.OutlineElementReader.Nh(b))return wc.a.instance.Zb("PossibleListStateNotUpdated",{["Reason"]:Ov.a.nXa}),ub.end(),v.ULS.sendTraceTag(578331469,393,15,"Iterator not pointing to OE in apply list info word."),Ib;let $b=-1,fc;fc=
vg.OutlineElementReader.g2(b);var Kc=Go.qh.ju(b.currentNode);const ed=b.Rb(2);let Jd=!1,ge=null;if(ed&&ie.ParagraphReader.nc(ed)&&(Jd=!0,ge=ed,$b=this.gp.mT(b.currentNode).kt-this.gp.wF(ed).kt,Md.a(ed,8)))return ub.end(),v.ULS.sendTraceTag(578331470,393,15,"Returning from apply list info word as its a page break."),Ib;let qe=null;if(xg.a.instance.J(3)&&12===ed.type){if(ge.qa.last.ei)return v.ULS.sendTraceTag(578331471,393,15,"User applied list to para with deleted EOP."),Ib;qe=ge.Kz()}ag.OutlineElementNavigator.Zd(b);
var Ve=vg.OutlineElementReader.bBa(b);const Bd=vg.OutlineElementReader.wF(b),he=vg.OutlineElementReader.g2(b);let we=null,hg=null;h&&(we=h.LA,hg=this.infoAtLevel(b,h));let Pf=b.Rb(4);Pf?h&&16!==h.listType?(this.flh(Pf,hg,R,we,!!ta&&ta.hasProperty(od.a.bDf)),b.mc(),Ib.action=3,Ib.Xr=this.Qw(b)):(Jd&&(this.TNi(ge),this.Ypn(ge),ge.kW=null),z=this.hd.cPd(Pf.ia(yc.a.listID,0)),!Ki.a.ae.jfa||z?(Pf.o8d=!1,this.leaveList(b),b.Eg()):b.mc(),r&&Jd&&(this.TAd(Kc),Kc=Ve+(he?he:-1*Bd)-this.Tlc[0],Kc=0>Kc?0:Kc,
this.Kh.Hva(b,1,Kc)),Ki.a.ae.jfa&&b.Rb(4)&&(Pf.o8d=!1,this.leaveList(b),b.Eg()),Ib.action=1,Ib.Xr=null,ge&&(this.Hd.ng&&!this.xUa||Ki.a.ae.jfa&&!this.Hd.ng&&ge.hj)&&(!ge.hj||ge.NA&&ge.NA.hasProperty(yc.a.listID))&&this.uNk(b)):h&&16!==h.listType&&(r=-1,Ve=h.propertySet.ia(yc.a.listID,-1),mc.ListReader.sZ&&Wa&&0<Ve&&Ve+""in this.RKf&&(r=this.RKf[Ve+""]),h=h.Uhb?new dp(this,Nd.GraphIterator.$a(h.Uhb),!1,!0):dp.I9k(this,b,hg,Wa,ba),this.e1l(b,hg,z,Wa,h),Pf=this.XKk(b),this.xr&&this.cKn(h,hg),Jd&&!Ki.a.ae.RL&&
this.Z6d(Pf,ed,ta),void 0===h||null===h||ba||hg.sr!==this.hd.Bea(Pf,h.Xr).sr?this.lbm(hg,r,h,Pf)?(this.Yjo(hg,Pf,r,$b),Ib.action=3,Ib.Xr=this.flh(Pf,hg,-1,we)):(Ib.action=4,0<fc&&($b+=fc),Ib.Xr=this.$ch(Kc,Pf,hg,$b,we),this.Qjo(r,Ve,Ib.Xr,Pf)):(Ib.action=2,Ib.Xr=h.Xr,hg.listStyle||(h.J5b=!0),this.oom(r,Ib.Xr,Pf,h)),Jd&&this.QLn(ed),b.mc());xg.a.instance.J(3)&&!this.xUa&&(ge&&qe&&this.Ym.nM(ge,qe,this.Hd.ng),this.T7());ub.end();return Ib}XKk(b){Ki.a.ae.jfa&&b.Rb(31)&&b.Eg();return this.createList(b)}Ypn(b){b.hasProperty(yc.a.fe)&&
b.removeProperty(yc.a.fe);b.hasProperty(yc.a.ZB)&&b.removeProperty(yc.a.ZB);b.hasProperty(yc.a.ht)&&b.removeProperty(yc.a.ht)}infoAtLevel(b,h){if(!h)return null;const r=h.LA;if(this.xr)if(1===h.vr){if(h.pma&&!h.EI||!h.CWe(!1))return h;let z;b=vg.OutlineElementReader.bBa(b);z=this.IQc(b);const R=r.JEb[z];b=fq.a.M1(h.propertySet,h.propertySet);6===R?b.t7(1,1):b.t7(0,R);b.b7d("multilevel");b.levelText=r.KQc[z];r.MAa&&r.MAa[z]&&(b.font=r.MAa[z]);b.Zs=r.eRd[z];b.O3=r.O3;b.XRd=h.XRd}else b=h;else b=h;return b}cKn(b,
h){b&&b.Xr&&(h.levelText=b.Xr.levelText,h.sr||(h.font=b.Xr.font))}e1l(b,h,r,z,R){if(r&&R){r=vg.OutlineElementReader.bBa(b);if(this.xr){var ba=vg.OutlineElementReader.g2(b);0<ba?r+=ba:(ba=vg.OutlineElementReader.wF(b),0<ba&&(r-=ba))}h=h.propertySet.ia(yc.a.listLevel,-1);R.Xr.level=z&&0<=h?h:this.IQc(r);this.Am.Bea(b.currentNode,R.Xr).listType||(z=this.GL(b.currentNode,R.Xr),b=this.kQc(R.Xr,b,z),R.Xr.yEc=R.Xr.hq=b.Jfa===zi.a.Yi?z.startAt-1:b.Jfa,R.J5b=b.hlj)}else R&&R.Xr&&h.propertySet&&h.propertySet.hasProperty(yc.a.listLevel)&&
(R.Xr.level=h.propertySet.getValue(yc.a.listLevel))}Qjo(b,h,r,z){mc.ListReader.sZ&&(0>=b?this.RKf[h+""]=r.listID:(z.properties.setValue(yc.a.listID,b),r.listID=b))}Yjo(b,h,r,z){h.properties.setValue(yc.a.listID,r);h.properties.hasProperty(yc.a.listLevel)||(r=b.propertySet&&b.propertySet.hasProperty(yc.a.listLevel)?b.propertySet.Og(yc.a.listLevel):this.IQc(z),h.properties.setValue(yc.a.listLevel,r),this.xr&&(b.propertySet&&b.Nea&&(r=b.levelText.replace("%1","%"+(r+1)),h.setValue(yc.a.Ur,r)),b.propertySet&&
b.r4b&&!Ki.a.ae.RL&&h.setValue(We.a.font,b.font)))}oom(b,h,r,z){if(mc.ListReader.sZ){let R=null;0<b&&(R=new Bz(0,h,-1),R.hUc=b,R.delta=-1);this.joinList(r,z,!1,R)}else this.joinList(r,z,!1)}lbm(b,h,r,z){return!mc.ListReader.sZ||0>=h?!1:void 0===r||null===r?(r=b.propertySet.ia(yc.a.listLevel,-1),0<=r&&(h=this.Am.Pw(z,h,r))&&(h=h.ia(We.a.U2,null))?b.Cma!==h:!1):b.sr!==this.hd.Bea(z,r.Xr).sr||b.Cma!==this.hd.Bea(z,r.Xr).Cma}Xpn(b,h){const r=!!h&&ie.ParagraphReader.nc(h);let z=0,R=0;r&&(z=this.gp.mT(b.currentNode).kt,
R=this.gp.wF(h).kt);r&&this.TNi(h);b.Eg();r&&this.Kh.Hva(b,1,z-R)}K9(b,h,r,z=-1,R=!1,ba=null,ta=!1){v.ULS.sendTraceTag(17622211,324,50,"'Continue Existing List' is selected from Context Menu.");const Wa=wc.a.instance.oo(Fb.a.K9),ub=this.Hc.Rc(15);ub.Ou(b);let Ib=null,$b=0;({nom:Ib,mNm:$b,returnValue:z}=this.j$k(b,h,z,Ib,$b,R,ba));if(!Ib||ta&&(1===r||0>r-Ib.Xr.hq||2<r-Ib.Xr.hq))return ub.dispose(),Wa.end(),!1;for(;0<$b;)b.f4b(),$b--;this.Rjo(b,h,z,Ib);ub.dispose();Wa.end();return!0}Rjo(b,h,r,z){for(;b.f4b();)if(b.Rb(4)){if(this.Cea(b.currentNode).listID===
h.listID){h=new Bz(0,h,r);this.joinList(b.currentNode,z,!0,h);break}b.mc()}}j$k(b,h,r,z,R,ba=!1,ta=null){for(;b.fJd();){if(b.aq(4)){const Wa=this.Qw(b),ub=this.hd.Hs(b);if(ub.listType!==ta.listType){R++;continue}if(ba&&ub.listStyle!==ta.listStyle||!ba&&h.level<Wa.level){R++;continue}-1===r&&(r=Wa.hq+1);z=null;if(h.level===Wa.level||ba)Ki.a.ae.IDb&&this.Tkb&&this.Tkb.Ymf(b),z=new dp(this,b,!1,!1);ba&&Wa.level!==h.level&&b.aq(4)&&(b.Rb(4).setValue(yc.a.listLevel,Wa.level),b.mc());break}R++}return{returnValue:r,
nom:z,mNm:R}}FGd(b){let h=0;var r=0;xg.a.instance.J(3)&&(r=this.hd.AL(b,!1,!0),h=r.listId,r=r.listLevel);return this.hd.Pw(b,h,r)}startNewList(b,h,r){v.ULS.sendTraceTag(17622212,324,50,"'Start New List' is selected from Context Menu.");if(h){var z=wc.a.instance.oo(Fb.a.startNewList),R=this.Hc.Rc(15);R.Ou(b);var ba=fq.a.HP(0,h.listStyle,null,0,h.propertySet.ia(yc.a.listLevel,-1));b.Rb(4);var ta=b.currentNode.ia(yc.a.listID,0),Wa=b.currentNode.ia(yc.a.listLevel,-1);b.mc();ba.XRd=ta;var ub=h.propertySet.ia(yc.a.fe,
0);0<ub&&ba.propertySet.setValue(yc.a.fe,ub);-1===ba.propertySet.ia(yc.a.listLevel,-1)&&ba.propertySet.setValue(yc.a.listLevel,Wa);1===h.vr&&((Wa=new cx.a,ta=h.C0h(b.currentNode,ta),ta)?1===ta&&(ba.b7d(iv.a.U9b),ba.LA=Wa.w0e(Wa.JEf,Wa.KEf),ba.O3=ba.LA.O3):(ba.b7d(iv.a.U9b),ba.LA=Wa.D_e(),ba.O3=ba.LA.O3));h.Eea()&&1>r&&(r=1);ba.Tz=r;ta=new Ei.DictionaryPropertySet;ta=this.$0b(Fb.a.tH,ta);Wa=b.Rb(2);b.mc();b.Rb(4);h=this.Cea(b.currentNode);this.xr&&(ub=this.FGd(b.currentNode))&&(ba.levelText=ub.ia(yc.a.Ur,
""),ba.EI=42,ba.Zs=ub.ia(yc.a.jaa,"left"));this.Xpn(b,Wa);({LBa:ba}=this.ura(ta,b,ba,!0));b.Rb(4);22!==b.currentNode.type&&63!==b.currentNode.type&&v.ULS.sendTraceTag(587851671,393,15,"Graph node {0} is not list node.",b.currentNode.type);b.currentNode.setValue(yc.a.listLevel,h.level);b.mc();ba=new dp(this,b,!1,!1);this.hd.jD(b);r=new Bz(1,h,r);this.joinList(b.currentNode,ba,!0,r);R.dispose();z.end()}else v.ULS.sendTraceTag(51242764,324,50,"'Start New List' has no current ListInfo")}ysf(b){if(!b)return!1;
const h=b.Rb(2);h&&b.mc();return xg.a.instance.J(3)&&h&&12===h.type&&h.qa&&h.qa.last&&h.qa.last.ei?!0:!1}A_d(b,h,r,z){return this.Sxe.A_d(b,h,r,z)}JVf(b,h){if(!b||!h)return!1;const r=b.propertySet.ia(yc.a.Ur,null);h=h.propertySet.ia(yc.a.Ur,null);if(!r||!h)return!1;const z=b.propertySet.ia(We.a.font,null);b=b.propertySet.ia(We.a.font,null);return r===h&&z===b}J_i(b,h,r){r||h.listType||(h.Tz=b.ia(We.a.kX,zi.a.Yi))}ITh(b,h){if(!h)return null;const r=Array(9),z=h.XRd;if(!this.Sfm(h,b)||1>z)return null;
for(h=0;9>h;h++){const R=this.hd.Pw(b,z,h);if(null===R||void 0===R?0:R.hasProperty(yc.a.fe))r[h]=R.getValue(yc.a.fe);else return null}return r}Sfm(b,h){if(!b)return!1;const r=b.propertySet.ia(yc.a.listLevel,-1);b=b.propertySet.ia(yc.a.fe,-1);if(0>r||0>b)return!1;this.TAd(h);return b!==this.qPb[r]?!0:!1}P8g(b,h,r){b&&b.setValue(yc.a.fe,h?h[r]:this.qPb&&r<this.qPb.length?this.qPb[r]:720*(r+1))}z$e(b,h,r,z,R,ba=null,ta=!1){const Wa=new Nd.GraphIterator,ub=this.GL(b,h);Wa.set(b);Wa.vd();b=xi.a.Kr(Wa,
Wa.nwa());b.Um(gu.a.d0a,null);let Ib=-1;for(;b.moveNext();){if(!mc.ListReader.ai(Wa))continue;this.hd.jD(Wa);const $b=Wa.currentNode,fc=this.Cea($b);Wa.mc();if(z!==Object(u.a)(this,this.N0c,"siblingMatchesListAndLevel")||fc.listID===h.listID){if(ta){if(-1!==Ib&&Ib>fc.level)break;if(-1===Ib)Ib=fc.level;else if(fc.level!==Ib)continue}else{if(fc.level<=ub.m_)break;if(!z(h,fc,ba))continue}R($b,r,h.listID,ba)}}}fdl(b,h,r,z,R){const ba=new Nd.GraphIterator,ta=this.GL(b,h);ba.set(b);ba.vd();if(mc.ListReader.ai(ba)){this.hd.jD(ba);
b=ba.currentNode;var Wa=this.Cea(b);ba.mc();Wa.level<=ta.m_||z(h,Wa,null)&&R(b,r,h.listID,null)}}B$e(b,h,r,z,R=null){const ba=new Nd.GraphIterator;ba.fd(b);z(b,h,this.Qw(ba),ba,0);this.IGc(b,h,r,z,R)}IGc(b,h,r,z,R=null){let ba=new Nd.GraphIterator;const ta=this.GL(b.currentNode,h);let Wa=null,ub=0;var Ib=new Nd.GraphIterator;Ib.fd(b);Ib.Bb(10);const $b=Cn.a.Kr(Ib,Ib.origin);for($b.moveNext();$b.moveNext();)if(Wa=null,ba=$b.iterator,1===ba.role&&(Wa=$b.currentNode,ba.aq(4)&&(Ib=this.Qw(ba),r(h,Ib,
R))))if(Ib.level>h.level)z(b,h,Ib,ba,ub),ub++;else if(Ib.level===h.level||Ib.level<=ta.m_)break;return Wa?ba:null}N0c(b,h){return h.listID!==b.listID||h.level!==b.level?!1:!0}oZn(b,h,r){return h.listID!==b.listID&&h.listID!==r.hUc||h.level!==b.level?!1:!0}jzf(b,h,r){return h.listID===b.listID||r&&h.listID===r.hUc?!0:!1}L5i(b,h,r,z){const R=b.ia(Ki.a.ae.py,-1);this.K5i(b,R+h,r,z)}K5i(b,h,r,z){if(!Go.ZOc){const R=b.ia(Ki.a.ae.py,-1);b.hasProperty(Ki.a.ae.py)&&-1===R&&wc.a.instance.Zb("PossibleIncorrectListRenumbering",
{["Reason"]:"PropertyNotExist"});b.setValue(Ki.a.ae.py,h);b.setValue(Ki.a.ae.hJ,h)}b.setValue(yc.a.listID,r);h=this.Cea(b);b=Nd.GraphIterator.$a(b);b.vd();b.mc();this.B$e(b,h,Object(u.a)(this,this.jzf,"matchesListId"),Object(u.a)(this,this.b3f,"sublistsUpdateListItem"),z)}qZn(b,h){const r=b.getValue(Ki.a.ae.py);b.setValue(Ki.a.ae.py,r+h);b.hasProperty(Ki.a.ae.hJ);b.setValue(Ki.a.ae.hJ,r+h)}pZn(b,h,r,z){let R,ba;R=this.Am.yYa(b);ba=R.Kz();if(!Go.ZOc){b.hasProperty(Ki.a.ae.py)||wc.a.instance.Zb("PossibleIncorrectListRenumbering",
{["Reason"]:"PropertyNotExist"});const ta=b.getValue(Ki.a.ae.py);b.setValue(Ki.a.ae.py,ta+h);b.hasProperty(Ki.a.ae.hJ)&&b.getValue(Ki.a.ae.hJ)!==ta&&wc.a.instance.Zb("PossibleIncorrectListRenumbering",{["Reason"]:"PropertyNotExist"});b.setValue(Ki.a.ae.hJ,ta+h)}b.setValue(yc.a.listID,r);h=this.Cea(b);b=Nd.GraphIterator.$a(b);b.vd();b.mc();R&&ba&&!this.xUa&&(this.Ym.nM(R,ba,this.Hd.ng),this.T7());this.IGc(b,h,Object(u.a)(this,this.c9i,"sublistsEnsureSameListAsOriginal"),Object(u.a)(this,this.p$d,"sublistsUpdateId"),
z)}QJi(b,h,r,z,R){b=this.GL(b.currentNode,r);b.m_>=h.level&&this.wwb(z,b.startAt+R)}d9i(b,h,r,z,R){this.QJi(b,h,r,z,R)}p$d(b,h,r,z){r.listID=h.listID;z.Rb(4);b=this.Am.yYa(z.currentNode);h=b.Kz();this.HXb(z.currentNode,r);z.mc();b&&h&&!this.xUa&&(this.Ym.nM(b,h,this.Hd.ng),this.T7())}b3f(b,h,r,z){mc.ListReader.ai(z)&&(b=new Nd.GraphIterator,b.fd(z),b.vd(),this.hd.jD(b),this.Gof(z.currentNode,b.currentNode))}Q3n(b,h,r,z,R){r.listID=h.listID;this.QJi(b,h,r,z,R);this.p$d(b,h,r,z,R)}a3f(b,h){return h.listID!==
b.listID?!1:!0}P3n(b,h){return h.level>b.level?!1:!0}c9i(b,h,r){return h.listID!==r.hUc?!1:!0}static get ZOc(){null==Go.Ujd&&(t.AFrameworkApplication.K?(t.AFrameworkApplication.Hf("i75ig452;a229j208"),Go.Ujd=t.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.RemoveRedundantRenumberingForListActions",!1)):Go.Ujd=!1);return Go.Ujd}static get Tg(){return sm.ContextSetEditor.instance}static get qh(){return ml.PageNavigator.instance}static UZi(b,h){h.setValue(We.a.font,b.pma||
b.aNc||b.r4b?b.font:"Symbol")}static WZi(b,h){b=b.pma||b.aNc||b.Nea?b.levelText:zi.a.Iyd;v.ULS.shipAssertTag(22127637,338,!!b);h.setValue(yc.a.Ur,b)}static VZi(b,h){b=b.propertySet.ia(yc.a.jaa,"left");h.setValue(yc.a.jaa,b)}static n$h(b){b=b.iterator.parentNode;const h=Nd.GraphIterator.$a(b);b&&vg.OutlineElementReader.tsf(h,null)&&b.gk(8,!0)}static M7l(b){const h=new Nd.GraphIterator;h.set(b.currentNode);ag.OutlineElementNavigator.Zd(b);for(b=h.Xd();b&&!wA.a.T6b(b);)b=h.xj();b&&b.gk(4,!0)}}Go.UFm=
2147450879;Go.vri=1;Go.Ujd=null;Object(n.a)(Go,"FlatListEditorCssVersion",Ki.a,[424,425,52]);class by{constructor(b,h,r,z,R,ba,ta,Wa,ub,Ib,$b,fc){this.HH=b;this.Kh=r;this.Jhd=h;this.Hc=z;this.gp=R;this.Sxe=ba;this.Hd=ta;this.Ym=Wa;this.IHa=ub;this.Ac=Ib;this.He=$b;this.bJa=fc}create(){return new Go(this.HH,this.Jhd,this.Kh,this.Hc,this.gp,this.Sxe,this.Hd,this.Ym,this.IHa,this.Ac,this.He,this.bJa)}}Object(n.a)(by,"FlatListEditorFactory",null,[]);class bo{constructor(){this.startAt=this.listLevel=
this.listId=0;this.Uhb=null}}Object(n.a)(bo,"ListAutoCorrectionRefInfo",null,[]);class dC{constructor(b,h){this.RKj=b;this.Cf=h}A_d(b,h,r,z){if(!b.hasProperty(od.a.hNa))return!0;h=Nd.GraphIterator.$a(h.currentNode);Xd.SelectionEditor.Jt(h);let R=!0;if(!r.listType&&!z){23===h.Qe&&h.oE(1);z=b.ia(od.a.hNa,1);if(1!==z){var ba=new Nd.GraphIterator;ba.fd(h);ba.Bb(10);ba=Cn.a.Wp(ba.origin);z=this.i$k(ba,z,r,h.currentNode);r.Uhb||(R=!1)}b.setValue(od.a.hNa,z)}return R}i$k(b,h,r,z){const R=new Ua.a;for(;b.moveNext()&&
b.iterator.currentNode!==z;){const ba=b.iterator;if(!ba.aq(4))continue;const ta=this.RKj.value.Qw(ba),Wa=this.Cf.Hs(ba);this.xbn(R,ta);Wa.listType===r.listType&&Wa.listStyle===r.listStyle&&(0>h-ta.hq||2<h-ta.hq||R.add(Object.assign(new bo,{listId:ta.listID,listLevel:ta.level,Uhb:ba.currentNode,startAt:ta.hq+1})))}0<R.count&&(h=R.J(R.count-1).startAt,r.Uhb=R.J(R.count-1).Uhb);return h}xbn(b,h){let r=0;for(;r<b.count;){const z=b.J(r);z.listId===h.listID&&z.listLevel>=h.level?b.removeAt(r):r++}}}Object(n.a)(dC,
"ListAutoCorrector",null,[387]);class Gt{constructor(b,h,r,z,R){this.n3a=(ba,ta,Wa)=>{var ub;ba=this.NCc(ta);if(!ba||this.Or.ysf(ba))return 8;ta=this.Or.Qw(ba);if(1===ta.hq||this.jOc(ta.level))return 8;ta=null===(ub=this.hd)||void 0===ub?void 0:ub.Hs(ba);if(!ta||this.qei(ta))return 8;if(1===Wa)return 32;this.Or.startNewList(ba,ta,1);return 32};this.m3a=(ba,ta,Wa)=>{ba=this.NCc(ta);if(!ba||this.Or.ysf(ba))return 8;ta=this.Or.Qw(ba);if(this.jOc(ta.level))return 8;const ub=this.hd.Hs(ba);if(!ub||this.qei(ub))return 8;
if(1===Wa)return 32;this.K3e.eAl(ba.currentNode,ta.hq,this.hd,this.Or,this.oQa);return 32};this.K9=(ba,ta,Wa)=>{ba=this.NCc(ta);if(!ba||this.Or.ysf(ba))return 8;ta=this.Or.Qw(ba);if(1!==ta.hq||this.jOc(ta.level))return 8;if(1===Wa)return 32;Wa=this.hd.Hs(ba);return this.Or.K9(ba,ta,Wa.Tz,-1,!1,Wa)?32:8};this.blb=(ba,ta,Wa,ub,Ib)=>{ba=this.NCc(ta);if(!ba)return 8;ta=this.Or.Qw(ba);if(this.jOc(ta.level))return 8;if(1===Wa)return 32;Wa=this.hd.Hs(ba);this.Or.startNewList(ba,Wa,Ib);return 32};this.nbb=
(ba,ta,Wa,ub,Ib)=>{ba=this.NCc(ta);if(!ba)return 8;ta=this.Or.Qw(ba);return this.jOc(ta.level)?8:1===Wa?32:this.Or.K9(ba,ta,ta.hq,Ib)?32:8};this.zc=b;this.hd=r;this.Or=z;this.K3e=R}get qcm(){return mc.ListReader.rr}jOc(b){return 0>b?!0:this.qcm?!1:!!b}Vb(){this.zc.pa(Fb.a.n3a,kc.a.outlineElement,this.n3a);this.zc.pa(Fb.a.n3a,kc.a.Wc,this.n3a);this.zc.pa(Fb.a.n3a,kc.a.view,this.n3a);this.zc.Vc(Fb.a.n3a,12);this.zc.pa(Fb.a.m3a,kc.a.outlineElement,this.m3a);this.zc.pa(Fb.a.m3a,kc.a.Wc,this.m3a);this.zc.pa(Fb.a.m3a,
kc.a.view,this.m3a);this.zc.Vc(Fb.a.m3a,12);this.zc.pa(Fb.a.K9,kc.a.outlineElement,this.K9);this.zc.pa(Fb.a.K9,kc.a.Wc,this.K9);this.zc.pa(Fb.a.K9,kc.a.view,this.K9);this.zc.Vc(Fb.a.K9,12);this.zc.pa(Fb.a.blb,kc.a.outlineElement,this.blb);this.zc.pa(Fb.a.blb,kc.a.Wc,this.blb);this.zc.pa(Fb.a.blb,kc.a.view,this.blb);this.zc.Vc(Fb.a.blb,12);this.zc.pa(Fb.a.nbb,kc.a.outlineElement,this.nbb);this.zc.pa(Fb.a.nbb,kc.a.Wc,this.nbb);this.zc.pa(Fb.a.nbb,kc.a.view,this.nbb);this.zc.Vc(Fb.a.nbb,12)}get oQa(){return Sa.a.instance.resolve("Common.IStandaloneRootController").y3}NCc(b){return this.Or.Jxl(b)}qei(b){return 1===
(null===b||void 0===b?void 0:b.listType)}}Object(n.a)(Gt,"ListContextMenuSectionActor",null,[]);class yw{static get Hrm(){return Wc.a.Px(yw.sl,Box4Intl.Box4Strings.l_StartNewListDialog,Box4Intl.Box4Strings.l_ContinueFromPreviousList,Box4Intl.Box4Strings.l_SetValueTo)}}yw.sl="<div class='WACDialogRow' id='StartNewList'> <input type='radio' id='ListRadioStartNew' name='ListRadioBox' class='WACDialogRadio' alt='{0}' title='{0}'></input> <label id='StartNewList' class='WACDialogLabel' for='ListRadioStartNew' >{0}</label> </div> <div class='WACDialogRowNoBreak' id='ContinuePreviousList'> <input type='radio' id='ListRadioContinue' name='ListRadioBox' class='WACDialogRadio' alt='{1}' title='{1}'></input> <label id='ContinueFromPreviousList' class='WACDialogLabel' for='ListRadioContinue' >{1}</label> </div> <div class='WACDialogRow' id='SpinnerRow'> <div class='WACDialogGroupBox' id='ListStartAtSpinnerBox'> <label id='ListStartAtNumber' class='DialogSpinnerLabel' >{2}</label> <br/> <div id='SetListStartSpinnerContainer' class='WacSpinnerBox'></div> <br/> </div> </div>";
Object(n.a)(yw,"ListSetStartValueDialogHtml",null,[]);class kv extends Wc.a{constructor(b,h,r,z,R){super();this.chd=this.sle=this.vhd=this.gIe=null;this.one=!0;this.LK=!1;this.v8a=0;this.B7=[Fb.a.vYf,Fb.a.V1f,Fb.a.ROf];this.ROn=(ba,ta)=>{mc.ListReader.rr?(ba=ta[Cc.a.Number],this.r4=Number.isInteger(ta[Cc.a.Number])&&ba>=this.v8a?ba:this.v8a):this.r4=ta[Cc.a.Number]};this.EJl=(ba,ta)=>{mc.ListReader.rr&&(this.r4=this.r4>=this.v8a?this.r4:this.v8a);ta[Cc.a.Number]=this.r4;ta[Cc.a.UnitType]=0};this.TLn=
(ba,ta)=>{if(1===ba){var Wa=ta.ListRadioStartNew,ub=ta.ListRadioContinue,Ib=Nd.GraphIterator.$a(this.Pe);Ib.vd();ta=this.Or.Qw(Ib);ba=this.Cf.Hs(Ib);if(Wa)this.Or.startNewList(Ib,ba,this.r4);else if(ub)if(this.one)this.Or.K9(Ib,ta,this.pBe,-1,!1,ba);else{Wa=!0;for(ub=null;Ib.bH();)if(Ib.aq(4)){ub=new dp(this.Or,Ib,!1,!1);break}if(!ub||this.Or.Qw(Ib).hq>=this.r4)Wa=!1;Wa?(Ib=Nd.GraphIterator.$a(this.Pe),Ib.vd(),this.Or.K9(Ib,ta,this.pBe,this.r4,!1,ba)):(this.dispose(),this.Eva(CommonUIStrings.l_ErrorDialogMessage,
this.Grm))}}};this.Grm=()=>{new kv(this.Pe,this.pBe,this.Cf,this.Or,this.yd)};this.KXm=()=>{document.getElementById(kv.nli).style.visibility="visible"};this.SQm=()=>{document.getElementById(kv.nli).style.visibility="hidden"};this.kg="ListSetStartValueDialog";this.vg=yw.Hrm;this.Pe=b;this.r4=h;this.Cf=r;this.pBe=h;this.C4=z;mc.ListReader.rr&&(h=new Nd.GraphIterator,b?(h.set(b),h.vd(),vg.OutlineElementReader.Nh(h)||ag.OutlineElementNavigator.Zd(h),mc.ListReader.ai(h)&&(h.Rb(4),b=h.currentNode,22===
b.type&&(this.Cf.VN(b).Eea()?this.v8a=1:this.v8a=0))):this.v8a=1);this.yd=R;this.Wh(Box4Intl.Box4Strings.l_SetNumberingValueList,this.TLn,{["ListRadioStartNew"]:!0,["ListRadioContinue"]:!1});this.one&&(this.gIe=document.getElementById("ListRadioStartNew"),this.vhd=this.KXm,this.sle=document.getElementById("ListRadioContinue"),this.chd=this.SQm,Bf.a.addHandler(this.gIe,"click",this.vhd),Bf.a.addHandler(this.sle,"click",this.chd));for(let ba of this.B7)Eh.a.Jja(ba,this.ROn,this.EJl);this.yd.yl()}get Or(){return this.C4}dispose(){this.LK||
(this.one&&(this.vhd&&Bf.a.removeHandler(this.gIe,"click",this.vhd),this.chd&&Bf.a.removeHandler(this.sle,"click",this.chd)),this.yd.RA("ListStartSpinner"),super.dispose(),this.LK=!0)}dmk(){const b=Kf.n("none",mc.ListReader.rr?this.v8a+"":"0","100","1");return Kf.l(kv.oli,Fb.a.vYf,Fb.a.ROf,Box4Intl.Box4Strings.l_SetValueTo,[b],null,Fb.a.V1f)}DVa(b){const h=document.getElementById(kv.oli);this.yd.Pya("ListStartSpinner",b);b=this.yd.hYa("ListStartSpinner","Medium");h.appendChild(b)}cU(){const b=this.dmk();
this.DVa(b)}}kv.oli="SetListStartSpinnerContainer";kv.nli="ListStartAtSpinnerBox";Object(n.a)(kv,"ListSetStartValueDialog",Wc.a,[]);class Pv{eAl(b,h,r,z,R){new kv(b,h,r,z,R)}static get instance(){return Pv._instance||(Pv._instance=new Pv)}}Pv._instance=null;Object(n.a)(Pv,"ListDialogFactory",null,[385]);class Vh{constructor(b,h,r){this.C4=b;this.Cf=h;this.Hc=r}Ymf(b){v.ULS.shipAssertTag(40420184,393,vg.OutlineElementReader.Nh(b));const h=b.Rb(4);b.mc();if(h){const r=this.Cf.VN(h);r.vr||this.f1l(b,
h,r)}}Yuk(b){for(let h=0;h<b.length;h++){const r=new Nd.GraphIterator;r.set(b.getContext(h).node);this.Ymf(r)}}f1l(b,h,r){const z=ml.PageNavigator.instance.ju(h),R=this.C4.Cea(h),ba=this.Hc.Rc(15);ba.Ou(b);b=this.C4.$ch(z,h,r,0,null);this.C4.ZPi(h,!0,R.listID);ba.dispose();this.Cf.Bea(h,b)}}Object(n.a)(Vh,"SingleLevelListEditor",null,[384]);var cy=d(335);class Gg extends Bi{constructor(b){super();Gg.epc=b}VGi(b,h,r,z,R,ba){if(!b||!b.length)return 8;let ta;const Wa=({xRl:b,wRl:ta}=Gg.qp.uRl(b)).returnValue;
let ub=1;for(let $b of Wa.keys){var Ib=b.contains($b);const fc=Wa.J($b);Gg.qp.ork(Wa.J($b),this.FAc(h),Ib)?Ib?(v.ULS.sendTraceTag(575213851,393,50,"List Actions: {0} lists, with change in level",this.FAc(h)?"Promote":"Demote"),Ib=t.AFrameworkApplication.ya.Qf(cy.a.Qza(fc),h,r,z,R,ba)):(v.ULS.sendTraceTag(575213852,393,50,"List Actions: {0} lists, without change in level",this.FAc(h)?"Promote":"Demote"),Ib=Gg.qp.V_m(Wa.J($b),this.FAc(h),ta.J($b))):(v.ULS.sendTraceTag(575213850,393,50,"List Actions: Tried to {0} lists, but unable to indent",
this.FAc(h)?"Promote":"Demote"),Ib=8);ub=$c.ActionManager.bSc(ub,Ib)}return ub}FAc(b){return b===Fb.a.OF?!0:!1}static get qp(){return Gg.epc||(Gg.epc=Sa.a.instance.resolve("WordEditor.OutlineLevelEditors.IWordOutlineElementIndentationEditor"))}}Gg.epc=null;Object(n.a)(Gg,"WordEditorListContextManager",Bi,[]);class js{get name(){return"WordEditor.ListEditors"}yc(b){t.AFrameworkApplication.K.$("OutlineLevelEditorsDelayInitializationEnabled")&&(b.ha("WordEditor.ListEditors.IListAutoCorrector",()=>new dC(b.ef("WordEditor.IFlatListEditor"),
b.resolve("Box4.List.IListReader"))).singleInstance(),b.ha("WordEditor.IFlatListEditor",()=>(new by(b.resolve("WordEditor.List.IFlatListReader"),b.ef("Box4.IOutlineElementIndentationEditor"),b.resolve("Box4.IOutlineElementEditor"),new $m.a,b.resolve("Box4.IParagraphIndentationReader"),b.resolve("WordEditor.ListEditors.IListAutoCorrector"),b.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,b.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance,b.resolve("Box4.List.IListFormattingEditor"),
b.resolve("Box4.IFeatureHelper"),b.resolve("Box4.Styles.IWACStyleReader"),b.resolve("Box4.Styles.IWACStyleEditor"))).create()).singleInstance(),b.ha("Box4.List.IListEditor",()=>b.resolve("WordEditor.IFlatListEditor")).singleInstance(),b.ha("Box4.List.ISingleLevelListEditor",()=>new Vh(b.resolve("WordEditor.IFlatListEditor"),b.resolve("Box4.List.IListReader"),b.resolve("Box4.Graph.IGraphTransactionFactory"))).singleInstance(),b.ha("Box4.ListEditors.WordEditorListContextManager",()=>new Gg(b.resolve("WordEditor.OutlineLevelEditors.IWordOutlineElementIndentationEditor"))).as("Box4.ListEditors.IListContextManager"))}init(){(new Gt(t.AFrameworkApplication.ya,
new sn.a,js.hd,js.Or,Pv.instance)).Vb();const b=t.AFrameworkApplication.ya;b.gb(Fb.a.ROf,kc.a.view,Eh.a.PQ,96);b.gb(Fb.a.V1f,kc.a.view,Eh.a.BF,96);b.gb(Fb.a.vYf,kc.a.view,Eh.a.BF,96)}dispose(){}static get hd(){return null!=js.Sng?js.Sng:js.Sng=Sa.a.instance.resolve("Box4.List.IListReader")}static get Or(){return null!=js.Sjg?js.Sjg:js.Sjg=Sa.a.instance.resolve("WordEditor.IFlatListEditor")}static main(){O.a.instance.Oc(new js)}}Object(n.a)(js,"WordEditorListEditorsPackage",null,[1,2]);var Cz=d(1640),
Qv=d(527),Ht=d(79),rB=d(1912);class Hu extends ob.a{constructor(b,h,r,z,R,ba){super(b,h);this.styleId=null;this.yj=0;this.iNa=null;this.characterData=r;this.paragraphNode=z;this.listMarker=R;this.VLa=ba}}Object(n.a)(Hu,"HeadingText",ob.a,[]);class Dz{constructor(b,h,r,z,R,ba,ta){this.LIg=!0;this.QPg=0;this.D4g=8;this.$fa=null;this.GXl=Wa=>{if(Wa.qr)return!0;Wa=Wa.role;return 1===Wa||2===Wa||4===Wa};this.JKj=b;this.jB=h;this.He=r;this.Cf=z;this.iB=R;this.Qba=ba;this.Fxe=ta}get Sy(){return this.JKj.value}get Omf(){return this.LIg}set Omf(b){this.LIg=
b}get aFb(){return this.QPg}set aFb(b){this.QPg=b}get lMb(){return this.D4g}set lMb(b){this.D4g=b}kul(){return Object(Ht.__awaiter)(this,void 0,void 0,function*(){var b=this.Fxe.value;if(!isNullOrUndefined(b)&&b.Lv)return b=yield this.sCl(),this.BMf(b,!0);b=this.$fa;return isNullOrUndefined(b)?null:Promise.resolve(this.BMf(b,!0))})}PRh(){return this.BMf([],!1)}BMf(b,h){const r=window.performance.now(),z=this.QRh();if(!z)return null;const R=new Ua.a;let ba=0;for(;z.moveNext();){var ta=z.iterator;if(11===
ta.Qe){const Wa=this.Cf.zAb(ta),ub=ag.OutlineElementNavigator.De(ta,!0);h&&b[ba]&&b[ba].ParaId===ie.ParagraphReader.qT(ub)&&ba++;ag.OutlineElementNavigator.Zd(ta);if(!ub||!ie.ParagraphReader.nc(ub)||ub.Sr||""===ub.characterData||"\ufffc"===ub.characterData)continue;const Ib=this.YFd(ub);Ib&&(Wa&&(Ib.listMarker=this.iB.f0a(Wa,!1).K2,ta=this.Cf.Hs(ta),1===ta.listType&&ta.r4b&&(Ib.iNa=ta.font)),h&&(b[ba-1]&&b[ba-1].ParaId===ie.ParagraphReader.qT(ub)?Ib.yj=ba:Ib.yj=ba+1),R.add(Ib))}}v.ULS.sendTraceTag(591963592,
3019,50,String.format("GetHeadingsDataForToc Duration: {0} ms;",window.performance.now()-r));return R}sCl(){let b=new cc.a;var h=rB.a.I9(t.AFrameworkApplication.rootQuerySignature,null);let r=new ko.a;r.Yr=h;r.status=1;this.kPj=window.performance.now();h=this.Qba.bla(0,()=>{if(2!=r.statusCode||null==r.jk||0==r.jk.length||null==r.jk[0]){const z=String.format("GetPageEndsOperation Failed with status code: {0};",r.statusCode);b.setException(Error.create(z));v.ULS.sendTraceTag(543802465,3019,10,z)}else b.Gg(r.jk[0].PageEnds),
v.ULS.sendTraceTag(543802466,3019,50,String.format("GetPageEndsDuration Duration: {0} ms;",window.performance.now()-this.kPj))});h.JJ(r);h.qW();return Za.b(b.task)}iul(){const b=this.QRh();if(!b)return-1;let h=0;for(;b.moveNext();){const r=b.iterator;if(11===r.Qe){const z=ag.OutlineElementNavigator.De(r,!0);ag.OutlineElementNavigator.Zd(r);z&&ie.ParagraphReader.nc(z)&&!z.Sr&&""!==z.characterData&&"\ufffc"!==z.characterData&&this.YFd(z)&&h++}}return h}QRh(){if(!this.Sy)return v.ULS.sendTraceTag(591000526,
3019,10,"PageNode is null"),null;var b=this.jB.pT(this.Sy);if(!b)return v.ULS.sendTraceTag(591963593,3019,10,"pageContentNode is null."),null;b=Nd.GraphIterator.$a(b);if(!b.qo())return v.ULS.sendTraceTag(591963594,3019,10,"Failed to root at PageContent."),null;b=Cn.a.Kr(b,b.origin);b.Um(this.GXl,null);return b}YFd(b){return this.sPl(b)||this.hul(b)}hul(b){var h;let r=h=null,z=-1;var R=-1,ba=this.He.Qx(b);for(let Wa=0;Wa<b.qa.length;Wa++)if(h=b.qa.J(Wa),h.formatting){var ta=Aj.FormattingReader.gta(h.formatting);
const ub=this.He.rf(ta);if(!r&&(r=ub,R=(R=uj.a.rIc(r))?Number.parseInvariant(R):0,!this.usf(R-1)))break;ta=(ta=this.He.j2(ta,ba))?ta.ia(yc.a.mj,9):9;z=-1===z?ta:z;if(!(this.tuf(ta)&&z===ta||uj.a.ouf(ub)&&r===ub))break}h=h.cp;ba=b.characterData.substring(0,h);return this.tuf(z)?new Hu(0,h,ba,b,null,z+1):uj.a.ouf(r)?new Hu(0,h,ba,b,null,R):null}tuf(b){return this.Omf&&this.usf(b)}usf(b){return b<=this.lMb&&b>=this.aFb}sPl(b){const h=ie.ParagraphReader.dBa(b);if(this.tuf(h))return new Hu(0,b.characterData.length,
b.characterData,b,null,h+1);if(this.usf(h)){var r=this.He.yo(b);r=this.He.rf(r);if(uj.a.Y7b(r))return new Hu(0,b.characterData.length,b.characterData,b,null,h+1)}return null}}Object(n.a)(Dz,"StyleBasedDocumentHeadings",null,[416]);class xA{constructor(){this.startTime=0}}Object(n.a)(xA,"TocCallbackData",null,[]);class ks{constructor(b,h,r,z,R,ba,ta,Wa,ub,Ib,$b){this.c9f=(fc,Kc,ed)=>{const Jd=Kc.node;if(!Jd)return v.ULS.sendTraceTag(36705296,324,10,"Context node is null in UpdateTableOfContentsHandler."),
2;if(12!==Jd.type)return v.ULS.sendTraceTag(36705297,324,10,"Context node is not a paragraph in UpdateTableOfContentsHandler."),2;if(!Jd.Sr)return 2;if(1===ed)return Xh.SessionStatusManager.instance.Sj?8:32;this.Ac&&this.Ac.isFeatureEnabled(127)?this.fod.rio(Jd).then(ge=>{ge||this.Yij(Jd)}):this.Yij(Jd);return 32};this.Nmo=fc=>{fc=window.performance.now()-fc.startTime;v.ULS.sendTraceTag(574408796,3019,50,String.format("UpdateTOC Duration: {0} ms;",fc));fc=Object.assign(new eb.a,{durationMs:fc});Ca.Health.instance.recordKpiSuccess(ks.umj,
fc);ks.dwa()};this.K6l=(fc,Kc,ed)=>{if(ie.ParagraphReader.nc(Kc.node)&&Kc.node.Sr)return 2;if(1===ed)return Xh.SessionStatusManager.instance.Sj?8:32;if(Kc.contextId!==kc.a.Wc||this.Ok.T$(Kc)||!ie.ParagraphReader.nc(Kc.node))return 32;this.Hd.zs(17);this.fod.yIk(Kc);return 32};this.zSf=(fc,Kc,ed)=>{fc=Kc.node;if(!fc)return v.ULS.sendTraceTag(39358978,324,10,"Context node is null in RemoveTableOfContentsHandler."),2;if(12!==fc.type)return v.ULS.sendTraceTag(39358979,324,10,"Context node is not a paragraph in RemoveTableOfContentsHandler."),
2;if(!fc.Sr)return 2;if(1===ed)return Xh.SessionStatusManager.instance.Sj?8:32;ed=new Nd.GraphIterator;ed.set(fc);ed.Bb(8);ed.kd(8);Kc=this.Hc.Rc(15);Kc.Ou(ed);this.fod.vpn(fc)?(Kc.dispose(),ks.dwa()):(Kc.dispose(),v.ULS.sendTraceTag(556565975,3019,10,"Failed to remove TOC."));return 32};this.ga=b;this.l7c=h;this.Xc=z;this.Hc=R;this.Ok=ba;this.fod=ta;this.Hd=Wa;this.Ac=ub;this.FFg=Ib;this.ND=$b}Vb(){this.ga.pa(Fb.a.vhc,kc.a.paragraph,this.c9f);this.ga.pa(Fb.a.vhc,kc.a.Gd,this.c9f);this.ga.pa(Fb.a.vhc,
kc.a.Wc,this.c9f);this.ga.Vc(Fb.a.vhc,1028);this.ga.pa(Oa.a.nof,kc.a.Wc,this.K6l);this.ga.Vc(Oa.a.nof,1028);this.ga.pa(Oa.a.TXc,kc.a.paragraph,this.zSf);this.ga.pa(Oa.a.TXc,kc.a.Gd,this.zSf);this.ga.pa(Oa.a.TXc,kc.a.Wc,this.zSf);this.ga.Vc(Oa.a.TXc,1028)}Yij(b){Ca.Health.instance.recordKpiUsage(ks.umj,1,ks.EB,null);const h=this.Mil(b),r=new xA;r.startTime=window.performance.now();this.l7c.bXi(h,yc.a.o8f,this.ZNl(this.GCl(b)),this.Nmo,null,r);this.fod.Ftk()}rqj(b){if(null!=b&&b.Sr)if(null==this.FFg.instance)v.ULS.sendTraceTag(539628835,
3019,10,"Page Number Finder instance is null.");else{var h=this.FFg.instance.VVh();b=this.c$k(b);var r=!1;1===this.ND.Lw&&(r=!0);0!=b&&h!=b&&(h=[Object.assign(new ca.a,{name:"TOCPageNo",string:b}),Object.assign(new ca.a,{name:"HeadingPageNo",string:h}),Object.assign(new ca.a,{name:"isPageView",string:r})],Lb.a("TOCPageNoMismatch",!0,void 0,h))}}c$k(b){for(let h=0;h<b.qa.length;h++){const r=b.qa.J(h);if(null!=r.af)for(let z=0;z<r.af.length;z++){const R=r.af.J(z);if(1===R.Yl&&R.instruction.trim().startsWith("PAGEREF"))return parseInt(b.characterData.substr(r.cp,
b.characterData.length-r.cp))}}return 0}GCl(b){return b?b.ia(yc.a.zM,null):(v.ULS.sendTraceTag(38638673,324,10,"Node is null in GetParaIdForUpdate."),null)}Mil(b){return this.Xc.WAa(b,7,7).Rb(35)}ZNl(b){const h=[];h.push(b+",TOC,0");return h}static dwa(){t.AFrameworkApplication.K&&t.AFrameworkApplication.K.$("WordEditorTOCFloodgateIsEnabled")&&window.setTimeout(()=>{const b=Sa.a.instance.Za("Common.ISystemInitiatedFeedback");b&&b.execute(h=>{h.logActivity("InsertTOCInWordWeb","WordEditorTOCFloodgateIsEnabled")})},
ks.zka)}}ks.zka=5E3;ks.umj="WordUpdateTOC";ks.EB="wwaengidc";Object(n.a)(ks,"TableOfContentsActor",null,[415]);class Hy{}Object(n.a)(Hy,"FieldData",null,[]);class Iy extends Hy{constructor(){super();this.Klb=null}}Object(n.a)(Iy,"TOCFieldData",Hy,[]);class sB{constructor(b,h,r,z,R,ba=null){this.IXl=b;this.Ts=h;this.yj=r;this.T8i=z;this.listMarker=R;this.iNa=ba}}Object(n.a)(sB,"TOCHeadingData",null,[]);class yA{constructor(b,h){this.WRa=b;this.nl=h}RRh(b){return Object(Ht.__awaiter)(this,void 0,void 0,
function*(){this.WRa.Omf=b.Pmf;this.WRa.aFb=b.aFb;this.WRa.lMb=b.lMb;return this.WRa.kul()})}xjl(b){if(b=this.wjl(b))return this.nl.pea(b)}wjl(b){const h=b.qa.length;for(let r=0;r<h;r++){const z=b.qa.J(r);if(z.hyperlink&&z.hyperlink.Vla&&z.hyperlink.url.startsWith(B.a.qab))return z.hyperlink.url.substr(z.hyperlink.url.indexOf("_Toc"))}return null}t3d(b){(b=this.xjl(b))&&this.nl.yWd(b.id)}TKl(){return this.WRa.iul()}dGi(b,h){const r=new Iy,z=new Ua.a;for(let R of b){b=this.SKl(R,h);if(!b)return null;
z.add(b)}r.Klb=z;return r}SKl(b,h){let r;if(h&&(r=this.ZHk(b),!r))return v.ULS.sendTraceTag(591184344,3019,10,"Unable to create bookmark for Table of Contents"),null;h=dd.AParagraphNode.lU(b.characterData.trim());const z=this.CMl(b.VLa);return new sB(h,r,b.yj,z,b.listMarker,b.iNa)}ZHk(b){const h=String.format("{0}{1}","_Toc",ac.a.RF());return this.nl.HWb(h,b.begin,b.end,b.paragraphNode,b.paragraphNode)?h:null}CMl(b){return String.format("toc {0}",b)}}Object(n.a)(yA,"TOCDataManager",null,[414]);class jx{K0f(){const b=
Object.assign(new te.StandardDialog,{Bt:t.AFrameworkApplication.J$,Fd:0,tEa:!1});b.tU(1);b.Sga(WordEditorIntl.WordEditorStrings.L_EmptyTOCDialogTitle,WordEditorIntl.WordEditorStrings.L_EmptyTOCDialogMessage,()=>{})}static get instance(){return null!=jx.Dmg?jx.Dmg:jx.Dmg=new jx}}Object(n.a)(jx,"TOCDialogHelper",null,[]);var tB=d(194),eC=d(827),uB=d(340),zA=d(173);class On{constructor(b,h,r,z,R,ba,ta){this.L0f=b;this.Vfb=h;this.Pmf=r;this.aFb=z;this.lMb=R;this.Uub=ba;this.t3c=[];this.instruction=ta}toString(){return"showPageNumber:"+
this.L0f+"  isHyperlink:"+this.Vfb+" includeOutlineLevels:"+this.Pmf+" lowerOutlineLevel:"+this.aFb+" upperOutlineLevel:"+this.lMb+" addContentControl:"+this.Uub+" unsupportedSwitches:"+this.t3c.toString()}}Object(n.a)(On,"TOCSettings",null,[]);class ak{constructor(b,h,r,z,R,ba,ta,Wa,ub,Ib,$b,fc,Kc,ed,Jd,ge,qe,Ve,Bd){this.kJg="TOC";this.ime=this.rKe=null;this.M3a=b;this.Kh=h;this.tC=r;this.iS=z;this.BC=R;this.Ok=ba;this.ib=ta;this.Vd=Wa;this.s3g=ub;this.mg=Ib;this.pKe=$b;this.No=Kc;this.OH=ed;this.zn=
Jd;this.Hc=ge;this.Hb=qe;this.sg=Ve;this.fb=Bd}get LMc(){return this.kJg}set LMc(b){this.kJg=b}get Llb(){this.rKe||(this.rKe=this.vPh());return this.rKe}vPh(){return new On(!0,!0,!0,0,8,!0,this.w7m())}yIk(b){Object(Ht.__awaiter)(this,void 0,void 0,function*(){Lb.a(ak.jOk);const h=window.performance.now();if(this.fb.nc(b.node))if(this.Ok.T$(b))v.ULS.shipAssertTag(592233794,3019,!1,"We can't insert table of contents, current insertion point is in locked range"),ak.oNa("IP is in locked range");else{var r=
yield this.M3a.RRh(this.Llb);if(r){var z=new Ic.a(2,1,0,()=>{this.lOk(b,r,this.Llb.Vfb,h)});this.Hb.$b(z)}else v.ULS.sendTraceTag(592233795,3019,10,"Failed to create table of contents."),ak.oNa("Failed to get TOC data")}else v.ULS.shipAssertTag(592233793,3019,!1,"We can't insert table of contents, current context is not paragraph context"),ak.oNa("Context should be paragraph")})}lOk(b,h,r,z=0){let R;try{if(0==z&&(z=window.performance.now()),this.OGh(b.node)){var ba=new Nd.GraphIterator;ba.set(b.node);
ba.Bb(7);ba.kd(7);R=this.Hc.Rc(15);R.Ou(ba);var ta=this.M3a.dGi(h,r);ta||ak.oNa("Failed to prepare TOC Field data");var Wa=ta.Klb?ta.Klb.count:0;if(Wa){h=null;var ub;for(r=0;r<Wa;r++){const Kc=ta.Klb.J(r);if(!({Lxb:ub}=this.k9h(b,h,r,Wa,Kc,$b?$b.toString():void 0)).returnValue){ak.oNa("Failed to populate new TOC paragraph");return}if(0==r){var Ib=ub.currentNode;var $b=ie.ParagraphReader.qT(Ib)}h=ub}if(this.Llb.Uub&&!this.x_e(Ib.id,h.Cn.id))ak.oNa("Failed to add content control block");else{var fc=
window.performance.now()-z;Lb.a(ak.$0e,!0,fc)}}else if(this.pKe.K0f(),this.qJk(b)){const Kc=window.performance.now()-z;Lb.a(ak.$0e,!0,Kc)}}else ak.oNa("Failed to fetch style set")}catch(Kc){ak.oNa(String.format("{0} {1}",Kc.message,Kc.stack))}finally{R&&R.dispose()}}OGh(b){this.ime=this.BC.Qx(b);return this.ime?!0:(v.ULS.sendTraceTag(592233796,3019,15,"Failed to fetch style set"),!1)}static KCa(b){b=[Object.assign(new ca.a,{name:ak.Lmo,string:b})];Lb.a(ak.e9f,!1,void 0,b)}static $xf(b){b=[Object.assign(new ca.a,
{name:ak.Zqn,string:b})];Lb.a(ak.COi,!1,void 0,b)}static oNa(b){b=[Object.assign(new ca.a,{name:ak.kOk,string:b})];Lb.a(ak.$0e,!1,void 0,b)}rio(b){return Object(Ht.__awaiter)(this,void 0,void 0,function*(){const h=this.XZh(b);if(null==h)ak.KCa("Cannot update TOC when firstTocPara = null");else{var r=this.VKl(h);if(0<r.t3c.length)return this.cCm(r.t3c),!1;Lb.a(ak.Kmo);var z=window.performance.now(),R=yield this.M3a.RRh(r);if(!R)return v.ULS.sendTraceTag(559248668,3019,10,"Failed to get data for TOC update."),
ak.KCa("Failed to fetch TOC data"),!1;var ba=new Ic.a(1,1,0,()=>{this.Mmo(h,R,r,z)});this.Hb.$b(ba);return!0}})}Mmo(b,h,r,z=0){let R;try{if(null==b)ak.KCa("Attempt to update TOC when firstTocPara = null");else{0==z&&(z=window.performance.now());var ba=new Nd.GraphIterator;ba.set(b);ba.Bb(7);ba.kd(7);R=this.Hc.Rc(15);R.Ou(ba);var ta=this.M3a.dGi(h,r.Vfb);if(null==ta)ak.KCa("Attempt to update TOC when tocFieldData = null");else{var Wa;if(({NVe:Wa}=this.$Ni(b,r)).response){v.ULS.sendTraceTag(559018207,
3019,50,String.format("Attempting to update TOC with settings: {0}",r.toString()));var ub=ta.Klb?ta.Klb.count:0;if(this.OGh(b)){var Ib;this.Cfi(b)&&(this.BOi(b),(b=this.fb.Vg(b,!1,!0))&&(Ib=b.ia(yc.a.Nc,null).toString()));var $b=b.ia(yc.a.zM,null);h=$b;Ib=null!==Ib&&void 0!==Ib?Ib:$b;if(ub){for(var fc=0,Kc;b.Sr&&h==$b&&fc<ub;){let ge=ta.Klb.J(fc);r.Vfb&&this.M3a.t3d(b);if(!this.nmo(b,fc,ub,ge,r)){v.ULS.sendTraceTag(559248669,3019,10,"Failed to Update TOC Paragraph.");ak.KCa("Failed to update TOC paragraph");
return}b.setValue(yc.a.zM,Ib);fc++;Kc=b;b=this.fb.Vg(Kc,!1,!0);if(!b){h=null;break}this.Hfi(b)&&this.AOi(b);h=b.ia(yc.a.zM,null)}h==$b&&this.pSf(b);var ed;if(({Avf:ed}=this.s4j(ta,fc,ub,Kc,Ib)).response)if(r.Uub&&!this.x_e(Wa,ed.id))ak.KCa("Failed to add content control block");else{var Jd=window.performance.now()-z;Lb.a(ak.e9f,!0,Jd)}else ak.KCa("Failed to add new paragraph")}else this.pKe.K0f(),this.Hmo(b,r.Uub,Wa,r.instruction,Ib)&&(fc=window.performance.now()-z,Lb.a(ak.e9f,!0,fc))}else ak.KCa("Failed to fetch style set")}else ak.KCa("Failed to remove Content Control")}}}catch(ge){ak.KCa(String.format("{0} {1}",
ge.message,ge.stack))}finally{R&&R.dispose()}}s4j(b,h,r,z,R){let ba=new Nd.GraphIterator;for(ba.set(z);h<r;){z=b.Klb.J(h);if(!({Lxb:z}=this.k9h(null,ba,h,r,z,R)).returnValue)return{Avf:ba.currentNode,response:!1};ba=z;h++}return{Avf:ba.currentNode,response:!0}}$Ni(b,h){var r,z,R;let ba,ta;const Wa=null===(r=null===b||void 0===b?void 0:b.qa)||void 0===r?void 0:r.first.Mb;if(Wa&&0<Wa.length)if(b=b.qa.first.Mb.J(0),b.Vf){r=b.contentControlNode.getValue(yc.a.Gy);ba=this.sg.ir.get(null===(z=b.contentControlNode.id)||
void 0===z?void 0:z.toString());ta=this.sg.Bs.get(null===(R=b.contentControlNode.id)||void 0===R?void 0:R.toString());if(0!=this.No.xjb(r))return v.ULS.sendTraceTag(558952907,3019,10,"Failed to release content control"),{response:!1,NVe:ba,Skh:ta};h.Uub=!0}else v.ULS.sendTraceTag(528537613,3019,15,"Content control is not block type"),h.Uub=!1;else h.Uub=!1;return{response:!0,NVe:ba,Skh:ta}}Hmo(b,h,r,z,R){v.ULS.sendTraceTag(559018209,3019,50,"Updating old TOC to empty TOC");this.M3a.t3d(b);let ba=
this.XEd(b);if(!this.oFi(ba,h,r,z))return ak.KCa("Failed to populate empty TOC."),!1;if(h=this.fb.Vg(b,!1,!0))r=b.ia(yc.a.zM,null),z=h.ia(yc.a.zM,null),r==z&&this.pSf(h);b.setValue(yc.a.zM,R);return!0}oFi(b,h,r,z){this.Vd.replaceTextRange(b,WordEditorIntl.WordEditorStrings.L_EmptyTOCText);b=b.node;this.jsi(b);this.mg.UF(b.qa.first.formatting,!0);this.J_e(b,0,1,z);return h&&r&&!this.x_e(r,b.id)?!1:!0}XEd(b){b.qa.reset();b.eWa();const h=new tB.a(b,0);h.formatting=new zA.a(h,E.a.nil);h.Xh=!0;b.qa.add(h);
return Qe.a.createTextRange(b,0,b.characterData.length)}Cfi(b){if(ie.ParagraphReader.uT(b)){var h=b.qa.last.af;if(!h||!h.length)return!1;if(4<=h.length){b=0===h.J(h.length-4).Yl;const r=1===h.J(h.length-3).Yl&&h.J(h.length-3).instruction.trim().startsWith(this.LMc),z=2===h.J(h.length-2).Yl;h=5===h.J(h.length-1).Yl;return b&&r&&z&&h}}return!1}Hfi(b){if(ie.ParagraphReader.uT(b)){var h=b.qa.first.af;if(!h||!h.length)return!1;if(2<=h.length)return b=4===h.J(0).Yl,h=3===h.J(1).Yl,b&&h}return!1}BOi(b){const h=
b.qa.last.af,r=h.J(h.length-4),z=h.J(h.length-3),R=h.J(h.length-2),ba=h.J(h.length-1);h.remove(r);h.remove(z);h.remove(R);h.remove(ba);b.removeProperty(yc.a.zM)}AOi(b){const h=b.qa.first.af,r=h.J(0),z=h.J(1);h.remove(r);h.remove(z);b.removeProperty(yc.a.zM)}pSf(b){if(b){var h=b.ia(yc.a.zM,null),r=b.ia(yc.a.Nc,null).toString(),z=h;r==h&&this.Cfi(b)&&(this.BOi(b),(b=this.fb.Vg(b,!1,!0))&&(z=b.ia(yc.a.zM,null)));r=new Nd.GraphIterator;r.set(b);r.Bb(8);v.ULS.sendTraceTag(559018210,3019,50,"Attempting to remove TOC paragraphs");
for(var R;b&&b.Sr&&z==h&&R!=b;){if(this.Hfi(b)){this.AOi(b);break}this.M3a.t3d(b);this.zn.Zd(r);z=this.zn.Vr(r,!1,!0);this.Kh.QDa(b);if(!z)return null;R=b;r.Rb(2);z=(b=r.currentNode)?b.ia(yc.a.zM,null):null}return b}}VKl(b){var h=b.qa,r=h?h.length:0,z=null;b=new On(!0,!1,!1,0,8,!0,void 0);for(let R=0;R<r&&(z=this.UKl(h.J(R)),b.instruction=z,z=this.YHl(z),z[0]!==this.LMc);R++);h=z?z.length:0;for(r=1;r<h;r++)switch(z[r]){case "\\h":b.Vfb=!0;break;case "\\u":b.Pmf=!0;break;case "\\o":this.RMn(z[r+1],
b)&&r++;break;case "\\z":break;case "\\n":b.L0f=!1;b.t3c.push(z[r]);break;default:b.t3c.push(z[r])}return b}RMn(b,h){return b&&(b=b.match(RegExp('^"([0-9])-([0-9])"$')))&&3===b.length?(h.aFb=Number.parseInvariant(b[1])-1,h.lMb=Number.parseInvariant(b[2])-1,!0):!1}vpn(b){try{Lb.a(ak.Yqn);const h=window.performance.now(),r=this.XZh(b);if(null==r){ak.$xf("Attempt to remove TOC when firstTocPara = null");return}let z,R,ba;const ta=this.vPh();if(!({NVe:z,Skh:R}=this.$Ni(r,ta)).response)return ak.$xf("Failed to remove content control"),
!1;if(void 0==z&&void 0==R)ba=this.pSf(r);else{ba=r.Lc.Eb(z);let ub=new Nd.GraphIterator;ub.set(ba);ub.Bb(8);b=!1;let Ib;for(;!b&&ba&&Ib!=ba;){ba.id.equals(R)&&(b=!0);ba&&ba.Sr&&this.M3a.t3d(ba);this.zn.Zd(ub);const $b=this.zn.Vr(ub,!1,!0);this.Kh.QDa(ba);if(!$b){ba=null;break}ub.Rb(2);Ib=ba;ba=ub.currentNode}}ba&&this.nSc(ba);const Wa=window.performance.now()-h;Lb.a(ak.COi,!0,Wa)}catch(h){ak.$xf(String.format("{0} {1}",h.message,h.stack))}return!0}nSc(b){b=Qe.a.Uc(b,0);b=new tm.Selection([b],!0);
this.ib.setSelection(b)}x_e(b,h){return this.No.uja(b,h,null,ak.gZk,!0).returnValue?(v.ULS.sendTraceTag(573653840,3019,10,"Failed to create content control block for table of contents."),!1):!0}Ftk(){this.M3a.TKl()||this.pKe.K0f()}XZh(b){if(!b.Sr)return v.ULS.sendTraceTag(528320659,3019,15,"Cannot get TOC Begin Paragraph. Para is not in TOC"),null;b=b.ia(yc.a.zM,null);return this.OH.PCl(b)}cCm(b){b.length&&(b=[Object.assign(new ca.a,{name:"UnsupportedSwitches",string:b.toString()})],Lb.a("UnsupportedTocInstruction",
void 0,void 0,b))}UKl(b){const h=(b=b.af)?b.length:0;for(let r=0;r<h;r++)if(1===b.J(r).Yl&&b.J(r).instruction.trim().startsWith(this.LMc))return b.J(r).instruction.trim();return null}YHl(b){const h=[];if(!b)return h;b=b.split(" ");return b.length?b:h}qJk(b){b=this.Auh(b,null,!0,void 0).returnValue;if(!b)return ak.oNa("Failed to create paragraph"),!1;const h=Qe.a.Uc(b,0);if(!this.oFi(h,!0,b.id,this.Llb.instruction))return ak.oNa("Failed to populate empty TOC"),!1;v.ULS.sendTraceTag(575447938,3019,
50,"Created an empty table of contents.");return!0}Auh(b,h,r,z){let R,ba;r&&b?(R=this.FJk(b),ba=R.currentNode,z=ie.ParagraphReader.qT(ba).toString()):h&&(R=this.gAl(h),ba=this.Kh.zN(R));if(!ba)return v.ULS.sendTraceTag(592233798,3019,15,"Failed to insert paragraph for table of contents"),{returnValue:null,Lxb:R};ba.setValue(yc.a.zM,z);return{returnValue:ba,Lxb:R}}w7m(){const b=new Sys.StringBuilder(this.LMc);b.append(" \\o \\z \\u");b.append(" \\h");return b.toString()}K7m(b){const h=new Sys.StringBuilder("PAGEREF ");
h.append(b);this.Llb.Vfb&&h.append(" \\h");return h.toString()}gAl(b){b.vd();this.zn.Zd(b);return this.Kh.xta(b,!1)}FJk(b){const h=new Nd.GraphIterator;h.set(b.node);h.vd();this.zn.Zd(h);let r=this.GUh(h);const z=!b.cpBegin;if(vg.OutlineElementReader.isEmpty(h,!0))return this.$8h(r);if(z)return this.Kh.eD(r,!0,!1),this.Kh.mba(h,r,b,!1,!1,!1),b=this.GUh(r),this.$8h(b);r=this.Kh.xta(h);this.Kh.mba(h,r,b,!1,!1,!0);b=this.Kh.xta(h);this.Kh.OJb(b.currentNode,!1);this.Kh.zN(b);this.zn.De(b);return b}GUh(b){const h=
new Nd.GraphIterator;h.fd(b);h.vd();return h}$8h(b){this.Kh.eD(b,!0,!0);this.Kh.OJb(b.currentNode,!1);this.zn.De(b);return b}jsi(b){const h=b.qa;1===h.length&&(h.first.Xh=!1,b.RAd().Xh=!0)}nmo(b,h,r,z,R){let ba=this.XEd(b);this.Vd.replaceTextRange(ba,"");this.sFi(b,z,R);this.J_e(b,h,r,R.instruction);return R.Vfb&&!this.NG(b,z.Ts)?!1:!0}k9h(b,h,r,z,R,ba){h=({Lxb:b}=this.Auh(b,h,0==r,ba)).returnValue;if(!h)return{returnValue:!1,Lxb:b};this.sFi(h,R,this.Llb);this.J_e(h,r,z,this.Llb.instruction);return this.Llb.Vfb&&
!this.NG(h,R.Ts)?{returnValue:!1,Lxb:b}:{returnValue:!0,Lxb:b}}sFi(b,h,r){this.z5l(b,h.IXl,h.listMarker,h.T8i,h.iNa);this.s3g.U6l(b,b.characterData.length);r.L0f&&this.p6l(b,h);this.jsi(b);this.fPn(b,h.T8i)}Rxl(b,h){if(!b)return 0;const r=ak.DMl();return 4<b.length?r.J(h)+.5*Math.floor(b.length/3):r.J(h)}z5l(b,h,r,z,R){r&&this.M5l(b,r,z);r=Qe.a.Uc(b,b.characterData.length);this.Vd.replaceTextRange(r,h);R&&(b=b.qa.ji(0),this.mg.p_(b.formatting,R))}M5l(b,h,r){r=this.Rxl(h,r);const z=Qe.a.Uc(b,0);this.Vd.replaceTextRange(z,
h);this.s3g.N5l(b,h.length,r)}p6l(b,h){var r=Qe.a.Uc(b,b.characterData.length);this.Vd.replaceTextRange(r,h.yj.toString());r=b.qa.ji(b.characterData.length-h.yj.toString().length);h=this.K7m(h.Ts);this.eMa(b,r,0,2,h);this.eMa(b,r,1,2,h);this.eMa(b,r,2,2,h);r=b.qa.ji(b.characterData.length);this.eMa(b,r,3,2,h)}fPn(b,h){h=this.ime.xh(h);this.iS.oM(h,b,!0)}J_e(b,h,r,z){const R=b.qa.first,ba=b.qa.last;h?this.eMa(b,R,4,1,z):(this.eMa(b,R,0,1,z),this.eMa(b,R,1,1,z),this.eMa(b,R,2,1,z));h===r-1?this.eMa(b,
ba,3,1,z):this.eMa(b,ba,5,1,z)}eMa(b,h,r,z,R=null){r=new eC.a(h,null,r,z,!0,!1,!1,R);h.af||(h.af=new uB.a(h));h.af.add(r);b.wn();this.NOk(r,b)}NOk(b,h){xg.a.instance.J(6)&&(b.Ee?h.wordRunProperties.DZ(b.Ee-1,2):h.wordRunProperties.wta(b.Ee,2),h.wordRunProperties.Hq.Z(b.Ee,Eu.CharacterPropertiesEditor.CQ),h.wordRunProperties.gt.Z(b.Ee,Eu.CharacterPropertiesEditor.aU))}NG(b,h){b=Qe.a.createTextRange(b,0,b.characterData.length);return this.tC.NG(b,h,!1,!1,!1,!0)?!0:(v.ULS.sendTraceTag(592233799,3019,
50,"Failed to create hyperlink for table of contents entries"),!1)}static DMl(){ak.Wqa||(ak.Wqa=new Lc.a,ak.Wqa.Z("toc 1",1),ak.Wqa.Z("toc 2",1.5),ak.Wqa.Z("toc 3",2),ak.Wqa.Z("toc 4",2.5),ak.Wqa.Z("toc 5",3),ak.Wqa.Z("toc 6",3.5),ak.Wqa.Z("toc 7",4),ak.Wqa.Z("toc 8",4.5),ak.Wqa.Z("toc 9",5));return ak.Wqa}}ak.Wqa=null;ak.gZk="Table of Contents";ak.jOk="CreateTocClient";ak.$0e="CreateTocSuccess";ak.kOk="CreateTocFailureCause";ak.Kmo="UpdateTocClient";ak.e9f="UpdateTocSuccess";ak.Lmo="UpdateTocFailureCause";
ak.Yqn="RemoveTocClient";ak.COi="RemoveTocSuccess";ak.Zqn="RemoveTocFailureCause";Object(n.a)(ak,"TOCField",null,[412,413]);var lv=d(649);class Ez{constructor(b,h){this.fxa=b;this.RFa=h}U6l(b,h){if(ie.ParagraphReader.nc(b)&&!(0>h)){var r=km.a.EYb(b);r=new lv.a(r,4,1,1);this.fxa.yMd(b,r);b=Qe.a.Uc(b,h);this.RFa.MMd(b)}}N5l(b,h,r){var z=Cl.a.OJ/2;const R=b.qa.K2b(h);z=Aj.FormattingReader.Gn(R.formatting,We.a.fontSize,2*z)/2;r=new lv.a(pg.a.BA(z/36)*r,1,0,1);this.fxa.yMd(b,r);b=Qe.a.Uc(b,h);this.RFa.MMd(b)}}
Object(n.a)(Ez,"TOCTabUtility",null,[411]);class Rv{constructor(){this.W=null}get name(){return"WordEditor.TableOfContents"}yc(b){this.W=b;this.W.ha("WordEditor.AutoSaveParamsUpdateService",()=>new Cz.a(this.W.resolve("Box4.Graph.IGraphIteratorFactory"),Qv.a.PP)).singleInstance();this.W.ha("WordEditor.TableOfContents.StyleBasedDocumentHeadings",()=>new Dz(new De.a(()=>vb.App.xa.jb.Yc),ml.PageNavigator.instance,this.W.resolve("Box4.Styles.IWACStyleReader"),this.W.resolve("Box4.List.IListReader"),this.W.resolve("Box4.IListMarkerUtility"),
new Wq.a,new De.a(()=>vb.App.xa.jb.Ic))).as("WordEditor.TableOfContents.IDocumentHeadings").singleInstance();this.W.ha("WordEditor.TableOfContents.TOCDataManager",()=>new yA(this.W.resolve("WordEditor.TableOfContents.IDocumentHeadings"),this.W.resolve("WordEditor.Bookmark.IBookmarkManager"))).as("Box4.ITOCDataManager").singleInstance();this.W.ha("WordEditor.TableOfContents.TOCTabUtility",()=>new Ez(this.W.resolve("WordEditor.ICustomTabStopUtility"),this.W.resolve("Box4.IBlobEditor"))).as("WordEditor.TableOfContents.ITOCTabUtility").singleInstance();
this.W.ha("WordEditor.TableOfContents.TOCField",()=>new ak(this.W.resolve("Box4.ITOCDataManager"),this.W.resolve("Box4.IOutlineElementEditor"),this.W.resolve("Box4.IHyperlinkEditor"),this.W.resolve("Box4.Styles.IWACStyleEditor"),this.W.resolve("Box4.Styles.IWACStyleReader"),Yh.a.instance,this.W.resolve("Box4.ISelectionManager"),this.W.resolve("Box4.ICharacterPropertiesEditor"),this.W.resolve("WordEditor.TableOfContents.ITOCTabUtility"),this.W.resolve("Box4.IFormattingEditor"),jx.instance,this.W.resolve("Box4.IFeatureHelper"),
this.W.resolve("WordEditor.ContentControl.IContentControlManager"),this.W.Pa("WordEditor.ParagraphWordIdMapping"),this.W.resolve("Box4.IOutlineElementNavigator"),$m.a.instance,t.AFrameworkApplication.uc,this.W.resolve("Box4.ContentControlParagraphMapping"),b.resolve("Box4.IParagraphReader"))).as("WordEditor.TableOfContents.ITOCField").singleInstance();this.W.ha("WordEditor.TableOfContents.TableOfContentsActor",()=>new ks(t.AFrameworkApplication.ya,this.W.resolve("WordEditor.AutoSaveParamsUpdateService"),
this.W.resolve("Box4.IOutlineElementEditor"),this.W.resolve("Box4.Graph.IGraphIteratorFactory"),$m.a.instance,Yh.a.instance,this.W.resolve("WordEditor.TableOfContents.ITOCField"),this.W.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,this.W.resolve("Box4.IFeatureHelper"),this.W.Za("WordEditor.IPageNumberFinder"),b.resolve("WordEditor.IMainViewModeManager"))).as("WordEditor.TableOfContents.ITableOfContentsActor").singleInstance()}init(){this.W.resolve("WordEditor.TableOfContents.ITableOfContentsActor").Vb()}dispose(){}}
Object(n.a)(Rv,"PackageManager",null,[1,2]);class Uo{constructor(b,h,r,z,R,ba,ta,Wa){this.xOa=(ub,Ib,$b,fc,Kc)=>{if(!({Gx:ub}=this.Jkb(Ib,$b,Kc,!0,!0)).returnValue)return ub;this.xnd.Nth(Kc,Ib.node);return 32};this.fva=(ub,Ib,$b,fc,Kc)=>this.q3h(Ib,$b,fc,Kc,!0);this.jHb=(ub,Ib,$b,fc,Kc)=>{if(!({Gx:ub}=this.Jkb(Ib,$b,Kc,!1,!0)).returnValue)return ub;this.xnd.kLk(Kc,Ib.node);v.ULS.sendTraceTag(7878019,324,50,"Gallery expanded");return 32};this.Fja=(ub,Ib,$b,fc,Kc)=>{if(!({Gx:fc}=this.Jkb(Ib,$b,Kc,!1,
!0)).returnValue)return 2==$b&&8==fc&&hs.a.recordQosError("TableStyleButtonClickNoResponse",["TableInteractionFailed"],Xc.a.Yyb),fc;const ed=Ib.node;let Jd=null;(Jd=ub===Fb.a.Fja?this.xnd.EMb(Kc[Yf.a.SourceControlId],ed):this.xs.ZAb(ed,Kc))?(this.z_d(ed,()=>{this.zpd.APa(Jd,ed)}),this.AO(),fc=32):(hs.a.recordQosError("TableStyleButtonClickNoResponse",["TableInteractionFailed"],Xc.a.Yyb),fc=8);ub===Fb.a.Fja&&32===fc&&v.ULS.sendTraceTag(38410445,311,50,"ApplyTableStyle succeeded");v.ULS.shipAssertTag(0,
324,32===fc);return fc};this.vra=(ub,Ib,$b,fc,Kc)=>this.q3h(Ib,$b,fc,Kc,!1);this.hae=(ub,Ib,$b,fc,Kc)=>hq.a.kna(ub,Ib,$b,fc,Kc,{},14);this.Fwb=(ub,Ib,$b,fc,Kc)=>{if(!({Gx:ub}=this.Jkb(Ib,$b,Kc,!1,!1)).returnValue)return ub;const ed=Ib.node;this.z_d(ed,()=>{this.zpd.mnh(ed)});return 32};this.xs=b;this.xnd=h;this.ga=r;this.zpd=z;this.Hc=R;this.Gw=ba;this.$Jj=Wa}Vb(){this.Xbc(vb.App.K3a.rth())}Xbc(b){this.ga.pa(Fb.a.xOa,kc.a.view,b);this.ga.pa(Fb.a.xOa,kc.a.table,this.xOa);this.ga.Vc(Fb.a.xOa,1127);
this.ga.pa(Fb.a.Fja,kc.a.view,this.hae);this.ga.pa(Fb.a.Fja,kc.a.table,this.Fja);this.ga.Vc(Fb.a.Fja,1030);this.ga.pa(Fb.a.applyStyle,kc.a.table,this.Fja);this.ga.pa(Fb.a.vra,kc.a.view,this.hae);this.ga.pa(Fb.a.vra,kc.a.table,this.vra);this.ga.Vc(Fb.a.vra,1038);this.ga.pa(Fb.a.fva,kc.a.view,b);this.ga.pa(Fb.a.fva,kc.a.table,this.fva);this.ga.Vc(Fb.a.fva,1127);this.ga.pa(Fb.a.jHb,kc.a.view,b);this.ga.pa(Fb.a.jHb,kc.a.table,this.jHb);this.ga.Vc(Fb.a.jHb,1126);this.ga.pa(Fb.a.Fwb,kc.a.view,this.hae);
this.ga.pa(Fb.a.Fwb,kc.a.table,this.Fwb);this.ga.Vc(Fb.a.Fwb,1028)}AO(){t.AFrameworkApplication.K&&t.AFrameworkApplication.K.$("WordEditorTablesSupportFloodgateIsEnabled")&&window.setTimeout(()=>{const b=Sa.a.instance.Za("Common.ISystemInitiatedFeedback");b&&b.execute(h=>{h.logActivity("WordEditorTablesUsageSupport","WordEditorTablesSupportFloodgateIsEnabled")})},5E3)}q3h(b,h,r,z,R){if(!({Gx:ba}=this.Jkb(b,h,z,R,!0)).returnValue)return 2==h&&8==ba&&hs.a.recordQosError("TableStyleOptionButtonClickNoResponse",
["TableInteractionFailed"],Xc.a.Q6k),ba;b=b.node;h=this.xs.nT(b);var ba=z[Yf.a.On];const ta=Uo.nLl(z.MenuItemId);R?z[Yf.a.On]=Uo.GUn(h,ta):(this.iek(h,ta,ba,b),r.Lr=ta,r.xB=ba?0:1,v.ULS.shipAssertTag(0,324,!!ta));return 32}z_d(b,h){const r=this.Hc.Rc(15);try{r.Db(b),this.Gw.f2a(),h()}finally{r&&r.dispose()}}Jkb(b,h,r,z,R){return this.Ilm(b,h,r,z,R)?{returnValue:z||2===h,Gx:32}:{returnValue:!1,Gx:8}}Ilm(b,h,r,z,R){if(b.contextId!==kc.a.table)return!1;if(z||2===h)if(R&&!r||!Object(nb.a)(yq.TableNode,
b.node)||this.$Jj(b.node))return!1;return!0}iek(b,h,r,z){const R=(512===h||1024===h?!r:r)?b|h:b&~h;R!==b&&this.z_d(z,()=>{this.zpd.Wna(R,z)})}static Zz(){Uo.X9a[Uo.ial]=32;Uo.X9a[Uo.$$k]=128;Uo.X9a[Uo.Fpm]=64;Uo.X9a[Uo.xpm]=256;Uo.X9a[Uo.ohk]=512;Uo.X9a[Uo.nhk]=1024}static GUn(b,h){b=!!(b&h);if(512===h||1024===h)b=!b;return b}static nLl(b){let h=0;b in Uo.X9a&&(h=Uo.X9a[b]);return h}}Uo.ial="buttonFirstRow";Uo.$$k="buttonFirstColumn";Uo.Fpm="buttonLastRow";Uo.xpm="buttonLastColumn";Uo.ohk="buttonBandedRow";
Uo.nhk="buttonBandedColumn";Uo.X9a={};Object(n.a)(Uo,"TableStyleActor",null,[]);Uo.Zz();var Fz=d(766);class AA extends ap.a{constructor(){super();this.TableStyles=this.TableCellStyles=null;this.columns=0}}Object(n.a)(AA,"TableGalleryButtonProps",ap.a,[]);class Gz extends AA{constructor(){super()}get Type(){return 6}}Object(n.a)(Gz,"TableStyleGalleryButtonProps",AA,[]);class Iu{}Iu.lMm=2147483647;Object(n.a)(Iu,"TableStyleUtil",null,[]);class Gn{constructor(b,h,r){this.dXe="Clear";this.Wyb=null;this.dXj=
b;this.He=h;this.xs=r;this.hQ=t.AFrameworkApplication.hQ;this.pr=t.AFrameworkApplication.pr}zXa(){}N2j(b,h){this.zXa(b);const r=this.VLh(b),z=r.length;if(!(0>=z)){var R=Iu.lMm,ba=null;for(let ub=0;ub<z;ub++){var ta=r[ub],Wa=this.xs.ALl(ta);R!==Wa&&(R=Object.assign(new hi.a,{Id:"msMoreTableStyles"+Wa,Title:this.BLl(Wa),ControlList:[]}),ba=Object.assign(new lo.a,{Type:6,Id:"galleryMoreTableStyles"+Wa,ExternalGalleryId:"TableStylesGallery",Width:Gn.X2f,ElementDimensions:"Size64by48",GalleryItems:[]}),
this.Wyb&&(ba.ExternalId=this.Wyb[Wa.toString()]),R.ControlList.push(ba),h.MenuSectionList.push(R),R=Wa);Wa=this.He.zF(ta);ta=Gn.h4f+ub;Wa=Object.assign(new Gz,{Id:ta,ExternalId:ta,Command:Fb.a.Fja.toString(),QueryCommand:Fb.a.xOa.toString(),LabelText:Wa?B.a.If(Wa):"",Alt:Wa,VerticalCenterAlign:"true"});Wa.TableCellStyles=this.qId(ta,b);Wa.TableStyles=this.MJc(ta,b);ba&&ba.GalleryItems.push(Wa)}}}M2j(b){const h=Object.assign(new hi.a,{Id:"msMoreTableStyleCommands",DisplayMode:"Menu16",ControlsId:"ctrlMoreTableStyleCommands",
ControlList:[]}),r=Object.assign(new nh.a,{Id:"fseaClearTableFormatting",Command:Fb.a.Fwb.toString(),LabelText:B.a.If(this.dXe),Alt:B.a.If(this.dXe),Image16by16:this.pr,Image16by16Class:Wh.getImageClassWithCluster(this.hQ,Gn.gxk),KeyTip:CommonUIStrings.l_ClearTableFormattingKeytip});h.ControlList.push(r);b.MenuSectionList.push(h)}Nth(b,h){this.zXa(h);const r=b[Yf.a.SourceControlId];var z=this.EMb(r,h);if(z){var R=this.xs.Nz(h);R=R?this.He.rf(R):null;var ba=this.He.zF(z);z=this.He.rf(z);b[Fi.a.Alt]=
ba;b[Fi.a.On]=z===R;h=Object.assign(new Gz,{Id:r,ExternalId:r,Command:Fb.a.Fja.toString(),QueryCommand:Fb.a.xOa.toString(),TableCellStyles:this.qId(r,h),TableStyles:this.MJc(r,h),Alt:ba});b[Fi.a.GalleryButtonProps]=h}else b[Fi.a.InnerHTML]=null,b[Fi.a.Alt]=null,b[Fi.a.On]=!1,b[Fi.a.GalleryButtonProps]=null}qId(b,h){this.zXa(h);return(b=this.EMb(b,h))?this.dXj.rNh(b,h):null}MJc(b,h){this.zXa(h);return this.EMb(b,h),null}kLk(b,h){b.MenuItems=this.Gzl(h)}Gzl(b){const h=Object.assign(new ni.a,{Id:"menuMoreTableStyles",
MenuSectionList:[]});this.N2j(b,h);this.M2j(h);return h}EMb(b,h){return b?b.startsWith(Gn.h4f)?this.mjf(parseInt(b.substr(Gn.h4f.length)),h):this.Cxn(parseInt(b.substr(Gn.l6n.length)),h):null}}Gn.h4f="buttonTableStyleMenu";Gn.l6n="buttonTableStyleRibbon";Gn.X2f=7;Gn.gxk="ClearTableStyle_16x16x32";Object(n.a)(Gn,"ATableStyleRibbonControl",null,[419]);class kx extends Gn{constructor(b,h,r){super(null,h,r);this.w2g=b}Nth(b,h){this.zXa(h);const r=b[Yf.a.SourceControlId];var z=this.EMb(r,h);if(z){var R=
this.xs.Nz(h);R=R?this.He.rf(R):null;var ba=this.He.zF(z);z=this.He.rf(z);b[Fi.a.Alt]=ba;b[Fi.a.On]=z===R;h=Object.assign(new Gz,{Id:r,ExternalId:r,Command:Fb.a.Fja.toString(),QueryCommand:Fb.a.xOa.toString(),TableCellStyles:this.qId(r,h),TableStyles:this.MJc(r,h),Alt:ba});b[Fi.a.GalleryButtonProps]=h}else b[Fi.a.InnerHTML]=null,b[Fi.a.Alt]=null,b[Fi.a.On]=!1,b[Fi.a.GalleryButtonProps]=null}qId(b,h){this.zXa(h);return(b=this.EMb(b,h))?this.w2g.rNh(b,h,5,5):null}MJc(b,h){this.zXa(h);return this.EMb(b,
h),null}}Object(n.a)(kx,"ATableStyleRibbonControlVariableSizePreviews",Gn,[]);var Hz=d(1439),Bk=d(1080);class hu{constructor(b,h,r,z){this.Njl=(R,ba)=>this.getBorder(R,this.cY.HL(ba));this.Mjl=(R,ba)=>this.getBorder(R,this.cY.QN(ba));this.BC=b;this.Qt=h;this.EUa=r;this.cY=z;this.yxj=new De.a(()=>this.Ljl());this.C5a=new De.a(()=>this.Kjl())}Ljl(){const b={},h=t.AFrameworkApplication.isRtl;b.top="border-top";b.left=h?"border-right":"border-left";b.bottom="border-bottom";b.right=h?"border-left":"border-right";
b.insideHorizontal="border-bottom";b.insideVertical=h?"border-left":"border-right";return b}Kjl(){const b={};b[sg.a.mza]=sg.a.wab;b[sg.a.wab]=sg.a.wab;b[sg.a.KVa]=sg.a.KVa;return b}AIk(b,h,r,z){const R=new Bk.a;R.rowCount=r;R.Wab=z;R.XPa=this.EUa.NKl(b);R.Ha=b.ia(yc.a.Ha,1);R.Ga=b.ia(yc.a.Ga,1);R.tableLook=h;R.aae=1;return R}rNh(b,h,r,z){if(!this.BC.rf(b)||!Object(nb.a)(23,b)||!Object(nb.a)(nl.a,h))return null;const R=this.Qt.nT(h);r=this.AIk(b,R,r,z);z=[];for(r.rowIndex=0;r.rowIndex<r.rowCount;r.rowIndex++)this.M4j(b,
h,r,z);return z}MJc(){return null}o2(){}M4j(b,h,r,z){r.e5b=!r.rowIndex;for(r.cellIndex=0;r.cellIndex<r.Wab;r.cellIndex++)this.q1j(b,h,r,z)}q1j(b,h,r,z){h=this.EUa.TBk(r,this.EUa.qcf(r),h,b);const R={};var ba=this.Qt.HEd(b,h,We.a.fontColor,!0,Im.a.b2(),"None");R.color=ba?ba:"inherit";ba=this.Qt.HEd(b,h,We.a.ZH,!0,Im.a.b2(),"None");R["background-color"]=ba?ba:"inherit";this.Qt.ICb()&&this.p5j(r,b,h,R);z.push(R)}p5j(b,h,r,z){b=this.EUa.hLa(b);this.Aqd(5,b,h,r,z);this.Aqd(3,b,h,r,z);this.Aqd(0,b,h,r,
z);this.Aqd(4,b,h,r,z)}Aqd(b,h,r,z,R){h=this.Cql(b,h,r,z);h!==sg.a.aF&&(R[this.yxj.value[Hz.a[b]]]=h)}Cql(b,h,r,z){let R=sg.a.aF;if(({Oja:R}=this.aFa(z,b,1,h,this.Mjl,R)).returnValue)return R;({Oja:R}=this.aFa(r,b,3,h,this.Njl,R));return R}aFa(b,h,r,z,R,ba){return this.cY.H2i(r,h,z)&&(ba=R(b,h))!==sg.a.aF||!h&&({Oja:ba}=this.aFa(b,1,r,z,R,ba)).returnValue||4===h&&({Oja:ba}=this.aFa(b,2,r,z,R,ba)).returnValue?{returnValue:!0,Oja:ba}:{returnValue:ba!==sg.a.aF,Oja:ba}}getBorder(b,h){let r="",z,R;({borderStyle:z,
borderWidth:R}=this.Pjl(b,h));if(z===sg.a.KVa)return r;r=String.format(sg.a.Vsd,R,z,this.Ejl(b,h));return r.trim()}Ejl(b,h){if(!h)return sg.a.$Y;b=this.Qt.czb(b,h.color,cq.a.auto);return b!==cq.a.auto?cq.a.MC(b):sg.a.$Y}Pjl(b,h){var r=sg.a.Bra;let z=sg.a.bF+sg.a.pYb;if(!h)return{borderStyle:r,borderWidth:z};r=this.Qt.czb(b,h.style,sg.a.KVa);b=this.Qt.czb(b,h.size,sg.a.bF);z=this.Ojl(r,b)+sg.a.pYb;r=this.Fjl(r);return{borderStyle:r,borderWidth:z}}Ojl(b,h){let r=2;b===sg.a.mYb&&h<sg.a.Nja&&(r=1);return r}Fjl(b){return this.C5a.value[b]||
sg.a.nYb}static CLl(){return new hu(Sa.a.instance.resolve("Box4.Styles.IWACStyleReader"),Sa.a.instance.resolve("WordEditor.IWACTableStyleReader"),mp.a.instance,sg.a.instance)}static get instance(){return null!=hu.Olg?hu.Olg:hu.Olg=hu.CLl()}}Object(n.a)(hu,"TableStylePreviewGenerator",null,[420]);var mv;(function(b){b[b.DBo=0]="background1";b[b.fMo=1]="text1";b[b.EBo=2]="background2";b[b.gMo=3]="text2";b[b.accent1=4]="accent1";b[b.accent2=5]="accent2";b[b.accent3=6]="accent3";b[b.accent4=7]="accent4";
b[b.accent5=8]="accent5";b[b.accent6=9]="accent6";b[b.hyperlink=10]="hyperlink";b[b.QEo=11]="followedHyperlink";b[b.QCo=12]="dark1";b[b.SGo=13]="light1";b[b.RCo=14]="dark2";b[b.TGo=15]="light2";b[b.none=16]="none";b[b.max=17]="max"})(mv||(mv={}));Object(n.b)("ThemeColor",mv);class It{constructor(b){this.Rxa=b}Ohl(b,h,r){let z;({MJi:h,nfh:z}=this.OFl(h));b=[];const R=[];for(let ta=0;16>ta;ta++){if(!(mv[ta]in r.Utb))continue;const Wa=ta,ub=String.format(Box4Intl.Box4Strings.l_ColorPickerTooltipBase,
WoncaIntl.WoncaStrings[z[Wa]],this.Jwl(ta));var ba=h[Wa];ba=ba&4278190080|(ba&255)<<16|ba&65280|(ba&16711680)>>>16;R.push(Object.assign(new Gq.a,{Color:Wa.toString(),DisplayColor:"#"+B.a.dI(ba,6),Alt:B.a.If(ub)}));b[b.length]=ta}return{returnValue:R,g8n:b}}Jwl(b){switch(b){case 0:return Box4Intl.Box4Strings.l_ThemeLabel1;case 1:return Box4Intl.Box4Strings.l_ThemeLabel2;case 2:return Box4Intl.Box4Strings.l_ThemeLabel3;case 3:return Box4Intl.Box4Strings.l_ThemeLabel4;case 4:return Box4Intl.Box4Strings.l_ThemeLabel5;
case 5:return Box4Intl.Box4Strings.l_ThemeLabel6;case 6:return Box4Intl.Box4Strings.l_ThemeLabel7;case 7:return Box4Intl.Box4Strings.l_ThemeLabel8;case 8:return Box4Intl.Box4Strings.l_ThemeLabel9;case 9:return Box4Intl.Box4Strings.l_ThemeLabel10;default:return""}}OFl(b){let h=null,r=null;b=this.Rxa(b);if(!b)return{MJi:h,nfh:r};h=b.properties.ia(yc.a.themeColors,null);r=b.properties.getValue(yc.a.Lae).split(" ");return{MJi:h,nfh:r}}static ELl(){return new It(Object(u.a)(It.qh,It.qh.ju,"navigateToPageContentNode"))}static get qh(){return ml.PageNavigator.instance}static get instance(){return null!=
It.fmg?It.fmg:It.fmg=It.ELl()}}Object(n.a)(It,"TableStyleThemeHelper",null,[458]);var Ep=d(845);class Jy{constructor(b,h){this.sJe={};this.Utb={};this.He=b;this.xs=h}u7e(b,h){const r=this.sJe[mv[h]];return r&&r.length?r:this.Sfl(b,h)}ASh(b,h,r){if(h=this.u7e(h,r))for(b=this.He.rf(b),r=0;r<h.length;r++)if(this.He.rf(h[r])===b)return r;return-1}o2(){this.sJe={};this.Utb={}}Sfl(b,h){const r=[];this.Utb={};b=this.xs.HLa(b);this.Trd(r,this.Utb,0,h,b);this.Trd(r,this.Utb,1,h,b);this.Trd(r,this.Utb,2,h,
b);this.Trd(r,this.Utb,3,h,b);return this.sJe[mv[h]]=r}Trd(b,h,r,z,R){const ba=R.yN;for(let ta=0;ta<ba;ta++){const Wa=R.xla(ta);if(3!==this.He.Uw(Wa))continue;const ub=this.xs.zLl(Wa),Ib=this.xs.LJc(Wa);h[mv[Ib]]=!0;ub!==r||Ib!==z&&16!==Ib||this.He.rf(Wa)===Ep.a.$4c||(b[b.length]=Wa)}}static gPl(){return new Jy(Sa.a.instance.resolve("Box4.Styles.IWACStyleReader"),Sa.a.instance.resolve("WordEditor.IWACTableStyleReader"))}static GOk(){return Jy.gPl()}}Object(n.a)(Jy,"WACTableStyleRibbonList",null,[441]);
class Jt extends kx{constructor(b,h,r,z,R){super(b,h,r);this.cPb=4;this.Snd=[];this.d8l=()=>{this.nWb.o2();this.w2g.o2()};this.eXj=R;this.nWb=z;this.dXe=WordEditorIntl.WordEditorStrings.L_BtnClearTableFormatting;this.O5m()}uIk(b,h){b.MenuItems=this.afl(h)}O5m(){this.Wyb={};this.Wyb["0"]="CustomTableStyles";this.Wyb["1"]="PlainTableStyles";this.Wyb["2"]="GridTableStyles";this.Wyb["3"]="ListTableStyles"}afl(b){const h=Object.assign(new ni.a,{Id:"menuTableTheme"});h.MenuSectionList=[];if(this.Ykm(b))return h;
const r=Object.assign(new hi.a,{Id:"msTableStyleTheme",ControlsId:"ctrlTableStyleThemeColors",ControlList:[]}),z=Object.assign(new Fz.a,{Id:"clrTableStyleTheme",ExternalId:"TableStyleThemeColorPicker",Command:Oa.a.$$a.toString(),QueryCommand:Oa.a.YHb.toString(),Width:Jt.h8n});z.Colors=({g8n:this.Snd}=this.eXj.Ohl(this.Snd,b,this.nWb)).returnValue;r.ControlList.push(z);h.MenuSectionList.push(r);return h}zXa(b){if(b=this.xs.Nz(b))b=this.xs.LJc(b),16!==b&&(this.cPb=b)}VLh(b){return this.nWb.u7e(b,this.cPb)}mjf(b,
h){h=this.nWb.u7e(h,this.cPb);return 0>b||b>=h.length?null:h[b]}Cxn(b,h){var r=this.xs.Nz(h);r=this.nWb.ASh(r,h,this.cPb);r=-1!==r?Math.floor(r/Gn.X2f)*Gn.X2f:0;return this.mjf(r+b,h)}BLl(b){switch(b){case 0:return WordEditorIntl.WordEditorStrings.L_LabelTableStylesCustom;case 2:return WordEditorIntl.WordEditorStrings.L_LabelTableStylesGrid;case 3:return WordEditorIntl.WordEditorStrings.L_LabelTableStylesList;case 1:return WordEditorIntl.WordEditorStrings.L_LabelTableStylesPlain;default:return""}}Ykm(b){this.zXa(b);
return 0>=this.VLh(b).length}Emo(b,h){if(!b||!h)return null;b=parseInt(b[Gl.Color]);var r=this.xs.Nz(h);const z=this.xs.LJc(r);if(z===b)return null;if(16===z)return this.cPb=b,null;r=this.nWb.ASh(r,h,z);this.cPb=b;return this.mjf(r,h)}oVk(b){b=this.xs.Nz(b);b=this.xs.LJc(b);if(16!==b)for(let h=0;h<this.Snd.length;h++)if(this.Snd[h]===b)return h;return-1}aXb(b){b.NNe(this.d8l,2)}static DLl(){return new Jt(hu.instance,Sa.a.instance.resolve("Box4.Styles.IWACStyleReader"),Sa.a.instance.resolve("WordEditor.IWACTableStyleReader"),
Jy.GOk(),It.instance)}static get instance(){return null!=Jt.Kmg?Jt.Kmg:Jt.Kmg=Jt.DLl()}}Jt.h8n=4;Object(n.a)(Jt,"TableStyleRibbonControls",kx,[418,419]);var Jl=d(1529);class iu extends Uo{constructor(b,h,r,z,R,ba,ta,Wa){super(b,h,r,z,R,ba,ta,Wa)}Xbc(b){super.Xbc(b);this.ga.pa(Oa.a.$$a,kc.a.view,Object(u.a)(this,this.hae,"tableStyleGenericViewActionHandler"));this.ga.pa(Oa.a.$$a,kc.a.table,Object(u.a)(this,this.$$a,"applyTableTheme"));this.ga.Vc(Oa.a.$$a,1030);this.ga.pa(Oa.a.dbc,kc.a.view,b);this.ga.pa(Oa.a.dbc,
kc.a.table,Object(u.a)(this,this.dbc,"populateMenuTableTheme"));this.ga.Vc(Oa.a.dbc,1126);this.ga.pa(Oa.a.YHb,kc.a.view,b);this.ga.pa(Oa.a.YHb,kc.a.table,Object(u.a)(this,this.YHb,"queryTableTheme"));this.ga.Vc(Oa.a.YHb,1127)}dbc(b,h,r,z,R){if(!({Gx:b}=this.Jkb(h,r,R,!1,!0)).returnValue)return b;this.i4f.uIk(R,h.node);return 32}$$a(b,h,r,z,R){if(!({Gx:b}=this.Jkb(h,r,R,!1,!0)).returnValue)return 2==r&&8==b&&hs.a.recordQosError("TableStyleColorButtonClickNoResponse",["TableInteractionFailed"],Xc.a.R6k),
b;const ba=h.node,ta=this.i4f.Emo(R,ba);ta&&this.z_d(ba,()=>{this.zpd.APa(ta,ba)});return 32}YHb(b,h,r,z,R){if(!({Gx:b}=this.Jkb(h,r,R,!0,!0)).returnValue)return b;R[Gl.IndexColorSelected]=this.i4f.oVk(h.node);return 32}get i4f(){return this.xnd}static yLl(){return new iu(Sa.a.instance.resolve("WordEditor.IWACTableStyleReader"),Jt.instance,t.AFrameworkApplication.ya,Jl.a.instance,new $m.a,Sa.a.instance.resolve("Box4.IInsertionPointFormatting"),Sa.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,
Object(u.a)(Yh.a.instance,Yh.a.instance.Agb,"isTableNodeInLockedRange"))}static get instance(){return null!=iu.Vlg?iu.Vlg:iu.Vlg=iu.yLl()}}Object(n.a)(iu,"TableStyleActor",Uo,[]);var fC=d(1577);class ti{constructor(){this.W=null}get name(){return"WordEditor.TableStyle"}yc(b){this.W=b;this.W.ha("Box4.TableEditors.ITableStylePreviewGeneratorVariableSize",()=>hu.instance).singleInstance();this.W.ha("Box4.TableEditors.ITableStyleEditor",()=>fC.a.instance).singleInstance();this.W.ha("Box4.TableEditors.IWACTableStyleEditor",
()=>Jl.a.instance).singleInstance()}init(){this.W.resolve("Box4.IFeatureHelper").Yk.continueWith(()=>{this.Tm()})}Tm(){this.W.resolve("Box4.IFeatureHelper").isFeatureEnabled(118)&&(iu.instance.Vb(),Jt.instance.aXb(gs.a.instance),ki.StyleReader.iae=fC.a.instance,vb.App.xa.updateCommandUI())}dispose(){}}Object(n.a)(ti,"TableStylePackage",null,[1,2]);var Sv=window.WordEditorHeaderToolbarData={name:"CommandUI",attrs:{xmlns:"http://schemas.microsoft.com/sharepoint/"},children:[{name:"Toolbar",attrs:{Id:"WordEditorHeaderToolbar",
ImageDownArrow:"IMGMAP@we@SplitButtonArrow_5x3x32",ImageDownArrow8by8:"IMGMAP@we@SplitButtonArrow_8x8x32",ImageUpArrow:"IMGMAP@we@RibbonUpArrow_5x3x32",ImageUpArrow8by8:"IMGMAP@we@RibbonUpArrow_8x8x32",ImageSideArrow:"IMGMAP@we@SubmenuFlyoutArrow_13x13x32",Scale:"true",Size:"OneRow",TeamId:"WAC",TextDirection:"STR@L_RibbonOptionTextDirection",Title:"STR@L_HeaderToolbarLabel",LabelText:"STR@L_HeaderToolbarLabel"},children:[{name:"Docks",attrs:{Id:"HeaderToolbarButtonDocks"},children:[{name:"ButtonDock",
attrs:{Id:"HeaderToolbarButtonDockLeft",Alignment:"Left"},children:[{name:"Controls",attrs:{id:"HeaderToolbarControlsLeft"},children:[{name:"FlyoutAnchor",attrs:{Id:"HeaderToolbarSectionsFlyout",Command:"0x2F9A3D80",QueryCommand:"0x978B3323",PopulateDynamically:"true",PopulateOnlyOnce:"false",PopulateQueryCommand:"0xF9833D60",Visible:"false"}},{name:"ToggleButton",attrs:{Id:"HeaderToolbarFirstPageButton",LabelText:"STR@L_HeaderToolbarFirstPageButton",Command:"0xC95FE689",QueryCommand:"0xA99F5B15",
TogglesWhenExecuted:"false",DisplayMode:"Medium",Visible:"false"}},{name:"ToggleButton",attrs:{Id:"HeaderToolbarEvenPagesButton",LabelText:"STR@L_HeaderToolbarEvenPagesButton",Command:"0xD9BEF8F8",QueryCommand:"0xF04337C4",TogglesWhenExecuted:"false",DisplayMode:"Medium",Visible:"false"}},{name:"ToggleButton",attrs:{Id:"HeaderToolbarOddPagesButton",LabelText:"STR@L_HeaderToolbarOddPagesButton",Command:"0xE58D2847",QueryCommand:"0x732475F7",TogglesWhenExecuted:"false",DisplayMode:"Medium",Visible:"false"}},
{name:"ToggleButton",attrs:{Id:"HeaderToolbarOtherPagesButton",LabelText:"STR@L_HeaderToolbarOtherPagesButton",Command:"0x91C2D5C5",QueryCommand:"0x4B388351",TogglesWhenExecuted:"false",DisplayMode:"Medium",Visible:"false"}}]}]},{name:"ButtonDock",attrs:{Id:"HeaderToolbarButtonDockRight",Alignment:"Right"},children:[{name:"Controls",attrs:{id:"HeaderToolbarControlsRight"},children:[{name:"FlyoutAnchor",attrs:{Id:"HeaderToolbarOptions",Command:"0x568463EB",LabelText:"STR@L_HeaderToolbarOptions"},children:[{name:"Menu",
attrs:{Id:"HeaderFooterToolbarMenu"},children:[{name:"MenuSection",attrs:{Id:"HeaderToolbarOptionsSection",DisplayMode:"Menu32"},children:[{name:"Controls",attrs:{Id:"HeaderToolbarOptionsControl"},children:[{name:"ToggleButton",attrs:{Id:"HeaderToolbarButtonAllPages",MenuItemId:"HeaderToolbarButtonAllPages",Image32by32:"IMGMAP@box42@HeaderAndFooter_32x32x32",Command:"0xF56DFAEA",QueryCommand:"0x7B6FA1F6",TogglesWhenExecuted:"false",LabelText:"STR@L_HeaderToolbarAllPages"}},{name:"ToggleButton",attrs:{Id:"HeaderToolbarButtonFirstPage",
MenuItemId:"HeaderToolbarButtonFirstPage",Image32by32:"IMGMAP@we@DifferentFirstPage_32x32x32",Command:"0x3284B693",QueryCommand:"0x51527973",TogglesWhenExecuted:"false",LabelText:"STR@L_HeaderToolbarFirstPage"}},{name:"ToggleButton",attrs:{Id:"HeaderToolbarButtonEvenOddPages",MenuItemId:"HeaderToolbarButtonEvenOddPages",Image32by32:"IMGMAP@we@DifferentEvenOddPages_32x32x32",Command:"0x3DB867BD",QueryCommand:"0xE8BBEA49",TogglesWhenExecuted:"false",LabelText:"STR@L_HeaderToolbarEvenOddPages"}},{name:"ToggleButton",
attrs:{Id:"HeaderToolbarButtonFirstEvenOddPages",MenuItemId:"HeaderToolbarButtonFirstEvenOddPages",Image32by32:"IMGMAP@we@DifferentFirstEvenOddPages_32x32x32",Command:"0x8FF03DBF",QueryCommand:"0x2799C44F",TogglesWhenExecuted:"false",LabelText:"STR@L_HeaderToolbarFirstEvenOddPages"}}]}]},{name:"MenuSection",attrs:{Id:"HeaderToolbarDeleteSection",DisplayMode:"Menu32"},children:[{name:"Controls",attrs:{Id:"HeaderToolbarDeleteControl"},children:[{name:"Button",attrs:{Id:"HeaderToolbarButtonRemovePageNumbers",
MenuItemId:"HeaderToolbarButtonRemovePageNumbers",Image32by32:"IMGMAP@we@WordRemovePageNumbers_32x32x32",Command:"0xF3612A1B",QueryCommand:"0xA609D50C",TogglesWhenExecuted:"false",LabelText:"STR@L_RemovePageNumbers"}},{name:"Button",attrs:{Id:"HeaderToolbarButtonDelete",MenuItemId:"HeaderToolbarButtonDelete",Image32by32:"IMGMAP@we@RemoveHeadersAndFooters_32x32x32",Command:"0x3CD9B935",QueryCommand:"0xA609D50C",TogglesWhenExecuted:"false",LabelText:"STR@L_HeaderToolbarRemoveHeadersAndFooters"}}]}]}]}]}]}]}]}]}]},
Ky=d(1434);class ju{constructor(b,h){this.hHa=b;this.bxa=h}qmn(b){this.hHa.ird(b)}Eza(b){this.bxa.Eza(b)}hKb(b,h){return this.bxa.hKb(b,h)}gKb(b,h){return this.bxa.gKb(b,h)}B6f(b,h,r){this.bxa.B6f(b,h,r)}}Object(n.a)(ju,"ClientPaginationHeaderFooterBridge",null,[473]);class BA{constructor(b,h){this.Nl=b;this.ga=h;this.G8=new kl.a;this.H8=new kl.a}Eza(b){b=Nd.GraphIterator.$a(b);if(b.qo()&&b.Jp()){b.Xd();do 10===b.Qe&&this.ULf(b.currentNode),b.Du();while(8!==b.Qe)}}hKb(b,h){var r=this.UAb(h);if(!this.G8.xb(r))return v.ULS.sendTraceTag(573400388,
3009,15,"OutlineToHeaderFooterKindToContentMap does not contain a value for the section "+r),!1;h=this.G8.J(r);v.ULS.shipAssertTag(573400389,336,this.H8.xb(r),"Outline to template mode map doesn't contain the section key in PageAdornmentContentManager.ShouldShowHeaderForPage().");r=this.H8.J(r);return this.clf(h,b,r)}gKb(b,h){var r=this.UAb(h);if(!this.G8.xb(r))return v.ULS.sendTraceTag(573400390,3009,15,"OutlineToHeaderFooterKindToContentMap does not contain a value for the section "+r),!1;h=this.G8.J(r);
v.ULS.shipAssertTag(573400391,336,this.H8.xb(r),"Outline to template mode map doesn't contain the section key in PageAdornmentContentManager.ShouldShowFooterForPage().");r=this.H8.J(r);return this.r$e(h,b,r)}B6f(b,h,r){h=this.uif(h,r);this.ga.Xb(b?Oa.a.Qde:Oa.a.E4c,2,h)}uif(b,h){h=this.Nl.jAb(h);if(!h)return v.ULS.sendTraceTag(573400392,3009,15,"Header footer container node expected not to be null."),0;h=this.Nl.zla(h);const r=1===b;b=!(b%2);return 1===h?1:2===h?r?2:1:3===h?b?3:4:r?2:b?3:4}ULf(b){if(10===
b.type){var h=new kl.a,r=this.Nl.jAb(b);v.ULS.shipAssertTag(573400393,336,!!r,"Header footer container node expected to not be null in PageAdornmentContentManager.PopulateHeaderFooterKindToContentMap().");var z=this.Nl.zla(r);b=this.UAb(b);this.Y8f(b,z);this.X8f(b,h);r=Nd.GraphIterator.$a(r);if(r.Jp()){r.Xd();do b=r.currentNode,z=this.Nl.XFd(b),b=this.Nl.J4h(b),h.add(z,b),r.Du();while(36===r.Qe)}}}Y8f(b,h){this.H8.xb(b)?this.H8.Z(b,h):this.H8.add(b,h)}X8f(b,h){this.G8.xb(b)?this.G8.Z(b,h):this.G8.add(b,
h)}UAb(b){v.ULS.shipAssertTag(573400395,336,10===b.type,"Expected node of type Outline but received node of type "+b.type);return b.ia(yc.a.Ega,0)}clf(b,h,r){const z=1===h;h=!(h%2);switch(r){case 2:if(z){if(b.xb(2))return b.J(2)}else if(b.xb(0))return b.J(0);break;case 3:if(h){if(b.xb(1))return b.J(1)}else if(b.xb(0))return b.J(0);break;case 4:if(z){if(b.xb(2))return b.J(2)}else if(h){if(b.xb(1))return b.J(1)}else if(b.xb(0))return b.J(0);break;case 1:if(b.xb(0))return b.J(0)}return!1}r$e(b,h,r){const z=
1===h;h=!(h%2);switch(r){case 2:if(z){if(b.xb(5))return b.J(5)}else if(b.xb(3))return b.J(3);break;case 3:if(h){if(b.xb(4))return b.J(4)}else if(b.xb(3))return b.J(3);break;case 4:if(z){if(b.xb(5))return b.J(5)}else if(h){if(b.xb(4))return b.J(4)}else if(b.xb(3))return b.J(3);break;case 1:if(b.xb(3))return b.J(3)}return!1}}Object(n.a)(BA,"ClientPaginationPageAdornmentContentManager",null,[471]);class ep{constructor(b,h,r,z,R,ba){this.KCk=ta=>{1===ta&&this.HD.OD&&(ta=this.Xc.WAa(this.HD.OD,8,8),this.Nl.Pqk(ta)?
this.TSk(ta):this.zWn())};this.Vdo=ta=>{1===ta&&this.ga.Xb(Fb.a.openInClient,2,!1)};this.HD=b;this.Nl=h;this.Xc=r;this.Hc=z;this.qoc=R;this.ga=ba}MWn(){const b=new te.StandardDialog;b.Fd=1;b.Ve(1,WordEditorIntl.WordEditorStrings.L_HeaderToolbarDeleteDialogRemoveAllButton);b.tU(0);b.Pv(CommonUIStrings.l_DefaultDialogTitle,WordEditorIntl.WordEditorStrings.L_HeaderToolbarDeleteDialogMessage,0,this.KCk)}TSk(b){b.kd(8);const h=this.Hc.Rc(15);h.set(b.Cn.Qi);this.qoc.zon(b);this.HD.dismiss();h.dispose();
v.ULS.sendTraceTag(4214792,317,50,"{0}",{["RemovedHeadersAndFooters"]:!0})}zWn(){const b=new te.StandardDialog;b.Fd=1;b.Ve(1,Box4Intl.Box4Strings.L_OpenInWord);b.Ve(0,CommonUIStrings.l_Close);b.tU(0);b.Pv(CommonUIStrings.l_DefaultDialogTitle,WordEditorIntl.WordEditorStrings.L_HeaderToolbarCantDeleteContent,0,this.Vdo);v.ULS.sendTraceTag(4214793,317,50,"{0}",{["CouldntRemoveHeadersAndFooters"]:!0})}}Object(n.a)(ep,"DeleteHeaderFooterDialog",null,[]);class lx{constructor(b,h,r,z,R){this.Nl=b;this.Xc=
h;this.Hc=r;this.qoc=z;this.ga=R}create(b){return new ep(b,this.Nl,this.Xc,this.Hc,this.qoc,this.ga)}}Object(n.a)(lx,"DeleteHeaderFooterDialogFactory",null,[472]);class Tv{constructor(b,h,r,z,R,ba,ta,Wa,ub,Ib){this.p8=null;this.O5f=($b,fc,Kc,ed,Jd)=>{var ge=this.qjf(fc);return ge?1===Kc?32:(Kc=this.control)?(fc=this.Hc.Rc(15),fc.Db(ge),fc.Al=$b,Kc.V9?this.ga.processAction(Oa.a.KS,2):(ge=this.wEh(ge),ed.Lr=ge?1:0,ed=$b!==Oa.a.E4c,($b=this.yef($b,Jd))&&Kc.Bva($b),this.ga.Xb(Oa.a.Kzd,2,ed)),fc.dispose(),
32):8:8};this.W2e=($b,fc,Kc)=>{if(1===Kc)return 32;this.iBj.create(this.control).MWn();return 32};this.bcn=($b,fc,Kc,ed,Jd)=>1===Kc?32:($b=this.control)?(Jd[Yf.a.On]=$b.V9,32):8;this.ykb=($b,fc,Kc,ed,Jd)=>{if(1===Kc||!this.control.V9)return 32;fc=this.ORh($b,Jd);Kc=Tv.g1h(this.control.OD);ed=this.Hc.Rc(15);ed.Db(Kc);ed.Al=$b;$b=this.Xc.Dk();$b.set(Kc);this.iHa.s7e($b.currentNode,fc);this.Nl.DFb($b);this.qoc.u0i($b,fc);ed.dispose();return 32};this.Bva=($b,fc,Kc,ed,Jd)=>{if(1===Kc)return 32;$b=this.yef($b,
Jd);this.control.V9&&this.control.Bva($b);return 32};this.i6d=($b,fc,Kc,ed,Jd)=>{if(1===Kc)return 32;$b=this.CYh($b,Jd);ed.Lr=$b;fc=this.qjf(fc);if(!fc)return 8;ed=this.Xc.Dk();ed.set(fc);ed.Bb(8);ed.it(8);if(!this.Kk.XJm(ed,$b))return 8;this.Nl.DFb(ed);this.control.dea(ed.currentNode);return 32};this.VLf=($b,fc,Kc,ed,Jd)=>{if(1===Kc)return 32;$b=this.eYj.oNk(this.qjf(fc));Jd.PopulationXML=$b;return 32};this.Z1d=($b,fc,Kc,ed,Jd)=>{$b=this.ORh($b,Jd);fc=this.control.OD;Kc=this.Nl.zla(fc);Jd[Yf.a.On]=
$b===Kc;1===$b&&(Jd[Yf.a.LabelText]=this.f2h(fc)?WordEditorIntl.WordEditorStrings.L_HeaderToolbarEntireSection:WordEditorIntl.WordEditorStrings.L_HeaderToolbarAllPages);return 32};this.Z0d=($b,fc,Kc,ed,Jd)=>{if(1===Kc||!this.control.V9)return 32;fc=this.control.OD;void 0!==fc&&null!==fc&&(fc=this.Nl.zla(fc),$b=this.yef($b,Jd),Kc=this.control.ePb,Jd[Yf.a.Visible]=this.q7n($b,fc),Jd[Yf.a.On]=$b===Kc);return 32};this.ncn=($b,fc,Kc,ed,Jd)=>{if(1===Kc||!this.control.V9)return 32;$b=this.control.OD;void 0!==
$b&&null!==$b&&this.e6m($b,Jd);return 32};this.Cbn=($b,fc,Kc,ed,Jd)=>{if(1===Kc||!this.control.V9)return 32;$b=this.CYh($b,Jd);fc=this.control.OD;Kc=0;void 0!==fc&&null!==fc&&(Kc=fc.getValue(yc.a.Ega));Jd[Yf.a.On]=$b===Kc;return 32};this.KS=($b,fc,Kc)=>{if(1===Kc)return 32;this.control.dismiss();return 32};this.cLd=()=>32;this.Kzd=($b,fc,Kc,ed,Jd)=>{if(1===Kc)return 32;this.control.show(Jd);return 32};this.Wgb=($b,fc,Kc,ed,Jd)=>{if(1===Kc)return 32;if(!Jd)return 8;fc=Jd.vWa;if(!fc||!fc.isConnected)return 8;
$b=this.Nl.hDf(fc);if(!({isHeader:Kc,S4f:fc}=this.Nl.I_h(fc)).returnValue)return 8;this.control.dea($b);this.control.Bva(fc);this.control.show(Kc,Jd.$7d);return 32};this.ga=b;this.Nl=h;this.qoc=r;this.iHa=z;this.Kk=R;this.Xc=ba;this.Hc=ta;this.eYj=Wa;this.HFj=ub;this.iBj=Ib}get control(){return this.p8}set control(b){this.p8=b}Vb(){this.ga.pa(Oa.a.BMd,kc.a.view,this.O5f);this.ga.gb(Oa.a.OOf,kc.a.application,this.bcn,96);this.ga.pa(Oa.a.Qde,kc.a.view,this.O5f);this.ga.pa(Oa.a.E4c,kc.a.view,this.O5f);
this.ga.gb(Oa.a.cLd,kc.a.view,this.cLd,64);this.ga.pa(Oa.a.Kzd,kc.a.view,this.Kzd);this.ga.gb(Oa.a.KS,kc.a.application,this.KS,96);this.ga.gb(Oa.a.Wgb,kc.a.application,this.Wgb,96);this.ga.gb(Oa.a.bHn,kc.a.view,this.Bva,96);this.ga.pa(Oa.a.BXi,kc.a.view,this.Bva);this.ga.pa(Oa.a.DXi,kc.a.view,this.Bva);this.ga.pa(Oa.a.CXi,kc.a.view,this.Bva);this.ga.pa(Oa.a.EXi,kc.a.view,this.Bva);this.ga.gb(Oa.a.zKn,kc.a.view,this.ykb,100);this.ga.gb(Oa.a.lZi,kc.a.view,this.ykb,4);this.ga.gb(Oa.a.kZi,kc.a.view,this.ykb,
4);this.ga.gb(Oa.a.iZi,kc.a.view,this.ykb,4);this.ga.gb(Oa.a.jZi,kc.a.view,this.ykb,4);this.ga.pa(Oa.a.i6d,kc.a.view,this.i6d);this.ga.pa(Oa.a.kXf,kc.a.view,this.i6d);this.ga.gb(Oa.a.VLf,kc.a.view,this.VLf,96);this.ga.gb(Oa.a.W2e,kc.a.view,this.W2e,4);this.ga.gb(Oa.a.XHi,kc.a.view,this.Z0d,97);this.ga.gb(Oa.a.ZHi,kc.a.view,this.Z0d,97);this.ga.gb(Oa.a.YHi,kc.a.view,this.Z0d,97);this.ga.gb(Oa.a.$Hi,kc.a.view,this.Z0d,97);this.ga.gb(Oa.a.sIi,kc.a.view,this.Z1d,97);this.ga.gb(Oa.a.rIi,kc.a.view,this.Z1d,
97);this.ga.gb(Oa.a.pIi,kc.a.view,this.Z1d,97);this.ga.gb(Oa.a.qIi,kc.a.view,this.Z1d,97);this.ga.gb(Oa.a.Wbn,kc.a.view,this.ncn,97);this.ga.gb(Oa.a.mOf,kc.a.view,this.Cbn,97)}wEh(b){const h=this.Nl.jAb(b),r=this.Nl.zla(h);b=this.iHa.s7e(b,r);this.control.dea(h);return b}ORh(b,h){switch(b){case Oa.a.lZi:case Oa.a.sIi:b=1;break;case Oa.a.kZi:case Oa.a.rIi:b=2;break;case Oa.a.iZi:case Oa.a.pIi:b=3;break;case Oa.a.jZi:case Oa.a.qIi:b=4;break;default:b=h}return b}yef(b,h){switch(b){case Oa.a.BXi:case Oa.a.XHi:b=
1;break;case Oa.a.DXi:case Oa.a.ZHi:b=2;break;case Oa.a.CXi:case Oa.a.YHi:b=3;break;case Oa.a.EXi:case Oa.a.$Hi:b=4;break;case Oa.a.Qde:case Oa.a.E4c:b=h;break;case Oa.a.BMd:b=0;break;default:b=h}return b}CYh(b,h){return b===Oa.a.kXf||b===Oa.a.mOf?parseInt(h.MenuItemId):h}qjf(b){return this.Kk.u$(b.vk)}q7n(b,h){switch(h){case 1:return!1;case 2:return 1===b||2===b;case 4:return 4===b||2===b||3===b;case 3:return 4===b||3===b}return!0}e6m(b,h){const r=this.f2h(b);if(h[lh.a.Visible]=r)b=this.Kk.h1h(this.HFj(b)),
b=String.format(WordEditorIntl.WordEditorStrings.L_HeaderToolbarSectionButtonLabel,b),h[lh.a.LabelText]=b}f2h(b){const h=this.Xc.Dk();h.set(b);h.Bb(8);h.it(8);return 1<this.Kk.Rif(h)}static g1h(b){const h=new Nd.GraphIterator;h.set(b);h.Bb(10);return Co.WordSectionNavigator.fzn(h)}}Object(n.a)(Tv,"HeaderFooterActor",null,[]);var mx=d(609),mt=d(747);class nv{constructor(b,h,r,z,R){this.qNj=b;this.Nl=h;this.Kk=r;this.Xc=z;this.ga=R}jEh(b,h){this.Nl.DFb(b);h=this.N2k(b,h);b.mc();return h}s7e(b,h){b=
this.Xc.WAa(b,8,8);let r=!1;this.Kk.XKa(b,z=>{const R=this.Xc.Dk();R.set(z);r=(z=this.jEh(R,h))||r;return z});return r}N2k(b,h){if(3!==this.ga.mode)return!1;let r=!1;h=mt.a.I3e(h);for(let z=0;z<h.length;++z)r=this.qNj.M2k(b,h[z])||r;return r}}nv.ARk=1;Object(n.a)(nv,"HeaderFooterInserter",null,[463]);class Kt{constructor(b,h,r,z,R,ba,ta,Wa,ub,Ib,$b){this.H_g=this.PBg=!1;this.OD=null;this.pue=!1;this.ePb=0;this.gGb=()=>{this.pue=!0};this.n4=b;b.bind(this);this.CLe=z;this.IBj=ub;this.hTg=R;this.gOj=
ba;this.k7a=ta;this.header=h;this.footer=r;this.header.nOk();this.n4.Xy();this.GJe=nv.ARk;this.iHa=Wa;Kt.ga=Ib;this.KM=$b}get V9(){return this.PBg}show(b=!0,h=!0){this.V9||(this.Wij(),this.IYi(!0),this.header.Mjn(),this.IBj(),this.U1n(),t.AFrameworkApplication.ua&&t.AFrameworkApplication.ua.Sb.nma&&appChrome.api.dispatch(appChrome.actions.setShyState(Object.assign(new mx.a,{state:0,disablePopover:!0}))));(this.H_g=h)&&this.hTg(b)}dismiss(b=!1){this.V9&&(this.gOj(b),this.IYi(!1),this.hyb(),this.ePb=
0,this.$2n(),t.AFrameworkApplication.ua&&t.AFrameworkApplication.ua.Sb.nma&&appChrome.api.dispatch(appChrome.actions.setShyState(Object.assign(new mx.a,{disablePopover:!1}))))}IYi(b){this.PBg=b;Kt.ga.processAction(Fb.a.S$e,2);this.n4.o_(b);this.header.o_(b);this.footer.o_(b);this.CLe()}dea(b){this.OD!==b&&(this.OD=b,this.header.dea(b),this.footer.dea(b),this.ePb=0,this.ykb(this.k7a.zla(b)))}hyb(){this.OD&&(this.header.Tbb(),this.footer.Tbb(),this.OD=null)}update(){this.V9&&this.Rce()}Rce(){this.OD&&
(this.k7a.PZk(this.OD)&&this.k7a.uXl(this.OD)?this.Wij():this.dismiss())}Wij(){const b=this.k7a.zla(this.OD);b!==this.GJe&&this.ykb(b)}ykb(b){this.GJe=b;this.Bva(this.YLl(b))}YLl(b){switch(b){case 2:return 2;case 3:return 3;case 4:return 2}return 1}Bva(b,h=!0){this.ePb!==b&&(this.iHa.s7e(this.OD,this.GJe),this.header.AXi(b),this.header.Aeh(tf.AppFrame.y$),this.footer.AXi(b),this.footer.Aeh(tf.AppFrame.d$),this.ePb=b,this.V9&&this.H_g&&this.t3k(h))}t3k(b){this.hTg(b);b?this.header.setInitialSelection():
this.footer.setInitialSelection()}dispose(){this.n4.Q7();this.header.dispose();this.footer.dispose()}U1n(){this.KM.grd(this.gGb);this.pue=!1}$2n(){this.KM.JSf(this.gGb);this.pue&&Kt.ga.processAction(Oa.a.cLd,2)}static nXk(){Kt.ga.Xb(ab.a.Neb,2,!0);Kt.ga.processAction(Oa.a.T9,2)}}Kt.ga=null;Object(n.a)(Kt,"HeaderFooterControl",null,[488,9]);class vB{constructor(b,h,r,z,R){this.CLe=b;this.k7a=h;this.iHa=r;this.ga=z;this.KM=R}create(b,h,r,z,R){return new Kt(b,h,r,this.CLe,z,R,this.k7a,this.iHa,Kt.nXk,
this.ga,this.KM)}}Object(n.a)(vB,"Factory",null,[470]);class nt{constructor(){this.p8=null}get control(){return this.p8}set control(b){this.p8=b}Baf(b){return this.Caf(this.control.OD,this.control.ePb,b.isHeader,b)}Caf(b,h,r,z){return()=>{if(!b.isConnected)return null;this.control.dea(b);this.control.Bva(h);this.control.show(r);return z}}dismiss(){this.p8.V9&&this.p8.dismiss()}}Object(n.a)(nt,"HeaderFooterControlLauncher",null,[]);var Iz=d(1132),CA=d(533),Ns=d(336),Uv=d(799);class zw{constructor(b,
h,r){this.Bgc=null;const z=h?"Header":"Footer";this.Xq=b.ownerDocument.createElement("div");this.Xq.id=h?"HeaderPane":"FooterPane";this.Xq.classList.add(zw.xXl,z);this.yub=(new Uv.a(this.Xq,"WACViewPanel_"+z)).BE;this.Xq.appendChild(this.yub);b.appendChild(this.Xq);h&&(this.Bgc=b.ownerDocument.createElement("div"),this.Bgc.classList.add(zw.CXl),this.Xq.appendChild(this.Bgc));this.Hug=r.CCl(this.Xq)}bind(){}o_(b){b?this.Hug.Gak():this.Hug.Iak()}lik(b){b.oab(this.yub)}}zw.CXl="HeaderToolbarContainer";
zw.xXl="HeaderFooterPane";Object(n.a)(zw,"PaneControlDom",null,[497]);class Sr{constructor(b,h,r,z,R){this.HD=this.oq=null;this.Nyi=()=>{this.HD.dismiss(!0);if(this.iQb){let ba=new Xu.a(!0);this.iQb.HDa(ba)}return!0};this.mD=ba=>{ba.Ib.preventDefault();return!1};this.Xq=b.ownerDocument.createElement("div");this.Xq.id=Sr.rrh;this.Xq.className=Sr.rrh;this.RD=z;this.iQb=R;this.H4h=new zw(this.Xq,!0,h);this.eMk(this.Xq);this.LJh=new zw(this.Xq,!1,h);this.o_(!1);b.appendChild(this.Xq)}eMk(b){this.oq=b.ownerDocument.createElement("div");
this.oq.id=Sr.j0m;this.oq.className=Sr.h0m;this.oq.tabIndex=0;this.oq.setAttribute(vf.a.Ch,vf.a.t1);this.oq.setAttribute(vf.a.lda,WordEditorIntl.WordEditorStrings.L_HeaderFooterOverlayAccessibleText);b.appendChild(this.oq)}bind(b){this.HD=b}o_(b){if(!b&&this.RD){var h=new Xu.a(!0);this.RD.HDa(h)}!b&&this.iQb&&(h=new Xu.a(!0),this.iQb.HDa(h));this.Xq.style.display=b?"":"none";this.H4h.o_(b);this.LJh.o_(b)}RJn(){this.oq.focus()}Xy(){sf.a.instance.mb(jb.a.click,this.oq,this.Nyi);gf.a.instance.mb(jb.a.$w,
this.Xq,this.mD)}Q7(){sf.a.instance.sc(jb.a.click,this.oq,this.Nyi);gf.a.instance.sc(jb.a.$w,this.Xq,this.mD)}}Sr.rrh="HeaderFooterControl";Sr.j0m="HeaderFooterOverlay";Sr.h0m="EditingSurfaceOverlay HeaderFooterOverlay";Object(n.a)(Sr,"HeaderFooterControlDom",null,[487]);class rp{constructor(b,h,r,z,R,ba,ta,Wa,ub,Ib){this.n4=null;this.sa=new Te.a;this.HD=this.Zkd=null;this.KGf=$b=>{this.q7($b);this.sa.raiseEvent("OnShowEventKey")};this.JGf=$b=>{this.jf&&(this.Zkd=new Iz.a(this.jf));this.Wb.rDc(tf.AppFrame.y$);
this.Wb.rDc(tf.AppFrame.d$);this.aba($b);this.sa.raiseEvent("OnDismissEventKey")};this.MZd=()=>{this.Zkd&&(this.Zkd.dispose(),this.Zkd=null)};this.Wb=b;this.Oo=h;this.bVg=r;this.gGj=z;this.aQj=R;this.ga=ba;this.qzg=CA.a.create();this.jDg=rc.KeyInputManager.lc(wb.a.es,0);this.wY=rc.KeyInputManager.lc(wb.a.X_,0);this.ZVj=rc.KeyInputManager.lc(wb.a.sFa,0);this.MH=ta;this.Oa=Wa;this.RD=ub;this.iQb=Ib;this.jf&&this.jf.yja(this.MZd)}K$g(b){this.sa.addHandler("OnShowEventKey",b)}Vrn(b){this.sa.removeHandler("OnShowEventKey",
b)}ird(b){this.sa.addHandler("OnDismissEventKey",b)}aPi(b){this.sa.removeHandler("OnDismissEventKey",b)}get jf(){const b=this.MH.value;return b?b.wi?b:(v.ULS.sendTraceTag(25474004,317,10,"_lazyPageView.Value is not a page view in HeaderFooterControlOwner."),null):(v.ULS.sendTraceTag(25474003,317,10,"_lazyPageView.Value is null in HeaderFooterControlOwner."),null)}get control(){return this.HD}get ZEk(){return this.qzg}bind(b){this.HD=this.nDk(b);this.qzg.instance=this.HD}nDk(b){this.n4=new Sr(b,this.aQj.value,
this.Oa,this.RD,this.iQb);b=this.bVg.value.create(this.ga,this.n4.H4h,!0,tf.AppFrame.y$);const h=this.bVg.value.create(this.ga,this.n4.LJh,!1,tf.AppFrame.d$);this.HD=this.gGj.value.create(this.n4,b,h,this.KGf,this.JGf);this.wnf();this.qS();return this.control}wnf(){var b=3===this.ga.mode?tf.AppFrame.pF:tf.AppFrame.$Wc;const h=this.Wb.re(tf.AppFrame.y$);h.parent=b;this.Wb.cOe(tf.AppFrame.y$);const r=this.Wb.re(tf.AppFrame.d$);r.parent=b;this.Wb.cOe(tf.AppFrame.d$);b=this.Wb.re(Ns.a.HBb);b.parent=ke.AFrame.Np;
b.eda(()=>{this.n4.RJn()});b.bindAction(this.jDg,Oa.a.KS);b.bindAction(this.wY,Oa.a.KS);b.bindAction(this.ZVj,Oa.a.KS);h.bindAction(this.wY,Oa.a.KS);r.bindAction(this.wY,Oa.a.KS)}qS(){this.Oo.qS(tf.AppFrame.y$);this.Oo.qS(Ns.a.lZa);this.Oo.qS(tf.AppFrame.d$);this.Oo.qS(Ns.a.HBb)}q7(b){this.Oo.DG(tf.AppFrame.y$);this.Oo.DG(Ns.a.lZa);this.Oo.DG(tf.AppFrame.d$);this.Oo.DG(Ns.a.HBb);this.Oo.Mw(ke.AFrame.Zp);this.Wb.Rxc(tf.AppFrame.y$);this.Wb.Rxc(tf.AppFrame.d$);b?this.Wb.Jg(tf.AppFrame.y$):this.Wb.Jg(tf.AppFrame.d$)}aba(b){this.Oo.Mw(tf.AppFrame.y$);
this.Oo.Mw(Ns.a.lZa);this.Oo.Mw(tf.AppFrame.d$);this.Oo.Mw(Ns.a.HBb);this.Oo.DG(ke.AFrame.Zp);(b||this.Wb.og&&(this.Wb.og.name===tf.AppFrame.y$||this.Wb.og.name===Ns.a.lZa||this.Wb.og.name===tf.AppFrame.d$||this.Wb.og.name===Ns.a.HBb))&&this.Wb.Jg(ke.AFrame.Zp)}dispose(){const b=this.Wb.re(Ns.a.HBb);b.Dr(this.jDg);b.Dr(this.wY);this.Wb.re(tf.AppFrame.y$).Dr(this.wY);this.Wb.re(tf.AppFrame.d$).Dr(this.wY);this.jf&&this.jf.R3d(this.MZd);this.control.dispose()}}Object(n.a)(rp,"HeaderFooterControlOwner",
null,[468,469]);var dy=d(1081);class wB{constructor(b,h,r,z,R,ba){this.Nl=b;this.Xc=h;this.wPj=r;this.Ql=z;this.zPj=R;this.iGj=ba}p5l(b,h){const r=this.Xc.Dk();r.set(b);this.Nl.EFb(r,h);this.wPj(r);this.zPj(r.currentNode,this.Ql);this.iGj.q5l(r,dy.a(h))}}Object(n.a)(wB,"HeaderFooterDefaultContentInserter",null,[467]);class kq{constructor(b,h,r,z,R,ba,ta,Wa){this.jS=b;this.ZWj=h;this.Kje=r;this.Ql=z;this.yPj=R;this.sVj=ba;this.YFj=ta;kq.Kh=Wa}q5l(b,h){this.ZWj(b,1,3,null,!1);this.jS.J_c(Ep.a.$4c,1696,
b.currentNode);this.Kje(b,0,this.Ql?3:1,h);this.Kje(b,1,2,h);this.Kje(b,2,this.Ql?1:3,h);this.yPj(b);this.sVj(b,!1,!0,null);this.YFj(b,h)}static get eR(){return null!=kq.Isg?kq.Isg:kq.Isg=Sa.a.instance.resolve("Box4.Styles.IWACStyleEditor")}static get paragraphEditor(){return null!=kq.npg?kq.npg:kq.npg=Sa.a.instance.resolve("Box4.IParagraphEditor")}static XHn(b,h,r){Ke.moveToCellContent(b,0,h);ag.OutlineElementNavigator.De(b);kq.eR.w7d(Box4Intl.Box4Strings.L_StyleWordHeader,b.currentNode);kq.paragraphEditor.sD(b.currentNode,
r);h||kq.paragraphEditor.qp.Hva(b,1,-115);2===h&&kq.paragraphEditor.qp.EJb(b.currentNode,1,-115);Ke.returnToContainingTable(b)}static xKn(b,h){ag.OutlineElementNavigator.De(b);kq.eR.w7d(h?Box4Intl.Box4Strings.L_StyleWordHeader:Box4Intl.Box4Strings.L_StyleWordFooter,b.currentNode);ag.OutlineElementNavigator.Zd(b)}static Mkl(){return(b,h,r)=>{kq.XHn(b,h,r)}}static Otl(){return(b,h)=>{kq.xKn(b,h)}}static kLl(b){return(h,r,z,R,ba)=>b.Rza(h,r,z,R,ba)}static nJl(){return(b,h,r,z,R)=>kq.Kh.eD(b,h,r,z,R)}}
kq.Kh=null;Object(n.a)(kq,"HeaderFooterDefaultTableInserter",null,[466]);class DA{constructor(b,h,r,z){this.Nl=b;this.cTb=h;this.Xc=r;this.Kk=z}u0i(b,h){b.Cn.properties.setValue(yc.a.Ekf,2===h||4===h);b.Bb(8);b.g4c(8).properties.setValue(yc.a.LKd,3===h||4===h)}zon(b){this.Kk.XKa(b,h=>{const r=this.Xc.Dk();r.set(h);this.Nl.DFb(r);this.u0i(r,1);this.Aon(r);return!0})}Aon(b){for(;b.Xd();)b.Eg()}}Object(n.a)(DA,"HeaderFooterEditor",null,[464]);var EA=d(1085);class Aw extends Rr.a{constructor(b){super();
this.ELe=b}get index(){return 0}run(){this.ELe()}tXl(b,h){h.property===yc.a.Ekf&&this.pH()}H0m(b,h){h.property===yc.a.LKd&&this.pH()}pH(){this.tX()}}Object(n.a)(Aw,"ControlUpdateNeededTracker",Rr.a,[]);class ey{constructor(b,h,r,z,R,ba){this.$5a=null;this.hGj=r;this.Cbd=h;this.SQb=b;this.OPj=z;this.fIa=ba}start(){this.SQb.bind(vb.App.xa.lC);this.Cbd.control=this.SQb.control;this.Cbd.Vb();this.hGj.control=this.SQb.control;this.OPj.value.create(this.SQb.control,Object(u.a)(this.Cbd,this.Cbd.wEh,"ensureSectionHeaderFooterAttachedToControl")).Vb();
this.TYl()}TYl(){this.$5a=new Aw(()=>{this.SQb.control.update()});const b=vb.App.Xj.al;b.Se(35).lp(Object(u.a)(this.$5a,this.$5a.tXl,"headerFooterContainerNodePropertyChanged"));b.Se(8).lp(Object(u.a)(this.$5a,this.$5a.H0m,"pageContentNodePropertyChanged"));EA.a.e3d(Object(u.a)(this.$5a,this.$5a.pH,"setUpdateNeeded"));ik.GraphTransactionManager.instance.Rna(this.$5a,3)}dispose(){this.SQb.dispose();this.fIa.iAh()}}Object(n.a)(ey,"HeaderFooterManager",null,[]);class FA{constructor(b,h,r,z){this.Kk=
b;this.Nl=h;this.pNj=r;this.Bme=z}M2k(b,h){let r=!1;const z=mt.a.Zff(h);b.aq(z)||(this.y5l(b,h),this.Bme.p5l(b.currentNode,h),r=!0);return r}y5l(b,h){const r=this.pNj.create(1074135123),z=b.currentNode.ia(yc.a.Ega,0);r.properties.setValue(yc.a.Ega,z);r.properties.setValue(yc.a.A4b,h);h=mt.a.Zff(h);b.Sf(r,h)}}Object(n.a)(FA,"HeaderFooterNodeLevelInserter",null,[465]);var nx=d(234),GA=d(424);class Bw extends nx.a{constructor(b,h,r){super(b,h,"","");this.Yrb=null;this.S4h=Bw.uxh;this.ZKc=[];this.Mre=
r}get Yz(){return!0}get cssClass(){return"cui-herodock"}km(){this.Gjn();super.km()}FKa(){for(const b of this.ZKc)b.OAd();super.FKa()}U0n(){let b,h,r;b=[];h=[];r=[];for(let z=0;z<this.ZKc.length;z++){const R=this.ZKc[z];R.visible?b.length<this.S4h?b.push(R):Object(nb.a)(GA.FlyoutAnchor,R)?Array.addRange(h,R.Gnl()):h.push(R):r.push(R)}return{e$n:b,f0m:h,k8l:r}}dMk(b){if(!b||!b.length)return null;const h=new Mc.Menu(this.root,this.id+"OverflowMenu",null,null,null),r=new nc.a(this.root,this.id+"OverflowMenuSection",
null,null,{DisplayMode:"Menu20",ShowSeperator:"false",Scrollable:"true"},h);for(const z of b)r.Sf(z.GP("Menu20"));h.Sf(r);return h}Gjn(){this.x3d();this.Kc=jg.a.NOa(this.Kc);this.DB();var b;({e$n:r,f0m:b,k8l:z}=this.U0n());for(var h of r){var r=h.GP("Medium20");r.enabled=!0;this.IWb(r,this.children.count);this.Kc.appendChild(r.Kc);r.Mka()}if(b=this.dMk(b))this.Yrb?this.Yrb.menu=b:(h=this.id+"OverflowMenuLauncher",r={},r.Image20by20=this.Mre.OverflowMenuImage20by20,r.Image20by20Class=this.Mre.OverflowMenuImage20by20Class,
r.PopulateDynamically="false",r.HideDefaultArrow="true",r.Alt=this.Mre.OverflowMenuTooltip,r.Command="798637440",r.Id=h,this.Yrb=new GA.FlyoutAnchor(this.root,h,r,b)),b=this.Yrb.GP("Small20"),b.enabled=!0,this.IWb(b,this.children.count),this.Kc.appendChild(b.Kc),b.Mka();if(t.AFrameworkApplication.K.$("FixHeroDockNotPollingInvisibleComponentsIsEnabled"))for(const R of z){var z=R.GP("Medium20");this.Sf(z);z.Mka()}}dispose(){this.Yrb&&(this.Yrb.dispose(),this.Yrb=null);for(const b of this.ZKc)b.dispose();
this.x3d();super.dispose()}set Yz(b){super.Yz=b}}Bw.uxh=4;Object(n.a)(Bw,"HeroDock",nx.a,[]);var Ly=d(616);class My extends Ly.a{constructor(){super();this.A$d=this.ehm=this.D2n=!1;this.FFm=t.AFrameworkApplication.Zrf?1:Bw.uxh}}Object(n.a)(My,"ToolbarBuildOptions",Ly.a,[]);var mj=d(52),Lt=d(856),ox=d(710);class fy extends nx.a{constructor(b,h,r){super(b,h,"","");this.qjc=r.Alignment;this.sCg=r.ScalingDirection===mj.a.dpj}km(){this.zsa();this.ZV(this.Kc);super.km()}ZV(b){for(let h of this.children){h.DB();
switch(this.qjc){case mj.a.lfe:jg.a.Pf(h.Kc,"cui-toolbar-button-left");break;case mj.a.Q4a:jg.a.Pf(h.Kc,"cui-toolbar-button-center");break;case mj.a.dNb:jg.a.Pf(h.Kc,"cui-toolbar-button-right");break;default:throw Error.argumentOutOfRange(this.qjc);}h.visible&&b.appendChild(h.Kc);h.Mka()}}LN(b){if(!Object(nb.a)(ea.a,b))throw Error.create("Only children of type ControlComponent can be added to a ButtonDock.");}get cssClass(){switch(this.qjc){case mj.a.lfe:return"cui-toolbar-buttondock alignleft";case mj.a.Q4a:return"cui-toolbar-buttondock aligncenter";
case mj.a.dNb:return"cui-toolbar-buttondock alignright";default:throw Error.argumentOutOfRange(this.qjc);}}get Yz(){return!0}get alignment(){return this.qjc}c4b(){let b=0;if(this.alignment===mj.a.Q4a)for(let h of this.children){const r=h;r.visible&&(b+=r.Kc.offsetWidth)}else b=this.Kc.offsetWidth;return b}jId(){let b=null;if(this.alignment===mj.a.Q4a)for(let h of this.children){if(h.visible){b=Sys.UI.DomElement.getBounds(h.Kc);break}}else b=Sys.UI.DomElement.getBounds(this.Kc);return b?0===this.root.C_?
b.x:b.x+b.width:0}wFd(){let b=null;if(this.alignment===mj.a.Q4a){if(0<this.children.count){const h=this.children.xFd(this.children.count-1);for(;h.F0a();){const r=h.get_current();if(r.visible){b=Sys.UI.DomElement.getBounds(r.Kc);break}}}}else b=Sys.UI.DomElement.getBounds(this.Kc);return b?0===this.root.C_?b.x+b.width:b.x:0}m7e(){for(let b of this.children){const h=b;if(!Object(nb.a)(ea.a,h)||h.control.visible)h.visible=!0}}pCn(b){const h=this.children.toArray(),r=new ox.a;let z=this.sCg?0:h.length-
1;const R=this.children.count,ba=this.root.YPa;for(;this.c4b()>=b&&!(z>=R||0>z);){const ta=h[z];ba&&Object(nb.a)(ea.a,ta)&&ta.control.visible&&(r.add(ta),ta.Nch());z+=this.sCg?1:-1}for(let ta of r)ta.INi(),ta.visible=!1}set Yz(b){super.Yz=b}}Object(n.a)(fy,"ButtonDock",nx.a,[]);class ls extends Qg.a{constructor(b,h,r,z,R,ba,ta=!1){super(b,h,ba);this.wpa=this.iY=this.dja=null;this.Aze=!1;this.G_a=z;this.A$d=R;this.iod=0;qf.c(h.Size)||(h.Size===mj.a.Jdg||r.options.ehm?this.iod=0:h.Size===mj.a.Qrj&&
(this.iod=1));this.fYj=ta}get YPa(){return!0}Sf(b){super.Sf(b);Object(nb.a)(fy,b)&&!this.Aze&&(b.alignment===mj.a.lfe?(this.dja&&this.EYf(),this.dja=b):b.alignment===mj.a.Q4a?(this.iY&&this.EYf(),this.iY=b):b.alignment===mj.a.dNb&&(this.wpa&&this.EYf(),this.wpa=b))}EYf(){this.Aze=!0;this.wpa=this.iY=this.dja=null}gkb(b,h){b=this.KHc(b);qf.c(b)||b.visible===h||(b.visible=h,this.refresh())}km(){super.km();this.wLi(!0)}wLi(b){const h=this.root.axb;qf.c(this.Kc)&&this.oOk();this.Kc=jg.a.NOa(this.Kc);
this.$Kc&&this.Kc.appendChild(this.$Kc);for(let r of this.children)r.visible&&(r.DB(),this.Kc.appendChild(r.Kc),r.Mka());this.iY&&b&&this.m2k();h&&h.HX();this.dirty=!1}m2k(){if(this.iY.visible&&this.iY.children.count&&(this.Zch(0,0),this.OZk(this.dja,this.iY,this.wpa))){let b=0,h=0;const r=this.dja?this.dja.c4b():0,z=this.wpa?this.wpa.c4b():0;if(0<z||0<r)z>r?(b=0,h=z-r):(b=r-z,h=0);this.Zch(b,h)}}OZk(b,h,r){let z=!1;0===this.root.C_?(b&&(z=b.wFd()>h.jId()),!z&&r&&(z=h.wFd()>r.jId())):(b&&(z=b.wFd()<
h.jId()),!z&&r&&(z=h.wFd()<r.jId()));return z}Zch(b,h){0===this.C_?(this.iY.Kc.style.marginLeft=b+"px",this.iY.Kc.style.marginRight=h+"px"):(this.iY.Kc.style.marginRight=b+"px",this.iY.Kc.style.marginLeft=h+"px")}oOk(){this.DB()}Ht(){this.SAh(()=>{Zs.a.prototype.Ht.call(this)})}gM(b){b=this.KHc(b);qf.c(b)||this.SAh(Object(u.a)(b,b.yl,"pollForStateAndUpdate"))}SAh(b){this.X9b=this.I0a=!1;b();if(this.I0a||this.X9b)this.fYj||this.refresh(),this.scale()}LN(b){if(!Object(nb.a)(Bw,b)&&!Object(nb.a)(fy,
b))throw Error.create("Only children of type ButtonDock and HeroDock can be added to a Toolbar");if(Object(nb.a)(fy,b)&&b.alignment===mj.a.Q4a)for(let h of this.children)if(h.alignment===mj.a.Q4a)throw Error.create("Can't add a centered buttondock because one is already present.");}get cssClass(){let b="cui-toolbar-toolbar ";0===this.iod?(b+="cui-toolbar-onerow ",t.AFrameworkApplication.ua&&t.AFrameworkApplication.ua.Sb.C6||(b+="UITextTranformUpperCase ")):1===this.iod&&(b+="cui-toolbar-singledock ");
return b+super.cssClass}get psa(){return"div"}get l7(){return 26}get wbj(){return this.rN}set wbj(b){this.rN=b}fIk(b){b=b[mj.a.Vv];return new fy(this.root,b.Id,b)}DB(){super.DB();this.Kc.setAttribute("role","toolbar");this.properties.Title&&this.Kc.setAttribute("title",this.properties.Title)}mFa(b){return this.root&&this.root.Wbc(b)?!0:!1}UJn(){this.tPa()}scale(){super.scale();if(!jg.a.ur(this.properties.Scale)||this.Aze)return!1;qf.c(this.dja)||(this.dja.visible=!0,this.dja.m7e());qf.c(this.iY)||
(this.iY.visible=!0,this.iY.m7e());qf.c(this.wpa)||(this.wpa.visible=!0,this.wpa.m7e());this.wLi(!1);const b=this.Kc.offsetWidth,h=qf.c(this.dja)?0:this.dja.c4b(),r=qf.c(this.iY)?0:this.iY.c4b(),z=qf.c(this.wpa)?0:this.wpa.c4b();z+r+h>=b&&(z+h>=b?(this.X4h(this.iY),z>=b?(this.X4h(this.dja),this.WVf(this.wpa,b)):this.WVf(this.dja,b-z)):this.WVf(this.iY,b-z-h));this.I0a=!1;this.km();return!1}X4h(b){b&&(b.visible=!1)}WVf(b,h){b&&b.pCn(h)}}Object(n.a)(ls,"Toolbar",Qg.a,[833]);class Jz extends ls{constructor(b,
h,r,z,R=!1){super(b,h,r,!1,!1,z,R);this.COg=!0}get l7(){return 7}get cssClass(){return Jz.E2n+" "+super.cssClass}static get E2n(){let b="cui-statusbar";t.AFrameworkApplication.ua&&t.AFrameworkApplication.ua.Sb.C6||(b+=" UISmallFont UITextTranformUpperCase");return b}}Object(n.a)(Jz,"StatusBar",ls,[]);var Ny=d(512);class Kz extends Ny.a{constructor(){super();this.toolbar=null;this.rQd=!1}}Object(n.a)(Kz,"ToolbarBuildContext",Ny.a,[]);class HA extends Id.Builder{constructor(b,h,r,z){super(b,h,ee.Task.e$(r),
z);if(qf.c(h))throw Error.create("Toolbar placeholder DOM element is null or undefined.");}get toolbar(){return this.root}IZf(b){this.root=b}get X5f(){return this.options}Ank(){const b=new Kz,h=new Lt.a;h.id="toolbar";h.HWc=1;h.handler=Object(u.a)(this,this.zWm,"onReturnToolbarData");h.data=b;this.esa.m5d(h)}zWm(b){this.IZf(this.Cnk(b.$Vc,b.eCc));this.toolbar.wbj=this;this.toolbar.km();this.placeholder.appendChild(this.toolbar.Kc);jg.a.Pf(this.placeholder,"loaded");this.Era.continueWith(()=>{this.Era.result.fGb(this.toolbar)},
11)}Cnk(b,h){var r=mj.a.yea(b,mj.a.ysj);qf.c(r)&&(r=mj.a.yea(b,mj.a.Xrj),h.rQd=!0);if(qf.c(r))throw Error.create("No toolbar element was present in the data");b=new mj.a(r);r=t.AFrameworkApplication.K.$("ToolbarScalingRedundancyEliminationIsEnabled");h.rQd?this.IZf(new Jz(b.attributes[mj.a.id],b.attributes,this,this.V8,r)):this.IZf(new ls(b.attributes[mj.a.id],b.attributes,this,this.X5f.D2n,this.X5f.A$d,this.V8,r));this.toolbar.Ira=this.options.Ira;this.toolbar.ode=!0;this.toolbar.km();b=mj.a.Iv(mj.a.yea(b.node,
mj.a.Ooj));h=this.Fkk(b,h);for(const z of h)this.toolbar.Sf(z);return this.toolbar}Fkk(b,h){const r=[];for(let z=0;z<b.length;z++)this.CMa(b[z])||Array.add(r,this.mlk(b[z],h));return r}mlk(b,h){const r=mj.a.WIc(b);let z=null;r===mj.a.unj?z=this.Okk(b,h):r===mj.a.spj&&(z=this.Klk(b,h));return z}Klk(b,h){var r=new mj.a(b);r=new Bw(this.root,r.attributes[mj.a.id],b[mj.a.Vv]);r.S4h=this.X5f.FFm;b=mj.a.yea(b,mj.a.Rmb);b=mj.a.Iv(b);const z=[];for(let ba=0;ba<b.length;ba++){var R=b[ba];this.CMa(R)||(R=this.tda(R,
h),Array.add(z,R))}r.ZKc=z;return r}Okk(b,h){new mj.a(b);const r=this.toolbar.fIk(b);b=mj.a.yea(b,mj.a.Rmb);b=mj.a.Iv(b);for(let z=0;z<b.length;z++){if(this.CMa(b[z]))continue;const R=this.Bnk(b[z],h);r.Sf(R)}return r}Bnk(b,h){var r=new mj.a(b);const z=r.name;r=r.attributes[mj.a.uic];let R;R=h.rQd?"Small14":"Small";switch(z){case mj.a.button:return b=this.tda(b,h),b.GP(qf.b(r)?R:r);case mj.a.KAa:return R=h.rQd?"Medium14":"Medium",b=this.tda(b,h),b.GP(qf.b(r)?R:r);case mj.a.label:return b=this.tda(b,
h),b.GP(qf.b(r)?R:r);case mj.a.separator:return b=this.tda(b,h),b.GP("Small");case mj.a.toggleButton:return b=this.tda(b,h),b.GP(qf.b(r)?R:r);default:throw Error.create("Invalid control type.");}}}Object(n.a)(HA,"ToolbarBuilder",Id.Builder,[]);var Lz=d(1446);class Oy{constructor(b,h,r,z,R,ba){this.aib=()=>{this.toolbar.yl()};this.zH=b;b=new In.CuiHelper(il.a.yab,WordEditorIntl.WordEditorStrings,null,null,[WoncaIntl.WoncaStrings,Box4Intl.Box4Strings]);z=new My;z.eG={};ba=3!==ba.mode;z.eG.HeaderToolbarControlsRight=
ba;z.eG.HeaderToolbarButtonDockRight=ba;z.eG.HeaderToolbarButtonRemovePageNumbers=ba;R=new HA(z,this.zH,this,R);R.esa=new Lz.a(Oy.DXl,b);R.Ank();this.nja=R.toolbar;r.execute(ta=>{this.toolbar.vE=ta});this.toolbar.refresh();this.toolbar.yl();this.Eh=h;h.pVa(this.aib)}get toolbar(){return this.nja}dispose(){this.Eh.mcc(this.aib);this.toolbar&&(this.toolbar.dispose(),this.nja=null)}refresh(){this.toolbar.refresh()}setFocus(){this.toolbar.UJn()}mXk(){this.toolbar.T1()}fGb(){}}Oy.DXl="WordEditorHeaderToolbarData";
Object(n.a)(Oy,"HeaderFooterToolbar",null,[282,484]);class Py{constructor(b,h,r,z,R){this.Eh=b;this.Rle=h;this.Ac=r;this.V8=z;this.ga=R}create(b){return new Oy(b,this.Eh,this.Rle,this.Ac,this.V8,this.ga)}}Object(n.a)(Py,"Factory",null,[461]);class IA{constructor(b,h){this.Xc=b;this.Kk=h}oNk(b){return'<Menu Id="HeaderToolbarSectionMenu"><MenuSection Id="HeaderToolbarSectionSection" DisplayMode="Menu16"><Controls Id="HeaderToolbarSectionControls">'+this.nNk(b)+"</Controls></MenuSection></Menu>"}ztl(b){const h=
this.Xc.Dk();h.set(b);h.Bb(8);h.kd(8);return h}nNk(b){if(!b)return"";let h="";b=this.ztl(b);this.Kk.XKa(b,r=>{const z=this.Kk.h1h(r);r=r.getValue(yc.a.Ega);h+=Kf.m(r.toString(),r.toString(),Oa.a.kXf.toString(),Oa.a.mOf.toString(),String.format(WordEditorIntl.WordEditorStrings.L_HeaderToolbarSectionButtonLabel,z));return!0});return h}}Object(n.a)(IA,"HeaderFooterToolbarGenerator",null,[462]);var JA=d(117);class KA extends gv.a{constructor(b,h,r,z,R,ba,ta,Wa){super(b,h,r,z);this.Wr=()=>{this.y3c(this.zb)};
this.zH=b.container;this.ov=document.createElement("div");this.gC(this.ov);this.eya=R;this.$Ga=ba;this.Hn.execute(ub=>{ub.h7(this.Wr)});this.QE=ta;if(this.KH=Wa)this.zH.style.backgroundColor=this.QE.KAb()}dispose(){super.dispose();this.Hn.instance&&this.Hn.instance.Bjb(this.Wr)}get Hn(){return null!=this.Ekg?this.Ekg:this.Ekg=Sa.a.instance.Za("Common.IZoomManager")}fz(b){this.zH.classList.add("HeaderFooterViewElement");this.ov.classList.add("HeaderFooterViewContent");this.y3c(b.currentNode)}S7(b){this.ov.parentNode&&
this.ov.parentNode===this.zH||(this.zH.appendChild(this.ov),this.$Ga.instance&&this.$Ga.instance.MZf(this.fc,this.zH));super.S7(b)}nmb(b){JA.a.Pd(()=>{JA.a.prototype.nmb.call(this,b);this.vgj();this.$Ga.instance&&this.$Ga.instance.Efj(this.fc,this.ov.style.paddingLeft,this.ov.style.paddingTop)},"HFVE:UFO")}y3c(b){this.Hn.instance&&this.Hn.instance.h5c(this.ov);this.vgj();b=this.eya.G3b(b);this.ov.style.paddingLeft=b.OZb+"px";this.ov.style.width=b.dCc+"px";this.$Ga.instance&&this.$Ga.instance.Efj(this.fc,
this.ov.style.paddingLeft,this.ov.style.paddingTop)}vgj(){if(this.Hn.instance){this.ov.style.paddingTop="";var b=Ul.a.IB(this.ov);b.paddingTop&&(b=$e.a.eM(b.paddingTop),this.ov.style.paddingTop=Math.round(b/this.Hn.instance.vj)+"px")}}}Object(n.a)(KA,"HeaderFooterViewElement",gv.a,[]);class Qy{constructor(b,h,r,z){this.eya=b;this.$Ga=h;this.QE=r;this.KH=z}create(b,h,r,z){return new KA(b,h,r,z,this.eya,this.$Ga,this.QE,this.KH)}}Object(n.a)(Qy,"Factory",null,[460]);var gy=d(371),LA=d(189),Ry=d(946),
MA=d(581);class Mz extends gy.a{constructor(b,h,r,z,R,ba,ta,Wa,ub,Ib,$b,fc,Kc,ed,Jd,ge,qe,Ve){super(h,ba,ta,Wa,ub,LA.a.Ulf,Ib,$b,fc,Kc,ed,Jd,ge,qe,Ve);this.isHeader=this.isHeader=b;this.YTa=R;this.YTa.U1c=this;z(this);this.J8c=r;this.pxa=document.createElement("div");this.pxa.setAttribute("Unselectable","on");this.pxa.setAttribute("hideselection","hideselection");this.pxa.setAttribute("style","outline:none;");this.pxa.innerText=WordEditorIntl.WordEditorStrings.l_HeaderFooterNoContentAvailableMessage;
this.pxa.tabIndex=0;this.features.J3i=!0;this.features.uVe=!0}get crf(){return!0}ijf(){const b=this.J8c.Baf(this);return Ry.ViewReference.sF(this,b)}B4e(b){Object(nb.a)(Mz,b)||this.J8c.dismiss()}get flf(){return"WordEditor"+(this.isHeader?"Header":"Footer")+"HiddenLabel"}CJc(){return MA.a.Hri}onResize(){super.onResize();this.YTa.vEh()}rB(b,h=null){this.pxa.parentNode&&this.pxa.parentNode.removeChild(this.pxa);super.rB(b,h);this.YTa.iEh(this.rd.Qi)}detach(){this.YTa.uEh();super.detach();this.pxa.parentNode||
this.container.insertBefore(this.pxa,this.container.firstChild)}F_c(){this.Qr?super.F_c():this.pxa.focus()}HDd(){this.onResize()}}Object(n.a)(Mz,"HeaderFooterView",gy.a,[439,139,140,80,9,45,141,142,143]);class NA{constructor(b,h,r,z,R,ba,ta,Wa,ub,Ib,$b,fc,Kc,ed,Jd,ge){this.J8c=b;this.UZj=h;this.TZj=r;this.rt=z;this.Zc=R;this.pja=ba;this.ga=ta;this.ESa=Wa;this.Tqa=ub;this.f5=Ib;this.A_j=$b;this.Lt=fc;this.aA=Kc;this.Bf=ed;this.sh=Jd;this.C8c=ge}create(b,h){return new Mz(b,h,this.J8c,this.UZj,this.TZj(),
this.rt,this.Zc,this.pja,this.ga,this.ESa,this.Tqa,this.f5,this.A_j,this.Lt,this.aA,this.Bf,this.sh,this.C8c)}}Object(n.a)(NA,"Factory",null,[459]);class Cw{constructor(b,h,r,z,R,ba,ta,Wa,ub,Ib,$b,fc,Kc,ed,Jd,ge,qe,Ve){this.PUg=!1;this.d1g="SourceControlId";this.y8n=1;this.z8n=1E3;this.z1d=(Bd,he,we,hg,Pf)=>{if(1===we)return 32;this.hbd(Pf[this.d1g]);Pf[Fi.a.Text]=this.TBe.V0m(this.P8a.$Bb);return 32};this.acn=(Bd,he,we,hg,Pf)=>{if(1===we)return 32;Pf[Yf.a.On]=this.P8a.$Bb;return 32};this.z0l=(Bd,
he,we,hg,Pf)=>{if(1===we)return 32;this.P8a.rjo(Pf[Yf.a.On]);return 32};this.cOi=(Bd,he,we)=>{if(1===we)return 32;if(this.p8){he=Cw.qh.ju(he.view.rd);we=Nd.GraphIterator.$a(he);const hg=this.Hd.HVa();try{const Pf=this.Hc.Rc(15);try{Pf.Db(he),Pf.Al=Bd,km.a.instance.XKa(we,Ej=>{this.jTb.PXc(Ej,this.Gol,this.kLn);return!0})}finally{Pf&&Pf.dispose()}}finally{hg&&hg.dispose()}}return 32};this.jVc=(Bd,he,we,hg,Pf)=>{if(1===we)return 32;Pf.MenuItems=this.QPj.value;this.PUg?this.P8a.wwn():this.PUg=!0;return 32};
this.q6l=(Bd,he,we,hg,Pf)=>{if(1===we)return 32;const Ej=this.hbd(Pf[this.d1g]);if(this.p8){he=Cw.qh.ju(he.view.rd);we=Nd.GraphIterator.$a(he);hg=this.Hc.Rc(15);try{hg.Db(he);hg.Al=Bd;let pn=null;const Ol=this.le.hg("UserAction","InsertPageNumber");km.a.instance.XKa(we,qt=>{this.p8.V9||this.CCj(qt);pn=this.SBe.o6l(qt,Ej,this.P8a.$Bb)||pn;return!0});Ol.stop();if(!pn)return 8;this.xXn(pn,Ej)}finally{hg&&hg.dispose()}this.Hd.zs(12)}return 32};this.U0m=()=>32;this.cYn=(Bd,he,we,hg,Pf)=>{if(1===we)return 32;
2===we&&this.fIa.showCallout(Pf);return 32};this.bYn=(Bd,he,we,hg,Pf,Ej)=>this.sHe.create(Bd,he,we,hg,Pf,Ej);this.pXk=(Bd,he,we)=>{if(1===we)return 32;this.fIa.iAh();return 32};this.uWn=Bd=>{t.AFrameworkApplication.ya.tna(null,Oa.a.g5i,Bd.customData,null)};this.Gol=Bd=>{const he=di.a.instance.hb.kb;let we=-1;for(let hg of he)if(hg.node===Bd){we=hg.cpBegin;break}return{returnValue:we,gPd:Xd.SelectionEditor.Qm(he)}};this.kLn=(Bd,he)=>{Bd=Hf.SelectionFactory.xe(Bd,he);di.a.instance.setSelection(Bd)};
this.ga=b;this.Hc=h;this.Hb=r;this.P8a=z;this.p8=R;this.Nl=ba;this.TBe=ta;this.SBe=Wa;this.jTb=ub;this.fIa=Ib;this.ib=$b;this.sHe=fc;this.le=Kc;this.Hd=ed;this.hbd=Jd;this.CCj=Ve;this.QPj=new De.a(()=>this.P8a.wCl())}Vb(){this.ga.gb(Oa.a.jVc,kc.a.view,this.jVc,100);this.ga.gb(Oa.a.RCi,kc.a.view,this.U0m,68);this.ga.gb(Oa.a.d9h,kc.a.view,this.q6l,4);this.ga.gb(Oa.a.$Bb,kc.a.view,this.z0l,4);this.ga.gb(Oa.a.PXc,kc.a.view,this.cOi,4);this.ga.gb(Oa.a.tqn,kc.a.view,this.cOi,4);this.ga.gb(Oa.a.MOf,kc.a.application,
this.acn,97);this.ga.gb(Oa.a.z1d,kc.a.application,this.z1d,97);this.ga.gb(Oa.a.f5i,kc.a.view,this.cYn,4);this.ga.pS(Oa.a.g5i,kc.a.view,this.bYn,100);this.ga.gb(Oa.a.oXk,kc.a.view,this.pXk,4)}xXn(b,h){const r=b.Ob.paragraph;if(r){var z=this.Nl.hDf(r);z&&this.p8.dea(z)}z=this.p8.V9;this.p8.show(4>h);r&&this.yKn(r)&&(this.BOn(b,r),this.y5j(b,z))}yKn(b){let h;if(!({isHeader:h,S4f:b}=this.Nl.I_h(b)).returnValue)return!1;this.p8.Bva(b,h);return!0}BOn(b,h){b=Hf.SelectionFactory.xe(h,b.Ob.cp);this.ib.setSelection(b)}y5j(b,
h){h=new Ic.a(2,1,h?this.y8n:this.z8n,this.uWn);h.customData=b;this.Hb.$b(h)}static get qh(){return ml.PageNavigator.instance}}Object(n.a)(Cw,"PageNumbersActor",null,[438]);class Nz{constructor(b,h,r,z,R,ba,ta,Wa,ub,Ib,$b,fc,Kc){this.ga=b;this.Hb=h;this.P8a=r;this.TBe=z;this.SBe=R;this.jTb=ba;this.fIa=ta;this.sHe=Wa;this.Nl=ub;this.Hd=Ib;this.hbd=$b;this.bZj=fc;this.Wca=Kc}create(b,h){return new Cw(this.ga,new $m.a,this.Hb,this.P8a,b,this.Nl,this.TBe,this.SBe,this.jTb,this.fIa,di.a.instance,this.sHe,
vb.App.xa.jq,this.Hd,this.hbd,this.bZj,this.Wca,h)}}Object(n.a)(Nz,"Factory",null,[409]);var zr=d(1847),px;(function(b){b[b.small=0]="small";b[b.mediumSmall=1]="mediumSmall";b[b.medium=2]="medium";b[b.large=3]="large"})(px||(px={}));Object(n.b)("ModalCalloutSize",px);var Mt;(function(b){b[b.topCenter=0]="topCenter";b[b.topJustified=1]="topJustified";b[b.topLeft=2]="topLeft";b[b.topRight=3]="topRight";b[b.bottomCenter=4]="bottomCenter";b[b.bottomLeft=5]="bottomLeft";b[b.bottomRight=6]="bottomRight"})(Mt||
(Mt={}));Object(n.b)("BeakLocation",Mt);class Sy{constructor(b,h,r){this.x8n=1;this.pEe=!1;this.CUb=null;this.fln=()=>{this.ib.oB(this.una);this.pEe=!0;this.CUb=null};this.una=(z,R)=>{if(z=R.ll.kb)1<z.length||!z.length?z=!0:(z=z.Qa,z=z.cpEnd-z.cpBegin,z=1<z||!z),z&&this.GBj()};this.Hb=b;this.ib=h;this.GBj=r}Xy(){this.x5j()}Q7(){this.pEe?(this.ib.uga(this.una),this.pEe=!1):this.CUb&&(this.Hb.We(this.CUb),this.CUb=null)}x5j(){this.CUb=new Ic.a(2,1,this.x8n,this.fln);this.Hb.$b(this.CUb)}}Object(n.a)(Sy,
"CalloutDismissManager",null,[]);class Dw{constructor(b,h,r,z){this.dismiss=()=>{this.fH&&(this.qmc.Q7(),this.iSc.dismiss())};this.iSc=b;this.zp=z;this.qmc=new Sy(h,r,this.dismiss)}get fH(){return this.iSc.fH}show(){if(!this.fH){const b=document.createElement("div");b.classList.add(Dw.T0m);b.innerText=WordEditorIntl.WordEditorStrings.L_PageNumbersCalloutText;this.iSc.content=b;this.iSc.show();this.zp&&this.zp.sendNotification(WordEditorIntl.WordEditorStrings.L_PageNumbersCalloutText,!0);this.qmc.Xy()}}dispose(){this.dismiss();
this.iSc.dispose()}static qLk(b,h){h=zr.a.ouh(Ed.a.getElementBounds(b.targetElement),h,vb.App.xa.lC,px.small);h.oda=Dw.Tbf(b);h.Bt=!1;return h}static Tbf(b){let h=Mt.bottomCenter;Object(nb.a)(439,b.view)&&b.view.isHeader&&(h=Mt.topCenter);return h}}Dw.T0m="PageNumbersCalloutControl";Object(n.a)(Dw,"PageNumbersCallOutControl",null,[437]);class Oz{constructor(b,h,r){this.VR=null;this.KR=!1;this.dismiss=()=>{this.fH&&this.VR&&Uk.UISurfaces.bK().then(z=>{this.qmc.Q7();z.removeNotification(this.VR);this.KR=
!1;return null},z=>{v.ULS.sendTraceTag(593352339,383,15,"Failed to GetNotificationsAPIAsync: {0}",z);return null})};this.Tl=b;this.qmc=new Sy(h,r,this.dismiss)}get fH(){return this.KR}show(){this.fH||Uk.UISurfaces.bK().then(b=>{const h=b.callout(Object.assign(new Fq.a,{target:this.Tl,content:WordEditorIntl.WordEditorStrings.L_PageNumbersCalloutText})),r=Object.assign(new Oc.a,{telemetryId:"PageNumbersCallout",onShow:()=>{this.KR=!0},expirationOptions:Object.assign(new Fd.a,{displayTimeoutSeconds:7,
onExpire:()=>{this.dismiss()}})});this.VR=b.addNotification(h,r);this.qmc.Xy();return null},b=>{v.ULS.sendTraceTag(593352340,383,15,"Failed to GetNotificationsAPIAsync: {0}",b);return null})}}Object(n.a)(Oz,"ReactPageNumbersCallOutControl",null,[437]);class hy{constructor(b,h,r){this.ib=h;this.Hb=b;this.zp=r}create(b,h){if(t.AFrameworkApplication.ua.Sb&&t.AFrameworkApplication.ua.Sb.HMa)return new Oz(h.targetElement,this.Hb,this.ib);b=Dw.qLk(h,b);return new Dw(b,this.Hb,this.ib,this.zp,t.AFrameworkApplication.ua.wM)}}
Object(n.a)(hy,"Factory",null,[408]);class iy{constructor(b,h){this.HD=null;this.PPj=b;this.zi=h}get control(){return this.HD}showCallout(b){this.control&&this.control.fH&&this.control.dismiss();this.HD=this.L7m(b);this.control.show()}iAh(){this.control&&(this.control.dismiss(),this.HD=null)}L7m(b){const h=this.zi.hla();this.HD=this.PPj.value.create(h,b);return this.control}}Object(n.a)(iy,"PageNumbersCalloutControlManager",null,[407]);var gC=d(757);class hC extends ap.a{constructor(){super();this.Text=
null}get Type(){return 7}}Object(n.a)(hC,"PageNumberGalleryButtonProps",ap.a,[]);const Nt=(b,h,r)=>{b=b.Dk();b.set(r);h.DFb(b);return b};class Tr{constructor(b,h,r){this.Vse=!1;this.Wca=h;this.Ql=r}get $Bb(){return this.Vse}wCl(){const b=Object.assign(new ni.a,{Id:"menuPageNumbersDropDown",MenuSectionList:[]});b.MenuSectionList.push(this.f3j());b.MenuSectionList.push(this.S3j());b.MenuSectionList.push(this.t4j());return b}rjo(b){this.Vse=b;this.uLi()}wwn(){this.Vse=!1;const b={};b[Tr.f7h]="CheckboxModel";
this.Wca(b);this.uLi()}f3j(){const b=Object.assign(new hi.a,{Id:"msIncludePageCount",ControlsId:"ctrlIncludePageCount",Title:B.a.If(WordEditorIntl.WordEditorStrings.L_PageNumbersSectionHeaderForAdd),ShowMenuSectionSeparator:!1,DisplayMode:"Menu16",ControlList:[]}),h=Object.assign(new gC.a,{Id:Tr.A0l,Command:Oa.a.$Bb.toString(),QueryCommand:Oa.a.MOf.toString(),LabelText:B.a.If(WordEditorIntl.WordEditorStrings.L_IncludePageCount),Alt:B.a.If(WordEditorIntl.WordEditorStrings.L_IncludePageCountAlt),KeyTip:CommonUIStrings.l_IncludePageCountKeytip,
UseUncheckedImage:!0,CloseMenuWhenExecuted:!1});b.ControlList.push(h);return b}S3j(){const b=Object.assign(new hi.a,{Id:"msPageNumbersPosition",ShowMenuSectionSeparator:!1,ControlList:[]}),h=Object.assign(new lo.a,{Id:"galleryPageNumbersPosition",ExternalId:"PageNumbers",ExternalGalleryId:"InsertPageNumberGallery",Type:7,Width:3,ElementDimensions:"Size61by75",GalleryItems:[]});if(this.Ql){for(var r=3;1<=r;r--)h.GalleryItems.push(this.pef(r));for(r=6;4<=r;r--)h.GalleryItems.push(this.pef(r))}else for(r=
1;6>=r;r++)h.GalleryItems.push(this.pef(r));b.ControlList.push(h);return b}t4j(){const b=Object.assign(new hi.a,{Id:"msRemovePageNumbers",ControlsId:"ctrlRemovePageNumbers",DisplayMode:"Menu16",ControlList:[]}),h=Object.assign(new nh.a,{Id:"btnRemovePageNumber",Command:Oa.a.PXc.toString(),LabelText:B.a.If(WordEditorIntl.WordEditorStrings.L_RemovePageNumbers),Alt:B.a.If(WordEditorIntl.WordEditorStrings.L_RemovePageNumbersAlt),Image16by16:t.AFrameworkApplication.pr,Image16by16Class:Wh.getImageClass("WordRemovePageNumbers_16x16x32"),
KeyTip:CommonUIStrings.l_RemovePageNumbersKeytip});b.ControlList.push(h);return b}pef(b){const h=Tr.TJf+b.toString();var r=Object,z=r.assign,R=new hC,ba=Oa.a.d9h.toString(),ta=Oa.a.z1d.toString(),Wa=B.a,ub=Wa.If;let Ib="";switch(b){case 1:Ib=WordEditorIntl.WordEditorStrings.L_PageNumbersOnTopLeftAlt;break;case 2:Ib=WordEditorIntl.WordEditorStrings.L_PageNumbersOnTopCenterAlt;break;case 3:Ib=WordEditorIntl.WordEditorStrings.L_PageNumbersOnTopRightAlt;break;case 4:Ib=WordEditorIntl.WordEditorStrings.L_PageNumbersOnBottomLeftAlt;
break;case 5:Ib=WordEditorIntl.WordEditorStrings.L_PageNumbersOnBottomCenterAlt;break;case 6:Ib=WordEditorIntl.WordEditorStrings.L_PageNumbersOnBottomRightAlt}return z.call(r,R,{Id:h,Command:ba,QueryCommand:ta,Alt:ub.call(Wa,Ib)})}uLi(){const b={};for(let h=1;6>=h;h++)b[Tr.TJf+h.toString()]="PageNumberGalleryButtonModel";b[Tr.f7h]="CheckboxModel";this.Wca(b)}static xCl(b){return b?parseInt(b.substr(Tr.TJf.length)):1}}Tr.A0l="btnIncludePageCount";Tr.f7h="IncludePageCount";Tr.TJf="btnPageNumbersPosition";
Object(n.a)(Tr,"PageNumbersControl",null,[406]);class pr{constructor(b,h,r,z,R=null,ba=null,ta=null,Wa=null){this.aul=(ub,Ib)=>{const $b=new Nk.a;ub=4>ub;switch(Ib){case 1:case 2:$b.add(ub?0:3);break;case 3:case 4:$b.add(ub?0:3),$b.add(ub?1:4)}return $b};this.hnl=(ub,Ib,$b)=>{var fc=Nt(this.Xc,this.Nl,ub);this.Nl.EFb(fc,$b);let Kc=this.$zj(fc,Ib);if(Kc)this.jTb.EOi(Kc);else{fc=Nt(this.Xc,this.Nl,ub);this.Nl.EFb(fc,$b);fc.Xd();if(vg.OutlineElementReader.Nh(fc)&&(ag.OutlineElementNavigator.De(fc),ie.ParagraphReader.zh(fc))){fc=
fc.currentNode;const ed=this.N_h(Ib);ie.ParagraphReader.Hv(fc)===ed&&this.jTb.EOi(fc)&&(Kc=fc)}Kc||(fc=Nt(this.Xc,this.Nl,ub),this.Nl.EFb(fc,$b),this.rK.qfb(fc,null,!0),Kc=ag.OutlineElementNavigator.De(fc),this.sD(Ib,Kc))}return Kc};this.inl=(ub,Ib)=>{let $b=null;ub.Rb(1);if(vg.OutlineElementReader.Nh(ub)&&(ub.Rb(2),Ii.TableReader.isTable(ub))){var fc=ub.currentNode;if(3===Ii.TableReader.kh(fc)){let Kc=0;fc=Ii.TableReader.hm(fc);switch(Ib){case 1:case 4:Kc=fc?2:0;break;case 2:case 5:Kc=1;break;case 3:case 6:Kc=
fc?0:2}Ke.moveToCellContent(ub,0,Kc);ub.currentNode&&vg.OutlineElementReader.Nh(ub)&&(ub=ag.OutlineElementNavigator.De(ub),ie.ParagraphReader.nc(ub)&&($b=ub))}}return $b};this.aem=(ub,Ib)=>{const $b=Nt(this.Xc,this.Nl,ub);ub=$b.currentNode.ia(yc.a.Ega,0);this.Nl.EFb($b,Ib);Ib=$b.currentNode.ia(yc.a.Ega,0);return ub===Ib};this.Xc=b;this.RPj=h;this.jTb=r;this.Nl=z;this.roc=R||this.aul;this.aAj=ba||this.hnl;this.$zj=ta||this.inl;this.YIj=Wa||this.aem}get rK(){return null!=this.pog?this.pog:this.pog=
Sa.a.instance.resolve("Box4.IOutlineEditor")}o6l(b,h,r){var z=Nt(this.Xc,this.Nl,b).Cn;z=this.Nl.zla(z);z=this.roc(h,z);let R=null;for(let ta=0;ta<z.length;ta++){var ba=z.lg(ta);this.YIj(b,ba)&&(ba=this.aAj(b,h,ba),R=this.RPj.R3j(ba,r)||R)}return R}sD(b,h){pr.H7.w7d(4>b?Box4Intl.Box4Strings.L_StyleWordHeader:Box4Intl.Box4Strings.L_StyleWordFooter,h);pr.paragraphEditor.sD(h,this.N_h(b))}N_h(b){let h=1;switch(b){case 1:case 4:h=1;break;case 2:case 5:h=2;break;case 3:case 6:h=3}return h}static get paragraphEditor(){return null!=
pr.lpg?pr.lpg:pr.lpg=Sa.a.instance.resolve("Box4.IParagraphEditor")}static get H7(){return null!=pr.zqg?pr.zqg:pr.zqg=Sa.a.instance.resolve("Box4.Styles.IWACStyleEditor")}}Object(n.a)(pr,"PageNumbersInserter",null,[405]);var Vv=d(865),Pz=d(873);class Mh{constructor(b,h,r=null,z=null,R=null){this.EHk=(ba,ta)=>{ba=Qe.a.Uc(ba,ie.ParagraphReader.textLength(ba));const Wa=ba.node.Lc;return Wa?Mh.characterPropertiesEditor.Uea(ba,ub=>{ub=Pz.a.getInstance(ub);this.oxd(ub,15,Wa,ta);this.oxd(ub,47,Wa,ta);this.oxd(ub,
16,Wa);this.oxd(ub,17,Wa);return ub}):null};this.Q6l=(ba,ta)=>{ba=Qe.a.Uc(ba,ie.ParagraphReader.textLength(ba));Mh.characterPropertiesEditor.replaceTextRange(ba,ta)};this.Hc=b;this.Rhd=r||WordEditorIntl.WordEditorStrings.L_PageNumbersPreviewTextForIncludeCount;this.Lle=z||this.EHk;this.O2g=R||this.Q6l}R3j(b,h){const r=this.Hc.Rc(15);r.Db(b);var z=ie.ParagraphReader.text(b),R=!1;0<z.length&&" "!==z.charAt(z.length-1)&&(R=!0);if(h){h=String.format(this.Rhd,"#","$");R&&(h=" "+h);R=h.indexOf("#");z=h.indexOf("$");
v.ULS.shipAssertTag(4256717,309,-1!==R,"{0}",{["PageNumberIndex"]:R});v.ULS.shipAssertTag(4256718,309,-1!==z,"{0}",{["PageCountIndex"]:z});v.ULS.shipAssertTag(4256719,309,R!==z,"{0}",{["PageNumberIndex"]:R,["PageCountIndex"]:z});let Wa;let ub;if(R<z){var ba=R;Wa=z;var ta=Vv.a.cIc(0);ub=Vv.a.cIc(1)}else ba=z,Wa=R,ta=Vv.a.cIc(1),ub=Vv.a.cIc(0);this.oof(b,h,0,ba);ta=this.Lle(b,ta);this.oof(b,h,ba+1,Wa);ba=this.Lle(b,ub);this.oof(b,h,Wa+1,h.length);b=R<z?ta:ba}else R&&this.O2g(b," "),b=this.Lle(b,Vv.a.cIc(0));
r.dispose();return b}oxd(b,h,r,z=null){const R=new ix.a;R.setValue(We.a.K7,!0);R.setValue(yc.a.dzb,1);R.setValue(yc.a.Eq,h);switch(h){case 15:R.setValue(yc.a.MMa,!0);R.setValue(yc.a.fieldInstruction,z);break;case 47:R.setValue(yc.a.fieldInstruction,z);break;case 17:R.setValue(yc.a.ODb,!0)}h=r.Ku(R,E.a.create());this.P4j(b,h)}P4j(b,h){b.mra(h,E.a.nil,dd.AParagraphNode.BB,null)}oof(b,h,r,z){h=h.substring(r,z);0<h.length&&this.O2g(b,h)}static get characterPropertiesEditor(){return Mh.Vd||(Mh.Vd=Sa.a.instance.resolve("Box4.ICharacterPropertiesEditor"))}static set characterPropertiesEditor(b){Mh.Vd=
b}}Mh.Vd=null;Object(n.a)(Mh,"PageNumbersNodeLevelInserter",null,[404]);class Ju{V0m(b){return Ju.MEl(b)}static MEl(b){return String.format(b?WordEditorIntl.WordEditorStrings.L_PageNumbersPreviewTextForIncludeCount:WordEditorIntl.WordEditorStrings.L_PageNumbersPreviewText,Ju.ACi,Ju.ACi)}}Ju.ACi="1";Object(n.a)(Ju,"PageNumbersPositionPreviewGenerator",null,[403]);class qx{constructor(){this.Syg=String.format(WordEditorIntl.WordEditorStrings.L_PageNumbersPreviewTextForIncludeCount,"\ufffc","\ufffc");
this.yzj=this.Syg.length}WWl(b){let h=b.characterData.lastIndexOf("\ufffc");return-1!==h&&h+1===ie.ParagraphReader.textLength(b)?{returnValue:!0,mVc:h}:{returnValue:!1,mVc:-1}}JVl(b){let h=b.characterData.lastIndexOf(this.Syg);return-1!==h&&h+this.yzj===ie.ParagraphReader.textLength(b)?{returnValue:!0,mVc:h}:{returnValue:!1,mVc:-1}}BWl(b){return Md.a(b,9)?!0:!1}}Object(n.a)(qx,"PageNumbersReader",null,[402]);class jy{constructor(b,h,r,z,R,ba=null,ta=null){this.sqn=(Wa,ub,Ib,$b)=>{Wa=Nt(this.Xc,this.Nl,
Wa);this.Nl.EFb(Wa,ub);ub=xi.a.Xp(Wa);for(Wa=!1;ub.moveNext();){const fc=ub.currentNode;if(ie.ParagraphReader.nc(ub.currentNode)&&Md.a(ub.currentNode,9)){Wa=!0;let Kc;const ed=({gPd:Kc}=Ib(fc,Kc)).returnValue;let Jd=ed;Jd=this.Xon(fc,Jd);Jd=this.Mqn(fc,Jd);-1<ed&&(Jd===ed&&Kc||$b(fc,Jd))}}Wa&&this.Hd.zs(12)};this.Xc=b;this.Nl=h;this.UBe=r;this.Hd=z;this.vuc=R;this.roc=ba||mt.a.I3e;this.fSj=ta||this.sqn;this.Rhd=WordEditorIntl.WordEditorStrings.L_PageNumbersPreviewTextForIncludeCount;this.vFg=String.format(this.Rhd,
"#","$");this.tHj=this.vFg.indexOf("#");this.sHj=this.vFg.indexOf("$");this.jqe=String.format(this.Rhd,"\ufffc","\ufffc");this.oFg=this.jqe.length}PXc(b,h,r){var z=Nt(this.Xc,this.Nl,b).Cn;z=this.Nl.zla(z);z=this.roc(z);for(let R of z)this.fSj(b,R,h,r)}EOi(b){if(this.UBe.BWl(b)){let h=-1;if(({mVc:h}=this.UBe.JVl(b)).returnValue&&this.Clh(b,h)||({mVc:h}=this.UBe.WWl(b)).returnValue&&this.ltk(b,h))return!0}return!1}Mqn(b,h){var r=b.qa.length;for(let R=0;R<r;R++){var z=b.qa.J(R);z.blob&&9===z.blob.si&&
(z=z.cp,r=Qe.a.createTextRange(b,z,z+1),this.vuc(r,""),r=b.qa.length,R--,h=this.yah(h,z,1))}return h}Xon(b,h){let r=b.characterData.indexOf(this.jqe);for(;-1!==r;)this.Clh(b,r)&&(h=this.yah(h,r,this.oFg)),r=b.characterData.indexOf(this.jqe);return h}ltk(b,h){const r=b.qa.ji(h);return r&&r.blob&&9===r.blob.si?(b=Qe.a.createTextRange(b,h,h+1),this.vuc(b,""),!0):!1}Clh(b,h){const r=b.qa.ji(h+this.tHj),z=b.qa.ji(h+this.sHj);return r&&r.blob&&9===r.blob.si&&z&&z.blob&&9===z.blob.si?(b=Qe.a.createTextRange(b,
h,h+this.oFg),this.vuc(b,""),!0):!1}yah(b,h,r){-1<b&&b>h&&(h=b-h,b=h>r?b-r:b-h);return b}}Object(n.a)(jy,"PageNumbersRemover",null,[400]);class Fp{constructor(b,h){this.pnb=this.onb=null;this.Xq=b;this.Hb=h}Gak(){this.Xq.style.display="";this.onb||(this.pnb&&(this.Hb.We(this.pnb),this.pnb=null),this.onb=new Ic.a(0,1,10,()=>{this.Xq.classList.add("Displayed");this.onb=null}),this.Hb.$b(this.onb))}Iak(){this.Xq.classList.remove("Displayed");this.pnb||(this.onb&&(this.Hb.We(this.onb),this.onb=null),
this.pnb=new Ic.a(0,1,200,()=>{this.Xq.style.display="none";this.pnb=null}),this.Hb.$b(this.pnb))}}Object(n.a)(Fp,"PaneControlAnimationHelper",null,[434]);class Ty{constructor(b){this.Hb=b}CCl(b){return new Fp(b,this.Hb)}}Object(n.a)(Ty,"PaneControlAnimationHelperFactory",null,[399]);class Qz{constructor(b,h,r,z,R,ba,ta,Wa,ub=!1){this.Qtg=this.nja=this.Dbd=null;this.wXl=()=>{this.jw.sendNotification(this.Qtg+" "+WordEditorIntl.WordEditorStrings.l_EditingSurfaceAccessibilityDescribedByText,!0)};this.ga=
b;this.n4=h;this.n4.bind(this);this.oue=r;this.Qia=R;this.vKe=ta;this.Wb=Wa;this.ddd=ub;this.fca=ba.value.create(r,z);this.n4.lik(this.fca);this.wY=rc.KeyInputManager.lc(wb.a.X_,0)}get jw(){return null!=this.ygg?this.ygg:this.ygg=Sa.a.instance.resolve("Common.Utils.IAriaNotifier")}o_(b){this.n4.o_(b);this.nja&&!b&&this.nja.mXk()}dea(b){this.Dbd!==b&&(this.Tbb(),this.Dbd=b)}AXi(b){if(this.Dbd){var h=this.Qia.Idb(this.Dbd,mt.a.$tl(b,this.oue));this.ddd?(this.Qtg=this.ALh(b,this.oue),this.fca.BJb(vf.a.msd)):
this.dgo(b);h&&this.lSe(h)}}Aeh(b){this.ddd&&this.Wb&&(b=this.Wb.re(b))&&b.dda(this.wXl)}ALh(b,h){let r="";switch(b){case 1:r=3!==this.ga.mode?h?WordEditorIntl.WordEditorStrings.l_DefaultHeaderScreenReaderMessageForReadOnly:WordEditorIntl.WordEditorStrings.l_DefaultFooterScreenReaderMessageForReadOnly:h?WordEditorIntl.WordEditorStrings.l_DefaultHeaderScreenReaderMessage:WordEditorIntl.WordEditorStrings.l_DefaultFooterScreenReaderMessage;break;case 2:r=3!==this.ga.mode?h?WordEditorIntl.WordEditorStrings.l_FirstPageHeaderScreenReaderMessageForReadOnly:
WordEditorIntl.WordEditorStrings.l_FirstPageFooterScreenReaderMessageForReadOnly:h?WordEditorIntl.WordEditorStrings.l_FirstPageHeaderScreenReaderMessage:WordEditorIntl.WordEditorStrings.l_FirstPageFooterScreenReaderMessage;break;case 3:r=3!==this.ga.mode?h?WordEditorIntl.WordEditorStrings.l_EvenPagesHeaderScreenReaderMessageForReadOnly:WordEditorIntl.WordEditorStrings.l_EvenPagesFooterScreenReaderMessageForReadOnly:h?WordEditorIntl.WordEditorStrings.l_EvenPagesHeaderScreenReaderMessage:WordEditorIntl.WordEditorStrings.l_EvenPagesFooterScreenReaderMessage;
break;case 4:r=3!==this.ga.mode?h?WordEditorIntl.WordEditorStrings.l_OddPagesHeaderScreenReaderMessageForReadOnly:WordEditorIntl.WordEditorStrings.l_OddPagesFooterScreenReaderMessageForReadOnly:h?WordEditorIntl.WordEditorStrings.l_OddPagesHeaderScreenReaderMessage:WordEditorIntl.WordEditorStrings.l_OddPagesFooterScreenReaderMessage}return r}dgo(b){this.fca.MYi(this.ALh(b,this.oue),vf.a.msd)}setInitialSelection(){this.fca.F_c()}lSe(b){this.Tbb();this.fca.rB(b,b.Qi)}Tbb(){this.fca.detach()}nOk(){this.nja=
this.vKe.value.create(this.n4.Bgc);this.pRn(this.nja)}pRn(b){if(this.Wb){const h=this.Wb.re(Ns.a.lZa);h.parent=ke.AFrame.Np;h.eda(()=>{b.setFocus();this.FPn()});h.bindAction(this.wY,Oa.a.KS)}}FPn(){if(this.Wb){var b=this.Wb.re(Ns.a.lZa);const h=new xe.DOMFocusListing(()=>this.n4.Bgc);h.PDa=!0;h.Go(1);this.Wb.AUe(this.n4.Bgc,b,h);b=this.Wb.getRegion(Ns.a.lZa);b.JOa();b.mX=!0;h.lea&&h.oy(h.lea)}}dispose(){void 0!==this.nja&&null!==this.nja&&(this.Wb.re(Ns.a.lZa).Dr(this.wY),this.nja.dispose())}Mjn(){void 0!==
this.nja&&null!==this.nja&&this.nja.refresh()}}Object(n.a)(Qz,"PaneControl",null,[433]);class OA{constructor(b,h,r,z){this.Nl=b;this.jGj=h;this.vKe=r;this.Wb=z}create(b,h,r,z){return new Qz(b,h,r,z,this.Nl,this.jGj,this.vKe,this.Wb,t.AFrameworkApplication.K.$("AccessibilityNotificationEnabledViaAriaLiveRegion"))}}Object(n.a)(OA,"Factory",null,[398]);var iC=d(1072);class ov extends Bp.a{constructor(b,h,r,z,R,ba,ta,Wa,ub){super();this.init(b);this.ml("ShowCalloutForPageNumberOperation");this.Muj=Wa;
this.lfb(this.Muj,h,z,R,ba);this.pz=0;this.btc=ba;this.fIa=ta;this.Eh=ub;1===this.behavior&&(this.ar=32,this.Una())}run(){var b=this.Eh.jb.wv;!this.pz&&this.btc.UKd(b)&&this.btc.HYa(b).element&&(this.pz=1);if(1===this.pz){const h=this.btc.HYa(b);b=new iC.a(h.element,b);this.fIa.showCallout(b);this.pz=2}2===this.pz&&(this.ar=32,this.Una())}}Object(n.a)(ov,"ShowCalloutForPageNumberOperation",Bp.a,[]);class PA{constructor(b,h,r){this.fIa=b;this.ga=h;this.wNb=r}create(b,h,r,z,R,ba){return new ov(b,h,
r,z,R,ba,this.fIa,this.ga,this.wNb)}}Object(n.a)(PA,"Factory",null,[397]);class Ew{get rK(){return null!=this.nog?this.nog:this.nog=Sa.a.instance.resolve("Box4.IOutlineEditor")}yc(b){b.ha("WordEditor.HeaderFooter.HeaderFooterManager",()=>new ey(b.resolve("WordEditor.HeaderFooter.HeaderFooterControlOwner"),b.resolve("WordEditor.HeaderFooter.HeaderFooterActor"),b.resolve("WordEditor.HeaderFooter.HeaderFooterControlLauncher"),b.ef("WordEditor.HeaderFooter.IPageNumbersActorFactory"),b.resolve("WordEditor.IHeaderFooterViewElementFactory"),
b.resolve("WordEditor.HeaderFooter.IPageNumbersCalloutControlManager"),b.resolve("Box4.IFeatureHelper"))).singleInstance();b.ha("WordEditor.HeaderFooter.HeaderFooterView.Factory",()=>new NA(b.resolve("WordEditor.HeaderFooter.HeaderFooterControlLauncher"),Ky.a.MYe,()=>b.resolve("WordEditor.SectionAlignedViewRepositioner"),vb.App.xa.jb,Ya.InteractiveViewManager.instance,()=>b.resolve("Box4.IUndoManager"),t.AFrameworkApplication.ya,b.resolve("Box4.IInteractiveEventNotifier"),b.Za("Box4.ITextMetricsAdapter"),
b.resolve("Box4.IRotatingCoordinateConverter"),b.Za("Common.IZoomManager"),b.Pa("Box4.IContentControlViewElementManager"),b.Pa("Box4.CpConversionManagerImpl"),b.Pa("Box4.ContentControlConfigSettings"),b.Pa("Box4.IContentControlReader"),b.Pa("Box4.IContentControlBoundaryNavigator"))).as("WordEditor.HeaderFooter.IHeaderFooterViewFactory").singleInstance();b.ha("WordEditor.HeaderFooter.HeaderFooterViewElement.Factory",()=>new Qy(b.resolve("Box4.SectionAlignedViewPositionProvider"),b.Za("Box4.ContentControl.Acetate.IContentControlAcetateDomManager"),
b.resolve("WordEditor.PageBackground.PageBackgroundColorHandler"),!!vb.App.instance&&vb.App.instance.JA)).as("WordEditor.IHeaderFooterViewElementFactory").singleInstance();b.ha("WordEditor.HeaderFooter.HeaderFooterToolbar.Factory",()=>new Py(ja.App.fm,b.Za("Box4.IGeneralCuiUser"),b.resolve("Box4.IFeatureHelper"),ja.App.fm,t.AFrameworkApplication.ya)).as("WordEditor.HeaderFooter.IHeaderFooterToolbarFactory").singleInstance();b.ha("WordEditor.HeaderFooter.PaneControl.Factory",()=>new OA(b.resolve("WordEditor.HeaderFooter.HeaderFooterReader"),
b.ef("WordEditor.HeaderFooter.IHeaderFooterViewFactory"),b.ef("WordEditor.HeaderFooter.IHeaderFooterToolbarFactory"),ve.FocusManager.instance())).as("WordEditor.HeaderFooter.IPaneControlFactory").singleInstance();b.ha("WordEditor.HeaderFooter.HeaderFooterControl.Factory",()=>new vB(()=>{vb.App.xa.updateCommandUI()},b.resolve("WordEditor.HeaderFooter.HeaderFooterReader"),b.resolve("WordEditor.HeaderFooter.HeaderFooterInserter"),t.AFrameworkApplication.ya,b.resolve("Box4.ContentEditableViewEventSource"))).as("WordEditor.HeaderFooter.IHeaderFooterControlFactory").singleInstance();
b.ha("WordEditor.HeaderFooter.PageNumbersActor.Factory",()=>new Nz(t.AFrameworkApplication.ya,Oe.a.instance,b.resolve("WordEditor.HeaderFooter.PageNumbersControl"),b.resolve("WordEditor.HeaderFooter.PageNumbersPositionPreviewGenerator"),b.resolve("WordEditor.HeaderFooter.PageNumbersInserter"),b.resolve("WordEditor.HeaderFooter.PageNumbersRemover"),b.resolve("WordEditor.HeaderFooter.IPageNumbersCalloutControlManager"),b.resolve("WordEditor.HeaderFooter.IShowCalloutForPageNumberOperationFactory"),b.resolve("WordEditor.HeaderFooter.HeaderFooterReader"),
b.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,Tr.xCl,Object(u.a)(vb.App.xa,vb.App.xa.Q3c,"updateRibbonControl"),Object(u.a)(vb.App.xa,vb.App.xa.hG,"updateRibbonControls"))).as("WordEditor.HeaderFooter.IPageNumbersActorFactory").singleInstance();b.ha("WordEditor.HeaderFooter.HeaderFooterControlLauncher",()=>new nt).singleInstance();b.ha("WordEditor.HeaderFooter.IPaneControlAnimationHelperFactory",()=>new Ty(Oe.a.instance)).singleInstance();b.ha("WordEditor.HeaderFooter.HeaderFooterControlOwner",
()=>new rp(ve.FocusManager.instance(),vb.App.xa.jv,b.ef("WordEditor.HeaderFooter.IPaneControlFactory"),b.ef("WordEditor.HeaderFooter.IHeaderFooterControlFactory"),b.ef("WordEditor.HeaderFooter.IPaneControlAnimationHelperFactory"),t.AFrameworkApplication.ya,new De.a(()=>vb.App.xa.jb.Ic),t.AFrameworkApplication.K,b.resolve("Box4.IPasteFloatieEventSource"),b.resolve("Box4.IExternalContentFloatieEventSource"))).as("WordEditor.HeaderFooter.IHeaderFooterControlOwnerEvent").singleInstance();b.ha("WordEditor.HeaderFooter.HeaderFooterEditor",
()=>new DA(b.resolve("WordEditor.HeaderFooter.HeaderFooterReader"),ne.PageReader.instance,new sn.a,km.a.instance)).singleInstance();b.ha("WordEditor.HeaderFooter.HeaderFooterToolbarGenerator",()=>new IA(new sn.a,km.a.instance));b.ha("WordEditor.HeaderFooter.HeaderFooterActor",()=>new Tv(t.AFrameworkApplication.ya,b.resolve("WordEditor.HeaderFooter.HeaderFooterReader"),b.resolve("WordEditor.HeaderFooter.HeaderFooterEditor"),b.resolve("WordEditor.HeaderFooter.HeaderFooterInserter"),km.a.instance,new sn.a,
new $m.a,b.resolve("WordEditor.HeaderFooter.HeaderFooterToolbarGenerator"),Tv.g1h,b.resolve("WordEditor.HeaderFooter.DeleteHeaderFooterDialogFactory"))).singleInstance();b.ha("WordEditor.HeaderFooter.HeaderFooterDefaultTableInserter",()=>new kq(Jl.a.instance,kq.kLl(b.resolve("Box4.ITableEditor")),kq.Mkl(),t.AFrameworkApplication.isRtl,ag.OutlineElementNavigator.Zd,kq.nJl(),kq.Otl(),b.resolve("Box4.IOutlineElementEditor")));b.ha("WordEditor.HeaderFooter.HeaderFooterDefaultContentInserter",()=>new wB(b.resolve("WordEditor.HeaderFooter.HeaderFooterReader"),
new sn.a,h=>this.rK.qfb(h),t.AFrameworkApplication.isRtl,Object(u.a)(b.resolve("Box4.IOutlineElementEditor"),b.resolve("Box4.IOutlineElementEditor").OJb,"setRtlSimple"),b.resolve("WordEditor.HeaderFooter.HeaderFooterDefaultTableInserter")));b.ha("WordEditor.HeaderFooter.HeaderFooterNodeLevelInserter",()=>new FA(km.a.instance,b.resolve("WordEditor.HeaderFooter.HeaderFooterReader"),b.resolve("WordEditor.HeaderFooterNodeFactory"),b.resolve("WordEditor.HeaderFooter.HeaderFooterDefaultContentInserter"))).singleInstance();
b.ha("WordEditor.HeaderFooter.DeleteHeaderFooterDialogFactory",()=>new lx(b.resolve("WordEditor.HeaderFooter.HeaderFooterReader"),new sn.a,new $m.a,b.resolve("WordEditor.HeaderFooter.HeaderFooterEditor"),t.AFrameworkApplication.ya)).singleInstance();b.ha("WordEditor.HeaderFooter.HeaderFooterInserter",()=>new nv(b.resolve("WordEditor.HeaderFooter.HeaderFooterNodeLevelInserter"),b.resolve("WordEditor.HeaderFooter.HeaderFooterReader"),km.a.instance,new sn.a,t.AFrameworkApplication.ya)).singleInstance();
b.ha("WordEditor.HeaderFooter.PageNumbersControl",()=>new Tr(Object(u.a)(vb.App.xa,vb.App.xa.Q3c,"updateRibbonControl"),Object(u.a)(vb.App.xa,vb.App.xa.hG,"updateRibbonControls"),t.AFrameworkApplication.isRtl)).singleInstance();b.register(Ju,"WordEditor.HeaderFooter.PageNumbersPositionPreviewGenerator").singleInstance();b.ha("WordEditor.HeaderFooter.PageNumbersNodeLevelInserter",()=>new Mh(new $m.a,b.resolve("Box4.IFeatureHelper"))).singleInstance();b.ha("WordEditor.HeaderFooter.PageNumbersInserter",
()=>new pr(new sn.a,b.resolve("WordEditor.HeaderFooter.PageNumbersNodeLevelInserter"),b.resolve("WordEditor.HeaderFooter.PageNumbersRemover"),b.resolve("WordEditor.HeaderFooter.HeaderFooterReader"))).singleInstance();b.ha("WordEditor.HeaderFooter.PageNumbersReader",()=>new qx).singleInstance();b.ha("WordEditor.HeaderFooter.PageNumbersRemover",()=>new jy(new sn.a,b.resolve("WordEditor.HeaderFooter.HeaderFooterReader"),b.resolve("WordEditor.HeaderFooter.PageNumbersReader"),b.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,
Object(u.a)(Ew.characterPropertiesEditor,Ew.characterPropertiesEditor.replaceTextRange,"replaceTextRange"))).singleInstance();b.ha("WordEditor.HeaderFooter.PageNumbersCalloutControlManager",()=>new iy(b.ef("WordEditor.HeaderFooter.IPageNumbersCallOutControlFactory"),vb.App.xa)).as("WordEditor.HeaderFooter.IPageNumbersCalloutControlManager").singleInstance();b.ha("WordEditor.HeaderFooter.PageNumbersCallOutControl.Factory",()=>new hy(Oe.a.instance,di.a.instance,b.resolve("Common.Utils.IAriaNotifier"))).as("WordEditor.HeaderFooter.IPageNumbersCallOutControlFactory").singleInstance();
b.ha("WordEditor.HeaderFooter.ShowCalloutForPageNumberOperation.Factory",()=>new PA(b.resolve("WordEditor.HeaderFooter.IPageNumbersCalloutControlManager"),t.AFrameworkApplication.ya,vb.App.xa)).as("WordEditor.HeaderFooter.IShowCalloutForPageNumberOperationFactory").singleInstance();b.ha("WordEditor.HeaderFooter.ClientPaginationPageAdornmentContentManager",()=>new BA(b.resolve("WordEditor.HeaderFooter.HeaderFooterReader"),t.AFrameworkApplication.ya)).as("WordEditor.HeaderFooter.IClientPaginationPageAdornmentContentManager").singleInstance();
b.ha("WordEditor.HeaderFooter.ClientPaginationHeaderFooterBridge",()=>new ju(b.resolve("WordEditor.HeaderFooter.IHeaderFooterControlOwnerEvent"),b.resolve("WordEditor.HeaderFooter.IClientPaginationPageAdornmentContentManager"))).as("WordEditor.IClientPaginationHeaderFooterBridge").singleInstance()}static get characterPropertiesEditor(){return null!=Ew.chg?Ew.chg:Ew.chg=Sa.a.instance.resolve("Box4.ICharacterPropertiesEditor")}}Object(n.a)(Ew,"HeaderFooterComponentConfiguration",null,[2]);class Rz{constructor(){this.Fbd=
this.W=null}get name(){return"WordEditor.HeaderFooter"}yc(b){this.W=b;(new Ew).yc(b)}init(){this.W.resolve("Box4.IFeatureHelper").Yk.continueWith(()=>{this.Tm()})}Tm(){this.W.resolve("Box4.IFeatureHelper").isFeatureEnabled(118)&&(this.Fbd=this.W.resolve("WordEditor.HeaderFooter.HeaderFooterManager"),this.Fbd.start(),this.W.resolve("WordEditor.IClientPaginationHeaderFooterBridge"))}dispose(){this.Fbd&&this.Fbd.dispose()}static main(){O.a.instance.Oc(new Rz)}}Object(n.a)(Rz,"PackageManager",null,[1,
2]);var xB=d(385),rx=d(805);class Uy{constructor(b,h){this.Bf=b;this.qm=h}create(){return new rx.a(this.Bf.instance,this.qm.instance)}}Object(n.a)(Uy,"ContentControlNodeFactory",null,[256]);var UC=d(1641),jC=d(1021);class Ot{create(){return new jC.a}}Object(n.a)(Ot,"ContentControlContainerNodeFactory",null,[256]);class sx{constructor(b,h,r,z,R){this.Tra=b;this.Xqh=h;this.Awd=r;this.MI=z;this.Nj=R;this.$Dk=new Ot;this.mPm=(ba,ta)=>{this.MI.Pd(()=>{if(ta){ta.xo.selectedContentControls||(ta.xo.selectedContentControls=
{});var Wa=ta.xo.selectedContentControls,ub=ta.oPa;if(ub&&ub.length){var Ib=ub[0];ub=ub[ub.length-1];Ib=this.Tra.Gcf(Qe.a.Uc(Ib.node,Ib.hl),Qe.a.Uc(ub.node,ub.ut),!1);for(let $b of Ib)Wa[$b.contentControlNode.id.toString()]=!0}}},"CC:OnBeforeCopy")};this.LTc=(ba,ta)=>{this.MI.Pd(()=>{if(ta){var Wa=ta.clone,ub=ta.original;try{const Ib=ta.xo.selectedContentControls,$b=this.Tra.Qbf(ub,0,ub.characterData.length,!0,!0,!1);for(let fc of $b){const Kc=fc.pe.toString();Ib[Kc]?fc.Aq&&!this.kGk(fc.contentControlNode,
Wa,Ib)&&(v.ULS.sendTraceTag(521172763,368,10,String.format("Cannot clone ContentControlNode id:{0} under the clipboard tree",Kc)),this.SRf(Wa,fc.pe)):this.SRf(Wa,fc.pe)}}catch(Ib){v.ULS.sendTraceTag(521171974,307,10,"onParagraphCopy operation failed: {0}",Ib.toString()),this.Xqh.won(Wa)}}},"CC:onParagraphCopy")};this.NTc=(ba,ta)=>{this.MI.Pd(()=>{if(ta){var Wa=ta.clone,ub=ta.original;try{const Ib=this.Tra.Qbf(Wa,0,ub.characterData.length);ta.xo.ccObjectIdMapping||(ta.xo.ccObjectIdMapping={});const $b=
ta.xo.ccObjectIdMapping;for(let fc=0;fc<Ib.count;fc++){const Kc=Ib.J(fc),ed=Kc.pe.toString();if(this.$im(Kc))if(Kc.Pc){const Jd=ub.Di().zd.Eb(ed),ge=this.QDl(Kc),qe=this.Pxk(Jd,ge.uDi,ge.D8h,Wa.Di().zd);$b[ed]=qe.id;this.Awd.ugj($b[ed],Wa.id,E.a.nil);this.Nj.n9b(qe)}else this.Awd.ugj($b[ed],null,Wa.id);$b[ed]?(Kc.pe=$b[ed],Kc.Vs=null):this.SRf(Wa,Kc.pe)}}catch(Ib){v.ULS.sendTraceTag(520414297,307,10,"onParagraphPaste operation failed: {0}",Ib.toString())}}},"CC:onParagraphPaste")}}init(){dt.a.z6j(this.mPm);
dt.a.jrd(this.LTc);dt.a.pyc(this.NTc)}Gll(b){if(!b.Bb(25)||!b.kd(25))return null;if(!b.aq(25)){const h=this.$Dk.create(1074135144);b.Sf(h,25)}return b.Rb(25)}kGk(b,h,r){var z=b.ia(yc.a.I5,null);const R=Nd.GraphIterator.$a(h);h=h.Di().zd;r=z&&r[z.toString()]?h.Eb(z):this.Gll(R);if(!r)return v.ULS.sendTraceTag(521172765,368,10,String.format("Cannot get parent node of the cloned content control node id:{0}",b.id.toString())),null;z=Pi.a(b,h,!0);Nd.GraphIterator.$a(r).j1(z,26,b.id);54!==r.type&&z.setValue(yc.a.I5,
r.id);return z}SRf(b,h){this.Xqh.DSk(new Ua.a([b]),h)}$im(b){var h=b.Ob.paragraph.Lc;if(!h)return v.ULS.sendTraceTag(520152150,368,10,String.format("Cannot get containing object space of the cloned content control node id:{0}",b.pe.toString())),!1;h=h.Eb(b.Vs);if(!h)return v.ULS.sendTraceTag(520152149,368,10,String.format("Cannot get property set of the cloned content control node id:{0}",b.pe.toString())),!1;b=h.getValue(yc.a.Eq);return 38===b||39==b}ikl(b,h){var r,z=b.qa.J(b.qa.length-1);let R=
b.characterData.length;z=(null===(r=null===z||void 0===z?void 0:z.Mb)||void 0===r?void 0:r.length)||0;b.id.equals(h.Ob.paragraph.id)&&(R=h.Ob.cp,z=h.Ob.Mb.rI(h.pe,h.Pc));return this.Tra.bNh(b,0,R,0,z)}QDl(b){let h=null,r=b.Ob.paragraph;const z={};for(;r;){const R=this.ikl(r,b);for(let ba=R.count-1;0<=ba;ba--){const ta=R.J(ba);if(!ta.Aq)continue;const Wa=ta.pe.toString();if(ta.Pc){if(!z[Wa])return{uDi:ta.contentControlNode,D8h:h}}else z[Wa]=!0,h||(h=ta.contentControlNode)}r=ie.ParagraphReader.Vg(r,
!0,!0)}return{uDi:null,D8h:h}}Pxk(b,h,r,z){let R;h?R=this.Awd.Tsa(h):(R=this.Awd.Usa(),h=R.currentNode);b=Pi.a(b,z,!0);b.lh(yc.a.Gy,ac.a.RF());54!==h.type&&b.setValue(yc.a.I5,h.id);R.cH(b,r,26);return b}}Object(n.a)(sx,"ContentControlCCP",null,[]);var pv=d(190),QA=d(717);class Sz{constructor(b,h,r,z){this.Vd=b;this.Bf=h;this.fb=r;this.sg=z}get WW(){return!!this.Bf.instance&&this.Bf.instance.WW}get OCb(){return!!this.Bf.instance&&this.Bf.instance.OCb}lra(b,h,r,z,R,ba=pv.a.$xb,ta=pv.a.N_b,Wa=null,ub=
pv.a.C2e,Ib=-1){(b=this.aHd(b,r))?(b.Mb||(b.Mb=new xB.a(b)),this.W1j(h,b.Mb,z,R,ba,ta,Wa,ub,Ib)):v.ULS.sendTraceTag(17585366,368,15,"Unable to get a ChP at expected cp, which should not happen")}lyh(b,h,r){if(b){new Ua.a;for(let R=0;R<b.count;R++){var z=this.Bcf(b.J(R),h,!1);for(let ba of z)this.Zon(ba,r)}}}CSk(b,h){this.lyh(b,h,!0)}DSk(b,h){this.lyh(b,h,!1)}replaceTextRange(b,h){this.Vd.replaceTextRange(b,h)}aHd(b,h){var r=Qe.a.Uc(b,h);this.Vd.IKb(r);for(r=0;r<b.qa.length;r++){const z=b.qa.J(r);
if(z.cp>h)break;if(z.cp===h)return z}return null}W1j(b,h,r,z,R=pv.a.$xb,ba=pv.a.N_b,ta=null,Wa=pv.a.C2e,ub=-1){const Ib=h.Ob.paragraph;b=new QA.a(h.Ob,!0,!0,!0,null,b,z,r,R,ba,ta,Wa,null,this.sg);if(!this.WW||-1>=ub||ub>h.length)ub=h.length;h.insert(b,ub);Ib.wn();xg.a.instance.J(6)&&(b.Ee?Ib.wordRunProperties.DZ(b.Ee-1,512):Ib.wordRunProperties.wta(b.Ee,512),Ib.wordRunProperties.Hq.Z(b.Ee,Eu.CharacterPropertiesEditor.CQ),Ib.wordRunProperties.gt.Z(b.Ee,Eu.CharacterPropertiesEditor.aU))}Bcf(b,h,r){const z=
new Ua.a;for(let R=0;R<b.qa.length;R++){const ba=b.qa.J(R);if(ba.Mb)for(let ta=0;ta<ba.Mb.length;ta++)if(ba.Mb.J(ta).pe.equals(h)&&(z.add(ba.Mb.J(ta)),r))return z}return z}v3c(b,h,r){if(this.OCb&&b){var z=b.node,R=b.hl,ba=b.ut,ta=this.COh(z,R,h,!0);h=this.COh(z,ba,h,!1);r?-1!==ta&&ta++:-1!==h&&h++;R||-1===ta||(ta=Math.max(ta,this.fb.Yu(z)));ba===this.fb.textLength(z)&&-1!==h&&(h=Math.min(h,this.fb.Bu(z)));b.Fb=ta;b.Ub=h}}COh(b,h,r,z){return(b=(b=b.qa.ji(h))?b.Mb:null)&&b.length?b.rI(r,z):-1}Zon(b,
h){b&&b.Ob.Mb&&(h?b.Ob.Mb.remove(b):b.Ob.Mb.Dna(b),h=b.Ob.paragraph,0<=b.Ee&&b.Ee<h.wordRunProperties.length&&(b.Ob.cp||1!==h.wordRunProperties.length||(h.wordRunProperties.DZ(0,512),h.wordRunProperties.Hq.Z(1,Eu.CharacterPropertiesEditor.CQ),h.wordRunProperties.gt.Z(1,Eu.CharacterPropertiesEditor.aU)),h.wordRunProperties.removeAt(b.Ee,512)),h.wn())}won(b){const h=b.qa;if(h){var r=new Ua.a;for(let z=0;z<h.length;z++){const R=h.J(z);if(R&&R.Mb){for(let ba=0;ba<R.Mb.length;ba++)r.add(R.Mb.J(ba).Ee);
R.Mb=null}}b.sga(!0,r)}}}Object(n.a)(Sz,"ContentControlChpManager",null,[374]);class yB{constructor(b,h,r,z,R){this.fb=b;this.Co=h;this.sh=r;this.Ac=z;this.sg=R}Cbf(b){if(!b||!Xd.SelectionEditor.xf(b))return null;if(!b.cpBegin){const h=this.JMh(b.node,b.Fb,!0);if(h)return h}return b.cpBegin===this.fb.textLength(b.node)?this.JMh(b.node,b.Fb-1,!1):null}pjl(b,h){b=this.cuh(b,h);return this.Cbf(b)}JMh(b,h,r){return b.qa&&b.qa.length?(b=r?b.qa.first.Mb:b.qa.last.Mb)&&0<=h&&h<b.length&&b.J(h).Vf&&b.J(h).Pc===
r&&this.Gpf(b.J(h))?b.J(h):null:null}Tef(b){if(!b||!Xd.SelectionEditor.du(b))return null;var h=this.Co.UEd(b,b);b=0<h.count?h.J(h.count-1):null;return b&&!b.Vf&&this.Gpf(b)?(h=1<h.count?h.J(h.count-2):null)&&!h.Vf&&this.Gpf(h)?null:b:null}Gpf(b){if(!b)return!1;var h=this.ZVh(b);if(!h)return!1;if(b.Pc)var r=b;else r=h,h=b;var z=this.fb.textLength(b.Ob.paragraph);if(r.Ob.cp||h.Ob.cp!==z||!r.Aq||r.Yta||!h.Aq||h.Yta)return!1;r=r.Ob.Mb;h=h.Ob.Mb;for(z=0;z<r.length&&!r.J(z).pe.equals(b.pe);z++)if(!r.J(z).Pc)return!1;
for(r=h.length-1;0<=r&&!h.J(r).pe.equals(b.pe);r--)if(h.J(r).Pc)return!1;return!0}e3c(b){b=this.Cbf(b);this.Jwd(b,!1)}vej(b,h){b=this.cuh(b,h);this.e3c(b)}bFa(b){b=this.Tef(b);return this.Jwd(b,!0)?b:null}a$l(b,h){b=this.Cbf(b);return!!b&&b.pe.equals(h)}T5b(b,h,r){b=this.pjl(b,h);return!!b&&b.pe.equals(r)}orf(b,h){b=this.Tef(b);return!!b&&b.pe.equals(h)}Jwd(b,h){if(!b)return!1;const r=this.ZVh(b);return this.zrh(b,h)&&(!r||this.zrh(r,h))}zrh(b,h){if(!b||b.Vf===h)return!1;var r=this.Co.Ybe(b.Ob.paragraph,
b.Pc);const z=b.Ob.Mb;-1!==r||b.Pc||(r=z.length);const R=h===b.Pc?1:-1;r+=h?R:0;b=z.rI(b.pe,b.Pc)+R;if(r===b||0<R!==b>r)return v.ULS.shipAssertTag(24933847,368,r!==b,"Stopping content control inline block conversion since we can't find a correct range to convert. begin: {0}, end: {1}, step: {2}",r,b,R),v.ULS.shipAssertTag(24933848,368,0<R===b>r,"Stopping content control inline block conversion or we'll trap in infinite loop. begin: {0}, end: {1}, step: {2}",r,b,R),!1;for(var ba=r;ba!==b;ba+=R){var ta=
z.J(ba);z.Dna(ta);ta.Vf=h;z.W6l(ta,ba);this.vjo(z.J(ba))}if(this.M$)for(z.Ob.paragraph.wn(),ba=r;ba!==b;ba+=R)ta=z.J(ba),ta.paragraph.wordRunProperties.Hq.Z(ta.Ee,Eu.CharacterPropertiesEditor.CQ),ta.paragraph.wordRunProperties.gt.Z(ta.Ee,Eu.CharacterPropertiesEditor.aU);h?this.Xlo(z,r,b,R):this.Ylo(z,r,b,R);v.ULS.sendTraceTag(24933849,368,50,"Converted {0} content control(s) to {1}",Math.abs(b-r),h?"block":"inline");return!0}vHd(b){var h,r;return b.Pc&&this.sg.ir.get(null===(h=b.contentControlNode.id)||
void 0===h?void 0:h.toString()).equals(b.Ob.paragraph.id)?38:!b.Pc&&this.sg.Bs.get(null===(r=b.contentControlNode.id)||void 0===r?void 0:r.toString()).equals(b.Ob.paragraph.id)?39:b.Vf&&b.Pc?40:b.Vf&&!b.Pc?41:!b.Vf&&b.Pc?38:39}vjo(b){const h=b.Ob.paragraph.Lc;if(h){var r=h.Eb(b.Vs),z=b.contentControlNode;if(Nr.a.jCa||r&&z){if(r){r=r.clone();r.setValue(yc.a.Stf,b.Vf);const R=this.vHd(b);r.setValue(yc.a.Eq,R);h.Ku(r,null);b.Vs=r.id}z&&z.setValue(yc.a.u6,b.Vf)}}}ZVh(b){if(b.Ob.cp&&b.Ob.cp!==this.fb.textLength(b.Ob.paragraph)||
!b.Ob.paragraph.qa||!b.Ob.paragraph.qa.length)return null;const h=b.Pc?b.Ob.paragraph.qa.last:b.Ob.paragraph.qa.first;if(!h.Mb)return null;b=h.Mb.rI(b.pe,!b.Pc);return-1===b?null:h.Mb.J(b)}Ylo(b,h,r,z){var R,ba,ta,Wa,ub=b.J(h).contentControlNode;if(ub){var Ib=b.J(h).Pc?this.sg.ir:this.sg.Bs;ub=null!==(ba=Ib.get(null===(R=ub.id)||void 0===R?void 0:R.toString()))&&void 0!==ba?ba:E.a.nil;if(!ub.equals(E.a.nil))if(b.Ob&&b.Ob.paragraph&&b.Ob.paragraph.id.equals(ub)){for(h+=z;h!==r;h+=z){R=b.J(h).contentControlNode;
if(!R)return;Ib.set(null===(ta=R.id)||void 0===ta?void 0:ta.toString(),ub)}0<=r&&r<b.length&&b.J(r).Vf&&this.I7b(b.J(r))&&(b=b.J(r).contentControlNode)&&Ib.set(null===(Wa=b.id)||void 0===Wa?void 0:Wa.toString(),ub)}else v.ULS.shipAssertTag(24933851,368,!1,"Start/End object of innermost content control is not the paragraph which holds the content control.")}}Xlo(b,h,r,z){var R;if(!Nr.a.d6b){var ba=null,ta=h-z;0<=ta&&ta<b.length&&b.J(ta).Vf&&this.I7b(b.J(ta))&&(ba=b.J(ta).contentControlNode);for(ta=
b.J(h).Pc;h!==r;h+=z){const Wa=b.J(h).contentControlNode;if(!Wa)break;ba&&(ta?this.sg.ir:this.sg.Bs).set(null===(R=ba.id)||void 0===R?void 0:R.toString(),Wa.id);ba=Wa}}}I7b(b){return b.Aq&&!b.Yta}cuh(b,h){if(!b||!this.sh)return null;const r=h?Qe.a.Uc(b,0):Qe.a.ow(b);b=this.sh.xq(b,h);r.Ub=r.Fb=b;return r}get M$(){return this.Ac.isFeatureEnabled(27)}}Object(n.a)(yB,"ContentControlConverter",null,[373]);var qv;(function(b){b[b.swo=0]="BoundingBox";b[b.Gzo=1]="Tags";b[b.Cxo=2]="Hidden";b[b.uyo=3]="NumberOfContentControlAppearance"})(qv||
(qv={}));Object(n.b)("ContentControlAppearance",qv);var Vy;(function(b){b[b.Unknown=-1]="Unknown";b[b.nzo=0]="RichText";b[b.Jyo=1]="PlainText";b[b.Hyo=2]="Picture";b[b.Bwo=3]="ComboBox";b[b.jxo=4]="DropDownList";b[b.two=5]="BuildingBlockGallery";b[b.Date=6]="Date";b[b.gzo=7]="RepeatSectionItem";b[b.ywo=8]="CheckBox";b[b.fzo=9]="RepeatSection";b[b.Bibliography=10]="Bibliography";b[b.Fzo=11]="TableOfContents";b[b.vyo=12]="NumberOfContentControlKinds"})(Vy||(Vy={}));Object(n.b)("ContentControlKind",
Vy);class tx{constructor(b,h,r,z,R,ba,ta,Wa,ub,Ib,$b){this.M6a=this.Xvc=this.C$c=this.Dmd=this.Vgd=null;this.Hha=this.Fl=this.ntc=this._id=0;this.IPb=this.yTb=this.ynd=this._title=this.Twa=null;this.Zdd=this.Ydd=this.EMg=this.Wjd=this.Gpc=this.Bpc=this.W9c=!1;this.VNg=null;this.Vf=!1;this.gle=null;this.Bi=r;this.yx=h;this.$g=z;this.rs=R;this.qm=ba;this.q0=ta;this.Kpa=Wa;this.Zca=ub;this.Eub=Ib;this.sg=$b;b?(this.Vgd=b.id,this.gle=b,this.$S(!1)):this._id=ac.a.RF()}get Ui(){return this.Bi.value}get id(){this.$S();
return this._id}set id(b){this._id=b;this.Rd()&&(this.contentControlNode.setValue(yc.a.Gy,this._id),this.S_())}get parentId(){this.$S();return this.ntc}set parentId(b){this.ntc=b}get title(){this.$S();return this._title}set title(b){this._title=b;this.Rd()&&(this.contentControlNode.setValue(yc.a.hbb,this._title),this.S_(),this.x3c(h=>{h.title=this._title?this._title:pv.a.$xb}))}get tag(){this.$S();return this.ynd}set tag(b){this.ynd=b;this.Rd()&&(this.contentControlNode.setValue(yc.a.$Bc,this.ynd),
this.S_())}get type(){this.$S();return this.Fl}set type(b){this.Fl=b;this.Rd()&&(this.contentControlNode.setValue(yc.a.$wb,Vy[this.Fl]),this.S_())}get appearance(){this.$S();return this.Hha}set appearance(b){if(b&&1!==b&&2!==b)throw Error.argumentUndefined("The appearance value is undefined enum.");this.Hha=b;this.Rd()&&(this.contentControlNode.setValue(yc.a.ibb,qv[this.Hha].toLowerCase()),this.S_(),this.x3c(h=>{h.appearance=qv[this.Hha].toLowerCase()}))}get color(){this.$S();return this.Twa}set color(b){if(b&&
16777215>=b)this.Twa=b,this.Rd()&&(this.contentControlNode.setValue(yc.a.XBc,this.Twa),this.S_(),this.x3c(h=>{h.color=this.Twa}));else throw Error.argumentOutOfRange("The color value is out of range.");}get J_d(){this.$S();return this.yTb}set J_d(b){this.yTb=b}get Tzd(){this.$S();return this.IPb}set Tzd(b){this.IPb=b;this.Rd()&&(this.contentControlNode.setValue(yc.a.JZb,this.IPb),this.S_())}get e5e(){this.$S();return this.W9c}set e5e(b){b&&(this.W9c=b,this.Rd()&&(this.contentControlNode.setValue(yc.a.ywd,
this.W9c),this.S_()))}get removeWhenEdited(){this.$S();return this.Wjd}set removeWhenEdited(b){if(b&&!this.afa)throw Error.invalidOperation("Cannot set RemoveWhenEdited to true property if the content control is undeletable.");this.Wjd=b;this.Rd()&&(this.contentControlNode.setValue(yc.a.Zqh,this.Wjd),this.S_())}get afa(){this.$S();return this.Bpc}set afa(b){if(!b&&this.removeWhenEdited)throw Error.invalidOperation("Cannot set IsDeletable property to false if the content control RemoveWhenEdited property is true.");
this.Bpc=b;this.Rd()&&(this.contentControlNode.setValue(yc.a.LZb,this.Bpc),this.x3c(h=>{h.IS=this.Bpc}),this.S_())}get isEditable(){this.$S();return this.Gpc}set isEditable(b){this.Gpc=b;this.Rd()&&(this.contentControlNode.setValue(yc.a.Zwb,this.Gpc),this.x3c(h=>{h.editable=this.Gpc}),this.S_())}get isSupported(){this.$S();return this.EMg}get djm(){return this.isSupported&&11!==this.type&&10!==this.type}get gmm(){this.$S();return this.IPb&&"table of contents"===this.IPb.toLowerCase()?!0:!1}get BPd(){this.$S();
return this.Ydd}set BPd(b){this.Ydd=b;this.Rd()&&(this.contentControlNode.setValue(yc.a.brh,this.Ydd),this.S_())}get b7b(){this.$S();return this.Zdd}set b7b(b){this.Zdd=b;this.Rd()&&(this.contentControlNode.setValue(yc.a.crh,this.Zdd),this.S_())}get cO(){return this.contentControlNode.ia(yc.a.J5,!1)}set cO(b){this.Rd()&&this.contentControlNode.setValue(yc.a.J5,b)}get mu(){this.$S();return this.Dmd}set mu(b){this.Dmd=b}get Iz(){this.$S();return this.C$c}set Iz(b){this.C$c=b}get objectId(){return this.Vgd}set objectId(b){this.Vgd=
b;this.gle=this.Ui.Eb(this.Vgd)}get start(){this.Jij();return this.Xvc}set start(b){this.Xvc=b}get end(){this.Jij();return this.M6a}set end(b){this.M6a=b}get contentControlNode(){return this.gle}x2m(b){for(let h=0;3>h;++h)if(qv[h].toLowerCase()===b)return h;return 0}y2m(b){for(let h=0;12>h;++h)if(Vy[h]===b)return h;return-1}S_(){const b=this.start.node;b&&b.setValue(We.a.UT,new Date)}M3c(){var b,h,r,z;this._id=this.contentControlNode.ia(yc.a.Gy,0);this.Hha=this.x2m(this.contentControlNode.ia(yc.a.ibb,
null));this.Twa=this.contentControlNode.ia(yc.a.XBc,null);this._title=this.contentControlNode.ia(yc.a.hbb,null);this.ynd=this.contentControlNode.ia(yc.a.$Bc,null);this.Vf=this.contentControlNode.ia(yc.a.u6,!1);this.Bpc=this.contentControlNode.ia(yc.a.LZb,!1);this.Gpc=this.contentControlNode.ia(yc.a.Zwb,!1);this.EMg=this.contentControlNode.ia(yc.a.Hda,!1);this.IPb=this.contentControlNode.ia(yc.a.JZb,null);this.W9c=this.contentControlNode.ia(yc.a.ywd,!1);this.Dmd=null!==(h=this.sg.ir.get(null===(b=
this.contentControlNode.id)||void 0===b?void 0:b.toString()))&&void 0!==h?h:E.a.nil;this.C$c=null!==(z=this.sg.Bs.get(null===(r=this.contentControlNode.id)||void 0===r?void 0:r.toString()))&&void 0!==z?z:E.a.nil;this.Zdd=this.contentControlNode.ia(yc.a.crh,!1);this.Ydd=this.contentControlNode.ia(yc.a.brh,!1);this.Wjd=this.contentControlNode.ia(yc.a.Zqh,!1);this.Fl=this.y2m(this.contentControlNode.ia(yc.a.$wb,"RichText"));b=null;try{const R=this.contentControlNode.ia(yc.a.I5,E.a.nil);if(E.a.Fp(R,E.a.nil))this.ntc=
0;else if(b=this.Ui.Eb(R))this.ntc=b.ia(yc.a.Gy,0)}catch(R){this.ntc=0}this.Vko()}Vko(){if(this.Eub){var b=this.contentControlNode.ia(yc.a.oZe,"");if((b=this.Kpa.W0h(b))&&0<b.length){this.yTb=this.SLh(b.Qa,b.Tc);return}}this.yTb=(b=this.$g.Usa())&&b.currentNode?b.currentNode.ia(yc.a.YBc,null):null}$S(b=!0){if(!b||this.Rd())b=this.contentControlNode.ia(We.a.lastModifiedTime,new Date(0)),this.VNg!==b?(v.ULS.sendTraceTag(520734535,368,50,"Last Modified Time was used to update Properties"),this.M3c(),
this.VNg=b):v.ULS.sendTraceTag(520734534,368,50,"Last Modified was NOT used but updateProperties would run if Last Modified was removed.")}Wlo(b,h){var r,z;this.Dmd=b;this.C$c=h;this.sg.ir.set(null===(r=this.contentControlNode.id)||void 0===r?void 0:r.toString(),b);this.sg.Bs.set(null===(z=this.contentControlNode.id)||void 0===z?void 0:z.toString(),h)}Jij(){if(this.contentControlNode){var b=this.mu,h=this.Iz;if(!b||!h||b.equals(E.a.nil)||h.equals(E.a.nil))v.ULS.sendTraceTag(17330978,368,10,"StartObjectId/EndObjectId are not initialized before trying to update Start/End contexts.");
else if(b=this.$g.ala(b,!0),h=this.$g.ala(h,!1),b&&h)if(b.isConnected&&h.isConnected||v.ULS.sendTraceTag(37777626,368,10,"StartParaNode/EndParaNode are not connected."),this.Vf)b=Qe.a.create(b),this.rs.v3c(b,this.objectId,!0),this.start=b,b=Qe.a.create(h),this.rs.v3c(b,this.objectId,!0),this.end=b;else{let r=h=-1;if(b.qa){for(let z=0;z<b.qa.length&&(-1===h||-1===r);z++){const R=b.qa.J(z);if(R.Mb)for(let ba=0;ba<R.Mb.length&&(-1===h||-1===r);ba++){const ta=R.Mb.J(ba);E.a.Fp(ta.pe,this.objectId)&&(ta.Pc?
h=R.cp:r=R.cp)}}0<=h&&0<=r&&(b=Qe.a.pL(h,r,!1,b),this.rs.v3c(b,this.objectId,!0),this.start=this.end=b)}}}}getText(){let b="";var h=this.start;const r=this.end;if(!h||!r)return b;this.Vf?b=this.SLh(h,r):(h=ie.ParagraphReader.text(h.node).substring(h.cpBegin,r.cpEnd),b+=dd.AParagraphNode.lU(h));return b}Rd(){return!!this.contentControlNode&&this.contentControlNode.isConnected}B7d(b){return this.Zca?this.qm.x0i(this,b)?0:2:2}clear(){return this.Zca?this.qm.x0i(this,"")?0:2:2}MNh(){const b=new Ua.a;
var h=this.contentControlNode.ia(yc.a.contentControlNode,[]);for(let r of h)if(!E.a.Fp(r,E.a.nil)){h=this.Bi.value.Eb(r);try{b.add(this.q0.mxb(h,this.yx,this.Bi,this.$g,this.rs,this.qm,this.Kpa,this.Zca,this.Eub))}catch(z){}}return b}Zaf(){const b=new Ua.a;this.LLh(this,b);return b}LLh(b,h){b=b.MNh();if(b.count)for(let r of b)h.add(r),this.LLh(r,h)}mE(b=!1){const h=new Ua.a;if(this.Vf){var r=this.qm.hT(this.start,this.end);for(var z of r)r=Qe.a.create(z),this.rs.v3c(r,this.objectId,b),h.add(r)}else z=
this.start.clone(),this.rs.v3c(z,this.objectId,b),h.add(z);return h}x3c(b){const h=this.qm.hT(this.start,this.end);for(let r=0;r<h.count;r++){const z=this.rs.Bcf(h.J(r),this.objectId,!1);if(z){for(let R=0;R<z.count;R++)b(z.J(R));h.J(r).ik()}}}SLh(b,h){const r=new Sys.StringBuilder;h=this.qm.hT(b,h);for(let z of h)z.id.equals(b.node.id)||r.append("\r"),r.append(ie.ParagraphReader.plainText(z));return r.toString()}}Object(n.a)(tx,"ContentControl",null,[401]);class RA{constructor(b){this.sg=b}mxb(b,
h,r,z,R,ba,ta,Wa,ub){return new tx(b,h,r,z,R,ba,this,ta,Wa,ub,this.sg)}}Object(n.a)(RA,"ContentControlFactory",null,[372]);var kC=d(914);class Fw{constructor(b,h,r,z,R,ba,ta,Wa,ub,Ib,$b){this.yx=b;this.Bi=h;this.Xc=r;this.iTb=z;this.Rzj=R;this.BJ=ba;this.Kh=ta;this.fb=Wa;this.bid=ub;this.Yad=Ib;this.sg=$b}get ir(){return this.sg.ir}get Bs(){return this.sg.Bs}get Sy(){return this.yx.value}Usa(){const b=this.Xc.Dk();b.set(this.Sy);this.iTb.zQ(b);if(b.Rb(25))return b;this.Yad.instance&&this.Yad.instance.Yla&&
v.ULS.sendTraceTag(17040640,368,10,"Content Control root node doesn't exist");v.ULS.sendTraceTag(528537619,368,15,"getContentControlRootIterator() returning null");return null}oIc(b,h,r=!1){this.X0b();const z=new Ua.a;let R;if(b){R=b.Rb(26);if(!R)return z;for(;R&&(!h(R)||(z.add(R),!r));){z.addRange(this.oIc(b,h));if(r&&0<z.count)break;R=b.vf(26)}b.mc()}return z}uCl(){const b=this.Xc.Dk();b.set(this.yx.value);this.iTb.zQ(b);return b.currentNode}FMa(b,h,r){let z;z=b.equals(h);z||(z=(b=this.ala(b,r))?
b.id.equals(h):!1);return z}cLa(b,h){var r,z,R,ba;b=this.Cu(b);if(!b)return null;let ta=null;for(;55===b.type;){let Wa;Wa=h?null!==(z=this.sg.ir.get(null===(r=b.id)||void 0===r?void 0:r.toString()))&&void 0!==z?z:E.a.nil:null!==(ba=this.sg.Bs.get(null===(R=b.id)||void 0===R?void 0:R.toString()))&&void 0!==ba?ba:E.a.nil;if(Wa.equals(ta)){b=null;break}else b=this.Cu(Wa);ta=Wa}return b}ala(b,h){return(b=this.cLa(b,h))?ie.ParagraphReader.nc(b)?b:h?this.fb.en(b):this.fb.ZJ(b):null}jyh(b,h=!1){this.Igo(b);
this.kyh(b,h)}Igo(b){var h,r,z,R,ba,ta,Wa,ub,Ib=this.Tsa(b);Ib=this.Tsa(Ib.parentNode);Ib=55===Ib.currentNode.type?Ib.currentNode.id:null;let $b;$b=this.Cu(null!==(r=this.sg.ir.get(null===(h=b.id)||void 0===h?void 0:h.toString()))&&void 0!==r?r:E.a.nil);for(h=this.Cu(null!==(R=this.sg.Bs.get(null===(z=b.id)||void 0===z?void 0:z.toString()))&&void 0!==R?R:E.a.nil);$b&&55===$b.type;)$b=this.Cu(null!==(ta=this.sg.ir.get(null===(ba=$b.id)||void 0===ba?void 0:ba.toString()))&&void 0!==ta?ta:E.a.nil);for(;h&&
55===h.type;)h=this.Cu(null!==(ub=this.sg.Bs.get(null===(Wa=h.id)||void 0===Wa?void 0:Wa.toString()))&&void 0!==ub?ub:E.a.nil);$b&&h&&this.tgj($b.id,h.id,Ib,fc=>{fc=fc.ia(yc.a.lW,E.a.nil);return!fc||fc.equals(E.a.nil)||b.id.equals(fc)})}kyh(b,h=!1){var r,z,R,ba,ta,Wa,ub,Ib,$b,fc,Kc,ed;v.ULS.sendTraceTag(528537620,368,50,"Attempting to delete content control node");const Jd=this.Tsa(b),ge=this.Tsa(Jd.parentNode);let qe=E.a.nil,Ve=E.a.nil;var Bd=ge.currentNode.ia(yc.a.contentControlNode,[]);const he=
new Ua.a;for(let hg=0;hg<Bd.length;hg++)he.add(Bd[hg]);if(h){if(54!==ge.currentNode.type){qe=this.sg.ir.get(null===(r=ge.currentNode.id)||void 0===r?void 0:r.toString());Ve=this.sg.Bs.get(null===(z=ge.currentNode.id)||void 0===z?void 0:z.toString());Bd=this.Cu(qe);for(r=this.Cu(Ve);Bd&&55===Bd.type;)qe=this.sg.ir.get(null===(R=Bd.id)||void 0===R?void 0:R.toString()),Bd=this.Cu(qe);for(;r&&55===r.type;)Ve=this.sg.Bs.get(null===(ba=r.id)||void 0===ba?void 0:ba.toString()),r=this.Cu(Ve)}R=this.Tsa(b);
if(R.Rb(26)){ba=new Ua.a;for(ba.add(R.currentNode);R.vf(26);)ba.add(R.currentNode);for(var we of ba)this.kyh(we,h)}}else if(qe=this.sg.ir.get(null===(ta=b.id)||void 0===ta?void 0:ta.toString()),Ve=this.sg.Bs.get(null===(Wa=b.id)||void 0===Wa?void 0:Wa.toString()),h=this.Gvl(he,b.id),we=this.Tsa(b),we.Rb(26))for(R=this.Tsa(we.currentNode),ba=R.currentNode,Bd=b;ba;)r=we.currentNode,he.insert(h++,r.id),ba=R.vf(26),z=this.Tsa(r),54!==ge.currentNode.type?r.setValue(yc.a.I5,ge.currentNode.id):r.removeProperty(yc.a.I5),
Pi.g(z,ge,Bd,26),Bd=z.currentNode,ba&&(we.set(ba),we.O_(this.Usa().currentNode));54!==ge.currentNode.type&&(h=null!==(Ib=this.sg.ir.get(null===(ub=ge.currentNode.id)||void 0===ub?void 0:ub.toString()))&&void 0!==Ib?Ib:E.a.nil,ub=null!==(fc=this.sg.Bs.get(null===($b=ge.currentNode.id)||void 0===$b?void 0:$b.toString()))&&void 0!==fc?fc:E.a.nil,h.equals(b.id)&&this.sg.ir.set(null===(Kc=ge.currentNode.id)||void 0===Kc?void 0:Kc.toString(),qe),ub.equals(b.id)&&this.sg.Bs.set(null===(ed=ge.currentNode.id)||
void 0===ed?void 0:ed.toString(),Ve));Jd.Eg();v.ULS.sendTraceTag(528537621,368,50,"Disconnected nodeToDelete");this.remove(he,b.id);Bd=Array(he.count);for($b=0;$b<he.count;$b++)Bd[$b]=he.J($b);ge.currentNode.setValue(yc.a.contentControlNode,Bd);kC.a.JCa(b.id)}V1j(b,h,r,z,R,ba,ta=null){var Wa,ub,Ib,$b,fc,Kc,ed,Jd;let ge,qe;h?(ge=this.Cu(h.objectId),qe=this.Tsa(ge)):(qe=this.Usa(),ge=qe.currentNode);const Ve=this.Rzj.create(1074135145);ta&&Ve.properties.Cs(ta.properties);54!==ge.type&&Ve.setValue(yc.a.I5,
ge.id);ta?qe.lCb(Ve,r,26,ta.id):qe.cH(Ve,r,26);this.sg.ir.set(null===(Wa=Ve.id)||void 0===Wa?void 0:Wa.toString(),R);this.sg.Bs.set(null===(ub=Ve.id)||void 0===ub?void 0:ub.toString(),ba);b.Vf&&(h&&(r=null!==($b=this.sg.ir.get(null===(Ib=ge.id)||void 0===Ib?void 0:Ib.toString()))&&void 0!==$b?$b:E.a.nil,Ib=null!==(Kc=this.sg.Bs.get(null===(fc=ge.id)||void 0===fc?void 0:fc.toString()))&&void 0!==Kc?Kc:E.a.nil,r.equals(R)&&this.sg.ir.set(null===(ed=ge.id)||void 0===ed?void 0:ed.toString(),Ve.id),Ib.equals(ba)&&
this.sg.Bs.set(null===(Jd=ge.id)||void 0===Jd?void 0:Jd.toString(),Ve.id)),this.tgj(R,ba,Ve.id,Bd=>{Bd=Bd.ia(yc.a.lW,E.a.nil);const he=h?h.objectId:null;return!Bd||Bd.equals(E.a.nil)||Bd.equals(he)}));R=this.Tsa(Ve);ba=Array(z.count);for(fc=z.count-1;0<=fc;fc--)ba[fc]=z.J(fc).objectId,Kc=this.Cu(z.J(fc).objectId),Kc=this.Tsa(Kc),Kc.currentNode.setValue(yc.a.I5,Ve.id),Pi.g(Kc,R,null,26);0<ba.length&&Ve.setValue(yc.a.contentControlNode,ba);Fw.Qb.isFeatureEnabled(36)&&(b.Tzd&&Ve.setValue(yc.a.JZb,b.Tzd),
b.e5e&&Ve.setValue(yc.a.ywd,!0));return Ve}UIn(b,h,r,z){b.setValue(yc.a.u6,h);b.setValue(yc.a.LZb,!0);b.setValue(yc.a.Zwb,!0);b.setValue(yc.a.Gy,r);b.setValue(yc.a.ibb,qv[0]);b.setValue(yc.a.Hda,!0);b.setValue(yc.a.$wb,"RichText");z&&b.setValue(yc.a.Nlb,z);b.setValue(yc.a.MZb,0)}ugj(b,h=null,r=null){h&&this.sg.ir.set(b.toString(),h);r&&this.sg.Bs.set(b.toString(),r)}xyh(b){if(!b||!b.count||!b.J(0))return null;const h=this.Vgf(b);for(let r=0;r<b.count;r++)this.Kh.QDa(b.J(r));return h}Vgf(b){if(!b||
!b.J(0))return null;const h=this.Xc.Dk();h.set(b.J(0));h.vd();h.mc();return h.bH()?h.currentNode:null}DDl(b){const h=this.Xc.Dk();h.set(b);h.vd();h.mc();h.mc();return h}Q8g(b,h,r){const z=new Ua.a;for(let R=0;R<r;R++){h=this.BJ.qfb(b,h,!0,null);if(!h||!b.Xd())return null;const ba=b.currentNode;b.mc();b.mc();z.add(ba)}return z}Y3b(b){const h=this.Xc.Dk();h.set(b);for(h.Bb(7);h.mc();)switch(h.currentNode.type){case 8:case 16:case 36:case 40:return h.currentNode.id}return null}KVh(b){const h=this.Xc.Dk();
h.set(b);h.vd();return(b=h.dPa())?b.id:null}Yef(b){const h=this.Xc.Dk();h.set(b);return h.Bb(7)?h:null}Cu(b){return this.Bi.value.Eb(b)}X0b(){if(!Fw.bKg){var b=this.Usa();b&&this.x6f(b);Fw.bKg=!0}}OPa(b){return this.bid.OPa(b)}Z9j(b,h){const r=this.Xc.Dk();r.set(b.node);const z=this.Xc.Dk();z.set(h.node);r.vd();z.vd();const R=this.Xc.Dk();R.set(r.currentNode);const ba=this.Xc.Dk();ba.set(z.currentNode);const ta=Ke.returnToLowestCommonTableCell(r,z);return ta?(R.vd(),ba.vd(),{returnValue:({Rx:b}=this.Cud(R,
!0,ta,b)).returnValue&&({Rx:h}=this.Cud(ba,!1,ta,h)).returnValue,H7i:b,ADh:h}):{returnValue:({Rx:b}=this.Cud(r,!0,null,b)).returnValue&&({Rx:h}=this.Cud(z,!1,null,h)).returnValue,H7i:b,ADh:h}}Cud(b,h,r,z){let R=null,ba=b.kd(16);for(;ba!==r;){if(h&&Gi.TableCellReader.Wcm(b)||!h&&Gi.TableCellReader.gei(b))R=b.kd(14);else return{returnValue:!1,Rx:z};ba=b.kd(16)}R&&(z=Qe.a.create(R));return{returnValue:!0,Rx:z}}x6f(b){if(b.Rb(26)){for(this.x6f(b);b.vf(26);)this.x6f(b);b.mc()}}remove(b,h){for(let r=0;r<
b.count;r++)if(b.J(r).toString()===h.toString()){b.removeAt(r);break}}Tsa(b){const h=this.Xc.Dk();h.set(b);h.O_(this.Usa().currentNode);return h}Gvl(b,h){for(let r=0;r<b.count;r++)if(b.J(r).equals(h))return r;return-1}tgj(b,h,r,z){b=this.Mml(b,h);for(h=0;h<b.count;h++)z(b.J(h))&&(r?b.J(h).setValue(yc.a.lW,r):b.J(h).removeProperty(yc.a.lW),this.Yad.instance&&this.Yad.instance.gbi&&b.J(h).gk(16,!0))}Mml(b,h){const r=new Ua.a;var z=this.Cu(b);const R=this.Cu(h);if(!z||!R)return r;const ba=({FQc:ta}=
this.hEd(z,R)).returnValue;z=ta[ba];if(14===z.type)r.add(z);else if(15===z.type&&1<=ba){const Wa=ta[ba-1];1===Ii.TableReader.ag(Wa)&&r.add(Wa)}var ta=Nd.GraphIterator.$a(ba>=ta.length-1?z:ta[ba+1]);ta.Bb(7);for(z=Cn.a.Kr(ta,z);z.moveNext()&&z.currentNode!==R;)14===z.currentNode.type&&r.add(z.currentNode);if(!E.a.Fp(h,b)&&14===R.type)for(ta=Nd.GraphIterator.$a(R),z=Cn.a.Kr(ta,R);z.moveNext();)14===z.currentNode.type&&r.add(z.currentNode);return r}hEd(b,h){b=this.jdb(b);h=this.jdb(h);let r=0;for(;r<
b.length&&r<h.length&&b[r]===h[r];++r);return{returnValue:0<r?r-1:r,FQc:b,jVf:h}}jdb(b){const h=[];h.push(b);b=Nd.GraphIterator.$a(b);for(b.Bb(7);b.mc();)h.push(b.currentNode);h.reverse();return h}static get Qb(){return null!=Fw.ejg?Fw.ejg:Fw.ejg=Sa.a.instance.Pa("Box4.IFeatureHelper")}}Fw.bKg=!1;Object(n.a)(Fw,"ContentControlGraphManager",null,[371]);class Wv{constructor(b,h,r,z,R,ba,ta,Wa,ub){this.Soa=null;this.lhm=(Ib,$b)=>{if(this.WW)return this.mhm(Ib,$b);if(!Ib||!Ib.count)return v.ULS.sendTraceTag(17356048,
368,15,"The GNC list should not be null or empty"),!1;let fc=!0;switch($b){case 0:$b=this.VP(Ib.J(0),Ib.J(Ib.count-1),1);if((Ib=this.VP(Ib.J(0),Ib.J(Ib.count-1),3))&&0<Ib.count){if(!Ib.J(0).isSupported||!Ib.J(0).isEditable){fc=!1;break}for(Ib=Ib.J(0);Ib;)this.IXc($b,Ib.id),Ib=this.getById(Ib.parentId)}if($b)for(var Kc of $b)if(!Kc.isSupported||!Kc.isEditable){fc=!1;break}break;case 1:if(Ib.J(0).contextId!==kc.a.Wc){v.ULS.sendTraceTag(17356049,368,15,"The only GNC in the GNC list should always be an IpContext for ApiOperation.Inserting");
fc=!1;break}($b=this.VP(Ib.J(0),Ib.J(0),1))&&0<$b.count&&(fc=!1);break;case 2:if(Ib.J(0).contextId!==kc.a.Wc){v.ULS.sendTraceTag(17424994,368,15,"The only GNC in the GNC list should always be an IpContext for ApiOperation.InsertingIgnoringBoundary");fc=!1;break}($b=this.VP(Ib.J(0),Ib.J(0),3))&&0<$b.count&&(fc=!1);break;case 3:case 4:$b=this.nGd(Ib.J(0),!0);Kc=this.nGd(Ib.J(Ib.count-1),!1);if(!$b||!Kc){v.ULS.sendTraceTag(17356050,368,15,"The GNC list is not supported for ApiOperation.Clearing or ApiOperation.Replacing");
fc=!1;break}if(($b=this.VP($b,$b,3))&&0<$b.count){fc=!1;break}if(($b=this.VP(Kc,Kc,3))&&0<$b.count){fc=!1;break}if($b=this.qm.VP(Ib.J(0),Ib.J(Ib.count-1),1))for(let ed of $b)if(!ed.afa){fc=!1;break}break;default:fc=!1}return fc};Wv.yx=b;Wv.Bi=h;this.$g=r;this.rs=z;this.qm=R;this.q0=ba;this.Kpa=ta;this.Bf=Wa;this.Co=ub}get pMa(){return!!this.Bf.instance&&this.Bf.instance.pMa}get Yla(){return!!this.Bf.instance&&this.Bf.instance.Yla}get WNd(){return!!this.Bf.instance&&this.Bf.instance.WNd}get WW(){return!!this.Bf.instance&&
this.Bf.instance.WW}get YNd(){return!!this.Bf.instance&&this.Bf.instance.YNd}OCb(){return!!this.Bf.instance&&this.Bf.instance.OCb}uja(b,h,r=null,z=null,R=!1){if(!this.pMa)return{returnValue:2,id:0};b=this.$g.ala(b,!0);h=this.$g.ala(h,!1);if(!b||!h)return{returnValue:2,id:0};b=Qe.a.create(b);h=Qe.a.create(h);return this.A7g(b,h,r,z,R)}a1j(b,h,r=!1){return this.pMa&&b&&h?this.A7g(b,h,null,null,!1,r):{returnValue:2,id:0}}Xub(b,h=null,r=!1){let z=0;if(!this.pMa)return{returnValue:2,id:z};const R=this.q0.mxb(h,
Wv.yx,Wv.Bi,this.$g,this.rs,this.qm,this.Kpa,this.pMa,this.WNd);R.start=b;R.end=b;R.mu=b.node.id;R.Iz=b.node.id;R.Vf=!1;return this.qm.C8g(R,h,r)?(z=R.id,{returnValue:0,id:z}):{returnValue:2,id:z}}U1j(b,h=null){if(!this.pMa||!this.Sdm(b))return{returnValue:2,id:0};var r=b.J(0).contextId===kc.a.endOfParagraph?b.J(1):b.J(0);const z=b.J(b.count-1);if(this.XYe(b,kc.a.paragraph)||this.XYe(b,kc.a.endOfParagraph)){b=r.node.id;let R=z.node.id;const ba=b.equals(R);r=this.qm.i7i(r,!0);void 0!==r&&null!==r&&
(b=r,R=ba?b:R);this.qm.i7i(z,!1);h.setValue(yc.a.u6,!0);return this.uja(b,R,h)}return r!==z||r.contextId!==kc.a.Gd&&r.contextId!==kc.a.Wc?{returnValue:2,id:0}:(h.setValue(yc.a.u6,!1),this.Xub(r,h))}getById(b){if(!this.Yla)return null;const h=this.$g.oIc(this.$g.Usa(),r=>r.getValue(yc.a.Gy)===b,!0);return 0<h.count?this.qm.iT(h.J(0)):null}getByTitle(b){if(!this.Yla)return null;const h=this.$g.oIc(this.$g.Usa(),z=>z.ia(yc.a.hbb,null)===b,!1),r=new Ua.a;for(let z of h)r.add(this.qm.iT(z));return r}getByTag(b){if(!this.Yla)return null;
const h=this.$g.oIc(this.$g.Usa(),z=>z.ia(yc.a.$Bc,null)===b,!1),r=new Ua.a;for(let z of h)r.add(this.qm.iT(z));return r}VP(b,h,r,z=!1){return this.Yla?this.WW?this.qm.rea(b,h,r):this.qm.VP(b,h,r,z):null}hT(b,h){return this.qm.hT(b,h)}qhl(){if(!this.Yla)return null;const b=this.$g.oIc(this.$g.Usa(),()=>!0,!1),h=new Ua.a;for(let r of b)h.add(this.qm.iT(r));return h}xjb(b){if(!this.pMa)return v.ULS.sendTraceTag(528537618,368,15,"Cannot release content control, isContentControlWriteEnabled = false"),
2;b=this.getById(b);return this.qm.ODa(b)?0:2}sSk(b){if(!this.pMa)return 2;b=this.getById(b);return this.qm.deleteContentControl(b)?0:2}k2j(b){this.qm.zkn(b)}aik(b){this.Soa=b;this.Soa.umn(this.lhm)}cnl(b){if(!this.OCb())return null;let h;var r=b.mE();h=this.nGd(r.J(r.count-1),!1);r=this.rs.aHd(r.J(r.count-1).node,h.cpBegin).Mb;b=this.KLl(r,b);if(-1===b)return null;h.Fb=b;h.Ub=h.Fb;return h}mhm(b,h){if(!b||!b.count)return v.ULS.sendTraceTag(21031131,368,15,"The GNC list should not be null or empty"),
!1;switch(h){case 0:return this.dcm(b);case 3:case 4:case 6:return this.njm(b,6===h);case 1:case 2:case 5:return 1!==b.count||b.J(0).contextId!==kc.a.Wc?(v.ULS.sendTraceTag(21031132,368,15,"The only GNC in the GNC list should always be an IpContext for ApiOperation.InsertingIgnoringBoundary"),!1):this.Mdi(b.J(0),5===h,!1);default:return!1}}dcm(b){const h=this.qm.rea(b.J(0),b.J(b.count-1),3);if(h&&0<h.count){var r=h.J(0);if(!r.isSupported||!r.isEditable)return!1}b=this.qm.rea(b.J(0),b.J(b.count-1),
1);for(r=0;h&&r<h.count;r++)this.IXc(b,h.J(r).id);if(b)for(let z of b)if(!z.isSupported||!z.isEditable)return!1;return!0}njm(b,h){var r=b.J(0),z=b.J(b.count-1),R=r.hl,ba=z.ut;if(-1===R||-1===ba)return!1;R=this.Co.d6(r.node,R,r.Fb);ba=this.Co.d6(z.node,ba,z.Ub);var ta=-1,Wa=Math.min(R.count,ba.count);for(--Wa;0<=Wa;Wa--){const ub=R.J(Wa).pe,Ib=ba.J(Wa).pe;if(ub.equals(Ib)){ta=Wa;break}}if(-1<ta&&(Wa=this.qm.iT(R.J(ta).contentControlNode),!Wa.isEditable||!Wa.isSupported||Wa.cO&&!this.Kbm(Wa,b)))return!1;
r=this.qm.rea(r,z,1);for(z=0;z<=ta;z++)this.IXc(r,this.qm.iT(R.J(z).contentControlNode).id);for(z=ta+1;z<R.count;z++){Wa=this.qm.iT(R.J(z).contentControlNode);if(!Wa.isEditable||!Wa.afa||!Wa.isSupported||Wa.cO)return!1;this.IXc(r,Wa.id)}for(R=ta+1;R<ba.count;R++){ta=this.qm.iT(ba.J(R).contentControlNode);if(!ta.isEditable||!ta.afa||!ta.isSupported||ta.cO)return!1;this.IXc(r,ta.id)}if(r)for(let ub of r)if(!ub.isSupported||!ub.afa)return!1;return h&&(b=this.nGd(b.J(0),!0))?this.Mdi(b,!0,!0):!0}Kbm(b,
h){h=this.Co.zDl(h.J(0),h.J(h.count-1));return!!b&&!!h&&b.objectId.equals(h.pe)}Mdi(b,h,r){return(b=this.qm.rea(b,b,3))&&0<b.count&&(b=b.J(0),!b.isSupported||!b.isEditable||!this.YNd&&h&&!b.Vf||!r&&b.cO)?!1:!0}nGd(b,h){if(!b)return null;let r=null;switch(b.contextId){case kc.a.paragraph:r=h?Qe.a.Uc(b.node,0):Qe.a.ow(b.node);break;case kc.a.endOfParagraph:r=Qe.a.ow(b.node);break;case kc.a.Gd:r=h?Qe.a.Uc(b.node,b.cpBegin):Qe.a.Uc(b.node,b.cpEnd);break;case kc.a.Wc:r=b}r&&(r.Ub=r.Fb=h?b.Fb:b.Ub);return r}IXc(b,
h){if(b)for(let r of b)if(r.id===h){b.remove(r);break}}KLl(b,h){if(!b)return-1;let r=-1;for(let z=0;z<b.length;z++)if(b.J(z).pe.equals(h.objectId)&&!1===b.J(z).Pc){r=z;if(h.Vf&&0<z&&b.J(z-1).Vf&&!b.J(z-1).Pc)return-1;break}return r}Sdm(b){if(void 0===b||null===b)return!1;for(let h=0;h<b.count;h++){const r=b.J(h).contextId;if(r!==kc.a.paragraph&&r!==kc.a.endOfParagraph&&r!==kc.a.Gd&&r!==kc.a.Wc||0<h&&h<b.count-1&&r===kc.a.Gd&&(b.J(h).cpBegin||b.J(h).cpEnd!==b.J(h).node.characterData.length))return!1}return b.J(0).contextId===
kc.a.endOfParagraph&&1===b.count||this.XYe(b,kc.a.Wc)&&1<b.count?!1:!0}XYe(b,h){for(let r of b)if(r.contextId===h)return!0;return!1}A7g(b,h,r=null,z=null,R=!1,ba=!1){let ta=0;var Wa=h.node;let ub=Qe.a.create(b.node);Wa=Qe.a.create(Wa);if(!({H7i:ub,ADh:Wa}=this.$g.Z9j(ub,Wa)).returnValue)return{returnValue:2,id:ta};const Ib=this.q0.mxb(r,Wv.yx,Wv.Bi,this.$g,this.rs,this.qm,this.Kpa,this.pMa,this.WNd);Ib.start=b;Ib.end=h;Ib.mu=ub.node.id;Ib.Iz=Wa.node.id;Ib.Vf=!0;Ib.Tzd=z;Ib.e5e=R;return this.qm.C8g(Ib,
r,ba)?(ta=Ib.id,{returnValue:0,id:ta}):{returnValue:2,id:ta}}}Wv.yx=null;Wv.Bi=null;Object(n.a)(Wv,"ContentControlManager",null,[370]);var SA=d(695),lC=d(162),Mq=d(191);class Tz extends Sys.EventArgs{constructor(b){super();this.tQk=b}}Object(n.a)(Tz,"ContentControlChangeEventArgs",Sys.EventArgs,[]);class rv{constructor(){this.aui=0;this.yDi=null}}Object(n.a)(rv,"BypassIfNodeOfTypeAndParentMatchingConditionFilterData",null,[]);class ms{constructor(b,h,r,z,R,ba,ta,Wa,ub,Ib,$b,fc,Kc,ed,Jd,ge,qe,Ve,Bd,
he,we,hg,Pf,Ej){this.Nj=Ej;this.dXg=[];this.SDe=[];this.yx=b;this.Bi=h;this.$g=r;this.rs=z;this.q0=R;this.mg=ub;this.BC=Ib;this.ib=ba;this.kA=ta;this.$xa=Wa;this.Kpa=ed;this.Eub=Jd;this.Zca=$b;this.AH=fc;this.ga=Kc;this.Co=ge;this.Bf=qe;this.sh=Ve;this.fb=Bd;this.Hc=he;this.o5g=we;this.Ac=hg;this.sg=Pf;this.AH&&(this.AH.addHandler(SA.a.oIb,Object(u.a)(this,this.mAi,"onShowingPlaceholder")),this.AH.addHandler(SA.a.L3d,Object(u.a)(this,this.yzi,"onRemoveWhenEdited")))}get Sy(){return this.yx.value}get Ui(){return this.Bi.value}get WW(){return!!this.Bf.instance&&
this.Bf.instance.WW}get M$(){return!!this.Ac&&this.Ac.isFeatureEnabled(27)}dispose(){this.AH&&(this.AH.removeHandler(SA.a.oIb,Object(u.a)(this,this.mAi,"onShowingPlaceholder")),this.AH.removeHandler(SA.a.L3d,Object(u.a)(this,this.yzi,"onRemoveWhenEdited")))}VP(b,h,r,z=!1){if(this.WW)return this.rea(b,h,r);if(!b||!h)return null;const R=this.$g.ala(b.node.id,!0);var ba=this.$g.ala(h.node.id,!1);if(!R||!ba)return null;b=b.contextId===kc.a.endOfParagraph?b:Qe.a.Uc(R,-1===b.cpBegin?0:b.cpBegin);h=h.contextId===
kc.a.endOfParagraph?h:Qe.a.Uc(ba,-1===h.cpEnd?ba.characterData.length:h.cpEnd);ba=null;switch(r){case 0:ba=this.irl(b,h);break;case 1:ba=this.KDl(b,h);break;case 3:ba=this.nWh(b,h,z);break;case 2:ba=this.KMl(b,h);break;case 4:ba=this.Gcf(b,h,!1)}return ba}rea(b,h,r){if(!b||!h||b.contextId!==kc.a.endOfParagraph&&(b=this.Arh(b,!0),!b)||h.contextId!==kc.a.endOfParagraph&&(h=this.Arh(h,!1),!h))return null;let z=null;switch(r){case 0:z=this.jrl(b,h);break;case 1:z=this.LDl(b,h);break;case 3:z=this.oWh(b,
h);break;case 2:z=this.LMl(b,h);break;case 4:z=this.Gcf(b,h,!0)}return z}Arh(b,h){var r=this.$g.ala(b.node.id,h);if(!r)return null;h?(h=-1===b.cpBegin?0:b.cpBegin,b=b.Fb):(h=-1===b.cpEnd?r.characterData.length:b.cpEnd,b=b.Ub);r=Qe.a.Uc(r,h);r.Fb=b;r.Ub=b;return r}irl(b,h){const r=new Ua.a;if(b.contextId===kc.a.endOfParagraph||h.contextId===kc.a.endOfParagraph||b.equals(h))return r;const z=new kn.a,R=this.Mzb(b,b),ba=this.Mzb(h,h);for(let ta=0;ta<R.count;ta++)if(R.J(ta).Pc)for(let Wa=0;Wa<ba.count;Wa++)ba.J(Wa).Pc||
R.J(ta).pe.equals(ba.J(Wa).pe)&&(!R.J(ta).Vf||this.$g.FMa(R.J(ta).pe,b.node.id,!0)&&this.$g.FMa(ba.J(Wa).pe,h.node.id,!1))&&this.xqd(r,z,R.J(ta).pe);return r}jrl(b,h){const r=new Ua.a;if(b.contextId===kc.a.endOfParagraph||h.contextId===kc.a.endOfParagraph||b.equals(h)&&b.Fb===b.Ub||-1===b.Fb||-1===h.Ub)return r;var z=b.node.qa.ji(b.cpBegin),R=h.node.qa.ji(h.cpEnd);z&&z.Mb&&0<z.Mb.length&&b.Fb<=z.Mb.length&&R&&R.Mb&&0<R.Mb.length&&h.Ub<=R.Mb.length&&(b=b.Fb,h=h.Ub,b===z.Mb.length&&b--,0<h&&h--,z=z.Mb.J(b),
R=R.Mb.J(h),z.Pc&&!R.Pc&&E.a.Fp(z.pe,R.pe)&&z.Aq&&R.Aq&&(R=z.contentControlNode)&&r.add(this.iT(R)));return r}KDl(b,h){const r=new Ua.a,z=new kn.a,R=this.Mzb(b,h);for(let ba=0;ba<R.count;ba++)this.xqd(r,z,R.J(ba).pe);b=this.nWh(b,h,!1,!1);for(let ba of b)z.contains(ba.objectId)||(r.add(ba),z.add(ba.objectId));return r}LDl(b,h){const r=new Ua.a,z=new kn.a,R=this.Pbf(b,h);for(let ba=0;ba<R.count;ba++)this.QNe(r,z,R.J(ba));b=this.oWh(b,h);for(let ba of b)z.contains(ba.objectId)||(r.add(ba),z.add(ba.objectId));
return r}nWh(b,h,r,z=!0){const R=new Ua.a;b.equals(h)&&(r=!1);const ba=new kn.a;let ta=!1;b=this.Mzb(null,b,!0,r);h=this.Mzb(h,null,r,!0);for(r=b.count-1;0<=r;r--){for(let Wa=0;Wa<h.count&&!(b.J(r).pe.equals(h.J(Wa).pe)&&(b.J(r),this.xqd(R,ba,b.J(r).pe)&&(ta=!this.$g.Cu(b.J(r).pe).ia(yc.a.I5,null),z||ta)));Wa++);if(0<R.count&&(z||ta))break}return R}oWh(b,h){const r=new Ua.a,z=new kn.a,R=b.node;var ba=h.node;const ta=h.contextId===kc.a.endOfParagraph?ba.characterData.length:h.cpEnd;b=this.Co.d6(R,
b.contextId===kc.a.endOfParagraph?R.characterData.length:b.cpBegin,b.Fb);h=this.Co.d6(ba,ta,h.Ub);ba=b.count>h.count?h.count:b.count;for(--ba;0<=ba;ba--)b.J(ba).pe.equals(h.J(ba).pe)&&this.QNe(r,z,b.J(ba));return r}KMl(b,h){const r=new Ua.a;let z=new kn.a;const R=this.Mzb(b,h);let ba=0,ta=null;if(b.equals(h))return r;for(b=0;b<R.count;b++)!R.J(b).Pc||R.J(b).Vf&&!this.$g.FMa(R.J(b).pe,R.J(b).Ob.paragraph.id,!0)?R.J(b).Pc||R.J(b).Vf&&!this.$g.FMa(R.J(b).pe,R.J(b).Ob.paragraph.id,!1)||(ba--,0>ba?(ba=
0,z=new kn.a):!ba&&ta&&R.J(b).pe.equals(ta)&&this.xqd(r,z,ta)):(ba||(ta=R.J(b).pe),ba++);return r}LMl(b,h){const r=new Ua.a;if(b.equals(h)&&b.Fb===h.Ub)return r;let z=new kn.a;b=this.Pbf(b,h);h=0;let R=null;for(let ba=0;ba<b.count;ba++){const ta=b.J(ba);!ta.Pc||ta.Vf&&!this.$g.FMa(ta.pe,ta.Ob.paragraph.id,!0)?ta.Pc||ta.Vf&&!this.$g.FMa(ta.pe,ta.Ob.paragraph.id,!1)||(h--,0>h?(h=0,z=new kn.a):!h&&R&&ta.pe.equals(R.pe)&&this.QNe(r,z,R)):(h||(R=ta),h++)}return r}Gcf(b,h,r){const z=new Ua.a;b=r?this.Pbf(b,
h):this.Mzb(b,h);h=0;for(r=0;r<b.count;r++){var R=b.J(r);R.Aq&&(R.Pc?h++:(h--,0>h?h=0:(R=this.iT(R.contentControlNode))&&z.add(R)))}return z}Mzb(b,h,r=!0,z=!0){const R=new Ua.a,ba=this.hT(b,h);if(!ba.count)return R;let ta,Wa,ub,Ib;for(let $b=0;$b<ba.count;$b++){ta=0;Wa=ba.J($b).characterData.length;ub=Ib=!0;if(b&&ba.J($b).id.equals(b.node.id)){if(b.contextId===kc.a.endOfParagraph)continue;0<=b.cpBegin&&(ta=b.cpBegin)}h&&ba.J($b).id.equals(h.node.id)&&0<=h.cpEnd&&(Wa=h.cpEnd);$b||(ub=r);$b!==ba.count-
1||h&&h.contextId===kc.a.endOfParagraph||(Ib=z);R.addRange(this.Qbf(ba.J($b),ta,Wa,ub,Ib))}return R}Pbf(b,h){const r=new Ua.a,z=this.hT(b,h);let R,ba,ta;for(let ub=0;ub<z.count;ub++){const Ib=z.J(ub);var Wa=Ib.qa.J(Ib.qa.length-1);R=0;ba=Ib.characterData.length;ta=0;Wa=Wa&&Wa.Mb?Wa.Mb.length:0;b&&Ib.id.equals(b.node.id)&&(R=b.hl,ta=b.Fb);h&&Ib.id.equals(h.node.id)&&(ba=h.ut,Wa=h.Ub);r.addRange(this.bNh(Ib,R,ba,ta,Wa))}return r}Qbf(b,h,r,z=!0,R=!0,ba=!0){const ta=new Ua.a;b=b.qa;for(let Wa=0;Wa<b.length;Wa++){if(b.J(Wa).cp<
h)continue;if(b.J(Wa).cp>r)break;const ub=b.J(Wa);if(ub.Mb&&0<ub.Mb.length&&(ub.cp!==h||z)&&(ub.cp!==r||R))for(let Ib=0;Ib<ub.Mb.length;Ib++){const $b=ub.Mb.J(Ib);(ba||$b.Pc)&&ta.add($b)}}return ta}bNh(b,h,r,z,R){const ba=new Ua.a;b=b.qa;for(let ta=0;ta<b.length;ta++){if(b.J(ta).cp<h)continue;if(b.J(ta).cp>r)break;const Wa=b.J(ta);if(Wa.Mb&&0<Wa.Mb.length){let ub=0,Ib=Wa.Mb.length;Wa.cp===h&&(ub=z);for(Wa.cp===r&&(Ib=R);ub<Ib&&ub<Wa.Mb.length;ub++)ba.add(Wa.Mb.J(ub))}}return ba}xqd(b,h,r){let z=null;
if(h.contains(r)||!(z=this.Ui.Eb(r)))return!1;b.add(this.iT(z));h.add(r);return!0}QNe(b,h,r){let z=null;!h.contains(r.pe)&&(z=r.contentControlNode)&&(b.add(this.iT(z)),h.add(r.pe))}vdj(b,h){let r,z=!1;r=({h1a:h,g1a:b,i0c:z}=this.wdj(b,h,!1,z)).returnValue||z;z&&(r=r||({h1a:h,g1a:b,i0c:z}=this.wdj(h,b,!0,z)).returnValue);return{returnValue:r,h1a:h,g1a:b}}wdj(b,h,r,z){var R,ba,ta,Wa;let ub,Ib;if(r)return ub=Ib=null,{returnValue:!1,h1a:Ib,g1a:ub,i0c:!1};let $b=!1;Ib=b;ub=h;const fc=b.cpBegin,Kc=h.cpEnd;
z=!1;var ed=r?this.OLh(h):this.Dhl(b);let Jd=!1,ge=!1,qe=0,Ve=0;for(let Bd of ed)for(ed=0;ed<Bd.qa.length;ed++){const he=Bd.qa.J(ed);!ge&&Bd.id.equals(h.node.id)&&(ge=!0);if(!Jd&&(Bd.id.equals(h.node.id)&&-1!==Kc&&he.cp>Kc||ge&&!Bd.id.equals(h.node.id)))if(Jd=!0,qe!==Ve)$b=!0;else return{returnValue:!1,h1a:Ib,g1a:ub,i0c:z};if((!Bd.id.equals(b.node.id)||he.cp>=fc||-1===fc)&&he.Mb)for(let we=0;we<he.Mb.length;we++){const hg=he.Mb.J(we),Pf=this.Ui.Eb(hg.pe);if(!Pf.getValue(yc.a.u6)||(!hg.Pc||this.$g.FMa(null!==
(ba=this.sg.ir.get(null===(R=Pf.id)||void 0===R?void 0:R.toString()))&&void 0!==ba?ba:E.a.nil,Bd.id,!0))&&(hg.Pc||this.$g.FMa(null!==(Wa=this.sg.Bs.get(null===(ta=Pf.id)||void 0===ta?void 0:ta.toString()))&&void 0!==Wa?Wa:E.a.nil,Bd.id,!1))){hg.Pc?qe++:qe--;if($b&&qe===Ve)return{h1a:Ib,g1a:ub}=this.JIk(b.node,Bd,b.cpBegin,he.cp),{returnValue:!0,h1a:Ib,g1a:ub,i0c:z};!r&&qe<Ve&&(z=!0,Ve--)}}}return{returnValue:$b,h1a:Ib,g1a:ub,i0c:z}}JIk(b,h,r,z){let R;h.id.equals(b.id)?b=0<r||z<ie.ParagraphReader.textLength(h)?
R=Qe.a.createTextRange(h,r,z):R=Qe.a.create(h):(R=0<r?Qe.a.createTextRange(b,r,ie.ParagraphReader.textLength(b)):Qe.a.create(b),b=z<ie.ParagraphReader.textLength(h)?Qe.a.createTextRange(h,0,z):Qe.a.create(h));return{h1a:R,g1a:b}}Uzl(b){var h,r,z,R;const ba=b.cpBegin,ta=this.OLh(b);for(let ub=ta.count-1;0<=ub;ub--){const Ib=ta.J(ub);for(let $b=Ib.qa.length-1;0<=$b;$b--){const fc=Ib.qa.J($b);if((!Ib.id.equals(b.node.id)||fc.cp<=ba||-1===ba&&!fc.cp)&&fc.Mb){var Wa=fc.Mb.length-1;for((fc.cp===ba||-1===
ba&&!fc.cp)&&this.WW&&Ib.id.equals(b.node.id)&&(Wa=b.Fb-1);0<=Wa;Wa--){const Kc=fc.Mb.J(Wa),ed=this.Ui.Eb(Kc.pe);if(Kc.Pc){if(ed.getValue(yc.a.u6)&&!this.$g.FMa(null!==(R=this.sg.ir.get(null===(z=ed.id)||void 0===z?void 0:z.toString()))&&void 0!==R?R:E.a.nil,Ib.id,!0))continue;return null}if(!ed.getValue(yc.a.u6)||this.$g.FMa(null!==(r=this.sg.Bs.get(null===(h=ed.id)||void 0===h?void 0:h.toString()))&&void 0!==r?r:E.a.nil,Ib.id,!1))return this.iT(ed)}}}}return null}iT(b){if(!b)return null;this.$g.X0b();
return this.q0.mxb(b,this.yx,this.Bi,this.$g,this.rs,this,this.Kpa,this.Zca,this.Eub)}hT(b,h){b=this.NLh(b,h,ms.vAb(12));if(!b)return null;h=new Ua.a;for(let r of b)h.add(r);return h}Bhl(b,h){const r=ms.pwl();return this.NLh(Qe.a.create(b.node),Qe.a.create(h.node),r)}NLh(b,h,r){if(!r||!b&&!h)return null;if(b&&h&&(b.equals(h)||b.node.id.equals(h.node.id))){var z=b.node;if(z&&r(z)){var R;return R=new Ua.a,R.add(z),R}}z=Object.assign(new rv,{aui:35,yDi:r});b=b?b.node:null;h=h?h.node:null;R=this.IHl(b,
h);if(!R)return null;h=this.b$j(h,r,ms.lih,z);return this.xhl(b,h,R,r,ms.lih,z)}IHl(b,h){return(b=b?this.dTh(b):this.dTh(h))?b.kd(35):this.$g.uCl()}b$j(b,h,r,z){if(!b)return null;h(b)||(h=this.yhl(b,h,r,z),h.count&&(b=h.J(h.count-1)));return b}xhl(b,h,r,z,R,ba){b?(b=Nd.GraphIterator.$a(b),b.Bb(7),r=Cn.a.Kr(b,r)):r=Cn.a.Wp(r);R&&r.Um(R,ba);for(R=new Ua.a;r.moveNext()&&(z(r.currentNode)&&R.add(r.currentNode),!h||!r.currentNode.id.equals(h.id)););return R}yhl(b,h,r,z){b=Cn.a.Wp(b);r&&b.Um(r,z);for(r=
new Ua.a;b.moveNext();)h(b.currentNode)&&r.add(b.currentNode);return r}dTh(b){b=Nd.GraphIterator.$a(b);return b.Bb(35)?b:null}c4h(b,h){b=this.hT(b,h);for(let r of b)if((b=this.$g.Yef(r))&&b.k6(4))return!0;return!1}C8g(b,h=null,r=!1){if(!b)return!1;var z=b.start,R=b.end;if(!Xd.SelectionEditor.du(z)&&z.contextId!==kc.a.paragraph||!Xd.SelectionEditor.du(R)&&R.contextId!==kc.a.paragraph||!this.WW&&({h1a:z,g1a:R}=this.vdj(b.start,b.end)).returnValue||this.WW&&!({start:z,end:R}=this.crk(z,R)).returnValue)return!1;
b.start=z;b.end=R;const ba=this.mcm(z,R);if(this.WW){var ta=this.rea(b.start,b.end,3);var Wa=this.rea(b.start,b.end,2)}else ta=this.VP(b.start,b.end,3),Wa=this.VP(b.start,b.end,2);const ub=ta&&0<ta.count?ta.J(0):null,Ib=Wa&&0<Wa.count?Wa.J(0):null;if(r)return this.wNc(b,0,ta)?!0:!1;if(this.wNc(b,0,ta)){r=(r=Object(la.a)(tx,this.Uzl(b.start)))?this.$g.Cu(r.objectId):null;Wa=this.$g.V1j(b,ub,r,Wa,b.mu,b.Iz,h);this.Nj.n9b(Wa);if(b.Vf)for(z=this.hT(b.start,b.end),R=0;R<z.count;R++)this.WW?(r=ub?ub.objectId:
null,ta=this.LSh(r,z.J(R),!0),this.rs.lra(z.J(R),Wa.id,0,!0,!0,void 0,void 0,void 0,void 0,ta),r=this.LSh(r,z.J(R),!1),this.rs.lra(z.J(R),Wa.id,z.J(R).characterData.length,!0,!1,void 0,void 0,void 0,void 0,r)):(this.rs.lra(z.J(R),Wa.id,0,!0,!0),this.rs.lra(z.J(R),Wa.id,z.J(R).characterData.length,!0,!1));else this.WW?(r=-1===z.Fb?0:z.Fb,this.rs.lra(b.start.node,Wa.id,z.cpBegin,!1,!0,void 0,void 0,void 0,void 0,r),this.rs.lra(b.end.node,Wa.id,R.cpEnd,!1,!1,void 0,void 0,void 0,void 0,ba?r+1:R.Ub)):
(this.rs.lra(b.start.node,Wa.id,b.start.cpBegin,!1,!0),this.rs.lra(b.start.node,Wa.id,b.start.cpEnd,!1,!1));h||this.$g.UIn(Wa,b.Vf,b.id,this.$g.Y3b(this.$g.Cu(b.mu)));b.objectId=Wa.id;h=this.$g.Usa().currentNode;h.hasProperty(yc.a.YBc)||h.setValue(yc.a.YBc,WordEditorIntl.WordEditorStrings.l_ContentControlPlaceholder);ub&&this.bij(ub.contentControlNode,b);Ib&&this.bij(Wa,Ib);ba&&this.ga.Xb(Fb.a.j0f,2,b.id);return!0}return!1}deleteContentControl(b){if(!this.wNc(b,3))return v.ULS.sendTraceTag(528537614,
368,15,"Invalid content control to delete"),!1;if(this.Nj.c3c(b.contentControlNode))return!0;b.cO&&(b.cO=!1);const h=this.ib.hb.kb;b=b.mE();const r=new tm.Selection(b.toArray(),!0);let z=!1;this.ib.bJb(()=>{this.ib.setSelection(r);if(32===this.ga.processAction(Fb.a.SG,2)){if(this.o5g.instance){const R=this.o5g.instance.uUh(h,r,this.ib.hb.kb);this.ib.igo(new lC.SelectionCollection([R],0))}z=!0}});return z}ODa(b,h=!1){if(this.wNc(b,2)){if(b.cO)return v.ULS.sendTraceTag(528537615,368,15,"Attempting to delete content control showing placeholder"),
this.deleteContentControl(b);const r=Nr.a.fE?b.contentControlNode:this.$g.Cu(b.objectId);let z=new Ua.a;h&&(z=b.Zaf());z.add(b);if(!this.Nj.c3c(b.contentControlNode)){r&&r.anchor&&this.$g.jyh(r,h);for(let R of z)b=this.hT(R.start,R.end),this.rs.CSk(b,R.objectId);this.bJi(z)}v.ULS.sendTraceTag(528537616,368,50,"Successfully released content control.");return!0}v.ULS.sendTraceTag(528537617,368,15,"Invalid content control to release.");return!1}x0i(b,h){if(this.wNc(b,1)){let Wa=!1;h||(Wa=!0,{XTn:r,returnValue:h}=
this.lJc(b),r&&this.$g.Usa().currentNode.setValue(yc.a.YBc,h));var r=b.MNh().toArray();for(var z=0;z<r.length;z++)this.ODa(r[z],!0);h=this.Q0n(h);if(b.Vf){z=this.hT(b.start,b.end);if(!z.count)return!1;if(1===z.count&&t.AFrameworkApplication.TG)h=h.join(" "),this.rs.replaceTextRange(Qe.a.createTextRange(z.J(0),0,z.J(0).characterData.length),h);else{var R=this.$g.DDl(z.J(0));r=z.J(0).g2b();z=this.$g.xyh(z);z=this.$g.Q8g(R,z,h.length);for(R=0;R<z.count;R++){this.rs.replaceTextRange(Qe.a.createTextRange(z.J(R),
0,0),h[R]);for(var ba=0;ba<r.count;ba++)this.rs.lra(z.J(R),r.J(ba),0,!0,!0),this.rs.lra(z.J(R),r.J(r.count-ba-1),z.J(R).characterData.length,!0,!1)}b.Wlo(z.J(0).id,z.J(z.count-1).id);h=this.kA.xe(z.J(0),0);this.ib.setSelection(h)}}else{R=0;1<h.length&&v.ULS.sendTraceTag(17585367,368,15,"New text being set to an inline content control should not contain multiple paragraphs");r=b.start;z=r.node;for(var ta=0;ta<z.qa.length&&r.contextId===kc.a.Gd;ta++)if(ba=z.qa.J(ta),ba.cp===r.cpBegin&&ba.blob){R++;
for(ta+=1;ta<z.qa.length;ta++)if(ba=z.qa.J(ta),ba.cp>r.cpBegin&&ba.cp<=r.cpEnd)if(ba.blob)R++;else break;else if(ba.cp>r.cpEnd)break;break}if(0<R&&R+r.cpBegin<r.cpEnd)z=Qe.a.createTextRange(r.node,r.cpBegin,r.cpBegin+R),r=Qe.a.createTextRange(r.node,r.cpBegin+R,r.cpEnd),this.rs.replaceTextRange(r,h[0]),this.rs.replaceTextRange(z,"");else if(0<R&&R+r.cpBegin===r.cpEnd)for(this.rs.replaceTextRange(b.start,h[0]),h=0;h<z.qa.length;h++){if(R=z.qa.J(h),R.cp===r.cpBegin){R.blob=null;break}}else t.AFrameworkApplication.TG?
(h=h.join(" "),this.rs.replaceTextRange(b.start,h)):this.rs.replaceTextRange(b.start,h[0])}this.hsd(b,Wa);let ub;this.Tdn((ub=new Ua.a,ub.add(b),ub));return!0}return!1}hsd(b,h){const r=this.rs.aHd(b.start.node,0<=b.start.cpBegin?b.start.cpBegin:0);if(!r)v.ULS.sendTraceTag(17585368,368,15,"Unable to get a ChP at starting Ip of Content Control");else if(xg.a.instance.J(10)){const z=this.$g.Cu(b.objectId);if(h){h=this.BC.Qx(b.start.node);let R=h.xh(ms.a5m);R||(R=h.eta(ms.$4m));R&&(this.mg.Wja(r.formatting),
this.mg.Ckb(r.formatting,R));z&&(b.cO=!0)}else z&&b.cO&&(this.eyn(b,r),b.cO=!1)}}eyn(b,h){b=this.$g.Cu(b.objectId);let r=null;b&&(r=b.ia(yc.a.ZBc,E.a.nil));this.mg.Wja(h.formatting);r&&!r.equals(E.a.nil)&&(b=this.Bi.value.Eb(r),h.formatting=b)}lJc(b){let h=!1;b=b.J_d;this.Wkm(b)&&(b=WordEditorIntl.WordEditorStrings.l_ContentControlPlaceholder,h=!0);return{returnValue:b,XTn:h}}eon(b,h=!0){this.Zca&&(h&&this.aon(b),this.ion(b))}fon(b){if(this.Zca&&(b=this.VP(b,b,4)))for(let h of b)this.ODa(h,!1)}NQm(b,
h){if(h&&!b.Pc&&(this.$g.X0b(),(b=b.Ob.paragraph.Lc.Eb(b.pe))&&b.anchor)){this.$g.jyh(b);b=this.q0.mxb(b,this.yx,this.Bi,this.$g,this.rs,this,this.Kpa,this.Zca,this.Eub);let r;this.bJi((r=new Ua.a,r.add(b),r))}}yzi(b,h){this.$g.X0b();b=this.$g.Cu(h.pe);const r=this.iT(b);if(r&&r.Rd()&&r.removeWhenEdited){const z=this.Hc.Rc(7);z.Db(b);this.ODa(r,!1);h.state=2;z.dispose()}}mAi(b,h){this.$g.X0b();b=this.$g.Cu(h.pe);this.sam(b)&&(b=b.ia(yc.a.Gy,0),this.ga&&(this.ga.Xb(Fb.a.j0f,2,b),ms.Qd.dQe()))}sam(b){return b&&
b.isConnected&&!b.ia(yc.a.J5,!1)?this.jbi(b):!1}jbi(b){b=this.q0.mxb(b,this.yx,this.Bi,this.$g,this.rs,this,this.Kpa,this.Zca,this.Eub);if(!b.Rd())return!1;if(b.Vf){if(b.mu.toString()===b.Iz.toString()){var h=this.$g.Cu(b.mu);if(!h)return v.ULS.shipAssertTag(22828291,368,!1,"Block content control is connected but its start node is null"),!1;if(12===h.type&&1===h.qa.length)return this.hbi(h.qa.J(0),b.objectId)}}else{h=b.start;if(!h)return v.ULS.shipAssertTag(22828292,368,!1,"Inline content control is connected but its start context is null"),
!1;if(h.cpBegin===h.cpEnd)return h=this.$g.Cu(b.mu).qa.ji(h.cpBegin),this.hbi(h,b.objectId)}return!1}hbi(b,h){b=b?b.Mb:null;if(!b)return!1;const r=b.rI(h,!0);return-1<r&&r+1<b.length&&b.J(r+1).pe.toString()===h.toString()}zkn(b){this.SDe.push(b)}i7i(b,h){if(void 0===b||null===b||b.contextId!==kc.a.Gd)return null;b=Qe.a.Uc(b.node,h?b.cpBegin:b.cpEnd);return 0<b.cpBegin&&b.cpBegin<ie.ParagraphReader.textLength(b.node)?this.$g.OPa(b):null}select(b,h){if(b&&!b.equals(E.a.nil)){var r=this.$g.Cu(b);if(r&&
55===r.type){r=this.iT(r);if(r.Vf)r=this.qjl(r);else{r=r.start;if(!r)return;r=this.kA.eo(r)}r&&r.length&&(this.sYi(r.Qa,b,h,!0,!0),this.sYi(r.Tc,b,h,!1,!1),this.ib.setSelection(r))}}}GDn(b,h){if(!Xd.SelectionEditor.xf(b)||b.Fb!==b.Ub)return!1;const r=b.Fb;return-1===r?!1:(b=this.Co.dYa(b.node,b.cpBegin,r,!h))&&h===b.Pc?(h=this.iT(b.contentControlNode),this.select(b.pe,!h.isEditable),!0):!1}qjl(b){var h=this.$g.cLa(b.mu,!0);b=this.$g.cLa(b.Iz,!1);if(!h||!b)return null;h=this.Bhl(Qe.a.create(h),Qe.a.create(b));
if(!h||!h.count)return null;b=new Ua.a;for(let r=0;r<h.count;r++){let z;if(12===h.J(r).type)z=r===h.count-1?Qe.a.createTextRange(h.J(r),0,ie.ParagraphReader.textLength(h.J(r))):Qe.a.create(h.J(r)),this.sh&&(z.Fb=this.sh.xq(z.node,!0),z.Ub=this.sh.xq(z.node,!1));else if(15===h.J(r).type)z=Mq.TableNodeContext.create(h.J(r));else continue;b.add(z)}return new tm.Selection(b.toArray(),!0)}qIn(b){if(b&&!b.equals(E.a.nil)&&(this.$g.X0b(),(b=this.$g.Cu(b))&&55===b.type&&b.isConnected)){var h=b.ia(yc.a.J5,
!1);b.setValue(yc.a.J5,!1);h&&this.tjn(b)}}tjn(b){var h,r;const z=null!==(r=this.sg.ir.get(null===(h=b.id)||void 0===h?void 0:h.toString()))&&void 0!==r?r:E.a.nil;z.equals(E.a.nil)||(h=this.$g.ala(z,!0))&&(b=this.rs.Bcf(h,b.id,!0))&&0<b.count&&(b=b.J(0),h=b.Ob,h.formatting=b.QP?b.QP.Yf(h):new zA.a(h,E.a.nil))}LMi(b){if(b=this.IOh(b))for(let h of b)h.cO=!1,this.ODa(h,!1)}Wml(b){const h=new Ua.a;if(b=this.IOh(b))for(let r of b)h.add(r.contentControlNode);return h}gon(b){if(b&&(11===b.type||14===b.type||
15===b.type||16===b.type)){var h=this.fb.en(b),r=this.fb.ZJ(b);if(this.sh&&h&&r){b=this.sh.xq(h,!0);const z=this.sh.xq(r,!1);h=Qe.a.create(h);r=Qe.a.create(r);h.Fb=b;r.Ub=z;if(b=this.rea(h,r,4))for(let R of b)this.ODa(R,!1)}}}Ehl(b){var h,r,z,R;const ba=null!==(r=this.sg.ir.get(null===(h=b.id)||void 0===h?void 0:h.toString()))&&void 0!==r?r:E.a.nil;b=null!==(R=this.sg.Bs.get(null===(z=b.id)||void 0===z?void 0:z.toString()))&&void 0!==R?R:E.a.nil;if(ba.equals(E.a.nil)||b.equals(E.a.nil))return new Ua.a;
z=this.$g.ala(ba,!0);R=this.$g.ala(b,!1);return z&&R?this.hT(Qe.a.create(z),Qe.a.create(R))||new Ua.a:new Ua.a}cLa(b,h){return this.$g.cLa(b,h)}Ief(b,h){if(b&&55===b.type&&(b=this.iT(b),b=h?b.start:b.end)){const r=Qe.a.Uc(b.node,h?b.hl:b.ut);r.Fb=r.Ub=(h?b.Fb:b.Ub)+(h?-1:1);return r}return null}$ml(b){return(b=this.iT(b))?b.start:null}sYi(b,h,r,z,R){if((b.contextId===kc.a.Gd||b.contextId===kc.a.Wc||b.contextId===kc.a.paragraph)&&(R=b.node.qa.ji(R?b.hl:b.ut))&&R.Mb)for(let ba=0;ba<R.Mb.length;ba++){const ta=
R.Mb.J(ba);if(ta.pe.equals(h)&&ta.Aq)if(z&&ta.Pc){b.Fb=r?ba:ba+1;break}else if(!z&&!ta.Pc){b.Ub=r?ba+1:ba;break}}}Tdn(b){for(let h=0;h<this.dXg.length;++h)(0,this.dXg[h])(this,new Tz(b))}bJi(b){for(let h=0;h<this.SDe.length;++h)(0,this.SDe[h])(this,new Tz(b))}ion(b){b=Qe.a.create(b);if(b=this.VP(b,b,4))for(let h of b)h.Vf||this.ODa(h,!1)}aon(b){if(b=b.g2b())for(let r=0;r<b.count;r++){var h=this.$g.Cu(b.J(0));h=this.q0.mxb(h,this.yx,this.Bi,this.$g,this.rs,this,this.Kpa,this.Zca,this.Eub);this.ODa(h)}}Dhl(b){return this.hT(b,
null)}wNc(b,h,r=null){let z=!0;try{if(!b)return v.ULS.sendTraceTag(529106507,368,50,"Content Control is null"),!1;v.ULS.sendTraceTag(529106508,368,50,String.format("Content control change type: {0}, isSupported: {1}, isDeletable: {2}",h,b.isSupported,b.afa));if(!Nr.a.fE&&this.$xa&&xg.a.instance.J(3)&&this.$xa.hX(this.yx.value))return v.ULS.sendTraceTag(529106509,368,50,"Content Control Change Invalid because track changes is enabled"),!1;if(this.nhm(h)&&this.ohm(h)&&!this.tam(b))return!1;if(!r){const ta=
this.yDl(b);ta&&(r=new Ua.a,r.add(ta))}var R=this.$g.KVh(b.start.node);const ba=this.$g.KVh(b.end.node);if(R&&ba&&!R.equals(ba)||!R&&ba||R&&!ba)return!1;R=!0;if(r&&0<r.count){if(!r.J(0).isSupported)return!1;R=r.J(0).isEditable}switch(h){case 0:z=this.Z8l(b,R);break;case 1:z=(this.M$||!this.nrf(b))&&b.isSupported&&b.isEditable&&this.Fdh(b)&&this.kbi(b);t.AFrameworkApplication.TG||(z=z&&!this.c4h(b.start,b.end));break;case 2:const ta=b.gmm?!0:b.isSupported;z=(this.M$||!this.nrf(b))&&ta&&b.afa&&R;v.ULS.sendTraceTag(529106510,
368,50,"True");break;case 3:z=b.isSupported&&b.afa&&R&&this.Fdh(b)&&this.kbi(b)&&!this.c4h(b.start,b.end)}}catch(ba){v.ULS.sendTraceTag(17413646,368,15,"Exception was caught in IsContentControlValid. OperationType: "+h+", Exception: "+ba),z=!1}return z}ohm(b){t.AFrameworkApplication.TG&&t.AFrameworkApplication.Hf("7gbeh287;7cff7940");return!(t.AFrameworkApplication.TG&&t.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.skipNestedCCCheck",!1)&&1===b)}nhm(b){return!(this.WW&&
(!b||2===b||3===b))}Z8l(b,h){let r=!0;if(!this.M$&&this.nrf(b))r=!1;else if(this.WW)this.WW?b.Vf||Xd.SelectionEditor.du(b.start)||b.start.contextId===kc.a.endOfParagraph?b.Vf&&(b.start.contextId!==kc.a.paragraph&&b.start.contextId!==kc.a.endOfParagraph||b.end.contextId!==kc.a.paragraph&&b.end.contextId!==kc.a.endOfParagraph)&&(r=!1):r=!1:r=h?this.$9l(b):!1;else if(!(b.Vf||-1!==b.start.cpBegin&&-1!==b.end.cpEnd&&b.start.equals(b.end)))r=!1;else if(b.Vf&&(b.start.contextId!==kc.a.paragraph||b.end.contextId!==
kc.a.paragraph||b.start.equals(b.end)&&!ie.ParagraphReader.textLength(b.start.node)))r=!1;else if(b.start.contextId===kc.a.Wc||b.end.contextId===kc.a.Wc||b.start.contextId===kc.a.endOfParagraph||b.end.contextId===kc.a.endOfParagraph)r=!1;return r}IOh(b){if(!b||!b.length)return null;const h=b[0];b=b[b.length-1];this.sh&&(this.fb.gm(h)&&12===h.node.type&&(h.Fb=this.sh.xq(h.node,!0)),this.fb.gm(b)&&12===b.node.type&&(b.Ub=this.sh.xq(b.node,!1)));return this.rea(h,b,4)}Fdh(b){b=b.Zaf();for(let h of b)if(!h.isSupported||
!h.afa)return!1;return!0}tam(b){if(this.vdj(b.start,b.end).returnValue)return!1;const h=this.VP(b.start,b.end,2);if(!h)return!0;for(let r of h)if(!r.objectId.equals(b.objectId)&&(r.Vf&&(r.start.node.id.equals(b.start.node.id)&&(-1===b.start.cpBegin||!b.start.cpBegin)||r.end.node.id.equals(b.end.node.id)&&(-1===b.end.cpEnd||b.end.cpEnd===ie.ParagraphReader.textLength(r.end.node)))||!r.Vf&&(b.start.node.id.equals(r.start.node.id)&&(-1!==b.start.cpBegin?r.start.cpBegin===b.start.cpBegin:!r.start.cpBegin)||
b.end.node.id.equals(r.end.node.id)&&(-1!==b.end.cpEnd?r.end.cpEnd===b.end.cpEnd:r.end.cpEnd===ie.ParagraphReader.textLength(b.end.node)))))return!1;return!0}kbi(b){if(b.Vf){var h=this.$g.Cu(b.mu),r=this.$g.Cu(b.Iz);let z=null;if(12===h.type&&12===r.type){h=this.$g.Y3b(h);h=this.$g.Cu(h);r=this.$g.Y3b(r);r=this.$g.Cu(r);if(!h||!r)return!1;16===h.type&&16===r.type&&h.id.equals(r.id)&&(z=h)}b=this.hT(b.start,b.end);if(!b.count)return!1;for(let R of b)if(b=this.$g.Y3b(R),b=this.$g.Cu(b),!b||!(16!==b.type||
z&&b.id.equals(z.id)))return!1}return!0}nrf(b){return b.Vf?!1:(b=b.start.node)?!b.ia(yc.a.y6b,!0):!0}$9l(b){if(b.Vf){var h=this.$g.Cu(b.mu);b=this.$g.Cu(b.Iz);if(Gi.TableCellReader.Zta(h)||Gi.TableCellReader.Zta(b)||Jm.a.rma(h)||Jm.a.rma(b))return!1;h=this.$g.Y3b(h);h=this.$g.Cu(h);b=this.$g.Y3b(b);b=this.$g.Cu(b);if(!h||!b||(16===h.type||16===b.type)&&!h.id.equals(b.id))return!1}return!0}yDl(b){if(!b)return null;b=this.$g.Cu(b.objectId);if(!b)return null;b=b.ia(yc.a.I5,E.a.nil);return b.equals(E.a.nil)?
null:(b=this.$g.Cu(b))?this.iT(b):null}OLh(b){return this.hT(null,b)}Q0n(b){return(b||"").split(RegExp("\r\n|\r|\n"))}Wkm(b){return b&&""!==b?!1:!0}LSh(b,h,r){h=h.qa.ji(r?0:h.characterData.length);if(!h)return v.ULS.sendTraceTag(21018849,368,15,"Unable to get a ChP at expected cp, which should not happen"),0;if(!h.Mb||!h.Mb.length)return 0;if(!b)return r?0:h.Mb.length;for(let z=0;z<h.Mb.length;z++){const R=h.Mb.J(z);if(E.a.Fp(R.pe,b)&&R.Pc===r)return r?z+1:z}return r?0:h.Mb.length}crk(b,h){var r=
b.node,z=h.node,R=b.contextId===kc.a.paragraph?0:b.cpBegin,ba=h.contextId===kc.a.paragraph?ie.ParagraphReader.textLength(z):h.cpEnd;r=this.Co.d6(r,R,b.Fb);z=this.Co.d6(z,ba,h.Ub);ba=!r||!r.count;R=!z||!z.count;if(ba&&R)return{returnValue:!0,start:b,end:h};if(ba)return{returnValue:this.Xbe(b,z.J(z.count-1).pe,!0),start:b,end:h};if(R)return{returnValue:this.Xbe(h,r.J(r.count-1).pe,!1),start:b,end:h};if(r.count===z.count)return r=r.J(r.count-1),z=z.J(z.count-1),{returnValue:r.pe.equals(z.pe),start:b,
end:h};r=(ba=r.count<z.count)?z.J(z.count-1):r.J(r.count-1);return{returnValue:ba?this.Xbe(b,r.pe,!0):this.Xbe(h,r.pe,!1),start:b,end:h}}Xbe(b,h,r){var z=b.node;let R;if(r){R=b.contextId===kc.a.paragraph?0:b.cpBegin;var ba=b.Fb}else R=b.contextId===kc.a.paragraph?ie.ParagraphReader.textLength(z):b.cpEnd,ba=b.Ub;z=z.qa.ji(R);if(-1===ba||!z||!z.Mb||!z.Mb.length)return!1;z=z.Mb;if(r)for(r=ba;r<z.length;r++){ba=z.J(r);if(!ba.Pc)break;if(ba.pe.equals(h))return b.Fb=r+1,!0}else for(r=ba-1;0<=r;r--){ba=
z.J(r);if(ba.Pc)break;if(ba.pe.equals(h))return b.Ub=r,!0}return!1}mcm(b,h){return this.Kek(b,h)&&b.Fb===b.Ub&&(b.contextId===kc.a.Wc||b.contextId===kc.a.paragraph&&!b.node.characterData.length)}Kek(b,h){return b.equals(h)&&b.Fb===h.Fb&&b.Ub===h.Ub}bij(b,h){var r,z,R,ba,ta,Wa;if(b&&h.Vf){var ub=null!==(z=this.sg.ir.get(null===(r=b.id)||void 0===r?void 0:r.toString()))&&void 0!==z?z:E.a.nil;r=this.$g.ala(h.mu,!0);ub.equals(r?r.id:null)&&this.sg.ir.set(null===(R=b.id)||void 0===R?void 0:R.toString(),
h.objectId);R=null!==(ta=this.sg.Bs.get(null===(ba=b.id)||void 0===ba?void 0:ba.toString()))&&void 0!==ta?ta:E.a.nil;ba=this.$g.ala(h.Iz,!1);R.equals(ba?ba.id:null)&&this.sg.Bs.set(null===(Wa=b.id)||void 0===Wa?void 0:Wa.toString(),h.objectId)}}static get Qd(){return null!=ms.Yrg?ms.Yrg:ms.Yrg=Sa.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance}static vAb(b){return h=>h.type===b}static pwl(){return b=>12===b.type||15===b.type}static lih(b,h){return b.Qe===h.aui||b.parentNode&&
h.yDi(b.parentNode)?!1:!0}}ms.a5m="Placeholder Text";ms.$4m="Placeholder Text";Object(n.a)(ms,"ContentControlOperator",null,[368,9,369]);class Uz{constructor(b,h,r){this.Xc=b;this.yx=h;this.iTb=r}W0h(b){const h=this.twl();return h&&b&&this.EQl(h,b)?this.cPl(h):null}EQl(b,h){if(!b)return!1;do{const r=b.currentNode;if(!r)break;if(r.ia(yc.a.BQl,null)===h)return!0}while(b.vf(29));return!1}cPl(b){var h=b.Rb(1);b.mc();b=b.oE(1);if(!h||!b)return null;h=Hf.SelectionFactory.hvh(h,b);b=Xd.SelectionEditor.Pj(h,
!1,!1);return Hf.SelectionFactory.XC(h,b.Tc)}twl(){const b=this.Xc.Dk();b.set(this.yx.value);this.iTb.zQ(b);return b.Rb(28)&&b.Rb(29)?b:null}}Object(n.a)(Uz,"GlossaryNavigator",null,[367]);class zB{constructor(b,h,r,z,R,ba){this.rs=b;this.$g=h;this.qm=r;this.fb=z;this.wh=R;this.Zca=ba}e_c(b,h,r){if(!this.Zca)return 1;if(!({tableNode:R}=this.Ttf(b)).returnValue||!this.wh.Nhi(R,h)||this.IMi(b,h))return 2;var z=this.wh.PLh(h);var R=z.J(0).g2b();R&&R.count||(R=new Ua.a,R.add(b.objectId));b=this.$g.xyh(z);
r=r.split("\n");h=Object(la.a)(Nd.GraphIterator,this.$g.Yef(h));h=this.$g.Q8g(h,b,r.length);for(b=0;b<h.count;++b){z=h.J(b);this.rs.replaceTextRange(Qe.a.createTextRange(z,0,0),r[b]);for(let ba=0;ba<R.count;++ba)this.rs.lra(z,R.J(ba),0,!0,!0),this.rs.lra(z,R.J(R.count-ba-1),z.characterData.length,!0,!1)}return 0}IMi(b,h){if(!this.Zca)return 1;let r;if(!({tableNode:r}=this.Ttf(b)).returnValue||!this.wh.Nhi(r,h))return 2;h=this.wh.PLh(h);if(0<h.count&&(h=this.qm.VP(Qe.a.create(h.J(0)),Qe.a.create(h.J(h.count-
1)),2)))for(let z of h)if(z.id!==b.id&&!this.qm.ODa(z,!0))return 2;return 0}N7b(b){if(!this.Zca||!({tableNode:r}=this.Ttf(b)).returnValue)return!1;b=b.Zaf();for(var h of b)if(!h.afa||!h.isSupported)return!1;if(this.wh.jam(r))return!1;var r=Object(la.a)(Nd.GraphIterator,this.$g.Yef(r));h=new Ua.a;this.fb.$db(r,!0,!1,h);for(let z of h)if(0<z.ia(yc.a.dzb,0)||this.fb.GYa(z).zw)return!1;return!0}Ttf(b){let h=null;return b&&b.mu.toString()===b.Iz.toString()&&b.Rd()&&b.isEditable&&b.isSupported?(h=this.$g.Cu(b.mu))&&
14===h.type?{returnValue:!0,tableNode:h}:{returnValue:!1,tableNode:null}:{returnValue:!1,tableNode:h}}}Object(n.a)(zB,"TableContentControlEditor",null,[366]);class AB{jam(b){let h=!1;const r=new Nd.GraphIterator;r.set(b);Ke.forEachCellInTable(r,z=>{if(!Gi.TableCellReader.qg(z)){let R=uf.OutlineNavigator.P6(z);for(;R;){if(vg.OutlineElementReader.WKd(z))return h=!0,!1;R=z.Wi(1)}}return!0});return h}Nhi(b,h){const r=new Nd.GraphIterator;r.set(h);return Gi.TableCellReader.Zta(h)&&r.Bb(14)&&r.kd(14).id===
b.id?!0:!1}PLh(b){const h=new Ua.a,r=new Nd.GraphIterator;r.set(b);b=new Ua.a;ie.ParagraphReader.$db(r,!0,!1,b);for(let z of b)h.add(z);return h}}Object(n.a)(AB,"TableReader",null,[356]);class ky{constructor(){this.qm=null}get name(){return"WordEditor.ContentControl"}init(){t.AFrameworkApplication.K.$("WordEditorContentControlWriteIsEnabled")&&(xB.a.HOa(Object(u.a)(Sa.a.instance.resolve("WordEditor.ContentControl.ContentControlOperator"),Sa.a.instance.resolve("WordEditor.ContentControl.ContentControlOperator").NQm,
"onContentControlRangeChanged")),this.qm=Sa.a.instance.Pa("WordEditor.ContentControl.IContentControlOperator"),Nr.a.jCa&&Sa.a.instance.resolve("WordEditor.ContentControl.ContentControlCCP").init())}dispose(){this.qm&&(this.qm.dispose(),this.qm=null)}yc(b){b.ha("WordEditor.ContentControl.Perf.IPerfLogger",()=>new UC.a(Ed.a.lf)).singleInstance();b.ha("WordEditor.ContentControl.ContentControlFactory",()=>new RA(Sa.a.instance.resolve("Box4.ContentControlParagraphMapping"))).as("WordEditor.ContentControl.IContentControlFactory").singleInstance();
b.ha("WordEditor.ContentControlNodeFactory",()=>new Uy(Sa.a.instance.Za("Box4.ContentControlConfigSettings"),Sa.a.instance.Za("Box4.ContentControl.IContentControlOperator"))).singleInstance();b.ha("WordEditor.ContentControl.ContentControlGraphManager",()=>new Fw(new De.a(()=>vb.App.xa.jb.Yc),new De.a(()=>vb.App.xa.jb.Yc.zd),new sn.a,ml.PageNavigator.instance,Sa.a.instance.resolve("WordEditor.ContentControlNodeFactory"),Sa.a.instance.resolve("Box4.IOutlineEditor"),Sa.a.instance.resolve("Box4.IOutlineElementEditor"),
Sa.a.instance.resolve("Box4.IParagraphReader"),Sa.a.instance.resolve("WordEditor.IParagraphSplitHelper"),Sa.a.instance.Za("Box4.ContentControlConfigSettings"),Sa.a.instance.resolve("Box4.ContentControlParagraphMapping"))).as("WordEditor.ContentControl.IContentControlGraphManager").singleInstance();b.ha("WordEditor.ContentControl.GlossaryNavigator",()=>new Uz(new sn.a,new De.a(()=>vb.App.xa.jb.Yc),ml.PageNavigator.instance)).as("WordEditor.ContentControl.IGlossaryNavigator").singleInstance();b.ha("WordEditor.ContentControl.ContentControlOperator",
()=>new ms(new De.a(()=>vb.App.xa.jb.Yc),new De.a(()=>vb.App.xa.jb.Yc.zd),Sa.a.instance.resolve("WordEditor.ContentControl.IContentControlGraphManager"),Sa.a.instance.resolve("WordEditor.ContentControl.ContentControlChpManager"),Sa.a.instance.resolve("WordEditor.ContentControl.IContentControlFactory"),di.a.instance,Sa.a.instance.resolve("Box4.ISelectionFactory"),ne.PageReader.instance,Sa.a.instance.resolve("Box4.IFormattingEditor"),Sa.a.instance.resolve("Box4.Styles.IWACStyleReader"),t.AFrameworkApplication.K.$("WordEditorContentControlWriteIsEnabled"),
Sa.a.instance.Pa("Box4.IContentControlDataChangedManager"),t.AFrameworkApplication.ya,Sa.a.instance.resolve("WordEditor.ContentControl.IGlossaryNavigator"),t.AFrameworkApplication.K.$("WordEditorContentControlCustomizedPlaceholderIsEnabled"),Sa.a.instance.resolve("Box4.IContentControlChpHelper"),Sa.a.instance.Za("Box4.ContentControlConfigSettings"),Sa.a.instance.Pa("Box4.IContentControlReader"),Sa.a.instance.resolve("Box4.IParagraphReader"),Sa.a.instance.resolve("Box4.Graph.IGraphTransactionFactory"),
Sa.a.instance.Za("Box4.Actors.IVirtualSelectionMerger"),Sa.a.instance.resolve("Box4.IFeatureHelper"),Sa.a.instance.resolve("Box4.ContentControlParagraphMapping"),Sa.a.instance.resolve("Box4.TrackChange.ITrackChangeEditor"))).as("Box4.ContentControl.IContentControlOperator").as("WordEditor.ContentControl.IContentControlOperator").singleInstance();b.ha("WordEditor.ContentControl.ContentControlManager",()=>new Wv(new De.a(()=>vb.App.xa.jb.Yc),new De.a(()=>vb.App.xa.jb.Yc.zd),Sa.a.instance.resolve("WordEditor.ContentControl.IContentControlGraphManager"),
Sa.a.instance.resolve("WordEditor.ContentControl.IContentControlChpManager"),Sa.a.instance.resolve("WordEditor.ContentControl.IContentControlOperator"),Sa.a.instance.resolve("WordEditor.ContentControl.IContentControlFactory"),Sa.a.instance.resolve("WordEditor.ContentControl.IGlossaryNavigator"),Sa.a.instance.Za("Box4.ContentControlConfigSettings"),Sa.a.instance.resolve("Box4.IContentControlChpHelper"))).as("WordEditor.ContentControl.IContentControlManager").singleInstance();b.ha("WordEditor.ContentControl.ContentControlChpManager",
()=>new Sz(Sa.a.instance.resolve("Box4.ICharacterPropertiesEditor"),Sa.a.instance.Za("Box4.ContentControlConfigSettings"),Sa.a.instance.resolve("Box4.IParagraphReader"),Sa.a.instance.resolve("Box4.ContentControlParagraphMapping"))).as("WordEditor.ContentControl.IContentControlChpManager").singleInstance();b.ha("WordEditor.ContentControl.TableContentControlEditor",()=>new zB(Sa.a.instance.resolve("WordEditor.ContentControl.IContentControlChpManager"),Sa.a.instance.resolve("WordEditor.ContentControl.IContentControlGraphManager"),
Sa.a.instance.resolve("WordEditor.ContentControl.IContentControlOperator"),Sa.a.instance.resolve("Box4.IParagraphReader"),new AB,t.AFrameworkApplication.K.$("WordEditorContentControlWriteIsEnabled"))).as("WordEditor.ContentControl.ITableContentControlEditor").singleInstance();t.AFrameworkApplication.K.$("WordEditorContentControlInlineBlockConversionIsEnabled")&&b.ha("Box4.ContentControlConverter",()=>new yB(b.resolve("Box4.IParagraphReader"),b.resolve("Box4.IContentControlChpHelper"),b.resolve("Box4.IContentControlReader"),
b.resolve("Box4.IFeatureHelper"),b.resolve("Box4.ContentControlParagraphMapping"))).as("Box4.IContentControlConverter").singleInstance();Nr.a.jCa&&b.ha("WordEditor.ContentControl.ContentControlCCP",()=>new sx(b.resolve("WordEditor.ContentControl.ContentControlOperator"),b.resolve("WordEditor.ContentControl.IContentControlChpManager"),b.resolve("WordEditor.ContentControl.IContentControlGraphManager"),b.resolve("WordEditor.ContentControl.Perf.IPerfLogger"),b.resolve("Box4.TrackChange.ITrackChangeEditor"))).singleInstance()}static main(){O.a.instance.Oc(new ky)}}
Object(n.a)(ky,"ContentControlPackage",null,[1,2]);var Vz=d(1392),f=d(1697);class w extends Sys.EventArgs{constructor(b,h,r){super();this.definition=b;this.source=h;this.zBk=r}}Object(n.a)(w,"MenuDidCloseEventArgs",Sys.EventArgs,[]);class D extends Sys.EventArgs{constructor(b,h){super();this.definition=b;this.source=h}}Object(n.a)(D,"MenuDidOpenEventArgs",Sys.EventArgs,[]);class Z{constructor(b,h,r,z,R,ba,ta=!1,Wa=null,ub=null,Ib=null,$b=!1,fc=null,Kc=!1,ed=!0,Jd=null,ge=!1,qe=9){this.target=this.container=
this.menu=null;this.isDismissed=!1;this.ATc=this.kTc=this.WFh=this.onScroll=this.onResize=this.$Z=this.Dua=this.gDa=this.documentElement=this.Qna=this.editingElement=null;this.isFocused=!1;this.Ezd=null;this.$Kf=this.zqf=!1;this.ede=null;this.i0d=0;this.paragraphNode=b;this.cpBegin=h;this.cpEnd=r;this.definition=z;this.p0j=R;this.XMa=ba;this.tKa=ta;this.g4i=Wa;this.Cka=ub;this.hostServices=Ib;this.PWn=$b;this.mCi=fc;this.t4i=Kc;this.lXk=ed;this.WFh=Jd;this.showDictationCommandUx=ge;this.source=qe}}
Object(n.a)(Z,"UxManagerState",null,[]);var na=d(1578);class c{constructor(b){this.contextualIntentInvocationSource=9;this.contextualIntentInvocationSource=b}}Object(n.a)(c,"UxManagerMenuActionTelemetryData",null,[]);class m{constructor(b,h,r,z,R,ba,ta,Wa,ub,Ib){this.Wb=b;this.ib=h;this.iz=r;this.Zc=z;this.ke=R;this.Hb=ba;this.zi=ta;this.Kj=Wa;this.hS=ub;this.hOb=Ib;this.tHe=!1;this._state=this.ALg=null;this.shouldIgnoreFocusEvent=$b=>{var fc;return this.Zc.xd.Lv&&!this.Zc.xd.aO&&$b===(null===(fc=
this.Zc.editingView)||void 0===fc?void 0:fc.editingElement)};this.sa=new Te.a;this.Jvc=new Lc.a;this.drd(($b,fc)=>{m.Oym(r,fc.definition,fc.source)});this.b$g(($b,fc)=>{m.Nym(r,fc.definition,fc.source,fc.zBk)});this.Wb.re(m.pDd).UL=!0}drd(b){this.sa.addHandler(m.Mzf,b)}GSf(b){this.sa.removeHandler(m.Mzf,b)}qen(b,h){this.sa.raiseEvent(m.Mzf,new D(b,h))}b$g(b){this.sa.addHandler(m.Lzf,b)}wrn(b){this.sa.removeHandler(m.Lzf,b)}oen(b,h,r){this.sa.raiseEvent(m.Lzf,new w(b,h,r))}wmo(b){if(!b.isDismissed&&
b.Qna){var h=na.c(b.paragraphNode,b.cpBegin,b.cpEnd);if(h&&h.length){h=na.b(h);var r=Ed.a.getElementBounds(b.Qna);h.width||h.height?h.x+h.width<r.x||h.x>r.x+r.width||h.y+h.height<r.y||h.y>r.y+r.height?this.dismiss():(r=b.target,r.style.left=h.x+"px",r.style.top=h.y+"px",r.style.width=h.width+"px",r.style.height=h.height+"px",b.menu.updatePosition()):(v.ULS.sendTraceTag(50968328,341,15,"Unable to obtain valid updated anchor for UX"),this.dismiss())}else v.ULS.sendTraceTag(50968327,341,15,"Unable to obtain updated anchor for UX"),
this.dismiss()}}TIi(b){b.isDismissed||b.ede||(b.ede=new Ic.a(2,1,1,()=>{b.ede=null;this.wmo(b)},147),this.Hb.$b(b.ede))}gDa(b,h){!b.isDismissed&&b.lXk&&0<h.qU.length&&(this.dismiss(),v.ULS.sendTraceTag(594363728,341,50,"Menu dismissed from selection change (possibly typing)"))}jak(b){return!!b&&b.id===m.t0j}Dua(b,h){if(b.isDismissed||!h||!h.Ib)return!1;h=h.Ib;const r=h.keyCode,z=!b.isFocused&&!!b.menu,R=h.altKey||h.ctrlKey||h.shiftKey;let ba=!1;r===wb.a.X_?(this.dismiss(),v.ULS.sendTraceTag(594363727,
341,50,"Dismiss menu from keyboard"),ba=!0):r!==wb.a.es&&r!==wb.a.mx||!z||R||!this.jak(b.definition)?r!==wb.a.tMb&&r!==wb.a.v4c||!z||R||(this.kOf(b),b.menu?(b.menu.focus(),ba=!0,v.ULS.sendTraceTag(594363725,341,50,"Focus menu from keyboard")):v.ULS.sendTraceTag(576582676,341,50,"Began focus menu from keyboard but dismissed before completion")):(b.menu.executeDefaultAction(),v.ULS.sendTraceTag(594363726,341,50,"Default action from keyboard"),ba=!0);ba&&(h.preventDefault(),h.stopPropagation());return ba}kTc(b,
h){if(b.isDismissed)return!1;b.menu.invokeBadgeId(h);v.ULS.sendTraceTag(526463882,341,50,"Badge ID action from dictation correction voice command");return!0}ATc(b,h){if(b.isDismissed)return!1;b.menu.executeActionFromString(h);v.ULS.sendTraceTag(526463883,341,50,"Execute action from dictation correction voice command as string");return!0}$Z(b,h){if(b.isDismissed||!h||!h.Ib)return!1;const r=b.target;b=b.menu.getElementBounds();var z=h.Ib;h=z.clientX;z=z.clientY;r&&m.YEi(h,z,Ed.a.getElementBounds(r),
16)||b&&m.YEi(h,z,m.Qjk(b),4)||this.dismiss();return!1}$Qn(b){var h=na.c(b.paragraphNode,b.cpBegin,b.cpEnd);if(!h||!h.length)return!1;h=na.a(h,"OfficeContextualTarget");if(!h)return!1;b.container=m.CCc();b.target=h;b.editingElement=this.Zc.editingView.editingElement;b.Qna=this.Zc.xd.container;b.documentElement=document.documentElement;b.gDa=(r,z)=>{this.gDa(b,z)};b.Dua=r=>this.Dua(b,r);b.$Z=r=>this.$Z(b,r);b.onScroll=()=>{this.TIi(b)};b.onResize=()=>{this.TIi(b)};b.showDictationCommandUx&&(b.kTc=
r=>this.kTc(b,r),b.ATc=r=>this.ATc(b,r),this.hOb&&this.hOb.execute(r=>{r.DMn(b.kTc);r.FMn(b.ATc)}));document.body.appendChild(b.container);document.body.appendChild(b.target);this.ib.oB(b.gDa);this.zi.o1(b.onResize);this.ke.mb(jb.a.WH,b.editingElement,b.Dua);b.tKa&&this.Kj.mb(jb.a.qaa,b.documentElement,b.$Z);Bf.a.addHandler(b.Qna,"scroll",b.onScroll);b.XMa||this.kOf(b);return!0}tBb(b,h){const r=!!b.menu;this.oen(b.definition,b.source,h);b.container&&document.body.removeChild(b.container);b.target&&
document.body.removeChild(b.target);b.isFocused&&this.Wb.og.name===m.pDd&&this.Wb.NQ(m.pDd);b.gDa&&this.ib.uga(b.gDa);b.Dua&&b.editingElement&&this.ke.sc(jb.a.WH,b.editingElement,b.Dua);this.hOb&&this.hOb.execute(z=>{b.showDictationCommandUx&&(z.Hwn(),z.Iwn());z.GZi(!1,b.showDictationCommandUx)});b.$Z&&b.documentElement&&b.tKa&&this.Kj.sc(jb.a.qaa,b.documentElement,b.$Z);b.onScroll&&b.Qna&&Bf.a.removeHandler(b.Qna,"scroll",b.onScroll);b.onResize&&this.zi.tga(b.onResize);b.menu=null;b.container=null;
b.target=null;b.isDismissed=!0;b.editingElement=null;b.documentElement=null;b.Qna=null;b.gDa=null;b.Dua=null;b.$Z=null;b.onScroll=null;b.onResize=null;b.kTc=null;b.ATc=null;r&&b.Cka&&(b.zqf?b.$Kf=!0:b.Cka(b.Ezd))}$Ya(b,h){var r;if(!h)return!1;switch(h.actionType){case La.b.Toggle:if(h.objectFulfillment===m.D9n)return this.tHe=!this.tHe,this.G8f(),this.bEc(b),!0;if(h.objectFulfillment===m.H9n)return{value:r}=this.Jvc.Dc(h.suggestionGroup.type,!1),this.Jvc.Z(h.suggestionGroup.type,!r),this.bEc(b),!0;
break;case La.b.GiveFeedback:if(f.a.wbm(null===(r=h.suggestionGroup)||void 0===r?void 0:r.type))break;this.focus();this.G8f();this.bEc(b);return!0;case La.b.RevealSuggestions:this.bEc(b)}b.zqf=!0;h=b.p0j.executeAction(h,b.paragraphNode,b.cpBegin,b.cpEnd);b.zqf=!1;h&&this.bEc(b);b.$Kf&&(b.$Kf=!1,b.Cka(b.Ezd),b.Ezd=null);return h}bEc(b){b.$Z&&b.documentElement&&b.tKa&&(this.Kj.sc(jb.a.qaa,b.documentElement,b.$Z),b.tKa=!1)}KUn(b,h){return!(0<=b.positionInSet&&0<b.setSize)&&!h}oej(b){var h;if(this.$Qn(b)){var r=
1;t.AFrameworkApplication.K.$("RenderMultipleSuggestionGroupsInBranfordIsEnabled")&&(r=3);var z=!1;0<(null===(h=b.definition.suggestionGroups)||void 0===h?void 0:h.length)&&(z=b.definition.suggestionGroups[0].type,z=this.Jvc.xb(z)?this.Jvc.J(z):b.PWn);h=!1;t.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.FooterIconsInContextualCardIsEnabled",!1)&&(h=!0);const R=t.AFrameworkApplication.ya;r={containerElement:b.container,targetElement:b.target,definition:b.definition,onAction:ba=>
this.$Ya(b,ba),onDismiss:ba=>{this.tBb(b,ba)},openCustomDictionaryDialog:()=>R.processAction(Oa.a.W1e,2),keepCurrentFocus:b.XMa,preventDismissOnScroll:!0,preventDismissOnResize:!0,showSnippet:this.tHe,showDescription:z,showEditorButton:b.t4i,showEditorBranding:this.KUn(b.definition,b.t4i),hostServices:b.hostServices,maxSuggestionGroupNumber:r,renderFooterIcons:h,shouldIgnoreFocusEvent:this.shouldIgnoreFocusEvent,keyboardHandlerTarget:b.WFh,showDictationCommandUx:b.showDictationCommandUx,editingElement:b.editingElement};
b.mCi&&b.mCi(r);this.iz.createContextualUi(r).then(ba=>{this.qen(b.definition,b.source);b.menu=ba;b.g4i&&b.g4i();this.hOb&&this.hOb.execute(ta=>ta.GZi(!0,b.showDictationCommandUx))}).catch(ba=>{this.tBb(b,{eBo:Vz.a.Unknown});v.ULS.sendTraceTag(50631187,341,10,"Failed to show menu. Error: {0}",ba)});0<b.i0d&&v.ULS.sendTraceTag(50968329,341,50,"Needed {0} tries to obtain updated anchor for UX",b.i0d)}else 5<++b.i0d?(v.ULS.sendTraceTag(50968330,341,15,"Unable to obtain initial anchor for UX after maximum tries -- giving up"),
this.dismiss()):this.Hb.$b(new Ic.a(2,1,Math.pow(3,b.i0d),()=>{b.isDismissed||this.oej(b)},146))}get bO(){return!!this._state&&!this._state.isDismissed}set R6d(b){this.ALg=b}get igm(){return this.ALg}lhi(b){let h=!1;({value:h}=this.Jvc.Dc(b,!1));return h}d8f(b,h){this.bO&&(this._state.cpBegin=b,this._state.cpEnd=h)}get definition(){return this.bO?this._state.definition:null}set definition(b){this.bO&&(this._state.definition=b,this._state.menu&&this._state.menu.setDefinition(b))}focus(){this.bO&&this._state.menu&&
(this._state.isFocused||this.kOf(this._state),this._state.menu.focus())}G8f(){this.bO&&this._state.menu&&this._state.menu.updatePosition()}kOf(b){this.Wb.uK(m.pDd,!1);b.isFocused=!0}c3a(b,h,r,z,R,ba=null,ta=null,Wa=null,ub=!1,Ib=null,$b=!1,fc=!0,Kc=null,ed=!1,Jd=9){if(!h||this._state&&!this._state.isDismissed)return!1;let ge,qe;if(!({paragraphNode:qe,start:b,end:ge}=m.Bbo(b)).returnValue)return!1;this._state=new Z(qe,b,ge,h,r,z,R,ba,ta,Wa,ub,Ib,$b,fc,Kc,ed,Jd);this.oej(this._state);return!0}z6d(){this._state&&
(this._state.Ezd=!0)}dismiss(){var b;this._state&&(this._state.isDismissed=!0,null===(b=this._state.menu)||void 0===b?void 0:b.dismiss())}static Oym(b,h,r){r=new c(r);b.logAction({actionType:La.b.SessionStart,engagement:La.a.Try,objectName:m.W$i,objectId:h.id,data:r});if(h.suggestionGroups)for(let z of h.suggestionGroups)b.logAction({actionType:La.b.Presented,engagement:La.a.See,objectName:z.type,objectId:z.id,data:r})}static Nym(b,h,r,z){r=new c(r);b.logAction({actionType:La.b.SessionEnd,engagement:La.a.None,
objectName:m.W$i,objectId:h.id,data:r},z)}static CCc(){const b=document.createElement("div");b.id="OfficeContextualContainer";return b}static Qjk(b){return new Sys.UI.Bounds(b.left,b.top,b.width,b.height)}static YEi(b,h,r,z){const R=r.y-z,ba=r.x+r.width+z,ta=r.y+r.height+z;return r.x-z<=b&&b<=ba&&R<=h&&h<=ta}static Bbo(b){let h,r;if(!b||!ie.ParagraphReader.nc(b.node)||b.contextId!==kc.a.Wc&&b.contextId!==kc.a.Gd&&b.contextId!==kc.a.paragraph)return{returnValue:!1,paragraphNode:null,start:-1,end:-1};
r=b.node;b.contextId!==kc.a.paragraph?(h=b.cpBegin,b=b.cpEnd):(h=0,b=r.characterData.length);return{returnValue:!0,paragraphNode:r,start:h,end:b}}kRc(){this.hS&&this.hS.execute(b=>{b.logActivity("WordWebEditorSeen",null)})}}m.t0j="ActionSet";m.W$i="IntentGroup";m.pDd="CanvasContextualUxReact";m.D9n="Context";m.H9n="Description";m.Mzf="MenuDidOpen";m.Lzf="MenuDidClose";Object(n.a)(m,"UxManager",null,[]);class x{constructor(){this.W=null}get name(){return"WordEditor.CanvasContextualProvider"}yc(b){this.W=
b}init(){this.W.resolve("Box4.IFeatureHelper").Yk.continueWith(()=>{this.Tm()})}Tm(){t.AFrameworkApplication.Hl("Microsoft.Office.Web.SessionSettings.IWacWordRewriteSettings");const b=t.AFrameworkApplication.K.$("EditorGoalsEnabled");(this.W.resolve("Box4.IFeatureHelper").isFeatureEnabled(63)||t.AFrameworkApplication.K.$("WordEditorIdeasCardsIsEnabled")||t.AFrameworkApplication.K.$("RewriteIsEnabled")||t.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.RewriteIsEnabledFromControlTower",
!1))&&(t.AFrameworkApplication.K.$("DynamicBundlesIsEnabled")?appResourceLoader.loadChunk("canvasContextual"):this.W.resolve("Common.IDynamicScriptLoaderProvider").JE.loadScript("canvasContextual")).then(()=>{this.W.ha("CanvasContextual.ICanvasContextualController",()=>canvasContextual.FactoryGlobal.getWordContextualControllerInstance({uiCulture:t.AFrameworkApplication.uiCulture,dataCulture:t.AFrameworkApplication.dataCulture,isRightToLeft:t.AFrameworkApplication.isRtl,ulsLogger:new an.a,dimeCallback:()=>
Object(Ht.__awaiter)(this,void 0,void 0,function*(){this.W.resolve("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").launchUpsellExperience("editorinword")}),loadUpsellDependencies:()=>Object(Ht.__awaiter)(this,void 0,void 0,function*(){this.W.Za("Common.IInProductMessagingUIManager").execute(h=>{h.Bli()})}),getSoftPaywallData:()=>this.W.resolve("WordEditor.EditorUpsell.ISoftPaywallData"),getPremiumPreviewCritiquesList:()=>this.W.resolve("WordEditor.EditorUpsell.IPremiumPreviewCritiquesFilter")})).singleInstance();
this.W.ha("WordEditor.CanvasContextualProvider.UxManager",()=>new m(ve.FocusManager.instance(),this.W.resolve("Box4.ISelectionManager"),this.W.resolve("CanvasContextual.ICanvasContextualController"),Ya.InteractiveViewManager.instance,rc.KeyInputManager.instance,t.AFrameworkApplication.uc,t.AFrameworkApplication.ua,t.AFrameworkApplication.ua.G_,this.W.Za("Common.ISystemInitiatedFeedback"),this.W.Za("WordEditor.DictationCommands.CorrectionCommandUxStateManager"))).singleInstance();this.W.resolve("CanvasContextual.ICanvasContextualController");
this.W.resolve("WordEditor.CanvasContextualProvider.UxManager");b&&(this.W.ha("CanvasContextual.IEditorInitializer",()=>canvasContextual.FactoryGlobal.getEditorInitializerInstance({uiCulture:t.AFrameworkApplication.uiCulture,ulsLogger:new an.a})).singleInstance(),this.W.resolve("CanvasContextual.IEditorInitializer").init(),this.W.ha("CanvasContextual.ISkittleControllerV2",()=>canvasContextual.FactoryGlobal.getSkittleControllerV2Instance({ulsLogger:new an.a})).singleInstance(),this.W.resolve("CanvasContextual.ISkittleControllerV2"))}).catch(h=>
{v.ULS.sendTraceTag(50422751,341,10,"CanvasContextualProvider - Failed to load Canvas Contextual script. Error: {0}",h)})}dispose(){}static main(){O.a.instance.Oc(new x)}}Object(n.a)(x,"PackageManager",null,[1,2]);class M{constructor(b,h,r,z){this.J5l=(R,ba,ta)=>{R=null;ba.view.ze&&(R=ba.view);if(!R||!R.Cb)return 8;if(!this.tG.trf())return 2;if(1===ta)return 32;this.wQj.ZIk();return 32};this.Hpi=(R,ba,ta)=>{let Wa=null;ba.view.ze&&(Wa=ba.view);if(!Wa||!Wa.Cb)return 8;if(!this.tG.trf())return 2;if(1===
ta)return 32;if(1!==this.tG.F3b(this.ib.hb,!0).count)return 2;ba=new yf.GraphTransaction(15);try{if(ba.Db(Wa.rd),!this.tG.Dco(R===Oa.a.fzf))return 8}finally{ba&&ba.dispose()}return 32};this.ga=b;this.ib=h;this.tG=r;this.wQj=z}Vb(){this.ga.pa(Oa.a.DMd,kc.a.view,this.J5l);this.ga.pa(Oa.a.fzf,kc.a.view,this.Hpi);this.ga.pa(Oa.a.Ipi,kc.a.view,this.Hpi)}}Object(n.a)(M,"IntelligentPlaceholderActor",null,[]);class aa{constructor(){this.Sjc=new Lc.a;this.j8c=new Lc.a}e1j(b,h){let r;({value:r}=this.Sjc.Dc(b,
r)).returnValue||this.Sjc.Z(b,r=new Ka.a);r.add(h)}K1j(b,h){this.j8c.xb(b)&&v.ULS.sendTraceTag(50954435,323,15,"Comment ID already exists for bookmark");this.j8c.Z(b,h)}c1j(b,h,r){this.e1j(b,h);this.K1j(h,r)}yjl(b){let h;return({value:h}=this.Sjc.Dc(b,h)).returnValue?h:null}iml(b){let h;return({value:h}=this.j8c.Dc(b,h)).returnValue?h:null}ern(b){let h;if(({value:h}=this.Sjc.Dc(b,h)).returnValue){for(let r of h)this.j8c.remove(r);this.Sjc.remove(b)}else v.ULS.sendTraceTag(50954436,323,15,"No bookmarks found for user ID")}}
Object(n.a)(aa,"IntelligentPlaceholderAtMentionManager",null,[380]);var sa=d(1625);class Va extends sa.a{constructor(b,h){super(b,h)}get key(){return"FOLLOW UP"}get mw(){return WordEditorIntl.WordEditorStrings.L_IntelligentPlaceholder}K3i(b){return!b.ia(yc.a.HF,!1)}zdb(){return Box4Intl.Box4Strings.l_ShowIntentSuggestionTooltipClickOrPress}}Object(n.a)(Va,"IntelligentPlaceholderDetailsProvider",sa.a,[]);var rb=d(1757),Wb=d(1907),ic=d(1761);class Nc{constructor(){this.Wwa=""}Wea(b){this.Wwa+=b}f9h(b){this.Wwa+=
b}Qnf(b){this.Wwa+=b}insertImage(b){this.Wwa+=b}U8h(b){this.Wwa+=b}}Object(n.a)(Nc,"PlainTextFormatCreator",null,[860]);var fd=d(1570),ld=d(1906);d(384);var Bc=d(1624),gd=d(1485);class se{constructor(){this.kmc=new Lc.a}contains(b){return this.kmc.xb(se.dvf(b))}add(b){this.kmc.Z(se.dvf(b),b)}remove(b){this.kmc.remove(se.dvf(b))}teo(b){for(let h of b.kmc)this.add(h.value)}RFh(){const b=new Ua.a;for(let h of this.kmc)b.add(h.value.Qj);return b}static dvf(b){return b.Qj.toString()}}Object(n.a)(se,"CommentRangeSet",
null,[]);class Hd extends Sys.EventArgs{constructor(b){super();this.commentNode=b}}Object(n.a)(Hd,"OnFollowUpEventArgs",Sys.EventArgs,[]);class Ge extends Hd{constructor(b,h){super(b);this.Z4m=h}}Object(n.a)(Ge,"OnCreateEventArgs",Hd,[]);class pf extends Hd{constructor(b,h){super(b);this.fjm=h}}Object(n.a)(pf,"OnResolveEventArgs",Hd,[]);var ch=d(222);class Ug{}Ug.qfe="MentionExperienceDegraded";Object(n.a)(Ug,"AtMentionsConstants",null,[]);class yg{constructor(b,h,r,z,R,ba,ta,Wa,ub,Ib){this.FUd=b;
this.Jfk=h;this.e2c=r;this.Vtd=z;this.Cb=R;this.Hu=ba;this.XMd=ta;this.J9h=Wa;this.jw=ub;this.kzc=Ib;this.kOa=null;(b=Sa.a.instance.Pa("Box4.IEditStateEventManager"))&&b.addHandler(ch.a.Wya,this.hyn.bind(this))}Fsf(){return!!this.kOa}hyn(){this.Fsf()&&this.wkh&&(this.kOa.updateInputText(this.vvf,!1),this.wkh=!1)}ariaNotify(b,h){this.jw.sendNotification(b,h)}Y3j(){const b=this.Hu.editingView.editingElement;if(b){var h=b.getAttribute(vf.a.azc);b.setAttribute(vf.a.azc,h?h.toString()+" PeoplePickerAutomationID":
"PeoplePickerAutomationID")}else v.ULS.sendTraceTag(51218125,323,15,"Cannot find editing element")}xqn(){const b=this.Hu.editingView.editingElement;if(b){var h=b.getAttribute(vf.a.azc);h?(h=h.toString().split(" "),Array.remove(h,"PeoplePickerAutomationID"),h.length?b.setAttribute(vf.a.azc,h.join(" ")):b.removeAttribute(vf.a.azc)):v.ULS.sendTraceTag(51218127,323,50,"No aria-controls when dismissing picker?")}else v.ULS.sendTraceTag(51218126,323,15,"Cannot find editing element")}Evk(){this.xqn();this.kOa&&
this.kOa.updateInputText("a",!0);const b=document.getElementById("PeoplePicker");b&&document.body.removeChild(b);this.kOa=null;this.J9h.OYi(!0)}pWm(b,h,r){v.ULS.sendTraceTag(41178053,323,50,"@ mention selected, callback to replace text");b=this.XMd.PZa(b,r.displayName,r.email,r.id);this.ariaNotify(String.format(WordEditorIntl.WordEditorStrings.L_AtMentionsSuggestionSelected,h),!0);b?v.ULS.sendTraceTag(558113739,323,50,"Successfully inserted at mentions"):this.kzc.logKpiFailure("LPPWordEditorKPI",
"FailedToInsertAtMention",{isInternal:!0},{name:Ug.qfe,isInternal:!0})}pVm(b,h){v.ULS.sendTraceTag(50954434,323,50,"Permissions received for entity");h&&this.kzc.TB(Oa.a.Wrk);this.XMd.XTl(b.id,h)}zRm(){this.Hu.xd.Lv&&!this.Hu.xd.aO&&this.Hu.editingView.Q5e?this.wkh=!0:(this.FUd.reset(),v.ULS.sendTraceTag(41178054,323,50,"People picker dismissed off canvas"))}yXm(){v.ULS.sendTraceTag(41178055,323,50,"People picker shown on canvas");this.Y3j()}oVm(b,h,r,z=new Map){z=Object.assign(new eb.a,{extendedProperties:z});
this.kzc.logKpiFailure("LPPWordEditorKPI",b,{isIntentional:h,isInternal:r,additionalValues:z},{name:Ug.qfe,errorNameOverride:"LPPFailedToInsertAtMention",isIntentional:h,isInternal:r,additionalValues:z})}mMi(){this.FUd.uMi(()=>{this.Evk()});this.FUd.hMi((b,h)=>{this.vvf=b;if(this.kOa)this.kOa.updateInputText(this.vvf,!1);else if(this.kzc.logKpiUsage("LPPWordEditorKPI",0),this.kzc.TB(Oa.a.DZm),(b=this.Qul(h))&&b.height){h=b.y;const r=b.height,z=document.createElement("div");z.id="PeoplePicker";z.style.position=
"absolute";z.style.top=h-5+"px";z.style.left=b.x+"px";z.style.height=r+10+"px";document.body.appendChild(z);b={editingElementId:this.Hu.editingView.editingElement.id,containerElement:z,automationID:"PeoplePickerAutomationID",onReplaceTextCallback:Object(u.a)(this,this.pWm,"onReplaceTextFromPicker"),onPermissionsReceivedCallback:Object(u.a)(this,this.pVm,"onPermissionsReceivedFromPicker"),onDismiss:Object(u.a)(this,this.zRm,"onDismissPicker"),onShow:Object(u.a)(this,this.yXm,"onShowPicker"),onFailure:Object(u.a)(this,
this.oVm,"onPeoplePickerServiceFailure")};this.Jfk.createPeoplePicker(b).then(R=>{R.updateInputText(this.vvf,!1);this.kOa=R;this.J9h.OYi(!1)})}});this.FUd.iMi(b=>{if(this.kOa)this.kOa.onKeyDown(b.Ib.rawEvent)})}Qul(b){var h=this.Cb.hb;if(!h)return null;h=h.kb;if(!h)return null;h=h.Qa;if(!h)return null;h=h.node;if(!h)return null;h=Object(la.a)(200,h);if(!h)return null;h=Object(la.a)(213,h.Ni(this.Hu.xd.Tb));if(!h)return null;h=Object(la.a)(86,h);if(!h)return null;let r=null;try{r=this.e2c.aZ(this.Vtd.j2b(2,
b),h,!1,!1,!1,!1)}catch(z){v.ULS.sendTraceTag(41178056,323,15,"Failed to get ip bounds due to exception {0}, will use fallback value.",z)}return r}}Object(n.a)(yg,"WordEditorAtMentionsHandler",null,[396]);var If=d(1476),wh=d(705);class Ah{static Qao(b){wh.a.COd()&&(Ii.TableReader.AOc(b)?Ah.F0f(Ah.EGm):mc.ListReader.dma(b)&&Ah.F0f(Ah.DGm))}static F0f(b){var h;null!==(h=t.AFrameworkApplication.K)&&void 0!==h&&h.getBooleanFeatureGate("Microsoft.Office.WordOnline.isLoopsTUIEnabled",!1)&&(Ah.rei||Ah.addEventListener(),
(h=Sa.a.instance.Za("Common.ISystemInitiatedFeedback"))&&h.execute(r=>{r.logActivity(b,null)}))}static addEventListener(){window.addEventListener(Ah.W4n,Ah.V4n,!0);Ah.rei=!0}}Ah.W6n="LoopsTeachingCalloutOnInsertTabActivity";Ah.W4n="switchToInsertTabEvent";Ah.DGm="mentionWithinListActivity";Ah.EGm="mentionWithinTableActivity";Ah.rei=!1;Ah.V4n=()=>{appChrome.api.dispatch(appChrome.actions.setCurrentTab("Insert"))};Object(n.a)(Ah,"FluidComponentsTUIHelper",null,[]);class ei{constructor(b,h,r,z,R,ba,
ta,Wa,ub,Ib,$b,fc,Kc,ed,Jd){this.ga=b;this.Xc=h;this.S8a=r;this.ib=z;this.Dp=R;this.Vd=ba;this.tC=ta;this.Tcd=Wa;this.Hd=ub;this.Ym=Ib;this.twj=fc;this.Bi=Kc;this.Hc=$b;this.sa=new Te.a;this.kf=ed;this.mvg=Jd;gd.a.nPe((ge,qe)=>{this.HF(qe.commentNode,!0)&&this.sa.raiseEvent(ei.vTc)})}q$g(b){this.sa.addHandler(ei.Ewi,b)}c8j(b){this.sa.addHandler(ei.Fzi,b)}L7j(b){this.sa.addHandler(ei.iUm,b)}nPe(b){this.sa.addHandler(ei.vTc,b)}HF(b,h){let r=b.ia(yc.a.HF,!1);h&&(r=r&&!b.ia(yc.a.F9,!1));return r}V6b(b){return this.Dp.V6b(b)}hBl(b){for(let h of b)for(let r of h)if(ei.puf(r.contextId))return r.node.Lc;
return null}hIl(b,h,r){const z=new se,R=b.Lc;for(let ba=0;ba<b.qa.length;ba++){const ta=b.qa.J(ba);if(ta.cp>=h)break;if(ta.Ff&&ta.Ff.length)for(let Wa=0;Wa<ta.Ff.length;Wa++){const ub=ta.Ff.J(Wa);this.HF(R.Eb(ub.Qj),r)&&(ub.Pc?z.add(ub):z.remove(ub))}}return z}iIl(b,h,r,z){const R=new se,ba=b.Lc;for(let ta=0;ta<b.qa.length;ta++){const Wa=b.qa.J(ta);if(Wa.cp>r)break;if(Wa.Ff&&Wa.Ff.length)for(let ub=0;ub<Wa.Ff.length;ub++){const Ib=Wa.Ff.J(ub);this.HF(ba.Eb(Ib.Qj),z)&&(Ib.Pc?Wa.cp<r&&R.add(Ib):Wa.cp<=
h&&R.remove(Ib))}}return R}FYh(b,h){let r;const z=b.node;b.contextId!==kc.a.paragraph?(r=b.cpBegin,b=b.cpEnd):(r=0,b=z.characterData.length);return r===b?this.hIl(z,r,h):this.iIl(z,r,b,h)}DJc(b,h){return ei.puf(b.contextId)?this.FYh(b,h).RFh():new Ua.a}F3b(b,h){const r=new se;for(let z of b)for(let R of z)ei.puf(R.contextId)&&r.teo(this.FYh(R,h));return r.RFh()}trf(){var b=this.ib.hb;if(!b||1!==b.length||1!==b.J(0).length)return!1;b=b.J(0).Qa.node;return ie.ParagraphReader.nc(b)&&!ie.ParagraphReader.hka(b)&&
this.Dp.Kfb(this.ga,!0)?!0:!1}W8h(b,h){if(!this.trf())return null;if(this.Dp.RVl())return v.ULS.sendTraceTag(592761861,323,15,"Placeholder insertion failed because of draft comment"),null;let r=!1;var z=this.ib.hb.J(0).Qa;z.contextId===kc.a.Wc?(b=b?Xd.SelectionEditor.X1(z,!1):null)&&b.eE&&b.Qa.contextId===kc.a.Gd?this.ib.setSelection(b):(this.Vd.replaceTextRange(z,WordEditorIntl.WordEditorStrings.L_InsertIntelligentPlaceholderAnchorText+" ",!0),this.ib.setSelection(Hf.SelectionFactory.DN(z.node,z.cpBegin,
z.cpBegin+WordEditorIntl.WordEditorStrings.L_InsertIntelligentPlaceholderAnchorText.length))):r=!0;this.kf.cyb||rb.a.instance.qMc();b=this.Dp.txb(this.ib.hb.kb);if(!b)return null;this.V6b(b)&&this.mvg.TB(ab.a.newComment,{succeeded:!0,TLb:29});var R=this.Xc.fg(b);const ba=R.Rb(1);if(!ba||393229!==ba.Qc)return null;R=R.Rb(2);if(!R||393230!==R.Qc)return null;this.$7f(b.Lc,b.id);this.sa.raiseEvent(ei.Ewi,new Ge(b,h));r&&(h=z.node,z=z.contextId!==kc.a.paragraph?z.cpEnd:h.characterData.length,this.ib.setSelection(Hf.SelectionFactory.DN(h,
z,z)));return b}DMd(b){return!!this.W8h(!0,b)}bof(b,h,r,z,R,ba){if(0>h)return!1;z="@"+z;const ta=z+" ",Wa=new yf.GraphTransaction(15);try{Wa.Db(b);this.Vd.replaceTextRange(Qe.a.createTextRange(b,h,r),ta);this.Hd.ng&&(this.Ym.gXe(b,h,h+z.length),this.Ym.Zna(b,h+z.length,h+ta.length,1));const ub=this.tC.NG(Qe.a.createTextRange(b,h,h+z.length),"mailto:"+R,!1,!0,!1);if(!ub)return!1;const Ib=ub.Hx;if(!Ib)return v.ULS.sendTraceTag(51217483,323,15,"Insertion of IntelligentPlaceholderWithMention failed"),
!1;this.ib.setSelection(Hf.SelectionFactory.DN(b,h,h+z.length));let $b=this.W8h(!1,2);if(!$b)return!1;ba&&this.Tcd.c1j(ba,Ib,$b.id);this.ib.setSelection(Hf.SelectionFactory.xe(b,h+ta.length));Ah.Qao(b)}finally{Wa&&Wa.dispose()}return!0}PZa(b,h,r,z){const R=this.ib.Rg;return Xd.SelectionEditor.xf(R)?this.bof(R.node,R.cpBegin-b,R.cpBegin,h,r,z):!1}kEl(b){if(1===b.length&&b.J(0).eE&&(b=b.J(0).Qa,b.contextId===kc.a.Wc&&ie.ParagraphReader.nc(b.node))){const h=b.node;for(let r=0;r<h.qa.length;r++){const z=
h.qa.J(r);if(z.cp===b.cpBegin){b=z.zHd(!0,!0);if(0<b.length)return b[0].Qj;break}}}return null}ixb(b,h,r){return this.Dp.wCc(b,h,r).returnValue}jEd(b,h,r,z,R){let ba=!1;const ta=b.characterData;if(h>=ta.length||r>ta.length||r<h)return{returnValue:!1,ZKa:ba};let Wa=h,ub=null;for(let $b=0;$b<b.qa.length;$b++){const fc=b.qa.J($b),Kc=fc.cp;if(!(Kc<h)){if(fc.wl&&ub)try{const ed=ta.substring(Wa,Kc),Jd=new Wb.a;Jd.fullName=ed.startsWith("@")?ed.substr(1):ed;Bc.a(ub,Jd);const ge=new ic.a;Bc.b(ub,ge);R&&(ge.contentId=
this.twj.waf());z.Qnf(ed,Jd,ge);ba=!0;ub=null;Wa=Kc}catch(ed){var Ib=Object.assign(new eb.a,{extendedProperties:new Map});Ib.extendedProperties.set("exception",ed.message);this.mvg.logKpiFailure("LPPWordEditorKPI","FailedToRenderAtMention",{isInternal:!0,additionalValues:Ib},{name:Ug.qfe,isInternal:!0,additionalValues:Ib})}Kc<=r&&!ub&&(Ib=Math.min(Kc,r),Ib>Wa&&z.Wea(ta.substring(Wa,Ib)),Wa=Kc);fc.hyperlink&&fc.hyperlink.GF&&(ub=fc.hyperlink);if(Kc>=r)break}}return{returnValue:!0,ZKa:ba}}aMh(b,h,r,
z,R=-1){var ba=!1,ta=b.Eb(h),Wa=b.Eb(If.k(ta));ta=b.Eb(If.h(ta));R=0<R?R:Number.MAX_VALUE;b=this.ixb(Wa,h,!0);h=this.ixb(ta,h,!1);if(-1===b||-1===h)return{returnValue:!1,ZKa:ba};if(Wa===ta)return this.jEd(Wa,b,h,r,z);const ub=this.S8a.wbb(Wa,!1,!1);if(!ub)return{returnValue:!1,ZKa:ba};Wa=new Ua.a;let Ib=0;do Wa.add(ub.pA),Ib+=ub.pA.characterData.length;while(ub.pA!==ta&&ub.ita()&&Ib<R);for(R=0;R<Wa.count;R++)if(ba=Wa.J(R),ta=ba.characterData,R)if(R===Wa.count-1){if(!({ZKa:ba}=this.jEd(ba,0,h,r,z)).returnValue)return{returnValue:!1,
ZKa:ba}}else{if(!({ZKa:ba}=this.jEd(ba,0,ta.length,r,z)).returnValue)return{returnValue:!1,ZKa:ba};r.Wea("\n")}else{if(!({ZKa:ba}=this.jEd(ba,b,ta.length,r,z)).returnValue)return{returnValue:!1,ZKa:ba};r.Wea("\n")}return{returnValue:!0,ZKa:ba}}iEd(b,h){const r=new Nc;return this.aMh(b,h,r,!1,-1).returnValue?r.Wwa:null}IBd(b,h){var r=b.Eb(h);if(!r)return null;b=b.Eb(If.h(r));if(!b)return null;h=this.ixb(b,h,!1);if(-1===h)return null;r=b.characterData;if(h>=r.length||!B.a.daa(r.charAt(h))){r=this.Hc.Rc(15);
try{r.Db(b),this.Vd.replaceTextRange(Qe.a.Uc(b,h)," ")}finally{r&&r.dispose()}}return Hf.SelectionFactory.xe(b,h+1)}$7f(b,h){const r=b.Eb(h),z=new fd.a;this.aMh(b,h,z,!0).returnValue&&(z.Wea("\n"),this.Dp.ngj(r,z.l8),this.sa.raiseEvent(ei.LYm))}tEn(b,h){for(let r of b){if(r.contains(h))return!0;for(let z of r)for(let R of h)if(z.node===R.node&&z.hl>=R.hl)return!0}return!1}iyh(b,h,r,z,R){const ba=this.ib.hb.clone(),ta=new ow.a(vb.App.xa.jb.Ic);b=Hf.SelectionFactory.xe(b,h);r=Qe.a.Uc(r,z);b=Hf.SelectionFactory.XC(b,
r);this.ib.setSelection(b);r=!this.tEn(ba,b);return 32===this.ga.Qf(ta,Fb.a.SG,2,!0,null,null)?(r?this.ib.KX(ba):R!==E.a.nil&&(R=this.IBd(this.Bi.value,R),this.ib.setSelection(R)),!0):!1}fpn(b,h){var r=b.Eb(h);const z=b.Eb(If.k(r));b=b.Eb(If.h(r));if(z===b){r=" "+WordEditorIntl.WordEditorStrings.L_InsertIntelligentPlaceholderAnchorText;var R=z.characterData.indexOf(r);-1!==R&&this.iyh(z,R,b,R+r.length,h)}}qyh(b,h,r){var z=b.Eb(h);if(!z)return!1;const R=b.Eb(If.k(z));b=b.Eb(If.h(z));z=this.ixb(R,h,
!0);const ba=this.ixb(b,h,!1);if(-1===z||-1===ba||!this.iyh(R,z,b,ba,E.a.nil))return!1;r&&this.zyh(h);return!0}zyh(b){this.Dp.lSf(b,!0)}Dco(b){var h=this.hBl(this.ib.hb);if(!h)return!1;const r=this.F3b(this.ib.hb,!0);if(1!==r.count)return!1;const z=h.Eb(r.J(0));if(b)h=this.qyh(h,r.J(0),!1);else{const R=If.k(z),ba=If.h(z);E.a.Fp(R,ba)||v.ULS.sendTraceTag(592487139,323,15,"User attempted to resolve comment that spans more than 1 paragraph");this.HFk(r.J(0));h.Eb(R).gk(16,!0);h=!0}h&&(z.setValue(yc.a.F9,
!0),this.sa.raiseEvent(ei.Fzi,new pf(z,b)));return h}sfh(b,h){b=this.F3b(this.ib.hb,!1);h.xo[ei.Wzh]=!!b.count}Uxi(b,h){if(h.xo[ei.Wzh]&&ie.ParagraphReader.nc(h.clone)&&(h=h.clone,b=h.Lc)&&(h=Qe.a.createTextRange(h,0,h.characterData.length),h=this.DJc(h,!1),h.count))for(let r of h)(h=b.Eb(r))&&h.setValue(yc.a.HF,!1)}Ynl(b,h,r){let z;const R=({MAc:ub}=this.Dp.wCc(h,r,!0)).returnValue;r=({MAc:z}=this.Dp.wCc(h,r,!1)).returnValue;let ba=null,ta=-1,Wa=-1;for(;ub<z;ub++){let Ib=h.qa.J(ub);if(Ib.hyperlink&&
Ib.hyperlink.GF&&Ib.hyperlink.Hx===b){ba=Ib.hyperlink;ta=Ib.cp;break}}if(!ba||ta<R)return{returnValue:!1,Dsh:ta,Csh:Wa};for(b=ub;b<h.qa.length;b++){var ub=h.qa.J(b);if(ub.cp>r)break;if(ub.xT){Wa=ub.cp;break}}return{returnValue:-1!==Wa,Dsh:ta,Csh:Wa}}eqn(b){var h=this.Tcd.iml(b);if(h){var r=null;vb.App.xa&&(r=vb.App.xa.jb.Yc.zd);if(r){var z=r.Eb(h);h=r.Eb(If.k(z));var R=r.Eb(If.h(z));if(h!==R)v.ULS.sendTraceTag(50954439,323,10,"Mention bookmark has no associated comments");else if(({Dsh:b,Csh:R}=this.Ynl(b,
h,z.id)).returnValue){var ba=new yf.GraphTransaction(7);try{ba.Db(h);let ta=Qe.a.createTextRange(h,b,R);this.Vd.replaceTextRange(ta,"");this.$7f(r,z.id)}finally{ba&&ba.dispose()}this.ib.hb&&0<this.ib.hb.length?(r=this.ib.hb.J(0).Qa,r.node===h?v.ULS.sendTraceTag(50954441,323,50,"Moving from cp {0} to {1}",r.cpBegin,b):v.ULS.sendTraceTag(50954442,323,50,"Moving selection to a different node")):v.ULS.sendTraceTag(50954443,323,50,"Unable to find selection start after deleting mention");this.ib.setSelection(Hf.SelectionFactory.xe(h,
b))}else v.ULS.sendTraceTag(50954440,323,15,"Unable to compute hyperlink CPs for bookmark")}else v.ULS.sendTraceTag(50954438,323,15,"Unable to find object space for removing mention")}else v.ULS.sendTraceTag(50954437,323,15,"Mention bookmark has no associated comments")}XTl(b,h){if(!h){h=this.Tcd.yjl(b);if(!h){v.ULS.sendTraceTag(50954444,323,15,"No bookmarks found for userId");return}for(let r of h)this.eqn(r)}this.Tcd.ern(b)}thl(){rb.a.instance.qMc();const b=new Ua.a;for(let r of this.Dp.lQe)if(r.Sq!==
ld.a.beingCreated){var h=E.a.Of(r.objectId);h=this.Bi.value.Eb(h);this.HF(h,!0)&&b.add(h)}return b}WDn(b){b=this.Dp.Bhf(b);this.ib.setSelection(b)}HFk(b){b?this.Bi.value.Eb(b).setValue(yc.a.HF,!1):v.ULS.sendTraceTag(594043491,323,10,"The given intelligent placeholder guid is null")}static puf(b){return b===kc.a.Gd||b===kc.a.Wc||b===kc.a.paragraph}}ei.Wzh="DisableNestedIntelligentPlaceholder";ei.Ewi="CreateIntelligentPlaceholder";ei.Fzi="ResolveIntelligentPlaceholder";ei.LYm="UpdateIntelligentPlaceholder";
ei.vTc="DeleteIntelligentPlaceholder";ei.iUm="MentionAddedToFollowUpEventKey";Object(n.a)(ei,"IntelligentPlaceholderEditor",null,[377,378,379]);class Am{constructor(b,h,r,z){this.aqa=!1;this.Pl=!0;this.ke=null;this.lab=R=>{if(!this.Pl||!this.Xqk(R,this.ib.hb))return!1;R.Ib.preventDefault();R.Ib.stopPropagation();this.Zc.xd&&this.Zc.xd.nFc(!1);R=this.IBd(this.ib.hb);if(!R)return!1;this.ib.setSelection(R);return!0};this.Zc=b;this.Bi=h;this.ib=r;this.M4=z}uzc(b,h){this.aqa||(b.Ata?(this.mab(h),this.aqa=
!0):b.hda(()=>{this.aqa||(this.mab(h),this.aqa=!0)}))}dispose(){this.ke&&this.ke.sc(jb.a.WH,this.Zc.editingView.editingElement,this.lab)}mab(b){this.ke=b;this.Zc.xd.wi&&this.ke.mb(jb.a.WH,this.Zc.editingView.editingElement,this.lab)}Xqk(b,h){if(b.Ib.keyCode!==wb.a.mx&&b.Ib.keyCode!==wb.a.es||1!==h.length||!h.J(0).eE)return!1;var r=this.M4.F3b(h,!0);if(1!==r.count)return!1;const z=h.J(0).Qa.node;if(!ie.ParagraphReader.nc(z))return!1;b=this.M4.ixb(z,r.J(0),!0);r=this.M4.ixb(z,r.J(0),!1);return h.J(0).Qa.cpBegin<
b||h.J(0).Qa.cpEnd>r?!1:!0}IBd(b){b=this.M4.F3b(b,!0);if(1!==b.count)return null;b=b.J(0);return this.M4.IBd(this.Bi.value,b)}OYi(b){this.Pl=b}}Object(n.a)(Am,"IntelligentPlaceholderKeyboardListener",null,[376,9]);class Yk{constructor(b,h){this.l7l=r=>{1===r&&this.ga.processAction(ab.a.newComment,2);2===r&&(this.xZg.instance?this.xZg.instance.ahc("https://go.microsoft.com/fwlink/?linkid=2154656")&&B.a.aX("https://go.microsoft.com/fwlink/?linkid=2154656")&&window.open("https://go.microsoft.com/fwlink/?linkid=2154656",
"_blank"):v.ULS.sendTraceTag(556794450,323,15,"IntelligentPlaceholderPhaseOut Dialog's SafeLinkManager was not ready"));r=[Object.assign(new ca.a,{name:"DialogResult",int64:r})];Lb.d(Oa.a.yJh,void 0,void 0,void 0,void 0,void 0,r)};this.ga=b;this.xZg=h}ZIk(){const b=new te.StandardDialog;b.Fd=11;b.Ve(1,WordEditorIntl.WordEditorStrings.L_TryIt);b.Ve(2,WordEditorIntl.WordEditorStrings.L_LearnMore);b.Pv(WordEditorIntl.WordEditorStrings.L_PhaseOutFollowUpsHeader,WordEditorIntl.WordEditorStrings.L_PhaseOutFollowUpsContent,
0,this.l7l);Lb.a("FollowUpsPhaseOutDialogShown")}}Object(n.a)(Yk,"IntelligentPlaceholderPhaseOutDialogManager",null,[]);var ts=d(1458);class Od{constructor(b,h,r,z,R,ba){this.b5=this.PCe=null;this.a3=()=>{this.b5||(this.b5=new Ic.a(3,1,0,()=>{this.b5=null;this.BKd(this.ib.hb)},130),this.Hb.$b(this.b5))};this.Hc=b;this.tG=h;this.ib=r;this.Hb=z;this.nLe=R;this.Bi=ba;this.D0=new dg.a;this.ns=new ts.a;this.mVg=new zd.a(this.D0);this.tG.q$g((ta,Wa)=>{this.d4j(Wa.commentNode)})}d4j(b){b=b.id;const h=this.IWh(this.Bi.value,
b);h&&this.ns.Z(b,h)}IWh(b,h){const r=b.Eb(h);return!r||this.tG.V6b(r)?null:this.tG.iEd(b,h)}Pkk(b){const h=new ts.a;var r=this.tG.F3b(b,!0);if(!r)return h;b=this.Bi.value;for(let z of r)(r=this.IWh(b,z))&&h.Z(z,r);return h}lSf(b){if(this.PCe){const h=this.Hc.Rc(15);try{h.Db(this.nLe()),this.tG.zyh(this.PCe)}finally{h&&h.dispose()}}this.PCe=b?this.tG.kEl(b):null}vUl(b){const h=this.Bi.value;if(b=b?this.Pkk(b):new ts.a){var r=new zd.a(this.D0),z=new zd.a(this.D0);Od.Zql(this.ns,b,r,z);for(var R of r)this.ns.Z(R,
b.J(R));for(let ba of z)if(r=this.ns.J(ba),z=this.tG.iEd(h,ba),this.ns.remove(ba),z&&(b=R=!1,ka.a.fKc().equals(z,WordEditorIntl.WordEditorStrings.L_InsertIntelligentPlaceholderAnchorText)?(b=!0,r=!1):r=-1<z.indexOf(WordEditorIntl.WordEditorStrings.L_InsertIntelligentPlaceholderAnchorText)?R=!0:!ka.a.fKc().equals(r,z),r||R||b)){z=this.Hc.Rc(15);try{z.Db(this.nLe()),b?this.tG.qyh(h,ba,!0):(R&&this.tG.fpn(h,ba),r&&this.tG.$7f(h,ba))}finally{z&&z.dispose()}}}}oDl(b){const h=new zd.a(this.D0);for(let r of b)for(let z of r)b=
z.node,ie.ParagraphReader.nc(b)&&h.add(b.id);return h}WSl(b){var h=this.Bi.value;const r=b?this.oDl(b):new zd.a(this.D0);if(r){b=new Ua.a;for(let ba of this.mVg)if(!r.contains(ba)){var z=h.Eb(ba);if(z){z=z.qa;for(let ta=0;ta<z.length;ta++){const Wa=z.J(ta).Ff;if(Wa)for(let ub=0;ub<Wa.length;ub++){var R=Wa.J(ub);R.Pc&&(R=h.Eb(R.Qj))&&R.ia(yc.a.Aii,!1)&&E.a.Fp(ba,If.h(R))&&this.tG.V6b(R)&&b.add(R)}}}}this.mVg=r;if(b.count){h=this.Hc.Rc(7);try{h.Db(this.nLe());for(let ba of b)ba.Qg(yc.a.Aii)}finally{h&&
h.dispose()}}}}BKd(b){this.lSf(b);this.vUl(b);this.WSl(b)}lkh(){this.b5&&(this.Hb.We(this.b5),this.b5=null)}lTc(){if(this.b5||this.Bi.$Kd)this.lkh(),this.BKd(null)}QA(){this.ib.oB(this.a3);t.AFrameworkApplication.xK(()=>{this.lTc()})}dispose(){this.ib.uga(this.a3);this.lkh()}static Zql(b,h,r,z){for(let R of h){let ba=R.key;b.xb(ba)||r.add(ba)}for(let R of b)b=R.key,h.xb(b)||z.add(b)}}Object(n.a)(Od,"IntelligentPlaceholderSelectionCache",null,[9]);var ae;(function(b){b[b.unknown=0]="unknown";b[b.contextMenu=
1]="contextMenu";b[b.atMention=2]="atMention";b[b.jMo=3]="textGesture";b[b.paste=4]="paste";b[b.Tuo=5]="workItemIntent";b[b.mCo=6]="characterTrigger"})(ae||(ae={}));Object(n.b)("IntelligentPlaceholderCreation",ae);class Oi{constructor(b,h,r,z){this.nxa=b;this.wm=h;this.eOb=r;this.yx=z}e8d(b){return b&&b.Lc&&b.Lc.id.equals(this.yx.value.zd.id)?!0:!1}$2i(b){return this.e8d(b)&&b.ia(yc.a.HF,!1)?!0:!1}Qzm(){this.eOb.execute(b=>{b.logAction({actionType:La.b.SessionStart,engagement:La.a.Offer,objectName:Oi.cgc})})}pTd(b,
h){let r=!1;t.AFrameworkApplication.K.$("FixInCanvasMentionLogging")&&(r=2==h&&this.e8d(b));if(this.$2i(b)||r){var z=b.getValue(yc.a.iE);this.eOb.execute(R=>{R.logAction({actionType:La.b.Created,engagement:La.a.None,objectName:Oi.cgc,objectId:z.toString(),objectFulfillment:ae[h]})})}}Ewm(b){if(this.$2i(b)){var h=b.getValue(yc.a.iE);this.eOb.execute(r=>{r.logAction({actionType:La.b.Deleted,engagement:La.a.None,objectName:Oi.cgc,objectId:h.toString()})})}}LAm(b,h){if(this.e8d(b)){var r=b.getValue(yc.a.iE);
this.eOb.execute(z=>{z.logAction({actionType:La.b.Resolved,engagement:La.a.None,objectName:Oi.cgc,objectId:r.toString(),objectFulfillment:h?"RemoveText":"KeepText"})})}}RBm(b){b===Oa.a.DMd&&this.eOb.execute(h=>{h.logAction({actionType:La.b.Deleted,engagement:La.a.None,objectName:Oi.cgc,objectFulfillment:Oi.k7n})})}Mym(b){if(this.e8d(b)){var h=b.getValue(yc.a.iE);this.eOb.execute(r=>{r.logAction({actionType:La.b.Modified,engagement:La.a.None,objectName:Oi.cgc,objectId:h.toString(),objectFulfillment:"MentionInserted"})})}}Khk(){this.Qzm();
this.nxa.q$g((b,h)=>{this.pTd(h.commentNode,h.Z4m)});this.nxa.c8j((b,h)=>{this.LAm(h.commentNode,h.fjm)});this.nxa.L7j((b,h)=>{this.Mym(h.commentNode)});this.wm.wPe((b,h)=>{this.RBm(h.actionId)});gd.a.nPe((b,h)=>{this.Ewm(h.commentNode)})}}Oi.cgc="IntelligentPlaceholder";Oi.k7n="Undo";Object(n.a)(Oi,"IntelligentPlaceholderTelemetry",null,[]);class us{constructor(){this.M4=this.Eed=this.tld=this.W=null}get name(){return"WordEditor.IntelligentPlaceholder"}yc(b){this.W=b;b.ha("WordEditor.IntelligentPlaceholder.IntelligentPlaceholderPhaseOutDialogManager",
()=>new Yk(t.AFrameworkApplication.ya,b.Za("Common.App.SafeLinks.ISafeLinksManager"))).singleInstance();b.ha("WordEditor.IntelligentPlaceholder.IntelligentPlaceholderAtMentionManager",()=>new aa).as("WordEditor.IntelligentPlaceholder.IIntelligentPlaceholderAtMentionManager").singleInstance();b.ha("WordEditor.IntelligentPlaceholder.IntelligentPlaceholderEditor",()=>new ei(t.AFrameworkApplication.ya,new sn.a,b.resolve("Box4.IParagraphIteratorFactory"),b.resolve("Box4.ISelectionManager"),b.resolve("WordEditor.Comments.IWordEditorCommentModel"),
b.resolve("Box4.ICharacterPropertiesEditor"),b.resolve("Box4.IHyperlinkEditor"),b.resolve("WordEditor.IntelligentPlaceholder.IIntelligentPlaceholderAtMentionManager"),b.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,b.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance,b.resolve("Box4.Graph.IGraphTransactionFactory"),b.resolve("Box4.IAtMentionHyperlinkConfigurator"),new De.a(()=>vb.App.xa.jb.Yc.zd),b.resolve("WordEditor.Comments.CommentsSettings"),this.W.resolve("WordEditor.AtMentions.IFeatureUsageAndHealthLogger"))).as("WordEditor.IntelligentPlaceholder.IIntelligentPlaceholderInternalEditor").as("WordEditor.IntelligentPlaceholder.IIntelligentPlaceholderEditor").as("WordEditor.IntelligentPlaceholder.IIntelligentPlaceholderEventSource").singleInstance();
b.ha("WordEditor.IntelligentPlaceholder.IntelligentPlaceholderActor",()=>new M(t.AFrameworkApplication.ya,b.resolve("Box4.ISelectionManager"),b.resolve("WordEditor.IntelligentPlaceholder.IIntelligentPlaceholderEditor"),b.resolve("WordEditor.IntelligentPlaceholder.IntelligentPlaceholderPhaseOutDialogManager"))).singleInstance();b.ha("WordEditor.IntelligentPlaceholder.IntelligentPlaceholderSelectionCache",()=>new Od(b.resolve("Box4.Graph.IGraphTransactionFactory"),b.resolve("WordEditor.IntelligentPlaceholder.IIntelligentPlaceholderInternalEditor"),
b.resolve("Box4.ISelectionManager"),t.AFrameworkApplication.uc,()=>vb.App.xa.jb.Ic.rd,new De.a(()=>vb.App.xa.jb.Yc.zd))).singleInstance();b.ha("WordEditor.IntelligentPlaceholder.IntelligentPlaceholderKeyboardListener",()=>new Am(Ya.InteractiveViewManager.instance,new De.a(()=>vb.App.xa.jb.Yc.zd),b.resolve("Box4.ISelectionManager"),b.resolve("WordEditor.IntelligentPlaceholder.IIntelligentPlaceholderInternalEditor"))).as("WordEditor.IntelligentPlaceholder.IIntelligentPlaceholderKeyboardListener").singleInstance();
b.ha("WordEditor.IntelligentPlaceholder.IntelligentPlaceholderTelemetry",()=>new Oi(b.resolve("WordEditor.IntelligentPlaceholder.IIntelligentPlaceholderInternalEditor"),b.resolve("Box4.IUndoManager"),b.Za("CanvasContextual.ICanvasContextualController"),new De.a(()=>vb.App.xa.jb.Yc))).singleInstance()}init(){this.W.resolve("Box4.IFeatureHelper").Yk.continueWith(()=>{this.Tm()})}Tm(){const b=this.W.resolve("Box4.IFeatureHelper");this.W.Za("WordEditor.CanvasContextualProvider.UxManager");this.W.resolve("WordEditor.IntelligentPlaceholder.IntelligentPlaceholderActor").Vb();
this.W.resolve("WordEditor.IntelligentPlaceholder.IntelligentPlaceholderTelemetry").Khk();this.M4=this.W.resolve("WordEditor.IntelligentPlaceholder.IIntelligentPlaceholderInternalEditor");dt.a.B6j(Object(u.a)(this.M4,this.M4.sfh,"beforeIntelligentPlaceholderPaste"));dt.a.pyc(Object(u.a)(this.M4,this.M4.Uxi,"onIntelligentPlaceholderPaste"));this.tld=this.W.resolve("WordEditor.IntelligentPlaceholder.IntelligentPlaceholderSelectionCache");b.isFeatureEnabled(100)||this.tld.QA();this.Eed=this.W.resolve("WordEditor.IntelligentPlaceholder.IntelligentPlaceholderKeyboardListener");
this.Eed.uzc(vb.App.xa.jb,rc.KeyInputManager.instance);this.Rln(this.W.Za("Box4.Accessibility.IAccessibilityContextManager"),this.W.resolve("Box4.IParagraphReader"),this.W.resolve("WordEditor.CommentsInteractive.ICommentEditor"))}dispose(){this.tld&&this.tld.dispose();this.Eed&&this.Eed.dispose();this.M4&&(dt.a.orn(Object(u.a)(this.M4,this.M4.sfh,"beforeIntelligentPlaceholderPaste")),dt.a.Rrn(Object(u.a)(this.M4,this.M4.Uxi,"onIntelligentPlaceholderPaste")))}Rln(b,h,r){b&&b.execute(z=>{z.i3(new Va(h,
r))})}static main(){O.a.instance.Oc(new us)}}Object(n.a)(us,"PackageManager",null,[1,2]);var sr=window.FindReplaceTaskPaneData={name:"CommandUI",attrs:{xmlns:"http://schemas.microsoft.com/sharepoint/"},children:[{name:"TaskPane",attrs:{Id:"FindReplaceTaskPane",Title:"STR@L_NavigationPaneTitle",Width:"300"},children:[{name:"Groups",attrs:{},children:[{name:"Group",attrs:{Id:"GroupNavControls",IsStretched:"false"},children:[{name:"Section",attrs:{Type:"OneRow"},children:[{name:"Row",attrs:{Id:"NavControls",
DisplayMode:"Medium",TextAlign:"Left"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"btnHeadings",Command:"0xD0FBCB6A",LabelText:"STR@L_NavigationPaneHeadingsSubtitle"}},{name:"Button",attrs:{Id:"btnFind",Command:"0x7EC3CC8E",LabelText:"STR@L_Find"}},{name:"Button",attrs:{Id:"btnReplace",Command:"0x8358F6C1",LabelText:"STR@L_Replace"}}]}]}]}]},{name:"Group",attrs:{Id:"GroupFindInput",IsStretched:"false"},children:[{name:"Section",attrs:{Type:"TwoRow"},children:[{name:"Row",
attrs:{Id:"SearchBoxPlaceholder",DisplayMode:"Medium"}},{name:"Row",attrs:{Id:"RowFindFilters",DisplayMode:"Medium",TextAlign:"Right"},children:[{name:"Controls",attrs:{},children:[{name:"Label",attrs:{Id:"LabelFilters",Command:"0x2F9A3D80",QueryCommand:"0x5E7080C7"}}]}]}]}]},{name:"Group",attrs:{Id:"GroupReplaceInput",IsStretched:"false"},children:[{name:"Section",attrs:{Type:"OneRow"},children:[{name:"Row",attrs:{Id:"ReplacePlaceholder",DisplayMode:"Medium"}}]}]},{name:"Group",attrs:{Id:"GroupReplaceControls",
IsStretched:"false"},children:[{name:"Section",attrs:{Type:"OneRow"},children:[{name:"Row",attrs:{Id:"RowReplaceButtons",DisplayMode:"Medium",TextAlign:"Right"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"ButtonReplace",Command:"0x3F2E19EE",LabelText:"STR@L_Replace"}},{name:"Button",attrs:{Id:"ButtonReplaceAll",Command:"0x69D75659",LabelText:"STR@L_ReplaceAll"}}]}]}]}]},{name:"Group",attrs:{Id:"GroupFindControls",IsStretched:"false"},children:[{name:"Section",attrs:{Type:"OneRow"},
children:[{name:"Row",attrs:{DisplayMode:"Medium"},children:[{name:"Controls",attrs:{},children:[{name:"Label",attrs:{Id:"LabelSummary",Command:"0x2F9A3D80",QueryCommand:"0x7F7A1460"}}]}]}]},{name:"Section",attrs:{Type:"OneRow",HorizontalAlignment:"Right"},children:[{name:"Row",attrs:{Id:"RowFindButtons",DisplayMode:"Small"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"ButtonFindPrevious",Alt:"STR@L_FindPrevious",Command:"0x4457C7F4",QueryCommand:"0x89A9BD2C",Image16by16:"IMGMAP@we@UpArrow_16x16x32",
LabelText:"STR@L_FindPrevious"}},{name:"Button",attrs:{Id:"ButtonFindNext",Alt:"STR@L_FindNext",Command:"0xB28AED00",Image16by16:"IMGMAP@we@DownArrow_16x16x32",QueryCommand:"0x8CA2CFB8",LabelText:"STR@L_FindNext"}}]}]}]}]},{name:"Group",attrs:{Id:"FindResultsPlaceholder",IsStretched:"true"}},{name:"Group",attrs:{Id:"GroupOutOfSyncResultsNotification",IsStretched:"false"}}]}]}]},dr=d(1941),tr=d(1842),wo=d(1913);class Vt{}Vt.L0n="Search_16x16x32";Vt.D0n="ClosePaneGlyph_16x16x32";Object(n.a)(Vt,"SearchBoxIcons",
null,[]);var fB=d(1916),er=d(1917),zv=d(1915);class gw{constructor(){this.vEg=null}get key(){return"FIND_HIT"}get mw(){return WordEditorIntl.WordEditorStrings.l_FindHitContentTitle}reset(b){this.vEg=b.node.yLa()}ZEa(b){let h=null;for(let r of this.vEg)if(r.begin<=b&&b<r.end)return h=Object.assign(new Mm.a,{QF:this.key,contentObject:r}),{returnValue:!0,XE:h};return{returnValue:!1,XE:h}}}Object(n.a)(gw,"FindHitDetailsProvider",null,[268,269]);var kz=d(1599),ty=d(1546),gB=d(1581);class Pu{constructor(b,
h,r,z,R,ba,ta,Wa=null,ub=null){this.Sl=null;this.find=(Ib,$b,fc,Kc,ed)=>1===fc?32:void 0===ed||null===ed?8:ed.length?this.q2f(ed):(this.BVe(wo.a.initial),32);this.findInDocument=(Ib,$b,fc,Kc,ed)=>this.h5i(Oa.a.Nkb,Ib,$b,fc,Kc,ed);this.T8k=(Ib,$b,fc,Kc,ed)=>this.h5i(Oa.a.Pkb,Ib,$b,fc,Kc,ed);this.WHh=(Ib,$b,fc)=>1===fc?32:this.q2f(this.Xn.tLa());this.aWc=(Ib,$b,fc,Kc,ed)=>{Ib=!this.Xn.lF;ed[be.a.Image16by16Class]=Ib?Wh.getImageClass(Vt.L0n):Wh.getImageClass(Vt.D0n);ed[be.a.LabelText]=Ib?WordEditorIntl.WordEditorStrings.L_SearchFilterTooltip:
WordEditorIntl.WordEditorStrings.l_SearchFilterCancelTooltip;ed[be.a.ApplyLabelTextToControlOnly]=!0;ed[be.a.EnsureControlRoleIsButton]=!0;ed[be.a.On]=!1;return 32};this.W9k=(Ib,$b,fc)=>{if(1===fc)return 32;this.U1h(!1);return 32};this.f$k=(Ib,$b,fc)=>{if(1===fc)return 32;this.U1h(!0);return 32};this.UOf=(Ib,$b,fc,Kc,ed)=>{ed[Ik.a.Visible]=this.Xn.o5i;return 32};this.dPf=(Ib,$b,fc,Kc,ed)=>{ed[Ik.a.Visible]=this.Xn.o5i;return 32};this.aJd=(Ib,$b,fc,Kc,ed)=>{if(1===fc)return 32;this.cA.SYc.Z1h(ed);
return 32};this.cancelSearch=(Ib,$b,fc)=>{if(1===fc)return 32;this.BVe(wo.a.initial);return 32};this.fBc=(Ib,$b,fc)=>{if(1===fc)return 32;this.BVe(wo.a.initial);this.Xn.XA(!1);return 32};this.clearSearch=(Ib,$b,fc)=>{if(1===fc)return this.G$l(Ib===ab.a.hnh);this.Xn.clearSearch();return 32};this.Nce=(Ib,$b,fc)=>{if(1===fc)return 32;switch(Ib){case ab.a.m9e:this.Xn.matchCase=!this.Xn.matchCase;break;case ab.a.B9e:this.Xn.matchWholeWord=!this.Xn.matchWholeWord}return this.q2f(this.Xn.tLa())};this.h1d=
(Ib,$b,fc,Kc,ed)=>{ed[Yf.a.On]=this.Xn.matchCase;return 32};this.j1d=(Ib,$b,fc,Kc,ed)=>{ed[Yf.a.On]=this.Xn.matchWholeWord;return 32};this.FOf=(Ib,$b,fc,Kc,ed)=>{Ib=this.Xn.matchCase;$b=this.Xn.matchWholeWord;fc="";Ib&&$b?fc=String.format(WordEditorIntl.WordEditorStrings.l_FindMultipleFiltersLabelText,WordEditorIntl.WordEditorStrings.l_MatchCase,WordEditorIntl.WordEditorStrings.l_MatchWholeWord):Ib?fc=String.format(WordEditorIntl.WordEditorStrings.l_FindFilterLabelText,WordEditorIntl.WordEditorStrings.l_MatchCase):
$b&&(fc=String.format(WordEditorIntl.WordEditorStrings.l_FindFilterLabelText,WordEditorIntl.WordEditorStrings.l_MatchWholeWord));ed[fe.a.Value]=fc;ed[fe.a.Visible]=Ib||$b;return 32};this.Jbc=(Ib,$b,fc,Kc,ed)=>{Ib=this.Xn.M0;$b="";switch(this.Xn.lF){case wo.a.startSearch:$b=WordEditorIntl.WordEditorStrings.l_SummarySearching;break;case wo.a.searching:$b=Ib?this.hhf(WordEditorIntl.WordEditorStrings.l_SummarySomeResults):WordEditorIntl.WordEditorStrings.l_SummarySearching;break;case wo.a.searchComplete:$b=
this.hhf(WordEditorIntl.WordEditorStrings.l_SummaryAllResults);break;case wo.a.tooManyResults:$b=this.hhf(this.Xn.oCa?WordEditorIntl.WordEditorStrings.l_SummaryAllResults:WordEditorIntl.WordEditorStrings.l_SummarySomeResults);break;case wo.a.noMatchesFound:$b=WordEditorIntl.WordEditorStrings.l_SummaryNoMatches;break;case wo.a.replaceAllInProgress:$b=WordEditorIntl.WordEditorStrings.l_ReplaceAllInProgress;break;case wo.a.replaceAllComplete:$b=WordEditorIntl.WordEditorStrings.l_ReplaceAllComplete}ed[fe.a.Value]=
$b;return 32};this.i1d=(Ib,$b,fc,Kc,ed)=>{ed&&(ed.CommandValueId=this.Xn.tLa());return 32};this.replace=(Ib,$b,fc,Kc,ed)=>{if(1===fc)return this.etf()?32:8;if(!this.etf())return 8;Ib=this.Xn.RAb();"string"===typeof ed&&ed&&(Ib=ed);v.ULS.sendTraceTag(6033813,312,50,"Replace Called");Lb.a("NavigationPaneReplace");ed=this.Vsb.replace(Ib);this.Xn.vHn(ed);return 32};this.replaceAll=(Ib,$b,fc,Kc,ed)=>{if(1===fc)return this.mjm()?32:8;Ib=this.Xn.RAb();"string"===typeof ed&&ed&&(Ib=ed);Lb.a("NavigationPaneReplace");
this.Sl=this.le.hg("UserAction","ReplaceAll");this.Xn.C5(wo.a.replaceAllInProgress);v.ULS.sendTraceTag(4065348,312,50,"Replace All started feedback indicated to user.");gB.a.$tn(this.Xn.tLa(),this.Xn.RAb());this.Vsb.replaceAll(Ib,this.nWm);return 32};this.nWm=(Ib,$b)=>{this.Sl&&(this.Sl.stop(),this.Sl=null);v.ULS.sendTraceTag(4065349,312,50,"{0}",{["ReplaceAll Complete.ReplaceCount"]:Ib,["TotalCount"]:$b});gB.a.Xtn(Ib,$b);this.Xn.C5(wo.a.replaceAllComplete)};this.jIi=(Ib,$b,fc,Kc,ed)=>{$b=!1;if(!ed)return 8;
this.Xn.hh.isVisible&&($b=Ib===Oa.a.vWc===this.Xn.zJc());Ib!==Oa.a.vWc||this.iMg||($b=!1);ed[Yf.a.On]=$b;return 32};this.GOf=(Ib,$b,fc,Kc,ed)=>{if(!ed||!this.Xn.hh.isVisible)return 32;ed[Yf.a.On]=this.Xn.oCa;return 32};this.IOf=(Ib,$b,fc,Kc,ed)=>{if(!ed)return 32;ed.currentFindReplaceViewType=this.Xn.lF;return 32};this.fcn=(Ib,$b,fc,Kc,ed)=>{if(1===fc)return 32;Ib=ed[Yf.a.On];ed&&(ed[Yf.a.On]=this.Xn.hh.isVisible);Ib&&!ed[Yf.a.On]&&(Pu.Qcj(),Lb.a("NavigationPaneCrossClick"));return 32};this.sQa=(Ib,
$b,fc,Kc,ed)=>{const Jd=this.Xn.hh.isVisible;v.ULS.sendTraceTag(42501021,367,50,"Visibility: {0}",Jd);return Jd?this.fBc(Ib,$b,fc,Kc,ed):this.Nec(Ib,$b,fc,Kc,ed)};this.Nec=(Ib,$b,fc,Kc,ed)=>{if(1===fc)return!Xh.SessionStatusManager.instance.jK||ze.a.gfa($b)?8:32;if(2===fc){t.AFrameworkApplication.naa("AutoDetectedHeadingsIsEnabled");Pu.Qcj();this.k3();kz.FindReplaceUIManager.Fok(Ib,ed,this.Xn.hh.isVisible);$b=!0;Ib===Oa.a.Sec&&void 0!==ed&&null!==ed&&($b=ed);this.Xn.XA(!0,$b);ed=zv.a.initial;switch(Ib){case Oa.a.Oec:v.ULS.sendTraceTag(42501022,
367,50,"");ed=zv.a.headings;break;case Oa.a.Nkb:ed=zv.a.find;break;case Oa.a.Pkb:ed=zv.a.replace;break;case Oa.a.Sec:ed=zv.a.intelligentPlaceholder;break;case Oa.a.sQa:ed=this.Xn.Gbb,ed||(v.ULS.sendTraceTag(42501023,367,50,""),ed=zv.a.headings)}this.Xn.oMn(ed,$b);return 32}return 8};this.R0a=()=>{this.Xn.lF&&!this.Xn.oCa&&v.ULS.sendTraceTag(5007322,312,50,"App closed when find is in progress.")};this.ga=b;this.Xn=h;this.cA=r;this.Vsb=z;this.iMg=R;this.le=ta;ub&&ub(1,this.R0a,null);this.ZGa=Wa}k3(){}Vb(){this.ga.gb(Oa.a.uPf,
kc.a.view,this.fcn,96);this.ga.pa(Oa.a.sQa,kc.a.view,this.sQa);this.ga.pa(Oa.a.Oec,kc.a.view,this.Nec);this.ga.pa(Oa.a.Nkb,kc.a.view,this.Nec);this.ga.pa(Fb.a.ICd,kc.a.view,this.find);this.ga.pa(ab.a.findInDocument,kc.a.view,this.findInDocument);this.ga.pa(Fb.a.findOnPage,kc.a.view,this.WHh);this.ga.gb(ab.a.Ibn,kc.a.view,this.aWc,97);this.ga.pa(Fb.a.QVd,kc.a.view,this.W9k);this.ga.pa(Fb.a.z0d,kc.a.view,this.f$k);this.ga.gb(Fb.a.UOf,kc.a.view,this.UOf,97);this.ga.gb(Fb.a.dPf,kc.a.view,this.dPf,97);
this.ga.pa(Oa.a.aJd,kc.a.view,this.aJd);this.ga.pa(Fb.a.rwb,kc.a.view,this.cancelSearch);this.ga.pa(ab.a.clearSearch,kc.a.view,this.clearSearch);this.ga.pa(ab.a.hnh,kc.a.application,this.clearSearch);this.ga.pa(Oa.a.fBc,kc.a.view,this.fBc);this.ga.pa(ab.a.m9e,kc.a.view,this.Nce);this.ga.pa(ab.a.B9e,kc.a.view,this.Nce);this.ga.gb(ab.a.h1d,kc.a.view,this.h1d,97);this.ga.gb(ab.a.j1d,kc.a.view,this.j1d,97);this.ga.gb(Oa.a.FOf,kc.a.view,this.FOf,97);this.ga.gb(Oa.a.Jbc,kc.a.view,this.Jbc,97);this.ga.gb(Oa.a.GOf,
kc.a.view,this.GOf,97);this.ga.gb(Oa.a.IOf,kc.a.view,this.IOf,97);this.ga.gb(Oa.a.HOf,kc.a.view,this.jIi,97);Object(ty.b)()&&this.ga.gb(Oa.a.i1d,kc.a.view,this.i1d,96);this.iMg&&(this.ga.gb(Oa.a.Pkb,kc.a.view,this.Nec,1028),this.ga.gb(Oa.a.vWc,kc.a.view,this.jIi,97),this.ga.gb(Oa.a.replace,kc.a.view,this.replace,1028),this.ga.gb(Oa.a.replaceAll,kc.a.view,this.replaceAll,1028),t.AFrameworkApplication.K.$("SmartLookupEnableNativePane")&&t.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentSearch",
!1)&&this.ga.gb(ab.a.v9e,kc.a.view,this.T8k,1028));this.ga.pa(Oa.a.Sec,kc.a.view,this.Nec)}cRf(){this.ZGa&&this.ZGa.execute(b=>{b.i3(new gw)})}h5i(b,h,r,z,R,ba){if(1===z)return Xh.SessionStatusManager.instance.jK?32:8;if(void 0===ba||null===ba)return 8;this.Nec(b,r,2,R,ba);b=this.Xn;b.XXf(ba.CommandValueId);Object(ty.b)()&&("MatchCase"in ba&&(b.matchCase=ba.MatchCase),"MatchWholeWord"in ba&&(b.matchWholeWord=ba.MatchWholeWord));return this.WHh(h,r,z,R,ba)}q2f(b){if(void 0===b||null===b||!b.length)return 32;
b=fB.a.createQuery(b,this.Nbn);if(void 0===b||null===b)return v.ULS.sendTraceTag(4069067,312,10,"InvalidQuery"),8;this.cA.find(b);return 32}get Nbn(){let b=er.a.none;this.Xn.matchCase&&(b|=er.a.matchCase);this.Xn.matchWholeWord&&(b|=er.a.wholeWordOnly);return b}U1h(b){this.Xn.Gbb!==zv.a.headings&&this.Xn.M0&&(b?this.cA.SYc.HQl():this.cA.SYc.W1h())}BVe(b){this.Xn.lF&&(this.Xn.oCa||v.ULS.sendTraceTag(5007321,312,50,"User action resulting in cancelling find operation in progress."),this.cA.VVa(),this.Xn.C5(b))}G$l(b){return this.Xn.lF===
wo.a.replaceAllInProgress||b&&!this.Xn.lF?8:32}hhf(b){return String.format(b,this.Xn.h9c,this.Xn.M0)}etf(){return this.Xn.zJc()&&0<this.Xn.M0}mjm(){return this.etf()&&this.Xn.oCa}static Qcj(){null!=t.AFrameworkApplication.K&&t.AFrameworkApplication.K.$("NavPaneFloodgateIsEnabled")&&window.setTimeout(()=>{const b=Sa.a.instance.Za("Common.ISystemInitiatedFeedback");b&&b.execute(h=>{h.logActivity("NavPaneUsed","NavPaneFloodgateIsEnabled")})},Pu.zka)}static Vrl(b,h,r,z){return new Pu(t.AFrameworkApplication.ya,
b,h,r,z,ve.FocusManager.instance(),vb.App.xa.jq,Sa.a.instance.Za("Box4.Accessibility.IAccessibilityContextManager"),Object(u.a)(t.AFrameworkApplication.ua.wM,t.AFrameworkApplication.ua.wM.mb,"registerHandler"))}static Trl(b,h,r,z){return Pu.Vrl(b,h,r,z)}}Pu.zka=5E3;Object(n.a)(Pu,"FindReplaceActor",null,[]);var hB=d(198),hw=d(885),Av=function(){function b(){this._map=new Map}Object.defineProperty(b.prototype,"first",{get:function(){return this.GH},set:function(h){this.GH=h},enumerable:!1,configurable:!0});
Object.defineProperty(b.prototype,"last",{get:function(){return this.WRb},enumerable:!1,configurable:!0});b.prototype.length=function(){return this._map.size};b.prototype.get=function(h){return this._map.get(h)};b.prototype.insert=function(h,r){this.removeItem(h);r={key:h,Maa:this.WRb,next:void 0,data:r};this.first||(this.first=r);this.WRb&&(this.WRb.next=r);this.WRb=r;this._map.set(h,r)};b.prototype.insertAfter=function(h,r,z){h=this._map.get(h);if(!h)return!1;z={key:r,Maa:h,next:h.next,data:z};
var R=h.next;R&&(R.Maa=z);h.next=z;this._map.set(r,z);return!0};b.prototype.insertBefore=function(h,r,z){h=this._map.get(h);if(!h)return!1;z={key:r,Maa:h.Maa,next:h,data:z};var R=h.Maa;R&&(R.next=z);h.Maa=z;this._map.set(r,z);return!0};b.prototype.removeItem=function(h){var r=this._map.get(h);r&&(this.first===r&&(this.first=r.next),this.WRb===r&&(this.WRb=r.Maa),r.Maa&&(r.Maa.next=r.next),r.next&&(r.next.Maa=r.Maa),this._map.delete(h))};return b}();class Sn{constructor(){this.type="heading"}}Object(n.a)(Sn,
"NavPaneHeadingItem",null,[]);class iB{constructor(){this.type="bookmark"}}Object(n.a)(iB,"NavPaneBookmarkItem",null,[]);class jB{constructor(b,h,r,z,R,ba){var ta,Wa;this.fb=b;this.ib=h;this.Wb=r;this.nl=z;this.Bi=R;this.iB=ba;this.OTa=0;this.Ogd=new Map;this.tHg=!1;this.izf={[1]:1,[0]:1,[2]:1};this.Kwa=new Map;this.nug=null===(ta=t.AFrameworkApplication.K)||void 0===ta?void 0:ta.getBooleanFeatureGate("Microsoft.Office.WordOnline.NavPaneADHToggleDefaultOff",!1);this.ENj=null===(Wa=t.AFrameworkApplication.K)||
void 0===Wa?void 0:Wa.getBooleanFeatureGate("Microsoft.Office.WordOnline.NavPaneShowNumberListedHeadings",!1)}get headingsReady(){return this.tHg}set headingsReady(b){this.tHg=b}get FHb(){return this.OTa}get Jaa(){this.pTb&&0!=this.pTb.length()||(this.pTb=this.E7m());return this.pTb}set Jaa(b){this.pTb=b}get xdc(){return this.ITj}set xdc(b){this.xdc&&(this.xdc.isSelected=!1);b.isSelected=!0;this.ITj=b}Kff(b,h){return"bookmark"===b.type?b.text:h.id.toString()}E7m(){var b;const h=new Av;var r=null===
(b=this.Bi.value)||void 0===b?void 0:b.kDi;if(!r)return h;this.Ogd=new Map;b=r.YCd();let z;const R=[];for(;b;){const ba=this.Bi.value.Eb(b.id);r=this.DUh(ba,R);null===r||void 0===r?void 0:r.forEach(ta=>{(z=this.qWh(ta,R))&&"heading"===z.type&&z.indentLevel<ta.indentLevel&&(1>=z.indentLevel?(z.isCollapsed=!1,ta.isHidden=!1):(z.isCollapsed=!0,ta.isHidden=!0));h.insert(this.Kff(ta,ba),ta)});b=b.next}return h}qWh(b,h){return"heading"===b.type?1<h.length?h[h.length-2]:void 0:0<h.length?h[h.length-1]:void 0}I8f(b){var h;
let r=ie.ParagraphReader.dBa(b),z=!1;9===r&&this.Kwa.has(b.id.toString())&&(r=this.Kwa.get(b.id.toString()),z=!0);const R=null===(h=this.Jaa.get(b.id.toString()))||void 0===h?void 0:h.data;if(R){if(R.indentLevel===r){h=dd.AParagraphNode.lU(b.characterData.trim());b=this.nl.value.XZd(b,!1);if(h!==R.text||R.hasBookmark!==b)return R.text=h,R.hasBookmark=b,!0;!z&&R.isPurelyADH&&(R.isPurelyADH=!1,--this.OTa);return!1}this.oVc();return!0}if(9===r)return this.v9l(b)?(this.oVc(),!0):!1;this.oVc();return!0}v9l(b){var h;
const r=this.nl.value.Hbf(b,!1);b=null!==(h=this.Ogd.get(b.id.toString()))&&void 0!==h?h:0;if(b!==r.length)return!0;for(h=0;h<b;++h)if(!this.Jaa.get(r[h].dLa()))return!0;return!1}WSk(b){if(this.Jaa.get(b.id.toString())||this.nl.value.XZd(b,!1))return this.oVc(),!0;this.Kwa.has(b.id.toString())&&(this.Kwa.delete(b.id.toString()),--this.OTa);return!1}oVc(){var b,h=null===(b=this.Bi.value)||void 0===b?void 0:b.kDi;const r=new Av;this.OTa=0;if(h){this.Ogd=new Map;var z=[];b=h.YCd();for(var R,ba;b;){const ta=
this.Bi.value.Eb(b.id);h=this.DUh(ta,z);null===h||void 0===h?void 0:h.forEach(Wa=>{var ub=this.Kff(Wa,ta);ba=this.qWh(Wa,z);this.wyn(ub,Wa,ba);r.insert(ub,Wa);"heading"===(null===R||void 0===R?void 0:R.type)&&(ub=R,ub.indentLevel>=Wa.indentLevel&&(ub.isCollapsed=void 0));R=Wa});b=b.next}}this.Jaa=r}wyn(b,h,r){var z,R;if(b=null===(z=this.pTb.get(b))||void 0===z?void 0:z.data)b.isSelected&&(h.isSelected=!0,this.xdc=h),h.isHidden=b.isHidden;if(r){if(z=null===(R=this.pTb.get(this.Kff(r,r.paragraphNode)))||
void 0===R?void 0:R.data)r.isCollapsed=z.isCollapsed;r.isCollapsed?h.isHidden=!0:r.isHidden?(r.isCollapsed=!0,h.isHidden=!0):(r.isCollapsed=!1,h.isHidden=!1)}}DUh(b,h){var r=ie.ParagraphReader.dBa(b),z=!this.drf(b);const R=this.dem(r)&&z?!0:!1;z=this.Kwa.has(b.id.toString())&&z;let ba=[];if(R)ba.push(this.Sth(b,r,!1,h));else if(z)this.OTa+=1,this.GFc&&(r=this.Kwa.get(b.id.toString()),ba.push(this.Sth(b,r,!0,h)));else{let ta=0;this.nl.value.Hbf(b,!1).forEach(Wa=>{const ub=new iB;ub.text=Wa.dLa();ub.isSelected=
!1;ub.bookmarkManager=this.nl;ub.indentLevel=0<h.length?h[h.length-1].indentLevel+1:0;ta+=1;ba.push(ub)});this.Ogd.set(b.id.toString(),ta)}return ba}Sth(b,h,r,z){var R,ba;const ta=new Sn;ta.text=dd.AParagraphNode.lU(b.characterData.trim());ta.indentLevel=h;ta.paragraphNode=b;ta.isSelected=!1;ta.isPurelyADH=r;this.ENj&&(ta.listMarker=this.dgf(b));ta.hasBookmark=this.nl.value.XZd(b,!1);for(b=null===(R=z[z.length-1])||void 0===R?void 0:R.indentLevel;b&&b>=h;)z.pop(),b=null===(ba=z[z.length-1])||void 0===
ba?void 0:ba.indentLevel;(!b||b<h)&&z.push(ta);return ta}drf(b){return this.fb.nc(b)&&0===this.fb.textLength(b,this.izf[hB.a.Ri]|4)}t5k(b){(b=this.Jaa.get(b))&&(1==b.data.isCollapsed?this.t5i(b):this.kYl(b))}onClickHeading(b){var h;this.xdc=b=null===(h=this.Jaa.get(b))||void 0===h?void 0:h.data;h=Hf.SelectionFactory.xe(b.paragraphNode,0);this.ib.setSelection(h);this.Wb.Jg(ke.AFrame.Zp)}onClickBookmark(b){var h;this.xdc=b=null===(h=this.Jaa.get(b))||void 0===h?void 0:h.data;this.nl.value.xjf(b.text)}W7f(b,
h){const r=b.id.toString(),z=this.Kwa.has(r);if(!z||this.Kwa.get(r)!==h){this.Kwa.set(r,h);if(this.GFc)return this.I8f(b);!this.nug||z||this.Jaa.get(r)||(this.OTa+=1)}return!1}qSk(b){const h=b.id.toString(),r=this.Kwa.has(h);if(r){this.Kwa.delete(h);if(this.GFc)return this.I8f(b);this.nug&&r&&!this.Jaa.get(h)&&--this.OTa}return!1}A9n(b){this.GFc=b;this.oVc()}u8f(b){var h;const r=null===(h=this.Jaa.get(b.id.toString()))||void 0===h?void 0:h.data;if(!r)return!1;b=this.dgf(b);if(r.listMarker===b)return!1;
this.lgo();return!0}e3e(b){var h;b=null===(h=this.Jaa.get(b.id.toString()))||void 0===h?void 0:h.data;if(!b||void 0===b.listMarker)return!1;b.listMarker=void 0;return!0}t5i(b){var h=b.data;1==h.isCollapsed&&(h.isCollapsed=!1);h=h.indentLevel;b=b.next;let r;for(;b&&b.data.indentLevel>h;)r=b,b=r.next,r.data.isHidden=!1,"heading"==r.data.type&&(b=r.data.isCollapsed?this.ZZn(r):this.t5i(r));return b}kYl(b){var h=b.data;h.isCollapsed=!0;h=h.indentLevel;b=b.next;let r;for(;b&&b.data.indentLevel>h;)r=b,
b=r.next,r.data.isHidden=!0}ZZn(b){const h=b.data.indentLevel;for(b=b.next;b&&b.data.indentLevel>h;)b=b.next;return b}dem(b){return 0<=b&&8>=b}lgo(){let b=this.Jaa.first;for(;b;){if("heading"===b.data.type){const h=b.data;h.listMarker=this.dgf(h.paragraphNode)}b=b.next}}dgf(b){var h;if(b.kW instanceof hw.a)return this.DOl(null===(h=this.iB.f0a(b.kW))||void 0===h?void 0:h.K2)}DOl(b){for(let h=0;h<(null===b||void 0===b?void 0:b.length);)return 128<=b.charCodeAt(h)?void 0:b}}Object(n.a)(jB,"NavPaneHeadingsManager",
null,[]);var uy=d(1547);class Ix{constructor(){this.Vsb=this.cA=this.Bnc=this.nad=this.W=null}get name(){return"WordEditor.FindReplace"}yc(b){this.W=b;const h=new jB(Sa.a.instance.resolve("Box4.IParagraphReader"),Sa.a.instance.resolve("Box4.ISelectionManager"),ve.FocusManager.instance(),Sa.a.instance.ef("WordEditor.Bookmark.IBookmarkManager"),new De.a(()=>vb.App.xa.jb.Yc.zd),b.resolve("Box4.IListMarkerUtility"));this.W.ha("WordEditor.FindReplace.NavPaneHeadingsManager",()=>h).as("WordEditor.FindReplace.NavPaneHeadingsManager").singleInstance()}init(){Ix.Qb.Yk.continueWith(()=>
{this.Tm()})}Tm(){if(vb.App.eag){const b=vb.App.kee;this.Bnc=kz.FindReplaceUIManager.getInstance(b);this.cA=tr.FindManager.createInstance(this.Bnc,dr.a.instance,uy.a.instance,!0);this.Vsb=this.cA.yIb;this.nad=Pu.Trl(this.Bnc,this.cA,this.Vsb,b);this.nad.Vb();this.nad.k3();this.nad.cRf();vb.App.xa.updateCommandUI()}}dispose(){this.Bnc&&this.Bnc.dispose()}static get Qb(){return null!=Ix.$ig?Ix.$ig:Ix.$ig=Sa.a.instance.resolve("Box4.IFeatureHelper")}}Object(n.a)(Ix,"FindReplacePackageManager",null,[1,
2]);class BB{constructor(){}waf(){return"_@_"+pa.a.create().toString().replace(RegExp("-","g"),"").toUpperCase()+"Z"}Xio(b,h,r,z){h.wHn(b,z);h.$l(b,We.a.K7,!0);h.$l(b,yc.a.MMa,!0);h.$l(b,yc.a.fieldInstruction,BB.SGh(r));h.$l(b,yc.a.Eq,15)}N9j(b,h,r,z){const R=b.nxd(z);h.$l(R,We.a.K7,!0);h.$l(R,yc.a.Eq,47);h.$l(R,yc.a.fieldInstruction,BB.SGh(r));b=b.nxd(z);h.$l(b,We.a.K7,!0);h.$l(b,yc.a.Eq,16);return[R.Bj,b.Bj]}qfl(b,h,r){b=b.nxd(r);h.$l(b,We.a.K7,!0);h.$l(b,yc.a.ODb,!0);return b.Bj}static SGh(b){return String.format(' HYPERLINK "{0}"',
b)}}Object(n.a)(BB,"AtMentionHyperlinkConfigurator",null,[474]);class VC{constructor(b,h,r){this.Drc=b;this.ib=h;this.y3h=this.oai=this.yue=!1;this.TGf=this.TGf.bind(this);this.iHf=this.iHf.bind(this);this.gIf=this.gIf.bind(this);r&&r.execute(z=>{this.Sha=z});pk.a.Asd.adf.then(z=>{this.y3h=!0;this.oai=z.isSuccess})}mMi(){this.Drc.hMi(this.TGf);this.Drc.iMi(this.iHf);this.Drc.uMi(this.gIf)}Fsf(){return!1}TGf(b,h,r){var z,R;h=Date.now();if(this.Sha)if(this.y3h&&!this.oai)v.ULS.sendTraceTag(512369951,
3034,10,"ContextIQUserInitHandler::onInputCallback - AugLoop Auth Token is not valid.");else{var ba=null===(R=null===(z=this.ib.hb)||void 0===z?void 0:z.kb)||void 0===R?void 0:R.Tc;ba?(z=ba.node,ie.ParagraphReader.nc(z)?(R=ie.ParagraphReader.text(z),0>r||r>R.length?v.ULS.sendTraceTag(540340298,3034,50,"ContextIQUserInitHandler::onInputCallback - Position of the @ was not within the bounds of the paragraph."):(this.yue||(this.yue=!0,this.Sha.fZn(ba)),this.Sha.d8f(r,r+b.length),b=R.substring(0,r)+b,
this.Sha.Haf(z,b,r,h))):v.ULS.sendTraceTag(540541835,3034,10,"ContextIQUserInitHandler::onInputCallback - Current node is not a paragraph.")):v.ULS.sendTraceTag(540541834,3034,10,"ContextIQUserInitHandler::onInputCallback - Failed to get the current selection context.")}else v.ULS.sendTraceTag(537776153,3034,10,"ContextIQUserInitHandler::onInputCallback - ContextIQIntentProvider is not available yet.")}iHf(b){if(this.Sha)this.Sha.onKeyDown(b)}gIf(){this.yue=!1;this.Sha&&this.Sha.Qnh()}}Object(n.a)(VC,
"ContextIQUserInitHandler",null,[396]);var ku=d(1705);class Mo{constructor(){this.iz=null}get name(){return"WordEditor.AtMentions"}yc(b){this.W=b;b.ha("Box4.IAtMentionHyperlinkConfigurator",()=>new BB(b.resolve("Box4.IFeatureHelper"))).singleInstance();const h={crewAlias:Mo.Fnj,featureName:Mo.cpj,topLevelKpiName:Mo.zsj,vetoPillar:7};b.ha("WordEditor.AtMentions.IFeatureUsageAndHealthLogger",()=>new gk.a(Ca.Health.instance,new yi.a,h)).as("WordEditor.AtMentions.IFeatureUsageAndHealthLogger").singleInstance()}init(){this.W.resolve("Box4.IFeatureHelper").Yk.continueWith(()=>
{this.Tm()})}dispose(){}Tm(){t.AFrameworkApplication.K.$("CanvasAtMentionDetectionIsEnabled")&&this.W.Za("Common.App.People.IExternalPeopleAPI").execute(b=>{b.atMentionsEnabledAsync().then(h=>{t.AFrameworkApplication.K.$("ConsumerMentionsHostIsEnabled")&&(h=h&&t.AFrameworkApplication.K.$("WordEditorConsumerCanvasMentionsIsEnabled"));h&&this.tsm()})});this.W.resolve("Box4.IAtMentionHyperlinkConfigurator")}tsm(){(t.AFrameworkApplication.K.$("DynamicBundlesIsEnabled")?appResourceLoader.loadChunk("canvasAtMentions"):
this.W.resolve("Common.IDynamicScriptLoaderProvider").JE.loadScript("canvasAtMentions")).then(()=>{t.AFrameworkApplication.K.zq(()=>{this.qkn()})})}qkn(){const b={peopleAPI:this.W.resolve("Common.App.People.IExternalPeopleAPI"),localizationDetails:{isRightToLeft:t.AFrameworkApplication.isRtl,appLocale:Sys.CultureInfo.CurrentCulture.name},useLPP:!0,isTestEnv:this.Ulm()};this.iz=canvasAtMentions.FactoryGlobal.getWordAtMentionsControllerInstance(b);this.W.Za("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(h=>
{h.isFeatureEnabled("MsoContextIq",!1).then(r=>{r&&ku.a.x5c()?this.W.ha("WordEditor.AtMentions.IWordEditorAtMentionsHandler",()=>new VC(this.W.resolve("Box4.AtMentions.IAtMentionsListener"),this.W.resolve("Box4.ISelectionManager"),this.W.Za("WordEditor.CanvasContextual.ContextIQIntentProvider"))).singleInstance():this.W.ha("WordEditor.AtMentions.IWordEditorAtMentionsHandler",()=>new yg(this.W.resolve("Box4.AtMentions.IAtMentionsListener"),this.iz,this.W.resolve("Box4.ITextMetricsAdapter"),this.W.resolve("Box4.ICaretPositionManager"),
this.W.resolve("Box4.ISelectionManager"),Ya.InteractiveViewManager.instance,this.W.resolve("WordEditor.IntelligentPlaceholder.IIntelligentPlaceholderEditor"),this.W.resolve("WordEditor.IntelligentPlaceholder.IIntelligentPlaceholderKeyboardListener"),this.W.resolve("Common.Utils.IAriaNotifier"),this.W.resolve("WordEditor.AtMentions.IFeatureUsageAndHealthLogger"))).singleInstance();this.W.resolve("WordEditor.AtMentions.IWordEditorAtMentionsHandler").mMi()})})}Ulm(){var b,h;const r=null!==(b=t.AFrameworkApplication.sessionStartInfoSettings.Ring)&&
void 0!==b?b:"-1";b=null!==(h=t.AFrameworkApplication.sessionStartInfoSettings.WACDatacenter)&&void 0!==h?h:"";return r===Mo.tnj&&b===Mo.snj}}Mo.tnj="-4";Mo.snj="DC2";Mo.Fnj="webasynccollabeng";Mo.cpj="AtMentions";Mo.zsj="AtMentionsFeatureUsage";Object(n.a)(Mo,"PackageManager",null,[1,2]);var oo=d(1637);class lu{constructor(){this.iconSet=null;this.hidden=this.disabled=!1;this.customTooltip=this.keytip=this.fullDescriptionLabel=this.iconColor=null;this.shouldTakeFocus=!1}}Object(n.a)(lu,"CommonOptionalButtonProperties",
null,[]);class Ur extends lu{constructor(){super();this.role=this.commandValueId=null;this.supportsPreview=this.hideLabel=!1;this.lang=null}}Object(n.a)(Ur,"OptionalButtonProperties",lu,[]);var Wg=d(1376);class WC{constructor(b,h,r,z,R,ba){this.Jf=b;this.mFe=h;this._augLoopRuntimeManager=r;this.G8c=z;this.iAj=R;this.l_j=ba;this.hxg=this.iYg=this.jYg=this.OEe=0;this.Ppd=!1;this.X5a=null;this.uLg=this.WKg=!1;this.aCj=new Map([["ReferencesSmartLookUp",!0],["SmartLookupSynonyms",!0],["SmartLookupContextMenu",
!0],["SmartLookupDictionary",!0],["ChangePicture",!0]]);this.QAj=[{id:`${es.tbc}_${1}`},{id:`${es.tbc}_${2}`},{id:`${es.tbc}_${3}`},{id:Wg.a.yyd},{id:Wg.a.Xwd},{id:Wg.a.s_d},{id:Wg.a.p_d}];this.ovj=[{id:"NewComment",count:2},{id:"CreatePullQuote"},{id:"DeleteBookmarkContextMenu"},{id:"EditBookmarkNameContextMenu"},{id:"EditIllustration"},{id:"CreateHeadingLink"},{id:"RemoveContentControl"},{id:"ReviewDesignerSuggestion"}];this.h8c=new Map;this.nMg=t.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.SearchSuggestionInContextMenuIsEnabled",
!1);this.dIj=t.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.AdaptiveContextMenuIsEnabled",!1);this.ULg=t.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.PersonalizerInContextMenuIsEnabled",!1);this.uJj=t.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.OpenHyperlinkInlineViewIsEnabled",!1);this.pMj=t.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.WordOnline.AcmMaximumSuggestions",8);this.WKg=t.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.GenericSignalSchemaIsEnabled",
!1);this.uLg=t.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.LoggingIntentIsEnabled",!1);this.oyj=t.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.CanvasContextFeature",!1);this.$Sb=new Map;this.Jf.mb(this,oo.SearchSuggestionAnnotation.getTypeName());t.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.recentLinksIsEnabled",!1)&&(t.AFrameworkApplication.K.$("IsO365CommercialHost")||t.AFrameworkApplication.K.$("IsO365ConsumerHost"))&&
this.h8c.set("InsertLink","InsertLinkFlyout");this.h8c.set("GraphicsEditor","");this.Rfj()}O9m(b,h){const r=Date.now();this.OEe&&1250>r-this.OEe||0<this.$Sb.size||(this.OEe=r,this.X5a=b,this.Amd=this.OJl(h),this.hxn(),this.iYg=Date.now(),this.WKg?this.yvn():this.xvn())}wI(b,h){if(b.annotationType===oo.SearchSuggestionAnnotation.getTypeName()&&b.content&&h===He.a.getTypeName()){h=Date.now();b=b.content;var r=this.$Sb.get(b.correlationId);if(r){window.clearTimeout(r.y5f);this.$Sb.delete(b.correlationId);
r.MEi&&(this.G8c.wzn=r.MEi);var z=b.menuSuggestions&&0<b.menuSuggestions.length,R=b.searchSuggestions&&0<b.searchSuggestions.length,ba=!0;z&&(this.iko(b.menuSuggestions,b.searchSuggestions),this.Ppd&&(ba=!1));ba&&this.TPi();v.ULS.sendTraceTag(572057625,1303,50,JSON.stringify({["description"]:"[Zero term context menu] augloop response latency",["correlationId"]:b.correlationId,["requestPreparationTime"]:this.jYg,["canvasContextRetrievalTime"]:this.hxg,["networkTime"]:b.networkTime,["executionTime"]:b.executionTime,
["updateTime"]:Date.now()-h,["latencyMs"]:h-r.timestamp,["containsZTM"]:z,["expectedZTM"]:r.OBd,["containsSearchSuggestions"]:R,["expectedSearchSuggestions"]:r.h8e,["fallBack"]:ba}))}}}OJl(b){const h=[],r=new Map,z=Date.now();for(const R of b){if(!R)continue;b=[];const ba={itemsMetadata:new Lc.a};for(let ta=0;ta<R.ControlList.length;ta++){const Wa=R.ControlList[ta];if(Wa&&!Wa.ExternalId)continue;b.push(Wa.ExternalId);const ub={timeStamp:z,source:"FallbackZeroTermMenu",confidenceScore:-1};ba.itemsMetadata[Wa.ExternalId]=
ub;r.set(Wa.ExternalId,ub)}h.push(appChrome.api.menuSection(b,R.Title,R.Lang,R.Id,ba))}return{sections:h,commands:r}}scj(b){return this.h8c.has(b)?this.h8c.get(b):b}jFa(b){if(!t.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.DisableUpdateControls",!1)){var h={};for(const r of b)b=this.scj(r.suggestion),appChrome.selectors.isControlDefined(b)&&(h[b]=appChrome.selectors.getModelType(b));vb.App.xa.MDd(h)}}W$l(b){return!appChrome.selectors.isControlDefined(b)||appChrome.selectors.isControlDisabled(b)?
!1:this.aCj.has(b)?this.Amd.commands.has(b):!0}Tvh(b){return appChrome.actions.updateMenu("ZeroTermContextMenu",b,null,null,null,null,{menuTargetType:this.X5a})}gdb(b=!1){b=b?dm.a.instance.xnc:dm.a.instance.gdb();const h=[],r=Date.now();for(let z of b)z.commandId&&h.push({Id:z.commandId,TimeElapsedSinceClick:(r-z.timeStamp)/1E3,ContentType:z.contentType,CommandSurface:z.commandSurface,InputMethod:z.Ww});return h}t2b(){const b=dm.a.instance.t2b(),h=[],r=Date.now();for(let z of b)z.controlId&&h.push({Id:z.controlId,
TimeElapsedSinceClick:(r-z.timeStamp)/1E3,ContentType:z.contentType,CommandSurface:z.commandSurface,InputMethod:z.Ww});return h}Vbf(){let b={semantic:oo.ObjectSemantic.CanvasContext,type:oo.ObjectSchemaType.WordCanvasContext,value:{contentType:this.X5a}};if(this.oyj){const h=Date.now(),r=this.l_j.Vbf(di.a.instance.hb.kb);r&&r.value.contentType&&(b.value=r.value);this.hxg=Date.now()-h}return b}qnl(){const b=this.t2b(),h=this.gdb(),r=this.gdb(!0),z=[];z.push({semantic:oo.ObjectSemantic.ControlIdHistory,
type:oo.ObjectSchemaType.CommandExecutionSequence,value:{SequenceType:oo.SequenceType.ControlId,Sequence:b}});z.push({semantic:oo.ObjectSemantic.CommandIdHistory,type:oo.ObjectSchemaType.CommandExecutionSequence,value:{SequenceType:oo.SequenceType.CommandId,Sequence:h}});z.push({semantic:oo.ObjectSemantic.FilteredCommandIdHistory,type:oo.ObjectSchemaType.CommandExecutionSequence,value:{SequenceType:oo.SequenceType.CommandId,Sequence:r}});z.push(this.Vbf());return z}zWh(){if(!this.ULg)return null;
const b={RankRequestData:{EventId:pa.a.create().toString()},RewardRequestData:this.G8c.vzn};this.G8c.LRi();return b}Rfj(){this._augLoopRuntimeManager.getSession().then(b=>this.g7c=b).catch(()=>{this.g7c=void 0})}yvn(){const b=this.qnl(),h=[oo.IntentIds.ZeroTermMenu];this.uLg&&h.push(oo.IntentIds.Logging);this.nMg&&h.push(oo.IntentIds.KeyPhrases);const r=this.zWh();this.g9i(null,null,r,h,b)}xvn(){const b={CommandClickedEvents:this.t2b(),CommandActionEvents:this.gdb(),ContentType:this.X5a},h=this.nMg?
this.NSh():null,r=this.zWh();this.g9i(b,h,r)}g9i(b,h,r,z,R){var ba,ta,Wa,ub;if(b||R){var Ib=new oo.SearchSuggestionSignal({correlationId:this.Onl(),intents:z,personalizerData:r,contextObjects:R,context:null===h||void 0===h?void 0:h.neighborhood,start:null!==(ba=null===h||void 0===h?void 0:h.mentionStart)&&void 0!==ba?ba:0,length:null!==(ta=null===h||void 0===h?void 0:h.mentionLength)&&void 0!==ta?ta:0,zeroTermMenuRequest:b});r=window.setTimeout(()=>{this.sWm(Ib.correlationId)},750);b={OBd:!!b,h8e:!!h,
timestamp:Date.now(),y5f:r,MEi:null===(ub=null===(Wa=Ib.personalizerData)||void 0===Wa?void 0:Wa.RankRequestData)||void 0===ub?void 0:ub.EventId};this.jYg=Date.now()-this.iYg;this.$Sb.set(Ib.correlationId,b);Wa=new He.l({parentPath:["Signal",oo.SearchSuggestionSignal.getTypeName()],items:[{id:pa.a.create().toString(),body:Ib}]});this.g7c&&!this.g7c.isClosed?this.g7c.submitOperation(Wa):(this._augLoopRuntimeManager.submitOperation({operation:Wa}),this.Rfj());v.ULS.sendTraceTag(574441286,1303,50,JSON.stringify({["description"]:"[Zero term context menu] search suggestion al workflow invocation",
["correlationId"]:Ib.correlationId,["containsZTM"]:b.OBd,["containsSearchSuggestions"]:b.h8e,["intents"]:z}))}else v.ULS.sendTraceTag(556892510,1303,15,"No search suggestion al workflow will be activated")}Onl(){const b=pa.a.create().toString();appChrome.api.setOfeCorrelationId("ACM",b);return b}sWm(b){const h=this.$Sb.get(b);h&&(this.$Sb.delete(b),h.OBd&&this.TPi(),v.ULS.sendTraceTag(572057624,1303,15,JSON.stringify({["description"]:"[Zero term context menu] augloop request timeout",["correlationId"]:b,
["containsZTM"]:h.OBd,["containsSearchSuggestions"]:h.h8e})))}TPi(){const b=this.Tvh(this.Amd.sections);appChrome.api.dispatch(b);this.Dph()}Dph(){this.Ppd=!0}npn(b){var h,r;const z=[],R=new Map;if(!b||0===b.length)return z;for(const ba of b){if(!ba||!ba.controlIds||0===ba.controlIds.length)continue;b={controlIds:[],id:ba.id,title:ba.title,lang:ba.lang,data:{itemsMetadata:new Lc.a}};const ta="CommandsZTM"===ba.id;for(const Wa of ba.controlIds){if(R.has(Wa))continue;if(ta&&b.controlIds.length>=this.pMj)break;
const ub=null===(r=null===(h=ba.data)||void 0===h?void 0:h.itemsMetadata)||void 0===r?void 0:r[Wa];R.set(Wa,ub);b.controlIds.push(Wa);ub&&(b.data.itemsMetadata[Wa]=ub)}0<b.controlIds.length&&z.push(b)}return z}hxn(){this.Ppd=!1;if(this.dIj){const b=[appChrome.actions.updateControlHiddenState("ContextMenu",!0),appChrome.actions.updateControlEnabledDisabledState("ZeroTermContextMenu",!1)];appChrome.api.dispatch(b)}}iko(b,h){this.Ppd||(b=this.jgl(b,h),0<b.length&&appChrome.api.dispatch(b))}jgl(b,h){const r=
[];let z=[];var R=this.MDl();R&&0<R.length&&z.push(...R);(R=this.hfl())&&z.push(R);(R=this.Jfl(r))&&z.push(R);Array.isArray(b)&&0<b.length&&(this.uJj&&(R=this.iAj.E5m(r))&&b.unshift({suggestion:R,rankingScore:-1,suggestionSource:"RichCommandZeroTermMenu"}),b=this.Zra(b))&&(b.id="CommandsZTM",z.push(b));Array.isArray(h)&&0<h.length&&(h=this.Lfl(h,r))&&z.push(h);(h=this.Yel())&&z.push(h);z=this.npn(z);if(0===z.length)return[];this.ULg&&(this.G8c.Ivo=this.IFk(z));r.push(this.Tvh(z));this.Dph();return r}Jfl(b){const h=
[],r={itemsMetadata:new Lc.a};if(this.mFe){var z=this.mFe.Hgn();const R=Date.now();for(const ba of z)z=ba.dTi.actionId,r.itemsMetadata[z]={timeStamp:R,source:this.mFe.source,confidenceScore:ba.score},appChrome.selectors.isControlDefined(z)||b.push(ba.dTi.efl()),h.push(z)}return 0<h.length?appChrome.api.menuSection(h,null,null,null,r):null}MDl(){var b,h;const r=null===(b=this.Amd)||void 0===b?void 0:b.sections.filter(z=>{var R;return null===(R=z.id)||void 0===R?void 0:R.startsWith(es.qCh)});for(const z of r)if(null===
(h=z.data)||void 0===h?0:h.itemsMetadata)for(const R in z.data.itemsMetadata)z.data.itemsMetadata[R].source="PassThroughZeroTermMenu";return r}hfl(){const b=this.ZKh(this.QAj,"DefaultZeroTermMenu");return this.Zra(b)}Yel(){const b=this.ZKh(this.ovj,"AdvertizedZeroTermMenu");return this.Zra(b)}ZKh(b,h){const r=[];for(const z of b)z&&this.OUn(z)&&this.Amd.commands.has(z.id)&&r.push({suggestion:z.id,rankingScore:-1,suggestionSource:h});return r}OUn(b){if("number"!==typeof(null===b||void 0===b?void 0:
b.count))return!0;if(0===b.count)return!1;b.count--;return!0}IFk(b){const h=[];for(let z of b)for(let R of z.controlIds){var r=z.data;b=-1;let ba=null;r&&r.itemsMetadata&&(r=r.itemsMetadata[R],b=r.confidenceScore,ba=r.source);h.push({suggestion:R,rankingScore:b,suggestionSource:ba})}return h}Lfl(b,h){const r=[],z=[],R={itemsMetadata:new Lc.a};this.mGd();let ba=0;for(let Wa of b){b=Wa.suggestion;var ta={neighborhood:b,mentionStart:0,mentionLength:b.length};ta=(new Wm.a).cvh(ta,23,null);b=Object.assign(new nh.a,
{ExternalId:"ZeroTermContextMenuSearchSuggestion"+ba,LabelText:this.i0e(b,WordEditorIntl.WordEditorStrings.L_ContextMenuTextSmartLookup,WordEditorIntl.WordEditorStrings.L_ContextMenuSmartLookupSubmenu_SearchMore),CommandValueId:ta});if(appChrome.selectors.isControlDefined(b.ExternalId))h.push(appChrome.actions.setControlLabel(b.ExternalId,b.LabelText)),h.push(appChrome.actions.setButtonCommandValueId(b.ExternalId,ta));else{ta={};const ub=Object.assign(new Ur,{commandValueId:b.CommandValueId});ta["default"]=
"Insights_20";ub.iconSet=ta;z.push(appChrome.api.createButtonModel(b.ExternalId,b.LabelText,ub))}r.push(b.ExternalId);R.itemsMetadata[b.ExternalId]={timeStamp:Date.now(),source:Wa.suggestionSource?Wa.suggestionSource:"SearchSuggestion",confidenceScore:Wa.rankingScore};ba++;if(3<=ba)break}0<z.length&&h.push(appChrome.actions.addControls(z));return r&&0<r.length?appChrome.api.menuSection(r,null,null,null,R):null}Zra(b){const h=[],r={itemsMetadata:new Lc.a},z=Date.now();this.jFa(b);for(let R of b)b=
this.scj(R.suggestion),this.W$l(b)&&(h.push(b),r.itemsMetadata[b]={timeStamp:z,source:R.suggestionSource,confidenceScore:R.rankingScore});return 0<h.length?appChrome.api.menuSection(h,null,null,null,r):null}NSh(){return(new Wm.a).yhf()}mGd(){const b=this.NSh();return b.neighborhood.substr(b.mentionStart,b.mentionLength)}KHd(b){b=b?b.trim():null;let h=20;b&&0<b.length&&(b.length>h&&(h=B.a.Ny(b,h)?h-1:h),b=b.length>h?b.substr(0,h).trim()+"...":b);return b}i0e(b,h,r){(b=this.KHd(b))&&0<b.length&&(r=
String.format(h,b));return r}}Object(n.a)(WC,"AugLoopSearchSuggestionManager",null,[250,391]);var XC=d(504),YC=d(310);d(1797);class ZC{constructor(b){this.jpb=b;this.Oxc=[];XC.a.instance.jPe(this.GRl.bind(this))}GRl(b,h){b={commandId:h.actionName,timestamp:h.timeStamp};(new $C).Eho(b)&&(Array.insert(this.Oxc,0,b),this.Oxc.length>this.jpb.Wpi&&Array.removeAt(this.Oxc,this.jpb.Wpi))}}Object(n.a)(ZC,"ActionContextCache",null,[]);class CB{constructor(b){this.Ps=b}get paragraphId(){return this.Ps&&this.Ps.Qa&&
this.Ps.Qa.node&&this.Ps.Qa.node.id&&this.Ps.Qa.node.id.nr?this.Ps.Qa.node.id.nr.toString():null}}Object(n.a)(CB,"SelectionDetailFetcher",null,[]);class $C{Eho(b){return"BrowserPasted"===b.commandId||"ImageResize"===b.commandId?(b.paragraphId=(new CB(this.e2())).paragraphId,!0):!1}e2(){var b=vb.App.xa.jb.Ic;return b?(b=b.Cb)&&b.hb&&b.hb.length?b.hb.kb:null:null}}Object(n.a)($C,"ActionContextFetcher",null,[]);class aD{constructor(b,h,r){this.jpb=b;this.ga=h;this.GXg=r;this.source="RichAction";this.fnn()}Hgn(){const b=
[];for(const h of this.GXg){const r=h.XEh();r>=this.jpb.threshold&&b.push({score:r,dTi:h})}b.sort((h,r)=>r.score-h.score);return b.slice(0,Math.min(this.jpb.topN,b.length))}fnn(){for(const b of this.GXg){const h=b.k5k;this.ga.gb(h.Yzk,h.contextId,h.handler,h.flags)}}}Object(n.a)(aD,"ActionRecommender",null,[]);var Gw;(function(b){b.bzo="WordEditor.ContextualSearch.RichAction.PreviousParagraphFormatApplier";b.azo="WordEditor.ContextualSearch.RichAction.NextParagraphFormatApplier";b.$yo="WordEditor.ContextualSearch.RichAction.AdjacentImageAligner"})(Gw||
(Gw={}));Object(n.b)("RichActionRegisterNames",Gw);class Vr{constructor(){this.topN=2;this.threshold=.5;this.Wpi=50;this.MFm=3}}Object(n.a)(Vr,"FeatureSetting",null,[]);class TA{constructor(b,h,r,z,R){this.Cb=b;this.iconName=h;this.actionId=r;this.u0j=z;this.Hyk=R;this.OG=void 0}get k5k(){return{Yzk:this.Hyk,contextId:Yd.a.frame,handler:this.xda.bind(this),flags:1028}}efl(){const b=new Ur;var h={};h["default"]=this.iconName;b.iconSet=h;h=[];h.push(appChrome.api.createButtonModel(this.actionId,this.u0j,
b));return appChrome.actions.addControls(h)}xda(b,h,r){if(1===r)return 32;h=new yf.GraphTransaction(15);h.Db(this.OG.Qa.node);h.Al=b;b=this.execute();h.dispose();return b}}Object(n.a)(TA,"RichAction",null,[]);class UA extends TA{constructor(b,h,r,z){super(b,"FormatPainter_20","previous"===z?"RaNeighborPreviousParagraphFormatApplier":"RaNeighborNextParagraphFormatApplier",`Format as ${z} paragraph`,"previous"===z?Oa.a.WIi:Oa.a.VIi);this.tJ=h;this.Lge=r;this.$vj=z;this.GSb=void 0}XEh(){var b,h,r;this.OG=
null===(h=null===(b=this.Cb)||void 0===b?void 0:b.hb)||void 0===h?void 0:h.kb;this.GSb=void 0;if(1!==(null===(r=this.OG)||void 0===r?void 0:r.length)||!ie.ParagraphReader.zh(this.OG.Qa.iterator)||this.OG.QL||!this.Sam)return 0;b=ie.ParagraphReader.Vg(this.OG.Qa.node,"previous"===this.$vj,!1,!1);if(!b||!ie.ParagraphReader.nc(b)||!this.Zei&&!this.Ndm)return 0;this.GSb=b;return.9}execute(){if(!this.OG||!this.GSb)return 16;var b=Qe.a.createTextRange(this.GSb,0,ie.ParagraphReader.textLength(this.GSb));
b=new tm.Selection([b],!1);this.tJ.rLf(b);this.Zei?(b=Qe.a.createTextRange(this.OG.Qa.node,0,ie.ParagraphReader.textLength(this.OG.Qa.node)),b=new tm.Selection([b],!1),this.tJ.asd(b)):this.tJ.asd(this.OG);this.GSb=this.OG=void 0;return 32}get Zei(){return this.OG.Qa.cpBegin===this.OG.Qa.cpEnd}get Ndm(){return 0===this.OG.Qa.cpBegin&&this.OG.Qa.cpEnd===ie.ParagraphReader.textLength(this.OG.Qa.node)}get Sam(){for(const b of this.Lge.Oxc)if("BrowserPasted"===b.commandId){const h=b.paragraphId;if(h){const r=
(new CB(this.OG)).paragraphId;if(h===r)return!0}}return!1}}Object(n.a)(UA,"NeighborParagraphFormatApplier",TA,[]);class bD extends UA{constructor(b,h,r){super(b,h,r,"previous")}}Object(n.a)(bD,"PreviousParagraphFormatApplier",UA,[]);class DB extends UA{constructor(b,h,r){super(b,h,r,"next")}}Object(n.a)(DB,"NextParagraphFormatApplier",UA,[]);class mC extends TA{constructor(b,h,r,z){super(b,"FormatPainter_20","RaAdjacentImageAligner","Align images",Oa.a.UIi);this.ij=h;this.Lge=r;this.jpb=z;this.FNb=
void 0}XEh(){var b,h,r;this.OG=null===(h=null===(b=this.Cb)||void 0===b?void 0:b.hb)||void 0===h?void 0:h.kb;if(1!==(null===(r=this.OG)||void 0===r?void 0:r.length)||!this.OG.QL)return 0;var z=$d.ImageReader.Xl(this.OG.Qa);b=this.GLh(this.OG.Qa.node,!0);h=this.P$h(z,b.oXb);r=this.GLh(this.OG.Qa.node,!1);z=this.P$h(z,r.oXb);if(h&&!z)return this.FNb=b.oXb,.9;if(z&&!h)return this.FNb=r.oXb,.9;if(!h&&!z)return 0;this.FNb=this.g9l(r.Q9j)?r.oXb:b.oXb;return.9}execute(){if(!this.OG||!this.FNb)return 16;
const b=$d.ImageReader.Xl(this.OG.Qa),h=$d.ImageReader.JB(this.FNb),r=$d.ImageReader.tA(this.FNb);this.ij.d0i(b,this.OG.Qa,r,h);return 32}GLh(b,h){let r=void 0,z=void 0;try{for(let R=-1;R<this.jpb.MFm;++R){r=ie.ParagraphReader.Vg(b,h,!1,!1);if(!r)break;if(z=$d.ImageReader.Xl(Qe.a.createTextRange(r,0,ie.ParagraphReader.textLength(r))))break;if(0<ie.ParagraphReader.textLength(r))break;b=r}}catch(R){v.ULS.sendTraceTag(545861641,1303,10,"Exception as getting adjacent image. Error: {0}",R),z=r=void 0}return{Q9j:r,
oXb:z}}P$h(b,h){if(!h)return!1;const r=$d.ImageReader.JB(b);b=$d.ImageReader.tA(b);const z=$d.ImageReader.JB(h);h=$d.ImageReader.tA(h);return r===z&&b===h?!1:!0}g9l(b){b=b.id.nr.toString();for(const h of this.Lge.Oxc)if("ImageResize"===h.commandId)return h.paragraphId===b;return!1}}Object(n.a)(mC,"AdjacentImageAligner",TA,[]);class VA{constructor(b){this.zc=b;this.Kxc=null;this.y9a={EventId:null};this.Hee=(h,r,z,R,ba)=>{var ta;if(1===z)return 32;if(!this.Kxc||0===this.Kxc.filter(Wa=>Wa.suggestionSource===
VA.source).length)return this.LRi(),32;ba&&ba.j5k&&(this.y9a.ExecutedSuggestion={suggestion:null!==(ta=ba.hJo)&&void 0!==ta?ta:ba.j5k,suggestionSource:ba.source,rankingScore:ba.confidenceScore});this.y9a.OfferedSuggestions=this.Kxc;return 32};this.Vb()}Vb(){this.zc.gb(Oa.a.Hee,Yd.a.frame,this.Hee,1124)}LRi(){this.y9a={EventId:null};this.Kxc=null}set wzn(b){this.y9a.EventId=b}set Ivo(b){this.Kxc=b}get vzn(){return this.y9a&&this.y9a.EventId&&this.y9a.OfferedSuggestions?this.y9a:null}}VA.source="Personalizer";
Object(n.a)(VA,"ContextualSearchPersonalizerActor",null,[354]);class cD{}Object(n.a)(cD,"DocumentItem",null,[]);class dD{constructor(b){this.Cb=b;this.EZj=RegExp("^(docx|pptx|ppsx|xlsx|pdf)$");this.FZj=["sharepoint.com","sharepoint-df.com"]}eIl(){var b,h;let r=null;const z=null===(h=null===(b=this.Cb)||void 0===b?void 0:b.hb)||void 0===h?void 0:h.kb;if(!z)return null;b=z.Qa;if(32!==t.AFrameworkApplication.ya.Qf(b,Fb.a.ZNa,1,!0,null,null))return r;(b=Pg.HyperlinkReader.E3b(b))&&1===b.length&&(r=decodeURIComponent(b[0].hyperlink.url));
return r}oql(b){const h=b.lastIndexOf(".");if(0>h)return null;b=b.substring(h+1).toLowerCase();return this.EZj.test(b)?b:null}gnm(b){const h=new URL(b);return h&&h.hostname&&this.FZj.find(r=>h.hostname.toLowerCase().includes(r))?!0:!1}E5m(b){const h=[];var r=new Wm.a,z=this.eIl();if(!z||!this.gnm(z))return null;const R=this.oql(z);if(!R)return null;z={landingTab:"Files",data:{type:3,l2Document:Object.assign(new cD,{Id:pa.a.create().toString(),Path:z,FileType:R,LastModifiedTime:null})}};r=r.cvh({neighborhood:"",
mentionStart:0,mentionLength:0},10,z);appChrome.selectors.isControlDefined("OpenHyperlinkInlineView")||(z=Object.assign(new Ur,{commandValueId:r}),h.push(appChrome.api.createButtonModel("OpenHyperlinkInlineView",WordRibbonStrings.OpenHyperlinkInSidebar,z)));z=Object.assign(new nh.a,{ExternalId:"OpenHyperlinkInlineView",CommandValueId:r});b.push(appChrome.actions.setButtonCommandValueId(z.ExternalId,r));0<h.length&&b.push(appChrome.actions.addControls(h));return z.ExternalId}}Object(n.a)(dD,"ContextualSearchHyperlinkProcessor",
null,[353]);class Hw{constructor(){this.W=null}get name(){return"WordEditor.ContextualSearch"}yc(b){this.W=b;t.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.RichActionInContextMenuIsEnabled",!1)&&(this.W.ha("WordEditor.ContextualSearch.RichAction.FeatureSetting",()=>new Vr).singleInstance(),this.W.ha("WordEditor.ContextualSearch.RichAction.ActionContextCache",()=>new ZC(this.W.resolve("WordEditor.ContextualSearch.RichAction.FeatureSetting"))).singleInstance(),this.W.ha("WordEditor.ContextualSearch.RichAction.PreviousParagraphFormatApplier",
()=>new bD(ja.App.fm.jb.Ic.Cb,this.W.resolve("Box4.IFormatPainter"),this.W.resolve("WordEditor.ContextualSearch.RichAction.ActionContextCache"))).singleInstance(),this.W.ha("WordEditor.ContextualSearch.RichAction.NextParagraphFormatApplier",()=>new DB(ja.App.fm.jb.Ic.Cb,this.W.resolve("Box4.IFormatPainter"),this.W.resolve("WordEditor.ContextualSearch.RichAction.ActionContextCache"))).singleInstance(),this.W.ha("WordEditor.ContextualSearch.RichAction.AdjacentImageAligner",()=>new mC(ja.App.fm.jb.Ic.Cb,
this.W.resolve("WordEditor.IImageEditor"),this.W.resolve("WordEditor.ContextualSearch.RichAction.ActionContextCache"),this.W.resolve("WordEditor.ContextualSearch.RichAction.FeatureSetting"))).singleInstance(),this.W.ha("WordEditor.ContextualSearch.RichAction.ActionRecommender",()=>new aD(this.W.resolve("WordEditor.ContextualSearch.RichAction.FeatureSetting"),t.AFrameworkApplication.ya,Object.keys(Gw).filter(h=>h.startsWith("Ra",0)).map(h=>this.W.resolve(Gw[h])))).singleInstance());this.W.ha("WordEditor.ContextualSearch.ContextualSearchPersonalizerActor",
()=>new VA(t.AFrameworkApplication.ya)).as("WordEditor.ContextualSearch.IContextualSearchPersonalizerActor").singleInstance();this.W.ha("WordEditor.ContextualSearch.ContextualSearchHyperlinkProcessor",()=>new dD(ja.App.fm.jb.Ic.Cb)).as("WordEditor.ContextualSearch.IContextualSearchHyperlinkProcessor").singleInstance();this.W.ha("WordEditor.ContextualSearch.AugLoopSearchSuggestionManager",()=>new WC(this.W.resolve("Box4.AugmentationLoop.IAnnotationStorage"),this.W.Pa("WordEditor.ContextualSearch.RichAction.ActionRecommender"),
augLoop.ALFactoryGlobal.getAugLoopRuntimeManager(),this.W.resolve("WordEditor.ContextualSearch.IContextualSearchPersonalizerActor"),this.W.resolve("WordEditor.ContextualSearch.IContextualSearchHyperlinkProcessor"),this.W.resolve("Box4.CanvasContext.ICanvasContextProvider"))).as("WordEditor.ContextualSearch.ISearchSuggestionManager").singleInstance()}init(){this.W.resolve("Box4.IFeatureHelper").Yk.continueWith(()=>{pk.a.En().then(()=>{this.start()})})}start(){this.W.resolve("WordEditor.ContextualSearch.AugLoopSearchSuggestionManager")}dispose(){}static main(){O.a.instance.Oc(new Hw)}}
Object(n.a)(Hw,"PackageManager",null,[1,2]);var ux=d(334),Nq=d(933);class Wy extends Nq.a{constructor(){super();this.documentUrl=this.scripts=null}}Object(n.a)(Wy,"BootMessage",Nq.a,[]);var Xj=d(1017);class eD{constructor(){this.IJ=null;this.oUm=b=>{if(b.target===this.IJ)if(void 0===b.data||null===b.data)v.ULS.sendTraceTag(50739143,3007,10,"WebWorker: The received message did not have any data.");else try{if("string"===typeof b.data){const h=y.a(b.data);this.x$d(h.api)?this.R6c.J(h.api).E9b(h.method,
h):v.ULS.sendTraceTag(50739144,3007,10,"WebWorker: The received message contained an unsupported API.")}}catch(h){v.ULS.sendTraceTag(50739145,3007,10,"WebWorker: Error routing a message received from a worker thread. Exception: {0}",h)}};this.R6c=new Hl.a}Fuf(){return!!t.AFrameworkApplication.K&&t.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.IsWorkerUtilsEnabled",!1)}create(b,h){let r=!1;try{this.IJ=new Worker(b);this.IJ.onmessage=this.oUm;const z=Object.assign(new Wy,
{api:0,method:0,scripts:h,documentUrl:document.URL});this.postMessage(z);this.Fuf()&&Xj.a.Ztj(this.IJ);r=!0}catch(z){v.ULS.sendTraceTag(50442775,3007,10,"WebWorker: Error creating worker. Exception: {0}",z)}return r}postMessage(b){try{const h=y.c(b);this.IJ.postMessage(h)}catch(h){v.ULS.sendTraceTag(50442776,3007,10,"WebWorker: Error sending a message to worker thread. Exception: {0}",h)}}x$d(b){return this.R6c.xb(b)}J0j(b,h){this.x$d(b)&&v.ULS.sendTraceTag(50442777,3007,10,"WebWorker: We're overwriting an existing API in the collection.  ApiId: {0}",
b);this.R6c.Z(b,h)}mil(b){return this.x$d(b)?this.R6c.J(b):null}}Object(n.a)(eD,"WebWorker",null,[68]);class fD{constructor(){this.Bag=[]}JOk(b,h){if(h){var r=t.AFrameworkApplication.Aw(b.kVi,7),z=[];for(let R=0;R<b.VKb.length;R++){let ba;switch(b.VKb[R].format){case 5:case 6:ba=ux.a.feb(b.VKb[R].name);break;default:ba=b.VKb[R].name}z.push(t.AFrameworkApplication.Aw(ba,b.VKb[R].format))}try{const R=URL.createObjectURL(new Blob(["importScripts('"+r+"');"],{type:"application/javascript"})),ba=new eD;
if(ba.create(R,z))for(this.Bag.push(ba),r=0;r<b.w$d.length;r++){const ta=h.NHk(ba,b.w$d[r]);ta&&ba.J0j(b.w$d[r],ta)}}catch(R){v.ULS.sendTraceTag(50442778,3007,10,"Exception caught when creating a new worker. Exception: {0}",R.message)}}else v.ULS.sendTraceTag(42824902,3007,10,"CreateWebWorker: ApiFactory parameter was null.")}}Object(n.a)(fD,"WebWorkerCollection",null,[]);class gD{constructor(b,h){this.SMe=new fD;if(b){b=b.create();for(let r=0;r<b.length;r++)this.SMe.JOk(b[r],h)}else v.ULS.sendTraceTag(50442779,
3007,10,"WebWorkerRouter: configFactory parameter was null.")}sendMessage(b,h,...r){let z=!1;for(let ba=0;ba<this.SMe.Bag.length;ba++){var R=this.SMe.Bag[ba];R.x$d(b)&&((R=R.mil(b))?z=R.HYb(h,r)||z:v.ULS.sendTraceTag(50442780,3007,10,"WebWorkerRouter: Failed to get an Api that is supported by the web worker. ApiId: {0}",b))}z||v.ULS.sendTraceTag(50442781,3007,10,"WebWorkerRouter: A SendMessage did not find a worker to succesfully send the message to. ApiId: {0}, MethodId: {1}",b,h)}}Object(n.a)(gD,
"WebWorkerRouter",null,[20]);class EB{constructor(){this.D=this.ST=0}}Object(n.a)(EB,"LongTaskInfo",null,[]);class nC{constructor(b,h){this.KMe=null;this.KCm=r=>{if(r){var z=[];for(let R of r.getEntries())R.duration>=this.xso&&(r=new EB,r.ST=R.startTime,r.D=Math.round(R.duration),z.push(r));if(0<z.length){let R;(R=this.mP).sendMessage.apply(R,[1,3].concat(z))}}};b.j3(this.KCm);this.mP=h}get xso(){null==this.KMe&&(this.KMe=t.AFrameworkApplication.K?t.AFrameworkApplication.K.rc("WordHangDetectionHangThresholdTime",
2E3):2E3);return this.KMe}}Object(n.a)(nC,"HangDetector",null,[]);class hD{constructor(){this.IVg=null;this.s7l=b=>{for(let h of this.$M)h(b)};this.$M=[];this.OSb=0}j3(b){this.OSb||this.LNm();1===this.OSb&&this.$M.push(b)}JCm(){return!!window.PerformanceObserver&&!!window.PerformanceLongTaskTiming&&!!PerformanceObserver.supportedEntryTypes&&-1!==Array.indexOf(PerformanceObserver.supportedEntryTypes,"longtask")}LNm(){if(!this.OSb)if(this.JCm())try{this.IVg=new PerformanceObserver(this.s7l),this.IVg.observe({type:"longtask"}),
this.OSb=1}catch(b){this.OSb=2,v.ULS.sendTraceTag(592479427,3008,10,"Failed to create PerformanceObserver with message {0}",b.message)}else this.OSb=2}}Object(n.a)(hD,"LongTaskListeners",null,[352]);class iD extends Nq.a{constructor(){super();this.LocalCobaltClusterId=this.LocalCobaltMachineId=this.LocalCobaltSessionId=this.sessionID=this.sessionStartInfoSettings=this.appSettings=null;this.LocalCobaltSessionHasBackup=!1;this.SettingsRoutedToServer=this.WaciiEnabledRequests=0;this.WacClusterId=null}}
Object(n.a)(iD,"SettingsMessage",Nq.a,[]);class mu{constructor(b){this.IJ=b}}Object(n.a)(mu,"WebWorkerApiMain",null,[]);class jD extends mu{constructor(b){super(b)}Fuf(){return!!t.AFrameworkApplication.K&&t.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.IsWorkerUtilsEnabled",!1)}HYb(b,h){if(!h)return v.ULS.sendTraceTag(591972375,3007,10,"InitializeWorkerApiMain: InitializeSettings called with a null methodParams value."),!1;if(1===b)return this.mqk(h);v.ULS.sendTraceTag(591972376,
3007,10,"InitializeWorkerApiMain: Unknown method called.  MethodId: {0}",b);return!1}E9b(b,h){switch(b){case 14:this.nTl(h);break;default:v.ULS.sendTraceTag(591972377,3007,10,"InitializeWorkerApiMain: MethodCallReceived is not supported on this API.  MethodId: {0}",b)}}mqk(b){if(2!==b.length)return v.ULS.sendTraceTag(591972378,3007,10,"InitializeWorkerApiMain: InitializeSettings called with incorrect parameters.  Param Count: {0}",b.length),!1;if("object"!==typeof b[0]||"object"!==typeof b[1])return v.ULS.sendTraceTag(587343010,
3007,10,"InitializeWorkerApiMain: InitializeSettings called with incorrect parameters. Param[0] is Dictionary: {0}, Param[1] is Dictionary: {1}","object"===typeof b[0],"object"===typeof b[1]),!1;b=Object.assign(new iD,{api:0,method:1,appSettings:b[0],sessionStartInfoSettings:b[1],sessionID:t.AFrameworkApplication.userSessionId,LocalCobaltSessionId:zl.a.instance.vQ,LocalCobaltMachineId:zl.a.instance.OEb,LocalCobaltClusterId:zl.a.instance.Y8b,LocalCobaltSessionHasBackup:zl.a.instance.hua,WaciiEnabledRequests:zl.a.instance.Hoa,
SettingsRoutedToServer:zl.a.instance.LZf,WacClusterId:t.AFrameworkApplication.Xe.U3});this.IJ.postMessage(b);return!0}nTl(b){this.Fuf()&&b&&b.result&&(v.ULS.sendTraceTag(555877916,3007,15,"Receive initialize finished message"),this.moo())}moo(){Object(Ht.__awaiter)(this,void 0,void 0,function*(){try{const b=yield new Xj.a.$tj.WorkerUtilsTestClass(10);yield b.Hh(5);15==(yield b.counter)?v.ULS.sendTraceTag(555877917,3007,50,"WorkerUtils testing successfully"):v.ULS.sendTraceTag(555877918,3007,15,"WorkerUtils testing failed")}catch(b){v.ULS.sendTraceTag(555877919,
3007,10,"WorkerUtils failed with exception: {0}",b.message)}})}}Object(n.a)(jD,"InitializeWorkerApiMain",mu,[]);class FB extends Nq.a{constructor(){super();this.mockDataEnabled=!1;this.requestEndpoint=this.rootQuerySignature=null;this.appMode=0;this.activityFeedIsEnabled=!1;this.api=2;this.method=4}}Object(n.a)(FB,"CatchUpNetworkRequestWorkerRequestMessage",Nq.a,[]);class kD extends mu{constructor(b,h){super(b);this.pAc=h}HYb(b,h){if(4===b)return b=Object.assign(new FB,{rootQuerySignature:h[0],requestEndpoint:h[1],
appMode:h[2],activityFeedIsEnabled:h[3]}),this.IJ.postMessage(b),!0;v.ULS.sendTraceTag(592189584,3012,10,"CatchUpNetworkRequestWorkerExternalApi: Unknown method called.  MethodId: {0}",b);return!1}E9b(b,h){switch(b){case 5:v.ULS.sendTraceTag(592189585,3012,50,"CatchUpNetworkRequestWorkerExternalApi: Message received for method: {0}",b);this.pAc.RHn(h);break;default:v.ULS.sendTraceTag(592189586,3012,10,"CatchUpNetworkRequestWorkerExternalApi: Unsupported Method sent to the Api.  MethodId: {0}",b)}}}
Object(n.a)(kD,"CatchUpNetworkRequestWorkerExternalApi",mu,[]);class lD extends Nq.a{constructor(){super();this.taskInfo=null}}Object(n.a)(lD,"HangDetectionMessage",Nq.a,[]);class mD extends Nq.a{constructor(){super();this.taskInfo=null}}Object(n.a)(mD,"ReportLongTasksMessage",Nq.a,[]);class oC extends mu{constructor(b){super(b)}HYb(b,h){if(!h)return v.ULS.sendTraceTag(591972370,3008,10,"HangDetectionWorkerApiMain: HangDetection called with a null methodParams value."),!1;switch(b){case 2:return this.lqk(h);
case 3:return this.evn(h);default:return v.ULS.sendTraceTag(591972371,3008,10,"HangDetectionWorkerApiMain: Unknown method called.  MethodId: {0}",b),!1}}E9b(b){v.ULS.sendTraceTag(591972372,3007,10,"HangDetectionWorkerApiMain: MethodCallReceived is not supported on this API.  MethodId: {0}",b)}lqk(b){if(1!==b.length||"object"!==typeof b[0])return v.ULS.sendTraceTag(591972373,3008,10,"HangDetectionWorkerApiMain: HangDetection called with incorrect parameters. Param Count: {0}, Param is Dictionary: {1}",
b.length,"object"===typeof b[0]),!1;b=Object.assign(new lD,{api:1,method:2,taskInfo:b[0]});this.IJ.postMessage(b);return!0}evn(b){if(!b.length||!Object(nb.a)(EB,b[0]))return v.ULS.sendTraceTag(591972374,3008,10,"HangDetectionWorkerApiMain: ReportLongTasks called with incorrect parameters. Params length is {0}, Param[0] is LongTaskInfo is {1}",b.length,0<b.length?Object(nb.a)(EB,b[0]):!1),!1;b=Object.assign(new mD,{api:1,method:3,taskInfo:b});this.IJ.postMessage(b);return!0}}Object(n.a)(oC,"HangDetectionWorkerApiMain",
mu,[]);class Xy extends Nq.a{constructor(){super();this.context=this.textPredictionConfig=this.prediction=this.paragraphContent=null}}Object(n.a)(Xy,"LocalInferenceMessage",Nq.a,[]);class vx{constructor(){this.prediction=this.context=null}}Object(n.a)(vx,"LocalInferenceOutput",null,[]);class mk{constructor(){this.modelFilesUrl=this.settings=this.scriptDirectory=null}}Object(n.a)(mk,"TextPredictionConfig",null,[]);class pC{constructor(){this.extendedRankLimit=0;this.dynamicTemporaryInDocModelNGramToken=
3}}Object(n.a)(pC,"TextPredictionSettings",null,[]);class fE{constructor(){this.nGramOrder=0;this.modelFilesUrl=null}}Object(n.a)(fE,"TextPredictionDynamicPayload",null,[]);class nD extends mu{constructor(b,h){super(b);this.s_j=h}HYb(b,h){if(!h)return v.ULS.sendTraceTag(575959325,3008,10,"LocalInferenceWorkerApiMain: LocalInference called with a null methodParams value."),!1;switch(b){case 8:return this.sqk(h);case 7:return this.nqk(h);case 9:return this.rqk(h);case 10:return this.oqk(h);case 13:return this.pqk(h);
case 14:return this.qqk(h);default:return v.ULS.sendTraceTag(575959326,3008,10,"LocalInferenceWorkerApiMain: Unknown method called.  MethodId: {0}",b),!1}}E9b(b,h){switch(b){case 9:this.mUl(h);break;default:v.ULS.sendTraceTag(575959822,3007,10,"LocalInferenceWorkerApiMain: MethodCallReceived is not supported on this API.  MethodId: {0}",b)}}mUl(b){b&&b.prediction&&(b=Object.assign(new vx,{prediction:b.prediction,context:b.context}),this.s_j.Meh().Y9m(b))}nqk(b){if(1>b.length)return v.ULS.sendTraceTag(575959823,
3008,10,"LocalInferenceWorkerApiMain: callLocalInferenceAddContext called with incorrect parameters. Param Count: {0}, Param is Dictionary: {1}",b.length,"object"===typeof b[0]),!1;b=b[0];b=Object.assign(new Xy,{api:4,method:7,paragraphContent:b,textPredictionConfig:this.getConfig()});this.IJ.postMessage(b);return!0}sqk(b){if(1>b.length)return v.ULS.sendTraceTag(575959824,3008,10,"LocalInferenceWorkerApiMain: callLocalInferenceRemoveContext called with incorrect parameters. Param Count: {0}, Param is Dictionary: {1}",
b.length,"object"===typeof b[0]),!1;b=b[0];b=Object.assign(new Xy,{api:4,method:8,paragraphContent:b});this.IJ.postMessage(b);return!0}rqk(b){if(2>b.length)return v.ULS.sendTraceTag(575959825,3008,10,"LocalInferenceWorkerApiMain: callLocalInferencePredict called with incorrect parameters. Param Count: {0}, Param is Dictionary: {1}",b.length,"object"===typeof b[0]),!1;var h=b[0];b=b[1];h=Object.assign(new Xy,{api:4,method:9,paragraphContent:b,context:h});this.IJ.postMessage(h);return!0}oqk(b){if(1>
b.length)return v.ULS.sendTraceTag(570782293,3008,10,"LocalInferenceWorkerApiMain: callLocalInferenceInit called with incorrect parameters. Param Count: {0}, Param is Dictionary: {1}",b.length,"object"===typeof b[0]),!1;b=b[0];b=Object.assign(new Xy,{api:4,method:10,textPredictionConfig:this.getConfig(b)});this.IJ.postMessage(b);return!0}pqk(b){if(1>b.length)return v.ULS.sendTraceTag(556827920,3008,10,"LocalInferenceWorkerApiMain: LocalInferenceWorker called with incorrect parameters. Param Count: {0}, Param is Dictionary: {1}",
b.length,"object"===typeof b[0]),!1;b=b[0];b=Object.assign(new Xy,{api:4,method:13,textPredictionConfig:this.VPh(b)});this.IJ.postMessage(b);return!0}qqk(b){if(1>b.length)return v.ULS.sendTraceTag(541733787,3008,10,"LocalInferenceWorkerApiMain: LocalInferenceWorker called with incorrect parameters. Param Count: {0}, Param is Dictionary: {1}",b.length,Object(nb.a)(Object,b[0])),!1;b=b[0];b=Object.assign(new Xy,{api:4,method:14,textPredictionConfig:this.VPh(b)});this.IJ.postMessage(b);return!0}getConfig(b=
null){return Object.assign(new mk,{scriptDirectory:t.AFrameworkApplication.C3+"/intelligence/",settings:Object.assign(new pC,{extendedRankLimit:0}),modelFilesUrl:b})}VPh(b=null){return Object.assign(new mk,{scriptDirectory:t.AFrameworkApplication.C3+"/intelligence/",settings:Object.assign(new pC,{dynamicTemporaryInDocModelNGramToken:b.nGramOrder}),modelFilesUrl:b.modelFilesUrl})}}Object(n.a)(nD,"LocalInferenceWorkerApiMain",mu,[]);class oD extends mu{constructor(b){super(b);t.AFrameworkApplication.xK(()=>
{this.lTc()})}HYb(b){v.ULS.sendTraceTag(591689869,3008,10,"ShutdownWorkerApiMain: CallMethod not supported on this API.  MethodId: {0}",b);return!1}E9b(b){v.ULS.sendTraceTag(591689870,3007,10,"ShutdownWorkerApiMain: MethodCallReceived is not supported on this API.  MethodId: {0}",b)}lTc(){const b=Object.assign(new Nq.a,{api:3,method:6});this.IJ.postMessage(b)}}Object(n.a)(oD,"ShutdownWorkerApiMain",mu,[]);var gE=d(855),qC=d(604);class pD extends Nq.a{constructor(){super();this.args=null;this.numLogs=
0}}Object(n.a)(pD,"UlsWorkerMessage",Nq.a,[]);var rC=d(848),sC=d(977),qD=d(1034);class GB extends sC.a{constructor(b,h,r,z,R){super(b,h,r,z,R);this.cze=null;this.$Ge=!1;if(this.QMg=this.iuf())if(b=z.lb("ContentBaseUrl")?6:5,z=z.lb("AppScriptBaseName"))z=t.AFrameworkApplication.K.getStringFeatureGate("Microsoft.Office.WordOnline.UlsTypedWorkerScriptName",z+".{0}ulsworker.js"),z=ux.a.feb(z),z=t.AFrameworkApplication.Aw(z,b),rC.createWorker({createMode:"Thread"},{local:rC.paramInsideDef(qD.ulsWorkerInsideInit),
r8n:rC.paramInsideDef(Object(qD.ulsWorkerInsideScript)(z))}).then(ba=>{ba.onClose=()=>{this.jLe=void 0};this.jLe=ba},ba=>{var ta=new Date;ba=`UlsWorkerDefererHost threw an error: ${this.bIm(ba)}`;console.error(ba);ta=new qC.a(ta.getTime(),3007,545653664,10,ba,0,!1,null,null);super.HW(ta);this.$Ge=!0})}iuf(){return!!t.AFrameworkApplication.K&&t.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.UlsTypedWorkerIsEnabled",!1)}get kIm(){this.cze||(this.cze=Sa.a.instance.resolve("Box4.Workers.IWebWorkerRouter"));
return this.cze}RKa(b){this.$Ge=b}HW(b){if(this.$Ge)super.HW(b);else if(this.QMg)null!=this.jLe&&this.jLe.call.HW(b);else{let h;(h=this.kIm).sendMessage.apply(h,[5,11].concat([b]))}}bIm(b){if(null==b||"object"!==typeof b)return"unknown";const h=String(b.name),r=String(b.message);return null!=b.stack?(b=String(b.stack),0<=b.indexOf(r)&&0<=b.indexOf(h)?b:`${h}: ${r}\n${b}`):0<=r.indexOf(h)?r:`${h}: ${r}`}}Object(n.a)(GB,"UlsWorkerDefererHost",sC.a,[]);class tC extends mu{constructor(b){super(b);this.lSg=
0;b=Sa.a.instance.Pa("Common.IRefreshableAppSettings");this.XVb=new GB(gE.a.Lyd,!0,t.AFrameworkApplication.Xe,null!==b&&void 0!==b?b:t.AFrameworkApplication.K,b);b=v.ULS.host;null!=b&&b.l4b(this.XVb);v.ULS.Bkb(this.XVb);this.zNg=Ed.a.lf();this.pWj=2*t.AFrameworkApplication.K.rc("UlsWorkerStayAliveIntervalMS",6E4);this.XVb.RKa(!0)}HYb(b,h){if(11!==b||!h||1!==h.length||!Object(nb.a)(qC.a,h[0]))return!1;if(Ed.a.lf()-this.zNg>this.pWj)return this.XVb.RKa(!0),this.XVb.HW(h[0]),v.ULS.sendTraceTag(570770058,
3008,15,"UlsWorkerApiMain: Haven't heard from UlsWorkerApi recently"),!1;b=Object.assign(new pD,{api:5,method:b,args:h[0],numLogs:this.lSg});this.lSg++;this.IJ.postMessage(b);return!0}E9b(b,h){void 0!==h&&null!==h&&12===b&&(this.zNg=Ed.a.lf(),this.XVb.RKa(!1))}}Object(n.a)(tC,"UlsWorkerApiMain",mu,[]);class rD{constructor(b){this.container=b}NHk(b,h){var r=null;switch(h){case 0:r=new jD(b);break;case 1:r=new oC(b);break;case 2:r=new kD(b,this.container.resolve("WordEditor.CatchUpActivity.Worker.CatchUpNetworkRequestWorkerCache"));
break;case 3:r=new oD(b);break;case 4:r=new nD(b,this.container.resolve("Box4.WordPrediction.IWordPredictionAugLoop"));break;case 5:h=t.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.UlsWorkerIsEnabled",!1);r=t.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.UlsTypedWorkerIsEnabled",!1);r=(h||r)&&t.AFrameworkApplication.jtd?new tC(b):null;break;default:v.ULS.sendTraceTag(50442782,3008,10,"WordWebWorkerApiFactory: CreateApi was passed an unsupported ApiId. ApiId: {0}",
h)}return r}}Object(n.a)(rD,"WordWebWorkerApiFactory",null,[351]);var hE=d(259);class Yy{constructor(b,h){this.name=b;this.format=h}}Object(n.a)(Yy,"ImportedScript",null,[]);class sD{constructor(){this.w$d=this.VKb=this.kVi=null}}Object(n.a)(sD,"WebWorkerConfig",null,[]);var Wz=d(1427);class Zy{constructor(b){this.UIe=[];this.jJj=b;if(t.AFrameworkApplication.K){b=t.AFrameworkApplication.K.$("AppChromeOverrideIsCombinedBundle")||t.AFrameworkApplication.K.$("IsCombinedBundleEnabled");const h=t.AFrameworkApplication.K.lb("ContentBaseUrl")?
6:5,r=t.AFrameworkApplication.K.lb("AppScriptBaseName"),z=b?"":".";if(r){const R=b?"":"{0}",ba=r+`${z}${R}worker.js`;this.UIe.push(new Yy(`MicrosoftAjax${b?"":"DS"}.${R}js`,h),new Yy(ba,h));this.iuf()&&this.UIe.push(new Yy(r+`${z}${R}ulsworker.js`,h))}else v.ULS.sendTraceTag(558465106,3008,10,"WordWebWorkerConfigFactory: Failed to get AppScriptBaseName. Worker JS is not loaded")}else v.ULS.sendTraceTag(558465107,3008,10,"WordWebWorkerConfigFactory: AFrameworkApplication.appSettingsManager do not exist. Worker JS is not loaded")}create(){const b=
[],h=Object.assign(new sD,{kVi:"workerboot",VKb:this.UIe,w$d:[0,1,2,3,4,5]});this.jJj&&this.Xbm()&&h.VKb.push(new Yy("intelligence/edge-inference-web.js",5));b.push(h);return b}Xbm(){return(new hE.a("arrowFunction",()=>{try{Object(Wz.a)("const sum = (a, b) => a + b")}catch(b){return!1}return!0},!1)).isSupported()}iuf(){return!!t.AFrameworkApplication.K&&t.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.UlsTypedWorkerIsEnabled",!1)}}Object(n.a)(Zy,"WordWebWorkerConfigFactory",
null,[350]);class Iw{constructor(){this.Oa=this.W=null}get name(){return"WordEditor.Workers"}init(){const b=this.W.resolve("Box4.Workers.IWebWorkerRouter");b.sendMessage.apply(b,[0,1].concat([this.Oa.appSettings,t.AFrameworkApplication.sessionStartInfoSettings]))}dispose(){}yc(b){this.W=b;this.Oa=this.W.resolve("Common.IAppSettingsManager");const h=this.Oa.getBooleanFeatureGate("Microsoft.Office.WordOnline.TextPredictionEdge",!1);b.ha("Box4.Workers.WebWorkerRouter",()=>new gD(new Zy(h),new rD(b))).as("Box4.Workers.IWebWorkerRouter").singleInstance();
b.ha("WordEditor.Workers.LongTaskListeners",()=>new hD).as("WordEditor.Workers.ILongTaskListeners").singleInstance();b.ha("WordEditor.Workers.HangDetector",()=>new nC(b.resolve("WordEditor.Workers.ILongTaskListeners"),b.resolve("Box4.Workers.IWebWorkerRouter"))).singleInstance()}static main(){O.a.instance.Oc(new Iw)}}Object(n.a)(Iw,"WordEditorWorkersPackage",null,[1,2]);var Xz=d(1154);class $y{constructor(){this.nkd=[]}aYh(b,h){let r=-1,z=null;z=R=>{R?h(this.nkd[r]):(++r,r<this.nkd.length?this.nkd[r].LYb(b,
z):h(null))};z(!1)}LYb(b,h){this.aYh(b,r=>{h(!!r)})}Ecc(b,h,r){this.aYh(b,z=>{if(!z)throw Error.invalidOperation("ResolveUrl called without checking CanResolveUrl");z.Ecc(b,h,r)})}a9g(b){this.nkd.push(b)}}Object(n.a)($y,"CompositeExternalContentURLResolver",null,[344,345]);var wx=d(1423);class WA extends wx.a{constructor(){super();this.Thumbnail=this.Author=this.Title=this.MediaType=null;this.Height=this.Width=0;this.IFrameHtml=null}}Object(n.a)(WA,"ExternalContentEmbedResponse",wx.a,[]);var Ck=d(1437),
tD=d(1349),uD=d(1316),vD=d(1347),wD=d(708),az=d(727),ly=d(196),HB=d(849),Ku;(function(b){b[b.autoCorrect=0]="autoCorrect";b[b.externalComponentPaste=1]="externalComponentPaste";b[b.externalHyperlinkPaste=2]="externalHyperlinkPaste";b[b.cEo=3]="externalContentFloatieConversion"})(Ku||(Ku={}));Object(n.b)("ExternalContentConversionContext",Ku);class kh{constructor(){this.sEb=this.rEb=null;this.o8e=new vD.ExternalContentEmbedRetriever;this.Bvc=!0;this.knc=this.Tn=this.p6h=this.o6h=this.em=this.hp=null;
this.picturePasteRequestSucceeded=()=>{v.ULS.sendTraceTag(592996169,324,100,"Picture paste request for External Content succeeded")};this.Tac=()=>{v.ULS.sendTraceTag(592996168,324,10,"Picture paste request for External Content failed.")};null!=kh.Rka&&kh.Rka.OOh()}get cKb(){return this.Bvc}set cKb(b){this.Bvc=b}pVe(b,h){let r=!1;if(b){switch(b.contextId){case kc.a.Wc:r=!h;break;case kc.a.Gd:r=!0}r&&!HB.a(b.node)&&(r=!1)}return r}mnm(b){const h=b.startsWith(Pg.HyperlinkReader.vbc),r=b.startsWith(Pg.HyperlinkReader.RVc),
z=b.startsWith(Pg.HyperlinkReader.W0d);return(h||r||z)&&Pg.HyperlinkReader.QMa(b)}PJi(){this.Tn=E.a.create();kh.uf.uxb(this.Tn,4);kh.uf.h3(this.Tn,0,kh.uf.fo());this.oCb(this.rEb,3,this.sEb,!0)}dMa(b,h,r){this.Tn=E.a.create();kh.uf.uxb(this.Tn,r?0:2);kh.uf.h3(this.Tn,0,kh.uf.fo());this.knc();this.oCb(b,r?0:2,h)}r_d(b,h){this.Tn=E.a.create();kh.uf.uxb(this.Tn,1);kh.uf.h3(this.Tn,0,kh.uf.fo());this.oCb(b,1,h)}CMd(b,h,r){if(!b||!b.isConnected||!$d.ImageReader.ww(b))return null;const z=new wD.a;z.setValue(Ij.a.V4b,
r);z.setValue(Ij.a.qZa,h);z.uWa=this.o6h;z.mw=this.p6h;z.O_a=1===r;Nd.GraphIterator.$a(b).Sf(z,2);this.HRc(z);return z}JLi(b){this.knc=b}age(b,h){const r=kh.u_.a0b(h)||0;h=kh.u_.aXa(h)||0;const z=b.Width/b.Height;1<=z?(b.Width=r,b.Height=r/z):(b.Height=h,b.Width=h/z)}vcg(b,h,r){if(null!=b&&null!=h&&!B.a.mf(r)){var z=kh.XSc.m3b(r);z.uEa=!0;z.hideFloatie=!0;this.age(b,h.node);this.s5b(b,h,!1,!1,z,r)}}eeb(b){return b?b.wf:0}Z9f(b,h,r){let z=null;const R=b.node;if(!ie.ParagraphReader.nc(R)||!R.isConnected)return{returnValue:!1,
Doa:z};if(r)return{returnValue:!0,Doa:b};r=b.cpBegin;const ba=b.cpEnd,ta=ie.ParagraphReader.text(R);if(0<=r&&ba<=ta.length&&ta.substring(r,ba)===h)return{returnValue:!0,Doa:b};const Wa=ta.indexOf(h);return 0<=Wa?(z=Qe.a.createTextRange(R,Wa,Wa+h.length),{returnValue:!0,Doa:z}):0<=r&&ba<=ta.length&&this.x4b(b)?{returnValue:!0,Doa:b}:{returnValue:!1,Doa:z}}x4b(b){if(!b||b.cpBegin>=b.cpEnd)return!1;var h=Qe.a.createTextRange(b.node,b.cpBegin,b.cpEnd);h=Pg.HyperlinkReader.ZC(h,!1);if(1===h.length){h=
h[0];const r=ie.ParagraphReader.text(b.node).substring(h.cpBegin,h.cpEnd).trim();if(b.cpEnd===h.cpEnd&&h.hyperlink.url!==r)return!0}return!1}uuf(b){return null==b.width&&null==b.height||null!=b.width&&null!=b.height&&0<b.width&&0<b.height?!0:!1}dwa(b,h){t.AFrameworkApplication.K&&t.AFrameworkApplication.K.$(h)&&window.setTimeout(()=>{const r=Sa.a.instance.Za("Common.ISystemInitiatedFeedback");r&&r.execute(z=>{z.logActivity(b,h)})},kh.zka)}Kdf(b,h){const r=!B.a.E1(h);switch(b){case 1:b=r?String.format(WordEditorIntl.WordEditorStrings.L_ExternalContentAriaNotifyMessage_InsertedVideoWithTitle,
h):WordEditorIntl.WordEditorStrings.L_ExternalContentAriaNotifyMessage_InsertedVideo;break;default:b=r?String.format(WordEditorIntl.WordEditorStrings.L_ExternalContentAriaNotifyMessage_InsertedWebContentWithTitle,h):WordEditorIntl.WordEditorStrings.L_ExternalContentAriaNotifyMessage_InsertedWebContent}return b}oCb(b,h,r,z=!1){if(this.mnm(r)){var R=kh.XSc.m3b(r);if(R)if(this.uuf(R)){v.ULS.sendTraceTag(591681428,324,50,"insertExternalContentImpl: URL Processed by ExternalContent");b=Object(la.a)(Qe.a,
b);var ba=!h;this.pVe(b,ba)?this.QNc(r)?(h=1===h,z=this.Hsl(b),R.hideFloatie=!0,this.s5b(z,b,ba,h,R,r)):this.zMf(b,h,R,r,z):kh.uf.OP(this.Tn,2,"URL inserted in Non-Embedable context",kh.uf.fo())}else v.ULS.sendTraceTag(577521882,324,50,"insertExternalContentImpl: Size is not valid for OEmbed"),kh.uf.OP(this.Tn,2,"Size provided is not valid for OEmbed",kh.uf.fo())}else v.ULS.sendTraceTag(591267584,324,50,"insertExternalContentImpl: URL inserted is not valid for ExternalContent"),kh.uf.OP(this.Tn,2,
"URL inserted is not valid for ExternalContent",kh.uf.fo())}Hsl(b){let h=new WA;h.Width=kh.u_.a0b(b.node)||0;h.Height=kh.u_.aXa(b.node)||0;h.Title="Fluid Component";h.MediaType="fluid";return h}QNc(b){return t.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.InsertFluidComponent",!1)&&null!=kh.zfa&&kh.zfa.Ghi(b)}zMf(b,h,r,z,R){const ba=!h,ta=1===h,Wa=kh.u_.a0b(b.node)||0,ub=kh.u_.aXa(b.node)||0,Ib=Ck.a.TYe(r.r9f,!0,Wa,ub);this.oRc(b,z,h,!0);this.o8e.Blh(Ib,$b=>{kh.uf.h3(this.Tn,
4,kh.uf.fo());kh.uf.l_c(this.Tn,this.eeb($b.data));if($b=this.FMf($b)){v.ULS.sendTraceTag(592307859,324,50,"PrepareAndQueueRequest: received a successful ExternalContent response for the url pasted");var fc=ly.p($b.MediaType);kh.uf.R2d(this.Tn,7,fc);fc=b;({Doa:fc}=this.Z9f(b,z,ta)).returnValue?(this.oRc(fc,z,h,!1),null==r.width?0<Wa&&$b.Width>Wa&&(v.ULS.sendTraceTag(591681426,324,50,"PrepareAndQueueRequest: received Width of ExternalContent more than the maxWidth in response"),$b.Width=Wa):(v.ULS.sendTraceTag(572618198,
324,50,"PrepareAndQueueRequest: Width of ExternalContent is provided for override"),$b.Width=this.w4c(r.width,$b.Width,Wa)),null==r.height?0<ub&&$b.Height>ub&&(v.ULS.sendTraceTag(591681427,324,50,"PrepareAndQueueRequest: received height of ExternalContent more than the maxHeight in response"),$b.Height=ub):(v.ULS.sendTraceTag(572618199,324,50,"PrepareAndQueueRequest: Height of ExternalContent is provided for override"),$b.Height=this.w4c(r.height,$b.Height,ub)),kh.Rka.a6a||R?this.s5b($b,fc,ba,ta,
r,z):(this.rEb=b,this.sEb=z,this.FCc(z))):(v.ULS.sendTraceTag(590955994,324,50,"PrepareAndQueueRequest: No conversion as the context is no longer valid for the external content conversion."),kh.uf.OP(this.Tn,2,"No conversion as the context is no longer valid for the external content conversion",kh.uf.fo()));ta&&this.fWa(fc.node)}else ta&&this.fWa(b.node),kh.uf.OP(this.Tn,1,"URL not oEmbedable",kh.uf.fo())},$b=>{kh.uf.h3(this.Tn,4,kh.uf.fo());kh.uf.l_c(this.Tn,this.eeb($b.data));ta&&this.fWa(b.node);
v.ULS.sendTraceTag(588834834,324,50,"Request failed in in InsertExternalContentImpl: "+$b.data.Ge);kh.uf.OP(this.Tn,2,"ExternalContentEmbedRequest failed",kh.uf.fo())},$b=>{ta&&this.fWa(b.node);v.ULS.sendTraceTag(588834835,324,50,"Request not allowed in InsertExternalContentImpl: "+$b)},this.Tn)}w4c(b,h,r){!b&&0<r&&h>r||b>r?(v.ULS.sendTraceTag(577521885,324,50,"ValidateAndFinalizeDimension: received Param of ExternalContent more than the maxParam"),h=r):b>r?h=r:b&&b<r&&(h=b);return h}s5b(b,h,r,z,
R,ba){this.em=pa.a.create();b.Width=b.Width/b.Height*(b.Height-(az.a.gLd+az.a.sda))+2*az.a.sda;const ta=new yf.GraphTransaction(15);ta.Db(h.node);ta.Al=Oa.a.dMa;const Wa=this.x4b(h);null!=R.uEa&&!R.uEa||z||Wa||(b.Title=""===R.title||R.title?R.title:b.Title,!b.Title&&""!==b.Title)||(h=this.pof(h,ta,b.Title,ba,r));if(h){z&&(h=this.b3e(h));var ub=this.Gxd(h,z);if(ub){r=ly.p(b.MediaType);var Ib=this.HHd(b,r);this.o6h=b.IFrameHtml;this.p6h=b.Title;if(ub=this.Xnf(ub,Ib,ta,z,ba,r))ta.NCa(this.em,1),ta.dispose(),
this.rEb=h,this.sEb=ba,this.HJf(R,b,ub),this.kMf(ba,z||R.hideFloatie,Wa,r,b.Title)}else ta.dispose(),v.ULS.sendTraceTag(590455041,324,10,"Unable to insert external content. Could not create IP context on splitting the paragraph."),kh.uf.OP(this.Tn,2,"Could not create IP context on splitting the paragraph",kh.uf.fo())}else kh.uf.OP(this.Tn,2,"GraphNodeContext is null",kh.uf.fo())}HHd(b,h){const r=new Ei.DictionaryPropertySet;kh.zT.o0d(r,b.Width,b.Height);b=this.Jdf(h,b.Title);r.setValue(We.a.imageAltText,
b);r.setValue(yc.a.yT,ac.a.RF());r.setValue(yc.a.imageType,0);return r}Xnf(b,h,r,z,R,ba){if(!b)return null;b=kh.zT.IMd(b,h);if(!b)return r.dispose(),v.ULS.sendTraceTag(590455042,324,10,"Unable to insert external content. The anchored image could not be inserted."),kh.uf.OP(this.Tn,2,"The anchored image could not be inserted",kh.uf.fo()),null;r=b.node;R=this.CMd(r,R,ba);kh.uf.y8f(this.Tn,R.id);z||this.NXf(r);return r}HJf(b,h,r){B.a.E1(b.thumbnailUrl)||(h.Thumbnail=b.thumbnailUrl);h.Thumbnail&&h.Thumbnail.length&&
(kh.uf.h3(this.Tn,8,kh.uf.fo()),v.ULS.sendTraceTag(591681431,324,50,"OverrideAndDownloadThumbnailImage: ExternalContent contains a Thumbnail image url"),this.rEc(r,h.Thumbnail))}kMf(b,h,r,z,R){h||this.FCc(b);this.dwa("OEmbedInserted","ExternalContentFloodGateSurveyIsEnabled");this.tZd("IsHyperlinkWithNonURLDisplayText",r);this.ariaNotify(z,R);kh.uf.h3(this.Tn,5,kh.uf.fo())}tZd(b,h){v.ULS.sendTraceTag(591267585,324,50,"OtelLogging: ExternalContent transaction successfully completed");Y.a.sendTelemetryEvent(Object.assign(new da.a,
{name:"Office.Word.Online.ExternalContent.OEmbedInsertions",dataFields:[Object.assign(new ca.a,{name:b,bool:h})]}))}ariaNotify(b,h){this.cKb&&kh.jw&&(b=this.Kdf(b,h),kh.jw.sendNotification(b,!0))}pof(b,h,r,z,R){if(R){if((R=Pg.HyperlinkReader.ZC(b,!1))&&1!==R.length)return h.dispose(),v.ULS.sendTraceTag(590455040,324,10,"Insertion of ExternalContent due to autoCorrect was canceled due to source Hyperlink not found."),null;kh.hyperlinkEditor.RQ(R[0].paragraph,R[0].hyperlink)}return this.tTf(b,r,z)}b3e(b){const h=
b.node,r=ie.ParagraphReader.text(h);return 0<r.length&&!r.trim().length?(b=Qe.a.createTextRange(h,0,r.length),kh.characterPropertiesEditor.replaceTextRange(b,""),Qe.a.Uc(h,0)):b}Gxd(b,h){return h?b:this.Hef(b)}Hef(b){const h=ie.ParagraphReader.text(b.node),r=Nd.GraphIterator.$a(b.node);if(r.vd()){b=Qe.a.Uc(b.node,b.cpEnd);ag.OutlineElementNavigator.Zd(r);const z=kh.Wg.xta(r);kh.Kh.mba(r,z,b,!0,!0,!0,!0);""!=h&&kh.Kh.eD(r,!1,!0);r.Xd();return Qe.a.Uc(r.currentNode,0)}return null}FMf(b){if(!({group:b}=
yl.a.M7(b.data.Ge)).returnValue)return null;b=b.Responses[0];return b.StatusCode?null:b}tTf(b,h,r){const z=b.cpBegin+h.length;kh.characterPropertiesEditor.replaceTextRange(b,h);b=Qe.a.createTextRange(b.node,b.cpBegin,z);kh.hyperlinkEditor.NG(b,r,!1);return b}Jdf(b,h){const r=!B.a.E1(h);switch(b){case 1:return r?String.format(WordEditorIntl.WordEditorStrings.L_ExternalContentThumbnailAltText_VideoWithTitle,h):WordEditorIntl.WordEditorStrings.L_ExternalContentThumbnailAltText_Video;default:return r?
String.format(WordEditorIntl.WordEditorStrings.L_ExternalContentThumbnailAltText_WebContentWithTitle,h):WordEditorIntl.WordEditorStrings.L_ExternalContentThumbnailAltText_WebContent}}rEc(b,h){b.Di().contentReplicator.forceOutbound(()=>{this.DMf(h,b)},()=>{v.ULS.sendTraceTag(592996173,324,15,"ForceOutbound for DoServerRequestToDownloadThumbnailImageBlob failed")},null)}HRc(b){b=Nd.GraphIterator.$a(b);b.Bb(12);b.kd(12);b.Cn.yP=!0}fWa(b){b.Nac=null}NXf(b){b=Nd.GraphIterator.$a(b);b.Bb(11)&&(b.kd(11),
b.vd()&&b.xj()&&b.Xd()&&ie.ParagraphReader.nc(b.currentNode)&&(b=Hf.SelectionFactory.xe(b.currentNode,0),di.a.instance.setSelection(b)))}oRc(b,h,r,z){const R=b.cpBegin,ba=b.cpEnd;b=ie.ParagraphReader.text(b.node).trim();R||b!==h&&""!==b?R?ba===b.length?v.ULS.sendTraceTag(590958601,324,50,"LogPastePositionTelemetry: OEmbed conversion happended at the end of the paragraph ExternalContentConversionContext = {0}, BeforeRequestCallback = {1}",Ku[r],z):0<R&&ba<b.length&&v.ULS.sendTraceTag(590958602,324,
50,"LogPastePositionTelemetry: OEmbed conversion happended in between of a paragraph ExternalContentConversionContext = {0}, BeforeRequestCallback = {1}",Ku[r],z):v.ULS.sendTraceTag(590958600,324,50,"LogPastePositionTelemetry: OEmbed conversion happended at the start of the paragraph ExternalContentConversionContext = {0}, BeforeRequestCallback = {1}",Ku[r],z):v.ULS.sendTraceTag(590958599,324,50,"LogPastePositionTelemetry: OEmbed conversion happended in a blank paragraph ExternalContentConversionContext = {0}, BeforeRequestCallback = {1}",
Ku[r],z)}FCc(b){this.g0b();const h=new Yu.a(1,t.AFrameworkApplication.isRtl);h.VUc=b;kh.Ccb.TWc(h)}g0b(){const b=new Xu.a(!0);kh.Iac.HDa(b)}DMf(b,h){if(b=this.Igf(b,h))h=Array(1),h[0]=b,b=tD.a.construct(h,!1,t.AFrameworkApplication.K.$("SendFileIdInPicturePasteRequestBodyIsEnabled")?this.hp.Fs:null),h=this.a1e(),this.dkb(h,b)}Igf(b,h){if(!h)return v.ULS.sendTraceTag(592996172,324,10,"GetPastedPictureForPicturePasteRequest: image node cannot be null"),null;this.hp=h.Di();(new Nd.GraphIterator).set(h);
if(!h.anchor||!h.anchor.Ip||!h.anchor.Ip.yr)return v.ULS.sendTraceTag(592996171,324,10,"GetPastedPictureForPicturePasteRequest: image node not properly connected to parent paragraph"),null;var r=h.anchor.Ip.yr.node;if(!r)return v.ULS.sendTraceTag(592996170,324,10,"GetPastedPictureForPicturePasteRequest: paragraph node cannot be null"),null;let z=Sl.a.Cq;xg.a.instance.J(4)&&(z=r.ia(ui.a.mK,Sl.a.Cq));r=h.getValue(We.a.oL);const R=Rf.a.yf($d.ImageReader.ZG(h.properties),0),ba=Rf.a.yf($d.ImageReader.YJ(h.properties),
1);return uD.a.construct(h.id.toString(),b,h.ia(We.a.imageAltText,""),R,ba,h.ia(yc.a.PW,""),z,h.ia(yc.a.yT,0),h.ia(yc.a.hfa,!1),h.ia(ui.a.Zda,-1),h.ia(yc.a.lhb,Box4Intl.Box4Strings.l_Picture),h.ia(We.a.ifa,!1),r,h.ia(yc.a.runId,1),h.ia(yc.a.Nc,0))}dkb(b,h){t.AFrameworkApplication.Xe.Lj(b,2,y.c(h),{},!1,2,this.picturePasteRequestSucceeded,this.Tac,null,void 0,void 0,void 0,void 0,"26");v.ULS.sendTraceTag(590874565,324,50,"Picture paste request for External Content")}a1e(){let b=Rc.a.dEd("PicturePaste.ashx");
t.AFrameworkApplication.K&&!t.AFrameworkApplication.K.$("SendFileIdInPicturePasteRequestBodyIsEnabled")&&(b=Rc.a.Pn(b,Tj.a.fileId,this.hp.Fs));b=Rc.a.Pn(b,Tj.a.cellId,this.hp.Zl.toString());this.em||(this.em=pa.a.create(),v.ULS.sendTraceTag(591683677,324,15,"CreateUrlForPicturePaste: desiredRevisionId should not be null"));b=Rc.a.Pn(b,Tj.a.R1,this.em.toString());b=Rc.a.Pn(b,Tj.a.classId,(393233).toString());this.hp.jI&&(b=Rc.a.Pn(b,Tj.a.jI,this.hp.jI));b=Rc.a.Pn(b,Tj.a.Emb,"1");b=Rc.a.Pn(b,rg.a.imageType,
"0");b=zl.a.instance.XOe(b);this.hp.contentReplicator&&this.hp.contentReplicator.YDb&&(b=Rc.a.Pn(b,Tj.a.lTe,"1"));b=Rc.a.Pn(b,Tj.a.Ara,this.hp.contentReplicator.eu.toString());b=Rc.a.Pn(b,Tj.a.Kac,"0");return b=Rc.a.Pn(b,Tj.a.rMb,"1")}static get Ccb(){return null!=kh.Jig?kh.Jig:kh.Jig=Sa.a.instance.resolve("Box4.IExternalContentFloatieEventSource")}static get Rka(){kh.qxa||(kh.qxa=Sa.a.instance.resolve("WordEditor.ExternalContent.IExternalContentSettingInfo"));return kh.qxa}static get Iac(){return null!=
kh.Apg?kh.Apg:kh.Apg=Sa.a.instance.resolve("Box4.IPasteFloatieEventSource")}static get jw(){return null!=kh.Agg?kh.Agg:kh.Agg=Sa.a.instance.resolve("Common.Utils.IAriaNotifier")}static get u_(){return null!=kh.pqg?kh.pqg:kh.pqg=Sa.a.instance.resolve("WordEditor.ExternalContent.IExternalContentSizeBehavior")}static get zT(){return null!=kh.mlg?kh.mlg:kh.mlg=Sa.a.instance.resolve("WordEditor.IImageEditor")}static get Wg(){return kh.Kh||(kh.Kh=Sa.a.instance.resolve("Box4.IOutlineElementEditor"))}static get hyperlinkEditor(){return null!=
kh.blg?kh.blg:kh.blg=Sa.a.instance.resolve("Box4.IHyperlinkEditor")}static get characterPropertiesEditor(){return null!=kh.jhg?kh.jhg:kh.jhg=Sa.a.instance.resolve("Box4.ICharacterPropertiesEditor")}static get uf(){return null!=kh.Sig?kh.Sig:kh.Sig=Sa.a.instance.resolve("Wonca.IExternalContentPerfMetricsHandler")}static get XSc(){return null!=kh.kog?kh.kog:kh.kog=Sa.a.instance.resolve("WordEditor.ExternalContent.IOEmbedOverridesURLParser")}static get zfa(){return null!=kh.eog?kh.eog:kh.eog=Sa.a.instance.resolve("Fluid.Host.LoopComponentManager")}}
kh.Kh=null;kh.zka=5E3;kh.qxa=null;Object(n.a)(kh,"ExternalContentEditor",null,[349]);var Yz=d(265),xD=d(1200);class yD{constructor(b,h){this.a6a=!0;this.$0a=r=>{if(null!=r.result)return r.result.Value;v.ULS.sendTraceTag(556376794,324,15,"onRegister get convertExternalContentIsEnabled settings options from Roaming Service failed.");return this.a6a};this.YCa=r=>{r.ho||r.Ji?v.ULS.sendTraceTag(559153884,324,15,"Load to get convertExternalContentIsEnabled settings options from Roaming Service failed."):
(this.wih(r.result),v.ULS.sendTraceTag(559437389,324,50,"Load to get convertExternalContentIsEnabled settings options from Roaming Service successfully"));return this.a6a};this.Vu=b;this.FJ=h}OOh(){const b=new cc.a;this.Hgi()&&this.FJ?this.FJ.T1a(Yz.a.jCc).CWRCo(this.$0a,0).CWRCo(this.YCa,8):b.Gg(this.a6a)}V_(b){this.FJ&&this.FJ.V_(Yz.a.jCc,new xD.a(Yz.a.jCc,b))}HBn(b){this.Hgi()&&(this.Vu.Qga("saveConvertExternalContentIsEnabled",b.toString()),v.ULS.sendTraceTag(559437386,324,50,"Try to save convertExternalContentIsEnabled settings value to Roaming Service."),
this.wih(b),this.V_(b))}Hgi(){const b=t.AFrameworkApplication.K.$("IsAnonymousUser");if(t.AFrameworkApplication.K.$("IsRoamingServiceEnabled"))if(b)v.ULS.sendTraceTag(559437387,324,50,"User is anonymous ");else return!0;return!1}wih(b){this.a6a=b}}Object(n.a)(yD,"ExternalContentSettingInfo",null,[348]);var Zz=d(1125);class No{constructor(){this.thumbnail=this.author=this.title=this.mediaType=this.url=null;this.height=this.width=0;this.type=null;this.showFloatie=!1}}Object(n.a)(No,"FluidComponentProperties",
null,[]);class zD{constructor(){this.loopType=this.mw=this.uWa=this.url=null;this.mediaType=0;this.doi=null}}Object(n.a)(zD,"IFrameProps",null,[]);class vl{static get u_(){return null!=vl.nqg?vl.nqg:vl.nqg=Sa.a.instance.resolve("WordEditor.ExternalContent.IExternalContentSizeBehavior")}static get zT(){return vl.ij||(vl.ij=Sa.a.instance.resolve("WordEditor.IImageEditor"))}static get jw(){return null!=vl.zgg?vl.zgg:vl.zgg=Sa.a.instance.resolve("Common.Utils.IAriaNotifier")}static get hyperlinkEditor(){return null!=
vl.Wkg?vl.Wkg:vl.Wkg=Sa.a.instance.resolve("Box4.IHyperlinkEditor")}static get Wg(){return null!=vl.Eog?vl.Eog:vl.Eog=Sa.a.instance.resolve("Box4.IOutlineElementEditor")}static get characterPropertiesEditor(){return null!=vl.ihg?vl.ihg:vl.ihg=Sa.a.instance.resolve("Box4.ICharacterPropertiesEditor")}static QMa(b){const h=b.startsWith(Pg.HyperlinkReader.vbc),r=b.startsWith(Pg.HyperlinkReader.RVc),z=b.startsWith(Pg.HyperlinkReader.W0d);return(h||r||z)&&Pg.HyperlinkReader.QMa(b)}static pVe(b,h){let r=
!1;if(b){switch(b.contextId){case kc.a.Wc:r=!h;break;case kc.a.Gd:r=!0}r&&!HB.a(b.node)&&(r=!1)}return r}static x4b(b){if(!b||b.cpBegin>=b.cpEnd)return!1;var h=Qe.a.createTextRange(b.node,b.cpBegin,b.cpEnd);h=Pg.HyperlinkReader.ZC(h,!1);if(1===h.length){h=h[0];const r=ie.ParagraphReader.text(b.node).substring(h.cpBegin,h.cpEnd).trim();if(b.cpEnd===h.cpEnd&&h.hyperlink.url!==r)return!0}return!1}static Jdf(b,h){const r=!B.a.E1(h);switch(b){case 1:return r?String.format(WordEditorIntl.WordEditorStrings.L_ExternalContentThumbnailAltText_VideoWithTitle,
h):WordEditorIntl.WordEditorStrings.L_ExternalContentThumbnailAltText_Video;default:return r?String.format(WordEditorIntl.WordEditorStrings.L_ExternalContentThumbnailAltText_WebContentWithTitle,h):WordEditorIntl.WordEditorStrings.L_ExternalContentThumbnailAltText_WebContent}}static HRc(b){b=Nd.GraphIterator.$a(b);b.Bb(12);b.kd(12);b.Cn.yP=!0}static HHd(b,h,r,z){const R=new Ei.DictionaryPropertySet;vl.zT.o0d(R,h,b);b=vl.Jdf(z,r);R.setValue(We.a.imageAltText,b);R.setValue(yc.a.yT,ac.a.RF());R.setValue(yc.a.imageType,
0);return R}static CMd(b,h){if(!b||!b.isConnected||!$d.ImageReader.ww(b))return null;const r=new wD.a;r.setValue(Ij.a.V4b,h.mediaType);r.setValue(Ij.a.qZa,h.url);r.setValue(od.a.loopComponentType,h.loopType);r.uWa=h.uWa;r.mw=h.mw;r.O_a=1===h.mediaType;r.createMode=h.doi;Nd.GraphIterator.$a(b).Sf(r,2);vl.HRc(r);return r}static Gxd(b,h){return h?b:vl.Hef(b)}static Hef(b){const h=ie.ParagraphReader.text(b.node),r=Nd.GraphIterator.$a(b.node);if(r.vd()){b=Qe.a.Uc(b.node,b.cpEnd);ag.OutlineElementNavigator.Zd(r);
const z=vl.Wg.xta(r);vl.Wg.mba(r,z,b,!0,!0,!0,!0);""!=h&&vl.Wg.eD(r,!1,!0);r.Xd();return Qe.a.Uc(r.currentNode,0)}return null}static NXf(b){b=Nd.GraphIterator.$a(b);b.Bb(11)&&(b.kd(11),b.vd()&&b.xj()&&b.Xd()&&ie.ParagraphReader.nc(b.currentNode)&&(b=Hf.SelectionFactory.xe(b.currentNode,0),di.a.instance.setSelection(b)))}static Kdf(b,h){const r=!B.a.E1(h);switch(b){case 1:b=r?String.format(WordEditorIntl.WordEditorStrings.L_ExternalContentAriaNotifyMessage_InsertedVideoWithTitle,h):WordEditorIntl.WordEditorStrings.L_ExternalContentAriaNotifyMessage_InsertedVideo;
break;default:b=r?String.format(WordEditorIntl.WordEditorStrings.L_ExternalContentAriaNotifyMessage_InsertedWebContentWithTitle,h):WordEditorIntl.WordEditorStrings.L_ExternalContentAriaNotifyMessage_InsertedWebContent}return b}static ariaNotify(b,h){vl.jw&&(b=vl.Kdf(b,h),vl.jw.sendNotification(b,!0))}static tZd(b,h,r){v.ULS.sendTraceTag(591267585,324,50,"OtelLogging: ExternalContent transaction successfully completed");Y.a.sendTelemetryEvent(Object.assign(new da.a,{name:r,dataFields:[Object.assign(new ca.a,
{name:b,bool:h})]}))}}Object(n.a)(vl,"ExternalContentHelper",null,[]);var $z=d(918),AD=d(1156);class Os extends AD.a{constructor(){super(...arguments);this.Tn=null}static get uf(){return null!=Os.Rig?Os.Rig:Os.Rig=Sa.a.instance.resolve("Wonca.IExternalContentPerfMetricsHandler")}Ekj(b,h,r){return vl.QMa(h)?vl.pVe(b,r)?!0:(Os.uf.OP(this.Tn,2,"URL inserted in Non-Embedable context",Os.uf.fo()),!1):(v.ULS.sendTraceTag(591267584,324,50,"insertExternalContentImpl: URL inserted is not valid for ExternalContent"),
Os.uf.OP(this.Tn,2,"URL inserted is not valid for ExternalContent",Os.uf.fo()),!1)}}Object(n.a)(Os,"AbstractExternalContentEditor",AD.a,[349]);var lq=d(891),uC=d(1155);class Wr extends Os{constructor(b){super();Wr.ZSa=b;this.Wwf()}Wwf(){this.Fhc&&uC.a.Wwf(Wr.ZSa.uPh())}static get paragraphEditor(){return null!=Wr.cpg?Wr.cpg:Wr.cpg=Sa.a.instance.resolve("Box4.IParagraphEditor")}HJk(b,h){h=this.gUh(b,h);this.R8h(h,b,5)}dMa(b,h,r){this.Ekj(b,h,r)&&(r=this.gUh(b,null),r.url=h,this.R8h(r,b,2))}r_d(b,h){this.dMa(b,
h,!1)}R8h(b,h,r){this.em=pa.a.create();const z=new yf.GraphTransaction(15);z.Db(h.node);z.Al=Oa.a.w5l;const R=vl.x4b(h),ba=ly.p(b.mediaType),ta=vl.HHd(b.height,b.width,b.title,ba);h=this.Oio(h,1==r);(h=vl.ij.IMd(h,ta))?(h=h.node,vl.CMd(h,{url:b.url,mediaType:ba,mw:b.title,loopType:b.type,doi:r})||v.ULS.sendTraceTag(538817433,324,50,"insertFluidComponentCore: Iframe node is null"),z.NCa(this.em,1),z.dispose(),this.rEc(h,b.thumbnail,this.Fhc),this.I6m(R,ba,b.type)):v.ULS.sendTraceTag(538817432,324,
50,"insertFluidComponentCore: insertPictureResult is null")}Oio(b,h){vl.characterPropertiesEditor.replaceTextRange(b,"");return vl.Gxd(b,h)}I6m(b,h,r){vl.tZd("IsHyperlinkWithNonURLDisplayText",b,"Office.Word.Online.ExternalContent.FluidComponent");vl.ariaNotify(h,this.Dil(r))}Dil(b){switch(b){case $z.a.CheckList:return"Checklist Component";case $z.a.TaskAssignment:return"Task List Component";case $z.a.Poll:return"Poll Component";default:return"Fluid Component"}}gUh(b,h){let r=new No;r.width=vl.u_.a0b(b.node)||
0;ly.h()?r.height=null!=Wr.ZSa&&Wr.ZSa.sPh(h)||vl.u_.aXa(b.node)||0:r.height=null!=Wr.ZSa&&Wr.ZSa.sPh(h)+2*az.a.sda||vl.u_.aXa(b.node)||0;r.title="Fluid Component";r.mediaType="fluid";r.type=h;r.thumbnail=this.Isl(r.width,r.height);r.url=null!=Wr.ZSa&&"https://fa000000096.resources.office.net/f7024bdc-7caf-4ca8-807d-2908f09640d6/1.0.2210.23001/en-us_web/assets/fallback.jpg";return r}Isl(b,h){return this.Fhc?uC.a.aRh(b,h):Wr.ZSa.uPh()}get Fhc(){return null!=this.Csg?this.Csg:this.Csg=t.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.useUpdatedFluidThumbailEnabled",
!1)}static QNc(b){t.AFrameworkApplication.Hf("04a02846;bab1g953");return t.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.InsertFluidComponent",!1)&&null!=Wr.ZSa&&Wr.ZSa.Ghi(b)&&lq.a.PNc()}}Object(n.a)(Wr,"FluidComponentEditor",Os,[]);class BD{get X5k(){return null!=this.Iig?this.Iig:this.Iig=Sa.a.instance.resolve("Wonca.ExternalContent.IExternalContentEditor")}get kDd(){return null!=this.Vjg?this.Vjg:this.Vjg=Sa.a.instance.resolve("WordEditor.ExternalContent.FluidComponentEditor")}D6m(b,
h){b&&(Wr.QNc(h)?this.kDd.dMa(b,h,!0):this.X5k.dMa(b,h,!0))}}Object(n.a)(BD,"PostHyperlinkAutoCorrectStrategy",null,[346]);class aA{LYb(b,h){h(aA.M6m.test(b))}Ecc(b,h){b.startsWith("https")||(b=b.replace("http","https"));b=String.format("<iframe width='{0}' height='{1}' src='{2}' frameborder='0' allow='accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture' allowfullscreen='' sandbox='allow-scripts allow-same-origin'></iframe>",960,960,b);b=Object.assign(new WA,{OperationId:0,
StatusCode:0,MediaType:"rich",Height:960,Width:960,Thumbnail:aA.thumbnailUrl,Title:"Power BI",IFrameHtml:b});h(b)}}aA.M6m=RegExp("^https?:\\/\\/(app|msit).powerbi.com\\/view\\?r=[^\\/]+$","i");aA.thumbnailUrl="https://www.onenote.com/Images/oembed_powerbi_defaultthumbnail.png";Object(n.a)(aA,"PowerBIURLResolver",null,[344,345]);class Xv{constructor(b){this.H4g=b}LYb(b,h){let r=!1;try{if(Xv.mlm(b)){const z=this.H4g.m3b(b);r=null!=z.width&&null!=z.height&&!!z.thumbnailUrl&&!!z.title&&null!=z.uEa}}catch(z){}h(r)}Ecc(b,
h){var r=this.H4g.m3b(b);b=String.format("<iframe width='{0}' height='{1}' src='{2}' frameborder='0' style='border:none' allowfullscreen='true' allow='accelerometer; autoplay; battery; camera; clipboard-write; encrypted-media; fullscreen; gyroscope; picture-in-picture; sync-xhr; wake-lock; screen-wake-lock; web-share' sandbox='allow-downloads allow-forms allow-modals allow-pointer-lock allow-popups allow-presentation allow-scripts allow-same-origin'></iframe>",r.width,r.height,b);r=Object.assign(new WA,
{Height:r.height,IFrameHtml:b,MediaType:"rich",OperationId:0,StatusCode:0,Thumbnail:r.thumbnailUrl,Title:r.title,Width:r.width});h(r)}static mlm(b){for(let h of Xv.r4n)if(b.startsWith(h))return!0;return!1}static Nda(){return new Xv(Sa.a.instance.resolve("WordEditor.ExternalContent.IOEmbedOverridesURLParser"))}}Xv.r4n=["https://wedge.wedge:9090/","https://wedgecomponents.azurewebsites.net/"];Object(n.a)(Xv,"WedgeComponentExperimentsURLResolver",null,[344,345]);class bz{constructor(b,h,r){this.ga=b;
this.XDj=h;this.Ok=r}Vb(){this.ga.gb(Oa.a.X8h,kc.a.Wc,this.P5l.bind(this),1028);this.ga.gb(Oa.a.GMc,kc.a.Wc,this.aof.bind(this),1028);this.ga.gb(Oa.a.vMc,kc.a.Wc,this.aof.bind(this),1028);this.ga.gb(Oa.a.kof,kc.a.Wc,this.aof.bind(this),1028);this.ga.gb(Oa.a.Hki,kc.a.Wc,this.cqj.bind(this),1028)}P5l(){return 32}aof(b,h,r){var z,R;if(1===r){if(!this.PNc(b)||!wh.a.COd())return 2;Ah.F0f(Ah.W6n);if(!h.vl||!Xd.SelectionEditor.xf(h)||Nr.a.Bwd&&(null===(z=this.Ok)||void 0===z?0:z.iZ(h))||(null===(R=this.Ok)||
void 0===R?0:R.Jta(h)))return 2;if(h&&h.node&&HB.a(h.node))return 32}else if(2===r)return this.XDj.HJk(h,bz.Gsl(b)),32;return 2}PNc(b){return b===Oa.a.vMc||b===Oa.a.GMc?lq.a.PNc():!0}cqj(b,h,r){2===r&&B.a.aX("https://go.microsoft.com/fwlink/?linkid=2194838")&&vb.App.HVf.ahc("https://go.microsoft.com/fwlink/?linkid=2194838");return 32}static Gsl(b){switch(b){case Oa.a.GMc:return $z.a.TaskAssignment;case Oa.a.vMc:return $z.a.CheckList;case Oa.a.kof:return $z.a.Poll;default:return null}}}Object(n.a)(bz,
"FluidComponentsActor",null,[]);class Ti extends Os{constructor(){super();this.sEb=this.rEb=null;this.o8e=new vD.ExternalContentEmbedRetriever;this.knc=null;null!=Ti.Rka&&Ti.Rka.OOh()}PJi(){this.Tn=E.a.create();Ti.uf.uxb(this.Tn,4);Ti.uf.h3(this.Tn,0,Ti.uf.fo());this.oCb(this.rEb,3,this.sEb,!0)}dMa(b,h,r){this.Tn=E.a.create();Ti.uf.uxb(this.Tn,r?0:2);Ti.uf.h3(this.Tn,0,Ti.uf.fo());this.knc();this.oCb(b,r?0:2,h)}r_d(b,h){this.Tn=E.a.create();Ti.uf.uxb(this.Tn,1);Ti.uf.h3(this.Tn,0,Ti.uf.fo());this.oCb(b,
1,h)}JLi(b){this.knc=b}age(b,h){const r=Ti.u_.a0b(h)||0;h=Ti.u_.aXa(h)||0;const z=b.Width/b.Height;1<=z?(b.Width=r,b.Height=r/z):(b.Height=h,b.Width=h/z)}vcg(b,h,r){if(null!=b&&null!=h&&!B.a.mf(r)){var z=Ti.XSc.m3b(r);z.uEa=!0;z.hideFloatie=!0;this.age(b,h.node);this.s5b(b,h,!1,!1,z,r)}}eeb(b){return b?b.wf:0}Z9f(b,h,r){let z=null;const R=b.node;if(!ie.ParagraphReader.nc(R)||!R.isConnected)return{returnValue:!1,Doa:z};if(r)return{returnValue:!0,Doa:b};r=b.cpBegin;const ba=b.cpEnd,ta=ie.ParagraphReader.text(R);
if(0<=r&&ba<=ta.length&&ta.substring(r,ba)===h)return{returnValue:!0,Doa:b};const Wa=ta.indexOf(h);return 0<=Wa?(z=Qe.a.createTextRange(R,Wa,Wa+h.length),{returnValue:!0,Doa:z}):0<=r&&ba<=ta.length&&vl.x4b(b)?{returnValue:!0,Doa:b}:{returnValue:!1,Doa:z}}uuf(b){return null==b.width&&null==b.height||null!=b.width&&null!=b.height&&0<b.width&&0<b.height?!0:!1}dwa(b,h){t.AFrameworkApplication.K&&t.AFrameworkApplication.K.$(h)&&window.setTimeout(()=>{const r=Sa.a.instance.Za("Common.ISystemInitiatedFeedback");
r&&r.execute(z=>{z.logActivity(b,h)})},Ti.zka)}oCb(b,h,r,z=!1){if(this.Ekj(b,r,!h)){var R=Ti.XSc.m3b(r);R&&(this.uuf(R)?(v.ULS.sendTraceTag(591681428,324,50,"insertExternalContentImpl: URL Processed by ExternalContent"),this.zMf(b,h,R,r,z)):(v.ULS.sendTraceTag(577521882,324,50,"insertExternalContentImpl: Size is not valid for OEmbed"),Ti.uf.OP(this.Tn,2,"Size provided is not valid for OEmbed",Ti.uf.fo())))}}zMf(b,h,r,z,R){const ba=!h,ta=1===h,Wa=Ti.u_.a0b(b.node)||0,ub=Ti.u_.aXa(b.node)||0,Ib=Ck.a.TYe(r.r9f,
!0,Wa,ub);this.oRc(b,z,h,!0);this.o8e.Blh(Ib,$b=>{Ti.uf.h3(this.Tn,4,Ti.uf.fo());Ti.uf.l_c(this.Tn,this.eeb($b.data));if($b=this.FMf($b)){v.ULS.sendTraceTag(592307859,324,50,"PrepareAndQueueRequest: received a successful ExternalContent response for the url pasted");var fc=ly.p($b.MediaType);Ti.uf.R2d(this.Tn,7,fc);fc=b;({Doa:fc}=this.Z9f(b,z,ta)).returnValue?(this.oRc(fc,z,h,!1),null==r.width?0<Wa&&$b.Width>Wa&&(v.ULS.sendTraceTag(591681426,324,50,"PrepareAndQueueRequest: received Width of ExternalContent more than the maxWidth in response"),
$b.Width=Wa):(v.ULS.sendTraceTag(572618198,324,50,"PrepareAndQueueRequest: Width of ExternalContent is provided for override"),$b.Width=this.w4c(r.width,$b.Width,Wa)),null==r.height?0<ub&&$b.Height>ub&&(v.ULS.sendTraceTag(591681427,324,50,"PrepareAndQueueRequest: received height of ExternalContent more than the maxHeight in response"),$b.Height=ub):(v.ULS.sendTraceTag(572618199,324,50,"PrepareAndQueueRequest: Height of ExternalContent is provided for override"),$b.Height=this.w4c(r.height,$b.Height,
ub)),Ti.Rka.a6a||R?this.s5b($b,fc,ba,ta,r,z):(this.rEb=b,this.sEb=z,this.FCc(z))):(v.ULS.sendTraceTag(590955994,324,50,"PrepareAndQueueRequest: No conversion as the context is no longer valid for the external content conversion."),Ti.uf.OP(this.Tn,2,"No conversion as the context is no longer valid for the external content conversion",Ti.uf.fo()));ta&&this.fWa(fc.node)}else ta&&this.fWa(b.node),Ti.uf.OP(this.Tn,1,"URL not oEmbedable",Ti.uf.fo())},$b=>{Ti.uf.h3(this.Tn,4,Ti.uf.fo());Ti.uf.l_c(this.Tn,
this.eeb($b.data));ta&&this.fWa(b.node);v.ULS.sendTraceTag(588834834,324,50,"Request failed in in InsertExternalContentImpl: "+$b.data.Ge);Ti.uf.OP(this.Tn,2,"ExternalContentEmbedRequest failed",Ti.uf.fo())},$b=>{ta&&this.fWa(b.node);v.ULS.sendTraceTag(588834835,324,50,"Request not allowed in InsertExternalContentImpl: "+$b)},this.Tn)}w4c(b,h,r){!b&&0<r&&h>r||b>r?(v.ULS.sendTraceTag(577521885,324,50,"ValidateAndFinalizeDimension: received Param of ExternalContent more than the maxParam"),h=r):b>r?
h=r:b&&b<r&&(h=b);return h}s5b(b,h,r,z,R,ba){this.em=pa.a.create();b.Width=b.Width/b.Height*(b.Height-(az.a.gLd+az.a.sda))+2*az.a.sda;const ta=new yf.GraphTransaction(15);ta.Db(h.node);ta.Al=Oa.a.dMa;const Wa=vl.x4b(h);null!=R.uEa&&!R.uEa||z||Wa||(b.Title=""===R.title||R.title?R.title:b.Title,!b.Title&&""!==b.Title)||(h=this.pof(h,ta,b.Title,ba,r));if(h){z&&(h=this.b3e(h));var ub=vl.Gxd(h,z);if(ub){r=ly.p(b.MediaType);var Ib=vl.HHd(b.Height,b.Width,b.Title,r);(ub=this.Xnf(ub,Ib,z,{url:ba,uWa:b.IFrameHtml,
mw:b.Title,mediaType:r}))?(ta.NCa(this.em,1),ta.dispose(),this.rEb=h,this.sEb=ba,this.HJf(R,b,ub),this.kMf(ba,z||R.hideFloatie,Wa,r,b.Title)):ta.dispose()}else ta.dispose(),v.ULS.sendTraceTag(590455041,324,10,"Unable to insert external content. Could not create IP context on splitting the paragraph."),Ti.uf.OP(this.Tn,2,"Could not create IP context on splitting the paragraph",Ti.uf.fo())}else Ti.uf.OP(this.Tn,2,"GraphNodeContext is null",Ti.uf.fo())}Xnf(b,h,r,z){if(!b)return null;b=Ti.zT.IMd(b,h);
if(!b)return v.ULS.sendTraceTag(590455042,324,10,"Unable to insert external content. The anchored image could not be inserted."),Ti.uf.OP(this.Tn,2,"The anchored image could not be inserted",Ti.uf.fo()),null;b=b.node;z=vl.CMd(b,z);Ti.uf.y8f(this.Tn,z.id);r||vl.NXf(b);return b}HJf(b,h,r){B.a.E1(b.thumbnailUrl)||(h.Thumbnail=b.thumbnailUrl);h.Thumbnail&&h.Thumbnail.length&&(Ti.uf.h3(this.Tn,8,Ti.uf.fo()),v.ULS.sendTraceTag(591681431,324,50,"OverrideAndDownloadThumbnailImage: ExternalContent contains a Thumbnail image url"),
this.rEc(r,h.Thumbnail,!1))}kMf(b,h,r,z,R){h||this.FCc(b);this.dwa("OEmbedInserted","ExternalContentFloodGateSurveyIsEnabled");vl.tZd("IsHyperlinkWithNonURLDisplayText",r,"Office.Word.Online.ExternalContent.OEmbedInsertions");vl.ariaNotify(z,R);Ti.uf.h3(this.Tn,5,Ti.uf.fo())}pof(b,h,r,z,R){if(R){if((R=Pg.HyperlinkReader.ZC(b,!1))&&1!==R.length)return h.dispose(),v.ULS.sendTraceTag(590455040,324,10,"Insertion of ExternalContent due to autoCorrect was canceled due to source Hyperlink not found."),null;
vl.hyperlinkEditor.RQ(R[0].paragraph,R[0].hyperlink)}return this.tTf(b,r,z)}b3e(b){const h=b.node,r=ie.ParagraphReader.text(h);return 0<r.length&&!r.trim().length?(b=Qe.a.createTextRange(h,0,r.length),vl.characterPropertiesEditor.replaceTextRange(b,""),Qe.a.Uc(h,0)):b}FMf(b){if(!({group:b}=yl.a.M7(b.data.Ge)).returnValue)return null;b=b.Responses[0];return b.StatusCode?null:b}tTf(b,h,r){const z=b.cpBegin+h.length;vl.characterPropertiesEditor.replaceTextRange(b,h);b=Qe.a.createTextRange(b.node,b.cpBegin,
z);vl.hyperlinkEditor.NG(b,r,!1);return b}fWa(b){b.Nac=null}oRc(b,h,r,z){const R=b.cpBegin,ba=b.cpEnd;b=ie.ParagraphReader.text(b.node).trim();R||b!==h&&""!==b?R?ba===b.length?v.ULS.sendTraceTag(590958601,324,50,"LogPastePositionTelemetry: OEmbed conversion happended at the end of the paragraph ExternalContentConversionContext = {0}, BeforeRequestCallback = {1}",Ku[r],z):0<R&&ba<b.length&&v.ULS.sendTraceTag(590958602,324,50,"LogPastePositionTelemetry: OEmbed conversion happended in between of a paragraph ExternalContentConversionContext = {0}, BeforeRequestCallback = {1}",
Ku[r],z):v.ULS.sendTraceTag(590958600,324,50,"LogPastePositionTelemetry: OEmbed conversion happended at the start of the paragraph ExternalContentConversionContext = {0}, BeforeRequestCallback = {1}",Ku[r],z):v.ULS.sendTraceTag(590958599,324,50,"LogPastePositionTelemetry: OEmbed conversion happended in a blank paragraph ExternalContentConversionContext = {0}, BeforeRequestCallback = {1}",Ku[r],z)}FCc(b){this.g0b();const h=new Yu.a(1,t.AFrameworkApplication.isRtl);h.VUc=b;Ti.Ccb.TWc(h)}g0b(){const b=
new Xu.a(!0);Ti.Iac.HDa(b)}static get Ccb(){return null!=Ti.Kig?Ti.Kig:Ti.Kig=Sa.a.instance.resolve("Box4.IExternalContentFloatieEventSource")}static get Rka(){Ti.qxa||(Ti.qxa=Sa.a.instance.resolve("WordEditor.ExternalContent.IExternalContentSettingInfo"));return Ti.qxa}static get Iac(){return null!=Ti.Bpg?Ti.Bpg:Ti.Bpg=Sa.a.instance.resolve("Box4.IPasteFloatieEventSource")}static get u_(){return null!=Ti.oqg?Ti.oqg:Ti.oqg=Sa.a.instance.resolve("WordEditor.ExternalContent.IExternalContentSizeBehavior")}static get zT(){return null!=
Ti.llg?Ti.llg:Ti.llg=Sa.a.instance.resolve("WordEditor.IImageEditor")}static get XSc(){return null!=Ti.jog?Ti.jog:Ti.jog=Sa.a.instance.resolve("WordEditor.ExternalContent.IOEmbedOverridesURLParser")}}Ti.zka=5E3;Ti.qxa=null;Object(n.a)(Ti,"ExternalContentEditorV2",Os,[]);class ns{constructor(){this.Ac=this.W=null}get name(){return"WordEditor.ExternalContent"}get Qb(){return this.Ac?this.Ac:this.Ac=this.W.resolve("Box4.IFeatureHelper")}yc(b){this.W=b;b.ha("WordEditor.ExternalContent.ExternalContentSizeBehavior",
()=>new Xz.a(km.a.instance,Co.WordSectionNavigator.instance)).as("WordEditor.ExternalContent.IExternalContentSizeBehavior").singleInstance();b.ha("WordEditor.ExternalContent.PostHyperlinkAutoCorrectStrategy",()=>new BD).as("Box4.AutoCorrect.IPostHyperlinkAutoCorrectStrategy").singleInstance();b.ha("WordEditor.ExternalContent.ExternalContentSettingInfo",()=>new yD(b.resolve("Box4.IRoamingServiceRequestManager"),b.resolve("Box4.RoamingSetting.IRoamingSettingCache"))).as("WordEditor.ExternalContent.IExternalContentSettingInfo").singleInstance();
t.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.InsertFluidComponent",!1)?(b.ha("WordEditor.ExternalContent.ExternalContentEditorV2",()=>new Ti).as("Wonca.ExternalContent.IExternalContentEditor").singleInstance(),b.ha("WordEditor.ExternalContent.FluidComponentEditor",()=>new Wr(b.resolve("Fluid.Host.LoopComponentManager"))).singleInstance(),b.ha("WordEditor.ExternalContent.FluidComponentsActor",()=>new bz(t.AFrameworkApplication.ya,b.resolve("WordEditor.ExternalContent.FluidComponentEditor"),
Yh.a.instance)).singleInstance()):b.ha("WordEditor.ExternalContent.ExternalContentEditor",()=>new kh).as("Wonca.ExternalContent.IExternalContentEditor").singleInstance()}init(){this.Qb.Yk.continueWith(()=>{this.Tm()});t.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.InsertFluidComponent",!1)&&this.W.resolve("WordEditor.ExternalContent.FluidComponentsActor").Vb()}dispose(){}zJk(){const b=new $y;this.jDh()&&b.a9g(Xv.Nda());b.a9g(new aA);return b}Tm(){null==t.AFrameworkApplication.K||
t.AFrameworkApplication.K.$("IOEmbedOverridesURLParserCrashFixIsEnabled")||this.W.ha("WordEditor.ExternalContent.OEmbedQueryParamsOverridesURLParser",()=>new Zz.a).as("WordEditor.ExternalContent.IOEmbedOverridesURLParser").singleInstance();this.jDh()&&(this.W.ha("WordEditor.ExternalContent.IWordExternalContentURLResolver",()=>this.zJk()).as("WordEditor.ExternalContent.IWordExternalContentURLResolver").singleInstance(),this.W.resolve("WordEditor.ExternalContent.IWordExternalContentURLResolver"))}jDh(){return t.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.EnableInnerRingWEdgeExperimentsOEmbedURLResolver",
!1)}static main(){O.a.instance.Oc(new ns)}}Object(n.a)(ns,"ExternalContentPackage",null,[1,2]);var xx;(function(b){b[b.invalid=-1]="invalid";b[b.clear=0]="clear";b[b.left=1]="left";b[b.start=2]="start";b[b.center=3]="center";b[b.right=4]="right";b[b.end=5]="end";b[b.decimal=6]="decimal";b[b.FBo=7]="bar";b[b.Jfa=8]="num"})(xx||(xx={}));Object(n.b)("TabStopValues",xx);class Nl{}Nl.Hxh=8;Nl.HRk=1;Nl.Y5="wwaengidc";Nl.kpiName="WordRuler";Nl.precision=.0625;Nl.U5n=1;Nl.Eoo="ShowHideRuler";Object(n.a)(Nl,
"Constants",null,[]);var cz=d(394),dz=d(756);class zq{static B3b(b,h){if(!zq.dPc)return null;switch(b){case "Left":return r=>{const z=r.rulerCanvasProps;r=r.indents;return{BEb:0,WIb:z.scale-(z.margins[1].value+r[2].value+Math.max(r[0].value,r[1].value)+8*z.precision)}};case "Right":return r=>{const z=r.rulerCanvasProps;r=r.indents;return{BEb:0,WIb:z.scale-(r[2].value+(z.margins[0].value+Math.max(r[0].value,r[1].value))+8*z.precision)}};case "MoveTableColumn":return()=>{let r=0,z=0;if(0===h){var R=
{};32===zq.zc.Xb(Fb.a.Lbc,2,R)&&(r=pg.a.kC(R.MinIndent),z=pg.a.kC(R.MaxIndent))}else R={ao:h-1},32===zq.zc.Xb(Fb.a.Kbc,2,R)&&(r=pg.a.kC(R.MinResize),z=pg.a.kC(R.MaxResize));return{BEb:r,WIb:z}};case "Top":return r=>{r=r.rulerCanvasProps;return{BEb:0,WIb:r.scale-(r.margins[1].value+8*r.precision)}};case "Bottom":return r=>{r=r.rulerCanvasProps;return{BEb:0,WIb:r.scale-(r.margins[0].value+8*r.precision)}}}return null}static XHd(b){if(!zq.dPc)return null;switch(b){case "FirstLineIndent":case "HangingIndent":case "LeftIndent":return h=>
{var r=h.rulerCanvasProps,z=h.indents,R=h.ipContextIndex;h=r.margins;var ba=r.scale;r=r.precision;if("MoveTableColumn"!==h[0].type){R=h[0].value;h=h[1].value+z[2].value;var ta=R;"LeftIndent"===b&&(ta+=Math.max(z[0].value,z[1].value));z=-1*R;r=ba-(ta+h+8*r)}else{ba=0;for(ta=0;ta<=R;ta++)ba+=h[ta].value;ta=0;if("LeftIndent"===b){ta=z[0].value;const Wa=z[1].value;ba+=Math.max(ta,Wa);ta=Math.max(ta,Wa)}h=h[R+1].value;ta+=z[2].value;z=-1*ba;r=h-ta-r}return{BEb:z,WIb:r}};case "RightIndent":return h=>{var r=
h.rulerCanvasProps,z=h.indents,R=h.ipContextIndex,ba=r.margins;h=r.scale;r=r.precision;if("MoveTableColumn"!==ba[0].type){var ta=ba[0].value;ba=ba[1].value;R=z[0].value;var Wa=z[1].value;z=-1*ba;h-=ta+ba+Math.max(R,Wa)+8*r}else{ta=0;for(Wa=0;Wa<=R;Wa++)ta+=ba[Wa].value;ba=ba[R+1].value;R=z[0].value;Wa=z[1].value;z=-1*(h-ta-ba);h=ba-Math.max(R,Wa)-r}return{BEb:z,WIb:h}}}return null}static zHl(){return b=>{var h=b.rulerCanvasProps,r=b.indents,z=b.ipContextIndex,R=h.margins;b=h.precision;h=h.scale;"MoveTableColumn"!==
R[0].type?(z=R[0].value,R=R[1].value+r[2].value,r=Math.min(r[0].value,r[1].value)+b,b=h-(z+R+b)):(h=r[2].value,R=R[z+1].value,r=Math.min(r[0].value,r[1].value)+b,b=R-(h+b));return{BEb:r,WIb:b}}}static get zc(){return null!=zq.sgg?zq.sgg:zq.sgg=t.AFrameworkApplication.ya}static get dPc(){null==this.R7a&&(t.AFrameworkApplication.maa("WoRul910;WoRul910cf"),this.R7a=t.AFrameworkApplication.K?t.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.RulerPropertyBoundaryIsEnabled",!1):
!1);return this.R7a}}zq.R7a=null;Object(n.a)(zq,"RulerPropertyBoundaryHelper",null,[]);var CD=d(908),Yv;(function(b){b[b.appChromeReady=0]="appChromeReady";b[b.appChromeLazyReady=1]="appChromeLazyReady"})(Yv||(Yv={}));Object(n.b)("WoncaAppChromeState",Yv);const vC=b=>{yh.c()?b():v.ULS.sendTraceTag(51393038,340,10,"appChrome is not defined.")},ot=(b,h)=>{const r=Sa.a.instance.Pa("Wonca.IWoncaAppChromeStateManager");r?r.tl(b,()=>{vC(h)}):vC(h)};var XA=d(1217),Lu=d(1218);class pt{constructor(b,h,r,z,
R,ba){this.O_m="OutlineContainer";this.WYj="UpdateCustomTabFailed";this.Nsb="ReadRulerPropertiesFailed";this.$Yj="UpdateIndentFailed";this.w4g="UpdateMarginFailed";this.Mm=b;this.KSb=h;this.ga=r;this.HFe=z;this.zC=R;this.GY=ba;this.WPb=null;this.ew=!!t.AFrameworkApplication.ua&&t.AFrameworkApplication.ua.Sb.A6}QA(){this.LOe();this.e9g();this.KSb.al.Se(10).lp(Object(u.a)(this,this.KTc,"onOutlinePropertyChanged"));Bf.a.addHandler(this.rMe,jb.a.scroll,Object(u.a)(this,this.xij,"updateRulerLocationOnScroll"));
this.Mm.execute(h=>{h.h7(Object(u.a)(this,this.Wr,"onZoomChanged"))});const b=[this.vgf(),document.getElementById(tf.AppFrame.G4c),document.getElementById("PageContentContainer")];this.WPb?this.WPb.register(b,Object(u.a)(this,this.nFa,"updateRulerLocation")):ot(Yv.appChromeLazyReady,()=>{appChrome.getResizeObserver().then(h=>{this.WPb=h.createResizeObserver();this.WPb.register(b,Object(u.a)(this,this.nFa,"updateRulerLocation"));return null})});vb.App.xa.wu.registerBoundingWindowRectsChanged("documentPanel",
(h,r)=>{"undefined"!==r&&this.l4a([1,0])})}vgf(){return 1===this.GY.Lw?this.XPj:this.sPj}get rMe(){return document.getElementById(tf.AppFrame.AFa)}get sPj(){const b=document.getElementsByClassName(this.O_m);return b&&0<b.length?b[0]:null}get XPj(){var b=this.zC.D1b;if(!b)return null;b=this.sDn(ie.ParagraphReader.qT(b));return CD.a.WVh(b)}sDn(b){return 0<b?document.querySelector("div.PagesContainer p[paraid='"+b+"']"):null}kYd(b){b.button===Sys.UI.MouseButton.rightButton&&this.HFe.show(new Sys.UI.Point(b.clientX,
b.clientY),2)}xij(){this.nFa()}get NM(){return this.Mm&&this.Mm.instance?this.Mm.instance.vj:Nl.HRk}a3b(){const b={};return 32!==this.ga.Xb(Fb.a.EDa,2,b)?(v.ULS.sendTraceTag(529065947,XA.a.msoulscat_Wac_WordRuler,Lu.a.warning,"Unable to read page properties for Ruler"),wl.recordQosError(this.Nsb,[wl.Nca],"Unable to read page properties for Ruler"),null):b}dispose(){this.V4h();this.KSb.al.Se(10).EX(Object(u.a)(this,this.KTc,"onOutlinePropertyChanged"));Bf.a.removeHandler(this.rMe,jb.a.scroll,Object(u.a)(this,
this.xij,"updateRulerLocationOnScroll"));this.Mm.execute(b=>{b.Bjb(Object(u.a)(this,this.Wr,"onZoomChanged"))});this.WPb&&this.WPb.dispose();vb.App.xa.wu.unregisterBoundingWindowRectsChanged("documentPanel",(b,h)=>{"undefined"!==h&&this.l4a([1,0])})}get Oei(){null==pt.Que&&(pt.Que=t.AFrameworkApplication.K?t.AFrameworkApplication.K.$("SharedUXThemingIsEnabled")&&t.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ModernUxExperimentOne",!1)&&t.AFrameworkApplication.K.$("RulerThemingIsEnabled"):
!1);return pt.Que}}pt.Que=null;Object(n.a)(pt,"ARuler",null,[450]);var wC=d(315);class on extends pt{constructor(b,h,r,z,R,ba,ta){super(b,h,r,R,ba,ta);this.J2="HorizontalRuler";this.koj="CustomTabModificationFromRuler";this.Ipj="IndentModificationFromRuler";this.pfe="MarginModificationFromRuler";this.OHg=this.NHg=this._tabStops=null;if(cz.a.isSharedUxGateEnabled("WordOnline.ChangeGate.DelayLoadUISlice20InRuler"))this.Dqa=z;else{const Wa=z();this.Dqa=()=>Wa}this.sv={}}get LW(){return this.NHg}get zBa(){return this.OHg}renderRuler(){this.LW.classList.remove("HideWACHorizontalRulerContainer");
this.LW.classList.add("ShowWACHorizontalRulerContainer");var b=this.a3b();if(b){var h=Object(u.a)(this,this.rHf,"onMarginChange"),r=Object(u.a)(this,this.oTm,"onIndentChange"),z=Object(u.a)(this,this.bRm,"onCustomTabChange"),R=this.Y2c(),ba=this.ndj(),ta=this.mdj();R&&ba&&ta||(this.sv.disabled=!0);this.sv.onIndentChange=r;this.sv.onMarginChange=h;this.sv.onTabChange=z;this.nFa();b=Rf.a.Pi(b.Lo,0);this.zBa.style.width=(b*this.NM).toString()+"px";return this.Dqa().then(Wa=>{Wa.renderRuler(this.zBa,
this.sv)})}}bRm(b,h,r){if(!(b>=this._tabStops.length)){b=this._tabStops[b];var z="Modify"===r?this.ga.Xb(Oa.a.K9b,2,{["tabStop"]:b,["value"]:pg.a.BA(h)}):this.ga.Xb(Oa.a.X1a,2,b);if(32===z){h=1;var R=String.format("Custom tab modified using ruler. Operation: {0}. CustomTab: {1}",r,xx[b.pba]);v.ULS.sendTraceTag(591213271,3014,50,R)}else h=0,R=String.format("Unable to modify custom tab using ruler. Operation: {0}. CustomTab: {1}",r,xx[b.pba]),v.ULS.sendTraceTag(591213272,3014,15,R),wl.recordQosError(this.WYj,
[wl.Nca],"Unable to modify custom tab using ruler");Lb.a(this.koj,32===z,void 0,[Object.assign(new ca.a,{name:"Operation",string:r}),Object.assign(new ca.a,{name:"TabType",int64:xx[b.pba]})]);r=new Map;r.set("Command","OnCustomTabChange");r.set("Source",this.J2);r.set("Response",R);Ca.Health.instance.recordKpiUsage(Nl.kpiName,h,Nl.Y5,r)}}mdj(){const b=[];var h={};if(32!==this.ga.Xb(Oa.a.IHb,2,h))return v.ULS.sendTraceTag(589651997,3014,15,"Unable to read paragraph tabs for Ruler"),wl.recordQosError(this.Nsb,
[wl.Nca],"Unable to read paragraph tabs for Ruler"),!1;var r=h.customTabs;if(!r||0>=r.length)return this.sv.tabs=b,!0;this._tabStops=r;h="";for(let z of r){switch(z.pba){case 1:h="LeftTab";break;case 4:h="RightTab";break;case 3:h="CenterTab";break;case 6:h="DecimalTab";break;case 7:h="BarTab"}r=Rf.a.Vib(z.GEa,0);b.push({["type"]:h,["value"]:r,["getRulerPropertyBoundary"]:zq.zHl()})}this.sv.tabs=b;return!0}l4a(b){if(this.LW){this.LW.classList.add("ShowWACHorizontalRulerContainer");"disabled"in this.sv&&
delete this.sv.disabled;for(let h of b)switch(h){case 0:b=this.ndj();const r=this.mdj();b&&r||(this.sv.disabled=!0);break;case 1:this.Y2c()||(this.sv.disabled=!0)}ze.a.UCb()&&this.zC.kb.Nqf&&(this.sv.disabled=!0);this.Dqa().then(h=>{h.renderRuler(this.zBa,this.sv);return null})}}Y2c(){const b={};var h=this.a3b();if(!h)return!1;b.scale=pg.a.kC(h.Lo);b.precision=Nl.precision;b.rulerType="Horizontal";if(!this.tZm())return this.sv.ipContextIndex=0,this.sv.permittedUnits=Nl.Hxh,h=[{["type"]:"Left",["value"]:pg.a.kC(h.marginLeft),
["getRulerPropertyBoundary"]:zq.B3b("Left",0)},{["type"]:"Right",["value"]:pg.a.kC(h.marginRight),["getRulerPropertyBoundary"]:zq.B3b("Right",1)}],b.margins=h,this.sv.rulerCanvasProps=b,!0;var r={};h={};var z=this.ga.Xb(Fb.a.BWc,2,r);const R=this.ga.Xb(Fb.a.WHb,2,h);if(32!==z||32!==R)return v.ULS.sendTraceTag(589651998,3014,15,"Unable to read table properties for Ruler"),wl.recordQosError(this.Nsb,[wl.Nca],"Unable to read table properties for Ruler"),!1;r=r.ColumnWidths;z=h.TablePosition;if(!z||!r||
0>=r.length)return v.ULS.sendTraceTag(589632533,3014,15,"Cannot show table properties on the ruler as they are null"),wl.recordQosError(this.Nsb,[wl.Nca],"Cannot show table properties on the ruler as they are null"),!1;h=Array(r.length+1);h[0]={["type"]:"MoveTableColumn",["value"]:pg.a.kC(z.x/this.NM),["getRulerPropertyBoundary"]:zq.B3b("MoveTableColumn",0)};for(z=0;z<r.length;z+=1)h[z+1]={["type"]:"MoveTableColumn",["value"]:pg.a.kC(r[z]),["getRulerPropertyBoundary"]:zq.B3b("MoveTableColumn",z+1)};
this.sv.ipContextIndex=this.hLl();this.sv.permittedUnits=Nl.U5n;b.margins=h;this.sv.rulerCanvasProps=b;return!0}ndj(){var b={};if(32!==this.ga.Xb(Fb.a.K1a,2,b))return v.ULS.sendTraceTag(592496522,3014,15,"Unable to read paragraph indentation for Ruler"),wl.recordQosError(this.Nsb,[wl.Nca],"Unable to read paragraph indentation for Ruler"),!1;const h={type:"FirstLineIndent"};h.getRulerPropertyBoundary=zq.XHd("FirstLineIndent");const r={type:"HangingIndent"};r.getRulerPropertyBoundary=zq.XHd("HangingIndent");
const z={type:"RightIndent"};z.getRulerPropertyBoundary=zq.XHd("RightIndent");const R={type:"LeftIndent"};R.getRulerPropertyBoundary=zq.XHd("LeftIndent");this.sv.rtl=b.isRtl;b=b.Ws;h.value=1===b.specialIndentType?pg.a.kC(b.kba+b.DA):2===b.specialIndentType?pg.a.kC(b.DA-b.kba):pg.a.kC(b.DA);r.value=pg.a.kC(b.DA);R.value=pg.a.kC(b.DA);z.value=pg.a.kC(b.Pla);this.sv.indents=[h,r,z,R];return!0}oTm(b,h){var r=new dz.a;r.unit=1;r.value=pg.a.BA(h);h=8;switch(b){case "FirstLineIndent":h=this.ga.Xb(Fb.a.G_c,
2,r);break;case "HangingIndent":h=this.ga.Xb(Fb.a.H_c,2,r);break;case "LeftIndent":h=this.ga.Xb(Fb.a.CZa,2,r);break;case "RightIndent":h=this.ga.Xb(Fb.a.BZa,2,r)}let z;32===h?(r=1,z=String.format("Indents set using Ruler. Indent: {0}",b),v.ULS.sendTraceTag(592517017,3014,50,z)):(r=0,z=String.format("Unable to set indent using Ruler. Indent: {0}",b),v.ULS.sendTraceTag(592496523,3014,15,z,b),wl.recordQosError(this.$Yj,[wl.Nca],"Unable to set indent using Ruler."));Lb.a(this.Ipj,32===h,void 0,[Object.assign(new ca.a,
{name:"Type",string:b})]);b=new Map;b.set("Command","OnIndentChange");b.set("Source",this.J2);b.set("Response",z);Ca.Health.instance.recordKpiUsage(Nl.kpiName,r,Nl.Y5,b)}e9g(){Bf.a.addHandler(this.LW,jb.a.$w,Object(u.a)(this,this.kYd,"onRulerMouseDown"))}V4h(){this.LW.classList.remove("ShowWACHorizontalRulerContainer");this.LW.classList.add("HideWACHorizontalRulerContainer");Bf.a.removeHandler(this.LW,jb.a.$w,Object(u.a)(this,this.kYd,"onRulerMouseDown"));this.Dqa().then(b=>{b.dispose(this.zBa);return null})}rHf(b,
h,r){let z;z="Left"===b?this.ga.Xb(Fb.a.Lga,2,pg.a.BA(h)):"Right"===b?this.ga.Xb(Fb.a.K2a,2,pg.a.BA(h)):r?this.ga.Xb(Fb.a.Z$d,2,{["columnIndex"]:r-1,["width"]:pg.a.BA(h)}):this.ga.Xb(Fb.a.jec,2,pg.a.BA(h));32===z?(h=1,r=String.format("Margins set using Ruler. Margin: {0}",b),v.ULS.sendTraceTag(592517018,3014,50,r)):(h=0,r=String.format("Unable to set margins using Ruler. Margin: {0}",b),v.ULS.sendTraceTag(592496524,3014,15,r),wl.recordQosError(this.w4g,[wl.Nca],"Unable to set margins using Ruler."));
Lb.a(this.pfe,32===z,void 0,[Object.assign(new ca.a,{name:"Type",string:b})]);b=new Map;b.set("Command","OnMarginChange");b.set("Source",this.J2);b.set("Response",r);Ca.Health.instance.recordKpiUsage(Nl.kpiName,h,Nl.Y5,b)}Wr(){this.zij();this.nFa();this.l4a([1,0])}KTc(b,h){b=h.property;if(b===yc.a.Lo||b===yc.a.marginLeft||b===yc.a.marginRight)this.zij(),this.nFa(),this.l4a([1])}zij(){var b=this.a3b();b&&(b=Rf.a.Pi(b.Lo,0),this.zBa.style.width=Math.round(b*this.NM).toString()+"px")}nFa(){window.requestAnimationFrame(()=>
{var b=this.vgf();b&&(b=Ed.a.getElementBounds(b),t.AFrameworkApplication.isRtl?this.zBa.style.marginRight=(window.document.documentElement.clientWidth-b.x-b.width).toString()+"px":this.zBa.style.marginLeft=b.x.toString()+"px")})}hLl(){const b=Nd.GraphIterator.$a(this.zC.D1b);if(b.Bb(14))return b.kd(16),dq.a(b,!0);v.ULS.sendTraceTag(557110540,3014,15,"Unable to read table column index for Ruler");wl.recordQosError(this.Nsb,[wl.Nca],"Unable to read table column index for Ruler");return 0}tZm(){let b=
!0;const h=this.zC.kb.BN();if(null===h)return v.ULS.sendTraceTag(557065614,3014,15,"Unable to get Context Iterator for the Ruler"),wl.recordQosError(this.Nsb,[wl.Nca],"Unable to get Context Iterator for the Ruler"),!1;for(;h.moveNext()&&b;){const r=Nd.GraphIterator.$a(h.current.node);r.vd();b=b&&Ii.TableReader.Yw(r)}return b}LOe(){var b;if(!this.zBa&&!this.LW){this.NHg=document.createElement("div");this.LW.id=on.vGj;this.LW.className=on.uGj;this.LW.setAttribute(vf.a.lda,WordEditorIntl.WordEditorStrings.L_Ruler);
this.LW.setAttribute(vf.a.Ch,vf.a.geh);this.LW.classList.add("HideWACHorizontalRulerContainer");if(this.Oei){var h=t.AFrameworkApplication.K.lb("ModernUxExperimentPreferenceCookieName");const r=t.AFrameworkApplication.K.$("ModernUxExperimentDefaultOffIsEnabled");Ga.a.dla(h,!r)&&this.LW.classList.add(on.JMj)}this.OHg=document.createElement("div");this.zBa.className=on.tGj;this.zBa.id=on.wGj;this.LW.appendChild(this.zBa);h=null;this.ew&&((h=t.AFrameworkApplication.K.$("IsSharedLayoutEnabled")?null!==
(b=Object(wC.a)("EditorBars"))&&void 0!==b?b:vb.App.xa.wu.getRegion(vb.App.xa.wu.qjb.J("Ruler")):vb.App.xa.wu.getRegion(vb.App.xa.wu.qjb.J("Ruler")))&&h.appendChild(this.LW),this.LW.classList.add("regionComposer"));h||(h=document.getElementById(tf.AppFrame.G4c),h.insertBefore(this.LW,h.firstChild))}}static hE(){return new on(Sa.a.instance.Za("Common.IZoomManager"),vb.App.Xj,t.AFrameworkApplication.ya,Uk.UISurfaces.vYh,Sa.a.instance.resolve("WordEditor.IRulerContextMenu"),yr.a.instance,Sa.a.instance.resolve("WordEditor.IMainViewModeManager"))}static get instance(){return null!=
on.Gmg?on.Gmg:on.Gmg=on.hE()}}on.vGj="WACHorizontalRulerContainer";on.uGj="WACHorizontalRulerContainer";on.wGj="WACHorizontalRuler";on.tGj="WACHorizontalRuler";on.JMj="ModernUxWACHorizontalRulerContainer";Object(n.a)(on,"HorizontalRuler",pt,[]);var YA=d(934);class Xr extends pt{constructor(b,h,r,z,R,ba,ta){super(b,h,r,R,ba,ta);this.J2="VerticalRuler";this.pfe="MarginModificationFromRuler";this.l5g=this.k5g=null;if(cz.a.isSharedUxGateEnabled("WordOnline.ChangeGate.DelayLoadUISlice20InRuler"))this.Dqa=
z;else{const Wa=z();this.Dqa=()=>Wa}this.sv={}}get S3(){return this.k5g}get xFa(){return this.l5g}renderRuler(){$e.a.Lu(this.S3,"HideWACVerticalRulerContainer");$e.a.Pf(this.S3,"ShowWACVerticalRulerContainer");var b=this.a3b();if(b){var h=Object(u.a)(this,this.rHf,"onMarginChange");this.Y2c()||(this.sv.disabled=!0);this.sv.onMarginChange=h;this.nFa();b=Rf.a.Pi(b.ay,1);this.xFa.style.height=(b*this.NM).toString()+"px";this.Dqa().then(r=>{r.renderRuler(this.xFa,this.sv);return null})}}l4a(b){if(this.S3){$e.a.Pf(this.S3,
"ShowWACVerticalRulerContainer");"disabled"in this.sv&&delete this.sv.disabled;for(let h of b)switch(h){case 1:this.Y2c()?this.nFa():this.sv.disabled=!0}ze.a.UCb()&&this.zC.kb.Nqf&&(this.sv.disabled=!0);this.Dqa().then(h=>{h.renderRuler(this.xFa,this.sv);return null})}}Y2c(){const b={},h=this.a3b();if(!h)return!1;b.scale=pg.a.kC(h.ay);b.precision=Nl.precision;b.rulerType="Vertical";this.sv.ipContextIndex=0;this.sv.permittedUnits=Nl.Hxh;b.margins=[{["type"]:"Top",["value"]:pg.a.kC(h.marginTop),["getRulerPropertyBoundary"]:zq.B3b("Top",
0)},{["type"]:"Bottom",["value"]:pg.a.kC(h.marginBottom),["getRulerPropertyBoundary"]:zq.B3b("Bottom",1)}];this.sv.rulerCanvasProps=b;return!0}e9g(){this.LOe();Bf.a.addHandler(this.S3,jb.a.$w,Object(u.a)(this,this.kYd,"onRulerMouseDown"))}V4h(){$e.a.Lu(this.S3,"ShowWACVerticalRulerContainer");$e.a.Pf(this.S3,"HideWACVerticalRulerContainer");Bf.a.removeHandler(this.S3,jb.a.$w,Object(u.a)(this,this.kYd,"onRulerMouseDown"));this.Dqa().then(b=>{b.dispose(this.xFa);return null})}rHf(b,h){let r=8;"Top"===
b?r=this.ga.Xb(Fb.a.L2a,2,pg.a.BA(h)):"Bottom"===b&&(r=this.ga.Xb(Fb.a.J2a,2,pg.a.BA(h)));let z;32===r?(h=1,z=String.format("Margins set using Ruler. Margin: {0}",b),v.ULS.sendTraceTag(529065945,3014,50,z)):(h=0,z=String.format("Unable to set margins using Ruler. Margin: {0}",b),v.ULS.sendTraceTag(529065946,3014,15,z),wl.recordQosError(this.w4g,[wl.Nca],"Unable to set margins using Ruler."));Lb.a(this.pfe,32===r,void 0,[Object.assign(new ca.a,{name:"Type",string:b})]);b=new Map;b.set("Command","OnMarginChange");
b.set("Source",this.J2);b.set("Response",z);Ca.Health.instance.recordKpiUsage(Nl.kpiName,h,Nl.Y5,b)}Wr(){this.wij();this.nFa();this.l4a([1])}KTc(b,h){b=h.property;if(b===yc.a.ay||b===yc.a.marginTop||b===yc.a.marginBottom)this.wij(),this.nFa(),this.l4a([1])}wij(){var b=this.a3b();b&&(b=Rf.a.Pi(b.ay,1),this.xFa.style.height=Math.round(b*this.NM).toString()+"px")}nFa(){window.requestAnimationFrame(()=>{var b=this.vgf();if(b){const h=Ed.a.getElementBounds(b);this.xFa.style.height=h.height.toString()+
"px";b=this.OMl(b);this.xFa.style.marginTop=b+"px"}})}OMl(b){b=b.getBoundingClientRect().y;let h=this.rMe.getBoundingClientRect().y;return b-h}LOe(){if(!this.xFa&&!this.S3){this.k5g=document.createElement("div");this.S3.id=Xr.OZj;this.S3.className=Xr.NZj;this.S3.setAttribute(vf.a.lda,WordEditorIntl.WordEditorStrings.L_Ruler);this.S3.setAttribute(vf.a.Ch,vf.a.geh);Sys.UI.DomElement.addCssClass(this.S3,"HideWACVerticalRulerContainer");if(this.Oei){var b=t.AFrameworkApplication.K.lb("ModernUxExperimentPreferenceCookieName");
const h=t.AFrameworkApplication.K.$("ModernUxExperimentDefaultOffIsEnabled");Ga.a.dla(b,!h)&&Sys.UI.DomElement.addCssClass(this.S3,Xr.KMj)}this.l5g=document.createElement("div");this.xFa.className=Xr.MZj;this.xFa.id=Xr.PZj;this.S3.appendChild(this.xFa);b=document.getElementById(tf.AppFrame.G4c);b.insertBefore(this.S3,b.firstChild)}}static hE(){return new Xr(Sa.a.instance.Za("Common.IZoomManager"),vb.App.Xj,t.AFrameworkApplication.ya,Uk.UISurfaces.vYh,Sa.a.instance.resolve("WordEditor.IRulerContextMenu"),
yr.a.instance,Sa.a.instance.resolve("WordEditor.IMainViewModeManager"))}static get instance(){return null!=Xr.Fmg?Xr.Fmg:Xr.Fmg=Xr.hE()}}Xr.OZj="WACVerticalRulerContainer";Xr.NZj="WACVerticalRulerContainer";Xr.PZj="WACVerticalRuler";Xr.MZj="WACVerticalRuler";Xr.KMj="ModernUxWACVerticalRulerContainer";Object(n.a)(Xr,"VerticalRuler",pt,[]);class wl{constructor(b,h,r,z,R,ba,ta,Wa,ub){this.Rre=this.que=!1;this.J2="RulerActor";this.pZg=null;this.jma=!1;this.Gyj="ClearAllTabStopsFailed";this.F0g="ShowHideRulerFailed";
this.hwe=null;this.Oud=(Ib,$b,fc)=>{if(1===fc)return 32;Ib=this.ga.processAction(Oa.a.qIb,2,null);32===Ib?(fc=1,$b=String.format("Clear all tab stops from ruler"),v.ULS.sendTraceTag(591213266,3014,50,$b)):(fc=0,$b=String.format("Unable to clear all tab stop from ruler"),v.ULS.sendTraceTag(591213267,3014,15,$b),wl.recordQosError(this.Gyj,[wl.Nca],$b));const Kc=new Map;Kc.set("Command","ClearAllTabStops");Kc.set("Source",this.J2);Kc.set("Response",$b);Ca.Health.instance.recordKpiUsage(Nl.kpiName,fc,
Nl.Y5,Kc);return Ib};this.yMc=(Ib,$b,fc)=>{if(1===fc)switch(Ib){case Oa.a.LSe:case Oa.a.t2e:return 2;default:return 32}$b=this.HFe.hGl();switch(Ib){case Oa.a.twf:var Kc=1;break;case Oa.a.kVf:Kc=4;break;case Oa.a.VVe:Kc=3;break;default:return v.ULS.sendTraceTag(591213268,3014,15,"Tried to insert bar or decimal tab stop."),2}Ib=new lv.a($b,Kc,0,1);Ib=this.ga.Xb(Oa.a.d_c,2,Ib);32===Ib?(fc=1,$b=String.format("Insert Custom Tab Stop from Ruler. Tab: {0}. Value: {1}",xx[Kc],$b.toString()),v.ULS.sendTraceTag(591213269,
3014,50,$b)):(fc=0,$b=String.format("Unable to set custom tab stop from ruler. Tab: {0}. Value: {1}",xx[Kc],$b.toString()),v.ULS.sendTraceTag(591213270,3014,15,$b));Kc=new Map;Kc.set("Command","InsertCustomTabStopRuler");Kc.set("Source",this.J2);Kc.set("Response",$b);Ca.Health.instance.recordKpiUsage(Nl.kpiName,fc,Nl.Y5,Kc);return Ib};this.zKb=(Ib,$b,fc,Kc,ed)=>this.que||1===fc&&ze.a.gfa($b.vk)&&ze.a.UCb()?8:this.jma?this.bLc(Ib,$b,fc,Kc,ed):this.AYn($b,fc);this.AAn=()=>{this.jma?v.ULS.sendTraceTag(574128526,
3014,50,"Ruler was already enabled"):(appChrome.api.dispatch(appChrome.actions.setCurrentTab("View")),32!==this.ga.processAction(Fb.a.zKb,2)?(v.ULS.sendTraceTag(574128527,3014,50,"Ruler could not be enabled"),wl.recordQosError(this.F0g,[wl.Nca],"Ruler could not be enabled")):v.ULS.sendTraceTag(573190796,3014,50,"Ruler was enabled from teaching callout"))};this.bLc=(Ib,$b,fc)=>{if(1===fc||!this.jma)return 32;this.jma=!1;this.IFe.AUi(!1);this.t7a.dispose();this.SQd()&&this.U4e();this.yij();v.ULS.sendTraceTag(593351623,
3014,50,"Ruler is disabled");Ib=new Map;Ib.set("Command","HideRuler");Ib.set("Source",this.J2);Ib.set("Response","");Ca.Health.instance.recordKpiUsage(Nl.kpiName,1,Nl.Y5,Ib);return 32};this.O1d=(Ib,$b,fc,Kc,ed)=>{if(1===fc)return 32;ed&&(ed[Yf.a.On]=this.jma);return 32};this.P1l=Ib=>{this.jma=Ib.result};this.GBb=()=>{this.que=!1};this.K4h=()=>{this.que=!0};this.ga=b;this.t7a=h;this.fMe=r;this.wNb=z;this.HFe=R;this.IFe=ba;wl.Kk=Wa;this.hHa=ta;this.GY=ub;this.hHa.K$g(this.K4h);this.hHa.ird(this.GBb)}initialize(){this.Vb();
this.pZg=this.AAn;window.addEventListener("TurnRulerOnAction",this.pZg,!0);return this.IFe.yHl().continueWith(this.P1l,8)}Vb(){this.ga.pa(Fb.a.zKb,kc.a.view,this.zKb);this.ga.gb(Fb.a.O1d,kc.a.view,this.O1d,96);this.ga.pa(Oa.a.LSe,kc.a.view,this.yMc);this.ga.pa(Oa.a.VVe,kc.a.view,this.yMc);this.ga.pa(Oa.a.Oud,kc.a.view,this.Oud);this.ga.pa(Oa.a.t2e,kc.a.view,this.yMc);this.ga.pa(Oa.a.bLc,kc.a.view,this.bLc);this.ga.pa(Oa.a.twf,kc.a.view,this.yMc);this.ga.pa(Oa.a.kVf,kc.a.view,this.yMc);YA.a.me.addHandler(YA.a.QXd,
this.$Tc.bind(this));this.GY.kvb(this.$If)}i8h(){this.jma&&(this.t7a.QA(),this.t7a.renderRuler(),this.SQd()&&this.RPi())}RPi(){this.fMe.QA();this.fMe.renderRuler()}U4e(){this.fMe.dispose()}SQd(){return this.Xii()&&this.isPaginatedView()}Xii(){null==this.hwe&&null!=t.AFrameworkApplication.K&&(this.hwe=t.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.VerticalRulerEnabled",!1));return this.hwe}Qgc(){this.jma||Sa.a.instance.Za("Common.ISystemInitiatedFeedback").execute(b=>
{b.logActivity("TurnRulerOnActivity",null)})}vS(){this.hHa.Vrn(this.K4h);this.hHa.aPi(this.GBb);this.jma&&(this.t7a.dispose(),this.SQd()&&this.U4e())}yij(){if(this.wNb){const b={};b[Nl.Eoo]="ToggleButtonModel";this.wNb.hG(b)}}AYn(b,h){if(!wl.Kk.u$(b.vk))return v.ULS.sendTraceTag(574375060,3014,15,"Cannot show ruler. Word Section Node not found."),wl.recordQosError(this.F0g,[wl.Nca],"Cannot show ruler. Word Section Node not found."),8;if(1===h)return 32;this.jma=!0;this.IFe.AUi(!0);this.i8h();this.yij();
v.ULS.sendTraceTag(593351624,3014,50,"Ruler is enabled");b=new Map;b.set("Command","ShowRuler");b.set("Source",this.J2);b.set("Response","");Ca.Health.instance.recordKpiUsage(Nl.kpiName,1,Nl.Y5,b);return 32}isPaginatedView(){return 1===this.GY.Lw}$Tc(b,h){switch(h.documentMode){case "View":this.jma&&(this.ga.processAction(Fb.a.zKb,2),this.Rre=!0);break;case "Edit":this.Rre&&(this.ga.processAction(Fb.a.zKb,2),this.Rre=!1)}}$If(b,h){if(wl.instance.jma&&wl.instance.Xii())switch(h.b$b){case 1:wl.instance.RPi();
break;case 0:wl.instance.U4e()}}static recordQosError(b,h,r){const z=Object.assign(new eb.a,{extendedProperties:new Map});r&&z.extendedProperties.set("exception",r);Ca.Health.instance.recordQosError(b,h,!1,!0,!1,!1,z)}static hE(){return new wl(t.AFrameworkApplication.ya,on.instance,Xr.instance,vb.App.xa,Sa.a.instance.resolve("WordEditor.IRulerContextMenu"),Sa.a.instance.Pa("WordEditor.Ruler.IRulerSettingInfo"),Sa.a.instance.resolve("WordEditor.HeaderFooter.IHeaderFooterControlOwnerEvent"),km.a.instance,
Sa.a.instance.resolve("WordEditor.IMainViewModeManager"))}static get instance(){return null!=wl.Ilg?wl.Ilg:wl.Ilg=wl.hE()}}wl.Kk=null;wl.Nca="RulerInteractionFailed";Object(n.a)(wl,"RulerActor",null,[]);class bA{constructor(b,h){this.Quc=null;this.$0a=r=>r.result?r.result.Value.toString():"";this.YCa=r=>{r.ho||r.Ji?(v.ULS.sendTraceTag(591541278,3014,15,"Failed to get ruler is enabled settings options from Roaming Service."),this.Quc=!1):(r=r.result,""===r&&t.AFrameworkApplication.K&&(r=t.AFrameworkApplication.K.lb("RulerDefaultOn")),
this.Quc="true"===r.toLowerCase(),v.ULS.sendTraceTag(591541279,3014,50,"Load to get ruler is enabled settings options from Roaming Service successfully."));return this.Quc};this.Vu=b;this.FJ=h}yHl(){const b=new cc.a;if(null==this.Quc){if(this.Lgi())return this.FJ.T1a(Yz.a.mZc).CWRCo(this.$0a,0).CWRCo(this.YCa,8);b.Gg(!1)}else b.Gg(this.Quc);return b.task}V_(b){this.FJ.V_(Yz.a.mZc,new xD.a(Yz.a.mZc,b))}AUi(b){this.Lgi()&&(this.Vu.Qga("saveRulerIsEnabled",b.toString()),v.ULS.sendTraceTag(591541276,
3014,50,"Try to save ruler settings value to Roaming Service."));this.V_(b)}Lgi(){const b=t.AFrameworkApplication.K.$("IsAnonymousUser");if(t.AFrameworkApplication.K.$("IsRoamingServiceEnabled"))if(b)v.ULS.sendTraceTag(591541277,3014,50,"User is anonymous ");else return!0;return!1}}Object(n.a)(bA,"RulerSettingInfo",null,[393]);class Wf{constructor(){this.XIg=this.W=null}get name(){return"WordEditor.Ruler"}yc(b){this.W=b;v.ULS.sendTraceTag(578110851,3014,50,"Word ruler package is configured.")}init(){this.W.ha("WordEditor.Ruler.RulerSettingInfo",
()=>new bA(this.W.resolve("Box4.IRoamingServiceRequestManager"),this.W.resolve("Box4.RoamingSetting.IRoamingSettingCache"))).as("WordEditor.Ruler.IRulerSettingInfo").singleInstance();this.W.resolve("Box4.IFeatureHelper").Yk.continueWith(()=>{this.Tm()});this.XIg=wl.instance.initialize();v.ULS.sendTraceTag(578110852,3014,50,"Word ruler package is initialized")}Tm(){this.XIg.continueWith(()=>{wl.instance.i8h();wl.instance.Qgc()});v.ULS.sendTraceTag(578110853,3014,50,"InitializeRuler is called")}dispose(){wl.instance.vS();
v.ULS.sendTraceTag(578110854,3014,50,"Word ruler package is disposed")}}Object(n.a)(Wf,"PackageManager",null,[1,2]);class ZA{constructor(){this.h5b=this.rXb=null}}Object(n.a)(ZA,"CreatePickerCustomizationDictionaryOptions",null,[902]);class my{}my.vg="<div class='InsertMediaM365Dialog' id='insertmediadialog'> <div class='InsertMediaM365Panel' id='insertmediapanel'> <iframe id='insertmediaframe' class='InsertMediaFrame' name='InsertMediaFrame'></iframe> </div> </div>";Object(n.a)(my,"InsertMediaM365DialogHtml",
null,[]);class cA{constructor(b,h,r,z,R,ba,ta,Wa,ub,Ib,$b,fc,Kc,ed,Jd,ge,qe){var Ve;this.Q1=qe;this.d6a=null;this.Cbi=this.Dqf=this.wed=!1;this.d5i=Bd=>{if(Bd.rawEvent&&(Bd=Bd.rawEvent.data))try{const he=Sys.Serialization.JavaScriptSerializer.deserialize(Bd,!0),we=he.MessageId?he.MessageId.toString():null;he&&we&&(we===F.a.insertImage||we===F.a.Tnf)&&this.Jsc.start(we===F.a.insertImage?this.H7a:this.hJg)}catch(he){}};this.iio=(Bd,he,we,hg,Pf)=>{if(1===we)return 32;this.PLg?Bd=CommonUIStrings.l_OneDriveName:
""!==this.Rbd?Bd=this.Rbd:(Bd=CommonUIStrings.l_HostGeneric,v.ULS.sendTraceTag(20509841,352,15,"InsertMediaActor::UpdateEntryPoints : Do not have host name, use generic name instead."));Pf[Ik.a.LabelText]=Bd;return 32};this.lio=(Bd,he,we,hg,Pf)=>{if(1===we)return 32;if(!t.AFrameworkApplication.rrf())return Pf[Ik.a.Visible]=!1,32;this.PLg?Bd=String.format(CommonUIStrings.l_ChangePictureFromHost,CommonUIStrings.l_OneDriveName):""!==this.Rbd?Bd=String.format(CommonUIStrings.l_ChangePictureFromHost,this.Rbd):
(Bd=CommonUIStrings.l_ChangePictureFromHostGeneric,v.ULS.sendTraceTag(577835747,352,15,"InsertMediaActor::UpdateEntryPointsForChangePictureHostButton : Do not have host name, use generic name instead."));Pf[Ik.a.LabelText]=Bd;return 32};this.jio=(Bd,he,we,hg,Pf)=>{if(1===we)return 32;t.AFrameworkApplication.K.$("InsertOnlinePictureEnabled")||(Pf[Ik.a.Visible]=!1);return 32};this.kio=(Bd,he,we,hg,Pf)=>{if(1===we)return 32;t.AFrameworkApplication.K.$("InsertPictureUsingStockImagesIsEnabled")||(Pf[Ik.a.Visible]=
!1);return 32};this.K8d=(Bd,he,we)=>{he=this.$oc.value.vda(he);if(1===we)return he&&this.G7a.Vem?32:8;if(2!==we||!he)return 8;this.d6a=pa.a.create();v.ULS.sendTraceTag(7165725,352,50,"InsertMediaActor::ShowInsertPictureFromSearchDialog : Show dialog.");Bd=this.Zvl(Bd,this.d6a);Bd=this.VNe(Bd);Bd=this.Ocd.CIc(Bd);Bd.correlationId=this.d6a;Bd.v5b=this.iJg;Bd.Gfa=1;return this.I8d(Bd,CommonUIStrings.L_PictureInsertTitle,this.H7a)};this.JXn=(Bd,he,we)=>{Bd=32===this.ga.Qf(he,Fb.a.insertHyperlink,1,!1,
null,null);if(1===we)return Bd&&this.G7a.Ldi?32:8;if(2!==we||!Bd)return 8;v.ULS.sendTraceTag(21612190,352,50,"InsertMediaActor::ShowInsertOneDriveFileDialog : ShowInsertMediaDialog dialog.");return this.I8d(this.gJg.getInstance(),Box4Intl.Box4Strings.l_InsertOneDriveFile,this.hJg)};this.R4i=(Bd,he,we)=>{Bd=this.$oc.value.vda(he);if(1===we)return Bd&&this.G7a.qrf?32:8;if(2!==we||!Bd)return 8;v.ULS.sendTraceTag(17838539,352,50,"InsertMediaActor::ShowInsertPictureFromHostDialog : ShowInsertMediaDialog dialog.");
return this.I8d(this.gJg.getInstance(),CommonUIStrings.L_PictureInsertTitle,this.H7a)};this.G8d=(Bd,he,we)=>{he=this.$oc.value.vda(he);if(1===we)return he&&this.G7a.Xem?32:8;if(2!==we||!he)return 8;v.ULS.sendTraceTag(587532180,352,50,"InsertMediaActor::ShowInsertM365PictureFromSearchDialog : Show dialog.");this.d6a=pa.a.create();we=t.AFrameworkApplication.K.$("StockImagesFreemiumExperienceIsEnabled")&&this.lR.isFreemiumUpsellEnabled();we=this.wed?1:we?0:-1;Bd=this.Cyl(Bd,this.d6a,we);Bd=this.Ocd.CIc(Bd);
Bd.vg=my.vg;Bd.correlationId=this.d6a;Bd.Gfa=2;Bd.v5b=this.iJg;Bd.sJa=this.lR;Bd.Sjj=we;return this.I8d(Bd,CommonUIStrings.L_PictureInsertTitle,this.H7a)};this.L8d=(Bd,he,we)=>{he=this.$oc.value.vda(he);Bd=Sa.a.instance.Pa("Common.App.SharedFilePicker.ISharedFilePicker");if(1===we)return he&&!this.G7a.qrf&&Bd&&Bd.ztf()?32:8;if(2!==we||!he||!Bd)return 8;v.ULS.sendTraceTag(553734720,352,50,"InsertMediaActor::showInsertPictureFromSharedPicker : Show dialog.");this.d6a=pa.a.create();we=cA.g5g;he=!1;t.AFrameworkApplication.srf()&&
(he=this.wgl());const hg=new ZA;hg.rXb=he;hg.h5b=!0;we=Bd.R_e(CommonUIStrings.L_ImageUploadButtonText,"Select Images",!0,!1,!0,we,"Insert Media",1,hg);Bd.Udf(we).then(Pf=>{if(null!=Pf&&0<Pf.length){const Ej=[];for(let pn=0;pn<Pf.length;pn++){const Ol=Pf[pn][G.a.PEi],qt=Pf[pn][G.a.OEi],rt={};rt.Extension=Ol;rt.OriginalUrl=qt;rt.caption=Ol;Ej.push(rt)}this.H7a.fMa=Fb.a.C1;this.H7a.OZa(Ej)}});return 32};this.J8d=(Bd,he,we)=>{var hg=this.$oc.value.vda(he);he=Sa.a.instance.Pa("Common.App.SharedFilePicker.ISharedFilePicker");
if(1===we)return hg&&he&&he.ztf()?32:8;if(2!==we||!hg||!he)return 8;we=Sa.a.instance.Pa("Common.App.PhoneLink.IPhoneLinkManager");null!=we&&we.D7k(t.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OverridePhoneLinkEndpointToDogfoodEnabled",!1));v.ULS.sendTraceTag(526951881,352,50,"InsertMediaActor::showInsertPictureFromMobileDevice : Show dialog.");this.d6a=pa.a.create();we=cA.g5g;hg=new ZA;hg.rXb=!0;hg.h5b=!0;we=he.R_e(CommonUIStrings.L_ImageUploadButtonText,CommonUIStrings.L_ImageUploadingTitle,
!0,!1,!0,we,"InsertPictureFromMobile",3,hg);he.Udf(we).then(Pf=>{if(null!=Pf&&0<Pf.length){var Ej=[];const pn=Bd===Fb.a.JMd;let Ol=!1;const qt=t.AFrameworkApplication.K.lb("PhoneLinkServiceEndpoint");for(let rt=0;rt<Pf.length;rt++){const $v=Pf[rt][G.a.PEi],iE=Pf[rt][G.a.OEi],Kw={};Kw.Extension=$v;Kw.OriginalUrl=iE;Kw.caption=$v;Ej.push(Kw);Ol||(Ol=-1!==Kw.OriginalUrl.indexOf(qt))}this.H7a.fMa=Fb.a.C1;this.H7a.OZa(Ej);Ej={};Ej.InsertImageCount=Pf.length;Ol&&Lb.c(pn?Fb.a.Q5l:Fb.a.Rsk,void 0,void 0,
void 0,void 0,void 0,Ej)}});return 32};this.Jsc=z;this.yhd=R;this.Ocd=ta;this.gJg=Wa;this.O0=ub;this.ga=b;this.$oc=ba;this.PLg=Kc;this.Rbd=Jd;this.G7a=r;this.H7a=Ib;this.hJg=$b;this.iJg=ge;this.lR=fc;this.Cbi=null!==(Ve=null===h||void 0===h?void 0:h.getBooleanFeatureGate("Microsoft.Office.WordOnline.DarkModeForHubble",!1))&&void 0!==Ve?Ve:!1;this.lR&&this.lR.isFeatureEnabled("MsoPremiumStockImages",!1).catch(Bd=>v.ULS.sendTraceTag(577249666,352,10,"InsertMediaActor::Constructor - Failed to load the premium state from application feature helper: {0}",
Bd)).then(Bd=>{(this.wed=Bd)||this.lR.lva("MsoPremiumStockImages",()=>{this.wed=!0;v.ULS.sendTraceTag(577249667,352,50,"InsertMediaActor::Constructor - License state changed to premium")});return null})}Vb(){(this.G7a.qrf||this.G7a.Ldi)&&this.G7a.Wem&&this.I7m();this.Qln();this.Pln();this.ga.gb(Fb.a.llh,kc.a.view,this.R4i,1284);this.ga.gb(Fb.a.dIi,kc.a.view,this.lio,1124);this.ga.gb(Fb.a.eof,kc.a.view,this.R4i,1284);this.ga.gb(Fb.a.POf,kc.a.view,this.iio,1124);this.ga.gb(Fb.a.Y5l,kc.a.view,this.JXn,
1284)}Qln(){this.ga.gb(Fb.a.insertOnlinePicture,kc.a.view,this.K8d,1284);this.ga.gb(Fb.a.GMd,kc.a.view,this.G8d,1284);this.ga.Qaa("word_insertOnlinePictures",Fb.a.insertOnlinePicture,kc.a.view,this.K8d,b=>{vb.App.xa.gMb(b,Object(u.a)(new Wg.a,(new Wg.a).vdb,"getCommandById"))});this.ga.Qaa("word_insertOnlinePictures",Fb.a.GMd,kc.a.view,this.G8d,b=>{vb.App.xa.gMb(b,Object(u.a)(new Wg.a,(new Wg.a).vdb,"getCommandById"))});this.ga.gb(Fb.a.dWe,kc.a.view,this.K8d,1284);this.ga.gb(Fb.a.fWe,kc.a.view,this.L8d,
1284);this.ga.Qaa("word_insertOnlinePictures",Fb.a.fWe,kc.a.view,this.L8d);this.ga.gb(Fb.a.gWe,kc.a.view,this.G8d,1284);this.ga.gb(Fb.a.bIi,kc.a.view,this.jio,1284);this.ga.gb(Fb.a.cIi,kc.a.view,this.kio,1284);this.ga.Qaa("word_insertOnlinePictures",Fb.a.dWe,kc.a.view,this.K8d);this.ga.Qaa("word_insertOnlinePictures",Fb.a.gWe,kc.a.view,this.G8d);this.ga.gb(Fb.a.gof,kc.a.view,this.L8d,1284);this.ga.Qaa("word_insertOnlinePictures",Fb.a.gof,kc.a.view,this.L8d,b=>{vb.App.xa.gMb(b,Object(u.a)(new Wg.a,
(new Wg.a).vdb,"getCommandById"))})}Pln(){t.AFrameworkApplication.srf()&&(this.ga.gb(Fb.a.JMd,kc.a.view,this.J8d,1284),this.ga.gb(Fb.a.eWe,kc.a.view,this.J8d,1284),this.ga.Qaa("mso_insertMobileDevicePictures",Fb.a.JMd,kc.a.view,this.J8d,b=>{vb.App.xa.gMb(b,Object(u.a)(new Wg.a,(new Wg.a).vdb,"getCommandById"))}),this.ga.Qaa("mso_insertMobileDevicePictures",Fb.a.eWe,kc.a.view,this.J8d,b=>{vb.App.xa.gMb(b,Object(u.a)(new Wg.a,(new Wg.a).vdb,"getCommandById"))}))}I7m(){t.AFrameworkApplication.ua.get_element().appendChild(this.yhd.FXa);
Bf.a.addHandler(this.yhd.FXa.contentWindow,"message",this.d5i);this.Dqf=!0}Zvl(b,h){let r=0;t.AFrameworkApplication.ua&&t.AFrameworkApplication.ua.Sb&&5===t.AFrameworkApplication.ua.Sb.jo&&(r=12);const z=Sj.a.pg(t.AFrameworkApplication.lcid);return String.format(t.AFrameworkApplication.K.appSettings.WordInsertPictureServiceEndpoint,b===Fb.a.insertOnlinePicture?1:0,t.AFrameworkApplication.lcid,z?z.name:"en-us",t.AFrameworkApplication.buildVersion,h,r,t.AFrameworkApplication.K.lb("UserId"))}I8d(b,h,
r){try{return b.H8d(h,r),v.ULS.sendTraceTag(7185476,352,50,"InsertMediaActor::ShowInsertPictureDialog : ShowInsertMediaDialog dialog success."),32}catch(z){return v.ULS.sendTraceTag(7165726,352,10,"InsertMediaActor::ShowInsertPictureDialog : Exception = [{0}]",z.toString()),this.xp(fj.a.noPictureSpecified,CommonUIStrings.l_DefaultDialogTitle,Box4Intl.Box4Strings.l_ClipartCannotConnect),8}}Cyl(b,h,r){if(Fb.a.GMd===b)return b=this.O0.uhh(t.AFrameworkApplication.K.lb("InsertOnlineM365PictureEndpoint"),
h.toString(),1,r),this.VNe(b);b=this.O0.uhh(t.AFrameworkApplication.K.lb("InsertOnlineM365PictureEndpoint"),h.toString(),0,r);return this.VNe(b)}xp(b,h,r){const z=new te.StandardDialog(!0);z.Bt=t.AFrameworkApplication.J$;z.Fd=0;z.Ve(1,CommonUIStrings.l_DialogClose);z.jy(b,h,r,()=>{})}wgl(){const b=Sa.a.instance.Pa("Common.App.PhoneLink.IPhoneLinkManager");return null!=b?b.mkl():!1}dispose(){this.Dqf&&this.yhd.FXa.contentWindow&&(Bf.a.removeHandler(this.yhd.FXa.contentWindow,"message",this.d5i),this.Dqf=
!1)}VNe(b){return this.Cbi&&this.Q1&&this.Q1.sL?(b=new Ma.QueryStringBuilder(b),b.Ie("theme","4"),b.toString()):b}}cA.g5g=".jpg .jpeg .png .gif .bmp .tif .tiff".split(" ");Object(n.a)(cA,"InsertMediaActor",null,[9]);var ny=d(935);class oy extends ny.a{constructor(b,h){super(b,Rc.a.p$(h))}zr(b,h){this.isEnabled()&&this.iVa(this.F3a)&&(this.xv(b),this.cC(b,h))}}Object(n.a)(oy,"InsertMediaCrossDocumentMessenger",ny.a,[494,63,9]);class DD{getInstance(b,h){return new oy(b,h)}}Object(n.a)(DD,"InsertMediaCrossDocumentMessengerFactory",
null,[481]);var ED=d(1009);class IB{}IB.vg="<div class='InsertMediaDialog' id='insertmediadialog'> <div class='InsertMediaPanel' id='insertmediapanel'> <iframe id='insertmediaframe' class='InsertMediaFrame' name='InsertMediaFrame'></iframe> </div> </div>";Object(n.a)(IB,"InsertMediaDialogHtml",null,[]);var dA;(function(b){b[b.OK=0]="OK";b[b.cancel=1]="cancel";b[b.error=2]="error";b[b.open=3]="open"})(dA||(dA={}));Object(n.b)("HubbleAction",dA);var yx;(function(b){b[b.unknown=0]="unknown";b[b.bing=
1]="bing";b[b.M365=2]="M365";b[b.icons=3]="icons";b[b.oneDrive=4]="oneDrive";b[b.hubble=5]="hubble"})(yx||(yx={}));Object(n.b)("InsertMediaProviders",yx);class JB extends Wc.a{constructor(b,h,r,z=null,R=!1){super(!1,!1,R);this.xG=null;this.mnc=!1;this.BRc=this.TZ=null;this.VUe="KeepFocusDiv";this.wtd="KeepFocusStartDiv";this.correlationId=null;this.Gfa=0;this.sJa=this.v5b=null;this.Sjj=0;this.Mxe=null;this.xTm=()=>{this.TZ&&(this.TZ.style.visibility="visible",window.setTimeout(()=>{if(this.Hk){const ba=
this.Hk.getElementById(this.wtd);ba&&ba.focus()}},0))};this.faa=ba=>{ba.keyCode===Sys.UI.Key.tab&&(ba.target.id!==this.VUe||ba.shiftKey?ba.target.id===this.wtd&&ba.shiftKey&&(ba.preventDefault(),this.Hk.getElementById(this.VUe).focus()):(ba.preventDefault(),this.Hk.getElementById(this.wtd).focus()))};this.lwi=()=>{v.ULS.sendTraceTag(17662422,352,100,"OnCancelDialog : Got message.");this.Qyb(this.NVa);this.ekb(1)};this.xxi=()=>{this.xG&&(v.ULS.sendTraceTag(7135755,352,100,"OnGetCustomHeaders : Got message."),
this.xG.sendMessage(F.a.KIn,{["CustomHeaders"]:""}))};this.Axi=()=>{this.xG&&(v.ULS.sendTraceTag(7135756,352,100,"OnGetSessionId : Got message."),this.xG.sendMessage(F.a.IOn,{["SessionId"]:t.AFrameworkApplication.userSessionId||"00000000-0000-0000-0000-000000000000"}))};this.wxi=()=>{this.xG&&(v.ULS.sendTraceTag(7135757,352,100,"OnGetCID : Got message."),this.xG.sendMessage(F.a.QHn,{["CID"]:""}))};this.STm=()=>{this.sJa&&(v.ULS.sendTraceTag(577249665,352,50,"OnLaunchM365Upsell: Launch Dime Upsell flow from Stock Image picker."),
this.sJa.launchUpsellExperience("stockimages"))};if(!b)throw Error.argumentNull("insertMediaSeviceEndpoint","insertMediaSeviceEndpoint cannot be null.");this.Pcd=b;this.APb="";this.O0=r;this.Oca=[];this.Pid=h;this.vg=z||IB.vg;this.kg="InsertMediaDialog"}get telemetryEventName(){return"InsertM365Images"}H8d(b,h){this.APb=b;this.mnc=!1;this.showDialog(this.APb,null);this.TZ=this.E2b(this.qj("insertmediaframe"));if(!this.TZ)throw this.Qyb(this.NVa),Error.invalidOperation("Couldn't get InsertMediaIframe.");
b=document.createElement("div");b.setAttribute("Id",this.wtd);b.setAttribute("tabindex","0");b.setAttribute("position","absolute");b.setAttribute("width","-1000px");b.setAttribute("top","-1000px");this.TZ.parentNode.insertBefore(b,this.TZ.parentNode.firstChild);b=document.createElement("div");b.setAttribute("Id",this.VUe);b.setAttribute("tabindex","0");this.TZ.parentNode.appendChild(b);b.setAttribute("position","absolute");b.setAttribute("width","-1000px");b.setAttribute("top","10000px");$addHandler(this.J3e,
"keydown",this.faa);this.TZ.src=this.Pcd;this.TZ.style.width="100%";this.TZ.style.height="100%";this.TZ.frameBorder="0";t.AFrameworkApplication.K.$("ShowInsertMediaIframeWhenIframeIsReady")&&X.a.gj?(this.TZ.style.visibility="hidden",this.BRc=this.xTm,Bf.a.addHandler(this.TZ,"load",this.BRc)):this.TZ.style.visibility="visible";this.E2b(this.qj("WACDialogButtonPanel")).style.display="none";this.E2b(this.qj("WACDialogTitleText")).style.display="none";2===this.Gfa&&(this.E2b(this.qj("WACDialogTitlePanel")).style.display=
"none",this.E2b(this.qj("WACDialogBodyPanel")).style.padding="0");ve.FocusManager.instance().Gs().scope.UL=!0;this.xG=this.Pid.getInstance(this.TZ.contentWindow,this.Pcd);this.xG.zr(F.a.r8g,r=>{this.Bvi(r,Object(u.a)(h,h.OZa,"insertMediaCallback"))});this.xG.zr(F.a.insert,r=>{this.BXd(r,Object(u.a)(h,h.OZa,"insertMediaCallback"))});this.xG.zr(F.a.O3j,r=>{this.OUm(r)});this.xG.zr(F.a.lPh,this.xxi);this.xG.zr(F.a.getSessionId,this.Axi);this.xG.zr(F.a.cNh,this.wxi);this.xG.zr(F.a.Otd,this.lwi);2!==this.Gfa||
this.Sjj||(this.xG.zr(F.a.tqm,this.STm),this.Mxe=this.sJa.lva("MsoPremiumStockImages",r=>{v.ULS.sendTraceTag(577249664,352,50,"OnCompleteM365Upsell: upsell completed from stock images");this.xG.sendMessage(F.a.mno,{["LicenseTier"]:r.toString()})}));this.ekb(3)}dispose(){this.sJa&&this.Mxe&&this.sJa.gcc("MsoPremiumStockImages",this.Mxe);this.xG&&(this.xG.dispose(),this.xG=null);this.BRc&&(Bf.a.removeHandler(this.TZ,"load",this.BRc),this.BRc=null);super.dispose()}Bvi(b,h){v.ULS.sendTraceTag(7135752,
352,100,"OnAddItem : Got message.");if(b=this.O0.O2m(b))this.Oca.push(b),this.mnc&&(h(this.Oca),this.mnc=!1)}xp(){const b=new te.StandardDialog(!0);b.Bt=t.AFrameworkApplication.J$;b.Fd=0;b.Ve(1,CommonUIStrings.l_DialogOk);b.Pv(CommonUIStrings.l_ImageUploadFailedTitle,CommonUIStrings.l_InsertPictureMaxLimitExceeded,2,()=>{})}ekb(b){var h=RegExp("hubble","gi");if(this.v5b&&0<this.v5b.search(h)&&this.correlationId){h=t.AFrameworkApplication.sessionStartInfoSettings;var r={};r.InsertedFiles=this.Oca.length;
r.MediaDetails=this.Oca;r.DialogResult=dA[b];r.DialogMode=this.yff();r.CorrelationId="{"+this.correlationId.toString()+"}";r.Platform="Wac";r.Provider=yx[this.Gfa]||"Unknown";r.AudienceGroup=h&&"AudienceGroup"in h?h.AudienceGroup.toString():"Unknown";r.Ring=h&&"Ring"in h?h.Ring.toString():"Unknown";r.AppId=2;r.Build=t.AFrameworkApplication.buildVersion;r.Locale=Sj.a.pg(t.AFrameworkApplication.lcid).name;this.N7m().send(JSON.stringify(r))}2===this.Gfa&&(r=t.AFrameworkApplication.K.lb("InsertMediaDialogAriaTenantNameSpace"))&&
""!==r&&(h=[],h.push(Object.assign(new ca.a,{name:"InsertedFiles",int64:this.Oca.length})),h.push(Object.assign(new ca.a,{name:"MediaDetails",string:JSON.stringify(this.Oca)})),h.push(Object.assign(new ca.a,{name:"DialogResult",string:dA[b]})),h.push(Object.assign(new ca.a,{name:"DialogMode",string:this.yff()})),h.push(Object.assign(new ca.a,{name:"CorrelationId",string:this.correlationId.toString()})),h.push(Object.assign(new ca.a,{name:"Provider",string:yx[this.Gfa]||"Unknown"})),Y.a.sendTelemetryEvent(Object.assign(new da.a,
{name:String.format("{0}.{1}",r,this.telemetryEventName),dataFields:h})))}yff(){return 3===this.Gfa?"Icons":5===this.Gfa?"ExternalContent":"Images"}E2b(b){const h=document.getElementById(b);if(!h)throw Error.invalidOperation(String.format("Couldn't get {0}.",b));return h}N7m(){const b=new XMLHttpRequest;b.open("POST",this.v5b,!0);b.setRequestHeader("Content-Type","");return b}BXd(b,h){v.ULS.sendTraceTag(7135754,352,100,"OnInsert : Got message.");this.Qyb(this.NVa);h?this.Oca&&50<this.Oca.length?(this.xp(),
this.ekb(0),v.ULS.sendTraceTag(578140104,352,10,"InsertMediaDialog: User tried to insert {0} images using {1}",this.Oca.length,yx[this.Gfa])):this.Oca&&0<this.Oca.length?(h(this.Oca),this.ekb(0),v.ULS.sendTraceTag(578140105,352,50,"InsertMediaDialog: User inserted {0} images using {1}",this.Oca.length,yx[this.Gfa])):(v.ULS.sendTraceTag(23078422,352,15,"Empty search result."),this.mnc=!0,h(this.Oca),this.ekb(2)):this.ekb(2)}OUm(b){b&&b.Values&&(b=b.Values,delete b.m_Origin,delete b.m_Source,delete b.m_ReceivedTime,
v.ULS.sendTraceTag(51652562,352,50,"Received OTel event: "+b.eventName||!1),Y.a.sendOtelEvent(Object.assign(new ED.a,{otelEvent:b})))}}Object(n.a)(JB,"InsertMediaDialog",Wc.a,[480,9]);class FD{constructor(b,h){this.ite=b;this.O0=h}CIc(b,h=!1){return new JB(b,this.ite,this.O0,IB.vg,h)}getInstance(){throw Error.notImplemented();}}Object(n.a)(FD,"InsertMediaDialogFactory",null,[478]);class GD{constructor(b,h,r){this.Gai=!1;this.correlationId=null;this.Gfa=0;this.v5b=null;this.AGj=b;this.axc=[];this.Sbd=
h;this.$1g=r.split(";")}H8d(b,h){Array.clear(this.axc);b=this.AGj.value;b.iVa(this.Sbd);b.xv(h.kLc);this.Gai||(b.cC(h.kLc,r=>{this.BXd(r,h)}),this.Gai=!0);v.ULS.sendTraceTag(17838540,352,100,"InsertMediaFromHostDialog::ShowInsertMediaDialog : Sending opening message.");b.sendMessage(h.Yvh,{["FileExtensionFilterList"]:this.$1g})}U5j(b){Array.contains(this.axc,b)||this.axc.push(b)}BXd(b,h){v.ULS.sendTraceTag(17838544,352,100,"InsertMediaFromHostDialog::OnInsert : Got message.");b=h.EDi(b);const r=[];
for(let z=0;z<b.length;z++){const R=b[z];h.uOd(R,this.$1g)?r.push(R):this.U5j(h.bYh(R))}r&&r.length?h.OZa(r):v.ULS.sendTraceTag(20509843,352,50,"InsertMediaFromHostDialog::OnInsert : search result is empty");0<this.axc.length&&(h=this.axc.join(", "),v.ULS.sendTraceTag(20509844,352,15,"InsertMediaFromHostDialog::OnInsert : Unsupported files {0} were selected.",h),this.dZn(h))}dZn(b){const h=new te.StandardDialog;h.Fd=0;h.vU(CommonUIStrings.l_DefaultDialogTitle,String.format(CommonUIStrings.l_OnlinePictureFromHostUnsupportedFiles,
b),null)}dispose(){}}Object(n.a)(GD,"InsertMediaFromHostManager",null,[480,9]);class xC{constructor(b){this.FHj=b}CIc(){throw Error.notImplemented();}getInstance(){return this.FHj}}Object(n.a)(xC,"InsertMediaFromHostManagerFactory",null,[477,478]);class KB{constructor(){this.FXa=document.createElement("iframe");this.FXa.src="about:blank";this.FXa.style.visibility="hidden";this.FXa.style.position="absolute";this.FXa.style.zIndex="-100"}}Object(n.a)(KB,"InsertMediaFromHostOneDriveHostFrame",null,[479]);
class eA extends ny.a{constructor(b,h){super(b,"*"===h?h:Rc.a.p$(h));this.u7g(F.a.insertImage);this.u7g(F.a.Tnf)}n4d(){}}Object(n.a)(eA,"InsertMediaFromOneDriveCrossDocumentMessenger",ny.a,[62,63,9]);class fA{}Object(n.a)(fA,"OnlineMediaSearchResult",null,[]);class Jw{uhh(b,h,r,z){const R=Sj.a.pg(t.AFrameworkApplication.lcid).name,ba=t.AFrameworkApplication.buildVersion,ta=B.a.cW(t.AFrameworkApplication.K.lb("UserId")).toString();if(-1!==b.indexOf("exp=")){const Wa=t.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.InsertOnlineM365ExperimentEnabled",
!1)?1:0;t.AFrameworkApplication.Hf("ShIns226;ShIns226cf");return String.format(b,t.AFrameworkApplication.lcid,R,ba,h,Jw.mge,ta,z,r,Wa)}return String.format(b,t.AFrameworkApplication.lcid,R,ba,h,Jw.mge,ta,z,r)}O2m(b){if(!b||!b.Values)return null;b=b.Values;if(!b)return null;let h="";"sourceProvider"in b&&(h=b.sourceProvider||"");return Object.assign(new fA,{Action:b.action||"",Caption:b.caption||"",ContentType:b.contenttype||"",Type:b.extension||"",PageUrl:b.pageUrl||"",OriginalUrl:b.sourceUrl||"",
ContentProvider:h,ThumbnailUrl:b.thumbnailUrl||"",LicenseUrl:b.licenseUrl||"",LicenseDisplayName:b.licenseDisplayName||"",Height:b.height||0,Width:b.width||0,SvgContent:b.svgContent||"",Html:b.html||""})}P2m(b){const h=[];if(!b||!b.Values||!b.Values.Items)return h;b=b.Values.Items;for(let z=0;z<b.length;z++){var r=b[z];r&&(r=Object.assign(new fA,{Type:r.Extension||"",OriginalUrl:r.SourceUrl||"",Caption:r.caption,Height:r.Height||0,Width:r.Width||0}),h.push(r))}return h}HKf(b){const h=[];for(let z=
0;z<b.data.files.length;z++){var r=b.data.files[z];r&&(r=Object.assign(new fA,{ContentType:r.itemType||"",Type:r.extension||"",OriginalUrl:r.urls&&r.urls.open?r.urls.open:"",Height:r.photo?r.photo.height:0,Width:r.photo?r.photo.width:0}),h.push(r))}return h}uOd(b,h){if(!b)return!1;for(let r=0;r<h.length;r++)if(0<=b.toLowerCase().indexOf(h[r]))return!0;return!1}D7m(b){let h="";if(b)for(let r=0;r<b.length;r++){const z=b[r];z&&(h+=String.format('<img src="{0}" width="{1}" height="{2}"></img>',z.OriginalUrl,
z.Width,z.Height))}return h}}Jw.mge=0;Object(n.a)(Jw,"InsertMediaHelper",null,[476]);class HD{constructor(b,h,r,z,R){this.Vem=b;this.qrf=h;this.Ldi=r;this.Wem=z;this.Xem=R}}Object(n.a)(HD,"InsertMediaSettingsManager",null,[]);class yC{constructor(b){this.lpc=Fb.a.insertHyperlink;this.ga=b}get fMa(){return this.lpc}set fMa(b){this.lpc=b}OZa(b){try{v.ULS.sendTraceTag(21612191,352,50,"InsertOneDriveFileLinkHelper::InsertMediaCallback: Insert {0} links.",b.length);for(let h=0;h<b.length;h++)this.ga.Xb(this.fMa,
2,b[h]);v.ULS.sendTraceTag(21612192,352,50,"InsertOneDriveFileLinkHelper::InsertMediaCallback: Insert {0} links.",b.length)}catch(h){v.ULS.sendTraceTag(21612193,352,10,"InsertOneDriveFileLinkHelper::InsertMediaCallback: Exception = [{0}].",h.toString())}}}Object(n.a)(yC,"InsertOneDriveFileHandler",null,[395]);class ID extends yC{constructor(b){super(b)}get Yvh(){return F.a.Tnf}get kLc(){return F.a.u5l}EDi(b){return b&&b.Values&&"Items"in b.Values?b.Values.Items:null}bYh(){ud.a(21612194,315,!1,"InsertOneDriveFileLinkHelper::GetResultFileType: Method should never be called when for OneDrive files");
return""}uOd(){return!0}pHi(b,h,r){b=r(b);b.length&&(r={},r.Items=b,h.sendMessage(this.kLc,r))}GDi(b){const h=[];for(let r=0;r<b.data.files.length;r++){const z=b.data.files[r];if(z){const R={};R.DisplayText=String.format("{0}{1}",z.name,z.extension);R.Url=this.tal([z.urls.viewInBrowser,z.urls.open,z.urls.download]);h.push(R)}}return h}tal(b){for(let h=0;h<b.length;h++)if(b[h]&&""!==b[h])return b[h];v.ULS.sendTraceTag(21764229,352,10,"None of the URLs we received are valid");return""}}Object(n.a)(ID,
"InsertOneDriveFileHelper",yC,[394,395]);class LB{constructor(b,h,r){this.lpc=Fb.a.C1;this.zp=null;this.ga=b;this.O0=h;this.Tca=r}get zc(){return this.ga}get jw(){return this.zp||(this.zp=Sa.a.instance.resolve("Common.Utils.IAriaNotifier"))}get fMa(){return this.lpc}set fMa(b){this.lpc=b}OZa(b){try{v.ULS.sendTraceTag(21612195,352,50,"InsertImageFromHostHelper::InsertMediaCallback : Insert {0} pictures.",b.length);const h=this.O0.D7m(b);let r=2;if(h&&0<h.length){const z=new Ei.DictionaryPropertySet;
z.setValue(od.a.hU,h);z.setValue(od.a.P$,!0);if(this.Tca){const R=this.Tca.i1c();R.EXb("insertOnlineImage");z.setValue(od.a.Jra,R)}r=this.ga.Xb(this.fMa,2,z)}v.ULS.sendTraceTag(21612224,352,50,"InsertImageFromHostHelper::InsertMediaCallback : Insert {0} pictures success: {1}. pastedHtmlContentIsEmpty: {2}",b.length,32===r,""===h)}catch(h){v.ULS.lM(21612225,352,10,h,"InsertImageFromHostHelper::InsertMediaCallback : Exception")}}}Object(n.a)(LB,"InsertOnlineImageHandler",null,[395]);class zx extends LB{constructor(b,
h,r=null){super(b,h,r)}get Yvh(){return F.a.insertImage}get kLc(){return F.a.G5l}EDi(b){return this.O0.P2m(b)}bYh(b){return b.Type}uOd(b,h){return this.O0.uOd(b.Type,h)}GDi(b){return this.O0.HKf(b)}pHi(b,h,r){r=r(b);if(r.length){b=[];for(let z=0;z<r.length;z++){const R=r[z],ba={};ba.Extension=R.Type;ba.SourceUrl=R.OriginalUrl;ba.caption=R.Type;ba.SourceUrl=R.OriginalUrl;ba.Width=R.Width;ba.Height=R.Height;b.push(ba)}r={};r.Items=b;h.sendMessage(this.kLc,r)}}}Object(n.a)(zx,"InsertOnlineImageHelper",
LB,[394,395]);class JD{constructor(b,h){this.mpb=b;this.Pid=h}start(b){this.mpb.start({mode:"open",select:"multi",lightbox:"white"},(h,r)=>{this.FNf(h,r,b)})}FNf(b,h,r){v.ULS.sendTraceTag(22090009,352,100,"OneDriveFilePickerHelperV5::ProcessOneDriveFilePickerResponse : Response received. IsSuccess: {0}.",b);b&&h&&h.data&&h.data.files&&0<h.data.files.length?(b=this.Pid.getInstance(window.frames[0].parent,window.document.URL),r.pHi(h,b,Object(u.a)(r,r.GDi,"parseOneDriveV5Response"))):v.ULS.sendTraceTag(22090010,
352,100,"OneDriveFilePickerHelperV5::ProcessOneDriveFilePickerResponse : No media to insert.")}}Object(n.a)(JD,"OneDriveFilePickerHelperV5",null,[392]);class zC{constructor(){this.Ncd=this.W=null}get name(){return"Box4.Media"}yc(b){this.W=b;b.ha("Box4.Media.InsertMediaFromHostOneDriveHostFrame",()=>new KB).as("Box4.Media.IInsertMediaFromHostOneDriveHostFrame").singleInstance();const h=new HD(Boolean.parse(t.AFrameworkApplication.K.appSettings.InsertOnlinePictureEnabled||"false"),t.AFrameworkApplication.rrf(),
!1,t.AFrameworkApplication.Z_f(),t.AFrameworkApplication.K.$("InsertPictureUsingStockImagesIsEnabled"));b.ha("Box4.Media.OneDriveFilePickerHelperV5",()=>new JD(b.resolve("Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV5"),b.resolve("Box4.Media.IInsertMediaCrossDocumentMessengerFactory"))).as("Box4.Media.IOneDriveFilePickerHelper").singleInstance();b.ha("Box4.Media.InsertMediaActor",()=>new cA(t.AFrameworkApplication.ya,t.AFrameworkApplication.K,h,b.resolve("Box4.Media.IOneDriveFilePickerHelper"),
b.resolve("Box4.Media.InsertMediaFromHostOneDriveHostFrame"),new De.a(()=>Sa.a.instance.resolve("Box4.Images.IImageEditor")),b.resolve("Box4.Media.IInsertMediaDialogFactory"),b.resolve("Box4.Media.IInsertMediaFromHostManagerFactory"),b.resolve("Box4.Media.InsertMediaHelper"),b.resolve("Box4.Media.InsertOnlineImageHelper"),b.resolve("Box4.Media.InsertOneDriveFileHelper"),b.resolve("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"),t.AFrameworkApplication.F7b,t.AFrameworkApplication.Ama,
t.AFrameworkApplication.eZl,t.AFrameworkApplication.K.appSettings.InsertPictureTelemetryEndpoint,b.resolve("Box4.IDarkModeState"))).singleInstance();b.ha("Box4.Media.InsertMediaDialogFactory",()=>new FD(b.resolve("Box4.Media.IInsertMediaCrossDocumentMessengerFactory"),b.resolve("Box4.Media.InsertMediaHelper"))).as("Box4.Media.IInsertMediaDialogFactory").singleInstance();b.ha("Box4.Media.InsertMediaFromHostManagerFactory",()=>new xC(b.resolve("Box4.Media.InsertMediaFromHostManager"))).as("Box4.Media.IInsertMediaFromHostManagerFactory").singleInstance();
b.ha("Box4.Media.InsertMediaFromHostManager",()=>new GD(new De.a(()=>{if(t.AFrameworkApplication.Z_f()){var r=Sa.a.instance.resolve("Box4.Media.IInsertMediaFromHostOneDriveHostFrame").FXa;r=new eA(r.contentWindow,"*")}else r=t.AFrameworkApplication.MW;return r}),t.AFrameworkApplication.Z_f()?Rc.a.p$(window.document.URL):Rc.a.p$(t.AFrameworkApplication.nHb),t.AFrameworkApplication.K.appSettings.ImageFetcherSupportedExtensions)).singleInstance();b.register(DD,"Box4.Media.InsertMediaCrossDocumentMessengerFactory").as("Box4.Media.IInsertMediaCrossDocumentMessengerFactory").singleInstance();
b.register(Jw,"Box4.Media.InsertMediaHelper").singleInstance();b.ha("Box4.Media.InsertOnlineImageHelper",()=>new zx(t.AFrameworkApplication.ya,b.resolve("Box4.Media.InsertMediaHelper"),b.resolve("Common.Utils.Telemetry.ITelemetry"))).singleInstance();b.ha("Box4.Media.InsertOneDriveFileHelper",()=>new ID(t.AFrameworkApplication.ya)).singleInstance()}init(){this.Ncd=this.W.resolve("Box4.Media.InsertMediaActor");this.Ncd.Vb()}dispose(){this.Ncd&&this.Ncd.dispose()}}Object(n.a)(zC,"MediaPackage",null,
[1,2]);var KD=d(282);class Zv{constructor(){this.Tzn="getAddinShortcutsPreference";this.Uzn="saveAddinShortcutsPreference";this.Vzn="{0}RoamingServiceHandler.ashx?action={1}&{2}";this.Wgl=6E4;this.NVd=this.yka=this.y7=null}hYh(b){return String.format(this.Vzn,t.AFrameworkApplication.K.appSettings.RoamingServiceHandlerWebServiceBase||"",b,t.AFrameworkApplication.xm)}executeRequest(b,h,r,z,R=null){return Zv.Zja.XWb(b,h,R,null,r,z,!1,null,this.Wgl)}saveSetting(b,h,r,z,R){return this.BUi(b,h,r,null,z,
R)}startBatchUpdateScope(){this.NVd=[]}saveShortcutInfoArrayBatch(b,h,r){this.YBn(r,b,h)}YBn(b,h,r){const z={action:"",addinId:"",ownerType:0};z.timestamp=(new Date).toUTCString();const R=this.getShortcutInfoArray(h.toString(),r.toString());b?(z.shortcutInfoArray=b,this.UNe(h,r,b)):R&&(z.shortcutInfoArray=R);b={};b[h.toString()]=z;h=new KD.a(r.toString(),b);this.NVd.push(h)}commitBatchUpdateScope(){return this.u0c()?this.$Bn().then(()=>{this.wYb();return Promise.resolve(!0)}):this.bCn().then(()=>
{this.wYb();return Promise.resolve(!0)})}$Bn(){return this.getSetting().then(b=>{let h=null;if(b&&!({Fv:h}=y.d(b)).returnValue)return v.ULS.sendTraceTag(522739852,0,10,"SaveSettingToLocalStorageBatch failed due to failed to deserialize the settings"),Promise.resolve(!1);h||(h={});for(const r of this.NVd){(b=h[r.key])||(b={});const z=r.value;for(const R of Na.a.UN(z))b[R]=z[R];h[r.key]=b}this.y7=h;try{return localStorage.setItem("AddinShortcutPreferenceData",y.c(h)),Promise.resolve(!0)}catch(r){return v.ULS.sendTraceTag(522739853,
0,10,"SaveSettingToLocalStorageBatch failed",r),Promise.resolve(!1)}})}bCn(){return this.FGn().then(b=>this.v5d(b))}FGn(){return this.Hhf().then(b=>{let h=null;b&&(({Fv:h}=y.d(b)).returnValue||v.ULS.sendTraceTag(522739854,0,10,"SerializeNewSettingWithSavedRoamingSettingsBatch failed due to failed to deserialize the settings"));h||(h={});for(const r of this.NVd){(b=h[r.key])||(b={});const z=r.value;for(const R of Na.a.UN(z))b[R]=z[R];h[r.key]=b}this.y7=h;return y.c(h)})}saveShortcutInfoArray(b,h,r){return this.BUi(0,
"","",r,b,h)}BUi(b,h,r,z,R,ba){const ta=this.u0c(),Wa={};Wa.action=r;Wa.addinId=h;Wa.ownerType=b;Wa.timestamp=(new Date).toUTCString();h=this.getShortcutInfoArray(R.toString(),ba.toString());0===b&&z?(Wa.shortcutInfoArray=z,this.UNe(R,ba,z)):h&&(Wa.shortcutInfoArray=h);b={};b[R.toString()]=Wa;R=new KD.a(ba.toString(),b);return ta?this.ZBn(R):this.aCn(R)}ZBn(b){return this.getSetting().then(h=>{let r=null;if(h&&!({Fv:r}=y.d(h)).returnValue)return v.ULS.sendTraceTag(522739855,0,10,"SaveSettingToLocalStorage failed due to failed to deserialize the settings"),
Promise.resolve(!1);r||(r={});r[b.key]=b.value;this.y7=r;try{return localStorage.setItem("AddinShortcutPreferenceData",y.c(r)),Promise.resolve(!0)}catch(z){return v.ULS.sendTraceTag(522739856,0,10,"SaveSettingToLocalStorage failed",z),Promise.resolve(!1)}})}aCn(b){return this.EGn(b).then(h=>this.v5d(h))}EGn(b){return this.Hhf().then(h=>{let r=null;h&&(({Fv:r}=y.d(h)).returnValue||v.ULS.sendTraceTag(522739857,0,10,"SerializeNewSettingWithSavedRoamingSettings failed due to failed to deserialize the settings"));
r||(r={});r[b.key]=b.value;this.y7=r;return y.c(r)})}saveSettings(b){this.y7=y.a(b);this.wYb();return this.u0c()?this.EUi(b):this.v5d(b)}EUi(b){try{return localStorage.setItem("AddinShortcutPreferenceData",b),Promise.resolve(!0)}catch(h){return v.ULS.sendTraceTag(522739858,0,10,"SaveSettingToLocalStorage failed",h),Promise.resolve(!1)}}v5d(b){const h={};h.Wac=b;const r=y.c(h);return new Promise(z=>{try{if(void 0===r||null===r||!r.length||1E6<=r.length)z(!1);else{var R=this.executeRequest(this.hYh(this.Uzn),
2,"SaveAddinShortcutsPreferenceRequest","38",r);R.continueWith(()=>{if(R.ho||R.Ji)v.ULS.sendTraceTag(522739859,0,10,"SaveAddinShortcutsPreference: Request failure"),z(!1);else{var ba=R.result;void 0!==ba.args&&null!==ba.args&&void 0!==ba.args.data&&null!==ba.args.data&&ba.args.data.wf===Ja.a.xD?z(!0):z(!1)}})}}catch(ba){v.ULS.sendTraceTag(522739860,0,10,"SaveAddinShortcutPerferrenceSettings: Exception = {0}",ba.toString()),z(!1)}})}getSetting(){const b=this.u0c();return this.y7?Promise.resolve(y.c(this.y7)):
b?this.VIl():this.Hhf()}u0c(){const b=t.AFrameworkApplication.K.$("IsAnonymousUser"),h=t.AFrameworkApplication.K.$("IsRoamingServiceEnabled");return b||!h}VIl(){try{const b=localStorage.getItem("AddinShortcutPreferenceData");return Promise.resolve(b)}catch(b){return v.ULS.sendTraceTag(522739861,0,10,"GetSettingFromLocalStorage failed",b),Promise.resolve("")}}Hhf(){return new Promise((b,h)=>{try{const r=this.executeRequest(this.hYh(this.Tzn),1,"GetSettingRequest","37");r.continueWith(()=>{if(r.ho||
r.Ji)v.ULS.sendTraceTag(522739862,0,10,"GetSettingFromRoaming : Request failure");else{let R="";var z=r.result;z&&z.args&&z.args.data?z.args.data.wf!==Ja.a.xD?v.ULS.sendTraceTag(522739864,0,10,"GetSettingFromRoaming : Received error response {0}",z.args.data.wf):z.args.data.Ge?(z=y.a(z.args.data.Ge),z.Wac&&(R=z.Wac)):v.ULS.sendTraceTag(522739865,0,10,"GetSettingFromRoaming : ResponseData is null"):v.ULS.sendTraceTag(522739863,0,10,"GetSettingFromRoaming : Data is null");b(R)}})}catch(r){v.ULS.sendTraceTag(522739866,
0,10,"GetSettingFromRoaming Exception handling request {0}",r.toString()),h("GetSettingFromRoaming Request Exception")}})}clearSettingByAddinId(b){const h=this.u0c(),r=this;return this.getSetting().then(z=>{let R=null;z&&(R=y.a(z));if(!R)return v.ULS.sendTraceTag(522739867,0,50,"savedRoamingSetting is empty and nothing to clear "),Promise.resolve(!0);for(const ba of Na.a.UN(R)){z=R[ba.toString()];for(const ta of Na.a.UN(z)){const Wa=z[ta];if(Wa.addinId===b)delete z[ta.toString()];else if(0===Wa.ownerType&&
Wa.shortcutInfoArray){const ub=Wa.shortcutInfoArray,Ib=new Ua.a;for(let $b=0;$b<ub.length;++$b)ub[$b].addinId!==b&&Ib.add(ub[$b]);Wa.shortcutInfoArray=Ib.toArray()}}Na.a.count(z)||delete z[ba]}r.y7=R;r.cpn(b);return h?r.EUi(y.c(R)):r.v5d(y.c(R))})}wYb(){if(this.y7){this.yka=null;const r=this.y7;for(let z in r){var b=z;const R=r[z];for(let ba in R){var h=ba;const ta=R[ba];ta.shortcutInfoArray&&this.UNe(parseInt(h),parseInt(b),ta.shortcutInfoArray)}}}}loadShortcutsPreferenceMappingTable(){return this.getSetting().then(b=>
{let h=null;if(b&&!({Fv:h}=y.d(b)).returnValue)return v.ULS.sendTraceTag(522739868,0,10,"LoadShortcutsPreferenceMappingTable is failed since savedRoamingSetting cannot be deserialized"),Promise.resolve(!1);this.y7=h;this.wYb();return Promise.resolve(!0)})}getShortcutsPreferenceInfoByAddinId(b,h,r){return this.y7&&(r=this.y7[r])&&(h=r[h])&&h.addinId===b?h:null}getShortcutInfoArray(b,h){return this.y7&&(h=this.y7[h])&&(b=h[b])&&b.shortcutInfoArray?b.shortcutInfoArray:null}setShortcutInfoWithinBatchUpdateScope(b,
h,r){this.saveShortcutInfoArrayBatch(parseInt(b),parseInt(h),r)}setShortcutInfoArray(b,h,r){return this.saveShortcutInfoArray(parseInt(b),parseInt(h),r).then(()=>{this.wYb();return Promise.resolve(!0)})}removeActionFromShortcutInfoArray(b,h){if(!this.yka)return Promise.resolve(!0);var r=this.yka[b];if(!r)return Promise.resolve(!0);var z=r[h];r=z.modifiers;z=z.keyCode;const R=this.getShortcutInfoArray(r.toString(),z.toString());if(!R||!R.length)return Promise.resolve(!0);let ba=0;for(const ta of R){if(ta.addinId===
b&&ta.action===h)break;++ba}if(ba>=R.length)return Promise.resolve(!0);R.splice(ba,1);return this.saveShortcutInfoArray(r,z,R).then(()=>{this.wYb();return Promise.resolve(!0)})}UNe(b,h,r){this.yka||(this.yka={});for(const z of r){r=z.addinId;const R=z.action;let ba=this.yka[r];ba||(ba={});const ta={};ta.modifiers=b;ta.keyCode=h;ba[R]=ta;this.yka[r]=ba}}cpn(b){b in this.yka&&delete this.yka[b]}isActionCustomized(b,h){return this.yka&&(b=this.yka[b])&&b[h]?!!b[h]:!1}getShortcutByCustomizedAction(b,
h){return this.yka&&(b=this.yka[b])?b[h]:null}getShortcutsPreferenceMappingTable(){return this.y7}static instance(){Zv.KPe||(v.ULS.sendTraceTag(522739851,0,50,"AddinShortcutsPreferenceSettingHelper"),Zv.KPe=new Zv,Zv.Zja=t.AFrameworkApplication.Xe);return Zv.KPe}}Zv.KPe=null;Zv.Zja=null;Object(n.a)(Zv,"AddinShortcutsPreferenceSettingHelper",null,[]);class DG{constructor(b,h){this.Z8c=null;new Ua.a;this.YKg=!0;this.kbd=b;this.tGg=h}ePe(b){this.tGg.addHandler("GoalChangedEvent",b)}QMm(){this.tGg.raiseEvent("GoalChangedEvent")}Rpf(b,
h){return this.Z8c&&this.YKg?b in this.Z8c?this.Z8c[b]:"Formality"===h&&this.kbd.xhf().formality?!1:!0:!0}AIn(b,h){h===this.kbd.xhf().formality&&(this.Z8c=b,this.QMm())}Mio(b){this.YKg=b}}Object(n.a)(DG,"GoalChangeSource",null,[363,364,365]);var jE=d(958),lF=d(905),nL=d(696);class EG{constructor(b,h,r,z,R,ba){this.dHa=h;this.wxa=r;this.Jf=b;this.HJ=z;this.eg=R;this.OFj=ba;this.wxa.XCb()&&this.initialize()}initialize(){return this.HJ.En().then(()=>{this.Jf.mb(this,jE.a.getTypeName());this.Jf.addHandler(this,
lF.a.getTypeName())}).catch(b=>{this.eg.sendTraceTag(528274563,2252,10,"EnsureAugLoopRuntimeManager threw exception when registering to GoalsAnnotation.",b)})}wI(b,h){if(h===ip.a.getTypeName()||h===nL.a.getTypeName())if(!b||!b.content)this.eg.sendTraceTag(528274564,2252,10,"Handled annotation is invalid");else if(to.a.getTypeNameFor(b.content)===jE.a.getTypeName()||to.a.getTypeNameFor(b.content)===lF.a.getTypeName())if(to.a.getTypeNameFor(b.content)===jE.a.getTypeName()){var r=b.content;this.eg.sendTraceTag(528274565,
2252,50,"Goal annotation received with formality goal: {0}",r.critiqueConfiguration.formalityGoal);this.dHa.AIn(r.critiqueConfiguration.mapping,r.critiqueConfiguration.formalityGoal)}else if(to.a.getTypeNameFor(b.content)===lF.a.getTypeName())if(b=b.content,b.features){for(r of b.features)if("Goals"===r.featureName){this.OFj.Mio(!!r.supportType);return}this.eg.sendTraceTag(528274567,2252,10,"No goals feature in multilingualFeaturesAnnotation")}else this.eg.sendTraceTag(528274566,2252,10,"MultilingualFeaturesAnnotation.Features is null")}}
Object(n.a)(EG,"GoalsAnnotationHandler",null,[250]);class FG{constructor(b){this.Oa=b}XCb(){return this.Oa.$("EditorGoalsEnabled")}}Object(n.a)(FG,"GoalsGate",null,[362]);var oL=d(1162),pL=d(1163),GG=d(859);class aw{}aw.Jyd=0;aw.Nyd="1.0";aw.settingType="Goals";Object(n.a)(aw,"GoalsConstants",null,[]);var mF=d(1030);class HG{constructor(b,h,r,z,R){this.xTb=null;this.idi=!1;this.NVg=b;this.mbd=h;this.eg=r;this.wxa=z;this.Vqe=R;this.wxa.XCb()?this.egn():this.wxa.XCb()&&this.TWf(aw.Jyd,aw.Nyd)}egn(){new Promise(b=>
{this.NVg.wWh(aw.settingType,h=>{this.fgn(h)?(this.TWf(this.xTb.formality,this.xTb.version),b(this.xTb)):(this.TWf(aw.Jyd,aw.Nyd),b(null))})})}fgn(b){this.idi=!0;if(!b||!b.Fkb)return this.eg.sendTraceTag(528274529,2252,50,"No persisted goal is registered."),!1;b=b.Fkb.properties;var h=b.getValue(yc.a.v9h);h=parseInt(h);b=b.getValue(yc.a.TMd);if(!this.mbd.h$f(b))return this.eg.sendTraceTag(528274530,2252,10,"Trying to read unsupported persisted formality goal version. Goal version {0}",b),!1;this.xTb=
b=Object.assign(new mF.a,{formality:h,version:b});this.eg.sendTraceTag(528274531,2252,50,"Persisted goal received with formality goal: {0} and version: {1}",b.formality,b.version);return!0}TWf(b,h){b=Object.assign(new GG.a,{formality:b,version:h});this.Vqe.dXi(b)}ivo(b){if(this.mbd.h$f(b.version)){var h=oL.a.$Jk(b.version,b.formality.toString());this.NVg.S8g(Object.assign(new pL.a,{Fkb:h,settingType:aw.settingType}))?this.xTb=b:this.eg.sendTraceTag(528274561,2252,10,"Write persisted goal failed.")}else this.eg.sendTraceTag(528274560,
2252,10,"Trying to write unsupported formality goal version. Goal version {0}",b.version)}rTh(){this.idi||this.eg.sendTraceTag(528274562,2252,10,"Trying to get persisted goal that is not read yet.");return this.xTb}}Object(n.a)(HG,"GoalsPersistenceHandler",null,[361]);class IG{constructor(b,h,r,z){this.eg=b;this.Wqe=h;this.mbd=r;this.wxa=z;this.lbd=Object.assign(new mF.a,{formality:aw.Jyd,version:aw.Nyd});this.gHe=this.wxa.XCb()}xhf(){this.gHe&&(this.gHe=!1,this.Wqe.rTh()&&(this.lbd=this.Wqe.rTh()));
return this.lbd}sOn(b){this.gHe=!1;this.mbd.h$f(b.version)?(this.wxa.XCb()&&this.Wqe.ivo(b),this.lbd=b):(this.eg.sendTraceTag(528274528,2252,10,"Unsupported formality goal version. Goal version {0}",b.version),this.lbd=Object.assign(new mF.a,{formality:aw.Jyd,version:aw.Nyd}))}}Object(n.a)(IG,"GoalsProvider",null,[359,360]);class kE{constructor(b,h,r,z){this.Jf=b;this.HJ=h;this.Z3=r;this.eg=z}dXi(b){b=Object.assign(new ip.a,{parentPath:["Signal",GG.a.getTypeName()],items:[Object.assign(new Uq.a,{body:b})]});
this.MAd(b)}MAd(b){this.HJ.En().then(()=>{this.rNe(b)}).catch(h=>{this.eg.sendTraceTag(528274526,2250,10,"EnsureAugLoopRuntimeManager threw exception.",h)})}rNe(b){return this.Jf.activateAnnotation(jE.a.getTypeName(),kE.uXb).then(()=>{this.Z3.getAugLoopRuntimeManager().submitOperation(Object.assign(new $r.a,{operation:b}))}).catch(h=>{this.eg.sendTraceTag(528274527,2250,10,"Activating GoalsAnnotation threw exception.",h)})}}kE.uXb="GoalSelected";Object(n.a)(kE,"GoalsSignalSender",null,[358]);class $A{constructor(){$A.eMe=
new RegExp($A.JZj)}h$f(b){return!!b.match($A.eMe)&&1===b.match($A.eMe).length}}$A.JZj="[0-9]+[.]?[0-9]*";$A.eMe=null;Object(n.a)($A,"GoalsValidator",null,[357]);class nF{constructor(){this.W=null}get name(){return"WordEditor.Goals"}init(){this.W.resolve("WordEditor.Goals.GoalsAnnotationHandler")}dispose(){}yc(b){this.W=b;this.W.ha("WordEditor.Goals.GoalsValidator",()=>new $A).as("WordEditor.Goals.IGoalsValidator").singleInstance();this.W.ha("WordEditor.Goals.IGoalsGate",()=>new FG(this.W.resolve("Common.IAppSettingsManager"))).singleInstance();
this.W.ha("WordEditor.Goals.GoalsProvider",()=>new IG(this.W.resolve("Common.IUlsWrapper"),this.W.resolve("WordEditor.Goals.GoalsPersistenceHandler"),this.W.resolve("WordEditor.Goals.IGoalsValidator"),this.W.resolve("WordEditor.Goals.IGoalsGate"))).as("WordEditor.Goals.IGoalReader").as("WordEditor.Goals.IGoalUpdater").singleInstance();this.W.ha("WordEditor.Goals.GoalChangeSource",()=>new DG(this.W.resolve("WordEditor.Goals.IGoalReader"),new Te.a)).as("WordEditor.Goals.IGoalChangeSource").as("WordEditor.Goals.IGoalCritiqueConfiguration").as("WordEditor.Goals.IGoalsFeatureSupport").singleInstance();
this.W.ha("WordEditor.Goals.GoalsPersistenceHandler",()=>new HG(this.W.resolve("Box4.PersistenceSettingsManager"),this.W.resolve("WordEditor.Goals.IGoalsValidator"),this.W.resolve("Common.IUlsWrapper"),this.W.resolve("WordEditor.Goals.IGoalsGate"),this.W.resolve("WordEditor.Goals.IGoalSelectedSignalSender"))).as("WordEditor.Goals.IGoalsPersistenceHandler").singleInstance();this.W.ha("WordEditor.Goals.GoalsAnnotationHandler",()=>new EG(this.W.resolve("Box4.AugmentationLoop.IAnnotationStorage"),this.W.resolve("WordEditor.Goals.IGoalCritiqueConfiguration"),
this.W.resolve("WordEditor.Goals.IGoalsGate"),this.W.resolve("Box4.AugmentationLoop.IUtilsWrapper"),this.W.resolve("Common.IUlsWrapper"),this.W.resolve("WordEditor.Goals.IGoalsFeatureSupport"))).as("WordEditor.Goals.GoalsAnnotationHandler").singleInstance();this.W.ha("WordEditor.Goals.GoalsSignalSender",()=>new kE(this.W.resolve("Box4.AugmentationLoop.IAnnotationStorage"),this.W.resolve("Box4.AugmentationLoop.IUtilsWrapper"),this.W.resolve("Box4.AugmentationLoop.IAlFactoryWrapper"),this.W.resolve("Common.IUlsWrapper"))).as("WordEditor.Goals.IGoalSelectedSignalSender").singleInstance()}static main(){O.a.instance.Oc(new nF)}}
Object(n.a)(nF,"WordEditorGoalsPackage",null,[1,2]);var oF=d(743),pF=d(447);class qF{constructor(){this.annotation=null;this.languages=new zd.a(ka.a.Rj())}}Object(n.a)(qF,"CritiqueCountWrapper",null,[]);class gA{constructor(){this.gpa=new Lc.a}$Ed(){return this.gpa}j7h(b,h,r,z){if(this.gpa.xb(r)){this.gpa.J(r).annotation.count+=h;r=this.gpa.J(r).languages;for(var R of z)r.add(R)}else R=E.a.create().toString(),b=Object.assign(new pF.a,{id:R,categoryName:b,count:h}),this.gpa.add(r,Object.assign(new qF,
{annotation:b,languages:z}))}}gA.Hi=389;Object(n.a)(gA,"BaseCritiquesByTypeCounter",null,[337]);class JG extends gA{constructor(b){super();this.Ssb=new Ka.a;this.Hle=new Ka.a;this.ypd=b}TRl(b){const h=b.annotation;if(h&&oF.a(to.a.getTypeNameFor(h.content))){const r=h.content;if(b.opType===ip.a.getTypeName()){this.ypd.grn(h.parentPath,r);b=r.M_.state;if(60!==b&&70!==b)return this.Ssb.contains(h.id)&&this.Ssb.remove(h.id),this.K0l(h.id,r),!0;this.Ssb.add(h.id)}else if(b.opType===cj.a.getTypeName())if(this.Ssb.contains(h.id))this.Ssb.remove(h.id);
else return this.Ywh(r.typeId,h.id)}return!1}SRl(b){if((b=b.annotation)&&oF.a(to.a.getTypeNameFor(b.content))){const h=b.content,r=h.M_.state;if((60===r||70===r)&&!this.Ssb.contains(b.id))return this.Ssb.add(b.id),this.Ywh(h.typeId,b.id)}return!1}K0l(b,h){this.Hle.add(b);b=new zd.a(ka.a.Rj());h.language&&b.add(h.language);this.j7h(h.categoryName,1,h.typeId,b)}Ywh(b,h){if(!this.Hle.contains(h))return!1;if(!this.gpa.xb(b))return v.ULS.sendTraceTag(589866503,gA.Hi,15,"Unable to decrement the count for critique category {0}. Reason : {1}",
b,"Category not found in CritiqueCountsByCategory dictionary"),!1;if(0>=this.gpa.J(b).annotation.count)return v.ULS.sendTraceTag(589866504,gA.Hi,15,"Unable to decrement the count for critique category {0}. Reason : {1}",b,"Current count is less than or equal to 0"),!1;this.Hle.remove(h);this.gpa.J(b).annotation.count--;return!0}}Object(n.a)(JG,"AlCritiquesByTypeCounter",gA,[342,337]);var qL=d(974);class KG extends Rr.a{constructor(b,h,r,z,R,ba,ta,Wa,ub){var Ib;super();this.Jf=b;this.ypd=h;this.xhe=
r;this.ABg=z;this.dHa=R;this.uqa=ba;this.Ih=ta;this.x8=this.Vzg=!1;this.tAe=new Lc.a;this.XRm=($b,fc)=>{this.ypd.RSl(fc)&&(this.x8=!0,this.tX())};this.YOm=($b,fc)=>{this.xhe.TRl(fc)&&this.oJb()};this.Qwi=()=>{this.oJb()};this.jFf=($b,fc)=>{this.xhe.SRl(fc)&&this.oJb()};this.fib=()=>{this.oJb()};this.oJb=()=>{let $b=!1;this.Ih.Pd(()=>{var fc=this.dol();const Kc=new Ua.a;for(let ed of fc)fc=Object.assign(new qL.a,{id:ed.id,parentPath:pk.a.qyb,content:ed,annotationType:to.a.getTypeNameFor(ed)}),Kc.add(fc),
$b||($b=0<ed.count);this.Jf.zIn(Kc)},"CC:SATH");!this.Vzg&&$b&&(Y.a.sendTelemetryEvent(Object.assign(Object.assign({},new da.a),{name:"Office.Word.Online.Editor.CritiquesAvailable"})),this.Vzg=!0)};this.Pam=($b,fc,Kc)=>{const ed=!this.dHa||this.dHa.Rpf($b,Kc);$b=this.uqa&&this.uqa.instance?this.uqa.instance.Qpf($b,Kc,fc.substr(1,fc.length-2)):!0;return ed&&$b};null===Wa||void 0===Wa?void 0:Wa.ePe(this.fib);ub.Rna(this,7);null===(Ib=this.uqa)||void 0===Ib?void 0:Ib.execute($b=>{$b.yPe(this.oJb)})}get index(){return 3}run(){this.x8&&
(this.oJb(),this.x8=!1)}mzi(){this.oJb()}XGk(b){let h=0;if(({value:h}=this.tAe.Dc(b.categoryName,0)).returnValue)if(h!==b.count)this.tAe.Z(b.categoryName,b.count);else return!1;else this.tAe.add(b.categoryName,b.count);return!0}dol(){const b=new Lc.a;var h=this.ypd.$Ed();const r=this.xhe.$Ed();this.e8f(b,h);this.e8f(b,r);this.ABg&&(h=this.ABg.$Ed(),this.e8f(b,h));h=new Ua.a;for(let z of b.values)this.XGk(z)&&h.add(z);return h}e8f(b,h){for(let R of h){h=R.value.annotation;const ba=R.key;var r=this.DGn(R.value.languages);
if(!b.xb(h.categoryName)){var z=E.a.create().toString();z=Object.assign(new pF.a,{id:z,categoryName:h.categoryName,count:0,countsByTypeId:{}});b.add(h.categoryName,z)}this.Pam(ba,r,h.categoryName)&&(r=b.J(h.categoryName),r.count+=h.count,r.countsByTypeId[ba]=(r.countsByTypeId[ba]?r.countsByTypeId[ba]:0)+h.count)}}DGn(b){const h=[];let r=0;for(let z of b)h[r++]=z;return y.c(h)}}Object(n.a)(KG,"CritiquesCounter",Rr.a,[339,340]);class LG{constructor(b){this.rY=b}$Ed(){const b=new Lc.a,h=new zd.a(ka.a.Rj()),
r=Object.assign(new pF.a,{id:"a8f8d183-1cc4-4f3c-8483-23ae2e6d092b",categoryName:"Did you say?",count:this.rY.nlc.count});b.add("33ab9b0e-2399-4300-a09f-ec2dbfcbf96e",Object.assign(new qF,{annotation:r,languages:h}));return b}}Object(n.a)(LG,"DictationCritiquesByTypeCounter",null,[338,337]);class MG extends gA{constructor(b){super();this.J5a=new Lc.a;this.Jf=b}RSl(b){const h=pk.a.rHd(b.nodeId);if(!pk.a.mf(h)){if(b.vcb&&b.vcb.length){let r=null;for(let z of b.vcb)z.errorDetails.q_a()||(b=this.ZOh(z),
pk.a.mf(b)||(r||(r=new Lc.a),r.xb(b)||r.add(b,new Ua.a),r.J(b).add(z)));this.Zwh(h);r?this.tMn(h,r):this.J5a.remove(h)}else{if(!this.J5a.xb(h))return!1;this.Zwh(h);this.J5a.remove(h)}return!0}return!1}grn(b,h){var r;if(({value:r}=this.J5a.Dc(b,r)).returnValue)for(let R of r)if(b=R.value,0<b.count&&this.Rcf(b.J(0))===h.categoryName)for(r=b.count-1;0<=r;r--){var z=b.J(r).end-b.J(r).begin;b.J(r).begin===h.range.start&&z===h.range.length&&(z=this.ZOh(b.J(r)),this.gpa.xb(z)&&(z=this.gpa.J(z).annotation,
z.count=Math.max(0,z.count-1)),b.removeAt(r))}}Zwh(b){if(this.J5a.xb(b))for(let r of this.J5a.J(b)){var h=r.key;b=r.value;this.gpa.xb(h)&&(h=this.gpa.J(h).annotation,h.count=Math.max(0,h.count-b.count))}}tMn(b,h){const r=new Lc.a,z=new Lc.a;for(let R of h){h=R.key;z.add(h,new zd.a(ka.a.Rj()));for(let ba of R.value){const ta=ba.end-ba.begin,Wa=this.Rcf(ba);this.Rtk(b,Wa,ba.begin,ta)?v.ULS.sendTraceTag(589866513,gA.Hi,50,"Canvas annotation category {0} for parent path {1} in range (start {2},length {3}) already received from AL. Skipping this",
h,b,ba.begin,ta):(r.xb(h)||r.add(h,new Ua.a),r.J(h).add(ba),z.J(h).add(this.fol(ba)))}}this.J5a.Z(b,r);for(let R of this.J5a.J(b))0<R.value.count&&(b=this.Rcf(R.value.J(0)),this.j7h(b,R.value.count,R.key,z.J(R.key)))}ZOh(b){let h=null;b&&(b=Object(la.a)(335,b.errorDetails))&&b.Us&&(h=b.Us.TypeId);return h}Rcf(b){let h=null;b&&(b=Object(la.a)(335,b.errorDetails))&&b.Us&&(h=b.Us.CategoryTitle);return h}fol(b){let h="";b&&b.errorDetails&&(h=Sj.a.pg(b.errorDetails.lcid).name);return h}Rtk(b,h,r,z){if((b=
this.Jf.dMh(b))&&0<b.count)for(let R of b)if(b=to.a.getTypeNameFor(R.content),R&&oF.a(b)&&(b=R.content,b.categoryName===h&&b.range.start===r&&b.range.length===z))return!0;return!1}}Object(n.a)(MG,"WacCritiquesByTypeCounter",gA,[336,337]);class rF{constructor(){this.W=null}get name(){return"WordEditor.CritiqueCounts"}yc(b){this.W=b}init(){var b=this.W.resolve("Common.IAppSettingsManager");if(b.$("AugLoopOperationsAreEnabled")){this.W.ha("WordEditor.CritiqueCounts.IWacCritiquesByTypeCounter",()=>new MG(this.W.resolve("Box4.AugmentationLoop.IAnnotationStorage"))).singleInstance();
this.W.ha("WordEditor.CritiqueCounts.IAlCritiquesByTypeCounter",()=>new JG(this.W.resolve("WordEditor.CritiqueCounts.IWacCritiquesByTypeCounter"),this.W.resolve("Common.IAppSettingsManager"))).singleInstance();var h=b.$("DictationCorrectionsInEditorPaneIsEnabled");h&&this.W.ha("WordEditor.CritiqueCounts.IDictationCritiquesByTypeCounter",()=>new LG(this.W.resolve("Box4.DictationCorrections.IDictationCorrectionManager"))).singleInstance();this.W.ha("WordEditor.CritiqueCounts.ICritiquesCounter",()=>
new KG(this.W.resolve("Box4.AugmentationLoop.IAnnotationStorage"),this.W.resolve("WordEditor.CritiqueCounts.IWacCritiquesByTypeCounter"),this.W.resolve("WordEditor.CritiqueCounts.IAlCritiquesByTypeCounter"),this.W.Pa("WordEditor.CritiqueCounts.IDictationCritiquesByTypeCounter"),this.W.Pa("WordEditor.Goals.IGoalCritiqueConfiguration"),this.W.Za("WordEditor.EditorUpsell.IPremiumPreviewCritiquesFilter"),Cp.a.instance,this.W.Pa("WordEditor.Goals.IGoalChangeSource"),this.W.resolve("Box4.Graph.IGraphTransactionManager"))).singleInstance();
b=this.W.resolve("WordEditor.CritiqueCounts.ICritiquesCounter");this.W.resolve("Box4.Proofing.IErrorRangeEditor").v$g(b.XRm);this.W.resolve("Box4.AugmentationLoop.IAnnotationStorage").a7j(b.YOm);this.W.resolve("Box4.AugmentationLoop.IAnnotationStorage").i$g(b.jFf);h&&(h=this.W.resolve("Box4.DictationCorrections.IDictationCorrectionRangeEditor"),h.R9g(b.Qwi),h.S9g(b.Qwi))}}dispose(){}static main(){O.a.instance.Oc(new rF)}}Object(n.a)(rF,"WordEditorCritiqueCountsPackage",null,[1,2]);class sF{get name(){return"WordEditor.GraphicsEditor"}yc(){}init(){}dispose(){}static main(){O.a.instance.Oc(new sF)}}
Object(n.a)(sF,"PackageManager",null,[1,2]);var rL=window.PasteFloatieData={name:"CommandUI",attrs:{xmlns:"http://schemas.microsoft.com/sharepoint/"},children:[{name:"Floatie",attrs:{Id:"WordEditor.PasteFloatie",ImageDownArrow:"IMGMAP@we@SplitButtonArrow_5x3x32",ImageDownArrow8by8:"IMGMAP@we@SplitButtonArrow_8x8x32",TextDirection:"STR@L_RibbonOptionTextDirection"},children:[{name:"Groups",attrs:{},children:[{name:"Group",attrs:{Id:"PasteOptionsGroup"},children:[{name:"Section",attrs:{},children:[{name:"Row",
attrs:{},children:[{name:"Controls",attrs:{},children:[{name:"FlyoutAnchor",attrs:{Id:"PasteFloatie.FlyoutAnchor",LabelText:"(Ctrl)",Image16by16:"IMGMAP@we@Paste_16x16x32",Alt:"STR@L_PasteOptionsWithCtrl",DisplayMode:"Medium",TemplateAlias:"Paste"},children:[{name:"Menu",attrs:{Id:"menuPasteOptions"},children:[{name:"MenuSection",attrs:{Id:"floatie.msPasteOptionsButtons",Title:"STR@L_PasteOptions",DisplayMode:"Menu16"},children:[{name:"Controls",attrs:{Id:"floatie.galleryPasteOptionsButtons"},children:[{name:"ToggleButton",
attrs:{Id:"floatie.gbPasteKeepSourceButton",Command:"0x5FA36C32",QueryCommand:"0x57455F86",Image16by16:"IMGMAP@we@PasteSourceFormatting_16x16x32",Alt:"STR@L_PasteWithSourceTheme",LabelText:"STR@L_PasteWithSourceTheme"}},{name:"ToggleButton",attrs:{Id:"floatie.gbPasteTextOnlyButton",Command:"0x8E28DB06",QueryCommand:"0x8A0031FF",Image16by16:"IMGMAP@we@PasteTextOnly_16x16x32",Alt:"STR@L_PasteTextOnly",LabelText:"STR@L_PasteTextOnly"}},{name:"ToggleButton",attrs:{Id:"floatie.gbFormatWithDesignerButton",
Command:"0x7a781ebb",QueryCommand:"0x56951cf6",Image16by16:"IMGMAP@we@StyleApplyPane_16x16x32",Alt:"STR@L_PasteFormatWithDesignerTooltipUnavailable",LabelText:"STR@L_PasteFormatWithDesigner"}},{name:"ToggleButton",attrs:{Id:"floatie.gbMatchDocumentFormattingButton",Command:"0x7a781ebb",QueryCommand:"0x56951cf6",Image16by16:"IMGMAP@we@StyleApplyPane_16x16x32",Alt:"STR@L_PasteMatchDocumentFormattingTooltipUnavailable",LabelText:"STR@L_PasteMatchDocumentFormatting"}},{name:"ToggleButton",attrs:{Id:"floatie.gbUseSmartPasteButton",
Command:"0x7a781ebb",QueryCommand:"0x56951cf6",Image16by16:"IMGMAP@we@StyleApplyPane_16x16x32",Alt:"STR@L_PasteUseSmartPasteTooltipUnavailable",LabelText:"STR@L_PasteUseSmartPaste"}}]}]}]}]}]}]}]}]}]}]}]};class NG{constructor(b){this.uCj={};this.Wb=b;this.btb=new Ub.a}MKa(b,h){const r=this.Wb.lbc,z=parseInt(b);return b&&z!==$c.ActionManager.r6e?this.btb.xb(r)?(b=this.btb.J(r).wKc(z,h,2),32===b||1===b):!1:!1}uCa(b){const h=parseInt(b),r=this.Wb.lbc;return b&&h!==$c.ActionManager.r6e?this.btb.xb(r)?
32===this.btb.J(r).wKc(h,this.uCj,1):!1:!0}wMi(b,h){this.btb.Z(b,h)}Q2i(b){b=parseInt(b);const h=this.Wb.lbc;return!!h&&!!this.btb.J(h)&&this.btb.J(h).V$l(b)}}Object(n.a)(NG,"NonCanvasCuiUser",null,[866,333]);var ez=d(1186),MB=d(62),LD;(function(b){b[b.UnspecifiedGallery=0]="UnspecifiedGallery";b[b.CharacterCodeGallery=1]="CharacterCodeGallery";b[b.FontStyleGallery=2]="FontStyleGallery";b[b.InkThicknessGallery=3]="InkThicknessGallery";b[b.IconGallery=4]="IconGallery";b[b.ListGallery=5]="ListGallery";
b[b.TableStyleGallery=6]="TableStyleGallery";b[b.PageNumberGallery=7]="PageNumberGallery";b[b.ChangeColorsGallery=8]="ChangeColorsGallery"})(LD||(LD={}));Object(n.b)("GalleryType",LD);class sv{constructor(){this.title=this.style=this.hidden=this.disabled=null}}Object(n.a)(sv,"CommonGalleryButtonProps",null,[]);class lE extends sv{constructor(){super();this.tableStyles=this.tableCellStyles=null;this.columns=0}}Object(n.a)(lE,"AdditionalTableStyleGalleryButtonProps",sv,[]);class OG extends lE{constructor(){super()}}
Object(n.a)(OG,"AdditionalChangeColorsGalleryButtonProps",lE,[]);class PG extends sv{constructor(){super();this.character=null}}Object(n.a)(PG,"AdditionalCharacterCodeGalleryButtonProps",sv,[]);class QG extends sv{constructor(){super();this.previewStyleLabel=this.styleDisplayName=null}}Object(n.a)(QG,"AdditionalFontStyleGalleryButtonProps",sv,[]);class RG{constructor(){this.selectedId=this.sections=this.hidden=this.disabled=null;this.level=this.columns=0;this.styles=null;this.galleryType="TableStyleGallery"}}
Object(n.a)(RG,"AdditionalGalleryProperties",null,[]);class SG extends sv{constructor(){super();this.largePreviewIconStyle=this.largeFullIconStyle=this.keytip=this.previewIconStyle=this.fullIconStyle=this.label=this.icon=null}}Object(n.a)(SG,"AdditionalIconButtonProperties",sv,[]);class TG extends sv{constructor(){super();this.styleDisplayName=null}}Object(n.a)(TG,"AdditionalInkThicknessGalleryButtonProps",sv,[]);class UG extends sv{constructor(){super();this.ariaLabel=this.infoAtLevel=null}}Object(n.a)(UG,
"AdditionalListGallerButtonProps",sv,[]);class VG extends sv{constructor(){super();this.text=null}}Object(n.a)(VG,"AdditionalPageNumberGalleryButtonProps",sv,[]);var AC=d(1110);const sL=(b,h)=>{var r=appChrome.selectors.getActiveControlStates();if(r=Object(la.a)(Object,r[b])){if((b=Object(la.a)(String,r.value))&&b===h)return!1;b=Object(la.a)(String,r.selectedKey);if(!h&&!b)return!1;if(b){r=Array.isArray(r.options)?r.options:null;let z=null;for(let R=0;R<r.length;R++){const ba=Object(la.a)(Object,
r[R]);if(Object(la.a)(String,ba.key)===b){z=ba;break}}if(z&&Object(la.a)(String,z.text)===h)return!1}}return!0},XG=(b,h,r,z)=>{if(0<(z&2)){z=[];switch(h){case "ToggleButtonModel":case "InkButtonModel":z.push(mE(b,r[Yf.a.On]));break;case "CheckboxModel":z.push(appChrome.actions.toggleCheckbox(b,r[Yf.a.On]));break;case "ComboBoxModel":if(t.AFrameworkApplication.K&&(t.AFrameworkApplication.K.$("ReactRibbonDispatchActionFilter")||t.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ReactRibbonDispatchActionFilter",
!1))&&!sL(b,r[Pk.a.Value]))break;(h=r[Pk.a.Key])?z.push(appChrome.actions.updateComboBoxKey(b,h,r[Pk.a.Value])):z.push(appChrome.actions.updateComboBoxValue(b,r[Pk.a.Value]));break;case "FontPickerModel":z.push(appChrome.actions.updateFontPickerSelectedFont(b,r[AC.a.SelectedFont]));break;case "SplitButtonModel":z.push(mE(b,r[be.a.On]));break;case "SpinButtonModel":z.push(appChrome.actions.updateSpinButton(b,r[Cc.a.Number],pg.a.WZb(r[Cc.a.UnitType]),r[Cc.a.Text],r[Cc.a.MaxValue],r[Cc.a.Alt]));break;
case "ColorPickerModel":z.push(appChrome.actions.updateColorPickerSelectedColor(b,r[Gl.IndexColorSelected]));break;case "PageNumberGalleryButtonModel":z.push(appChrome.actions.updatePageNumberGalleryButtonText(b,r[Fi.a.Text]));break;case "CompoundButtonModel":r[Yf.a.Description]&&z.push(appChrome.actions.updateCompoundButtonDescription(b,r[Yf.a.Description]));Yf.a.On in r&&z.push(mE(b,r[Yf.a.On]));break;case "SliderModel":r.snapToStep?z.push(appChrome.actions.updateSliderSelectedValue(b,r[bc.Value])):
z.push(appChrome.actions.updateSliderValue(b,r[bc.Value],r[bc.MinValue]||0,r[bc.MaxValue],r[bc.Text]));break;case "FlyoutAnchorModel":lh.a.ImageIsVisible in r&&z.push(appChrome.actions.hideFlyoutAnchorIcon(b,!r[lh.a.ImageIsVisible]));Yf.a.On in r&&z.push(mE(b,r[Yf.a.On]));break;case "InputBoxModel":z.push(appChrome.actions.updateInputBoxValue(b,r[Be.a.Text]))}h=z;var R=Object(la.a)(String,r[Wi.a.iconColor]);void 0!==R&&null!==R&&h.push(appChrome.actions.updateIconColor(b,R));WG(b,r,z);h=z;(R=Object(la.a)(Object,
r[Wi.a.IconSet]))&&h.push(appChrome.actions.setControlIconSet(b,R));h=z;R=Object(la.a)(String,r[Wi.a.customTooltip]);void 0!==R&&null!==R&&h.push(appChrome.actions.setControlCustomTooltip(b,R));b=z;(r=Array.isArray(r[Wi.a.MQf])?r[Wi.a.MQf]:null)&&b.push.apply(b,r);return z}return null},NB=(b,h)=>appChrome.actions.updateControlEnabledDisabledState(b,h),mE=(b,h)=>appChrome.actions.toggleButton(b,h),WG=(b,h,r)=>{h=Object(la.a)(String,h[Wi.a.Icon]);void 0!==h&&null!==h&&r.push(appChrome.actions.setControlIcon(b,
h))};class YG{constructor(b,h,r,z){this.Im=z;this.Cqa=b;this.uz=h;this.kUb=r;this.iqc={}}T5m(b,h,r,z,R=null){const ba=b.ExternalGalleryId||b.ExternalId;var ta=b.ExternalId;z.push(ba);if(appChrome.selectors.isControlDefined(ba))b.GalleryStyle&&yh.d("setGalleryStyles")&&h.push(appChrome.actions.setGalleryStyles(ba,b.GalleryStyle));else{if(4!==b.Type)return;r.push(appChrome.api.createGalleryModel(ba,Object.assign(new RG,{columns:b.Width,sections:[appChrome.api.gallerySection([],ta)],styles:b.GalleryStyle,
galleryType:"IconGallery"})))}r=0;z=!!t.AFrameworkApplication.K&&(t.AFrameworkApplication.K.$("ReactRibbonDispatchActionFilter")||t.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ReactRibbonDispatchActionFilter",!1));if(yh.d("setGallerySections")&&b.GallerySections&&0<b.GallerySections.length){ta=[];const ub=[],Ib=[],$b={};for(var Wa of b.GallerySections){ta.push(appChrome.api.gallerySection([],Wa.SectionId,Wa.Title));0===r&&Wa.GalleryButtons&&0<Wa.GalleryButtons.length&&
(r=Wa.GalleryButtons[0].Type);z&&this.OWh(Wa.GalleryButtons,R,$b);const fc=this.gOe(ub,Wa.GalleryButtons,$b);ub.push.apply(ub,this.Ogf(fc,ba,Wa.SectionId,!1,r,R,!0,$b));Ib.push.apply(Ib,fc)}h.push(appChrome.actions.setGallerySections(ba,ta));h.push.apply(h,ub);h.push.apply(h,this.qef(ba,LD[r],Ib,null,5===b.Type,!0,null,$b))}else b.GalleryItems&&0<b.GalleryItems.length&&(r=b.GalleryItems[0].Type),Wa=z?this.OWh(b.GalleryItems,R):null,h.push.apply(h,this.Ogf(this.gOe(h,b.GalleryItems,Wa),ba,ta,!1,r,
R,!1,Wa))}LEl(b,h){const r=[];let z=null,R=!1;if(!b)return null;const ba=this.Cqa.bVc(this.uz,b.commandId,h);r.push(NB(b.externalUxCommand,!ba));if(b.previewControlIds){const ub=[];for(let Ib=0;Ib<b.previewControlIds.length;Ib++){var ta={},Wa=b.previewControlIds[Ib];ta.SourceControlId=Wa;const $b=this.Im.getCommandByExternalUxId(Wa);this.AHd($b||b,ta);ta[Fi.a.On]&&(z=ta.SourceControlId,ta[Fi.a.HighlightOn]&&(R=!0));WG(Wa,ta,r);if(ta=Object(la.a)(ap.a,ta[Fi.a.GalleryButtonProps]))ub.push(ta),ba&&(Wa=
this.Cqa.bVc(this.uz,ta.Command,h),ta.IsDisabled=!Wa)}0<ub.length&&r.push.apply(r,this.Ogf(this.gOe(r,ub),b.externalUxCommand,b.externalUxCommand,!0,ub[0].Type));r.push(appChrome.actions.updateGallerySelectedId(b.externalUxCommand,z));R&&(v.ULS.sendTraceTag(561394453,340,50,"HighlightSelectedFontStyle fired for {0} button",z),r.push(appChrome.actions.highlightSelectedFontStyle(z)))}return r}gOe(b,h,r=null){const z=[],R=[];for(let ta=0;ta<h.length;ta++){const Wa=h[ta],ub=qf.b(Wa.ExternalId)?Wa.Id:
Wa.ExternalId;z.push(ub);const Ib=r&&r[ub]?r[ub].result:-1;switch(Wa.Type){case 1:var ba=Wa;R.push(appChrome.api.createCharacterCodeGalleryButtonModel(ub,Object.assign(new PG,{disabled:-1!==Ib?1>(Ib&1):ba.IsDisabled,character:ba.Character,style:ba.Style,title:ba.Alt})));break;case 2:ba=Wa;R.push(appChrome.api.createFontStylesGalleryButtonModel(ub,Object.assign(new QG,{disabled:-1!==Ib?1>(Ib&1):ba.IsDisabled,styleDisplayName:ba.LabelText,style:ba.Style,title:ba.Alt,previewStyleLabel:ba.PreviewStyleLabel})));
break;case 3:ba=Wa;R.push(appChrome.api.createInkThicknessGalleryButtonModel(ub,Object.assign(new TG,{disabled:-1!==Ib?1>(Ib&1):ba.IsDisabled,styleDisplayName:ba.LabelText,style:ba.Style,title:ba.Alt})));break;case 4:ba=Wa;R.push(appChrome.api.createIconGalleryButtonModel(ub,Object.assign(new SG,{disabled:-1!==Ib?1>(Ib&1):ba.IsDisabled,icon:[ba.Icon],fullIconStyle:ba.FullIconStyle,previewIconStyle:ba.PreviewIconStyle,largePreviewIconStyle:ba.LargePreviewIconStyle,label:ba.LabelText,title:ba.Alt})));
break;case 5:ba=Wa;R.push(appChrome.api.createListGalleryButtonModel(ub,Object.assign(new UG,{disabled:-1!==Ib?1>(Ib&1):ba.IsDisabled,infoAtLevel:ba.LevelInfo,ariaLabel:ba.Alt})));break;case 6:ba=Wa;R.push(appChrome.api.createTableStyleGalleryButtonModel(ub,Object.assign(new lE,{disabled:-1!==Ib?1>(Ib&1):ba.IsDisabled,tableCellStyles:ba.TableCellStyles,tableStyles:ba.TableStyles,title:ba.Alt,columns:ba.columns})));break;case 8:ba=Wa;R.push(appChrome.api.createChangeColorsGalleryButtonModel(ub,Object.assign(new OG,
{disabled:-1!==Ib?1>(Ib&1):ba.IsDisabled,tableCellStyles:ba.TableCellStyles,tableStyles:ba.TableStyles,title:ba.Alt})));break;case 7:ba=Wa,R.push(appChrome.api.createPageNumberGalleryButtonModel(ub,Object.assign(new VG,{disabled:-1!==Ib?1>(Ib&1):ba.IsDisabled,text:ba.Text,title:ba.Alt})))}this.Im.addCommandToMaps(Object.assign(new MB.a(ub,Wa.Command),{queryCommandId:Wa.QueryCommand,menuItemId:Wa.MenuItemId}))}b.push(appChrome.actions.addControls(R));return z}Ogf(b,h,r,z,R,ba=null,ta=!1,Wa=null){const ub=
[];z?ub.push(appChrome.actions.populateGalleryItems(h,b)):(this.iqc[h]=!1,ta||(z=!0,appChrome.selectors.isControlDefined(h)&&(z=appChrome.selectors.getGalleryState(h),z=z.disableIndividualButtons?z.disableIndividualButtons:!0),ub.push.apply(ub,this.qef(h,LD[R],b,null,5===R,z,ba,Wa))),ub.push(appChrome.actions.updateGallerySectionItems(h,r,b)));return ub}utl(b){return this.qef(b.ExternalUxId,b.galleryType,b.items,b.sections,b.isListGallery,b.disableIndividualButtons?b.disableIndividualButtons:!0)}qef(b,
h,r,z,R,ba=!0,ta=null,Wa=null){const ub=[];if(b in this.iqc){if(this.iqc[b])return delete this.iqc[b],ub;this.iqc[b]=!0}let Ib=null,$b=-1;if(r)({MKh:$b,returnValue:Ib}=this.i8g(h,r,ub,ba,ta,Wa));else if(z)for(const fc of z)(r=({MKh:$b}=this.i8g(h,fc.galleryButtons,ub,ba,null,Wa)).returnValue)&&(Ib=r);ub.push(appChrome.actions.updateGallerySelectedId(b,Ib));ba&&ub.push(NB(b,!1));R&&0<$b&&ub.push(appChrome.actions.updateListGalleryTextDirection(b,2===$b));return ub}NWh(b,h=null){const r={},z={};z.SourceControlId=
b;z.Location=h;b=this.Im.getCommandByExternalUxId(b);if(!b)return r.result=-1,r.props=z,r;b=this.AHd(b,z);r.result=b;r.props=z;return r}OWh(b,h=null,r=null){r||(r={});for(const z of b)b=qf.b(z.ExternalId)?z.Id:z.ExternalId,r[b]=this.NWh(b,h);return r}i8g(b,h,r,z,R=null,ba=null){let ta,Wa=null;ta=-1;let ub=!1;for(const $b of h){var Ib=this.qtl(b);h=ba&&ba[$b]&&-1!==ba[$b].result?ba[$b]:this.NWh($b,R);const fc=h.result;h=h.props;z&&r.push(NB($b,1>(fc&1)));(Ib=XG($b,Ib,h,fc))&&r.push.apply(r,Ib);h[Fi.a.On]&&
(Wa=$b,h[Fi.a.HighlightOn]&&h[Fi.a.HighlightOn]&&(ub=!0));void 0!==h[Wi.a.labelText]&&null!==h[Wi.a.labelText]&&(Ib=this.Im.getCommandByExternalUxId($b),r.push(appChrome.actions.setControlLabel(Ib.externalUxCommand,h[Wi.a.labelText])));h[Fi.a.IsRtl]&&0>ta&&(ta=h[Fi.a.IsRtl])}ub&&(v.ULS.sendTraceTag(561394456,340,50,"HighlightSelectedFontStyle fired for {0} button",Wa),r.push(appChrome.actions.highlightSelectedFontStyle(Wa)));return{returnValue:Wa,MKh:ta}}qtl(b){switch(b){case "CharacterCodeGallery":return"CharacterCodeGalleryButtonModel";
case "FontStyleGallery":return"FontStyleGalleryButtonModel";case "InkThicknessGallery":return"InkThicknessGalleryButtonModel";case "IconGallery":return"IconGalleryButtonModel";case "ListGallery":return"ListGalleryButtonModel";case "TableStyleGallery":return"TableStyleGalleryButtonModel";case "ChangeColorsGallery":return"ChangeColorsGalleryButtonModel";case "PageNumberGallery":return"PageNumberGalleryButtonModel"}return"None"}AHd(b,h){h.MenuItemId=b.menuItemId;return this.Cqa.ona(this.uz,this.kUb,
b.commandId,b.queryCommandId,h)}}Object(n.a)(YG,"ReactGalleryPoller",null,[]);var tL=d(828),ZG=d(662);class $G{constructor(){this.initialPinnedFontKeys=this.mruList=this.fonts=this.commandId=null;this.isSubscriber=!1;this.previewFontFamily=null}}Object(n.a)($G,"PopulateFontPickerDataProps",null,[]);var aH=d(302),fz=d(1798);class bH extends lu{constructor(){super();this.ariaDescription=this.lang=this.roleInMenu=this.styles=this.commandValueId=null}}Object(n.a)(bH,"OptionalCompoundButtonProperties",
lu,[]);class cH extends lu{constructor(){super();this.menuModel=null;this.hideLabel=!1;this.downChevronIcon=null;this.hideIcon=this.hideChevron=!1;this.labelInMenu=this.lang=null;this.toggled=!1;this.roleInMenu=null}}Object(n.a)(cH,"OptionalFlyoutAnchorProperties",lu,[]);class dH extends Ur{constructor(){super();this.styles=this.secondaryText=null;this.flipIconInRtl=!1}}Object(n.a)(dH,"OptionalPersonaButtonProperties",Ur,[]);class nE extends lu{constructor(){super();this.toggled=!1;this.roleInMenu=
null;this.toggleUsingIcon=!1}}Object(n.a)(nE,"OptionalToggleButtonProperties",lu,[]);var uL=d(1647),vL=d(1646),wL=d(506);class eH{constructor(){this.Ioh=this.actions=null;this.llj=!1}}Object(n.a)(eH,"PopulateActions",null,[]);class tF{AZh(b,h){switch(h){case "ColorPickerModel":return appChrome.selectors.getColorPickerState(b);case "ToggleButtonModel":return this.zFl(b);case "InkButtonModel":return this.yFl(b);case "GalleryModel":return appChrome.selectors.getGalleryState(b);case "SplitButtonModel":return appChrome.selectors.getSplitButtonState(b);
case "SliderModel":return appChrome.selectors.getSliderState(b)}return{}}zFl(b){const h={};h[Yf.a.On]=appChrome.selectors.getButtonToggleState(b);return h}yFl(b){const h={};h[Yf.a.On]=yh.i("getInkButtonToggleState")?appChrome.selectors.getInkButtonToggleState(b):appChrome.selectors.getButtonToggleState(b);return h}}Object(n.a)(tF,"ReactStatePropsSelector",null,[]);class oE{constructor(b,h,r,z,R){this.Cqa=b;this.uz=h;this.kUb=r;this.Im=z;this.LIe={};this.PRj=new tF;this.Msb=R}i6i(b){const h=b.populationProps.populateQueryCommandId;
return b.populationProps.populateOnlyOnce&&h in this.LIe}XFl(b,h,r=null){const z=[],R={};if(!this.i6i(b)){const ba=b.populationProps.populateQueryCommandId,ta={};ta.MenuId=b.externalUxCommand;ta.IsShadowMenuOpen=this.isShadowMenuOpen(r);if(0<(this.Cqa.ona(this.uz,this.kUb,ba,ba,ta,this.Xvl(r))&1))if("FontPickerModel"===h)this.LIe[ba]=!0,z.push(oE.qEl(b,ta)),R[b.externalUxCommand]="FontPickerModel";else if(ta.MenuItems)switch(this.LIe[ba]=!0,h){case "ComboBoxModel":z.push(oE.oEl(b,ta));R[b.externalUxCommand]=
"ComboBoxModel";break;case "FlyoutAnchorModel":case "InkFlyoutAnchorModel":case "PreviewGalleryModel":case "SplitButtonModel":case "StatefulSplitButtonModel":z.push.apply(z,this.F0h(b.externalUxCommand,h,ta.MenuItems,R,r&&"location"in r?r.location:null))}}return Object.assign(new eH,{actions:z,Ioh:R,llj:this.isShadowMenuOpen(r)})}F0h(b,h,r,z,R=null){const ba=[],ta=[],Wa=[],ub=[];for(let Ib=0;Ib<r.MenuSectionList.length;Ib++){const $b=Object(la.a)(hi.a,r.MenuSectionList[Ib]);if(!$b)continue;let fc=
null;const Kc=[];qf.c($b.Title)||(fc=$b.Title);for(let ed=0;ed<$b.ControlList.length;ed++){const Jd=Object(la.a)(fk.a,$b.ControlList[ed]);if(!Jd||Jd.ExternalId)z&&this.aml(Jd,z),ba.push.apply(ba,this.pEl(Jd,ta,Kc,ub,b,h,R))}r.UpdateDynamically&&Wa.push(appChrome.api.menuSection(Kc,fc,$b.Lang))}r.UpdateDynamically&&ba.push(appChrome.actions.updateMenu(b,Wa,r.Title,r.AriaLabel,r.ShouldAutoOpen,r.AriaRoleDescription,r.MenuTargetDescriptor));0<ta.length&&ba.splice(0,0,appChrome.actions.addControls(ta));
0<ub.length&&yh.d("setStatefulSplitButtonMruBypassControls")&&ba.push(appChrome.actions.setStatefulSplitButtonMruBypassControls(b,ub));return ba}aml(b,h){switch(b.ControlType){case 1:case 3:h[b.ExternalId]=1===b.ControlType?"ButtonModel":"CompoundButtonModel";break;case 2:h[b.ExternalId]="ToggleButtonModel";break;case 6:h[b.ExternalId]="CheckboxModel";break;case 7:h[b.ExternalId]="ColorPickerModel";b=Object(la.a)(Fz.a,b);b.McuLayout&&(h[b.McuExternalId]="ColorPickerModel");break;case 9:h[b.ExternalId]=
"FlyoutAnchorModel"}}pEl(b,h,r,z,R,ba,ta=null){const Wa=[];switch(b.ControlType){case 1:case 3:z=Object(la.a)(nh.a,b);this.D5m(z,Wa,h,r);z.MenuItemsStatefulData&&yh.d("setStatefulSplitButtonMenuItemsStatefulData")&&Wa.push(appChrome.actions.setStatefulSplitButtonMenuItemsStatefulData(R,z.MenuItemsStatefulData));break;case 2:this.j6m(Object(la.a)(wL.a,b),Wa,h,r);break;case 6:this.F5m(Object(la.a)(gC.a,b),Wa,h,r);break;case 4:this.c6m(Object(la.a)(Da,b),Wa,h,r);break;case 7:this.H5m(Object(la.a)(Fz.a,
b),Wa,h,r);break;case 9:R=Object(la.a)(mi.a,b);this.P5m(R,Wa,h,r);"StatefulSplitButtonModel"===ba&&z.push(R.ExternalId);break;case 8:this.Msb.T5m(Object(la.a)(lo.a,b),Wa,h,r,ta)}return Wa}D5m(b,h,r,z){z.push(b.ExternalId);appChrome.selectors.isControlDefined(b.ExternalId)?(b.LabelText&&h.push(appChrome.actions.setControlLabel(b.ExternalId,b.LabelText)),b.Description&&h.push(appChrome.actions.updateCompoundButtonDescription(b.ExternalId,b.Description)),b.CommandValueId&&h.push(appChrome.actions.setButtonCommandValueId(b.ExternalId,
b.CommandValueId)),this.Crd()&&((r=this.zLa(b))&&0<r.length&&h.push(appChrome.actions.setControlIconSet(b.ExternalId,(new fz.a(r)).iconSet)),b.LabelText!==b.Alt&&h.push(appChrome.actions.setControlCustomTooltip(b.ExternalId,b.Alt)))):(b.Description||Object(nb.a)(fx,b)?r.push(appChrome.api.createCompoundButtonModel(b.ExternalId,b.LabelText,b.Description,Object.assign(new bH,{iconSet:(new fz.a(this.zLa(b))).iconSet,keytip:b.KeyTip,roleInMenu:b.RoleInMenu,ariaDescription:b.AriaDescription,customTooltip:b.LabelText!==
b.Alt?b.Alt:null}))):r.push(appChrome.api.createButtonModel(b.ExternalId,b.LabelText,Object.assign(new Ur,{iconSet:(new fz.a(this.zLa(b))).iconSet,keytip:b.KeyTip,supportsPreview:!!b.CommandPreviewId&&!!b.CommandRevertId,customTooltip:b.LabelText!==b.Alt?b.Alt:null,commandValueId:b.CommandValueId,shouldTakeFocus:b.ShouldTakeFocus}))),this.Im.addCommandToMaps(Object.assign(new MB.a(b.ExternalId,b.Command),{menuItemId:b.MenuItemId,queryCommandId:b.QueryCommand,commandPreviewId:b.CommandPreviewId,commandRevertId:b.CommandRevertId})));
b.Lang&&yh.d("setControlLanguage")&&h.push(appChrome.actions.setControlLanguage(b.ExternalId,b.Lang))}F5m(b,h,r,z){z.push(b.ExternalId);appChrome.selectors.isControlDefined(b.ExternalId)?(b.LabelText&&h.push(appChrome.actions.setControlLabel(b.ExternalId,b.LabelText)),this.Crd()&&((r=this.zLa(b))&&0<r.length&&h.push(appChrome.actions.setControlIconSet(b.ExternalId,(new fz.a(r)).iconSet)),b.IsChecked&&h.push(appChrome.actions.toggleButton(b.ExternalId,b.IsChecked)),b.LabelText!==b.Alt&&h.push(appChrome.actions.setControlCustomTooltip(b.ExternalId,
b.Alt)))):(r.push(appChrome.api.createToggleButtonModel(b.ExternalId,b.LabelText,Object.assign(new nE,{iconSet:(new fz.a(this.zLa(b))).iconSet,keytip:b.KeyTip,toggled:b.IsChecked,fullDescriptionLabel:b.Description,roleInMenu:b.AriaLabel,customTooltip:b.LabelText!==b.Alt?b.Alt:null,toggleUsingIcon:!!b.CheckedImageClass}))),this.Im.addCommandToMaps(Object.assign(new MB.a(b.ExternalId,b.Command),{menuItemId:b.MenuItemId,queryCommandId:b.QueryCommand})))}j6m(b,h,r,z){z.push(b.ExternalId);appChrome.selectors.isControlDefined(b.ExternalId)?
(b.LabelText&&h.push(appChrome.actions.setControlLabel(b.ExternalId,b.LabelText)),this.Crd()&&((r=this.zLa(b))&&0<r.length&&h.push(appChrome.actions.setControlIconSet(b.ExternalId,(new fz.a(r)).iconSet)),t.AFrameworkApplication.K.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.ToggleButtonTooltip")&&b.LabelText!==b.Alt&&h.push(appChrome.actions.setControlCustomTooltip(b.ExternalId,b.Alt)))):(t.AFrameworkApplication.K.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.ToggleButtonTooltip")?
r.push(appChrome.api.createToggleButtonModel(b.ExternalId,b.LabelText,Object.assign(new nE,{iconSet:(new fz.a(this.zLa(b))).iconSet,iconColor:b.IconColor,keytip:b.KeyTip,fullDescriptionLabel:b.Description,roleInMenu:b.AriaLabel,customTooltip:b.LabelText!==b.Alt?b.Alt:null}))):r.push(appChrome.api.createToggleButtonModel(b.ExternalId,b.LabelText,Object.assign(new nE,{iconSet:(new fz.a(this.zLa(b))).iconSet,iconColor:b.IconColor,keytip:b.KeyTip,fullDescriptionLabel:b.Description,roleInMenu:b.AriaLabel}))),
this.Im.addCommandToMaps(Object.assign(new MB.a(b.ExternalId,b.Command),{menuItemId:b.MenuItemId,queryCommandId:b.QueryCommand})))}c6m(b,h,r,z){z.push(b.ExternalId);z=this.XDl(b);appChrome.selectors.isControlDefined(b.ExternalId)?b.LabelText&&h.push(appChrome.actions.setPersonaButtonCoauthor(b.ExternalId,z,b.LabelText)):yh.a("createPersonaButtonModel")&&r.push(appChrome.api.createPersonaButtonModel(b.ExternalId,z,b.LabelText,Object.assign(new dH,{role:b.RoleInMenu,fullDescriptionLabel:b.AriaDescription,
iconSet:{["default"]:"doughboywhiteglyph_20"}})))}P5m(b,h,r,z){z.push(b.ExternalId);if(appChrome.selectors.isControlDefined(b.ExternalId))b.LabelText&&h.push(appChrome.actions.setControlLabel(b.ExternalId,b.LabelText)),this.Crd()&&((r=this.zLa(b))&&0<r.length&&h.push(appChrome.actions.setControlIconSet(b.ExternalId,(new fz.a(r)).iconSet)),void 0!==b.ImageIsVisible&&null!==b.ImageIsVisible&&h.push(appChrome.actions.hideFlyoutAnchorIcon(b.ExternalId,!b.ImageIsVisible)),void 0!==b.Toggled&&null!==b.Toggled&&
h.push(appChrome.actions.toggleButton(b.ExternalId,b.Toggled)));else{z=!(void 0===b.ImageIsVisible||null===b.ImageIsVisible)&&!b.ImageIsVisible;const R=!(void 0===b.Toggled||null===b.Toggled)&&b.Toggled;r.push(appChrome.api.createFlyoutAnchorModel(b.ExternalId,b.LabelText,Object.assign(new cH,{iconSet:(new fz.a(this.zLa(b))).iconSet,keytip:b.KeyTip,hideIcon:z,toggled:R,roleInMenu:b.AriaLabel})));this.Im.addCommandToMaps(Object.assign(new MB.a(b.ExternalId,b.Command),{queryCommandId:b.QueryCommand,
populationProps:new tL.a(b.PopulateQueryCommand,b.PopulateOnlyOnce)}))}b.Menu&&h.push.apply(h,this.F0h(b.ExternalId,"FlyoutAnchorModel",b.Menu,null));b.Lang&&h.push(appChrome.actions.setControlLanguage(b.ExternalId,b.Lang))}H5m(b,h,r,z){b.McuLayout&&z.push(b.McuExternalId);z.push(b.ExternalId);z=0;appChrome.selectors.isControlDefined(b.ExternalId)?b.McuLayout&&(z=this.PRj.AZh(b.ExternalId,"ColorPickerModel").columnCount):(b.McuLayout&&(r.push(appChrome.api.createColorPickerModel(b.McuExternalId,b.Width)),
this.Im.addCommandToMaps(Object.assign(new MB.a(b.McuExternalId,b.Command),{commandPreviewId:b.CommandPreviewId,commandRevertId:b.CommandRevertId})),z=b.Width),r.push(appChrome.api.createColorPickerModel(b.ExternalId,b.Width)),this.Im.addCommandToMaps(Object.assign(new MB.a(b.ExternalId,b.Command),{commandPreviewId:b.CommandPreviewId,commandRevertId:b.CommandRevertId})));r=[];const R=[];for(let ba=0;ba<b.Colors.length;ba++){const ta=b.Colors[ba];ba<z?r.push(appChrome.api.colorPickerCell(ta.Color,
ta.DisplayColor,ta.Alt)):R.push(appChrome.api.colorPickerCell(ta.Color,ta.DisplayColor,ta.Alt))}0<r.length&&h.push(appChrome.actions.populateColorPickerCells(b.McuExternalId,r));h.push(appChrome.actions.populateColorPickerCells(b.ExternalId,R));b.SelectedColorId&&(0<r.length&&h.push(appChrome.actions.updateColorPickerSelectedColor(b.McuExternalId,b.SelectedColorId)),h.push(appChrome.actions.updateColorPickerSelectedColor(b.ExternalId,b.SelectedColorId)))}zLa(b){return b.Image32by32Class?this.Im.qQh(b.Image32by32Class):
b.Image16by16Class?this.Im.qQh(b.Image16by16Class):b.ExternalImageId}XDl(b){return b?Object.assign(new vL.a,{displayName:b.DisplayName,personaCoinColor:b.ImageBackColor,isUnauthenticatedSender:b.IsAnonymous,identifiers:Object.assign(new uL.a,{PersonaType:"User",Smtp:b.PersonaId})}):null}Xvl(b){let h=2;b&&"inputMethod"in b&&b.inputMethod&&(h=b.inputMethod);return h}isShadowMenuOpen(b){return!!b&&b.isShadowRendering}Crd(){return t.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AllowFullPropPopulation",
!1)}static qEl(b,h){return appChrome.actions.populateFontPickerDataAsync(new Promise((r,z)=>{Sa.a.instance.Za("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(R=>{R.isFeatureEnabled(aH.a.CEb,!1).then(ba=>{let ta=h.fonts;ba||R.isFreemiumUpsellEnabled()||(ta=Kh.a.T$f(ta,Wa=>Wa.fontType!==aH.a.vMf));ba=Object.assign(new $G,{commandId:b.externalUxCommand,fonts:ta,isSubscriber:ba,mruList:h.mruList,initialPinnedFontKeys:h.initialPinnedFontKeys,previewFontFamily:"msofp_hier_MSFontService"});
r(ba)}).catch(z)})}))}static oEl(b,h){const r=[];for(let z=0;z<h.MenuItems.MenuSectionList.length;z++){const R=h.MenuItems.MenuSectionList[z];R.Title&&r.push(appChrome.api.comboBoxHeader("Header-"+z.toString(),R.Title));for(let ba=0;ba<R.ControlList.length;ba++){const ta=Object(la.a)(ZG.a,R.ControlList[ba]);ta&&r.push(appChrome.api.comboBoxItem(ta.MenuItemId,ta.LabelText,ta.Styles,ta.CommandValueId,ta.AriaLabel,ta.Data,ta.Disabled))}z<h.MenuItems.MenuSectionList.length-1&&r.push(appChrome.api.comboBoxDivider("Divider-"+
z.toString()))}return appChrome.actions.populateComboBoxOptions(b.externalUxCommand,r)}}Object(n.a)(oE,"ReactPopulateQueryCommandPoller",null,[]);class fH{constructor(b,h,r,z,R){this.Im=r;this.Cqa=b;this.uz=h;this.kUb=z;this.Msb=R}WFl(b,h,r){const z=[];if(this.lam(h))b=this.TJl(b,h,r),void 0!==b&&null!==b&&z.push.apply(z,b);else if(b){var R=this.AHd(b,r);Wi.a.visible in r&&z.push(appChrome.actions.updateControlHiddenState(b.externalUxCommand,!r[Wi.a.visible]));z.push(NB(b.externalUxCommand,1>(R&1)));
void 0!==r[Wi.a.labelText]&&null!==r[Wi.a.labelText]&&z.push(appChrome.actions.setControlLabel(b.externalUxCommand,r[Wi.a.labelText]));void 0!==h&&null!==h&&(R=XG(b.externalUxCommand,h,r,R),void 0!==R&&null!==R&&z.push.apply(z,R),"PeopleWell"===h&&this.Z3j(b.externalUxCommand,r,z))}return z}Rql(b,h,r){const z=[];switch(h){case "FlyoutAnchorModel":var R=appChrome.selectors.getFlyoutAnchorMenuItems(b);break;case "SplitButtonModel":var ba=appChrome.selectors.getSplitButtonState(b);if(ba=this.Im.getCommandByExternalUxId(ba.command))r=
this.Cqa.bVc(this.uz,ba.commandId,r),z.push(appChrome.actions.updateSplitButtonPrimaryDisabledState(b,!r)),z.push(NB(b,!1));return z;default:return null}h=!1;for(ba in R)if(R=this.Im.getCommandByExternalUxId(ba),qf.c(R))h=!0;else if(r.SourceControlId=R.externalUxCommand,this.Cqa.bVc(this.uz,R.commandId,r))return z.push(NB(b,!1)),z;z.push(NB(b,!h));return z}TJl(b,h,r){switch(h){case "PreviewGalleryModel":return this.Msb.LEl(b,r);case "GalleryModel":return this.Msb.utl(r)}return null}lam(b){return"GalleryModel"===
b||"PreviewGalleryModel"===b}AHd(b,h){h.MenuItemId=b.menuItemId;return this.Cqa.ona(this.uz,this.kUb,b.commandId,b.queryCommandId,h)}Z3j(b,h,r){const z=h[lh.a.LabelTextUserGeneratedPlaceholderReplacements];h=h[lh.a.LabelText];z&&0<z.length&&(h=String.format.apply(null,[h].concat(z)));r.push(this.YNl(b,h))}YNl(b,h){return appChrome.actions.updatePeopleWell(this.Oll(b),h)}Oll(b){const h=[];var r={};b=this.Im.getCommandByExternalUxId(b).populationProps.populateQueryCommandId;this.Cqa.ona(this.uz,this.kUb,
"1285265560",b,r);r=r.MenuItems;if(!r)return h;r=r.MenuSectionList[0];for(b=0;b<r.ControlList.length;b++){const z=r.ControlList[b],R={};R.name=z.Alt;R.id=z.MenuItemId;R.description=z.Description;R.color=z.ImageBackColor;R.joinTime=z.JoinTimeInMS;R.imageUrl=z.ImageUrl;R.activeStatus=z.ActiveStatus;R.isAnonymous=z.IsAnonymous;R.canJump=z.CanJump;R.upn=z.Upn;h.push(R)}return h}}Object(n.a)(fH,"ReactQueryCommandPoller",null,[]);var xL=d(1097);class gH{constructor(b,h,r){this.Im=b;this.uz=h;b=new xL.a;
this.jWj=new tF;this.Msb=new YG(b,this.uz,r,this.Im);this.jXg=new oE(b,this.uz,r,this.Im,this.Msb);this.$Wg=new fH(b,this.uz,this.Im,r,this.Msb)}jBa(){const b=[];if(!yh.c())return b;b.push.apply(b,this.WNl());var h=this.Vpl();if(0<h.length)b.push.apply(b,h);else if(h=appChrome.selectors.getActiveControlIds(),Object.keys(h).length){const r=this.Wpl();for(const z of r)b.push(appChrome.actions.updateControlEnabledDisabledState(z,!0)),delete h[z];b.push.apply(b,this.QId(h))}return b}cVc(b,h){yh.c()&&
(b=this.QId(b,h),appChrome.api.dispatch(b))}QLf(b,h,r=null){if(!qf.c(b)&&b.populationProps&&!this.jXg.i6i(b)){b=this.jXg.XFl(b,h,r);if(!b.llj){let z;(z=b.actions).push.apply(z,this.QId(b.Ioh,yh.g(r)))}if(0<b.actions.length)return appChrome.api.dispatch(b.actions),!0}return!1}QId(b,h=0){const r=[],z={};if(yh.a("isSharedUxGateEnabled")&&appChrome.api.isSharedUxGateEnabled("SharedOnline.ChangeGate.DefaultRibbinUILocationPolling")&&""!==appChrome.selectors.getSelectedTabId())for(var R of appChrome.selectors.getActiveGroupIds())for(var ba of appChrome.selectors.getVisibleControlsInGroup(R))z[ba]=
!0;for(let ta in b)R=ta,ba=b[ta],0===h&&z[R]&&(h=2),r.push.apply(r,this.VNl(R,ba,h));return r}VNl(b,h,r=0){const z=[],R=this.Im.getCommandByExternalUxId(b);let ba={};appChrome.selectors.isControlDefined(b)&&(ba=this.jWj.AZh(b,h));ba[ez.a.TLb]=r;qf.c(R)?(ba.ExternalUxId=b,(b=this.$Wg.Rql(b,h,ba))&&0<b.length&&z.push.apply(z,b)):(ba.MenuItemId=R.menuItemId,ba.SourceControlId=b);z.push.apply(z,this.$Wg.WFl(R,h,ba));return z}WNl(){const b=[],h=!!t.AFrameworkApplication.K&&(t.AFrameworkApplication.K.$("ReactRibbonDispatchActionFilter")||
t.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ReactRibbonDispatchActionFilter",!1)),r=appChrome.selectors.getContextualTabIds();let z=[];h&&(z=appChrome.selectors.getActiveContextualTabIds());for(let ba=0;ba<r.length;ba++){var R=this.Im.hif(r[ba]);if(R){R=this.uz.uCa(R);let ta=!0;h&&(ta=0<=Array.indexOf(z,r[ba]));h&&ta===R||b.push(appChrome.actions.activateDeactivateContextualTab(r[ba],R))}}return b}Vpl(){var b=appChrome.selectors.getSelectedTabId();const h=[],r=this.Im.hif(b);
r&&(this.uz.uCa(r)||h.push(appChrome.actions.updateDisabledEnabledStateForControlsInTab(b,!0)));return h}Wpl(){var b=appChrome.selectors.getActiveGroupIds();const h=[];for(const r of b)if(b=this.Im.Ltl(r))for(const z of b)this.uz.uCa(z.commandId)||((b=z.externalUxCommandIds)||(b=appChrome.selectors.getVisibleControlsInGroup(z.externalUxGroupId)),h.push.apply(h,b));return h}}Object(n.a)(gH,"ReactRibbonRootPoller",null,[852]);class pE{constructor(b,h,r=null){this.uz=this.Kxa=this.o9a=null;this.QTb=
h;b.kJa(this);this.vE=r}get wma(){this.Kxa||(this.Kxa=new Date,this.Kxa.setTime(0));return this.Kxa}set wma(b){this.Kxa=b}get l7(){return 2}get vE(){return this.uz}set vE(b){this.uz=b}get Tbc(){this.o9a||(this.o9a=new gH(this.QTb,this.vE,this.l7));return this.o9a}abb(){const b=document.activeElement;$e.a.isEditable(b)&&b.blur()}executeCommand(b,h,r,z,R,ba,ta,Wa=2){qf.c(this.vE)||(R=new wf.a,R.CommandLocation=Wa,R.InvocationMethod=z,R.CommandTabName=r,this.xud(),h[ez.a.TLb]=Wa,this.vE.MKa(b,h,R,ba,
ta),this.lwm(b,h))}jBa(){return qf.c(this.vE)?[]:this.Tbc.jBa()}yl(){const b=this.jBa();0<b.length&&(this.wma=new Date,appChrome.api.dispatch(b))}K3c(){yh.c()&&this.Tbc.cVc({PeopleWell:"PeopleWell"},18)}z3c(){}xud(){const b=Sa.a.instance.Pa("Common.ISystemInitiatedFeedback");b?b.logActivity("SLRCommandUsed","FGSLRUsageEnabled"):v.ULS.sendTraceTag(561394446,340,50,"ISystemInitiatedFeedback was null")}lwm(b,h){try{const r=Sa.a.instance.Pa("Common.ISystemInitiatedFeedback");if(r&&h){const z=h.SourceControlId||
h.launcherId||h.LegacyId||h.NewContextId;let R=(z?"_"+z:"")+(h.SqmControlId?"_"+h.SqmControlId:"");R=R.length?R:"_"+b;r.lxf("Ribbon"+R)}}catch(r){v.ULS.sendTraceTag(527247309,356,10,"LogCommandActivity failed: "+(r?r.toString():""))}}}Object(n.a)(pE,"ReactRibbonRoot",null,[705,853]);var qE=d(1582);class hH{constructor(b){this.sMe=this.vre=!1;this.Z5a=null;this.bxg=!1;this.DO=null;this.$pa=!1;this.ZDe=b;gf.a.instance.mb(jb.a.$w,this.JHc(),Object(u.a)(this,this.RQm,"onContextualUIMouseDown"));(b=Sa.a.instance.Za("Common.IActionContextProvider"))&&
b.execute(h=>{this.DO=h});t.AFrameworkApplication.K.$("InitializeContextualUIAftereHeaderInteractiveIsEnabled")&&t.AFrameworkApplication.ua.Sb.BI?Si.a.get_instance().tl(16,()=>{this.Uta?this.initializeContextualUI(this.JHc()):Si.a.get_instance().tl(7,()=>{this.initializeContextualUI(this.JHc())})}):Si.a.get_instance().tl(7,()=>{this.initializeContextualUI(this.JHc())})}get KZ(){return this.$pa}get Uta(){return t.AFrameworkApplication.K.$("InitializeContextualUIAftereHeaderInteractiveIsEnabled")&&
t.AFrameworkApplication.ua.Sb.BI?Si.a.get_instance().isCompleted(16)&&Si.a.get_instance().isCompleted(7):Si.a.get_instance().isCompleted(7)}ark(){if(this.bxg)return!0;try{return Promise.resolve(null),this.bxg=!0}catch(b){return!1}}t7f(b){if(!this.Uta||this.sMe)return this.byf("Unable to launch contextual ui because ribbon hasn't loaded yet"),!0;if(!this.ark())return this.byf("Unable to launch contextual ui because promise.resolve is not defined"),!0;if(t.AFrameworkApplication.TG)return this.byf("Unable to launch contextual ui because the feature to show contextual ui is disabled"),
!0;this.sMe=!0;let h=ab.a.Ag;switch(b){case 1:h=ab.a.showContextMenu;break;case 0:h=ab.a.showFloatie;break;case 2:h=ab.a.Jec}window.requestAnimationFrame(()=>{window.setTimeout(()=>{this.sMe=!1;Lb.c(h)},0)});return!1}X0h(b){return Uk.UISurfaces.eYa().then(h=>{if(appChrome.api.isSmallDevice()&&h.getBlockedSmallScreenFloatieGroupList){h=h.getBlockedSmallScreenFloatieGroupList();const r=[];for(const z of b)Array.contains(h,z)||r.push(z);return r}return b})}showFloatie(b,h,r,z=null){this.t7f(0)||this.X0h(h).then(R=>
{if(0>=R.length)return null;this.OZf(R).then(()=>{const ba={};ba.target=b;Uk.UISurfaces.eYa().then(ta=>{appChrome.api.dispatch(ta.showFloatie(ba,r,void 0,this.zff(),z));this.$pa=!0;return null})});return null})}showContextMenu(b,h,r=null,z=null){this.t7f(1)||this.q4i(b,h,r,z)}q4i(b,h,r=null,z=null){this.OZf(null).then(()=>{const R={};R.target=b;z&&(R.directionalHint=z);Uk.UISurfaces.eYa().then(ba=>{appChrome.api.dispatch(ba.showContextMenu(R,h,r,void 0,this.zff()));return null})})}Iec(b,h,r,z=null){this.t7f(2)||
this.X0h(h).then(R=>{0>=R.length?this.q4i(b,r,z):this.OZf(R).then(()=>{const ba={};ba.target=b;const ta={};ta.target=b;Uk.UISurfaces.eYa().then(Wa=>{appChrome.api.dispatch(Wa.showContextualUI(ba,ta,r,void 0,z,this.zff()));this.$pa=!0;return null})});return null})}byf(b){v.ULS.sendTraceTag(561394519,340,15,b)}x4e(){this.Uta&&Uk.UISurfaces.isLoaded()&&Uk.UISurfaces.eYa().then(b=>{appChrome.api.dispatch(b.hideContextMenu());return null})}qw(){this.Uta&&Uk.UISurfaces.isLoaded()&&Uk.UISurfaces.eYa().then(b=>
{this.$pa=!1;appChrome.api.dispatch(b.hideFloatie());return null})}fEc(){this.Uta&&Uk.UISurfaces.isLoaded()&&Uk.UISurfaces.eYa().then(b=>{appChrome.api.dispatch(b.hideContextualUI());this.$pa=!1;return null})}initializeContextualUI(b){return Uk.UISurfaces.eYa().then(h=>{this.vre||(h.initializeContextualUI(b),this.vre=!0);return null})}OZf(b){if(!this.vre)return this.initializeContextualUI(this.JHc()).then(()=>{this.setActiveFloatieGroups(b);return null});this.setActiveFloatieGroups(b);return Promise.resolve(null)}setActiveFloatieGroups(b){if(b&&
b.length){var h=[];h.push(appChrome.actions.setActiveFloatieGroups(b));appChrome.api.dispatch(h);var r=[];Uk.UISurfaces.eYa().then(z=>{r.push.apply(r,this.ZDe.Tbc.QId(z.selectors.getFloatieOnlyControlsMap(),9));0<r.length&&appChrome.api.dispatch(r);return null})}}JHc(){if(this.Z5a)return this.Z5a;this.Z5a=qE.a("div");this.Z5a.id="ReactContextualUIDiv";this.Z5a.style.position="absolute";this.Z5a.style.zIndex="1001";document.body.insertBefore(this.Z5a,document.body.firstChild);return this.Z5a}RQm(b){b.Ib&&
b.Ib.target&&"input"===b.Ib.target.tagName.toLowerCase()&&ve.FocusManager.instance().fC("ribbon");return!1}zff(){return this.DO?this.DO.contentType:"Unknown"}}Object(n.a)(hH,"ReactContextualUILauncher",null,[854]);class iH extends Ly.a{constructor(){super()}}Object(n.a)(iH,"FloatieBuildOptions",Ly.a,[]);class jH extends Ny.a{constructor(){super()}}Object(n.a)(jH,"FloatieBuildContext",Ny.a,[]);var yL=d(659);class kH extends Id.Builder{constructor(b,h,r){super(b,h,r,null);if(qf.c(h))throw Error.create("Floatie placeholder DOM element is null or undefined.");
}get floatie(){return this.root}wQn(b){this.root=b}tlk(){const b=new jH,h=new Lt.a;h.HWc=1;h.handler=Object(u.a)(this,this.wWm,"onReturnFloatieData");h.data=b;this.esa.m5d(h)}wWm(b){this.ulk(b.$Vc,b.eCc);this.floatie.RIh=this;this.floatie.km();this.floatie.Kc.style.display="none";this.placeholder.appendChild(this.floatie.Kc);this.Era.continueWith(()=>{this.Era.result.fGb(this.floatie)},11);rj.a.instance.mb(jb.a.pointerDown,this.floatie.Kc,Object(u.a)(this.floatie,this.floatie.XB,"onPointerDown"))}ulk(b,
h){b=mj.a.yea(b,mj.a.epj);if(qf.c(b))throw Error.create("No floatie element was present in the data");b=new mj.a(b);this.wQn(new $s(b.attributes[mj.a.id],b.attributes));b=mj.a.yea(b.node,mj.a.dfe);this.oUe(b,h)}oUe(b,h){b=mj.a.Iv(b);for(let r=0;r<b.length;r++){if(this.CMa(b[r]))continue;const z=this.wUe(b[r],h);this.floatie.Sf(z)}}wUe(b,h){var r=new mj.a(b);b=new yL.Group(this.floatie,r.attributes[mj.a.id],r.attributes[mj.a.WQa],r.attributes[mj.a.tic],r.attributes[mj.a.QQa],!1,r.name===mj.a.Asj,!1,
r.attributes);r=mj.a.Iv(r.node);for(let z=0;z<r.length;z++)b.Sf(this.otd(r[z],h));return b}otd(b,h){b=new mj.a(b);var r=b.attributes[mj.a.id];b=mj.a.Iv(b.node);var z=2;2===b.length&&(z=3);r=new jj.a(this.floatie,r,z,2,1);for(z=0;z<b.length;z++){const ba=new mj.a(b[z]);var R=mj.a.yea(ba.node,mj.a.Rmb);R=mj.a.Iv(R);this.BUe(r.UHd(z+1),R,ba.attributes[mj.a.id],h)}return r}BUe(b,h,r,z){for(r=0;r<h.length;r++){if(this.CMa(h[r]))continue;const R=new mj.a(h[r]),ba=this.tda(h[r],z);ba&&b.Sf(ba.GP(R.attributes[mj.a.uic]))}}}
Object(n.a)(kH,"FloatieBuilder",Id.Builder,[]);class MD{constructor(b,h){this.Su=null;this.fAk=b;this.Rle=h}get floatie(){return this.Su}cbb(b,h,r){h=new In.CuiHelper(il.a.yab,Box4Intl.Box4Strings,null,null,h);const z=new iH;z.eG=r||{};z.eG.floatieshadingColor=!1;const R=new kH(z,document.body,this.fAk.qTi);R.esa=new Lz.a(b,h);R.tlk();this.Rle.execute(ba=>{R.floatie.vE=ba});R.floatie.pmn(Object(u.a)(this,this.kXd,"onFloatieDismissed"));R.floatie.Cln(Object(u.a)(this,this.uul,"getHiddenFloatieGroups"));
this.Su=R.floatie;return this.floatie}uul(){return[]}}Object(n.a)(MD,"AFloatieInitializer",null,[]);class lH extends MD{constructor(b,h,r,z){super(h,r);this.JLf=()=>{this.floatie.yl()};this.Eh=b;this.IH=z}cbb(b,h,r){if(b=super.cbb(b,h,r))b.jbc=!0,b.t0d=!0,b.preventDismissOnScroll=!0;this.Eh.pVa(this.JLf);return b}mMc(b,h,r=null){this.IH.zfh(()=>this.cbb(b,h,r))}kXd(){this.floatie.jbc=!0}}Object(n.a)(lH,"PasteFloatieInitializer",MD,[]);var uF=d(793);class Ax{Kva(b,h){this.zrk&&this.HWn(b,h,Ax.Pzf,
Ax.kb)}HWn(b,h,r,z){switch(r){case 1:case 6:case 2:case 3:case 4:Ax.W5e.show(z,b,h)}}Gqi(){switch(Ax.Pzf){case 5:case 1:return!0;default:return!1}}GPk(){return Ax.Pzf}get zrk(){return 1!==vb.App.xa.state}static get W5e(){return null!=Ax.yig?Ax.yig:Ax.yig=Sa.a.instance.resolve("Box4.UI.AEditSurfaceContextMenu")}static Tyl(b){if(!b)return 0;if(2===vb.App.xa.mode){const h=b.Qa.node,r=Nd.GraphIterator.$a(h);r.qo();return kg.e(r.currentNode)?2:t.AFrameworkApplication.Ihc||!Gj.isEmbeddedFileNode(h)||Gj.isInvalid(h)?
ze.a.qem(b.Qa)||ze.a.Lqf(b.Qa)?6:1:3}return 4}static get kb(){return di.a.instance.hb.kb}static get Pzf(){return Ax.Tyl(Ax.kb)}}Object(n.a)(Ax,"SelectionContextMenuProvider",null,[1256]);var rE=d(1781);class sE{constructor(b,h){this.t0d=this.jbc=!1;this.SKc=!0;this.Zv=b;this.Im=h}get isVisible(){return this.Zv.KZ}get controls(){return null}qw(){this.Zv.qw();return!0}a7e(){}$2a(b,h,r,z,R=null){this.Zv.showFloatie(Object.assign(new rE.a,{x:b.x,y:b.y}),this.Uaf(r),r,R)}gAb(){return new Sys.UI.Bounds(0,
0,0,0)}T1(){return this.qw()}Uaf(){return[]}}Object(n.a)(sE,"ReactFloatie",null,[389,390]);class mH{constructor(b){this.g9c=null;this.Zv=b}dispose(){}T1(){this.Zv.fEc();return!0}showContextMenu(b,h){this.vKb(b,h.clientPoint,h.gg)}vKb(b,h,r){this.X2a(b,new Sys.UI.Bounds(h.x,h.y,0,0),r);v.ULS.sendTraceTag(39195875,207,50,"React ContextMenu launched for Id: {0}",b)}X2a(b,h,r,z=null){this.g9c?this.Zv.Iec(Object.assign(new rE.a,{x:h.x,y:h.y}),this.g9c.Uaf(r),r,b):this.Zv.showContextMenu(Object.assign(new rE.a,
{x:h.x,y:h.y}),r,b,z);this.g9c=null}Jec(b,h,r,z){this.g9c=Object(la.a)(sE,r);z.Kva(b,h);return!0}$Zb(){}}Object(n.a)(mH,"ReactContextMenuController",null,[576,9]);var zL=d(356);class nH{constructor(){this.Cga=this.text=this.Sla=null}}Object(n.a)(nH,"BusinessBarButtonData",null,[]);class vF{constructor(){this.text=this.Sla=null}}Object(n.a)(vF,"BusinessBarLinkData",null,[]);var oH=d(180);class wF{constructor(b,h,r,z){this.gEg=this.PSb=this.BBg=this.z6a=this.Bzg=null;this.ks=b;this.Woa=h;this.ga=r;
this.Oa=z}nLf(){this.aZb();this.vud();this.BAc();this.avk()}vud(){}aZb(){const b=vb.App.xa.jb.Yc;b&&(this.Bzg=this.n4a(this.Bzg,1,2===vb.App.xa.mode&&b.fOd,Box4Intl.Box4Strings.l_BusinessBarReadonlyCorruptContent))}get ymm(){return vb.App.Afj?X.a.Ak:!1}pnm(){return t.AFrameworkApplication.ua&&1===t.AFrameworkApplication.ua.mode}avk(){this.ymm&&!this.PSb&&(this.PSb=this.Woa.create("",CommonUIStrings.l_UnsupportedBrowserDeadline,null),this.PSb.id=15,this.PSb.closeable=!0,this.PSb.addButton(Box4Intl.Box4Strings.L_DownloadNow,
tf.AppFrame.Ufo,""),Lb.a("NewBrowserSuggestionShown"),this.ks.mA(this.PSb,!1))}BAc(){let b=null;const h=vb.App.xa.jb.activeSection;if(h){const r=h.iUc;oH.a.GNd(r)?22===r?b=Box4Intl.Box4Strings.l_BusinessBarQuotaExceeded:19===r||20===r?b=X.a.ki?Box4Intl.Box4Strings.l_BusinessBarVirusNoCopy:Box4Intl.Box4Strings.l_BusinessBarVirus:21===r?b=Box4Intl.Box4Strings.l_BusinessBarMinorVersionLimitExceeded:23===r?b=X.a.ki?Box4Intl.Box4Strings.l_BusinessBarFileSizeExceededNoCopy:Box4Intl.Box4Strings.l_BusinessBarFileSizeExceeded:
7===r&&(b=Box4Intl.Box4Strings.l_BusinessBarWriteAccessDenied):oH.a.y4h(h.bVa)||vb.App.Bm||this.pnm()||(b=Box4Intl.Box4Strings.l_SectionLockedInfoText)}this.gEg=this.n4a(this.gEg,5,!!b,b)}E4i(b,h,r,z){b=this.Woa.create(null,b,null);b.closeable=!0;b.id=23;b.image=3;b.Kqd(h,()=>{Ed.a.openWindow(4,"https://go.microsoft.com/fwlink/?linkid="+r)});z&&(b.aka=z);this.ks.mA(b,!0)}tXn(b,h,r){this.E4i(b,h,r,null)}EXn(b){b=this.Woa.create(null,b,null);b.closeable=!0;b.id=20;this.ks.mA(b)}RWn(){var b=Box4Intl.Box4Strings.L_DictationSilenceBusinessBarTitle,
h=Box4Intl.Box4Strings.L_DictationSilenceBusinessBarMessage;this.z6a||(this.z6a=this.Woa.create(b,h,null),this.z6a.closeable=!0,this.z6a.id=27,this.ks.mA(this.z6a))}UXl(){this.z6a&&(this.z6a=this.n4a(this.z6a,27,!1,""))}p0f(b){this.BBg=this.n4a(this.BBg,30,!0,b)}n4a(b,h,r,z,R=!1,ba="",ta=null,Wa=null,ub=null){r?b?b.message=z:(b=this.Woa.create(ba,z,null),b.id=h,b.closeable=R,ta&&b.addButton(ta.text,ta.Sla,ta.Cga),Wa&&b.Kqd(Wa.text,Wa.Sla),ub&&(b.aka=ub),this.ks.mA(b,!1)):b&&(this.ks.removeEntry(b),
b=null);return b}MNe(b){this.ks.mA(b,void 0)}}Object(n.a)(wF,"BusinessBarController",null,[513]);class OB extends wF{constructor(b,h,r,z){super(b,h,r,z);this.Ixa=null}hTh(b,h,r=null,z=null,R=null,ba=2){this.Ixa||(this.Ixa=this.Woa.create(h,r||"",null),this.Ixa.id=6,this.Ixa.image=ba,this.Ixa.wPd=!1,b&&(this.Ixa.errorCode=b),this.Ixa.closeable=!1,h=t.AFrameworkApplication.xE&&this.Oa.$("ShowFeedbackButtonOnKickoutBusinessBar"),z?(this.Ixa.addButton(z,R,""),h&&this.Ixa.i9g(WoncaIntl.WoncaStrings.L_GiveFeedback,
()=>{this.H1h(b)})):h&&this.Ixa.addButton(WoncaIntl.WoncaStrings.L_GiveFeedback,()=>{this.H1h(b)},""),this.ks.mA(this.Ixa,void 0,null,null,null))}H1h(b){v.ULS.sendTraceTag(36471966,338,15,"Feedback given after kickout: {0}",{["ErrorCode"]:b});this.ga.Xb(ab.a.giveFeedback,2,{["ErrorCode"]:b})}static get Te(){return ne.PageReader.instance}}Object(n.a)(OB,"BusinessBarController",wF,[512,513]);class xF{static get Yui(){const b=B.a.Ij(Sj.a.pg(t.AFrameworkApplication.lcid).name);return String.format("https://r.office.microsoft.com/r/rlidWebOpenDocumentDetails?clid={0}",
b)}}Object(n.a)(xF,"OdtUtils",null,[]);class pH extends OB{constructor(b,h,r,z){super(b,h,r,z);this.Pnb=this.hoc=this.YPg=this.dJa=this.dQg=this.Q0g=null;this.mLj="https://go.microsoft.com/fwlink/?linkid=2134357"}nLf(){super.nLf();this.Duk()}vud(){const b=vb.App.xa.jb.Yc;if(b){var h=vb.App.NZ;if(vb.App.As||vb.App.Bm||h&&t.AFrameworkApplication.Iu)this.Q0g=this.n4a(this.Q0g,4,OB.Te.nPc(b),Box4Intl.Box4Strings.l_BusinessBarSigned,!0),this.dQg=this.n4a(this.dQg,3,OB.Te.W6b(b),Box4Intl.Box4Strings.l_BusinessBarMarkedAsFinal,
!0),this.YPg=this.n4a(this.YPg,8,OB.Te.TDk(b),Box4Intl.Box4Strings.l_BusinessBarContainsMalformedHyperlinkUris,!0),OB.Te.YPc(b)?this.dJa||(this.dJa=this.Woa.create(Box4Intl.Box4Strings.l_BusinessBarCompatTitle,Box4Intl.Box4Strings.l_BusinessBarCompatMessage,null),this.dJa.id=14,this.dJa.closeable=!0,this.dJa.image=3,this.dJa.addButton(Box4Intl.Box4Strings.L_LearnMore,tf.AppFrame.Vqm,""),this.ks.mA(this.dJa,!1)):this.dJa&&(this.ks.removeEntry(this.dJa),this.dJa=null)}}Duk(){if(ja.App.COc){const b=
xF.Yui,h=this.Woa.create(Box4Intl.Box4Strings.l_BusinessBarODTDocumentTitle,Box4Intl.Box4Strings.l_BusinessBarODTDocument,null);h.id=9;h.closeable=!0;h.j3j(b);this.ks.mA(h,!0)}}uXn(b,h){if(vb.App.xa.jb.Yc){const r=new nH;r.text=WordEditorIntl.WordEditorStrings.l_BusinessBarMergePromptSendButton;r.Sla=()=>{b()};const z=new vF;z.text=WordEditorIntl.WordEditorStrings.l_BusinessBarMergePromptPrivacyLinkText;z.Sla=()=>{Ed.a.openWindow(4,t.AFrameworkApplication.bjb)};this.hoc=this.n4a(this.hoc,25,!0,WordEditorIntl.WordEditorStrings.l_BusinessBarMergePromptMessage,
!0,WordEditorIntl.WordEditorStrings.l_BusinessBarMergePromptTitle,r,z,()=>{h()})}}bYl(){this.hoc&&(this.hoc=this.n4a(this.hoc,25,!1,""))}AWn(){if(vb.App.xa.jb.Yc){const b=new vF;b.text=WordEditorIntl.WordEditorStrings.L_CitationStyleLearnMore;b.Sla=()=>{Ed.a.openWindow(4,this.mLj)};this.Pnb||(this.Pnb=this.Woa.create(WordEditorIntl.WordEditorStrings.L_CitationStylePromptTitle,WordEditorIntl.WordEditorStrings.L_CitationStylePromptText,null),this.Pnb.id=32,this.Pnb.closeable=!0,this.Pnb.image=3,this.Pnb.Kqd(b.text,
b.Sla),this.ks.mA(this.Pnb,!1))}}bfa(b){return this.ks.bfa(b)}mA(b,h){this.ks.mA(b,h)}}Object(n.a)(pH,"BusinessBarController",OB,[511,512,513]);class qH{constructor(){this.menuTargetType=null}}Object(n.a)(qH,"MenuTargetDescriptor",null,[]);class Ps{static get L1(){return null!=Ps.Mhg?Ps.Mhg:Ps.Mhg=Sa.a.instance.resolve("Box4.IContextMenuController")}static GIk(b){Ps.L1.$Zb(b,"mnuNavPaneWordEditor","","","Menu16")}static showContextMenu(b,h){Ps.L1.showContextMenu(b,h)}static vKb(b,h,r){Ps.L1.vKb(b,
h,r)}static X2a(b,h,r,z=null){Ps.L1.X2a(b,h,r,z)}static VKh(b,h,r,z){return Kf.a(b,h.toString(),z,r)}}Object(n.a)(Ps,"BaseContextMenu",null,[]);class rk extends Ps{constructor(b,h,r,z=!1,R,ba=null,ta){super();this.xan=h;this.Xm=r;this.ak=ba;this.Zue=z;this.Vb(b);this.u5a=ta;rk.oUa[1]=Fb.a.E9d;rk.oUa[2]=Fb.a.hJd;rk.oUa[3]=Fb.a.l$d}get S_k(){return Wg.a.yyd}get R_k(){return Wg.a.Xwd}get T_k(){return Wg.a.s_d}get U5e(){return Wg.a.NDi}Vb(b){b.gb(Fb.a.TLf,kc.a.application,Object(u.a)(this,this.V_d,"populateContextMenu"),
96);b.gb(Fb.a.mFi,kc.a.application,Object(u.a)(this,this.V_d,"populateContextMenu"),96)}show(b,h,r){let z=null,R=new Sys.UI.Bounds(0,0,0,0);const ba=this.mFl(b);if(ba&&(b=b.Qa.node)&&(b=b.Ce(Ya.InteractiveViewManager.instance.xd.Tb))){R=ul.a.rq(b,ba.end);if(t.AFrameworkApplication.isRtl&&R.x>h.x||!t.AFrameworkApplication.isRtl&&R.x+R.width<h.x||R.y+R.height<h.y)R=ul.a.rq(b,ba.end-1);h.x=R.x+(t.AFrameworkApplication.isRtl?0:R.width);h.y=R.y+R.height;z=6}Ps.X2a("ContextMenu",new Sys.UI.Bounds(h.x,h.y,
R.width,R.height),r,z)}V_d(b,h,r,z,R){if(1===r)return 32;b=R.Ww;R=R.Cd;h=Object.assign(new ni.a,{ExternalId:"ContextMenu",UpdateDynamically:!0,MenuSectionList:[]});this.lLk(h,b,R.IsShadowMenuOpen);R.MenuItems=h;return 32}yZ(b,h){return this.J0c(b)||rk.zAc(Fb.a.mergeCells)||rk.zAc(Fb.a.yEa)||this.$0f(b)||this.l4i(b,h)||rk.W4i()||rk.K4i(b).returnValue}J0c(b){return 2===vb.App.xa.mode&&this.uOc(b)}WCc(b,h,r=null){if(W.GA()&&2===vb.App.xa.mode){h=this.u5a.Erh(b.Qa);if(!h||!this.yjm()&&!this.Okm(h.errorDetails))return;
h=h.errorDetails}else{if(!this.J0c(b))return;h=this.oXh(b)}var z=Sj.a.pg(h.lcid);const R=z?z.name:"UNKNOWN";z=Object(nb.a)(pi.a,h)?h.typeId:"";v.ULS.sendTraceTag(8712398,324,50,"ErrorType:{0}, ProofingType:{1}, CritiqueId:{2}, CultureTag:{3}",h.errorType,h.proofingType,z,R);if(b=this.xan.m_b(b,h))r.push.apply(r,b),this.xBm(h,z)}Okm(b){return b&&(1===b.proofingType||2===b.proofingType)}yjm(){return!!t.AFrameworkApplication.K&&t.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.RightClickALV2Refinement",
!1)}xBm(b,h){const r=rk.oUa[b.proofingType];r&&(t.AFrameworkApplication.ya.processAction(r,2),v.ULS.sendTraceTag(527799885,375,50,"AEditSurfaceContextMenu: Logging command {0}, typeId {1}, proofingType {2}, ALV2 flight {3}.",r,h,b.proofingType,W.GA()))}oXh(b){return this.Xm.jla(b.Qa).errorDetails}uOc(b){return this.Xm.P5d(b)}F2b(){return null}wxd(){}mFl(b){return this.uOc(b)?this.Xm.jla(b.Qa):(b=this.F2b(b))?new ob.a(b.Ds,b.cpEnd):null}$0f(b){if(2!==vb.App.xa.mode||!b)return!1;b=cy.a.Qza(b.toArray());
return!!rk.Tg.uS(b,14)}v5i(b,h){return 2===h||3===h&&!this.uOc(b)}l4i(b,h){return 3!==h||this.uOc(b)}jIk(){const b=[];b.push(Object.assign(new nh.a,{ExternalId:this.S_k}));b.push(Object.assign(new nh.a,{ExternalId:this.R_k}));b.push(Object.assign(new nh.a,{ExternalId:this.T_k}));return b}oMk(){const b=[];this.Zue&&b.push(Object.assign(new nh.a,{ExternalId:this.U5e}));return b}static get hd(){return null!=rk.Rng?rk.Rng:rk.Rng=Sa.a.instance.resolve("Box4.List.IListReader")}static get Tg(){return sm.ContextSetEditor.instance}static get pem(){null==
rk.rue&&(rk.rue=t.AFrameworkApplication.K?t.AFrameworkApplication.K.$("HyperlinkContextMenuOnEOPFixIsEnabled"):!1);return rk.rue}static get qSc(){null==rk.Ymb&&(rk.Ymb=t.AFrameworkApplication.K?t.AFrameworkApplication.K.$("MultiParagraphHyperlinkEditEnabled"):!1);return rk.Ymb}static get m1(){null==rk.HU&&(rk.HU=t.AFrameworkApplication.K?t.AFrameworkApplication.K.$("AddHyperlinkWhenSelectionContainsLineBreak"):!1);return rk.HU}static zAc(b){return 32===t.AFrameworkApplication.ya.processAction(b,1)}static W4i(){return 2===
vb.App.xa.mode&&!!vb.App.Cv.aI&&vb.App.Cv.aI.cPc(Fb.a.aZd.toString())}static Y4i(b){if(1!==b.length||!b.Qa.vl)return!1;b=Nd.GraphIterator.$a(b.Qa.node);b.Bb(11);b.mc();return b.aq(4)&&!rk.hd.Hs(b).listType?!0:!1}static K4i(b){let h=!1,r=!1;if(!b)return{returnValue:!1,Geb:h,wLc:r};if(rk.qSc)return rk.DXn(b,r);if(!(b.eE||rk.pem&&2===b.length&&b.Tc.contextId===kc.a.endOfParagraph))return{returnValue:!1,Geb:h,wLc:r};b=b.Qa.clone();h=32===t.AFrameworkApplication.ya.Qf(b,Fb.a.ZNa,1,!0,null,null);r=32===
t.AFrameworkApplication.ya.Qf(b,Fb.a.insertHyperlink,1,!0,null,null);return{returnValue:h||r,Geb:h,wLc:r}}static DXn(b,h){let r;h=b.Qa.clone();r=rk.m1&&Md.l(h);let z=!r&&32===t.AFrameworkApplication.ya.Qf(h,Fb.a.ZNa,1,!0,null,null);if(b.eE||2===b.length&&b.Tc.contextId===kc.a.endOfParagraph)h=!r&&32===t.AFrameworkApplication.ya.Qf(h,Fb.a.insertHyperlink,1,!0,null,null);else{h=!0;const R=b.length;for(let ba=0;ba<R;ba++){const ta=b.J(ba).clone();if(ta.contextId===kc.a.paragraph||ta.contextId===kc.a.Gd)(r=
rk.m1&&Md.l(ta))||(h=32===t.AFrameworkApplication.ya.Qf(ta,Fb.a.insertHyperlink,1,!0,null,null)&&h);else if(ta.contextId!==kc.a.endOfParagraph)return h=z=!1,{returnValue:!1,Geb:z,wLc:h}}}return{returnValue:z||h,Geb:z,wLc:h}}static oUh(b){const h=Object.assign(new hi.a,{ControlList:[]});for(const r of b)h.ControlList.push(Object.assign(new nh.a,{ExternalId:r}));return h}static XG(b){let h=[];for(const r of b)h.push(Object.assign(new nh.a,{ExternalId:r}));return h}}rk.rue=null;rk.Ymb=null;rk.HU=null;
rk.oUa=[];Object(n.a)(rk,"AEditSurfaceContextMenu",Ps,[]);var AL=d(597),BL=d(847),CL=d(1706);class tE{static yEl(b,h,r){h=[];r.Y7m.m_b(r.Fhl(b),h);return h}static Ppl(b,h,r){const z=[];if(r.J0c(b))return z;r.K.$("WordEditorIdeasCardsIsEnabled")&&!X.a.Ak||r.O3e.wxd(b,null,h,z);return z}static DJl(b,h,r){const z=[];r.WCc(b,h,z);return z}}Object(n.a)(tE,"ContextMenuSectionHelper",null,[]);class Qp{static Cpl(b,h,r){h=[];r.WUk(b)&&h.push(Object.assign(new nh.a,{ExternalId:"ReviewDesignerSuggestion",LabelText:r.IGl(b)}));
return h}static bzl(){return rk.zAc(Fb.a.mergeCells)?rk.XG(["MergeCells"]):rk.zAc(Fb.a.N9d)?rk.XG(["SplitCells"]):[]}static $Ml(b,h,r){h=[];if(!r.Ph.Bqh(b))return h;b=r.Ph.p0h(b);h.push(Object.assign(new nh.a,{ExternalId:"AcceptChangeContext",LabelText:String.format(WordEditorIntl.WordEditorStrings.L_TrackChangeContextMenuTextFormat,WordEditorIntl.WordEditorStrings.L_AcceptChange,b)}));h.push(Object.assign(new nh.a,{ExternalId:"RejectChangeContext",LabelText:String.format(WordEditorIntl.WordEditorStrings.L_TrackChangeContextMenuTextFormat,
WordEditorIntl.WordEditorStrings.L_RejectChange,b)}));return h}static zkl(b,h,r){return t.AFrameworkApplication.K.$("CatchUpActivityIsEnabled")&&b&&b.Qa&&b.Qa.node&&r.Mc&&r.Mc.Yti(b.Qa.node)?rk.XG(["ShowCatchUpActivitiesForParagraph"]):[]}static uql(b){return mq.O4i(b)?rk.XG(["EditIllustration"]):[]}static MPl(b,h,r){return r.K.$("WordEditorWrapTextIsEnabled")&&mq.jZn(b)?[Object.assign(new mi.a,{ExternalId:"WrapTextMenu"})]:[]}static JHd(b,h,r){return r.mVk(b)?rk.XG(["CreatePullQuote"]):[]}static Fcf(b,
h,r){return r.VUk()?rk.XG(["RemoveContentControl"]):[]}static gml(){return rk.XG(["NewComment"])}static Vkl(b){let h=[];!mq.Z0f(b)&&mq.C0f(b)&&Xh.SessionStatusManager.instance.jK&&b.QL&&h.push(Object.assign(new mi.a,{ExternalId:"ChangePictureMenu",QueryCommand:"QueryChangePictureHostButton"}));return h}static cwl(b,h,r){h=[];!mq.Z0f(b)&&mq.C0f(b)&&Xh.SessionStatusManager.instance.jK&&(v.ULS.sendTraceTag(39188235,1303,50,"Showing Insights context menu option"),b.QL&&!t.AFrameworkApplication.K.$("ChangePicturesIsEnabled")?
h.push(...rk.XG(["ChangePicture"])):h.push(...r.zKk().ControlList),(b=mq.mGd())&&0<b.length&&(r=r.RNk(b),null!=r&&h.push(...r.ControlList)));return h}static jFl(){return rk.W4i()?rk.XG(["SetProofingLanguage"]):[]}static SGl(b,h,r){return r.xjm&&r.yYn(b)?rk.XG(["Rewrite"]):[]}static Ixl(b){return rk.Y4i(b)?rk.XG(["StartNewList","ContinueNumbering","SetNumberingValue"]):[]}static gDl(){return mq.j5i()?rk.XG(["ParagraphOptions"]):[]}static Xul(b){return mq.O4i(b)?rk.XG(["EditIllustration"]):[]}static wJl(b){return mq.Z0f(b)?
rk.XG(["ShowSmartLookupPane"]):[]}static kNl(b){return mq.a5i(b)?rk.XG(["ModernTranslatorSplitButton"]):[]}static jul(b,h,r){h=[];t.AFrameworkApplication.Hf("0j6hg566;iii68384");if(t.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.HeadingDeeplinkIsEnabled",!1)&&b.eE){const z=b.Qa;if(z.contextId===kc.a.paragraph||z.contextId===kc.a.Wc||z.contextId===kc.a.Gd){b=b.Qa.node;if(!r.Sn.nc(b)||b.Sr||""===b.characterData)return h;r.r0b.YFd(b)&&h.push(...rk.XG(["CreateHeadingLink"]))}}return h}static getBookmark(b,
h,r){h=[];if(t.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.BookmarksIsEnabled",!1)&&b.eE){const z=b.Qa;(Xd.SelectionEditor.xf(z)||Xd.SelectionEditor.ZZa(z))&&r.gjk.YHc(b.Qa.node,b.Qa.cpBegin)&&(h.push(...rk.XG(["DeleteBookmarkContextMenu"])),t.AFrameworkApplication.Hf("bookmarks-edit-ex;bookmarks-edit-ex-cf"),t.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.BookmarkEditNameIsEnabled",!1)&&h.push(...rk.XG(["EditBookmarkNameContextMenu"])))}return h}static k$(b){let h=
!1,r=!1,z=[];({Geb:h,wLc:r}=rk.K4i(b)).returnValue&&(h?r?z.push(...rk.XG(["EditHyperlink","SelectHyperlink","OpenHyperlink","CopyHyperlink","RemoveHyperlink"])):z.push(...rk.XG(["OpenHyperlink"])):r&&(t.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.recentLinksIsEnabled",!1)&&(t.AFrameworkApplication.K.$("IsO365CommercialHost")||t.AFrameworkApplication.K.$("IsO365ConsumerHost"))?z.push(...rk.XG(["InsertLinkFlyout"])):z.push(...rk.XG(["InsertLink"]))));return z}static Hll(b,
h,r){let z=[];if(!r.l4i(b,h))return z;2===vb.App.xa.mode?(z.push(...r.jIk()),z.push(...r.oMk()),3===h&&r.uOc(b)&&z.push(Object.assign(new nh.a,{ExternalId:"Delete"}))):t.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.RestrictCopyWithIRMEnabled",!1)?(!t.AFrameworkApplication.protectFile&&!t.AFrameworkApplication.jO||t.AFrameworkApplication.N0b)&&z.push(Object.assign(new nh.a,{ExternalId:"Copy"})):t.AFrameworkApplication.protectFile||z.push(Object.assign(new nh.a,{ExternalId:"Copy"}));
return z}static gbf(b,h,r){return r.$0f(b)&&r.v5i(b,h)?rk.XG(["EditTableAltText"]):[]}static SSh(b,h,r){return r.fVk(b)?rk.XG(["ShowIntentSuggestion"]):[]}static mLl(b,h,r){const z=[];r.$0f(b)&&!r.v5i(b,h)&&(z.push(Object.assign(new mi.a,{ExternalId:"InsertTableMenu"})),z.push(Object.assign(new mi.a,{ExternalId:"DeleteTableMenu"})),z.push(Object.assign(new mi.a,{ExternalId:"SelectTableMenu"})));return z}static rLl(b,h,r){return mq.Qb.isFeatureEnabled(116)&&r.PYn(b)?rk.XG(["UpdateTableOfContents"]):
[]}static crl(b){return mq.$Wn(b)?rk.XG(["ShowHideEquationToolsPane"]):[]}}Object(n.a)(Qp,"ContextMenuSectionItemHelper",null,[]);class mq extends rk{constructor(b,h,r,z,R,ba,ta,Wa,ub,Ib,$b,fc,Kc,ed,Jd,ge,qe,Ve,Bd=!1,he=null,we=null,hg,Pf,Ej,pn){super(b,h,r,Bd,void 0,he,hg);this.kzd=pn;this.cDe=this.DO=null;this.oHg=!1;this.D5d=new Map;this.rD={};this.rFb={};this.ga=b;this.K=z;this.Ph=R;this.tV=Wa;this.LH=ub;this.Ns=Ib;this.oZj=!!he;this.O3e=$b;this.Y7m=fc;this.xPb=ge;this.ZU=qe;this.gjk=Ve;this.WRa=
Ej;this.fb=Pf;Jd&&Jd.execute(Ol=>{this.KZg=Ol});Kc&&Kc.execute(Ol=>{this.cDe=Ol});this.Mc=ta;this.qy=ed;we&&we.execute(Ol=>{this.DO=Ol});this.I1l();this.g6m();this.G7k();this.f6m()}get Sn(){return this.fb}get r0b(){return this.WRa}get U5e(){return this.oZj?Wg.a.p_d:super.U5e}$Un(){const b=ja.App.fm.jb.Ic.Cb.hb.kb;return this.J0c(b)&&2!==this.oXh(b).errorType}yZ(b,h){return super.yZ(b,h)||mq.j5i()||rk.Y4i(b)||mq.C0f(b)||mq.a5i(b)}lLk(b,h,r){const z=[];let R=null;try{R=ja.App.fm.jb.Ic.Cb.hb.kb}catch(ba){v.ULS.sendTraceTag(576481226,
341,15,"Selection was not initialized in time for ContextMenu Population");return}this.X5m(R,h,z,this.wnl(R));b.MenuSectionList.push(...z);this.eMn(b);!r&&this.KZg&&this.KZg.O9m(b.MenuTargetDescriptor.menuTargetType,z)}wnl(b){return rk.zAc(Fb.a.mergeCells)?bw.efg:b.Nqf?bw.Qbg:b.QL?bw.Rdg:b.z7b()?bw.Dbg:bw.Zbg}AKk(b){b=mq.i0e(b);return Object.assign(new nh.a,{ExternalId:"SmartLookupContextMenu",LabelText:b})}SNk(b){return(b=mq.hoj(b))?Object.assign(new nh.a,{ExternalId:"SmartLookupSynonyms",LabelText:b}):
null}zKk(){const b=Object.assign(new hi.a,{ControlList:[]}),h=mq.mGd();b.ControlList.push(this.AKk(h));return b}RNk(b){const h=Object.assign(new hi.a,{ControlList:[]});if(b&&0<b.length){b=this.SNk(b);if(null==b)return null;h.ControlList.push(b)}return h}Z7b(b){return b.QL||2<b.length||!b.length||2===b.length&&!Xd.SelectionEditor.uk(b.Tc)||1===b.length&&Xd.SelectionEditor.uk(b.Tc)?!1:this.suf(b.Qa)}suf(b){return ie.ParagraphReader.nc(b.node)?""!==ie.ParagraphReader.text(b.node).trim():!1}PYn(b){var h=
Nd.GraphIterator.$a(b.Qa.node);h=Object(la.a)(AL.a,h.currentNode);return xg.a.instance.J(5)&&b.QL?!1:!!h&&h.Sr}G7k(){t.AFrameworkApplication.Hl("Microsoft.Office.Web.SessionSettings.IWacWordRewriteSettings");this.K.$("RewriteIsEnabled")||this.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.RewriteIsEnabledFromControlTower",!1)?this.qy.execute(b=>{b.isFeatureEnabled(BL.a.gti,!1).then(h=>{h||v.ULS.sendTraceTag(592995265,341,50,"Rewrite license missing, skip creating context menu item");this.oHg=
h;return null})}):v.ULS.sendTraceTag(592995266,341,50,"Rewrite flight not enabled, skip creating context menu item")}get xjm(){t.AFrameworkApplication.Hl("Microsoft.Office.Web.SessionSettings.IWacWordRewriteSettings");return this.K.$("RewriteIsEnabled")||this.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.RewriteIsEnabledFromControlTower",!1)?this.oHg:!1}yYn(b){if(!this.Z7b(b)||b.p6b||b.z7b())return!1;b=b.Qa;if(ie.ParagraphReader.gm(b)||Xd.SelectionEditor.xf(b)||Xd.SelectionEditor.Ek(b)){b=
this.LH.xYa(b);b||(b=t.AFrameworkApplication.lcid);switch(b&1023){case 9:return!0;case 10:if(this.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.RewriteIsEnabledFromControlTower",!1))return!0}return!1}}fVk(b){if(1!==b.length||X.a.Ak)return!1;const h=t.AFrameworkApplication.K.$("WordEditorIdeasCardsIsEnabled");if(h&&this.$Un()||W.GA()&&this.u5a.Erh(b.Qa))return!1;const r=mq.Qb.isFeatureEnabled(63);return b.J(0).contextId===kc.a.Wc&&(h||r)&&0<this.Ns.DIc(b.J(0),0).count||h&&this.F2b(b)?!0:!1}WUk(b){return 1===
b.length&&this.xPb.wA(b.Qa.node).bma}IGl(b){var h,r;const z=null===(h=this.kzd)||void 0===h?void 0:h.sT(null===(r=null===b||void 0===b?void 0:b.Qa)||void 0===r?void 0:r.node);return CL.a.k0h(z)}get Mx(){return null!=this.iig?this.iig:this.iig=Sa.a.instance.Pa("WordEditor.Designer.IDesignerTaskPane")}mVk(b){if(!this.ZU.Kbi()||!this.Mx||this.Mx.isVisible||!(1===b.length||2===b.length&&Xd.SelectionEditor.uk(b.Tc))||b.Fgb||!Xd.SelectionEditor.Ek(b.Qa)&&b.Qa.contextId!==kc.a.paragraph||b.ckm()||this.xPb.wA(b.Qa.node).bma)return!1;
const h=ie.ParagraphReader.text(b.Qa.node),r=b.Qa.contextId===kc.a.paragraph?0:b.Qa.cpBegin,z=b.Qa.contextId===kc.a.paragraph?h.length:b.Qa.cpEnd-r;return 1>z||1500<z||B.a.mf(B.a.ova(h.substr(r,z)))||1!=pc.a.xdb(b.Qa.node)?!1:!0}VUk(){return Nr.a.Epf?32==this.ga.processAction(Fb.a.HXc,1):!1}F2b(b){return this.O3e.F2b(b)}wxd(b,h,r,z=null){this.J0c(b)||this.O3e.wxd(b,h,r,z)}Fhl(b){return this.cDe?this.cDe.Ghl(b):[]}eMn(b){const h=this.DO?this.DO.contentType:"Unknown";b.MenuTargetDescriptor=Object.assign(new qH,
{menuTargetType:h})}static get Qb(){return null!=mq.zjg?mq.zjg:mq.zjg=Sa.a.instance.resolve("Box4.IFeatureHelper")}static C0f(b){return t.AFrameworkApplication.EZ&&!b.p6b&&Sa.a.instance.resolve("Box4.Insights.IBox4InsightsSelection").Umm()}static KHd(b){b=b?b.trim():null;let h=20;b&&0<b.length&&(b.length>h&&(h=B.a.Ny(b,h)?h-1:h),b=b.length>h?b.substr(0,h).trim()+"...":b);return b}static i0e(b){let h=WordEditorIntl.WordEditorStrings.L_ContextMenuSmartLookup;(b=mq.KHd(b))&&0<b.length&&(h=String.format(WordEditorIntl.WordEditorStrings.L_ContextMenuTextSmartLookup,
b));return h}static hoj(b){b=mq.KHd(b);return null!=b&&0<b.length?String.format(WordEditorIntl.WordEditorStrings.L_ContextMenuTextSynonyms,b):null}static mGd(){const b=(new Wm.a).getSelectedText();return b.neighborhood.substr(b.mentionStart,b.mentionLength)}static O4i(b){const h=mq.Qb.isFeatureEnabled(48);return!b.twd&&h&&!X.a.Ak&&(b.p6b||h&&b.QL)}static Z0f(b){return t.AFrameworkApplication.K.$("WordEditorSmartLookupIsEnabled")&&!b.z7b()}static a5i(b){return t.AFrameworkApplication.K.$("LanguageTranslationIsEnabled")&&
!b.p6b&&!b.z7b()}static $Wn(b){return b.Wgi()&&t.AFrameworkApplication.ua.Sb.WOc}static j5i(){return 2===ja.App.fm.mode}static jZn(b){return b.QL}X5m(b,h,r,z){this.rFb[z].forEach(R=>{const ba=Object.assign(new hi.a,{ControlList:[]}),ta=ba.ControlList;R.forEach(Wa=>{Wa instanceof Qs?r.push(...this.D5d.get(Wa)(b,h,this)):ta.push(...this.rD[Wa](b,h,this))});(null===ta||void 0===ta?0:ta.length)&&r.push(ba)})}f6m(){this.D5d.set(Qs.aNb,tE.yEl);this.D5d.set(Qs.Yee,tE.Ppl);this.D5d.set(Qs.Lfe,tE.DJl)}g6m(){this.rD[$h.WMb]=
Qp.Hll;this.rD[$h.Ofe]=Qp.mLl;this.rD[$h.Pfe]=Qp.rLl;this.rD[$h.Xee]=Qp.Cpl;this.rD[$h.ofe]=Qp.bzl;this.rD[$h.Lee]=Qp.gbf;this.rD[$h.ife]=Qp.cwl;this.rD[$h.G5c]=Qp.SSh;this.rD[$h.mcg]=Qp.Xul;this.rD[$h.Kfe]=Qp.wJl;this.rD[$h.Rfe]=Qp.kNl;this.rD[$h.wfe]=Qp.jFl;this.rD[$h.Bfe]=Qp.SGl;this.rD[$h.I5c]=Qp.Ixl;this.rD[$h.L5c]=Qp.gDl;this.rD[$h.xfe]=Qp.JHd;this.rD[$h.t5c]=Qp.Fcf;this.rD[$h.lge]=Qp.MPl;this.rD[$h.Zee]=Qp.uql;this.rD[$h.Ree]=Qp.Vkl;this.rD[$h.Qfe]=Qp.$Ml;this.rD[$h.Qee]=Qp.zkl;this.rD[$h.r5c]=
Qp.getBookmark;this.rD[$h.efe]=Qp.jul;this.rD[$h.gfe]=Qp.k$;this.rD[$h.Qmb]=Qp.gml;this.rD[$h.G5c]=Qp.SSh;this.rD[$h.$ee]=Qp.crl}I1l(){const b=[$h.ofe,$h.Lee,$h.Ofe];this.rFb[bw.efg]=[[$h.WMb],b,[$h.Qmb],[Qs.aNb],[$h.t5c]];this.rFb[bw.Rdg]=[[$h.WMb],[$h.Ree,$h.Zee,$h.lge],b,[$h.Qmb],[Qs.aNb]];this.rFb[bw.Dbg]=[[$h.$ee],[$h.I5c,$h.L5c],[$h.r5c,$h.Qmb],[Qs.aNb]];this.rFb[bw.Zbg]=[[$h.G5c],[$h.Xee],[Qs.Lfe],[Qs.Yee],[$h.WMb],[$h.ife,$h.mcg,$h.Kfe,$h.Rfe],[$h.wfe,$h.Bfe,$h.L5c],[$h.I5c],b,[$h.t5c],[$h.gfe,
$h.r5c,$h.efe,$h.Qmb],[$h.xfe],[$h.Qfe],[$h.Qee],[$h.Pfe],[Qs.aNb]];this.rFb[bw.Qbg]=[[$h.WMb],[$h.Qmb]];this.rFb[bw.aqj]=[[$h.G5c],[$h.Xee],[Qs.Lfe],[Qs.Yee],[$h.WMb],[$h.Ree],[$h.Zee],[$h.lge],[$h.ife],[$h.Kfe],[$h.Rfe],[$h.wfe],[$h.Bfe],[$h.$ee],[$h.I5c],[$h.L5c],[$h.gfe],[$h.ofe],[$h.Lee],[$h.Ofe],[$h.r5c],[$h.efe],[$h.Qmb],[$h.xfe],[$h.t5c],[$h.Qfe],[$h.Qee],[$h.Pfe],[Qs.aNb]]}}Object(n.a)(mq,"EditSurfaceContextMenu",rk,[]);var bw;(function(b){b[b.efg=1]="TABLE_MULTI_CELL";b[b.Zbg=2]="GENERIC";
b[b.Rdg=3]="PICTURE";b[b.Dbg=4]="EQUATION";b[b.aqj=5]="LEGACY";b[b.Qbg=6]="FLUID"})(bw||(bw={}));Object(n.b)("Scenarios",bw);class Qs{}Qs.aNb=new Qs;Qs.Yee=new Qs;Qs.Lfe=new Qs;Object(n.a)(Qs,"Sections",null,[]);var $h;(function(b){b[b.G5c=1]="INTENT_SUGGESTION";b[b.WMb=2]="ESSENTIALS";b[b.ife=3]="INSIGHT";b[b.mcg=4]="ILLUSTRATION";b[b.Kfe=5]="SMART_LOOKUP";b[b.Rfe=6]="TRANSLATE";b[b.wfe=7]="PROOFING";b[b.Bfe=8]="REWRITE_SUGGESTIONS";b[b.I5c=9]="LISTS";b[b.L5c=10]="PARAGRAPH_OPTIONS";b[b.ofe=11]=
"MERGE_SPLIT_CELLS";b[b.Lee=12]="ALT_TEXT";b[b.gfe=13]="HYPERLINK";b[b.r5c=14]="BOOKMARK";b[b.efe=15]="HEADING_LINK";b[b.Qmb=16]="COMMENT";b[b.xfe=17]="PULL_QUOTE";b[b.lge=18]="WRAP_TEXT";b[b.Zee=19]="DRAW_ANNOTATE";b[b.Qfe=20]="TRACK_CHANGE";b[b.Qee=21]="CATCHUP_ACTIVITIES";b[b.Pfe=22]="TABLE_OF_CONTENTS";b[b.Xee=23]="DESIGNER_REVIEW";b[b.Ofe=24]="TABLE_ITEMS";b[b.Ree=25]="CHANGE_PICTURE";b[b.$ee=26]="EQUATION_TOOLS";b[b.t5c=27]="CONTENT_CONTROL"})($h||($h={}));Object(n.b)("SectionItem",$h);class hA extends Ps{constructor(b,
h,r){super();this.Tl=null;this.b0d=(z,R,ba,ta,Wa)=>{if(1===ba)return 32;z=[];R=[];this.aVn()&&R.push("InsertTabStopMenuSplitButton");this.MUn()&&R.push("ClearAllTabStops");R.push("HideRuler");z.push(hA.oUh(R));R=Object.assign(new ni.a,{ExternalId:"RulerContextMenu",UpdateDynamically:!0,MenuSectionList:[]});R.MenuSectionList.push(...z);Wa.MenuItems=R;return 32};this.ga=b;this.Mm=h;this.zC=r;this.Vb()}get t7a(){return document.getElementById("WACHorizontalRuler")}get NM(){return this.Mm&&this.Mm.instance?
this.Mm.instance.vj:1}get target(){return this.Tl}show(b,h){this.Tl=b;Ps.vKb("RulerContextMenu",b,h);v.ULS.sendTraceTag(592307397,3014,50,"Ruler Context menu invoked.");b=new Map;b.set("Command","Show");b.set("Source",hA.J2);b.set("Response","Ruler Context menu invoked.");Ca.Health.instance.recordKpiUsage(hA.kpiName,1,hA.Y5,b)}hGl(){var b=0,h=(this.target.x-Ed.a.Lbf(this.t7a))/this.NM;h=Rf.a.Wy(h,0);var r={},z=this.zC.D1b,R=Nd.GraphIterator.$a(z);R.vd();if(!Ii.TableReader.Yw(R))return 32===this.ga.Xb(Fb.a.EDa,
2,r)&&(b=r.marginLeft),h-b;b={};R={};r=this.ga.Xb(Fb.a.BWc,2,b);var ba=this.ga.Xb(Fb.a.WHb,2,R);if(32!==r||32!==ba)return v.ULS.sendTraceTag(559252943,3014,15,"Unable to read table properties for Ruler Context Menu"),h;b=b.ColumnWidths;ba=R.TablePosition;if(!ba||!b||0>=b.length)return v.ULS.sendTraceTag(559252944,3014,15,"Queried table properties are null or do not exist"),h;r=0;R=Nd.GraphIterator.$a(z);R.Bb(14)&&(R.kd(16),r=dq.a(R,!0));z=ba.x/this.NM;for(R=0;R<r;R++)z+=b[R];return h-z}Vb(){this.ga.gb(Oa.a.b0d,
kc.a.application,this.b0d,96)}aVn(){var b={},h={},r=this.ga.Xb(Fb.a.EDa,2,b),z=this.ga.Xb(Fb.a.K1a,2,h);if(32===r&&32===z){z=h.Ws;r=Rf.a.Pi(z.Pla,0);z=1===z.specialIndentType?Rf.a.Pi(z.DA,0):Rf.a.Pi(z.DA-z.kba,0);const R=Rf.a.Pi(b.marginLeft,0);b=Rf.a.Pi(b.marginRight,0);const ba=Ed.a.Lbf(this.t7a),ta=Ed.a.SMh(this.t7a);h.isRtl?(h=ba+this.NM*Math.max(b,b+r),r=ta-this.NM*Math.max(R,R+z)):(h=ba+this.NM*Math.max(R,R+z),r=ta-this.NM*Math.max(b,b+r));if(this.target.x>=h&&this.target.x<=r)return!0}return!1}MUn(){var b=
{};if(32!==this.ga.Xb(Oa.a.IHb,2,b)||!b)return!1;b=b.customTabs;return!b||0>=b.length?!1:!0}static oUh(b){const h=Object.assign(new hi.a,{ControlList:[]});for(let r of b)h.ControlList.push(Object.assign(new nh.a,{ExternalId:r}));return h}}hA.Y5="wwaengidc";hA.kpiName="WordRuler";hA.J2="RulerContextMenu";Object(n.a)(hA,"RulerContextMenu",Ps,[515]);let py;class Gp{static get oc(){return null!=Gp.Ssg?Gp.Ssg:Gp.Ssg=Sa.a.instance.resolve("Box4.Styles.IWACStyleReader")}static get eR(){return null!=Gp.Jsg?
Gp.Jsg:Gp.Jsg=Sa.a.instance.resolve("Box4.Styles.IWACStyleEditor")}static get Tj(){return null!=Gp.tlg?Gp.tlg:Gp.tlg=Sa.a.instance.resolve("Box4.IInsertionPointFormatting")}static HHi(b,h,r){if(1===h)return(b?Gp.rrk(r):Gp.Sqk(r))?32:8;(b=Gp.tKl(b,r))&&Gp.Cdk(b,r);return 32}static Cdk(b,h){const r=new yf.GraphTransaction(15);r.Db(h);Gp.Tj.f2a();Gp.eR.oM(b,h,!1);r.dispose()}static rrk(b){b=Gp.oc.yo(b);return!!b&&Gp.oc.rf(b)!==ki.StyleReader.wordStyleIdHeading1}static Sqk(b){b=Gp.oc.yo(b);return!!b&&
Gp.oc.rf(b)!==ki.StyleReader.G4a}static tKl(b,h){const r=Gp.oc.yo(h);return r?Gp.oc.Qx(h).xh(Gp.qKl(b,Gp.oc.rf(r))):null}static qKl(b,h){h=Gp.headingsList.indexOf(h);b=b?h-1:h+1;return 0<=b&&b<Gp.headingsList.count?Gp.headingsList.J(b):null}}Gp.headingsList=(py=new Ua.a,py.add(ki.StyleReader.wordStyleIdHeading1),py.add(ki.StyleReader.wordStyleIdHeading2),py.add(ki.StyleReader.wordStyleIdHeading3),py.add(ki.StyleReader.D4a),py.add(ki.StyleReader.E4a),py.add(ki.StyleReader.F4a),py.add(ki.StyleReader.Fmb),
py.add(ki.StyleReader.Gmb),py.add(ki.StyleReader.G4a),py);Object(n.a)(Gp,"NavigationPaneEditor",null,[]);class ND extends Ps{constructor(){super();this.N1=null;this.V_d=(b,h,r,z,R)=>{if(1===r)return 32;b=new Sys.StringBuilder;b.append(String.format('<Menu Id="{0}">',"mnuNavPaneWordEditor"));b.append('<MenuSection Id="msWordEditorHeadings" DisplayMode="Menu16"><Controls>');b.append(Ps.VKh("promoteHeading",Oa.a.N0d,"LeftArrow_16x16x32",WordEditorIntl.WordEditorStrings.L_PromoteHeadingText));b.append(Ps.VKh("demoteHeading",
Oa.a.izd,"RightArrow_16x16x32",WordEditorIntl.WordEditorStrings.L_DemoteHeadingText));b.append("</Controls></MenuSection></Menu>");R.PopulationXML=b.toString();return 32};this.N0d=(b,h,r)=>Gp.HHi(!0,r,this.N1.zb);this.izd=(b,h,r)=>Gp.HHi(!1,r,this.N1.zb)}show(b){ND.Bh||(this.$Zb(),ND.Bh=!0);Ps.showContextMenu("mnuNavPaneWordEditor",b)}$Zb(){const b={PopulateDynamically:"true",PopulateOnlyOnce:"false"};b.PopulateQueryCommand=""+Oa.a.uFi;b.Command=""+ab.a.Aja;Ps.GIk(b);t.AFrameworkApplication.ya.pa(Oa.a.uFi,
kc.a.application,this.V_d);t.AFrameworkApplication.ya.pa(Oa.a.N0d,kc.a.view,this.N0d);t.AFrameworkApplication.ya.pa(Oa.a.izd,kc.a.view,this.izd)}}ND.Bh=!1;Object(n.a)(ND,"WordEditorNavigationPaneContextMenu",Ps,[516]);var gz=d(1448),tv=d(294),DL=d(488),EL=d(740),uE=d(1174),yF=d(1645),zF=d(970);class vE{constructor(){this.t6=this.Ddi=!1;this.rLb=2;this.Zs=0;this.L4a=1}}Object(n.a)(vE,"WrapTextPropertiesData",null,[]);class El extends uE.a{constructor(b=null){super(b);this.QZg=new yF.a;this.c6g=new vE;
this.o2g=new zF.a;this.qre=!1}initialize(){super.initialize();this.jd.Z(Oa.a.Pvf,gz.a.nfb);this.jd.Z(Oa.a.Tvf,gz.a.nfb);this.jd.Z(Oa.a.Vvf,gz.a.nfb);this.jd.Z(Oa.a.OOf,El.uOa);this.jd.Z(Oa.a.vWc,El.uOa);this.jd.Z(Oa.a.HOf,El.uOa);this.jd.Z(ab.a.ZHb,El.uOa);this.jd.Z(Fb.a.w1d,Object(u.a)(this,this.n_,"sectionPropertiesExecuteBridge"));this.jd.Z(Fb.a.v1d,Object(u.a)(this,this.n_,"sectionPropertiesExecuteBridge"));this.jd.Z(Fb.a.u1d,Object(u.a)(this,this.n_,"sectionPropertiesExecuteBridge"));this.jd.Z(Fb.a.y1d,
Object(u.a)(this,this.n_,"sectionPropertiesExecuteBridge"));this.jd.Z(Fb.a.x1d,Object(u.a)(this,this.n_,"sectionPropertiesExecuteBridge"));this.jd.Z(Fb.a.t1d,Object(u.a)(this,this.n_,"sectionPropertiesExecuteBridge"));this.jd.Z(Fb.a.F1d,Object(u.a)(this,this.n_,"sectionPropertiesExecuteBridge"));this.jd.Z(Fb.a.E1d,Object(u.a)(this,this.n_,"sectionPropertiesExecuteBridge"));this.jd.Z(Fb.a.D1d,Object(u.a)(this,this.n_,"sectionPropertiesExecuteBridge"));this.jd.Z(Fb.a.A1d,Object(u.a)(this,this.n_,"sectionPropertiesExecuteBridge"));
this.jd.Z(Fb.a.B1d,Object(u.a)(this,this.n_,"sectionPropertiesExecuteBridge"));this.jd.Z(Fb.a.C1d,Object(u.a)(this,this.n_,"sectionPropertiesExecuteBridge"));this.jd.Z(Fb.a.aPf,Object(u.a)(this,this.n_,"sectionPropertiesExecuteBridge"));this.jd.Z(Fb.a.$Of,Object(u.a)(this,this.n_,"sectionPropertiesExecuteBridge"));this.jd.Z(Fb.a.sOf,Object(u.a)(this,this.n_,"sectionPropertiesExecuteBridge"));this.jd.Z(Fb.a.uOf,Object(u.a)(this,this.n_,"sectionPropertiesExecuteBridge"));this.jd.Z(Fb.a.tOf,Object(u.a)(this,
this.n_,"sectionPropertiesExecuteBridge"));this.jd.Z(Fb.a.rOf,Object(u.a)(this,this.n_,"sectionPropertiesExecuteBridge"));this.jd.Z(Fb.a.M2a,El.uEm);this.jd.Z(Fb.a.xPa,El.a1m);this.jd.Z(Fb.a.fkb,El.Nzk);this.jd.Z(Fb.a.Fja,El.uOa);this.jd.Z(Fb.a.jHb,El.uOa);this.jd.Z(Fb.a.xOa,El.uOa);this.jd.Z(Fb.a.vra,El.uOa);this.jd.Z(Fb.a.fva,El.uOa);this.jd.Z(Oa.a.jVc,El.uOa);this.jd.Z(Oa.a.xDd,gz.a.o$e);this.jd.Z(Oa.a.yDd,Object(u.a)(this,this.uLh,"genericFontSizeExecuteBridge"));this.Pm.Z(Oa.a.hVc,gz.a.fXa);
this.Pm.Z(Oa.a.iVc,gz.a.fXa);this.jd.Z(Fb.a.SJb,gz.a.DXa);this.jd.Z(Fb.a.RJb,gz.a.DXa);this.jd.Z(Fb.a.ukb,gz.a.DXa);this.jd.Z(Fb.a.mPf,Object(u.a)(this,this.tE,"queryParaFormattingExecuteBridge"));this.jd.Z(Fb.a.kPf,Object(u.a)(this,this.tE,"queryParaFormattingExecuteBridge"));this.jd.Z(Fb.a.lPf,Object(u.a)(this,this.tE,"queryParaFormattingExecuteBridge"));this.jd.Z(Fb.a.qM,El.nan);this.Pm.Z(Oa.a.h2d,El.DXc);this.Pm.Z(Oa.a.i2d,El.DXc);this.Pm.Z(Oa.a.j2d,El.DXc);this.Pm.Z(Oa.a.f2d,El.DXc);this.Pm.Z(Oa.a.g2d,
El.DXc);this.jd.Z(Oa.a.h2d,Object(u.a)(this,this.b5c,"wrapTextPropertiesExecuteBridge"));this.jd.Z(Oa.a.i2d,Object(u.a)(this,this.b5c,"wrapTextPropertiesExecuteBridge"));this.jd.Z(Oa.a.j2d,Object(u.a)(this,this.b5c,"wrapTextPropertiesExecuteBridge"));this.jd.Z(Oa.a.f2d,Object(u.a)(this,this.b5c,"wrapTextPropertiesExecuteBridge"));this.jd.Z(Oa.a.g2d,Object(u.a)(this,this.b5c,"wrapTextPropertiesExecuteBridge"));this.jd.Z(Oa.a.yee,El.kic);this.jd.Z(Oa.a.zee,El.kic);this.jd.Z(Oa.a.Aee,El.kic);this.jd.Z(Oa.a.Bee,
El.kic);this.jd.Z(Oa.a.Cee,El.kic);this.jd.Z(Oa.a.Dee,El.kic);this.jd.Z(Oa.a.coa,El.S1b);this.jd.Z(Oa.a.u0f,El.S1b);this.jd.Z(Oa.a.v0f,El.S1b);this.jd.Z(Oa.a.C8d,El.S1b);this.jd.Z(Oa.a.D8d,El.S1b);this.jd.Z(Oa.a.E8d,El.S1b);this.jd.Z(Oa.a.kjb,Object(u.a)(this,this.Ybn,"queryImageCropExecuteBridge"));this.jd.Z(Oa.a.eWc,El.aEd);this.jd.Z(Oa.a.l1d,El.aEd);this.jd.Z(Oa.a.m1d,El.aEd);this.jd.Z(Oa.a.n1d,El.aEd);this.jd.Z(Oa.a.NLc,Object(u.a)(this,this.OLd,"imageCropFromSpinnersExecuteBridge"));this.jd.Z(Oa.a.GLc,
Object(u.a)(this,this.OLd,"imageCropFromSpinnersExecuteBridge"));this.jd.Z(Oa.a.HLc,Object(u.a)(this,this.OLd,"imageCropFromSpinnersExecuteBridge"));this.jd.Z(Oa.a.ILc,Object(u.a)(this,this.OLd,"imageCropFromSpinnersExecuteBridge"));this.jd.Z(Fb.a.Kla,Object(u.a)(this,this.B6h,"ignoreAllExecuteBridge"));this.jd.Z(Fb.a.oyb,Object(u.a)(this,this.B6h,"ignoreAllExecuteBridge"));this.jd.Z(Oa.a.ijb,El.ijb);this.jd.Z(Oa.a.M8d,gz.a.DXa);this.jd.Z(Fb.a.rPf,Object(u.a)(this,this.EIi,"queryTableBorderFormattingExecuteBridge"));
this.jd.Z(Fb.a.sPf,Object(u.a)(this,this.EIi,"queryTableBorderFormattingExecuteBridge"))}clearCache(){super.clearCache();this.qre=!1;this.QZg=new yF.a;this.c6g=new vE;this.o2g=new zF.a}Ycf(){const b=super.Ycf();b.aza=El.aza;b.AVa=El.AVa;return b}B6h(b){const h=new tv.a;h.EAa=!0;h.cL=b;return h}n_(){const b=new tv.a;b.EBb=!1;b.cL=Fb.a.EDa;b.Cd=this.QZg;b.m7b=!0;b.mfa=!0;return b}EIi(){const b=new tv.a;b.EBb=this.qre;this.qre=!0;b.cL=Fb.a.M1a;b.Cd=this.o2g;b.m7b=!0;b.mfa=!0;return b}b5c(){const b=new tv.a;
b.EBb=!1;b.cL=Oa.a.Obc;b.Cd=this.c6g;b.m7b=!0;b.mfa=!0;return b}OLd(b,h){const r=new tv.a;r.Cd=new Ei.DictionaryPropertySet;switch(b){case Oa.a.NLc:r.Cd.setValue(od.a.bfb,h[Cc.a.Number]);break;case Oa.a.GLc:r.Cd.setValue(od.a.Zeb,h[Cc.a.Number]);break;case Oa.a.HLc:r.Cd.setValue(od.a.$eb,h[Cc.a.Number]);break;case Oa.a.ILc:r.Cd.setValue(od.a.afb,h[Cc.a.Number])}return r}Ybn(){const b=new tv.a;b.Cd=new Ei.DictionaryPropertySet;b.mfa=!0;return b}static get C0m(){return null!=El.Oog?El.Oog:El.Oog=Sa.a.instance.Pa("WordEditor.IPageCommandStringBuilder")}static get $y(){El.Qqa||
(El.Qqa=Sa.a.instance.Pa("WordEditor.ITableBorderManager"));return El.Qqa}static uOa(b,h){b=new tv.a;b.Cd=h;return b}static r_c(b,h,r){h[Yf.a.Description]=b?b.rEm(r):null}static aza(b,h){const r=Object(la.a)(yF.a,b.Cd),z=Object(la.a)(DL.a,b.Cd),R=Object(la.a)(vE,b.Cd),ba=Object(la.a)(zF.a,b.Cd);let ta=!0;const Wa=El.C0m;switch(b.Aib){default:ta=uE.a.aza(b,h);break;case Fb.a.w1d:h[Wi.a.Icon]=r.Mta?"PageMarginsLandscapeNormal_48":"PageMarginsPortraitNormal_48";h[Yf.a.On]=!r.lFb;El.r_c(Wa,h,0);break;
case Fb.a.v1d:h[Wi.a.Icon]=r.Mta?"PageMarginsLandscapeNarrow_48":"PageMarginsPortraitNarrow_48";h[Yf.a.On]=1===r.lFb;El.r_c(Wa,h,1);break;case Fb.a.u1d:h[Wi.a.Icon]=r.Mta?"PageMarginsLandscapeModerate_48":"PageMarginsPortraitModerate_48";h[Yf.a.On]=2===r.lFb;El.r_c(Wa,h,2);break;case Fb.a.y1d:h[Wi.a.Icon]=r.Mta?"PageMarginsLandscapeWide_48":"PageMarginsPortraitWide_48";h[Yf.a.On]=3===r.lFb;El.r_c(Wa,h,3);break;case Fb.a.x1d:h[Wi.a.Icon]=r.Mta?"PageMarginsLandscapeOffice2003_48":"PageMarginsPortraitOffice2003_48";
h[Yf.a.On]=4===r.lFb;El.r_c(Wa,h,4);break;case Fb.a.t1d:h[Wi.a.Icon]=r.Mta?"PageMarginsLandscapeCustom_48":"PageMarginsPortraitCustom_48";h[Yf.a.On]=5===r.lFb;break;case Fb.a.F1d:h[Yf.a.On]=!r.LGb;h[Yf.a.Description]=Wa?Wa.vUc(0):null;break;case Fb.a.E1d:h[Yf.a.On]=1===r.LGb;h[Yf.a.Description]=Wa?Wa.vUc(1):null;break;case Fb.a.D1d:h[Yf.a.On]=2===r.LGb;h[Yf.a.Description]=Wa?Wa.vUc(2):null;break;case Fb.a.A1d:h[Yf.a.On]=3===r.LGb;h[Yf.a.Description]=Wa?Wa.vUc(3):null;break;case Fb.a.B1d:h[Yf.a.On]=
4===r.LGb;h[Yf.a.Description]=Wa?Wa.vUc(4):null;break;case Fb.a.C1d:h[Yf.a.On]=5===r.LGb;break;case Fb.a.aPf:h[Yf.a.On]=!r.Mta;break;case Fb.a.$Of:h[Yf.a.On]=r.Mta;break;case Fb.a.sOf:h[Yf.a.On]=1===r.KC;break;case Fb.a.uOf:h[Yf.a.On]=2===r.KC;break;case Fb.a.tOf:h[Yf.a.On]=3===r.KC;break;case Fb.a.rOf:h[Yf.a.On]=0===r.Qzk;break;case Fb.a.mPf:h[Yf.a.On]=z.Ws?!z.Ws.specialIndentType:!1;break;case Fb.a.kPf:h[Yf.a.On]=z.Ws?1===z.Ws.specialIndentType:!1;h[Ik.a.Image16by16Class]=z.isRtl?Wh.getImageClass("IndentSpecialFirstLineRTL_Server_16x16x32"):
Wh.getImageClass("IndentSpecialFirstLine_Server_16x16x32");break;case Fb.a.lPf:h[Yf.a.On]=z.Ws?2===z.Ws.specialIndentType:!1;h[Ik.a.Image16by16Class]=z.isRtl?Wh.getImageClass("IndentSpecialHangingRTL_Server_16x16x32"):Wh.getImageClass("IndentSpecialHanging_Server_16x16x32");break;case Oa.a.h2d:h[Yf.a.On]=1===R.L4a;break;case Oa.a.i2d:h[Yf.a.On]=8===R.L4a;break;case Oa.a.j2d:h[Yf.a.On]=9===R.L4a;break;case Oa.a.f2d:h[Yf.a.On]=3===R.L4a;break;case Oa.a.g2d:h[Yf.a.On]=4===R.L4a;break;case Oa.a.kjb:h[Yf.a.On]=
b.Cd.ia(od.a.Hta,!1);break;case Oa.a.ijb:h[Pk.a.IsFreeForm]=!0;h[Pk.a.Value]=b.Cd[fe.a.Value];break;case Fb.a.rPf:h[Fi.a.On]=El.$y.QMh(h.MenuItemId)===ba.lineStyle;break;case Fb.a.sPf:h[Fi.a.On]=El.$y.RMh(h.MenuItemId)===ba.PQc}return ta}static uEm(b,h){b=5;switch(h.MenuItemId){case "buttonMarginsNormal":b=0;break;case "buttonMarginsNarrow":b=1;break;case "buttonMarginsModerate":b=2;break;case "buttonMarginsWide":b=3;break;case "buttonMarginsOffice2003":b=4}h=new tv.a;h.Cd=b;return h}static a1m(b,
h){b=5;switch(h.MenuItemId){case "buttonSizeLetter":b=0;break;case "buttonSizeLegal":b=1;break;case "buttonSizeExecutive":b=2;break;case "buttonSizeA4":b=3;break;case "buttonSizeA5":b=4}h=new tv.a;h.Cd=b;return h}static Nzk(b,h){b=0;switch(h.MenuItemId){case "buttonOneColumn":b=1;break;case "buttonTwoColumns":b=2;break;case "buttonThreeColumns":b=3}h=new tv.a;h.Cd=b;return h}static ijb(){const b=new tv.a;b.cL=Oa.a.ijb;b.Cd={};b.mfa=!0;b.m7b=!0;return b}static kic(b,h){const r=new tv.a;r.Cd=new Ei.DictionaryPropertySet;
let z=1;switch(b){case Oa.a.Bee:z=1;break;case Oa.a.Cee:z=8;break;case Oa.a.Dee:z=9;break;case Oa.a.zee:z=3;break;case Oa.a.Aee:z=4}r.Cd.setValue(od.a.L4a,z);r.Cd.setValue(od.a.xEa,h[Yf.a.SourceControlId]);return r}static S1b(b,h,r){b=new tv.a;b.Cd=r.InvocationMethod;return b}static nan(b,h){b=new tv.a;b.Cd=h;return b}static DXc(){const b=new EL.a;b.cL=Oa.a.Obc;return b}static aEd(){const b=new tv.a;b.Cd=new Ei.DictionaryPropertySet;b.UOc=!0;return b}static AVa(b,h){let r=!0;switch(b.Aib){case Oa.a.eWc:b=
b.Cd.ia(od.a.bfb,0);h[Cc.a.Number]=b;h[Cc.a.UnitType]=7;break;case Oa.a.l1d:b=b.Cd.ia(od.a.Zeb,0);h[Cc.a.Number]=b;h[Cc.a.UnitType]=7;break;case Oa.a.m1d:b=b.Cd.ia(od.a.$eb,0);h[Cc.a.Number]=b;h[Cc.a.UnitType]=7;break;case Oa.a.n1d:b=b.Cd.ia(od.a.afb,0);h[Cc.a.Number]=b;h[Cc.a.UnitType]=7;break;default:r=uE.a.AVa(b,h)}return r}}El.Qqa=null;Object(n.a)(El,"CuiActionBridge",uE.a,[]);class AF extends Wc.a{constructor(b){super();this.iAk=CommonUIStrings.l_AccHelpDialogCommandsHeaderText;this.YRn=CommonUIStrings.l_AccHelpDialogShortcutHeaderText;
this.pzd=this.ltb=this.t4=this.dTa=this.XGe=null;this.Wb=b;this.vg="<div id='AccessibilityHelpDialogBody'></div>";this.kg="AAccessibilityHelpDialog";this.Fd=6;this.Ve(0,CommonUIStrings.l_DialogClose)}get N3e(){return null}get U7d(){this.XGe||(this.XGe=this.S2l());return this.XGe}get J5n(){return 300}get Sri(){return"https://go.microsoft.com/fwlink/p/?LinkId=325036"}get Rri(){return CommonUIStrings.l_AccHelpDialogMoreHelpLinkText}get PWa(){return this.Wb.Gs()}sPa(b){super.sPa(b);this.L5m()}KPa(){this.showDialog(this.sKa,
Object(u.a)(this,this.P_j,"accHelpDialogResultHandler"));this.JDa();this.setFocus()}setFocus(){this.t4?(this.ltb=this.t4.tBodies[0].firstChild,this.uU(this.ltb)):this.kG&&"none"!==this.kG.style.display?this.uU(this.kG):this.uU(this.hz)}Kja(){this.ke.mb(jb.a.li,this.pzd,Object(u.a)(this,this.t6g,"accHelpDialogKeydownHandler"));if(this.t4){this.ke.mb(jb.a.oh,this.t4,Object(u.a)(this,this.x$i,"tableOnKeyUpHandler"));const b=this.t4.tBodies[0].children;for(let h=0;h<b.length;h++)if(Bf.a.addHandler(b[h],
jb.a.focus,Object(u.a)(this,this.DTi,"rowOnFocusHandler")),Bf.a.addHandler(b[h],jb.a.blur,Object(u.a)(this,this.CTi,"rowOnBlurHandler")),X.a.Ak){const r=b[h].children;for(let z=0;z<r.length;z++)Bf.a.addHandler(r[z],jb.a.focus,Object(u.a)(this,this.Ykh,"cellOnFocusHandler"))}}super.Kja()}Sbb(){this.ke&&(this.ke.sc(jb.a.li,this.pzd,Object(u.a)(this,this.t6g,"accHelpDialogKeydownHandler")),this.t4&&this.ke.sc(jb.a.oh,this.t4,Object(u.a)(this,this.x$i,"tableOnKeyUpHandler")));if(this.t4){const b=this.t4.tBodies[0].children;
for(let h=0;h<b.length;h++)if(Bf.a.removeHandler(b[h],jb.a.focus,Object(u.a)(this,this.DTi,"rowOnFocusHandler")),Bf.a.removeHandler(b[h],jb.a.blur,Object(u.a)(this,this.CTi,"rowOnBlurHandler")),X.a.Ak){const r=b[h].children;for(let z=0;z<r.length;z++)Bf.a.removeHandler(r[z],jb.a.focus,Object(u.a)(this,this.Ykh,"cellOnFocusHandler"))}}super.Sbb()}JDa(){this.PWa.scope.Dr(this.Wb.EV);this.PWa.scope.Dr(this.Wb.FV);this.PWa.scope.bindAction(this.Wb.EV,ab.a.Nxc);this.PWa.scope.bindAction(this.Wb.FV,ab.a.Mxc)}KUl(b){if(!this.PWa.Vj||
!this.PWa.Vj.N1)return 2;var h=this.PWa.Vj.N1;if(this.t4&&(h===this.hz&&b===ab.a.Nxc||h===this.dTa&&b===ab.a.Mxc))this.uU(this.ltb);else if(h.id.startsWith("SelectableTableRow"))h=null,b===ab.a.Nxc?h=this.dTa:b===ab.a.Mxc&&(h=this.hz),h&&this.uU(h);else if(b===ab.a.Nxc)this.PWa.P9b();else if(b===ab.a.Mxc)this.PWa.N9b();else return 2;return 32}DTi(b){b.target.setAttribute(vf.a.eab,vf.a.Ho);Sys.UI.DomElement.removeCssClass(this.ltb,"inactiveRowSelection");this.ltb=b.target}CTi(b){b.target.removeAttribute(vf.a.eab);
Sys.UI.DomElement.addCssClass(b.target,"inactiveRowSelection")}Ykh(b){(b=b.target.parentNode)&&b!==this.ltb&&this.uU(b)}x$i(b){return b.Ib.keyCode===wb.a.es?(b.Ib.stopPropagation(),!0):!1}t6g(b){if(!b.Ib)return!1;const h=b.Ib.keyCode;if(b.eventName===jb.a.li){b=this.Jvl(this.ltb);let r=-1;const z=Na.a.count(this.U7d)-1;h===Sys.UI.Key.down?r=b<z?b+1:0:h===Sys.UI.Key.up?r=0<b?b-1:z:h===Sys.UI.Key.home?r=0:h===Sys.UI.Key.end&&(r=z);-1!==r&&this.uU(this.t4.tBodies[0].children[r])}return!0}P_j(){}L5m(){this.pzd=
document.getElementById("AccessibilityHelpDialogBody")||this.mv;this.ONk();this.wNk();this.rLk()}ONk(){if(this.N3e){var b=document.createElement("div");b.className="WACDialogSubtitle";var h=document.createElement("span");h.innerText=this.N3e;b.appendChild(h);this.cia.appendChild(b)}}wNk(){if(this.U7d&&!Na.a.isEmpty(this.U7d)){this.t4=document.createElement("table");this.t4.className="SelectableDialogTable";var b=document.createElement("thead"),h=document.createElement("tr");h.setAttribute(vf.a.Ch,
vf.a.ezc);b.appendChild(h);var r=$e.a.DCc(14,this.iAk);h.appendChild(r);r=$e.a.DCc(14,this.YRn);h.appendChild(r);this.t4.appendChild(b);b=document.createElement("tbody");h=0;r=this.U7d;for(let ba in r){var z=ba,R=r[ba];const ta=document.createElement("tr");ta.tabIndex=0;ta.setAttribute(vf.a.Ch,vf.a.ezc);ta.id="SelectableTableRow"+h++;z=$e.a.DCc(15,z);ta.appendChild(z);R=$e.a.DCc(15,R);ta.appendChild(R);b.appendChild(ta)}b.style.maxHeight=this.J5n+"px";this.t4.appendChild(b);this.pzd.appendChild(this.t4)}}rLk(){if(this.Rri&&
this.Sri){var b=document.createElement("div");b.className="WACDialogLearnMoreLinkContainer";this.dTa=document.createElement("a");this.dTa.innerText=this.Rri;this.dTa.href=this.Sri;this.dTa.target="_blank";this.dTa.id=this.qj("AccessibilityHelpDialogLink");this.dTa.className=ke.AFrame.nQe;b.appendChild(this.dTa);this.ed.insertBefore(b,this.ed.lastChild)}}Jvl(b){return Number.parseInvariant(b.id.substr(18))}k1(b,h,r,z=null){b&&h&&r&&(r=z?String.format(r,z):r,b[h]=r)}rZh(b,h){return X.a.xl?h:b}}Object(n.a)(AF,
"AAccessibilityHelpDialog",Wc.a,[946]);class PB extends AF{constructor(b){super(b)}get sKa(){return WordEditorIntl.WordEditorStrings.L_AccHelpDialogWETitle}get N3e(){return WordEditorIntl.WordEditorStrings.L_AccHelpDialogWESubtitle}S2l(){const b=this.rZh(CommonUIStrings.l_AccHelpDialogCtrlKey,CommonUIStrings.l_AccHelpDialogCommandKey),h=this.rZh(CommonUIStrings.l_AccHelpDialogWindowsKey,CommonUIStrings.l_AccHelpDialogCtrlKey),r={};this.k1(r,CommonUIStrings.l_AccHelpDialogAccHelpCommand,CommonUIStrings.l_AccHelpDialogAccHelpShortcut);
this.k1(r,CommonUIStrings.l_AccHelpDialogLandmarkRegionsCommand,CommonUIStrings.l_AccHelpDialogLandmarkRegionsShortcut,b);this.k1(r,CommonUIStrings.l_AccHelpDialogTellMeCommand,CommonUIStrings.l_AccHelpDialogTellMeShortcut);this.k1(r,CommonUIStrings.l_AccHelpDialogAccessKeysCommand,CommonUIStrings.l_AccHelpDialogAccessKeysShortcut,h);this.k1(r,CommonUIStrings.l_AccHelpDialogTooltipToggle,CommonUIStrings.l_AccHelpDialogTooltipToggleShortcut,b);this.k1(r,WordEditorIntl.WordEditorStrings.L_AccHelpDialogShowNextFootnoteCommand,
WordEditorIntl.WordEditorStrings.L_AccHelpDialogShowNextFootnoteShortcut,b);this.k1(r,WordEditorIntl.WordEditorStrings.L_AccHelpDialogShowNextEndnoteCommand,WordEditorIntl.WordEditorStrings.L_AccHelpDialogShowNextEndnoteShortcut,b);this.k1(r,WordEditorIntl.WordEditorStrings.L_AccHelpDialogShowNextCommentCommand,WordEditorIntl.WordEditorStrings.L_AccHelpDialogShowNextCommentShortcut);ja.App.dee&&this.k1(r,WordEditorIntl.WordEditorStrings.L_AccHelpDialogAccCheckerCommand,WordEditorIntl.WordEditorStrings.L_AccHelpDialogAccCheckerShortcut,
b);this.k1(r,WordEditorIntl.WordEditorStrings.L_AccHelpDialogTrackChangesToggleCommand,WordEditorIntl.WordEditorStrings.L_AccHelpDialogTrackChangesToggleShortcut,b);this.k1(r,WordEditorIntl.WordEditorStrings.L_AccHelpDialogTrackChangesAcceptCommand,WordEditorIntl.WordEditorStrings.L_AccHelpDialogTrackChangesAcceptShortcut,b);this.k1(r,WordEditorIntl.WordEditorStrings.L_AccHelpDialogTrackChangesRejectCommand,WordEditorIntl.WordEditorStrings.L_AccHelpDialogTrackChangesRejectShortcut,b);this.k1(r,WordEditorIntl.WordEditorStrings.L_AccHelpDialogTrackChangesPreviousCommand,
WordEditorIntl.WordEditorStrings.L_AccHelpDialogTrackChangesPreviousShortcut,b);this.k1(r,WordEditorIntl.WordEditorStrings.L_AccHelpDialogTrackChangesNextCommand,WordEditorIntl.WordEditorStrings.L_AccHelpDialogTrackChangesNextShortcut,b);t.AFrameworkApplication.K&&t.AFrameworkApplication.K.$("AccessibleMovingDialogsEnabled")&&this.k1(r,CommonUIStrings.l_AccHelpDialogOpenDialogMenuCommand,CommonUIStrings.l_AccHelpDialogOpenDialogMenuShortcut);t.AFrameworkApplication.K.$("CatchUpActivityIsEnabled")&&
this.k1(r,WordEditorIntl.WordEditorStrings.L_AccHelpDialogActivityAnnouncementsCommand,WordEditorIntl.WordEditorStrings.L_AccHelpDialogActivityAnnouncementsShortcut);(PB.Qb&&PB.Qb.isFeatureEnabled(63)||t.AFrameworkApplication.K.$("WordEditorIdeasCardsIsEnabled"))&&this.k1(r,WordEditorIntl.WordEditorStrings.L_ShowIntentSuggestion,WordEditorIntl.WordEditorStrings.L_ShowIntentSuggestionShortcut);return r}static get Qb(){return null!=PB.rjg?PB.rjg:PB.rjg=Sa.a.instance.Pa("Box4.IFeatureHelper")}}Object(n.a)(PB,
"AccessibilityHelpDialog",AF,[]);class wE{static get vg(){return Wc.a.Px(wE.sl,WordEditorIntl.WordEditorStrings.l_StyleName,WordEditorIntl.WordEditorStrings.l_BadStyleName)}}wE.sl="<div class='normal' id='text'> <label id='IntroLabel' class='WACDialogLabel' for='styleText' >{0}</label> <input type='text' id='styleText' class='WACDialogInput' autocomplete=\"off\"/> </div> <div class='normal' id='list'> <select class='UIFont WACDialogList' id='styleList' size='9'> </select> </div> <div class='normal' id='text'> <div class='WACDialogError' id='badStyleError' role='alert'>{1}</div> </div>";
Object(n.a)(wE,"ApplyStylesDialogHtml",null,[]);class BC extends Wc.a{constructor(b,h){super();this.AG=null;this.lwc=!1;this.vub=this.v5a=this.Esc=this.Hsc=this.Awc=null;this.fek=(r,z)=>{if(this.Ef.Qr){if(r){r=z.styleList;z=z.styleText;if(-1===r||B.a.mh(z)!==B.a.mh(this.AG[r]))r=this.KZh(z);z=this.AG[r];r=this.oc.Kp();z=this.oc.rf(r.eta(z));t.AFrameworkApplication.ya.Qf(this._context,Fb.a.applyStyle,2,!1,new YC.a,z)}this.Ef.RX()}};this.dYm=r=>{this.lwc?(this.lwc=!1,this.validate()):"value"===r.rawEvent.propertyName&&
(this.lwc=!0,this.gN.value!==this.Awc&&(this.Awc=this.gN.value,this.Xeh()))};this.YTm=()=>{-1!==this.gja.selectedIndex&&(X.a.QB&&(this.lwc=!0),this.Awc=this.AG[this.gja.selectedIndex],this.gN.value=this.AG[this.gja.selectedIndex],this.validate())};this.onKeyDown=r=>{X.a.aJ?r.keyCode!==wb.a.bB&&r.keyCode!==wb.a.W_||this.v5a||this.vub||(this.vub=new Ic.a(0,1,1,this.upo),t.AFrameworkApplication.uc.$b(this.vub)):X.a.QB&&r.keyCode===wb.a.bB&&(this.lwc=!0)};this.KF=()=>{this.v5a||(this.v5a=new Ic.a(0,1,
1,this.ngk),t.AFrameworkApplication.uc.$b(this.v5a));this.vub&&(t.AFrameworkApplication.uc.We(this.vub),this.vub=null)};this.ngk=()=>{this.v5a=null;this.Xeh()};this.upo=()=>{this.vub=null;this.validate()};this._context=b;this.Ac=h;this.kg="ApplyStylesDialog";this.Ef=this._context.view;this.Xhf();b=this.J3n();h="";this.AG.length>b&&(h=this.AG[b]);h={["styleText"]:h,["styleList"]:b};this.vg=wE.vg;this.Wh(WordEditorIntl.WordEditorStrings.l_ApplyStyles,this.fek,h);this.gja=document.getElementById("styleList");
this.eMf();this.gja.selectedIndex=b;this.gN=document.getElementById("styleText");this.gN.focus();this.gN.select();this.mhd=this.YTm;Bf.a.addHandler(this.gja,"change",this.mhd);this.lhd=this.onKeyDown;Bf.a.addHandler(this.gN,"keydown",this.lhd);X.a.QB?(this.Hsc=this.dYm,Bf.a.addHandler(this.gN,"propertychange",this.Hsc),this.Awc=this.AG[b]):(this.Esc=this.KF,Bf.a.addHandler(this.gN,"keypress",this.Esc))}get oc(){return null!=this.Usg?this.Usg:this.Usg=Sa.a.instance.resolve("Box4.Styles.IWACStyleReader")}J3n(){var b=
this.Ef.Cb;if(!b||!b.hb)return ud.b(579216408,3018,15,"Unable to retrieve valid SelectionCollection"),0;b=b.hb.kb;if(!b)return ud.b(579216409,3018,15,"CurrentSelection is null"),0;ie.ParagraphReader.gm(b.Qa)&&(b=Xd.SelectionEditor.Pj(b,!0,!1));b=b.Qa;if(!b||!Xd.SelectionEditor.du(b))return ud.b(579216410,3018,15,"Received invalid nodeContext, null={0}",!b),0;var h=Aj.FormattingReader.Pr(b);(h=Aj.FormattingReader.gta(h))||(h=this.oc.yo(b.node));if(!h)return 0;b=this.oc.zF(h);b=Array.indexOf(this.AG,
b);0>b&&(b=0);return b}eMf(){const b=this.AG.length;for(let h=0;h<b;h++){const r=document.createElement("OPTION");r.value=h.toString();r.text=this.AG[h];this.gja.add(r,null)}}Xhf(){var b=uj.a.Rw();if(b){b=(new Nv.WACStyleSet).XN(b);var h=b.yN,r=this.Ac.isFeatureEnabled(118)&&!!this.oc.Yg;this.AG=[];for(let z=0;z<h;z++){const R=b.xla(z);if(this.oc.isHidden(R))continue;const ba=this.oc.Uw(R);if(!r){if(3===ba)continue}else if(3===ba&&this.oc.rf(R)===Ep.a.$4c)continue;Array.add(this.AG,this.oc.zF(R))}this.AG.sort(BC.OBk)}else ud.b(577644352,
3018,15,"Couldn't find PageContentNode")}dispose(){this.Hsc&&Bf.a.removeHandler(this.gN,"propertychange",this.Hsc);this.lhd&&Bf.a.removeHandler(this.gN,"keydown",this.lhd);this.mhd&&Bf.a.removeHandler(this.gja,"change",this.mhd);this.Esc&&Bf.a.removeHandler(this.gN,"keypress",this.Esc);this.v5a&&t.AFrameworkApplication.uc.We(this.v5a);this.v5a=this.Esc=this.gja=this.gN=this.lhd=this.Hsc=this.mhd=null;super.dispose()}Xeh(){var b=this.gN.value,h=this.T0l(b);const r=-1===h?b:this.AG[h];b=b.length;const z=
r.length;this.Awc=r;this.gN.value=r;this.gja.selectedIndex=h;z>b&&(X.a.aJ?this.gN.setSelectionRange(b,z):X.a.QB&&(h=this.gN.createTextRange(),h.collapse(!0),h.moveStart("character",b),h.moveEnd("character",z-b),h.select()));this.validate();this.gN.focus()}T0l(b){let h=0,r=this.AG.length,z=-1;for(b=B.a.mh(b);h<r;){const R=Math.floor((h+r)/2),ba=BC.sYe(b,this.AG[R]);if(!ba){z=R;break}0<ba?h=R+1:r=R}if(z>h)for(;!BC.sYe(b,this.AG[z-1])&&(z--,z!==h););return z}validate(){const b=-1===this.KZh(this.gN.value),
h=document.getElementById("badStyleError");b?(h.style.display="inline-block",h.innerText=WordEditorIntl.WordEditorStrings.l_BadStyleName):(h.style.display="none",h.innerText="");return!b}KZh(b){b=B.a.mh(b);const h=this.AG.length;for(let r=0;r<h;r++)if(b===B.a.mh(this.AG[r]))return r;return-1}static sYe(b,h){const r=Math.min(b.length,h.length);b=B.a.mh(b);h=B.a.mh(h);for(let z=0;z<r;z++){const R=B.a.charCodeAt(b,z),ba=B.a.charCodeAt(h,z);if(R!==ba)return R-ba}return b.length<=h.length?0:1}static OBk(b,
h){return BC.sYe(b,h)}}Object(n.a)(BC,"ApplyStylesDialog",Wc.a,[]);class xE{static get vg(){return Wc.a.Px(xE.sl,WordEditorIntl.WordEditorStrings.l_CreateNewStyleDialogName,WordEditorIntl.WordEditorStrings.l_CreateNewStyleDialogParagraphPreview,WordEditorIntl.WordEditorStrings.l_StyleNameAlreadyExists)}}xE.sl="<div class='normal' id='text'> <label id='NameLabel' class='WACDialogLabel' for='styleText' >{0}</label> <input type='text' id='styleText' class='WACDialogInput' autocomplete=\"off\"/> </div> <br/> <div class='normal' id='text'> <label id='ParagraphLabel' class='WACDialogLabel' >{1}</label> <div id='previewContainer' class='previewContainer' style='height: 40px; border: solid 1px #c3cbd0; position: relative; overflow: hidden;'></div> </div> <div class='normal' id='text'> <div class='WACDialogError' id='badStyleNameError' role='alert'>{2}</div> </div>";
Object(n.a)(xE,"CreateNewStyleDialogHtml",null,[]);class os extends Wc.a{constructor(b,h,r=!1){super(!1,!1,r);this.vx=null;this._context=b;this.ga=h;r=h=null;this.kg=os.id;if(this.Ef=b.view)r=this.Ef.Cb;r&&r.hb&&r.hb.kb&&(h=r.hb.kb.Qa);h?(b=h.node)?(this.qz=os.qh.ju(b))?(this.JC=(new Nv.WACStyleSet).XN(this.qz),(this.UR=this.U1b.kCd(h))?(b=this.UR.ia(We.a.fontSize,22),16>b?ud.b(593078050,3018,50,"Font size less than 8pt in create new style dialog preview"):52>=b?ud.b(593078049,3018,50,"Font size between 8pt and 26pt in create new style dialog preview"):
90>=b?ud.b(593078048,3018,50,"Font size between 26pt and 45 pt in create new style dialog preview"):ud.b(593078047,3018,50,"Font size more than 45pt in create new style dialog preview"),this.ASf(this.UR)):ud.b(592737758,3018,10,"_newStyleProperties is null.")):ud.b(592737757,3018,10,"_pageContenNode is null."):ud.b(592725466,3018,10,"node is null."):ud.b(556917206,3018,10,"nodeContext is null.")}ASf(b){b.Qg(Ij.a.paragraphStyle,Ij.a.tB,...Zl.a.aH())}get U1b(){return this.vx||(this.vx=Sa.a.instance.resolve("Box4.IFormattingReader"))}get oc(){return null!=
this.atg?this.atg:this.atg=Sa.a.instance.resolve("Box4.Styles.IWACStyleReader")}Sff(b){if(!b)return"";const h=WordEditorIntl.WordEditorStrings.l_CreateNewStyleDialogDefaultStyle,r=b.yN;let z;for(z=1;z<=r;z++){const R=h+z;let ba=b.xh(R)||b.M3b(R);ba||(ba=b.xh(R+"Char")||b.M3b(R+"Char"));if(!ba)break}return h+z}hyc(b,h){const r=new yf.GraphTransaction(15);r.Db(this.qz);r.Al=Fb.a.createNewStyle;if(h=uj.a.hyc(b,uj.a.sXh(h),null,this.qz))ud.b(593078046,3018,50,"User created linked style"),this.JC=(new Nv.WACStyleSet).XN(this.qz),
b=B.a.ova(B.a.BZ(b)),b=this.JC.M3b(b),this.ga.Qf(this._context,Fb.a.applyStyle,2,!1,new YC.a,this.oc.rf(b));r.dispose();return h}Bkj(b){var h=B.a.ova(b);const r=""===B.a.ova(b),z=b.length>os.zFm,R=RegExp("[{|}|;|\\\\]").test(b);b=!!this.JC.eta(b)||!!this.JC.M3b(h);h=null;if(r||z||R||b)h=r?WordEditorIntl.WordEditorStrings.l_StyleNameEmpty:z?WordEditorIntl.WordEditorStrings.l_StyleNameOverMaxLength:R?WordEditorIntl.WordEditorStrings.l_StyleNameRestrictedCharacters:WordEditorIntl.WordEditorStrings.l_StyleNameAlreadyExists;
return h}static get qh(){return ml.PageNavigator.instance}}os.id="CreateNewStyleDialog";os.vUd=26;os.zFm=253;os.W8i=5;os.V8i=40;Object(n.a)(os,"ACreateNewStyleDialog",Wc.a,[]);class rH extends os{constructor(b,h){super(b,h);this.CLk=r=>{this.Ef.Qr&&(r&&(r=new Map,r.set("Source","CreateNewStyleDialog"),r.set("Action","CreateStyle"),Ca.Health.instance.recordKpiUsage(Zl.a.Imb,0,Zl.a.EB,r),this.hyc(this.gN.value,this.UR)||(r=new Map,r.set("Source","CreateNewStyleDialog"),r.set("Action","CreateStyle"),
r=Object.assign(new eb.a,{extendedProperties:r}),Ca.Health.instance.recordKpiFailure(Zl.a.Imb,"CreateStyleFailed",!1,!0,r))),this.Ef.RX())};this.qz&&this.UR&&(b=this.Sff(this.JC),h={["styleText"]:b},this.vg=xE.vg,this.Wh(WordEditorIntl.WordEditorStrings.l_CreateNewStyle,this.CLk,h),this.gN=document.getElementById("styleText"),this.uU(this.gN),h=document.getElementById("previewContainer"),this.bPn(this.UR,b,h),this.M$c=document.getElementById("badStyleNameError"))}lol(b){const h=b.ia(We.a.fontSize,
Cl.a.OJ)>=2*os.vUd;b=Jb.a.ePh(b,"97%",os.vUd,!1,!0,h)+" padding-left: "+os.W8i+"px;";h||(b=b+" line-height: "+os.V8i+"px;");return b}bPn(b,h,r){const z=document.createElement("div");z.innerText=h;b=this.lol(b);z.setAttribute("style",b);r.appendChild(z)}validate(){const b=this.Bkj(this.gN.value),h=!!b;h?(this.M$c.style.display="inline-block",this.M$c.innerText=b):(this.M$c.style.display="none",this.M$c.innerText="");return!h}}Object(n.a)(rH,"CreateNewStyleDialog",os,[]);var CC=d(345);class sH extends te.StandardDialog{constructor(b){super();
this.Vu=b;this.NWn()}NWn(){this.Fd=1;this.tU(1);this.Ve(1,Box4Intl.Box4Strings.l_DeleteSavedStylesDialogOKText);this.Pv(Box4Intl.Box4Strings.l_DeleteSavedStylesDialogTitleText,Box4Intl.Box4Strings.l_DeleteSavedStylesDialogMessageText,1,this.k3e.bind(this))}k3e(b){1===b&&this.Vu.Qga("saveWordUserPreferenceSaveStyleSetting","{}").continueWith(h=>{h.Ji?ud.b(524834400,3018,10,"DeleteSavedSytles: Task Faulted.Exception:{0} Stack:{1}",h.exception,h.exception.stack):(this.fxn(),ud.b(524834399,3018,50,"User deleted saved styles via UI."))},
8)}fxn(){CC.a.tmb="{}"}}Object(n.a)(sH,"DeleteSavedStylesConfirmationDialog",te.StandardDialog,[]);class tH extends te.StandardDialog{constructor(b,h){super();this.k3e=R=>{if(1===R){R=new Map;R.set("Source","DeleteStyleConfirmationDialog");R.set("Action","DeleteStyle");Ca.Health.instance.recordKpiUsage(Zl.a.Imb,0,Zl.a.EB,R);var ba=uj.a.Rw();R=new yf.GraphTransaction(15);R.Db(ba);R.Al=Fb.a.dyb;this.eR.GSk(this.M1g)?ud.b(578359694,3018,50,"User deleted a style via UI."):(ba=new Map,ba.set("Source",
"DeleteStyleConfirmationDialog"),ba.set("Action","DeleteStyle"),ba=Object.assign(new eb.a,{extendedProperties:ba}),Ca.Health.instance.recordKpiFailure(Zl.a.Imb,"DeleteStyleFailed",!1,!0,ba),ud.b(578359695,3018,50,"User tried to delete a style via UI, but we were unable to delete it."));R.dispose()}};h||ud.b(590128417,3018,10,"styleId is null");let r=null,z=null;if(this.Ef=b.view)z=this.Ef.Cb;z&&(r=z.hb.kb.Qa);r?(b=r.node)?(this.qz=this.qh.ju(b))?(this.M1g=new Ua.a,this.M1g.add(h),this.OWn(h)):ud.b(590128448,
3018,10,"_pageContenNode is null."):ud.b(590128419,3018,10,"node is null."):ud.b(590128418,3018,10,"nodeContext is null.")}get eR(){return null!=this.Hsg?this.Hsg:this.Hsg=Sa.a.instance.resolve("Box4.Styles.IWACStyleEditor")}get oc(){return null!=this.ctg?this.ctg:this.ctg=Sa.a.instance.resolve("Box4.Styles.IWACStyleReader")}get qh(){return null!=this.bpg?this.bpg:this.bpg=ml.PageNavigator.instance}OWn(b){const h=(new Nv.WACStyleSet).XN(this.qz);h?((b=h.xh(b))||ud.b(590128450,3018,10,"Style set doesn't contain style with given ID"),
b=this.oc.zF(b),this.Fd=4,this.tU(2),this.Pv(CommonUIStrings.l_DefaultDialogTitle,String.format(WordEditorIntl.WordEditorStrings.l_DeleteStyleConfirmationDialogMessage,b),0,this.k3e)):ud.b(590128449,3018,10,"Can't retrieve style set from page content node")}}Object(n.a)(tH,"DeleteStyleConfirmationDialog",te.StandardDialog,[]);class yE{static get vg(){return Wc.a.Px(yE.sl)}}yE.sl="<div class='normal' id='list'> <select class='UIFont WACDialogList' id='styleList' size='9'> </select> </div>";Object(n.a)(yE,
"DeleteStyleDialogHtml",null,[]);class uH extends Wc.a{constructor(b){super();this.qz=this.AG=null;this.oTk=(h,r)=>{this.Ef.Qr&&(h?(h=r.styleList,-1!==h&&(h=this.AG[h],r=this.oc.Kp(),h=this.oc.rf(r.eta(h)),this.K3e.nTk(this._context,h),this.Ef.RX())):this.Ef.RX())};this._context=b;this.kg="DeleteStyleDialog";this.Fd=1;this.Ve(1,WordEditorIntl.WordEditorStrings.l_DeleteStyleDialogButton);this.Ef=this._context.view;this.Xhf();this.vg=yE.vg;this.Wh(WordEditorIntl.WordEditorStrings.l_DeleteStyle,this.oTk,
{["styleList"]:0});this.gja=document.getElementById("styleList");this.eMf();this.gja.selectedIndex=0;this.gja.focus()}get oc(){return null!=this.Wsg?this.Wsg:this.Wsg=Sa.a.instance.resolve("Box4.Styles.IWACStyleReader")}get K3e(){return null!=this.jig?this.jig:this.jig=Sa.a.instance.resolve("WordEditor.UI.IDialogFactory")}eMf(){const b=this.AG.length;for(let h=0;h<b;h++){const r=document.createElement("OPTION");r.value=h.toString();r.text=this.AG[h];this.gja.add(r,null)}}Xhf(){if(this.qz=uj.a.Rw()){var b=
(new Nv.WACStyleSet).XN(this.qz),h=b.yN;this.AG=[];for(let z=0;z<h;z++){const R=b.xla(z);if(!this.oc.isHidden(R)&&this.oc.oe(R,b)){var r=this.oc.Uw(R);if(2===r||1===r)R.hasProperty(yc.a.Gc)&&2!==r||(r=R.ia(yc.a.gF,null))&&0<r.length||this.AG.push(this.oc.zF(R))}}this.AG.sort()}else ud.b(578650370,3018,15,"PageContentNode is null")}}Object(n.a)(uH,"DeleteStyleDialog",Wc.a,[]);var FL=d(764);class vH{constructor(b){this.customData=null;this.MN=b}}Object(n.a)(vH,"PropertySetChangedState",null,[]);class wH{static A9m(b,
h,r){if(b&&h){var z=new vH(h),R=(ba,ta,Wa)=>{r.z9m(ba,ta,Wa,z)};b=new FL.a(h,b);b.prd=R;b.nud=R;b.U3d=R;b.mbc()}}}Object(n.a)(wH,"PropertySetChangedManager",null,[]);class xH{constructor(b){this.MY=b}z9m(b,h,r,z){const R=this.MY[b.id.toString()];R&&R(b,h,r,z)}}Object(n.a)(xH,"PropertyChangedProcessor",null,[]);const DC=(b,h,r)=>{const z=yr.a.instance.D1b;if(z){const R=new yf.GraphTransaction(15);R.Db(z);wH.A9m(b,h,new xH(r));R.dispose()}};class zE{static get vg(){return Wc.a.Px(zE.sl,WordEditorIntl.WordEditorStrings.l_MarginsDialogMarginTop,
WordEditorIntl.WordEditorStrings.l_MarginsDialogMarginLeft,WordEditorIntl.WordEditorStrings.l_MarginsDialogMarginBottom,WordEditorIntl.WordEditorStrings.l_MarginsDialogMarginRight)}}zE.sl="<div class='WACDialogRow' id='RowMargins'> <div class='WACDialogGroupBox' id='MarginsDialogTopLeftBox'> <div class='WacDialogLabels' id='MarginsDialogTopLeftLabels'> <label id='MarginsDialogMarginTop' class='DialogSpinnerLabel' >{0}</label> <br/> <label id='MarginsDialogMarginLeft' class='DialogSpinnerLabel' >{1}</label> <br/> </div> <div class='WacSpinnerBoxes' id='MarginsDialogTopLeftSpinners'> <div id='MarginsDialogMarginTopSpinnerContainer' class='WacSpinnerBox'></div> <br/> <div id='MarginsDialogMarginLeftSpinnerContainer' class='WacSpinnerBox'></div> <br/> </div> </div> <div class='WACDialogGroupBox MarginsDialogRightChunk' id='MarginsDialogBottomRightBox'> <div class='WacDialogLabels' id='MarginsDialogBottomRightLabels'> <label id='MarginsDialogMarginBottom' class='DialogSpinnerLabel' >{2}</label> <br/> <label id='MarginsDialogMarginRight' class='DialogSpinnerLabel' >{3}</label> <br/> </div> <div class='WacSpinnerBoxes' id='MarginsDialogBottomRightSpinners'> <div id='MarginsDialogMarginBottomSpinnerContainer' class='WacSpinnerBox'></div> <br/> <div id='MarginsDialogMarginRightSpinnerContainer' class='WacSpinnerBox'></div> <br/> </div> </div> </div>";
Object(n.a)(zE,"MarginsDialogHtml",null,[]);class sp{static get d_(){return null!=sp.Pog?sp.Pog:sp.Pog=Sa.a.instance.Pa("WordEditor.IPageCommands")}static qEm(b,h,r){sp.d_&&null!==r&&sp.d_.c7d(0,r)}static mEm(b,h,r){sp.d_&&null!==r&&sp.d_.c7d(3,r)}static oEm(b,h,r){sp.d_&&null!==r&&sp.d_.c7d(1,r)}static pEm(b,h,r){sp.d_&&null!==r&&sp.d_.c7d(2,r)}static k1m(b,h,r){sp.d_&&null!==r&&sp.d_.xPa(0,r)}static M0m(b,h,r){sp.d_&&null!==r&&sp.d_.xPa(1,r)}static yzk(b,h,r){sp.d_&&null!==r&&sp.d_.FXf(0,r)}static Kzk(b,
h,r){sp.d_&&null!==r&&sp.d_.FXf(1,r)}static Izk(b,h,r){sp.d_&&null!==r&&sp.d_.FXf(2,r)}}Object(n.a)(sp,"PageLevelPropertyChangedHandlers",null,[]);class nu extends Wc.a{constructor(b,h,r,z,R,ba){super();this.Igb=ba;this.Msa=(ta,Wa)=>{var ub=nu.fjb(ta);ta=vb.App.kaa;this.Ae.hasProperty(ub)?(ub=this.Ae.getValue(ub),Wa[Cc.a.Number]=pg.a.Gba(ub,ta)):Wa[Cc.a.Number]=0;Wa[Cc.a.UnitType]=ta};this.Cva=(ta,Wa)=>{this.Ae.setValue(nu.fjb(ta),pg.a.zQa(Wa[Cc.a.Number],Wa[Cc.a.UnitType]));this.kp.yl()};this.sEm=
ta=>{let Wa=!1;1===ta&&(Math.abs(this.Ae.getValue(yc.a.marginTop))+Math.abs(this.Ae.getValue(yc.a.marginBottom))+vb.App.wwa<=this.aL.getValue(yc.a.ay)&&this.Ae.getValue(yc.a.marginLeft)+this.Ae.getValue(yc.a.marginRight)+vb.App.wwa<=this.aL.getValue(yc.a.Lo)?DC(this.ZM,this.Ae,nu.IYa()):Wa=!0);this.dispose();Wa&&this.Eva(WoncaIntl.WoncaStrings.l_MarginSetFailedMessage,this.nEm)};this.nEm=()=>{Sa.a.instance.resolve("WordEditor.UI.IDialogFactory").kuh(this.ZM,this.aL,this.VO)};this.kg="MarginsDialog";
this.aL=h.clone();this.ZM=b.clone();this.Ae=b.clone();this.VO=r;this.zR=!1;this.kp=R;this.vg=zE.vg;r&&(this.tob=kr.a.R3a);this.Wh(WordEditorIntl.WordEditorStrings.L_PageMargins,this.sEm,null);this.hCb();this.Igb&&(this.oIe=document.getElementById("DialogMarginTopSpinner"),this.uU(this.oIe))}cU(){this.mtd("MarginsDialogMarginTopSpinnerContainer","DialogMarginTopSpinner",Oa.a.cUc,Oa.a.s1d,WordEditorIntl.WordEditorStrings.l_MarginsDialogMarginTopAlt);this.mtd("MarginsDialogMarginBottomSpinnerContainer",
"DialogMarginBottomSpinner",Oa.a.bUc,Oa.a.p1d,WordEditorIntl.WordEditorStrings.l_MarginsDialogMarginBottomAlt);this.mtd("MarginsDialogMarginLeftSpinnerContainer","DialogMarginLeftSpinner",Oa.a.cZd,Oa.a.q1d,WordEditorIntl.WordEditorStrings.l_MarginsDialogMarginLeftAlt);this.mtd("MarginsDialogMarginRightSpinnerContainer","DialogMarginRightSpinner",Oa.a.dZd,Oa.a.r1d,WordEditorIntl.WordEditorStrings.l_MarginsDialogMarginRightAlt)}hCb(){for(let b=0;b<nu.B7.length;b++)Eh.a.Jja(nu.B7[b],this.Cva,this.Msa);
this.kp.gM("DialogMarginTopSpinner");this.kp.gM("DialogMarginBottomSpinner");this.kp.gM("DialogMarginLeftSpinner");this.kp.gM("DialogMarginRightSpinner")}dispose(){for(let b=0;b<nu.B7.length;b++)Eh.a.jsa(nu.B7[b]);this.kp.RA("DialogMarginTopSpinner");this.kp.RA("DialogMarginBottomSpinner");this.kp.RA("DialogMarginLeftSpinner");this.kp.RA("DialogMarginRightSpinner");super.dispose()}mtd(b,h,r,z,R){r=nu.emk(h,r,z,R);this.DVa(r,b,h)}DVa(b,h,r){h=document.getElementById(h);this.kp.Pya(r,b);b=this.kp.hYa(r,
"Medium");h.appendChild(b)}static IYa(){return nu.MY||(nu.MY=nu.hKa())}static hKa(){const b={};b[yc.a.marginTop.id.toString()]=sp.qEm;b[yc.a.marginBottom.id.toString()]=sp.mEm;b[yc.a.marginLeft.id.toString()]=sp.oEm;b[yc.a.marginRight.id.toString()]=sp.pEm;return b}static emk(b,h,r,z){let R=!0;if(h===Oa.a.cUc||h===Oa.a.bUc)R=!1;return Kf.l(b,h,r,z,[nu.gmk(R),nu.fmk(R)])}static gmk(b){return Kf.n("inch",b?"0":"-22","22",".1")}static fmk(b){return Kf.n("centimeter",b?"0":"-55.8","55.8","1")}static fjb(b){let h=
null;switch(b){case Oa.a.cUc:case Oa.a.s1d:h=yc.a.marginTop;break;case Oa.a.bUc:case Oa.a.p1d:h=yc.a.marginBottom;break;case Oa.a.cZd:case Oa.a.q1d:h=yc.a.marginLeft;break;case Oa.a.dZd:case Oa.a.r1d:h=yc.a.marginRight}return h}}nu.B7=[Oa.a.cUc,Oa.a.bUc,Oa.a.cZd,Oa.a.dZd,Oa.a.s1d,Oa.a.p1d,Oa.a.q1d,Oa.a.r1d];nu.MY=null;Object(n.a)(nu,"MarginsDialog",Wc.a,[]);class AE{static get vg(){return Wc.a.Px(AE.sl,WordEditorIntl.WordEditorStrings.l_PaperSizeDialogWidth,WordEditorIntl.WordEditorStrings.l_PaperSizeDialogHeight)}}
AE.sl="<div class='WACDialogRow' id='RowPapeSize'> <div class='WacDialogLabels' id='PaperSizeDialogLabels'> <label id='PaperSizeDialogWidth' class='DialogSpinnerLabel' >{0}</label> <br/> <label id='PaperSizeDialogHeight' class='DialogSpinnerLabel' >{1}</label> <br/> </div> <div class='WacSpinnerBoxes' id='PaperSizeDialogSpinners'> <div id='PaperSizeDialogWidthSpinnerContainer' class='WacSpinnerBox'></div> <br/> <div id='PaperSizeDialogHeightSpinnerContainer' class='WacSpinnerBox'></div> <br/> </div> </div>";
Object(n.a)(AE,"PaperSizeDialogHtml",null,[]);class Oq extends Wc.a{constructor(b,h,r,z,R,ba){super();this.Igb=ba;this.Msa=(ta,Wa)=>{var ub=this.fjb(ta);ta=vb.App.kaa;this.Ae.hasProperty(ub)?(ub=this.Ae.getValue(ub),Wa[Cc.a.Number]=pg.a.Gba(ub,ta)):Wa[Cc.a.Number]=0;Wa[Cc.a.UnitType]=ta};this.Cva=(ta,Wa)=>{this.Ae.setValue(this.fjb(ta),pg.a.zQa(Wa[Cc.a.Number],Wa[Cc.a.UnitType]));this.kp.yl()};this.v1m=ta=>{let Wa=!1;1===ta&&(this.Ae.getValue(yc.a.ay)>=vb.App.wwa+this.aL.getValue(yc.a.marginTop)+
this.aL.getValue(yc.a.marginBottom)&&this.Ae.getValue(yc.a.Lo)>=vb.App.wwa+this.aL.getValue(yc.a.marginLeft)+this.aL.getValue(yc.a.marginRight)?DC(this.ZM,this.Ae,Oq.IYa()):Wa=!0);this.dispose();Wa&&this.Eva(WoncaIntl.WoncaStrings.l_PaperSizeSetFailedMessage,this.u1m)};this.u1m=()=>{Sa.a.instance.resolve("WordEditor.UI.IDialogFactory").Puh(this.ZM,this.aL,this.VO)};this.kg="PaperSizeDialog";this.aL=h.clone();this.ZM=b.clone();this.Ae=b.clone();this.VO=r;this.zR=!1;this.kp=R;this.vg=AE.vg;r&&(this.tob=
kr.a.R3a);this.Wh(WordEditorIntl.WordEditorStrings.l_PaperSizeDialogTitle,this.v1m,null);this.hCb();this.Igb&&(this.oIe=document.getElementById("DialogWidthSpinner"),this.uU(this.oIe))}cU(){this.Bhh("PaperSizeDialogWidthSpinnerContainer","DialogWidthSpinner",Oa.a.gZd,Oa.a.H1d,WordEditorIntl.WordEditorStrings.l_PaperSizeDialogWidthAlt);this.Bhh("PaperSizeDialogHeightSpinnerContainer","DialogHeightSpinner",Oa.a.fZd,Oa.a.G1d,WordEditorIntl.WordEditorStrings.l_PaperSizeDialogHeightAlt)}hCb(){for(let b=
0;b<Oq.B7.length;b++)Eh.a.Jja(Oq.B7[b],this.Cva,this.Msa);this.kp.gM("DialogWidthSpinner");this.kp.gM("DialogHeightSpinner")}dispose(){for(let b=0;b<Oq.B7.length;b++)Eh.a.jsa(Oq.B7[b]);this.kp.RA("DialogWidthSpinner");this.kp.RA("DialogHeightSpinner");super.dispose()}Bhh(b,h,r,z,R){r=Oq.vmk(h,r,z,R);this.DVa(r,b,h)}DVa(b,h,r){h=document.getElementById(h);this.kp.Pya(r,b);b=this.kp.hYa(r,"Medium");h.appendChild(b)}fjb(b){let h=null;switch(b){case Oa.a.fZd:case Oa.a.G1d:h=yc.a.ay;break;case Oa.a.gZd:case Oa.a.H1d:h=
yc.a.Lo}return h}static IYa(){return Oq.MY||(Oq.MY=Oq.hKa())}static hKa(){const b={};b[yc.a.Lo.id.toString()]=sp.k1m;b[yc.a.ay.id.toString()]=sp.M0m;return b}static vmk(b,h,r,z){return Kf.l(b,h,r,z,[Oq.xmk(),Oq.wmk()])}static xmk(){return Kf.n("inch",Oq.t6i,Oq.upm,Oq.q_n)}static wmk(){return Kf.n("centimeter",Oq.t6i,Oq.spm,Oq.p_n)}}Oq.B7=[Oa.a.gZd,Oa.a.fZd,Oa.a.H1d,Oa.a.G1d];Oq.t6i="0";Oq.upm="22";Oq.q_n=".1";Oq.p_n="1";Oq.spm="55.8";Oq.MY=null;Object(n.a)(Oq,"PaperSizeDialog",Wc.a,[]);class yH{constructor(){this.N6i=
this.eDi=this.dDi=this.B1m=this.iKf=!1}}Object(n.a)(yH,"Box4PropertySetChangedState",null,[]);class Lk{static get l5b(){return null!=Lk.olg?Lk.olg:Lk.olg=Sa.a.instance.Pa("Box4.IIndentationCommands")}static get sji(){return null!=Lk.mng?Lk.mng:Lk.mng=Sa.a.instance.Pa("Box4.IJustificationCommands")}static get NX(){return null!=Lk.tqg?Lk.tqg:Lk.tqg=Sa.a.instance.Pa("Box4.ISpacingCommands")}static rji(b,h,r){Lk.sji&&r&&(null===h||11!==r||10!==h&&9!==h)&&Lk.sji.sD(r)}static ali(b,h,r){Lk.NX&&r&&Lk.NX.hC(r)}static NEk(b,
h,r){h!=r&&Lk.NX.Sdc(r)}static Hom(b,h,r){h!=r&&Lk.NX.q_c(r)}static xro(b,h,r){h!=r&&Lk.NX.S_c(r)}static Fom(b,h,r){h!=r&&Lk.NX.p_c(r)}static UZd(b,h,r,z){Lk.NX&&void 0!==r&&null!==r&&(b=Lk.tHc(z),!b.iKf&&z.MN.hasProperty(od.a.rDa)&&z.MN.hasProperty(od.a.sDa)&&(h=z.MN.getValue(od.a.sDa),z=z.MN.getValue(od.a.rDa),b.iKf=!0,Lk.NX.Mga(1,h,z)))}static TZd(b,h,r,z){Lk.NX&&void 0!==r&&null!==r&&(b=Lk.tHc(z),!b.B1m&&z.MN.hasProperty(od.a.pDa)&&z.MN.hasProperty(od.a.qDa)&&(h=z.MN.getValue(od.a.qDa),z=z.MN.getValue(od.a.pDa),
b.iKf=!0,Lk.NX.Mga(0,h,z)))}static QZd(b,h,r,z){Lk.l5b&&void 0!==r&&null!==r&&(b=Lk.tHc(z),!b.dDi&&z.MN.hasProperty(od.a.Gaa)&&z.MN.hasProperty(od.a.Haa)&&(h=z.MN.getValue(od.a.Haa),z=z.MN.getValue(od.a.Gaa),b.dDi=!0,Lk.l5b.u_i(1,h,z)))}static RZd(b,h,r,z){Lk.l5b&&void 0!==r&&null!==r&&(b=Lk.tHc(z),!b.eDi&&z.MN.hasProperty(od.a.Rua)&&z.MN.hasProperty(od.a.Sua)&&(h=z.MN.getValue(od.a.Sua),z=z.MN.getValue(od.a.Rua),b.eDi=!0,Lk.l5b.u_i(0,h,z)))}static ifc(b,h,r,z){Lk.l5b&&void 0!==r&&null!==r&&(b=Lk.tHc(z),
!b.N6i&&z.MN.hasProperty(od.a.jba)&&z.MN.hasProperty(od.a.v_)&&(h=0,z.MN.hasProperty(od.a.ZI)&&(h=z.MN.getValue(od.a.ZI)),r=z.MN.getValue(od.a.v_),z=z.MN.getValue(od.a.jba),b.N6i=!0,Lk.l5b.t7d(h,r,z)))}static tHc(b){b.customData||(b.customData=new yH);return b.customData}}Object(n.a)(Lk,"ParagraphLevelPropertyChangedHandlers",null,[]);class Xi extends Wc.a{constructor(b,h,r,z,R,ba){super();this.LK=this.Nad=!1;this.kg="ParagraphDialog";Xi.NX=r;this.gw=ba;this.ZM=b.clone();this.Ae=b.clone();if(this.VO=
h)this.tob=kr.a.R3a}cU(){Xi.Chh(Xi.x0n,Xi.U6i,Fb.a.iac,Fb.a.Gbc,Fb.a.k3a,Box4Intl.Box4Strings.l_ParagraphDialogSpacingBeforeAlt,this.gw);Xi.Chh(Xi.w0n,Xi.T6i,Fb.a.hZd,Fb.a.S1d,Fb.a.Z0c,Box4Intl.Box4Strings.l_ParagraphDialogSpacingAfterAlt,this.gw);Xi.Ylk(Xi.v0n,Xi.X1f,this.gw);Xi.amk(Xi.urm,Xi.URd,this.gw)}pnf(){for(let b=0;b<Xi.z9d.length;b++)Eh.a.Jja(Xi.z9d[b],Object(u.a)(this,this.Cva,"setAdvancedControlValue"),Object(u.a)(this,this.Msa,"getAdvancedControlValue"));Eh.a.Jja(Fb.a.c1a,Object(u.a)(this,
this.ikb,"setDropDownValue"),Object(u.a)(this,this.gjb,"provideDropDownValue"));Eh.a.Jja(Fb.a.rWc,Object(u.a)(this,this.ikb,"setDropDownValue"),Object(u.a)(this,this.gjb,"provideDropDownValue"));this.gw.yl()}dispose(){if(!this.LK){for(let b=0;b<Xi.z9d.length;b++)Eh.a.jsa(Xi.z9d[b]);Eh.a.jsa(Fb.a.c1a);Eh.a.jsa(Fb.a.rWc);this.gw.RA(Xi.U6i);this.gw.RA(Xi.T6i);this.gw.RA(Xi.X1f);this.gw.RA(Xi.URd);super.dispose();this.LK=!0}}Msa(b,h){switch(b){case Fb.a.Gbc:case Fb.a.S1d:var r=b===Fb.a.Gbc?od.a.sDa:od.a.qDa;
b=b===Fb.a.Gbc?od.a.rDa:od.a.pDa;this.Ae.hasProperty(r)&&this.Ae.hasProperty(b)?(b=this.Ae.getValue(b),1===b?(h[Cc.a.Text]=Box4Intl.Box4Strings.L_SpinnerAuto,h[Cc.a.Number]=Number.NaN,h[Cc.a.UnitType]=5):(r=this.Ae.getValue(r),b=2===b?4:5,h[Cc.a.Number]=r,h[Cc.a.UnitType]=b)):(h[Cc.a.Text]="",h[Cc.a.Number]=Number.NaN,h[Cc.a.UnitType]=vb.App.x6?4:5);break;case Fb.a.o1d:r=!1,this.Ae.hasProperty(od.a.ta)&&this.Ae.hasProperty(od.a.QZ)&&2===this.Ae.getValue(od.a.QZ)&&(this.lei()||this.Nad)&&(b=Xi.WT.ALa(this.Ae),
b>=Xi.lAf&&(h[Cc.a.Number]=b,r=!0)),r||(h[Cc.a.Text]="",h[Cc.a.Number]=Number.NaN),h[Cc.a.UnitType]=0}}Cva(b,h){var r=h[Cc.a.Text],z=h[Cc.a.Number],R=h[Cc.a.UnitType];switch(b){case Fb.a.iac:case Fb.a.hZd:r===Box4Intl.Box4Strings.L_SpinnerAuto?(r=0,z=1):(r=z,z=4===R?2:4);h=b===Fb.a.iac?od.a.rDa:od.a.pDa;this.Ae.setValue(b===Fb.a.iac?od.a.sDa:od.a.qDa,r);this.Ae.setValue(h,z);break;case Fb.a.k3a:case Fb.a.Z0c:R=b===Fb.a.k3a?od.a.sDa:od.a.qDa;b=b===Fb.a.k3a?od.a.rDa:od.a.pDa;h=h.Increment;""===r||h&&
r===Box4Intl.Box4Strings.L_SpinnerAuto?(this.Ae.setValue(R,0),this.Ae.setValue(b,4)):z||h||(this.Ae.setValue(R,0),this.Ae.setValue(b,1));break;case Fb.a.bZd:this.SZi(z);break;case Fb.a.I9d:""===r&&this.SZi(Xi.lAf)}this.gw.yl()}SZi(b){this.Ae.setValue(od.a.QZ,2);this.Ae.setValue(od.a.ta,Xi.WT.fff(b));this.Nad=!0;this.gw.gM(Xi.URd)}gjb(b,h){switch(b){case Fb.a.rWc:this.mbn(h)}}mbn(b){let h=0;var r=!1;this.Ae.hasProperty(od.a.ta)&&this.Ae.hasProperty(od.a.QZ)||(r=!0);r||(2!==this.Ae.getValue(od.a.QZ)&&
(r=!0),h=Xi.WT.ALa(this.Ae),h<Xi.lAf&&(r=!0));r||(r=Xi.Awf,this.Nad||this.lei()||(ac.a.JZ(h,1)?r="1.00":ac.a.JZ(h,1.5)?r="1.50":ac.a.JZ(h,2)&&(r="2.00")),b[Sk.a.SelectedItemId]=r)}ikb(b,h){switch(b){case Fb.a.c1a:this.XIn(h)}}XIn(b){b=b.MenuItemId;b===Xi.Awf?(this.Ae.setValue(od.a.QZ,2),this.Ae.setValue(od.a.ta,Xi.WT.fff(3))):(b=parseFloat(b),this.Ae.setValue(od.a.QZ,2),this.Ae.setValue(od.a.ta,Xi.WT.fff(b)));this.Nad=!1;this.gw.gM(Xi.URd);this.gw.gM(Xi.X1f)}$Zd(b){1===b&&DC(this.ZM,this.Ae,Xi.IYa());
this.dispose()}ZZd(){const b=Sa.a.instance.resolve("Box4.UI.IBox4DialogFactory"),h=Sa.a.instance.resolve("WordEditor.ClientPagination.IClientPaginationSettings");b.k_b(this.ZM,null,this.VO,h)}lei(){if(!this.Ae.hasProperty(od.a.ta)||!this.Ae.hasProperty(od.a.QZ)||2!==this.Ae.getValue(od.a.QZ))return!1;const b=Xi.WT.ALa(this.Ae);return!ac.a.JZ(b,1)&&!ac.a.JZ(b,1.5)&&!ac.a.JZ(b,2)}static get WT(){return null!=Xi.wng?Xi.wng:Xi.wng=Sa.a.instance.resolve("Box4.ILineSpacingHelper")}static IYa(){return Xi.MY||
(Xi.MY=Xi.hKa())}static hKa(){const b={};b[od.a.ta.id.toString()]=Lk.ali;b[od.a.qDa.id.toString()]=Lk.TZd;b[od.a.pDa.id.toString()]=Lk.TZd;b[od.a.sDa.id.toString()]=Lk.UZd;b[od.a.rDa.id.toString()]=Lk.UZd;return b}static Chh(b,h,r,z,R,ba,ta){r=Xi.zmk(h,r,z,R,ba);Xi.Kvb(r,b,h,ta)}static Ylk(b,h,r){const z=Xi.Zlk(h);Xi.Kvb(z,b,h,r)}static amk(b,h,r){const z=Xi.cmk(h);Xi.Kvb(z,b,h,r)}static Kvb(b,h,r,z){h=document.getElementById(h);z.Pya(r,b);b=z.hYa(r,"Medium");h.appendChild(b)}static zmk(b,h,r,z,R){return Kf.l(b,
h,r,R,[Xi.Smk(),Xi.Rmk()],[Box4Intl.Box4Strings.L_SpinnerAuto],z,Xi.M9d)}static Zlk(b){return Kf.l(b,Fb.a.bZd,Fb.a.o1d,Box4Intl.Box4Strings.l_ParagraphDialogLineSpacingAtAlt,[Xi.$lk()],null,Fb.a.I9d,Xi.M9d)}static $lk(){return Kf.n("none","1","132",".5")}static Smk(){return Kf.n("point","0","1584","1")}static Rmk(){return Kf.n("line","0","327","1")}static cmk(b){const h=Kf.e("DdlLineSpacing_Single","1.00",Fb.a.c1a.toString(),Box4Intl.Box4Strings.l_ParagraphDialogLineSpacingSingle),r=Kf.e("DdlLineSpacing_1.5",
"1.50",Fb.a.c1a.toString(),Box4Intl.Box4Strings.l_ParagraphDialogLineSpacingOneAndHalf),z=Kf.e("DdlLineSpacing_Double","2.00",Fb.a.c1a.toString(),Box4Intl.Box4Strings.l_ParagraphDialogLineSpacingDouble),R=Kf.e("DdlLineSpacing_Multiple",Xi.Awf,Fb.a.c1a.toString(),Box4Intl.Box4Strings.l_ParagraphDialogLineSpacingMultiple);return Kf.k(b,Fb.a.c1a,Fb.a.rWc,Box4Intl.Box4Strings.l_ParagraphDialogLineSpacingAlt,Xi.vrm,[h,r,z,R])}}Xi.vrm=150;Xi.M9d=70;Xi.lAf=1;Xi.U6i="DialogSpacingBeforeSpinner";Xi.T6i="DialogSpacingAfterSpinner";
Xi.X1f="DialogLineSpacingAtSpinner";Xi.x0n="ParagraphDialogSpacingBeforeSpinnerContainer";Xi.w0n="ParagraphDialogSpacingAfterSpinnerContainer";Xi.v0n="ParagraphDialogLineSpacingAtSpinnerContainer";Xi.urm="ParagraphDialogLineSpacingContainer";Xi.URd="ParagraphDialogLineSpacingSelect";Xi.Awf="multiple";Xi.z9d=[Fb.a.iac,Fb.a.hZd,Fb.a.bZd,Fb.a.Gbc,Fb.a.S1d,Fb.a.o1d,Fb.a.I9d,Fb.a.Z0c,Fb.a.k3a];Xi.NX=null;Xi.MY=null;Object(n.a)(Xi,"ParagraphDialog",Wc.a,[]);class BE{static get vg(){return Wc.a.Px(BE.sl,
Box4Intl.Box4Strings.l_ParagraphDialogGeneral,Box4Intl.Box4Strings.l_ParagraphDialogAlignment,Box4Intl.Box4Strings.l_ParagraphDialogIndentation,Box4Intl.Box4Strings.l_ParagraphDialogIndentLeft,Box4Intl.Box4Strings.l_ParagraphDialogIndentRight,Box4Intl.Box4Strings.l_ParagraphDialogSpacing,Box4Intl.Box4Strings.l_ParagraphDialogSpacingBefore,Box4Intl.Box4Strings.l_ParagraphDialogSpacingAfter,Box4Intl.Box4Strings.l_ParagraphDialogLineSpacing,Box4Intl.Box4Strings.l_ParagraphDialogLineSpacingAt,Box4Intl.Box4Strings.l_ParagraphDialogSpecialIndentation,
Box4Intl.Box4Strings.l_ParagraphDialogSpecialIndentationBy)}}BE.sl="<div class='WACDialogGroupBox ParagraphDialogLeftChunk' id='LeftChunk'> <div class='WACDialogSectionTitle UIFontBold'>{0}</div> <div class='ParagraphDialogContentArea' id='ParagraphDialogGeneralRow'> <div class='WACDialogGroupBox' id='GeneralLabelBox'> <table cellpadding=5 cellspacing=5 role='presentation'> <tr role='presentation'> <td> <label id='Alignment' class='DialogSpinnerLabel' aria-hidden='true' for='ParagraphDialogAlignmentContainer' >{1}</label> </td> <td> <div id='ParagraphDialogAlignmentContainer' class='WacSpinnerBox' aria-labelledby='Alignment' role='presentation'></div> </td> </tr> </table> <div class='WACDialogRow' id='ParagraphDialogIndentationRow'> <div class='WACDialogSectionTitle UIFontBold'>{2}</div> </div> <div class='WACDialogGroupBox ParagraphDialogContentArea' id='InnerRowIndentationLabels'> <table cellpadding=5 cellspacing=5 role='presentation'> <tr role='presentation'> <td> <label id='ParagraphDialogIndentationLeft' class='DialogSpinnerLabel' aria-hidden='true' for='ParagraphDialogIndentLeftSpinnerContainer' >{3}</label> </td> <td> <div id='ParagraphDialogIndentLeftSpinnerContainer' class='WacSpinnerBox' aria-labelledby='ParagraphDialogIndentationLeft' role='presentation'></div> </td> </tr> <tr> <td> <label id='ParagraphDialogIndentationRight' class='DialogSpinnerLabel' aria-hidden='true' for='ParagraphDialogIndentRightSpinnerContainer' >{4}</label> </td> <td> <div id='ParagraphDialogIndentRightSpinnerContainer' class='WacSpinnerBox' aria-labelledby='ParagraphDialogIndentationRight' role='presentation'></div> </td> </tr> <tr> <td> <label id='ParagraphDialogSpecialIndent' class='DialogSpinnerLabel' aria-hidden='true' for='ParagraphDialogSpecialIndentContainer' >{10}</label> </td> <td> <div id='ParagraphDialogSpecialIndentContainer' class='WacSpinnerBox' aria-labelledby='ParagraphDialogSpecialIndent' role='presentation'></div> </td> </tr> <tr> <td> <label id='ParagraphDialogSpecialIndentBy' class='DialogSpinnerLabel' aria-hidden='true' for='ParagraphDialogSpecialIndentBySpinnerContainer' >{11}</label> </td> <td> <div id='ParagraphDialogSpecialIndentBySpinnerContainer' class='WacSpinnerBox' aria-labelledby='ParagraphDialogSpecialIndentBy' role='presentation'></div> </td> </tr> </table> </div> </div> </div> </div> <div class='WACDialogGroupBox ParagraphDialogRightChunk' id='RightChunk'> <div class='WACDialogSectionTitle UIFontBold'>{5}</div> <div class='ParagraphDialogContentArea' id='InnerRowSpacing'> <div class='WACDialogGroupBox' id='SpacingLabelBox'> <table cellpadding=5 cellspacing=5 role='presentation'> <tr> <td> <label id='ParagraphDialogSpacingBefore' class='DialogSpinnerLabel' aria-hidden='true' for='ParagraphDialogSpacingBeforeSpinnerContainer' >{6}</label> </td> <td> <div id='ParagraphDialogSpacingBeforeSpinnerContainer' class='WacSpinnerBox' aria-labelledby='ParagraphDialogSpacingBefore' role='presentation'></div> </td> </tr> <tr> <td> <label id='ParagraphDialogSpacingAfter' class='DialogSpinnerLabel' aria-hidden='true' for='ParagraphDialogSpacingAfterSpinnerContainer' >{7}</label> </td> <td> <div id='ParagraphDialogSpacingAfterSpinnerContainer' class='WacSpinnerBox' aria-labelledby='ParagraphDialogSpacingAfter' role='presentation'></div> </td> </tr> <tr> <td> <label id='ParagraphDialogLineSpacing' class='DialogSpinnerLabel' aria-hidden='true' for='ParagraphDialogLineSpacingContainer' >{8}</label> </td> <td> <div id='ParagraphDialogLineSpacingContainer' class='WacSpinnerBox' aria-labelledby='ParagraphDialogLineSpacing' role='presentation'></div> </td> </tr> <tr> <td> <label id='ParagraphDialogLineSpacingAt' class='DialogSpinnerLabel' aria-hidden='true' for='ParagraphDialogLineSpacingAtSpinnerContainer' >{9}</label> </td> <td> <div id='ParagraphDialogLineSpacingAtSpinnerContainer' class='WacSpinnerBox' aria-labelledby='ParagraphDialogLineSpacingAt' role='presentation'></div> </td> </tr> </table> </div> </div> </div>";
Object(n.a)(BE,"ParagraphDialogHtml",null,[]);const BF=b=>1===b||2===b||3===b||6===b||10===b||11===b||9===b||7===b||13===b,CF=(b,h,r,z)=>{let R=vb.App.kaa;b.hasProperty(h)&&b.hasProperty(r)&&!z?(h=b.getValue(h),b=b.getValue(r),h?2===b?R=2:h=pg.a.Gba(h,R):vb.App.x6&&(R=2)):(h=Number.NaN,vb.App.x6&&(R=2));return{hfc:h,b4a:R}},GL=b=>{let h="0";b.hasProperty(od.a.ZI)&&(b=b.getValue(od.a.ZI),(1===b||2===b||!b)&&(1===b?h="1":2===b?h="2":b||(h="0")));return h},CE=(b,h)=>{if(h.hasProperty(od.a.ZI)&&2===h.getValue(od.a.ZI)&&
h.hasProperty(od.a.v_)&&h.hasProperty(od.a.jba)&&b.hasProperty(od.a.Haa)&&b.hasProperty(od.a.Gaa)){var r=b.getValue(od.a.Haa),z=b.getValue(od.a.Gaa);r=(new Wj.a(z,r)).kt;z=h.getValue(od.a.v_);h=h.getValue(od.a.jba);h=(new Wj.a(h,z)).kt;b.setValue(od.a.Haa,r+h);b.setValue(od.a.Gaa,1)}},CH=(b,h)=>{var r;if(r=zH(b,h))r=h.hasProperty(od.a.v_)&&h.hasProperty(od.a.jba);if(r){r=h.getValue(od.a.v_);const z=h.getValue(od.a.jba);r=(new Wj.a(z,r)).kt;return AH(h)+BH(h)+b.getValue(yc.a.marginRight)+b.getValue(yc.a.marginLeft)+
r+vb.App.wwa<=b.getValue(yc.a.Lo)}return zH(b,h)?AH(h)+BH(h)+b.getValue(yc.a.marginRight)+b.getValue(yc.a.marginLeft)+vb.App.wwa<=b.getValue(yc.a.Lo):!0},AH=b=>{const h=b.getValue(od.a.Haa);b=b.getValue(od.a.Gaa);return(new Wj.a(b,h)).kt},BH=b=>{const h=b.getValue(od.a.Sua);b=b.getValue(od.a.Rua);return(new Wj.a(b,h)).kt},zH=(b,h)=>h.hasProperty(od.a.Haa)&&h.hasProperty(od.a.Gaa)&&h.hasProperty(od.a.Sua)&&h.hasProperty(od.a.Rua)&&b.hasProperty(yc.a.marginLeft)&&b.hasProperty(yc.a.marginRight)&&b.hasProperty(yc.a.Lo),
HL=b=>b.hasProperty(od.a.EUc)?b.getValue(od.a.EUc):!1,IL=b=>b.hasProperty(Li.a.Yh)?b.getValue(Li.a.Yh):!1,JL=b=>b.hasProperty(Li.a.BM)?b.getValue(Li.a.BM):!1,KL=b=>b.hasProperty(Li.a.keepTogether)?b.getValue(Li.a.keepTogether):!1;class ar extends Xi{constructor(b,h,r,z,R,ba,ta,Wa,ub,Ib,$b){super(b,r,ba,ta,Wa,Ib);this.qx=$b;this.vg=BE.vg;this.aL=h.clone();this.Wh(Box4Intl.Box4Strings.l_ParagraphDialogTitle,Object(u.a)(this,this.$Zd,"paragraphDialogResultHandler"),null);this.pnf();b=document.getElementById("ParagraphDialogAlignmentControl-Medium");
this.uU(b)}cU(){ar.shh("ParagraphDialogIndentLeftSpinnerContainer","DialogIndentLeftSpinner",Fb.a.k5b,Fb.a.RHb,Fb.a.lfc,Box4Intl.Box4Strings.l_ParagraphDialogIndentLeftAlt,this.gw);ar.shh("ParagraphDialogIndentRightSpinnerContainer","DialogIndentRightSpinner",Fb.a.eMd,Fb.a.fWc,Fb.a.H9d,Box4Intl.Box4Strings.l_ParagraphDialogIndentRightAlt,this.gw);ar.Wmk(this.gw);const b=this.Ae.getValue(od.a.Zs);ar.Dkk(b,this.gw);ar.Ymk(this.gw);super.cU()}pnf(){for(let b=0;b<ar.gMd.length;b++)Eh.a.Jja(ar.gMd[b],
Object(u.a)(this,this.Cva,"setAdvancedControlValue"),Object(u.a)(this,this.Msa,"getAdvancedControlValue"));Eh.a.Jja(Fb.a.$ma,Object(u.a)(this,this.ikb,"setDropDownValue"),Object(u.a)(this,this.gjb,"provideDropDownValue"));Eh.a.Jja(Fb.a.Ebc,Object(u.a)(this,this.ikb,"setDropDownValue"),Object(u.a)(this,this.gjb,"provideDropDownValue"));Eh.a.Jja(Fb.a.d1a,Object(u.a)(this,this.ikb,"setDropDownValue"),Object(u.a)(this,this.gjb,"provideDropDownValue"));Eh.a.Jja(Fb.a.Hbc,Object(u.a)(this,this.ikb,"setDropDownValue"),
Object(u.a)(this,this.gjb,"provideDropDownValue"));super.pnf()}dispose(){if(!this.Cl){for(let b=0;b<ar.gMd.length;b++)Eh.a.jsa(ar.gMd[b]);Eh.a.jsa(Fb.a.$ma);Eh.a.jsa(Fb.a.Ebc);Eh.a.jsa(Fb.a.d1a);Eh.a.jsa(Fb.a.Hbc);this.gw.RA("DialogIndentLeftSpinner");this.gw.RA("DialogIndentRightSpinner");this.gw.RA("ParagraphDialogAlignmentControl");this.gw.RA("ParagraphDialogSpecialIndentSelect");this.gw.RA("ParagraphDialogSpecialIndentBySpinner");super.dispose()}}Msa(b,h){var r=!1;switch(b){case Fb.a.RHb:case Fb.a.fWc:var z=
b===Fb.a.RHb?od.a.Haa:od.a.Sua,R=b===Fb.a.RHb?od.a.Gaa:od.a.Rua;r=vb.App.kaa;this.Ae.hasProperty(z)&&this.Ae.hasProperty(R)?(z=this.Ae.getValue(z),R=this.Ae.getValue(R),z?2===R?r=2:z=pg.a.Gba(z,r):vb.App.x6&&(r=2),h[Cc.a.Number]=z):(h[Cc.a.Text]="",h[Cc.a.Number]=Number.NaN,vb.App.x6&&(r=2));h[Cc.a.UnitType]=r;r=!0;break;case Fb.a.T1d:z=od.a.v_;R=od.a.jba;let ba=!1;r=vb.App.kaa;this.Ae.hasProperty(od.a.ZI)&&(ba=!this.Ae.getValue(od.a.ZI));this.Ae.hasProperty(z)&&this.Ae.hasProperty(R)&&!ba?(z=this.Ae.getValue(z),
R=this.Ae.getValue(R),z?2===R?r=2:z=pg.a.Gba(z,r):vb.App.x6&&(r=2),h[Cc.a.Number]=z):(h[Cc.a.Text]="",h[Cc.a.Number]=Number.NaN,vb.App.x6&&(r=2));h[Cc.a.UnitType]=r;r=!0}r||super.Msa(b,h)}Cva(b,h){var r=h[Cc.a.Text],z=h[Cc.a.Number],R=h[Cc.a.UnitType],ba=!1;switch(b){case Fb.a.k5b:case Fb.a.eMd:r=z;2===R?ba=2:(ba=1,r=pg.a.zQa(z,R));z=b===Fb.a.k5b?od.a.Gaa:od.a.Rua;this.Ae.setValue(b===Fb.a.k5b?od.a.Haa:od.a.Sua,r);this.Ae.setValue(z,ba);ba=!0;break;case Fb.a.lfc:case Fb.a.H9d:""===r&&(z=2===R?2:1,
r=b===Fb.a.lfc?od.a.Gaa:od.a.Rua,this.Ae.setValue(b===Fb.a.lfc?od.a.Haa:od.a.Sua,0),this.Ae.setValue(r,z));ba=!0;break;case Fb.a.k3a:case Fb.a.Z0c:R=b===Fb.a.k3a?od.a.sDa:od.a.qDa;ba=b===Fb.a.k3a?od.a.rDa:od.a.pDa;const ta=h.Increment;""===r||ta&&r===Box4Intl.Box4Strings.L_SpinnerAuto?(this.Ae.setValue(R,0),this.Ae.setValue(ba,4)):z||ta||(this.Ae.setValue(R,0),this.Ae.setValue(ba,1));ba=!0;break;case Fb.a.iZd:""===r&&this.Ae.setValue(od.a.ZI,1);this.f0i(z,R);ba=!0;break;case Fb.a.L9d:""===r&&(this.Ae.setValue(od.a.ZI,
1),this.f0i(.1,R)),ba=!0}ba||super.Cva(b,h)}f0i(b,h){let r=b,z;2===h?z=2:(z=1,r=pg.a.zQa(b,h));this.Ae.setValue(od.a.v_,r);this.Ae.setValue(od.a.jba,z);this.gw.gM("ParagraphDialogSpecialIndentBySpinner")}gjb(b,h){let r=!1;switch(b){case Fb.a.Ebc:this.lbn(h);r=!0;break;case Fb.a.Hbc:this.nbn(h),r=!0}r||super.gjb(b,h)}nbn(b){let h="0";if(this.Ae.hasProperty(od.a.ZI)){const r=this.Ae.getValue(od.a.ZI);(1===r||2===r||!r)&&(1===r?h="1":2===r?h="2":r||(h="0"))}b[Sk.a.SelectedItemId]=h}lbn(b){if(this.Ae.hasProperty(od.a.Zs)){let h=
this.Ae.getValue(od.a.Zs);if(10===h||9===h)h=11;BF(h)&&(b[Sk.a.SelectedItemId]=h.toString())}}ikb(b,h){let r=!1;switch(b){case Fb.a.$ma:this.VMn(h);r=!0;break;case Fb.a.d1a:this.QOn(h),r=!0}r||super.ikb(b,h)}QOn(b){b=parseInt(b.MenuItemId);this.Ae.setValue(od.a.ZI,b);this.gw.gM("ParagraphDialogSpecialIndentSelect");b?(this.Ae.setValue(od.a.jba,1),this.Ae.hasProperty(od.a.v_)?this.Ae.getValue(od.a.v_)||this.Ae.setValue(od.a.v_,720):this.Ae.setValue(od.a.v_,720)):(this.Ae.setValue(od.a.jba,1),this.Ae.setValue(od.a.v_,
0));this.gw.gM("ParagraphDialogSpecialIndentBySpinner")}VMn(b){this.Ae.setValue(od.a.Zs,parseInt(b.MenuItemId));this.gw.gM("ParagraphDialogAlignmentControl")}$Zd(b){let h="";1===b&&(CE(this.ZM,this.ZM),CE(this.Ae,this.ZM),CH(this.aL,this.Ae)?DC(this.ZM,this.Ae,ar.pjf()):h=""!==h?h:Box4Intl.Box4Strings.l_ParaIndentSetFailedMessage);this.dispose();""!==h&&this.Eva(h,Object(u.a)(this,this.ZZd,"paragraphDialogCreator"))}ZZd(){Sa.a.instance.resolve("Box4.UI.IBox4DialogFactory").k_b(this.ZM,this.aL,this.VO,
this.qx)}static pjf(){return Xi.MY||(Xi.MY=ar.d1e())}static d1e(){const b=Xi.IYa();b[od.a.Zs.id.toString()]=Lk.rji;b[od.a.Gaa.id.toString()]=Lk.QZd;b[od.a.Haa.id.toString()]=Lk.QZd;b[od.a.Rua.id.toString()]=Lk.RZd;b[od.a.Sua.id.toString()]=Lk.RZd;b[od.a.ZI.id.toString()]=Lk.ifc;b[od.a.jba.id.toString()]=Lk.ifc;b[od.a.v_.id.toString()]=Lk.ifc;return b}static shh(b,h,r,z,R,ba,ta){r=ar.Nlk(h,r,z,R,ba);Xi.Kvb(r,b,h,ta)}static Wmk(b){const h=ar.Xmk();Xi.Kvb(h,"ParagraphDialogSpecialIndentBySpinnerContainer",
"ParagraphDialogSpecialIndentBySpinner",b)}static Dkk(b,h){b=ar.Ekk(b);Xi.Kvb(b,"ParagraphDialogAlignmentContainer","ParagraphDialogAlignmentControl",h)}static Ymk(b){const h=ar.Zmk();Xi.Kvb(h,"ParagraphDialogSpecialIndentContainer","ParagraphDialogSpecialIndentSelect",b)}static Nlk(b,h,r,z,R){return Kf.l(b,h,r,R,[ar.Qlk(),ar.Plk(),ar.Olk()],null,z,Xi.M9d)}static Xmk(){return Kf.l("ParagraphDialogSpecialIndentBySpinner",Fb.a.iZd,Fb.a.T1d,Box4Intl.Box4Strings.l_ParagraphDialogSpecialIndentationByAlt,
[ar.Vmk(),ar.Umk(),ar.Tmk()],null,Fb.a.L9d,Xi.M9d)}static Vmk(){return Kf.n("inch","0","22",".1")}static Umk(){return Kf.n("centimeter","0","55.88","1")}static Tmk(){return Kf.n("character","0","316.8",".5")}static Qlk(){return Kf.n("inch","-11","22",".1")}static Plk(){return Kf.n("centimeter","-27.94","55.88","1")}static Olk(){return Kf.n("character","-316.8","316.8",".5")}static Ekk(b){return Kf.k("ParagraphDialogAlignmentControl",Fb.a.$ma,Fb.a.Ebc,Box4Intl.Box4Strings.l_ParagraphDialogAlignmentAlt,
150,ar.WLk(b))}static WLk(b){var h=Kf.e("DdlAlignment_Left","1",Fb.a.$ma.toString(),Box4Intl.Box4Strings.l_ParagraphDialogAlignLeft),r=Kf.e("DdlAlignment_Center","2",Fb.a.$ma.toString(),Box4Intl.Box4Strings.l_ParagraphDialogAlignCenter);const z=Kf.e("DdlAlignment_Right","3",Fb.a.$ma.toString(),Box4Intl.Box4Strings.l_ParagraphDialogAlignRight),R=Kf.e("DdlAlignment_Justified","6",Fb.a.$ma.toString(),Box4Intl.Box4Strings.l_ParagraphDialogAlignJustified),ba=Kf.e("DdlAlignment_Kashida","11",Fb.a.$ma.toString(),
Box4Intl.Box4Strings.l_ParagraphDialogAlignKashida),ta=Kf.e("DdlAlignment_Distribued","7",Fb.a.$ma.toString(),Box4Intl.Box4Strings.l_ParagraphDialogAlignDistributed),Wa=Kf.e("DdlAlignment_ThaiDistribued","13",Fb.a.$ma.toString(),Box4Intl.Box4Strings.l_ParagraphDialogAlignThaiDistributed);h=[h,r,z,R,ta];r=5;if(t.AFrameworkApplication.lcid===Sj.a.pg("AR-SA").LCID||11===b)h[r]=ba,r=6;if(t.AFrameworkApplication.lcid===Sj.a.pg("TH-TH").LCID||13===b)h[r]=Wa;return h}static Zmk(){const b=Kf.e("DdlSpecialIndent_None",
"0",Fb.a.d1a.toString(),Box4Intl.Box4Strings.l_ParagraphDialogNoneIndent),h=Kf.e("DdlSpecialIndent_FirstLine","1",Fb.a.d1a.toString(),Box4Intl.Box4Strings.l_ParagraphDialogFirstLineIndent),r=Kf.e("DdlSpecialIndent_Hanging","2",Fb.a.d1a.toString(),Box4Intl.Box4Strings.l_ParagraphDialogHangingIndent);return Kf.k("ParagraphDialogSpecialIndentSelect",Fb.a.d1a,Fb.a.Hbc,Box4Intl.Box4Strings.l_ParagraphDialogSpecialIndentationAlt,150,[b,h,r])}}ar.gMd=[Fb.a.k5b,Fb.a.eMd,Fb.a.d1a,Fb.a.iZd,Fb.a.$ma,Fb.a.RHb,
Fb.a.fWc,Fb.a.Hbc,Fb.a.T1d,Fb.a.Ebc,Fb.a.lfc,Fb.a.H9d,Fb.a.L9d];Object(n.a)(ar,"ParagraphDialog",Xi,[]);class DH extends os{constructor(b,h){super(b,h,!0);this.P6a=null;this.TJi=(r,z)=>{this.Ef.Qr&&(r?(r="string"===typeof z.styleText?z.styleText:null,(z=this.Bkj(r))?(this.P6a=z,z=this.Sff(this.JC),r=this.$zb(r,z),this.P6a=null,this.zR=!1,this.hide(),this.Wh(WordEditorIntl.WordEditorStrings.l_CreateNewStyle,this.TJi,r),this.zR=!0):(this.hide(),z=new Map,z.set("Source","ReactCreateNewStyleDialog"),
z.set("Action","CreateStyle"),Ca.Health.instance.recordKpiUsage(Zl.a.Imb,0,Zl.a.EB,z),this.hyc(r,this.UR)||(r=new Map,r.set("Source","ReactCreateNewStyleDialog"),r.set("Action","CreateStyle"),r=Object.assign(new eb.a,{extendedProperties:r}),Ca.Health.instance.recordKpiFailure(Zl.a.Imb,"CreateStyleFailed",!1,!0,r)))):this.hide(),this.Ef.RX())};this.qz&&this.UR&&(this.q8=!1,b=this.Sff(this.JC),b=this.$zb(b,b),this.Wh(WordEditorIntl.WordEditorStrings.l_CreateNewStyle,this.TJi,b))}$zb(b,h){var r=this.UR.ia(We.a.fontSize,
Cl.a.OJ)>=2*os.vUd;const z=Jb.a.Xcf(this.UR,"97%",os.vUd,!1,!0,r);z["padding-left"]=os.W8i+"px";r||(z["line-height"]=os.V8i+"px");r={};r.styleNameLabel=WordEditorIntl.WordEditorStrings.l_CreateNewStyleDialogName;r.previewWindowLabel=WordEditorIntl.WordEditorStrings.l_CreateNewStyleDialogParagraphPreview;r.styleName=b;r.previewContainerText=h;r.getPreviewStyle=()=>z;this.P6a&&(r.errorMessage=this.P6a);return{["id"]:this.kg,["bodyControls"]:r}}}Object(n.a)(DH,"ReactCreateNewStyleDialog",os,[]);class aB extends Wc.a{constructor(b,
h=!1,r){super(!1,!1,h);let z=h=this.vx=null;this.kg=aB.id;this.Ef=b.view;this.nl=r;this.Ef&&(z=this.Ef.Cb);z&&z.hb&&z.hb.kb&&(h=z.hb.kb.Qa);h?(b=h.node)?(this.qz=aB.qh.ju(b))||v.ULS.sendTraceTag(539762890,3029,10,"_pageContenNode is null"):v.ULS.sendTraceTag(539762889,3029,10,"node is null"):v.ULS.sendTraceTag(539762888,3029,10,"nodeContext is null")}hpo(b){var h=RegExp("^(?!\\p{N})[\\p{L}\\p{N}\\p{Mc}\\p{Mn}_]{1,40}$","gu"),r=this.mhl();const z=""===B.a.ova(b),R=b.length>aB.xFm;r=r.includes(b);h=
h.test(b);b=b.startsWith("_");let ba=null;if(z||R||r||b||!h)ba=z?WordEditorIntl.WordEditorStrings.l_BookmarkNameEmpty:R?WordEditorIntl.WordEditorStrings.l_BookmarkNameOverMaxLength:b?WordEditorIntl.WordEditorStrings.l_BookmarkNameRestrictedCharacters:h?WordEditorIntl.WordEditorStrings.l_BookmarkNameAlreadyExists:WordEditorIntl.WordEditorStrings.l_BookmarkNameRestrictedCharacters;return ba}d$l(b,h){return b?b===h:!1}static get qh(){return ml.PageNavigator.instance}mhl(){const b=this.nl.eHc(!1);let h=
[];for(let r=0;r<b.count;r++){let z=b.J(r).ia(yc.a.Ts,"");h.push(z)}return h}}aB.id="BookmarkEditDialog";aB.xFm=40;Object(n.a)(aB,"AEditBookmarkDialog",Wc.a,[]);class EH extends aB{constructor(b,h,r){super(b,!0,r);this.P6a=null;this.jSa="wwaengidc";this.nqc="ReactCreateEditBookmarkNameDialog";this.nNg="EditBookmarkName";this.Hed="EditBookmarkNameDialog";this.Nie=h;this.nl=r;this.qz&&(this.q8=!1,b=this.$zb(h.properties.ia(yc.a.Ts,null)),this.Wh(WordEditorIntl.WordEditorStrings.l_EditBookmark,this.VJi.bind(this),
b))}VJi(b,h){if(this.Ef.Qr){if(b){b="string"===typeof h.BookmarkText?h.BookmarkText:null;var r;this.Nie.hasProperty(yc.a.Ts)?r=this.Nie.getValue(yc.a.Ts):v.ULS.sendTraceTag(528880847,3029,10,"Bookmark name not found");h=this.hpo(b);this.d$l(b,r)?(v.ULS.sendTraceTag(528880848,3029,50,"User did not update existing bookmark's name, dismissing edit bookmark dialog"),this.hide()):h?(this.P6a=h,r=this.$zb(b),this.P6a=null,this.zR=!1,this.hide(),this.Wh(WordEditorIntl.WordEditorStrings.l_EditBookmark,this.VJi.bind(this),
r),this.zR=!0):(this.hide(),r=new Map,r.set("Source",this.nqc),r.set("Action",this.nNg),Ca.Health.instance.recordKpiUsage(this.Hed,0,this.jSa,r),this.Jsk(b)||(r=new Map,r.set("Source",this.nqc),r.set("Action",this.nNg),r=Object.assign(new eb.a,{extendedProperties:r}),Ca.Health.instance.recordKpiFailure(this.Hed,"Unable to edit bookmark",!1,!0,r)))}else this.hide();this.Ef.RX()}}Jsk(b){b=B.a.ova(B.a.BZ(b));try{const h=this.nl.Xfj(this.Nie,b);if(h)v.ULS.sendTraceTag(539762886,3029,50,"Updated bookmark name to name specified by user");
else return v.ULS.sendTraceTag(525111646,3029,10,"Error updating bookmark name to name specified by user"),h}catch(h){return v.ULS.sendTraceTag(539762887,3029,10,"Error updating bookmark name to name specified by user",h.Message),!1}}$zb(b){const h={};h.bookmarkValue=b;h.errorMessage=this.P6a;h.bookmarkTextLabel=WordEditorIntl.WordEditorStrings.l_EditBookmarkDialogLabelName;return{["id"]:this.kg,["bodyControls"]:h}}}Object(n.a)(EH,"ReactEditBookmarkNameDialog",aB,[]);const DE=(b,h,r)=>{const z=[];
if(b.length!==h.length||r&&r.length!==h.length)return z;for(let R=0;R<b.length;R++){const ba={};ba.key=h[R];ba.text=b[R];ba.type="AppComboBoxItem";r&&(ba.ariaLabel=r[R]);z[R]=ba}return z},hz=(b,h,r,z,R)=>({["unitType"]:b,["unitPlaceholder"]:B.a.ALf(h),["minValue"]:r,["maxValue"]:z,["step"]:R}),DF=()=>({["negativeSign"]:"-",["numberDecimalDigits"]:2,["numberDecimalSeparator"]:".",["numberNegativePattern"]:1,["numberGroupSeparator"]:",",["numberGroupSizes"]:[3]}),FH=(b,h,r)=>{let z=!1;b.hasProperty(h)&&
b.hasProperty(r)?(r=b.getValue(r),1===r?(b=Number.NaN,h=5,z=!0):(b=b.getValue(h),h=2===r?4:5)):(b=Number.NaN,h=vb.App.x6?4:5);return{hfc:b,b4a:h,N5b:z}};class bB{constructor(){this.MY=null}RCl(b){const h={};h.spacingLabelProps={["type"]:"AppLabelProps",["id"]:"SpacingSection",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogSpacing,["forId"]:"SpacingGroup"};var r=hz("Point",5,0,1584,1),z=hz("Line",4,0,327,1),R=[r,z];z=DF();var ba=[Box4Intl.Box4Strings.L_SpinnerAuto];r=[""];({hfc:Wa,b4a:ta,N5b:ub}=
FH(b,od.a.sDa,od.a.rDa));var ta={["type"]:"AppSpinButtonProps",["id"]:"BeforeSpacingSpinButton",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogSpacingBefore,["customTooltip"]:Box4Intl.Box4Strings.l_ParagraphDialogSpacingBeforeAlt,["unitType"]:pg.a.WZb(ta),["validUnits"]:R,["numberFormatInfo"]:z,["validReservedValues"]:ba};ub?ta.reservedValue=ba[0]:ta.value=isNaN(Wa)?"":Wa;h.beforeSpacingSpinButtonProps=ta;({hfc:Wa,b4a:ta,N5b:ub}=FH(b,od.a.qDa,od.a.pDa));R={["type"]:"AppSpinButtonProps",["id"]:"AfterSpacingSpinButton",
["label"]:Box4Intl.Box4Strings.l_ParagraphDialogSpacingAfter,["customTooltip"]:Box4Intl.Box4Strings.l_ParagraphDialogSpacingAfterAlt,["unitType"]:pg.a.WZb(ta),["validUnits"]:R,["numberFormatInfo"]:z,["validReservedValues"]:ba};ub?R.reservedValue=ba[0]:R.value=isNaN(Wa)?"":Wa;h.afterSpacingSpinButtonProps=R;if(ba=R=b.hasProperty(od.a.ta))ba=bB.WT.ALa(b),ba=b.hasProperty(od.a.ta)&&b.hasProperty(od.a.QZ)&&2===b.getValue(od.a.QZ)?!ac.a.JZ(ba,1)&&!ac.a.JZ(ba,1.5)&&!ac.a.JZ(ba,2):!1;if(R){var Wa=bB.WT.ALa(b);
R=0;var ub=!1;b.hasProperty(od.a.ta)&&b.hasProperty(od.a.QZ)||(ub=!0);ub||(2!==b.getValue(od.a.QZ)&&(ub=!0),R=Wa,1>R&&(ub=!0));ub?R="":(Wa="multiple",ba||(ac.a.JZ(R,1)?Wa="1.00":ac.a.JZ(R,1.5)?Wa="1.50":ac.a.JZ(R,2)&&(Wa="2.00")),R=Wa)}else R=null;Wa={["type"]:"AppComboBoxProps",["id"]:"LineSpacingComboBox",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogLineSpacing,["customTooltip"]:Box4Intl.Box4Strings.l_ParagraphDialogLineSpacingAlt,["showLabel"]:!0,["options"]:DE([Box4Intl.Box4Strings.l_ParagraphDialogLineSpacingSingle,
Box4Intl.Box4Strings.l_ParagraphDialogLineSpacingOneAndHalf,Box4Intl.Box4Strings.l_ParagraphDialogLineSpacingDouble,Box4Intl.Box4Strings.l_ParagraphDialogLineSpacingMultiple],["1.00","1.50","2.00","multiple"]),["allowFreeForm"]:!1};R?Wa.selectedKey=R:Wa.defaultSelectedKey="";h.lineSpacingComboBoxProps=Wa;R=0;Wa=!1;b.hasProperty(od.a.ta)&&b.hasProperty(od.a.QZ)&&2===b.getValue(od.a.QZ)&&ba&&(R=bB.WT.ALa(b),Wa=!0,1>R&&(R=Number.NaN));b=[hz("none",0,1,132,.5)];b={["type"]:"AppSpinButtonProps",["id"]:"AtSpinButton",
["label"]:Box4Intl.Box4Strings.l_ParagraphDialogLineSpacingAt,["customTooltip"]:Box4Intl.Box4Strings.l_ParagraphDialogLineSpacingAtAlt,["unitType"]:"none",["validUnits"]:b,["numberFormatInfo"]:z,["validReservedValues"]:r};Wa?b.value=R:b.reservedValue=r[0];h.atSpinButtonProps=b;return h}IYa(){return this.MY||(this.MY=this.hKa())}hKa(){const b={};b[od.a.ta.id.toString()]=Lk.ali;b[od.a.qDa.id.toString()]=Lk.TZd;b[od.a.pDa.id.toString()]=Lk.TZd;b[od.a.sDa.id.toString()]=Lk.UZd;b[od.a.rDa.id.toString()]=
Lk.UZd;return b}static get WT(){return null!=bB.vng?bB.vng:bB.vng=Sa.a.instance.resolve("Box4.ILineSpacingHelper")}}Object(n.a)(bB,"ReactParagraphDialog",null,[]);class GH extends Wc.a{constructor(b,h,r,z,R,ba=Sa.a.instance.Za("Box4.Settings.SpacingSettings")){var ta,Wa;super(!1,!1,!0);this.sO=this.b6g=null;this.ZZd=()=>{Sa.a.instance.resolve("Box4.UI.IBox4DialogFactory").k_b(this.ZM,this.aL,this.VO,this.qx)};this.$Zd=($b,fc)=>{var Kc,ed,Jd,ge;if(fc&&(1===$b||2===$b)){if(fc.alignmentComboBoxProps){var qe=
parseInt(fc.alignmentComboBoxProps.selectedKey);isNaN(qe)||BF(qe)&&this.Ae.setValue(od.a.Zs,qe)}var Ve=fc.bySpinButtonProps;qe=!!Ve&&""!==Ve.value;var Bd=fc.didChangeSpecialIndentationComboBoxValue;if(fc.specialIndentationComboBoxProps){var he=parseInt(fc.specialIndentationComboBoxProps.selectedKey);1!==he&&2!==he&&he||!(he||Bd||qe)||this.Ae.setValue(od.a.ZI,he)}if(Ve){he=Ve.value;Ve=pg.a.fxb(Ve.unitType.toLowerCase());let we;0<=he||(he=0);2===Ve?we=2:(we=1,he=pg.a.zQa(he,Ve));if(qe||Bd)this.Ae.setValue(od.a.v_,
he),this.Ae.setValue(od.a.jba,we)}fc.beforeTextSpinButtonProps&&(Bd=fc.beforeTextSpinButtonProps,qe=pg.a.fxb(Bd.unitType.toLowerCase()),Bd=""===Bd.value?Number.NaN:Bd.value,isNaN(Bd)||(he=Bd,2===qe?Ve=2:(Ve=1,he=pg.a.zQa(Bd,qe)),this.Ae.setValue(od.a.Haa,he),this.Ae.setValue(od.a.Gaa,Ve)));fc.afterTextSpinButtonProps&&(Bd=fc.afterTextSpinButtonProps,qe=pg.a.fxb(Bd.unitType.toLowerCase()),Bd=""===Bd.value?Number.NaN:Bd.value,isNaN(Bd)||(he=Bd,2===qe?Ve=2:(Ve=1,he=pg.a.zQa(Bd,qe)),this.Ae.setValue(od.a.Sua,
he),this.Ae.setValue(od.a.Rua,Ve)));fc.beforeSpacingSpinButtonProps&&(qe=fc.beforeSpacingSpinButtonProps,Bd=pg.a.fxb(qe.unitType.toLowerCase()),he=qe.reservedValue,""!==qe.value&&(he===Box4Intl.Box4Strings.L_SpinnerAuto?(Bd=1,qe=0):(Bd=4===Bd?2:4,qe=qe.value),this.Ae.setValue(od.a.sDa,qe),this.Ae.setValue(od.a.rDa,Bd)));fc.afterSpacingSpinButtonProps&&(qe=fc.afterSpacingSpinButtonProps,Bd=pg.a.fxb(qe.unitType.toLowerCase()),he=qe.reservedValue,""!==qe.value&&(he===Box4Intl.Box4Strings.L_SpinnerAuto?
(Bd=1,qe=0):(Bd=4===Bd?2:4,qe=qe.value),this.Ae.setValue(od.a.qDa,qe),this.Ae.setValue(od.a.pDa,Bd)));if(fc.atSpinButtonProps||fc.lineSpacingComboBoxProps)if(qe=fc.atSpinButtonProps.value,1<qe)this.Ae.setValue(od.a.ta,qe),this.Ae.setValue(od.a.QZ,2);else if(qe=fc.lineSpacingComboBoxProps.selectedKey)qe="1.00"===qe?1:"1.50"===qe?1.5:"2.00"===qe?2:0,qe=1<=qe?qe:1,this.Ae.setValue(od.a.ta,qe),this.Ae.setValue(od.a.QZ,2);(null===(Kc=this.sO)||void 0===Kc?0:Kc.Qta)&&fc.contextualSpacingCheckboxProps&&
this.Ae.setValue(od.a.EUc,fc.contextualSpacingCheckboxProps.checked);(null===(ed=this.qx)||void 0===ed?0:ed.DCa)&&fc.keepWithNextCheckboxProps&&this.Ae.setValue(Li.a.Yh,fc.keepWithNextCheckboxProps.checked);(null===(Jd=this.qx)||void 0===Jd?0:Jd.DFa)&&fc.widowOrphanCheckboxProps&&this.Ae.setValue(Li.a.BM,fc.widowOrphanCheckboxProps.checked);(null===(ge=this.qx)||void 0===ge?0:ge.ofa)&&fc.keepTogetherCheckboxProps&&this.Ae.setValue(Li.a.keepTogether,fc.keepTogetherCheckboxProps.checked);CE(this.ZM,
this.ZM);CE(this.Ae,this.ZM);fc="";CH(this.aL,this.Ae)?DC(this.ZM,this.Ae,this.pjf(this.TGe?this.TGe.hKa():{})):fc=""!==fc?fc:Box4Intl.Box4Strings.l_ParaIndentSetFailedMessage;this.dispose();""!==fc?this.Eva(fc,this.ZZd):2===$b&&(Lb.c(Oa.a.Kec,!0,"Custom Tab Stop Dialog was opened via Paragraph Dialog"),this.ga.Xb(Oa.a.Kec,2,null))}};ba.execute($b=>this.sO=$b);this.ZM=b.clone();this.Ae=b.clone();this.aL=h.clone();this.VO=r;this.ga=z;this.TGe=new bB;this.qx=R;b=this.TGe.RCl(this.Ae);h=hz("Inch",3,
-11,22,.1);r=hz("Inch",3,0,22,.1);ba=hz("Centimeter",1,-27.94,55.88,1);z=hz("Centimeter",1,0,55.88,1);var ub=hz("Character",2,-316.8,316.8,.5);R=hz("Character",2,0,316.8,.5);h=[h,ba,ub];z=[r,z,R];r=DF();b.generalLabelProps={["type"]:"AppLabelProps",["id"]:"GeneralSection",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogGeneral,["forId"]:"GeneralGroup"};ba=[Box4Intl.Box4Strings.l_ParagraphDialogAlignLeft,Box4Intl.Box4Strings.l_ParagraphDialogAlignCenter,Box4Intl.Box4Strings.l_ParagraphDialogAlignRight,
Box4Intl.Box4Strings.l_ParagraphDialogAlignJustified,Box4Intl.Box4Strings.l_ParagraphDialogAlignDistributed];ub=["1","2","3","6","7"];let Ib=5;R=this.Ae.hasProperty(od.a.Zs)?this.Ae.getValue(od.a.Zs):0;if(10===R||9===R)R=11;if(t.AFrameworkApplication.lcid===Sj.a.pg("AR-SA").LCID||11===R)b.isKashidaSupported=!0,ba[Ib]=Box4Intl.Box4Strings.l_ParagraphDialogAlignKashida,ub[Ib]="11",Ib=6;if(t.AFrameworkApplication.lcid===Sj.a.pg("TH-TH").LCID||13===R)b.isThaiSupported=!0,ba[Ib]=Box4Intl.Box4Strings.l_ParagraphDialogAlignThaiDistributed,
ub[Ib]="13";ba={["type"]:"AppComboBoxProps",["id"]:"AlignmentComboBox",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogAlignment,["customTooltip"]:Box4Intl.Box4Strings.l_ParagraphDialogAlignmentAlt,["showLabel"]:!0,["options"]:DE(ba,ub),["allowFreeForm"]:!1};BF(R)?ba.selectedKey=R.toString():ba.defaultSelectedKey="";b.alignmentComboBoxProps=ba;(null===(ta=this.qx)||void 0===ta?0:ta.mlf)||(b.paginationLabelProps={["type"]:"AppLabelProps",["id"]:"PaginationSection",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogPagination,
["forId"]:"PaginationGroup"});this.qx.DCa&&(ta={["type"]:"AppCheckboxInternalProps",["id"]:"KeepWithNextCheckbox",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogKeepWithNext,["checked"]:IL(this.Ae)},b.keepWithNextCheckboxProps=ta);this.qx.DFa&&(ta={["type"]:"AppCheckboxInternalProps",["id"]:"WidowOrphanCheckbox",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogWidowOrphan,["checked"]:JL(this.Ae)},b.widowOrphanCheckboxProps=ta);this.qx.ofa&&(ta={["type"]:"AppCheckboxInternalProps",["id"]:"KeepTogetherCheckbox",
["label"]:Box4Intl.Box4Strings.l_ParagraphDialogKeepTogether,["checked"]:KL(this.Ae)},b.keepTogetherCheckboxProps=ta);b.indentationLabelProps={["type"]:"AppLabelProps",["id"]:"IndentationSection",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogIndentation,["forId"]:"IndentationGroup"};R=GL(this.Ae);ta="0"===R;b.specialIndentationComboBoxProps={["type"]:"AppComboBoxProps",["id"]:"SpecialComboBox",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogSpecialIndentation,["customTooltip"]:Box4Intl.Box4Strings.l_ParagraphDialogSpecialIndentationAlt,
["showLabel"]:!0,["options"]:DE([Box4Intl.Box4Strings.l_ParagraphDialogNoneIndent,Box4Intl.Box4Strings.l_ParagraphDialogFirstLineIndent,Box4Intl.Box4Strings.l_ParagraphDialogHangingIndent],["0","1","2"]),["selectedKey"]:R,["allowFreeForm"]:!1};ba=vb.App.kaa;R=0;({hfc:R,b4a:ba}=CF(this.Ae,od.a.v_,od.a.jba,ta));ta={["type"]:"AppSpinButtonProps",["id"]:"BySpinButton",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogSpecialIndentationBy,["customTooltip"]:Box4Intl.Box4Strings.l_ParagraphDialogSpecialIndentationByAlt,
["unitType"]:pg.a.WZb(ba),["validUnits"]:z,["numberFormatInfo"]:r};ta=this.xZf(R,ta);b.bySpinButtonProps=ta;z=vb.App.kaa;ta=0;({hfc:ta,b4a:z}=CF(this.Ae,od.a.Haa,od.a.Gaa,!1));z={["type"]:"AppSpinButtonProps",["id"]:"BeforeTextSpinButton",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogIndentLeft,["customTooltip"]:Box4Intl.Box4Strings.l_ParagraphDialogIndentLeftAlt,["unitType"]:pg.a.WZb(z),["validUnits"]:h,["numberFormatInfo"]:r};z=this.xZf(ta,z);b.beforeTextSpinButtonProps=z;z=vb.App.kaa;ta=0;({hfc:ta,
b4a:z}=CF(this.Ae,od.a.Sua,od.a.Rua,!1));h={["type"]:"AppSpinButtonProps",["id"]:"AfterTextSpinButton",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogIndentRight,["customTooltip"]:Box4Intl.Box4Strings.l_ParagraphDialogIndentRightAlt,["unitType"]:pg.a.WZb(z),["validUnits"]:h,["numberFormatInfo"]:r};h=this.xZf(ta,h);b.afterTextSpinButtonProps=h;h={["id"]:"ParagraphDialog",["bodyControls"]:b};if(null===(Wa=this.sO)||void 0===Wa?0:Wa.Qta)Wa={["type"]:"AppCheckboxInternalProps",["id"]:"ContextualSpacingCheckbox",
["label"]:Box4Intl.Box4Strings.l_ParagraphDialogContextualSpacing,["checked"]:HL(this.Ae)},b.contextualSpacingCheckboxProps=Wa;h.dialogButtonsOption=9;h.secondaryActionButtonProps={["id"]:"tabStopOptionsButton",["type"]:"AppButtonProps",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogTabStopOptions};h.styles={["root"]:{["#tabStopOptionsButton"]:{["float"]:"left",["margin-left"]:"0"}}};this.Wh(Box4Intl.Box4Strings.l_ParagraphDialogTitle,this.$Zd,h)}pjf(b){return this.b6g||(this.b6g=this.d1e(b))}d1e(b){var h,
r,z,R;b[od.a.Zs.id.toString()]=Lk.rji;b[od.a.Gaa.id.toString()]=Lk.QZd;b[od.a.Haa.id.toString()]=Lk.QZd;b[od.a.Rua.id.toString()]=Lk.RZd;b[od.a.Sua.id.toString()]=Lk.RZd;b[od.a.ZI.id.toString()]=Lk.ifc;b[od.a.jba.id.toString()]=Lk.ifc;b[od.a.v_.id.toString()]=Lk.ifc;if(null===(h=this.sO)||void 0===h?0:h.Qta)b[od.a.EUc.id.toString()]=Lk.NEk;if(null===(r=this.qx)||void 0===r?0:r.DCa)b[Li.a.Yh.id.toString()]=Lk.Hom;if(null===(z=this.qx)||void 0===z?0:z.DFa)b[Li.a.BM.id.toString()]=Lk.xro;if(null===(R=
this.qx)||void 0===R?0:R.ofa)b[Li.a.keepTogether.id.toString()]=Lk.Fom;return b}xZf(b,h){h.value=isNaN(b)?"":b;return h}}Object(n.a)(GH,"WordReactParagraphDialog",Wc.a,[]);class EE{static get vg(){return Wc.a.Px(EE.sl,"Count: ","Width: ","Spacing: ")}}EE.sl="<div class='WACDialogRow' id='RowColumns'> <div class='WacDialogLabels' id='ColumnsDialogLabels'> <label id='ColumnsDialogCount' class='DialogSpinnerLabel' >{0}</label> <br/> <label id='ColumnsDialogWidth' class='DialogSpinnerLabel' >{1}</label> <br/> <label id='ColumnsDialogSpacing class='DialogSpinnerLabel' >{2}</label> <br/> </div> <div class='WacSpinnerBoxes' id='ColumnsDialogSpinners'> <div id='ColumnsDialogCountSpinnerContainer' class='WacSpinnerBox'></div> <br/> <div id='ColumnsDialogWidthSpinnerContainer' class='WacSpinnerBox'></div> <br/> <div id='ColumnsDialogSpacingSpinnerContainer' class='WacSpinnerBox'></div> <br/> </div> </div>";
Object(n.a)(EE,"ColumnsDialogHtml",null,[]);class mm extends Wc.a{constructor(b,h,r,z){super();this.kg="ColumnsDialog";this.aL=h.clone();this.ZM=b.clone();this.Ae=b.clone();this.VO=r;this.zR=!1;this.kp=z;this.vg=EE.vg;r&&(this.tob=kr.a.R3a);this.Wh("Columns",Object(u.a)(this,this.Mzk,"columnsDialogResultHandler"),null);this.hCb()}cU(){this.rUe("ColumnsDialogCountSpinnerContainer","DialogCountSpinner",Oa.a.UYd,Oa.a.c1d,"Columns Count",0,mm.o_n,mm.tpm,mm.aHk);this.rUe("ColumnsDialogWidthSpinnerContainer",
"DialogWidthSpinner",Oa.a.WYd,Oa.a.e1d,"Columns Width",vb.App.kaa,mm.t9d,mm.qRd,mm.yro);this.rUe("ColumnsDialogSpacingSpinnerContainer","DialogSpacingSpinner",Oa.a.VYd,Oa.a.d1d,"Columns Spacing",vb.App.kaa,mm.s9d,mm.pRd,mm.$_n)}hCb(){for(let b=0;b<mm.B7.length;b++)Eh.a.Jja(mm.B7[b],Object(u.a)(this,this.Cva,"setAdvancedControlValue"),Object(u.a)(this,this.Msa,"getAdvancedControlValue"));this.kp.gM("DialogCountSpinner");this.kp.gM("DialogWidthSpinner");this.kp.gM("DialogSpacingSpinner")}dispose(){for(let b=
0;b<mm.B7.length;b++)Eh.a.jsa(mm.B7[b]);this.kp.RA("DialogCountSpinner");this.kp.RA("DialogWidthSpinner");this.kp.RA("DialogSpacingSpinner");super.dispose()}Msa(b,h){var r=this.fjb(b);if(this.Ae.hasProperty(r))if(r==Li.a.KC)b=this.Ae.getValue(r),h[Cc.a.Number]=b,h[Cc.a.UnitType]=0;else if(r==Li.a.Kx){b=vb.App.kaa;r=this.Ae.getValue(Li.a.iW);const z=this.Ae.getValue(Li.a.KC);r=this.Nzb(Li.a.Kx,z,r,0);h[Cc.a.Number]=pg.a.Gba(r,b);h[Cc.a.UnitType]=b}else r==Li.a.iW&&(b=vb.App.kaa,r=this.Ae.getValue(r),
h[Cc.a.Number]=pg.a.Gba(r,b),h[Cc.a.UnitType]=b);else h[Cc.a.Number]=0,h[Cc.a.UnitType]=0}Cva(b,h){var r=h[Cc.a.Number];h=h[Cc.a.UnitType];b=this.fjb(b);if(b==Li.a.KC)this.Ae.setValue(b,r),this.Ae.setValue(Li.a.iW,mm.ERk[r]),this.Ae.setValue(Li.a.Kx,[mm.FRk[r]]);else if(b==Li.a.iW){var z=this.Ae.getValue(Li.a.KC);h=pg.a.zQa(r,h);r=this.Nzb(Li.a.Kx,z,h,0);h=this.zah(Li.a.Kx,z,r,h);r=h[0];h=h[1];r>=mm.t9d&&r<=mm.qRd&&(this.Ae.setValue(b,h),this.Ae.setValue(Li.a.Kx,[r]))}else b==Li.a.Kx&&(z=this.Ae.getValue(Li.a.KC),
r=pg.a.zQa(r,h),h=this.Nzb(Li.a.iW,z,0,r),h=this.zah(Li.a.iW,z,r,h),r=h[0],h=h[1],h>=mm.s9d&&h<=mm.pRd&&(this.Ae.setValue(b,[r]),this.Ae.setValue(Li.a.iW,h)));this.kp.yl()}Nzb(b,h,r,z){var R=this.aL.getValue(yc.a.Lo),ba=this.aL.getValue(yc.a.marginLeft);const ta=this.aL.getValue(yc.a.marginRight);R=R-ba-ta;ba=0;b==Li.a.iW?ba=(R-h*z)/(h-1):b==Li.a.Kx&&(ba=(R-(h-1)*r)/h);return ba}zah(b,h,r,z){b==Li.a.iW?z<mm.s9d?(z=mm.s9d,r=this.Nzb(Li.a.Kx,h,z,0)):z>mm.pRd&&(z=mm.pRd,r=this.Nzb(Li.a.Kx,h,z,0)):b==
Li.a.Kx&&(r<mm.t9d?(r=mm.t9d,z=this.Nzb(Li.a.iW,h,0,r)):r>mm.qRd&&(r=mm.qRd,z=this.Nzb(Li.a.iW,h,0,r)));return[r,z]}Mzk(b){let h=!1;var r=this.Ae.getValue(Li.a.Kx);const z=this.Ae.getValue(Li.a.KC),R=this.Ae.getValue(Li.a.iW);let ba=0;for(let ta=0;ta<z;ta++)ba+=r[0];r=this.aL.getValue(yc.a.Lo)-this.aL.getValue(yc.a.marginLeft)-this.aL.getValue(yc.a.marginRight);1===b&&(13>=z&&(z-1)*R+ba<=r?DC(this.ZM,this.Ae,mm.IYa()):h=!0);this.dispose();h&&this.Eva("The page does not fit the current columns sizes.  Please try changing them.",
Object(u.a)(this,this.Lzk,"marginDialogCreator"))}Lzk(){Sa.a.instance.resolve("WordEditor.UI.IDialogFactory").gth(this.ZM,this.aL,this.VO)}rUe(b,h,r,z,R,ba,ta,Wa,ub){r=mm.Ykk(h,r,z,R,ba,ta,Wa,ub);this.DVa(r,b,h)}DVa(b,h,r){h=document.getElementById(h);this.kp.Pya(r,b);b=this.kp.hYa(r,"Medium");h.appendChild(b)}fjb(b){let h=null;switch(b){case Oa.a.UYd:case Oa.a.c1d:h=Li.a.KC;break;case Oa.a.WYd:case Oa.a.e1d:h=Li.a.Kx;break;case Oa.a.VYd:case Oa.a.d1d:h=Li.a.iW}return h}static IYa(){return mm.MY||
(mm.MY=mm.hKa())}static hKa(){const b={};b[Li.a.KC.id.toString()]=sp.yzk;b[Li.a.Kx.id.toString()]=sp.Kzk;b[Li.a.iW.id.toString()]=sp.Izk;return b}static Ykk(b,h,r,z,R,ba,ta,Wa){return 0==R?Kf.l(b,h,r,z,[mm.alk(R,ba,ta,Wa)]):Kf.l(b,h,r,z,[mm.$kk(pg.a.Gba(ba,3),pg.a.Gba(ta,3),Wa),mm.Zkk(pg.a.Gba(ba,1),pg.a.Gba(ta,1),Wa)])}static $kk(b,h,r){return Kf.n("inch",b.toString(),h.toString(),r.toString())}static Zkk(b,h,r){return Kf.n("centimeter",b.toString(),h.toString(),r.toString())}static alk(b,h,r,z){return Kf.n(b.toString(),
h.toString(),r.toString(),z.toString())}}mm.B7=[Oa.a.c1d,Oa.a.e1d,Oa.a.d1d,Oa.a.UYd,Oa.a.WYd,Oa.a.VYd];mm.o_n=1;mm.tpm=13;mm.aHk=1;mm.t9d=720;mm.qRd=9360;mm.yro=.1;mm.s9d=0;mm.pRd=7920;mm.$_n=.1;mm.ERk=[-1,0,720,720,720,720,720,720,520,360,245,144,72,0];mm.FRk=[-1,9360,4320,2635,1800,1296,965,720,720,720,720,720,720,720];mm.MY=null;Object(n.a)(mm,"ColumnsDialog",Wc.a,[]);class HH{SHk(b){new BC(b,Sa.a.instance.resolve("Box4.IFeatureHelper"))}BLk(b,h){t.AFrameworkApplication.ua&&t.AFrameworkApplication.ua.Sb.KA?
new DH(b,h):new rH(b,h)}N_k(b,h,r){new EH(b,h,r)}kuh(b,h,r){new nu(b,h,r,Sa.a.instance.resolve("WordEditor.IPageCommands"),Sa.a.instance.resolve("Common.IStandaloneRootController").y3,!!vb.App.instance&&vb.App.instance.Igb)}Puh(b,h,r){new Oq(b,h,r,Sa.a.instance.resolve("WordEditor.IPageCommands"),Sa.a.instance.resolve("Common.IStandaloneRootController").y3,!!vb.App.instance&&vb.App.instance.Igb)}gth(b,h,r){new mm(b,h,r,Sa.a.instance.resolve("Common.IStandaloneRootController").y3)}mHk(b){return new PB(b)}k_b(b,
h,r,z){t.AFrameworkApplication.ua&&t.AFrameworkApplication.ua.Sb.KA&&t.AFrameworkApplication.K.$("ReactParagraphDialogIsEnabled")?new GH(b,h,r,t.AFrameworkApplication.ya,z):new ar(b,h,r,Sa.a.instance.resolve("Box4.IIndentationCommands"),Sa.a.instance.resolve("Box4.IJustificationCommands"),Sa.a.instance.resolve("Box4.ISpacingCommands"),Sa.a.instance.ef("Box4.IFeatureHelper"),t.AFrameworkApplication.K,Sa.a.instance.resolve("Box4.IParagraphIndentationReader"),Sa.a.instance.resolve("Common.IStandaloneRootController").y3,
z)}kTk(){const b=Sa.a.instance.Pa("Box4.IRoamingServiceRequestManager");null==b?ud.b(524834398,3018,10,"Roaming service not resolved."):new sH(b)}nTk(b,h){new tH(b,h)}l3e(b){return new uH(b)}}Object(n.a)(HH,"DialogFactory",null,[505,506]);class OD extends Wc.a{constructor(b,h){super(!1,!1,!0);this.NAh="DoNotCheckSpellingCheckbox";this.$Ah="DocumentChoiceGroup";this.i9c=0;this.Hji="LanguageList";this.documentContext="DocumentContext";this.Fq="RangeContext";this.pLn=(r,z)=>{if(xg.a.instance.J(9)){var R=
wc.a.instance.oo(Fb.a.LZi);if(1!==r)R.properties.Z("canceled","true");else{r=z[this.Hji].replace(OD.xeg,"");var ba=parseInt(r),ta=Boolean.parse(z[this.NAh]);z=z[this.$Ah];z===this.documentContext?this.Ked.cJn(ba,ta):this.Ked.rOn(ba,ta);R.properties.Z("PreviousLCID",this.i9c.toString());R.properties.Z("ChangedLCID",ba.toString());R.properties.Z("NoProof",ta.toString());this.rNg.oLn(ba,this.i9c);Lb.d(Fb.a.LZi,!0,void 0,void 0,void 0,void 0,[Object.assign(new ca.a,{name:"SelectedLcid",string:r}),Object.assign(new ca.a,
{name:"NoProof",string:ta.toString()}),Object.assign(new ca.a,{name:"Context",string:z})]);vb.App.xa.updateCommandUI(!0)}R.end()}};this.rNg=h;this.Ked=b}E0f(){const b=Array(2);b[0]={["key"]:this.Fq,["text"]:WordEditorIntl.WordEditorStrings.l_SelectedText};b[1]={["key"]:this.documentContext,["text"]:WordEditorIntl.WordEditorStrings.l_CurrentDocument};const h={showDocumentChoiceGroup:!0};h.markSelectedText=Box4Intl.Box4Strings.l_MarkSelectedText;h.documentChoiceGroupProps={["id"]:this.$Ah,["defaultSelectedKey"]:this.qpl(),
["label"]:WordEditorIntl.WordEditorStrings.l_ChangeProofingLanguage,["options"]:b};this.i9c=({Ban:this.AAj}=this.Ked.cIl()).returnValue;h.languageListPropsProvider=this.Nwl();h.spellingCheckboxProps={["id"]:this.NAh,["checked"]:!this.AAj,["label"]:WordEditorIntl.WordEditorStrings.l_DoNotCheckSpellingOrGrammar};this.Wh(Box4Intl.Box4Strings.l_Language,this.pLn,{["id"]:"LanguageDialog",["bodyControls"]:h})}qpl(){return this.Ked.xf()?this.documentContext:this.Fq}Nwl(){return()=>{let b,h;const r=({selectedIndex:b,
j7i:h}=this.rNg.Mwl(this.i9c)).returnValue;for(let z=0;z<r.length&&z<h;z++)r[z].value=OD.xeg+r[z].value;return{["id"]:this.Hji,["items"]:r,["selectedLanguageIndex"]:b,["applyBorderIndex"]:h}}}}OD.xeg="recent-";Object(n.a)(OD,"ReactLanguageDialog",Wc.a,[504]);class IH extends MD{constructor(b,h,r,z){super(h,r);this.JLf=()=>{this.floatie.yl()};this.Eh=b;this.IH=z}cbb(b,h,r){if(b=super.cbb(b,h,r))b.jbc=!0,b.t0d=!0,b.preventDismissOnScroll=!0;this.Eh.pVa(this.JLf);return b}mMc(b,h,r=null){this.IH.zfh(()=>
this.cbb(b,h,r))}kXd(){this.floatie.jbc=!0}}Object(n.a)(IH,"ExternalContentFloatieInitializer",MD,[]);class JH{eHb(){wl.instance.jma&&(on.instance.l4a([1,0]),wl.instance.SQd()&&Xr.instance.l4a([1]))}}Object(n.a)(JH,"RulerUser",null,[503]);class KH{constructor(){this.whitelistedControlIds=null}}Object(n.a)(KH,"StatusBarProps",null,[]);class PD{constructor(b,h){this.Bjd=!1;this.aEe=null;this.Wca=h.hG;this.rIe=h.f8i;Si.a.get_instance().tl(7,()=>{window.setTimeout(()=>{Cp.a.instance.Pd(()=>{Uk.UISurfaces.WJl().then(r=>
{const z=Object.assign(new KH,{whitelistedControlIds:h.whitelistedControlIds});r.initializeNewStatusBar(b,z,this.rIe);this.aEe=r;this.Bjd=!0;window.setTimeout(()=>{Cp.a.instance.Pd(()=>{const R=[];if(h.eG){const ba=h.eG;for(let ta in ba)R.push(appChrome.actions.updateControlHiddenState(ta,ba[ta]));appChrome.api.dispatch(R)}this.eHb()},"RSB:I2")},0);return null}).catch(()=>{v.ULS.sendTraceTag(51656736,324,10,"Failed to load React Status Bar API");return null})},"RSB:I1");if(h.koa&&b){PD.ZGg||(t.AFrameworkApplication.ya.pa(ab.a.h8i,
Yd.a.frame,Object(u.a)(this,this.i8i,"statusBarTabAction")),t.AFrameworkApplication.ya.pa(ab.a.g8i,Yd.a.frame,Object(u.a)(this,this.i8i,"statusBarTabAction")),PD.ZGg=!0);const r=kr.a.qnf(h.koa,h.WYi,b,!1);r.UL=!0;this.Ubc(r,ab.a.h8i,ab.a.g8i)}},0)})}eHb(){this.Bjd&&this.Wca&&window.setTimeout(()=>{this.Wca(this.aEe.selectors.getStatusBarControlsMap(this.rIe),7)},0)}gkb(b,h){this.Bjd&&window.setTimeout(()=>{appChrome.api.dispatch(appChrome.actions.updateControlHiddenState(b,h))},0)}MQ(b){this.Bjd&&
this.Wca&&window.setTimeout(()=>{const h=this.aEe.selectors.getStatusBarControlsMap(this.rIe);if(h[b]){const r={};r[b]=h[b];this.Wca(r,7)}},0)}Ubc(b,h,r){const z=rc.KeyInputManager.lc(wb.a.mx,0),R=rc.KeyInputManager.lc(wb.a.mx,4);b.Dr(z);b.Dr(R);b.bindAction(z,h);b.bindAction(R,r)}i8i(){return 4}}PD.ZGg=!1;Object(n.a)(PD,"ReactStatusBar",null,[]);class LH{constructor(){this.whitelistedControlIds=this.eG=this.hG=null;this.onm=!1;this.WYi=this.koa=this.f8i=null}}Object(n.a)(LH,"ReactStatusBarInitOptions",
null,[]);var QB=d(473);class MH{constructor(b,h,r,z,R){this.QTb=this.pIa=this.Oa=null;this.L2n=()=>{const ba=vb.App.xa.$o.getRegion(tf.AppFrame.koa);ba&&ba.FAf()};this.iVl=(ba,ta,Wa,ub,Ib)=>{if(!Ib)return v.ULS.sendTraceTag(572135558,306,10,String.format("{0}","actionData is null for visibility toggle")),8;if(1===Wa)return 32;Ib&&2===Ib.length&&this.pIa&&this.pIa.gkb(Ib[0],Ib[0]);return 32};this.V3c=ba=>{vb.App.xa.hG(ba)};this.ga=z;Cp.a.instance.Pd(()=>{this.Oa=R;this.QTb=this.pIa=null;let ba={};
t.AFrameworkApplication.p5i||(ba[QB.a.sAn]=!0);ba.GiveFeedback=!t.AFrameworkApplication.xE;this.Oa.$("OfficeOnlineInGallatinTextVisible")||(ba.CenterStatusLabel=!0);ba[QB.a.zCi]=!0;this.Oa.$("WPMPackageIsEnabled")&&this.Oa.$("WPMStatusBarLabelIsEnabled")||(ba[QB.a.Eag]=!0);this.Oa.$("AddInCommandsIsEnabled")||(ba[QB.a.c3j]=!0);this.Oa.$("WordEditorShowOcsConnectionStatus")||(ba[QB.a.qWd]=!0);ba[QB.a.aso]=!0;this.Oa.$("ReadingTimeIsEnabled")||(ba[QB.a.fKi]=!0);window.setTimeout(()=>{this.W3l(b,ba)},
0)},"SBU:I")}Vb(){this.ga.gb(Fb.a.c$d,kc.a.application,this.iVl,96)}W3l(b,h){this.QTb=Sa.a.instance.Pa("WordEditor.WordEditorReactCommandDefinitionMapping");const r={};for(let R in h){var z=h[R];r[this.Ygf(R)]=z}this.pIa=new PD(b,Object.assign(new LH,{eG:r,hG:this.V3c,onm:!1,f8i:"WordEditorStatusBar",koa:tf.AppFrame.koa,WYi:this.L2n}))}Ygf(b){let h="";if(this.QTb){const r=this.QTb.Ldf(b);r&&0<r.count&&(h=r.J(0))}return h&&""!==h?h:b}eHb(){this.pIa&&this.pIa.eHb()}gkb(b,h){this.pIa&&this.pIa.gkb(this.Ygf(b),
h)}MQ(b){this.pIa&&this.pIa.MQ(this.Ygf(b))}dispose(){}}Object(n.a)(MH,"StatusBarUser",null,[502,9]);var NH=d(1026);class EF{constructor(b){this.ga=b;this.ga.pa(ab.a.xYc,Yd.a.frame,Object(u.a)(this,this.xYc,"reportFileMenuPageSwitch"));this.ga.pa(ab.a.vQi,Yd.a.frame,$c.ActionManager.Nf)}xYc(b,h,r,z,R){this.ga.processAction(this.Lrl(R[NH.a.IZd]),2);return 32}}Object(n.a)(EF,"FileMenuSQMInformation",null,[892]);class OH extends EF{constructor(b){super(b);this.Rkn()}Rkn(){this.ga.pa(ab.a.GTf,Yd.a.frame,
$c.ActionManager.Nf);this.ga.pa(ab.a.pQi,Yd.a.frame,$c.ActionManager.Nf);this.ga.pa(ab.a.HTf,Yd.a.frame,$c.ActionManager.Nf);this.ga.pa(ab.a.qQi,Yd.a.frame,$c.ActionManager.Nf);this.ga.pa(ab.a.rQi,Yd.a.frame,$c.ActionManager.Nf);this.ga.pa(ab.a.ITf,Yd.a.frame,$c.ActionManager.Nf);this.ga.pa(ab.a.sQi,Yd.a.frame,$c.ActionManager.Nf);this.ga.pa(ab.a.tQi,Yd.a.frame,$c.ActionManager.Nf);this.ga.pa(ab.a.uQi,Yd.a.frame,$c.ActionManager.Nf);this.ga.pa(ab.a.YQi,Yd.a.frame,$c.ActionManager.Nf);this.ga.pa(ab.a.ZQi,
Yd.a.frame,$c.ActionManager.Nf);this.ga.pa(ab.a.AQi,Yd.a.frame,$c.ActionManager.Nf);this.ga.pa(ab.a.BQi,Yd.a.frame,$c.ActionManager.Nf)}Lrl(b){switch(b){case "menuJewelAbout":case "FileAboutPage":return ab.a.GTf;case "tabHome":case "FileHomePage":return ab.a.pQi;case "menuJewelInfo":case "FileInfoPage":return ab.a.HTf;case "menuJewelNew":case "FileNewPage":return ab.a.qQi;case "menuJewelOpen":case "FileOpenPage":return ab.a.rQi;case "menuJewelPrint":case "FilePrintPage":return ab.a.ITf;case "menuJewelSaveAs":case "FileSaveAsPage":return ab.a.sQi;
case "menuJewelShare":case "FileSharePage":return ab.a.tQi;case "menuJewelTransform":case "FileTransformPage":return ab.a.uQi}return ab.a.vQi}}Object(n.a)(OH,"WordEditorFileMenuSQMInformation",EF,[]);var PH=d(1024);class FF{constructor(b){this.ga=b;this.ga.pa(ab.a.yYc,Yd.a.frame,Object(u.a)(this,this.yYc,"reportTabSwitch"));this.ga.pa(ab.a.TQi,Yd.a.frame,$c.ActionManager.Nf);this.ga.pa(ab.a.VQi,Yd.a.frame,$c.ActionManager.Nf)}yYc(b,h,r,z,R){this.ga.processAction(this.VGl(R[PH.a.R3f]),2);return 32}}
Object(n.a)(FF,"RibbonSQMInformation",null,[849]);class QH extends FF{constructor(b){super(b);this.enn()}enn(){this.ga.pa(ab.a.LQi,Yd.a.frame,$c.ActionManager.Nf);this.ga.pa(ab.a.MQi,Yd.a.frame,$c.ActionManager.Nf);this.ga.pa(Oa.a.KTf,Yd.a.frame,$c.ActionManager.Nf);this.ga.pa(ab.a.NQi,Yd.a.frame,$c.ActionManager.Nf);this.ga.pa(ab.a.OQi,Yd.a.frame,$c.ActionManager.Nf);this.ga.pa(Oa.a.PQi,Yd.a.frame,$c.ActionManager.Nf);this.ga.pa(Oa.a.QQi,Yd.a.frame,$c.ActionManager.Nf);this.ga.pa(Oa.a.RQi,Yd.a.frame,
$c.ActionManager.Nf);this.ga.pa(Oa.a.SQi,Yd.a.frame,$c.ActionManager.Nf);this.ga.pa(Oa.a.LTf,Yd.a.frame,$c.ActionManager.Nf);this.ga.pa(Oa.a.UQi,Yd.a.frame,$c.ActionManager.Nf);this.ga.pa(ab.a.WQi,Yd.a.frame,$c.ActionManager.Nf);this.ga.pa(Oa.a.XQi,Yd.a.frame,$c.ActionManager.Nf)}VGl(b){switch(b){case "tabAddins":case "Addins":return ab.a.LQi;case "tabHome":case "Home":return ab.a.NQi;case "tabInsert":case "Insert":return ab.a.OQi;case "tabDeveloper":case "Developer":return ab.a.MQi;case "tabPageLayout":case "Layout":return Oa.a.PQi;
case "tabReferences":case "References":return Oa.a.SQi;case "tabReview":case "Review":return Oa.a.LTf;case "tabView":case "View":return ab.a.WQi;case "Table":case "TableLayout":case "ContextualTabs.Tables.Design":case "ContextualTabs.Tables.Layout":return Oa.a.UQi;case "tabMailings":case "Mailings":return Oa.a.QQi;case "tabWordDesign":case "Design":return Oa.a.XQi;case "tabHelp":case "Help":return Oa.a.KTf;case "ctabPictureTools":case "Picture":return Oa.a.RQi}return ab.a.VQi}}Object(n.a)(QH,"WordEditorRibbonSQMInformation",
FF,[]);class RH{constructor(b=null,h=null,r=null){this.eG=b||{};this.fdj=h||[];this.hdj=r||{}}}Object(n.a)(RH,"RibbonTrimmingProperties",null,[]);class SH{constructor(b,h,r){this.esa=b;this.eG=h;this.Luf=r}}Object(n.a)(SH,"ReactRibbonJewelProperties",null,[]);class TH{constructor(){t.AFrameworkApplication.ya.pa(ab.a.eNa,Yd.a.frame,Object(u.a)(this,this.Hfn,"reactFileMenuOpenFromTellMe"))}Hfn(b,h,r,z,R){if(1===r||!R)return 32;b=R.SourceControlId;17!==R.UILocation||"New"!==b&&"Open"!==b||(R=[],yh.d("setFileMenuSelectedPage")&&
("New"===b&&t.AFrameworkApplication.ua?2===t.AFrameworkApplication.ua.Sb.jo?R.push(appChrome.actions.setFileMenuSelectedPage("PptFileNewPage")):R.push(appChrome.actions.setFileMenuSelectedPage("FileNewPage")):"Open"===b&&t.AFrameworkApplication.ua&&(2===t.AFrameworkApplication.ua.Sb.jo?R.push(appChrome.actions.setFileMenuSelectedPage("PptFileOpenPage")):R.push(appChrome.actions.setFileMenuSelectedPage("FileOpenPage")))),R.push(appChrome.actions.updateFileMenuExpandedValue(!0)),appChrome.api.dispatch(R));
return 32}uki(){appChrome.api.dispatch(appChrome.actions.updateFileMenuExpandedValue(!0))}FOa(){return!1}fFi(){}yAh(){}}Object(n.a)(TH,"ReactFileMenu",null,[532]);class UH{K_e(){const b=new TH,h=[];h.push(appChrome.actions.updateFileMenuExpandedValue(!1));h.push(appChrome.actions.updateFileMenuDisabledValue(!1));appChrome.api.dispatch(h);return b}}Object(n.a)(UH,"ReactFileMenuFactory",null,[520]);class EC{constructor(b,h,r,z=!1){this.sLb=b;this.UKg=this.sLb.l_a;this.sWd=Sa.a.instance.Pa("Common.IOfficeTrialExperience");
this.hFb=Sa.a.instance.Pa("Common.IMacOfficeOffer");EC.vje=!1;this.Qhm=z;this.ga=h;this.Wb=r}get zc(){return this.ga}get Ci(){return this.Wb}LRe(){return this.UKg&&!!this.sWd&&!!this.hFb}MQa(b,h){this.sLb.zq(()=>{v.ULS.sendTraceTag(5878046,340,50,"Full app settings are ready");this.UKg=!0;this.U7e(b,h)});Sa.a.instance.Za("Common.IOfficeTrialExperience").execute(r=>{v.ULS.sendTraceTag(5878049,340,50,"IOfficeTrialExperience object is ready");this.sWd=r;this.U7e(b,h)});Sa.a.instance.Za("Common.IMacOfficeOffer").execute(r=>
{v.ULS.sendTraceTag(5878050,340,50,"IMacOfficeOffer object is ready");this.hFb=r;this.U7e(b,h)})}U7e(b,h){EC.vje||(this.LRe()?(v.ULS.sendTraceTag(5878051,340,50,"ExecuteCallbackWhenReady: ready"),b(this,h),EC.vje=!0):v.ULS.sendTraceTag(5878080,340,100,"ExecuteCallbackWhenReady: not ready yet"))}}EC.vje=!1;Object(n.a)(EC,"RibbonDependencies",null,[771]);class GF{constructor(b,h,r){this.Apb=b;this.ga=h;this.Wb=r}}Object(n.a)(GF,"WoncaRibbonUserFactory",null,[51]);class VH{constructor(b,h){this.Kke=
b;this.uWb=h}Akb(b){this.Kke.Akb(b);this.uWb&&this.uWb.Akb(b)}o_c(b){this.Kke.o_c(b);this.uWb&&this.uWb.o_c(b)}X3c(b){this.Kke.X3c(b);this.uWb&&this.uWb.X3c(b)}}Object(n.a)(VH,"RibbonCommandTrimmer",null,[521]);var LL=d(1215);class WH{constructor(b,h){this.Oa=b;this.fUb=h}Akb(b){X.a.ki&&6>X.a.rZa&&(b.fseaInsertPicture=!0);this.Oa.$("InsertSymbolIsEnabled")||(b.grpInsertSymbols=!0);this.Oa.$("ClipartInsertEnabled")||(b.fseaInsertClipart=!0);this.Oa.$("UIDiscoverabilityEnabled")||(b.jbtnAccessibilityHelp=
!0);wh.a.gfi()||(b.InsertLoopComponentsForConsumers=!0);const h=this.Oa.$("InsertOnlinePictureEnabled"),r=t.AFrameworkApplication.rrf();h||(b.fseaInsertOnlinePicture=!0,b.fseaFlyInsertOnlinePictureFromSearch=!0);r?b.fseaInsertPictureFromOneDrive=!0:(b.fseaFlyInsertOnlinePictureFromHost=!0,b.fseaInsertOnlinePictureFromHost=!0);r&&h?(b.fseaInsertOnlinePicture=!0,b.fseaInsertOnlinePictureFromHost=!0):b.flyOnlinePicture=!0;t.AFrameworkApplication.srf()||(b.InsertPictureFromMobileDevice=!0,b.ChangePictureFromMobileDevice=
!0);t.AFrameworkApplication.Dbe&&(b.btnOpenInClient=!0);t.AFrameworkApplication.K.$("DisablePrintBasedOnPolicy")&&t.AFrameworkApplication.K.$("DisablePrint")&&this.Rgc(b)}o_c(b){b.menuJewel=!0;t.AFrameworkApplication.xE||(b.jbtnGiveFeedback=!0)}Rgc(b){b.faPrint=!0;b.jbtnSaveACopy=!0;b.jbtnSaveAsToHost=!0;b.jbtnSaveToSharePoint=!0;b.jbtnDownloadACopy=!0;b.jbtnDownloadAsPdf=!0;b.jbtnDownloadAsOdt=!0;b.jbtnPrintToPdf=!0;b.jbtnDirectPrint=!0}X3c(b){delete b.menuJewel;t.AFrameworkApplication.bjb||(b.jbtnPrivacy=
!0);t.AFrameworkApplication.uYc||(b.jbtnReportAbuse=!0);t.AFrameworkApplication.Aae||(b.jbtnTermsOfUse=!0);t.AFrameworkApplication.tCd||(b.jbtnFileSharing=!0);xg.a.instance.J(4)&&t.AFrameworkApplication.Ejb||(b.jbtnShareRWC=!0);t.AFrameworkApplication.W8e||t.AFrameworkApplication.z9f||(b.jbtnVersion=!0);this.fUb.sWd&&this.fUb.sWd.RNm||(b.btnjTryOffice=!0,b.btnjTryOfficeForWordEditor=!0);this.fUb.hFb&&this.fUb.hFb.QTn||(b.btnjTryMacOffice=!0,b.btnjTryMacOfficeForWordEditor=!0);t.AFrameworkApplication.Dbe?
(b.btnjOpenInClient=!0,b.btnjEditInClient=!0):b[vb.App.As?"btnjOpenInClient":"btnjEditInClient"]=!0;t.AFrameworkApplication.gbo&&(b.jbtnDownloadACopy=!0,b.jbtnDownloadAsPdf=!0,b.jbtnDownloadAsOdt=!0);t.AFrameworkApplication.K.$("DisablePrintBasedOnPolicy")&&t.AFrameworkApplication.K.$("DisablePrint")?this.Rgc(b):t.AFrameworkApplication.K.$("DirectPrintIsEnabled")?b.jbtnPrintToPdf=!0:b.jbtnDirectPrint=!0;t.AFrameworkApplication.jO&&(this.Rgc(b),b.faShare=!0);if(t.AFrameworkApplication.protectFile||
X.a.OMa||!t.AFrameworkApplication.lLc&&!t.AFrameworkApplication.N8e&&!t.AFrameworkApplication.x9f)b.jbtnFileEmbed=!0;LL.a.x0l()||(b.btnjClose=!0);t.AFrameworkApplication.F7b?(b.jbtnVersion=!0,v.ULS.sendTraceTag(594629315,3005,15,"Word external version history menu item for OneDriveConsummer trimmed.")):t.AFrameworkApplication.xuf()||(b.btnjVersionHistory=!0);b.jbtnVersion&&b.btnjVersionHistory&&b.btnjOpenInClient&&b.btnjEditInClient&&(b.faInfo=!0);t.AFrameworkApplication.ZPf||(b.faOpen=!0);b.jbtnFileSharing&&
b.jbtnFileEmbed&&b.jbtnShareRWC&&(b.faShare=!0);b.AboutInformationMenuSectionDiagnostics=!this.Oa.$("DiagnosticsInfoInJewelAboutMenuIsEnabled");b.btnjTryOffice&&b.btnjTryMacOffice&&b.jbtnTermsOfUse&&b.jbtnPrivacy&&b.AboutInformationMenuSectionDiagnostics&&(b.faAbout=!0);b.jbtnHelp&&b.jbtnGiveFeedback&&b.jbtnReportAbuse&&(b.faHelp=!0);b.btnjClose&&(b.msJewelSecondary=!0);const h=!!t.AFrameworkApplication.ua&&t.AFrameworkApplication.ua.Sb.ngi;if(b.faOpen&&b.faNew||!h)b.faHome=!0}}Object(n.a)(WH,"WoncaCommandTrimmer",
null,[521]);var ML=d(973);d(467);var NL=d(1025),OL=d(1129);class XH{constructor(b,h){this.C0=this.uJ=null;this._clientId=b;this.V8=h}I3k(){if(!qf.c(this.C0))return this.C0;this.j7e();this.C0.style.display="block";this.V8&&this.V8.o1(Object(u.a)(this,this.onResize,"onResize"));return this.C0}onResize(){this.vva()}vva(){this.Q6e()?(document.getElementById("application").style.minWidth="0px",(new OL.a(this.C0,null,t.AFrameworkApplication.isRtl)).sCn(this.C0)):t.AFrameworkApplication.ua.Sb.BI||NL.a.tCn(this.C0,
t.AFrameworkApplication.isRtl)}Q6e(){return t.AFrameworkApplication.K?t.AFrameworkApplication.K.$("EnhancedMobileViewIsEnabled"):!1}j7e(){if(qf.c(this.uJ)){var b;({C4b:b}=kr.a.Vgc(!t.AFrameworkApplication.eQ)).returnValue&&(this.uJ=qE.a("div"),this.uJ.className=kr.a.Z5k,this.uJ.id=In.CuiHelper.QBd,b.appendChild(this.uJ),this.c7e(),t.AFrameworkApplication.ua&&t.AFrameworkApplication.ua.Sb.B6&&!t.AFrameworkApplication.eQ&&this.d7e(),this.H3k())}}H3k(){qf.c(this.C0)&&(this.C0=qE.a("div"),this.C0.className=
kr.a.$5f,this.C0.style.display="none",this.uJ.appendChild(this.C0))}c7e(){Sys.UI.DomElement.addCssClass(this.uJ,kr.a.$5k);t.AFrameworkApplication.isRtl&&qE.b(this.uJ,"cui-rtl")}d7e(){Sys.UI.DomElement.addCssClass(this.uJ,"FlexBoxLayout")}}Object(n.a)(XH,"HeaderSkeleton",null,[]);var QD=d(634);class HF{constructor(){this.Wic=null}Yco(){this.Wic||(this.Wic=Sa.a.instance.Pa("Common.App.AccountSwitching.IAccountSwitching"))||v.ULS.sendTraceTag(589050651,1300,10,"Unable to resolve IAccountSwitching")}xgl(){this.Yco();
return this.Wic?this.Wic.getCustomAuthConfig():null}static Wam(){return t.AFrameworkApplication.K.$("UiHostSupportsCustomAuthConfig")}}Object(n.a)(HF,"ReactSharedHeaderAccountSwitchingUtils",null,[]);class IF{constructor(){this.t8b=this.cultureName=null}}Object(n.a)(IF,"HeaderCultureInfo",null,[]);var FE=d(1583);class YH{constructor(){this.getTokenRequestDictionary=this.userRing=this.loadTellMeResources=null}}Object(n.a)(YH,"SearchInitializationSettings",null,[]);var FC=d(286);class ZH{constructor(){this.saveStatus=
this.documentTitle=null;this.isVersionHistoryEnabled=!1;this.breadcrumbFolderUrl=this.breadcrumbFolderName=this.breadcrumbBrandUrl=this.breadcrumbBrandName=null;this.hideDocumentTitleInput=!1;this.getCalloutAppProps=this.onFirstRender=this.onGetSuggestedTitle=this.documentExtension=null;this.isShared=!1}}Object(n.a)(ZH,"DocumentTitleAppProps",null,[]);class $H{constructor(){this.documentExtension=this.breadcrumbFolderUrl=this.breadcrumbFolderName=this.breadcrumbBrandUrl=this.breadcrumbBrandName=null;
this.isMoveEnabled=this.isVersionHistoryEnabled=this.hideDocumentTitleInput=!1;this.renameDisableReason=this.message=this.onMove=null;this.openBreadcrumbsInNewTab=!1}}Object(n.a)($H,"DocumentTitleCalloutAppProps",null,[]);class aI{constructor(){this.language=this.culture=this.userID=this.emailAddress=this.userDisplayName=this.appName=null;this.defaultDocumentTitleToLeft=this.hideUserName=this.showMeControl=this.showAppLauncher=this.isConsumer=!1;this.documentTitleAppProps=this.controls=this.assetsContainerOverride=
null;this.showGoPremiumControl=this.enableSearchControl=this.showSearchControl=this.showChatControl=!1;this.onFlexPaneClose=this.onFlexPaneOpen=this.getTokenRequestDictionary=this.signOutLink=this.signInLink=null;this.enableTheming=!1;this.userRing=null;this.testTraffic=!1;this.onLoadFailed=this.onFullyLoaded=this.onFirstRender=this.loadTellMeResources=null;this.showDocumentTitleControl=this.showRibbonToggle=this.showWorkflowButton=this.enableVanillaSearchBox=!1;this.shellAuthProviderConfigPromise=
null;this.enableUpdatedRUMReporting=!1}}Object(n.a)(aI,"HeaderAppProps",null,[]);class bI{constructor(){this.workflowButton=this.ribbonToggleId=null}}Object(n.a)(bI,"HeaderControls",null,[]);class cI{constructor(){this.command=this.label=null}}Object(n.a)(cI,"WorkflowButtonAppProps",null,[]);var GE;(function(b){b[b.none=0]="none";b[b.readOnly=1]="readOnly";b[b.insufficientPermission=2]="insufficientPermission";b[b.incompatibleEditorsPresent=3]="incompatibleEditorsPresent";b[b.editorsPresent=4]="editorsPresent";
b[b.notSupported=5]="notSupported"})(GE||(GE={}));Object(n.b)("RenameDisableReason",GE);class dI{constructor(b=""){this.hWf=this.documentTitleAppProps=this.Cag=null;this.kWj=""!==b?b:Eg.a.E7}PFl(b){const h=Sa.a.instance.Pa("Common.IExternalUICommandDefinitionMapping").vdb(b);if(h&&0<h.length)return h[0].externalUxCommand;v.ULS.sendTraceTag(594929363,340,10,String.format("GetReactCommand cannot find the command mapping for {0}",b));return null}rjf(){if(!this.Cag){const b=QD.a();if(b){const h=this.PFl(b.command);
h&&(this.Cag=Object.assign(new cI,{command:h,label:b.label}))}}return this.Cag}Fnl(){return Object.assign(new bI,{workflowButton:this.rjf()})}FRm(){Si.a.get_instance().XI(17)}onMove(){const b={};b.MoveButtonClickedTime=new Date;t.AFrameworkApplication.ya.Xb(ab.a.CFb,2,b)}mGl(b){switch(b){case 1:return CommonUIStrings.l_CalloutRenameReadOnlyError;case 2:return CommonUIStrings.l_CalloutRenamePermissionError;case 3:case 4:return CommonUIStrings.l_CalloutRenameCoauthError;case 5:return null;default:return CommonUIStrings.l_CalloutRenameGenericError}}eql(){let b=
null,h=null;var r=Sa.a.instance.Pa("Common.IRenameProps");r?(r=r.SXh(),0!==r&&(b=this.mGl(r),h=GE[r])):v.ULS.sendTraceTag(572375621,340,15,"IRenameProps not yet initialized");return Object.assign(new $H,{breadcrumbBrandName:t.AFrameworkApplication.zt.breadcrumbBrandName,breadcrumbBrandUrl:t.AFrameworkApplication.zt.breadcrumbBrandUrl,breadcrumbFolderName:t.AFrameworkApplication.zt.breadcrumbFolderName,breadcrumbFolderUrl:t.AFrameworkApplication.zt.breadcrumbFolderUrl,hideDocumentTitleInput:t.AFrameworkApplication.ua.Sb.YXl,
isVersionHistoryEnabled:this.cVn(),documentExtension:B.a.rLa(t.AFrameworkApplication.fileName),isMoveEnabled:32===t.AFrameworkApplication.ya.processAction(ab.a.CFb,1),onMove:Object(u.a)(this,this.onMove,"onMove"),message:b,renameDisableReason:h,openBreadcrumbsInNewTab:t.AFrameworkApplication.K.$("OpenLinksInNewWindow")})}QPh(){if(!this.documentTitleAppProps){const b=t.AFrameworkApplication.zt.Bz;this.documentTitleAppProps=Object.assign(new ZH,{documentTitle:t.AFrameworkApplication.vEc?b:B.a.qI(b),
onFirstRender:Object(u.a)(this,this.FRm,"onDocumentTitleFirstRender"),getCalloutAppProps:Object(u.a)(this,this.eql,"getDocumentFlyoutProperties"),isShared:!1})}return this.documentTitleAppProps}cVn(){return!!t.AFrameworkApplication.ua&&t.AFrameworkApplication.ua.Sb.khi}TSn(){return!!t.AFrameworkApplication.ua&&t.AFrameworkApplication.ua.Sb.jhi}LUn(){const b=!QD.b()&&!t.AFrameworkApplication.hideHeader&&!t.AFrameworkApplication.jlf&&(t.AFrameworkApplication.K.$("SkypeWebControlIsEnabled")||t.AFrameworkApplication.K.$("TeamsChatIsEnabled"));
v.ULS.sendTraceTag(592315859,215,50,"ShowChat is {0}",b);return b}UEk(b){appChrome.getHeaderApi().then(h=>{h.setNavBarData(b.result);return null});v.ULS.sendTraceTag(50602782,215,50,"SetHeaderNavBarData has been dispatched.")}ekn(b=!1){appChrome.getHeaderApi().then(h=>{const r=Sa.a.instance.resolve("Common.App.Header.IReactSharedHeaderFocusManager");h.setHeaderCommandHandler("OnFirstRender",()=>{this.onFirstRender()});h.setHeaderCommandHandler("OnFullyLoaded",()=>{this.onFullyLoaded()});h.setHeaderCommandHandler("OnFlexPaneOpen",
z=>{r.onFlexPaneOpen(z)});h.setHeaderCommandHandler("OnFlexPaneClose",z=>{r.onFlexPaneClose(z)});h.setHeaderCommandHandler("SetCookie",z=>Ga.a.set(z.cookieName,z.value));h.setHeaderCommandHandler("GetCookie",z=>this.Hnl(z));h.setHeaderCommandHandler("QueryWorkflowButtonSettings",Object(u.a)(this,this.rjf,"getWorkflowButtonAppProps"));b||(h.setHeaderCommandHandler("QueryDocumentTitleAppProps",Object(u.a)(this,this.QPh,"getDocumentTitleAppProps")),h.setHeaderCommandHandler("OnDocumentTitleReducerReady",
()=>{this.GRm();return null}));FE.a.fQd()&&h.setHeaderCommandHandler("QuerySearchInitializationSettings",Object(u.a)(this,this.AYh,"getSearchInitializationSettings"))})}GRm(){Sa.a.instance.Za("Common.App.SaveStatus.ISaveStatusUIHandler").execute(b=>{b.pmb(!1,t.AFrameworkApplication.ya.mode)})}Hnl(b){b=Ga.a.get(b);void 0!==b&&null!==b&&0<b.length&&(b=decodeURIComponent(b));return b}IKl(){return FC.AppChromeOverrideUtilities.isEnabled?FC.AppChromeOverrideUtilities.tHd("suiteux-shell",!1):this.kWj+t.AFrameworkApplication.Dga+
"suiteux-shell"}onFirstRender(){Sa.a.instance.Za("Common.App.O365Shell.IO365ShellActor").execute(b=>{b.PRn.continueWith(Object(u.a)(this,this.UEk,"continueShellServiceDataAsync"),3)});Si.a.get_instance().XI(15)}onFullyLoaded(){Si.a.get_instance().XI(16)}bta(b=!1){a:{try{var h=Sj.a.pg(t.AFrameworkApplication.lcid);if(h){var r=Object.assign(new IF,{cultureName:h.name,t8b:h.t8b});break a}}catch(z){v.ULS.sendTraceTag(592318981,340,15,"Header language cannot be determined, LCID:"+t.AFrameworkApplication.lcid.toString())}r=
Object.assign(new IF,{cultureName:"en-us",t8b:"en"})}h=Sa.a.instance.resolve("Common.App.Header.IReactSharedHeaderFocusManager");r=Object.assign(new aI,{appName:CommonUIStrings.l_AppNameShort,culture:r.cultureName,language:r.t8b,isConsumer:!t.AFrameworkApplication.C9f,showAppLauncher:QD.g(),showMeControl:QD.f(),hideUserName:t.AFrameworkApplication.kLd,defaultDocumentTitleToLeft:t.AFrameworkApplication.qxh,assetsContainerOverride:this.IKl(),controls:this.Fnl(),documentTitleAppProps:b?null:this.QPh(),
showDocumentTitleControl:!b,showWorkflowButton:!!this.rjf(),showChatControl:this.LUn(),showGoPremiumControl:QD.h(),enableSearchControl:FE.a.Tjm(),onFlexPaneOpen:Object(u.a)(h,h.onFlexPaneOpen,"onFlexPaneOpen"),onFlexPaneClose:Object(u.a)(h,h.onFlexPaneClose,"onFlexPaneClose"),enableTheming:this.TSn(),testTraffic:t.AFrameworkApplication.K.$("SharedHeaderTestTrafficIsEnabled"),onFirstRender:Object(u.a)(this,this.onFirstRender,"onFirstRender"),onFullyLoaded:Object(u.a)(this,this.onFullyLoaded,"onFullyLoaded"),
enableUpdatedRUMReporting:t.AFrameworkApplication.USn()});!t.AFrameworkApplication.Ihc||t.AFrameworkApplication.m1f?(r.userDisplayName=t.AFrameworkApplication.userName,r.emailAddress=t.AFrameworkApplication.K.lb("UserPrincipalName"),r.userID=t.AFrameworkApplication.K.lb("Puid")||"",r.signOutLink=t.AFrameworkApplication.m1f):t.AFrameworkApplication.signInUrl&&(r.signInLink=t.AFrameworkApplication.signInUrl);FE.a.fQd()&&(h=this.AYh(),r.loadTellMeResources=h.loadTellMeResources,r.getTokenRequestDictionary=
h.getTokenRequestDictionary,r.enableVanillaSearchBox=t.AFrameworkApplication.K.$("VanillaSearchUxInHeaderIsEnabled"),r.userRing=h.userRing);HF.Wam()&&(h=new HF,r.shellAuthProviderConfigPromise=Object(u.a)(h,h.xgl,"getAccountSwitchingConfig"));this.ekn(b);return r}AYh(){if(!this.hWf){const b=new FE.a;let h=t.AFrameworkApplication.K.lb("Microsoft365Ring");h&&h.length||(h="generalAudience");this.hWf=Object.assign(new YH,{loadTellMeResources:b.ktm(),getTokenRequestDictionary:Object(u.a)(b,b.GMl,"getTokenRequestDict"),
userRing:h})}return this.hWf}}Object(n.a)(dI,"ReactSharedHeaderPropsHelper",null,[1060]);class JF{constructor(){this.label=this.value=null}}Object(n.a)(JF,"TextInfoSectionField",null,[]);var RD=d(742),PL=d(1036);class KF{constructor(){this.commandId=0;this.externalUxCommand=null}}Object(n.a)(KF,"CommandDefinition",null,[]);class eI{constructor(){this.addTabToMap=this.addIconToMap=this.addCommandToMaps=this.getDoNothingCommand=this.getCommandByExternalUxId=null}}Object(n.a)(eI,"CommandDefinitionMapping",
null,[]);const QL=b=>Object.assign(new eI,{getCommandByExternalUxId:h=>{const r=b.getCommandByExternalUxId(h);return r?Object.assign(new KF,{commandId:parseInt(r.commandId),externalUxCommand:r.externalUxCommand}):Object.assign(new KF,{externalUxCommand:h})},getDoNothingCommand:()=>parseInt(ab.a.Ag),addCommandToMaps:Object(u.a)(b,b.addCommandToMaps,"addCommandToMaps"),addIconToMap:Object(u.a)(b,b.addIconToMap,"addIconToMap"),addTabToMap:Object(u.a)(b,b.addTabToMap,"addTabToMap")});var RL=d(1370);class fI{}
Object(n.a)(fI,"RibbonInitState",null,[]);var gI=d(448),SL=d(1322);class hI{constructor(){}flatten(b){const h=[];for(const r of b)h.push.apply(h,r);return h}}Object(n.a)(hI,"ReactAsyncDispatcher",null,[]);var TL=d(1619);class iI{constructor(b,h){this.EVj=b;this.dzj=h}}Object(n.a)(iI,"ReactExecuteCommandContext",null,[]);class cw{}cw.Trigger="FontTrigger";cw.Name="FontName";cw.Action="FontAction";cw.Level="FontLevel";cw.IsPinned="FontIsPinned";Object(n.a)(cw,"FontPickerLogProperties",null,[]);class jI{constructor(b,
h,r,z,R,ba,ta,Wa,ub,Ib=null,$b=null){this.HY=null;this.b0g=!1;this.Hoe=[];this.e9c=-1;this.Knd=!1;this.TWj=0;this.Rkc=null;this.GWg=!1;this.Lca=b;this.o9a=h;this.aZg=Object(la.a)(853,b);this.Im=r;this.Wb=z;R&&(this.HY=new TL.a(R,z));this.cTj=ba;this.nDj=ta;this.Pt=Ib;this.ga=Wa;this.Rqb={};this.Oa=ub;this.jgg=$b;ub&&(ub.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnqueueTasksWhenTaskMgrIsYielding",!1)||ub.$("EnqueueTasksWhenTaskMgrIsYielding"))&&sd.a.instance.Lyc.CWR(()=>this.b0g=!0);ub&&
(b=this.Oa.lb("CommandControlIdPairsForLoggingOverride")||"")&&0<=b.trim().length&&({Fv:this.Rkc}=y.d(b));this.Rkc||(this.Rkc={})}get GWi(){return!!window.appChrome&&!!appChrome.selectors}fVi(){-1!==this.e9c&&window.clearTimeout(this.e9c);this.e9c=window.setTimeout(()=>{for(this.e9c=-1;0<this.Hoe.length;){if(Oe.a.instance.Mv){this.fVi();break}const b=this.Hoe.shift();b&&this.executeCommand(b.EVj,b.dzj)}},0)}executeCommand(b,h){if(Oe.a.instance.Mv){if(this.b0g){this.Hoe.push(new iI(b,h));this.fVi();
return}v.ULS.sendTraceTag(561394496,207,15,"React.ExecuteCommandHandler.ExecuteCommand: TaskManager.Instance.IsYielding, simplifiedUxCommand: {0}, commandHandlerData.ModelType: {1}, commandHandlerData.ModelType.Payload: {2}",b,h.modelType,Na.a.toJSON(h.payload));if(this.Oa.$("WordEditorReactExecuteYieldReturnIsEnabled"))return}if(h){const r=this.Im.getCommandByExternalUxId(b),z=h.modelType;this.jgg&&this.jgg.nwm(b,h);r?this.O4k(b,r,z,h):this.P4k(b,z,h);this.Ntk(h);this.aEm(b,h)}}P4k(b,h,r){switch(h){case "GalleryModel":case "PreviewGalleryModel":this.vFh(r,
b)}}Rko(b,h,r,z,R){if(r.payload)switch(r.payload.type){case "CoauthorMenuPayload":b.MenuItemId=r.payload.coauthorId;break;case "ButtonPayload":b.MenuItemId=h.menuItemId;b.CommandValueId=r.payload.commandValueId;this.zda();break;case "ButtonPreviewPayload":b.MenuItemId=h.menuItemId;b.CommandValueId=r.payload.commandValueId;R=h.commandPreviewId;break;case "ButtonRevertPreviewPayload":b.MenuItemId=h.menuItemId;b.CommandValueId=r.payload.commandValueId;R=h.commandRevertId;break;default:b.MenuItemId=h.menuItemId}else b.MenuItemId=
h.menuItemId;b.SourceControlId=z;return R}Sko(b,h,r){if(h.payload)switch(h.payload.type){case "MenuOpenPayload":b=this.Im.getCommandByExternalUxId("TellMeLogMenuOpen").commandId;break;case "MenuClosePayload":b=this.Im.getCommandByExternalUxId("TellMeLogMenuClose").commandId;break;case "TellMeMenuItemExecuted":r.CommandId=h.payload.executedControl;r.ControlId=h.payload.executedControl;r.ParentControlId=h.payload.parentControl;r.CloseAllMenus=!0;this.zda();break;case "TellMeSearchResultChangePayload":r.Value=
h.payload.searchText;break;case "SmartLookupPayload":r.CommandValueId=h.payload.selectionContextJson}return b}O4k(b,h,r,z){var R=this.K5m(z,r),ba=h.commandId;const ta={},Wa={};switch(r){case "SplitButtonModel":if(this.CKc(z.payload,Object(u.a)(this,this.Slo,"updateSplitButtonMenuState"),R))return;ta.MenuItemId=h.menuItemId;this.nZf(z,ta);break;case "StatefulSplitButtonModel":if(this.CKc(z.payload,Object(u.a)(this,this.amo,"updateStatefulSplitButtonMenuState"),R))return;r=z.payload.statefulData;R=
z.payload.statefulMode;"color"===R?ta.Color=r:"icon"===R&&(r=this.Im.getCommandByExternalUxId(r))&&(ta.MenuItemId=r.menuItemId);break;case "FileMenu":ta.MenuItemId=h.menuItemId;ta.SourceControlId=b;z.payload&&"FileMenuPageSwitchPayload"===z.payload.type&&this.$Sl(ba,z.payload,b);break;case "TellMe":ba=this.Sko(ba,z,ta);ta.SourceControlId=b;ta.Location=z.payload.location;break;case "ButtonModel":z.payload&&"TabSwitchPayload"===z.payload.type?this.NUl(ta,z):ba=this.Rko(ta,h,z,b,ba);break;case "CompoundButtonModel":ta.MenuItemId=
h.menuItemId;ta.CommandValueId=z.payload.commandValueId;ta.SourceControlId=b;this.nZf(z,ta);this.zda();break;case "ToggleButtonModel":case "InkButtonModel":ta.MenuItemId=h.menuItemId;ta.SourceControlId=b;this.nZf(z,ta);this.zda();break;case "FontPickerModel":switch(z.payload.type){case "MenuOpenPayload":return;case "MenuClosePayload":ba=this.Im.getCommandByExternalUxId("FontPickerMenuClose").commandId;ta[AC.a.FontPickerId]=z.payload.launcherId;break;case "FontPickerFontSelectedPayload":r=z.payload.font;
R=null;"string"===typeof r?(R=So.FontUtils.LNa(r),ta.CommandValueId=R,R=So.FontUtils.Lxd(R)):(r.data?(ta.CommandValueId=r.data.fontToApply,ta.MenuItemId=r.data.themeIndex,ta[AC.a.Formatting]=r.data):ta.CommandValueId=r.name,R=r);ta.SourceControlId=b;ta[AC.a.RequestUpdateMru]=R;Wa[cw.Name]=z.payload.nameToLog?z.payload.nameToLog:"string"===typeof r?So.FontUtils.TNd(r)?"*"+r:So.FontUtils.rqf(r)?"[EF]":"[MF]":"";Wa[cw.IsPinned]=z.payload.isPinned;Wa[cw.Level]=z.payload.level;this.zxf();break;case "FontPickerFontInfoRequestedPayload":ta.CommandValueId=
z.payload.font.name;ta[AC.a.Trigger]=z.payload.trigger;Wa[cw.Trigger]=z.payload.trigger;Wa[cw.Name]=z.payload.nameToLog;this.zxf();break;case "FontPickerFontPinningPayload":r=z.payload.isPinned;ta.CommandValueId=z.payload.fontKey;ta[AC.a.IsPinned]=r;Wa[cw.Name]=z.payload.nameToLog;Wa[cw.Action]=r?"pin":"unpin";Wa[cw.Level]=z.payload.level;this.zxf();break;default:return}break;case "ComboBoxModel":var ub=z.payload.type;switch(ub){case "MenuOpenPayload":case "MenuPopulatePayload":this.zec(z.payload.launcherId,
R)&&(ba={},ba[z.payload.launcherId]=r,this.o9a.cVc(ba,yh.g(z.payload)),this.Rqb[b]=new Date);return;case "MenuClosePayload":return;case "ComboBoxPayload":case "ComboBoxPreviewPayload":r=z.payload.newValue;if(!r)return;r.value?(ta[Pk.a.Value]=r.value,ta[Pk.a.IsFreeForm]=!0):(ta[Pk.a.Value]=r.text,ta.MenuItemId=r.key,ta.CommandValueId=r.commandValueId);"ComboBoxPreviewPayload"===ub&&(ba=h.commandPreviewId);break;case "ComboBoxRevertPreviewPayload":ba=h.commandRevertId;break;default:return}break;case "FlyoutAnchorModel":switch(z.payload.type){case "ZeroTermContextMenuClosePayload":r=
Na.a.UN(z.payload);for(ub of r)ta[ub]=z.payload[ub];break;default:this.CKc(z.payload,Object(u.a)(this,this.wio,"updateFlyoutAnchorMenuState"),R),ta.launcherId=z.payload.launcherId}break;case "InkFlyoutAnchorModel":this.CKc(z.payload,Object(u.a)(this,this.ujo,"updateInkFlyoutAnchorMenuState"),R);ta.launcherId=z.payload.launcherId;break;case "ColorPickerModel":switch(z.payload.type){case "ColorPickerPayload":ta[Gl.Color]=z.payload.selectedColorId;break;case "ColorPickerPreviewPayload":ba=h.commandPreviewId;
ta[Gl.Color]=z.payload.selectedColorId;break;case "ColorPickerRevertPreviewPayload":ba=h.commandRevertId;break;default:return}break;case "SpinButtonModel":ta[Cc.a.Number]=z.payload.value;ta[Cc.a.UnitType]=pg.a.fxb(z.payload.unitType.toLowerCase());ta[Cc.a.Text]=z.payload.reservedValue;break;case "SliderModel":ta[bc.Value]=z.payload.value;break;case "InsertTableModel":ta[kb.a.Rows]=z.payload.rows;ta[kb.a.Columns]=z.payload.columns;break;case "CheckboxModel":ta[Yf.a.On]=z.payload.checked;ta.MenuItemId=
h.menuItemId;break;case "PreviewGalleryModel":if(this.CKc(z.payload,Object(u.a)(this,this.blo,"updatePreviewGalleryMenuState"),R)){ta.launcherId=z.payload.launcherId;break}this.vFh(z,b);return;case "DocumentTitleModel":switch(z.payload.type){case "DocumentTitleRenamePayload":ta.getNewDocumentTitle=z.payload.getNewDocumentTitle;break;case "MenuOpenPayload":ba={};ba[z.payload.launcherId]=r;this.o9a.cVc(ba,yh.g(z.payload));this.Rqb[b]=new Date;return;case "MenuClosePayload":return;default:return}break;
case "MRUCompoundButtonModel":ta.MenuItemId=z.payload.url;this.jxm(z.payload.pageId);break;case "NewBlankDocumentModel":case "CustomTemplateModel":ta.MenuItemId=z.payload.assetId;ta.SourceControlId=b;this.kxm(z.payload.pageId);break;case "CoauthorGallery":ta.RenderTime=z.triggerTime;break;case "PeopleWell":ta.RenderTime=z.triggerTime;break;case "SyncStatus":ta.SourceControlId=b;break;case "InputBoxModel":ta.Text=z.payload.newValue;break;case "PersonaButtonModel":ta.CommandValueId=z.payload.commandValueId;
this.ZTl(z.payload);break;default:return}ba&&!this.isShadowMenuOpen(z.payload)&&(ta.CommandValueId||(ta.CommandValueId=ta.MenuItemId),h.legacyControlId&&(ta.LegacyId=h.legacyControlId),ta.SourceControlId||(ta.SqmControlId=b),this.Oa&&this.Oa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ExtendedPRIIsEnabled",!1)&&ta.launcherId&&(h=this.Im.getCommandByExternalUxId(ta.launcherId))&&(ta.launcherCommandId=parseInt(h.commandId)),z.payload&&!qf.c(z.payload.PRIReadinessCheck)&&(ta.PRIReadinessCheck=
z.payload.PRIReadinessCheck,this.GWg=!0),z.payload&&!qf.c(z.payload.shouldTakeFocus)&&(ta[ez.a.T2a]=z.payload.shouldTakeFocus),h=this.n8g(z,ta),qf.c(z.triggerTime)||(Wa.TriggerTime=z.triggerTime),z.payload&&!qf.c(z.payload.userActionKey)&&(Wa.userActionKey=z.payload.userActionKey),this.vYi(Wa,z,b,ba),this.aZg.executeCommand(ba,ta,this.getSelectedTabId(),h,!0,()=>{this.csi(ta,b)},Wa,yh.g(z.payload)))}vYi(b,h,r,z){this.Oa&&this.Oa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableControlIdLoggingInUserActions",
!1)&&r&&z&&(b.ControlId=this.VAl(r,z));this.Oa&&this.Oa.$("TerminalParentControlIdLoggingInUserActionsIsEnabled")&&h.payload&&"terminalParentControlId"in h.payload&&(b.TerminalParentControlId=h.payload.terminalParentControlId)}VAl(b,h){h=parseInt(h);h=$c.ActionManager.TXe(h)||$c.ActionManager.ada(h)||"";return!qf.c(h)&&h in this.Rkc?this.Rkc[h]:100<b.length?"":b}zxf(){this.Pt&&this.Pt.execute(b=>{b.lxf("ModernFontPickerExperience")})}n8g(b,h){let r=2;b.payload&&"inputMethod"in b.payload&&b.payload.inputMethod&&
(r=b.payload.inputMethod,h[ez.a.Ww]=r);return r}csi(b,h){const r=Object(la.a)(ke.AFrame,t.AFrameworkApplication.ua);if(this.Wb&&this.f3i(b)){if(!this.Wb.og&&r){let z="null";if(b){const R=b.Value;delete b.Value;z=Na.a.toJSON(b);qf.c(R)||(b.Value=R)}v.ULS.sendTraceTag(561394506,207,50,"Excel React unexpectly calling the callback with, simplifiedUxCommand: {0}, commandHandlerData.ModelType.Payload: {1}, focus scope name: {2}",h,z,r.l2a)}this.Wb.nJh()}(this.Wb&&this.Wb.og&&this.Wb.og.name!==ke.AFrame.yna&&
r&&this.Wb.og.name!==r.l2a||this.f3i(b))&&this.$yk(b)}f3i(b){return!!b&&!qf.c(b[ez.a.T2a])&&b[ez.a.T2a]}$yk(b){ez.a.Ww in b&&1===b[ez.a.Ww]&&RD.ShyRibbon.Lab(1,0)}NUl(b,h){this.Lca.yl();if(this.cTj&&this.ga){const r={};r[PH.a.R3f]=h.payload.tabId;this.ga.Xb(ab.a.yYc,2,r,this.Jea(h));qf.c(h.payload.inputMethod)||(this.ga.processAction(ab.a.TQi,2),this.Knd||this.RYn(h.payload.tabId))}h=h.payload.tabId;b.NewContextId=h;b.NewContextCommand=this.Im.hif(h);v.ULS.sendTraceTag(561394507,340,50,"HandleTabSwitch tabId: "+
h);if(this.Pt&&h){const r=h+"TabSwitchActivity";this.Pt.execute(z=>{z.lxf(r)})}}CKc(b,h,r){const z=b.type;return"MenuClosePayload"===z?!0:"MenuOpenPayload"===z?(h(b,r),!0):!1}ZTl(b){b=b.type;"MenuOpenPayload"===b?t.AFrameworkApplication.Kfc=!0:"MenuClosePayload"===b&&(t.AFrameworkApplication.Kfc=!1)}K5m(b,h){if(!b.payload||!b.payload.launcherId||"MenuOpenPayload"!==b.payload.type&&"MenuPopulatePayload"!==b.payload.type)return!1;const r=b.payload.launcherId,z=this.Im.getCommandByExternalUxId(r);return z&&
z.populationProps?((b=this.o9a.QLf(z,h,b.payload))&&r in this.Rqb&&delete this.Rqb[r],b):!1}wio(b,h){const r=b.launcherId;this.zec(r,h)&&(h=appChrome.selectors.getFlyoutAnchorMenuItems(r),this.rhc(h,r,yh.g(b)))}ujo(b,h){const r=b.launcherId;this.zec(r,h)&&(h=yh.i("getInkFlyoutAnchorMenuItems")?appChrome.selectors.getInkFlyoutAnchorMenuItems(r):appChrome.selectors.getFlyoutAnchorMenuItems(r),this.rhc(h,r,yh.g(b)))}blo(b,h){const r=b.launcherId;this.zec(r,h)&&(h=appChrome.selectors.getPreviewGalleryMenuItems(r),
this.rhc(h,r,yh.g(b)))}Slo(b,h){const r=b.launcherId;this.zec(r,h)&&(h=appChrome.selectors.getSplitButtonMenuItems(r),this.rhc(h,r,yh.g(b)))}amo(b,h){const r=b.launcherId;this.zec(r,h)&&(h=appChrome.selectors.getStatefulSplitButtonMenuItems(r),this.rhc(h,r,yh.g(b)))}getSelectedTabId(){return this.GWi?appChrome.selectors.getSelectedTabId():null}rhc(b,h,r){this.o9a.cVc(b,r);this.Rqb[h]=new Date}zec(b,h){let r=!0;b in this.Rqb&&(r=this.Rqb[b].getTime()<this.Lca.wma.getTime());return r&&!h&&this.GWi}vFh(b,
h){const r={};var z=b.payload.selectedGalleryId;const R=this.Im.getCommandByExternalUxId(z);if(R){r.SourceControlId=z;r.MenuItemId=R.menuItemId;r.SqmControlId=h;R.legacyControlId&&(r.LegacyId=R.legacyControlId);b.payload&&!qf.c(b.payload.shouldTakeFocus)&&(r[ez.a.T2a]=b.payload.shouldTakeFocus);this.tDl(b.payload,r);(z=this.Jea(b))||(z={});this.vYi(z,b,h,R.commandId);const ba=this.n8g(b,r);this.aZg.executeCommand(R.commandId,r,this.getSelectedTabId(),ba,!0,()=>{this.csi(r,h)},z,yh.g(b.payload))}}tDl(b,
h){"CharacterGalleryPayload"===b.type&&(h.MenuItemId=b.character)}nZf(b,h){b.payload&&"toggled"in b.payload&&(h[Yf.a.On]=b.payload.toggled)}aEm(b,h){if("MenuOpen"===b){if(this.HY&&!("isShadowRendering"in h.payload&&h.payload.isShadowRendering))this.HY.onMenuOpen()}else if("MenuClose"===b&&this.HY)this.HY.onMenuClose()}zda(){this.HY&&this.HY.PFf()}Jea(b){let h=null;qf.c(b.triggerTime)||(h={},h.TriggerTime=b.triggerTime);return h}$Sl(b,h,r){if(this.nDj&&this.ga){const z={};z[NH.a.IZd]=r;this.ga.Xb(ab.a.xYc,
2,z)}this.rhc(h.pageControlIdMap,b,yh.g(h))}kxm(b){if(this.ga)switch(b){case "FileHomePage":this.ga.processAction(ab.a.YQi,2);break;case "FileNewPage":this.ga.processAction(ab.a.ZQi,2)}}jxm(b){if(this.ga)switch(b){case "FileHomePage":this.ga.processAction(ab.a.AQi,2);break;case "FileOpenPage":this.ga.processAction(ab.a.BQi,2)}}isShadowMenuOpen(b){return!!b&&"MenuOpenPayload"===b.type&&b.isShadowRendering}RYn(b){if(t.AFrameworkApplication.K.$("TellMeHelpCoachMarkActivityEnabled")&&"Help"===b)this.Pt.execute(h=>
{h.logActivity("TellMeHelpCoachMarkActivity",null)}),this.Knd=!0;else{if(t.AFrameworkApplication.K.$("TellMe3TabSwitchCoachMarkActivityEnabled")&&(this.Pt.execute(h=>{h.logActivity("TellMe3TabSwitchCoachMarkActivity",null)}),3===++this.TWj)){this.Knd=!0;return}t.AFrameworkApplication.K.$("TellMe1TabSwitchCoachMarkActivityEnabled")&&32===this.ga.processAction(ab.a.CKb,2)&&(this.Knd=!0)}}Ntk(b){b&&b.payload&&b.payload.PRIReadinessCheck&&!this.GWg&&appChrome.PRIToastManager.dismissToast()}}Object(n.a)(jI,
"ReactExecuteCommandHandler",null,[]);class kI{constructor(){this.fileMenu=null}get qmb(){return 0}get o0a(){return 0}get QCa(){return!1}vva(){}kbj(){}oZ(){return!1}YYi(){}T1(){return!1}mFa(b){return this.fileMenu&&this.fileMenu.FOa(b)?!0:!1}get Zga(){return!1}gkb(){}eOd(){return!1}get Hwd(){return null}set Hwd(b){}pda(){}Y9(){}cjf(){return null}FKa(){}refresh(){}get controls(){return null}Wbc(){return!1}abb(){}yl(){}get vE(){return null}set vE(b){}z3c(){}get inKeytipMode(){return!1}enterKeytipMode(){}exitKeytipMode(){}}
Object(n.a)(kI,"ReactRibbonExternal",null,[704,650,705]);class lI{constructor(b,h,r,z){this.Wb=b;this.ga=h;this.v5g=r;this.gUb=z}initialize(){this.ga.pa(ab.a.V4d,Yd.a.frame,Object(u.a)(this,this.aTi,"ribbonMoveForwardAction"));this.ga.pa(ab.a.U4d,Yd.a.frame,Object(u.a)(this,this.$Si,"ribbonMoveBackwardAction"));this.ga.pa(ab.a.T4d,Yd.a.frame,Object(u.a)(this,this.XSi,"ribbonEscAction"));var b=kr.a.qnf(this.gUb,null,this.v5g,!1);b.UL=!0;this.Ubc(b,ab.a.V4d,ab.a.U4d);b.bindAction(rc.KeyInputManager.lc(wb.a.u4a,
0),ab.a.T4d);b=this.Wb.re(ke.AFrame.yna);b.UL=!0;this.Ubc(b,ab.a.kXa,ab.a.kXa);gf.a.instance.mb(jb.a.$w,this.v5g,Object(u.a)(this,this.CWm,"onRibbonMouseDown"));b=mn.a.instance;yh.a("enterKeytipMode")&&b.IMn(this.gUb,()=>{appChrome.api.enterKeytipMode(!1)});yh.a("exitKeytipMode")&&b.EMn(this.gUb,()=>{appChrome.api.exitKeytipMode();RD.ShyRibbon.Lab(1,0)});t.AFrameworkApplication.ua&&t.AFrameworkApplication.ua.Sb.nma&&(b=Object(la.a)(ve.FocusManager,this.Wb))&&b.B7j(Object(u.a)(this,this.pSm,"onFocusScopeChanged"))}pSm(b,
h){if((b=Object(la.a)(ke.AFrame,t.AFrameworkApplication.ua))&&h.Hti&&t.AFrameworkApplication.ua&&t.AFrameworkApplication.ua.Sb.nma){const r=appChrome.selectors.getShyState();r.isActive&&h.Hti.name===b.l2a&&RD.ShyRibbon.Lab(r.state,1)}}aTi(){return 4}$Si(){return 4}XSi(){yh.a("inKeytipMode")&&!appChrome.api.inKeytipMode()&&(t.AFrameworkApplication.ua&&t.AFrameworkApplication.ua.Sb.nma&&appChrome.selectors.getShyState().isActive&&RD.ShyRibbon.Lab(1,0),this.Wb.Jg(ke.AFrame.Zp));return 4}Ubc(b,h,r){const z=
rc.KeyInputManager.lc(wb.a.mx,0),R=rc.KeyInputManager.lc(wb.a.mx,4);b.Dr(z);b.Dr(R);b.bindAction(z,h);b.bindAction(R,r)}CWm(b){b.Ib&&b.Ib.target&&"input"!==b.Ib.target.tagName.toLowerCase()&&b.Ib.preventDefault();return!1}dispose(){this.ga.Yy(ab.a.V4d,Yd.a.frame,Object(u.a)(this,this.aTi,"ribbonMoveForwardAction"));this.ga.Yy(ab.a.U4d,Yd.a.frame,Object(u.a)(this,this.$Si,"ribbonMoveBackwardAction"));this.ga.Yy(ab.a.T4d,Yd.a.frame,Object(u.a)(this,this.XSi,"ribbonEscAction"))}}Object(n.a)(lI,"ReactRibbonFocusManager",
null,[9]);class iz{constructor(b,h,r,z,R,ba,ta,Wa=null,ub=!0,Ib=null,$b=null){this.X6a=this.Kod=this.Hke=this.Lca=null;this.D_g=[];this.Akd=null;this.wIa=b;this.lze=h;this.gUb=r;this.Wb=z;this.ga=R;this.Im=ba;this.Lca=Ib?Ib:new pE(kt.instance,this.Im);this.gqc=ta;this.RYg=new kI;this.xIa=Wa;this.hHe=ub;new hI;this.lEg=$b;Si.a.get_instance().tl(7,Object(u.a)(this,this.YNn,"setRibbonPostInteractiveReady"));Si.a.get_instance().tl(7,Object(u.a)(this,this.VAm,"logRibbonLoadedActivity"));Si.a.get_instance().tl(19,
Object(u.a)(this,this.Svm,"logAppLoadedActivity"));t.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.GeneralizedRibbonTTVRReporting",!1)&&Si.a.get_instance().tl(7,Object(u.a)(this,this.snn,"registerSubComponentReporting"));Si.a.get_instance().tl(7,Object(u.a)(this,this.tdn,"queueSettingsDependentActions"))}initialize(b,h,r=null){this.hHe||this.XI(5);r?r.then(()=>{this.KPi()}).catch(()=>v.ULS.sendTraceTag(561394319,340,10,"Failed to load the resources for the Ribbon")):
gI.a.j2c(gI.a.j2c(ee.Task.WAA(this.Ili(b),this.Hli(iz.vzj)),()=>this.Hli(iz.Ovj)),()=>this.Ili(h)).continueWith(()=>{this.KPi()},11)}dispose(){this.$do();this.X6a&&this.X6a.yAh();this.Akd&&this.Akd.dispose();for(const b of this.D_g)Si.a.get_instance().Zvk(b);t.AFrameworkApplication.ya.Yy(ab.a.ivn,Yd.a.frame,$c.ActionManager.Nf)}Hli(b){return Sa.a.instance.resolve("Common.ISharedDependencyLoader").V8b(t.AFrameworkApplication.Aw(b,2))}Ili(b){return""===b?ee.Task.e$(!0):Sa.a.instance.resolve("Common.ISharedDependencyLoader").V8b(t.AFrameworkApplication.Aw(b,
3))}Z3l(){(this.xIa||this.gqc)&&appChrome.api.dispatch(this.A0h());this.QPn();yh.a("setWebpackPublicPath")&&appChrome.api.setWebpackPublicPath(t.AFrameworkApplication.C3);this.Lca.yl()}KPi(){this.Z3l();this.hHe&&(appChrome.renderAppChrome(this.wIa,yh.e()),this.XI(10));this.x7g();this.pUe();this.hHe&&this.XI(5);this.a8h()}a8h(){this.Wb&&this.ga&&this.gUb&&(this.Akd=new lI(this.Wb,this.ga,this.wIa,this.gUb),this.Akd.initialize())}get XYc(){return this.RYg}setCommandDefinitionMapping(){if(yh.a("setCommandDefinitionMapping")){const b=
QL(this.Im);appChrome.api.setCommandDefinitionMapping(b)}}registerOnShyRibbonStateChange(){t.AFrameworkApplication.ua&&t.AFrameworkApplication.ua.Sb.nma&&yh.a("registerOnShyRibbonStateChange")&&appChrome.api.registerOnShyRibbonStateChange((b,h)=>{0===h&&this.bbc()})}x7g(){this.setCommandDefinitionMapping();this.registerOnShyRibbonStateChange();const b=Object(la.a)(pE,this.Lca);this.Hke=new jI(this.Lca,b.Tbc,this.Im,this.Wb,this.lze,Sa.a.instance.Pa("Common.IRibbonSQMInformation"),Sa.a.instance.Pa("Common.IFileMenuSQMInformation"),
t.AFrameworkApplication.ya,t.AFrameworkApplication.K,Sa.a.instance.Za("Common.ISystemInitiatedFeedback"),null);this.hik();this.$Rl()}hik(){this.Kod=appChrome.api.bindCommandHandler((b,h)=>{this.Hke.executeCommand(b,h)})}$do(){this.Kod&&(this.Kod(),this.Kod=null)}QPn(){appChrome.api.initializeLogger(new an.a)}jBa(){return this.Lca?this.Lca.jBa():[]}bbc(){Cp.a.instance.Pd(()=>{let b=null;Cp.a.instance.Pd(()=>{b=this.jBa()},"RB:GA");b&&0<b.length&&(this.Lca.wma=new Date,Cp.a.instance.Pd(()=>{appChrome.api.dispatch(b)},
"RB:DA"));this.X6a&&Cp.a.instance.Pd(()=>{this.X6a.fFi()},"RB:J")},"RB:PFSU")}K3c(){this.Lca.K3c()}fGb(){}w0j(b){b=[appChrome.actions.activateDeactivateContextualTab(b,!0),appChrome.actions.setCurrentTab(b)];appChrome.api.dispatch(b)}setCurrentTab(b){b=[appChrome.actions.setCurrentTab(b)];appChrome.api.dispatch(b)}A0h(){var b=t.AFrameworkApplication.K;const h=[];b.$("EnableTellMeForOneLineRibbonIsEnabled")?b.$("OcpsIsEnabled")&&Sa.a.instance.Za("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(r=>
{r.isFeatureEnabled("ConnectedServices",!0).then(z=>{z&&appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("TellMeControl",!1));return null})}):h.push(appChrome.actions.updateControlHiddenState("TellMeControl",!0));h.push.apply(h,this.BQh());b=new RL.a(this.Im);this.xIa.eG&&(SL.a.jbo(this.xIa.eG),h.push.apply(h,b.eEd(this.xIa.eG)));if(this.xIa.fdj)for(const r of this.xIa.fdj)h.push(appChrome.actions.updateGallerySectionHiddenState(r.LKh,r.wKo,r.yMo));h.push.apply(h,b.BLh(this.xIa.hdj));
return h}BQh(){const b=[];if(this.gqc&&this.gqc.eG){const r=this.gqc.eG;for(let z in r){var h=r[z];const R=this.Im.Ldf(z);if(R)for(let ba of R)b.push(appChrome.actions.updateControlHiddenState(ba,h))}}return b}jFa(b){b&&this.Lca.Tbc.cVc(b,0)}QLf(b){this.Lca.Tbc.QLf(this.Im.getCommandByExternalUxId(b),appChrome.selectors.getModelType(b),{inputMethod:0})}FXk(){const b=t.AFrameworkApplication.K.$("ShareMenuIsEnabled")?"ShareMenu":"Share",h=t.AFrameworkApplication.K.appSettings;h&&appChrome.api.dispatch(this.Nlo(b,
"Shared"===(h.SharingStatus||"")))}tdn(){t.AFrameworkApplication.K.zq(()=>{this.FXk()})}Nlo(b,h){return appChrome.actions.updateSharingStatusIndicator(b,h)}iJl(b){return appChrome.actions.updateControlHiddenState(b,!1)}jJl(){return appChrome.actions.updateControlHiddenState("CopyLink",!1)}XI(b){Si.a.get_instance().XI(b);this.D_g.push(b)}YNn(){yh.d("updateRibbonInitializationState")&&appChrome.api.dispatch(appChrome.actions.updateRibbonInitializationState(Object.assign(new fI,{postRibbonInteractiveReady:!0})))}pUe(){this.gqc&&
this.lEg&&(this.X6a=this.lEg.K_e(),this.RYg.fileMenu=this.X6a)}rqm(b,h){this.X6a&&this.X6a.uki(b,h)}gVf(b,h,r){if(1===r)return 32;this.L_i(!0);this.bbc();t.AFrameworkApplication.ua.updateCommandUI();return 32}hVf(b,h,r){if(1===r)return 32;this.L_i(!1);this.iOn();this.bbc();t.AFrameworkApplication.ua.updateCommandUI();return 32}iOn(){Ga.a.DPa(t.AFrameworkApplication.K.lb("IsSimplifiedRibbonOnCookieName"),"true",Ga.a.zNa)}L_i(b){Ga.a.DPa(t.AFrameworkApplication.K.lb("ReactRibbonMLRPreferenceCookieName"),
b.toString(),Ga.a.zNa)}VAm(){if(t.AFrameworkApplication.ua&&t.AFrameworkApplication.ua.Sb.fq){const b=Sa.a.instance.Za("Common.ISystemInitiatedFeedback");"SingleLine"===appChrome.selectors.getRibbonMode()?(b.execute(h=>{h.logActivity("SingleRibbonModeActivity",null)}),t.AFrameworkApplication.naa("d79fg304;61jba833")):"Multiline"===appChrome.selectors.getRibbonMode()&&(b.execute(h=>{h.logActivity("MultiRibbonModeActivity",null)}),t.AFrameworkApplication.naa("69a7h198;dfd7j584"))}}Svm(){const b=Ga.a.dla(t.AFrameworkApplication.K.lb("VNextStyleOptOutCookieName"),
!1);window.setTimeout(()=>{const h=Sa.a.instance.Za("Common.ISystemInitiatedFeedback");h&&(t.AFrameworkApplication.K.$("Fluent2StyleIsEnabled")?(h.execute(r=>{r.logActivity("VNextStylesOn",null)}),h.execute(r=>{r.logActivity("Fluent2StyleEnabledFPS","Fluent2StyleFloodgateSurveyIsEnabled")})):t.AFrameworkApplication.K.$("Fluent2StyleFGOnlyIsEnabled")&&b&&h.execute(r=>{r.logActivity("Fluent2StyleOptOutFPS","Fluent2StyleFloodgateSurveyIsEnabled")}))},5E3)}snn(){Si.a.get_instance().tl(19,()=>{appChrome.api.setAsyncRequestStatus("appBoot",
!1)});const b=appChrome.api.getRibbonSubComponentMappings();for(let r in b){var h=r;const z=b[r];if(z)for(const R of z)t.AFrameworkApplication.ya.b6(R)?appChrome.api.reportRibbonSubComponentBehaviorMapped(h):t.AFrameworkApplication.ya.BMn(R,this.SLk(h));else appChrome.api.reportRibbonSubComponentBehaviorMapped(h)}}SLk(b){return()=>{appChrome.api.reportRibbonSubComponentBehaviorMapped(b)}}$Rl(){if(t.AFrameworkApplication.K&&t.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ExtendedPRIIsEnabled",
!1)&&yh.a("isSharedUxGateEnabled")&&appChrome.api.isSharedUxGateEnabled("SharedOnline.ChangeGate.UnifyPRIToastDismissal")&&t.AFrameworkApplication.Pac.uNe){const b=t.AFrameworkApplication.Pac.uNe,h=t.AFrameworkApplication.Pac.Z6g;h.payload||(h.payload={});const r=h.payload.launcherId?h.payload.launcherId:b;iz.cTi.xb(r)?iz.cTi.J(r)():"StatefulSplitButtonModel"===h.modelType?appChrome.PRIToastManager.dismissToast():(h.payload.PRIReadinessCheck=!0,this.Hke.executeCommand(b,h))}}}iz.vzj="common";iz.Ovj=
"appChrome";iz.cTi=new PL.a(ka.a.fKc());Object(n.a)(iz,"ReactRibbonUser",null,[755,282,9]);class LF extends iz{constructor(b,h,r,z,R,ba,ta,Wa,ub=null,Ib=!0,$b=null,fc=null){super(b,h,z,R,ba,ta,Wa,ub,Ib,$b,fc);this.abd=null;this.Apb=r;this.Apb.execute(Kc=>{this.abd=Kc});this.Apb.execute(Kc=>{this.Lca.vE=Kc})}jBa(){return this.abd?(this.abd.clearCache(),super.jBa()):[]}fGb(b){if(!b)throw Error.argumentNull();this.Apb.execute(h=>{b.vE=h})}}Object(n.a)(LF,"ReactRibbonUser",iz,[]);var UL=d(967);class SD extends LF{constructor(b,
h,r,z,R,ba,ta,Wa,ub,Ib=!0,$b=null,fc=null){super(h,b.tAa,z,tf.AppFrame.Jna,R.Ci,R.zc,ta,Wa,ub,Ib,$b,fc);if(void 0===b||null===b)throw Error.argumentNull("hostingAppFrame");this.cse=b;this.V8=ba;R.MQa(()=>{this.wlo();t.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.DelayUIComponentsUntilAfterRibbon",!1)?Si.a.get_instance().tl(7,()=>{this.T7h()}):this.T7h()},null)}get Ypf(){return!!t.AFrameworkApplication.K.appSettings.BootActivityNavigationId}T7h(){this.cKk();this.K_e();
this.gkn()}wlo(){this.wIa.classList.add("FlexBoxLayout");this.cse.hla().classList.add("cui-exth");this.cse.hla().classList.add("FlexBoxLayout");this.cse.hla().classList.add("ScrollableRibbon")}cKk(){t.AFrameworkApplication.eQ||this.QNk()}QNk(){if(!t.AFrameworkApplication.eQ){var b=(new XH(SD.aTj,this.V8)).I3k(),h=kr.a.qnf(tf.AppFrame.ULa,null,b,!0);h.UL=!0;this.Ubc(h,ab.a.V4d,ab.a.U4d);h.bindAction(rc.KeyInputManager.lc(wb.a.u4a,0),ab.a.T4d);ot(1,()=>{this.wtn(b)})}}wtn(b){const h=new dI;appChrome.renderSharedHeader(b,
h.bta()).then(Object(u.a)(this,this.z4e,"dismissFastViewHeader"))}FNi(){t.AFrameworkApplication.ua.Sb.ihi?appChrome.getHeaderApi().then(b=>{document.getElementById(t.AFrameworkApplication.Ecb).classList.remove("Placeholder");return b.dismissPlaceholder()}):(new UL.a).z4e()}z4e(){this.Ypf&&t.AFrameworkApplication.naa("Microsoft.Office.Web.SessionSettings.IWacWordImprovedDeepLinkLoadSettings");this.Ypf&&t.AFrameworkApplication.K.$("ImprovedDeepLinkLoadIsEnabled")?(Si.a.get_instance().tl(12,Object(u.a)(this,
this.FNi,"removeHeaderPlaceholder"),11),v.ULS.sendTraceTag(42316515,338,50,"DismissFastViewHeader was delayed to AppInitializationStatus.CommentRendered phase")):this.FNi()}Ubc(b,h,r){const z=rc.KeyInputManager.lc(wb.a.mx,0),R=rc.KeyInputManager.lc(wb.a.mx,4);b.Dr(z);b.Dr(R);b.bindAction(z,h);b.bindAction(R,r)}K_e(){const b=!!this.xIa&&"FileMenu"in this.xIa.hdj;t.AFrameworkApplication.ua.Sb.GMa&&!b&&ot(1,Object(u.a)(this,this.Usn,"renderFileMenu"))}Usn(){const b=[];if(t.AFrameworkApplication.K.$("DiagnosticsInfoInJewelAboutMenuIsEnabled")){var h=
[Object.assign(new JF,{label:CommonUIStrings.L_DiagnosticsSessionId,value:t.AFrameworkApplication.userSessionId}),Object.assign(new JF,{label:CommonUIStrings.L_DiagnosticsBuild,value:t.AFrameworkApplication.buildVersion})];b.push(appChrome.actions.setFileMenuSessionDetails("AboutTextSection",h))}b.push.apply(b,this.BQh());h=document.createElement("div");document.body.appendChild(h);appChrome.renderFileMenu(h,b)}gkn(){this.ga.pa(ab.a.aQa,kc.a.view,Object(u.a)(this,this.aQa,"tabSwitch"));this.ga.pa(ab.a.gVf,
kc.a.view,Object(u.a)(this,this.gVf,"ribbonModeToggledToMLR"));this.ga.pa(ab.a.hVf,kc.a.view,Object(u.a)(this,this.hVf,"ribbonModeToggledToSLR"))}activateRibbonTab(b){this.w0j(b)}bbc(){Si.a.get_instance().isCompleted(7)&&this.abd&&(mf.a.mark(4893),Jb.a.alo(),super.bbc(),mf.a.mark(4894))}aQa(b,h,r,z,R){if(2===R[ez.a.Ww]){if(r=Object(la.a)(ow.a,h))z=Object(la.a)(gy.a,r.view);else return v.ULS.sendTraceTag(38549528,338,10,"Context is not a valid ViewContext. It is a {0}, the actionId is: {1}, the actionData is: {2}",
Object.getTypeName(h),b,Na.a.join(R," ",":")),8;if(z&&""!==z.mI)ze.a.gfa(h)&&ze.a.UCb()||(this.Wb.Jg(z.mI),appChrome.selectors.getShyState().isActive&&RD.ShyRibbon.Lab(0,1));else return v.ULS.sendTraceTag(38549529,338,10,"Context is not a valid InteractiveView. It is a {0}, the actionId is: {1}, the actionData is: {2}, it is a view type of: {3}",Object.getTypeName(r.view),b,Na.a.join(R," ",":"),this.jwl(r.view)),8}return 32}jwl(b){return b?"is ContentEditableView: "+b.Dj+" is Editing View: "+b.Dta+
" is FishbowlView: "+b.pCa+" is HtmlView: "+b.o_a+" is InteractiveView: "+b.ze+" is NavigationPaneView: "+b.Vei+" is PageView: "+b.wi+" is WordNavigationPaneHeadingsView "+b.WQd:"null view"}}SD.aTj="WACRibbon";Object(n.a)(SD,"ReactRibbonUser",LF,[754,755,282,9]);class mI{constructor(b){this.ak=b}fJl(){return[k(Wg.a.Q2f,this.ak.C5h,"Strikethrough"),k(Wg.a.h3f,this.ak.D5h,"Subscript"),k(Wg.a.p3f,this.ak.E5h,"Superscript"),k(Wg.a.T$e,this.ak.t5h,"Format Painter"),k(Wg.a.T8h,this.ak.s5h,"Insert Footnote"),
k(Wg.a.O8h,this.ak.q5h,"Insert Endnote"),k(Wg.a.e1f,this.ak.A5h,"Show/Hide \u00b6"),k(Wg.a.x7f,this.ak.ylf,"Undo"),k(Wg.a.LQf,this.ak.z5h,"Redo"),k(Wg.a.tTe,this.ak.m5h,"Bold"),k(Wg.a.Iuf,this.ak.w5h,"Italic"),k(Wg.a.w7f,this.ak.F5h,"Underline"),k(Wg.a.heo,this.ak.ylf,"Undo"),k(Wg.a.Sjf,this.ak.u5h,"Grow Font Size"),k(Wg.a.g1f,this.ak.B5h,"Shrink Font Size"),k(Wg.a.m$k,this.ak.r5h,"Find"),k(Wg.a.Uhh,this.ak.n5h,"Bullets"),k(Wg.a.Vhh,this.ak.n5h,"Bullets"),k(Wg.a.Tui,this.ak.y5h,"Numbering"),k(Wg.a.Uui,
this.ak.y5h,"Numbering"),k(Wg.a.Gzh,this.ak.p5h,"Dictate"),k(Wg.a.nti,this.ak.x5h,"New Comment")]}hJl(){return[k(Wg.a.gQe,this.ak.rLd,"Align Left"),k(Wg.a.fQe,this.ak.qLd,"Align Center"),k(Wg.a.hQe,this.ak.sLd,"Align Right"),k(Wg.a.Suf,this.ak.tLd,"Justify"),k(Wg.a.X4f,this.ak.rLd,"Align Left"),k(Wg.a.V4f,this.ak.qLd,"Align Center"),k(Wg.a.Y4f,this.ak.sLd,"Align Right"),k(Wg.a.W4f,this.ak.tLd,"Justify")]}cJl(){return[k(Wg.a.Q2f,this.ak.C5h),k(Wg.a.h3f,this.ak.D5h),k(Wg.a.p3f,this.ak.E5h),k(Wg.a.T$e,
this.ak.t5h),k(Wg.a.T8h,this.ak.s5h),k(Wg.a.O8h,this.ak.q5h),k(Wg.a.L$n,this.ak.LYl),k(Wg.a.Sjf,this.ak.u5h),k(Wg.a.g1f,this.ak.B5h),k(Wg.a.tTe,this.ak.m5h),k(Wg.a.Iuf,this.ak.w5h),k(Wg.a.w7f,this.ak.F5h),k(Wg.a.vzh,this.ak.p5h),k(Wg.a.e1f,this.ak.A5h),k(Wg.a.Znf,this.ak.IYl),k(Wg.a.nti,this.ak.x5h),k(Wg.a.x7f,this.ak.ylf),k(Wg.a.LQf,this.ak.z5h),k(Wg.a.l9k,this.ak.r5h)]}eJl(){return[k(Wg.a.gQe,this.ak.rLd),k(Wg.a.fQe,this.ak.qLd),k(Wg.a.hQe,this.ak.sLd),k(Wg.a.Suf,this.ak.tLd),k(Wg.a.X4f,this.ak.rLd),
k(Wg.a.V4f,this.ak.qLd),k(Wg.a.Y4f,this.ak.sLd),k(Wg.a.W4f,this.ak.tLd)]}dJl(){return[k(Wg.a.Rmf,this.ak.v5h),k(Wg.a.v2e,this.ak.o5h)]}gJl(){return[k(Wg.a.Rmf,this.ak.v5h,"Increase Indent"),k(Wg.a.v2e,this.ak.o5h,"Decrease Indent")]}}Object(n.a)(mI,"ShortcutDiscoverySettings",null,[]);class nI{constructor(){this.YMg=X.a.TMa;this.ak=new uF.a(X.a.xl||X.a.ki);this.OUb=new mI(this.ak)}RHl(){let b=this.THl();this.YMg&&(b=b.concat(this.UHl()));return b}SHl(){return this.whf(this.OUb.dJl())}Qol(){let b=
this.Sol();this.YMg&&(b=b.concat(this.Tol()));return b}Rol(){return this.ddf(this.OUb.gJl())}UHl(){return this.whf(this.OUb.eJl())}THl(){return this.whf(this.OUb.cJl())}Tol(){return this.ddf(this.OUb.hJl())}Sol(){return this.ddf(this.OUb.fJl())}whf(b){const h=[];b.forEach(r=>{h.push(appChrome.actions.setButtonSecondaryText(r.actionId,r.l2i))});return h}ddf(b){const h=[];b.forEach(r=>{h.push(appChrome.actions.setControlCustomTooltip(r.actionId,this.Khf(r.label,r.l2i)))});return h}Khf(b,h){return b+
" ("+h+")"}}Object(n.a)(nI,"ShortcutActionHelper",null,[]);class oI extends SD{constructor(b,h,r,z,R,ba,ta,Wa,ub,Ib,$b,fc,Kc,ed,Jd=null,ge,qe){super(b,h,r,z,R,ba,ta,Wa,ub,!1,$b,Jd);this.lHe=Ib.i8d();this.dVj=Ib.N_f();this.ak=fc;this.s0g=Kc;this.t0g=ed;this.Pt=Sa.a.instance.Za("Common.ISystemInitiatedFeedback");this.T3n();this.Hb=ge;this.uqe=qe}w4l(){v.ULS.sendTraceTag(587232785,306,50,"InitializeWordRibbon was reached");Si.a.get_instance().XI(5);const b=this.Ypf&&t.AFrameworkApplication.K.$("ImprovedDeepLinkLoadIsEnabled")?
12:10;Si.a.get_instance().tl(b,Object(u.a)(this,this.n3l,"initializeFullRibbon"),11);t.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.EnablePenMinutes",!1)&&this.X3j()}Z4j(){this.Hb.$b(new Ic.a(5,1,t.AFrameworkApplication.K.rc("TickIntervalTimeForShortcutDiscovery",1E3),()=>{this.bJl()}))}X3j(){this.Hb.$b(new Ic.a(5,1,0,()=>{this.uqe.execute(b=>{b.hNn()})}))}bJl(){const b=[],h=new nI;b.push(...h.RHl(),...h.Qol());null!=t.AFrameworkApplication.K&&t.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.EnableHeadingDiscovery",
!1)&&b.push(...h.SHl(),...h.Rol());appChrome.api.dispatch(b)}Dkl(){const b=[];this.s0g&&(b.push(appChrome.actions.setButtonSecondaryText(Wg.a.yyd,this.ak.HYl)),b.push(appChrome.actions.setButtonSecondaryText(Wg.a.Xwd,this.ak.GYl)),b.push(appChrome.actions.setButtonSecondaryText(Wg.a.s_d,this.ak.JYl)));this.t0g&&b.push(appChrome.actions.setButtonSecondaryText(Wg.a.p_d,this.ak.KYl));return b}Aak(){this.Pt&&this.Pt.execute(b=>{b.logActivity("WordShyRibbon",null)});return 32}jRn(){this.Pt&&appChrome.api.isSmallDevice()?
this.Pt.execute(b=>{b.logActivity("ShyRibbonSmallScreenActivity",null)}):this.Pt.execute(b=>{b.logActivity("ShyRibbonNormalScreenActivity",null)});t.AFrameworkApplication.ya.gb(ab.a.cbh,Yd.a.frame,Object(u.a)(this,this.Aak,"alwaysShowRibbonSurvey"),96)}n3l(){Ze.a.instance.Tf(Vi.a.x4l,(new Date).getTime());appChrome.getLazyRibbonInitializationActions().then(b=>{if(!t.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CollabCornerCleanupIsEnabled",!1)&&!t.AFrameworkApplication.K.$("CollabCornerCleanupIsEnabled")){var h=
t.AFrameworkApplication.K.$("ShareMenuIsEnabled"),r=h?"ShareTopBar":"Share";this.lHe?b.push(this.iJl(r)):b.push(appChrome.actions.removePeripheralControl(r));this.dVj?b.push(this.jJl()):b.push(appChrome.actions.removePeripheralControl("CopyLink"));h&&!this.lHe&&b.push(appChrome.actions.updateControlHiddenState("ShareMenu",!this.lHe))}this.xIa&&b.push.apply(b,this.A0h());(this.s0g||this.t0g)&&this.ak&&b.push.apply(b,this.Dkl());t.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.EnableShortcutDiscovery",
!1)&&Si.a.get_instance().tl(7,()=>{this.Z4j()});b.push(appChrome.actions.setControlCustomTooltip(Wg.a.Uqm,CommonUIStrings.l_LoopsLearnMoreTooltip));t.AFrameworkApplication.ua&&t.AFrameworkApplication.ua.Sb.nma&&this.jRn();appChrome.api.isSmallDevice()&&t.AFrameworkApplication.ua&&t.AFrameworkApplication.ua.Sb.BI&&!t.AFrameworkApplication.eQ&&t.AFrameworkApplication.naa("Microsoft.Office.Web.SessionSettings.IWacWordShyRibbonSettings");b.push.apply(b,this.jBa());b.push(appChrome.actions.setControlBehaviorAttached(!0));
const z=Sa.a.instance.resolve("WordEditor.IModeSwitcherControl");h=z.Pvl();t.AFrameworkApplication.Hf("RibbonCleanupForUnifiedRead;RibbonCleanupForUnifiedReadcf");t.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ModeSwitcherInitialRenderIsEnabled",!1)&&(r=appChrome.selectors.getModeSwitcherMode())&&r!==h.activeMode&&v.ULS.sendTraceTag(527778651,306,15,`ModeSwitcher was initially rendered in the incorrect mode. Expected: ${h.activeMode}, Actual: ${r}`);(r="Suggest"===
h.activeMode)&&t.AFrameworkApplication.Hf("7aj80981;1e3dc950");t.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ShowReviewTabInReviewMode",!1)&&r||t.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.RibbonCleanupForUnifiedReadIsEnable",!1)&&"View"===h.activeMode?appChrome.getUpdateAppModeAndTabsActions(h).then(R=>{appChrome.api.dispatch(b.concat(R));z.xqi();this.g8h()}):(b.push(appChrome.actions.updateModeSwitcher(h)),appChrome.api.dispatch(b),
z.xqi(),this.g8h())})}g8h(){t.AFrameworkApplication.Pac.Zdo();this.x7g();this.pUe();this.a8h();Si.a.get_instance().XI(7);Ze.a.instance.wja(Vi.a.Jyc,Vi.a.Izn,(new Date).getTime())}T3n(){null!=t.AFrameworkApplication.K&&t.AFrameworkApplication.K.$("CollabCornerFloodgateSurveyFileSharedStatusIsEnabled")&&t.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FileSharedStatusInSharePeripheralControl",!1)&&2===t.AFrameworkApplication.zt.h2i&&(this.v4=Sa.a.instance.Za("Common.App.HostNotification.EditNotificationEventSource"))&&
this.v4.execute(b=>{b.lvb(Object(u.a)(this,this.Dcj,"triggerCollabCornerFileSharedStatusSurvey"))})}Dcj(){const b=Sa.a.instance.Za("Common.ISystemInitiatedFeedback");b&&window.setTimeout(()=>b.execute(h=>{h.logActivity("ToggleCollabCornerFileSharedStatusSurvey","CollabCornerFloodgateSurveyFileSharedStatusIsEnabled");this.v4&&this.v4.execute(r=>{r.O3d(Object(u.a)(this,this.Dcj,"triggerCollabCornerFileSharedStatusSurvey"))})}),12E4)}jFa(b){if(b){const h=this.GRh();try{super.jFa(b)}finally{null===h||
void 0===h?void 0:h.dispose()}}}jBa(){const b=this.GRh();try{return super.jBa()}finally{null===b||void 0===b?void 0:b.dispose()}}GRh(){var b;let h=void 0;const r=null===(b=vb.App.Xj)||void 0===b?void 0:b.al;r&&(h=new yf.GraphTransaction(vb.App.nci()&&vb.App.grf?0:2),h.set(r));return h}}Object(n.a)(oI,"ReactRibbonUser",SD,[]);var VL=d(1124);class pI extends GF{constructor(b,h,r,z,R,ba,ta,Wa){super(b,h,r);b=!1;t.AFrameworkApplication.K.$("HidePasteTextOnlyInRibbonChrome")||(b=!z.Hkb);this.Zue=t.AFrameworkApplication.K.$("PasteWithOptionsFromRibbon")&&
(X.a.v2||X.a.rp&&b);this.Im=R;this.ZDe=ba;this.Hb=ta;this.uqe=Wa}gNk(b,h){const r=new EC(t.AFrameworkApplication.K,this.ga,this.Wb,this.Zue),z=new ML.a(r);return this.ANk(b,h,z,r)}ANk(b,h,r,z){var R=new VH(new WH(t.AFrameworkApplication.K,z),r);r=this.V3l(R);const ba={};R.Akb(ba);R=!X.a.v2;const ta=X.a.rp||X.a.gj;var Wa=X.a.xl;t.AFrameworkApplication.K.$("CcpFixIPadShortcutStringsIsEnabled")&&(Wa=X.a.ki||Wa);Wa=new uF.a(Wa);b=new oI(b,h,WordEditorIntl.WordEditorStrings,this.Apb,z,b,this.Im,r,new RH(ba),
new VL.a(null),this.ZDe,Wa,R,ta,new UH,this.Hb,this.uqe);b.w4l();return b}V3l(b){const h={};b.o_c(h);b.X3c(h);return new SH(null,h,"jewelWordEditor")}}Object(n.a)(pI,"WordEditorRibbonUserFactory",GF,[]);class MF{constructor(b,h){this.uz=b;this.Fgd=h}MKa(b,h,r,z=null,R=null){return this.Fgd.Q2i(b)?this.Fgd.MKa(b,h,r,z,R):this.uz.MKa(b,h,r,z,R)}uCa(b,h=null){return this.Fgd.Q2i(b)?this.Fgd.uCa(b):this.uz.uCa(b,h)}}Object(n.a)(MF,"RootCuiUser",null,[333]);class qI extends MF{constructor(b,h){super(b,
h)}clearCache(){this.uz.clearCache()}}Object(n.a)(qI,"WordGeneralCuiUser",MF,[332,333]);class Bx extends sE{constructor(b,h,r){super(b,r);this.yH=h}Uaf(b){const h=[],r=di.a.instance.hb.kb,z=!!this.yH&&this.yH.cPc(Fb.a.YVe.toString()),R=!!this.yH&&this.yH.cPc(Fb.a.XHb.toString()),ba=!z&&!r.p6b&&Bx.x2a.Gqi(),ta=!!this.yH&&this.yH.cPc(ab.a.newComment.toString())||!!rb.a.instance&&(3===rb.a.instance.mode||2===rb.a.instance.mode),Wa=r.Wgi()&&t.AFrameworkApplication.ua.Sb.WOc,ub=3===b||X.a.ki||t.AFrameworkApplication.M$e;
b=ub&&Bx.W5e.yZ(r,b);ub&&h.push(this.Im.qYa("ClipboardGroup")[0].externalUxGroupId);ba&&(h.push(this.Im.qYa("TextFormattingGroup")[0].externalUxGroupId),h.push(this.Im.qYa("StylesGroup")[0].externalUxGroupId));z&&h.push(this.Im.qYa("PictureToolsGroup")[0].externalUxGroupId);R&&h.push(this.Im.qYa("TableToolsGroup")[0].externalUxGroupId);Wa&&h.push(this.Im.qYa("EquationToolsGroup")[0].externalUxGroupId);ta&&h.push(this.Im.qYa("CommentGroup")[0].externalUxGroupId);b&&h.push(this.Im.qYa("ContextMenuGroup")[0].externalUxGroupId);
return h}static get W5e(){return null!=Bx.xig?Bx.xig:Bx.xig=Sa.a.instance.resolve("Box4.UI.AEditSurfaceContextMenu")}static get x2a(){return null!=Bx.dqg?Bx.dqg:Bx.dqg=Sa.a.instance.resolve("Box4.ISelectionContextMenuProvider")}static mMc(b,h,r,z){b.dik(()=>Bx.cbb(h,r,z))}static cbb(b,h,r){return new Bx(b,h,r)}}Object(n.a)(Bx,"WordReactFloatie",sE,[]);class NF{constructor(){this.Yba=this.bwc=this.W=null}get name(){return"WordEditor.UI"}init(){var b;this.W.resolve("WordEditor.UI.BusinessBarController").nLf();
const h=vb.App.Cv.aI,r=vb.App.xa;Bx.mMc(r,this.W.resolve("Common.IReactContextualUILauncher"),h,this.W.resolve("Common.IExternalUICommandDefinitionMapping"));this.Yba=this.W.Pa("Box4.IContextMenuController");const z=new lH(r,h,this.W.Za("Box4.IGeneralCuiUser"),this.W.resolve("Box4.UI.PasteFloatieManager")),R={"floatie.gbFormatWithDesignerButton":!0,"floatie.gbMatchDocumentFormattingButton":!0,"floatie.gbUseSmartPasteButton":!0};switch(null===(b=t.AFrameworkApplication.K)||void 0===b?void 0:b.getIntFeatureGate("Microsoft.Office.WordOnline.Designer.SmartPasteInCCPFloatieExperience",
0)){case 1:R["floatie.gbFormatWithDesignerButton"]=!1;break;case 2:R["floatie.gbMatchDocumentFormattingButton"]=!1;break;case 3:R["floatie.gbUseSmartPasteButton"]=!1}z.mMc("PasteFloatieData",null,R);this.W.resolve("WordEditor.UI.CuiActionBridge").initialize();(new IH(r,h,this.W.Za("Box4.IGeneralCuiUser"),this.W.resolve("Box4.UI.ExternalContentFloatieManager"))).mMc("ExternalContentFloatieData",[WordEditorIntl.WordEditorStrings],{});this.W.resolve("Box4.IGeneralCuiUser");Si.a.get_instance().tl(7,()=>
{this.bwc=this.W.resolve("WordEditor.UI.StatusBarUser");this.bwc.Vb()})}dispose(){this.bwc&&(this.bwc.dispose(),this.bwc=null);this.Yba&&(this.Yba.dispose(),this.Yba=null)}yc(b){this.W=b;b.ha("WordEditor.UI.BusinessBarController",()=>new pH(b.resolve("CommonUI.IBusinessBar"),b.resolve("CommonUI.IBusinessBarEntryFactory"),t.AFrameworkApplication.ya,t.AFrameworkApplication.K)).as("WordEditor.IBusinessBarController").as("Wonca.IBusinessBarController").as("Box4.IBusinessBarController").singleInstance();
let h=X.a.xl;t.AFrameworkApplication.K.$("CcpFixIPadShortcutStringsIsEnabled")&&(h=X.a.ki||h);b.ha("Box4.UI.ShortcutHintMapping",()=>new uF.a(h));const r=X.a.rp||X.a.gj,z=t.AFrameworkApplication.K.$("PasteWithOptionsFromContextMenu")&&(X.a.v2||r),R=t.AFrameworkApplication.K.$("CatchUpActivityIsEnabled");b.ha("Box4.UI.AugLoopProofingErrorDetailHelper",()=>new W(Sa.a.instance.resolve("Box4.Proofing.IEditorServiceErrorDetailsFactory"),Sa.a.instance.resolve("Box4.Intent.IIntentRangeEditor"),new Te.a)).singleInstance();
b.ha("WordEditor.UI.EditSurfaceContextMenu",()=>new mq(t.AFrameworkApplication.ya,b.resolve("Box4.UI.IProofingContextMenuSectionFactory"),b.resolve("Box4.Proofing.IErrorRangeEditor"),t.AFrameworkApplication.K,b.resolve("Box4.TrackChange.ITrackChangeReaderFactory").instance,b.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,R?b.Za("WordEditor.CatchUpActivity.ActivityAnnouncementManager").instance:null,b.resolve("Box4.Proofing.IProofingFeatureConfiguration"),b.resolve("Box4.ILanguageReader"),
b.Pa("Box4.Intent.IIntentRangeEditor"),b.resolve("Box4.DictationCorrections.IDictationCorrectionContextMenuManager"),b.resolve("Common.App.UI.IPresenceContextMenuSectionBuilder"),b.Za("Box4.IPresenceDataManager"),b.Za("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"),b.Za("WordEditor.ContextualSearch.ISearchSuggestionManager"),b.resolve("WordEditor.DocumentUnderstanding.RLM.IDesignerRoleReader"),b.resolve("WordEditor.Designer.IDesignerControl"),b.resolve("WordEditor.Bookmark.FullBookmarkManager"),
z,r?b.resolve("Box4.UI.ShortcutHintMapping"):null,Sa.a.instance.Za("Common.IActionContextProvider"),Sa.a.instance.resolve("Box4.UI.AugLoopProofingErrorDetailHelper"),b.resolve("Box4.IParagraphReader"),b.resolve("WordEditor.TableOfContents.StyleBasedDocumentHeadings"),b.Pa("WordEditor.Designer.Review.IReviewTraverser"))).as("Box4.UI.AEditSurfaceContextMenu").singleInstance();b.ha("Box4.ISelectionContextMenuProvider",()=>new Ax).singleInstance();b.ha("WordEditor.UI.CuiActionBridge",()=>new El(t.AFrameworkApplication.K)).as("Box4.UI.CuiActionBridge").singleInstance();
b.ha("WordEditor.UI.DialogFactory",()=>new HH).as("WordEditor.UI.IDialogFactory").as("Box4.UI.IBox4DialogFactory").singleInstance();b.ha("Common.NonCanvasCuiUser",()=>new NG(ve.FocusManager.instance())).as("Common.INonCanvasCuiUser").singleInstance();b.ha("WordEditor.UI.WordGeneralCuiUser",()=>new qI(b.resolve("Box4.IGeneralCuiUser"),b.resolve("Common.INonCanvasCuiUser"))).singleInstance();b.resolve("WordEditor.UI.WordGeneralCuiUser");b.ha("WordEditor.UI.StatusBarUser",()=>new MH(vb.App.xa.E2f,b.Za("Box4.IGeneralCuiUser"),
b.resolve("Box4.IFeatureHelper"),t.AFrameworkApplication.ya,t.AFrameworkApplication.K,vb.App.xa)).as("WordEditor.IStatusBarUser").singleInstance();b.ha("WordEditor.IWordEditorNavigationPaneContextMenu",()=>new ND).singleInstance();const ba=b.resolve("WordEditor.UI.WordGeneralCuiUser");b.ha("CommandUI.ReactRibbonRoot",()=>new pE(kt.instance,b.resolve("Common.IExternalUICommandDefinitionMapping"),ba)).singleInstance();const ta=b.Za("WordEditor.UI.WordGeneralCuiUser");b.ha("WordEditor.UI.WordEditorRibbonUserFactory",
()=>new pI(ta,t.AFrameworkApplication.ya,ve.FocusManager.instance(),b.resolve("Common.App.ChromeExtensionHelper.IChromeExtensionHelper"),b.resolve("Common.IExternalUICommandDefinitionMapping"),b.resolve("CommandUI.ReactRibbonRoot"),t.AFrameworkApplication.uc,b.Za("Common.App.PenMinutesManager.IPenMinutesManager"))).as("Wonca.IRibbonUserFactory").singleInstance();b.ha("WordEditor.UI.ReactLanguageDialog",()=>new OD(b.resolve("Box4.UI.ILanguageEditor"),b.resolve("Box4.UI.ILanguageListHelper"))).as("Box4.UI.ILanguageDialog");
b.ha("WordEditor.UI.WordEditorRibbonSQMInformation",()=>new QH(t.AFrameworkApplication.ya)).as("Common.IRibbonSQMInformation").singleInstance();b.ha("WordEditor.UI.WordEditorFileMenuSQMInformation",()=>new OH(t.AFrameworkApplication.ya)).as("Common.IFileMenuSQMInformation").singleInstance();b.ha("WordEditor.UI.RulerUser",()=>new JH).as("WordEditor.IRulerUser");b.ha("WordEditor.UI.RulerContextMenu",()=>new hA(t.AFrameworkApplication.ya,Sa.a.instance.Za("Common.IZoomManager"),yr.a.instance)).as("WordEditor.IRulerContextMenu").singleInstance();
b.ha("Common.IReactContextualUILauncher",()=>new hH(b.resolve("CommandUI.ReactRibbonRoot"),b.resolve("Common.IExternalUICommandDefinitionMapping"))).singleInstance();b.ha("Box4.IContextMenuController",()=>new mH(b.resolve("Common.IReactContextualUILauncher"))).singleInstance()}static main(){t.AFrameworkApplication.Hf("5b6i5792;30d4f535");tj.instance.kDh();tj.instance.A6e();O.a.instance.Oc(new NF,6)}}Object(n.a)(NF,"WordEditorUIPackage",null,[1,2]);var XL=window.ExternalContentFloatieData={name:"CommandUI",
attrs:{xmlns:"http://schemas.microsoft.com/sharepoint/"},children:[{name:"Floatie",attrs:{Id:"WordEditor.ExternalContentFloatie",ImageDownArrow:"IMGMAP@we@SplitButtonArrow_5x3x32",ImageDownArrow8by8:"IMGMAP@we@SplitButtonArrow_8x8x32",TextDirection:"STR@L_RibbonOptionTextDirection"},children:[{name:"Groups",attrs:{},children:[{name:"Group",attrs:{Id:"ExternalContentOptionsGroup"},children:[{name:"Section",attrs:{},children:[{name:"Row",attrs:{},children:[{name:"Controls",attrs:{},children:[{name:"FlyoutAnchor",
attrs:{Id:"ExternalContentFloatie.FlyoutAnchor",LabelText:"STR@L_DisplayAs",Image16by16:"IMAGEPATH@DisplayAs.png",Alt:"STR@L_DisplayAs",DisplayMode:"Medium",TemplateAlias:"ExternalContent"},children:[{name:"Menu",attrs:{Id:"menuPasteOptions"},children:[{name:"MenuSection",attrs:{Id:"floatie.msExternalContentOptionsButtons",DisplayMode:"Menu16"},children:[{name:"Controls",attrs:{Id:"floatie.galleryPasteOptionsButtons"},children:[{name:"ToggleButton",attrs:{Id:"floatie.gbPasteKeepSourceButton",Command:"0xE188C0F7",
QueryCommand:"0xD46B64BD",Image16by16:"IMAGEPATH@EmbeddedContent.png",Alt:"STR@L_EmbeddedContent",LabelText:"STR@L_EmbeddedContent"}},{name:"ToggleButton",attrs:{Id:"floatie.gbPasteTextOnlyButton",Command:"0xE36ACF00",QueryCommand:"0xB5FF507C",Image16by16:"IMGMAP@we@WebInsertHyperlink_16x16x32",Alt:"STR@L_Hyperlink",LabelText:"STR@L_Hyperlink"}}]}]}]}]}]}]}]}]}]}]}]},cB={};cB.ric=function(){function b(){return ta()&&(Jd()||3<=(fc()?ge("version/"):0))}function h(){return 0<=window.navigator.userAgent.indexOf("Windows")}
function r(){return 0<=window.navigator.userAgent.indexOf("Windows Phone")}function z(Cf){Cf=(new RegExp(Cf+"\\s+(\\d+(\\.\\d*)?)")).exec(window.navigator.userAgent);var Oh=-1;null!=Cf&&2<=Cf.length&&(Oh=parseFloat(Cf[1]),isNaN(Oh)&&(Oh=-1));return Oh}function R(){rI||(rI=!0,sI=z("Windows Phone"));return 8<=sI}function ba(){return"function"==typeof navigator.msLaunchUri&&!r()&&!ed()&&!Wa()}function ta(){return 0<=window.navigator.userAgent.indexOf("Macintosh")}function Wa(){return 0<=window.navigator.userAgent.indexOf("Edge/")}
function ub(){return 0<=window.navigator.userAgent.indexOf(" MSIE ")||0<=window.navigator.userAgent.indexOf("Trident/")}function Ib(){return ub()?8==window.document.documentMode:!1}function $b(){return 0<=window.navigator.userAgent.indexOf(" Firefox/")}function fc(){return 0<=window.navigator.userAgent.indexOf(" AppleWebKit/")}function Kc(){return 0<=window.navigator.userAgent.toLowerCase().indexOf("chrome")}function ed(){var Cf=window.navigator.userAgent.toLowerCase();return 0<=Cf.indexOf("android")&&
0<=Cf.indexOf("chrome")}function Jd(){return 3<=($b()?ge("firefox/"):0)}function ge(Cf){var Oh=window.navigator.userAgent.toLowerCase(),ol=Oh.indexOf(Cf);return 0<=ol?parseInt(Oh.substring(ol+Cf.length,Oh.length)):0}function qe(Cf,Oh,ol,Vk,fp){if(Vk&&null!=Oh)Oh();else if(ba())navigator.msLaunchUri(Cf,Oh,ol);else if(!(Kc()||0<=window.navigator.userAgent.indexOf("iPhone")||0<=window.navigator.userAgent.indexOf("iPad")||0<navigator.maxTouchPoints&&ta())||Wa())Bd(Cf,Oh,ol);else if(Kc()&&fp)a:{try{window.open(Cf,
"_self")}catch(Ar){null!=ol&&ol();break a}null!=Oh&&Oh()}else Ve(Cf,Oh,ol)}function Ve(Cf,Oh,ol){var Vk=document.getElementById("OICLinkTag");null==Vk&&(Vk=document.createElement("a"),Vk.id="OICLinkTag",Vk.style.visibility="hidden",Vk.href="",0==(Rp.Options&dw.SupportsTopTargetNavigation)||Rp.NoBrowserModalDialogs?Vk.target="_blank":Vk.target="_top",document.body.appendChild(Vk),null!=Vk.addEventListener&&Vk.addEventListener("click",function(fp){null!=fp.stopPropagation&&fp.stopPropagation()},!1));
try{Vk.href=Cf,Vk.click()}catch(fp){null!=ol&&ol();return}null!=Oh&&Oh()}function Bd(Cf,Oh,ol){var Vk=document.getElementById("OICFrame");null==Vk&&(Vk=document.createElement("iframe"),Vk.className="ObjectInDialog",Vk.style.visibility="hidden",Vk.src="about:blank",document.body.appendChild(Vk),Vk.id="OICFrame");try{Vk.contentWindow.location.href=Cf}catch(fp){null!=ol&&ol();return}null!=Oh&&Oh()}function he(Cf){return 0!=(Cf.Options&dw.SkipProtocolHandler)||Ib()}function we(Cf){return Cf===dB.ReadOnly||
Cf===dB.ReadWrite}function hg(Cf,Oh,ol,Vk){var fp;try{var Ar=new ActiveXObject("SharePoint.OpenDocuments.4");return(fp=Ar.ViewDocument3(window.self,Cf,Oh,Vk))?(GC(jz.O14ActiveX),Vo.None):Vo.Failed}catch(Br){}if(dw.O14Only===(ol&dw.O14Only))return Rp.DescriptiveUnattemptedEnums?Vo.O14AttemptFailure:Vo.Unattempted;try{return Ar=new ActiveXObject("SharePoint.OpenDocuments.3"),(fp=Ar.ViewDocument3(window.self,Cf,Oh,Vk))?(GC(jz.O12ActiveX),Vo.None):Vo.Failed}catch(Br){}if(dw.O12UpOnly===(ol&dw.O12UpOnly))return Rp.DescriptiveUnattemptedEnums?
Vo.O12UpOnlyFail:Vo.Unattempted;try{return Ar=new ActiveXObject("SharePoint.OpenDocuments.2"),(fp=we(Oh)?Ar.ViewDocument2(window.self,Cf,Vk):Ar.EditDocument2(window.self,Cf,Vk))?(GC(jz.O11ActiveX),Vo.None):Vo.Failed}catch(Br){}return Rp.DescriptiveUnattemptedEnums?Vo.ActiveXUnattempted:Vo.Unattempted}function Pf(Cf,Oh,ol,Vk,fp){Cf==Pq.Visio&&ol==dB.ReadWrite&&(ol=dB.WriteOnly);Cf=fp;Vk=Vk||r()&&!R();Vk||(Vk="",Vk=we(ol)?Vk+"ofv|ofc|":Vk+"ofe|",Cf+=pn(Vk+"u|"));Cf+=pn(Oh);Rp.NewTelemetryDataIsEnabled&&
(Oh=-1!==Cf.indexOf("?")?"&":"?",Oh+=Rp.SessionOrigin?"OR="+Rp.SessionOrigin+"&":"",Oh+=Rp.ClickTime?"CT="+Rp.ClickTime+"&":"",Oh+=Rp.CorrelationId?"CID="+Rp.CorrelationId:"",Oh="?"!=Oh?Oh:"",Oh="&"!=Oh.slice(-1)?Oh:Oh.slice(0,-1),Cf+=pn(Oh));Oh=window.location.href;ol=Oh.toLowerCase().indexOf("&wdlor=");-1!=ol?(ol+=7,Vk=Oh.indexOf("&",ol),Oh=-1==Vk?Oh.substr(ol):Oh.substring(ol,Vk)):Oh=void 0;if(null!=Oh&&"undefined"!=typeof Oh){ol="";try{ol=decodeURIComponent(Oh)}catch(Ar){}0<ol.length&&RegExp("(c|t)[\\w]{8}-[\\w]{4}-[\\w]{4}-[\\w]{4}-[\\w]{12}").test(ol)&&
(Cf=Cf+"|f|"+ol)}return Cf}function Ej(Cf,Oh,ol,Vk,fp,Ar){var Br=tI(Cf);if(null==Br)return RB(Rp.DescriptiveUnattemptedEnums?Vo.ProtocolHandlerIsNull:Vo.Unattempted,Rp.Application),!1;Cf=Pf(Cf,Oh,ol,Vk,Br);qe(Cf,Ol,qt,fp,Ar);return!0}function pn(Cf){if(ta()&&Kc()){var Oh="";try{Oh=decodeURI(Cf)}catch(ol){}if(Oh==Cf)return encodeURI(Cf)}return Cf}function Ol(){GC(jz.ProtocolHandler)}function qt(){Rp.Options|=dw.SkipProtocolHandler;uI(Rp,HC,IC)}function rt(){null!=OF&&OF(jz.RoamingProtocolHandler)}
function $v(){null!=PF&&PF(Vo.ControlNeeded)}function iE(){var Cf=document.getElementById("npSharePointPlugin");if(null==Cf){Cf="application/x-sharepoint";ta()&&3<=(fc()?ge("version/"):0)&&Kw("application/x-sharepoint-webkit",!0)&&(Cf="application/x-sharepoint-webkit");if(!Kw(Cf,!0))if(ta()&&Kw("application/officelive",!0))Cf="application/officelive";else return null;var Oh=document.createElement("object");Oh.id="npSharePointPlugin";Oh.type=Cf;Oh.style.width="0px";Oh.style.height="0px";Oh.style.setProperty("visibility",
"hidden","");document.body.appendChild(Oh);Cf=document.getElementById("npSharePointPlugin")}return Cf}function Kw(Cf,Oh){var ol=window.navigator.mimeTypes;if(null==ol)return!1;Cf=ol[Cf];return!Cf||Oh&&!Cf.enabledPlugin?!1:!0}function HE(Cf){try{if(null!=new ActiveXObject(Cf))return!0}catch(Oh){}return!1}function QF(Cf){switch(Cf){case Pq.OneNote:return"OneNote.Notebook";default:return""}}function tI(Cf){if(Cf!=Pq.OneNote&&r()&&!R())return"office:";switch(Cf){case Pq.Excel:return"ms-excel:";case Pq.OneNote:return"onenote:";
case Pq.PowerPoint:return"ms-powerpoint:";case Pq.Visio:return"ms-visio:";case Pq.Word:return"ms-word:";case Pq.Project:return"ms-project:";case Pq.Publisher:return"ms-publisher:";case Pq.Infopath:return"ms-infopath:";case Pq.Access:return"ms-access:";default:return""}}function YL(Cf){switch(Cf){case Pq.Excel:return"root\\office15\\excel.exe";case Pq.PowerPoint:return"root\\office15\\powerpnt.exe";case Pq.Visio:return"root\\office15\\visio.exe";case Pq.Word:return"root\\office15\\winword.exe";case Pq.Project:return"root\\office15\\winproj.exe";
case Pq.Publisher:return"root\\office15\\mspub.exe";case Pq.Infopath:return"root\\office15\\infopath.exe";case Pq.Access:return"root\\office15\\msaccess.exe";default:return null}}function uI(Cf,Oh,ol){Rp=Cf;HC=Oh;IC=ol;if(Cf.DocumentUrl){var Vk=ol=Oh=Cf.DocumentUrl;try{Vk=decodeURIComponent(Cf.DocumentUrl)}catch(JC){}try{ol=encodeURI(Cf.DocumentUrl)}catch(JC){}Oh=Oh+""+Cf.CorrelationIdForWinClient;Vk+=Cf.CorrelationIdForWinClient;ol+=Cf.CorrelationIdForWinClient;Cf.Mode===dB.ReadWrite&&dw.CheckoutRequired===
(Cf.Options&dw.CheckoutRequired)&&(Cf.Mode=dB.ForceCheckout);dw.HostIsEditOnly===(Cf.Options&dw.HostIsEditOnly)&&(Cf.Mode=dB.WriteOnly);if(he(Cf)?0:ta()&&(Cf.Application==Pq.OneNote||Kw("application/x-sharepoint-protocolhandler",!1)||Kw("application/x-sharepoint-webkit-protocolhandler",!1))||ba()||ed()||!(b()||Jd()||"ActiveXObject"in window&&!r()||Kc())||15<=IE())Ej(Cf.Application,Cf.EncodeUrl?ol:Oh,Cf.Mode,Cf.Application==Pq.OneNote,Cf.SilentExternalHandler,Cf.NavigateUsingWindowOpen);else{var fp;
if(fp=Ib())a:{var Ar=Cf.EncodeUrl?Oh:Vk,Br=Cf.Mode,TD=QF(Cf.Application);try{fp=(new ActiveXObject("SharePoint.OpenDocuments.5")).ViewDocument3(window.self,Ar,Br,TD);break a}catch(JC){}fp=!1}if(fp)GC(jz.O15ActiveX);else{if(b()||Jd()){var ps=Cf.EncodeUrl?Oh:Vk;Vk=Cf.Mode;fp=QF(Cf.Application);Ar=iE();if(null==Ar)ps=Rp.DescriptiveUnattemptedEnums?Vo.PluginIsNull:Vo.Unattempted;else{Br=!1;try{Br=Ar.ViewDocument3(window.self,ps,Vk,fp)}catch(JC){}if(!Br)try{Br=we(Vk)?Ar.ViewDocument2(window.self,ps,fp):
Ar.EditDocument2(window.self,ps,fp)}catch(JC){}Br?(GC(jz.NpapiPlugin),ps=Vo.None):ps=Vo.Failed}}else{try{ps=new ActiveXObject("IDBHO.IDBHOCtrl"),null!=ps&&ps.SaveSSOCreds()}catch(JC){}ps=hg(Cf.EncodeUrl?Oh:Vk,Cf.Mode,Cf.Options,QF(Cf.Application))}if(ps!=Vo.None){if(Vk=Cf.CouldUseRoamingApps)vI||(vI=!0,wI=z("Windows NT")),Vk=6.1<=wI&&!(0<=window.navigator.userAgent.indexOf("ARM;"))&&(ub()||Jd()||Kc());if(Vk&&Cf.Application!=Pq.OneNote){if(!cB.ric.wwo()){RB(Vo.ControlNeeded,Rp.Application);return}if(Cf.RoamingAppsLauncher){"undefined"==
typeof Cf.RoamingAppsLauncher||null==Cf.RoamingAppsLauncher?RB(Rp.DescriptiveUnattemptedEnums?Vo.RoamingLauncherIsNull:Vo.Unattempted,Rp.Application):"undefined"==typeof Cf.RoamingBitsUrl||null==Cf.RoamingBitsUrl?cB.ric.Yxo(Cf.DocumentUrl,Cf.RoamingAppsLauncher,Cf.Application,Cf.ApplicationParameters,HC,IC):cB.ric.bqj(Cf.DocumentUrl,Cf.RoamingAppsLauncher,Cf.RoamingApplicationExe,Cf.ApplicationParameters,Cf.RoamingPlatform,Cf.RoamingBitsUrl,HC,IC);return}if(!Cf.ContinueIfLauncherIsNull){RB(Vo.LauncherNeeded,
Rp.Application);return}}dw.NoProtocolHandlerFallback==(Cf.Options&dw.NoProtocolHandlerFallback)||he(Cf)||ub()||ta()&&!(Rp.DescriptiveUnattemptedEnums?ps>=Vo.O14Unattempted&&ps<=Vo.DocumentUrlIsNull:ps==Vo.Unattempted)?RB(ps,Rp.Application):Ej(Cf.Application,Cf.EncodeUrl?ol:Oh,Cf.Mode,Cf.Application==Pq.OneNote,Cf.SilentExternalHandler,Cf.NavigateUsingWindowOpen)}}}}else RB(Rp.DescriptiveUnattemptedEnums?Vo.DocumentUrlIsNull:Vo.Unattempted,Rp.Application)}function GC(Cf){null!=HC&&HC(Cf)}function RB(Cf,
Oh){"undefined"==typeof Oh&&(Oh=null);null!=IC&&IC(Cf,Oh)}function IE(){var Cf=0;if(b()||Jd()||Kc()){var Oh=iE();try{null!=Oh&&(Cf=Oh.GetOfficeVersion())}catch(ol){}}else HE("SharePoint.OpenDocuments.5")?Cf=15:HE("SharePoint.OpenDocuments.4")?Cf=14:HE("SharePoint.OpenDocuments.3")?Cf=12:HE("SharePoint.OpenDocuments.2")&&(Cf=11);return Cf}function xI(){return ta()&&(Kw("application/x-sharepoint",!0)||Kw("application/x-sharepoint-webkit",!0))}var yI="",zI="",AI="",HC,IC,OF,PF,Rp,vI,wI,rI,sI,dB={ReadWrite:0,
ReadOnly:1,WriteOnly:2,ForceCheckout:3,WriteLocalCopy:4,OpenInBrowser:5},dw={None:0,CheckoutRequired:1,O14Only:2,HostIsEditOnly:4,O12UpOnly:8,SkipProtocolHandler:16,NoProtocolHandlerFallback:32,SupportsTopTargetNavigation:64},Vo={None:0,Failed:1,Unattempted:2,LauncherNeeded:3,ControlNeeded:4,PopupBlocked:5,O14Unattempted:6,O12UpOnlyUnattempted:7,PluginIsNull:8,ActiveXUnattempted:9,ProtocolHandlerIsNull:10,ProtocolHandlerNoCallbackIsNull:11,RoamingLauncherIsNull:12,DocumentUrlIsNull:13},jz={Unknown:0,
NpapiPlugin:1,O10ActiveX:2,O11ActiveX:3,O12ActiveX:4,O14ActiveX:5,ProtocolHandler:6,RoamingActiveX:7,RoamingFFExtension:8,RoamingProtocolHandler:9,O15ActiveX:10},Pq={Unknown:0,Excel:1,OneNote:2,PowerPoint:3,Visio:4,Word:5,Project:6,Publisher:7,Infopath:8,Access:9};return{OpenDocumentMode:dB,OpenDocumentOptions:dw,OpenDocumentFailureType:Vo,OpenDocumentControl:jz,OfficeApplication:Pq,EditDocumentInClient:uI,EditDocumentInClientParams:function(){this.DocumentUrl="";this.Options=this.Mode=0;this.Application=
Pq.Unknown;this.CouldUseRoamingApps=!1;this.RoamingAppsLauncher="";this.ContinueIfLauncherIsNull=!1;this.RoamingBitsUrl=this.RoamingApplicationExe=this.RoamingPlatform=this.ApplicationParameters="";this.EncodeUrl=this.SilentExternalHandler=!1;this.CorrelationIdForWinClient="";this.NewTelemetryDataIsEnabled=this.NoBrowserModalDialogs=this.DescriptiveUnattemptedEnums=this.NavigateUsingWindowOpen=!1;this.SessionOrigin=this.ClickTime=this.CorrelationId=""},OfficeVersionInstalled:IE,IsO14MacPluginInstalled:xI,
OfferOfficeInDialog:function(){return h()&&11>=IE()},OfferOfficeNoIntrusive:function(){return h()&&15>IE()},OfferMacOffice:function(){return ta()&&!(0<=window.navigator.userAgent.indexOf("PPC Mac"))&&!xI()},InstallRoamingControl:function(){$b()?window.InstallTrigger.install({Office:{URL:zI}}):Bd(AI,null,null)},CanUseRoamingControl:function(){if(ba())return!0;if(Kc())return"undefined"!=typeof navigator.plugins.refresh&&navigator.plugins.refresh(!1),!!navigator.mimeTypes["application/x-vnd.officeondemand"];
if($b()){var Cf=document.createElement("RoamingExtensionElement");document.documentElement.appendChild(Cf);var Oh=document.createEvent("Events");Oh.initEvent("RoamingOfficeInstalled",!0,!1);Cf.dispatchEvent(Oh);return!!Cf.getAttribute("installed")}if(ub())try{return(new ActiveXObject("RoamingOfficeActiveX.RoamingOffice")).HrExists()}catch(ol){}return!1},InitUrls:function(Cf,Oh,ol){yI=Cf;zI=ol;AI=Oh},LaunchRoamingApps:function(Cf,Oh,ol,Vk,fp,Ar){cB.ric.bqj(Cf,Oh,YL(ol),Vk,"x86",yI,fp,Ar)},LaunchRoamingApps2:function(Cf,
Oh,ol,Vk,fp,Ar,Br,TD){var ps="";null!=Vk&&(ps+=" "+Vk);null!=Cf&&(ps+=' "'+Cf+'"');if(ba()||Kc())OF=Br,PF=TD,Br='office: "'+(Ar+'" "')+(ol+'" "ROAMING"'),Br+=' "'+Oh+'"',Br+=' "'+fp+'"',Br+=" "+ps,qe(Br,rt,$v,!1,!1);else if($b())Cf=document.createElement("RoamingExtensionElement"),Cf.setAttribute("cabUrl",Ar),Cf.setAttribute("app",ol),Cf.setAttribute("licensingEntitlements",Oh),Cf.setAttribute("platform",fp),Cf.setAttribute("args",ps),document.documentElement.appendChild(Cf),Oh=document.createEvent("Events"),
Oh.initEvent("RoamingOfficeLaunch",!0,!1),Cf.dispatchEvent(Oh),null!=Br&&Br(jz.RoamingFFExtension);else if(ub()){if(Cf=new ActiveXObject("RoamingOfficeActiveX.RoamingOffice"),null!=Cf)try{Cf.HrConfigureSingle(Ar,ol,Oh,fp,ps),null!=Br&&Br(jz.RoamingActiveX)}catch(JC){}}else null!=TD&&TD(Vo.Failed)},ShouldShowDialog:function(){return!r()},NavigateToUrlUsingClickingOnATag:Ve,OpenDocumentWithProtocolHandler:Ej,OpenDocumentWithProtocolHandlerNoCallBack:function(Cf,Oh,ol,Vk){var fp=tI(Cf);if(null==fp)return RB(Rp.DescriptiveUnattemptedEnums?
Vo.ProtocolHandlerNoCallbackIsNull:Vo.Unattempted,Rp.Application),!1;Cf=Pf(Cf,Oh,ol,Vk,fp);qe(Cf,null,null,!1,!1);return!0}}}();cB.ClientUtils=cB.ric;var ZL=d(1460);class JE{constructor(b,h,r){this.ga=b;this.lJj=h;this.N4=r}Vb(){this.ga.pa(ab.a.tryMacOffice,Yd.a.frame,Object(u.a)(this,this.GYm,"onTryMacOffice"));this.ga.pa(ab.a.Xdj,Yd.a.frame,Object(u.a)(this,this.XAi,"onTryMacOfficeFromViewer"));this.ga.pa(ab.a.Wdj,Yd.a.frame,Object(u.a)(this,this.XAi,"onTryMacOfficeFromViewer"))}GYm(b,h,r,z,R){if(1===
r)return 32;R?(b=R.SourceControlId,"btnjTryMacOfficeForWordEditor"===b?Ed.a.Cm(Rc.a.pYa(12),"_blank",void 0,"MacOfficeOffer.TriggerFromWordEditor"):"PptJewel.About.TryMacOffice"===b&&Ed.a.Cm(Rc.a.pYa(22),"_blank",void 0,"MacOfficeOffer.TriggerFromPPTEditor")):this.wki();return 32}XAi(b,h,r){if(1===r)return 32;switch(b){case ab.a.Xdj:Ed.a.Cm(Rc.a.pYa(15),"_blank",void 0,"MacOfficeOffer.TriggerFromWordViewer");break;case ab.a.Wdj:Ed.a.Cm(Rc.a.pYa(25),"_blank",void 0,"MacOfficeOffer.TriggerFromPPTViewer")}return 32}wki(){Ed.a.Cm(JE.xDm,
"_blank",void 0,"LaunchMacTrialWindow")}get m0c(){return this.lJj&&X.a.xl&&!X.a.Lsf&&!MSOJS.ClientUtils.IsO14MacPluginInstalled()}get QTn(){const b=this.m0c;b||t.AFrameworkApplication.Dm.IHn();return b}get PTn(){return this.m0c}static get xDm(){return Rc.a.i6("522401")}}Object(n.a)(JE,"MacOfficeOffer",null,[968]);class KE{constructor(b,h,r){this.ga=b;this.rJj=h;this.lR=null;(this.$od=t.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseApplicationFeatureHelperAPIForFeedbackAndSurvey",
!1))&&Sa.a.instance.Za("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(z=>{this.lR=z});this.N4=r}Vb(){this.ga.pa(ab.a.tryOffice,Yd.a.frame,Object(u.a)(this,this.HYm,"onTryOffice"));this.ga.pa(ab.a.Z6f,Yd.a.frame,Object(u.a)(this,this.Z6f,"tryOfficeThroughTellMe"));this.ga.pa(ab.a.cej,Yd.a.frame,Object(u.a)(this,this.dej,"tryOfficeThroughViewer"));this.ga.pa(ab.a.bej,Yd.a.frame,Object(u.a)(this,this.dej,"tryOfficeThroughViewer"))}HYm(b,h,r,z,R){if(this.$od&&1===r)return this.isFreemiumUpsellEnabled&&
this.n0c?32:8;2===r&&(R?(b=R.SourceControlId,"btnjTryOfficeForWordEditor"===b?Ed.a.Cm(Rc.a.pYa(11),"_blank",void 0,"OfficeTrial.TriggerFromWordEditor"):"PptJewel.About.TryOffice"===b?Ed.a.Cm(Rc.a.pYa(21),"_blank",void 0,"OfficeTrial.TriggerFromPPTViewer"):this.Uvf()):this.Uvf());return 32}Z6f(b,h,r,z,R){if(this.$od&&1===r)return this.isFreemiumUpsellEnabled&&this.n0c?32:8;2===r&&(R?(b=R.SourceControlId,Ed.a.Cm(Rc.a.i6("862405")+this.rDl(b),"_blank",void 0,"TryOfficeThroughTellMe.WithSourceControlId")):
Ed.a.Cm(Rc.a.i6("522402"),"_blank",void 0,"TryOfficeThroughTellMe.Legacy"));return 32}dej(b,h,r){if(this.$od&&1===r)return this.isFreemiumUpsellEnabled&&this.n0c?32:8;if(2===r)switch(b){case ab.a.cej:Ed.a.Cm(Rc.a.pYa(14),"_blank",void 0,"TryOfficeThroughViewer.Word");break;case ab.a.bej:Ed.a.Cm(Rc.a.pYa(24),"_blank",void 0,"TryOfficeThroughViewer.PPT")}return 32}get RNm(){return this.n0c}get QNm(){return this.n0c&&MSOJS.ClientUtils.OfferOfficeInDialog()}get n0c(){return this.rJj&&!X.a.xl}get isFreemiumUpsellEnabled(){let b=
!1;this.lR&&(b=this.lR.isFreemiumUpsellEnabled());return b}Uvf(b=null){let h=0;b&&(h=b);Ed.a.Cm(KE.wxl(h),"_blank",void 0,"LaunchOfficeOffer")}rDl(b){let h=0;switch(b){case "jbtnTryOfficeThroughTellMeForWordTrackChanges":h=1;break;case "jbtnTryOfficeThroughTellMeForWordShapes":h=2;break;case "jbtnTryOfficeThroughTellMeForWordLabel":h=3;break;case "jbtnTryOfficeThroughTellMeForWordCitations":h=4;break;case "jbtnTryOfficeThroughTellMeForWordTextBox":h=5;break;case "jbtnTryOfficeThroughTellMeForWordTableOfContent":h=
6;break;case "jbtnTryOfficeThroughTellMeForWordSmartArt":h=7;break;case "jbtnTryOfficeThroughTellMeForWordWordArt":h=8;break;case "jbtnTryOfficeThroughTellMeForWordMultiColumnLayout":h=9;break;case "jbtnTryOfficeThroughTellMeForWordEquation":h=10;break;case "jbtnTryOfficeThroughTellMeForPPTGroupShapes":h=16;break;case "jbtnTryOfficeThroughTellMeForPPTWordArt":h=17;break;case "jbtnTryOfficeThroughTellMeForPPTSpellCheckDict":h=18;break;case "jbtnTryOfficeThroughTellMeForPPTInsertAudio":h=19;break;case "jbtnTryOfficeThroughTellMeForPPTInsertChart":h=
20;break;case "TellMe.TryOfficeThroughTellMeForXLSSpellCheck":h=26;break;case "TellMe.TryOfficeThroughTellMeForXLSMacros":h=27;break;case "TellMe.TryOfficeThroughTellMeForXLSPivotTable":h=28;break;case "TellMe.TryOfficeThroughTellMeForXLSHeaderFooter":h=29}return 0===h?"":String.format("&pc={0:D}",h)}static wxl(b){if(X.a.ki)switch(b){case 1:return Rc.a.i6("393806");case 2:return Rc.a.i6("393810");case 3:return Rc.a.i6("393809");case 5:return Rc.a.i6("393805")}else if(X.a.ML)switch(b){case 1:return Rc.a.i6("521979");
case 3:return Rc.a.i6("521980");case 5:return Rc.a.i6("521978");case 2:return Rc.a.i6("522490")}else{if(2===b)return Rc.a.i6("517778");if(1===b)return Rc.a.pYa(30)}return Rc.a.i6("522402")}}Object(n.a)(KE,"OfficeTrialExperience",null,[965]);class BI{yc(b){b.register(KE,"Common.App.OpenInClient.OfficeTrialExperience").as("Common.IOfficeTrialExperience").singleInstance().Yd(()=>new KE(t.AFrameworkApplication.ya,t.AFrameworkApplication.msf,t.AFrameworkApplication.lcid));b.register(JE,"Common.App.OpenInClient.MacOfficeOffer").as("Common.IMacOfficeOffer").singleInstance().Yd(()=>
new JE(t.AFrameworkApplication.ya,t.AFrameworkApplication.Dei,t.AFrameworkApplication.lcid))}}Object(n.a)(BI,"OpenInClientConfiguration",null,[2]);var $L=d(1159);class qy{constructor(b,h,r,z,R,ba,ta){this.Zf=b;this.characterPropertiesEditor=h;this.$V=r;this.t8e=z;this.Nj=R;this.Qd=ba;this.LLa=ta}K5l(b,h){var r;b=h.view;h=h.vk;if(!h||!this.Zf.uci(h,!0)||this.t8e&&this.t8e.instance&&this.t8e.instance.HT(h))return 2;var z=qy.nba?!qy.xI.cma(h):!0;this.$V&&z&&this.$V.ehc(h.node,wb.a.es,h.cpBegin);z=h.node;
(null===(r=this.LLa)||void 0===r?0:r.replaceText)&&this.LLa.wDb(z)?(r=z.qa.oXa(h.cpBegin),this.LLa.replaceText(z,r,r,jr.a.MQc)):this.characterPropertiesEditor.Uea(h,R=>new jr.a(R));if(this.Qd.ng){r=new yf.GraphTransaction(15);try{r.Db(h.node),this.Nj.Zna(h.node,h.cpBegin,h.cpBegin+1,1)}finally{r&&r.dispose()}}z=h.node;r=h.cpEnd+1;" "===ie.ParagraphReader.text(z).charAt(r)&&(z=Qe.a.createTextRange(z,r,r+1),this.characterPropertiesEditor.replaceTextRange(z,"\u00a0"));h=Qe.a.Uc(h.node,r);b.Cb.setSelection(Hf.SelectionFactory.eo(h));
return 32}static get xI(){return null!=qy.dlg?qy.dlg:qy.dlg=Sa.a.instance.resolve("Box4.IHyperlinkStrategy")}static get nba(){null==qy.Z0&&(qy.Z0=t.AFrameworkApplication.K?t.AFrameworkApplication.K.$("SplitHyperlinkFixWithEnterIsEnabled"):!1);return qy.Z0}}qy.Z0=null;Object(n.a)(qy,"InsertLineBreakStrategy",null,[]);class ou{static get Wg(){return null!=ou.wog?ou.wog:ou.wog=Sa.a.instance.resolve("Box4.IOutlineElementEditor")}static get Tg(){return sm.ContextSetEditor.instance}static get Nj(){return null!=
ou.Grg?ou.Grg:ou.Grg=Sa.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance}static get Qd(){return null!=ou.ksg?ou.ksg:ou.ksg=Sa.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance}static h6l(b,h,r,z,R){if(R&&R.hasProperty(od.a.targetObject)){var ba=h.view.rd.Lc.Eb(R.getValue(od.a.targetObject));ba=Qe.a.create(ba)}else ba=ou.Tg.uS(h.vk,11);if(!ba)return 8;b=t.AFrameworkApplication.ya.Qf(ba,b,r,!0,z,R);if(32===b&&2===r){if(!h.view.ze)return 2;h=h.view;z=
h.Cb.Rg;if(z=ou.Tg.uS(z,11)){r=new eg.a;r.set(z.node);r.vd();if(R&&R.hasProperty(od.a.targetObject))for(R=R.Og(od.a.targetObject);!r.currentNode.id.equals(R)&&r.mc()&&(ag.OutlineElementNavigator.Zd(r),11===r.Qe););ag.OutlineElementNavigator.R2(r,!1,!1);R=Xd.SelectionEditor.GAa(r,!0);R=ie.ParagraphReader.xu(R)?Hf.SelectionFactory.xe(R,0):Hf.SelectionFactory.jr(R);h.Cb.setSelection(R)}}return b}static HMd(b,h,r,z,R){b=b===Fb.a.DMc;h=h.node;if(R&&R.hasProperty(od.a.targetObject)&&!h.id.equals(R.Og(od.a.targetObject)))return 2;
if(1===r)return 32;r=new Nd.GraphIterator;r.set(h);r.Bb(10);ou.Wg.eD(r,b,!0);ou.Qd.ng&&(r=ag.OutlineElementNavigator.De(r),ou.Nj.XJb(r,1));return 32}}Object(n.a)(ou,"InsertOutlineElementStrategy",null,[]);class eB{constructor(b,h,r,z,R,ba,ta,Wa,ub,Ib){this.bY=h;this.DCj=b;this.Gw=ba;this.uG=R;this.Kh=r;this.BAj=z;this.Ok=ta;this.ib=Wa;this.kA=ub;this.klc=Ib}gLm(b,h,r,z,R){if(!h.view.ze)return 2;h=h.view;let ba=null;h.wi&&(ba=h);const ta=h.Cb.Rg;var Wa=!0;let ub=!1,Ib=null;if(!ta)return 2;const $b=
new yf.GraphTransaction(15);$b.Db(h.rd);let fc=null;2===r&&(fc=new eg.a,fc.set(ta.node),fc.vd(),Ib=new xy.a(fc),ag.OutlineElementNavigator.Zd(fc),Wa=vg.OutlineElementReader.isEmpty(fc,!1),{d3i:Wa,Blj:ub}=this.BAj.e3i(fc,Wa,ao.a.GAb,-1,ta));b=t.AFrameworkApplication.ya.Qf(ta,b,r,!1,z,R);Wa&&32===b&&2===r&&(ub||ag.OutlineElementNavigator.RCa(fc,!1,!Xd.SelectionEditor.xf(ta),!1),ub&&Ib&&Ib.restore(fc),this.Gw.freeze(),(r=Hf.SelectionFactory.wo(fc.currentNode,!0))||v.ULS.sendTraceTag(591958035,324,15,
"could not create selection for NewLineView."),h.Cb.setSelection(r),this.Gw.MEa(),this.DCj.xi.EF());ba&&(Wa||ba.Waa(),ba.editingView&&ba.aO&&(ba.editingView.qH=!0));cs.GrippersManager.instance.kMb(1);$b.dispose();return b}VB(b,h,r){b=!1;if($d.ImageReader.Q$(h)||$d.ImageReader.WZa(h))h=this.GFk(h),b=!0;const z=h;if((h=Xd.SelectionEditor.xf(h))&&this.Ok.yh&&!this.Ok.Egm(z))return 2;if(1===r)return 32;const R=z.node,ba=new Nd.GraphIterator;ba.set(R);ba.vd();ag.OutlineElementNavigator.Zd(ba);r=new yf.GraphTransaction(15);
r.Ou(ba);h?(this.klc.instance&&this.klc.instance.bFa(z),ie.ParagraphReader.nc(R)&&z.cpBegin===ie.ParagraphReader.textLength(R)&&Md.m(z)&&9===ie.ParagraphReader.dBa(R)&&this.Gw.BGk(z),this.uG.uYf(ba,!0,z,R),mc.ListReader.ai(ba)&&!vg.OutlineElementReader.isEmpty(ba,!1)&&(h=ie.ParagraphReader.en(ba.currentNode))&&h.qa&&!h.qa.last.formatting&&eB.characterPropertiesEditor.GKa(h),this.bY&&this.bY.ehc(R,wb.a.es,z.cpBegin),b&&(ag.OutlineElementNavigator.Vr(ba,!1,!1),b=ba.Rb(2),(b=this.kA.xe(b,0))&&this.ib.setSelection(b))):
this.Kh.eD(ba,!0,!0);r.dispose();vb.App.xa&&vb.App.xa.updateCommandUI();return 32}GFk(b){if($d.ImageReader.Q$(b))var h=Qe.a.Uc(b.node,b.cpBegin);else{h=ie.ParagraphReader.xP(b.node);var r=h.properties.Og(yc.a.Hq);b=b.node.properties.getValue(yc.a.runId);r=eB.Pcf(b,r,h.qa);h=Qe.a.Uc(h,r)}return h}static get characterPropertiesEditor(){return null!=eB.$gg?eB.$gg:eB.$gg=Sa.a.instance.resolve("Box4.ICharacterPropertiesEditor")}static x9e(b,h){let r=0;for(;r<h.length&&!(b<h[r]);)r++;return r}static Pcf(b,
h,r){let z=0;b=eB.x9e(b,h);let R=0;if(b===h.length)R=r.length-1;else for(;R<r.length;){h=r.J(R);if(h.formatting&&h.formatting.Ee===b)break;R++}R<r.length&&(z=r.J(R).cp);return z}}Object(n.a)(eB,"NewLineStrategy",null,[]);class SB{constructor(b,h,r,z,R,ba,ta,Wa,ub,Ib,$b,fc,Kc,ed,Jd,ge){this.wm=null;this.pja=b;this.G$c=ta;this.xgd=new eB(this,h,r,z,R,ba,Wa,$b,fc,Jd);this.fJg=new qy(Wa,ub,h,Ib,Kc,ed,ge)}get xi(){return this.wm||(this.wm=this.pja())}Vb(){const b=t.AFrameworkApplication.ya,h=Object(u.a)(this.xgd,
this.xgd.VB,"newLine");b.gb(Fb.a.enter,kc.a.view,Object(u.a)(this.G$c.value,this.G$c.value.T3k,"enterView"),1124);b.gb(Fb.a.i2i,kc.a.view,Object(u.a)(this.G$c.value,this.G$c.value.VRn,"shiftEnterView"),1124);b.pa(Fb.a.VB,kc.a.view,Object(u.a)(this.xgd,this.xgd.gLm,"newLineView"));b.pa(Fb.a.VB,kc.a.Wc,h);b.pa(Fb.a.VB,kc.a.image,h);b.pa(Fb.a.VB,kc.a.Gd,h);b.pa(Fb.a.VB,kc.a.anchoredObject,h);b.pa(Fb.a.VB,kc.a.embeddedFile,h);b.pa(Fb.a.VB,kc.a.ink,h);b.pa(Fb.a.VB,kc.a.paragraph,h);b.pa(Fb.a.VB,kc.a.iFrame,
h);b.pa(Fb.a.VB,kc.a.unsupportedObject,h);b.Vc(Fb.a.VB,1124);b.gb(Fb.a.EMd,kc.a.view,Object(u.a)(this.fJg,this.fJg.K5l,"insertLineBreakView"),1028);b.pa(Fb.a.DMc,kc.a.view,ou.h6l);b.pa(Fb.a.DMc,kc.a.outlineElement,ou.HMd);b.Vc(Fb.a.DMc,1092)}static get instance(){return null!=SB.jmg?SB.jmg:SB.jmg=SB.Gl()}static Gl(){return new SB(()=>Sa.a.instance.resolve("Box4.IUndoManager"),Sa.a.instance.Pa("Box4.IAutoCorrectScheduler"),Sa.a.instance.resolve("Box4.IOutlineElementEditor"),Sa.a.instance.resolve("Box4.List.ICursorMovementValidator"),
Sa.a.instance.resolve("Box4.List.IListEditor"),Sa.a.instance.resolve("Box4.IInsertionPointFormatting"),Sa.a.instance.ef("Box4.Actors.IEnterViewStrategy"),Yh.a.instance,Sa.a.instance.resolve("Box4.ICharacterPropertiesEditor"),Sa.a.instance.Za("Box4.IExternalSelectionManager"),di.a.instance,Sa.a.instance.resolve("Box4.ISelectionFactory"),Sa.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance,Sa.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,Sa.a.instance.Za("Box4.IContentControlConverter"),
Sa.a.instance.resolve("Box4.IBox4GraphWriter"))}}Object(n.a)(SB,"EnterActor",null,[]);var RF=d(1373),SF=d(685);class kk{static get paragraphEditor(){return null!=kk.dpg?kk.dpg:kk.dpg=Sa.a.instance.resolve("Box4.IParagraphEditor")}static get NX(){return null!=kk.sqg?kk.sqg:kk.sqg=Sa.a.instance.Pa("Box4.ISpacingCommands")}static get SKb(){return null!=kk.Dqg?kk.Dqg:kk.Dqg=Sa.a.instance.Pa("Box4.Styles.IWACStyleReader")}static get WT(){return null!=kk.yng?kk.yng:kk.yng=Sa.a.instance.Pa("Box4.ILineSpacingHelper")}static get Nj(){return null!=
kk.Org?kk.Org:kk.Org=Sa.a.instance.Pa("Box4.TrackChange.ITrackChangeEditor")}static get Qd(){return null!=kk.osg?kk.osg:kk.osg=Sa.a.instance.Pa("Box4.TrackChange.ITrackChangeManager")}static get sO(){return Sa.a.instance.Pa("Box4.Settings.SpacingSettings")}static get Nm(){return Sa.a.instance.Pa("WordEditor.ClientPagination.IClientPaginationSettings")}static Vb(){var b,h,r,z;const R=t.AFrameworkApplication.ya;R.pa(Fb.a.zwf,kc.a.view,lm.a.Av);R.Vc(Fb.a.zwf,1028);R.pa(Fb.a.hC,kc.a.view,lm.a.Av);R.pa(Fb.a.hC,
kc.a.paragraph,kk.fsd);R.Vc(Fb.a.hC,1036);if(null===(b=kk.sO)||void 0===b?0:b.Qta)R.pa(Fb.a.Sdc,kc.a.paragraph,kk.Lck),R.pa(Fb.a.Sdc,kc.a.view,lm.a.Av),R.Vc(Fb.a.Sdc,1036);if(null===(h=kk.Nm)||void 0===h?0:h.DCa)R.pa(Fb.a.q_c,kc.a.paragraph,kk.kRe),R.pa(Fb.a.q_c,kc.a.view,lm.a.Av);if(null===(r=kk.Nm)||void 0===r?0:r.DFa)R.pa(Fb.a.S_c,kc.a.paragraph,kk.DRe),R.pa(Fb.a.S_c,kc.a.view,lm.a.Av);if(null===(z=kk.Nm)||void 0===z?0:z.ofa)R.pa(Fb.a.p_c,kc.a.paragraph,kk.jRe),R.pa(Fb.a.p_c,kc.a.view,lm.a.Av);
R.pa(Fb.a.POe,kc.a.view,kk.J9j);R.Vc(Fb.a.POe,1036);R.pa(Fb.a.vSf,kc.a.view,kk.xsn);R.Vc(Fb.a.vSf,1036);R.pa(Fb.a.OOe,kc.a.view,kk.I9j);R.Vc(Fb.a.OOe,1036);R.pa(Fb.a.uSf,kc.a.view,kk.wsn);R.Vc(Fb.a.uSf,1036);R.pa(Fb.a.zPa,kc.a.view,lm.a.Av);R.pa(Fb.a.zPa,kc.a.paragraph,kk.fsd);R.Vc(Fb.a.zPa,1036);R.pa(Fb.a.yPa,kc.a.view,lm.a.Av);R.pa(Fb.a.yPa,kc.a.paragraph,kk.fsd);R.Vc(Fb.a.yPa,1036);R.pa(Fb.a.K9d,kc.a.view,kk.J9d);R.pa(Fb.a.K9d,kc.a.paragraph,kk.J9d);R.Vc(Fb.a.K9d,1028);R.pa(Fb.a.W1f,kc.a.view,
kk.J9d);R.pa(Fb.a.W1f,kc.a.paragraph,kk.J9d);R.Vc(Fb.a.W1f,1028);R.pa(Fb.a.y9d,kc.a.view,lm.a.Av);R.pa(Fb.a.y9d,kc.a.paragraph,kk.ldh);R.Vc(Fb.a.y9d,1028);R.pa(Fb.a.x9d,kc.a.view,lm.a.Av);R.pa(Fb.a.x9d,kc.a.paragraph,kk.ldh);R.Vc(Fb.a.x9d,1028)}static ldh(b,h,r,z,R){if(1===r)return 32;b===Fb.a.y9d?b=Fb.a.zPa:b===Fb.a.x9d&&(b=Fb.a.yPa);return kk.fsd(b,h,r,z,kk.X2m(R))}static X2m(b){var h=b.indexOf(",");const r=b.substring(0,h);b=b.substring(h+1,b.length);h=new RF.a;h.value=parseFloat(r);h.unit=parseInt(b);
return h}static J9d(b,h,r,z,R){if(2===r){h=R[Cc.a.Text];r=R[Cc.a.Number];R=R.Increment;z=new RF.a;let ba=!1;""===h||R&&h===Box4Intl.Box4Strings.L_SpinnerAuto?(z.value=0,z.unit=vb.App.x6?2:4,ba=!0):r||R||(z.value=0,z.unit=1,ba=!0);ba&&(t.AFrameworkApplication.ya.Xb(b===Fb.a.K9d?Fb.a.zPa:Fb.a.yPa,2,z),vb.App.xa.updateCommandUI())}return 32}static fsd(b,h,r,z,R){if(!({Gx:r}=lm.a.n_f(r,h)).returnValue)return r;h=h.node;switch(b){case Fb.a.hC:kk.paragraphEditor.hC(h,new SF.a(2,R));break;case Fb.a.zPa:b=
new SF.a(R.unit,R.value);kk.paragraphEditor.xJb(h,b);break;case Fb.a.yPa:b=new SF.a(R.unit,R.value),kk.paragraphEditor.uJb(h,b)}z&&pc.a.Clb&&(z.Lr|=pc.a.xdb(h));return 32}static J9j(b,h,r){if(1===r)return 32;v.ULS.sendTraceTag(588394561,340,50,"Add Space Before Paragraph option is clicked");b=kk.GZh(h);if(!b)return v.ULS.sendTraceTag(588367186,3018,10,"No style applied on the paragraph"),8;b=(b=b.ia(yc.a.zj,240)/20)?b:kk.xRk;kk.NX.Mga(1,b,4);return 32}static xsn(b,h,r){if(1===r)return 32;v.ULS.sendTraceTag(588394562,
340,50,"Remove Space Before Paragraph option is clicked");kk.NX.Mga(1,0,4);return 32}static I9j(b,h,r){if(1===r)return 32;v.ULS.sendTraceTag(588394563,340,50,"Add Space After Paragraph option is clicked");b=kk.GZh(h);if(!b)return v.ULS.sendTraceTag(588367187,3018,10,"No style applied on the paragraph"),8;b=b.ia(yc.a.ra,240)/20;kk.NX.Mga(0,b?b:12,4);return 32}static wsn(b,h,r){if(1===r)return 32;v.ULS.sendTraceTag(588394564,340,50,"Remove Space After Paragraph option is clicked");kk.NX.Mga(0,0,4);
return 32}static kRe(b,h,r,z,R){if(2==r){if("boolean"!==typeof R)return 16;b=h.node;h=null;xg.a.instance.J(3)&&(h=b.Kz());kk.paragraphEditor.kRe(b,R);h&&kk.Nj.nM(b,h,kk.Qd.ng)}return 32}static DRe(b,h,r,z,R){if(2==r){if("boolean"!==typeof R)return 16;b=h.node;h=null;xg.a.instance.J(3)&&(h=b.Kz());kk.paragraphEditor.DRe(b,R);h&&kk.Nj.nM(b,h,kk.Qd.ng)}return 32}static jRe(b,h,r,z,R){if(2==r){if("boolean"!==typeof R)return 16;b=h.node;h=null;xg.a.instance.J(3)&&(h=b.Kz());kk.paragraphEditor.jRe(b,R);
h&&kk.Nj.nM(b,h,kk.Qd.ng)}return 32}static Lck(b,h,r,z,R){if(2==r){if("boolean"!==typeof R)return 16;b=new Map;b.set("Value",R.toString());Ca.Health.instance.recordKpiUsage(zi.a.gQc.E9n,0,zi.a.EB,b);h=h.node;b=null;xg.a.instance.J(3)&&(b=h.Kz());h.hasProperty(yc.a.Ut)&&h.removeProperty(yc.a.Ut);kk.WT.YEd(h)!==R&&h.setValue(yc.a.Ut,R);(R=kk.WT.TGd(h,!0))&&R.gk(4,!0);(R=kk.WT.TGd(h,!1))&&R.gk(4,!0);b&&kk.Nj.nM(h,b,kk.Qd.ng)}return 32}static GZh(b){b=b.view;return b.ze&&(b=b.Cb)&&b.hb.kb?kk.SKb.yo(b.hb.kb.Qa.node):
null}}kk.xRk=12;Object(n.a)(kk,"SpacingActor",null,[]);class CI{process(){}}Object(n.a)(CI,"NoOpFormattingViewOperationFinishedStageProcessor",null,[41]);class DI{constructor(b){this.mg=b}nKn(b,h){this.mg.p_(b,h.cache.WG);this.mg.Sv(b,h.cache.fontSize)}ALa(){return null}fBa(){return null}J3b(){return null}mT(){return null}}Object(n.a)(DI,"FormattingStewardBridge",null,[43]);class EI{yc(b){b.ha("Box4.Actors.IFormattingViewOperationFinishedStageProcessor",()=>new CI).singleInstance();b.ha("Box4.Actors.IFormattingStewardBridge",
()=>new DI(b.resolve("Box4.IFormattingEditor"))).singleInstance()}}Object(n.a)(EI,"WoncaActorsConfiguration",null,[2]);class FI{constructor(b,h,r,z,R,ba,ta,Wa){this.ga=b;this.Ixj=h;this.Hxj=r;this.twg=z;this.lQj=R;this.kid=ba;this.qQj=ta;this.rQj=Wa}get zc(){return this.ga}fkk(b){this.zc.tna(b,this.Ixj,null,null)}dkk(b){this.zc.tna(b,this.Hxj,null,null)}C1(b,h,r){r?this.zc.tna(b,this.twg,h,null):this.zc.Xb(this.twg,2,h)}w3m(b,h){this.zc.tna(b,this.kid,h,null)}b7(b,h){this.zc.tna(b,this.qQj,h,null)}Tib(b,
h){this.zc.tna(b,this.rQj,h,null)}OKf(b,h=!1){const r=new Ei.DictionaryPropertySet;r.setValue(od.a.hU,b);r.setValue(od.a.fEi,!0);r.setValue(od.a.f_a,h);this.zc.Xb(this.lQj,2,r)}}Object(n.a)(FI,"ClipboardCommands",null,[1420]);class GI{}Object(n.a)(GI,"NoOpEdgeSystemClipboardSelectionEnsureStrategy",null,[1336]);class HI{constructor(b){this.ga=b}get zc(){return this.ga}u_i(b,h,r){let z=0;b?1===b&&(z=Fb.a.CZa):z=Fb.a.BZa;b=new dz.a;b.unit=r;b.value=h;this.zc.Xb(z,2,b)}t7d(b,h,r){let z=0;1===b?z=Fb.a.RJb:
2===b?z=Fb.a.ukb:b||(z=Fb.a.SJb);b=new dz.a;b.unit=r;b.value=h;this.zc.Xb(z,2,b)}}Object(n.a)(HI,"IndentationCommands",null,[1359]);var LE;(function(b){b[b.unspecified=-1]="unspecified";b[b.none=0]="none";b[b.left=1]="left";b[b.center=2]="center";b[b.right=3]="right";b[b.inner=4]="inner";b[b.outer=5]="outer";b[b.both=6]="both";b[b.distribute=7]="distribute";b[b.margin=8]="margin";b[b.highKashida=9]="highKashida";b[b.lowKashida=10]="lowKashida";b[b.mediumKashida=11]="mediumKashida";b[b.numTab=12]=
"numTab";b[b.thaiDistribute=13]="thaiDistribute";b[b.start=14]="start";b[b.end=15]="end"})(LE||(LE={}));Object(n.b)("Justification",LE);class II{constructor(b){this.CHa={};this.ga=b;this.D1l()}get zc(){return this.ga}sD(b){b=this.CHa[LE[b]];void 0!==b&&null!==b&&this.zc.processAction(b,2)}D1l(){this.CHa.left=Fb.a.leftJustify;this.CHa.center=Fb.a.centerJustify;this.CHa.right=Fb.a.rightJustify;this.CHa.both=Fb.a.fullJustify;this.CHa.lowKashida=Fb.a.hEb;this.CHa.mediumKashida=Fb.a.hEb;this.CHa.highKashida=
Fb.a.hEb;this.CHa.distribute=Fb.a.lEc;this.CHa.thaiDistribute=Fb.a.N_c}}Object(n.a)(II,"JustificationCommands",null,[1355]);class JI{constructor(b){this.ga=b}hC(b){this.ga.Xb(Fb.a.hC,2,b)}Sdc(b){this.ga.Xb(Fb.a.Sdc,2,b)}q_c(b){this.ga.Xb(Fb.a.q_c,2,b)}S_c(b){this.ga.Xb(Fb.a.S_c,2,b)}p_c(b){this.ga.Xb(Fb.a.p_c,2,b)}Mga(b,h,r){this.ga.Xb(b?Fb.a.zPa:Fb.a.yPa,2,Object.assign(new RF.a,{value:h,unit:r}))}}Object(n.a)(JI,"SpacingCommands",null,[1243]);class KI{constructor(b,h,r){this.zc=b;this.NEc=h;this.m0k=
r;this.JZm=(z,R,ba)=>{if(1===ba)return this.NEc.Ija?32:8;this.NEc.btm();this.m0k().VWn(this.NEc.Aql());return 32}}Vb(){this.zc.gb(Fb.a.yib,kc.a.application,this.JZm,1028)}}Object(n.a)(KI,"EditorSettingsUIActor",null,[]);class LI extends Wc.a{constructor(b,h){super(!1,!1,!0);this.o0k=b;this.gNa=h;this.n0k=r=>{1!==r?v.ULS.sendTraceTag(527434075,340,50,"Editor Settings closed without changes"):(this.o0k.qgo(),v.ULS.sendTraceTag(578869131,340,50,"Editor Settings updated"))}}VWn(b){Object(Ht.__awaiter)(this,
void 0,void 0,function*(){var h=yield this.gNa.DEb;h={["id"]:"SettingsDialog",["uiLanguage"]:t.AFrameworkApplication.uiCulture,["selectedLanguage"]:Sj.a.pg(t.AFrameworkApplication.lcid).name,["isGoalActive"]:!1,["isSubscription"]:h.QPc,["editorSettings"]:b};this.Wh(Box4Intl.Box4Strings.l_EditorSettings,this.n0k,h);v.ULS.sendTraceTag(578091235,340,50,"Editor settings dialog is opened.")})}}Object(n.a)(LI,"EditorSettingsDialog",Wc.a,[]);class MI{constructor(b,h,r,z,R,ba,ta,Wa,ub,Ib,$b,fc,Kc,ed){this.isb=
this.mtc=this.mOb=null;this.QHe=0;this.Dte=!1;this.sa=new Te.a;this.JOd=!1;this.yqb=null;this.iS=b;this.Gw=h;this.mg=r;this.su=z;this.fb=R;this.uG=ba;this.Cf=ta;this.Vd=Wa;this.Ok=ub;this.Ac=Ib;this.Hd=$b;this.Ym=fc;this.HV=Kc;this.BC=ed}get M1k(){return this.Ac?this.Ac.isFeatureEnabled(41):!!t.AFrameworkApplication.K&&t.AFrameworkApplication.K.$("Box4EndOfParagraphFormattingIsEnabled")}get U$e(){return null!=this.hkg?this.hkg:this.hkg=Sa.a.instance.resolve("Box4.IFormatPainterStrategy")}get mQ(){return this.Dte}set mQ(b){this.Dte!==
b&&(this.Dte=this.JOd=b,this.sa.raiseEvent("FormatPainterBrushActiveStatusChanged"))}D6j(b){this.sa.addHandler("FormatPainterBrushActiveStatusChanged",b)}rLf(b){const h=b.Qa;v.ULS.sendTraceTag(22832028,354,50,"Picked format from context: {0}",h.contextId);this.reset();var r=h.node;b=this.Sei(b);if(this.U$e.VTn(h.contextId,b))try{this.isb=this.fb.GYa(r)}catch(z){throw v.ULS.sendTraceTag(22832029,354,10,"GetParagraphProperties error: {0}",z.message),z;}this.mtc=this.BC.yo(r);r=Aj.FormattingReader.Pr(h);
r.an&&(this.mOb=Object(la.a)(Jj.a,r.an.clone()));this.QHe=b?kc.a.paragraph:h.contextId}asd(b){if(b){const z=this.Sei(b);if(this.GOd)if(b=b.BN().Vy(),null===b||void 0===b?0:b.vl)this.Y$a(b,z);else if(0==(null===b||void 0===b?void 0:b.length))v.ULS.sendTraceTag(529089953,354,50,"Attempt to apply format to non-graph-node context: {0}",b);else{if(b)for(var h=0;h<b.length;h++){var r=b.getContext(h);if(null===r||void 0===r?0:r.Xw){if(r)for(let R=0;R<r.length;R++)b.addContext(r.getContext(R))}else(null===
r||void 0===r?0:r.vl)?this.Y$a(r,z):v.ULS.sendTraceTag(529089954,354,50,"Attempt to apply format to non-graph-node context: {0}",r.contextId)}}else for(h=0;h<b.length;h++)r=b.J(h),(null===r||void 0===r?0:r.vl)?this.Y$a(r,z):v.ULS.sendTraceTag(22832068,354,50,"Attempt to apply format to non-graph-node context: {0}",r.contextId)}}Lch(b,h){if(h){var r=b.node,z=r.qa.last,R=this.Vd.GKa(r),ba=R.Yf(R.Ob);this.Mch(R,h,null);xg.a.instance.J(3)&&this.Ym.CJb(r,z,b.cpBegin,b.cpEnd,ba,R,this.Hd.ng)}}Zck(b,h,r){if(h||
r)0<Md.g(b).length&&v.ULS.sendTraceTag(22832071,354,50,"User tried to apply format on Blob objects"),this.HV.s1(b,z=>{this.Mch(z,h,r)})}Mch(b,h,r){var z,R,ba,ta;this.mg.Wja(b);b.an&&b.an.removeProperty(We.a.highlight);this.mg.RWe(b);if(r){let Wa=r.$h();if(null===(z=t.AFrameworkApplication.K)||void 0===z?0:z.$("StylesFlatteningCrashFixIsEnabled"))Wa=uj.a.Xta(r)?null===(ta=null===(ba=null===(R=this.BC)||void 0===R?void 0:R.Kp())||void 0===ba?void 0:ba.zW(Wa))||void 0===ta?void 0:ta.clone():Wa.clone(),
Wa.Qg(...Zl.a.aH());this.Cs(b,Wa)}this.Cs(b,h)}Cs(b,h){var r;if(h){var z=b.paragraph.Lc;if(z){var R=b.an;R=R?Object(la.a)(ix.a,R.clone()):Jj.a.Fza(1179725);for(const ta of h.Mj())if(ta!==yc.a.Hx&&ta!==yc.a.fieldInstruction&&ta!==We.a.IA&&ta!==We.a.z6&&ta!==yc.a.Mfb&&ta!==We.a.pE&&ta!==yc.a.languageHint&&ta!==yc.a.noProof){if(ta===Ij.a.tB){var ba=h.ia(Ij.a.tB,E.a.nil);if(ba!==E.a.nil)if(ba=z.Eb(ba)){if(ba=new uA.a(ba),ba=this.BC.zF(ba),ba===Box4Intl.Box4Strings.L_StyleWordHyperlink)if(ba=this.BC.Qx(b.paragraph).eta(ba)){(null===
(r=t.AFrameworkApplication.K)||void 0===r?0:r.$("StylesFlatteningCrashFixIsEnabled"))?R.eI(ba.$h(),...Zl.a.aH()):R.Cs(ba.$h());continue}else v.ULS.sendTraceTag(589345875,354,50,"Applied Hyperlink style on formatting is not present in Style Set")}else v.ULS.sendTraceTag(589345876,354,50,"Applied character style on formatting is not present in Object Space")}R.setValue(ta,h.Og(ta))}R.lma?h=z.QQ(R,!0):(z.Ku(R),h=R);b.Bj=h.id}}}Sei(b){return!b.eE&&b.Tc.contextId!==kc.a.endOfParagraph}reset(){this.isb=
this.mtc=this.mOb=null;this.QHe=kc.a.none}Y$a(b,h){if(b.contextId===kc.a.Wc||b.contextId===kc.a.Gd)var r=this.Ok.T$(b);else if(b.contextId===kc.a.paragraph)r=this.Ok.GPd(b);else if(b.contextId===kc.a.endOfParagraph)r=this.Ok.qOd(b);else{v.ULS.sendTraceTag(22832033,354,50,"Skipped applying format to context: {0}",b.contextId);return}v.ULS.sendTraceTag(22832034,354,50,"Applied format to context: {0}",b.contextId);if(r)v.ULS.sendTraceTag(22832035,354,50,"Tried format painting to locked context. Skipped.");
else{r=Object(la.a)(dd.AParagraphNode,b.node);var z=!1;r&&(z=b.contextId===kc.a.Gd&&!!r&&!b.cpBegin&&b.cpEnd===this.fb.textLength(r));if(h=this.U$e.fSn(this.QHe,b.contextId,h,z))try{ie.ParagraphReader.nc(r)?(this.mtc&&this.iS.oM(this.mtc,r,!0),this.su.cdh(r,this.isb)):v.ULS.sendTraceTag(22832064,354,50,"Tried to apply paragraph style and properties to non-paragraph node: {0}",b.node.type)}catch(R){throw v.ULS.sendTraceTag(22832065,354,10,"ApplyParagraphProperties error: {0}",R.message),R;}z=b;b.contextId===
kc.a.paragraph?z=Qe.a.createTextRange(r,0,ie.ParagraphReader.textLength(r)):b.contextId===kc.a.Wc&&(z=this.Gw.Chf(b),z=di.a.sxb(z));if(z&&z.contextId===kc.a.Gd)try{this.Zck(z,this.mOb,h?null:this.mtc)}catch(R){throw v.ULS.sendTraceTag(22832066,354,10,"ApplyFormattingsToTextRange error: {0}",R.message),R;}if(b.contextId===kc.a.paragraph||b.contextId===kc.a.endOfParagraph){h=new Nd.GraphIterator;h.set(r);h.vd();h.kd(11);z=mc.ListReader.ai(h);const R=!ie.ParagraphReader.textLength(r);v.ULS.sendTraceTag(22832067,
354,50,"Applied format to EOP: InList - {0}, IsEmpty - {1}.",z,R);z?(this.Cf.jD(h),h=h.currentNode,this.Cf.V$(h)&&(Ki.a.ae.RL?this.Lch(b,this.mOb):this.uG.Z6d(h,r,this.mOb))):this.M1k&&this.Lch(b,this.mOb)}}}get GOd(){null==this.yqb&&(t.AFrameworkApplication.Hf("0b2ac141;84eff841"),this.yqb=t.AFrameworkApplication.K?t.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.IsFormatPainterBugFixFlightEnabled",!1):!1);return this.yqb}}Object(n.a)(MI,"FormatPainter",null,[1389]);var aM=
d(123);class TB{constructor(b,h,r,z,R,ba,ta,Wa=!1,ub,Ib,$b){this.ged=!1;this.iqe=new rr.a;this.yqb=null;this.dTl=()=>{this.tJ.mQ=!1;return 32};this.eTl=(fc,Kc,ed)=>{fc=!1;if(Kc=this.zC.Isa){switch(Kc.contextId){case kc.a.Gd:case kc.a.paragraph:case kc.a.endOfParagraph:case kc.a.Wc:fc=!0}fc&&Xd.SelectionEditor.Ek(Kc)&&Md.b(Kc)&&(this.ld.Zb(Sc.a.Sm,{["Reason"]:Xc.a.VBc}),fc=!1);fc&&ie.ParagraphReader.UW(Kc)&&(this.ld.Zb(Sc.a.Sm,{["Reason"]:Xc.a.uN}),fc=!1)}if(1===ed||!fc)return fc?32:8;6!==this.ga.IG?
(this.tJ.mQ?v.ULS.sendTraceTag(22832076,354,50,"User deactivated the Format Painter button"):(v.ULS.sendTraceTag(22832075,354,50,"User activated the Format Painter button"),this.tJ.rLf(this.zC.kb),this.ged||(this.Eh.oVa(this.Egj),(ed=this.Eh.jb.wv)&&ed.wi&&ed.V9g(this.Dgj),this.ged=!0)),this.tJ.mQ=!this.tJ.mQ):(v.ULS.sendTraceTag(22832077,354,50,"User picked format from keyboard shortcut"),this.tJ.rLf(this.zC.kb),this.tJ.mQ=!1);return 32};this.cTl=(fc,Kc,ed,Jd,ge)=>{if(6===this.ga.IG||this.tJ.mQ){v.ULS.sendTraceTag(22832078,
354,50,"User applied the Format Painter from command location: {0}",this.ga.IG);fc=this.Eh.jq.hg("UserAction","FormatPainterApply");if(TB.Qb&&TB.Qb.Vx(123)){ge=ge?ge.KeepBrushActive:!1;ed=null;this.zC.kb&&2===this.zC.kb.trigger&&(ge=ge||this.tJ.JOd,this.tJ.JOd&&Xd.SelectionEditor.Qm(this.zC.kb)&&(ed=Xd.SelectionEditor.X1(this.zC.kb.Qa,!1)))&&(ed.trigger=2);this.tJ.JOd=!1;if(ge||2!==this.zC.kb.trigger)Kc=new yf.GraphTransaction(15),ed&&ed.Qa?(Kc.set(ed.Qa.node.Qi),this.ib.setSelection(ed)):Kc.set(this.zC.D1b.Qi),
ed=this.GOd?Hf.SelectionFactory.eo(this.ib.Rg):this.zC.kb,this.tJ.asd(ed),Kc.dispose();this.tJ.mQ=ge}else ge=new yf.GraphTransaction(15),ge.set(this.zC.D1b.Qi),Kc=this.GOd?Hf.SelectionFactory.eo(this.ib.Rg):this.zC.kb,this.tJ.asd(Kc),this.tJ.mQ=!1,ge.dispose();fc.stop()}return 32};this.Egj=()=>{this.PYd(this.tJ.mQ)};this.Dgj=()=>{this.PYd(this.tJ.mQ)};this.Eh=b;this.Wb=h;this.ga=r;this.ld=z;this.zC=R;this.tJ=ba;this.ib=ta;this.FIj=Wa;this.$v=ub;this.Hw=Ib;this.JAj=$b}get nFg(){return X.a.Ys||X.a.bQd?
"url("+this.jRh()+"), pointer":'url("'+this.jRh()+'"), pointer'}jRh(){return this.Hw?this.$v.Vsa(il.a.Sh("FormatPainterText.cur"),il.a.Sh("FormatPainterTextDarkMode.cur"),new aM.a(Im.a.b2())):il.a.Sh("FormatPainterText.cur")}Vb(){const b=this.Wb.re(tf.AppFrame.pF);b.bindAction(rc.KeyInputManager.lc(wb.a.u4a,0),Fb.a.S$e);b.bindAction(rc.KeyInputManager.lc(wb.a.Umb,6),Fb.a.ODd);this.FIj||b.bindAction(rc.KeyInputManager.lc(wb.a.Xmb,6),Fb.a.UXa);this.ga.gb(Fb.a.ODd,kc.a.view,this.eTl,1028);this.ga.gb(Fb.a.UXa,
kc.a.view,this.cTl,1028);this.ga.gb(Fb.a.S$e,kc.a.view,this.dTl,1028);this.tJ.D6j(()=>{this.f9f(this.tJ.mQ)});this.Hw&&this.JAj.frd(()=>{this.PYd(this.tJ.mQ)})}f9f(b){const h=this.Eh.jq.hg("UserAction","FormatPainterUpdateCursor");this.PYd(b);this.Eh.updateCommandUI();h.stop()}Cgj(b,h){for(let r=0;r<b.length;r++)this.Bgj(b[r],h);(b=this.Eh.jb.wv)&&b.ze&&this.Bgj(b.Ug.editingElement,h)}Bgj(b,h){b.style.cursor=h?this.nFg:""}PYd(b){const h=document.querySelectorAll(".OutlineElement");if(1<h.length){const r=
h[h.length-2].style.cursor===this.nFg;if(this.Eh.jb.isEditingAllowed||this.Eh.jb.Xx){if(b&&!r||!b&&r)this.Cgj(h,b),this.$gj(b);b||!this.ged||this.iqe.count||(this.Eh.UOi(this.Egj),(b=this.Eh.jb.wv)&&b.wi&&b.trn(this.Dgj),this.ged=!1)}else r&&(this.Cgj(h,!1),this.$gj(!1))}}$gj(b){const h=this.Eh.jb.wv;h&&(b?this.iqe.add(h.rd.vn):this.iqe.remove(h.rd.vn))}static get Qb(){return null!=TB.jjg?TB.jjg:TB.jjg=Sa.a.instance.Pa("Box4.IFeatureHelper")}get GOd(){null==this.yqb&&(t.AFrameworkApplication.Hf("0b2ac141;84eff841"),
this.yqb=t.AFrameworkApplication.K?t.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.IsFormatPainterBugFixFlightEnabled",!1):!1);return this.yqb}}Object(n.a)(TB,"FormatPainterActor",null,[]);class ry{constructor(b,h,r){this.Hm=r}T3k(b,h,r,z,R){var ba;if(!({ve:r,selected:ba,Gx:ub}=this.n3i(h,r,!1)).returnValue)return ub;mf.a.mark(5013);var ta=ry.Tg.rP(ba);for(var Wa=0;Wa<ta.length;++Wa){if(!ta[Wa].Rd)continue;const Ib=ta[Wa].iterator;Ib.qo();if(Ff.OutlineReader.xw(Ib))return this.HEh(r,
Ib)}ta=this.Yql();if(ba.Xw||Xd.SelectionEditor.Ek(ba)||ie.ParagraphReader.gm(ba)&&!Xd.SelectionEditor.v6(ba)){if(ry.Qb&&ry.Qb.isFeatureEnabled(23)&&sm.ContextSetEditor.instance.f1f(ba).returnValue)return 8;var ub=this.IEh(h,r,b,z,R,ta)}else if(Xd.SelectionEditor.uk(ba))ub=this.GEh(h,r,b,z,R,ta);else if(Xd.SelectionEditor.xf(ba)){ub=new Nd.GraphIterator;ub.set(ba.node);ub.Bb(10);Wa=Pg.HyperlinkReader.ZC(ba,!1);if(0<Wa.length){if(!Wa[0].hyperlink)return v.ULS.sendTraceTag(38835461,324,15,"Hyperlink is null. CpBegin: {0}, CpEnd: {1}",
Wa[0].cpBegin,Wa[0].cpEnd),8;vb.App.uzb(Wa[0].hyperlink.url);return 32}Gi.TableCellReader.MZ(ub)&&(Ke.returnToContainingCell(ub),Gi.TableCellReader.ffa(ub)&&(Wa=new Nd.GraphIterator,Wa.fd(ub),Ke.returnToContainingRow(Wa),Ff.OutlineReader.Pz(ub,ba,!1)&&Jm.a.Pci(Wa)&&0>=ba.Fb&&(ta=Fb.a.DMc,Ke.returnToContainingTable(ub),ag.OutlineElementNavigator.Zd(ub),R||(R=new Ei.DictionaryPropertySet),R.lh(od.a.targetObject,ub.currentNode.id))));ub=this.JEh(h,r,b,z,R,ta)}else Xd.SelectionEditor.v6(ba)&&(ub=t.AFrameworkApplication.ya.Qf(h,
Fb.a.VB,2,!1,z,R));mf.a.mark(5014);return ub}n3i(b,h,r){let z=null,R=null;if(1===h)return{returnValue:!1,ve:z,selected:R,Gx:32};if(!b.view.ze)return{returnValue:!1,ve:z,selected:R,Gx:2};z=b.view;return(R=z.Cb.Rg)&&ry.Zf.uci(R,r)?this.Hm&&this.Hm.instance&&this.Hm.instance.HT(R)?{returnValue:!1,ve:z,selected:R,Gx:4}:{returnValue:!0,ve:z,selected:R,Gx:2}:{returnValue:!1,ve:z,selected:R,Gx:2}}VRn(b,h,r,z,R){let ba,ta;if(!({ve:r,selected:ba,Gx:ta}=this.n3i(h,r,!0)).returnValue)return ta;const Wa=ry.Tg.rP(ba);
for(let ub=0;ub<Wa.length;++ub){if(!Wa[ub].Rd)continue;const Ib=Wa[ub].iterator;Ib.qo();if(Ff.OutlineReader.xw(Ib))return this.HEh(r,Ib)}ba.Xw||Xd.SelectionEditor.Ek(ba)?ta=this.IEh(h,r,b,z,R,Fb.a.EMd):Xd.SelectionEditor.uk(ba)?ta=this.GEh(h,r,b,z,R,Fb.a.EMd):Xd.SelectionEditor.xf(ba)?ta=this.JEh(h,r,b,z,R,Fb.a.EMd):Xd.SelectionEditor.v6(ba)&&(ta=t.AFrameworkApplication.ya.Qf(h,Fb.a.VB,2,!1,z,R));return ta}HEh(b,h){b.Cb.setSelection(Hf.SelectionFactory.wo(h.currentNode,!1));return 32}IEh(b,h,r,z,
R,ba){const ta=new yf.GraphTransaction(15);ta.Al=r;ta.Db(h.rd);h=new Ei.DictionaryPropertySet;h.setValue(od.a.pEc,!0);h=t.AFrameworkApplication.ya.Qf(b,Fb.a.SG,2,!0,z,h);32===h&&(h=t.AFrameworkApplication.ya.Qf(b,ba,2,!1,z,R));ta.dispose();return h}GEh(b,h,r,z,R,ba){const ta=new yf.GraphTransaction(15);ta.Al=r;ta.Db(h.rd);h.Cb.setSelection(Xd.SelectionEditor.Pj(h.Cb.hb.J(0),!1,!1));b=t.AFrameworkApplication.ya.Qf(b,ba,2,!1,z,R);ta.dispose();return b}JEh(b,h,r,z,R,ba){const ta=new yf.GraphTransaction(15,
r);ta.Al=r;ta.Db(h.rd);b=t.AFrameworkApplication.ya.Qf(b,ba,2,!1,z,R);ta.dispose();return b}static get Tg(){return sm.ContextSetEditor.instance}static get Zf(){return Yh.a.instance}static get Qb(){return null!=ry.fjg?ry.fjg:ry.fjg=Sa.a.instance.Pa("Box4.IFeatureHelper")}}Object(n.a)(ry,"AEnterViewStrategy",null,[1421]);class NI extends ry{constructor(b,h,r){super(b,h,r)}Yql(){return Fb.a.VB}}Object(n.a)(NI,"EnterViewStrategy",ry,[]);class TF{constructor(b){this.ll=this.transaction=null;this.ve=b;
this.gCc=this.Vn=0}}Object(n.a)(TF,"SelectAllArguments",null,[]);class iA{constructor(b,h,r,z){this.z5k=(R,ba,ta,Wa,ub)=>ba.view.wi?this.zcb(ba,ta,this.P7i):this.OVi(R,ba,ta,Wa,ub);this.GVc=(R,ba)=>ba.Vn?1===ba.Vn?(ba.ve.Cb.q7d(ba.ll,R),ba.Vn=2,!0):2===ba.Vn?(ba.ve.Cb.hb.OWa=ba.ll.OWa,this.xi.EF(),ba.transaction.jEa(R),ba.Vn=3,ba.transaction.dispose(),mf.a.mark(5799),!0):!1:(ba.transaction=this.Hc.Rc(2),ba.transaction.Db(ba.ve.rd),ba.Vn=1,!0);this.OVi=(R,ba,ta)=>{if(1===ta)return 32;if(!ba.view.ze)return 2;
R=ba.view;return R.Cb&&R.Cb.hb&&R.Cb.hb.kb?this.P7i(R).inProgress?1:32:8};this.P7i=R=>{t.AFrameworkApplication.Hl("Microsoft.Office.Web.SessionSettings.IQoETinyWinsSelectAllSettings");this.aue&&R.wi&&v.ULS.sendTraceTag(39098306,324,50,"Progress select all reach top");R=new Bq.a(null,this.F$m,new TF(R));R.ml("SelectAllInOutline");R.run();return R};this.F$m=(R,ba)=>{if(!ba.Vn)return ba.ll=Hf.SelectionFactory.JDn(ba.ve.Cb.hb.kb),ba.transaction=this.Hc.Rc(2),ba.transaction.Db(ba.ve.rd),ba.Vn=1,!0;if(1===
ba.Vn){if(!ba.gCc)return ba.ve.Cb.setSelection(ba.ll.J(0),R),++ba.gCc,!0;if(ba.gCc<ba.ll.length)return ba.ve.Cb.V4j(ba.ll.J(ba.gCc),R),++ba.gCc,!0;ba.Vn=2}return 2===ba.Vn?(ba.ve.Cb.hb.OWa=ba.ll.OWa,this.xi.EF(),ba.transaction.jEa(R),ba.Vn=3,ba.transaction.dispose(),!0):!1};this.cTb=b;this.Lxa=h;this.Hc=r;this.aue=z}get J0m(){return this.cTb}get xi(){return this.Lxa.value}get IDn(){return this.aue?this.z5k:this.OVi}Vb(){const b=t.AFrameworkApplication.ya;b.pa(Fb.a.Kva,Yd.a.frame,iA.p4i);b.pa(Fb.a.ZZf,
Yd.a.frame,iA.p4i);b.gb(Fb.a.zcb,kc.a.view,this.IDn,2);b.gb(Fb.a.rJa,kc.a.view,ke.AFrame.Ag,100);b.gb(Fb.a.HAf,kc.a.view,iA.HAf,4)}zcb(b,h,r){if(1===h)return 32;if(!b.view.ze)return 2;h=b.view;if(!h.Cb)return 8;const z=h.Cb.hb;if(!z||!z.length)return 8;mf.a.mark(5798);vb.App.xa.jb.isEditingAllowed||vb.App.xa.jb.Xx||h.wi?b=Xd.SelectionEditor.Xff(z):(ve.FocusManager.instance().fC(ke.AFrame.Zp),b=Hf.SelectionFactory.PVi(h.rd));if(!b)return 8;this.aue&&!z.OWa&&v.ULS.sendTraceTag(39098305,324,50,"Progress selection start");
r&&this.J0m.ggb(Xd.SelectionEditor.jPh(b))?r=r(h):(r=new TF(h),r.ll=b,r=new Bq.a(null,this.GVc,r),r.ml("ExpandSelection"),r.run());return r.inProgress?1:32}static get x2a(){return null!=iA.cqg?iA.cqg:iA.cqg=Sa.a.instance.resolve("Box4.ISelectionContextMenuProvider")}static HAf(b,h,r){if(1===r)return 32;if(!h.view.ze)return 8;b=h.view;h=Hf.SelectionFactory.wo(b.root.graphNode,!0);if(!h)return 8;b.Cb.setSelection(h);return 32}static p4i(){var b=vb.App.xa.jb.wv;if(!b.ze)return 2;if(b.ze&&1!==vb.App.xa.state){mf.a.mark(4668);
var h=b.Cb.hb.kb;if(!h&&t.AFrameworkApplication.K.$("ContextMenuOnSelectionFixIsEnabled"))return 2;h=Xd.SelectionEditor.nza(h);let r=h.x,z=h.y+h.height;if(!b.container)return 8;b=Sys.UI.DomElement.getBounds(b.container);if(h.y<b.y||h.y>b.y+b.height||h.x<b.x||h.x>b.x+b.width)r=b.x,z=b.y;iA.x2a.Kva(new Sys.UI.Point(r,z),1);mf.a.mark(4669)}return 32}}Object(n.a)(iA,"SelectAllHandlers",null,[1258]);class OI{E6d(){}}Object(n.a)(OI,"FontNameFormattingStrategyNoop",null,[1390]);var bM=d(763);class ME{constructor(b,
h,r,z,R,ba){this.agh=this.egh=null;this.lu=b;this.$fh=h;this.Sik=r;this.bjk=z;this.egh=R;this.agh=ba}}Object(n.a)(ME,"BookmarkHighlightContext",null,[]);class PI extends Mf.a{constructor(){super()}get Ila(){return!0}get PBb(){return 5}get Qeb(){if(null!=this.Opa)return this.Opa;this.Opa=[];this.Opa.push(new $g.a(wj.a.Ssd,wj.a.Ssd));this.Opa.push(new $g.a(wj.a.xTe,wj.a.xTe));this.Opa.push(new $g.a(wj.a.Ezc,wj.a.Ezc));return this.Opa}WNa(b,h){this.Ila&&Cp.a.instance.Pd(()=>{const r=this.Ky.mKa;var z=
this.Ky.wRd;if(r)if(5===r.type){z=r.DF;if(r.iO&&r.iO.lu.includes(b))for(const R of h.L1a("*"))this.Ky.W1a(R);z&&z.lu.includes(b)&&this.v_c(h,r.action,z,b)}else z&&5===z.type&&3===r.action&&z.DF.lu.includes(b)&&this.v_c(h,0,z.DF,b)},"BHA:OPHC")}M_a(b){return Object(nb.a)(ME,b)}Zdb(b,h){if(b)for(let r of b.lu)h.add(r)}v_c(b,h,r,z){0===h&&b.htmlElement&&Cp.a.instance.Pd(()=>{const R=b.L1a("*"),ba=R.length,ta=wj.a.Ssd;var Wa=z.id===r.egh,ub=z.id===r.agh;let Ib=!1;var $b=0,fc=[];let Kc=Array(ba);for(let ge=
0;ge<ba;ge++){var ed=R[ge];const qe=Qj.a(ed);Kc[ge]=qe;const Ve=ed.classList;if(0!=Kc[ge]){const Bd=!Ve.contains(wj.a.kI);let he=Ri.a.Eb(ed,wj.a.Vvb);he&&fc.push(...he);if(Wa){let we;if((we=Ri.a.Eb(ed,wj.a.Usd))&&he&&1===we.length&&1===he.length&&we[0].equals(he[0]))continue;we&&($b+=we.length,1===qe?Ve.add(wj.a.xTe):Ve.add(ta));if(he)for(let hg of he)this.INd(r,hg)&&($b--,Ib&&Ve.add(wj.a.Ezc));0!==$b&&Bd&&Ve.add(ta)}if(!Wa&&!ub&&r.bjk.has(z.id))if((ed=Ri.a.Eb(ed,wj.a.Vvb))&&Ib){Ve.add(ta);for(let we of ed)if(this.INd(r,
we)){Ve.add(wj.a.Ezc);break}}else Bd&&Ve.add(ta)}Ib=!Ve.contains(wj.a.uXa)}if(ub&&!Wa){Wa=new Set;for(var Jd of fc)this.INd(r,Jd)&&Wa.add(Jd);Ib=!1;for(fc=0;0!==Wa.size&&fc<ba;fc++){$b=R[fc];Jd=$b.classList;if(0!=Kc[fc])if(ub=!1,$b=Ri.a.Eb($b,wj.a.Vvb)){for(let ge of $b)this.INd(r,ge)&&(Wa.delete(ge),ub=!0);0!==Wa.size&&Jd.add(ta);Ib&&ub&&Jd.add(wj.a.Ezc)}else Jd.contains(wj.a.kI)||Jd.add(ta);Ib=!Jd.contains(wj.a.uXa)}}},"BHA:SPH")}INd(b,h){for(let r of b.Sik)if(h.equals(r))return!0;return!1}}Object(n.a)(PI,
"BookmarkHighlightActor",Mf.a,[271]);var NE=d(1801),QI=d(1603);class OE{constructor(b,h,r,z,R,ba,ta,Wa,ub,Ib){var $b;this.Oai=!1;this.rg=b;this.jB=h;this.fb=R;this.OU=ba;this.ij=ta;this.le=Wa;this.Ac=Ib;this.Oa=ub;this.Oai=null!==($b=null===ub||void 0===ub?void 0:ub.getBooleanFeatureGate("Microsoft.Office.WordOnline.CheckMultiRangeContextForTheme",!1))&&void 0!==$b?$b:!1}JWf(b,h,r,z){const R=b.L6g(h);if(R){var ba=Object(nb.a)(QI.a,b),ta=this.le.hg("WebServiceCall",String.format("SendGraphicsEditorRequest: ClosingDialog = {0} EditingExistingContent = {1}",
ba,r)),Wa=h.vk.node,ub=()=>{r||this.Kpn(h.vk,R.getId())};ba=OE.qhh();z=this.Phh(R.getId().toString(),Wa,z,r);try{b.Tbh(z,h)}catch(Ib){v.ULS.sendTraceTag(572872463,3001,10,"GraphicsEditorRequestManager::SendGraphicsEditorRequest: Exception while trying to AppendUrlParameters. Exception: "+Ib.message);this.xp(WordEditorIntl.WordEditorStrings.L_GraphicsEditorDefaultError);return}this.rg.Lj(ba,2,z.toString(),{},!0,0,Ib=>{v.ULS.sendTraceTag(575522560,3001,50,"GraphicsEditorRequestManager::SendGraphicsEditorRequest: Successfully created GraphicsEditorSession.");
b.b1a(Ib,R,()=>{this.xp(b.NHd())},ub,Wa,h,ta)},Ib=>{const $b=415===Ib.data.wf;let fc="";Ib&&Ib.data&&Ib.data.rj&&"X-CorrelationId"in Ib.data.rj&&Ib.data.rj["X-CorrelationId"]&&(fc=Ib.data.rj["X-CorrelationId"]);b.Wma(`Graphics editor request failed. HttpStatus [${Ib.data.wf}], ResponseData [${Ib.data.Ge}], CorrelationId [${fc}]`,R,Wa,ub,()=>{this.xp($b?WordEditorIntl.WordEditorStrings.L_GraphicsEditorUnsupportedContentError:b.NHd())},ta,$b)},null)}else this.xp(b.NHd())}nFn(b,h,r){return new Promise((z,
R)=>{var ba=b.vk,ta=null;ta=this.Oai&&id.a.csf(ba)?ba.getContext(0).node:ba.node;ba=OE.qhh();ta=this.Phh(h.toString(),ta,r,!1);ta.Ie(NE.a.JZe,"2");this.rg.Lj(ba,2,ta.toString(),{},!0,0,Wa=>{v.ULS.sendTraceTag(575522563,3001,50,"GraphicsEditorRequestManager::SendGraphicsEditorThemeRequest: Successfully created.");z(Wa.data.Ge)},Wa=>{v.ULS.sendTraceTag(575522564,3001,10,`GraphicsEditorRequestManager::SendGraphicsEditorThemeRequest: Request failed. HttpStatus ${Wa.data.wf}, ResponseData ${Wa.data.Ge}`);
this.xp(WordEditorIntl.WordEditorStrings.L_GraphicsEditorDefaultError);R(null)},null)})}Phh(b,h,r,z){const R=h.Di(),ba=new Ma.QueryStringBuilder("WordGraphicsEditorHandler.ashx");t.AFrameworkApplication.vja(ba);ba.Ie(NE.a.strict,this.Kem(h)?"true":"false");ba.Ie(Tj.a.nodeId,b);ba.Ie(Tj.a.cellId,R.Zl.toString());ba.Ie(Tj.a.fileId,R.Fs);ba.Ie(Tj.a.R1,r.toString());ba.Ie(NE.a.m5k,z?"true":"false");if(b=!!this.Ac&&this.Ac.isFeatureEnabled(48)){ba.Ie(rg.a.REi,b.toString());if(b=this.Ac.isFeatureEnabled(93))ba.Ie(rg.a.G4m,
b.toString()),ba.Ie(rg.a.ignoreMalformedColors,this.Ac.isFeatureEnabled(56).toString());this.Oa.getBooleanFeatureGate("Microsoft.Office.WordOnline.PictureTransparency",!1)&&ba.Ie(rg.a.P4m,"true")}ba.Ie(rg.a.kfh,"true");zl.a.instance.fvb(ba);return ba}Kem(b){if(!this.jB)return!1;b=this.jB.ju(b);return!!b&&b.Og(yc.a.Ktf)}Kpn(b,h){b.cpBegin===b.cpEnd-1&&this.ij.icc(b.node,h,this.fb,this.OU)}xp(b){const h=new te.StandardDialog;h.Fd=0;h.jy(fj.a.I5e,Box4Intl.Box4Strings.l_GraphicsEditorErrorTitle,b,null,
b===WordEditorIntl.WordEditorStrings.L_GraphicsEditorUnsupportedContentError);vb.App.xa.updateCommandUI()}static qhh(){const b=new Ma.QueryStringBuilder("WordGraphicsEditorHandler.ashx");t.AFrameworkApplication.vja(b);return b.toString()}}Object(n.a)(OE,"GraphicsEditorRequestManager",null,[501]);class RI extends zx{constructor(b,h){super(b,h);this.fMa=Fb.a.insertHyperlink}OZa(b){null!=b&&0<b.length&&this.zc.Xb(this.fMa,2,b[0])}ynj(b,h,r){const z=Sj.a.pg(t.AFrameworkApplication.lcid).name;return String.format(b,
t.AFrameworkApplication.lcid,z,t.AFrameworkApplication.buildVersion,h,Jw.mge,r)+"&flipgrid=1&ted=1"}}Object(n.a)(RI,"InsertHubbleMediaHelper",zx,[]);class SI{constructor(b,h,r,z,R,ba){this.ga=b;this.Oa=h;this.Ocd=r;this.O0=z;this.V$c=R;this.Ok=ba}Vb(){this.ga.gb(Oa.a.CBi,kc.a.Wc,this.c_m.bind(this),1028);this.ga.gb(Oa.a.a9h,kc.a.Wc,this.$5l.bind(this),1028)}$5l(b,h,r,z,R){if(1!==r){if(null==R)return 16;if(!h.vl||!Xd.SelectionEditor.xf(h))return 2;b=this.Mql(R);R=R.OriginalUrl;t.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.InsertFluidComponent",
!1);this.V$c.vcg(b,h,R)}return 32}Qsj(){t.AFrameworkApplication.K&&t.AFrameworkApplication.K.$("OnlineVideoFloodgateIsEnabled")&&window.setTimeout(()=>{const b=Sa.a.instance.Za("Common.ISystemInitiatedFeedback");b&&b.execute(h=>{h.logActivity("OnlineVideoInserted","OnlineVideoFloodgateIsEnabled")})},5E3)}Mql(b){const h=new WA;h.MediaType=b.ContentType;h.Height=b.Height;h.Width=b.Width;h.IFrameHtml=b.Html;h.Title=b.Caption;h.Thumbnail=b.ThumbnailUrl;return h}c_m(b,h,r){var z,R;if(1!==r)h=B.a.cW(this.Oa.lb("UserId")).toString(),
h=this.O0.ynj(this.Oa.appSettings.InsertVideoHubbleEndpoint,pa.a.create().toString(),h),this.O0.fMa=Oa.a.a9h,h=this.Ocd.CIc(h,!0),h.correlationId=pa.a.create(),h.Gfa=5,h.H8d(null,this.O0),Y.a.sendTelemetryEvent(Object.assign(new da.a,{name:"Office.Word.Online.OnlineMedia",dataFields:[Object.assign(new ca.a,{name:"ActionId",int64:b})]})),this.Qsj();else if(!(h&&h.node&&HB.a(h.node))||Nr.a.Bwd&&(null===(z=this.Ok)||void 0===z?0:z.iZ(h))||(null===(R=this.Ok)||void 0===R?0:R.Jta(h)))return 2;return 32}}
Object(n.a)(SI,"OnlineMediaActor",null,[]);class TI extends JB{constructor(b,h,r,z=null,R=!1){super(b,h,r,z,R);this.uoc=null}get telemetryEventName(){return"Office.Word.Online.OnlineMediaDialog"}qHc(){const b={};b.insertMediaServiceEndpoint=this.Pcd;b.iFrameId="mediaiframe";return b}H8d(b,h){this.APb=b;this.uoc=h;this.mnc=!1;b={["id"]:"OnlineMediaDialog",["bodyControls"]:this.qHc(),["componentIsVisibleCallback"]:this.brj.bind(this)};this.Wh(this.APb,null,b)}brj(){this.TZ=this.E2b(this.qj("mediaiframe"));
this.xG=this.Pid.getInstance(this.TZ.contentWindow,this.Pcd);this.xG.zr(F.a.r8g,b=>{this.Bvi(b,this.uoc.OZa.bind(this.uoc))});this.xG.zr(F.a.insert,b=>{this.BXd(b,this.uoc.OZa.bind(this.uoc))});this.xG.zr(F.a.lPh,this.xxi.bind(this));this.xG.zr(F.a.getSessionId,this.Axi.bind(this));this.xG.zr(F.a.cNh,this.wxi.bind(this));this.xG.zr(F.a.Otd,this.lwi.bind(this));this.ekb(3)}ekb(b){const h=[];h.push(Object.assign(new ca.a,{name:"DialogResult",string:dA[b]}));h.push(Object.assign(new ca.a,{name:"DialogMode",
string:this.yff()}));h.push(Object.assign(new ca.a,{name:"CorrelationId",string:this.correlationId.toString()}));h.push(Object.assign(new ca.a,{name:"Provider",string:yx[this.Gfa]||"Unknown"}));Y.a.sendTelemetryEvent(Object.assign(new da.a,{name:this.telemetryEventName,dataFields:h}))}}Object(n.a)(TI,"OnlineMediaDialog",JB,[]);class UI{constructor(b,h){this.ite=b;this.O0=h}CIc(b,h=!1){return new TI(b,this.ite,this.O0,null,h)}getInstance(){throw Error.notImplemented();}}Object(n.a)(UI,"OnlineMediaDialogFactory",
null,[496]);class VI extends Dj{constructor(){super(1,3);this.Zv=Sa.a.instance.resolve("Common.IReactContextualUILauncher");this.eaj=!1}$2a(){t.AFrameworkApplication.ya.processAction(Oa.a.Mec,2)}YAd(){this.TIh&&!this.Su&&(this.Su=this.UGa())}MBd(){if(this.Su&&this.Su.isVisible){var b=Object(la.a)(Gm.Control,this.Su.controls["ExternalContentFloatie.FlyoutAnchor"]);b.behavior.rw(b.Cdb(),1,null)}b=document.getElementById("ExternalContentFloatieFlyout");if(null==b)v.ULS.shipAssertTag(555816415,324,!1,
"ExternalContentFloatieEventManger.onOnlyKeyPressed: externalContentFloatieUIElement is null.");else{var h=b.getBoundingClientRect();0<h.top&&h.bottom<window.innerHeight&&(h=b.getAttribute(vf.a.nsd)||"",vf.a.jL===h&&b.click())}}KZ(){return this.Zv.KZ}}Object(n.a)(VI,"ExternalContentFloatieManager",Dj,[]);class br{constructor(){br.L3l()}get oc(){return null!=this.btg?this.btg:this.btg=Sa.a.instance.resolve("Box4.Styles.IWACStyleReader")}get key(){return"FORMATTING_PARAGRAPH"}get mw(){return null}Ygc(b){var h=
null;if(!ie.ParagraphReader.zh(b))return{returnValue:!1,ika:h};if((b=this.oc.yo(b.currentNode))&&2===this.oc.Uw(b)){const r=this.oc.rf(b);br.kP.contains(r)&&(h=this.oc.zF(b),h=Object.assign(new Rs.a,{QF:this.key,contentId:b.id,contentObject:h}))}return{returnValue:!!h,ika:h}}Zzb(b,h){let r=null;h&&b.contentId.equals(h.contentId)||(r=b.contentObject);return r}static L3l(){br.kP=new kn.a;br.kP.add(ki.StyleReader.styleIdHeading1);br.kP.add(ki.StyleReader.styleIdHeading2);br.kP.add(ki.StyleReader.styleIdHeading3);
br.kP.add(ki.StyleReader.Qva);br.kP.add(ki.StyleReader.UPa);br.kP.add(ki.StyleReader.VPa);br.kP.add(ki.StyleReader.zfc);br.kP.add(ki.StyleReader.s3a);br.kP.add(ki.StyleReader.wordStyleIdHeading1);br.kP.add(ki.StyleReader.wordStyleIdHeading2);br.kP.add(ki.StyleReader.wordStyleIdHeading3);br.kP.add(ki.StyleReader.D4a);br.kP.add(ki.StyleReader.E4a);br.kP.add(ki.StyleReader.F4a);br.kP.add(ki.StyleReader.Fmb);br.kP.add(ki.StyleReader.Gmb);br.kP.add(ki.StyleReader.G4a);br.kP.add(ki.StyleReader.K4a);br.kP.add(ki.StyleReader.gic)}}
br.kP=null;Object(n.a)(br,"ParagraphStyleDetailsProvider",null,[596,269]);class WI{constructor(b,h,r,z){this.ZGa=b;this.$Kj=h;this.hLj=r;this.iLj=z}dRf(){this.ZGa.execute(b=>{b.acc(this.$Kj.value);b.acc(new br);b.acc(this.iLj.value);b.i3(this.hLj.value)})}}Object(n.a)(WI,"AccessibilityActor",null,[]);class XI{constructor(b,h,r){this.jg=null;this.w0c=(z,R,ba)=>{if(1===ba)return 32;this.jg=this.hmc.value.mHk(this.Wb);if(!this.jg)return v.ULS.sendTraceTag(21233673,334,10,"AccessibilityHelpDialog failed to initialize"),
8;this.jg.KPa();return 32};this.u6g=z=>this.jg?this.jg.KUl(z):2;this.ga=b;this.hmc=h;this.Wb=r}Vb(){if(t.AFrameworkApplication.K.$("UIDiscoverabilityEnabled")){var b=rc.KeyInputManager.lc(wb.a.Tmb,5);this.Wb.re(ke.AFrame.Zp).Dr(b);this.Wb.re(ke.AFrame.Np).bindAction(b,ab.a.w0c);this.ga.pa(ab.a.w0c,Yd.a.frame,this.w0c);this.ga.pa(ab.a.Nxc,Yd.a.frame,this.u6g);this.ga.pa(ab.a.Mxc,Yd.a.frame,this.u6g)}}}Object(n.a)(XI,"AccessibilityHelpDialogActor",null,[]);var cM=d(1006),dM=d(1384);class YI{constructor(b,
h){this.$Fj=b.rc("WordHangForActionManagerThresholdTime",750);this.ga=h;this.Kuj=cM.a.sF(26,5,new dM.a)}j3(){this.ga.j3(this)}T6(){}S6(b){const h=+b.endTime-+b.startTime;if(h>this.$Fj){let r="";switch(b.behavior){case 1:r="E";break;case 2:r="X";break;case 3:r="A"}(b=$c.ActionManager.ada(b.actionId))&&b.length||(b="UnknownAction");this.Kuj.track(h,b+"_"+r)}}}Object(n.a)(YI,"ActionHangDetector",null,[33]);var ZI=d(1450);class $I extends Ag{constructor(b){super(b,void 0,t.AFrameworkApplication.bXa,new Dc(b,
!1))}get C0a(){return CommonUIStrings.l_DownLoadACopyDialogMessageWorkOffline}get O8b(){return CommonUIStrings.l_DownLoadACopyDialogLinkSuggestion}get SQc(){return"DownloadCopyLink"}get buttonText(){return CommonUIStrings.l_DownloadACopyMin}get cDc(){return t.AFrameworkApplication.bXa?"UIFontDialogTextLarge":null}txf(){v.ULS.sendTraceTag(7690388,324,50,"Download a copy dialog displayed")}uxf(){v.ULS.sendTraceTag(7690389,324,50,"Download a copy dialog clicked")}jRc(){v.ULS.sendTraceTag(19462214,324,
50,"Download a copy dialog button clicked");t.AFrameworkApplication.ya.processAction(ab.a.JBh,2)}}Object(n.a)($I,"DownloadACopyDialog",Ag,[]);var PE;(function(b){b[b.Unknown=0]="Unknown";b[b.Excel=1]="Excel";b[b.OneNote=2]="OneNote";b[b.PowerPoint=3]="PowerPoint";b[b.Visio=4]="Visio";b[b.Word=5]="Word";b[b.Project=6]="Project";b[b.Publisher=7]="Publisher";b[b.Infopath=8]="Infopath";b[b.Access=9]="Access"})(PE||(PE={}));Object(n.b)("OfficeApplication",PE);var UD;(function(b){b[b.ReadWrite=0]="ReadWrite";
b[b.ReadOnly=1]="ReadOnly";b[b.WriteOnly=2]="WriteOnly";b[b.ForceCheckout=3]="ForceCheckout";b[b.WriteLocalCopy=4]="WriteLocalCopy";b[b.OpenInBrowser=5]="OpenInBrowser"})(UD||(UD={}));Object(n.b)("OpenDocumentMode",UD);class aJ extends Wc.a{constructor(){super(!1,!1,!0)}ZYd(){var b={["description"]:"We'd love to understand why you're opening this document in the Desktop App. Why did you decide to leave Word for the web?",["actionButtonLabel"]:Box4Intl.Box4Strings.l_WordPredictionFeedbackActionLabel};
const h=Array(5);h[0]={["key"]:"0",["text"]:"I can't open my document in Word for the web"};h[1]={["key"]:"1",["text"]:"I didn't intend to open this document online"};h[2]={["key"]:"2",["text"]:"Word for the web was glitchy with this document"};h[3]={["key"]:"3",["text"]:"I need features in the Desktop App for this document"};h[4]={["key"]:"4",["text"]:"I prefer the Desktop App"};b.selectionOptions={["id"]:"reasonsList",["options"]:h};b={["id"]:"OpenInClientFeedbackDialog",["bodyControls"]:b};this.Wh("Send feedback to Microsoft",
this.LMn.bind(this),b);return new Promise(r=>{this.YNj=r})}LMn(b,h){1===b&&this.DEa(h.selectedReason)}dispose(){super.dispose();this.YNj()}DEa(b){const h={},r={},z={},R={},ba={};h.appId=2155;h.manifestType="Fps";h.submitTime=(new Date).toISOString();h.source="Client";h.type="Survey";h.clientFeedbackId=pa.a.create().toString();ba.reason=b;let ta={};ta.rating=[{$Ho:5,zKo:b}];R.surveySpecificData=JSON.stringify(ta);z.extendedManifestData=JSON.stringify(R);h.application=z;ba.surveyId="4938d2fd-3840-4f39-9073-1b7522395873";
h.survey=ba;h.telemetry=this.tUe();h.web=this.uUe();r["Content-Type"]="application/json";this.njb(JSON.stringify(h),r)}q9(b,h,r,z){h&&b&&z&&r&&z in h&&(b[r]=h[z])}tUe(){const b=t.AFrameworkApplication.sessionStartInfoSettings,h={};h.officeBuild=t.AFrameworkApplication.buildVersion;h.featureArea="Open In Desktop App";this.q9(h,b,"audienceGroup","AudienceGroup");this.q9(h,b,"osBuild","OsVersion");this.q9(h,b,"platform","Platform");this.q9(h,b,"processSessionId","WACSessionID");return h}uUe(){const b=
t.AFrameworkApplication.sessionStartInfoSettings,h={};this.q9(h,b,"browser","Browser");this.q9(h,b,"browserVersion","BrowserVersion");this.q9(h,b,"dataCenter","WACDatacenter");return h}njb(b,h,r=0){let z=0;3<r||(1===r?z=200:1<r&&(z=200+500*(r-1)),t.AFrameworkApplication.uc.$b(new Ic.a(2,1,z,()=>{t.AFrameworkApplication.Xe.Lj("https://petrol.office.microsoft.com/v1/feedback",2,b,h,!1,2,()=>{v.ULS.sendTraceTag(512341407,211,50,"Success sending OCV feedback for Open In Client")},()=>{this.njb(b,h,r+
1);v.ULS.sendTraceTag(512341406,211,50,"Failure sending OCV feedback for Open In Client, attempt {0}",r)},null)})))}}Object(n.a)(aJ,"WordOpenInClientFeedbackDialog",Wc.a,[]);var bJ=d(1700);const KC=b=>{for(let h=0;h<b.children.length;h++){const r=b.children[h];r.style.position="relative";r.style.top=(r.parentNode.offsetHeight-r.offsetHeight)/2+"px"}},QE=b=>b.Ib.keyCode===wb.a.es||b.Ib.keyCode===wb.a.sFa?(b.Af.click(),!0):!1,VD=(b,h,r,z,R,ba,ta)=>{const Wa=document.createElement("a");Wa.className=
"ProtocolLaunchingDialogButtonAnchor";Wa.className+=" OICDialog";Wa.id=b;Wa.setAttribute(vf.a.Ch,vf.a.t1);Wa.style.padding="0";Wa.style.margin="0";z&&cJ(R,h,r,z,Wa);b=document.createElement("span");b.className="ProtocolLaunchingDialogButtonLabel";b.innerText=R;Wa.appendChild(b);Wa.tabIndex=0;ba&&sf.a.instance.mb(jb.a.click,Wa,ba);ta&&rc.KeyInputManager.instance.mb(jb.a.oh,Wa,ta);return Wa},cJ=(b,h,r,z,R)=>{var ba=document.createElement("img");ba.alt=b;ba.className=Wh.getImageClassWithCluster(r,z);
ba.src=h;ba.setAttribute(vf.a.Ch,vf.a.Az);b=document.createElement("span");b.className="ProtocolLaunchingDialogImg32Container";b.appendChild(ba);ba=document.createElement("span");ba.className="ProtocolLaunchingDialogIconContainer";ba.appendChild(b);R.appendChild(ba)};class RE{static get vg(){return Wc.a.Px(RE.sl,CommonUIStrings.l_OICLaunchDialogTitle)}}RE.sl="<div class='ProtocolLaunchingDialogBody' id='PLDDlgBody'> <div class='ProtocolLaunchingDialogTitle UIFontDialogTitle OICDialog' id='ProtocolLaunchingDialogTitle'> <div class='WACDialogSectionTitle'>{0}</div> </div> <div class='OICDialogRow' id='OICDialog'> <div class='OICDialogButtons' id='Buttons'> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonLaunchRichClient'> <div id='OICLaunchRichClient' class='UIFontDialogButton WACGlyph OICDialog'></div> </div> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonReturn'> <div id='OICReturnToApp' class='UIFontDialogButton WACGlyph OICDialog'></div> </div> </div> </div> </div>";
Object(n.a)(RE,"OICLaunchDialogHtml",null,[]);class dJ extends Wc.a{constructor(b){super();this.ZNb=this.Fnb=null;this.LK=!1;this.Sp=b;this.vg=RE.vg;this.Fd=5;this.kg="OICLaunchDialog";this.showDialog("",Object(u.a)(this,this.eOm,"oicLaunchDialogResultHandler"));this.JZi();this.u3("ProtocolLaunchingDialogTitle");4!==t.AFrameworkApplication.ua.Sb.yKa&&(document.getElementById("ProtocolLaunchingDialogTitle").innerText=CommonUIStrings.l_OICLaunchDialogTitleForView);this.uU(this.Fnb);v.ULS.sendTraceTag(22140865,
211,50,"OIC launch dialog opened");document.getElementById("WACDialogTitlePanel").className+=" OICDialog"}cU(){this.Fnb=VD("BtnRichClient",this.Sp.mEc,this.Sp.WLc,this.Sp.ymf,CommonUIStrings.l_OICLaunchRichClient,Object(u.a)(this,this.Nzi,"onRichClientButtonClick"),QE);document.getElementById("OICLaunchRichClient").appendChild(this.Fnb);KC(this.Fnb);this.ZNb=VD("BtnReturn",this.Sp.mEc,this.Sp.WLc,this.Sp.V6h,CommonUIStrings.l_OICReturnToOnlineClient,Object(u.a)(this,this.Jzi,"onReturnButtonClick"),
QE);document.getElementById("OICReturnToApp").appendChild(this.ZNb);KC(this.ZNb)}Jzi(){this.hide();this.Sp.Fcc();return!0}Nzi(){v.ULS.sendTraceTag(22140866,211,50,"OIC dialog: launch rich client");this.hide();t.AFrameworkApplication.ya.processAction(ab.a.QIb,2);return!0}eOm(){this.Sp.Fcc()}dispose(){this.LK||(this.Fnb&&(sf.a.instance.sc(jb.a.click,this.Fnb,Object(u.a)(this,this.Nzi,"onRichClientButtonClick")),rc.KeyInputManager.instance.sc(jb.a.oh,this.Fnb,QE)),this.ZNb&&(sf.a.instance.sc(jb.a.click,
this.ZNb,Object(u.a)(this,this.Jzi,"onReturnButtonClick")),rc.KeyInputManager.instance.sc(jb.a.oh,this.ZNb,QE)),super.dispose(),this.LK=!0)}}Object(n.a)(dJ,"OICLaunchDialog",Wc.a,[]);class SE{static get vg(){return Wc.a.Px(SE.sl,CommonUIStrings.l_OICDialogTitle)}}SE.sl="<div class='ProtocolLaunchingDialogBody' id='PLDDlgBody'> <div class='ProtocolLaunchingDialogTitle UIFontDialogTitle OICDialog' id='ProtocolLaunchingDialogTitle'> <div class='WACDialogSectionTitle'>{0}</div> </div> <div class='ProtocolLaunchingDialogIssues OICDialog' id='ProtocolhandlerGetHelp'> <div class='UIFontDialogText OICDialog' id='Issues'> </div> <div class='ProtocolLaunchingDialogHelpButtons' id='Buttons'> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonEdit'> <div id='ProtocolHandlerDialogEditInApp' class='UIFontDialogButton WACGlyph'></div> </div> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonGiveFeedback'> <div id='ProtocolHandlerDialogGiveFeedbackInApp' class='UIFontDialogButton WACGlyph'></div> </div> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonRetryOIC'> <div id='ProtocolHandlerDialogRetryOIC' class='UIFontDialogButton WACGlyph OICDialog'></div> </div> </div> </div> </div>";
Object(n.a)(SE,"ProtocolLaunchingDialogV2Html",null,[]);class eJ extends Wc.a{constructor(b){super();this.YNb=this.dRa=null;this.LK=!1;this.D5a=null;this.Sp=b;this.vg=SE.vg;this.Fd=5;this.kg="ProtocolLaunchingDialog";this.tob="OICRetryDialog";t.AFrameworkApplication.uc.CBb&&t.AFrameworkApplication.uc.restart();t.AFrameworkApplication.uc.$b(new Ic.a(2,1,5E3,()=>{this.switchToBackupMode()},101));this.showDialog("",Object(u.a)(this,this.fOf,"protocolLaunchingDialogResultHandler"));this.JZi();this.u3("Issues");
this.oJh();v.ULS.sendTraceTag(19239262,211,50,"OIC dialog launched");document.getElementById("WACDialogTitlePanel").className+=" OICDialog"}cU(){const b=document.getElementById("Issues");if(b){cJ("",this.Sp.mEc,this.Sp.WLc,this.Sp.ymf,b);const h=document.createElement("span");h.className="WACDialogSectionTitle";h.innerText=5===this.Sp.qBi?CommonUIStrings.l_OICBrowserDialogTitle:CommonUIStrings.l_OICDialogSectionTitle;b.appendChild(h);KC(b);b.style.display="none"}t.AFrameworkApplication.ua.Sb.J1h?
(this.YNb=VD("GiveFeedback",this.Sp.mEc,this.Sp.WLc,"",CommonUIStrings.l_OICDialogSectionGiveFeedback,Object(u.a)(this,this.nXd,"onGiveFeedbackClick"),Object(u.a)(this,this.Cxi,"onGiveFeedbackKeyUp")),document.getElementById("ProtocolHandlerDialogGiveFeedbackInApp").appendChild(this.YNb),KC(this.YNb)):document.getElementById("ButtonGiveFeedback").style.display="none";0===t.AFrameworkApplication.ua.Sb.yKa||t.AFrameworkApplication.zWk?document.getElementById("ButtonEdit").style.display="none":(this.dRa=
VD("Edit",this.Sp.mEc,this.Sp.WLc,"",2===t.AFrameworkApplication.ua.Sb.jo?4===t.AFrameworkApplication.ua.Sb.yKa?CommonUIStrings.l_OICResumeEditing:CommonUIStrings.l_OICReturnToOnlineClient:4===t.AFrameworkApplication.ua.Sb.yKa?CommonUIStrings.l_OICResumeEditing:CommonUIStrings.l_OICContinueInBrowser,Object(u.a)(this,this.bxi,"onEditClick"),Object(u.a)(this,this.exi,"onEditKeyUp")),document.getElementById("ProtocolHandlerDialogEditInApp").appendChild(this.dRa),KC(this.dRa));0===t.AFrameworkApplication.ua.Sb.yKa&&
!t.AFrameworkApplication.msf&&b&&(b.style.display="none")}pJh(){return this.D5a?(this.uU(this.D5a),!0):!1}oJh(){return this.dRa?(this.uU(this.dRa),!0):!1}exi(b){return this.GFf(b,0)}Cxi(b){return this.GFf(b,2)}Izi(b){return this.GFf(b,1)}GFf(b,h){let r=!1;if(b.Ib.keyCode===wb.a.es||b.Ib.keyCode===wb.a.sFa)b.Af.click(),r=!0;else if(b.Ib.keyCode===Sys.UI.Key.down||b.Ib.keyCode===Sys.UI.Key.up)switch(h){case 1:r=this.oJh();break;case 0:r=this.pJh()}return r}bxi(){this.hide();4===t.AFrameworkApplication.ua.Sb.yKa?
(v.ULS.sendTraceTag(18715411,211,50,"Restart the App and continue editing"),this.Sp.Fcc()):(v.ULS.sendTraceTag(18715412,211,50,"Switch to edit doc in browser"),this.Sp.xKc());return!0}nXd(){v.ULS.sendTraceTag(37339423,211,50,"Open give feedback dialog");return!0}lHf(){zL.Redirect.showHelp("OICFailure");return!0}iYd(){v.ULS.sendTraceTag(19239263,211,50,"OIC dialog retry");document.getElementById("WACDialogPanel").style.display="none";t.AFrameworkApplication.ya.processAction(ab.a.QIb,2);return!0}fOf(){this.Sp.Fcc()}switchToBackupMode(){var b=
document.getElementById("ProtocolLaunchingDialogTitle");if(b){b.innerText=CommonUIStrings.l_OICDialog2ndTitle;if(b=document.getElementById("Issues"))b.style.display="block";(b=document.getElementById("ProtocolHandlerDialogRetryOIC"))&&!b.children.length&&(this.D5a=VD("RetryOIC","","","",CommonUIStrings.l_OICDialogRetry,Object(u.a)(this,this.iYd,"onRetryOICClick"),Object(u.a)(this,this.Izi,"onRetryOICKeyUp")),b.appendChild(this.D5a),KC(this.D5a),this.dRa||this.pJh())}}dispose(){this.LK||(this.dRa&&
(sf.a.instance.sc(jb.a.click,this.dRa,Object(u.a)(this,this.bxi,"onEditClick")),rc.KeyInputManager.instance.sc(jb.a.oh,this.dRa,Object(u.a)(this,this.exi,"onEditKeyUp"))),this.YNb&&(sf.a.instance.sc(jb.a.click,this.YNb,Object(u.a)(this,this.nXd,"onGiveFeedbackClick")),rc.KeyInputManager.instance.sc(jb.a.oh,this.YNb,Object(u.a)(this,this.Cxi,"onGiveFeedbackKeyUp"))),this.D5a&&(sf.a.instance.sc(jb.a.click,this.D5a,Object(u.a)(this,this.iYd,"onRetryOICClick")),rc.KeyInputManager.instance.sc(jb.a.oh,
this.D5a,Object(u.a)(this,this.Izi,"onRetryOICKeyUp"))),super.dispose(),this.LK=!0)}}Object(n.a)(eJ,"ProtocolLaunchingDialog",Wc.a,[]);class TE extends te.StandardDialog{constructor(b){super();this.Sp=b;this.kg="ProtocolLaunchingDialog";t.AFrameworkApplication.uc.CBb&&t.AFrameworkApplication.uc.restart();t.AFrameworkApplication.ua.Sb.J1h&&this.F2j(CommonUIStrings.l_OICStandardDialogSectionGiveFeedback,Object(u.a)(this,this.nXd,"onGiveFeedbackClick"));TE.B3h?(this.Fd=12,this.Ve(1,CommonUIStrings.l_CloseFile),
this.Ve(2,CommonUIStrings.l_OICDialogContinueHere),this.Ve(3,CommonUIStrings.l_OICDialogLaunchAgain)):(this.Fd=4,this.Ve(1,CommonUIStrings.l_OICDialogContinueHere),this.Ve(2,CommonUIStrings.l_OICDialogLaunchAgain));this.xhb(CommonUIStrings.l_OICDialog2ndTitle,5===this.Sp.qBi?CommonUIStrings.l_OICBrowserDialogTitle:CommonUIStrings.l_OICStandardDialogSectionTitle,null,null,Object(u.a)(this,this.fOf,"protocolLaunchingDialogResultHandler"),null)}nXd(b){v.ULS.sendTraceTag(595342858,211,50,"Open give feedback dialog");
this.kxi(b)}iYd(){v.ULS.sendTraceTag(595342857,211,50,"OIC dialog retry");t.AFrameworkApplication.ya.processAction(ab.a.QIb,2)}fOf(b){TE.B3h?3===b?this.BSi():2===b||0===b?this.continueEditing():1===b&&this.closeDocument():2===b?this.BSi():(1===b||0===b)&&this.continueEditing()}closeDocument(){v.ULS.sendTraceTag(577783557,211,50,"Closing the document");t.AFrameworkApplication.ya.Xb(ab.a.close,2,dk.a)}BSi(){v.ULS.sendTraceTag(593602691,211,50,"OIC dialog retry");window.setTimeout(Object(u.a)(this,this.iYd,
"onRetryOICClick"),0)}continueEditing(){4===t.AFrameworkApplication.ua.Sb.yKa||t.AFrameworkApplication.K.$("WordConsumptionViewToEditRedirectIsEnabled")&&1===t.AFrameworkApplication.ua.mode?(v.ULS.sendTraceTag(593602690,211,50,"Restart the App and continue editing"),this.Sp.Fcc()):(v.ULS.sendTraceTag(593602689,211,50,"Switch to edit doc in browser"),this.Sp.xKc())}static get B3h(){return t.AFrameworkApplication.K.$("OICDialogThreeActions")&&32===t.AFrameworkApplication.ya.processAction(ab.a.close,
1)}}Object(n.a)(TE,"StandardProtocolLaunchingDialog",te.StandardDialog,[]);class fJ{}Object(n.a)(fJ,"EditDocumentInClientParams",null,[]);class UF{static gCh(b,h,r,z,R,ba,ta=!1,Wa=!1,ub="",Ib=!1,$b=!1,fc=!1,Kc="",ed="",Jd="",ge=!1){const qe=new fJ;qe.DocumentUrl=b;qe.Mode=h;qe.Options=r;qe.Application=z;qe.SilentExternalHandler=ta;qe.EncodeUrl=Wa;qe.CorrelationIdForWinClient=ub;qe.NavigateUsingWindowOpen=Ib;qe.DescriptiveUnattemptedEnums=$b;qe.NoBrowserModalDialogs=fc;qe.SessionOrigin=Kc;qe.CorrelationId=
ed;qe.ClickTime=Jd;qe.NewTelemetryDataIsEnabled=ge;MSOJS.ClientUtils.EditDocumentInClient(qe,R,ba)}}Object(n.a)(UF,"ClientUtils",null,[]);var eM=d(411),gJ=d(930);class UB{constructor(b){this.ETa=this.Fmc=this.Gkc=null;this.Pnc=!1;this.Bye=this.LSg=null;this.R7c=this.s0=this.Dld="";this.application=this.xy=0;this.G4n=this.C3f=!1;this.Xno=b&&t.AFrameworkApplication.K.$("OICLaunchDialogIsEnabled");t.AFrameworkApplication.ya.b6(ab.a.QIb)||t.AFrameworkApplication.ya.pa(ab.a.QIb,Yd.a.frame,Object(u.a)(this,
this.Vyn,"retryOpenInClientAction"));this.P5i=!!t.AFrameworkApplication.K&&t.AFrameworkApplication.K.$("SilentExternalHandler")}get qBi(){return this.xy}uPn(b,h="",r=""){this.s0=r||pa.a.create().toString();this.Dld=h||eM.a.dVh();this.R7c=b}Vyn(b,h,r){return h.contextId!==Yd.a.frame?2:1===r?32:this.QIb()}get options(){let b=0;t.AFrameworkApplication.Tvn&&(b|=1);t.AFrameworkApplication.vBi&&(b|=4);this.z4n()&&(b|=64);return b}z4n(){return!(2===this.application&&t.AFrameworkApplication.K.$("IsEmbeddedScenario"))}get mEc(){return t.AFrameworkApplication.pr}get WLc(){return t.AFrameworkApplication.hQ}get V6h(){return""}get ymf(){return""}get F4n(){return t.AFrameworkApplication.K.$("OneNoteMobileViewerIsEnabled")}get X7n(){return this.LSg||
(this.LSg=Sa.a.instance.resolve("Common.IOfficeTrialExperience"))}closeApplication(){this.C3f||this.L4k()}Fcc(){this.G4n||this.EFh()}hKi(b){return this.Xno&&X.a.ki?(new dJ(this),32):this.Cph(b)}Cph(b){const h=({Vlb:b}=this.Ypm(b)).returnValue;v.ULS.sendTraceTag(34198736,211,50,"OICLaunchClient,{0},{1}",32===h,b);return h}begin(b,h,r,z,R,ba){this.Gkc=b;this.Fmc=h;this.ETa=ba;this.application=r;this.xy=z;return t.AFrameworkApplication.QBh?(this.rki(),32):t.AFrameworkApplication.Ama&&!t.AFrameworkApplication.O5h?
(t.AFrameworkApplication.T0f(),8):this.qfh(R)}get dOm(){return!!t.AFrameworkApplication.K&&t.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OicAshaLoggingIsEnabled",!1)}QIb(){this.dOm&&this.Uvm();return this.Cph(this.Pnc)}VWi(){const b=new gJ.a(F.a.openInClient);b.Values["ui-language"]=t.AFrameworkApplication.lcid.toString();b.Values[ny.a.twh]=t.AFrameworkApplication.userSessionId;return this.ETa.value.send(b)?32:8}Uvm(){Ca.Health.instance.recordQosError("UserClickedRetryOpenInDesktop",
["OpenInClientFailed"],!1,!1,!1,!1,Object.assign(new eb.a,{inStaging:!0}))}YFn(b){const h=new gJ.a(F.a.Hqo);h.Values["ui-language"]=t.AFrameworkApplication.lcid.toString();h.Values[ny.a.twh]=t.AFrameworkApplication.userSessionId;h.Values[G.a.Gqo]=b;this.ETa.value.send(h)}Ypm(b){this.Pnc=b;this.YFn(5===this.xy?UB.PZm:UB.VZm);return 5===this.xy?this.Xpm():this.aqm()}Xpm(){this.Aki();return{returnValue:32,Vlb:"HostEditUrl,"}}aqm(){let b;var h=b="";t.AFrameworkApplication.k9g&&(h="|f|"+t.AFrameworkApplication.userSessionId);
const r=t.AFrameworkApplication.K.$("IsAssignmentMode")&&t.AFrameworkApplication.K.$("UseWindowOpenForOpenInClientInChromeAssignmentsIsEnabled")||t.AFrameworkApplication.JPc||X.a.OMa,z=t.AFrameworkApplication.K.$("UnattemptedEnumIsEnabled"),R=t.AFrameworkApplication.K.$("NoBrowserModalDialogs");if(t.AFrameworkApplication.ya.MVd){var ba=t.AFrameworkApplication.ya.Jea(3588168074);ba&&this.uPn(ba.epochClickTime,ba.sessionOrigin,ba.correlationId);this.fni()}if(t.AFrameworkApplication.UFi){b+="NewOrder,";
ba=8;this.ETa&&this.ETa.value&&this.ETa.value.isEnabled()&&t.AFrameworkApplication.Dhc&&(b+="Post,",ba=this.VWi());if(32===ba)return{returnValue:ba,Vlb:b};v.ULS.sendTraceTag(4994821,211,50,"AOpenInclientOperation.LaunchClient: cannot send postmessage");return t.AFrameworkApplication.zt.Zma?(v.ULS.shipAssertTag(5566816,211,!!t.AFrameworkApplication.zt.Zma),b+="HostUrl,",{returnValue:t.AFrameworkApplication.ua.S2(!0,t.AFrameworkApplication.zt.Zma),Vlb:b}):this.Gkc?(v.ULS.sendTraceTag(18715405,211,15,
"Try to open doc in rich client, SessionId {0}",t.AFrameworkApplication.userSessionId),b+="DocUrl,",UF.gCh(this.Gkc,this.xy,this.options,this.application,Object(u.a)(this,this.dxi,"onEditInClientSuccess"),Object(u.a)(this,this.cxi,"onEditInClientFailure"),this.P5i,t.AFrameworkApplication.K.$("OICEncodeUrlIsEnabled"),h,r,z,R,this.Dld,this.s0,this.R7c,t.AFrameworkApplication.ya.MVd),{returnValue:32,Vlb:b}):{returnValue:8,Vlb:b}}b+="OldOrder,";if(!this.Gkc&&t.AFrameworkApplication.zt.Zma)return this.ETa&&
this.ETa.value&&this.ETa.value.isEnabled()&&t.AFrameworkApplication.Dhc?(b+="Post,",h=this.VWi()):(v.ULS.sendTraceTag(22595483,211,50,"AOpenInclientOperation.LaunchClient: cannot send postmessage"),h=8),32!==h?(v.ULS.shipAssertTag(22595484,211,!!t.AFrameworkApplication.zt.Zma),b+="HostUrl,",{returnValue:t.AFrameworkApplication.ua.S2(!0,t.AFrameworkApplication.zt.Zma),Vlb:b}):{returnValue:h,Vlb:b};v.ULS.sendTraceTag(22595485,211,15,"Try to open doc in rich client, SessionId {0}",t.AFrameworkApplication.userSessionId);
b+="DocUrl,";UF.gCh(this.Gkc,this.xy,this.options,this.application,Object(u.a)(this,this.dxi,"onEditInClientSuccess"),Object(u.a)(this,this.cxi,"onEditInClientFailure"),this.P5i,t.AFrameworkApplication.K.$("OICEncodeUrlIsEnabled"),h,r,z,R,this.Dld,this.s0,this.R7c,t.AFrameworkApplication.ya.MVd);return{returnValue:32,Vlb:b}}Vun(b){t.AFrameworkApplication.Dm.setDw(8981,b)}dxi(b){this.Vun(b);v.ULS.sendTraceTag(18715406,211,50,"Open in rich client succeed");6===b&&MSOJS.ClientUtils.ShouldShowDialog()?
(this.F4n||this.Aki(),this.fni()):this.C3f||this.closeApplication()}cxi(b,h=0){v.ULS.sendTraceTag(18715407,211,10,"Fail to open doc in rich client. Failure Type: {0:D2}, Application: {1}",b,h);if(5===b)alert(CommonUIStrings.l_OICErrorPopupBlockerForSafari);else{const r=!!this.Fmc&&!this.Pnc;let z=0;1===b&&(z=2);6<=b&&13>=b&&(z=1,1===h&&(this.C3f=!0));this.X7n.QNm?(v.ULS.sendTraceTag(18715408,211,50,"Open OICErrorDialogWithTrial. Dialog cause: {0}",z),bJ.a.instance.RLk(this.Pnc?Object(u.a)(this,this.kvi,
"oicErrorDialogHandlerCloseForced"):Object(u.a)(this,this.lvi,"oicErrorDialogHandlerNoCloseForced"),r?Object(u.a)(this,this.byi,"onLaunchDownload"):null,this.Qzh(!1)?Object(u.a)(this,this.TZl,"iHaveOfficeButtonHandler"):null,z,h)):(v.ULS.sendTraceTag(18715409,211,50,"Open OICErrorDialog. Dialog cause: {0}",z),bJ.a.instance.PLk(this.Pnc?Object(u.a)(this,this.kvi,"oicErrorDialogHandlerCloseForced"):Object(u.a)(this,this.lvi,"oicErrorDialogHandlerNoCloseForced"),r?Object(u.a)(this,this.byi,"onLaunchDownload"):
null,z))}}fni(){try{const b=[Object.assign(new ca.a,{name:"CorrelationId",string:this.s0}),Object.assign(new ca.a,{name:"SessionOrigin",string:this.Dld}),Object.assign(new ca.a,{name:"ClickTime",string:this.R7c}),Object.assign(new ca.a,{name:"ProtocolHandlerFinishedTimestamp",double:(new Date).getTime()})];Lb.a("OpenInClientCompleted",!0,0,b)}catch(b){v.ULS.sendTraceTag(537773316,306,15,"Record OIC attempt failed: "+b.toString())}}Aki(){t.AFrameworkApplication.ua&&t.AFrameworkApplication.ua.Sb.KA&&
t.AFrameworkApplication.K.$("StandardProtocolDialogIsEnabled")?new TE(this):new eJ(this)}kvi(){this.closeApplication()}lvi(){this.Fcc()}byi(){this.rki()}TZl(){return this.Qzh(!0)}Qzh(b){const h=(X.a.w_a||X.a.Ys)&&!!t.AFrameworkApplication.yzd;h&&b&&(Ed.a.Cm(t.AFrameworkApplication.yzd,"_blank",void 0,"OpenInClient"),this.closeApplication());return h}}UB.VZm="OpenInDesktop";UB.PZm="OpenInBrowser";Object(n.a)(UB,"AOpenInClientOperation",null,[]);class VF extends UB{constructor(b,h,r=!1){super(r);this.gHj=
b;this.fHj=h}get V6h(){return this.fHj}get ymf(){return this.gHj}L4k(){t.AFrameworkApplication.ya.Xb(ab.a.close,2,dk.a)}EFh(){}qfh(b){return this.hKi(b)}rki(){v.ULS.shipAssertTag(5566817,211,!!this.Fmc);t.AFrameworkApplication.J$?t.AFrameworkApplication.ua.S2(!0,this.Fmc):Ed.a.Cm(this.Fmc,void 0,void 0,"LaunchDownload")}xKc(){t.AFrameworkApplication.ua.Sb.xKc()}}Object(n.a)(VF,"OpenInClientOperation",UB,[]);class hJ extends VF{constructor(){super("Word_32x32x32","EditInWordWebApp_32x32x32",!0);this.jon=
b=>{v.ULS.sendTraceTag(50857160,211,50,"Saving finished. Release lock before open in client");vb.App.F_.forceOutbound(this.GBi,this.xvm,b)};this.xvm=b=>{v.ULS.sendTraceTag(50857161,211,15,"Lock release failed.");const h=new te.StandardDialog;h.Fd=0;h.jy(fj.a.Beo,CommonUIStrings.l_DefaultDialogTitle,WordEditorIntl.WordEditorStrings.l_UnlockFailed,b?this.vvm:this.wvm)};this.vvm=()=>{t.AFrameworkApplication.ya.Xb(ab.a.close,2,dk.c)};this.wvm=()=>{vb.App.xa.refreshDocument(null)};this.GBi=b=>{t.AFrameworkApplication.Kfc=
!0;v.ULS.sendTraceTag(50857162,211,50,"Saving finished. Ready to OpenWordClient with forceClose: {0}.",b);this.hKi(b)}}Thk(b){vb.App.Xj.MNa.kQ||vb.App.ud.ZA.io?(v.ULS.sendTraceTag(50857159,211,15,"Saving skipped due to document loading failure"),this.GBi(b)):Qv.a.PP(4,!0,this.jon,null,b)}qfh(b){this.Thk(b);return 32}EFh(){vb.App.xa.refreshDocument(null)}}Object(n.a)(hJ,"OpenInWordOperation",VF,[]);const iJ=(b,h)=>{v.ULS.sendTraceTag(41186076,306,50,"Toggling readonly recommended setting for the document.");
b[Yf.a.On]=ne.PageReader.instance.Iu(h);ne.PageReader.instance.Iu(h)?b[Yf.a.Description]=WoncaIntl.WoncaStrings.L_ProtectDocumentDescriptionOn:b[Yf.a.Description]=WoncaIntl.WoncaStrings.L_ProtectDocumentDescriptionOff},fM=(b,h,r,z,R)=>{if(!vb.App.xa||!vb.App.xa.jb||!t.AFrameworkApplication.Gp.kdb)return 8;h=vb.App.xa.jb.Yc;if(!h)return 8;if(b===Fb.a.V0d&&2===r){b=new yf.GraphTransaction(15);try{b.Db(h),ne.PageReader.instance.J9n(h)}finally{b&&b.dispose()}iJ(R,h)}return 32},gM=(b,h,r,z,R)=>{if(!vb.App.xa||
!vb.App.xa.jb)return 8;b=vb.App.xa.jb.Yc;if(!b)return 8;R[Yf.a.Alt]=t.AFrameworkApplication.Gp.kdb?"":CommonUIStrings.l_ProtectDocumentToolTip;iJ(R,b);return 32};class jJ extends ZI.a{constructor(b,h){super(b,h);this.NLg=!1;this.Kyi=(r,z,R,ba,ta)=>{var Wa;if(z.contextId!==Yd.a.frame)return 2;if(!(vb.App.bBc||t.AFrameworkApplication.zt.Zma||t.AFrameworkApplication.Dhc||this.NLg))return v.ULS.sendTraceTag(50857163,211,15,"OIC entry is hidden"),this.NLg=!0,8;if(1===R)return Xh.SessionStatusManager.instance.Sj?
8:32;let ub=!1;void 0!==ta&&null!==ta&&(ub=ta);if(null===(Wa=t.AFrameworkApplication.K)||void 0===Wa?0:Wa.getBooleanFeatureGate("Microsoft.Office.WordOnline.OpenInClientFeedback",!1))(new aJ).ZYd().then(()=>this.GGb(r,ub));else return this.GGb(r,ub);return 32};this.xYk=r=>{this.Hwm();if(!t.AFrameworkApplication.JPc&&t.AFrameworkApplication.ua.Sb.f_f(ab.a.downloadACopy.toString()))this.zva(!0,F.a.download,!0,{});else if(t.AFrameworkApplication.K.$("WordEditorDownloadACopyUiIsEnabled")){let z=t.AFrameworkApplication.yyb;
r&&r.FileDownloadUrl&&(z=r.FileDownloadUrl.toString());new $I(z)}else super.downloadACopy(0,null,2,null,null)};this.Fqk=r=>{super.workflow(0,null,2,null,r)};this.hS=Sa.a.instance.Za("Common.ISystemInitiatedFeedback")}Vb(){super.Vb();this.ga.pa(Fb.a.openInClient,Yd.a.frame,this.Kyi);t.AFrameworkApplication.K&&t.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OICExtendedTelemetryIsEnabled",!1)&&this.ga.Vc(Fb.a.openInClient,12288);var b=this.ga;b.gb(Fb.a.V0d,kc.a.application,
fM,4);b.gb(Fb.a.fPf,kc.a.application,gM,96);this.ga.pa(ab.a.nJf,Yd.a.frame,this.Kyi)}GGb(b,h){v.ULS.sendTraceTag(50857164,211,50,"OpenInClient begin. Expect saving starting soon.");return(new hJ).begin(vb.App.bBc,t.AFrameworkApplication.yyb,PE.Word,b===ab.a.nJf?UD.OpenInBrowser:UD.WriteOnly,h,new De.a(()=>this.MW))}Ksd(b){return Df.a.instance.uza()?!0:vb.App.xa.qUi(1,tf.AppFrame.syk,b)}downloadACopy(b,h,r,z,R){if(2===r){if(!t.AFrameworkApplication.yyb&&!t.AFrameworkApplication.ua.Sb.f_f(ab.a.downloadACopy.toString()))return 8;
Qv.a.PP(2,!0,this.xYk,null,R);return 32}return super.downloadACopy(b,h,r,z,R)}Hwm(){t.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CollabCornerFloodgateDownloadCopy",!1)&&null!=this.hS&&this.hS.execute(b=>b.logActivity("CollabCornerSurveyLogDownloadACopyCommandActivity","CollabCornerFloodgateSurveysIsEnabled"))}workflow(b,h,r,z,R){return 2===r?(Qv.a.PP(13,!0,this.Fqk,null,R),32):super.workflow(b,h,r,z,R)}}Object(n.a)(jJ,"AppFrameCommandUIActor",ZI.a,[]);class kJ extends te.StandardDialog{constructor(){super();
this.Fd=0;this.xhb(CommonUIStrings.l_WheresTheSaveButtonDialogTitle,CommonUIStrings.l_WheresTheSaveButtonDialogMessage,"WheresTheSaveButtonDialogItem_32x32x32",CommonUIStrings.l_WheresTheSaveButtonDialogTitle,null,null)}}Object(n.a)(kJ,"WheresTheSaveButtonDialog",te.StandardDialog,[]);const hM=(b,h,r)=>{if(1===r)return 32;new kJ;return 32};var WF=d(567),lJ=d(1355);class Cr extends ro.a{constructor(b,h,r,z,R,ba){var ta,Wa,ub;super();this.rxj=50;this.sxj=56;this.UVg="px";this.fwj="aria-label";this.UFa=
"BookmarkIndicator";this.HHg="HighlightBookmarkedContent";this.rGj="HighlightBookmark";this.jSa="wwaengidc";this.djk="Bookmark_24";this.fb=b;this.ig=r;this.Kj=h;this.J4=z;this.vC=R;this.m0g=null===(ta=t.AFrameworkApplication.K)||void 0===ta?void 0:ta.getBooleanFeatureGate("Microsoft.Office.WordOnline.QueryBookmarkIndicatorOnSplit",!1);this.wxj=null===(Wa=t.AFrameworkApplication.K)||void 0===Wa?void 0:Wa.getBooleanFeatureGate("Microsoft.Office.WordOnline.BookmarksIsEnabled",!1);this.nxj=null===(ub=
t.AFrameworkApplication.K)||void 0===ub?void 0:ub.getBooleanFeatureGate("Microsoft.Office.WordOnline.BookmarkHighlightIsEnabled",!1);this.vC&&this.vC.fPe(this.mD.bind(this));this.KH=ba}xSn(b){if(b.Uj){for(let h of b.zg.Ii)if(this.g_f(h))return!0;return!1}return this.g_f(b.htmlElement)}eKb(b){let h=!1;t.AFrameworkApplication.Hf("bookmarks-core-ex;bookmarks-core-ex-cf");this.wxj&&(t.AFrameworkApplication.Hf("BookmarkIndicatorOnSplit;BookmarkIndicatorOnSplitcf"),this.m0g?Cp.a.instance.Pd(()=>{h=this.xSn(b)},
"BIA:SCIVE"):Cp.a.instance.Pd(()=>{h=this.g_f(b.htmlElement)},"BIA:SCI"));return h}g_f(b){return Cr.rHe?(b=b.querySelectorAll(".ParaWrappingDiv:not([style*='visibility: hidden;']) .BookmarkStart"))&&0<b.length?!0:!1:!1}oxb(b){const h=[];Cp.a.instance.Pd(()=>{const r=b.kwb(0,this.KH?this.sxj:this.rxj,this.zoom);h.push(this.IWa(b.Y6,r,b.D4c[0].y-b.E$[0].y))},"BIA:CIs");return h}IWa(b,h,r){const z=b.Ig.ownerDocument,R=um.a.createElement(z,Xk.a.div);R.className=this.KH?Cr.vxj:Cr.Oie;Cr.Oie;R.style.left=
h+this.UVg;R.style.top=r+this.UVg;this.KH?(h=um.a.createElement(z,Xk.a.div),yh.a("renderIcon")&&appChrome.api.renderIcon(this.djk,h),h.setAttribute("role","img"),h.setAttribute("alt","Bookmark")):(h=um.a.createElement(z,Xk.a.vZa),h.src=il.a.Sh(Cr.r7c),h.alt="Bookmark");h.title="Bookmark";h.setAttribute(this.fwj,"Bookmark");R.appendChild(h);b={context:new ME([],R,new Set,new Set,null,null),ONm:b,container:R};this.KH||(this.Kj.mb(jb.a.yQ,h,this.onMouseEnter),this.Kj.mb(jb.a.oK,h,this.Tma));this.ig.uE(jb.a.click,
R,this.S0a.bind(this),b);return R}Tmh(){const b=Object.assign(new Yl.a,{action:1,type:5,DF:null,iO:this.N5a});this.N5a=null;this.J4.nH(b)}mD(b,h){this.N5a&&(h.wcb.Af.classList.contains("BookmarkHighlightSelected")||this.Tmh())}onMouseEnter(b){if(null==b)return!1;b=b.Af;b.parentElement.classList.add(Cr.dwg);b.src=il.a.Sh(Cr.pxj);return!0}Tma(b){if(null==b)return!1;b=b.Af;b.parentElement.classList.remove(Cr.dwg);b.src=il.a.Sh(Cr.r7c);return!0}S0a(b){this.R1a(this.HHg,this.rGj);if(null==b){var h=new Map;
h.set("Source",this.UFa);h=Object.assign(new eb.a,{additionalValues:h});Ca.Health.instance.recordKpiFailure(this.HHg,"Unable to highlight bookmarked content",!1,!0,h);return!1}t.AFrameworkApplication.Hf("bookmarks-highlight-ex;bookmarks-highlight-ex-cf");if(this.nxj){h=b.yp.context;if(Cr.FDb(h,this.N5a))return!0;h=this.xul(b.yp.ONm,h,b.yp.container);b=Object.assign(new Yl.a,{action:0,type:5,DF:h,iO:this.N5a});this.N5a=h;this.J4.nH(b);return!0}return!1}xul(b,h,r){h={cgh:new Set,bKf:new Set,fgh:null,
vTe:null};const z=this.fb.Sw(b.zb,!0,!1);let R=[];if(z)for(let ba of z)R.push(ba);this.T3j(b,h,R);h=new ME(R,r,h.cgh,h.bKf,h.fgh,h.vTe);this.N5a&&this.N5a.lu===R&&(r.className+=String.format(" {0}",Cr.qxj),this.N5a=h);return h}T3j(b,h,r){t.AFrameworkApplication.Hf("BookmarkIndicatorOnSplit;BookmarkIndicatorOnSplitcf");if(this.m0g&&b.Uj){var z=new Set;for(let ba of b.zg.Ii)ba.querySelectorAll("*").forEach(z.add,z);b=Array.from(z.values())}else b=Array.prototype.slice.call(b.htmlElement.querySelectorAll("*"),
0);let R=[];h.bKf.add(r[0].id);h.fgh=r[0].id;h.vTe=r[0].id;b.forEach(ba=>{let ta=Ri.a.Eb(ba,wj.a.Usd);if(ta)for(let Wa of ta)R.push(Wa),h.cgh.add(Wa);if(!R.length)return!0;ba=Ri.a.Eb(ba,wj.a.Vvb);if(!ba)return!0;R=lJ.a.B3d(R,ba)});for(z=b=this.fb.Vg(r[r.length-1],!1,!0);R.length&&b;){h.bKf.add(b.id);h.vTe=b.id;r.push(b);for(let ba of z.wD)ba.htmlElement.querySelectorAll("."+wj.a.uTe).forEach(ta=>{(ta=Ri.a.Eb(ta,wj.a.Vvb))&&(R=lJ.a.B3d(R,ta))});z=b=this.fb.Vg(b,!1,!0)}}R1a(b,h){const r=new Map;r.set("Source",
this.UFa);r.set("Action",h);Ca.Health.instance.recordKpiUsage(b,0,this.jSa,r)}static FDb(b,h){return!!h&&!!b&&b.$fh===h.$fh}}Cr.dwg="WordBookmarkIndicatorContainerHovered";Cr.qxj="WordBookmarkIndicatorContainerSelected";Cr.r7c="BookmarkDefault.png";Cr.pxj="BookmarkHover.png";Cr.rHe=!0;Cr.Oie="WordBookmarkIndicatorContainer";Cr.vxj="WordBookmarkSvgIndicatorContainer";Object(n.a)(Cr,"BookmarkIndicatorActor",ro.a,[495]);class mJ{constructor(b,h,r,z,R,ba,ta,Wa,ub,Ib=null,$b=null,fc=null,Kc=null,ed=null,
Jd=null,ge=null){this.L0="_";this.sie="Bookmark";this.Qwj=/^BOOKMARK\d+$/i;this.UFa="BookmarkRibbonOptions";this.lxj="BookmarkFloatieOptions";this.Mzg="CreateBookmarkOnRange";this.Nzg="CreateBookmarkOnView";this.Lzg="CreateBookmarkOnIP";this.Mle="CreateBookmark";this.jSa="wwaengidc";this.E0g="ShowHideBookmarksOnDocument";this.YAg="DeleteBookmark";this.hBj="DeleteBookmarkAction";this.nVj="ShowHideBookmarks";this.D0g="ShowBookmarksFloatie";this.kVj="ShowBookmarksFloatieAction";this.zCg="EditBookmark";
this.dCj="EditBookmarkAction";this.Gzc="BookmarksUsage";this.hjk="InsertTabSwitchActivity";this.F6l="Insert";this.wNb=b;this.ga=h;this.ib=r;this.nl=z;this.yx=R;this.L4=ba;this.Hc=ta;this.Zv=Wa;this.Pt=$b;this.cwg=ub;this.Fe=Ib;this.s4=ed;this.zn=fc;this.Zc=Kc;this.cB=Jd;this.Ok=ge}get Sy(){return this.yx.value}Vb(){this.npf()&&(this.ga.pa(Oa.a.eKa,kc.a.view,this.eKa.bind(this)),this.ga.gb(ab.a.aQa,kc.a.application,this.Wao.bind(this),96),this.ga.pa(Oa.a.eKa,kc.a.Gd,this.cIk.bind(this)),this.ga.pa(Oa.a.eKa,
kc.a.Wc,this.bIk.bind(this)),this.ga.pa(Oa.a.deleteBookmark,kc.a.view,this.deleteBookmark.bind(this)),this.ga.pa(Oa.a.S5e,kc.a.view,this.M_k.bind(this)),this.ga.gb(Oa.a.f4i,kc.a.view,this.zXn.bind(this),1028),this.ga.gb(Oa.a.a1d,kc.a.application,this.a1d.bind(this),96),this.ga.gb(Oa.a.v8d,kc.a.Wc,this.v8d.bind(this),1028),this.ga.gb(Fb.a.VRd,kc.a.view,this.VRd.bind(this),1028),this.ga.gb(Oa.a.oLd,kc.a.view,this.oLd.bind(this),1028),this.ga.Vc(Oa.a.eKa,1028))}Wao(b,h,r,z,R){return R&&R.NewContextId===
this.F6l?(this.Z8b(this.hjk),32):2}eKa(b,h,r,z,R){var ba,ta;b=this.ib.Rg;if(!b||b.contextId===kc.a.anchoredObject)return 2;if(1===r)return ze.a.gfa(h)||Nr.a.Bwd&&(null===(ba=this.Ok)||void 0===ba?0:ba.iZ(b))||(null===(ta=this.Ok)||void 0===ta?0:ta.Jta(b))?8:32;h=this.ib.hb.kb;if(!h||this.Fe.Qm(h))return 2;this.qRc(R,"User is trying to create bookmark from UILocation : {0}");this.R1a(this.Nzg,this.Mle);if(h&&this.nl.sqd(this.dLa(),h))return this.Z8b(this.Gzc),32;R=new Map;R.set("Source",this.UFa);
R=Object.assign(new eb.a,{additionalValues:R});Ca.Health.instance.recordKpiFailure(this.Nzg,"Unable to create bookmark",!1,!0,R);return 8}cIk(b,h,r,z,R){if(1===r)return 32;if(kc.a.Gd!==h.contextId)return 8;this.qRc(R,"User is trying to create bookmark from UILocation : {0}");b=this.ib.hb.kb;if(!b)return 2;this.R1a(this.Mzg,this.Mle);if(this.nl.sqd(this.dLa(),b))return this.Z8b(this.Gzc),32;b=new Map;b.set("Source",this.UFa);b=Object.assign(new eb.a,{additionalValues:b});Ca.Health.instance.recordKpiFailure(this.Mzg,
"Unable to create bookmark for range",!1,!0,b);return 8}bIk(b,h,r,z,R){if(1===r)return 32;if(kc.a.Wc!==h.contextId)return 8;this.qRc(R,"User is trying to create bookmark from UILocation : {0}");b=this.ib.hb.kb;if(!b)return 2;this.Fe.Qm(b)&&(h=b.Qa,this.Fe.ugb(h)?(b=this.Fe.X1(h,!1),b||(v.ULS.sendTraceTag(542921105,3029,50,"User is trying to create bookmark at EOP"),b=this.Fe.X1(h,!0))):v.ULS.sendTraceTag(542921106,3029,50,"Selection is not expandable to word. Bookmark will be added on IP"));this.R1a(this.Lzg,
this.Mle);if(this.nl.sqd(this.dLa(),b))return this.Z8b(this.Gzc),32;b=new Map;b.set("Source",this.UFa);b=Object.assign(new eb.a,{additionalValues:b});Ca.Health.instance.recordKpiFailure(this.Lzg,"Unable to create bookmark for IP",!1,!0,b);return 8}a1d(b,h,r,z,R){1===r&&32;R[Yf.a.On]=Cr.rHe;return 32}zXn(b,h,r,z,R){if(1===r)return 32;this.R1a(this.E0g,this.nVj);(b=R[Yf.a.On])||v.ULS.sendTraceTag(556889756,3029,50,"User hides bookmarks annotations on document");Cr.rHe=b;b=ml.PageNavigator.instance.pT(this.Sy);
if(null!==b)return this.WWc(b),this.wNb.hG({ShowBookmarks:"CheckboxModel"}),32;b=new Map;b.set("Source",this.UFa);b=Object.assign(new eb.a,{additionalValues:b});Ca.Health.instance.recordKpiFailure(this.E0g,"Unable to show/hide bookmark on document",!1,!0,b);return 8}deleteBookmark(b,h,r,z,R){if(this.npf()){b=this.ib.hb.kb;if(!b)return 2;b=b.Qa;b=this.nl.YHc(b.node,b.cpBegin);if(1===r)return b?32:8;this.qRc(R,"User is trying to delete bookmark from UILocation : {0}");this.Zv.KZ&&(v.ULS.sendTraceTag(545118155,
3029,50,"Dismissing the bookmarks floatie"),this.Zv.qw());this.R1a(this.YAg,this.hBj);b||v.ULS.sendTraceTag(545118156,3029,50,"Delete bookmark called for a context where there were no bookmarks.");if(b&&this.nl.PRf(b.id))return this.cwg&&this.cwg.Tmh(),this.Z8b(this.Gzc),32;r=new Map;r.set("Source",this.UFa);r=Object.assign(new eb.a,{additionalValues:r});Ca.Health.instance.recordKpiFailure(this.YAg,"Unable to delete bookmark",!1,!0,r);return 8}return 2}M_k(b,h,r,z,R){if(t.AFrameworkApplication.K&&
t.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.BookmarkEditNameIsEnabled",!1)){b=this.ib.hb.kb;if(!b)return 2;b=b.Qa;b=this.nl.YHc(b.node,b.cpBegin);if(1===r)return b?32:8;this.qRc(R,"User is trying to edit bookmark from UILocation : {0}");this.Zv.KZ&&(v.ULS.sendTraceTag(539762822,3029,50,"Dismissing the bookmarks floatie"),this.Zv.qw());this.R1a(this.zCg,this.dCj);b||v.ULS.sendTraceTag(539762823,3029,50,"Edit bookmark called for a context where there were no bookmarks.");
if(b)return this.s4.value.N_k(h,b,this.nl),this.Z8b(this.Gzc),32;h=new Map;h.set("Source",this.UFa);h=Object.assign(new eb.a,{additionalValues:h});Ca.Health.instance.recordKpiFailure(this.zCg,"Unable to edit bookmark",!1,!0,h);return 8}return 2}qRc(b,h){b&&b.UILocation&&v.ULS.sendTraceTag(540386525,3029,50,h,b.UILocation)}v8d(b,h,r,z,R){if(t.AFrameworkApplication.K&&t.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.BookmarksFloatie",!1)){1===r&&32;this.R1a(this.D0g,this.kVj);
if(h.contextId===kc.a.Wc)return b=Array(1),b.push("Bookmarks"),this.Zv.showFloatie(R.location,b,1),32;R=new Map;R.set("Source",this.lxj);R=Object.assign(new eb.a,{additionalValues:R});Ca.Health.instance.recordKpiFailure(this.D0g,"Unable to show bookmark floatie",!1,!0,R);return 8}return 2}VRd(b,h,r,z,R){let ba;return 1===r?(Cp.a.instance.Pd(()=>{ba=this.ga.Qf(h,Fb.a.insertHyperlink,r,!0,z,R);32!==ba&&(ba=this.ga.Qf(h,Oa.a.eKa,r,!0,z,R))},"BA:LFE"),ba):8}oLd(b,h,r){var z;if(1===r)return 32;if(b=this.ib.hb.kb){b=
b.Qa.node;if(h=this.bGh(b))return h.click(),32;v.ULS.sendTraceTag(539523265,3029,50,"No indicator found in current paragraph.");if(b=this.nl.YHc(b,0)){b=this.cB.Mja.get(null===(z=b.id)||void 0===z?void 0:z.toString());z=ml.PageNavigator.instance.pT(this.Sy).Lc.Eb(b);if(z=this.bGh(z))return z.click(),32;v.ULS.sendTraceTag(539523266,3029,50,"No indicator found for the paragraph in previous paragraphs.")}else v.ULS.sendTraceTag(539523267,3029,50,"No bookmark found enclosing the content.")}return 2}bGh(b){let h;
b=this.zn.Uk(b).Ni(this.Zc.xd.Tb);b.E6b&&(b=b.htmlElement.querySelectorAll("div."+Cr.Oie),0<b.length&&(h=b[0]));return h}WWc(b){const h=WF.b(b);if(h){var r=this.Hc.Rc(2);try{for(r.Db(b);h.moveNext();){if(!ie.ParagraphReader.zh(h.iterator))continue;const z=h.currentNode;this.TZk(z)&&this.L4.D5b(z,!0)}}finally{r&&r.dispose()}}}TZk(b){for(let r=0;r<b.qa.length;r++){const z=b.qa.J(r);if(null!=z.Lh)for(let R=0;R<z.Lh.length;R++){var h=z.Lh.J(R);if(null!=h&&(h=b.Lc.Eb(h.qn).ia(yc.a.Ts,""),!B.a.mf(h)&&!h.startsWith(this.L0)))return!0}}}dLa(){var b=
this.nl.eHc(!1);let h=[];for(let r=0;r<b.count;r++){let z=b.J(r).ia(yc.a.Ts,"");this.Qwj.test(z)&&h.push(z)}return 0<h.length?(h.sort((r,z)=>r.localeCompare(z,void 0,{numeric:!0})),b=parseInt(h[h.length-1].substring(this.sie.length)),this.sie+(b+1)):this.sie+1}R1a(b,h){const r=new Map;r.set("Source",this.UFa);r.set("Action",h);Ca.Health.instance.recordKpiUsage(b,0,this.jSa,r)}Z8b(b){this.npf()&&this.Pt&&this.Pt.execute(h=>{h.logActivity(b,null)})}npf(){t.AFrameworkApplication.Hf("bookmarks-core-ex;bookmarks-core-ex-cf");
return t.AFrameworkApplication.K&&t.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.BookmarksIsEnabled",!1)}}Object(n.a)(mJ,"BookmarkActor",null,[]);class nJ{constructor(b,h,r){this.zc=b;this.CVk=h;this.Sg=r;this.SXe=this.SXe.bind(this)}Vb(){this.zc.pa(Oa.a.Pvf,kc.a.view,this.SXe);this.zc.gb(Oa.a.c1d,kc.a.view,Eh.a.PQ,96);this.zc.gb(Oa.a.e1d,kc.a.view,Eh.a.PQ,96);this.zc.gb(Oa.a.d1d,kc.a.view,Eh.a.PQ,96);this.zc.pa(Oa.a.UYd,kc.a.view,Eh.a.BF);this.zc.pa(Oa.a.WYd,kc.a.view,
Eh.a.BF);this.zc.pa(Oa.a.VYd,kc.a.view,Eh.a.BF)}SXe(b,h,r,z,R){return 1===r?32:(b=this.Sg.u$(h.vk))?(R=3===R.Ww,this.CVk.value.gth(this.oFl(b),this.KOl(b),R),32):2}oFl(b){const h=new Ei.DictionaryPropertySet;h.setValue(Li.a.KC,this.Sg.kh(b));h.setValue(Li.a.Kx,this.Sg.tea(b));h.setValue(Li.a.iW,this.Sg.Qzb(b));return h}KOl(b){const h=new Ei.DictionaryPropertySet;h.setValue(yc.a.marginLeft,this.Sg.BL(b));h.setValue(yc.a.marginRight,this.Sg.CL(b));h.setValue(yc.a.Lo,this.Sg.Jv(b));return h}}Object(n.a)(nJ,
"ColumnsDialogActor",null,[]);class oJ{constructor(b,h,r,z,R,ba,ta,Wa,ub,Ib,$b){this.No=b;this.Kpa=h;this.mg=r;this.rs=z;this.qm=R;this.Vd=ba;this.Hc=ta;this.He=Wa;this.ga=ub;this.GIj=Ib;this.Tve=$b}get bbm(){return this.GIj}Vb(){this.ga.gb(Fb.a.j0f,kc.a.view,this.l5l.bind(this),96);this.ga.gb(Fb.a.HXc,kc.a.view,this.HXc.bind(this),4)}l5l(b,h,r,z,R){b=this.No.getById(R);if(!b)return 8;h=b.contentControlNode;if(!h)return 8;if(h.ia(yc.a.J5,!1))return 2;r=this.No.cnl(b);if(!r)return 8;z=this.Hc.Rc(7);
z.Db(r.node);if(!this.bbm)return(R=b.J_d)||(R=WordEditorIntl.WordEditorStrings.l_ContentControlPlaceholder),this.Vd.replaceTextRange(r,R),this.hsd(b),h.setValue(yc.a.J5,!0),z.dispose(),32;R=new Ei.DictionaryPropertySet;R.setValue(od.a.M1h,r);var ba=h.ia(yc.a.oZe,"");ba=this.Kpa.W0h(ba);if(!ba)return this.rs.replaceTextRange(r,WordEditorIntl.WordEditorStrings.l_ContentControlPlaceholder),this.hsd(b),h.setValue(yc.a.J5,!0),z.dispose(),32;R.setValue(od.a.wjf,ba);if(1<ba.length&&!b.Vf)return z.dispose(),
8;this.zGk(R);h.setValue(yc.a.J5,!0);z.dispose();return 32}HXc(b,h,r){var z=h.view.ze?h.view:null;if(!z||!z.Cb)return 8;if(Nr.a.eEk)return this.Yon(z,r);h=z.Cb.hb.J(0);b=this.qm.rea(h.Qa,h.Tc,1);if(!b||0==b.count)return 8;var R=this.qm.rea(h.Qa,h.Tc,3);h=new Ub.a;if(R&&0<R.count){for(var ba of R)h.add(ba.id,ba);for(ba=b.count-1;0<=ba;ba--)h.xb(b.J(ba).id)&&b.removeAt(ba);0==b.count&&(ba=R.J(0),b.add(ba))}for(ba=0;ba<b.count;ba++)R=b.J(ba),h.add(R.id,R);if(1===r){for(r=b.count-1;0<=r;r--)if(z=b.J(r),
ba=h.J(z.parentId),this.ZNd(z,ba))return 32;return 8}if(2===r){r=this.Hc.Rc(15);r.Db(z.rd);for(z=b.count-1;0<=z;z--)ba=b.J(z),R=h.J(ba.parentId),this.ZNd(ba,R)&&this.No.xjb(ba.id);r.dispose();return 32}return 2}Yon(b,h){const [r,z]=this.wIl(b.Cb.hb);if(0===r.length)return 8;if(1===h){for(var R of r){var ba=z.get(R.parentId);if(this.ZNd(R,ba))return 32}return 8}if(2===h){h=this.y_n(r,z);R=this.Hc.Rc(15);R.Db(b.rd);for(ba of h)b=z.get(ba.parentId),this.ZNd(ba,b)&&this.No.xjb(ba.id);R.dispose();return 32}return 2}wIl(b){var h,
r,z=[];for(const ba of b)z.push(...(null!==(h=this.qm.rea(ba.Qa,ba.Tc,1))&&void 0!==h?h:[]));if(0===z.length)return[z,new Map];h=[];for(const ba of b)h.push(...(null!==(r=this.qm.rea(ba.Qa,ba.Tc,3))&&void 0!==r?r:[]));b=new Map(z.map(ba=>[ba.id,ba]));if(0===h.length)return[z,b];const R=new Map(h.map(ba=>[ba.id,ba]));z=z.filter(ba=>!R.has(ba.id));b=new Map([...b,...R]);return 0==z.length?[[h[0]],b]:[z,b]}hsd(b){const h=this.rs.aHd(b.start.node,0<=b.start.cpBegin?b.start.cpBegin:0);h?this.Tve&&(b=this.He.Qx(b.start.node).xh("Placeholder Text"))&&
(this.mg.Wja(h.formatting),this.mg.Ckb(h.formatting,b)):v.ULS.sendTraceTag(20492441,368,15,"Unable to get a ChP at starting Ip of Content Control")}zGk(b){this.ga.Xb(Fb.a.showPlaceholderGlossary,2,b)}ZNd(b,h){return b.afa&&b.djm&&(!h||h.isEditable)}y_n(b,h){const r=(z,R)=>null==z||null==R||z.id===R.id?!1:z.id===R.parentId||r(h.get(z.parentId),R);return b.slice().sort((z,R)=>r(z,R)?1:r(R,z)?-1:0)}}Object(n.a)(oJ,"ContentControlActor",null,[]);class WD{constructor(b){this.ga=b;this.primaryButtonText=
"Count me in";this.secondaryButtonText="Cancel";this.O9j=["We are gauging interest in a feature that would let you","customize your ribbon in Word on the web. Click below","to vote or comment on this idea, as well as follow it","status updates. Thank you."];this.$8n="Interested in this feature?"}Vb(){this.ga.pa(Oa.a.$1e,kc.a.view,this.q8l.bind(this))}q8l(b,h,r){2===r&&(Object(Lb.c)(Oa.a.$1e),b=new te.StandardDialog,b.Fd=4,b.Ve(1,this.primaryButtonText),b.Ve(2,this.secondaryButtonText),b.Zxc(this.O9j,
null),b.Pv(this.$8n,null,0,this.S9));return 32}S9(b){1===b&&(Object(Lb.a)("CountMeIn_CustomizeRibbon",!0),B.a.aX(WD.pjj)&&Ed.a.Cm(WD.pjj))}}WD.pjj="https://feedbackportal.microsoft.com/feedback/idea/974fe330-6613-ed11-b83e-000d3a4d92e4";Object(n.a)(WD,"CustomizeRibbonActor",null,[]);var sy=d(1038);class XF extends Wc.a{constructor(b,h,r){super(!1,!1,!0);this.MOg=[Box4Intl.Box4Strings.l_CustomTabDialogLeaderNone,sy.a.jQe,sy.a.iQe,sy.a.kQe];this.gwj=[Box4Intl.Box4Strings.l_CustomTabDialogLeaderNone,
sy.a.Z$j,sy.a.Y$j,sy.a.aak];this.uug=[Box4Intl.Box4Strings.l_CustomTabDialogAlignLeft,Box4Intl.Box4Strings.l_CustomTabDialogAlignCenter,Box4Intl.Box4Strings.l_CustomTabDialogAlignRight];this.Kec=()=>{new XF(this.ga,this.kJe,this.Xlc)};this.Nvl=()=>{const z=[];for(let R of this.kJe)z.push(this.I3(R));return z};this.Zlo=z=>{const R=new Set;this.xpa="";for(let ba of z)if(""!==ba.position){const ta=this.iVh(ba.position);if(0>ta||22<ta){this.xpa=Box4Intl.Box4Strings.l_CustomTabDialogDefaultTabStopBounds;
break}if(R.has(ta)){this.xpa=Box4Intl.Box4Strings.l_CustomTabDialogMultipleTabStopsSamePosition;break}else this._tabStops.push(this.p9n(ba)),R.add(ta)}else{this.xpa=Box4Intl.Box4Strings.l_CustomTabDialogEmptyPosition;break}""!==this.xpa&&(this._tabStops=[],this.kJe=z)};this.YPk=(z,R)=>{try{if(1===z){if(""!==this.xpa)throw Error.create(this.xpa);R.DefaultTabStop&&(this.Xlc=sy.a.tVf(R.DefaultTabStop),this.mpo(this.Xlc));if(32!==this.ga.Xb(Oa.a.bMb,2,{["tabStops"]:this._tabStops,["defaultTabStopLength"]:pg.a.BA(this.Xlc)}))throw Error.create(Box4Intl.Box4Strings.l_CustomTabDialogSaveError);
}}catch(ba){this.Eva(ba.message,this.Kec)}};this.ga=b;this.kJe=h;this._tabStops=[];this.Xlc=r;this.xpa="";b={["id"]:"CustomTabDialog",["bodyControls"]:this.qHc()};this.Wh(Box4Intl.Box4Strings.l_CustomTabDialogTitle,this.YPk,b)}I3(b){return{["position"]:b.position,["alignment"]:b.alignment,["leader"]:b.leader}}iVh(b){return Math.floor(100*parseFloat(b))/100}p9n(b){return new lv.a(pg.a.BA(this.iVh(b.position)),sy.a.$Kl(b.alignment),sy.a.YKl(b.leader),1)}mpo(b){if(0>b||22<b)throw Error.create(Box4Intl.Box4Strings.l_CustomTabDialogDefaultTabStopBounds);
var h={};if(32===this.ga.Xb(Fb.a.EDa,2,h)){var r=h.marginLeft;const z=Rf.a.Pi(h.marginRight,0);r=Rf.a.Pi(r,0);h=Rf.a.Pi(h.Lo,0);if(Rf.a.B$(b,0,!1)>=h-z-r)throw Error.create(Box4Intl.Box4Strings.l_CustomTabDialogDefaultTabStopMarginIndentCheck);}}qHc(){return{["getInitState"]:this.Nvl,["updateState"]:this.Zlo,["validPositions"]:this.sZh(-Infinity,Infinity,"Position"),["validAlignments"]:this.fOh(this.uug,this.uug,null,"Alignment"),["validLeaders"]:this.fOh(this.MOg,this.MOg,this.gwj,"Leader"),["defaultTabStopSpinButtonProps"]:this.sZh(.01,
22,"DefaultTabStops"),["defaultTabStopLength"]:this.Xlc,["DefaultTabStop"]:"DefaultTabStop",["addButtonText"]:Box4Intl.Box4Strings.l_CustomTabDialogAddButton,["clearAllButtonText"]:Box4Intl.Box4Strings.l_CustomTabDialogClearAllButton,["positionHeaderText"]:Box4Intl.Box4Strings.l_CustomTabDialogPosition,["alignmentHeaderText"]:Box4Intl.Box4Strings.l_CustomTabDialogAlignment,["leaderHeaderText"]:Box4Intl.Box4Strings.l_CustomTabDialogLeader,["defaultTabStopText"]:Box4Intl.Box4Strings.l_CustomTabDialogDefaultTabStops,
["addNewTabStopHeader"]:Box4Intl.Box4Strings.l_CustomTabDialogAddNewTabStopHeader,["addNewTabStopDescription"]:Box4Intl.Box4Strings.l_CustomTabDialogAddNewTabStopDescription,["deleteButtonTooltip"]:Box4Intl.Box4Strings.l_CustomTabDialogDeleteButtonTooltip}}sZh(b,h,r){return{["type"]:"AppSpinButtonProps",["id"]:"CustomTabDialogSpinButtonPosition",["label"]:r,["unitType"]:"Inch",["validUnits"]:[hz("Inch",3,b,h,.1)],["numberFormatInfo"]:DF()}}fOh(b,h,r,z){return{["type"]:"AppComboBoxProps",["id"]:"CustomTabDialogComboBox",
["label"]:z,["options"]:DE(b,h,r)}}}Object(n.a)(XF,"CustomTabDialog",Wc.a,[]);class pJ{constructor(b,h,r){this.K9b=(z,R,ba,ta,Wa)=>{if(2!==ba)return 8;if(!Wa)return 16;z=Wa.tabStop;Wa=Wa.value;if(!z)return 16;Lb.c(Oa.a.K9b);Wa=new lv.a(Wa,z.pba,z.zma,z.S3f);R=R.node;this.fxa.X1a(R,z);this.fxa.yMd(R,Wa);return 32};this.d_c=(z,R,ba,ta,Wa)=>{if(2===ba){if(!Wa)return 16;this.fxa.yMd(R.node,Wa);return 32}return 8};this.IHb=(z,R,ba,ta,Wa)=>{z=this.fxa.bKi(R.node);if(!("customTabs"in Wa))return Wa.customTabs=
z,32;R=Wa.customTabs;if(!R||0>=R.length||!z||0>=z.length)return Wa.customTabs=null,32;ba=[];for(let ub of R)for(let Ib of z)if(Ib.GEa===ub.GEa&&Ib.S3f===ub.S3f&&Ib.pba===ub.pba){ba.push(ub);break}Wa.customTabs=ba;return 32};this.X1a=(z,R,ba,ta,Wa)=>{if(2===ba){if(!Wa)return 16;Lb.c(Oa.a.X1a);this.fxa.X1a(R.node,Wa);return 32}return 8};this.qIb=(z,R)=>{this.fxa.qIb(R.node);return 32};this.bMb=(z,R,ba,ta,Wa)=>{if(2===ba){if(!Wa)return 16;z=Wa.tabStops;ba=Wa.defaultTabStopLength;R=R.node;ta=!1;let ub=
this.fxa.Ytn(R,z);Wa.defaultTabStopLengthSaved||(ta=this.BJ.VIn(R,ba),Wa.defaultTabStopLengthSaved=!0);ub&&Lb.d(Oa.a.bMb,!0,void 0,void 0,void 0,void 0,[Object.assign(new ca.a,{name:"Custom Tab Stops Count",string:z.length.toString()})]);if(null==ta)return v.ULS.sendTraceTag(571479714,3015,15,"Could not set Default Tab Stop Length."),16;ta&&(this.iYc&&this.iYc.v$h(),this.Qd.zs(11,Box4Intl.Box4Strings.l_CustomTabDialogDefaultTabStopTrackingAlert),Lb.d(Oa.a.bMb,!0,void 0,void 0,void 0,void 0,[Object.assign(new ca.a,
{name:"Default Tab Stop Length",string:ba.toString()})]));return 32}return 8};this.r4i=(z,R,ba)=>{if(2!==ba)return 8;z={};if(32!==this.ga.Xb(Oa.a.yL,2,z))return v.ULS.sendTraceTag(572072071,3015,15,"Could not read Default Tab Stop Length."),16;R={};if(32!==this.ga.Xb(Fb.a.EDa,2,R))return v.ULS.sendTraceTag(572072072,3015,15,"Could not read Section Properties."),16;z=sy.a.tVf(pg.a.kC(z.defaultTabStop));ba={};ba.defaultTabStopLength=z;ba.sectionPropertiesData=R;if(32!==this.ga.Xb(Oa.a.e$f,2,ba))return v.ULS.sendTraceTag(572072073,
3015,15,"Could not validate Paragraphs against indents and default tab stop."),16;if(!ba.isParagraphValid)return v.ULS.sendTraceTag(572072074,3015,15,"Could not open Custom Tab Stop Dialog since all selected paragraphs failed validation."),this.fxa.Eva(Box4Intl.Box4Strings.l_CustomTabDialogIndentError),8;R={};if(32!==this.ga.Xb(Oa.a.IHb,2,R))return v.ULS.sendTraceTag(572072075,3015,15,"Could not read Custom Tab Stops."),16;(R=R.customTabs)||(R=[]);R=sy.a.ZKl(R);new XF(this.ga,R,z);Lb.c(Oa.a.Kec,!0);
return 32};this.Lhm=(z,R,ba,ta,Wa)=>{if(2!==ba)return 8;if(!Wa)return 16;if(Wa.isParagraphValid)return 32;ba={};if(32!==this.ga.Qf(R,Fb.a.K1a,2,!1,null,ba))return 16;z=Wa.sectionPropertiesData;R=Wa.defaultTabStopLength;var ub=ba.Ws;ta=ub.Pla;ub=1===ub.specialIndentType?ub.DA:ub.DA-ub.kba;const Ib=z.marginLeft,$b=z.marginRight;ba.isRtl?(ba=Rf.a.Pi(Math.max($b,$b+ta),0),ta=Rf.a.Pi(Math.max(Ib,Ib+ub),0)):(ba=Rf.a.Pi(Math.max(Ib,Ib+ub),0),ta=Rf.a.Pi(Math.max($b,$b+ta),0));z=Rf.a.Pi(z.Lo,0);R=Rf.a.B$(R,
0,!1);Wa.isParagraphValid=R<z-ba-ta;return 32};this.ga=b;this.fxa=h;this.BJ=r}get Qd(){return null!=this.Trg?this.Trg:this.Trg=Sa.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance}get iYc(){return null!=this.Npg?this.Npg:this.Npg=Sa.a.instance.Pa("WordEditor.Actors.RenderParagraphsContainingTabs")}Vb(){const b=vb.App.K3a.vxd(h=>nw.OutlineElementGeneralizer.$ka(h.hb,!0),!0);this.ga.pa(Oa.a.IHb,kc.a.view,b);this.ga.gb(Oa.a.IHb,kc.a.paragraph,this.IHb,96);this.ga.pa(Oa.a.X1a,
kc.a.view,b);this.ga.gb(Oa.a.X1a,kc.a.paragraph,this.X1a,96);this.ga.pa(Oa.a.qIb,kc.a.view,b);this.ga.gb(Oa.a.qIb,kc.a.paragraph,this.qIb,96);this.ga.pa(Oa.a.d_c,kc.a.view,b);this.ga.gb(Oa.a.d_c,kc.a.paragraph,this.d_c,96);this.ga.pa(Oa.a.K9b,kc.a.view,b);this.ga.gb(Oa.a.K9b,kc.a.paragraph,this.K9b,96);this.ga.pa(Oa.a.bMb,kc.a.view,b);this.ga.gb(Oa.a.bMb,kc.a.paragraph,this.bMb,96);this.ga.pa(Oa.a.e$f,kc.a.view,b);this.ga.gb(Oa.a.e$f,kc.a.paragraph,this.Lhm,96);this.ga.pa(Oa.a.Kec,kc.a.view,this.r4i);
this.ga.pa(Oa.a.l9h,kc.a.view,this.r4i)}}Object(n.a)(pJ,"CustomTabActor",null,[]);var iM=d(127),UE=d(637);class qJ{constructor(b,h,r,z,R,ba,ta,Wa,ub){this.ga=b;this.ppd=r;this.YFa=(this.MUb=R)&&z;this.Do=ba;this.BV=ta;this.KAj=Wa;this.Hw=ub;this.cwj=h;this.MUb&&yh.a("isSharedUXDarkModeOn")?(this.Do.sL=appChrome.api.isSharedUXDarkModeOn(),this.Ani(!0)):this.Do.sL=!1;this.YFa?this.jmi(!0):this.Do.w3a=!1;t.AFrameworkApplication.xK(()=>{this.lTc()});this.YFa&&yh.a("dispatch")&&appChrome.api.dispatch(this.I9i([]))}Vb(){this.YFa&&
(this.ga.pa(Oa.a.F9n,kc.a.view,this.mQk.bind(this)),this.ga.pa(Oa.a.c0c,kc.a.view,this.c0c.bind(this)),this.ga.gb(Oa.a.yWc,kc.a.view,this.yWc.bind(this),96));this.MUb&&(this.ga.pa(Oa.a.R7d,kc.a.view,this.R7d.bind(this)),this.ga.gb(Oa.a.R1d,kc.a.view,this.R1d.bind(this),96))}f8l(b){if(!this.ETn(b))return!1;const h=$m.a.instance.Rc(2);try{h.Db(b.root);const r=Nd.GraphIterator.$a(b.root.graphNode),z=xi.a.Xp(r);for(;z.moveNext();){const R=Object(la.a)(iM.a,z.currentNode);R&&R.dH(b.Tb,20,!0)}}finally{h&&
h.dispose()}return!0}ETn(b){return b&&b.root&&b.Qr?b.wi||b.crf||b.$ci||b.Dj:!1}Wvn(){let b=!1;this.ppd.forEach(h=>{this.f8l(h)&&(b=!0)});return b}G9n(){v.ULS.sendTraceTag(570566656,3023,50,"Toggle Dark Mode for canvas fishbowl to {0} mode",this.Do.sL?"dark":"light");return this.Do.sL?UE.a.dyc(1):UE.a.nNi(1)}N5f(){const b=this.Do.wda;v.ULS.sendTraceTag(571524678,3023,50,"Toggle canvas Dark Mode to {0} mode",b?"dark":"light");if(!this.Wvn()||(b?!UE.a.dyc(0):!UE.a.nNi(0)))return!1;this.KAj.ven(b);return!0}I9i(b){b.push(appChrome.actions.updateControlHiddenState("DarkModeSwitchBackgroundStatusBar",
!this.Do.sL));b.push(appChrome.actions.setControlIconSet("DarkModeSwitchBackgroundStatusBar",this.VZh(!0)));try{WordRibbonStrings?b.push(appChrome.actions.setControlCustomTooltip("DarkModeSwitchBackgroundStatusBar",this.Do.w3a?WordRibbonStrings.DarkModeSwitchBackgroundTooltipDark:WordRibbonStrings.DarkModeSwitchBackgroundTooltipLight)):v.ULS.sendTraceTag(527283228,3023,10,"Trying to access WordRibbonStrings when it's undefined")}catch(h){v.ULS.sendTraceTag(527282835,3023,10,h)}return b}mQk(){return this.N5f()?
32:8}R7d(b,h,r){if(1===r)return 32;b=this.BV.hg("UserAction","sharedUXDarkModeToggle");if(yh.a("toggleSharedUXDarkMode"))v.ULS.sendTraceTag(571524677,3023,50,"Requesting to toggle Dark Mode for the Shared UX."),appChrome.api.toggleSharedUXDarkMode(),yh.a("isSharedUXDarkModeOn")?this.Do.sL=appChrome.api.isSharedUXDarkModeOn():this.Do.sL=!this.Do.sL,v.ULS.sendTraceTag(529388308,3023,50,"User in new ribbonMode: {0}",this.Do.sL);else return 8;appChrome.getHeaderApi().then(z=>{z.hasOwnProperty("refreshThemeOverride")&&
z.refreshThemeOverride()});this.G9n()||v.ULS.sendTraceTag(561553416,3023,15,"Failed to toggle Dark mode for Fishbowl");this.YFa&&!this.Do.w3a&&(this.N5f()||v.ULS.sendTraceTag(561553417,3023,15,"Failed to toggle Dark mode for Canvas"));h={};h.DarkModeToggle=appChrome.selectors.getModelType("DarkModeToggle");vb.App.xa.hG(h);appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("DarkModeSwitchBackground",!this.Do.sL));this.YFa&&appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("DarkModeSwitchBackgroundStatusBar",
!this.Do.sL));b.stop();v.ULS.sendTraceTag(555885377,3023,50,"{0}",b.oi);return 32}c0c(b,h,r){if(1===r)return 32;b=this.BV.hg("UserAction","sharedUXDarkModeSwitchBackground");v.ULS.sendTraceTag(561088148,3023,50,"Requesting to toggle Dark Mode for the switch background UX.");this.Do.w3a=!this.Do.w3a;if(!this.N5f())return 8;h={};h.DarkModeSwitchBackground=this.Hw?"ButtonModel":"ToggleButtonModel";vb.App.xa.hG(h);b.stop();v.ULS.sendTraceTag(555885378,3023,50,"{0}",b.oi);v.ULS.sendTraceTag(529388309,
3023,50,"User in new canvasMode: {0}",this.Do.w3a);return 32}R1d(b,h,r,z,R){if(1===r)return 32;if(!R)return 2;yh.a("isSharedUXDarkModeOn")&&(this.Do.sL=appChrome.api.isSharedUXDarkModeOn());R&&(R[Yf.a.On]=this.Do.sL);return 32}yWc(b,h,r,z,R){if(1===r)return 32;if(!R)return 2;!this.Hw&&R&&(R[Yf.a.On]=this.Do.w3a);b=[];b.push(appChrome.actions.updateControlHiddenState("DarkModeSwitchBackground",!this.Do.sL));this.YFa&&this.I9i(b);b.push(appChrome.actions.setControlIconSet("DarkModeSwitchBackground",
this.VZh(!1)));appChrome.api.dispatch(b);return 32}VZh(b){const h={};this.Do.w3a?b?h["default"]="MoonMonochromatic_16":(h["default"]="MoonMonochromatic_20",h.icon32="MoonMonochromatic_32"):b?h["default"]="SunMonochromatic_16":(h["default"]="SunMonochromatic_20",h.icon32="SunMonochromatic_32");return h}lTc(){this.MUb&&this.Ani(!1);this.YFa&&this.jmi(!1)}Ani(b){var h;v.ULS.sendTraceTag(561088149,3023,50,"Shared dark mode state. IsBoot: {0}; State: {1}; DefaultOn: {2}",b,this.Do.sL?"dark":"light",this.Do.fAa);
b&&this.Do.sL!=(null===(h=this.cwj)||void 0===h?void 0:h.$("DarkModeIsOn"))&&v.ULS.sendTraceTag(522303360,3023,15,"Inconsistent dark mode value is found during boot. Dark mode toggle: {0}. DefaultOn: {1}.",this.Do.sL?"dark":"light",this.Do.fAa)}jmi(b){v.ULS.sendTraceTag(561088150,3023,50,"Canvas dark mode state. IsBoot: {0}; State: {1}; DarkCanvasPreferred: {2}",b,this.Do.wda?"dark":"light",this.Do.lQk)}}Object(n.a)(qJ,"DarkModeActor",null,[]);var rJ=d(1555);class VE{constructor(){this.Height=this.Width=
0}static construct(b,h){const r=new VE;r.Width=b;r.Height=h;return r}}Object(n.a)(VE,"ViewportInfo",null,[]);class YF extends rn.a{constructor(){super();this.ContractVersion=0;this.World=this.EnhancementId=this.DocumentContent=null;this.ScalingFactor=0;this.MobileViewportInfo=this.DesktopViewportInfo=null;this.MinParagraphCount=0;this.ContentCulture=null}Wl(){return 85}static construct(b,h,r,z,R,ba,ta,Wa,ub,Ib,$b){const fc=new YF;fc.ContractVersion=b;fc.DocumentContent=h;fc.EnhancementId=r;fc.World=
z;fc.ScalingFactor=R;fc.DesktopViewportInfo=VE.construct(ba,ta);fc.MobileViewportInfo=VE.construct(Wa,ub);fc.MinParagraphCount=Ib;fc.ContentCulture=$b;return fc}}Object(n.a)(YF,"SwayPreviewRequest",rn.a,[]);var jM=d(600);class LC{static get vg(){return Wc.a.Px(LC.sl,WordEditorIntl.WordEditorStrings.L_DigitalPrintLearnMore,WordEditorIntl.WordEditorStrings.L_DigitalPrintDialogStyleLabel,WordEditorIntl.WordEditorStrings.L_DigitalPrintDialogPreviewLabel,LC.hBn,WordEditorIntl.WordEditorStrings.l_SavingStatus)}}
LC.hBn=il.a.Sh("progress.gif");LC.sl="<div class='WACDialogRow digitalPrintDialogWrapper UIFont' id='homeWrapper'> <div class='swayContentMain' id='swayContentMain'> <span id='mainText' class='swayMainDescription'>''</span> <a id='digitalPrintLearnMoreLink' class='swayHyperlink' href='' target='_blank' >{0}</a> </div> <div class='swayContentWrapper' id='swayContentWrapper'> <div class='swayGalleryWrapper' id='swayGalleryWrapper'> <label id='styleLabel' class='swayStyleContentSubHeader' role='heading' aria-level='1' >{1}</label> <div class='swayGallery' id='swayGallery' aria-labelledby='styleLabel'></div> </div> <div class='swayPreviewWrapper' id='swayPreviewWrapper'> <label id='previewLabel' class='swayPreviewContentSubHeader' role='heading' aria-level='1'>{2}</label> <div class='swayDesktopPreviewWrapper' id='swayDesktopPreviewWrapperDiv'> <div class='digitalPrintStatusMessageWrapper' id='digitalPrintStatusMessageWrapperDiv'> <img id='digitalPrintStatusMessageIconDiv' class='digitalPrintStatusMessageIcon' role='presentation' src={3} /> <label id='digitalPrintStatusMessageDiv' class='digitalPrintStatusMessage' >string.Empty</label> </div> <div class='swayDesktopPreview' id='swayDesktopPreviewHtmlHolder'> </div> </div> <div class='swayMobilePreviewWrapper' id='swayMobilePreviewWrapperDiv'> <div class='swayMobilePreview' id='swayMobilePreviewHtmlHolder'> </div> </div> <div class='swayPreviewContentWrapper' id='swayPreviewContentWrappereDiv'> <div class='swayPreviewFrame swayPreviewFrameBackground' id='swayPreviewFrameDiv'> </div> <div class='digitalPrintSaving' id='digitalPrintSavingDiv'> <img id='digitalPrintSavingIcon' class='digitalPrintSavingIcon' role='presentation' src={3} /> <span id='digitalPrintSaving' class='digitalPrintSavingDescription'>{4}</span> </div> </div> </div> </div> </div>";
Object(n.a)(LC,"DigitalPrintDialogHtml",null,[]);class uv{constructor(b,h,r,z){this.fontFamily=b;this.MYc=h;this.fontWeight=r;this.fontStyle=z}}Object(n.a)(uv,"FontInfo",null,[]);class Dr{constructor(b,h,r,z){this.styleName=b;this.title=h;this.Z8n=r;this.FXl=z}}Object(n.a)(Dr,"StyleVisualInfo",null,[]);class VB extends Wc.a{constructor(b,h,r,z,R=!0){super();this.F4=this.Zn=this.Bia=this.R0=this.Nbd=this.f2g=this.knd=this.bJe=this.cJe=this.tIe=this.iVb=this.FIa=this.b1=this.zUb=null;this.VLe=this.rEe=
!1;this.Had=null;this.yZk=()=>{this.LUi(0)};this.xZk=(ba,ta)=>{this.LUi(ta)};this.RAi=ba=>{this.fTh(ba)===Sys.UI.Key.enter&&(this.zIf(ba),ba.preventDefault(),ba.stopPropagation())};this.uxi=ba=>{((ba=ba.rawEvent.relatedTarget)&&("digitalPrintLearnMoreLink"===ba.id||ba.id===mg.a.o6c)||X.a.Ak)&&this.FIa&&this.FJb(this.FIa)};this.vxi=ba=>{const ta=this.fTh(ba);ta!==Sys.UI.Key.tab&&ta!==Sys.UI.Key.left&&ta!==Sys.UI.Key.right&&ta!==Sys.UI.Key.up&&ta!==Sys.UI.Key.down||this.JUl(ta)||(ba.preventDefault(),
ba.stopPropagation(),this.ySm(ta))};this.EGf=()=>{this.VLe||(this.VLe=!0,v.ULS.sendTraceTag(25798020,382,50,"User has scrolled styles gallery"),Bf.a.removeHandler(this.b1,jb.a.scroll,this.EGf))};this.lHf=()=>{v.ULS.sendTraceTag(26005580,382,50,"Learn more click")};this.zIf=ba=>{ba.preventDefault();ba.stopPropagation();t.AFrameworkApplication.ya.processAction(Fb.a.Ozh,2);ba.target?(ba="button"===ba.target.tagName.toLowerCase()?ba.target:ba.target.parentNode)&&ba.id!==this.zUb&&(v.ULS.sendTraceTag(25231813,
382,50,"DigitalPrintDialog.OnStyleGalleryItemClick style changed from {0} to {1}",this.zUb,ba.id),this.mlh(ba),this.Wuh()):v.ULS.sendTraceTag(24418077,382,10,"DigitalPrintDialog.OnStyleGalleryItemClick e.Target is null!")};this.iWk=ba=>{const ta=(new Date).getTime()-this.tBg;Ze.a.instance.Tf(Vi.a.kWk,ta);ba?this.MFn():(v.ULS.sendTraceTag(25231814,382,50,"DigitalPrintDialog.DigitalPrintDialogHandler Dialog has been closed with the cancel button"),t.AFrameworkApplication.ya.processAction(Fb.a.Nzh,2))};
this.KFn=()=>{this.KYn();try{const ba=VB.eBh.q6k(),ta=YF.construct(2,ba,this.zUb,"VerticalWorld",.3,1366,600,330,280,20,VB.eBh.ROb.name);t.AFrameworkApplication.Xe.Lj(String.format("{0}/we/GetSwayPreview.ashx?{1}",vb.App.webServiceBase,t.AFrameworkApplication.rootQuerySignature),2,jM.b(ta),{"Content-Type":"application/json; charset=utf-8","Content-Encoding":"gzip"},!1,2,this.E8m,this.pGi,ta)}catch(ba){v.ULS.sendTraceTag(25268375,382,10,"Failed to generate preview request. Exception: {0}",ba.message)}};
this.E8m=ba=>{var ta=null;({group:ta}=yl.a.M7(ba.data.Ge)).returnValue?(ta=ta.Responses[0],ta.Succeeded?(this.BTd(ba.data,Vi.a.S4n),this.Qab(),this.A_i(this.bJe,ta.PreviewHtml),this.A_i(this.knd,ta.PreviewHtmlMobile)):this.pGi(null)):v.ULS.sendTraceTag(25231816,382,10,"DigitalPrintDialog.PreviewSuccessCallback Preview response deserialization failed")};this.pGi=()=>{this.LYn();this.cJe.style.background="#E6E6E6";this.f2g.style.background="#E6E6E6"};this.vg=LC.vg;this.kg="DigitalPrintDialog";v.ULS.sendTraceTag(26005578,
382,50,"Print to Web dialog has been opened and we initiated document force save");this.zRj=WordEditorIntl.WordEditorStrings.L_DigitalPrintTransformSlab;this.APb=WordEditorIntl.WordEditorStrings.L_DigitalPrintButtonTransform;this.NWj=r;this.vnc=z;this.Ve(1,this.zRj);this.Wh(this.APb,this.iWk,null);this.X2l();this.G3n();this.tBg=(new Date).getTime();R&&Qv.a.PP(14,!1,this.yZk,this.xZk,null);this.f4l();this.B1l();this.Msm();this.axf();this.Dsm();this.Wuh()}get Lsa(){return this.Had}LUi(b){if(!this.rEe){const h=
(new Date).getTime()-this.tBg;Ze.a.instance.Tf(Vi.a.jWk,h);b?v.ULS.sendTraceTag(25548302,382,15,String.format("We failed to save document with status code {0}",Of.a[b])):v.ULS.sendTraceTag(25548301,382,50,"We saved document successfully");document.getElementById("digitalPrintSavingDiv").style.display="none";this.NVa.disabled=!1}}X2l(){this.iVb=document.getElementById("digitalPrintStatusMessageDiv");this.tIe=document.getElementById("digitalPrintStatusMessageIconDiv");this.cJe=document.getElementById("swayDesktopPreviewWrapperDiv");
this.bJe=document.getElementById("swayDesktopPreviewHtmlHolder");this.knd=document.getElementById("swayMobilePreviewHtmlHolder");this.f2g=document.getElementById("swayMobilePreviewWrapperDiv");this.b1=document.getElementById("swayGallery");this.b1.setAttribute("tabindex","0");Bf.a.addHandler(this.b1,jb.a.scroll,this.EGf);this.b1.setAttribute(vf.a.Ch,vf.a.$dh);this.R0=document.getElementById("digitalPrintLearnMoreLink");this.R0.href="https://go.microsoft.com/fwlink/?linkid=871972";Bf.a.addHandler(this.R0,
jb.a.click,this.lHf);this.Bia=new Ua.a;this.Nbd=document.getElementById("homeWrapper");this.u3("mainText");document.getElementById("mainText").innerText="OneDriveWOPI"===this.vnc?WordEditorIntl.WordEditorStrings.L_DigitalPrintDialogDescriptionMSA:WordEditorIntl.WordEditorStrings.L_DigitalPrintDialogDescriptionAAD}f4l(){this.Zn=new Ua.a;this.Zn.add(new Dr("BokehV2",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameBokeh,"swayLightProTitle swayBokehTitle","swayLightProHeading swayBokehHeading"));
this.Zn.add(new Dr("Regency",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameRegency,"swayVanillaTitle swayRegencyTitle","swayVanillaHeading swayRegencyHeading"));this.Zn.add(new Dr("PilarV2",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNamePilar,"swayVanillaTitle swayPilarTitle","swayVanillaHeading swayPilarHeading"));this.Zn.add(new Dr("Boutique",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameBoutique,"swaySwirlTitle swayBoutiqueTitle","swaySwirlHeading swayBoutiqueHeading"));
this.Zn.add(new Dr("Studio",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameStudio,"swaySimplicityTitle swayStudioTitle","swaySimplicityHeading swayStudioHeading"));this.Zn.add(new Dr("Sierra",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameSierra,"swaySwirlTitle swaySierraTitle","swaySwirlHeading swaySierraHeading"));this.Zn.add(new Dr("Fete",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameFete,"swaySwirlTitle swayFeteTitle","swaySwirlHeading swayFeteHeading"));this.Zn.add(new Dr("CelestialV2",
WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameCelestial,"swaySwirlTitle swayCelestialTitle","swaySwirlHeading swayCelestialHeading"));this.Zn.add(new Dr("TranquilV2",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameTranquil,"swayVanillaTitle swayTranquilTitle","swayVanillaHeading swayTranquilHeading"));this.Zn.add(new Dr("Midtown",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameMidtown,"swayLightProTitle swayMidtownTitle","swayLightProHeading swayMidtownHeading"));this.Zn.add(new Dr("Lucent",
WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameLucent,"swaySimplicityTitle swayLucentTitle","swaySimplicityHeading swayLucentHeading"));this.Zn.add(new Dr("AerialV2",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameAerial,"swaySwirlTitle swayAerialTitle","swaySwirlHeading swayAerialHeading"));this.Zn.add(new Dr("StructureV2",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameStructure,"swaySwirlTitle swayStructureTitle","swaySwirlHeading swayStructureHeading"));this.Zn.add(new Dr("Muse",
WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameMuse,"swayLightProTitle swayMuseTitle","swayLightProHeading swayMuseHeading"));this.Zn.add(new Dr("Cinema",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameCinema,"swaySimplicityTitle swayCinemaTitle","swaySimplicityHeading swayCinemaHeading"));this.Zn.add(new Dr("MegaV2",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameMega,"swayVanillaTitle swayMegatitle","swayVanillaHeading swayVanillaHeading"));this.Zn.add(new Dr("ConvergenceV2",
WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameConvergence,"swayVanillaTitle swayConvergenceTitle","swayVanillaHeading swayConvergenceHeading"));this.Zn.add(new Dr("Alloy",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameAlloy,"swayLightProTitle swayAlloyTitle","swayLightProHeading swayAlloyHeading"));this.Zn.add(new Dr("Fluent",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameFluent,"swaySimplicityTitle swayFluentTitle","swaySimplicityHeading swayFluentHeading"));this.Zn.add(new Dr("Aurora",
WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameAurora,"swaySwirlTitle swayAuroraTitle","swaySwirlHeading swayAuroraHeading"));this.Zn.add(new Dr("Civic",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameCivic,"swayLightProTitle swayCivicTitle","swayLightProHeading swayCivicHeading"));this.Zn.add(new Dr("Reflection",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameReflection,"swaySimplicityTitle swayReflectionTitle","swaySimplicityHeading swayReflectionHeading"))}B1l(){this.F4=
new Ua.a;this.F4.add(new uv("universc","universc","normal","normal"));this.F4.add(new uv("Miller-Banner_Roman_WebTT","Miller-Banner_Roman_WebTT","normal","normal"));this.F4.add(new uv("Miller-Banner_Italic_WebTT","Miller-Banner_Italic_WebTT","normal","italic"));this.F4.add(new uv("Miller-Banner_Bold_Italic_WebTT","Miller-Banner_Bold_Italic_WebTT","bold","italic"));this.F4.add(new uv("QuireSans-Thin","QuireSans-Thin","extrathin","normal"));this.F4.add(new uv("Posterama-Regular","Posterama-Regular",
"normal","normal"));this.F4.add(new uv("Heron_Serif-Regular_WebTT","Heron_Serif-Regular_WebTT","normal","normal"));this.F4.add(new uv("Benton_Modern-Roman_WebTT","Benton_Modern-Roman_WebTT","normal","normal"));this.F4.add(new uv("ArialNova","ArialNova","normal","normal"));this.F4.add(new uv("TisaOffcSerifPro-Thin","TisaOffcSerifPro-Thin","normal","normal"));this.F4.add(new uv("QuireSans-Regular","QuireSans-Regular","normal","normal"));this.F4.add(new uv("RockwellNova","RockwellNova","normal","normal"));
this.F4.add(new uv("SabonNRegLT","SabonNRegLT","normal","normal"));this.F4.add(new uv("DaytonaThin","DaytonaThin","100","normal"))}Msm(){const b=document.createElement("style");b.setAttribute("type","text/css");let h="";for(let r of this.F4)h+=String.format(this.NWj,r.fontFamily,r.MYc,r.fontWeight,r.fontStyle);b.innerText=h;this.Nbd.appendChild(b)}Dsm(){const b=document.createElement("style");b.setAttribute("type","text/css");const h=String.format(".{0} {{ background: url({1}) no-repeat; }}","swayPreviewFrameBackground",
il.a.Sh("SwayPreviewFrame.svg")),r=String.format("@media screen and (-ms-high-contrast: active) {{ .{0} {{ background: url({1}) no-repeat; -ms-high-contrast-adjust: none; }}}}","swayPreviewFrameBackground",il.a.Sh("SwayPreviewFrameHC.svg"));b.innerText=h+r;X.a.rp&&(b.innerText+=".AppRtl .swayGallery { margin-right: -15px; }");this.Nbd.appendChild(b)}fTh(b){return b?b.keyCode:window.event.keyCode}hide(){this.ERf();super.hide()}ERf(){if(this.b1&&!this.rEe){for(let b=0;b<this.Bia.count;b++)Bf.a.removeHandler(this.Bia.J(b),
jb.a.click,this.zIf),Bf.a.removeHandler(this.Bia.J(b),jb.a.li,this.RAi);Bf.a.removeHandler(this.b1,jb.a.li,this.vxi);Bf.a.removeHandler(this.b1,jb.a.focus,this.uxi);Bf.a.removeHandler(this.R0,jb.a.click,this.lHf);this.VLe||Bf.a.removeHandler(this.b1,jb.a.scroll,this.EGf);this.rEe=!0}}axf(){const b=document.createElement("link");b.setAttribute("rel","stylesheet");b.setAttribute("type","text/css");b.setAttribute("href",il.a.Tjk());this.Nbd.appendChild(b);for(let h of this.Zn)this.VKk(this.b1,h);this.uU(this.b1);
this.mlh(this.b1.firstChild);this.b1.firstChild.focus();Bf.a.addHandler(this.b1,jb.a.li,this.vxi);Bf.a.addHandler(this.b1,jb.a.focus,this.uxi)}VKk(b,h){const r=document.createElement("button");r.className="swayGalleryItem swayClip136x90 swayImageBorderButton";r.setAttribute(vf.a.eab,vf.a.jL);r.setAttribute("title",h.title);r.setAttribute(vf.a.Ch,vf.a.ceh);r.id=h.styleName;b.appendChild(r);b=document.createElement("img");b.className=String.format("swayPublish_Sway{0}StyleBlank_136x90x32",h.styleName);
b.src=il.a.Sh("swayPublish.png");b.setAttribute(vf.a.Ch,vf.a.Az);b.setAttribute("unselectable","on");b.setAttribute(vf.a.zz,vf.a.Ho);b.id=h.styleName+"img";r.appendChild(b);b=document.createElement("label");b.innerText=h.title;b.className=h.Z8n;b.setAttribute(vf.a.zz,vf.a.Ho);b.setAttribute("unselectable","on");b.setAttribute(vf.a.Ch,vf.a.Az);r.appendChild(b);const z=document.createElement("label");z.innerText=WordEditorIntl.WordEditorStrings.L_DigitalPrintHeadingText;z.className=h.FXl;z.setAttribute(vf.a.zz,
vf.a.Ho);b.setAttribute("unselectable","on");z.setAttribute(vf.a.Ch,vf.a.Az);r.appendChild(z);Bf.a.addHandler(r,jb.a.click,this.zIf);Bf.a.addHandler(r,jb.a.li,this.RAi);this.Bia.add(r)}ySm(b){const h=this.Lsa;this.lcl(b,h,!t.AFrameworkApplication.isRtl)||this.ncl(b,h,!t.AFrameworkApplication.isRtl)||this.icl(b,h)||this.jcl(b,h)}JUl(b){return b===Sys.UI.Key.tab?(this.Lsa&&this.Lsa!==this.FIa&&(this.Lsa.className="swayGalleryItem swayClip136x90 swayImageBorderButton",this.Had=this.FIa),!0):!1}lcl(b,
h,r){return b===Sys.UI.Key.right&&r||b===Sys.UI.Key.left&&!r?(b=(b=h.nextSibling)||this.b1.firstChild,this.FJb(b),!0):!1}ncl(b,h,r){return b===Sys.UI.Key.left&&r||b===Sys.UI.Key.right&&!r?(b=(b=h.previousSibling)||this.b1.lastChild,this.FJb(b),!0):!1}icl(b,h){return b===Sys.UI.Key.down?(b=this.Bia.indexOf(h),h=b+2,h<this.Bia.count?(b=this.Bia.J(h))&&this.FJb(b):(h=b%2+1,h=2<=h?0:h,(b=this.Bia.J(h))&&this.FJb(b)),!0):!1}jcl(b,h){b===Sys.UI.Key.up&&(b=this.Bia.indexOf(h),h=b-2,0<=h?(b=this.Bia.J(h))&&
this.FJb(b):(h=b?20+b-1:this.Bia.count-1,(b=this.Bia.J(h))&&this.FJb(b)))}FJb(b){this.Lsa&&this.Lsa.id!==this.FIa.id&&(this.Lsa.className="swayGalleryItem swayClip136x90 swayImageBorderButton");this.Had=b;this.Lsa.className=String.format("{0} {1}","swayGalleryItem swayClip136x90 swayImageBorderButton","swayImageBorderButtonFocused");this.Lsa.focus()}G3n(){this.NVa.className="WACDialogButtonNormal swayPrintToWebButton";this.NVa.setAttribute("tabindex","0");this.hz.className="WACDialogButtonNormal swayCancelButton";
this.hz.setAttribute("tabindex","0");this.NVa.disabled=!0}mlh(b){this.Lsa&&(this.Lsa.className="swayGalleryItem swayClip136x90 swayImageBorderButton");this.FIa&&(this.FIa.className="swayGalleryItem swayClip136x90 swayImageBorderButton",this.FIa.setAttribute(vf.a.eab,vf.a.jL));this.zUb=b.id;this.FIa=b;this.FIa.setAttribute(vf.a.eab,vf.a.Ho);this.Had=b;this.Lsa.className=String.format("{0} {1}","swayGalleryItem swayClip136x90 swayImageBorderButton","swayImageBorderButtonSelected")}Wuh(){Oe.a.instance.$b(new Ic.a(2,
1,50,this.KFn))}A_i(b,h){b.innerHTML=h}MFn(){v.ULS.sendTraceTag(25231818,382,50,String.format("DigitalPrintDialog.SendPublishRequest Sending publish request for style {0}",this.zUb));t.AFrameworkApplication.ya.processAction(Fb.a.Pzh,2);const b=String.format("{0}/we/SwayPublish.ashx?{1}&parentSessionId={2}&styleId={3}",vb.App.webServiceBase,t.AFrameworkApplication.rootQuerySignature,t.AFrameworkApplication.userSessionId,this.zUb);Ed.a.openWindow(4,b)}BTd(b,h){Ze.a.instance.Tf(h,+b.AS-+b.eH)}LYn(){var b=
WordEditorIntl.WordEditorStrings.L_DigitalPrintPreviewFailureMessage;this.Qab();this.iVb.innerText=b;this.iVb.style.display="block"}KYn(){this.Qab();this.tIe.style.display="block";this.iVb.innerText=WordEditorIntl.WordEditorStrings.L_DigitalPrintGeneratingPreview;this.iVb.style.display="block"}Qab(){this.cJe.style.background="";this.knd.style.background="";$e.a.eZ(this.bJe);$e.a.eZ(this.knd);this.iVb.style.display="none";this.tIe.style.display="none"}static get eBh(){return null!=VB.qig?VB.qig:VB.qig=
Sa.a.instance.Pa("Box4.DocumentContentExtractor.IDocumentContentExtractor")}}Object(n.a)(VB,"DigitalPrintDialog",Wc.a,[]);class ZF{constructor(b,h){this._context=this.Pk=null;this.Wje=0;this.O7c=!1;this.c1g=null;this.digitalPrint=(r,z,R,ba,ta)=>{if(1===R)return t.AFrameworkApplication.jO?8:32;this.c1g=ta.SourceControlId;if(t.AFrameworkApplication.K.$("IsAnonymousUser"))return v.ULS.sendTraceTag(34373826,382,50,"DigitalPrintActor.DigitalPrint: Anonymous user tried to click on Print to Web feature."),
this.Rec(WordEditorIntl.WordEditorStrings.L_DigitalPrintSignInNeeded),32;this._context=z;if(ZF.ogm())return v.ULS.sendTraceTag(34373828,382,50,"DigitalPrintActor.DigitalPrint: MSA user clicked on Print to Web feature."),this.I_e(),32;switch(this.Wje){case 1:v.ULS.sendTraceTag(34373829,382,50,"DigitalPrintActor.DigitalPrint: AAD user with Sway license clicked again on Print to Web feature.");this.I_e();break;case 2:v.ULS.sendTraceTag(34373830,382,50,"DigitalPrintActor.DigitalPrint: AAD user without Sway license clicked again on Print to Web feature.");
this.Rec(WordEditorIntl.WordEditorStrings.L_DigitalPrintNoSwayLicense);break;case 0:this.O7c=!1,this.Pk=(new Om.a).create(),this.Pk.message=WordEditorIntl.WordEditorStrings.L_DigitalPrintCheckingSwayLicense,this.Pk.qM(CommonUIStrings.l_DefaultDialogTitle,this.Ruk,null),t.AFrameworkApplication.Xe.Lj(String.format("{0}/we/CheckSwayLicense.ashx?{1}",vb.App.webServiceBase,t.AFrameworkApplication.rootQuerySignature),2,null,null,!1,2,this.Tuk,this.Suk,null)}return 32};this.Ruk=()=>{this.O7c=!0;v.ULS.sendTraceTag(34373831,
382,50,"DigitalPrintActor.CheckSwayLicenseCanceled: Canceling license check...")};this.Tuk=r=>{if(!this.O7c){this.Pk.close();var z=null;this.BTd(r.data,Vi.a.R4n);({group:z}=yl.a.M7(r.data.Ge)).returnValue?(r=z.Responses[0],v.ULS.sendTraceTag(34373832,382,50,"DigitalPrintActor.CheckSwayLicenseSuccessCallback: CheckSwayLicenseResponse deserialization succeeded. HasLicense: {0}, Succeeded: {1}",r.HasLicense,r.Succeeded),r.Succeeded?(this.Wje=r.HasLicense?1:2,2===this.Wje?this.Rec(WordEditorIntl.WordEditorStrings.L_DigitalPrintNoSwayLicense):
this.I_e()):this.Rec(WordEditorIntl.WordEditorStrings.L_DigitalPrintSwayServiceDown)):(v.ULS.sendTraceTag(34373833,382,10,"DigitalPrintActor.CheckSwayLicenseSuccessCallback: CheckSwayLicenseResponse deserialization failed"),this.Rec(WordEditorIntl.WordEditorStrings.L_DigitalPrintSwayServiceDown))}};this.Suk=r=>{this.O7c||(this.Pk.close(),v.ULS.sendTraceTag(34373834,382,15,"DigitalPrintActor.CheckSwayLicenseFailCallback: CheckSwayLicense request failed!"),this.BTd(r.data,Vi.a.Q4n),this.Rec(WordEditorIntl.WordEditorStrings.L_DigitalPrintSwayServiceDown))};
this.ga=b;this.s4=h}Vb(){t.AFrameworkApplication.protectFile?v.ULS.sendTraceTag(26093080,382,50,"Disabling Digital Print button because document has protection."):t.AFrameworkApplication.K.$("DisablePrintBasedOnPolicy")&&t.AFrameworkApplication.K.$("DisablePrint")?v.ULS.sendTraceTag(26093081,382,50,"Disabling Digital Print button because print is disabled."):(this.ga.gb(Fb.a.wzd,kc.a.view,this.digitalPrint,4),this.ga.gb(Fb.a.Ozh,kc.a.view,$c.ActionManager.qZ,4),this.ga.gb(Fb.a.Pzh,kc.a.view,$c.ActionManager.qZ,
4),this.ga.gb(Fb.a.Nzh,kc.a.view,$c.ActionManager.qZ,4),this.ga.gb(ab.a.xzd,kc.a.view,$c.ActionManager.qZ,4))}I_e(){v.ULS.sendTraceTag(36824994,382,50,"DigitalPrintActor.CreateDigitalPrintDialog: Opening the DigitalPrintDialog. Button {0} clicked.",this.c1g);new VB(this._context,this.ga,t.AFrameworkApplication.K.lb("SwayFontDownloadUrlTemplate"),t.AFrameworkApplication.K.lb("FileSource"))}Rec(b){const h=new te.StandardDialog;h.Fd=0;h.Sga(CommonUIStrings.l_DefaultDialogTitle,b,null)}BTd(b,h){Ze.a.instance.Tf(h,
+b.AS-+b.eH)}static ogm(){return"OneDriveWOPI"===t.AFrameworkApplication.K.lb("FileSource")}}Object(n.a)(ZF,"DigitalPrintActor",null,[]);class sJ{constructor(){this.W3g=null}zni(){v.ULS.sendTraceTag(25007841,375,50,"Do not check for this critique type triggered")}nej(b){if(!b)return v.ULS.sendTraceTag(25007842,375,15,"Error range is null"),!1;if(!this.Pii(b.errorDetails))return!1;this.W3g=Object(la.a)(pi.a,b.errorDetails).typeId;return!0}c8d(b){return this.Pii(b)?Object(la.a)(pi.a,b).typeId===this.W3g:
!1}Pii(b){if(!b)return v.ULS.sendTraceTag(25007843,375,15,"No ErrorDetails found"),!1;b=Object(la.a)(pi.a,b);return b?b.token&&b.typeId?!0:(v.ULS.sendTraceTag(25007873,375,50,"Token is null: {0}",!b.token),!1):(v.ULS.sendTraceTag(25007872,375,50,"ErrorDetails is null"),!1)}}Object(n.a)(sJ,"DoNotCheckThisCritiqueTypeStrategy",null,[489]);class tJ extends Wc.a{constructor(b,h,r){super(!1,!1,!0);this.zc=b;this.Rka=r;this.RBj="DocumentChoiceGroup";this.QCg="EmbededContent";this.iIg="HyperLink";this.$we=
r.a6a;b={["id"]:"ExternalContentDefaultSettingsDialog",["bodyControls"]:this.qHc()};this.Cxj=this.V5k.bind(this);this.Ve(1,WordEditorIntl.WordEditorStrings.L_ExternalContentDefaultSettingsDialogSave);this.Wh(WordEditorIntl.WordEditorStrings.L_ExternalContentDefaultSettingsDialogTitle,this.Cxj,b)}qHc(){const b=Array(2);b[0]={["key"]:this.QCg,["text"]:WordEditorIntl.WordEditorStrings.L_ExternalContentGalleryContent};b[1]={["key"]:this.iIg,["text"]:WordEditorIntl.WordEditorStrings.L_ExternalContentGalleryHyperLink};
const h={};h.documentChoiceGroupProps={["id"]:this.RBj,["defaultSelectedKey"]:this.$we?this.QCg:this.iIg,["label"]:WordEditorIntl.WordEditorStrings.L_ExternalContentDefaultSettingsDialogDescription,["options"]:b};h.learnMoreLinkText=WordEditorIntl.WordEditorStrings.L_ExternalContentDefaultSettingsDialogLearnMore;h.learnMoreURL=WordEditorIntl.WordEditorStrings.L_ExternalContentDefaultSettingsDialogLearnMoreUrl;h.externalContentDefaultSettingsDialogInformationText=WordEditorIntl.WordEditorStrings.L_ExternalContentDefaultSettingsDialogInformation;
return h}V5k(b,h){1===b?(this.$we!==h.isExternalContentSelected&&(b=h.isExternalContentSelected?Oa.a.PKa:Oa.a.Dcb,this.zc.processAction(b,2),this.$we=h.isExternalContentSelected,Y.a.sendTelemetryEvent(Object.assign(new da.a,{name:"Office.Word.Online.ExternalContent.ExternalContentDefaultSettings",dataFields:[Object.assign(new ca.a,{name:"ActionId",int64:b})]}))),this.Rka.HBn(h.isExternalContentSelected)):0===b&&v.ULS.sendTraceTag(556565635,324,50,"Cancel Clicked in ExternalContentDefaultSettingsDialog")}}
Object(n.a)(tJ,"ExternalContentDefaultSettingsDialog",Wc.a,[]);class Er{constructor(b,h,r,z,R){this.Zv=Sa.a.instance.resolve("Common.IReactContextualUILauncher");this.Gnb=Yf.a.On;this.Mec=()=>{const ba=Array(1);ba.push("ExternalContent");var ta=Sa.a.instance.resolve("WordEditor.Actors.ExternalContentFloatiePositionProvider").wLa();ta=Object.assign(new rE.a,{x:ta.x,y:ta.y});this.Zv.showFloatie(ta,ba,1);return 32};this.JBb=()=>{this.Zv.KZ&&this.Zv.qw();return 32};this.iIi=(ba,ta,Wa,ub,Ib)=>{if(ta="object"===
typeof Ib?Ib:null)ba===Oa.a.DOf?(ba=Er.QSa!==Oa.a.PKa&&Er.QSa!==Oa.a.Dcb,ta[this.Gnb]=Er.QSa===Oa.a.PKa||ba):ba===Oa.a.EOf&&(ta[this.Gnb]=Er.QSa===Oa.a.Dcb);return 32};this.UFh=(ba,ta,Wa)=>{1!==Wa&&(ba===Oa.a.Dcb&&Er.QSa!==Oa.a.Dcb?(v.ULS.sendTraceTag(575813832,324,50,"ExternalContentPasteHyperlinkOption clicked"),this.wm.undo()&&(ta=new Yu.a(1,t.AFrameworkApplication.isRtl),ta.VUc="ExternalContent",Er.Ccb.TWc(ta))):ba===Oa.a.PKa&&Er.QSa!==Oa.a.PKa&&(v.ULS.sendTraceTag(575813833,324,50,"ExternalContentPasteEmbededWebContentOption clicked"),
t.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.InsertFluidComponent",!1),this.IDg.PJi()),Er.QSa=ba);Y.a.sendTelemetryEvent(Object.assign(new da.a,{name:"Office.Word.Online.ExternalContent.Floatie",dataFields:[Object.assign(new ca.a,{name:"behavior",string:Wa.toString()}),Object.assign(new ca.a,{name:"ActionId",int64:ba})]}));return 32};this.ga=b;this.wm=h;this.IDg=z;this.qqb=R;this.Bxj=this.W5k.bind(this);t.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.InsertFluidComponent",
!1);this.IDg.JLi(()=>{this.reset()})}Vb(){this.ga.gb(Oa.a.DOf,kc.a.view,this.iIi,97);this.ga.gb(Oa.a.EOf,kc.a.view,this.iIi,97);this.ga.gb(Oa.a.TFh,kc.a.view,this.Bxj,1028);this.ga.gb(Oa.a.PKa,kc.a.view,this.UFh,1028);this.ga.gb(Oa.a.Dcb,kc.a.view,this.UFh,1028);this.qqb||(this.ga.gb(Oa.a.Mec,kc.a.view,this.Mec,96),this.ga.gb(Oa.a.JBb,kc.a.view,this.JBb,96))}eXn(b){new tJ(this.ga,b,Er.Rka)}W5k(b,h,r){1!==r&&this.eXn(Er.QSa);return 32}static get Ccb(){return null!=Er.Lig?Er.Lig:Er.Lig=Sa.a.instance.resolve("Box4.IExternalContentFloatieEventSource")}static get Rka(){Er.qxa||
(Er.qxa=Sa.a.instance.resolve("WordEditor.ExternalContent.IExternalContentSettingInfo"));return Er.qxa}reset(){Er.QSa=null!=Er.Rka?Er.Rka.a6a?Oa.a.PKa:Oa.a.Dcb:Oa.a.PKa}}Er.QSa=Oa.a.PKa;Er.qxa=null;Object(n.a)(Er,"ExternalContentActor",null,[]);class WB extends Vw{constructor(b,h,r,z,R,ba,ta,Wa,ub,Ib,$b,fc){super(b,h,r,z,R,ba,ta,Wa,ub,Ib,$b);this.BBd=!1;this.uJg=null;this.qqb=fc}rXc(){this.BBd||(super.rXc(),this.BBd=!0)}tce(){this.BBd&&(super.tce(),WB.lCh&&this.uJg&&WB.lCh.removeHandler(ch.a.Wya,
this.uJg),this.BBd=!1)}cMb(){if(this.qqb){this.Zv.KZ&&this.Zv.qw();const b=new Yu.a(0,t.AFrameworkApplication.isRtl);b.location=this.bya.wLa();this.showFloatie(null,b)}else this.Zv.KZ&&t.AFrameworkApplication.ya.processAction(Oa.a.JBb,2),t.AFrameworkApplication.ya.processAction(Oa.a.Mec,2);this.U7b=!1}qw(b){!this.Iue&&(b&&(this.bya.Aof(),this.ofj()),this.Zv.KZ||this.xHa)&&(this.xHa=!b,this.tce(),this.qqb?this.Zv.qw():t.AFrameworkApplication.ya.processAction(Oa.a.JBb,2))}showFloatie(b,h){h||(h=new Yu.a(0,
t.AFrameworkApplication.isRtl));h.location||(h.location=this.bya.wLa());if(!h.location)return!1;this.xHa&&(this.xHa=!1,this.rXc());this.qqb?(b=Array(1),b.push("ExternalContent"),this.Zv.showFloatie(this.bya.wLa(),b,1)):t.AFrameworkApplication.ya.processAction(Oa.a.Mec,2);return!0}sDc(){if(!this.U7b){const b=new Ic.a(3,1,this.Uwh,()=>{this.cMb()},196);Oe.a.instance.$b(b);this.U7b=!0}}vga(){this.qqb?this.Zv.KZ&&this.Zv.qw():t.AFrameworkApplication.ya.processAction(Oa.a.JBb,2);this.sDc()}hJb(){this.qqb?
this.Zv.KZ&&this.Zv.qw():t.AFrameworkApplication.ya.processAction(Oa.a.JBb,2);this.sDc()}static get lCh(){return null!=WB.wig?WB.wig:WB.wig=Sa.a.instance.resolve("Box4.IEditStateEventManager")}}Object(n.a)(WB,"ExternalContentFloatieEventManager",Vw,[]);class XB extends ym{constructor(b,h,r,z,R){super(b,h,r,z,R)}cjh(){if(!this.ib||!this.ib.hb||!this.ib.hb.kb)return v.ULS.sendTraceTag(575813836,307,15,"Selection is null when we try to calculate external content floatie position"),null;var b=this.ib.hb.kb.Qa,
h=!b.cpBegin&&!b.cpEnd;let r=b.node;if(r&&h&&!r.yI){do r=this.$Wh(r);while(r&&!r.yI&&Object(nb.a)(dd.AParagraphNode,r)&&!r.characterData.trim().length)}let z="";const R=Object(la.a)(dd.AParagraphNode,r);R&&(z=R.characterData.length===b.cpBegin||h?R.characterData.trimEnd():R.characterData.substring(0,b.cpBegin).trimEnd());h=R?z.length:b.cpBegin;b=Object.assign(new Xw,{Xua:Object(la.a)(200,(R?Object(la.a)(200,R):Object(la.a)(200,r))||b.node),Lac:h});return this.bef(b)}gSh(b,h){let r=null;const z=Object(la.a)(213,
b.Xua.Ni(h.Tb));if(!z)return null;if(Object(nb.a)(dd.AParagraphNode,b.Xua)){const R=Object(la.a)(dd.AParagraphNode,b.Xua);if(R.yP){if(b=Object(la.a)(fw.a,ie.ParagraphReader.Kdb(R)))(b=Object(la.a)(213,b.Ni(h.Tb)))&&(r=b.getBounds()),r&&(r.height+=XB.WIh,r.width-=XB.Gbl);return r}h=Object(la.a)(86,z);if(!h)return null;try{if(r=this.Sqa.aZ(b.Lac,h,0<b.Lac,!1,!1,!1))r.height+=XB.WIh}catch(ba){v.ULS.sendTraceTag(575813837,307,15,"Failed to get ip bound due to exception {0}, will use fallback value.",
ba),r=null}}r||(r=z.getBounds());return r}}XB.WIh=65;XB.Gbl=100;Object(n.a)(XB,"ExternalContentFloatiePositionProvider",ym,[]);class uJ{constructor(b,h,r,z,R,ba){this.PTf=(ta,Wa,ub)=>{if(1===ub)return t.AFrameworkApplication.protectFile||t.AFrameworkApplication.jO||t.AFrameworkApplication.fma||Xh.SessionStatusManager.instance.Sj?8:32;if(ta===Fb.a.print)ta=1;else if(ta===Oa.a.AEc)ta=0;else if(ta===Oa.a.eAd)ta=2;else return 8;return this.sBn(ta)};this.ga=b;this.s4=h;this.mQb=r;this.CBj=z;this.HBg=R;
this.Sxj=ba}Vb(){t.AFrameworkApplication.K.$("DisablePrintBasedOnPolicy")&&this.CBj||t.AFrameworkApplication.jO?(document.body.classList.add("WACStopPrinting"),""!==this.HBg&&this.Sxj.EXn(this.HBg)):(this.ga.pa(Fb.a.print,kc.a.application,this.PTf),this.ga.pa(Oa.a.AEc,kc.a.application,this.PTf),this.ga.pa(Oa.a.eAd,kc.a.application,this.PTf))}sBn(b){const h=t.AFrameworkApplication.rootQuerySignature;if(!h||""===h||vb.App.ud&&vb.App.ud.ZA.io)return 8;this.mQb.KNd=!1;this.mQb.mlj.start();Qv.a.PP(5,!0,
Object(u.a)(this.mQb,this.mQb.zvn,"requestFileDownload"),Object(u.a)(this.mQb,this.mQb.pGb,"onForceSaveFailed"),b);return 32}}Object(n.a)(uJ,"FileDownloadActor",null,[]);class vJ extends Uc{constructor(b,h=null){super(b,!0,h,!1)}get Ylf(){return null}get C0a(){return t.AFrameworkApplication.bXa?CommonUIStrings.l_DownLoadACopyDialogMessage:CommonUIStrings.l_PrintDialogDocumentIsPrinting}get O8b(){return CommonUIStrings.l_DownloadAsPdfDialogLinkSuggestion}get buttonText(){return CommonUIStrings.l_Download}get trd(){return null}}
Object(n.a)(vJ,"DownloadAsPdfDialog",Uc,[]);class pu{constructor(){this._url=this.Pu=null;this.eUa=this.dUa=0;this.u$a=!1;this.makeRequest=()=>{t.AFrameworkApplication.Xe.Lj(this._url,1,null,null,!0,2,this.yGb,this.Wma,null)};this.yGb=b=>{pu.FYc();const h=b.data.wga;let r=null;if(h)try{r=h.selectSingleNode("/docdata/status")}catch(z){}r&&("InProgress"===r.text&&22>this.dUa++||"ServiceBusy"===r.text&&3>this.eUa++)?this.YDa(1E3*(this.dUa+this.eUa)):this.Pu(!0,r?r.text:null,b.data)};this.Wma=b=>{this.u$a?
(pu.kya||(pu.$7a=new Date,pu.kya=!0,pu.dS=1),18E4>(new Date).getTime()-pu.$7a.getTime()?this.retryOnFailure(4<=pu.dS?2E4:1E3):this.UYa(b.data)):4>pu.dS?this.retryOnFailure(2E3):this.UYa(b.data)}}send(b,h,r){this._url=b;this.Pu=h;this.u$a=r;this.makeRequest(null)}YDa(b){b=new Ic.a(2,1,b,this.makeRequest);t.AFrameworkApplication.uc.$b(b)}retryOnFailure(b){this.YDa(b);pu.dS++}UYa(b){this.Pu(!1,null,b)}static W9(b,h){(new pu).send(b,h,!1)}static FYc(){pu.kya=!1;pu.dS=0}}pu.$7a=null;pu.kya=!1;pu.dS=0;
Object(n.a)(pu,"ClientRequestWithRetry",null,[]);class wJ extends Ag{constructor(b){super(b,void 0,t.AFrameworkApplication.bXa)}get C0a(){return WordEditorIntl.WordEditorStrings.l_DownloadAsOdtDialogOdtReady}get O8b(){return WordEditorIntl.WordEditorStrings.l_DownloadAsOdtDialogLinkSuggestion}get SQc(){return"DownloadOdtLink"}get buttonText(){return CommonUIStrings.l_Download}get cDc(){return t.AFrameworkApplication.bXa?"UIFontDialogTextLarge":null}txf(){v.ULS.sendTraceTag(7628378,324,50,"ODT download dialog displayed")}uxf(){v.ULS.sendTraceTag(7628379,
324,50,"ODT download dialog link clicked")}jRc(){v.ULS.sendTraceTag(19462216,324,50,"ODT download dialog button clicked")}get BQc(){return xF.Yui}get Zgb(){return WordEditorIntl.WordEditorStrings.l_DownloadAsOdtDialogLearnMoreLinkText}get dri(){return!t.AFrameworkApplication.bXa}}Object(n.a)(wJ,"DownloadAsOdtDialog",Ag,[]);class xJ{constructor(b,h){this.W6a=this.ZUa=null;this.b3a=r=>{1===vb.App.xa.state||this.ZUa||(this.ZUa=(new Om.a).create(),r=r.customData,this.Vvm(r),1===r?this.ZUa.message=this.Kob.JP.isEnabled?
t.AFrameworkApplication.bXa?CommonUIStrings.l_DirectPrintPreparingPDF:WordEditorIntl.WordEditorStrings.L_DirectPrintWait:WordEditorIntl.WordEditorStrings.l_PrintPDFWait:r?2===r&&(this.ZUa.message=WordEditorIntl.WordEditorStrings.l_ConversionToODTWait):this.ZUa.message=WordEditorIntl.WordEditorStrings.l_PrintPDFWait,this.ZUa.qM(CommonUIStrings.l_DefaultDialogTitle,this.cancelButton,null))};this.cancelButton=()=>{this.KNd=!0};this.V6=(r,z,R)=>{this.J2f("Success. Save and Conversion Complete.");R=new Ma.QueryStringBuilder(R.request.get_url());
t.AFrameworkApplication.vja(R);R=R.toString();const ba=this.Pvn(R);this.Dka(ba);2!==ba&&this.Kob.k9m();!r||z?this.z3(ba):this.KNd?(this.KNd=!1,this.W6a=null):(this.W6a&&t.AFrameworkApplication.uc.We(this.W6a),this.W6a=null,this.KXk(R,ba))};this.KNd=!1;this.Kob=b;this.mlj=h.vNa("UserAction","WordEditorForceSaveAndPrint")}Dka(b){this.ZUa&&(this.hwm(b),this.ZUa.close(),this.ZUa=null)}z3(b){if(1!==vb.App.xa.state){this.cxm(b);const h=new te.StandardDialog;h.Fd=0;h.Ve(1,CommonUIStrings.l_DialogClose);
h.jy(0,"",1===b?WordEditorIntl.WordEditorStrings.l_PrintError:WordEditorIntl.WordEditorStrings.l_ConversionError,null,!0)}}wGl(b){switch(b){case 0:return"downloadpdf";case 1:return"printpdf";case 2:return"odt";default:return v.ULS.sendTraceTag(7628383,324,10,"Unknown request PDF type {0}",b),"printpdf"}}zvn(b){var h=t.AFrameworkApplication.rootQuerySignature;h&&""!==h?(h="WordViewer/request."+this.Q5k(b)+"?"+h+"&type="+this.wGl(b)+"&rndm="+pa.a.create(),1===b&&this.Kob.bWn()&&(h+="&useNamedAction=1"),
t.AFrameworkApplication.K&&t.AFrameworkApplication.K.$("CustomFontReadModePDFIsEnabled")&&So.FontUtils.V7d()&&(1===b||!b)&&(0<So.FontUtils.Gwh&&(h+="&cfcVer="+So.FontUtils.Gwh),So.FontUtils.Fwh&&(h+="&cfcUrl="+So.FontUtils.Fwh),So.FontUtils.Hwh&&(h+="&cfcEncData="+So.FontUtils.Hwh)),pu.W9(h,this.V6),this.W6a||(this.W6a=new Ic.a(2,1,500,this.b3a),this.W6a.customData=b,t.AFrameworkApplication.uc.$b(this.W6a))):(this.J2f("failed. QuerySignature is empty."),this.z3(b))}Q5k(b){return 2===b?"odt":"pdf"}pGb(){this.J2f("Failed. force save failed.")}Pvn(b){if(0<
b.indexOf("&type=downloadpdf"))return 0;if(0<b.indexOf("&type=printpdf"))return 1;if(0<b.indexOf("&type=odt"))return 2;v.ULS.sendTraceTag(7628384,324,10,"Could not get requestType from uri:{0}",b);return 1}J2f(b){v.ULS.sendTraceTag(7628385,328,50,"stopping the perf counter for forcesave and print. [StoppingReason:{0}]",b);this.mlj.stop()}KXk(b,h){const r=new Ua.a;r.add("access_token");r.add("access_token_ttl");1!==vb.App.xa.state&&(1===h?this.Kob.oYn(b,r):h?2===h&&new wJ(b):new vJ(b))}dispose(){}Vvm(b){switch(b){case 0:v.ULS.sendTraceTag(38114782,
203,50,"Download Attempt: Pdf");break;case 2:v.ULS.sendTraceTag(38114783,203,50,"Download Attempt: Odt");break;case 1:v.ULS.sendTraceTag(38114784,203,50,"Download Attempt: PrintPdf");break;default:v.ULS.sendTraceTag(38114785,203,15,"Download Attempt: {0}",b)}}hwm(b){switch(b){case 0:v.ULS.sendTraceTag(38114786,203,50,"Download Cancelled: Pdf");break;case 2:v.ULS.sendTraceTag(38114787,203,50,"Download Cancelled: Odt");break;case 1:v.ULS.sendTraceTag(38114816,203,50,"Download Cancelled: PrintPdf");
break;default:v.ULS.sendTraceTag(38114817,203,15,"Download Cancelled: {0}",b)}}cxm(b){switch(b){case 0:v.ULS.sendTraceTag(38114818,203,15,"Download Failed: Pdf");break;case 2:v.ULS.sendTraceTag(38114819,203,15,"Download Failed: Odt");break;case 1:v.ULS.sendTraceTag(38114820,203,15,"Download Failed: PrintPdf");break;default:v.ULS.sendTraceTag(38114821,203,15,"Download Failed: {0}",b)}}}Object(n.a)(xJ,"FileDownloadManager",null,[]);class YB{get key(){return"LIST"}get mw(){return Box4Intl.Box4Strings.l_ListContentTitle}Ygc(b){let h=
null;const r=YB.hd.Hs(b);if(!r)return{returnValue:!1,ika:h};b=this.Exl(b,r);h=Object.assign(new Rs.a,{QF:this.key,contentId:b.listId,contentObject:b});return{returnValue:!0,ika:h}}Zzb(b,h){b=b.contentObject;const r=this.rwl(b.zw),z=new Nk.a;h?(h=h.contentObject,h.level!==b.level?(z.add(String.format(Box4Intl.Box4Strings.l_ListContentDetailsLevelFormat,b.level)),z.add(r)):h.id.equals(b.id)&&h.zw.listType===b.zw.listType||z.add(r)):(z.add(String.format(Box4Intl.Box4Strings.l_ListContentTitle)),z.add(String.format(Box4Intl.Box4Strings.l_ListContentDetailsLevelFormat,
b.level)),z.add(r));return z.toArray().join(" ")}rwl(b){let h="";const r=b.listStyle;if(!b.listType)h=String.format(Box4Intl.Box4Strings.l_ListContentDetailsItemFormat,b.hq);else if(1===b.listType)switch(r){case 1:h=this.Whh;break;case 2:h=this.Onk;break;case 3:h=this.Pnk;break;default:h=this.Whh}return h}static get hd(){return null!=YB.Nng?YB.Nng:YB.Nng=Sa.a.instance.resolve("Box4.List.IListReader")}}Object(n.a)(YB,"ListDetailsProvider",null,[596,269]);class yJ{constructor(){this.zw=this.listId=
this.id=null;this.level=0}}Object(n.a)(yJ,"ListItemInfo",null,[]);class zJ extends YB{constructor(b){super();this.C4=b}get Whh(){return WoncaIntl.WoncaStrings.L_BulletStyle1}get Onk(){return WoncaIntl.WoncaStrings.L_BulletStyle2}get Pnk(){return WoncaIntl.WoncaStrings.L_BulletStyle3}Exl(b,h){const r=this.C4.Qw(b);return Object.assign(new yJ,{id:b.currentNode.id,listId:new E.a(pa.a.nil,r.listID),zw:h,level:r.level+1})}}Object(n.a)(zJ,"FlatListDetailsProvider",YB,[]);class AJ{constructor(b,h){this.ga=
b;this.Cf=h}get oc(){return null!=this.Ysg?this.Ysg:this.Ysg=Sa.a.instance.Pa("Box4.Styles.IWACStyleReader")}Vb(){}}Object(n.a)(AJ,"FormattingActor",null,[]);var kM=d(1139),MC=d(1288),lM=d(1651);class BJ{constructor(b,h,r,z,R,ba,ta,Wa){this.Gb=b;this.dUj=h;this.Hc=r;this.Opb=z;this.rm=R;this.Oa=ba;this.Ac=ta;this.cJj=Wa}b1a(b,h,r,z,R,ba,ta){v.ULS.sendTraceTag(574358090,3001,50,"GraphicsEditorDocumentXmlToJsonRequestHelper: {0}",{["Method"]:"OnRequestSuccess",["DurationInMilliseconds"]:ta.oi});this.Opb.then(()=>
{this.dUj(b.data.Ge);v.ULS.sendTraceTag(574358091,3001,50,"GraphicsEditorDocumentXmlToJsonRequestHelper load success: {0}",{["Method"]:"OnRequestSuccess",["DurationInMilliseconds"]:ta.oi});ta.stop()})}Wma(b,h,r,z,R,ba,ta){ba.stop();R();ta?(this.m4m(h,r),v.ULS.sendTraceTag(574377989,3001,15,"{0}",{["message"]:b,["id"]:$d.ImageReader.Ldb(h.Gb)})):v.ULS.sendTraceTag(574377990,3001,15,"{0}",{["message"]:b,["id"]:$d.ImageReader.Ldb(h.Gb)})}Tbh(b,h){b.Ie(NE.a.JZe,"1");if(this.Ac&&this.Ac.isFeatureEnabled(48)){var r=
this.rm.Xl(h.vk);r=this.rm.ul(r);b.Ie(rg.a.Eq,MC.a[r]);5===r&&this.fck(b,h)}this.cJj&&b.Ie(rg.a.TLd,"true")}L6g(){return new lM.a(this.Gb.id,this.Gb)}NHd(){return WordEditorIntl.WordEditorStrings.L_GraphicsEditorDefaultError}m4m(b,h){const r=this.Hc.Rc(7,Fb.a.hRl);r.Db(h);b.Gb.setValue(yc.a.Kqh,!0);r.dispose()}fck(b,h){var r=h.vk;h=this.rm.Xl(r);var z=r.node;const R=(r=this.rm.iBa(h,z.Lc,!1))?this.rm.aBa(r):"";if(""===R)throw v.ULS.sendTraceTag(572555911,3001,10,"Could not find original dataBlobId on picture node."),
Error.argumentNull("OriginalObjectDataBlobId");z=(z=this.rm.iBa(h,z.Lc,!0))?this.rm.aBa(z):"";b.Ie(rg.a.oac,R);b.Ie(rg.a.plj,z);r=r.ia(Ij.a.VGh,"");""!==r&&b.Ie(rg.a.extension,r);b.Ie(rg.a.width,this.rm.tA(h).toString());b.Ie(rg.a.height,this.rm.JB(h).toString());b.Ie(rg.a.ZUc,this.rm.ceb(h).toString());r=this.Oa.$("WordEditorImageCropIsEnabled");b.Ie(rg.a.Xvh,r.toString());r&&(b.Ie(rg.a.top,this.rm.pla(h).toString()),b.Ie(rg.a.bottom,this.rm.lla(h).toString()),b.Ie(rg.a.left,this.rm.nla(h).toString()),
b.Ie(rg.a.right,this.rm.ola(h).toString()));r=this.Oa.$("WordEditorImageRotateIsEnabled");b.Ie(rg.a.yTi,r.toString());r&&(b.Ie(rg.a.angle,this.rm.vZ(h).toString()),b.Ie(rg.a.flipH,this.rm.N3(h,yc.a.MKc,!1)?"true":"false"),b.Ie(rg.a.flipV,this.rm.N3(h,yc.a.VKc,!1)?"true":"false"));b.Ie(rg.a.SCh,"true")}}Object(n.a)(BJ,"GraphicsEditorDocumentXmlToJsonRequestHelper",null,[498]);class CJ{constructor(){this.aHa=null}fik(b){this.aHa=b}teardown(){null!=this.aHa&&(this.aHa.teardown(),this.aHa=null);this.pDe=
null}getGraphicData(){return this.aHa?this.aHa.getGraphicData():null}mon(){null!=this.pDe&&this.setGraphicData(this.pDe)}setGraphicData(b){this.pDe=b;if(this.aHa)try{this.aHa.setGraphicData(b)}catch(h){v.ULS.sendTraceTag(575522530,3001,10,"GraphicsEditorGC2HostUser::SetGraphicData: Exception {0} thrown from GraphicHost.",h.toString())}else v.ULS.sendTraceTag(575522529,3001,10,"GraphicsEditorGC2HostUser::SetGraphicData: GraphicHost is null.")}hasEdits(){return this.aHa?this.aHa.hasEdits():!1}}Object(n.a)(CJ,
"GraphicsEditorGC2HostUser",null,[500]);var mM=d(1652),nM=d(1356),oM=d(605),pM=d(1443),qM=d(1053);class DJ{constructor(b){this.preloadScript=this.loadScript=null;this.loadScript=h=>b.loadScript(h);this.preloadScript=h=>{b.preloadScript(h)}}}Object(n.a)(DJ,"GC2ScriptLoader",null,[]);class $F{constructor(b,h,r){this.xke=b;this._context=h;this.uIa=r}closeEditor(){this.xke&&(this.xke(),this.xke=null)}logActivity(b,h,r,z){Lb.a(b,h,r,z)}logTrace(b,h,r,z){v.ULS.sendTraceTag(575522531,3001,$F.ECm(h),z)}isEnabled(b){const h=
t.AFrameworkApplication.K;switch(b){case "EqualSizingGuide":return h.getBooleanFeatureGate("Microsoft.Office.WordOnline.GraphicsEqualSizingGuide",!1);case "EqualSpacingGuide":return h.getBooleanFeatureGate("Microsoft.Office.WordOnline.GraphicsEqualSpacingGuide",!1);case "AdjustHandles":return h.getBooleanFeatureGate("Microsoft.Office.WordOnline.GraphicsAdjustHandles",!1);case "SpaceFirstLastPara":return h.getBooleanFeatureGate("Microsoft.Office.WordOnline.TextSpaceFirstLastPara",!1);case "ModernFontPicker":return h.$("ModernFontPickerIsEnabled");
case "SnapToAspectRatio":return h.getBooleanFeatureGate("Microsoft.Office.WordOnline.SnapToAspectRatio",!1);case "SVG":return h.getBooleanFeatureGate("Microsoft.Office.WordOnline.GraphicsUseSVG",!1);case "ShapeLocksSchema":return h.getBooleanFeatureGate("Microsoft.Office.WordOnline.ShapeLocks",!1);default:return!1}}getFontPickerFonts(b){const h=`${Sa.a.instance.resolve("Box4.IFontServiceParser").QXa}/${"hier_officeFontsPreview.ttf"}`;b("msofp_hier",h);b=So.FontUtils.Aaf(()=>!1,()=>"",!0);return{commandId:"FontPicker",
fonts:b.fonts.filter(r=>"premium"!==r.fontType),mruList:b.mruList,previewFontFamily:"msofp_hier_MSFontService"}}getFonts(b){const h=t.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ModernFontPicker",!1),r=h?"msofp_hier":"msofp",z=`${Sa.a.instance.resolve("Box4.IFontServiceParser").QXa}/${h?"hier_officeFontsPreview.ttf":"flat_officeFontsPreview.ttf"}`;b(r,z);So.FontUtils.s7g();So.FontUtils.T7g({});b=So.FontUtils.zaf(()=>!1,(R,ba)=>ba).MenuSectionList;h&&0<b.length&&(b.pop(),
b.push(this.kDk()));return b}kDk(){const b=So.FontUtils.Aaf(()=>!1,()=>"").fonts.map((h,r)=>{const z=h.name;h=h.displayName;const R=So.FontUtils.qma(z);return Object.assign(new ZG.a,{MenuItemId:So.FontUtils.KVi+r,CommandValueId:z,LabelText:h||z,Styles:{["optionText"]:{["fontFamily"]:h&&!R?"msofp_hier_MSFontService":"'Segoe UI',Tahoma,Sans-Serif;"}},AriaLabel:z})});return Object.assign(new hi.a,{Title:CommonUIStrings.l_FontDropdownMenuSectionAll,Id:"AllFontsDropdown",ControlList:b})}getPictureDataFromId(b){const h=
this._context.vk;var r=$d.ImageReader.Xl(h);if(this.sem(r,h,b)&&(r=$d.ImageReader.N3(r,od.a.ana,""),r.length))return Promise.resolve(r);r=new Ma.QueryStringBuilder("/we/GetImage.ashx?");r.NWb(h.node.Di().Fs);r.Ie(rg.a.Ayd,b);t.AFrameworkApplication.vja(r);r.Ie(Tj.a.Emb,"1");zl.a.instance.fvb(r);r.Ie(rg.a.Swh,"true");const z=r.toString();return new Promise((R,ba)=>{this.uIa.Lj(z,1,null,null,!1,2,ta=>{R(ta.data.Ge)},ta=>{ba(ta.data.wf.toString())},null)})}getPlaceholders(){const b={};b.PictureDownloading=
il.a.Sh("progress.gif");b.PictureInvalid=il.a.Sh("CancelRequest.32x32x32.png");return b}getTheme(){const b=ml.PageNavigator.instance.ju(this._context.view.rd).properties.ia(yc.a.Lae,"");return 0===b.length?[]:b.split(" ").map(h=>vb.App.rZb[h])}static ECm(b){switch(b){case 0:return 10;case 1:return 15;case 2:return 50;case 3:return 100;case 4:return 200;default:return 50}}sem(b,h,r){const z=h.node.Lc;h=$d.ImageReader.YGd(b,z,!1);b=$d.ImageReader.YGd(b,z,!0);return r===h||r===b}}Object(n.a)($F,"GraphicsEditorApp",
null,[518]);class EJ extends Wc.a{constructor(b,h,r,z,R){super(!1,!1,!0);this.closeEditor=()=>{this.frh();this.dispose()};this.S9=ba=>{this.frh(2===ba)};this.m7a=b;this.WFj=h;this.zIg=r;this._context=z;this.uIa=R}vXn(){return new Promise((b,h)=>{this.Wh(WordEditorIntl.WordEditorStrings.L_GraphicsEditorDialogTitle,this.S9,{["id"]:"GraphicsEditorDialog",["bootstrap"]:(r,z)=>this.ojk(z),["onload"]:r=>{this.onLoad(r,b,h)},["editorDiscardText"]:WordEditorIntl.WordEditorStrings.L_GraphicsEditorDialogDiscardChanges,
["editorSaveText"]:WordEditorIntl.WordEditorStrings.L_GraphicsEditorDialogSave,["onReload"]:()=>{this.m7a.mon()},["iFrameTitle"]:WordEditorIntl.WordEditorStrings.L_GraphicsEditorDialogTitle})})}onLoad(b,h,r){b?(this.m7a.fik(b),h(b)):(v.ULS.sendTraceTag(573100169,3001,10,"ReactGraphicsEditorDialog::Bootstrap: Null host"),r(null))}ojk(b){const h=t.AFrameworkApplication.K,r=qM.a();r.loadScriptWithRetryHandler=b;const z=new $F(this.closeEditor,this._context,this.uIa),R={["bootConfig"]:Object.assign(new nM.a,
{scriptBaseUrl:FC.AppChromeOverrideUtilities.isEnabled?FC.AppChromeOverrideUtilities.KGd(t.AFrameworkApplication.lcid):t.AFrameworkApplication.C3+t.AFrameworkApplication.lcid+"/",isMLRRibbonMode:t.AFrameworkApplication.ua.Sb.Bec}),["scriptLoader"]:new DJ(new dynamicScriptLoader.DynamicScriptLoader(r)),["publicPath"]:t.AFrameworkApplication.C3,["appSettings"]:h.appSettings,["logger"]:new an.a,["featureGateManager"]:Object.assign(new oM.a,{getBooleanFeatureGate:Object(u.a)(h,h.getBooleanFeatureGate,
"getBooleanFeatureGate"),getIntFeatureGate:Object(u.a)(h,h.getIntFeatureGate,"getIntFeatureGate"),getStringFeatureGate:Object(u.a)(h,h.getStringFeatureGate,"getStringFeatureGate")}),["app"]:z,["resolveScript"]:(ba,ta)=>pM.a.resolveScript(ba,ta)};h.$("DynamicBundlesIsEnabled")&&(R.dynamicBundlesPath=FC.AppChromeOverrideUtilities.isEnabled?FC.AppChromeOverrideUtilities.ldc+"exp/":h.lb("StaticContentUrl")+"exp/");return new Promise((ba,ta)=>{b("gc2",t.AFrameworkApplication.Aw("gc2.js",5),"anonymous",
5,!1).then(()=>{ba(R)}).catch(()=>{v.ULS.sendTraceTag(572915794,3001,10,"ReactGraphicsEditorDialog::Bootstrap: Failed To Download Scripts");ta(null)})})}frh(b){b=this.m7a.hasEdits()&&!b;this.WFj(b?this.m7a.getGraphicData():null,!!this.zIg,this.zIg,b)}}Object(n.a)(EJ,"ReactGraphicsEditorDialog",Wc.a,[]);class FJ{constructor(b,h,r,z,R,ba,ta,Wa,ub,Ib,$b,fc,Kc,ed,Jd=!1){this.PKh=Jd;this.Opb=this._context=null;this.wXn=(ge,qe,Ve,Bd,he)=>{const we=!!he&&Object(nb.a)(E.a,he);try{if(1===Ve){const hg=qe.view;
return this.ij.vda(qe)&&hg.features.C$d?32:8}this.zJj=4===(null===he||void 0===he?void 0:he.InputMethod)?!0:!1;vb.App.instance&&vb.App.instance.cDb&&(this.PKh||kM.a.i1b(()=>{this.PKh=!0}));v.ULS.sendTraceTag(573100171,3001,50,`Launch Graphics Editor dialog. Existing:${we}`);performance.mark("LaunchStart");this._context=qe;this.Opb=(new EJ(this.m7a,this.RFf,we?he:null,qe,this.rg)).vXn().then(()=>{v.ULS.sendTraceTag(559424644,3001,50,`Graphics Editor dialog display success. Existing:${we}`)}).catch(()=>
{this.rAh()});if(!we){const hg=pn=>{this.Opb.then(()=>{this.fAi(pn,!1)})};if(t.AFrameworkApplication.sessionStartInfoSettings&&"Automation"===t.AFrameworkApplication.sessionStartInfoSettings.AudienceGroup)return hg(JSON.stringify({elements:[]})),32;let Pf=null;Pf=ml.PageNavigator.instance.ju(qe.view.rd);const Ej=Pf.properties.ia(yc.a.QKh,"");if(0<Ej.length)return hg(Ej),32;this.are.nFn(qe,E.a.create(),pa.a.create()).then(pn=>{const Ol=this.Hc.Rc(0,Fb.a.qKc);Ol.Db(Pf);Pf.setValue(yc.a.QKh,pn);Ol.dispose();
hg(pn);return null}).catch(pn=>{v.ULS.sendTraceTag(512521162,3001,10,"Exception = [{0}] when bringing up Graphics Editor Dialog. Existing:${1}",pn.toString(),we);this.rAh()})}return 32}catch(hg){return v.ULS.sendTraceTag(42328736,3001,10,"Exception = [{0}] when bringing up Graphics Editor Dialog. Existing:${1}",hg.toString(),we),8}};this.JSl=(ge,qe,Ve,Bd,he)=>{if(!qe.view.features.C$d)return 32;v.ULS.sendTraceTag(574232200,3001,50,"Launch Graphics Editor: DoubleClick");this.hCh(he,qe);return 32};
this.KSl=(ge,qe,Ve)=>{if(1===Ve)return qe.view.features.C$d?32:8;if(2===Ve){ge=$d.ImageReader.Xl(qe.vk);if(!ge)return 2;v.ULS.sendTraceTag(574232201,3001,50,"Launch Graphics Editor: ContextMenu");this.hCh(ge,qe);return 32}return 2};this.fAi=(ge,qe=!0)=>{this.m7a.setGraphicData(ge);performance.mark("LaunchEnd");performance.measure("EditorLaunch","LaunchStart","LaunchEnd");ge=performance.getEntriesByName("EditorLaunch");v.ULS.sendTraceTag(559424645,3001,50,`Graphics Editor dialog launched with data successfully set. Existing: ${qe} Duration: ${ge[ge.length-
1].duration}`);performance.clearMarks("LaunchStart");performance.clearMarks("LaunchEnd");performance.clearMeasures("EditorLaunch")};this.RFf=(ge,qe,Ve,Bd)=>{var he;this.m7a.teardown();if(qe&&this._context){var we=this._context.view.Cb.Rg,hg=we.node;we.vl&&ie.ParagraphReader.nc(hg)&&(we=null===(he=this.eP)||void 0===he?void 0:he.wA(hg),27==(null===we||void 0===we?void 0:we.role)&&v.ULS.sendTraceTag(541446533,3016,50,"Editing Pull Quote using Graphics Editor. Has edits: {0}; {1}",Bd,Bd?" Everything deleted: "+
(0==(null===ge||void 0===ge?void 0:ge.json.length)):""))}if(Bd)if(v.ULS.sendTraceTag(541714E3,3001,50,"GraphicsEditorActor: close dialog and save"),this._context)if(ge)if(Bd=ge.json,he=ge.width,hg=ge.height,Bd.length||qe)if(!Bd.length&&qe)if(qe=this._context.vk){qe=qe.node;if($d.ImageReader.s6(qe)){if(!this.ij.Eon(qe,new Nd.GraphIterator,Yh.a.instance,rJ.DeleteActor.yWb)){v.ULS.sendTraceTag(588817116,3001,10,"Failed to remove anchored image.");return}}else if(!this.ij.icc(qe,Ve,this.fb,this.OU)){v.ULS.sendTraceTag(572363225,
3001,10,"Failed to remove inline image.");return}v.ULS.sendTraceTag(572363226,3001,50,"Graphic removed thru dialog.")}else v.ULS.sendTraceTag(588886034,3001,10,"Context was in invalid state for removing existing content.");else we=new mM.a(this._context,t.AFrameworkApplication.ua.WLa,!0,this.ij,this.Oa,ml.PageNavigator.instance),ge=pa.a.create(),Ve=new QI.a(we,Bd,this.lJ,this.wm,ge,$m.a.instance,qe,Ve,this.ij,this.rm,he,hg,this.Oa,this.OU,this.Ac,vb.App.instance.cDb,vb.App.instance.Bmf),this.are.JWf(Ve,
this._context,qe,ge),this.XEa(),this.zJj&&this.Tao();else v.ULS.sendTraceTag(541714001,3001,50,"Empty Json on new content creation when close dialog");else v.ULS.sendTraceTag(577868244,3001,10,"JSON was unexpectedly null and the model did change!");else v.ULS.sendTraceTag(590205069,3001,10,"GraphicsEditorActor: context cannot be null")};this.ga=b;this.Oa=h;this.are=r;this.ij=z;this.lJ=R;this.wm=ba;this.m7a=new CJ;this.Hc=Wa;this.fb=ub;this.OU=Ib;this.rm=$b;this.Ac=Kc;this.rg=fc;this.eP=ed}Vb(){let b=
!0;this.Oa.$("GraphicsEditorActorRegistrationUpdateIsEnabled")||(b=this.Ac&&this.Ac.isFeatureEnabled(48));b&&!X.a.Ak&&(this.ga.gb(Oa.a.graphicsEditor,kc.a.view,this.wXn,4),this.ga.gb(Fb.a.T5e,kc.a.view,this.JSl,4),this.ga.gb(Oa.a.jCh,kc.a.view,this.KSl,4))}rAh(){const b=new te.StandardDialog;b.Fd=0;b.jy(fj.a.I5e,Box4Intl.Box4Strings.l_GraphicsEditorErrorTitle,WordEditorIntl.WordEditorStrings.L_GraphicsEditorDefaultError,null);vb.App.xa.updateCommandUI()}hCh(b,h){var r=b.ia(ui.a.l3,1);const z=b.ia(Ij.a.CZ,
0);r&&1!==z?b.ia(yc.a.Kqh,!1)?(h=new te.StandardDialog,h.Fd=0,h.jy(fj.a.I5e,Box4Intl.Box4Strings.l_GraphicsEditorErrorTitle,WordEditorIntl.WordEditorStrings.L_GraphicsEditorUnsupportedContentError,null,!0),vb.App.xa.updateCommandUI(),v.ULS.sendTraceTag(521426528,3001,15,"{0}",{["message"]:"Graphic already known to have unsupported properties",["id"]:$d.ImageReader.Ldb(b)})):(this.ga.Xb(Oa.a.graphicsEditor,2,b.id),this.Opb||(v.ULS.sendTraceTag(574997639,3001,10,"GraphicsEditorDialogInitialization promise was null!"),
this.Opb=new Promise(R=>{R(null)})),r=pa.a.create(),b=new BJ(b,this.fAi,$m.a.instance,this.Opb,this.rm,this.Oa,this.Ac,vb.App.instance.Ita(this.rm.ul(b))),this.are.JWf(b,h,!0,r)):v.ULS.sendTraceTag(573055959,3001,50,"Graphics Editor launch diverted since Box4 model is not ready!")}XEa(){const b=Sa.a.instance.Za("Common.ISystemInitiatedFeedback");b?b.execute(h=>{h.logActivity("WordWebDrawing","WordDrawingFloodgateIsEnabled")}):v.ULS.sendTraceTag(572352085,3001,10,"ISystemInitiatedFeedback was null")}Tao(){const b=
Sa.a.instance.Za("Common.ISystemInitiatedFeedback");b?b.execute(h=>{h.logActivity("WordPenNsatSurvey","WordPenNsatSurveyIsEnabled")}):v.ULS.sendTraceTag(520382472,3001,10,"ISystemInitiatedFeedback was null")}}Object(n.a)(FJ,"GraphicsEditorActor",null,[]);var rM=d(539);class GJ{constructor(b,h,r){this.jSa="wwaengidc";this.W8c="CreateLinkForHeading";this.qAj="CreateLinkForHeadingAction";this.vCj="\ufffc";this.WRa=b;this.ga=h;this.fb=r}Vb(){this.ga.pa(Oa.a.JCc,kc.a.paragraph,this.N0e.bind(this));this.ga.pa(Oa.a.JCc,
kc.a.Gd,this.N0e.bind(this));this.ga.pa(Oa.a.JCc,kc.a.Wc,this.N0e.bind(this));this.ga.Vc(Oa.a.JCc,1028)}N0e(b,h,r){if(t.AFrameworkApplication.K&&t.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.HeadingDeeplinkIsEnabled",!1)){b=h.node;if(1===r)return this.nei(b)?32:8;this.ain(this.W8c,this.qAj);if(!this.nei(b))return v.ULS.sendTraceTag(528815444,3029,50,"User is trying to create sharable link for a non-heading text"),8;r=b.getValue(yc.a.Nc);if(!r)return v.ULS.sendTraceTag(528815445,
3029,10,"Word id does not exist for the paragraph"),r=new Map,r.set("Source",this.W8c),r=Object.assign(new eb.a,{additionalValues:r}),Ca.Health.instance.recordKpiFailure(this.W8c,"Unable to create sharable link as paragraph id is missing",!1,!0,r),8;r=String.format('{{"{0}":"{1}"}}',rM.a.heading,r);b={};b.nav=btoa(r);b.mode="copy";this.ga.Xb(ab.a.Lcb,2,b);return 32}return 8}nei(b){return!this.fb.nc(b)||this.fb.VNc(b)||this.fb.MOd(b)||b.Sr||""===b.characterData||b.characterData===this.vCj||!this.WRa.YFd(b)?
!1:!0}ain(b,h){const r=new Map;r.set("Source",this.W8c);r.set("Action",h);Ca.Health.instance.recordKpiUsage(b,0,this.jSa,r)}}Object(n.a)(GJ,"HeadingsActor",null,[]);class HJ{DUn(b){return ie.ParagraphReader.hka(this.CRh(b))}i_c(b,h,r){if(b=ie.ParagraphReader.Kdb(this.CRh(b)))h=b.Ce(h),Object(nb.a)(490,h)&&(ly.k(b)?h.gPn(r):h.i_c())}CRh(b){return b&&b.vl&&b?b.node:null}}Object(n.a)(HJ,"IFrameFocusStrategy",null,[491]);class IJ{constructor(b){this.Ztb=null;this.lcd=b}zni(){v.ULS.sendTraceTag(25007835,
375,50,"Ignore all spelling error triggered")}nej(b){if(!b)return v.ULS.sendTraceTag(25007836,375,15,"Error range is null"),!1;if(!b.errorDetails)return v.ULS.sendTraceTag(25007837,375,15,"No error detail found"),!1;if(!b.errorDetails.token)return v.ULS.sendTraceTag(25007838,375,50,"Ignore-all: Token is null and the ErrorDetails type is {0}",Object.getType(b.errorDetails).toString()),!1;this.Ztb=B.a.Xae(b.errorDetails.token,b.errorDetails.lcid);this.lcd.add(this.Ztb,b.errorDetails.lcid);return!0}c8d(b){return b?
b.token?B.a.Xae(b.token,b.lcid)===this.Ztb:(v.ULS.sendTraceTag(25007840,375,15,"ErrorDetails Token is null"),!1):(v.ULS.sendTraceTag(25007839,375,15,"ErrorDetails is null during ignore-all operation"),!1)}}Object(n.a)(IJ,"IgnoreAllProofingErrorStrategy",null,[489]);var sM=d(1364),JJ=d(551);class KJ{constructor(b,h){this.filename=b;this.blob=h}}Object(n.a)(KJ,"UploadBlobParameters",null,[]);class LJ extends rl{constructor(b,h,r,z,R,ba,ta,Wa=null){super(b,h,r,null,R,ba,!1);this.DKj="DragAndDrop";this.jEg=
"FileName";this.mEg=0;this.B4g=null;this.rde=this.b0b=!1;this.tCg=z;this.iWg=Wa}get J2(){return this.DKj}get fileExtension(){return this.jEg}get fileSize(){return this.mEg}get njj(){return this.B4g}v1c(b){const h=new KJ(this.tCg.name,this.tCg);b.e9i(h);this.B4g=b.s$a}VKa(b,h){this.iWg&&this.iWg();super.VKa(b,h)}qpo(b){const h=!!b&&this.rwa(b.name,null)&&this.d$f(b,null);b&&(this.jEg=b.name,this.mEg=b.size);h||this.qTd();return h}}Object(n.a)(LJ,"DragDropInsertImageUploader",rl,[]);class Fr{constructor(b,
h,r,z,R){this.wUd=this.xUd=this.QUd=this.RUd=0;this.ga=null;this.z5e=(ba,ta,Wa)=>{if(vb.App.Bzd)return 8;ba=ta.node;return 1===Wa?ba?32:2:2===Wa?(Wa=$d.ImageReader.Xl(ta),ta=$d.ImageReader.$Ic(Wa,ta.node.Di().zd,t.AFrameworkApplication.K,t.AFrameworkApplication.ua.WLa),zt(ta),32):2};this.s6l=(ba,ta,Wa)=>{const ub=this.ij.vda(ta);if(2===Wa&&ub){if(Fb.a.lQ===ba||Fb.a.lud===ba)t.AFrameworkApplication.Ama?t.AFrameworkApplication.T0f():this.wMk(ta);return 32}return 1!==Wa||Fb.a.lQ!==ba&&Fb.a.lud!==ba?
2:ub?32:2};this.pCb=(ba,ta,Wa,ub,Ib)=>this.ij.vda(ta)?1===Wa?32:this.ij.jof(ta,Ib)?32:2:2;this.DOn=()=>{if(this.ib&&this.ib.hb&&this.ib.hb.kb){const ba=this.ib.hb.kb.Qa;ba&&this.ib.setSelection(Hf.SelectionFactory.xe(ba.node,ba.cpBegin))}};this.u_k=(ba,ta,Wa,ub,Ib)=>{v.ULS.sendTraceTag(42530333,307,50,"Drag and drop local content");if((ba=Ib.DataTransfer)&&ba.files&&0<ba.files.length){v.ULS.sendTraceTag(578380440,307,50,String.format("{0} files to drop",ba.files.length));for(Wa=0;Wa<ba.files.length;Wa++)ub=
ba.files[Wa],0<=B.a.mh(ub.type).indexOf("image")&&this.H5l(ub,ta)&&(ub=this.ib.hb.kb.Qa,this.ib.setSelection(Hf.SelectionFactory.xe(ub.node,ub.cpBegin+1)));this.HFa();return 32}v.ULS.sendTraceTag(42530334,307,15,"Drag and drop local content not handled");return 2};this.N4m=(ba,ta,Wa,ub,Ib)=>{if(2===Wa)return t.AFrameworkApplication.ya.Qf(ta.vk,ba,Wa,!0,ub,Ib);if(!ta.view.ze)return 8;ba=ta.view;if(!ba.Cb)return 8;ba=Fr.Tg.rP(ba.Cb.Rg);return 1===ba.length&&this.qN(ba[0])?(this.$zm(),this.NPc||Fr.uLf(!0),
32):8};this.DRl=(ba,ta,Wa)=>{if(!this.qN(ta))return 8;const ub=$d.ImageReader.Xl(ta),Ib=$d.ImageReader.tA(ub),$b=$d.ImageReader.JB(ub);ba=ba===Fb.a.kKd;v.ULS.sendTraceTag(20459936,322,50,"GrowShrinkImage: {0}",{["IsGrow"]:ba});if(1===Wa)return this.Te.r2||$d.ImageReader.t_a(ub)?2:ba&&Ib<this.xUd&&$b<this.wUd||!ba&&Ib>this.RUd&&$b>this.QUd?32:2;Wa=ba?1.1:.9;this.setSize(ub,ta,Ib*Wa,$b*Wa,!0);return 32};this.zbc=(ba,ta,Wa,ub,Ib)=>{if(!this.dza(ta))return 8;ba=$d.ImageReader.Xl(ta);ta=$d.ImageReader.DLa(ba);
Wa=$d.ImageReader.CLa(ba);if(0>=ta||0>=Wa)return 2;ba=$d.ImageReader.tA(ba)/ta*100;Ib.setValue(od.a.VLc,ba);return 32};this.c5b=(ba,ta,Wa,ub,Ib)=>{if(!this.dza(ta))return 8;ba=$d.ImageReader.Xl(ta);if(1===Wa)return this.Te.r2||$d.ImageReader.t_a(ba)?2:32;v.ULS.sendTraceTag(20459937,322,50,"Change image scale.");Wa=Ib.ia(od.a.VLc,-1)/100;ub=Ib.ia(od.a.Q6h,!1);const $b=Ib.ia(od.a.umf,!0);Ib=Ib.ia(od.a.vmf,!0);if(0>=Wa)return Fr.Mc.Zb(Sc.a.Sm,{["Reason"]:Xc.a.ACb}),2;const fc=$d.ImageReader.DLa(ba),
Kc=$d.ImageReader.CLa(ba),ed=$d.ImageReader.tA(ba),Jd=$d.ImageReader.JB(ba);if(0>=fc||0>=Kc)return Fr.Mc.Zb(Sc.a.P_,{["Reason"]:Xc.a.ACb}),2;ub?(ub=$b?Wa*ed:ed,Wa=Ib?Wa*Jd:Jd):(ub=$b?Wa*fc:ed,Wa=Ib?Wa*Kc:Jd);this.setSize(ba,ta,ub,Wa);xg.a.instance.J(4)&&vb.App.ud.Mp&&vb.App.ud.Lq.CG(ta.node);this.HFa();return 32};this.NHb=(ba,ta,Wa,ub,Ib)=>{if(!this.qN(ta))return 8;ba=$d.ImageReader.Xl(ta);ba=$d.ImageReader.JB(ba);if(0>=ba)return 2;Ib.setValue(od.a.EBa,ba);return 32};this.EBa=(ba,ta,Wa,ub,Ib)=>{if(!this.dza(ta))return 8;
ba=$d.ImageReader.Xl(ta);if(1===Wa)return this.Te.r2||$d.ImageReader.t_a(ba)?2:32;v.ULS.sendTraceTag(20459938,322,50,"Change image absolute height.");Wa=Ib.ia(od.a.EBa,0);Ib=$d.ImageReader.r_a(ba);if(0>=Wa)return Fr.Mc.Zb(Sc.a.Sm,{["Reason"]:Xc.a.ACb}),2;ub=$d.ImageReader.DLa(ba);const $b=$d.ImageReader.CLa(ba),fc=$d.ImageReader.tA(ba);var Kc=$d.ImageReader.JB(ba);Kc=fc/Kc;if(0>=ub||0>=$b)if(Fr.Mc.Zb(Sc.a.P_,{["Reason"]:Xc.a.ACb}),this.m3i(ba))return 2;this.setSize(ba,ta,Ib?Wa*Kc:fc,Wa);xg.a.instance.J(4)&&
vb.App.ud.Mp&&vb.App.ud.Lq.CG(ta.node);vb.App.xa.updateCommandUI();return 32};this.OHb=(ba,ta,Wa,ub,Ib)=>{if(!this.qN(ta))return 8;ba=$d.ImageReader.Xl(ta);ba=$d.ImageReader.tA(ba);if(0>=ba)return 2;Ib.setValue(od.a.FBa,ba);return 32};this.FBa=(ba,ta,Wa,ub,Ib)=>{if(!this.dza(ta))return 8;ba=$d.ImageReader.Xl(ta);if(1===Wa)return this.Te.r2||$d.ImageReader.t_a(ba)?2:32;v.ULS.sendTraceTag(20459939,322,50,"Change image absolute width.");Wa=Ib.ia(od.a.FBa,0);Ib=$d.ImageReader.r_a(ba);if(0>=Wa)return Fr.Mc.Zb(Sc.a.Sm,
{["Reason"]:Xc.a.ACb}),2;ub=$d.ImageReader.DLa(ba);const $b=$d.ImageReader.CLa(ba);var fc=$d.ImageReader.tA(ba);const Kc=$d.ImageReader.JB(ba);fc=Kc/fc;if(0>=ub||0>=$b)if(Fr.Mc.Zb(Sc.a.P_,{["Reason"]:Xc.a.ACb}),this.m3i(ba))return 2;this.setSize(ba,ta,Wa,Ib?Wa*fc:Kc);xg.a.instance.J(4)&&vb.App.ud.Mp&&vb.App.ud.Lq.CG(ta.node);vb.App.xa.updateCommandUI();return 32};this.QHb=(ba,ta,Wa,ub,Ib)=>{if(!this.qN(ta))return 8;ba=$d.ImageReader.Xl(ta);ba=$d.ImageReader.r_a(ba);Ib.setValue(od.a.QW,ba);return 32};
this.QW=(ba,ta,Wa,ub,Ib)=>{if(!this.qN(ta))return 8;ba=$d.ImageReader.Xl(ta);if(1===Wa&&this.Te.r2)return 2;xg.a.instance.J(4)&&vb.App.ud.Mp&&vb.App.ud.Lq.CG(ta.node);Ib&&(ta=Ib.ia(od.a.QW,!0),v.ULS.sendTraceTag(20459968,322,50,"Change image lock aspect ratio."),this.ij.vZi(ba,ta),vb.App.xa.updateCommandUI());return 32};this.J1a=(ba,ta,Wa,ub,Ib)=>{if(!this.qN(ta))return 8;ba=$d.ImageReader.Xl(ta);ba=$d.ImageReader.lT(ba);Ib.setValue(od.a.Xeb,ba);return 32};this.Xeb=(ba,ta,Wa,ub,Ib)=>{if(!this.qN(ta))return 8;
if(1===Wa)return this.Te.r2?2:32;if(xg.a.instance.J(4)&&vb.App.ud.Mp&&(ba=ta.node.ia(ui.a.mK,Sl.a.Cq),ba!==Sl.a.Cq&&(ba=vb.App.ud.Lq.Qdb(ba),JJ.CoauthLockEditor.getInstance().V2a(ba))))return Fr.Mc.Zb(Sc.a.Sm,{["Reason"]:Xc.a.dE}),2;ba=$d.ImageReader.Xl(ta);Ib=Ib.ia(od.a.Xeb,null);this.ij.RKn(ba,ta,Ib);v.ULS.sendTraceTag(21297027,322,50,"Change image alt text.");this.Qd.zs(13);return 32};this.I1a=(ba,ta,Wa,ub,Ib)=>{if(!this.qN(ta))return 8;ba=$d.ImageReader.Xl(ta);ba=$d.ImageReader.ZAa(ba);Ib.setValue(od.a.PW,
ba);return 32};this.PW=(ba,ta,Wa,ub,Ib)=>{if(!this.qN(ta))return 8;if(1===Wa)return this.Te.r2?2:32;if(xg.a.instance.J(4)&&vb.App.ud.Mp&&(ba=ta.node.ia(ui.a.mK,Sl.a.Cq),ba!==Sl.a.Cq&&(ba=vb.App.ud.Lq.Qdb(ba),JJ.CoauthLockEditor.getInstance().V2a(ba))))return Fr.Mc.Zb(Sc.a.Sm,{["Reason"]:Xc.a.dE}),2;ba=$d.ImageReader.Xl(ta);Ib=Ib.ia(od.a.PW,null);this.ij.QKn(ba,ta,Ib);v.ULS.sendTraceTag(21297029,322,50,"Change image alt text description.");this.Qd.zs(13);return 32};this.ij=b;this.Hm=h;this.Qd=r;this.xi=
z;this.ib=R}get Te(){return ne.PageReader.instance}get a$(){return this.Hm.instance}get zc(){return this.ga}e4l(){this.RUd=Rf.a.pn(1,0);this.QUd=Rf.a.pn(1,1);this.xUd=Rf.a.pn(1920,0);this.wUd=Rf.a.pn(1280,1)}Vb(b){this.ga=b;const h=this.N4m,r=this.s6l,z=this.pCb,R=this.DRl;b.gb(Fb.a.lQ,kc.a.view,r,1284);b.pa(Fb.a.pCb,kc.a.Wc,z);b.pa(Fb.a.pCb,kc.a.image,z);b.Vc(Fb.a.pCb,1284);b.gb(Fb.a.lud,kc.a.view,r,1284);b.gb(Fb.a.YVe,kc.a.view,h,1028);this.Pq(b,Fb.a.kKd,R);this.Pq(b,Fb.a.i1f,R);this.Pq(b,Fb.a.zbc,
this.zbc);this.Pq(b,Fb.a.NHb,this.NHb);this.Pq(b,Fb.a.OHb,this.OHb);this.Pq(b,Fb.a.J1a,this.J1a);this.Pq(b,Fb.a.I1a,this.I1a);this.Pq(b,Fb.a.c5b,this.c5b);this.Pq(b,Fb.a.K6d,this.EBa);this.Pq(b,Fb.a.L6d,this.FBa);this.Pq(b,Fb.a.m_c,this.Xeb);this.Pq(b,Fb.a.DJb,this.PW);this.Pq(b,Fb.a.QHb,this.QHb);this.Pq(b,Fb.a.QW,this.QW);this.Pq(b,Fb.a.z5e,this.z5e);b.gb(Fb.a.WBh,kc.a.view,this.u_k,4);b.Vc(Fb.a.kKd,4);b.Vc(Fb.a.i1f,4);b.Vc(Fb.a.zbc,69);b.Vc(Fb.a.NHb,69);b.Vc(Fb.a.OHb,69);b.Vc(Fb.a.QHb,69);b.Vc(Fb.a.J1a,
69);b.Vc(Fb.a.I1a,69);b.Vc(Fb.a.QW,4);b.Vc(Fb.a.c5b,4);b.Vc(Fb.a.K6d,4);b.Vc(Fb.a.L6d,4);b.Vc(Fb.a.m_c,4);b.Vc(Fb.a.DJb,4);this.e4l();this.NPc&&di.a.instance.oB(this.xqk)}Pq(b,h,r){b.pa(h,kc.a.image,r);b.pa(h,kc.a.ozb,r);b.pa(h,kc.a.Gd,r);b.pa(h,kc.a.anchoredObject,r)}wMk(b){new rl(b,Oe.a.instance,t.AFrameworkApplication.K,null,this.xi,this.ga)}ypo(b){return this.Te.r2?(Fr.Mc.Zb(Sc.a.Sm,{["Reason"]:Xc.a.compatMode}),!1):this.ga&&3!==this.ga.mode?(Fr.Mc.Zb(Sc.a.Sm,{["Reason"]:Xc.a.U6k}),!1):Fr.Zf.iZ(b)?
(Fr.Mc.Zb(Sc.a.Sm,{["Reason"]:Xc.a.dE}),!1):this.a$&&this.a$.HT(b)?(Fr.Mc.Zb(Sc.a.Sm,{["Reason"]:Xc.a.externalSelection}),!1):!0}wem(b){const h=$d.ImageReader.Xl(b);return h&&5===$d.ImageReader.ul(h)&&this.kci(b,h)}kci(b,h){(h=!$d.ImageReader.V2b(h)&&!$d.ImageReader.ePd(h))||Fr.Mc.Zb(Sc.a.Sm,{["Reason"]:Xc.a.Rqh});return h&&this.ypo(b)}H5l(b,h){h=new LJ(h,Oe.a.instance,t.AFrameworkApplication.K,b,this.xi,this.ga,this.ib,this.DOn);if(!h.qpo(b))return Ca.Health.instance.recordQosError("PictureDragDropInvalid",
["ImageInsertFailed"],!0,!0,!1,!1,null),v.ULS.sendTraceTag(578380439,307,50,"The file is not supported"),!1;new Em.a(document.body,Object(u.a)(h,h.dac,"onUploadFrameInitialized"),Object(u.a)(h,h.kwa,"uploadResponseReceived"),t.AFrameworkApplication.K,!1,void 0,Tl.a(t.AFrameworkApplication.K));return!0}qN(b){return this.wem(b)}dza(b){const h=$d.ImageReader.Xl(b);if(!h)return!1;const r=Sa.a.instance.Pa("Box4.IFeatureHelper"),z=$d.ImageReader.ul(h);return 5===z||10===z||48===z||11===z||r&&r.isFeatureEnabled(48)&&
4===z?this.kci(b,h):!1}get NPc(){var b;return null===(b=t.AFrameworkApplication.K)||void 0===b?void 0:b.getBooleanFeatureGate("Microsoft.Office.WordOnline.IsUpdatedTabUpdateEnabled",!1)}xqk(){Fr.uLf(!0)}setSize(b,h,r,z,R=!1){xg.a.instance.J(4)&&vb.App.ud.Mp&&vb.App.ud.Lq.CG(h.node);const ba=$d.ImageReader.r_a(b);let ta=1;r>this.xUd?ta=this.xUd/r:r<this.RUd&&(ta=this.RUd/r);let Wa=1;z>this.wUd?Wa=this.wUd/z:z<this.QUd&&(Wa=this.QUd/z);if(ba||R)ta=Math.min(ta,Wa),Wa=Math.min(ta,Wa);1!==ta&&(r*=ta);
1!==Wa&&(z*=Wa);this.b5e(b,h,r,z)}b5e(b,h,r,z){this.ij.d0i(b,h,r,z)}$zm(){v.ULS.sendTraceTag(20459969,322,50,"PictureTools Tab enabled.")}HFa(){t.AFrameworkApplication.K&&t.AFrameworkApplication.K.$("WordEditorInsertImagesFloodgateIsEnabled")&&window.setTimeout(()=>{const b=Sa.a.instance.Za("Common.ISystemInitiatedFeedback");b&&b.execute(h=>{h.logActivity("WordInsertImageApplied","WordEditorInsertImagesFloodgateIsEnabled")})},5E3)}m3i(b){const h=$d.ImageReader.DLa(b);b=$d.ImageReader.CLa(b);return 0>=
h||0>=b}static get Tg(){return sm.ContextSetEditor.instance}static get Zf(){return Yh.a.instance}static get Mc(){return wc.a.instance}}Fr.uLf=null;Object(n.a)(Fr,"ImageActor",null,[]);var aG=d(1137),bG=d(1138),WE=d(691),MJ=d(540),tM=d(492),uM=d(1445);class Sp extends Fr{constructor(b,h,r,z,R,ba,ta,Wa){super(b,h,z,ba,ta);this.IPg=!1;this.N8=null;this.Tv=(ub,Ib,$b,fc,Kc)=>{if(!this.qN(Ib))return 8;if(1===$b)return this.Te.r2?2:32;ub=parseInt(Kc);v.ULS.sendTraceTag(593372312,322,50,"SetPictureStyle: "+
ub);this.Vkd.wdn(Ib,$d.ImageReader.Xl(Ib),ub);this.eRc(Ib);this.HFa();return 32};this.y4d=(ub,Ib,$b)=>{if(!this.qN(Ib))return 8;v.ULS.sendTraceTag(593372311,322,50,"Applying Style Reset");ub=$d.ImageReader.Xl(Ib);if(1===$b)return this.Te.r2?2:32;$b=$d.ImageReader.Mdb(ub);1===$b?($b=new yf.GraphTransaction(15),$b.Db(Ib.node),$d.ImageReader.U5b()?ub.setValue(yc.a.ZGb,""):this.wJ.ppn(ub),$b.dispose(),this.ruc.create(ub,Ib).Tv(Gc.a.HRi),this.eRc(Ib)):2===$b&&this.ruc.create(ub,Ib).Tv(Gc.a.HRi);return 32};
this.jTl=(ub,Ib,$b,fc,Kc)=>{if(!this.qN(Ib))return 8;ub=$d.ImageReader.Xl(Ib);if(1===$b)return this.Te.r2||$d.ImageReader.I6b(ub)?2:32;Kc&&(this.wJ.v2c(ub,Ib),v.ULS.sendTraceTag(22381021,322,50,"Toggled Image Crop Mode"),vb.App.xa.updateCommandUI());this.HFa();return 32};this.kTl=(ub,Ib,$b,fc,Kc)=>{if(!this.qN(Ib))return 8;if(1===$b)return this.Te.r2?2:32;ub=$d.ImageReader.Xl(Ib);if(Kc){$b=$d.ImageReader.LNd($d.ImageReader.Xl(Ib));v.ULS.sendTraceTag(22381022,322,50,"Applying New Image Cropping, isCanvas: "+
$b);fc=Kc.ia(od.a.bfb,0);const ed=Kc.ia(od.a.Zeb,0),Jd=Kc.ia(od.a.$eb,0);Kc=Kc.ia(od.a.afb,0);const ge=$d.ImageReader.pla(ub),qe=$d.ImageReader.lla(ub),Ve=$d.ImageReader.nla(ub),Bd=$d.ImageReader.ola(ub);if(fc===ge&&ed===qe&&Jd===Ve&&Kc===Bd)return v.ULS.sendTraceTag(23070480,322,50,"Cropping Properties were the same as before, no need to update."),32;$b?(new aG.a(ub,new bG.a)).EIn(fc,ed,Jd,Kc,this.aRm,Ib):this.Vkd.ldn(Ib,$d.ImageReader.Xl(Ib),fc,ed,Jd,Kc);this.eRc(Ib);vb.App.xa.updateCommandUI()}return 32};
this.sKd=(ub,Ib,$b,fc,Kc)=>{if(!this.qN(Ib))return 8;fc=$d.ImageReader.Xl(Ib);if(1===$b)return this.Te.r2||$d.ImageReader.I6b(fc)?2:32;if(Kc){v.ULS.sendTraceTag(22552775,322,50,"Getting New Image Cropping From Spinners on Format Picture Pane");this.wJ.Hta()||this.wJ.v2c(fc,Ib);switch(ub){case Oa.a.NLc:ub=Kc.ia(od.a.bfb,-1);$b=0;break;case Oa.a.GLc:ub=Kc.ia(od.a.Zeb,-1);$b=1;break;case Oa.a.HLc:ub=Kc.ia(od.a.$eb,-1);$b=2;break;case Oa.a.ILc:ub=Kc.ia(od.a.afb,-1);$b=3;break;default:return 8}this.wJ.mjo(ub,
$b);this.eRc(Ib);vb.App.xa.updateCommandUI()}return 32};this.kjb=(ub,Ib,$b,fc,Kc)=>{if(!this.qN(Ib))return 8;$d.ImageReader.Xl(Ib);Kc&&(ub=this.wJ.Hta(),Kc.setValue(od.a.Hta,ub));return 32};this.ybc=(ub,Ib,$b,fc,Kc)=>{if(!this.qN(Ib))return 8;Ib=$d.ImageReader.Xl(Ib);if(Kc){if(this.wJ.Hta())({top:Jd,bottom:$b,left:ub,right:Ib}=this.wJ.uol());else{fc=Rf.a.yf($d.ImageReader.tA(Ib),0);var ed=Rf.a.yf($d.ImageReader.JB(Ib),1);var Jd=Math.max($d.ImageReader.pla(Ib),0);$b=Math.max($d.ImageReader.lla(Ib),
0);ub=Math.max($d.ImageReader.nla(Ib),0);Ib=Math.max($d.ImageReader.ola(Ib),0);fc=1E5*fc/(1E5-(ub+Ib));ed=1E5*ed/(1E5-(Jd+$b));Jd=Math.floor(Jd*ed/1E5);$b=Math.floor($b*ed/1E5);ub=Math.floor(ub*fc/1E5);Ib=Math.floor(Ib*fc/1E5)}Kc.setValue(od.a.bfb,Jd);Kc.setValue(od.a.Zeb,$b);Kc.setValue(od.a.$eb,ub);Kc.setValue(od.a.afb,Ib)}return 32};this.k4b=(ub,Ib,$b,fc,Kc)=>{if(!this.qN(Ib))return 8;if(1===$b){if(this.Te.r2)return 2;this.zCm();return 32}ub=$d.ImageReader.Xl(Ib);this.wJ.Hta()&&this.wJ.v2c(ub,
Ib);ub=Kc.ia(od.a.xEa,"");Kc=Kc.ia(od.a.L4a,0);v.ULS.sendTraceTag(20459970,322,50,"SetWrapTextAction: {0}",{["Type"]:Kc,["SourceControlId"]:ub});switch(Kc){case 1:this.wJ.CPn(Ib);break;case 8:this.wJ.G7d(Ib,1,1);break;case 9:this.wJ.G7d(Ib,1,3);break;case 3:this.wJ.G7d(Ib,2,void 0,!0);break;case 4:this.wJ.G7d(Ib,2,void 0,!1)}this.HFa();vb.App.xa.updateCommandUI();return 32};this.Obc=(ub,Ib,$b,fc,Kc)=>{if(!this.qN(Ib))return 8;ub=$d.ImageReader.Xl(Ib);Ib=$d.ImageReader.Q$(Ib);$b=$d.ImageReader.t6(ub);
fc=$d.ImageReader.RJc(ub);ub=$d.ImageReader.Hv(ub);return this.jdn(Ib,$b,fc,ub,Kc)?32:8};this.mTl=(ub,Ib,$b,fc,Kc)=>{if(!this.dza(Ib))return 8;fc=$d.ImageReader.Xl(Ib);if(1===$b)return Xh.SessionStatusManager.instance.Sj?8:this.Te.r2||$d.ImageReader.K6b(fc)?2:32;this.wJ.Hta()&&this.wJ.v2c(fc,Ib);if(Kc){var ed=Kc.ia(od.a.SLc,0);const Jd=$d.ImageReader.LNd(fc);v.ULS.sendTraceTag(22052889,322,50,"SetImageRotateAction: {0}, isCanvas: {1}",ed,Jd);$b=$d.ImageReader.vZ(fc);let ge=$d.ImageReader.dGd(fc),
qe=$d.ImageReader.mAb(fc);switch(ed){case 0:$b=Kc.ia(od.a.dK,0);break;case 2:$b-=90;$b=cd.c($b);break;case 1:$b+=90;$b=cd.c($b);break;case 4:ge=!ge;break;case 3:qe=!qe;break;case 5:$b+=Kc.ia(od.a.dK,0),$b=cd.c($b)}Jd?(new aG.a(fc,new bG.a)).cOn($b,ge,qe,this.HWm,Ib):ed?this.ruc.create(fc,Ib).oNn($b,ge,qe):(Kc=pa.a.create(),ed=new yf.GraphTransaction(15,Fb.a.imageRotate),ed.Db(Ib.node),this.wJ.$Kn(fc,$b),this.Vkd.sdn(Ib,$d.ImageReader.Xl(Ib),$b,Kc),ed.NCa(Kc,1),ed.Al=ub,ed.dispose());this.HFa();this.eRc(Ib);
vb.App.xa.updateCommandUI()}return 32};this.PHb=(ub,Ib,$b,fc,Kc)=>{if(!this.qN(Ib))return 8;ub=$d.ImageReader.Xl(Ib);ub=$d.ImageReader.vZ(ub);if(0>ub)return 2;Kc.setValue(od.a.dK,ub);return 32};this.HWm=(ub,Ib,$b,fc)=>{if(ub){const Kc=new yf.GraphTransaction(15,Fb.a.imageRotate);Kc.Db(fc.node);Ib.setValue(od.a.PYb,JSON.stringify($b));Ib.setValue(od.a.Fu,ub);this.wJ.O6d(Ib,$b.rotationAngle,$b.N4b,$b.Whc);this.Czb(Ib);Kc.dispose()}};this.tWm=(ub,Ib,$b,fc)=>{if(ub){const Kc=new yf.GraphTransaction(15);
Kc.Db(fc.node);Ib.setValue(od.a.PYb,JSON.stringify($b));Ib.setValue(od.a.Fu,ub);this.wJ.x6d(Ib,$b.ice,$b.o3c);this.Czb(Ib);Kc.dispose()}};this.aRm=(ub,Ib,$b,fc)=>{if(ub){const Kc=new yf.GraphTransaction(15);Kc.Db(fc.node);Ib.setValue(od.a.PYb,JSON.stringify($b));Ib.setValue(od.a.Fu,ub);this.wJ.UKn(Ib,Math.round($b.Vza*WE.a.zbb),Math.round($b.Sza*WE.a.zbb),Math.round($b.Tza*WE.a.zbb),Math.round($b.Uza*WE.a.zbb));this.Czb(Ib);Kc.dispose()}};this.kVc=(ub,Ib,$b,fc,Kc)=>{if(!this.dza(Ib))return 8;if(1===
$b)return 32;ub=Ib.contextId===kc.a.view?ne.PageReader.instance.eHd(Ib):ml.PageNavigator.instance.ju(Ib.node);if(!ub)return 8;$b=$d.ImageReader.Xl(Ib);Ib=this.vo.AWh(Im.a.kT(Ib),$b);Sp.QEi.vdc=Ib;Ib=Sp.QEi.XDd(ub,vb.App.rZb);if(!Ib)return 8;Kc.MenuItems=Ib;return 32};this.u7=(ub,Ib,$b,fc,Kc)=>{if(!this.dza(Ib))return 8;if((fc=$d.ImageReader.Xl(Ib))&&$d.ImageReader.Wx(fc))return 2;if(1===$b)return 32;if(2!==$b)return 2;if(!Kc)return v.ULS.sendTraceTag(571287758,322,10,"SetPictureBorderColor: actionData null"),
8;$b=new yf.GraphTransaction(15);$b.Db(Ib.node);const ed=Sp.pgc.yza(Ib.node,Kc);this.vo.u7(fc,Kc,Ib,ed);this.Czb(fc);$b.dispose();ub==Fb.a.x_c&&this.recentColors.L$a(Kc);this.X5c();this.HFa();return 32};this.Ufa=(ub,Ib,$b)=>{if(!this.dza(Ib))return 8;if(1===$b)return 32;vb.App.xa.qw();Sp.Q5a=new yu.a("PictureBorder",Fb.a.x_c);Sp.Q5a.y0c(0);return 32};this.Nga=(ub,Ib,$b,fc,Kc)=>{if(!this.dza(Ib))return 8;if(1===$b)return 32;if((ub=$d.ImageReader.Xl(Ib))&&$d.ImageReader.Wx(ub))return 2;if(!Kc)return v.ULS.sendTraceTag(571287759,
322,10,"SetPictureBorderWeight: actionData null"),8;$b=new yf.GraphTransaction(15);$b.Db(Ib.node);this.vo.Nga(ub,Kc,Ib);this.Czb(ub);$b.dispose();this.X5c();this.HFa();return 32};this.O2a=(ub,Ib,$b,fc,Kc)=>{if(!this.dza(Ib))return 8;if(1===$b)return 32;if((ub=$d.ImageReader.Xl(Ib))&&$d.ImageReader.Wx(ub))return 2;if(!Kc)return v.ULS.sendTraceTag(571287760,322,10,"SetPictureBorderStyle: actionData null"),8;$b=new yf.GraphTransaction(15);$b.Db(Ib.node);this.vo.O2a(ub,Kc,Ib);this.Czb(ub);$b.dispose();
this.X5c();this.HFa();return 32};this.G3d=(ub,Ib,$b)=>{if(!this.dza(Ib))return 8;if(1===$b)return 32;ub=$d.ImageReader.Xl(Ib);$b=new yf.GraphTransaction(15);$b.Db(Ib.node);$d.ImageReader.w4b(ub)&&(this.vo.G3d(ub),this.Czb(ub));$b.dispose();this.X5c();this.HFa();return 32};this.wJ=b;this.ruc=r;this.Vkd=R;Sp.Eh=Wa;Fr.uLf=Sp.O4m}get recentColors(){return null!=this.Kpg?this.Kpg:this.Kpg=Sa.a.instance.Pa("Box4.UI.RecentColorsSectionHandler")}get vo(){this.N8||(this.N8=new MJ.a);return this.N8}Vb(b){super.Vb(b);
this.Pq(b,Fb.a.Tv,this.Tv);b.Vc(Fb.a.Tv,4);this.Pq(b,Fb.a.y4d,this.y4d);this.Pq(b,Oa.a.yee,this.k4b);b.Vc(Oa.a.yee,4);this.Pq(b,Oa.a.zee,this.k4b);this.Pq(b,Oa.a.Aee,this.k4b);this.Pq(b,Oa.a.Bee,this.k4b);this.Pq(b,Oa.a.Cee,this.k4b);this.Pq(b,Oa.a.Dee,this.k4b);this.Pq(b,Oa.a.Obc,this.Obc);b.Vc(Oa.a.Obc,101);this.Pq(b,Oa.a.imageCrop,this.jTl);b.Vc(Oa.a.imageCrop,4);this.Pq(b,Oa.a.kjb,this.kjb);b.Vc(Oa.a.kjb,101);this.Pq(b,Oa.a.K6h,this.kTl);this.Pq(b,Oa.a.NLc,this.sKd);this.Pq(b,Oa.a.GLc,this.sKd);
this.Pq(b,Oa.a.HLc,this.sKd);this.Pq(b,Oa.a.ILc,this.sKd);this.Pq(b,Oa.a.eWc,this.ybc);b.Vc(Oa.a.eWc,101);this.Pq(b,Oa.a.l1d,this.ybc);b.Vc(Oa.a.l1d,101);this.Pq(b,Oa.a.m1d,this.ybc);b.Vc(Oa.a.m1d,101);this.Pq(b,Oa.a.n1d,this.ybc);b.Vc(Oa.a.n1d,101);this.Pq(b,Fb.a.imageRotate,this.mTl);b.Vc(Fb.a.imageRotate,4);this.Pq(b,Fb.a.PHb,this.PHb);b.Vc(Fb.a.PHb,101);this.Pq(b,Fb.a.kVc,this.kVc);b.Vc(Fb.a.kVc,4);this.Pq(b,Fb.a.u7,this.u7);b.Vc(Fb.a.u7,4);this.Pq(b,Fb.a.x_c,this.u7);b.Vc(Fb.a.x_c,4);this.Pq(b,
Fb.a.pJf,this.Ufa);b.Vc(Fb.a.pJf,4);this.Pq(b,Fb.a.eva,this.eva.bind(this));b.Vc(Fb.a.eva,4);this.Pq(b,Fb.a.Nga,this.Nga);b.Vc(Fb.a.Nga,4);this.Pq(b,Fb.a.SHb,this.SHb.bind(this));b.Vc(Fb.a.SHb,4);this.Pq(b,Fb.a.O2a,this.O2a);b.Vc(Fb.a.O2a,4);this.Pq(b,Fb.a.WDf,this.G3d);b.Vc(Fb.a.WDf,4)}b5e(b,h,r,z){v.ULS.sendTraceTag(593372313,322,50,"Applying New Image Resize, isCanvas: "+$d.ImageReader.LNd(b));this.wJ.Hta()&&this.wJ.v2c(b,h);if($d.ImageReader.Wx(b)){b=pa.a.create();const R=new yf.GraphTransaction(15);
R.Db(h.node);this.Vkd.rdn(h,$d.ImageReader.Xl(h),r,z,b);R.NCa(b,1);R.dispose()}else $d.ImageReader.Fec(b)?(new aG.a(b,new bG.a)).NNn(r,z,this.tWm,h):(super.b5e(b,h,r,z),this.Qd.zs(13))}qN(b){if(!b.vl)return!1;var h=b.node;return(h=vb.App.instance&&vb.App.instance.cDb?h instanceof Hm.a||h instanceof uM.a?h:null:Object(la.a)(Hm.a,h))&&ly.m(h)?(Fr.Mc.Zb(sM.a.Sm,{["Reason"]:Ov.a.uN}),!1):super.qN(b)}static O4m(b){b&&!Sp.Srb&&(Sp.Eh.pVa(Sp.aib),Sp.Srb=!0)}jdn(b,h,r,z,R){return R?(R.Ddi=b,R.t6=h,R.rLb=
r,R.Zs=z,R.L4a=Sp.NPl(R),!0):!1}eRc(b){xg.a.instance.J(4)&&vb.App.ud.Mp&&vb.App.ud.Lq.CG(b.node)}zCm(){this.IPg||(v.ULS.sendTraceTag(20459971,322,50,"Wrap Text UI enabled."),this.IPg=!0)}Czb(b){const h=tM.a.instance.rBd(b);this.wJ.M6d(b,h[0],h[1],h[2],h[3])}eva(b,h,r,z,R){2===r&&(b=$d.ImageReader.Xl(h),this.vo.Nsj(R,b));return 32}SHb(b,h,r,z,R){2===r&&(b=$d.ImageReader.Xl(h),this.vo.Msj(R,b));return 32}X5c(){t.AFrameworkApplication.K&&t.AFrameworkApplication.K.$("PictureBorderFloodgateSurveyIsEnabled")&&
window.setTimeout(()=>{const b=Sa.a.instance.Za("Common.ISystemInitiatedFeedback");b&&b.execute(h=>{h.logActivity("PictureBorderApplied","PictureBorderFloodgateSurveyIsEnabled")})},5E3)}static get pgc(){return null!=Sp.xrg?Sp.xrg:Sp.xrg=xq.a.instance}static get QEi(){Sp.RU||(Sp.RU=new Zu.a("PictureBorder"),Sp.GZa(Sp.RU));return Sp.RU}static NPl(b){if(b.Ddi)b=1;else switch(b.rLb){case 2:b=b.t6?3:4;break;case 1:b=1===b.Zs?8:3===b.Zs?9:2;break;case 0:b=5;break;case 3:b=6;break;case 4:b=7;break;default:b=
0}return b}static GZa(b){b.cda(3,Fb.a.u7);b.cda(4,Fb.a.u7);b.cda(5,Fb.a.x_c);b.cda(6,Fb.a.u7);b.aXb(gs.a.instance,1)}}Sp.Srb=!1;Sp.RU=null;Sp.Q5a=null;Sp.aib=()=>{Sp.Eh.mcc(Sp.aib);Sp.Srb=!1;const b=appChrome.selectors.getActiveContextualTabIds();"Home"===appChrome.selectors.getSelectedTabId()&&0<=Array.indexOf(b,"Picture")&&appChrome.api.dispatch(appChrome.actions.setCurrentTab("Picture"))};Object(n.a)(Sp,"ImageActor",Fr,[]);class Lm{static get paragraphEditor(){return null!=Lm.gpg?Lm.gpg:Lm.gpg=
Sa.a.instance.resolve("Box4.IParagraphEditor")}static get ey(){return null!=Lm.spg?Lm.spg:Lm.spg=Sa.a.instance.resolve("Box4.IParagraphIndentationReader")}static get g_(){return Lm.paragraphEditor.qp}static get xi(){return null!=Lm.ysg?Lm.ysg:Lm.ysg=Sa.a.instance.resolve("Box4.IUndoManager")}static Vb(){const b=t.AFrameworkApplication.ya;b.pa(Fb.a.CHb,kc.a.view,lm.a.Av);b.pa(Fb.a.CHb,kc.a.paragraph,Lm.Cja);b.Vc(Fb.a.CHb,1036);b.pa(Fb.a.eyb,kc.a.view,lm.a.Av);b.pa(Fb.a.eyb,kc.a.paragraph,Lm.Cja);b.Vc(Fb.a.eyb,
1036);b.pa(Fb.a.Obb,kc.a.view,lm.a.Av);b.pa(Fb.a.Obb,kc.a.paragraph,Lm.Cja);b.Vc(Fb.a.Obb,1036);b.pa(Fb.a.hcc,kc.a.view,lm.a.Av);b.pa(Fb.a.hcc,kc.a.paragraph,Lm.Cja);b.Vc(Fb.a.hcc,1036);b.pa(Fb.a.MXc,kc.a.view,lm.a.Av);b.pa(Fb.a.MXc,kc.a.paragraph,Lm.Cja);b.Vc(Fb.a.MXc,1036);b.pa(Fb.a.CZa,kc.a.view,lm.a.Av);b.pa(Fb.a.CZa,kc.a.paragraph,Lm.Cja);b.Vc(Fb.a.CZa,1036);b.pa(Fb.a.hfb,kc.a.view,lm.a.Av);b.pa(Fb.a.hfb,kc.a.paragraph,Lm.Cja);b.Vc(Fb.a.hfb,1036);b.pa(Fb.a.BZa,kc.a.view,lm.a.Av);b.pa(Fb.a.BZa,
kc.a.paragraph,Lm.Cja);b.Vc(Fb.a.BZa,1036);b.pa(Fb.a.Q6d,kc.a.view,Lm.G9d);b.pa(Fb.a.Q6d,kc.a.paragraph,Lm.G9d);b.Vc(Fb.a.Q6d,1028);b.pa(Fb.a.mYf,kc.a.view,Lm.G9d);b.pa(Fb.a.mYf,kc.a.paragraph,Lm.G9d);b.Vc(Fb.a.mYf,1028);b.pa(Fb.a.RJb,kc.a.view,lm.a.Av);b.pa(Fb.a.RJb,kc.a.paragraph,Lm.Cja);b.Vc(Fb.a.RJb,1036);b.pa(Fb.a.ukb,kc.a.view,lm.a.Av);b.pa(Fb.a.ukb,kc.a.paragraph,Lm.Cja);b.Vc(Fb.a.ukb,1036);b.pa(Fb.a.SJb,kc.a.view,lm.a.Av);b.pa(Fb.a.SJb,kc.a.paragraph,Lm.Cja);b.Vc(Fb.a.SJb,1036);b.pa(Fb.a.A9d,
kc.a.view,lm.a.Av);b.Vc(Fb.a.A9d,1028);b.pa(Fb.a.G_c,kc.a.view,lm.a.Av);b.pa(Fb.a.G_c,kc.a.paragraph,Lm.Cja);b.Vc(Fb.a.G_c,1036);b.pa(Fb.a.H_c,kc.a.view,lm.a.Av);b.pa(Fb.a.H_c,kc.a.paragraph,Lm.Cja);b.Vc(Fb.a.H_c,1036)}static G9d(b,h,r,z,R){2===r&&""===R[Cc.a.Text]&&(b=b===Fb.a.Q6d?Fb.a.CZa:Fb.a.BZa,h=new dz.a,h.value=0,h.unit=vb.App.x6?2:1,t.AFrameworkApplication.ya.Xb(b,2,h),vb.App.xa.updateCommandUI());return 32}static Cja(b,h,r,z,R){if(!({Gx:r}=lm.a.n_f(r,h)).returnValue)return r;h=h.node;switch(b){case Fb.a.CHb:Lm.g_.ZNf(h,
!0);break;case Fb.a.eyb:Lm.g_.ZNf(h,!1);break;case Fb.a.Obb:Lm.g_.Obb(h);break;case Fb.a.hcc:Lm.g_.$aa(h,0);break;case Fb.a.MXc:Lm.g_.mkb(h,0);break;case Fb.a.hfb:case Fb.a.CZa:r=new Nd.GraphIterator;r.set(h);r.Bb(11);let ba=R.value;R=R.unit;b===Fb.a.hfb&&(ba=(new Wj.a(R,ba)).kt+Lm.ey.wF(h).kt,R=1);Lm.g_.Hva(r,R,ba);break;case Fb.a.BZa:Lm.g_.EJb(h,R.unit,R.value);break;case Fb.a.RJb:R?(b=(new Wj.a(R.unit,R.value)).kt,Lm.g_.$aa(h,b)):Lm.ey.LFd(h).kt||Lm.g_.$aa(h,Ff.OutlineReader.yL(h));break;case Fb.a.ukb:R?
(b=(new Wj.a(R.unit,R.value)).kt,Lm.g_.mkb(h,b)):Lm.ey.wF(h).kt||Lm.g_.mkb(h,Ff.OutlineReader.yL(h));break;case Fb.a.SJb:Lm.g_.$aa(h,0);break;case Fb.a.G_c:b=R;b=(new Wj.a(b.unit,b.value)).kt;Lm.g_.dZf(h,1,b);break;case Fb.a.H_c:b=R,b=(new Wj.a(b.unit,b.value)).kt,Lm.g_.dZf(h,2,b)}Lm.xi.EF();z&&pc.a.Clb&&(z.Lr|=pc.a.xdb(h));return 32}}Object(n.a)(Lm,"IndentationActor",null,[]);var NJ=d(316),vM=d(51),XE=d(452),wM=d(1184);class Aq{constructor(b){this.tTa=this.Iya=this.usc=null;this.K5g=!1;this.x0d=
h=>{if(this.Iya)if(h===ab.a.w0d)ve.FocusManager.instance().getRegion(ke.AFrame.y1a).P9b();else if(h===ab.a.v0d)ve.FocusManager.instance().getRegion(ke.AFrame.y1a).N9b();else return 2;else return 2;return 32};this._frame=b}a2n(){if(this.K5g)this.zki();else{const b=hc.a.create(t.AFrameworkApplication.K.lb("WopiBootstrapUrl"));b.VV((h,r)=>{r.succeeded?(this.K5g=!0,this.zki()):v.ULS.sendTraceTag(40436806,323,10,"Failed to download word.boot.js")});Rb.a.XS(b)}}zki(){if(this.usc)v.ULS.sendTraceTag(38130908,
323,10,"previewPanel: Tried to launch while already running");else{const b=this._frame.Goa;this.Iya=document.createElement("div");b.parentNode.insertBefore(this.Iya,b);this.tTa=previewPanel.FactoryGlobal.getWordDocumentPanel(this,{fileName:t.AFrameworkApplication.K.lb("FileName"),reactRoot:this.Iya});this.tTa.setWebpackPublicPath(t.AFrameworkApplication.C3);this.tTa.renderDocumentPanel()}}vwl(b){const h={};h.Container=b;h.BootstrapperUrl=t.AFrameworkApplication.K.lb("WopiBootstrapUrl");h.ApplicationUrl=
this._frame.Amb;b={};b.HostName=t.AFrameworkApplication.K.lb("FileSource");b.HostSessionId=t.AFrameworkApplication.K.lb("HostSessionId");b.UserId=t.AFrameworkApplication.K.lb("UserId");b.DocumentClickTime=new Date(this._frame.yhb);b.SessionContext="";b.WdParams={};h.SessionInformation=b;b={};b.FileName=t.AFrameworkApplication.K.lb("FileName");b.FileGetUrl="";b.ReadOnly=!1;b.BundleInfo={MajorVersion:1,Url:""};h.WopiPrecheckInfo=b;h.ApplicationCustomSettings={WopiFallbackEnabled:!0,appFrameName:"PreviewPanelApplicationFrame",
IsCore:!0,InAppDocumentPreview:!0};b={entryPoint:"WordEditorPreviewPanel"};b.userClickTime=this._frame.yhb;h.Diagnostics=b;b={};b.WopiSrc=t.AFrameworkApplication.K.lb("WopiSrc");b.AccessToken=t.AFrameworkApplication.K.lb("AccessToken");b.AccessTokenTtl=t.AFrameworkApplication.K.lb("AccessTokenTtl");h.WopiInfo=b;h.FnOnInitializeSuccess=r=>{Aq.SV=r;this.tTa.setMaxPage(Aq.SV.GetPageCount());this.tTa.setCurrentPage(Aq.SV.GetCurrentPage());this.tTa.setPageControlVisible(!0);Aq.SV.RegisterEventHandler("PageChanged",
z=>{this.tTa.setCurrentPage(z.newPage)});Aq.SV.RegisterEventHandler("BrowserEvent",z=>{27===z.keyCode?this.closeViewer():z.button&&1!==z.button||this.Iya.click()});r=this._frame.yhb-(new Date).getTime();v.ULS.sendTraceTag(38355488,323,50,"previewPanel: Load finished - {0}",r);this.Vb();ve.FocusManager.instance().uK(ke.AFrame.y1a,!0);this.buildFocusRegion();this.JDa(ve.FocusManager.instance().re(ke.AFrame.y1a));this.Iya.click()};h.FnOnInitializeFailure=(r,z)=>{v.ULS.sendTraceTag(38273185,323,10,"previewPanel: {1}: {0}",
r.toString(),z.toString());this.closeViewer()};return h}buildFocusRegion(){const b=ve.FocusManager.instance();var h=b.getRegion(ke.AFrame.y1a);h=[2,3];const r=b.re(ke.AFrame.y1a),z=new xe.DOMFocusListing(()=>this.Iya);z.PDa=!0;for(let R of h)z.Go(R);h=b.Pja(()=>this.Iya,r,z);h.JOa();h.mX=!0;h.oWa=!0;z.oy(z.lea)}Vb(){t.AFrameworkApplication.ya.pa(ab.a.w0d,Yd.a.frame,this.x0d);t.AFrameworkApplication.ya.pa(ab.a.v0d,Yd.a.frame,this.x0d)}JDa(b){b.Dr(ve.FocusManager.instance().EV);b.Dr(ve.FocusManager.instance().FV);
b.bindAction(ve.FocusManager.instance().EV,ab.a.w0d);b.bindAction(ve.FocusManager.instance().FV,ab.a.v0d)}loadViewer(b){b=this.vwl(b);this.usc=Microsoft.Office.Word.Viewer.InitializeWopiPending(b);this.usc.Complete(b.WopiInfo)}closeViewer(){ve.FocusManager.instance().NQ(ke.AFrame.y1a);Aq.SV&&(Aq.SV.Dispose(),Aq.SV=null,t.AFrameworkApplication.ya.Yy(ab.a.w0d,Yd.a.frame,this.x0d),t.AFrameworkApplication.ya.Yy(ab.a.v0d,Yd.a.frame,this.x0d));this.usc&&(this.Iya.parentNode.removeChild(this.Iya),this.Iya=
this.usc=null)}printAction(){v.ULS.sendTraceTag(38355489,323,50,"previewPanel: Print Called");t.AFrameworkApplication.ya.processAction(Fb.a.print,2)}downloadPdfAction(){v.ULS.sendTraceTag(38355490,323,50,"previewPanel: Download to PDF Called");t.AFrameworkApplication.ya.processAction(Oa.a.AEc,2)}downloadCopyAction(){v.ULS.sendTraceTag(38355491,323,50,"previewPanel: Download Copy Called");t.AFrameworkApplication.ya.processAction(ab.a.downloadACopy,2)}zoomInAction(){if(Aq.SV){let b=Aq.SV.GetZoomLevel();
b+=.2;Aq.SV.SetZoomLevel(b)}}zoomOutAction(){if(Aq.SV){let b=Aq.SV.GetZoomLevel();b-=.2;Aq.SV.SetZoomLevel(b)}}setPage(b){if(Aq.SV){const h=Aq.SV.GetPageCount();1>b?(Aq.SV.SetCurrentPage(1),this.tTa.setCurrentPage(1)):1<=b&&b<=h?Aq.SV.SetCurrentPage(b):(Aq.SV.SetCurrentPage(h),this.tTa.setCurrentPage(h))}}static getInstance(b){Aq.nDe||(Aq.nDe=new Aq(b));return Aq.nDe}}Aq.SV=null;Aq.nDe=null;Object(n.a)(Aq,"PreviewPanelActor",null,[]);class nq{static get Tkj(){return null!=nq.Esg?nq.Esg:nq.Esg=t.AFrameworkApplication.K.lb("ClassicViewModePreferenceCookieName")}static Vb(b,
h){b.gb(Fb.a.eIb,Yd.a.frame,nq.imj,128);b.pa(Fb.a.N$d,Yd.a.frame,nq.imj);nq.ND=h;b.pa(Oa.a.uQc,Yd.a.frame,nq.uQc);b.pa(Oa.a.wQc,Yd.a.frame,nq.wQc);b.gb(Oa.a.uWc,Yd.a.frame,nq.uWc,96);b.gb(Oa.a.IWc,Yd.a.frame,nq.IWc,96)}static imj(b,h,r){if(h.contextId!==Yd.a.frame)return 2;h=ja.App.fm;switch(b){case Fb.a.eIb:if(!h.Amb)return 8;if(1===r)return Xh.SessionStatusManager.instance.Sj?8:32;b=(new Date).getTime();sd.a.instance.gjn(b);h.yhb=b;t.AFrameworkApplication.K.$("InAppDocumentPreviewIsEnabled")?Qv.a.PP(3,
!0,nq.d8m,null,h):Qv.a.PP(3,!0,nq.Ysi,null,h);return 32;case Fb.a.N$d:return 32;default:return 2}}static Ysi(b){XE.a()?nq.zOl(b):nq.K9i(b)}static zOl(b){const h={};h[G.a.Jlf]=nq.Tkj;t.AFrameworkApplication.bQ().execute(r=>{r.xv(F.a.Klf);r.Peo(F.a.Klf);r.cC(F.a.Klf,z=>{nq.vtk(z,b)});r.sendMessage(F.a.Dul,h)})}static vtk(b,h){b.Values[G.a.Jlf]===nq.Tkj&&("true"===b.Values[G.a.a6h]?nq.K9i(h):(nq.Zho(),nq.Z4n()))}static Zho(){if("View"!==appChrome.selectors.getModeSwitcherMode()){const b={activeMode:"View"};
t.AFrameworkApplication.Hf("RibbonCleanupForUnifiedRead;RibbonCleanupForUnifiedReadcf");t.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.RibbonCleanupForUnifiedReadIsEnable",!1)?appChrome.dispatchUpdateAppModeAndTabsAction(b):appChrome.api.dispatch(appChrome.actions.updateModeSwitcher(b))}}static Z4n(){t.AFrameworkApplication.Iu=!0;vb.App.xa.I7(1);vb.App.xa.jb.wv&&vb.App.xa.jb.wv.wi&&vb.App.xa.jb.wv.znf();t.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ClassViewButtonBugFix",
!1)&&vb.App.xa.updateCommandUI();wM.PageView.Fcj(t.AFrameworkApplication.K)}static K9i(b){try{const h=new Lc.a;let r,z;t.AFrameworkApplication.ilj?(r=vb.App.hostUrl,z=3):(r=b.Amb,z=1);b.yhb&&h.add(t.AFrameworkApplication.rAf,b.yhb.toString());t.AFrameworkApplication.Kpf&&h.add(t.AFrameworkApplication.HZe,"1");t.AFrameworkApplication.vVe&&h.add(t.AFrameworkApplication.DDk,"1");h.add(NJ.a.Q9f,NJ.a.userSessionData);h.add(t.AFrameworkApplication.A0d,t.AFrameworkApplication.userSessionId);const R=t.AFrameworkApplication.K.lb(t.AFrameworkApplication.pha);
R&&h.add(t.AFrameworkApplication.Nej,R);v.ULS.sendTraceTag(573095942,324,100,"Navigate to view mode");XE.b(t.AFrameworkApplication.K)?XE.d("view",h,XE.c):(r=Rc.a.L8g(r,h),t.AFrameworkApplication.ilj?Ed.a.Cm(r,Ed.a.Ioa(z),void 0,"AuthenticationLostDuringSession"):Ed.a.openWindow(z,r,!1,void 0,vM.a.vPi))}catch(h){}}static d8m(b){v.ULS.sendTraceTag(38355487,323,50,"previewPanel: init");(t.AFrameworkApplication.K.$("DynamicBundlesIsEnabled")?appResourceLoader.loadChunk("previewPanel"):Sa.a.instance.resolve("Common.IDynamicScriptLoaderProvider").JE.loadScript("previewPanel")).catch(()=>
{v.ULS.sendTraceTag(38130907,323,10,"previewPanel: Failed to download script");nq.Ysi(b)}).then(()=>{Aq.getInstance(b).a2n()})}static uQc(b,h,r){if(1===r)return 32;nq.ND.BYi(1);vb.App.xa.updateCommandUI();return 32}static wQc(b,h,r){if(1===r)return 32;nq.ND.BYi(0);vb.App.xa.updateCommandUI();return 32}static uWc(b,h,r,z,R){if(1===r)return 32;R[Yf.a.On]=1===nq.ND.Lw;return 32}static IWc(b,h,r,z,R){if(1===r)return 32;R[Yf.a.On]=!nq.ND.Lw;return 32}}nq.ND=null;Object(n.a)(nq,"MainViewModeActor",null,
[]);class OJ{constructor(b,h,r){this.tEm=(z,R,ba,ta,Wa)=>1===ba?32:(z=this.Kk.u$(R.vk))?(Wa=3===Wa.Ww,this.s4.value.kuh(this.pFl(z),this.fBb(z),Wa),32):2;this.ga=b;this.s4=h;this.Kk=r}Vb(){this.ga.pa(Oa.a.Tvf,kc.a.view,this.tEm);this.ga.gb(Oa.a.s1d,kc.a.view,Eh.a.PQ,96);this.ga.gb(Oa.a.p1d,kc.a.view,Eh.a.PQ,96);this.ga.gb(Oa.a.q1d,kc.a.view,Eh.a.PQ,96);this.ga.gb(Oa.a.r1d,kc.a.view,Eh.a.PQ,96);this.ga.pa(Oa.a.cUc,kc.a.view,Eh.a.BF);this.ga.pa(Oa.a.bUc,kc.a.view,Eh.a.BF);this.ga.pa(Oa.a.cZd,kc.a.view,
Eh.a.BF);this.ga.pa(Oa.a.dZd,kc.a.view,Eh.a.BF)}pFl(b){const h=new Ei.DictionaryPropertySet;h.setValue(yc.a.marginTop,this.Kk.rla(b));h.setValue(yc.a.marginBottom,this.Kk.$sa(b));h.setValue(yc.a.marginLeft,this.Kk.BL(b));h.setValue(yc.a.marginRight,this.Kk.CL(b));return h}fBb(b){const h=new Ei.DictionaryPropertySet;h.setValue(yc.a.Lo,this.Kk.Jv(b));h.setValue(yc.a.ay,this.Kk.uA(b));return h}}Object(n.a)(OJ,"MarginsDialogActor",null,[]);class cG{constructor(b){this.w2c=(h,r,z)=>{if(1===z)return 32;
h=t.AFrameworkApplication.ua;if(!h)return 32;h.tzc();cG.IBn(h);return 32};this.ga=b}Vb(){this.ga.pa(Oa.a.w2c,kc.a.view,this.w2c)}static IBn(b){const h=t.AFrameworkApplication.K.lb("ModernUxExperimentPreferenceCookieName");var r=t.AFrameworkApplication.K.$("ModernUxExperimentDefaultOffIsEnabled");r=Ga.a.dla(h,!r);Ga.a.DPa(h,(!r).toString(),Ga.a.zNa);r?v.ULS.sendTraceTag(576075457,340,50,"User is opting out of the modern ux experience"):v.ULS.sendTraceTag(576075458,340,50,"User is opting in to the modern ux experience");
Lb.d(Oa.a.w2c,!0,void 0,void 0,void 0,void 0,[Object.assign(new ca.a,{name:"ModernUxExperimentPreference",string:(!r).toString()})]);b.refreshDocument(null)}}Object(n.a)(cG,"ModernUxActor",null,[]);var xM=d(1029),Gr=d(1648);class PJ{constructor(b,h){this.r9d=pg.a.BA(1)/6;this.WE=b;this.Hd=h}get Sg(){return km.a.instance}Kyl(b){var h=vb.App.Xrf,r=h?1:3,z=t.AFrameworkApplication.numberFormat;let R=Gr.a.i_[b].mrb;var ba=Gr.a.i_[b].krb;var ta=Gr.a.i_[b]._marginLeft;b=Gr.a.i_[b].lrb;R=h?pg.a.PLb(R):pg.a.kC(R);
ba=h?pg.a.PLb(ba):pg.a.kC(ba);ta=h?pg.a.PLb(ta):pg.a.kC(ta);b=h?pg.a.PLb(b):pg.a.kC(b);h=B.a.NAa(R,r,z);ba=B.a.NAa(ba,r,z);ta=B.a.NAa(ta,r,z);r=B.a.NAa(b,r,z);z={};z.top=h;z.bottom=ba;z.left=ta;z.right=r;return z}rEm(b){const h=WordRibbonStrings.PageMarginsTop,r=WordRibbonStrings.PageMarginsBottom,z=WordRibbonStrings.PageMarginsLeft,R=WordRibbonStrings.PageMarginsRight;b=this.Kyl(b);return[[h,b.top,r,b.bottom],[z,b.left,R,b.right]]}vUc(b){var h=vb.App.Xrf,r=h?1:3;const z=t.AFrameworkApplication.numberFormat;
let R=Gr.a.rna[b].qqa;b=Gr.a.rna[b].gIa;R=h?pg.a.PLb(R):pg.a.kC(R);b=h?pg.a.PLb(b):pg.a.kC(b);h=B.a.NAa(b,r,z);r=B.a.NAa(R,r,z);return String.format(WoncaIntl.WoncaStrings.L_PageSizeDescription,h,r)}Vb(){const b=t.AFrameworkApplication.ya;b.gb(Fb.a.M2a,kc.a.view,Object(u.a)(this,this.vNn,"setPredefinedMarginsView"),4);b.gb(Fb.a.xPa,kc.a.view,Object(u.a)(this,this.wNn,"setPredefinedPageSizeView"),4);b.gb(Fb.a.setOrientation,kc.a.view,Object(u.a)(this,this.OMn,"setOrientationView"),4);b.gb(Fb.a.EDa,
kc.a.view,Object(u.a)(this,this.EDa,"querySectionProperties"),96);b.pa(Fb.a.L2a,kc.a.view,Object(u.a)(this,this.d7d,"setMarginView"));b.pa(Fb.a.J2a,kc.a.view,Object(u.a)(this,this.d7d,"setMarginView"));b.pa(Fb.a.Lga,kc.a.view,Object(u.a)(this,this.d7d,"setMarginView"));b.pa(Fb.a.K2a,kc.a.view,Object(u.a)(this,this.d7d,"setMarginView"));b.pa(Fb.a.MYf,kc.a.view,Object(u.a)(this,this.t_i,"setPaperSizeView"));b.pa(Fb.a.LYf,kc.a.view,Object(u.a)(this,this.t_i,"setPaperSizeView"));b.pa(Fb.a.fkb,kc.a.view,
Object(u.a)(this,this.fkb,"setColumnsCount"));b.pa(Fb.a.r6d,kc.a.view,Object(u.a)(this,this.r6d,"setColumnsWidths"));b.pa(Fb.a.q6d,kc.a.view,Object(u.a)(this,this.q6d,"setColumnsSpaces"))}vNn(b,h,r,z,R){if(1===r)return 32;if(r=this.Sg.u$(h.vk)){if(0<=R&&R<Gr.a.i_.length){h=new yf.GraphTransaction(15);h.Db(r);h.Al=b;b=Gr.a.i_[R].mrb;z=Gr.a.i_[R].krb;const ba=Gr.a.i_[R]._marginLeft;R=Gr.a.i_[R].lrb;this.JZd(b,z,this.Sg.uA(r))&&this.JZd(ba,R,this.Sg.Jv(r))?(this.WE.L2a(r,b),this.WE.J2a(r,z),this.WE.Lga(r,
ba),this.WE.K2a(r,R),this.Hd.zs(11)):this.Eva(WoncaIntl.WoncaStrings.l_MarginSetFailedMessage);h.dispose()}else return 2;return 32}v.ULS.sendTraceTag(520618525,3009,50,"wordSectionNode is null; context.nextContext = {0}",h.vk);return 2}JZd(b,h,r){return r>=b+h+vb.App.wwa}wNn(b,h,r,z,R){if(1===r)return 32;if(r=this.Sg.u$(h.vk)){if(0<=R&&R<Gr.a.rna.length)h=new yf.GraphTransaction(15),h.Db(r),h.Al=b,b=(z=this.Sg.iPd(r))?Gr.a.rna[R].qqa:Gr.a.rna[R].gIa,R=z?Gr.a.rna[R].gIa:Gr.a.rna[R].qqa,this.JZd(this.Sg.$sa(r),
this.Sg.rla(r),R)&&this.JZd(this.Sg.BL(r),this.Sg.CL(r),b)?(this.WE.KYf(r,b),this.WE.JYf(r,R),this.Hd.zs(11)):this.Eva(WoncaIntl.WoncaStrings.l_PaperSizeSetFailedMessage),h.dispose();else return 2;return 32}v.ULS.sendTraceTag(520618524,3009,50,"wordSectionNode is null; context.nextContext = {0}",h.vk);return 2}OMn(b,h,r,z,R){if(1===r)return 32;if(r=this.Sg.u$(h.vk)){h=this.Sg.iPd(r);z=new yf.GraphTransaction(15);z.Db(r);z.Al=b;this.WE.KZi(r,R);if(R&&!h||!R&&h){b=this.Sg.Jv(r);R=this.Sg.uA(r);this.WE.KYf(r,
R);this.WE.JYf(r,b);b=this.Sg.rla(r);R=this.Sg.$sa(r);const ba=this.Sg.BL(r),ta=this.Sg.CL(r);h?(this.WE.L2a(r,t.AFrameworkApplication.isRtl?ba:ta),this.WE.J2a(r,t.AFrameworkApplication.isRtl?ta:ba),this.WE.Lga(r,t.AFrameworkApplication.isRtl?R:b),this.WE.K2a(r,t.AFrameworkApplication.isRtl?b:R)):(this.WE.L2a(r,t.AFrameworkApplication.isRtl?ta:ba),this.WE.J2a(r,t.AFrameworkApplication.isRtl?ba:ta),this.WE.Lga(r,t.AFrameworkApplication.isRtl?Math.abs(b):R),this.WE.K2a(r,t.AFrameworkApplication.isRtl?
R:b));this.Hd.zs(11)}z.dispose();return 32}v.ULS.sendTraceTag(520618523,3009,50,"wordSectionNode is null; context.nextContext = {0}",h.vk);return 2}fkb(b,h,r,z,R){if(1===r)return 32;r=this.Sg.u$(h.vk);if(!r)return v.ULS.sendTraceTag(520618522,3009,50,"wordSectionNode is null; context.nextContext = {0}",h.vk),2;h=new yf.GraphTransaction(15);h.Db(r);h.Al=b;if(0>R||13<R)return 2;this.WE.zJb(r,R);h.dispose();return 32}r6d(b,h,r,z,R){if(1===r)return 32;r=this.Sg.u$(h.vk);if(!r)return v.ULS.sendTraceTag(520618521,
3009,50,"wordSectionNode is null; context.nextContext = {0}",h.vk),2;h=new yf.GraphTransaction(15);h.Db(r);h.Al=b;b=R[0];if(720>b||9360<b)return 2;this.WE.Qdc(r,R);h.dispose();return 32}q6d(b,h,r,z,R){if(1===r)return 32;r=this.Sg.u$(h.vk);if(!r)return v.ULS.sendTraceTag(520618520,3009,50,"wordSectionNode is null; context.nextContext = {0}",h.vk),2;h=new yf.GraphTransaction(15);h.Db(r);h.Al=b;if(0>R||7920<R)return 2;this.WE.iIn(r,R);h.dispose();return 32}EDa(b,h,r,z,R){if(b=this.Sg.u$(h.vk))return R.marginTop=
this.Sg.rla(b),R.marginBottom=this.Sg.$sa(b),R.marginLeft=this.Sg.BL(b),R.marginRight=this.Sg.CL(b),R.Lo=this.Sg.Jv(b),R.ay=this.Sg.uA(b),R.Mta=this.Sg.iPd(b),R.KC=this.Sg.kh(b),R.iW=this.Sg.Qzb(b),R.lFb=this.Jyl(R),R.LGb=this.zCl(R),32;v.ULS.sendTraceTag(520618519,3009,50,"wordSectionNode is null; context.nextContext = {0}",h.vk);return 2}Jyl(b){let h=5;for(let r=0;r<Gr.a.i_.length;r++)if(Gr.a.i_[r].mrb===b.marginTop&&Gr.a.i_[r].krb===b.marginBottom&&Gr.a.i_[r]._marginLeft===b.marginLeft&&Gr.a.i_[r].lrb===
b.marginRight){h=r;break}return h}zCl(b){let h=5;b=new xM.a(Math.min(b.Lo,b.ay),Math.max(b.Lo,b.ay));for(let r=0;r<Gr.a.rna.length;r++)if(this.$0m(b,Gr.a.rna[r])){h=r;break}return h}$0m(b,h){return ac.a.uai(b.gIa,Math.max(h.gIa-this.r9d,0),h.gIa+this.r9d)&&ac.a.uai(b.qqa,Math.max(h.qqa-this.r9d,0),h.qqa+this.r9d)}d7d(b,h,r,z,R){if(1===r)return 32;if(r=this.Sg.u$(h.vk)){h=new yf.GraphTransaction(15);h.Db(r);switch(b){case Fb.a.L2a:this.WE.L2a(r,R);break;case Fb.a.J2a:this.WE.J2a(r,R);break;case Fb.a.Lga:this.WE.Lga(r,
R);break;case Fb.a.K2a:this.WE.K2a(r,R)}this.Hd.zs(11);h.dispose();return 32}v.ULS.sendTraceTag(520618518,3009,50,"wordSectionNode is null; context.nextContext = {0}",h.vk);return 2}t_i(b,h,r,z,R){if(1===r)return 32;if(r=this.Sg.u$(h.vk)){h=new yf.GraphTransaction(15);h.Db(r);let ba=z=0;switch(b){case Fb.a.MYf:ba=R;this.WE.KYf(r,ba);z=this.Sg.uA(r);break;case Fb.a.LYf:z=R,this.WE.JYf(r,z),ba=this.Sg.Jv(r)}this.WE.KZi(r,z<ba);this.Hd.zs(11);h.dispose();return 32}v.ULS.sendTraceTag(520618517,3009,50,
"wordSectionNode is null; context.nextContext = {0}",h.vk);return 2}Eva(b){if(!mg.a.qL){const h=new te.StandardDialog;h.Fd=0;h.vU(CommonUIStrings.l_DefaultDialogTitle,b,null)}}}Object(n.a)(PJ,"PageActor",null,[485]);class QJ{constructor(b){this.ga=b}get zc(){return this.ga}c7d(b,h){let r=0;b?1===b?r=Fb.a.Lga:2===b?r=Fb.a.K2a:3===b&&(r=Fb.a.J2a):r=Fb.a.L2a;this.zc.Xb(r,2,h)}xPa(b,h){let r=0;1===b?r=Fb.a.LYf:b||(r=Fb.a.MYf);this.zc.Xb(r,2,h)}FXf(b,h){let r=0;switch(b){case 0:r=Fb.a.fkb;break;case 1:r=
Fb.a.r6d;break;case 2:r=Fb.a.q6d}this.zc.Xb(r,2,h)}}Object(n.a)(QJ,"PageCommands",null,[486]);class RJ{constructor(b,h,r){this.Z0m=(z,R,ba,ta,Wa)=>1===ba?32:(z=this.Kk.u$(R.vk))?(Wa=3===Wa.Ww,this.s4.value.Puh(this.qFl(z),this.fBb(z),Wa),32):2;this.ga=b;this.s4=h;this.Kk=r}Vb(){this.ga.pa(Oa.a.Vvf,kc.a.view,this.Z0m);this.ga.gb(Oa.a.H1d,kc.a.view,Eh.a.PQ,96);this.ga.gb(Oa.a.G1d,kc.a.view,Eh.a.PQ,96);this.ga.pa(Oa.a.gZd,kc.a.view,Eh.a.BF);this.ga.pa(Oa.a.fZd,kc.a.view,Eh.a.BF)}qFl(b){const h=new Ei.DictionaryPropertySet;
h.setValue(yc.a.Lo,this.Kk.Jv(b));h.setValue(yc.a.ay,this.Kk.uA(b));return h}fBb(b){const h=new Ei.DictionaryPropertySet;h.setValue(yc.a.marginTop,Math.abs(this.Kk.rla(b)));h.setValue(yc.a.marginBottom,Math.abs(this.Kk.$sa(b)));h.setValue(yc.a.marginLeft,this.Kk.BL(b));h.setValue(yc.a.marginRight,this.Kk.CL(b));return h}}Object(n.a)(RJ,"PaperSizeDialogActor",null,[]);class NC{constructor(b,h,r,z,R=Sa.a.instance.Za("Box4.Settings.SpacingSettings")){this.ga=b;this.s4=h;this.S0=r;this.qx=z;this.sO=null;
R.execute(ba=>this.sO=ba)}Vb(){this.ga.gb(Fb.a.D8b,kc.a.view,Object(u.a)(this,this.M1m,"paragraphDialogViewHandler"),1028);this.ga.pa(Fb.a.D8b,kc.a.paragraph,Object(u.a)(this,this.L1m,"paragraphDialogHandler"));this.ga.gb(Fb.a.S1d,kc.a.view,Eh.a.PQ,96);this.ga.gb(Fb.a.Gbc,kc.a.view,Eh.a.PQ,96);this.ga.gb(Fb.a.o1d,kc.a.view,Eh.a.PQ,96);this.ga.gb(Fb.a.rWc,kc.a.view,Eh.a.PQ,96);this.ga.gb(Fb.a.k3a,kc.a.view,Eh.a.BF,96);this.ga.gb(Fb.a.Z0c,kc.a.view,Eh.a.BF,96);this.ga.gb(Fb.a.hZd,kc.a.view,Eh.a.BF,
96);this.ga.gb(Fb.a.iac,kc.a.view,Eh.a.BF,96);this.ga.gb(Fb.a.bZd,kc.a.view,Eh.a.BF,96);this.ga.gb(Fb.a.I9d,kc.a.view,Eh.a.BF,96);this.ga.gb(Fb.a.c1a,kc.a.view,Eh.a.BF,96)}L1m(b,h,r,z,R){if(1===r)return 3===this.ga.mode||2===this.ga.mode?32:8;b=h.node;h=this.Mdj(h);R=3===R.Ww;this.s4.value.k_b(this.sJc(b),this.fBb(h),R,this.qx);return 32}M1m(b,h,r,z,R){b=h.view.Cb;if(!b||NC.Zf.g6b(b.Rg))return 8;if(NC.Tg.swa(ie.ParagraphReader.UW,b.Rg))return NC.Mc.Zb(Sc.a.zf,{["Reason"]:Xc.a.uN}),8;if(1===r)return 3===
this.ga.mode||2===this.ga.mode?32:8;r=b.hb.kb;h=this.Mdj(h);R=3===R.Ww;if(1===r.length&&Xd.SelectionEditor.xf(r.J(0)))return r=r.J(0).node,this.s4.value.k_b(this.sJc(r),this.fBb(h),R,this.qx),32;b=[];for(z=0;z<r.length;z++){const ba=r.J(z);(!z&&Xd.SelectionEditor.uk(ba)||ie.ParagraphReader.gm(ba)||Xd.SelectionEditor.Ek(ba))&&b.push(ba.node)}if(!b.length)return 8;r=Array(b.length);for(z=0;z<b.length;z++)r[z]=this.sJc(b[z]);r=tA.APropertySet.VSh(r);this.s4.value.k_b(r,this.fBb(h),R,this.qx);return 32}sJc(b){var h,
r,z,R;const ba=new Ei.DictionaryPropertySet;ba.setValue(od.a.Zs,ie.ParagraphReader.Hv(b));const ta=this.S0.fBa(b);var Wa=ta.lineSpacing;ba.setValue(od.a.QZ,Wa.unit);ba.setValue(od.a.ta,Wa.value);Wa=ta.beforeSpacing;ba.setValue(od.a.rDa,Wa.unit);ba.setValue(od.a.sDa,Wa.value);Wa=ta.afterSpacing;ba.setValue(od.a.pDa,Wa.unit);ba.setValue(od.a.qDa,Wa.value);(null===(h=this.sO)||void 0===h?0:h.Qta)&&ba.setValue(od.a.EUc,ta.Ut);(null===(r=this.qx)||void 0===r?0:r.DCa)&&ba.setValue(Li.a.Yh,ie.ParagraphReader.Yh(b));
(null===(z=this.qx)||void 0===z?0:z.DFa)&&ba.setValue(Li.a.BM,ie.ParagraphReader.cic(b));(null===(R=this.qx)||void 0===R?0:R.ofa)&&ba.setValue(Li.a.keepTogether,ie.ParagraphReader.keepTogether(b));return ba}static get Zf(){return Yh.a.instance}static get Tg(){return sm.ContextSetEditor.instance}static get Mc(){return wc.a.instance}}Object(n.a)(NC,"AParagraphDialogActor",null,[]);class SJ extends NC{constructor(b,h,r,z,R,ba){super(b,h,r,ba);this.Kk=z;this.gp=R;this.l3h=(ta,Wa,ub,Ib,$b)=>{const fc=
Wa.view.Cb,Kc=fc.hb.kb.Qa;return 1===ub&&fc.hb.kb.eE&&ie.ParagraphReader.iK(Kc.node)&&!mc.ListReader.rr?8:Eh.a.BF(ta,Wa,ub,Ib,$b)}}Vb(){super.Vb();this.ga.gb(Fb.a.RHb,kc.a.view,Eh.a.PQ,96);this.ga.gb(Fb.a.fWc,kc.a.view,Eh.a.PQ,96);this.ga.gb(Fb.a.Ebc,kc.a.view,Eh.a.PQ,96);this.ga.gb(Fb.a.k5b,kc.a.view,Eh.a.BF,96);this.ga.gb(Fb.a.eMd,kc.a.view,Eh.a.BF,96);this.ga.gb(Fb.a.lfc,kc.a.view,Eh.a.BF,96);this.ga.gb(Fb.a.H9d,kc.a.view,Eh.a.BF,96);this.ga.gb(Fb.a.$ma,kc.a.view,Eh.a.BF,96);this.ga.gb(Fb.a.d1a,
kc.a.view,this.l3h,96);this.ga.gb(Fb.a.iZd,kc.a.view,this.l3h,96);this.ga.gb(Fb.a.L9d,kc.a.view,Eh.a.BF,96);this.ga.gb(Fb.a.T1d,kc.a.view,Eh.a.PQ,96);this.ga.gb(Fb.a.Hbc,kc.a.view,Eh.a.PQ,96)}Mdj(b){return this.Kk.u$(b.vk)}sJc(b){const h=super.sJc(b);var r=this.gp.mT(b);const z=this.gp.wF(b);h.setValue(od.a.Gaa,1);h.setValue(od.a.Haa,r.kt-z.kt);r=this.gp.NYa(b);h.setValue(od.a.Rua,r.unit);h.setValue(od.a.Sua,r.value);b=this.gp.J3b(b);b.specialIndentType&&(h.setValue(od.a.ZI,b.specialIndentType),h.setValue(od.a.jba,
b.unit),h.setValue(od.a.v_,b.value));return h}fBb(b){const h=new Ei.DictionaryPropertySet;h.setValue(yc.a.Lo,this.Kk.Jv(b));h.setValue(yc.a.ay,this.Kk.uA(b));h.setValue(yc.a.marginTop,Math.abs(this.Kk.rla(b)));h.setValue(yc.a.marginBottom,Math.abs(this.Kk.$sa(b)));h.setValue(yc.a.marginLeft,this.Kk.BL(b));h.setValue(yc.a.marginRight,this.Kk.CL(b));return h}}Object(n.a)(SJ,"ParagraphDialogActor",NC,[]);class TJ extends Sys.EventArgs{constructor(b,h){super();this.node=b;this.kPd=h}}Object(n.a)(TJ,"AfterPasteEventArgs",
Sys.EventArgs,[]);class UJ{constructor(b){this.Mte=this.Ste=null;this.V$c=b}get kDd(){return null!=this.Ujg?this.Ujg:this.Ujg=Sa.a.instance.resolve("WordEditor.ExternalContent.FluidComponentEditor")}get pbm(){this.Ste||(this.Ste=!!t.AFrameworkApplication.K&&t.AFrameworkApplication.K.getBooleanFeatureGate(Kq.a.Lyh,!1));return this.Ste}get dOd(){this.Mte||(this.Mte=!!t.AFrameworkApplication.K&&t.AFrameworkApplication.K.$(Kq.a.Syh));return this.Mte}t$m(b){if(b&&vg.OutlineElementReader.Nh(b.Jsa)&&vg.OutlineElementReader.Nh(b.Rgb)){this.O$m(b);
var h=new eg.a;for(h.fd(b.Jsa);h&&h.currentNode;){const r=this.sHd(h),z=ie.ParagraphReader.nc(r);z&&ie.ParagraphReader.gbb(r)&&this.r$m(r);const R=h.currentNode.id===b.Rgb.currentNode.id;z&&(this.pbm||this.dOd)&&r.Qi.xea(r.type).n2d(new TJ(r,R));if(R)break;ag.OutlineElementNavigator.Vr(h,!1,!1)}}}r$m(b){v.ULS.sendTraceTag(590435214,307,50,"ProcessParagraphForExternalContent: Processing the pasted the external content (oEmbed) component via external paste flow.");const h=b.Nac;b=Qe.a.Uc(b,0);Wr.QNc(h)?
this.kDd.r_d(b,h):this.V$c.r_d(b,h)}O$m(b){if(b.Jsa.currentNode&&b.Rgb.currentNode&&b.Jsa.currentNode.id===b.Rgb.currentNode.id){const h=this.sHd(b.Jsa);ie.ParagraphReader.nc(h)?this.w$m(h,b.y3m,b.x3m):v.ULS.sendTraceTag(590955995,307,50,"ProcessSinglePastedHyperlink: No paragraph node pasted.")}}w$m(b,h,r){v.ULS.shipAssertTag(590956771,307,0<=h);v.ULS.shipAssertTag(590958592,307,0<=r);var z=ie.ParagraphReader.text(b);if(""!==z){var R=Qe.a.createTextRange(b,h,r);R=Pg.HyperlinkReader.ZC(R,!1);if(1===
R.length){const ba=R[0];R=z.substring(h,r).trim();z=z.substring(ba.cpBegin,ba.cpEnd).trim();h=R===z;R=Qe.a.createTextRange(b,ba.cpBegin,ba.cpEnd);if(ba.hyperlink&&h&&!Pg.HyperlinkReader.QMa(z))b=ba.hyperlink.url;else if(h)b=z;else{v.ULS.sendTraceTag(590958596,307,50,"ProcessPastedHyperlinks: No hyperlink conversion to oEmbed because the pasted text is not equal to the pasted hyperlink display text");return}Wr.QNc(b)?this.kDd.dMa(R,b,!1):this.V$c.dMa(R,b,!1)}else v.ULS.sendTraceTag(590958597,307,50,
"ProcessPastedHyperlinks: No hyperlink conversion to oEmbed because either no hyperlinks or more than one hyperlink got pasted  Hyperlinks pasted = {0}",R.length)}}sHd(b){const h=ag.OutlineElementNavigator.De(b);ag.OutlineElementNavigator.Zd(b);return h}}Object(n.a)(UJ,"PastedContentsProcessorPostMergeAfterPaste",null,[483]);class dG extends Xm{constructor(b,h,r,z,R,ba,ta,Wa){super(z);this.ZFe=7;this.mB=this.cnc=null;this.vse=0;this.rse=b;this.Ok=h;this.Xm=r;this.le=R;this.Ouj=ta;this.NTa=Wa;this.a1=
this.le.vNa("UserAction","WordIgnoreAll")}NZf(b){this.rse.zni();this.cnc=this.Xm.jla(b);this.NTa.C6h(this.cnc,null,!1);return this.rse.nej(this.cnc)?(this.a1.start(),this.mB=new yf.GraphTransaction(15),this.mB.Db(b.node),!0):!1}E0d(b){this.yHb(b.node);return!0}CVc(b){this.yHb(b);return!0}F0d(b){this.yHb(b.node)}A4f(b){this.mB.dispose();this.cnc.errorDetails.Qlb(b.actionId);this.a1.stop();v.ULS.sendTraceTag(19779652,324,50,String.format("Ignore-all succeeded. Actual ignored errors: {0}. Duration in milliseconds: {1}. Type: {2}",
this.vse,this.a1.oi,this.cnc.errorDetails.proofingType));return!0}jfc(b,h){if(super.jfc(b,h))return!0;b=b.role;return 9===b||10===b||13===b||7===b||8===b}qXh(b){if(b&&b.type!==this.ZFe){const h=Nd.GraphIterator.$a(b);return h.Bb(this.ZFe)?h.kd(this.ZFe):b}return b}uem(b,h){return this.rse.c8d(h.errorDetails)&&!this.Ok.T$(Qe.a.createTextRange(b,h.begin,h.end))}yHb(b){if(b){var h=this.Xm.f2(b,r=>this.uem(b,r));this.Ouj?this.Xm.Ajb(b,h,!0):0<h.length&&(b.gk(4,!0),this.Xm.RFb(b));this.vse+=h.length}}}
Object(n.a)(dG,"IgnoreAllCallbackSteps",Xm,[]);class VJ{constructor(b,h,r,z,R,ba,ta,Wa,ub,Ib,$b,fc,Kc){this.pWc=(ed,Jd,ge,qe,Ve)=>{if(1===ge)return 32;ed=this.LH.xYa(Jd.view.Cb.Rg);if(ed=Sj.a.pg(ed))Ve[Ik.a.LabelText]=ed.displayName;return 32};this.Kla=(ed,Jd,ge,qe,Ve,Bd)=>{const he=new dG(this.WGj,this.Ok,this.Xm,this.Fe,this.le,this.tV,0,this.NTa);return new Hs(ed,Jd,ge,qe,Ve,Bd,he,this.ga,this.ib,this.Fe,"IgnoreAllOperation")};this.oyb=(ed,Jd,ge,qe,Ve,Bd)=>{const he=new dG(this.NBj,this.Ok,this.Xm,
this.Fe,this.le,this.tV,1,this.NTa);return new Hs(ed,Jd,ge,qe,Ve,Bd,he,this.ga,this.ib,this.Fe,"DoNotCheckThisCritiqueType")};this.ga=b;this.Ok=h;this.ib=r;this.Fe=z;this.Xm=R;this.LH=ba;this.le=ta;this.WGj=Wa;this.NBj=ub;this.ARb=Ib.SOc;this.tV=Ib;this.NTa=$b;this.uue=fc;this.u5a=Kc}Vb(){this.uue&&(W.GA()?this.ga.gb(Fb.a.Kla,kc.a.Wc,this.p_l.bind(this),1028):this.ga.pS(Fb.a.Kla,kc.a.view,this.Kla,1028));this.ARb&&this.ga.pS(Fb.a.oyb,kc.a.view,this.oyb,1028);this.ga.gb(Oa.a.pWc,kc.a.view,this.pWc,
96)}p_l(b,h,r,z,R){if(1===r)return 32;v.ULS.sendTraceTag(528023773,324,50,"Ignore All error triggered for AL");this.u5a.Zjf(R?R:h,null,La.b.IgnoreAll);return 32}}Object(n.a)(VJ,"ProofingActor",null,[]);var jA=d(1170),yM=d(1650);class kA{constructor(b,h,r,z,R,ba,ta,Wa,ub){this.Sp=this.BIa=this.Nmd=this.Omd=null;this.zD=this.Zq=this.Bp=0;this.d7a=this.c7a=!1;this.d9=this.POb=this.OOb=this.NOb=this.QOb=0;this.Lld=null;this.Rba=this.vV=this.pq=this.WO=0;this.em=null;this.bqb=0;this.ij=r;this._image=b;
this._context=h;this.ped=!1;(b=kA.qh.ju(h.node))&&b.Og(yc.a.Ktf)&&(this.ped=!0);this.Yoc=z.$("ImageDataURLPresentationIsEnabled");this.NQj=z.$("WordOartPostRequestIsEnabled");this.Oa=z;this.Nq=R;this.le=ba;this.Hd=ta;this.wm=Wa;this.lJ=ub;this.v3l()}v3l(){this.Sp="";this.Bp=$d.ImageReader.tA(this._image);this.Zq=$d.ImageReader.JB(this._image);this.d9=$d.ImageReader.ceb(this._image);this.zD=$d.ImageReader.vZ(this._image);this.c7a=$d.ImageReader.dGd(this._image);this.d7a=$d.ImageReader.mAb(this._image);
this.QOb=Math.max($d.ImageReader.pla(this._image),0);this.NOb=Math.max($d.ImageReader.lla(this._image),0);this.OOb=Math.max($d.ImageReader.nla(this._image),0);this.POb=Math.max($d.ImageReader.ola(this._image),0);this.em=pa.a.nil;this.BIa=null;this.bqb=$d.ImageReader.ul(this._image)}ntd(b,h){return(new yM.a(this.Nq,this.bqb,this.Oa,this.Bp,this.Zq,this.zD,this.d9,this.QOb,this.NOb,this.OOb,this.POb,this.c7a,this.d7a,this.ped)).build(this._context.node,this._image,b,h)}resize(b,h){this.Sp="Resize";
this.X9d();mf.a.mark(this.q3b());this.Bp=b;this.Zq=h;this.sendMessage(!1,Object(u.a)(this,this.b1a,"onRequestSuccess"))}Tv(b){this.Sp="Styles";this.X9d();mf.a.mark(this.q3b());this.d9=b;this.sendMessage(!1,Object(u.a)(this,this.b1a,"onRequestSuccess"))}oNn(b,h,r){this.Sp="Rotation";this.X9d();this.zD=b;this.c7a=h;this.d7a=r;this.sendMessage(!1,Object(u.a)(this,this.b1a,"onRequestSuccess"))}nNn(b,h){this.Sp="SwordRequestManager";this.X9d();this.BIa=b;this.zD=h.angle;this.Bp=h.width;this.Zq=h.height;
this.d9=h.styleId;this.QOb=h.top;this.NOb=h.bottom;this.OOb=h.left;this.POb=h.right;this.em=h.R1;this.sendMessage(!1,Object(u.a)(this,this.b1a,"onRequestSuccess"))}sendMessage(b,h){if(this.Oa.$("WordOartForceOutboundAfterImageSuccessIsEnabled")){var r=this.ubb(r);const z=$d.ImageReader.wla(this._image,this.Oa,this.Nq);z?jA.a.skb(this._image,z,4):this._image.setValue(ui.a.JDd,!0);r.dispose()}this.W7i(b);mf.a.mark(this.q3b());b=new Ma.QueryStringBuilder(this.ntd(b,!0));this.Yoc&&b.Ie(rg.a.Swh,"true");
this.NQj?(r=new Ma.QueryStringBuilder("WordOart.ashx"),t.AFrameworkApplication.Xe.Lj(r.toString(),2,b.toString(),{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"},!0,0,h,Object(u.a)(this,this.fIf,"onRequestFail"),null)):t.AFrameworkApplication.Xe.Lj(b.toString(),1,"",null,!0,0,h,Object(u.a)(this,this.fIf,"onRequestFail"),null)}ubb(b){b=this.em&&this.em!==pa.a.nil?new yf.GraphTransaction(7,Fb.a.imageRotate):new yf.GraphTransaction(15);b.Db(this._context.node);return b}get rpj(){const b=
new yf.GraphTransaction(3);b.Db(this._context.node);return b}N4d(){this.fFc();this.JAd();const b=this.rpj;var h=$d.ImageReader.QAa(this._image,this._context.node.Lc,this.Oa,this.Nq);this._image.setValue(ui.a.JDd,!1);this._image.setValue(od.a.OLc,h);this._image.setValue(od.a.dK,-1);this._image.setValue(ui.a.l3,1);h=$d.ImageReader.wla(this._image,this.Oa,this.Nq);this.Oa.$("WordOartForceOutboundAfterImageSuccessIsEnabled")&&(this._image.removeProperty(od.a.M_d),this._image.removeProperty(od.a.L_d),
h&&jA.a.skb(this._image,h,3));b.dispose();kA.xp();this.BIa&&this.BIa()}fIf(b){if(5===this.bqb){const h=Object.assign(new eb.a,{extendedProperties:new Map});h.extendedProperties.set("status",b.data.status.toString());h.extendedProperties.set("httpStatus",b.data.wf.toString());Ca.Health.instance.recordQosError("PictureSwordRequestFailed",["ImageEditFailed"],!1,!0,!1,!1,h)}v.ULS.sendTraceTag(25182720,322,15,"Request failed: {0}. PlaceholderKind: {1}",{["Status"]:b.data.status,["HttpStatus"]:b.data.wf,
["Id"]:b.data.id,["ResponseData"]:b.data.Ge},MC.a[this.bqb]);this.N4d()}W7i(b){this.le&&(b=String.format("Send Single {0} SWORD Request.",b?"PNG":"XML"),this.Omd=this.le.hg("WebServiceCall",b))}fFc(){this.Omd&&(this.Omd.stop(),this.Omd=null)}X9d(){if(this.le){const b=String.format("Send SWORD {0} Request. PlaceholderKind: {1}",this.Sp,MC.a[this.bqb]);this.Nmd=this.le.hg("WebServiceCall",b)}}JAd(){this.Nmd&&(this.Nmd.stop(),this.Nmd=null)}static get qh(){return ml.PageNavigator.instance}static xp(){const b=
new te.StandardDialog;b.Fd=0;b.jy(fj.a.L4m,Box4Intl.Box4Strings.l_PictureStyleErrorTitle,Box4Intl.Box4Strings.l_PictureStyleError,null);vb.App.xa&&vb.App.xa.updateCommandUI()}}Object(n.a)(kA,"RenderedImageEditOperation",null,[517]);var eG=d(318),YE=d(531);class WJ extends kA{constructor(b,h,r,z,R,ba,ta,Wa,ub){super(b,h,r,z,R,ba,ta,Wa,ub)}sendMessage(b,h){Object(eG.a)(()=>{let r;r=this.ubb(r);this._image.setValue(ui.a.l3,0);r.dispose()});this.W7i(b);mf.a.mark(this.q3b());b=new Ma.QueryStringBuilder("WordOart.ashx");
this.AIg=this.leb(!0,!1);b=new YE.a(b.toString(),2,this.leb(!1,!1),{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"},!1,2,null,null,null,null,null,null,null,null,null,null,null,null,["Content-Type"],null,"text");t.AFrameworkApplication.Xe.send(b).LDa(h,r=>{this.fIf(r)})}b1a(b){try{const h=JSON.parse(b.data.aPa);this.VFj=h[rg.a.pKc];this.i_j=h[rg.a.width];this.kGj=h[rg.a.height];this.Eug=h[rg.a.Eyc];this.Omc=Array(4);this.Omc[0]=h[rg.a.ecb];this.Omc[1]=h[rg.a.fcb];this.Omc[2]=h[rg.a.gcb];
this.Omc[3]=h[rg.a.dcb];this.TMg=void 0!==h[rg.a.T7b]?"true"===h[rg.a.T7b].toLowerCase():null;Object(eG.a)(()=>{this.M3c();this._context.node.Di().contentReplicator.forceOutbound(()=>{this.P$k()},null,null)})}catch(h){v.ULS.sendTraceTag(526528851,322,15,"Exception parsing WordOart response: {0}, with a {1} operation. PlaceholderKind: {2}",h.message,this.Sp,$d.ImageReader.ul(this._image)),this.N4d()}}yXd(){v.ULS.sendTraceTag(521175366,322,15,"onImageSuccess should not have been called")}M3c(){let b;
b=this.ubb(b);this._image.setValue(Li.a.Mea,this.VFj);this.Eug&&this._image.setValue(Li.a.Erd,this.Eug);this._image.setValue(Li.a.oBa,this.i_j);this._image.setValue(Li.a.pBa,this.kGj);this._image.setValue(Li.a.ZYa,this.Omc);this.bHj&&this._image.setValue(od.a.$4b,this.bHj);jA.a.skb(this._image,this.AIg,3);this._image.setValue(yc.a.bcb,this.AIg);this.TMg?this._image.setValue(Li.a.Pfb,this.TMg):this._image.removeProperty(Li.a.Pfb);this.Ovk();b.dispose()}Ovk(){this._image.removeProperty(od.a.Fu);this._image.removeProperty(od.a.dK);
this._image.removeProperty(od.a.M_d);this._image.removeProperty(od.a.L_d)}P$k(){this.lJ.kEa(this._context);if(this.em&&this.em!==pa.a.nil){const b=this._context.node.Di(),h=new E.a(this.em,1);this.wm.zZb(b,h)}this.Hd.zs(13);this.fFc();this.JAd();mf.a.mark(this.p3b());Object(eG.a)(()=>{let b;b=this.ubb(b);this._image.setValue(ui.a.l3,1);b.dispose()});this.BIa&&this.BIa()}leb(b,h){b=new Ma.QueryStringBuilder(this.ntd(b,h));b.Ie(rg.a.TLd,"true");return b.toString()}q3b(){return 51511}p3b(){return 51512}}
Object(n.a)(WJ,"RenderedGraphicEditOperation",kA,[]);class XJ extends kA{constructor(b,h,r,z,R,ba,ta,Wa,ub,Ib){super(b,h,r,z,R,ba,ta,Wa,ub);this.GDg=null;this.yXd=$b=>{const fc=this.ntd(!0,!1);let Kc;Kc=this.ubb(Kc);this._image.setValue(yc.a.Frd,this.Lld);var ed=Sa.a.instance.Pa("Box4.IFeatureHelper");ed&&ed.isFeatureEnabled(48)&&this._image.setValue(yc.a.RBd,this.GDg);this.Oa.$("WordEditorImageRotateIsEnabled")&&this.Oa.$("WordOartForceOutboundAfterImageSuccessIsEnabled")&&this.ij.O6d(this._image,
this.zD,this.c7a,this.d7a);const Jd=$d.ImageReader.wla(this._image,this.Oa,this.Nq),ge=()=>{Jd&&jA.a.skb(this._image,Jd,3);jA.a.skb(this._image,fc,3);this.ij.M6d(this._image,pg.a.qF(this.WO),pg.a.qF(this.vV),pg.a.qF(this.pq),pg.a.qF(this.Rba));this._image.setValue(yc.a.bcb,fc);$d.ImageReader.Wx(this._image)||this._image.setValue(yc.a.GBa,1);this.ij.x6d(this._image,this.Bp,this.Zq);this.Oa.$("WordEditorImageRotateIsEnabled")&&!this.Oa.$("WordOartForceOutboundAfterImageSuccessIsEnabled")&&this.ij.O6d(this._image,
this.zD,this.c7a,this.d7a);2===$b.data.status&&$d.ImageReader.LZ($b.data.Ge)&&(this._image.setValue(od.a.Fu,$b.data.Ge),$b.data.request&&this._image.setValue(od.a.$4b,jA.a.OFc("POST"===$b.data.request.get_httpVerb()?$b.data.request.get_body():$b.data.request.get_url())));this.BIa&&this.BIa();this.lJ.kEa(this._context);if(this.em&&this.em!==pa.a.nil){const qe=this._context.node.Di(),Ve=new E.a(this.em,1);this.wm.zZb(qe,Ve)}this.Hd.zs(13);this.fFc();this.JAd();mf.a.mark(this.p3b())};if(this.Oa.$("WordOartForceOutboundAfterImageSuccessIsEnabled")&&
this.em&&this.em!==pa.a.nil&&(ed=this._context.node.Di())&&ed.contentReplicator){Kc.dispose();ed.contentReplicator.forceOutbound(()=>{let qe;qe=this.ubb(qe);ge();qe.dispose()},null,null);return}ge();Kc.dispose()};this.xEe=Ib}q3b(){return 51511}p3b(){return 51512}b1a(b){try{var h=JSON.parse(b.data.Ge);const R=Sys.Net.XMLDOM("string"===typeof h[rg.a.bbh]?h[rg.a.bbh]:null);this.Lld="string"===typeof h[rg.a.Grd]?h[rg.a.Grd]:null;const ba=Sa.a.instance.Pa("Box4.IFeatureHelper");ba&&ba.isFeatureEnabled(48)&&
(this.GDg="string"===typeof h[rg.a.o1b]?h[rg.a.o1b]:null);X.a.Ak&&R.setProperty("SelectionNamespaces","xmlns:mc='"+Gc.a.xak+"'");const ta=R.selectSingleNode("/mc:AlternateContent");if(!ta)throw Vj.a.argument("Alternate content element could not be retrieved!");const Wa=ta.firstChild;if(!Wa)throw Vj.a.argument("Alternate content choice element could not be retrieved!");const ub=Wa.firstChild;if(!ub)throw Vj.a.argument("Drawing element could not be retrieved!");var r=ub.firstChild;if(!r)throw Vj.a.argument("Inline element could not be retrieved!");
h=b=null;const Ib=RegExp("effectExtent"),$b=RegExp("extent");for(let Kc of r.childNodes)-1!==Kc.nodeName.search(Ib)&&(b=Kc),-1!==Kc.nodeName.search($b)&&(h=Kc);if(!b||!h)throw Vj.a.argument("Effect extent or extent could not be retrieved!");this.WO=parseInt(b.selectSingleNode("@l").text);this.vV=parseInt(b.selectSingleNode("@r").text);this.pq=parseInt(b.selectSingleNode("@t").text);this.Rba=parseInt(b.selectSingleNode("@b").text);const fc=cd.c(this.zD);if(45<=fc&&135>=fc||225<=fc&&315>=fc){const Kc=
parseInt(h.selectSingleNode("@cx").text);var z=parseInt(h.selectSingleNode("@cy").text);r=Kc/2;z/=2;this.WO-=r-z;this.vV+=r-z;this.pq-=z-r;this.Rba+=z-r}}catch(R){v.ULS.sendTraceTag(42079129,322,15,"Exception parsing WordOart response: {0}, with a {1} operation. PlaceholderKind: {2}",R.message,this.Sp,MC.a[this.xEe]);this.N4d();return}this.sendMessage(!0,this.yXd)}}Object(n.a)(XJ,"RenderedDrawingEditOperation",kA,[]);class YJ extends kA{constructor(b,h,r,z,R,ba,ta,Wa,ub,Ib,$b){super(b,h,r,z,R,ba,
ta,Wa,ub);this.N8=null;this.yXd=fc=>{const Kc=this.ntd(!0,!1);let ed;ed=this.ubb(ed);this._image.setValue(yc.a.ZGb,this.Lld);const Jd=$d.ImageReader.wla(this._image,this.Oa,this.Nq),ge=()=>{Jd&&jA.a.skb(this._image,Jd,3);jA.a.skb(this._image,Kc,3);this.ij.M6d(this._image,pg.a.qF(this.WO),pg.a.qF(this.vV),pg.a.qF(this.pq),pg.a.qF(this.Rba));this._image.setValue(yc.a.bcb,Kc);$d.ImageReader.Wx(this._image)||this._image.setValue(yc.a.GBa,1);this._image.setValue(yc.a.ZUc,this.d9);this._image.setValue(od.a.a0l,
-1);this.Ac.isFeatureEnabled(93)&&$d.ImageReader.w4b(this._image)&&this.vo.G3d(this._image);this._image.setValue(ui.a.JDd,!1);this.ij.x6d(this._image,this.Bp,this.Zq);this.Oa.$("WordEditorImageRotateIsEnabled")&&this.ij.O6d(this._image,this.zD,this.c7a,this.d7a);this.Oa.$("WordEditorImageCropIsEnabled")&&this.ij.kYf(this._image,this.QOb,this.NOb,this.OOb,this.POb);2===fc.data.status&&$d.ImageReader.LZ(fc.data.Ge)&&(this._image.setValue(od.a.Fu,fc.data.Ge),fc.data.request&&this._image.setValue(od.a.$4b,
jA.a.OFc("POST"===fc.data.request.get_httpVerb()?fc.data.request.get_body():fc.data.request.get_url())));this.BIa&&this.BIa();this.lJ.kEa(this._context);if(this.em&&this.em!==pa.a.nil){const qe=this._context.node.Di(),Ve=new E.a(this.em,1);this.wm.zZb(qe,Ve)}this.Hd.zs(13);this.fFc();this.JAd();mf.a.mark(this.p3b())};if(this.Oa.$("WordOartForceOutboundAfterImageSuccessIsEnabled")&&this.em&&this.em!==pa.a.nil){const qe=this._context.node.Di();if(qe&&qe.contentReplicator){ed.dispose();qe.contentReplicator.forceOutbound(()=>
{let Ve;Ve=this.ubb(Ve);ge();Ve.dispose()},null,null);return}}ge();ed.dispose()};this.xEe=Ib;this.Ac=$b}q3b(){return 7988}p3b(){return 7989}get vo(){this.N8||(this.N8=new MJ.a);return this.N8}b1a(b){try{const h=b.data.wga;this.Lld=b.data.Ge;X.a.Ak&&h.setProperty("SelectionNamespaces","xmlns:pic='"+Gc.a.J4m+"'");const r=h.selectSingleNode("/pic:wordEdit/pic:spPr").nextSibling;this.WO=parseInt(r.selectSingleNode("@l").text);this.vV=parseInt(r.selectSingleNode("@r").text);this.pq=parseInt(r.selectSingleNode("@t").text);
this.Rba=parseInt(r.selectSingleNode("@b").text)}catch(h){b=Object.assign(new eb.a,{extendedProperties:new Map});b.extendedProperties.set("exception",h.message);b.extendedProperties.set("operation",this.Sp);Ca.Health.instance.recordQosError("PictureSwordResponseInvalid",["ImageEditFailed"],!1,!0,!1,!1,b);v.ULS.sendTraceTag(25182691,322,15,"Exception parsing WordOart response: {0}, with a {1} operation. PlaceholderKind: {2}",h.message,this.Sp,MC.a[this.xEe]);this.N4d();return}this.fFc();mf.a.mark(this.p3b());
this.sendMessage(!0,this.yXd)}}Object(n.a)(YJ,"RenderedPictureEditOperation",kA,[]);class ZJ{constructor(b,h,r,z,R,ba,ta,Wa){this.ij=b;this.Oa=h;this.Nq=r;this.le=z;this.Hd=R;this.wm=ba;this.lJ=ta;this.Ac=Wa}create(b,h){const r=$d.ImageReader.ul(b);return ja.App.instance.Ita(r)?new WJ(b,h,this.ij,this.Oa,this.Nq,this.le,this.Hd,this.wm,this.lJ):10===r||11===r||48===r||4===r?new XJ(b,h,this.ij,this.Oa,this.Nq,this.le,this.Hd,this.wm,this.lJ,r):5===r?new YJ(b,h,this.ij,this.Oa,this.Nq,this.le,this.Hd,
this.wm,this.lJ,r,this.Ac):null}}Object(n.a)(ZJ,"Factory",null,[482]);class $J{constructor(){this.qEc=b=>{const h=window.performance.now(),r=uj.a.Rw();if(r){b=WF.a(b.customData,r);b=Cn.a.Kr(b,r);var z=0,R=new yf.GraphTransaction(3);try{for(R.Db(r);b.moveNext();){if(!ie.ParagraphReader.zh(b.iterator))continue;const ba=b.currentNode;this.vBh(ba)&&(z++,ba.gk(4,!0));const ta=window.performance.now()-h;if(2500<z||100<ta){this.Xsb=null;this.KWc(ba);break}}}finally{R&&R.dispose()}}else ud.b(570450380,3018,
10,"PageContentNode not found")};this.Xsb=null}v$h(){const b=uj.a.Rw();this.WWc(b);this.KWc(null)}KWc(b){this.Xsb&&(t.AFrameworkApplication.uc.We(this.Xsb),this.Xsb=null);this.Xsb=new Ic.a(1,1,1,this.qEc,198);this.Xsb.customData=b;t.AFrameworkApplication.uc.$b(this.Xsb)}WWc(b){const h=WF.b(b);if(h){var r=new yf.GraphTransaction(3);try{for(r.Db(b);h.moveNext();){if(!ie.ParagraphReader.zh(h.iterator))continue;const z=h.currentNode;this.vBh(z)&&z.gk(4,!0)}}finally{r&&r.dispose()}}}vBh(b){b=b.wD;for(let h of b)if(h.E6b)return 0<
h.YKb;return!1}}Object(n.a)($J,"RenderParagraphsContainingTabs",null,[]);class aK{constructor(b,h){this.mne=!0;this.Jlc=null;this.dZk=()=>{this.Jlc=null;this.mne=!0;this.CIa&&this.CIa.FQa(!vb.App.cK())};this.m4a=(r,z,R)=>{if(1===R)return 32;2===R&&(r=!1,vb.App.cK()?this.mne=!1:this.mne?r=!0:this.Imo(),this.CIa&&this.CIa.FQa(r));return 32};this.ga=b;this.CIa=h}Vb(){this.ga.gb(ab.a.m4a,kc.a.application,this.m4a,1124)}Imo(){this.Jlc?t.AFrameworkApplication.uc.We(this.Jlc):this.Jlc=new Ic.a(4,1,5E3,this.dZk);
t.AFrameworkApplication.uc.$b(this.Jlc)}}Object(n.a)(aK,"SaveStatusActor",null,[]);class bK{constructor(b,h){this.Avb=(r,z,R)=>{r=uj.a.NDb(z);if(1===R||r)return r?8:32;this.s4.value.SHk(z);return 32};this.createNewStyle=(r,z,R)=>{r=uj.a.NDb(z);if(1===R||r)return r?8:32;this.s4.value.BLk(z,this.ga);return 32};this.l3e=(r,z,R)=>{r=uj.a.NDb(z)||this.GSn();if(1===R||r)return r?8:32;this.s4.value.l3e(z);return 32};this.ga=b;this.s4=h}get SVf(){return null!=this.Xpg?this.Xpg:this.Xpg=Sa.a.instance.Pa("Box4.ISaveStyleManager")}get ewn(){return this.dwn||
(this.dwn=Sa.a.instance.Pa("Box4.IResetAndDeleteStyleManager"))}get Gj(){return null!=this.Mqg?this.Mqg:this.Mqg=Sa.a.instance.Pa("Box4.Styles.StyleSettings")}get oc(){return null!=this.ktg?this.ktg:this.ktg=Sa.a.instance.resolve("Box4.Styles.IWACStyleReader")}Vb(){this.ga.gb(Fb.a.Avb,kc.a.view,this.Avb,1028);this.ga.gb(Fb.a.createNewStyle,kc.a.view,this.createNewStyle,4);this.ga.gb(Fb.a.dyb,kc.a.view,this.l3e,4);this.ga.gb(Fb.a.RVf,kc.a.view,this.fCn.bind(this),4);this.ga.gb(Fb.a.mUf,kc.a.view,this.nUf.bind(this),
4);this.ga.gb(Fb.a.i3e,kc.a.view,this.lTk.bind(this),4)}fCn(b,h,r){b=uj.a.NDb(h)||this.LSn();if(1===r||b)return b?8:32;this.SVf.eCn();return 32}nUf(b,h,r){b=uj.a.NDb(h)||this.JSn();if(1===r||b)return b?8:32;this.ewn.nUf();return 32}lTk(b,h,r){b=uj.a.NDb(h)||this.FSn();if(1===r||b)return b?8:32;this.s4.value.kTk();return 32}FSn(){return"{}"===CC.a.tmb?!0:!1}JSn(){if(0==CC.a.Q2.size)return!0;var b=CC.a.Q2;const h=this.oc.Kp();let r=0;for(let z of b.values())b=h.xh(z),this.oc.oe(b,h)||r++;return 0==
r?!0:!1}LSn(){var b=CC.a.tmb,h=CC.a.Q2;const r=this.oc.Kp();if(0==h.size)return!0;if(!({Fv:b}=y.d(b)).returnValue)return v.ULS.sendTraceTag(526979992,3017,15,"Received null string during  deserialization: StylesActor."),!0;if(Object.keys(b).length!=h.size)return!1;for(let R of h.values()){h=r.xh(R);var z=b[R];if(null==z)return!1;if(z=uj.a.mId(z)){if(this.Gj.eX||(h=uj.a.UHc(h,r)),uj.a.vOc(h,z))return!1}else v.ULS.sendTraceTag(526979993,3017,15,"Received null style during de serialization: StylesActor.")}return!0}GSn(){var b=
uj.a.Rw();if(!b)return ud.b(577368330,3018,15,"PageContentNode is null"),!0;b=(new Nv.WACStyleSet).XN(b);const h=b.yN;for(let z=0;z<h;z++){var r=b.xla(z);if(this.oc.isHidden(r)||!this.oc.oe(r,b))continue;const R=this.oc.Uw(r);if(2===R||1===R)if(!r.hasProperty(yc.a.Gc)||2===R)if(r=r.ia(yc.a.gF,null),!(r&&0<r.length))return!1}return!0}}Object(n.a)(bK,"StylesActor",null,[]);class ZE{constructor(b){this.M$d=(h,r,z)=>{h=t.AFrameworkApplication.ua;if(1===z)return 1!==h.mode||Xh.SessionStatusManager.instance.Sj?
2:32;Ca.Health.instance.recordKpiUsage("SwitchToClassicViewMode",0,ZE.EB,null);const R={};R[G.a.Jlf]=t.AFrameworkApplication.K.lb("ClassicViewModePreferenceCookieName");R[G.a.a6h]="true";t.AFrameworkApplication.bQ().execute(ba=>{ba.sendMessage(F.a.i3n,R)});return t.AFrameworkApplication.ya.processAction(Fb.a.eIb,2)};this.ga=b}Vb(){this.ga.pa(Oa.a.M$d,kc.a.view,this.M$d)}}ZE.EB="wwaengidc";Object(n.a)(ZE,"SwitchToClassicViewModeActor",null,[]);class cK{constructor(b,h,r,z,R,ba,ta,Wa,ub){this.angle=
r;this.styleId=z;this.width=b;this.height=h;this.top=R;this.bottom=ba;this.left=ta;this.right=Wa;this.R1=ub}}Object(n.a)(cK,"SWordData",null,[]);class dK{constructor(b,h){this.gl=this.JR=this.Rp=null;this.LEe=this.ISb=!1;this.WO=this.vV=this.Rba=this.pq=this.d9=this.Zq=this.Bp=this.zD=0;this.em=null;this.V6=()=>{this.LEe=!1;this.ISb&&this.jFc()};this.rm=b;this.ruc=h;this.$7h()}$7h(){this.vV=this.WO=this.Rba=this.pq=this.d9=this.Zq=this.Bp=this.zD=-1;this.em=pa.a.nil}jFc(){this.LEe||(this.Hpo(),this.QMk(),
this.ISb=!1)}QMk(){this.gl=new cK(this.Bp,this.Zq,this.zD,this.d9,this.pq,this.Rba,this.WO,this.vV,this.em);this.ruc.create(this.JR,this.Rp).nNn(this.V6,this.gl);this.LEe=!0;let b;Object(nb.a)(3,this.JR)?b=MC.a[$d.ImageReader.ul(this.JR)]:(v.ULS.sendTraceTag(42469523,322,50,"Unable to acquire PlaceholderKind because the image property set isn't of the type which contains information about the PlaceholderKind."),b="generic");v.ULS.sendTraceTag(23171277,322,50,"Sending request to SWord with width: {0}, height: {1}, angle: {2}, style: {3}, top: {4}, bottom: {5}, left: {6}, right: {7}, placeholderKind: {8}",
this.Bp,this.Zq,this.zD,this.d9,this.pq,this.Rba,this.WO,this.vV,b);this.$7h()}Hpo(){this.Bp=-1!==this.Bp?this.Bp:this.JR.ia(od.a.FBa,-1);this.Zq=-1!==this.Zq?this.Zq:this.JR.ia(od.a.EBa,-1);this.Bp=-1!==this.Bp?this.Bp:this.rm.tA(this.JR);this.Zq=-1!==this.Zq?this.Zq:this.rm.JB(this.JR);this.zD=-1!==this.zD?this.zD:this.rm.vZ(this.JR);this.d9=-1!==this.d9?this.d9:this.rm.ceb(this.JR);this.pq=-1!==this.pq?this.pq:this.rm.pla(this.JR);this.Rba=-1!==this.Rba?this.Rba:this.rm.lla(this.JR);this.WO=-1!==
this.WO?this.WO:this.rm.nla(this.JR);this.vV=-1!==this.vV?this.vV:this.rm.ola(this.JR)}sdn(b,h,r,z){this.Rp=b;this.zD=r;this.ISb=!0;this.JR=h;this.em=z;this.jFc()}rdn(b,h,r,z,R){this.Rp=b;this.ISb=!0;this.JR=h;this.em=R;this.JR.setValue(od.a.FBa,r);this.JR.setValue(od.a.EBa,z);this.jFc()}wdn(b,h,r){this.Rp=b;this.ISb=!0;this.JR=h;this.d9=r;this.jFc()}ldn(b,h,r,z,R,ba){this.Rp=b;this.pq=r;this.Rba=z;this.WO=R;this.vV=ba;this.ISb=!0;this.JR=h;h=b=0;({width:b,height:h}=this.rm.lAb(this.JR));this.Bp=
b-(R+ba)/1E5*b;this.Zq=h-(r+z)/1E5*h;this.jFc()}}Object(n.a)(dK,"SWordRequestManager",null,[343]);class XD{constructor(b,h,r,z=null,R=null,ba=null,ta=null,Wa=null,ub=null,Ib=null){this.wm=null;this.a5g=!1;this.w5n=($b,fc,Kc,ed,Jd)=>{if(1===Kc)return 32;const ge=$b===Fb.a.$Zf;if(!fc.view.ze)return 2;const qe=fc.view,Ve=qe.Cb,Bd=Ve.Rg;if(!Bd||XD.Zf.iZ(Bd))return 2;if(this.Hm&&this.Hm.instance&&this.Hm.instance.HT(Bd))return 4;$b=null;var he=$c.ActionManager.zua;let we=!1;var hg=Xd.SelectionEditor.xf(Bd);
if(Bd.Xw){if(Ve.hb.zI&&(he=Bd.getContext(0),$b=new Nd.GraphIterator,$b.set(he.node),$b.qo(),he=ge?Fb.a.pWf:Fb.a.I5d),he=this.gJe.S8m(he),he===$c.ActionManager.zua){var Pf=XD.Tg.uS(Bd,16);Pf?(ge&&(he=Fb.a.zVd),$b=new Nd.GraphIterator,$b.set(Pf.node),$b.vd()):he=ge?Fb.a.OF:Fb.a.FN}}else if(Bd.vl)if($b=new Nd.GraphIterator,$b.set(Bd.node),Xd.SelectionEditor.Jt($b),Ff.OutlineReader.DMa(Bd))he=ge?Fb.a.pWf:Fb.a.I5d;else{if(this.pse&&this.pse.DUn(Bd))return this.pse.i_c(Bd,qe.Tb,ge),32;he=ge?this.gJe.$Ql($b,
Bd,he,fc):this.gJe.ZQl($b,Bd,he,fc);vg.OutlineElementReader.Nh($b)&&Bd.contextId===kc.a.Wc&&(we=vg.OutlineElementReader.Pz($b,Bd,!1));Pf=mc.ListReader.ai($b)&&we;he!==$c.ActionManager.zua||Gi.TableCellReader.NMa($b)||Pf||(this.a5g||(v.ULS.sendTraceTag(39662619,383,50,"User tried to insert inline tabs"),this.a5g=!0),t.AFrameworkApplication.ya.processAction(Fb.a.v8h,2),this.V8h(fc))}else return 2;if(!ge&&he===$c.ActionManager.zua&&Gi.TableCellReader.NMa($b))if(Ke.returnToCell($b),Gi.TableCellReader.zMa($b)||
Ii.TableReader.zdi($b)&&Gi.TableCellReader.gei($b)){if(he=this.v0j(),!he)return 2}else he=Fb.a.Ssi;if(he===$c.ActionManager.zua)return 2;switch(he){case Fb.a.Ssi:case Fb.a.zVd:ed=he===Fb.a.zVd;hg&&this.h0&&this.bY&&(hg=this.h0.h9e(Bd,-1,!0,wb.a.mx))&&this.bY.ZUi(hg);Kc=32;Ke.returnToCell($b);Ke.moveToNextOrPreviousCell($b,ed)&&(hg=!0,ed=!1,Ff.OutlineReader.Qkf($b)||(uf.OutlineNavigator.LAf($b,!1),ag.OutlineElementNavigator.De($b),ie.ParagraphReader.xu($b.currentNode)&&(hg=!1,ie.ParagraphReader.textLength($b.currentNode)||
(ed=!0)),ed||Ke.returnToCell($b)),ed?$b=Hf.SelectionFactory.xe($b.currentNode,0):($b=Hf.SelectionFactory.jr($b.currentNode),!hg&&Xd.SelectionEditor.uk($b.Tc)&&(hg=$b.toArray(),Array.removeAt(hg,hg.length-1),$b=new tm.Selection(hg,$b.Wf))),Ve.setSelection($b));break;case Fb.a.pWf:case Fb.a.I5d:he===Fb.a.I5d?uf.OutlineNavigator.ssi($b,!1):uf.OutlineNavigator.ssi($b,!0);Ve.setSelection(Hf.SelectionFactory.jr($b.currentNode));Kc=32;break;case Fb.a.c1c:Kc=t.AFrameworkApplication.ya.Qf(fc,he,Kc,!0,ed,Jd);
break;default:if(Kc=t.AFrameworkApplication.ya.Qf(fc,he,Kc,!0,ed,Jd),!we&&hg&&(he===Fb.a.OF||he===Fb.a.FN)){const Ej=Xd.SelectionEditor.nza(Ve.hb.kb).y;vb.App.Ybc(()=>{this.KJm(Ve,qe,Ej)})}}32===Kc&&fc.view.ze&&this.xi.EF();return Kc};this.pja=b;this.gJe=h;this.Hm=r;this.h0=z;this.bY=R;this.jJe=ba;this.RFa=ta;this.Ac=Wa;this.Hc=ub;this.pse=Ib}get xi(){return this.wm||(this.wm=this.pja())}Vb(){const b=t.AFrameworkApplication.ya,h=this.w5n;b.gb(Fb.a.tab,kc.a.view,h,1124);b.gb(Fb.a.$Zf,kc.a.view,h,1124);
b.pa(Fb.a.v8h,kc.a.view,$c.ActionManager.Nf)}KJm(b,h,r){if(b&&h){var z=b.hb.kb;Xd.SelectionEditor.nza(z).y<r?(h=Xd.SelectionEditor.fGc(h,z,!1),h=Xd.SelectionEditor.Hsa(h,{eC:!1,Xs:!1,kE:!1,dG:!0})):h=Xd.SelectionEditor.HCd(h,z,!1);b.setSelection(h)}}v0j(){return Fb.a.RZa}V8h(){}nSc(b,h,r){if(b&&h){var z=b.hb.kb;Xd.SelectionEditor.nza(z).y<r?(h=Xd.SelectionEditor.fGc(h,z,!1),h=Xd.SelectionEditor.Hsa(h,{eC:!1,Xs:!1,kE:!1,dG:!0})):h=Xd.SelectionEditor.Hsa(z,{eC:!1,Xs:!1,kE:!1,dG:!0});b.setSelection(h)}}static get Zf(){return Yh.a.instance}static get Tg(){return sm.ContextSetEditor.instance}}
Object(n.a)(XD,"TabActor",null,[]);class fG{constructor(b){this.epc=b}get qp(){return this.epc}S8m(b){return b}$Ql(b,h,r,z){const R=z.view,ba=R.Cb.hb.kb;if(Gi.TableCellReader.NMa(b))return this.wdi(b,z)?Fb.a.OF:Fb.a.zVd;ag.OutlineElementNavigator.Zd(b);if(Xd.SelectionEditor.xf(h))vg.OutlineElementReader.Pz(b,h,!1)&&this.p3i(b)?r=Fb.a.CHb:Xd.SelectionEditor.hPc(R,ba)&&this.qp.pwb(b)?r=Fb.a.OF:Xd.SelectionEditor.hPc(R,ba)&&(r=Fb.a.OF);else if(Xd.SelectionEditor.Ek(h)){if(!this.qp.pwb(b))return r;Xd.SelectionEditor.Qfb(h)?
r=Fb.a.OF:Xd.SelectionEditor.kii(h)&&(r=this.p3i(b)?Fb.a.CHb:Fb.a.OF)}else this.qp.pwb(b)&&(r=Fb.a.OF);return r}ZQl(b,h,r,z){if(Gi.TableCellReader.MZ(b))return this.wdi(b,z)?Fb.a.FN:r;ag.OutlineElementNavigator.Zd(b);if(Xd.SelectionEditor.xf(h))vg.OutlineElementReader.Pz(b,h,!1)&&(!mc.ListReader.ai(b)&&vg.OutlineElementReader.isEmpty(b,!1)?r=$c.ActionManager.zua:this.ESn(b)?r=Fb.a.Obb:this.z2i(b)?r=Fb.a.eyb:this.qp.JYb(b)&&(r=Fb.a.FN));else if(Xd.SelectionEditor.Ek(h)){if(!this.qp.JYb(b))return r;
Xd.SelectionEditor.Qfb(h)?r=Fb.a.FN:Xd.SelectionEditor.kii(h)&&(r=this.z2i(b)?Fb.a.eyb:Fb.a.FN)}else this.qp.JYb(b)&&(r=Fb.a.FN);return r}p3i(b){return mc.ListReader.ai(b)?!1:0<vg.OutlineElementReader.g2(b)?!0:!1}z2i(b){if(mc.ListReader.ai(b))return!1;const h=vg.OutlineElementReader.g2(b);b=Ff.OutlineReader.yL(b.currentNode);return h<b?!0:!1}ESn(b){return mc.ListReader.ai(b)?!1:0<vg.OutlineElementReader.wF(b)?!0:!1}static mr(){return new fG(ao.a.GAb)}wdi(b,h){if(this.Iim){h=h.view;const r=h.Cb.hb.kb,
z=new Nd.GraphIterator;z.fd(b);ag.OutlineElementNavigator.Zd(z);if(mc.ListReader.ai(z)&&Xd.SelectionEditor.hPc(h,r))return!0}return!1}get Iim(){var b;t.AFrameworkApplication.Hf("egdi3422;7g6fa693");return null===(b=t.AFrameworkApplication.K)||void 0===b?void 0:b.getBooleanFeatureGate("Microsoft.Office.WordOnline.QOEForListInTableIsEnabled",!1)}}Object(n.a)(fG,"TabActorPromoteDemoteStrategy",null,[388]);class ZB extends XD{constructor(b,h,r,z,R,ba,ta,Wa,ub,Ib,$b,fc,Kc){super(b,h,r,z,R,ba,ta,Wa,ub,
Ib);this.KTc=(ed,Jd)=>{ed=Jd.property;!this.iYc||ed!==yc.a.Lo&&ed!==yc.a.marginLeft&&ed!==yc.a.marginRight||this.iYc.v$h()};this.yL=(ed,Jd,ge,qe,Ve)=>{ed=Ff.OutlineReader.yL(this.bDl(Jd));Ve.defaultTabStop=ed;return 32};this.KSb=$b;this.ga=Kc;this.QA();this.ga.pa(Oa.a.yL,kc.a.view,this.yL)}get iYc(){return null!=this.Mpg?this.Mpg:this.Mpg=Sa.a.instance.Pa("WordEditor.Actors.RenderParagraphsContainingTabs")}QA(){this.KSb.al.Se(10).lp(this.KTc)}V8h(b){const h=b.view,r=h.Cb;b=r.Rg;if(this.RFa&&this.Hc){var z=
this.Hc.Rc(15);z.Db(b.node);b.contextId===kc.a.Gd&&t.AFrameworkApplication.ya.processAction(Fb.a.SG,2);this.RFa.MMd(r.Rg);z.dispose();var R=Xd.SelectionEditor.nza(r.hb.kb).y;vb.App.Ybc(()=>{this.nSc(r,h,R)})}}bDl(b){return b.view.Cb.hb.kb.Qa.node}static get instance(){return null!=ZB.Smg?ZB.Smg:ZB.Smg=ZB.Gl()}static Gl(){return new ZB(()=>Sa.a.instance.resolve("Box4.IUndoManager"),fG.mr(),Sa.a.instance.Za("Box4.IExternalSelectionManager"),Sa.a.instance.resolve("Box4.IAutoCorrectRules"),Sa.a.instance.resolve("Box4.IAutoCorrectScheduler"),
Sa.a.instance.Pa("Box4.ITabPresenterFactory"),Sa.a.instance.Pa("Box4.IBlobEditor"),Sa.a.instance.Pa("Box4.IFeatureHelper"),Sa.a.instance.Pa("Box4.Graph.GraphTransactionFactory"),Sa.a.instance.Pa("Box4.Actors.IIFrameFocusStrategy"),vb.App.Xj,Sa.a.instance.Pa("Box4.ITabRenderer"),t.AFrameworkApplication.ya)}}Object(n.a)(ZB,"TabActor",XD,[]);class vv{static get Ss(){return null!=vv.tgg?vv.tgg:vv.tgg=Sa.a.instance.resolve("Box4.IAppFrame")}static initialize(){hs.a.t7b=vv.Gjm;hs.a.jae=vv.tso}static Gjm(b){return!Ii.TableReader.Hem(b)}static aib(){vv.Ss.mcc(vv.aib);
vv.Srb=!1;const b=appChrome.selectors.getActiveContextualTabIds();"Home"===appChrome.selectors.getSelectedTabId()&&0<=Array.indexOf(b,"Table")&&appChrome.api.dispatch(appChrome.actions.setCurrentTab("Table"))}static tso(b){b&&(yr.a.instance.kb.zCa||yr.a.instance.kb.yw||yr.a.instance.kb.TDb)&&!vv.Srb&&(vv.Ss.pVa(vv.aib),vv.Srb=!0)}}vv.Srb=!1;Object(n.a)(vv,"TableActor",null,[]);var zM=d(898);class gG{I$k(b,h,r,z){return b?this.j9k(h,r,z):this.J$k(h,r,z)}THh(b,h,r,z,R){return b?this.l$k(h,r,z,R):this.$9k(h,
r,z,R)}X9k(b){let h=!1;var r=b.Wf?b.Ke.Tc:b.Ke.Qa;b=new Nd.GraphIterator;b.set(r.node);b.Bb(14);r=null;Gi.TableCellReader.U$(b)?Gi.TableCellReader.iDb(b)||(h=!0,r=Ke.moveToNextRow(b)):r=Ke.moveToNextColumn(b);return{returnValue:r,bKm:h}}g$k(b){var h=b.Wf?b.Ke.Tc:b.Ke.Qa;const r=new Nd.GraphIterator;r.set(h.node);r.Bb(14);h=null;Gi.TableCellReader.ffa(r)?Gi.TableCellReader.efa(r)||(h=new Nd.GraphIterator,h.set(b.pza.node),h.Bb(14),b=Jm.a.At(h),Jm.a.At(r)>b?(Ke.moveToPreviousRow(r),Ke.moveToLastColumn(r),
h=r.currentNode):h=Ke.moveToPreviousRow(r)):h=Ke.moveToPreviousColumn(r);return h}fIh(b,h){var r=b.Wf?b.Ke.Tc:b.Ke.Qa;b=new Nd.GraphIterator;b.set(r.node);b.Bb(14);r=null;h?Gi.TableCellReader.efa(b)||(r=Ke.moveToPreviousRow(b)):Gi.TableCellReader.iDb(b)||(r=Ke.moveToNextRow(b));return r}gEb(b,h,r){for(;Gi.TableCellReader.qg(b);)if(h){if(r&&b.Fta(1)||!r&&b.Nta(1))return null;r?Ke.moveToPreviousColumn(b):Ke.moveToNextColumn(b)}else{if(Gi.TableCellReader.F2(b.currentNode)){const z=new Nd.GraphIterator;
z.fd(b);if(this.gEb(z,!0,!0)||this.gEb(z,!0,!1)){b.fd(z);break}}else{if(!r&&Ke.moveToControllingCell(b,2))break;if(r&&Ke.moveToControllingCell(b))break}if(r&&Gi.TableCellReader.efa(b)||!r&&Gi.TableCellReader.iDb(b))return null;r?Ke.moveToPreviousRow(b):Ke.moveToNextRow(b)}return b.currentNode}A1b(b,h){if(!Jm.a.isTableRow(b))return null;b=Nd.GraphIterator.$a(b.currentNode);b.Bb(14);let r;const z=Ii.TableReader.HA(b.origin);do r=h?Ke.moveToPreviousRow(b):Ke.moveToNextRow(b);while(z&&r&&Jm.a.uMa(b));
return r}Ehb(b,h,r,z,R){let ba=null;ag.OutlineElementNavigator.Zd(b);const ta=vg.OutlineElementReader.isRtl(b.currentNode);if(r)if(Ke.returnToCell(b),h=Gi.TableCellReader.U$(b),r=Gi.TableCellReader.ffa(b),R||!ta&&r||ta&&z&&h)Ke.returnToContainingRow(b),(z=this.A1b(b,!0))?ba=Hf.SelectionFactory.wo(z,!h):R&&(ag.OutlineElementNavigator.Zd(b),R=new eg.a,R.fd(b),(b=ag.OutlineElementNavigator.R2(R,!1,!1))&&(ba=Hf.SelectionFactory.wo(b,!1)));else{do ta?Ke.moveToNextColumn(b):Ke.moveToPreviousColumn(b);while(Gi.TableCellReader.qg(b)&&
!Gi.TableCellReader.efa(b));Gi.TableCellReader.qg(b)||(ba=Hf.SelectionFactory.wo(b.currentNode,!ta))}else vg.OutlineElementReader.Pz(b,h,ta)||Xd.SelectionEditor.xf(h)||Ke.returnToCell(b),ba=Hf.SelectionFactory.wo(b.currentNode,!ta);return ba}Dhb(b,h,r,z,R){let ba=null;ag.OutlineElementNavigator.Zd(b);const ta=vg.OutlineElementReader.isRtl(b.currentNode);if(r)if(Ke.returnToCell(b),r=Gi.TableCellReader.U$(b),h=Gi.TableCellReader.ffa(b),R||!ta&&z&&r||ta&&!z&&h)Ke.returnToContainingRow(b),(z=this.A1b(b,
!1))?ba=Hf.SelectionFactory.wo(z,h):(ag.OutlineElementNavigator.Zd(b),z=new eg.a,z.fd(b),(b=ag.OutlineElementNavigator.Vr(z,!1,!1))&&(ba=Hf.SelectionFactory.wo(b,!0)));else{do ta?Ke.moveToPreviousColumn(b):Ke.moveToNextColumn(b);while(Gi.TableCellReader.qg(b)&&!Gi.TableCellReader.U$(b));Gi.TableCellReader.qg(b)||(ba=Hf.SelectionFactory.wo(b.currentNode,ta))}else vg.OutlineElementReader.Pz(b,h,!ta)||Xd.SelectionEditor.xf(h)||Ke.returnToCell(b),ba=Hf.SelectionFactory.wo(b.currentNode,ta);return ba}}
Object(n.a)(gG,"ATableCellSelectionStrategy",null,[1428]);class eK extends gG{constructor(){super()}$9k(b,h,r,z){let R=b.kb,ba=null;if(b.yw)if(h)if(2===R.Ke.Pma&&!R.Wf&&R.Ke.Tc.equals(R.pza))R=Hf.SelectionFactory.jvh(R.pza.node,!1);else{var ta=({bKm:b}=this.X9k(R)).returnValue;ta&&(Gi.TableCellReader.Rr(ta)&&(ta=Nd.GraphIterator.$a(ta),ta.Bb(14),ta=!b&&this.gEb(ta,!0,!1)?ta.currentNode:b||Ke.moveToNextRow(ta)?this.gEb(ta,!1,!1):null),ta&&(ba=Hf.SelectionFactory.eo(Mq.TableNodeContext.create(ta),R.Wf)))}else R=
b.vba,b=Nd.GraphIterator.$a(R.Ke.Tc.node),b.Bb(14),Gi.TableCellReader.kCa(b.currentNode)&&Ke.moveToLastGhostCell(b,2),(ta=Ke.moveToNextColumn(b))?(b=Gi.TableCellReader.F2(ta),Gi.TableCellReader.Rr(ta)&&!b&&(ta=Nd.GraphIterator.$a(ta),ta.Bb(14),ta=Ke.moveToControllingCell(ta)),b?R=Hf.SelectionFactory.wo(R.Ke.Tc.node,!1):ba=Hf.SelectionFactory.wo(ta,!0)):(ta=R.Ke.Tc.node,ba=Hf.SelectionFactory.wo(ta,!1));else b=h&&R.Wf||!h&&!R.aua?R.Ke.Tc:R.Ke.Qa,Jm.a.rma(b.node)&&(b=Nd.GraphIterator.$a(b.node),(ta=
this.A1b(b,!1))?ba=h?Hf.SelectionFactory.eo(Mq.TableNodeContext.create(ta),R.Wf):Hf.SelectionFactory.wo(ta,!0):R=Xd.SelectionEditor.Pj(Hf.SelectionFactory.jr(b.currentNode),!1,!0));return ba?ba:z?Xd.SelectionEditor.z1b(R,!1,h,!0):Xd.SelectionEditor.Hsa(R,{eC:!h,Xs:h,kE:r,dG:!0})}l$k(b,h,r,z){let R=b.kb;var ba=null;if(b.yw)h?1===R.Ke.Pma&&R.Wf&&R.Ke.Qa.equals(R.pza)||(ba=this.g$k(R),(ba=this.RHh(R,ba))||R.Wf&&(R=R.xGc())):(R=b.vba,ba=Hf.SelectionFactory.wo(R.Ke.Qa.node,!0));else if(h){var ta=(R.Wf?
R.Ke.Tc:R.Ke.Qa).node;b=Nd.GraphIterator.$a(ta);Xd.SelectionEditor.Jt(b);Jm.a.rma(ta)&&(R.Wf&&1===R.Ke.Pma&&R.aua?(ba=Jm.a.sA(ta).toArray(),(ba=this.RHh(R,0<=ba.length-2?ba[ba.length-2]:null))||R.Wf&&(R=R.xGc())):(ta=this.A1b(b,!0))?ba=Hf.SelectionFactory.eo(Mq.TableNodeContext.create(ta),R.Wf):R=Hf.SelectionFactory.wo(b.currentNode,!0))}else ba=Xd.SelectionEditor.Pj(R,!0,!1);return ba?ba:z?Xd.SelectionEditor.z1b(R,!0,h,!0):Xd.SelectionEditor.IAa(R,{eC:!h,Xs:h,kE:r,dG:!0})}RHh(b,h){if(!h)return null;
var r=h;Gi.TableCellReader.Rr(h)&&(r=Nd.GraphIterator.$a(h),r.Bb(14),r=this.gEb(r,!0,!0)?r.currentNode:Gi.TableCellReader.Vka(h));return r?Hf.SelectionFactory.eo(Mq.TableNodeContext.create(r),b.Wf):null}J$k(b,h,r){let z=h.kb,R=null;if(h.yw){var ba=h.oW>h.IEa;if(r)if(2===h.length&&1===h.vba.Ke.Pma&&ba)z=Xd.SelectionEditor.Pj(z,!0,!1);else{if(h=this.fIh(z,!0))Gi.TableCellReader.Rr(h)&&(h=Nd.GraphIterator.$a(h),h.Bb(14),h=this.gEb(h,!1,!0)),h&&(R=Hf.SelectionFactory.eo(Mq.TableNodeContext.create(h),
z.Wf));R||z.Wf&&(z=z.xGc())}else ba&&(z=h.vba)}else h=r&&z.Wf?z.Ke.Tc:z.Ke.Qa,Jm.a.rma(h.node)&&(h=Nd.GraphIterator.$a(h.node),(ba=this.A1b(h,!0))?R=r?Hf.SelectionFactory.eo(Mq.TableNodeContext.create(ba),z.Wf):Hf.SelectionFactory.wo(ba,!0):r&&(z=Hf.SelectionFactory.wo(h.currentNode,!0)));return R?R:Xd.SelectionEditor.vbb(b,z,!1,r,r)}j9k(b,h,r){let z=h.kb,R=null;if(h.yw){const ba=h.oW<h.IEa;if(r)if(2===h.length&&1===h.vba.Ke.Pma&&ba)z=Xd.SelectionEditor.Pj(z,!1,!1);else{if(h=this.fIh(z,!1))Gi.TableCellReader.Rr(h)&&
(h=Nd.GraphIterator.$a(h),h.Bb(14),h=this.gEb(h,!1,!1)),h&&(R=Hf.SelectionFactory.eo(Mq.TableNodeContext.create(h),z.Wf))}else ba&&(z=h.vba)}else h=!r||z.Wf?z.Ke.Tc:z.Ke.Qa,Jm.a.rma(h.node)&&(h=Nd.GraphIterator.$a(h.node),(h=this.A1b(h,!1))&&(R=r?Hf.SelectionFactory.eo(Mq.TableNodeContext.create(h),z.Wf):Hf.SelectionFactory.wo(h,z.aua)));return R?R:Xd.SelectionEditor.vbb(b,z,!0,r,r)}}Object(n.a)(eK,"TableCellSelectionStrategy",gG,[]);class fK{constructor(b){this.qM=(h,r,z,R,ba)=>{if(1===z)return 32;
h=(new Om.a).create();r="";switch(ba.DialogType){case "DirectPrintPreparingPDF":r=CommonUIStrings.l_DirectPrintPreparingPDF;ba=CommonUIStrings.l_DefaultDialogTitle;break;default:ba=CommonUIStrings.l_DefaultDialogTitle}h.message=r;h.qM(ba,null,null);return 32};this.ga=b}Vb(){this.ga.gb(Fb.a.qM,kc.a.view,this.qM,1028)}}Object(n.a)(fK,"UIAutomationActor",null,[]);class gK{constructor(b,h,r,z){this.fb=b;this.RFa=h;this.Wjc=r;this.G4=z}R6f(b,h,r){return this.Wjc.whm(h)?r?!0:b&&this.fb.zh(b)?(b=this.ow(b.currentNode),
this.RFa.c9h(b),!0):!1:!1}kkf(b,h){return this.Wjc.m4k(b,h)}pkf(b){b&&this.fb.zh(b)&&(b=this.ow(b.currentNode),this.RFa.MMd(b))}ow(b){return Qe.a.ow(b)}oEa(b,h,r){this.G4.VDi&&this.Wjc.fci(r)&&(this.G4.oEa(b,h),b.setValue(od.a.wci,!0))}$6d(){}HOd(b){return this.Wjc.HOd(b)}get JPd(){return this.Wjc.JPd}hC(){}Mga(){}t7d(){}get P3i(){return!1}}Object(n.a)(gK,"WordEditorPasteStewardBridge",null,[334]);class hK{constructor(b){this.sa=new Te.a;this.oUi="WordFileSaveAsButtonClicked";this.wso=()=>{this.sa.raiseEvent(this.oUi,
null);return 32};this.ga=b}Vb(){t.AFrameworkApplication.K.$("UseNewCommandForWordFileMenuSaveAs")&&this.ga.pa(Oa.a.fmj,Yd.a.frame,this.wso)}B8j(b){this.sa.addHandler(this.oUi,b)}}Object(n.a)(hK,"WordFileSaveAsActor",null,[]);class iK extends Dy{constructor(){super()}Uyc(b,h,r,z,R,ba,ta){return hq.a.Qac(h,r,z,R,ba,ta)}}Object(n.a)(iK,"WordIndentationActorExtension",Dy,[]);class hG{constructor(){this.aed=null}get name(){return"WordEditor.Actors"}init(){var b;Ya.InteractiveViewManager.instance.editingView.U_b=
!0;t.AFrameworkApplication.ya.pa(Oa.a.uro,Yd.a.frame,hM);this.W.resolve("WordEditor.Actors.DeleteActor").Vb(t.AFrameworkApplication.ya);SB.instance.Vb();Lm.Vb();nq.Vb(t.AFrameworkApplication.ya,this.W.resolve("WordEditor.IMainViewModeManager"));kk.Vb();ZB.instance.Vb();zM.a.Vb();this.W.resolve("WordEditor.Actors.ModeSwitcherControlActor").Vb(t.AFrameworkApplication.ya);this.W.resolve("WordEditor.Actors.ExternalContentActor").Vb();this.W.resolve("WordEditor.OnlineMedia.OnlineMediaActor").Vb();t.AFrameworkApplication.K.$("WordEditorFormatPainterIsEnabled")&&
this.W.resolve("Box4.Actors.FormatPainterActor").Vb();t.AFrameworkApplication.K.$("WordEditorAutoSaveImprovementIsEnabled")&&this.W.resolve("WordEditor.Actors.SaveStatusActor").Vb();t.AFrameworkApplication.K.$("WritingStyleIsEnabled")&&t.AFrameworkApplication.K.$("WordWritingStylesDialogIsEnabled")&&(this.tV.RPd=!0);t.AFrameworkApplication.K.$("SharedUXThemingIsEnabled")&&t.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ModernUxExperimentOne",!1)&&this.W.resolve("WordEditor.Actors.ModernUxActor").Vb();
t.AFrameworkApplication.K.$("WordConsumptionViewToEditRedirectIsEnabled")&&this.W.resolve("WordEditor.Actors.SwitchToClassicViewModeActor").Vb();this.W.resolve("WordEditor.Actors.AppFrameCommandUIActor").Vb();this.W.resolve("Common.IOfficeTrialExperience").Vb();this.W.resolve("Common.IMacOfficeOffer").Vb();this.W.resolve("WordEditor.Actors.MarginsDialogActor").Vb();this.W.resolve("WordEditor.Actors.PaperSizeDialogActor").Vb();this.W.resolve("WordEditor.Actors.ColumnsDialogActor").Vb();this.W.resolve("WordEditor.Actors.FileDownloadActor").Vb();
this.W.resolve("WordEditor.Actors.StylesActor").Vb();(null===(b=t.AFrameworkApplication.K)||void 0===b?0:b.getBooleanFeatureGate("Microsoft.Office.WordOnline.isCustomizeRibbonEnabled",!1))&&this.W.resolve("WordEditor.Actors.CustomizeRibbonActor").Vb();this.W.resolve("WordEditor.Actors.ParagraphDialogActor").Vb();this.W.resolve("WordEditor.Actors.ProofingActor").Vb();this.W.resolve("WordEditor.Actors.PageActor").Vb();this.W.resolve("WordEditor.Actors.DarkModeActor").Vb();this.W.resolve("WordEditor.Actors.ImageActor").Vb(t.AFrameworkApplication.ya);
this.W.resolve("WordEditor.Actors.FormattingActor").Vb();this.W.resolve("WordEditor.Actors.UIAutomationActor").Vb();this.W.resolve("WordEditor.Actors.ContentControlActor").Vb();this.W.resolve("WordEditor.Actors.CustomTabActor").Vb();this.W.resolve("WordEditor.Actors.BookmarkActor").Vb();this.W.resolve("WordEditor.Actors.HeadingsActor").Vb();this.W.resolve("Box4.Indicator.IIndicatorManager").ujb(this.W.resolve("WordEditor.Actors.BookmarkIndicatorActor"));this.W.resolve("WordEditor.Actors.AccessibilityHelpDialogActor").Vb();
this.W.resolve("WordEditor.Actors.AccessibilityActor").dRf();this.W.resolve("WordEditor.Actors.ISWordRequestManager");this.W.resolve("Box4.Actors.AutoCorrectActor").Vb();this.W.resolve("WordEditor.Actors.DigitalPrintActor").Vb();this.W.resolve("WordEditor.GraphicsEditor.IGraphicsEditorRequestManager");this.W.resolve("Box4.Actors.VisiMarkersActor").Vb();this.W.resolve("WordEditor.Actors.ExternalContentFloatieEventManager");this.W.resolve("WordEditor.Actors.ActionHangDetector").j3();this.W.resolve("WordEditor.Actors.WordFileSaveAsActor").Vb();
t.AFrameworkApplication.K.$("GraphicsEditorActorRegistrationUpdateIsEnabled")?this.Ujn():this.W.resolve("WordEditor.Actors.GraphicsEditorActor").Vb();this.J4.tjb(this.mxj);b=this.W.resolve("WordEditor.Bookmark.FullBookmarkManager");t.AFrameworkApplication.Hf("bookmarks-core-ex;bookmarks-core-ex-cf");t.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.BookmarksIsEnabled",!1)&&b.Gqh(!1)&&vb.App.xa.jb.PDh();vb.App.xa.updateCommandUI();vv.initialize()}dispose(){}Ujn(){this.Ac.Yk.isCompleted?
this.Ac&&this.Ac.isFeatureEnabled(48)&&this.W.resolve("WordEditor.Actors.GraphicsEditorActor").Vb():this.Ac.Yk.continueWith(()=>{this.Ac&&this.Ac.isFeatureEnabled(48)&&(this.W.resolve("WordEditor.Actors.GraphicsEditorActor").Vb(),vb.App.xa.updateCommandUI())})}get Phm(){if(null==this.aed)if(this.Ac)if(this.Ac.Yk.isCompleted)this.aed=this.Ac.isFeatureEnabled(30)&&this.Ac.isFeatureEnabled(2);else return!1;else this.aed=!1;return this.aed}yc(b){var h;this.W=b;this.Ac=b.Pa("Box4.IFeatureHelper");this.tV=
this.W.resolve("Box4.Proofing.IProofingFeatureConfiguration");this.tV.SOc=t.AFrameworkApplication.K.$("WordProofingSecondaryContextualMenuIsEnabled")||t.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.WordEditorRightClickSecondaryMenuIsEnabled",!1);(new EI).yc(b);b.ha("Box4.IClipboardCommands",()=>new FI(t.AFrameworkApplication.ya,Fb.a.iUe,Fb.a.Jzc,Fb.a.C1,Fb.a.NKf,Fb.a.paste,Fb.a.b7,Fb.a.Tib)).singleInstance();b.ha("HtmlImport.IHtmlNormalizerSettings",()=>{const r=b.resolve("Common.IAppSettingsManager");
return new wt(!0,r.$("SplitHyperlinkFixWithEnterIsEnabled"))}).singleInstance();b.ha("HtmlImport.IHtmlTranslatorSettings",()=>{const r=b.resolve("Common.IAppSettingsManager"),z=R=>!R.h6b;return new $L.a(r.$("ExternalPasteImprovementsEnabled"),r.$("PasteComplexTablesIsEnabled"),r.$("PasteTableCellMarginImprovementsIsEnabled")||r.getBooleanFeatureGate("Microsoft.Office.WordOnline.ImprovedHtmlTableCellMarginsHandlingIsEnabled",!1),r.$("WordWacQoEListBulletsLevelExternalPasteImprovementIsEnabled"),!0,
void 0,void 0,void 0,void 0,void 0,void 0,!0,void 0,r.$("SupportCloudFontInExternalPasteIsEnabled"),!0,!0,!0,!0,!0,R=>R.h6b,()=>!1,z,z,z,z,void 0,()=>this.Phm,R=>!R.h6b)}).singleInstance();b.ha("WordEditor.Actors.WordEditorPasteStewardBridge",()=>new gK(b.resolve("Box4.IParagraphReader"),b.resolve("Box4.IBlobEditor"),b.resolve("Box4.Actors.IBox4PasteStewardUtils"),b.resolve("Box4.IFormattingPropertyTransitStrategy"))).as("Box4.Actors.IBox4PasteStewardBridge").singleInstance();b.ha("WordEditor.Actors.PastedContentsProcessorPostMergeAfterPaste",
()=>new UJ(b.resolve("Wonca.ExternalContent.IExternalContentEditor"),b.resolve("Box4.IFeatureHelper"))).as("Box4.Actors.IPastedContentsProcessorPostMergeAfterPaste").singleInstance();b.ha("Box4.Clipboard.NoOpEdgeSystemClipboardSelectionEnsureStrategy",()=>new GI).as("Box4.Clipboard.IEdgeSystemClipboardSelectionEnsureStrategy").singleInstance();b.ha("Box4.IIndentationCommands",()=>new HI(t.AFrameworkApplication.ya)).singleInstance();b.ha("Box4.IJustificationCommands",()=>new II(t.AFrameworkApplication.ya)).singleInstance();
b.ha("Box4.ISpacingCommands",()=>new JI(t.AFrameworkApplication.ya)).singleInstance();b.ha("WordEditor.IPageCommands",()=>new QJ(t.AFrameworkApplication.ya)).singleInstance();b.ha("WordEditor.Actors.StylesActor",()=>new bK(t.AFrameworkApplication.ya,b.ef("WordEditor.UI.IDialogFactory"))).singleInstance();(null===(h=t.AFrameworkApplication.K)||void 0===h?0:h.getBooleanFeatureGate("Microsoft.Office.WordOnline.isCustomizeRibbonEnabled",!1))&&b.ha("WordEditor.Actors.CustomizeRibbonActor",()=>new WD(t.AFrameworkApplication.ya)).singleInstance();
b.ha("WordEditor.Actors.DigitalPrintActor",()=>new ZF(t.AFrameworkApplication.ya,b.ef("WordEditor.UI.IDialogFactory"))).singleInstance();b.ha("WordEditor.Actors.FileDownloadManager",()=>new xJ(b.resolve("Common.App.DirectPrint.IDirectPrintManager"),new ZL.a)).singleInstance();b.ha("WordEditor.Actors.FileDownloadActor",()=>new uJ(t.AFrameworkApplication.ya,b.ef("WordEditor.UI.IDialogFactory"),b.resolve("WordEditor.Actors.FileDownloadManager"),t.AFrameworkApplication.K.$("DisablePrint"),t.AFrameworkApplication.K.lb("IrmPolicyDescription"),
b.resolve("WordEditor.IBusinessBarController"))).singleInstance();b.ha("WordEditor.Actors.ParagraphDialogActor",()=>new SJ(t.AFrameworkApplication.ya,b.ef("Box4.UI.IBox4DialogFactory"),b.resolve("WordEditor.LineSpacingHelper"),km.a.instance,b.resolve("Box4.IParagraphIndentationReader"),b.resolve("WordEditor.ClientPagination.IClientPaginationSettings"))).singleInstance();b.ha("WordEditor.Actors.MarginsDialogActor",()=>new OJ(t.AFrameworkApplication.ya,b.ef("WordEditor.UI.IDialogFactory"),km.a.instance)).singleInstance();
b.ha("WordEditor.Actors.ColumnsDialogActor",()=>new nJ(t.AFrameworkApplication.ya,b.ef("WordEditor.UI.IDialogFactory"),km.a.instance)).singleInstance();b.ha("WordEditor.Actors.ModeSwitcherControlActor",()=>new YA.a(b.Za("Common.ISystemInitiatedFeedback"),bM.a.B2b())).as("WordEditor.IModeSwitcherControl").singleInstance();b.ha("WordEditor.Actors.PaperSizeDialogActor",()=>new RJ(t.AFrameworkApplication.ya,b.ef("WordEditor.UI.IDialogFactory"),km.a.instance)).singleInstance();b.ha("WordEditor.Actors.IgnoreAllProofingErrorStrategy",
()=>new IJ(b.resolve("Box4.Proofing.IIgnoreAllKeywords"))).singleInstance();b.register(sJ,"WordEditor.Actors.DoNotCheckThisCritiqueTypeStrategy").singleInstance();b.ha("WordEditor.Actors.ProofingActor",()=>new VJ(t.AFrameworkApplication.ya,Yh.a.instance,Sa.a.instance.resolve("Box4.ISelectionManager"),Xs.a.instance,Sa.a.instance.resolve("Box4.Proofing.IErrorRangeEditor"),Sa.a.instance.resolve("Box4.ILanguageReader"),Sa.a.instance.resolve("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder"),Sa.a.instance.resolve("WordEditor.Actors.IgnoreAllProofingErrorStrategy"),
Sa.a.instance.resolve("WordEditor.Actors.DoNotCheckThisCritiqueTypeStrategy"),this.tV,Sa.a.instance.resolve("Box4.Proofing.IProofingIgnorePersistenceHelper"),t.AFrameworkApplication.K.$("WordEditorProofingIgnoreAll"),Sa.a.instance.resolve("Box4.UI.AugLoopProofingErrorDetailHelper"))).singleInstance();(t.AFrameworkApplication.K.$("DynamicBundlesIsEnabled")?appResourceLoader.loadChunk("editorSettingsManager"):b.resolve("Common.IDynamicScriptLoaderProvider").JE.loadScript("EditorSettingsManager")).then(()=>
{const r=b.resolve("Box4.Proofing.IEditorSettingsManagerActor");r.v1l();r.init();b.ha("Box4.Proofing.EditorSettingsUIActor",()=>new KI(t.AFrameworkApplication.ya,b.resolve("Box4.Proofing.IEditorSettingsManagerActor"),()=>new LI(b.resolve("Box4.Proofing.IEditorSettingsManagerActor"),b.resolve("WordEditor.Ideas.AddInLoader.IAddInLicensingManager")))).singleInstance();t.AFrameworkApplication.K.$("WritingStyleIsEnabled")&&t.AFrameworkApplication.K.$("WordWritingStylesDialogIsEnabled")&&this.W.resolve("Box4.Proofing.EditorSettingsUIActor").Vb()});
b.ha("WordEditor.Actors.PageActor",()=>new PJ(Sa.a.instance.resolve("Box4.IWordSectionEditor"),Sa.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance)).as("WordEditor.IPageCommandStringBuilder").singleInstance();b.ha("WordEditor.Actors.DarkModeActor",()=>new qJ(t.AFrameworkApplication.ya,t.AFrameworkApplication.K,vb.App.Bba,!!vb.App.instance&&vb.App.instance.hCa,!!vb.App.instance&&vb.App.instance.lPc,Sa.a.instance.resolve("Box4.IDarkModeState"),Sa.a.instance.resolve("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder"),
Sa.a.instance.resolve("Box4.DarkModeEventsManager"),!!vb.App.instance&&vb.App.instance.gma)).singleInstance();b.ha("WordEditor.FlatListDetailsProvider",()=>new zJ(b.resolve("WordEditor.IFlatListEditor")));b.ha("WordEditor.Actors.AccessibilityActor",()=>new WI(b.Za("Box4.Accessibility.IAccessibilityContextManager"),b.ef("WordEditor.FlatListDetailsProvider"),b.ef("WordEditor.TrackChange.TrackChangeCpDetailsProvider"),b.ef("WordEditor.TrackChange.TrackChangeStructuralDetailsProvider"))).singleInstance();
b.ha("WordEditor.Actors.AppFrameCommandUIActor",()=>new jJ(t.AFrameworkApplication.ya,b.Za("Postmessage.IHostPostmessenger"))).singleInstance();b.ha("WordEditor.Actors.ImageActor",()=>new Sp(b.resolve("WordEditor.IImageEditor"),b.Za("Box4.IExternalSelectionManager"),b.resolve("WordEditor.Actors.RenderedImageEditOperation.Factory"),b.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,b.resolve("WordEditor.Actors.ISWordRequestManager"),b.resolve("Box4.IUndoManager"),b.resolve("Box4.ISelectionManager"),
b.resolve("Box4.IAppFrame"),t.AFrameworkApplication.K)).as("Box4.Actors.ImageActor").singleInstance();b.ha("WordEditor.Actors.WordFileSaveAsActor",()=>new hK(t.AFrameworkApplication.ya)).singleInstance();b.ha("WordEditor.Actors.RenderedImageEditOperation.Factory",()=>new ZJ(b.resolve("WordEditor.IImageEditor"),t.AFrameworkApplication.K,t.AFrameworkApplication.ua.WLa,Sa.a.instance.resolve("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder"),b.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,
b.resolve("Box4.IUndoManager"),b.resolve("Box4.CatchUpActivity.IChangeIdEditor"),b.resolve("Box4.IFeatureHelper"))).singleInstance();b.ha("WordEditor.Actors.DeleteActor",()=>new rJ.DeleteActor(Sa.a.instance.resolve("WordEditor.ContentControl.IContentControlOperator"),Sa.a.instance.Za("Box4.ContentControlConfigSettings"),Sa.a.instance.Za("Box4.IContentControlEditor"),Sa.a.instance.resolve("Box4.IDynamicRangeEditor"),Sa.a.instance.Za("WordEditor.Bookmark.IBookmarkManager"),Sa.a.instance.resolve("Box4.IHyperlinkEditor"),
Sa.a.instance.resolve("Box4.IHyperlinkStrategy"),Sa.a.instance.resolve("Box4.IParagraphReader"),Sa.a.instance.resolve("Box4.IParagraphIndentationReader"),Sa.a.instance.resolve("Box4.ICharacterPropertiesEditor"),Sa.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance)).singleInstance();this.W.ha("WordEditor.Actors.SWordRequestManager",()=>new dK(b.resolve("Box4.Images.IImageReader"),b.resolve("WordEditor.Actors.RenderedImageEditOperation.Factory"),t.AFrameworkApplication.K)).as("WordEditor.Actors.ISWordRequestManager").singleInstance();
b.ha("WordEditor.Actors.TableCellSelectionStrategy",()=>new eK).as("Box4.ITableCellSelectionStrategy").singleInstance();t.AFrameworkApplication.K.$("WordEditorFormatPainterIsEnabled")&&b.ha("Box4.Actors.FormatPainter",()=>new MI(b.resolve("Box4.Styles.IWACStyleEditor"),b.resolve("Box4.IInsertionPointFormatting"),b.resolve("Box4.IFormattingEditor"),b.resolve("Box4.IParagraphEditor"),b.resolve("Box4.IParagraphReader"),b.resolve("Box4.List.IListEditor"),b.resolve("Box4.List.IListReader"),b.resolve("Box4.ICharacterPropertiesEditor"),
Yh.a.instance,b.resolve("Box4.IFeatureHelper"),b.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,b.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance,b.resolve("Box4.TextFormattingHelper"),b.resolve("Box4.Styles.IWACStyleReader"))).as("Box4.IFormatPainter").singleInstance();b.ha("Box4.Actors.FormatPainterActor",()=>new TB(vb.App.xa,ve.FocusManager.instance(),t.AFrameworkApplication.ya,wc.a.instance,yr.a.instance,b.resolve("Box4.IFormatPainter"),b.resolve("Box4.ISelectionManager"),
!0,b.resolve("Box4.ICssColorProvider"),!!vb.App.instance&&vb.App.instance.gma,b.resolve("Box4.DarkModeEventsManager"))).singleInstance();b.ha("WordEditor.Actors.FormattingActor",()=>new AJ(t.AFrameworkApplication.ya,b.resolve("Box4.List.IListReader"))).singleInstance();b.ha("WordEditor.Actors.UIAutomationActor",()=>new fK(t.AFrameworkApplication.ya)).singleInstance();b.ha("WordEditor.Actors.SaveStatusActor",()=>new aK(t.AFrameworkApplication.ya,b.resolve("Common.App.SaveStatus.ISaveStatusUIHandler"))).singleInstance();
b.ha("Box4.Actors.IEnterViewStrategy",()=>new NI(b.Pa("Box4.IAutoCorrectScheduler"),b.ef("Box4.IUndoManager"),b.Za("Box4.IExternalSelectionManager"))).singleInstance();b.ha("Box4.ISelectAllHandlers",()=>new iA(ne.PageReader.instance,b.ef("Box4.IUndoManager"),b.resolve("Box4.Graph.IGraphTransactionFactory"),t.AFrameworkApplication.K.$("QoETinyWinsSelectAllEnabled"))).singleInstance();b.ha("WordEditor.Actors.ContentControlActor",()=>new oJ(b.resolve("WordEditor.ContentControl.IContentControlManager"),
b.resolve("WordEditor.ContentControl.IGlossaryNavigator"),b.resolve("Box4.IFormattingEditor"),b.resolve("WordEditor.ContentControl.IContentControlChpManager"),b.resolve("WordEditor.ContentControl.IContentControlOperator"),b.resolve("Box4.ICharacterPropertiesEditor"),b.resolve("Box4.Graph.IGraphTransactionFactory"),b.resolve("Box4.Styles.IWACStyleReader"),t.AFrameworkApplication.ya,t.AFrameworkApplication.K.$("WordEditorContentControlCustomizedPlaceholderIsEnabled"),xg.a.instance.J(10))).singleInstance();
b.ha("WordEditor.Actors.AccessibilityHelpDialogActor",()=>new XI(t.AFrameworkApplication.ya,b.ef("WordEditor.UI.IDialogFactory"),ve.FocusManager.instance())).singleInstance();b.ha("Box4.Actors.FontNameFormattingStrategyNoop",()=>new OI).as("Box4.Actors.IFontNameFormattingStrategy").singleInstance();b.ha("WordEditor.GraphicsEditor.GraphicsEditorRequestManager",()=>new OE(t.AFrameworkApplication.Xe,ml.PageNavigator.instance,b.resolve("Box4.ICharacterPropertiesEditor"),b.resolve("Box4.Graph.IGraphTransactionFactory"),
b.resolve("Box4.IParagraphReader"),b.resolve("Box4.IBlobReader"),b.resolve("WordEditor.IImageEditor"),Sa.a.instance.resolve("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder"),t.AFrameworkApplication.K,b.resolve("Box4.IFeatureHelper"))).as("WordEditor.GraphicsEditor.IGraphicsEditorRequestManager").singleInstance();b.ha("WordEditor.Actors.GraphicsEditorActor",()=>new FJ(t.AFrameworkApplication.ya,t.AFrameworkApplication.K,b.resolve("WordEditor.GraphicsEditor.IGraphicsEditorRequestManager"),b.resolve("WordEditor.IImageEditor"),
b.resolve("Box4.CatchUpActivity.IChangeIdEditor"),b.resolve("Box4.IUndoManager"),b.resolve("Box4.ICharacterPropertiesEditor"),b.resolve("Box4.Graph.IGraphTransactionFactory"),b.resolve("Box4.IParagraphReader"),b.resolve("Box4.IBlobReader"),b.resolve("Box4.Images.IImageReader"),t.AFrameworkApplication.Xe,this.Ac,b.resolve("WordEditor.DocumentUnderstanding.RLM.IRoleLifecycleManager"))).singleInstance();b.ha("WordEditor.Actors.RenderParagraphsContainingTabs",()=>new $J).singleInstance();b.ha("WordEditor.Actors.CustomTabActor",
()=>new pJ(t.AFrameworkApplication.ya,b.resolve("WordEditor.ICustomTabStopUtility"),b.resolve("Box4.IOutlineEditor"))).singleInstance();b.ha("WordEditor.Actors.HeadingsActor",()=>new GJ(b.resolve("WordEditor.TableOfContents.StyleBasedDocumentHeadings"),t.AFrameworkApplication.ya,b.resolve("Box4.IParagraphReader"))).singleInstance();b.ha("WordEditor.Actors.BookmarkActor",()=>new mJ(vb.App.xa,t.AFrameworkApplication.ya,di.a.instance,b.resolve("WordEditor.Bookmark.FullBookmarkManager"),new De.a(()=>
vb.App.xa.jb.Yc),this.W.resolve("Box4.Indicator.IIndicatorManager"),this.W.resolve("Box4.Graph.IGraphTransactionFactory"),this.W.resolve("Common.IReactContextualUILauncher"),this.W.resolve("WordEditor.Actors.BookmarkIndicatorActor"),Xs.a.instance,this.W.Za("Common.ISystemInitiatedFeedback"),b.resolve("Box4.IOutlineElementNavigator"),Ya.InteractiveViewManager.instance,this.W.ef("WordEditor.UI.IDialogFactory"),this.W.resolve("Box4.BookmarkParagraphMapping"),Yh.a.instance)).singleInstance();b.ha("WordEditor.Actors.BookmarkIndicatorActor",
()=>{var r,z;return new Cr(b.resolve("Box4.IParagraphReader"),gf.a.instance,sf.a.instance,this.W.resolve("Box4.Highlight.IHighlightManager"),b.resolve("Box4.IInteractiveEventHandler"),null!==(z=null===(r=vb.App.instance)||void 0===r?void 0:r.JA)&&void 0!==z?z:!1)}).singleInstance();b.ha("Box4.Actors.IIFrameFocusStrategy",()=>new HJ).singleInstance();b.ha("WordEditor.Actors.ExternalContentFloatiePositionProvider",()=>new XB(di.a.instance,b.resolve("Box4.ITextMetricsAdapter"),Ya.InteractiveViewManager.instance,
Ed.a.getElementBounds,b.resolve("Box4.UI.ExternalContentFloatieManager"))).singleInstance();b.ha("WordEditor.Actors.ExternalContentActor",()=>new Er(t.AFrameworkApplication.ya,b.resolve("Box4.IUndoManager"),t.AFrameworkApplication.K,b.resolve("Wonca.ExternalContent.IExternalContentEditor"),t.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ActionManagerRemovedExternalContentFloatie",!1))).as("WordEditor.Actors.ExternalContentActor").singleInstance();b.ha("Box4.UI.ExternalContentFloatieManager",
()=>new VI).as("Box4.UI.IFloatieManager").singleInstance();b.ha("WordEditor.Actors.ActionHangDetector",()=>new YI(t.AFrameworkApplication.K,t.AFrameworkApplication.ya)).as("WordEditor.Actors.ActionHangDetector").singleInstance();b.ha("WordEditor.Actors.ExternalContentFloatieEventManager",()=>new WB(b.resolve("Box4.UI.ExternalContentFloatieManager"),b.resolve("Box4.IExternalContentFloatieEventSource"),Ya.InteractiveViewManager.instance,Xt.a.instance(),t.AFrameworkApplication.ua,b.resolve("WordEditor.Actors.ExternalContentFloatiePositionProvider"),
b.resolve("Common.IAppSettingsManager"),b.resolve("Box4.Actors.PasteFloatieFeatureSetBuilder"),vb.App.Xj.al.Se(12),b.resolve("Box4.Graph.IGraphTransactionManager"),b.resolve("Common.IReactContextualUILauncher"),t.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ActionManagerRemovedExternalContentFloatie",!1))).singleInstance();b.ha("Box4.Actors.WordIndentationActorExtension",()=>new iK).as("Box4.Actors.IIndentationActorExtension").singleInstance();t.AFrameworkApplication.K.$("SharedUXThemingIsEnabled")&&
(t.AFrameworkApplication.Hl("Microsoft.Office.Web.SessionSettings.IWacWordModernUxExperimentOneSettings"),t.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ModernUxExperimentOne",!1)&&b.ha("WordEditor.Actors.ModernUxActor",()=>new cG(t.AFrameworkApplication.ya)).singleInstance());t.AFrameworkApplication.K.$("WordConsumptionViewToEditRedirectIsEnabled")&&b.ha("WordEditor.Actors.SwitchToClassicViewModeActor",()=>new ZE(t.AFrameworkApplication.ya)).singleInstance();(new BI).yc(b);
b.ha("WordEditor.OnlineMedia.OnlineMediaDialogFactory",()=>new UI(b.resolve("Box4.Media.IInsertMediaCrossDocumentMessengerFactory"),b.resolve("Box4.Media.InsertMediaHelper"))).as("WordEditor.OnlineMedia.OnlineMediaDialogFactory").singleInstance();b.ha("WordEditor.OnlineMedia.InsertHubbleMediaHelper",()=>new RI(t.AFrameworkApplication.ya,b.resolve("Box4.Media.InsertMediaHelper"))).singleInstance();b.ha("WordEditor.OnlineMedia.OnlineMediaActor",()=>new SI(t.AFrameworkApplication.ya,t.AFrameworkApplication.K,
b.resolve("WordEditor.OnlineMedia.OnlineMediaDialogFactory"),b.resolve("WordEditor.OnlineMedia.InsertHubbleMediaHelper"),b.resolve("Wonca.ExternalContent.IExternalContentEditor"),Yh.a.instance)).singleInstance();this.mxj=new PI;this.J4=this.W.resolve("Box4.Highlight.IHighlightManager")}static main(){O.a.instance.Oc(new hG)}}Object(n.a)(hG,"WordEditorActorsPackage",null,[1,2]);class jK{constructor(b){this.Kpc=!1;this.Dxi=()=>{this.Kpc=!0;this.Rs.PSf(this.Dxi)};this.Rs=b;this.Rs.jXb(this.Dxi)}}Object(n.a)(jK,
"GraphFullyConnectedGetter",null,[301]);class bg{constructor(){this.KOg=Object.assign(new kl.a,{})}Z1j(b,h){let r;const z=b&1023;({value:r}=this.KOg.Dc(z,0)).returnValue||bg.pQl().contains(z)||v.ULS.sendTraceTag(50942149,338,15,"Culture is not supported. LCID {0}; Key: {1}",b,z);r+=h;this.KOg.Z(z,r);return r}static pQl(){bg.$md||(bg.$md=new Ka.a,bg.pc(0),bg.pc(1),bg.pc(2),bg.pc(3),bg.pc(4),bg.pc(5),bg.pc(6),bg.pc(7),bg.pc(8),bg.pc(9),bg.pc(10),bg.pc(11),bg.pc(12),bg.pc(13),bg.pc(14),bg.pc(15),bg.pc(16),
bg.pc(17),bg.pc(18),bg.pc(19),bg.pc(20),bg.pc(21),bg.pc(22),bg.pc(23),bg.pc(24),bg.pc(25),bg.pc(26),bg.pc(27),bg.pc(28),bg.pc(29),bg.pc(30),bg.pc(31),bg.pc(32),bg.pc(33),bg.pc(34),bg.pc(35),bg.pc(36),bg.pc(37),bg.pc(38),bg.pc(39),bg.pc(40),bg.pc(41),bg.pc(42),bg.pc(43),bg.pc(44),bg.pc(45),bg.pc(46),bg.pc(47),bg.pc(48),bg.pc(49),bg.pc(50),bg.pc(51),bg.pc(52),bg.pc(53),bg.pc(54),bg.pc(55),bg.pc(56),bg.pc(57),bg.pc(58),bg.pc(59),bg.pc(60),bg.pc(61),bg.pc(62),bg.pc(63),bg.pc(64),bg.pc(65),bg.pc(66),bg.pc(67),
bg.pc(68),bg.pc(69),bg.pc(70),bg.pc(71),bg.pc(72),bg.pc(73),bg.pc(74),bg.pc(75),bg.pc(76),bg.pc(77),bg.pc(78),bg.pc(79),bg.pc(80),bg.pc(81),bg.pc(82),bg.pc(83),bg.pc(84),bg.pc(85),bg.pc(86),bg.pc(87),bg.pc(88),bg.pc(89),bg.pc(90),bg.pc(91),bg.pc(92),bg.pc(93),bg.pc(94),bg.pc(95),bg.pc(96),bg.pc(97),bg.pc(98),bg.pc(99),bg.pc(100),bg.pc(101),bg.pc(102),bg.pc(103),bg.pc(104),bg.pc(105),bg.pc(106),bg.pc(107),bg.pc(108),bg.pc(109),bg.pc(110),bg.pc(111),bg.pc(112),bg.pc(113),bg.pc(114),bg.pc(115),bg.pc(116),
bg.pc(117),bg.pc(118),bg.pc(119),bg.pc(120),bg.pc(121),bg.pc(122),bg.pc(124),bg.pc(126),bg.pc(127),bg.pc(128),bg.pc(129),bg.pc(130),bg.pc(131),bg.pc(132),bg.pc(133),bg.pc(134),bg.pc(135),bg.pc(136),bg.pc(140),bg.pc(145),bg.pc(146),bg.pc(147));return bg.$md}static pc(b){bg.$md.add(b&1023)}}bg.$md=null;Object(n.a)(bg,"LanguagePerParagraphModel",null,[]);class kK{constructor(){this.c0f=!1;this.rud=this.qud=this.RMb=0;this.Iii=!0;this.Ruo=0}}Object(n.a)(kK,"UpdateWordCountStateResult",null,[]);class lK extends Sys.EventArgs{constructor(b){super();
this.isEnabled=b}}Object(n.a)(lK,"WordCountAvailabilityChangedEventArg",Sys.EventArgs,[]);class mK{constructor(){this.plh=this.olh=this.wordCount=-1;this.Cyb=this.Wgh=0;this.Byb=1;this.oDi=1033}}Object(n.a)(mK,"WordCountCache",null,[]);class nK extends Sys.EventArgs{constructor(b){super();this.state=b}}Object(n.a)(nK,"WordCountChangedEventArg",Sys.EventArgs,[]);class oK{constructor(){this.bic=this.tza=0}}Object(n.a)(oK,"CharsCountResult",null,[]);class pK{constructor(){this.cp=0;this.dic=null;this.D5=
this.E5=0}}Object(n.a)(pK,"TextChunkResult",null,[]);class qK{constructor(){this.Ulj=this.E5=this.D5=this.wordCount=0}}Object(n.a)(qK,"WordCountStateForParagraph",null,[]);class iG{constructor(){this.moa=this.iQ=this.E5=this.D5=this.f_=this.wordCount=0;this.currentNode=null;this.oW=-1;this.cp=0;this.cLf=[];this.Byb=this.Cyb=this.MVa=this.YKf=this.ZKf=0;this.wH=this.bdi=!1;this.Lmb=new Ua.a;this.U_a=new Ua.a}}Object(n.a)(iG,"WordCountState",null,[]);class Tp{constructor(b,h,r,z,R,ba){this.D1n=1E3;
this.sa=new Te.a;this.Dub=null;this.Vge=0;this.hEj="\ue000";this.xmc=!1;this.jme=this.Zle=this.s9c=0;this.hAg=this.pAg=null;this.Vle=this.Ule=this.dme=0;this.iB=h;this.sCj=new RegExp(dd.AParagraphNode.BB,"g");this.hd=b;this.taskManager=z;this.jn=r;this.aVa=ba;this.ASa=R.$("WordEditorWordCountPackageImageAndTableCountIsEnabled");this.LTj=R.$("WordEditorWordCountPackageSelectionAdditionalCountsIsEnabled");this.xRi()}get Inm(){return!!this.Dub}get uKa(){return this.xmc}set uKa(b){this.xmc=b}get kqd(){return this.Vge}set kqd(b){this.Vge=
b}get UMa(){return!this.Vge}get RC(){return this.s9c}get Hxb(){return this.Zle}get Mxb(){return this.jme}get PPk(){return this.pAg}get C1e(){return this.hAg}get hDc(){return this.dme}get fDc(){return this.Ule}get z_b(){return this.Vle}jXb(b){this.sa.addHandler(Tp.eee,b)}PSf(b){this.sa.removeHandler(Tp.eee,b)}CPe(b){this.sa.addHandler(Tp.aag,b)}ssn(b){this.sa.removeHandler(Tp.aag,b)}dzd(){this.czd();this.xRi()}xRi(){this.dme=this.Vle=this.Ule=this.jme=this.Zle=this.s9c=-1}Q2e(){this.a$d(this.D1n)}n1c(){const b=
new iG;b.bdi=!0;this.czd();this.d5e(b)}a$d(b,h=null){this.UMa&&(this.Inm&&(h=null,this.czd()),h||(h=new iG),b=new Ic.a(3,1,b,Object(u.a)(this,this.fZk,"doWordCountTask"),this.I$i),b.customData=h,this.j6j(b))}czd(){this.Dub&&(this.taskManager.We(this.Dub),this.Dub=null)}gjj(b,h,r,z,R,ba=!0,ta=-1,Wa=-1,ub=-1,Ib=1033){const $b=new kK;$b.RMb=r;$b.qud=R;$b.rud=z;if(!b.cp&&h.S4c&&ba&&!this.NXh(h))return Tp.bno(b,h.S4c),$b.Iii=!0,$b;z=0<=Wa&&0<=ub?{Ed:Wa,endCp:ub}:void 0;r=this.chl(h,z);z&&(Wa=z.Ed,ub=z.endCp);
r=0<=ub?r.substring(0,ub):r;ub=0<=Wa&&0<=ub?r.substring(Wa,ub):r;z=b.cp>=Wa?b.cp:Wa;R=b.cLf||[];ba=0<b.ZKf?b.ZKf:0;let fc=0<b.YKf?b.YKf:0,Kc=[];b.wH=!1;do{this.aVa.update();if(!b.bdi&&($b.RMb+Kc.length/2>Tp.$ro||this.aVa.Hhb())){let ge;R=(ge=R).concat.apply(ge,Kc);b.cp=z;b.cLf=R;b.YKf=fc;b.ZKf=ba;b.oW=ta;b.currentNode=h;this.a$d(Tp.qvo,b);$b.c0f=!0;b.wH=!0;return $b}if((!z||z===Wa)&&0<r.length&&z<r.length){R.push(tn.a.instance.Eif(r,z));var ed=this.NXh(h);if(0<=ta&&!z&&ed){b.wordCount+=1;$b.RMb+=
1;const ge=this.hd.VN(ed);ed=this.iB.m$b(ge,ed);ed=Tp.hxd(ed);b.E5+=ed.tza+1;b.D5+=ed.tza-ed.bic}}ed=this.d1h(r,z,Tp.vvk);z=ed.cp;let Jd;Kc=(Jd=Kc).concat.apply(Jd,ed.dic);ba+=ed.E5;fc+=ed.D5}while(-1!==z);b=this.f0j(b,R,Kc,r,ub,$b.RMb,$b.qud,$b.rud,h,-1===ta,Ib);$b.RMb=b.wordCount;$b.qud=b.D5;$b.rud=b.E5;$b.Ruo=b.Ulj;return $b}QAh(b,h){const r=ie.ParagraphReader.textLength(h,5);if(r){h=Md.e(h);var z=0;for(let R=0;R<h.length;R++)if(this.Yeb&&5===h[R].si&&b.iQ++,Tp.jSn(h[R])){z++;break}h.length!==
r?b.f_++:b.f_+=z}}y2i(b){this.kqd=this.ISn(b.MVa,b.wordCount)?1:0;return!!this.kqd}hBi(b){this.s9c=b.wordCount;this.Zle=b.iQ;this.jme=b.moa;this.Vle=b.E5;this.Ule=b.D5;this.dme=b.f_;this.pAg=b.Lmb;this.hAg=b.U_a;this.IJi(b)}IJi(b){this.sa.raiseEvent(Tp.eee,new nK(b))}HJi(){this.sa.raiseEvent(Tp.aag,new lK(!1))}ISn(b,h){if(X.a.Ak||X.a.Ys||X.a.gH)return!1;(h/=2)||(h=1);return(h?b/h:0)>Tp.yFm?!0:!1}get Yeb(){const b=!this.azf||1===this.azf&&this.LTj;return this.ASa&&b}zUh(b,h){let r=1033,z=0;b=h.$ef(b);
h=new bg;for(let R=0;R<b.length;R++){const ba=h.Z1j(b[R].lcid,b[R].end-b[R].begin);z<ba&&(z=ba,r=b[R].lcid)}return r}fZk(b){this.Dub=null;this.d5e(b.customData)}f0j(b,h,r,z,R,ba,ta,Wa,ub,Ib,$b){var fc;h=(fc=h).concat.apply(fc,r);r=tn.a.instance.e1h(h,z);b.wordCount+=r.wordCount;const Kc=Tp.hxd(R);R=Kc.tza-Kc.bic;fc=Kc.tza;b.D5+=R;b.E5+=fc;ba+=r.wordCount;ta+=Kc.tza-Kc.bic;Wa+=Kc.tza;b.MVa+=r.MVa;({L_k:h,l$n:z}=Tp.e0j(h,z));b.Cyb+=h;b.Byb+=z;b.U_a.add($b);b.Lmb.add(r.wordCount);Ib&&Tp.Dok(fc,R,ub,
r,h,z,$b);b.cp=0;b.cLf=[];b=new qK;b.D5=ta;b.E5=Wa;b.wordCount=ba;b.Ulj=r.wordCount;return b}chl(b,h){let r=this.bun(b);r=ie.ParagraphReader.ezb(b,5,r,h);return this.qpn(r)}bun(b){var h=ie.ParagraphReader.text(b);b=Md.e(b);if(0<b.length){h=h.split("");for(let z=0;z<b.length;++z){let R=!0;var r=!0;const ba=b[z];if(1===ba.si)r=ba,r=22!==r.kind&&2!==r.kind;else if(5===ba.si)R=!1;else if(7===ba.si||10===ba.si)h[ba.Ob.cp]=this.hEj,R=!1;if(R){if(ba.Ob.cp>=h.length)return"";h[ba.Ob.cp]=r?" ":"C"}}h=h.join("")}return h}qpn(b){return b.replace(this.sCj,
"")}d1h(b,h,r){const z=b.length-h<=r;var R=z?b.length:h+r;const ba=new pK;if(R<h)return ba.cp=-1,ba;ba.dic=tn.a.instance.Mbf(b,h,R);R=Tp.hxd(b.substr(h,R));ba.E5=R.tza;ba.D5=R.tza-R.bic;if(!ba.dic.length&&!z)return r===b.length-h?ba:this.d1h(b,h,b.length-h);ba.cp=z||!ba.dic.length?-1:ba.dic[ba.dic.length-1].cp;return ba}j6j(b){this.Dub=b;this.taskManager.$b(this.Dub)}NXh(b){if(b=b.kW){const h=this.hd.VN(b);if(h&&h.sr)return b}return null}static jSn(b){return 11===b.si}static bno(b,h){b.wordCount+=
h.wordCount;b.D5+=h.olh;b.E5+=h.plh;b.MVa+=h.Wgh;b.Cyb+=h.Cyb;b.Byb+=h.Byb;b.U_a.add(h.oDi);b.Lmb.add(h.wordCount)}static Dok(b,h,r,z,R,ba,ta){const Wa=new mK;Wa.wordCount=z.wordCount;Wa.plh=b;Wa.olh=h;Wa.Wgh=z.MVa;Wa.Cyb=R;Wa.Byb=ba;Wa.oDi=ta;r.S4c=Wa}static hxd(b){const h=b.length,r=new oK;for(let R=0;R<h;R++){var z=b.charCodeAt(R);r.tza++;if(55296<=z&&56319>=z&&(z=R+1<h?b.charCodeAt(R+1):0,56320<=z&&57343>=z)){R++;continue}B.a.daa(b.charAt(R))&&r.bic++}return r}static e0j(b,h){let r=0,z=0;for(let R=
0;R<b.length;++R){const ba=b[R],ta=ba.GK;(3===ta||2===ta)&&ba.cp<h.length&&(++r,B.a.q6b(h.charCodeAt(ba.cp))&&++z)}return{L_k:z,l$n:r}}}Tp.eee="wctek";Tp.aag="wcac";Tp.qvo=1;Tp.vvk=400;Tp.$ro=90;Tp.yFm=.1;Object(n.a)(Tp,"WordCountManagerBase",null,[322]);class rK extends Tp{constructor(b,h,r,z,R,ba,ta,Wa,ub,Ib,$b){super(b,h,r,R,ub,Ib);this.SJh=this.qnd=this.Zia=null;this.Vma=()=>{this.Q2e()};this.ib=z;this.ld=ta;this.s2g=Wa;this.LH=$b;this.ib.oB(this.Vma);this.kve=ub.$("ReadingTimeIsEnabled")}get I$i(){return 66}a4l(){if(this.Zia)return!0;
if(!this.ib||!this.ib.hb)return this.ld&&(vb.App.PNd||t.AFrameworkApplication.Mk?this.ld.Zb("SelectionWordCountSelectionNullWhenAppExiting",{["Reason"]:"SelectionWordCount triggerred when app is exiting"}):this.ld.Zb("SelectionWordCountSelectionNullWhenAppAlive")),!1;const b=this.ib.hb.clone();this.Zia=b.BN(!0);if(!this.Zia||!this.Zia.Vy())return this.czd(),!1;this.s2g&&(this.qnd=this.s2g.create(h=>b.BN(h),this.jn));this.Zia.moveNext();return!0}get azf(){return 1}KEk(b){return b===kc.a.Gd||b===kc.a.paragraph?
!0:this.Yeb&&(b===kc.a.ozb||b===kc.a.image||b===kc.a.anchoredObject)}d5e(b){this.aVa.reset();if(this.a4l()){for(this.Yeb&&this.qnd&&(this.qnd.aZk(b,this.aVa)||this.a$d(1,b));this.Zia.current;){const z=-1===b.oW?0:b.oW;let R=0;var h=this.Zia.current;if(!this.KEk(h.contextId)){this.Zia.moveNext();continue}if(this.Yeb&&$d.ImageReader.Gfb(h)){b.iQ++;this.Zia.moveNext();continue}if(!ie.ParagraphReader.nc(h.node)){this.Zia.moveNext();continue}const ba=h.node;if(this.uKa&&this.SJh&&this.SJh.O2b(ba))this.Zia.moveNext();
else{if(this.Yeb&&h.Rd){var r=Nd.GraphIterator.$a(ba);for(r.Rb(6);!r.qr;)$d.ImageReader.ww(r.currentNode)&&b.iQ++,r.Wi(6)}r=this.kve?this.zUh(ba,this.LH):1033;h=this.gjj(b,ba,0,0,0,this.LOd(h),z,h.cpBegin,h.cpEnd,r);if(h.Iii&&(R+=1,100<R)){b.oW=z+1;this.a$d(1,b);return}if(h.c0f)return;this.QAh(b,ba);this.Zia.moveNext()}}this.qnd=this.Zia=null;this.y2i(b)?(this.s9c=-1,this.HJi()):this.hBi(b)}}LOd(b){let h=!1;b.contextId===kc.a.paragraph?h=!0:b.contextId===kc.a.Gd&&(h=b.cpEnd-b.cpBegin===b.node.characterData.length);
return h}}Object(n.a)(rK,"SelectionWordCountManager",Tp,[]);class $E{constructor(b,h){this.rRb=!1;this.Otb=null;b&&h&&(this.vVb=b(!1),this.Xc=h,this.vVb.moveNext())}aZk(b,h){if(!b||!this.vVb||!this.vVb.current)return!0;do{const r=this.vVb.current;if(r.contextId===kc.a.tableRow||r.contextId===kc.a.tableCell){for(this.Otb||this.i4l(r.node);this.Otb.moveNext();)if(14===this.Otb.currentNode.type&&b.moa++,h.update(),h.Hhb())return!1;this.dHk(r,b);this.Otb=null}this.vVb.moveNext()}while(this.vVb.current);
return!0}dHk(b,h){const r=this.Xc.fg(b.node);r.Bb(14);b.contextId===kc.a.tableRow&&(Jm.a.Pci(r)&&(this.rRb=!0),Jm.a.lPd(r)&&this.rRb&&(this.rRb=!1,h.moa++));b.contextId===kc.a.tableCell&&(Gi.TableCellReader.LNc(r)&&(this.rRb=!0),Gi.TableCellReader.zMa(r)&&this.rRb&&(this.rRb=!1,h.moa++))}i4l(b){this.Otb=Cn.a.Wp(b);14===b.type?this.Otb.Um($E.ZFc,b):this.Otb.Um($E.ZFc,null)}static ZFc(b){return b.parentNode?!0:!1}}Object(n.a)($E,"TableCountSelectionTraverser",null,[323]);class sK{constructor(b){this.ASa=
b.$("WordEditorWordCountPackageImageAndTableCountIsEnabled")}create(b,h){return this.ASa?new $E(b,h):null}}Object(n.a)(sK,"TableCountSelectionTraverserFactory",null,[300]);class tK extends Tp{constructor(b,h,r,z,R,ba,ta,Wa,ub,Ib,$b){super(b,h,r,R,ub,Ib);this.bso=fc=>{if(fc.qr)return!0;fc=fc.role;return 1===fc||2===fc||this.Yeb&&6===fc||3===fc||4===fc||5===fc||!this.uKa&&(7===fc||8===fc)};this.ga=z;this.JPj=ba;this.uYj=ta;this.Ozg=Wa;this.LH=$b;this.ga.gb(Oa.a.Slj,kc.a.application,$c.ActionManager.Nf,
64);this.ga.gb(Oa.a.Tlj,kc.a.application,$c.ActionManager.Nf,64);this.kve=ub.$("ReadingTimeIsEnabled")}get I$i(){return 63}get azf(){return 0}d5e(b){var h,r;this.aVa.reset();b.wH=!1;var z=this.JPj();ne.PageReader.instance.ggb(z)||(this.dzd(),this.HJi());z=this.jn.WAa(z,7,7).currentNode;var R=this.HKk(b.currentNode,z);z=this.uYj(R,z);z.Um(this.bso,null);let ba=R=0;for(var ta=0;z.moveNext();)if(z.currentNode&&this.hd.V$(z.currentNode)){var Wa=this.hd.VN(z.currentNode);if(Wa.sr){var ub=this.hd.yYa(z.currentNode);
if(ub&&(ub=ub.qa.last,(null===ub||void 0===ub?0:ub.Xh)&&(ja.App.f3a&&ub.ei||Nr.a.tWa&&(null===(r=null===(h=ub.formatting)||void 0===h?void 0:h.cache)||void 0===r?0:r.$Db))))continue;b.wordCount+=1;if(Wa=this.iB.m$b(Wa,z.currentNode))Wa=Tp.hxd(Wa),b.E5+=Wa.tza+1,b.D5+=Wa.tza-Wa.bic;R+=1;ba+=b.E5;ta+=b.D5}}else if(this.Yeb&&z.currentNode&&$d.ImageReader.ww(z.currentNode))b.iQ++;else if(this.Yeb&&z.currentNode&&Ii.TableReader.fX(z.currentNode))b.moa++;else if(z.currentNode&&ie.ParagraphReader.nc(z.currentNode)){Wa=
z.currentNode;ub=this.kve?this.zUh(Wa,this.LH):1033;ta=this.gjj(b,Wa,R,ba,ta,!0,-1,-1,-1,ub);if(ta.c0f){b.wH=!0;t.AFrameworkApplication.Hl("Microsoft.Office.Web.SessionSettings.IWacWordWordEditorWordCountPackageImageAndTableCountSettings");return}this.QAh(b,Wa);R=ta.RMb;ba=ta.rud;ta=ta.qud}this.y2i(b)?(this.dzd(),this.Wun(),this.IJi(b)):this.hBi(b)}HKk(b,h){b?(b=this.Ozg(b),b.Bb(7)):b=this.Ozg(h);return b}Wun(){switch(this.kqd){case 1:this.ga.processAction(Oa.a.Slj,2);break;case 2:this.ga.processAction(Oa.a.Tlj,
2)}}}Object(n.a)(tK,"TotalWordCountManager",Tp,[]);class uK{constructor(){this.yWi=this.xWi=this.CWf=this.zWi=this.Ibj=this.Jbj=this.Gbj=this.Hbj=0}get Nui(){return this.c3b(this.zWi,this.Jbj,"WC")}get hNm(){return this.c3b(this.xWi,this.Gbj,"NumCharsNoSp")}get iNm(){return this.c3b(this.CWf,this.Hbj,"NumCharsWithSp")}get nNm(){return this.c3b(this.yWi,this.Ibj,"NumParagraphs")}c3b(b,h,r){const z=this.z4c(h,r).toLocaleString();return 0<this.CWf?(b=this.f$f(b,h,r),String.format(WordEditorIntl.WordEditorStrings.L_DocStatsDialogCountString,
b.toLocaleString(),z)):z}f$f(b,h,r){b=this.z4c(b,r);return b>h?(v.ULS.sendTraceTag(22397767,338,15,"Sel>Total for {0}",r),h):b}z4c(b,h){0>b&&v.ULS.sendTraceTag(22397768,338,15,"{0}<0",h);return Math.max(b,0)}}Object(n.a)(uK,"DocumentStats",null,[]);class aF{static G_e(b){return Wc.a.Px(aF.sl,WordEditorIntl.WordEditorStrings.L_DocStatsDialogWordsCount,b.Nui,WordEditorIntl.WordEditorStrings.L_DocStatsDialogCharsNoSpacesCount,b.hNm,WordEditorIntl.WordEditorStrings.L_DocStatsDialogCharsWithSpacesCount,
b.iNm,WordEditorIntl.WordEditorStrings.L_DocStatsDialogParagraphsCount,b.nNm)}}aF.sl="<table id='DocumentStatsTable' cellpadding=5 cellspacing=5 role='presentation' width='100%'> <tr role='presentation'> <td> <span id='WordCount' class='WACDialogSpan'>{0}</span> </td> <td style='text-align:right'> <span id='WordCountResult' class='WACDialogSpan'>{1}</span> </td> </tr> <tr role='presentation'> <td> <span id='CharNoSpacesCount' class='WACDialogSpan'>{2}</span> </td> <td style='text-align:right'> <span id='CharNoSpacesCountResult' class='WACDialogSpan'>{3}</span> </td> </tr> <tr role='presentation'> <td> <span id='CharWithSpacesCount' class='WACDialogSpan'>{4}</span> </td> <td style='text-align:right'> <span id='CharWithSpacesCountResult' class='WACDialogSpan'>{5}</span> </td> </tr> <tr role='presentation'> <td> <span id='ParagraphCount' class='WACDialogSpan'>{6}</span> </td> <td style='text-align:right'> <span id='ParagraphCountResult' class='WACDialogSpan'>{7}</span> </td> </tr> </table>";
Object(n.a)(aF,"DocumentStatsDialogHtml",null,[]);class vK extends Wc.a{constructor(b){super();this.LK=!1;this.FZk=()=>{};this.Dx=b}UWn(){this.kg="DocumentStatsDialog";this.vg=aF.G_e(this.Dx);this.Fd=0;this.showDialog(WordEditorIntl.WordEditorStrings.L_DocStatsDialogTitle,this.FZk);this.u3("DocumentStatsTable")}cU(){}dispose(){this.LK||(super.dispose(),this.LK=!0)}}Object(n.a)(vK,"DocumentStatsDialog",Wc.a,[]);class wK{constructor(b,h,r,z,R,ba,ta,Wa,ub){this.B1g=this.ooc=this.xmc=this.qRb=this.qwe=
!1;this.gac=()=>{this.jde()};this.Yma=()=>{this.jde()};this.YOn=()=>{this.B1g=!0;return 32};this.vPf=()=>this.Rs.UMa?32:8;this.JWc=(Ib,$b,fc,Kc,ed)=>{if(1===fc)return this.Rs.UMa?32:8;ed[Yf.a.On]=this.Duf;return 32};this.Yae=(Ib,$b,fc)=>{if(1===fc)return this.Rs.UMa?32:8;this.Duf?this.PWk():this.B1k();vb.App.xa.hG({ShowWordCount:"CheckboxModel"});return 32};this.$ec=(Ib,$b,fc)=>{if(1===fc)return ze.a.gfa($b)?8:this.Rs.UMa?32:8;if(this.B1g)return t.AFrameworkApplication.ya.processAction(Oa.a.YYd,2),
32;Ib=this.le.hg("UserAction","Show Word Count Dialog");Ib.start();this.Rs.n1c();this.hP.n1c();this.Rs.RC!==this.hP.RC?v.ULS.sendTraceTag(23188303,338,50,"Open Word Count Dialog with content selected"):v.ULS.sendTraceTag(523072473,338,50,"Open Word Count Dialog without content selected");$b=this.hJk();(new vK($b)).UWn();Ib.stop();return 32};this.WVc=(Ib,$b,fc,Kc,ed)=>{ed||v.ULS.sendTraceTag(23652428,338,10,String.format("{0}","actionData is null"));if(1===fc)return 32;if(!this.Rs.UMa)return ed[Ik.a.Visible]=
!1,32;ed[Ik.a.Visible]=!0;this.Duf?(Ib=this.Rs.RC,0>Ib?Ib=WordEditorIntl.WordEditorStrings.l_WordCountCalculating:Ib?($b=this.hP?this.hP.RC:-1,Ib=0<$b?this.FIl(Ib,$b):String.format(1===Ib?WordEditorIntl.WordEditorStrings.l_WordCountResultSingularAccurate:WordEditorIntl.WordEditorStrings.l_WordCountResultAccurate,this.r5d(Ib))):Ib=String.format(WordEditorIntl.WordEditorStrings.l_WordCountResultExact,this.r5d(Ib))):Ib=WordEditorIntl.WordEditorStrings.l_WordCountHidden;ed[Ik.a.LabelText]=Ib;return 32};
this.Ble=ta;this.Cle=ba;this.Rs=b;this.hP=h;this.cwc=r;this.oWj=R;this.hP.CPe(this.gac);this.Rs.CPe(this.gac);this.hP.jXb(this.Yma);this.Rs.jXb(this.Yma);this.le=Wa;this.uKa=z;this.ASa=ub.$("WordEditorWordCountPackageImageAndTableCountIsEnabled")}get D2e(){return!X.a.z2}Vb(){const b=t.AFrameworkApplication.ya;b.pa(Oa.a.Yae,kc.a.application,this.Yae);b.pa(Oa.a.$ec,kc.a.view,this.$ec);b.gb(Oa.a.JWc,kc.a.application,this.JWc,96);b.gb(Oa.a.WVc,kc.a.application,this.WVc,96);b.gb(Oa.a.vPf,kc.a.application,
this.vPf,96);b.pa(Oa.a.iDh,kc.a.application,this.YOn)}get uKa(){return this.xmc}set uKa(b){this.xmc=b;this.Rs.uKa=b;this.hP.uKa=b}B1k(){this.Rs.UMa&&(this.l1i(!0),this.jde(),this.Rs.n1c())}hJk(){const b=new uK;b.Jbj=this.Rs.RC;b.Hbj=this.Rs.z_b;b.Gbj=this.Rs.fDc;b.Ibj=this.Rs.hDc;b.zWi=this.hP.RC;b.xWi=this.hP.fDc;b.CWf=this.hP.z_b;b.yWi=this.hP.hDc;return b}Sql(){return this.Ble("WACWordCountEnabled",this.D2e)}B6d(b){this.Cle("WACWordCountEnabled",b?"true":"false",Ga.a.zNa)}get Duf(){this.qRb||(this.qwe=
this.Sql(),this.qRb=!0);return this.qwe}l1i(b){this.B6d(b);this.qwe=b;this.qRb=!0}PWk(){this.Rs.dzd();this.hP.dzd();this.l1i(!1);this.jde()}get $I(){return null!=this.vqg?this.vqg:this.vqg=(()=>this.cwc())()}jde(){this.ooc||(v.ULS.sendTraceTag(23188304,338,50,"Word count document stats: {0}",this.LOk()),this.ooc=!0);this.$I&&this.$I.MQ(this.oWj)}LOk(){const b={["words"]:this.Rs.RC,["charsWithSpaces"]:this.Rs.z_b,["charsWithNoSpaces"]:this.Rs.fDc,["paragraphs"]:this.Rs.hDc};this.ASa&&(b.images=this.Rs.Hxb,
b.tables=this.Rs.Mxb);return b}r5d(b){try{return b.toLocaleString()}catch(h){v.ULS.sendTraceTag(23652430,338,10,String.format("Error converting count to locale string, error: {1}, stacktrace: {2}",h.toString(),h.stack))}return b.toString()}FIl(b,h){h>b&&(v.ULS.sendTraceTag(23652432,338,10,String.format("Selection word count is greater than total word count.")),h=b);return String.format(WordEditorIntl.WordEditorStrings.l_WordCountResultOnSelectionAccurate,this.r5d(h),this.r5d(b))}}Object(n.a)(wK,"WordCountActor",
null,[]);class xK extends Rr.a{constructor(b,h,r,z){super();this.Y2=(R,ba)=>{if(ba.property===We.a.lo||ba.property===We.a.un)R=ba.node,ba=ja.App.fm.jb.Ic,ba.Qr&&ba.rd&&ba.rd.Lc&&R.Lc&&R.Lc.id===ba.rd.Lc.id&&this.sEh(R)};this.Syi=(R,ba)=>{this.sEh(ba.node)};this.KUm=(R,ba)=>{ba.property!==od.a.Nv&&ba.property!==yc.a.Ur||this.tX()};this.hXd=()=>{this.tX()};this.fV=b;this.Rs=h;this.Po=r;this.ASa=z.$("WordEditorWordCountPackageImageAndTableCountIsEnabled")}Xy(){var b=this.Po.Se(12);b.lp(this.Y2);b.ys(this.Syi);
b.zv(this.Syi);b=this.Po.Se(22);b.lp(this.KUm);b.ys(this.hXd);b.zv(this.hXd);this.ASa&&this.hmn();this.fV.Rna(this,7)}hmn(){var b=[19,14];for(let h of b)b=this.Po.Se(h),b.ys(this.hXd),b.zv(this.hXd)}get index(){return 1}run(){this.Rs.Q2e()}sEh(b){b.S4c=null;this.tX()}}Object(n.a)(xK,"WordCountAppEventCoordinator",Rr.a,[]);class jG{}jG.g0j="AccurateWordCountButton";Object(n.a)(jG,"WordCountConstants",null,[]);class yK{constructor(b,h){this.Rs=b;this.hP=h}getInstance(b){switch(b){case 1:return this.hP;
case 0:return this.Rs;default:return this.Rs}}}Object(n.a)(yK,"WordCountManagerFactory",null,[128]);class kG{constructor(){this.W=null}get name(){return"WordEditor.WordCount"}yc(b){this.W=b;const h=this.W.resolve("Common.IAppSettingsManager");this.W.ha("WordEditor.WordCount.ITableCountSelectionTraverserFactory",()=>new sK(h)).singleInstance();this.W.ha("WordEditor.WordCount.IWordCountManagerFactory",()=>{var r=new Ro.a(10,Ed.a.lf);const z=new tK(b.resolve("Box4.List.IListReader"),b.resolve("Box4.IListMarkerUtility"),
new sn.a,t.AFrameworkApplication.ya,t.AFrameworkApplication.uc,()=>ja.App.fm.jb.Ic.rd,Cn.a.Kr,Nd.GraphIterator.$a,h,r,Sa.a.instance.resolve("Box4.ILanguageReader"));r=new rK(Sa.a.instance.resolve("Box4.List.IListReader"),Sa.a.instance.resolve("Box4.IListMarkerUtility"),new sn.a,di.a.instance,t.AFrameworkApplication.uc,Dp.a.instance,wc.a.instance,Sa.a.instance.resolve("WordEditor.WordCount.ITableCountSelectionTraverserFactory"),h,r,Sa.a.instance.resolve("Box4.ILanguageReader"));return new yK(z,r)}).singleInstance();
this.W.ha("WordEditor.WordCount.GraphFullyConnectedGetter",()=>new jK(this.W.resolve("WordEditor.WordCount.IWordCountManagerFactory").getInstance(0))).as("WordEditor.IGraphFullyConnectedGetter").singleInstance()}init(){const b=vb.App.xa.jb;b.Ata?this.Uga():b.hda(()=>{this.Uga()})}Uga(){if(vb.App.Xj){var b=vb.App.Xj.al;if(b){this.W.resolve("WordEditor.IGraphFullyConnectedGetter");var h=this.W.resolve("WordEditor.WordCount.IWordCountManagerFactory").getInstance(0),r=this.W.resolve("WordEditor.WordCount.IWordCountManagerFactory").getInstance(1),
z=Sa.a.instance.resolve("Common.IAppSettingsManager");(new wK(h,r,()=>Sa.a.instance.Pa("WordEditor.IStatusBarUser"),this.Ypl(),jG.g0j,Ga.a.DPa,Ga.a.dla,Sa.a.instance.resolve("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder"),z)).Vb();(new xK(ik.GraphTransactionManager.instance,h,b,z)).Xy();h.Q2e()}else v.ULS.sendTraceTag(22425994,306,10,"Graph is null. Word Count will not be available")}else v.ULS.sendTraceTag(23967264,306,15,"TheNotebookManager is null. Word Count will not be available")}Ypl(){var b=
ja.App.fm.jb;if(!b)return v.ULS.sendTraceTag(22611550,324,10,""),!1;b=b.Ic;if(!b)return v.ULS.sendTraceTag(22611552,324,10,""),!1;b=b.rd;return b?b.ia(yc.a.uKa,!1):(v.ULS.sendTraceTag(22611554,324,10,""),!1)}dispose(){}static main(){O.a.instance.Oc(new kG)}}Object(n.a)(kG,"PackageManager",null,[1,2]);var AM=d(1914);class zK{constructor(b){this.fGe=null;b.Za("Common.App.SearchCommon.SearchHostRuntime").execute(h=>{this.fGe=h})}JYi(b){this.fGe&&this.fGe.Def().handleDocumentContentAugloopAnnotation(b)}}
Object(n.a)(zK,"DocumentContentExtractionManager",null,[288]);class Lh{}Lh.u_n="mso_smartLookup";Lh.channelId="SmartLookup";Lh.t_n="https://uciserviceintcdnwus.blob.core.windows.net/mirrored/smartlookup/";Lh.v6i="https://uci.edog.cdn.office.net/mirrored/smartlookup/";Lh.w6i="https://uci.cdn.office.net/mirrored/smartlookup/";Lh.s_n="https://hedwigtestserver.blob.core.windows.net/builds/";Lh.r_n="http://localhost:8080/";Lh.S0c="current";Lh.u6i="next";Lh.s1m=2;Lh.vac=1;Lh.Lib=CommonUIStrings.L_SmartLookupPaneTitle;
Lh.ly="InsightsTaskPane";Lh.t4f="InsightsTaskPaneData";Lh.Xlf="InsightsContentFrame";Lh.width=400;Lh.$Hm="ApplicationPropertiesRequest";Lh.mIm="SelectionRequest";Lh.gIm="PageRendered";Lh.ZHm="ApplicationProperties";Lh.lIm="Selection";Lh.oIm="Telemetry";Lh.nIm="TakeFocus";Lh.fIm="LostFocus";Lh.cIm="Keyboard";Lh.dIm="LegalAgreed";Lh.Puo="WordWac";Lh.rZm="OneNoteWAC";Lh.CKf="yes";Lh.U$i="appCorrelationId";Lh.h7n="clientCorrelationId";Lh.V$i="message";Lh.Rki="Microsoft::Office::Insights::LegalAgreed";
Object(n.a)(Lh,"InsightsConstants",null,[]);var YD=d(1574);class OC{}Object(n.a)(OC,"ActivityContractInfo",null,[]);class qs{}Object(n.a)(qs,"BrowserPaneDataField",null,[]);class PC{}Object(n.a)(PC,"BrowserPaneTelemetryEvent",null,[]);class Pl{static WA(b,h){const r=new PC;r.eventName="Diagnostics";r.isActivity=!1;r.activityContract=Object.assign(new OC,{success:!0});const z=[],R=new qs;R.name="Message";R.dataType=0;R.value=b;b=new qs;b.name="Level";b.dataType=0;b.value=Pl.getLevelString(h);Array.add(z,
R);Array.add(z,b);r.dataFields=z;Pl.sendTelemetryEvent(r)}static OWi(b,h){const r=new PC;r.eventName=b;r.isActivity=!1;r.activityContract=Object.assign(new OC,{success:!0});b=[];const z=new qs;z.name="AppCorrelationId";z.dataType=0;z.value=h;Array.add(b,z);r.dataFields=b;Pl.sendTelemetryEvent(r)}static rFn(b,h,r,z,R,ba){const ta=new PC;ta.eventName="LaunchPaneWithError";ta.isActivity=!1;ta.activityContract=Object.assign(new OC,{success:!0});const Wa=[],ub=new qs;ub.name="IsNetworkConnected";ub.dataType=
0;ub.value=b?"true":"false";b=new qs;b.name="IsHostruntimeAvailable";b.dataType=0;b.value=h?"true":"false";h=new qs;h.name="EntryPoint";h.dataType=0;h.value=r;r=new qs;r.name="RuntimeVersion";r.dataType=0;r.value=z;z=new qs;z.name="IsFirstRelease";z.dataType=1;z.value=R?"true":"false";R=new qs;R.name="IsZeroTerm";R.dataType=1;R.value=ba?"true":"false";ba=new qs;ba.name="IsClientSideRendering";ba.dataType=1;ba.value="false";Array.add(Wa,ub);Array.add(Wa,h);Array.add(Wa,b);Array.add(Wa,r);Array.add(Wa,
z);Array.add(Wa,R);Array.add(Wa,ba);ta.dataFields=Wa;Pl.sendTelemetryEvent(ta)}static FWf(b,h,r){const z=new PC;z.eventName="CDNDownloadLatency";z.isActivity=!0;z.activityContract=Object.assign(new OC,{duration:r,success:!0});r=[];const R=new qs;R.name="CDNHostname";R.dataType=0;R.value=b;b=new qs;b.name="Filename";b.dataType=0;b.value=h;Array.add(r,R);Array.add(r,b);z.dataFields=r;Pl.sendTelemetryEvent(z,1)}static Bdc(b,h,r,z,R,ba,ta,Wa){const ub=new PC;ub.eventName="LaunchPane";ub.isActivity=!0;
ub.activityContract=Object.assign(new OC,{duration:h,success:!0});h=[];const Ib=new qs;Ib.name="AppCorrelationId";Ib.dataType=0;Ib.value=b;b=new qs;b.name="EntryPoint";b.dataType=0;b.value=r;r=new qs;r.name="IsServerSideRendering";r.dataType=1;r.value="true";const $b=new qs;$b.name="UxVersion";$b.dataType=0;$b.value=z;z=new qs;z.name="FeatureGates";z.dataType=0;z.value=R;R=new qs;R.name="IsFirstRelease";R.dataType=1;R.value=ba?"true":"false";ba=new qs;ba.name="IsZeroTerm";ba.dataType=1;ba.value=ta?
"true":"false";ta=new qs;ta.name="IsClientSideRendering";ta.dataType=1;ta.value=Wa?"true":"false";Array.add(h,Ib);Array.add(h,b);Array.add(h,r);Array.add(h,$b);Array.add(h,z);Array.add(h,R);Array.add(h,ba);Array.add(h,ta);ub.dataFields=h;Pl.sendTelemetryEvent(ub)}static sendTelemetryEvent(b,h=2){if(b.isFeedbackActivity)Pl.gxm(b.eventName);else{var r=-1<b.eventName.indexOf(Pl.T$i)?b.eventName:Pl.T$i+b.eventName,z=Pl.dpl(b.dataFields);b.isActivity?(b=Object.assign(new si.a,{name:r,samplingPolicy:h,
dataFields:z,succeeded:b.activityContract.success,durationMs:b.activityContract.duration}),Y.a.sendActivityEvent(b)):(b=Object.assign(new da.a,{name:r,samplingPolicy:h,dataFields:z}),Y.a.sendTelemetryEvent(b))}}static getLevelString(b){switch(b){case 10:return"Error";case 15:return"Warning";default:return"Info"}}static dpl(b){const h=[];if(b&&0<b.length)for(const r of b)(b=bh.a.uea(r.name,r.value,Pl.eGk(r.dataType)))&&Array.add(h,b);return h}static eGk(b){switch(b){case 0:return 2;case 1:return 1;
case 2:return 3;case 3:return 4;default:return 0}}static gxm(b){const h=Sa.a.instance.Pa("Common.ISystemInitiatedFeedback");h?h.logActivity(b,null):v.ULS.sendTraceTag(540624772,1303,15,"Failed to resolve ISystemInitiatedFeedback.")}}Pl.T$i="Office.Insights.SmartLookup.";Object(n.a)(Pl,"TelemetryUtils",null,[]);var QC;(function(b){b[b.other=0]="other";b[b.searchBoxSearch=1]="searchBoxSearch";b[b.searchBoxDictionary=2]="searchBoxDictionary";b[b.searchBoxQuickAnswer=3]="searchBoxQuickAnswer";b[b.smartLookupRibbon=
4]="smartLookupRibbon";b[b.smartLookupContextMenu=5]="smartLookupContextMenu";b[b.entity=6]="entity";b[b.dictionary=7]="dictionary";b[b.web=8]="web";b[b.pictures=9]="pictures";b[b.files=10]="files";b[b.bookmarks=11]="bookmarks";b[b.help=12]="help";b[b.chartRecommendation=13]="chartRecommendation";b[b.linkSkill=14]="linkSkill";b[b.searchBoxFindInDocument=15]="searchBoxFindInDocument";b[b.searchBoxEntity=16]="searchBoxEntity";b[b.searchSkill=17]="searchSkill";b[b.controlF=18]="controlF";b[b.ribbonFindButton=
19]="ribbonFindButton";b[b.reuseSlides=20]="reuseSlides";b[b.data=21]="data";b[b.contextMenuDictionary=22]="contextMenuDictionary";b[b.contextMenuSearchSuggestion=23]="contextMenuSearchSuggestion";b[b.contextMenuSynonyms=24]="contextMenuSynonyms";b[b.contextMenuSearchBoxSearch=25]="contextMenuSearchBoxSearch";b[b.searchBoxSearchZeroTerm=26]="searchBoxSearchZeroTerm";b[b.contextMenuSearchZeroTerm=27]="contextMenuSearchZeroTerm";b[b.note=28]="note";b[b.smartLookupAutoLaunch=29]="smartLookupAutoLaunch";
b[b.contextMenuSmartLookupInSubMenu=30]="contextMenuSmartLookupInSubMenu";b[b.dataDisambiguate=31]="dataDisambiguate";b[b.linkFiles=32]="linkFiles";b[b.searchBoxNoteL2=33]="searchBoxNoteL2";b[b.contextMenuLaunchL2Document=34]="contextMenuLaunchL2Document";b[b.prefetch=99]="prefetch"})(QC||(QC={}));Object(n.b)("EntryPoint",QC);var Pt=d(1516),ew=d(1527);class Qt{static r6(b,h,r,z,R,ba){if(1===r)return Xh.SessionStatusManager.instance.jK?32:8;if(R.value.vVn())return Pl.WA("Skipping Serplet launch",10),
32;h=ba;if(!h)return 8;b=Qt.Jzb();if(r=h.CommandValueId)try{h=y.a(r)}catch(ta){return v.ULS.sendTraceTag(594044173,1313,15,"SmartLookup application interface [{0}] is not in proper format",r),8}r=h;h.selection||(h.neighborhood?r=Object.assign(new Pt.a,{selection:h}):(h=R.value.Y2b(),r.selection=Object.assign(new ew.a,{neighborhood:h.neighborhood,mentionStart:h.mentionStart,mentionLength:h.mentionLength})));r.selection.clientDetectedLanguage=R.value.MSh();return Qt.k1b(ba,null,r,b,0,R)}static k1b(b,
h,r,z,R,ba){const ta={};ta.controlId=b?b.SourceControlId:"shortcut";r&&(ta.entryPoint=QC[r.entryPoint]);v.ULS.sendTraceTag(594044172,1303,50,Qt.eT("Show insights",z,ta));h?ba.value.MXn(h,z,R):r&&ba.value.NXn(r,z,R);return 32}static eT(b,h,r=null){b={["appCorrelationId"]:h,["message"]:b};if(r)for(let z in r)b[z]=r[z];return y.c(b)}static Jzb(){return pa.a.create().toString()}}Object(n.a)(Qt,"InvokingPaneUtils",null,[]);class AK{}Object(n.a)(AK,"LaunchDataInDoc",null,[]);var Mu=d(1530);class lG{constructor(b,
h,r,z,R,ba,ta,Wa,ub){this.Amc=this.Ubd=this.Xv=null;this.uC=b;this.ga=h||t.AFrameworkApplication.ya;this.Oo=r;this.Wb=z;this.oMg=Wa;this.psc=R;this.Oa=ba;this.Hb=ta;this.h3l();this.qSa=new De.a(()=>new gm.a(ub.value,Object(u.a)(this,this.BAb,"getMoreInfoEventReceived")))}Vb(){this.ga.pa(ab.a.X6l,Yd.a.frame,Object(u.a)(this,this.KXn,"showInsights"));this.ga.pa(ab.a.Y6l,Yd.a.frame,Object(u.a)(this,this.LXn,"showInsightsForTellMe"));this.ga.pa(ab.a.definitions,Yd.a.frame,Object(u.a)(this,this.KWn,"showDefinitions"));
this.ga.pa(ab.a.N2e,Yd.a.frame,Object(u.a)(this,this.LWn,"showDefinitionsForTellMe"));this.ga.pa(ab.a.B0f,Yd.a.frame,Object(u.a)(this,this.B0f,"showInsightsForSuggestion"));this.oMg&&(this.ga.pa(ab.a.Zea,Yd.a.frame,Object(u.a)(this,this.r6,"invokeSmartLookupPane")),this.ga.pa(ab.a.ZMc,Yd.a.frame,Object(u.a)(this,this.ZMc,"invokeInDocSerplet")),this.ga.pa(ab.a.oNd,Yd.a.frame,Object(u.a)(this,this.oNd,"invokeSerpletRibbon")),this.ga.pa(ab.a.$Mc,Yd.a.frame,Object(u.a)(this,this.$Mc,"invokeSerpletContextMenu")),
this.ga.pa(ab.a.Xof,Yd.a.frame,Object(u.a)(this,this.Xof,"invokeSerpletTellMeZeroTerm")),this.ga.pa(ab.a.Wof,Yd.a.frame,Object(u.a)(this,this.Wof,"invokeSerpletTellMeNotes")),this.ga.pa(ab.a.kNd,Yd.a.frame,Object(u.a)(this,this.kNd,"invokeImageSerpletContextMenu")),this.ga.pa(ab.a.pNd,Yd.a.frame,Object(u.a)(this,this.pNd,"invokeSynonymsSerpletContextMenu")),this.ga.pa(ab.a.jNd,Yd.a.frame,Object(u.a)(this,this.jNd,"invokeDictionarySerpletContextMenu")),this.ga.pa(ab.a.rNd,Yd.a.frame,Object(u.a)(this,
this.rNd,"invokeZeroTermSerpletContextMenu")),this.ga.pa(ab.a.nNd,Yd.a.frame,Object(u.a)(this,this.nNd,"invokeSerpletBrowseFiles")),this.ga.pa(ab.a.lNd,Yd.a.frame,Object(u.a)(this,this.lNd,"invokeInDocSerpletWithLaunchData")),this.ga.pa(ab.a.c2d,Yd.a.frame,Object(u.a)(this,this.c2d,"queryToggleSerplet")),this.ga.pa(ab.a.P6d,Yd.a.frame,Object(u.a)(this,this.P6d,"setInDocSearchParameter")),t.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableSerpletAutolaunch",!1)&&(this.ga.pa(ab.a.I$h,
Yd.a.frame,Object(u.a)(this,this.E8l,"invokeSmartLookupPaneConversations")),this.ga.pa(ab.a.hNd,Yd.a.frame,Object(u.a)(this,this.hNd,"invokeAutoLaunchSearchRequest"))),this.Skn().continueWith(()=>{t.AFrameworkApplication.ua&&t.AFrameworkApplication.ua.updateCommandUI(!0)}))}a8g(){this.ga.gb(ab.a.dCa,Yd.a.frame,Object(u.a)(this,this.dCa,"invokeFilesSerplet"),4);this.ga.gb(ab.a.Rof,Yd.a.frame,Object(u.a)(this,this.dCa,"invokeFilesSerplet"),4);this.ga.gb(ab.a.C$h,Yd.a.frame,Object(u.a)(this,this.u8l,
"invokeLinkFilesSerplet"),4);if(this.Oa.$("IsTellMeUpSellEnterpriseEnabled")&&this.Oa.$("SmartLookupTokenPrefetchIsEnabled")){const b=Ic.a.N9(0,Object(u.a)(this,this.VFi,"prefetchToken"),0,177);this.Hb.$b(b)}}YOe(){yh.a("isSharedUxGateEnabled")&&appChrome.api.isSharedUxGateEnabled("SharedOnline.ChangeGate.AddEmptyFilesActionWhenUnavailable")&&(this.ga.pa(ab.a.dCa,Yd.a.frame,Object(u.a)(this,this.Sof,"invokeFilesSerpletUnavailable")),this.ga.pa(ab.a.Rof,Yd.a.frame,Object(u.a)(this,this.Sof,"invokeFilesSerpletUnavailable")),
this.ga.pa(ab.a.C$h,Yd.a.frame,Object(u.a)(this,this.Sof,"invokeFilesSerpletUnavailable")))}VFi(b){v.ULS.sendTraceTag(579352786,1303,50,"SmartLookupFiles: Token prefetch initiated, interval={0}, IsRetry={1}",b.interval,!!b.data);this.Zgc().then(h=>{let r=1;if(h)v.ULS.sendTraceTag(579352787,1303,50,"SmartLookupFiles: Token prefetch succeeded"),this.VWf("SmartLookupFiles: Token prefetch succeeded",!0),h=6E4*this.Oa.rc("SmartLookupTokenRenewalWaitDurationInMinutes",30);else{v.ULS.sendTraceTag(579352788,
1303,50,"SmartLookupFiles: Token prefetch failed");this.VWf("SmartLookupFiles: Token prefetch failed",!1);r=parseInt(b.data||"1");if(r>this.Oa.rc("SmartLookupTokenRenewalRetryThreshold",5)){v.ULS.sendTraceTag(577345097,1303,10,"SmartLookupFiles: Token prefetch max retry count reached");this.VWf("SmartLookupFiles: Token prefetch max retry count reached",!1);return}h=6E4*this.Oa.rc("SmartLookupTokenRetryWaitDurationInMinutes",10);r++}h=new Ic.a(3,1,h,Object(u.a)(this,this.VFi,"prefetchToken"),177);
h.data=r.toString();this.Hb.$b(h)})}VWf(b="",h=!1){this.psc.execute(r=>{r&&r.ckb("PrefetchToken",h,0,"SmartLookup",b)})}Zgc(){return this.psc?new Promise(b=>{this.psc.execute(h=>{if(h){var r=Date.now();h.getToken("SmartLookup",this.Oa.lb("SmartLookupShredderServiceEndpoint")).then(z=>{b(!!z&&0<z.length);h.ckb("TryGetTokenInternal",!!z&&0<z.length,Date.now()-r,"SmartLookup")})}else b(!1)})}):Promise.resolve(!1)}Skn(){const b=new cc.a;if(this.Oa.$("BrowserSupportsInsightsPaneSSO"))this.a8g(),b.Gg(!0);
else{if(!this.psc)return v.ULS.sendTraceTag(587534883,1303,10,"_oAuthManagerFuture not initialized"),b.Gg(!1),this.YOe(),b.task;this.psc.execute(h=>{h?h.getToken("SmartLookup",this.Oa.lb("SmartLookupShredderServiceEndpoint")).then(r=>{v.ULS.sendTraceTag(587534913,1303,15,"Token:{0}",!!r&&0<r.length);r&&0<r.length?(this.a8g(),b.Gg(!0)):this.YOe()}):(v.ULS.sendTraceTag(587534912,1303,10,"Unable to resolve oAuthManager"),b.Gg(!1),this.YOe())})}return b.task}KXn(b,h,r,z,R){if(1===r)return t.AFrameworkApplication.ua&&
t.AFrameworkApplication.K.$("OneNoteDelayLoadContextActivationManager")&&!t.AFrameworkApplication.hCc?8:this.uC.value.Odi()?32:8;b=Qt.Jzb();h=this.uC.value.Y2b();return this.oMg?(h=Object.assign(new ew.a,{neighborhood:h.neighborhood,mentionStart:h.mentionStart,mentionLength:h.mentionLength}),h=Object.assign(new Pt.a,{selection:h,userIntent:null,entryPoint:0,launchData:Object.assign(new Mu.a,{landingTab:"All"})}),Qt.k1b(R,null,h,b,0,this.uC)):Qt.k1b(R,h,null,b,0,this.uC)}KWn(b,h,r,z,R){if(1===r)return this.uC.value.Odi()?
32:8;b=Qt.Jzb();h=this.uC.value.Y2b();return Qt.k1b(R,h,null,b,1,this.uC)}LXn(b,h,r,z,R){return 1===r?32:this.FFh(R,0)}LWn(b,h,r,z,R){return 1===r?32:this.FFh(R,1)}FFh(b,h){const r=Qt.Jzb(),z=b.CommandValueId;let R;try{R=y.a(z)}catch(ba){return v.ULS.sendTraceTag(6295941,1303,15,Qt.eT(String.format("Insights parameters [{0}] is not in proper format.",z),r)),8}return Qt.k1b(b,R,null,r,h,this.uC)}B0f(b,h,r,z,R){if(1===r)return 32;if(!R)return 8;b=R.query?R.query:"";h=Qt.Jzb();r=new YD.a;r.neighborhood=
b;r.mentionStart=0;r.mentionLength=b.length;return Qt.k1b(R,r,null,h,0,this.uC)}u8l(b,h,r,z){if(1===r)return Xh.SessionStatusManager.instance.jK?32:8;const R=t.AFrameworkApplication.K.$("InsertFileLinkSerpletIsEnabled"),ba=this.uC.value.uYa();return this.r6(b,h,r,z,Object.assign(new Pt.a,{selection:Object.assign(new ew.a,{neighborhood:ba.neighborhood,mentionStart:0,mentionLength:0}),launchData:Object.assign(new Mu.a,{landingTab:"File"}),entryPoint:R?32:10}))}dCa(b,h,r,z){if(1===r)return Xh.SessionStatusManager.instance.jK?
32:8;const R=t.AFrameworkApplication.K.$("InvokeReuseSlidesSerpletIsEnabled"),ba=this.uC.value.uYa();return this.r6(b,h,r,z,Object.assign(new Pt.a,{selection:Object.assign(new ew.a,{neighborhood:ba.neighborhood,mentionStart:0,mentionLength:0}),launchData:Object.assign(new Mu.a,{landingTab:R?"Slide":"File"}),entryPoint:R?20:10}))}Sof(){return 2}ZMc(b,h,r,z,R){if(1===r)return Xh.SessionStatusManager.instance.Sj?8:32;const ba=this.uC.value.uYa();R=void 0===R||null===R?18:19;return this.r6(b,h,r,z,Object.assign(new Pt.a,
{selection:Object.assign(new ew.a,{neighborhood:ba.neighborhood,mentionStart:ba.mentionStart,mentionLength:ba.mentionLength}),launchData:Object.assign(new Mu.a,{landingTab:"Indoc"}),entryPoint:R}))}lNd(b,h,r,z,R){R=R.CommandValueId;if(!R||R&&this.Amc&&R.query===this.Amc.query&&R.matchCase===this.Amc.matchCase&&R.matchWholeWordOnly===this.Amc.matchWholeWordOnly)return 32;const ba=this.uC.value.uYa();return this.r6(b,h,r,z,Object.assign(new Pt.a,{selection:Object.assign(new ew.a,{neighborhood:ba.neighborhood,
mentionStart:ba.mentionStart,mentionLength:ba.mentionLength}),launchData:Object.assign(new Mu.a,{landingTab:"Indoc",data:Object.assign(new AK,{type:4,query:R.query,matchCase:R.matchCase,matchWholeWord:R.matchWholeWordOnly})}),entryPoint:18}))}c2d(b,h,r,z,R){R&&(R[Yf.a.On]=this.uC.value.pDb);return 32}P6d(b,h,r,z,R){if(b=R.CommandValueId)this.Amc=b;return 32}E8l(b,h,r){if(1===r)return Xh.SessionStatusManager.instance.jK?32:8;b=this.uC.value.uYa();b=Object.assign(new Pt.a,{selection:Object.assign(new ew.a,
{neighborhood:b.neighborhood,mentionStart:b.mentionStart,mentionLength:0}),entryPoint:29,launchData:Object.assign(new Mu.a,{landingTab:"All"})});this.uC.value.ERd(b);return 32}hNd(b,h,r){if(1===r)return Xh.SessionStatusManager.instance.jK?32:8;b=this.uC.value.uYa();b=Object.assign(new Pt.a,{selection:Object.assign(new ew.a,{neighborhood:b.neighborhood,mentionStart:b.mentionStart,mentionLength:0}),entryPoint:29,launchData:Object.assign(new Mu.a,{landingTab:"All",data:t.AFrameworkApplication.yyb})});
h=Qt.Jzb();this.uC.value.qJb(b,h);return 32}oNd(b,h,r,z){if(1===r)return Xh.SessionStatusManager.instance.jK?32:8;const R=this.uC.value.OSh();return this.r6(b,h,r,z,Object.assign(new Pt.a,{selection:Object.assign(new ew.a,{neighborhood:R.neighborhood,mentionStart:R.mentionStart,mentionLength:R.mentionLength}),entryPoint:4,launchData:Object.assign(new Mu.a,{landingTab:"All"})}))}$Mc(b,h,r,z){return this.r6(b,h,r,z,Object.assign(new Pt.a,{entryPoint:5,launchData:Object.assign(new Mu.a,{landingTab:"All"})}))}Xof(b,
h,r,z){if(1===r)return Xh.SessionStatusManager.instance.jK?32:8;const R=this.uC.value.uYa();return this.r6(b,h,r,z,Object.assign(new Pt.a,{selection:Object.assign(new ew.a,{neighborhood:R.neighborhood,mentionStart:R.mentionStart,mentionLength:0}),launchData:Object.assign(new Mu.a,{landingTab:"All"}),entryPoint:26}))}jNd(b,h,r,z){return 1===r?(b=this.uC.value.Y2b())&&0<b.mentionLength?32:8:this.r6(b,h,r,z,Object.assign(new Pt.a,{entryPoint:22,launchData:Object.assign(new Mu.a,{landingTab:"All"})}))}kNd(b,
h,r,z){return this.r6(b,h,r,z,Object.assign(new Pt.a,{launchData:Object.assign(new Mu.a,{landingTab:"Image"}),entryPoint:9}))}pNd(b,h,r,z){return this.r6(b,h,r,z,Object.assign(new Pt.a,{launchData:Object.assign(new Mu.a,{landingTab:"All"}),entryPoint:24}))}Wof(b,h,r,z){return this.r6(b,h,r,z,Object.assign(new Pt.a,{launchData:Object.assign(new Mu.a,{landingTab:"Notes"}),entryPoint:33}))}rNd(b,h,r,z){if(1===r)return Xh.SessionStatusManager.instance.jK?32:8;const R=this.uC.value.uYa();return this.r6(b,
h,r,z,Object.assign(new Pt.a,{selection:Object.assign(new ew.a,{neighborhood:R.neighborhood,mentionStart:R.mentionStart,mentionLength:0}),launchData:Object.assign(new Mu.a,{landingTab:"All"}),entryPoint:27}))}r6(b,h,r,z,R){return Qt.r6(b,h,r,z,this.uC,R)}nNd(b,h,r){if(1===r)return 32;this.Xv||this.qSa.value.fk("Browse File from Search pane",!0);if(!this.Ubd||""===this.Ubd)return v.ULS.sendTraceTag(558409934,1303,10,"InsightsActor: Failed to get host url to browse files."),8;Ed.a.Cm(this.Ubd,"_blank",
void 0,"BrowseFilesFromSearchPane");return 32}BAb(b){this.Xv||3!==b.state||(this.Xv=b,this.Ubd=this.Xv.Kaa)}h3l(){const b=this.Wb.re(Lh.ly);b.parent=ke.AFrame.Np;b.eda(Object(u.a)(this,this.Adc,"sendIFrameTakeFocusMessage"));this.Oo.qS(Lh.ly)}Adc(){document.activeElement.blur();t.AFrameworkApplication.ua&&t.AFrameworkApplication.ua.Sb.lgb||(this.uC.value.SJn(),this.uC.value.pFn())}dispose(){this.uC.value&&this.uC.value.dispose()}}Object(n.a)(lG,"InsightsActor",null,[9]);const mG=b=>{b=b.split("-");
return b[b.length-1]},CM=()=>{var b=bF();if(b)return Promise.resolve(b);b=ZD().replace("SearchWeb","searchweb");b=t.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupCDNNextIsEnabled",!1)?b+Lh.u6i+"/":b+Lh.S0c+"/";b+="version.json";if(X.a.S$)return BM(b);try{const h=new Sys.Net.WebRequest;h.set_httpVerb("GET");h.set_url(b);b={};b.method=h.get_httpVerb();return"function"!==typeof window.fetch?(Pl.WA("InsightsUtils - Failed to download version.json because fetch API is unavailable.",
10),Promise.resolve("")):window.fetch(h.getResolvedUrl(),b).then(r=>r.json()).catch(()=>{Pl.WA("InsightsUtils - Failed to prefetch version.json of HttpException.",10);return""}).then(r=>{r=y.b(JSON.stringify(r));return r.version?r.version:""},r=>{Pl.WA("InsightsUtils - Failed to deserialize version: "+r.toString(),10);v.ULS.sendTraceTag(591971029,1303,15,"Insights: Failed to deserialize version: "+r.toString());return""}).then(r=>r)}catch(h){return Pl.WA("InsightsUtils - Failed to download version.json: "+
h.toString(),10),v.ULS.sendTraceTag(591984149,1303,50,"Insights: Call to Version JSON failed + "+h.toString()),Promise.resolve("")}},BM=b=>{const h=t.AFrameworkApplication.Xe;return new Promise(r=>{const z=new YE.a(b,1,null,null,!0,2,null);h.send(z).LDa(R=>{R&&R.data?R.data.Ge||(Pl.WA("InsightsUtils - Request for version.json with ClientRequestManager returned empty ResponseData. StatusCode: "+R.data.wf,10),r("")):(Pl.WA("InsightsUtils - Request for version.json with ClientRequestManager returned no Data.",
10),r(""));try{const ba=y.b(R.data.Ge);ba.version&&r(ba.version)}catch(ba){Pl.WA("InsightsUtils - Failed to deserialize version: "+ba.toString(),10),r("")}},R=>{R&&R.data?Pl.WA("InsightsUtils - Failed to prefetch version.json with ClientRequestManager. StatusCode: "+R.data.wf,10):Pl.WA("InsightsUtils - Failed to prefetch version.json with ClientRequestManager. Unknown HTTP Failure.",10);r("")})})},cF=()=>t.AFrameworkApplication.K.$("SmartLookupEnableLocalOverride")||t.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableLocalOverride",
!1),dF=()=>{const b=ZD();return cF()||t.AFrameworkApplication.K.lb("SmartLookupPRClientVersion")?b+bF()+"/":t.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupCDNNextIsEnabled",!1)?b+Lh.u6i:b+Lh.S0c},bF=()=>cF()?"dev":t.AFrameworkApplication.K.lb("SmartLookupPRClientVersion")?t.AFrameworkApplication.K.lb("SmartLookupPRClientVersion").split("/")[1]:t.AFrameworkApplication.K.lb("SmartLookupClientVersion"),nG=b=>{var h=3===t.AFrameworkApplication.ua.Sb.jo?"wordwac":
2===t.AFrameworkApplication.ua.Sb.jo?"pptwac":"excelwac";var r=Sj.a.pg(t.AFrameworkApplication.lcid);const z=r?r.name:"en-us";r=ZD();const R=$B();h="main_ssr_wac.html?appName="+h+"&culture="+z;return"LOCAL"===R?r+h:r+((""!==b?b:Lh.S0c)+"/")+h},DM=b=>ZD()+(""!==b?b:Lh.S0c)+"/scripts/microsoft.office.smartlookup.host.runtime.js",ZD=()=>{switch($B()){case "LOCAL":return Lh.r_n;case "PR":const b=t.AFrameworkApplication.K.lb("SmartLookupPRClientVersion").split("/");return Lh.s_n+b[0]+"/";case "INT":return Lh.t_n;
case "EDOG":return Lh.v6i;default:return Lh.w6i}},EM=()=>{if(!t.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SerpletCDNLatencyActivityEnabled",!1))return"";switch($B()){case "EDOG":return Lh.v6i;case "PROD":return Lh.w6i;default:return""}},$B=()=>{if(t.AFrameworkApplication.K.$("SmartLookupEnableEdogSourceLocationOverride")||t.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableEdogSourceLocationOverride",!1))return"EDOG";if(t.AFrameworkApplication.K.$("SmartLookupEnableProdSourceLocationOverride")||
t.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableProdSourceLocationOverride",!1))return"PROD";if(t.AFrameworkApplication.K.$("SmartLookupEnableIntSourceLocationOverride")||t.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableIntSourceLocationOverride",!1))return"INT";if(t.AFrameworkApplication.K.lb("SmartLookupPRClientVersion")&&t.AFrameworkApplication.K.lb("SmartLookupPRIntentSvc"))return"PR";if(cF())return"LOCAL";
switch(Object(la.a)(String,t.AFrameworkApplication.sessionStartInfoSettings.AudienceGroup)||""){case "Dogfood":if(t.AFrameworkApplication.K&&t.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableSmartLookupSKITeamDogfood",!1)){let b=t.AFrameworkApplication.K.lb("UserPrincipalName");b=B.a.mh(b);const h=t.AFrameworkApplication.K.yu("SmartLookupINTEnabledForSKITeam")?t.AFrameworkApplication.K.KB("SmartLookupINTEnabledForSKITeam"):[];if(0<=Array.indexOf(h,b))return"INT"}return"EDOG";
case "Microsoft":return"EDOG";default:return"PROD"}},BK=()=>{let b;b=t.AFrameworkApplication.K.$("IntentSvcEnableEdogSourceLocationOverride")||t.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.IntentSvcEnableEdogSourceLocationOverride",!1)?"EDOG":t.AFrameworkApplication.K.$("IntentSvcEnableProdSourceLocationOverride")||t.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.IntentSvcEnableProdSourceLocationOverride",!1)?"PROD":t.AFrameworkApplication.K.$("IntentSvcEnableIntSourceLocationOverride")||
t.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.IntentSvcEnableIntSourceLocationOverride",!1)?"INT":$B();const h=t.AFrameworkApplication.K.lb("IntentServiceEndpoint"),r=t.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.IntentSvcNewEndpointEnabled",!1);if("PROD"===b&&""!==h)return h+"searchendpointv2/";switch(b){case "LOCAL":return"wss://127.0.0.1:9000/officeaugmentation/searchendpointv2/";case "PR":return t.AFrameworkApplication.K.lb("SmartLookupPRIntentSvc")+
"searchendpointv2/";case "INT":return(r?"wss://entity.osi.office-int.net/officeaugmentation/":"wss://augmentation.osi.office-int.net/officeaugmentation/")+"searchendpointv2/";case "EDOG":return(r?"wss://entity.osi.officeppe.net/officeaugmentation/":"wss://augmentation.osi.officeppe.net/officeaugmentation/")+"searchendpointv2/";default:return"wss://augmentation.osi.office.net/officeaugmentation/searchendpointv2/"}};class CK{sendTelemetryEvent(b){Pl.sendTelemetryEvent(b)}}Object(n.a)(CK,"OtelTelemetrySink",
null,[315]);class DK{}Object(n.a)(DK,"ApplicationProperties",null,[]);class EK{constructor(){this.createdDate=this.author=this.filePath=this.docName=null}}Object(n.a)(EK,"CurrentDocumentProperties",null,[]);class FK{}Object(n.a)(FK,"EnterpriseUserInfo",null,[]);class GK{}Object(n.a)(GK,"FeatureGates",null,[]);class oG{constructor(b,h){this.gu=this.Fi=null;this.Voi=!0;this.wub=h;this.qy=b;this.qy.execute(r=>{r.isFeatureEnabled("mso_sendASmile",!0).then(z=>{this.Voi=z}).catch(z=>{Pl.WA("SearchHelper - Failed to check if Feedback feature is enabled: "+
z.toString(),15)})});b=BK();h=t.AFrameworkApplication.K.$("SmartLookupEnableInDocumentSearch")||t.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentSearch",!1);if(t.AFrameworkApplication.K.$("SmartLookupFeatureGateV2")){this.gu={};const r=this.PIl();if(r&&0<r.length)for(let z=0;z<r.length;z++){const R=r[z],ba=this.$Il(R);switch(ba.toLowerCase()){case "true":this.gu[R]=!0;break;case "false":this.gu[R]=!1;break;default:this.gu[R]=ba}}this.gu.EnableInDocumentSearch=
h;this.gu.EnableInDocumentSearchReplace=!0;this.gu.EnableInDocumentParamLocalSearch=!0;this.gu.EnableInDocumentQuerySuggest=h&&t.AFrameworkApplication.K.$("SmartLookupEnableInDocumentQuerySuggest")||t.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentQuerySuggest",!1);this.gu.EnableInDocumentQuestionGeneration=h&&t.AFrameworkApplication.K.$("SmartLookupEnableInDocumentQuestionGeneration")||t.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentQuestionGeneration",
!1);this.gu.EnableInDocumentGlobalEncoder=h&&t.AFrameworkApplication.K.$("SmartLookupEnableInDocumentGlobalEncoder")||t.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentGlobalEncoder",!1);this.gu.EnableInDocumentExperiment1=h&&t.AFrameworkApplication.K.$("SmartLookupEnableInDocumentExperiment1")||t.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentExperiment1",!1);this.gu.EnableInDocumentExperiment2=
h&&t.AFrameworkApplication.K.$("SmartLookupEnableInDocumentExperiment2")||t.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentExperiment2",!1);this.gu.EnableInDocumentExperiment3=h&&t.AFrameworkApplication.K.$("SmartLookupEnableInDocumentExperiment3")||t.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentExperiment3",!1);this.gu.EnableZeroTermAutoRefresh=t.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableZeroTermAutoRefresh",
!1);this.gu.EnableTap3SZeroTerm=t.AFrameworkApplication.K.$("SmartLookupEnableTap3SZeroTerm")||t.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableTap3SZeroTerm",!1);this.gu.EnableLocalSearch=!0;this.gu.EnableInDocumentStickyFilters=!0;this.gu.IntentServiceEndpoint=b;this.gu.EnablePDFShredding=t.AFrameworkApplication.K.$("SmartLookupEnableSharepointPDFIsEnabled")||t.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupSharepointPDFEnabled",
!1);this.gu.FilterNonPPTFilesForReuseSlides=t.AFrameworkApplication.K.$("SmartLookupFilterNonPPTFilesForReuseSlides");this.gu.UXBundleVersion=bF();this.gu.SmartLookupServicePath=dF();this.gu.EnableAcronymSearch=!0;this.gu.UseAltAnswerEndpoint1=t.AFrameworkApplication.K.$("SmartLookupUseAltAnswerEndpoint1")||t.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupUseAltAnswerEndpoint1",!1);this.gu.UseAltAnswerEndpoint2=t.AFrameworkApplication.K.$("SmartLookupUseAltAnswerEndpoint2")||
t.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupUseAltAnswerEndpoint2",!1);this.gu.UseAltAnswerEndpoint3=t.AFrameworkApplication.K.$("SmartLookupUseAltAnswerEndpoint3")||t.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupUseAltAnswerEndpoint3",!1);this.gu.UseNextUXVersion=t.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupCDNNextIsEnabled",!1);this.gu.IgnoreNeighborhoodContext=t.AFrameworkApplication.K.$("SmartLookupIgnoreNeighborhoodContextIsEnabled");
this.gu.ShowDebugInfo="INT"===$B();this.gu.DebugCommands=t.AFrameworkApplication.K.getStringFeatureGate("Microsoft.Office.SharedOnline.EnableSmartLookupDebugCommands","");this.gu.ChangeGates=t.AFrameworkApplication.K.getStringFeatureGate("Microsoft.Office.SharedOnline.SmartLookupChangeGateNames","");this.gu.QnaInMixSection=!0;this.gu.EnableNoteSearch=t.AFrameworkApplication.K.$("SmartLookupNoteSearchIsEnabled")||t.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupNoteSearchIsEnabled",
!1);this.gu.EnableWikiL2=t.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupWikipediaL2Enabled",!1);this.gu.EnableFilteringOutRedundantKPE=t.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableFilteringOutRedundantKPE",!1);this.gu.EnableZeroTermEntitySuggestion=t.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableZeroTermEntitySuggestion",!1);this.gu.RankingModels=t.AFrameworkApplication.K.getStringFeatureGate("Microsoft.Office.SharedOnline.SmartLookupRankingModels",
"");this.gu.EnableClientSideRendering=!0}else this.Fi=new GK,this.Fi.EnableInDocumentSearch=h,this.Fi.EnableInDocumentSearchReplace=!0,this.Fi.EnableInDocumentParamLocalSearch=!0,this.Fi.EnableInDocumentQuerySuggest=h&&t.AFrameworkApplication.K.$("SmartLookupEnableInDocumentQuerySuggest")||t.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentQuerySuggest",!1),this.Fi.EnableInDocumentQuestionGeneration=h&&t.AFrameworkApplication.K.$("SmartLookupEnableInDocumentQuestionGeneration")||
t.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentQuestionGeneration",!1),this.Fi.EnableInDocumentGlobalEncoder=h&&t.AFrameworkApplication.K.$("SmartLookupEnableInDocumentGlobalEncoder")||t.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentGlobalEncoder",!1),this.Fi.EnableInDocumentExperiment1=h&&t.AFrameworkApplication.K.$("SmartLookupEnableInDocumentExperiment1")||t.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentExperiment1",
!1),this.Fi.EnableInDocumentExperiment2=h&&t.AFrameworkApplication.K.$("SmartLookupEnableInDocumentExperiment2")||t.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentExperiment2",!1),this.Fi.EnableInDocumentExperiment3=h&&t.AFrameworkApplication.K.$("SmartLookupEnableInDocumentExperiment3")||t.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentExperiment3",!1),this.Fi.EnableZeroTermAutoRefresh=
t.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableZeroTermAutoRefresh",!1),this.Fi.EnableTap3SZeroTerm=t.AFrameworkApplication.K.$("SmartLookupEnableTap3SZeroTerm")||t.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableTap3SZeroTerm",!1),this.Fi.EnableLocalSearch=!0,this.Fi.EnableInDocumentStickyFilters=!0,this.Fi.IntentServiceEndpoint=b,this.Fi.EnablePDFShredding=t.AFrameworkApplication.K.$("SmartLookupEnableSharepointPDFIsEnabled")||
t.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupSharepointPDFEnabled",!1),this.Fi.FilterNonPPTFilesForReuseSlides=t.AFrameworkApplication.K.$("SmartLookupFilterNonPPTFilesForReuseSlides"),this.Fi.UXBundleVersion=bF(),this.Fi.SmartLookupServicePath=dF(),this.Fi.EnableAcronymSearch=!0,this.Fi.UseAltAnswerEndpoint1=t.AFrameworkApplication.K.$("SmartLookupUseAltAnswerEndpoint1")||t.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupUseAltAnswerEndpoint1",
!1),this.Fi.UseAltAnswerEndpoint2=t.AFrameworkApplication.K.$("SmartLookupUseAltAnswerEndpoint2")||t.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupUseAltAnswerEndpoint2",!1),this.Fi.UseAltAnswerEndpoint3=t.AFrameworkApplication.K.$("SmartLookupUseAltAnswerEndpoint3")||t.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupUseAltAnswerEndpoint3",!1),this.Fi.UseNextUXVersion=t.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupCDNNextIsEnabled",
!1),this.Fi.IgnoreNeighborhoodContext=t.AFrameworkApplication.K.$("SmartLookupIgnoreNeighborhoodContextIsEnabled"),this.Fi.ShowDebugInfo="INT"===$B(),this.Fi.DebugCommands=t.AFrameworkApplication.K.getStringFeatureGate("Microsoft.Office.SharedOnline.EnableSmartLookupDebugCommands",""),this.Fi.ChangeGates=t.AFrameworkApplication.K.getStringFeatureGate("Microsoft.Office.SharedOnline.SmartLookupChangeGateNames",""),this.Fi.QnaInMixSection=!0,this.Fi.EnableNoteSearch=t.AFrameworkApplication.K.$("SmartLookupNoteSearchIsEnabled")||
t.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupNoteSearchIsEnabled",!1),this.Fi.EnableWikiL2=t.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupWikipediaL2Enabled",!1),this.Fi.EnableFilteringOutRedundantKPE=t.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableFilteringOutRedundantKPE",!1),this.Fi.EnableZeroTermEntitySuggestion=t.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableZeroTermEntitySuggestion",
!1),this.Fi.RankingModels=t.AFrameworkApplication.K.getStringFeatureGate("Microsoft.Office.SharedOnline.SmartLookupRankingModels",""),this.Fi.EnableClientSideRendering=!0,this.Fi.SharedSerpletFeatureGate1=t.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate1",!1),this.Fi.SharedSerpletFeatureGate2=t.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate2",!1),this.Fi.SharedSerpletFeatureGate3=t.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate3",
!1),this.Fi.SharedSerpletFeatureGate4=t.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate4",!1),this.Fi.SharedSerpletFeatureGate5=t.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate5",!1),this.Fi.SharedSerpletFeatureGate6=t.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate6",!1),this.Fi.SharedSerpletFeatureGate7=t.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate7",
!1),this.Fi.SharedSerpletFeatureGate8=t.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate8",!1),this.Fi.SharedSerpletFeatureGate9=t.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate9",!1),this.Fi.SharedSerpletFeatureGate10=t.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate10",!1),this.Fi.SharedSerpletFeatureGate11=t.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate11",
!1),this.Fi.SharedSerpletFeatureGate12=t.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate12",!1),this.Fi.SharedSerpletFeatureGate13=t.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate13",!1),this.Fi.SharedSerpletFeatureGate14=t.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate14",!1),this.Fi.SharedSerpletFeatureGate15=t.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate15",
!1),this.Fi.SharedSerpletFeatureGate16=t.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate16",!1),this.Fi.SharedSerpletFeatureGate17=t.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate17",!1),this.Fi.SharedSerpletFeatureGate18=t.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate18",!1),this.Fi.SharedSerpletFeatureGate19=t.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate19",
!1),this.Fi.SharedSerpletFeatureGate20=t.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate20",!1),this.Fi.SharedSerpletFeatureGate21=t.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate21",!1),this.Fi.SharedSerpletFeatureGate22=t.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate22",!1),this.Fi.SharedSerpletFeatureGate23=t.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate23",
!1),this.Fi.SharedSerpletFeatureGate24=t.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate24",!1),this.Fi.SharedSerpletFeatureGate25=t.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate25",!1),this.Fi.SharedSerpletFeatureGate26=t.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate26",!1),this.Fi.SharedSerpletFeatureGate27=t.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate27",
!1),this.Fi.SharedSerpletFeatureGate28=t.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate28",!1),this.Fi.SharedSerpletFeatureGate29=t.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate29",!1),this.Fi.SharedSerpletFeatureGate30=t.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate30",!1),this.Fi.SharedSerpletFeatureGate31=t.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate31",
!1),this.Fi.SharedSerpletFeatureGate32=t.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate32",!1),this.Fi.SharedSerpletFeatureGate33=t.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate33",!1),this.Fi.SharedSerpletFeatureGate34=t.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate34",!1),this.Fi.SharedSerpletFeatureGate35=t.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate35",
!1),this.Fi.SharedSerpletFeatureGate36=t.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate36",!1),this.Fi.SharedSerpletFeatureGate37=t.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate37",!1),this.Fi.SharedSerpletFeatureGate38=t.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate38",!1),this.Fi.SharedSerpletFeatureGate39=t.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate39",
!1),this.Fi.SharedSerpletFeatureGate40=t.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate40",!1);this.nrc=Sa.a.instance.resolve("Common.App.SearchCommon.ISearchOAuthManager");this.fFb=!!t.AFrameworkApplication.K&&t.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableOAuthManager",!1);this.qhb=oG.isEnterpriseUser();this.rNa=t.AFrameworkApplication.K.lb("SmartLookupShredderServiceEndpoint");this.Ryf=Rc.a.i2(t.AFrameworkApplication.K.lb("AppCatalogUrl")||
"");this.uDm=t.AFrameworkApplication.K.lb("UserPrincipalName");(this.qhb||this.fFb)&&this.fZh()}$Il(b){return t.AFrameworkApplication.K.getStringFeatureGate("Microsoft.Office.SharedOnline."+b,"")}PIl(){const b=t.AFrameworkApplication.K.OXa,h=t.AFrameworkApplication.K.KB("SmartLookupFlightKeywordList"),r=[];if(b&&h&&0<h.length)for(let R in b){var z={key:R,value:b[R]};z=z&&z.key?z.key:"";for(let ba=0;ba<h.length;ba++)if(-1<z.toLowerCase().indexOf(h[ba].toLowerCase())){const ta=z.split(".");ta&&4===
ta.length&&Array.add(r,ta[ta.length-1])}}return r}Mhf(b,h,r,z){return new Promise(R=>{this.Jkm().then(ba=>{const ta=new DK;ta.anid="";ta.applicationName=3===t.AFrameworkApplication.ua.Sb.jo?"WORD":"POWERPNT";ta.applicationVersion=t.AFrameworkApplication.buildVersion;ta.appCorrelationId=b?b:Qt.Jzb();ta.themePlatform="web";ta.lcid=t.AFrameworkApplication.lcid;ta.launchUtcTime=(new Date).toUTCString();t.AFrameworkApplication.K.$("SmartLookupFeatureGateV2")?ta.featureGates=y.c(this.gu):ta.featureGates=
y.c(this.Fi);var Wa=Sj.a.pg(t.AFrameworkApplication.lcid);Wa=Wa?Wa.name:null;ta.market=mG(Wa);ta.uiLanguage=Wa;ta.sessionId=t.AFrameworkApplication.userSessionId;ta.themeId=r;ta.parentalControl="yes";ta.processorOnlyMode=ba;ta.isEditingAllowed=h.isEditingAllowed();ta.isFeedbackEnabled=this.Voi;ta.isClientSideRendering=18===z||19===z||15===z;ta.disableClipboard=t.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SerpletRestrictCopyWithIRMEnabled",!1)&&t.AFrameworkApplication.jO&&
!t.AFrameworkApplication.N0b;ta.accessToken=this.qhb||this.fFb?this.fZh():"";ba=new FK;ba.CountryCode=mG(Wa);ba.ServiceEndpoint=this.rNa;ba.IsGoLocal=t.AFrameworkApplication.K.$("IsGoLocalEnvironment");ba.IsEnabled=this.qhb;ba.IsEnterpriseEnabled=this.qhb;ba.TenantRoot=this.Ryf;ba.Upn=this.uDm;ta.enterpriseUserInfo=ba;ba=new EK;ba.filePath=t.AFrameworkApplication.K.lb("EditDocInClientUrl");ba.docName=t.AFrameworkApplication.K.lb("FileName");ba.author=99!==z?h.author():null;ba.createdDate=99!==z?h.createdDate():
null;ta.currentDocument=ba;R(ta)})})}Jkm(){return new Promise(b=>{this.qy?this.qy.execute(h=>{h.isFeatureEnabled(Lh.u_n,!0).then(r=>{b(!r)}).catch(r=>{Pl.WA("SearchHelper - Failed to load the SmartLookup state from application feature helper: "+r.toString(),10);b(!0)})}):b(!0)})}X3m(b){this.nrc&&(this.qhb||this.fFb)&&this.e0h(this.rNa).then(h=>{b(h)})}fZh(){if("Dev Box"===t.AFrameworkApplication.K.lb("StatusBarEnvironmentNameToUse")&&void 0!==window.SearchPaneShredderTokenOverride&&null!==window.SearchPaneShredderTokenOverride)return window.SearchPaneShredderTokenOverride;
const b=this.fFb?"Search":"SmartLookup";return this.nrc?this.nrc.FMl(b,this.rNa,this.fFb):""}e0h(b){if("Dev Box"===t.AFrameworkApplication.K.lb("StatusBarEnvironmentNameToUse")&&void 0!==window.SearchPaneShredderTokenOverride&&null!==window.SearchPaneShredderTokenOverride)return new Promise(r=>{r(window.SearchPaneShredderTokenOverride)});const h=this.fFb?"Search":"SmartLookup";return this.nrc?this.nrc.getToken(h,b,this.fFb):Promise.resolve("")}EJc(){return this.wub?this.wub.getVersion():""}Crl(){return t.AFrameworkApplication.K.$("SmartLookupFeatureGateV2")?
y.c(this.gu):y.c(this.Fi)}static isEnterpriseUser(){const b=t.AFrameworkApplication.K.lb("SovereignEnvironmentName"),h=t.AFrameworkApplication.K.$("IsTellMeUpSellEnterpriseEnabled");return(!b||!b.length)&&h}}Object(n.a)(oG,"SearchHelper",null,[289]);class aC{constructor(){aC._instance=""}getVersion(){return aC._instance}bQn(b){aC._instance=b}}aC._instance=null;Object(n.a)(aC,"SmartLookupVersion",null,[]);class HK{}Object(n.a)(HK,"ConfigurationProvider",null,[]);class RC{constructor(b){RC._instance=
b}Def(){return RC._instance}}RC._instance=null;Object(n.a)(RC,"SearchHostRuntime",null,[]);class pG{constructor(){this.mca=this.BNb=this.W=null}get name(){return"Common.App.Insights"}yc(b){this.W=b;const h=Sg.a.Kq(Sa.a.instance.Za("Common.IEventEmitter<Common.IGetMoreInfoResult>")),r=t.AFrameworkApplication.K.$("SmartLookupEnableNativePane")||t.AFrameworkApplication.K.$("SmartLookupIsEnabled");b.register(lG,"Common.App.Insights.InsightsActor").singleInstance().Yd(()=>new lG(b.ef("Common.App.Insights.IInsightsManager"),
t.AFrameworkApplication.ya,mn.a.instance,ve.FocusManager.instance(),b.Za("Common.App.SearchCommon.ISearchOAuthManager"),t.AFrameworkApplication.K,Oe.a.instance,r,new De.a(()=>h.result)));b.register(288,"Common.App.Insights.IDocumentContentExtractionManager").singleInstance().Yd(()=>new zK(b));r&&(b.register(aC,"Common.App.Insights.SmartLookupVersion").singleInstance().Yd(()=>new aC),b.register(289,"Common.App.SearchCommon.ISearchHelper").singleInstance().Yd(()=>new oG(Sa.a.instance.Za("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"),
b.Pa("Common.App.Insights.SmartLookupVersion"))))}init(){t.AFrameworkApplication.EZ&&(this.BNb=this.W.Pa("Common.App.Insights.InsightsActor"),this.BNb.Vb())}h_k(){this.q7l()}q7l(){CM().then(b=>{if(""!==b){const h=this.W.Pa("Common.App.Insights.SmartLookupVersion");h&&h.bQn(b)}this.fAd();this.BNb=this.W.resolve("Common.App.Insights.InsightsActor");b=DM(b);b=hc.a.create(b);b.VV((h,r)=>{r.succeeded?this.aRn()&&this.prefetchZeroTerm():Pl.WA("InsightsPackage - Failed to load SmartLookupHostRuntime script. ResourceURL: "+
r.dC,10);this.BNb.Vb()});Rb.a.XS(b)})}aRn(){const b=Object.assign(new HK,{channelId:Lh.channelId,approvedOriginPattern:cF()?"^(http)?://(localhost:8080)$":t.AFrameworkApplication.K.lb("SmartLookupApprovedOriginPattern")});var h=this.W.resolve("Common.App.SearchCommon.IDocumentContentExecutor");const r=this.W.resolve("Common.App.SearchCommon.ISerpletExecutor"),z=this.W.resolve("Common.App.SearchCommon.IInsertContentExecutor"),R=new Ua.a;h&&R.add(h);r&&R.add(r);z&&R.add(z);h=BK();try{const ba=new CK,
ta=SmartLookupHostRuntime.setup(b,R.toArray(),!0,h,ba);this.W.register(RC,"Common.App.SearchCommon.SearchHostRuntime").singleInstance().Yd(()=>new RC(ta));return!0}catch(ba){return Pl.WA("InsightsPackage - Failed to setup SmartLookupHostRuntime during package initialization. Error: "+ba,10),!1}}prefetchZeroTerm(){if(t.AFrameworkApplication.K.$("SmartLookupEnableInDocumentSearch")||t.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentSearch",!1)){var b=
Sa.a.instance.Pa("Common.App.SearchCommon.SearchHostRuntime");if(b){const h=this.W.resolve("Common.App.SearchCommon.ISearchHelper"),r=this.W.resolve("Common.App.SearchCommon.IDocumentHelper");h.Mhf(null,r,0,99).then(z=>{b.Def().prefetchZeroTerm(z,t.AFrameworkApplication.userSessionId,dF(),!0,"Indoc",null)})}else Pl.WA("InsightsPackage - Failed to prefetch zero term because we failed to resolve the HostRuntime.",15)}}fAd(){var b=this.W.resolve("Common.App.SearchCommon.ISearchHelper");const h=nG(b.EJc());
b=b.EJc();b=ZD()+(""!==b?b:Lh.S0c)+"/scripts/microsoft.office.smartlookup.ssr.js";const r=EM();X.a.S$?this.g_k(h,b):(this.e_k(h,r),this.f_k(b,r))}e_k(b,h){const r=new Sys.Net.WebRequest;r.set_httpVerb("GET");const z={};z.method=r.get_httpVerb();r.set_url(b);const R=(new Date).getTime();try{window.fetch(r.getResolvedUrl(),z).then(()=>{""!==h&&Pl.FWf(h,b,(new Date).getTime()-R);this.W.Pa("Common.App.Insights.SmartLookupVersion")})}catch(ba){Pl.WA("InsightsPackage - Failed to prefetch Html file because of HttpException. Error: "+
ba.toString(),10)}}f_k(b,h){var r=new Sys.Net.WebRequest;r.set_httpVerb("GET");const z={};z.method=r.get_httpVerb();r.set_url(b);let R=-1;if(t.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableSerpletPrefetchJSOnIdle",!1))r=t.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.SharedOnline.SerpletPrefetchDelayInMs",3E5),Oe.a.instance.$b(new Ic.a(5,1,r,()=>{const ba=hc.a.create(b);ba.hPe(()=>{R=Date.now()});ba.VV((ta,Wa)=>{Wa.succeeded?""!==h&&Pl.FWf(h,b,Date.now()-
R):Pl.WA("InsightsPackage - Failed to prefetch JS file.",10)});Rb.a.XS(ba)}));else{R=Date.now();try{window.fetch(r.getResolvedUrl(),z).then(()=>{""!==h&&Pl.FWf(h,b,Date.now()-R)})}catch(ba){Pl.WA("InsightsPackage - Failed to prefetch JS file because of HttpException. Error: "+ba.toString(),10)}}}g_k(b,h){if(X.a.S$){var r=t.AFrameworkApplication.Xe;b=new YE.a(b,1,null,null,!0,2,null);r.send(b).LDa(z=>{z&&z.data?z.data.Ge?this.W.Pa("Common.App.Insights.SmartLookupVersion"):Pl.WA("InsightsPackage - Request for Html with ClientRequestManager returned empty ResponseData. StatusCode: "+
z.data.wf,10):Pl.WA("InsightsPackage - Request for Html with ClientRequestManager returned no Data.",10)},z=>{z&&z.data?Pl.WA("InsightsPackage - Failed to prefetch Html file with ClientRequestManager. StatusCode: "+z.data.wf,10):Pl.WA("InsightsPackage - Failed to prefetch Html file with ClientRequestManager. Unknown HTTP Failure.",10)});t.AFrameworkApplication.K.$("SmartLookupPrefetchJSIsEnabled")&&(h=new YE.a(h,1,null,null,!0,2,null),r.send(h).LDa(z=>{z&&z.data?z.data.Ge||Pl.WA("InsightsPackage - Request for SSR JS with ClientRequestManager returned empty ResponseData. StatusCode: "+
z.data.wf,10):Pl.WA("InsightsPackage - Request for SSR JS with ClientRequestManager returned no Data.",10)},z=>{z&&z.data?Pl.WA("InsightsPackage - Failed to prefetch JS SSR file with ClientRequestManager. StatusCode: "+z.data.wf,10):Pl.WA("InsightsPackage - Failed to prefetch JS SSR file with ClientRequestManager. Unknown HTTP Failure.",10)}))}}dispose(){this.BNb&&this.BNb.dispose()}}Object(n.a)(pG,"InsightsPackage",null,[1,2]);var IK=d(1558);class JK{constructor(){this.documentContentTableName=this.dataCenterEndpoint=
this.documentContentKey=null}}Object(n.a)(JK,"DocumentContentParams",null,[]);var eF=d(1802),KK=d(534),$D=d(734),rs;(function(b){b.UQa="SearchProvider";b.YQa="TextSummarization"})(rs||(rs={}));Object(n.b)("WorkflowType",rs);var Rt;(function(b){b.Success="Success";b.zcg="Invoked";b.Error="Error";b.Timeout="Timeout";b.ksj="StaleAnnotation";b.rnj="AugloopLateResponse"})(Rt||(Rt={}));Object(n.b)("LogType",Rt);class fF{constructor(b){this.dBh=b;this.nGf=this.nGf.bind(this);this.VTc=this.VTc.bind(this);
this.R7n=t.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.WordOnline.TextSummarizationRequestTimeout",5E3)}submitDocumentContentExtractionSignal(){return Object(Ht.__awaiter)(this,void 0,void 0,function*(){try{this.tDn=Date.now();this.Yjb=pa.a.create().toString();this.logMessage({EE:rs.UQa,logType:Rt.zcg,success:!0,correlationId:this.Yjb,message:"[SearchProvider] workflow invoked"});var b=$B().toLowerCase();b="int"===b||"local"===b;yield this.activateAnnotation();const h=new He.l({parentPath:["Signal",
eF.SearchProviderSignal.getTypeName()],items:[{id:"SearchProvider",body:new eF.SearchProviderSignal({correlationId:this.Yjb,shouldUseIntEndpoint:b})}]});augLoop.ALFactoryGlobal.getAugLoopRuntimeManager().submitOperation({operation:h});this.FVi=window.setTimeout(()=>{this.onError(rs.UQa,Rt.Timeout,"[SearchProvider] request timed out")},1500)}catch(h){window.clearTimeout(this.FVi),this.onError(rs.UQa,Rt.Error,this.kQh(h))}})}generateDocumentSummary(){return Object(Ht.__awaiter)(this,void 0,void 0,function*(){try{this.Q7n=
Date.now();if(!fF.M7b)return this.logMessage({EE:rs.YQa,logType:Rt.Error,success:!1,message:"[TextSummary] workflow disbled by flight"}),null;this.logMessage({EE:rs.YQa,logType:Rt.zcg,success:!0,message:"[TextSummary] workflow invoked"});yield this.activateAnnotation();const b=new He.l({parentPath:["Signal",$D.GenerateTextSummarySignal.getTypeName()],items:[{id:"TextSummarization",body:new $D.GenerateTextSummarySignal}]});augLoop.ALFactoryGlobal.getAugLoopRuntimeManager().submitOperation({operation:b});
this.m5f=window.setTimeout(()=>{this.onError(rs.YQa,Rt.Timeout,"[TextSummary] request timed out")},this.R7n);return new Promise(h=>{this.Efc=h})}catch(b){window.clearTimeout(this.m5f),this.onError(rs.YQa,Rt.Error,this.kQh(b))}})}static get M7b(){return t.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.FA000000029.ContentCreationSummaryEnabled",!1)}activateAnnotation(){return Object(Ht.__awaiter)(this,void 0,void 0,function*(){if(!this.K5b){yield pk.a.En();var b=augLoop.ALFactoryGlobal.getAugLoopRuntimeManager().activateAnnotation,
h=[b(Object.assign(new KK.a,{annotationType:eF.SearchProviderAnnotation.getTypeName(),handler:this.nGf}))];fF.M7b&&h.push(b(Object.assign(new KK.a,{annotationType:$D.TextSummaryAnnotation.getTypeName(),handler:this.VTc})));yield Promise.all(h);this.K5b=!0}})}VTc(b){if(this.Efc)if(this.nfi(b)){if(b=b.items[0],$D.TextSummaryAnnotation.typeGuard(b.body))if(window.clearTimeout(this.m5f),b=b.body,b.status!==$D.Result.Success)this.onError(rs.YQa,Rt.Error,`[TextSummary] workflow failed with status: ${b.status}`);
else this.logMessage({EE:rs.YQa,logType:Rt.Success,success:!0,message:"[TextSummary] workflow completed successfully"}),this.Efc(b.summary),this.Efc=null}else this.logMessage({EE:rs.YQa,logType:Rt.Error,success:!1,message:"[TextSummary] operation values invalid"});else window.clearTimeout(this.m5f),this.logMessage({EE:rs.YQa,logType:Rt.Error,success:!1,message:"[TextSummary] summary callback is not defined"})}nGf(b){if(this.nfi(b)&&(b=b.items[0],eF.SearchProviderAnnotation.typeGuard(b.body)))if(window.clearTimeout(this.FVi),
(b=b.body)&&(b.docContentKey||b.dataCenterEndpoint||b.documentContentTableName))if(void 0===this.Yjb)this.logMessage({EE:rs.UQa,logType:Rt.rnj,success:!1,correlationId:b.correlationId,message:"[SearchProvider] workflow results arrived after timeout",workflowExecutionTime:b.workflowExecutionTime});else if(this.Yjb!==b.correlationId)this.logMessage({EE:rs.UQa,logType:Rt.ksj,success:!1,correlationId:b.correlationId,message:"[SearchProvider] current correlation Id is not the one pending",workflowExecutionTime:b.workflowExecutionTime});
else{var h=this.wth(b.docContentKey,b.dataCenterEndpoint,b.documentContentTableName);this.logMessage({EE:rs.UQa,logType:Rt.Success,success:!0,correlationId:b.correlationId,message:"[SearchProvider] workflow completed successfully",workflowExecutionTime:b.workflowExecutionTime});this.Yjb=void 0;this.dBh.JYi(h)}else this.onError(rs.UQa,Rt.Error,"[SearchProvider] annotation is empty or incorrect")}nfi(b){return b&&b.items&&0<b.items.length&&b.items[0].body}logMessage(b){var h=b.EE===rs.UQa?this.tDn:
this.Q7n;const r=Date.now(),z=h?r-h:-1;h=[Object.assign(new ca.a,{name:"WorkflowType",string:b.EE}),Object.assign(new ca.a,{name:"LogType",string:b.logType}),Object.assign(new ca.a,{name:"CorrelationId",string:b.correlationId}),Object.assign(new ca.a,{name:"Message",string:b.message}),Object.assign(new ca.a,{name:"WorkflowExecutionTime",int64:b.workflowExecutionTime}),Object.assign(new ca.a,{name:"StartTime",int64:h}),Object.assign(new ca.a,{name:"EndTime",int64:r}),Object.assign(new ca.a,{name:"Duration",
int64:z})];Object(Lb.a)("AugloopSearchProviderData",b.success,z,h)}kQh(b){return`Error: ${b}, Message: ${b.message}, Stack: ${b.stack}`}wth(b="",h="",r=""){return Object.assign(new JK,{documentContentKey:b,dataCenterEndpoint:h,documentContentTableName:r})}onError(b,h,r){if(b===rs.UQa){if(!this.Yjb)return;this.logMessage({EE:b,logType:h,success:!1,correlationId:this.Yjb,message:r});this.Yjb=void 0;this.V6k()}b===rs.YQa&&this.Efc&&(this.logMessage({EE:b,logType:h,success:!1,message:r}),this.Efc(null),
this.Efc=null)}V6k(){this.dBh.JYi(this.wth())}}Object(n.a)(fF,"AugloopSearchProviderManager",null,[]);class gF{constructor(){this.results=null;this.totalResultCount=0;this.hasTooManyResults=!1}}Object(n.a)(gF,"DocumentContentSearchResults",null,[]);class qG{getAllParagraphsInDocument(){return null}selectRange(){}selectRangeV2(b,h,r,z,R){this.selectRange(h,r,z,R)}search(){}searchV2(b,h){this.search(b,r=>{h(Object.assign(new gF,{results:r,totalResultCount:r.length,hasTooManyResults:100<r.length}))})}searchWithParam(b,
h){this.search(b.query,h)}searchWithParamV2(b,h){this.searchWithParam(b,r=>{h(Object.assign(new gF,{results:r,totalResultCount:r.length,hasTooManyResults:r.length>b.totalResultLimit}))})}highlight(){}highlightWithParam(b){this.highlight(b.query)}getRevision(){return null}getDocumentSelection(){return null}clearDocumentSelection(){}selectNextPrevHighlight(){return-1}getSelectedText(){return null}submitDocumentContentExtractionSignal(){}generateDocumentSummary(){return new Promise(b=>{b(null)})}extractDocumentObjects(){}getId(){return"DocumentContentExecutor"}}
Object(n.a)(qG,"BaseDocumentContentExecutor",null,[908,154]);var rG=d(1940),LK=d(1440);class hF{constructor(){this.query=null;this.matchWholeWordOnly=this.matchCase=!1;this.totalResultLimit=0}}Object(n.a)(hF,"DocumentContentSearchParams",null,[]);class sG{constructor(){this.subdocumentId=null;this.endParagraphOffset=this.endParagraphIndex=this.startParagraphOffset=this.startParagraphIndex=0}}Object(n.a)(sG,"DocumentSelection",null,[]);var SC=d(683);class tG{constructor(){this.lGc=this.cYe=0}}Object(n.a)(tG,
"CommentFindResultIndexInfo",null,[]);const uG=(b,h)=>{var r;if(null===(r=t.AFrameworkApplication.K)||void 0===r?0:r.getBooleanFeatureGate("Microsoft.Office.WordOnline.FindPaneSafeCollapseToIp",!1))b.setSelection(Xd.SelectionEditor.Pj(b.hb.kb,!0,!1));else{r=b.hb.kb;if(!r||!r.length)return null;r=r.Qa;h=h.xe(r.node,r.hl);b.setSelection(h)}};class MK{constructor(){this.subdocumentId=this.snippet=null;this.endOffsetInParagraph=this.startOffsetInParagraph=this.paragraphIndex=this.endOffsetInSnippet=this.startOffsetInSnippet=
this.subdocumentType=0}}Object(n.a)(MK,"DocumentContentSearchResult",null,[]);var FM=d(1763);class NK{constructor(){this.izb=this.gYe=null}}Object(n.a)(NK,"CommentFindResults",null,[]);class OK{constructor(){this.end=this.begin=0}}Object(n.a)(OK,"FindResultOffset",null,[]);class lA{constructor(b,h,r,z,R,ba,ta,Wa,ub,Ib,$b){this.xje=this.Pu=this.zpe=this.cA=null;this.A3g=0;this.Nt=null;this.Ukc=new Ua.a;this.Iyg=null;this.vG=b;this.fb=h;this.jtb=r;this.Jca=R;this.qQb=ba;this.znc=ta;this.ii=Wa;this.ga=
ub;this.ib=Ib;this.kA=$b}get eka(){return this.Iyg}initialize(){this.cA=tr.FindManager.createInstance(this,this.Jca,uy.a.instance,!1,!0)}search(b,h){this.cA.VVa();this.Wsf(b)?(this.Pu=h,this.Nt=new Ua.a,b=this.D0e(b),this.cA.find(b)):h(null)}searchV2(b,h){t.AFrameworkApplication.Hl("Microsoft.Office.Web.SessionSettings.IWacWordCommentsInFindPaneSettings");this.cA.VVa();if(this.Wsf(b)){this.Adi()&&this.ga.Xb(ab.a.P6d,2,{CommandValueId:b});this.xje=h;this.A3g=b.totalResultLimit;this.Nt=new Ua.a;b=this.D0e(b);
this.Iyg=new kl.a;this.cA.find(b);h=this.Jca.qVc(b.text);h=this.Jca.VGb(h);b=this.qQb.w3b(h.join("|"),b);h=this.ii.gT();for(let R=0;R<h.length;R++){const ba=h[R];var r=rG.a.wHd(ba.text[0]).split("\n");r=1===r.length?r[0]:r.join(" ");var z=this.znc.rKc(r,b);if(z)for(let ta of z)z=FM.a.createInstance(ta.begin,ta.end,E.a.Of(ba.objectId),R,32,!1),this.Ukc.add(z),this.eka.xb(R)||this.eka.add(R,Object.assign(new NK,{gYe:r,izb:[]}));else v.ULS.sendTraceTag(572343620,313,15,"commentTextIsNull: {0}, findRegexIsNull: {1}",
!r,!b)}}else h(null)}get LHh(){null==this.zpe&&(this.zpe=tr.FindManager.createInstance(this,this.Jca,uy.a.instance));return this.zpe}Adi(){var b;return null===(b=t.AFrameworkApplication.K)||void 0===b?void 0:b.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate32",!1)}WOd(){var b;return null===(b=t.AFrameworkApplication.K)||void 0===b?void 0:b.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletEnableInDocHeaderFooterSearchOnWac",!1)}highlight(b){var h=this.Wsf(b);
b=h?this.D0e(b):null;var r={};this.Adi()&&this.ga.Xb(Oa.a.uPf,2,r);if(r[Yf.a.On]){if(h){h={};r={};var z={};this.ga.Xb(Oa.a.i1d,2,h);this.ga.Xb(ab.a.h1d,2,r);this.ga.Xb(ab.a.j1d,2,z);if(b.text!=h.CommandValueId||b.matchCase!=r[Yf.a.On]||b.matchWholeWord!=z[Yf.a.On])uG(this.ib,this.kA),this.ga.Xb(ab.a.findInDocument,2,{CommandValueId:b.text,MatchCase:b.matchCase,MatchWholeWord:b.matchWholeWord})}}else r=this.LHh,r.VVa(),h&&r.find(b)}selectNextPrevHighlight(b){const h=this.LHh;return 0<h.Ej.lha?(b?h.dJd():
h.eJd(),h.Ej.zNe-1):-1}D0e(b){let h=er.a.none;b.matchCase&&(h|=er.a.matchCase);b.matchWholeWordOnly&&(h|=er.a.wholeWordOnly);return fB.a.createQuery(b.query,h)}Wsf(b){return b&&!!b.query&&0<b.query.length}I7d(){}j6d(){}reset(){}z9e(){}w1b(){if(this.Pu){var b=this.xth(this.Nt);this.Pu(b)}if(this.xje){b=new gF;const h=this.Nt.count+this.Ukc.count>this.A3g;b.totalResultCount=this.Nt.count+this.Ukc.count;b.hasTooManyResults=h;h||(this.Nt.EA(this.Nt.count,this.Ukc),b.results=this.xth(this.Nt));this.xje(b);
this.Ukc.clear()}}xth(b){const h=[];var r=Object.assign(new SC.a,{xZa:!1,yZa:this.WOd(),zZa:!0});r=this.fb.sLa(this.vG.value,r);for(let R of b){var z=R.begin;let ba=R.end,ta;b=-1;let Wa=null,ub=0;if(32===R.type){Wa=lA.pph;ub=3;b=r.count+R.Reb;const Ib=({begin:z,end:ba}=IK.a.vNi(this.eka.J(R.Reb).gYe,z,ba)).returnValue;ta=this.jtb.J0e(Ib,z,ba,ty.a(R.type));this.eka.J(R.Reb).gYe=Ib;this.eka.J(R.Reb).izb.push(Object.assign(new OK,{begin:z,end:ba}))}else{!this.WOd()||2!==R.type&&4!==R.type||(ub=2===R.type?
1:2,Wa=lA.blf);for(z=0;z<r.count;z++)if(r.J(z).id===R.nodeId){b=z;break}ta=this.jtb.Uxd(R)}0<=b&&(b=Object.assign(new MK,{snippet:ta.EZe,subdocumentId:Wa,subdocumentType:ub,startOffsetInSnippet:ta.FUf,endOffsetInSnippet:ta.CUf-1,paragraphIndex:b,startOffsetInParagraph:R.begin-ta.FUf,endOffsetInParagraph:R.end-ta.CUf-1}),h.push(b))}h.sort((R,ba)=>R.paragraphIndex===ba.paragraphIndex?R.startOffsetInParagraph-ba.startOffsetInParagraph:R.paragraphIndex-ba.paragraphIndex);return h}update(){}WKa(b,h){switch(b){case 0:h&&
0<h.length&&!this.Nt&&(v.ULS.sendTraceTag(570975814,313,15,"Results container list is null"),this.Nt=new Ua.a);for(let r of h)this.Nt.add(r)}}tkb(){}dispose(){}}lA.pph="Comment";lA.blf="HeaderFooter";Object(n.a)(lA,"WordDocumentSearchProcessor",null,[284,9,285]);class PK extends qG{constructor(b,h,r,z,R,ba,ta,Wa,ub,Ib,$b,fc,Kc){super();this.Oa=Ib;this.qUa=null;this.Y2=(ed,Jd)=>{ed=Jd.node;Jd=Jd.property;this.s_f(ed)&&Jd===We.a.lo&&this.vBb(ed,3)};this.Sfa=(ed,Jd)=>{ed=Jd.node;!Jd.Zpf&&this.s_f(ed)&&
this.vBb(ed,1)};this.oib=(ed,Jd)=>{ed=Jd.node;this.s_f(ed)&&this.vBb(ed,2)};this.vG=b;this.fb=h;this.Zc=r;this.ib=z;this.kA=R;this.ol=Wa;this.Wb=ub;this.m9=ba;this.rv=ta;this.ii=$b;this.KHj=fc;this.OYg=E.a.create();this.f3d(this.Y2,this.Sfa,this.oib);Kc.execute(ed=>{this.dld=ed})}get pO(){return!this.Oa.getBooleanFeatureGate("Microsoft.Office.WordOnline.NoCommentFocusOnFindSelection",!1)}WOd(){var b;return null===(b=t.AFrameworkApplication.K)||void 0===b?void 0:b.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletEnableInDocHeaderFooterSearchOnWac",
!1)}submitDocumentContentExtractionSignal(){this.dld&&this.dld.submitDocumentContentExtractionSignal()}generateDocumentSummary(){return this.dld?this.dld.generateDocumentSummary():Promise.resolve(null)}getAllParagraphsInDocument(){var b=Object.assign(new SC.a,{xZa:!1,yZa:!1,zZa:!0});const h=this.fb.sLa(this.vG.value,b);b=new Ua.a;for(var r of h)b.add(this.mHd(r));for(let z of this.ii.gT())r=rG.a.wHd(z.text[0]).split("\n"),r=1===r.length?r[0]:r.join(" "),b.add(r);return b.toArray()}extractDocumentObjects(b){var h=
Object.assign(new SC.a,{xZa:!1,yZa:!1,zZa:!0});h=this.fb.sLa(this.vG.value,h);const r=[];for(let z=0;z<h.count;++z)r.push(...this.vvl(h.J(z),z));b({images:r})}selectRange(b,h,r,z,R){const ba=Date.now(),ta={activityName:"InDocSelectRangeData",success:!0,message:"Select Range Succeeded",duration:0};try{this.Q2a();if(0>b||0>h||0>r||0>z||b>r||b===r&&h>z)throw Error("Provided select range offsets incorrect");const ed=Object.assign(new SC.a,{xZa:!1,yZa:!1,zZa:!0}),Jd=this.fb.sLa(this.vG.value,ed);if(r>=
Jd.count){const ge=Sa.a.instance.resolve("Common.Comments.ICommentModel").gT(),qe=r-Jd.count;if(qe<ge.length){R=-1;if(this.m9.eka.xb(qe)){const Bd=this.m9.eka.J(qe).izb;for(var Wa=0;Wa<Bd.length;Wa++)if(Bd[Wa].begin===h){R=Wa;break}}this.qUa=-1!==R?Object.assign(new tG,{cYe:qe,lGc:R}):null;const Ve=ge[qe];t.AFrameworkApplication.ya.processAction(Oa.a.KS,2);t.AFrameworkApplication.ya.Xb(Oa.a.T9,2,null);t.AFrameworkApplication.ya.Xb(Oa.a.selectComment,2,Object.assign(new LK.a,{commentId:Ve.id,r3:2,
pO:this.pO}))}}else{this.qUa=null;var ub=Jd.J(b),Ib=Jd.J(r);if(!this.QQd(ub,h)||!this.QQd(Ib,z))throw Error("Provided select range offsets incorrect");t.AFrameworkApplication.ya.processAction(Oa.a.KS,2);this.ibj(ub);var $b=this.kA.xe(ub,h);Wa=this.kA.XC($b,Qe.a.Uc(Ib,z+1));if(R){const ge=Wa.toArray();h=[];for(const qe of ge)h.push(this.mHd(qe.node));h.join(" ").includes(R)||(ta.success=!1,ta.message="The text in clicked passage does not match the selected hit")}var fc=this.ol.value.wv,Kc=this.ib.hb.kb;
Kc&&Kc.equals(Wa)&&this.Zc.$na(fc,null);this.Zc.$na(fc,Wa);ta.duration=Date.now()-ba;this.logMessage(ta)}}catch(ed){ta.success=!1,ta.message=ed.stack,ta.duration=Date.now()-ba,this.logMessage(ta)}}search(b,h){this.Q2a();this.m9.search(Object.assign(new hF,{query:b}),h)}searchV2(b,h){this.Q2a();this.m9.searchV2(Object.assign(new hF,{query:b}),h)}selectNextPrevHighlight(b){this.Q2a();return this.m9.selectNextPrevHighlight(b)}searchWithParam(b,h){this.Q2a();this.m9.search(b,h)}searchWithParamV2(b,h){this.Q2a();
this.m9.searchV2(b,h)}highlight(b){this.Q2a();this.m9.highlight(Object.assign(new hF,{query:b}))}highlightWithParam(b){this.Q2a();this.m9.highlight(b)}getRevision(){return this.OYg.toString()}getSelectedText(){const b=this.KHj.getSelectedText();return Object.assign(new ew.a,{neighborhood:b.neighborhood,mentionStart:b.mentionStart,mentionLength:b.mentionLength})}getDocumentSelection(){var b=Object.assign(new SC.a,{xZa:!1,yZa:this.WOd(),zZa:!0}),h=({lu:ba}=this.BIl(b)).returnValue;if(h)return h;var r=
this.ib.hb.kb;if(!r||!r.length)return null;h=r.Qa;r=r.Tc;let z=-1,R=-1;var ba=ba||this.fb.sLa(this.vG.value,b);b=null;for(let ta=0;ta<ba.count;ta++){const Wa=ba.J(ta);-1===z&&h.node.id===Wa.id&&(z=ta,b=Wa);-1===R&&r.node.id===Wa.id&&(R=ta)}ba=null;5===(null===b||void 0===b?void 0:b.sAa)&&(ba=lA.blf);return Object.assign(new sG,{subdocumentId:ba,startParagraphIndex:z,startParagraphOffset:h.hl,endParagraphIndex:R,endParagraphOffset:r.ut})}clearDocumentSelection(){uG(this.ib,this.kA)}selectRangeV2(b,
h,r,z,R,ba){const ta=Date.now(),Wa={activityName:"InDocSelectRangeData",success:!0,message:"Select Range Succeeded",duration:0};try{this.Q2a();if(0>h||0>r||0>z||0>R||h>z||h===z&&r>R)throw Error("Provided select range offsets incorrect");const Jd=Object.assign(new SC.a,{xZa:!1,yZa:!0,zZa:!0}),ge=this.fb.sLa(this.vG.value,Jd);if(b==lA.pph){const qe=Sa.a.instance.resolve("Common.Comments.ICommentModel").gT(),Ve=z-ge.count;if(Ve<qe.length){ba=-1;if(this.m9.eka.xb(Ve)){const he=this.m9.eka.J(Ve).izb;for(var ub=
0;ub<he.length;ub++)if(he[ub].begin===r){ba=ub;break}}this.qUa=-1!==ba?Object.assign(new tG,{cYe:Ve,lGc:ba}):null;const Bd=qe[Ve];t.AFrameworkApplication.ya.processAction(Oa.a.KS,2);t.AFrameworkApplication.ya.Xb(Oa.a.T9,2,null);t.AFrameworkApplication.ya.Xb(Oa.a.selectComment,2,Object.assign(new LK.a,{commentId:Bd.id,r3:2,pO:this.pO}))}}else{this.qUa=null;var Ib=ge.J(h),$b=ge.J(z);if(!this.QQd(Ib,r)||!this.QQd($b,R))throw Error("Provided select range offsets incorrect");b==lA.blf?t.AFrameworkApplication.ya.Xb(Oa.a.Wgb,
2,new Gy.a(Ib)):t.AFrameworkApplication.ya.processAction(Oa.a.KS,2);this.ibj(Ib);var fc=this.kA.xe(Ib,r);ub=this.kA.XC(fc,Qe.a.Uc($b,R+1));if(ba){const qe=ub.toArray();r=[];for(const Ve of qe)r.push(this.mHd(Ve.node));r.join(" ").includes(ba)||(Wa.success=!1,Wa.message="The text in clicked passage does not match the selected hit")}var Kc=this.ol.value.wv,ed=this.ib.hb.kb;(null===ed||void 0===ed?0:ed.equals(ub))&&this.Zc.$na(Kc,null);this.Zc.$na(Kc,ub);Wa.duration=Date.now()-ta;this.logMessage(Wa)}}catch(Jd){Wa.success=
!1,Wa.message=Jd.stack,Wa.duration=Date.now()-ta,this.logMessage(Wa)}}Q2a(){this.Wb&&(this.Wb.og&&this.Wb.og.name===Lh.ly||this.Wb.Jg(Lh.ly))}ulo(){this.OYg=E.a.create()}mHd(b){if(b.NCb)return"";b=this.fb.text(b);return dd.AParagraphNode.lU(b," ")}QQd(b,h){b=this.mHd(b);return h<b.length}vBb(b,h){switch(h){case 1:case 2:case 3:this.ulo()}}logMessage(b){const h=[Object.assign(new ca.a,{name:"Message",string:b.message})];Object(Lb.a)(b.activityName,b.success,b.duration,h)}s_f(b){return!b.NCb&&this.BOc(b)}BOc(b){const h=
this.vG.value;return!!h&&!!h.zd&&!!b.Lc&&b.Lc.id.equals(h.zd.id)}ibj(b){this.fb.VNc(b)?32===t.AFrameworkApplication.ya.Xb(Oa.a.xib,2,new Gy.a(b))&&t.AFrameworkApplication.ya.processAction(Oa.a.u$e,2):t.AFrameworkApplication.ya.Xb(Oa.a.T9,2,null)}f3d(b,h,r){this.rv&&(this.rv.lp(b),this.rv.ys(h),this.rv.zv(r))}BIl(b){let h=null;var r=this.Wb?this.Wb.og.name:"";if(!this.ii.Ks||r!==ke.AFrame.gr&&r!==ke.AFrame.xL)return{returnValue:null,lu:h};r=Array.indexOf(this.ii.gT(),this.ii.Ks);if(0>r)return{returnValue:null,
lu:h};h=this.fb.sLa(this.vG.value,b);var z=rG.a.wHd(this.ii.Ks.text[0]).split("\n");b=0;z=(1===z.length?z[0]:z.join(" ")).length-1;this.qUa&&r===this.qUa.cYe&&this.m9.eka.xb(r)&&this.m9.eka.J(r).izb.length>this.qUa.lGc&&(b=this.m9.eka.J(r).izb[this.qUa.lGc].begin,z=this.m9.eka.J(r).izb[this.qUa.lGc].end);return{returnValue:Object.assign(new sG,{startParagraphIndex:h.count+r,startParagraphOffset:b,endParagraphIndex:h.count+r,endParagraphOffset:z,subdocumentId:"Comment"}),lu:h}}vvl(b,h){const r=[],
z=b.Lc;if(12!=b.type||!z||!b.hasProperty(We.a.un))return r;const R=b.ia(We.a.un,null);if(!R)return r;b=b.ia(We.a.mm,null);for(let ta=0;ta<R.length;++ta){var ba=R[ta];if(!ba)continue;ba=z.Eb(ba);if(!ba||!$d.ImageReader.TOd(ba))continue;const Wa=ba.ia(od.a.Fu,"");if(0==Wa.length)continue;let ub=0;0!=ta&&b&&ta-1<b.length&&(ub=b[ta-1]);ba={data:{base64Encoding:Wa,width:$d.ImageReader.ZG(ba),height:$d.ImageReader.YJ(ba),altText:$d.ImageReader.lT(ba),description:$d.ImageReader.ZAa(ba)},startParagraphIndex:h,
endParagraphIndex:h,startOffsetInParagraph:ub,endOffsetInParagraph:ub+1};r.push(ba)}return r}}Object(n.a)(PK,"WordDocumentContentExecutor",qG,[]);class iF{isEditingAllowed(){return!0}author(){return null}createdDate(){return null}}Object(n.a)(iF,"BaseDocumentHelper",null,[226]);class QK extends iF{constructor(b){super();this.Pel=b}get Zzd(){const b=this.Pel.instance;b&&b.loadDocumentProperty();return b}isEditingAllowed(){return vb.App.xa.jb.isEditingAllowed}author(){var b;return null===(b=this.Zzd)||
void 0===b?void 0:b.author}createdDate(){var b;return null===(b=this.Zzd)||void 0===b?void 0:b.creationDate}}Object(n.a)(QK,"WordDocumentHelper",iF,[]);class RK{constructor(b){this.soi=b}insertOnlinePicture(){}insertHtmlText(b){b&&this.Unf(b.htmlText)}getId(){return"InsertContentExecutor"}Unf(b){return this.executeCommand(Fb.a.bza,b)}executeCommand(b,h){const r=new Ei.DictionaryPropertySet;r.setValue(od.a.hU,h);r.setValue(od.a.eEa,!1);h=this.soi.processAction(b,1);32===h&&(h=this.soi.Xb(b,2,r));return h}}
Object(n.a)(RK,"WordInsertContentExecutor",null,[153,154]);class SK{constructor(b,h,r){this.Klc="undefined";this.F8l=(z,R,ba,ta,Wa)=>Qt.r6(z,R,ba,ta,this.uC,Wa);this.uC=b;this.ga=h||t.AFrameworkApplication.ya;this.Oa=r;this.qIj=(this.ew=!!t.AFrameworkApplication.ua&&t.AFrameworkApplication.ua.Sb.A6)&&!!this.Oa&&this.Oa.$("AutoOpenSearchPaneInDoublePortraitIsEnabled")}Vb(){this.ga.gb(Oa.a.efh,Yd.a.frame,this.F8l,1028);this.qIj&&(this.Klc=vb.App.xa.wu.getWindowMode(),this.UDh(this.Klc),vb.App.xa.wu.registerBoundingWindowRectsChanged("SearchPane",
(b,h)=>{h!==this.Klc&&(this.Klc=h,this.UDh(this.Klc))}))}UDh(b){"DP"===b&&Uk.UISurfaces.$t().then(h=>{h.selectors.getTabbedTaskPaneCount()||this.ga.Xb(Oa.a.efh,2,{SourceControlId:"smartlookupAuto"});return null})}}Object(n.a)(SK,"WordInsightsActor",null,[]);class TC{constructor(){this.TO=null}uYa(){return this.Y2b()}OSh(){return this.Y2b()}MSh(){return null}MXn(b,h,r){this.TO||(this.TO=this.Fxd());this.TO.qO(b,h,r)}NXn(b,h,r){this.TO||(this.TO=this.Fxd());this.TO.i5i(b,h,r)}qJb(b,h){this.TO||(this.TO=
this.Fxd());this.TO.qJb(b,h)}ERd(b){this.TO||(this.TO=this.Fxd());this.TO.ERd(b)}pFn(){this.TO&&this.TO.Adc()}SJn(){this.TO&&this.TO.D6d()}vVn(){var b=t.AFrameworkApplication.K.rc("SmartLookupLaunchThrottleThresholdInMilliseconds",1500);b=window.performance.now()-TC.hki<=b;b||(TC.hki=window.performance.now());return b}dispose(){this.TO&&(this.TO.dispose(),this.TO=null)}get pDb(){return this.TO?this.TO.isVisible:!1}}TC.hki=0;Object(n.a)(TC,"InsightsManager",null,[935,9]);class aE{constructor(b,h,r,
z,R,ba=!0,ta=null,Wa=null){this.a4=this.eN=this.uHa=null;this.eqc=!1;this.mca=null;this.Wb=h;this.HRb=ba;this.UBg=Wa?Wa:new iF;this.qy=ta;this.Oo=b;this.HRb&&(Sa.a.instance.Pa("Common.App.SearchCommon.SearchHostRuntime")&&(this.mca=Sa.a.instance.resolve("Common.App.SearchCommon.SearchHostRuntime").Def()),this.G9a=Sa.a.instance.resolve("Common.App.SearchCommon.ISearchHelper"),this.wub=this.G9a.EJc())}U0a(b){if(this.HRb){b=b.rawEvent;try{var h=y.a(b.data)}catch(r){v.ULS.sendTraceTag(595161728,1303,
15,this.eT("Message data from Serplet [{0}] failed to deserialize.",b.data));return}switch(h.actionType){case 101:b=0;this.eN&&(b=this.eN.entryPoint);this.G9a.Mhf(this.a4,this.UBg,this.W3b(),b).then(r=>{h.data=r;this.Xib(h)});break;case 118:h.data=this.eN?this.eN:Object.assign(new Pt.a,{selection:Object.assign(new ew.a,{neighborhood:this.uHa.neighborhood,mentionStart:this.uHa.mentionStart,mentionLength:this.uHa.mentionLength})});this.Xib(h);break;case 103:b=y.a(Object(la.a)(String,h.data));Pl.sendTelemetryEvent(b);
break;case 206:this.G9a.e0h(h.data).then(r=>{h.data=r;this.Xib(h)});break;case 112:h.data.shiftPressed?(X.a.gj&&document.activeElement.blur(),this.Oo.qKd(0,null,2,null,null),v.ULS.sendTraceTag(592545156,1303,50,this.eT("Serplet UX lost focus through Ctrl + Shift + F6"))):(this.Oo.yKc(0,null,2,null,null),v.ULS.sendTraceTag(592545155,1303,50,this.eT("Serplet UX lost focus through Ctrl + F6")));break;case 40:this.Hla()}}}uZc(b){if(this.mca){var h=0;this.eN&&(h=this.eN.entryPoint);this.G9a.Mhf(this.a4,
this.UBg,this.W3b(),h).then(r=>{Pl.OWi("SearchFromHost",this.a4);this.eN.launchData||(this.eN.launchData=new Mu.a);const z=dF();try{this.mca.search(this.eN,r,t.AFrameworkApplication.userSessionId,z,b),this.G9a.X3m(R=>{Pl.OWi("SearchFromHostWithToken",this.a4);this.mca.searchAuthenticatedProviders(this.eN,r,t.AFrameworkApplication.userSessionId,z,null,R)})}catch(R){Pl.WA("BaseSmartLookupPane - Fail to search from host. Error: "+R,10)}}).catch(r=>{Pl.WA("BaseSmartLookupPane - Failed to resolve application properties and invoke Search: "+
r.toString(),10)})}}Bdc(b){if(this.HRb){var h=Pl,r=h.Bdc,z=this.a4;b=Math.round(window.performance.now()-b);var R=this.eN?QC[this.eN.entryPoint]:"",ba=this.G9a.EJc(),ta=this.G9a.Crl(),Wa=this.eN?this.eN.entryPoint:0;r.call(h,z,b,R,ba,ta,t.AFrameworkApplication.qQe,this.eqc,18===Wa||19===Wa||15===Wa)}}}Object(n.a)(aE,"BaseSmartLookupPane",null,[212,9]);class bE{constructor(b){this.messageType=null;this.messageType=b}}Object(n.a)(bE,"InsightsMessage",null,[]);class cE extends bE{constructor(b,h){super(b);
this.messageContent=null;this.messageContent=h}}Object(n.a)(cE,"InsightsMessageWithContent",bE,[]);class TK extends cE{constructor(b){super(Lh.ZHm,b)}}Object(n.a)(TK,"InsightsMessageAppProperties",cE,[]);class UK extends cE{constructor(b){super(Lh.lIm,b)}}Object(n.a)(UK,"InsightsMessageSelection",cE,[]);class VK extends bE{constructor(){super(Lh.nIm)}}Object(n.a)(VK,"InsightsMessageTakeFocus",bE,[]);class dE extends aE{constructor(b,h,r,z,R=null,ba=null,ta=null,Wa=!0,ub=null,Ib=null){super(h,r,R,
ba,ta,Wa,ub,Ib);this.T7c=this.eA=this.hh=null;this.Uhd=!1;this.Qcd=b;this.Loc=this.HRb?nG(this.wub):t.AFrameworkApplication.Z6l;this.bZ();this.mRf();this.zp=z;this.LAg=0}get isVisible(){return!1}bZ(){this.hh=this.Qcd.YCc();t.AFrameworkApplication.ua&&t.AFrameworkApplication.ua.Sb.lgb&&this.hh.smn(b=>{b===this.hh&&(this.D6d(),this.Adc())});this.xnf(this.hh.SPa.Nfh);this.hh.yl()}xnf(b){b.style.overflow="hidden";const h=jg.a.createElement("iframe");Sys.UI.DomElement.addCssClass(h,"InsightsPaneIFrame");
h.setAttribute("Unselectable","off");this.eA=h;b.appendChild(this.eA);this.eA.id=Lh.Xlf}mRf(){Bf.a.addHandler(this.eA,"load",Object(u.a)(this,this.G$b,"onIFrameLoad"));Bf.a.addHandler(this.eA,"error",Object(u.a)(this,this.jib,"onIFrameError"));$addHandler(window,"message",Object(u.a)(this,this.U0a,"onIFrameMessage"))}G7f(){Bf.a.removeHandler(this.eA,"load",Object(u.a)(this,this.G$b,"onIFrameLoad"));Bf.a.removeHandler(this.eA,"error",Object(u.a)(this,this.jib,"onIFrameError"));$removeHandler(window,
"message",Object(u.a)(this,this.U0a,"onIFrameMessage"))}dispose(){this.eA&&(this.G7f(),this.eA.parentNode.removeChild(this.eA),this.eA=null);this.hh&&(this.Qcd.myb(this.hh),this.hh=null)}qO(b,h,r){this.a4=h;this.T7c=null;this.LAg=r;this.eqc=!b.mentionLength;this.Uhd=!1;v.ULS.sendTraceTag(6295947,1303,50,this.eT("Start to show Insights"));this.uHa=b;this.Loc&&this.Loc.length?this.eA.src=this.Loc:(this.eA.src=dE.Hui,v.ULS.sendTraceTag(6295948,1303,15,this.eT("The Insights URL config setting is null or empty")));
this.zp.sendNotification(CommonUIStrings.l_InsightsPaneNotification,!0);this.hh.gX||this.hh.rRf(Object(u.a)(this,this.yTm,"onInsightsTaskPaneHidden"));this.HRb&&this.uZc(!1);b=window.performance.now();this.Qcd.showTaskPane(this.hh);this.hh.yl();this.Bdc(b)}i5i(b,h,r){this.eN=b;this.qO(Object.assign(new YD.a,{neighborhood:b.selection.neighborhood,mentionStart:b.selection.mentionStart,mentionLength:b.selection.mentionLength}),h,r)}qJb(){}ERd(){}Adc(){this.eA.src===this.Loc&&this.Uhd&&(this.Wb.Jg(Lh.ly),
this.Xib(new VK))}D6d(){this.eA&&ve.FocusManager.AK(this.eA.contentWindow)}s2e(){this.eA.src=dE.Hui;this.hh.km()}Hla(){this.Qcd.hideTaskPane(this.hh);this.s2e()}yTm(b){b===this.hh&&this.Hla()}G$b(){v.ULS.sendTraceTag(6295951,1303,50,this.eT("The iframe is successfully loaded in Insights task pane"))}jib(){v.ULS.sendTraceTag(6295952,1303,15,this.eT("The iframe failed to load in Insights task pane"))}U0a(b){const h=b.rawEvent;if(h.source===this.eA.contentWindow)if(this.HRb)super.U0a(b);else{let r;try{r=
y.a(h.data)}catch(z){v.ULS.sendTraceTag(6295953,1303,15,this.eT("Message data [{0}] failed to deserialize.",h.data));return}if(qf.c(r.messageType))v.ULS.sendTraceTag(6295954,1303,15,this.eT("Message data [{0}] is in wrong format.",h.data));else switch(r.messageType){case Lh.$Hm:this.Xib(new TK(this.bwl()));break;case Lh.mIm:this.Xib(new UK(this.uHa));break;case Lh.gIm:this.Uhd=!0;this.D6d();this.Adc();v.ULS.sendTraceTag(6295955,1303,50,this.eT("Insights pane rendering is completed"));break;case Lh.oIm:b=
r.messageContent;this.T7c=b.clientCorrelationId;this.a4!==b.appCorrelationId&&v.ULS.sendTraceTag(6403778,1303,15,this.eT("App correlation ID on client {0} does not match one on server {1}",this.a4,b.appCorrelationId));break;case Lh.fIm:r.messageContent?(X.a.gj&&document.activeElement.blur(),this.Oo.qKd(0,null,2,null,null),v.ULS.sendTraceTag(6604741,1303,50,this.eT("Insights UX lost focus through Ctrl + Shift + F6"))):(this.Oo.yKc(0,null,2,null,null),v.ULS.sendTraceTag(6604742,1303,50,this.eT("Insights UX lost focus through Ctrl + F6")));
break;case Lh.cIm:r.messageContent.keyCode===wb.a.u4a&&this.Hla();break;case Lh.dIm:try{this.Uhd=!1,localStorage.setItem(Lh.Rki,"true")}catch(z){v.ULS.sendTraceTag(17961859,1303,10,this.eT("Failed to SetItem in LocalStorage for LegalAgreed"))}}}}bwl(){const b={anid:"00000000-0000-0000-0000-000000000000"};b.appCorrelationId=this.a4;3===t.AFrameworkApplication.ua.Sb.jo?b.applicationName=Lh.Puo:4===t.AFrameworkApplication.ua.Sb.jo&&(b.applicationName=Lh.rZm);b.applicationVersion=t.AFrameworkApplication.buildVersion;
var h=Sj.a.pg(t.AFrameworkApplication.lcid);h=h?h.name:null;b.market=mG(h);b.uiLanguage=h;b.sessionId=t.AFrameworkApplication.userSessionId;b.parentalControl=Lh.CKf;b.clientType="user";b.legalAgreed=this.kxl();b.defaultDefineTab=1===this.LAg?"true":null;return b}eT(b,...h){const r={};this.a4&&(r[Lh.U$i]=this.a4);this.T7c&&(r[Lh.h7n]=this.T7c);r[Lh.V$i]=String.format.apply(null,[b].concat(h));return y.c(r)}W3b(){return 5}kxl(){try{const b=localStorage.getItem(Lh.Rki);return!!b&&"true"===b}catch(b){return v.ULS.sendTraceTag(17961860,
1303,10,this.eT("Failed to GetItem in LocalStorage for LegalAgreed")),!1}}Xib(b){b=y.c(b);this.eA.contentWindow.postMessage(b,Rc.a.p$(this.Loc))}}dE.Hui="about:blank";Object(n.a)(dE,"InsightsPane",aE,[]);class WK{constructor(){this.type="SmartLookupTaskPaneProps"}}Object(n.a)(WK,"SmartLookupTaskPaneProps",null,[]);class XK{}Object(n.a)(XK,"ActionDescriptor",null,[]);class YK extends aE{constructor(b,h,r,z=null,R=null,ba=null,ta=!0,Wa=null,ub=null){super(h,r,z,R,ba,ta,Wa,ub);this.zJe=!!t.AFrameworkApplication.ua&&
!!t.AFrameworkApplication.ua.Sb&&t.AFrameworkApplication.ua.Sb.$tf;this.ru=this.nEe=!1;this.qMj=t.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.SharedOnline.SerpletMaxViewportWidthThreshold",1680);this.oMj=t.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.SharedOnline.SerpletMaxPaneWidth",844);this.tMj=t.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.SharedOnline.SerpletMediumViewportWidthThreshold",1366);this.sMj=t.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.SharedOnline.SerpletMediumPaneWidth",
700);ta||Pl.WA("ReactSmartLookupPane - React SmartLookup pane constructed for legacy SmartLookup.",10);this.sTa=b;this.nIg=nG(this.wub)}get isVisible(){return this.ru}qJb(b,h){this.eN=b;this.uHa=b=Object.assign(new YD.a,{neighborhood:b.selection.neighborhood,mentionStart:b.selection.mentionStart,mentionLength:b.selection.mentionLength});this.eqc=!b.mentionLength;this.a4=h;this.uZc(!1)}ERd(b){this.eN=b;this.Tec(Object.assign(new YD.a,{neighborhood:b.selection.neighborhood,mentionStart:b.selection.mentionStart,
mentionLength:b.selection.mentionLength}),!1)}qO(b,h){this.a4=h;this.Tec(b,!0)}i5i(b,h,r){this.eN=b;this.qO(Object.assign(new YD.a,{neighborhood:b.selection.neighborhood,mentionStart:b.selection.mentionStart,mentionLength:b.selection.mentionLength}),h,r)}Hla(){this.aba();this.sTa.hideTaskPane()}Tec(b,h){Xh.SessionStatusManager.instance.jK&&this.mca?(this.uHa=b,this.eqc=!b.mentionLength,b=window.performance.now(),this.initialize(),this.isVisible?t.AFrameworkApplication.K.$("SmartLookupDisableRefreshPaneIsEnabled")?
(this.sTa.updateTaskPane(null),h&&this.UFn()):(h&&this.uZc(!1),this.nEe=!this.nEe,this.sTa.updateTaskPane(this.wB())):(h&&this.uZc(this.isVisible),this.sTa.showTaskPane(this.wB())),this.Bdc(b)):(this.sTa.showTaskPane(this.wB()),Pl.rFn(Xh.SessionStatusManager.instance.jK,!!this.mca,this.eN?QC[this.eN.entryPoint]:"",this.G9a.EJc(),t.AFrameworkApplication.qQe,this.eqc))}UFn(){if(!this.eN){const b=Object.assign(new ew.a,{neighborhood:this.uHa.neighborhood,mentionStart:this.uHa.mentionStart,mentionLength:this.uHa.mentionLength});
this.eN=Object.assign(new Pt.a,{selection:b,userIntent:null,entryPoint:0,launchData:null})}this.uZc(this.isVisible)}zFn(){const b=new XK;b.transactionId=this.a4;b.actionType=15;b.channelId=Lh.channelId;this.Xib(b)}U0a(b){const h=b.rawEvent;document.getElementById(Lh.ly)&&h.source!==document.getElementById(Lh.ly).contentWindow||(t.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableSerpletL2Resizing",!1)?this.Pfn(b):super.U0a(b))}Pfn(b){const h=b.rawEvent;let r;try{r=
y.b(h.data)}catch(z){v.ULS.sendTraceTag(545604257,1303,15,this.eT("Message data from Serplet [{0}] failed to deserialize.",h.data));return}switch(r.actionType){case 32:$e.a.hBb()>=this.qMj?this.sTa.updateTaskPane(this.X0e(this.oMj)):$e.a.hBb()>=this.tMj&&this.sTa.updateTaskPane(this.X0e(this.sMj));break;case 33:this.sTa.updateTaskPane(this.X0e(r.data));break;default:super.U0a(b)}}dispose(){}initialize(){this.bZ();this.Rga()}bZ(){this.sTa.YCc()}Rga(){const b=this.Wb.re(Lh.ly);b.parent=ke.AFrame.Np;
b.UL=!0}ZJn(){this.Wb.Jg(Lh.ly)}aba(){this.K_a()&&this.Wb.Jg(this.Wb.HS)}mRf(){$addHandler(window,"message",Object(u.a)(this,this.U0a,"onIFrameMessage"))}G7f(){$removeHandler(window,"message",Object(u.a)(this,this.U0a,"onIFrameMessage"))}K_a(){return!!this.Wb.og&&this.Wb.og.name===Lh.ly}Xib(b){b=y.c(b);document.getElementById(Lh.ly)&&document.getElementById(Lh.ly).contentWindow.postMessage(b,Rc.a.p$(this.nIg))}eT(b,...h){const r={};this.a4&&(r[Lh.U$i]=this.a4);r[Lh.V$i]=String.format.apply(null,[b].concat(h));
return y.c(r)}W3b(){return yh.a("isSharedUXDarkModeOn")&&appChrome.api.isSharedUXDarkModeOn()?3:0}QAi(){if(this.mca)this.mca.onPaneThemeChanged(this.W3b());return yh.a("getTheme")?appChrome.api.getTheme():null}Adc(){}D6d(){document.getElementById(Lh.ly)&&ve.FocusManager.AK(document.getElementById(Lh.ly).contentWindow)}jib(){Pl.WA("ReactSmartLookupPane - Iframe component failed to load.",10)}G$b(){t.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.DisableSerpletIFrameLoadHandler",
!1)||window.navigator.onLine||Pl.WA("ReactSmartLookupPane - Onload detected no network.",50)}wB(){var b=new WK;b.src=this.nIg;b.id=Lh.ly;b.refreshPane=this.nEe;b.onError=Object(u.a)(this,this.jib,"onIFrameError");b.onLoad=Object(u.a)(this,this.G$b,"onIFrameLoad");b.title=Lh.Lib;Xh.SessionStatusManager.instance.jK?this.mca||(b.errorMessage=CommonUIStrings.l_SmartLookupPaneInitializationError,b.errorType=1):(b.errorMessage=CommonUIStrings.l_SmartLookupPaneNetworkDisconnected,b.errorType=0);b=Object.assign(new Io.a,
{title:Lh.Lib,hideHeader:!1,width:Lh.width,location:Lh.s1m,contentProps:b,isModernPane:!0,onOpen:()=>{this.ZJn();this.ru=!0;this.mRf();yh.a("registerOnThemeChangeCallback")&&appChrome.api.registerOnThemeChangeCallback(Object(u.a)(this,this.QAi,"onThemeIdChanged"));t.AFrameworkApplication.ua.updateCommandUI();if(this.mca)this.mca.onPaneStateChanged(!0)},onClose:()=>{this.zFn();this.aba();this.ru=!1;this.G7f();yh.a("removeOnThemeChangeCallback")&&appChrome.api.removeOnThemeChangeCallback(Object(u.a)(this,
this.QAi,"onThemeIdChanged"));t.AFrameworkApplication.ua.updateCommandUI();if(this.mca)this.mca.onPaneStateChanged(!1)}});this.zJe&&(b.enableResize=!0,b.minResizeWidth=320,b.maxResizeWidth=920);return b}X0e(b){const h=this.wB();h.resizeWidth=b;return h}}Object(n.a)(YK,"ReactSmartLookupPane",aE,[]);class ZK{YCc(){const b=new In.CuiHelper(il.a.yab,WordEditorIntl.WordEditorStrings);return jn.a.instance.Z0e(Lh.ly,Lh.vac,Lh.width,Lh.t4f,b)}showTaskPane(b){jn.a.instance.showTaskPane(b)}hideTaskPane(b){jn.a.instance.hideTaskPane(b)}myb(b){jn.a.instance.myb(Lh.ly,
b)}}Object(n.a)(ZK,"WordInsightsPaneHandler",null,[184]);class $K{YCc(){jn.a.instance.iKa()}showTaskPane(b){Uk.UISurfaces.$t().then(h=>{h.showTaskPane(Lh.ly,b);return null})}updateTaskPane(b=null){Uk.UISurfaces.$t().then(h=>{h.setSelectedTaskPane(Lh.ly);b&&h.updateTaskPane(Lh.ly,b);return null})}hideTaskPane(){Uk.UISurfaces.$t().then(b=>{b.hideTaskPane(Lh.ly,2);return null})}}Object(n.a)($K,"WordReactSmartLookupPaneHandler",null,[183]);class aL extends TC{constructor(b,h){super();this.Ps=b;this.ib=
h}Fxd(){const b=!!t.AFrameworkApplication.ua&&!!t.AFrameworkApplication.ua.Sb&&t.AFrameworkApplication.K.$("SmartLookupEnableNativePane");return t.AFrameworkApplication.ua&&t.AFrameworkApplication.ua.Sb&&t.AFrameworkApplication.ua.Sb.atf?new YK(new $K,mn.a.instance,ve.FocusManager.instance(),Sa.a.instance.resolve("Common.App.SearchCommon.IDocumentContentExecutor"),Sa.a.instance.resolve("Common.App.SearchCommon.ISerpletExecutor"),Sa.a.instance.resolve("Common.App.SearchCommon.IInsertContentExecutor"),
b,Sa.a.instance.Za("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"),Sa.a.instance.resolve("Common.App.SearchCommon.IDocumentHelper")):new dE(new ZK,mn.a.instance,ve.FocusManager.instance(),Sa.a.instance.resolve("Common.Utils.IAriaNotifier"),Sa.a.instance.resolve("Common.App.SearchCommon.IDocumentContentExecutor"),Sa.a.instance.resolve("Common.App.SearchCommon.ISerpletExecutor"),Sa.a.instance.resolve("Common.App.SearchCommon.IInsertContentExecutor"),b,Sa.a.instance.Za("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"),
Sa.a.instance.resolve("Common.App.SearchCommon.IDocumentHelper"))}Y2b(){return this.Ps.getSelectedText()}MSh(){if(!this.ib||!this.ib.hb||1>this.ib.hb.length)return null;var b=this.ib.hb.kb.Qa;b=null==b?null:Aj.FormattingReader.Pr(b);return(b=null==b?null:Sj.a.pg(Aj.FormattingReader.language(b)))?b.name:""}uYa(){return this.Ps.yhf()}OSh(){return this.Ps.yhf()}Odi(){return this.Ps.Uam()}}Object(n.a)(aL,"WordInsightsManager",TC,[]);var GM=d(172);class bL{}Object(n.a)(bL,"CommandMetadataResponse",null,
[]);class bC{constructor(){this.Zlf=this.getAllIcons()}executeCommand(){}openFeedbackPane(){}openSerpletTaskPane(){}sendAutoLaunchSearchRequest(){}openFindReplaceTaskPane(){}openFindReplaceTaskPaneV2(){}openFindTaskPane(){}openNavigationPane(){}closeNavigationPane(){}openPrivacySettings(){GM.PrivacyDialogManager.w8d()}browseFiles(){}getId(){return"SerpletExecutor"}getCommandMetadata(b){const h=new bL;b.iconNames&&(h.svgData=this.getCommandIconSvg(b.iconNames));if(!b.commandId||""===b.commandId)return h;
try{h.label=appChrome.selectors.getControlLabel(b.commandId);if(h.svgData&&""!==h.svgData)return h;const r=appChrome.selectors.getControlIconSet(b.commandId),z=Array(2);z[0]=r["default"];z[1]=r.icon32;h.svgData=this.getCommandIconSvg(z)}catch(r){return null}return h}getCommandIconSvg(b){if(!this.Zlf)return"";for(let h=0;h<b.length;h++){const r=b[h];if(r in this.Zlf)return this.Zlf[r]}return""}getAllIcons(){return{}}createFeedbackPropertiesFromData(b){const h={SourceControlId:"GiveFeedback"};h.feedbackType=
"true"===b.IsPosFeedback?0:1;const r={};r.featureArea=bC.k7k;h.telemetryGroup=r;h.appData=b;return h}}bC.Q4h="FA000000012";bC.queryPrefix="AssetID=";bC.k7k="SearchPane";Object(n.a)(bC,"BaseSerpletExecutor",null,[185,154]);class cL extends bC{constructor(b,h,r){super();this.ga=b;this.ib=h;this.kA=r}executeCommand(b){if(!b)throw Error("Missing commandData argument");switch(b.CommandId){case 0:this.ga.Xb(Fb.a.wEb,2,null);break;case 1:this.ga.Xb(Oa.a.BKb,2,null);break;default:throw Error(`Unknown commandId requested: ${b.CommandId}`);
}}browseFiles(){this.ga.Xb(ab.a.nNd,2,null)}openHelpTaskPane(){}openFeedbackPane(b){this.ga.Xb(ab.a.odc,2,this.createFeedbackPropertiesFromData(b))}openFindReplaceTaskPane(b){const h={};h.CommandValueId=b;h.SourceControlId="Insights";this.ga.Xb(ab.a.v9e,2,h)}openFindReplaceTaskPaneV2(b){b={CommandValueId:b.Query,MatchCase:b.MatchCase,MatchWholeWord:b.MatchWholeWordOnly};uG(this.ib,this.kA);this.ga.Xb(ab.a.v9e,2,b)}openFindTaskPane(b){const h={};h.CommandValueId=b;h.SourceControlId="Insights";this.ga.Xb(ab.a.findInDocument,
2,h)}openNavigationPane(){this.ga.Xb(Oa.a.Oec,2,null)}openSerpletTaskPane(){this.ga.Xb(ab.a.I$h,2,null)}sendAutoLaunchSearchRequest(){this.ga.Xb(ab.a.hNd,2,null)}getAllIcons(){const b={};for(const r of Object.keys(window))if(r.startsWith("word")){var h=window[r];h&&(h=h.icons,null!==h&&void 0!==h&&h.length&&h.forEach(z=>b[z.id]=JSON.stringify(z)))}return b}}Object(n.a)(cL,"WordSerpletExecutor",bC,[]);class dL extends pG{constructor(){super();this.FBe=null;this.ax=()=>{t.AFrameworkApplication.EZ&&
(this.h_k(),pk.a.En().then(()=>this.FBe.resolve("WordEditor.Insights.IAugloopSearchProviderManager")))}}get name(){return"WordEditor.Insights"}init(){t.AFrameworkApplication.EZ&&(this.FBe.Pa("WordEditor.Insights.WordInsightsActor").Vb(),t.AFrameworkApplication.K.$("SmartLookupEnableNativePane")&&t.AFrameworkApplication.K.$("DownloadSmartLookupRuntimeDuringPkgInitIsEnabled")?t.AFrameworkApplication.K.zq(this.ax):super.init())}yc(b){super.yc(b);this.FBe=b;b.ha("Box4.Insights.Box4InsightsSelection",
()=>new Wm.a).as("Common.App.Insights.IInsightsSelection").as("Box4.Insights.IBox4InsightsSelection").singleInstance();b.ha("WordEditor.Insights.WordInsertContentExecutor",()=>new RK(t.AFrameworkApplication.ya)).as("Common.App.SearchCommon.IInsertContentExecutor").singleInstance();b.ha("WordEditor.Insights.WordSerpletExecutor",()=>new cL(t.AFrameworkApplication.ya,di.a.instance,b.resolve("Box4.ISelectionFactory"))).as("Common.App.SearchCommon.ISerpletExecutor").singleInstance();b.ha("WordEditor.Insights.AugloopSearchProviderManager",
()=>new fF(b.resolve("Common.App.Insights.IDocumentContentExtractionManager"))).as("WordEditor.Insights.IAugloopSearchProviderManager").singleInstance();b.ha("WordEditor.Insights.WordDocumentContentExecutor",()=>{const h=new lA(new De.a(()=>vb.App.xa?vb.App.xa.jb.Yc:null),b.resolve("Box4.IParagraphReader"),IK.a.instance,t.AFrameworkApplication.K,dr.a.instance,AM.a.instance,b.resolve("Box4.Search.IFindManagerHelper"),b.resolve("Common.Comments.ICommentModel"),t.AFrameworkApplication.ya,di.a.instance,
b.resolve("Box4.ISelectionFactory"));h.initialize();return new PK(new De.a(()=>vb.App.xa?vb.App.xa.jb.Yc:null),b.resolve("Box4.IParagraphReader"),Ya.InteractiveViewManager.instance,di.a.instance,b.resolve("Box4.ISelectionFactory"),h,vb.App.Xj.al.Se(12),new De.a(()=>vb.App.xa.jb),ve.FocusManager.instance(),t.AFrameworkApplication.K,b.resolve("Common.Comments.ICommentModel"),b.resolve("Common.App.Insights.IInsightsSelection"),b.Za("WordEditor.Insights.IAugloopSearchProviderManager"))}).as("Common.App.SearchCommon.IDocumentContentExecutor").singleInstance();
b.ha("WordEditor.Insights.WordInsightsManager",()=>new aL(b.resolve("Common.App.Insights.IInsightsSelection"),b.resolve("Box4.ISelectionManager"))).as("Common.App.Insights.IInsightsManager").singleInstance();b.ha("WordEditor.Insights.WordInsightsActor",()=>new SK(b.ef("Common.App.Insights.IInsightsManager"),t.AFrameworkApplication.ya,t.AFrameworkApplication.K)).singleInstance();b.ha("Common.App.SearchCommon.IDocumentHelper",()=>new QK(b.Za("WordEditor.Extension.DocumentProperties"))).singleInstance()}}
Object(n.a)(dL,"WordInsightsPackage",pG,[]);class HM{}Object(n.a)(HM,"ScalingStep",null,[]);class eL{constructor(b,h,r){this.rpc=!1;this.DO=null;this.qwc=this.sRb=!1;this.wUa=[];this.v4d=z=>{this.j8&&this.j8!==z&&appChrome.api.dispatch(this.wYh(!1))};h.execute(z=>{this.DO=z});b.oB(Object(u.a)(this,this.fXm,"onProcessSetSelectionFinished"));this.Pt=r}C3b(b,h,r){const z=[];for(const R of b)z.push(appChrome.actions.addScalingStepInTab("Home",{type:h,controlId:R},r));return z}VWh(b){const h=[];for(let r=
0;4>r;r++)h.push(appChrome.actions.addScalingStepInTab("Home",{type:"DropPreviewItemFromGallery",controlId:b},2>r?0:void 0));h.push(appChrome.actions.addScalingStepInTab("Home",{type:"GalleryToFlyout",controlId:b},void 0));return h}wYh(b){const h=[];if(b)switch(this.j8){case "Image":h.push(appChrome.actions.removeControlScalingStepsFromTab("TextAlignmentAnchor","Home"));h.push(...this.VWh("PictureStyles"));h.push(...this.C3b("RotatePictureMenu PictureBorders PictureStyles CropPictureMenu WrapTextMenu EditPictureAltText".split(" "),
"DropLabel"));b=this.wUa.slice().reverse();b.push("TextAlignmentAnchor");h.push(...this.C3b(b,"MoveToOverflow"));break;case "Table":this.qwc||h.push(...this.VWh("TableStyles"));h.push(...this.C3b(this.wUa,"DropLabel",this.qwc?0:void 0));b=this.wUa.slice().reverse();h.push(...this.C3b(b,"MoveToOverflow"));break;case "Hyperlink":h.push(...this.C3b(["EditHyperlink","RemoveHyperlink"],"DropLabel")),b=this.wUa.slice().reverse(),h.push(...this.C3b(b,"MoveToOverflow"))}else for(const r of this.wUa)h.push(appChrome.actions.removeControlScalingStepsFromTab(r,
"Home"));return h}w3c(b){let h={};for(const r of b)try{h[r]=appChrome.selectors.getModelType(r)}catch(z){this.laa("Error","GetModelType failed for "+r)}vb.App.xa.MDd(h)}hgo(b){if(0!==b.length){var h=[],r={},z=!1;for(const R of b)try{if(appChrome.selectors.isControlDefined(R))r[R]=appChrome.selectors.getModelType(R);else{z=!0;break}}catch(ba){this.laa("Error","GetModelType failed for "+R);z=!0;break}if(z)this.j8=void 0,this.Bce(!1);else{if("Image"===this.j8&&!this.sRb)h.push(appChrome.actions.updateGroupHiddenState("Font",
!0)),this.sRb=!0;else if(this.sRb){h.push(appChrome.actions.updateGroupHiddenState("Font",!1));z=appChrome.selectors.getVisibleControlsInGroup("Font");for(const R of z)r[R]=appChrome.selectors.getModelType(R);this.sRb=!1}vb.App.xa.MDd(r);this.wUa=b;r=[];for(const R of b)appChrome.selectors.isControlDisabled(R)&&r.push(R);0<r.length&&this.laa("Disabled",r.join(","));0<this.wUa.length&&(h.push(appChrome.actions.updateGroupHiddenState("Adaptive",!1)),h.push(appChrome.actions.updateControlsInGroup("Adaptive",
this.wUa)),h.push(...this.wYh(!0)),this.rpc=!0);appChrome.api.dispatch(h)}}}Bce(b){if(b||this.rpc){var h=[];h.push(appChrome.actions.updateGroupHiddenState("Adaptive",!b));this.rpc=b;if("Image"===this.j8||this.sRb){b=!b;h.push(appChrome.actions.updateGroupHiddenState("Font",!b));if(b){const r=appChrome.selectors.getVisibleControlsInGroup("Font");this.w3c(r)}this.sRb=!b}appChrome.api.dispatch(h)}}Qgc(){this.rpc&&this.Pt&&this.Pt.execute(b=>{b.logActivity("AdaptiveContextualGroupShown",null)})}fXm(b,
h){!t.AFrameworkApplication.ua.Sb.Bec&&"Home"===appChrome.selectors.getSelectedTabId()&&this.DO&&h.ll&&h.ll.kb&&0!==h.ll.length?(b=()=>{let r=[],z=!1;var R=this.DO.contentType,ba=appChrome.selectors.getActiveContextualTabIds();R.includes("Image")?(this.v4d("Image"),this.j8&&"Image"===this.j8?z=!0:(r="PictureStyles PictureBorders WrapTextMenu RotatePictureMenu CropPictureMenu PictureAbsoluteHeight PictureAbsoluteWidth LockAspectRatio EditPictureAltText FormatPictureOptions".split(" "),this.j8="Image")):
R.includes("Table")&&0<=ba.indexOf("Table")?(R=!(yr.a.instance.kb.zCa||yr.a.instance.kb.yw||yr.a.instance.kb.TDb),(ba="Table"===this.j8&&R!==this.qwc)?this.v4d("TableCellEdit"):this.v4d("Table"),!this.j8||"Table"!==this.j8||ba?(R?(r=["SelectTableMenu","DeleteTableMenu","InsertTableMenu","AlignmentTableMenu"],this.qwc=!0):(r="SelectTableMenu DeleteTableMenu InsertTableMenu AlignmentTableMenu MergeCells SplitCells TableDistributeMenu TableStyles ChangeColorsTable StyleOptionsTableMenu CellShading EditTableAltText BorderGallery TableBorderColor".split(" "),
this.qwc=!1),this.j8="Table"):z=!0):R.includes("Hyperlink")&&(this.v4d("Hyperlink"),this.j8&&"Hyperlink"===this.j8?z=!0:(r=["EditHyperlink","RemoveHyperlink","CopyHyperlink","OpenHyperlink"],this.j8="Hyperlink"));z?this.rpc||(this.w3c(this.wUa),this.Bce(!0),this.Qgc()):0<r.length?(this.hgo(r),this.Qgc()):this.Bce(!1)},"requestIdleCallback"in window?window.requestIdleCallback(b):window.requestAnimationFrame(b)):this.Bce(!1)}laa(b,h){b={Time:(new Date).getTime(),Event:b,Message:h,Scenario:"AdaptiveTabGroup"};
h=new si.a;h.name="Events";h.dataFields=bh.a.PJ(b);h.durationMs=window.performance.now();Y.a.hEa(h,"TellMeWAC.")}}Object(n.a)(eL,"AdaptiveTabGroupUpdater",null,[]);class fL{constructor(){this.W=null;this.$Om=()=>{t.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.EnableAdaptiveTabGroupUpdater",!1)&&(this.W.ha("WordEditor.UI.AdaptiveTabGroupUpdater",()=>new eL(this.W.resolve("Box4.ISelectionManager"),this.W.Za("Common.IActionContextProvider"),this.W.Za("Common.ISystemInitiatedFeedback"))).singleInstance(),
this.W.resolve("WordEditor.UI.AdaptiveTabGroupUpdater"))}}get name(){return"WordEditor.RibbonIntelligence"}yc(b){this.W=b}init(){ot(1,this.$Om)}dispose(){}}Object(n.a)(fL,"PackageManager",null,[1,2]);const IM=(b,h,r)=>1===r?32:2===r?(d.e(5).then(d.bind(null,1932)).then(z=>{z.createAndShowDevToolsMenu()}),32):2;class vG{constructor(){this.name="WordEditor.DevTools"}init(){if(window.g_wordDevToolsIsEnabled||t.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.DevToolsIsEnabled",
!1))t.AFrameworkApplication.ya.pa(Oa.a.m0f,Yd.a.frame,IM),null!==sessionStorage.getItem("devToolsRefresh")&&d.e(5).then(d.bind(null,1932))}dispose(){}yc(){}static main(){O.a.instance.Oc(new vG)}}Object(n.a)(vG,"WordDevToolsPackage",null,[1,2]);d(579);class wG{constructor(){this.underline=this.strikethrough=this.italic=this.highlight=this.fontColor=this.bold=null}}Object(n.a)(wG,"FormattingData",null,[]);class gL extends wG{constructor(){super();this.hyperlinkData=null}}Object(n.a)(gL,"RichContentCommandData",
wG,[]);class Ui{constructor(){Ui.Xi.add(Oa.a.x3a);Ui.Xi.add(Oa.a.XKb);Ui.Xi.add(Oa.a.Lfc);Ui.Xi.add(Oa.a.UX);Ui.Xi.add(Oa.a.QDf);Ui.Xi.add(Oa.a.PMf);Ui.Xi.add(Oa.a.deleteComment);Ui.Xi.add(Oa.a.CDc);Ui.Xi.add(Oa.a.Y2e);Ui.Xi.add(Oa.a.O8d);Ui.Xi.add(Oa.a.sQa);Ui.Xi.add(Oa.a.m0f);Ui.Xi.add(Oa.a.BKb);Ui.Xi.add(Oa.a.s0f);Ui.Xi.add(Oa.a.AEc);Ui.Xi.add(Oa.a.eAd);Ui.Xi.add(Fb.a.wzd);Ui.Xi.add(Fb.a.openInClient);Ui.Xi.add(Fb.a.print);Ui.Xi.add(Fb.a.V0d);Ui.Xi.add(Fb.a.fPf);Ui.Xi.add(Fb.a.eIb);Ui.Xi.add(Fb.a.wEb);
Ui.Xi.add(ab.a.ebj);Ui.Xi.add(ab.a.tellMe);Ui.Xi.add(ab.a.Z1c);Ui.Xi.add(ab.a.odc);Ui.Xi.add(ab.a.giveFeedback);Ui.Xi.add(ab.a.w0c);Ui.Xi.add(ab.a.e0f);Ui.Xi.add(ab.a.S$f);Ui.Xi.add(ab.a.Lcb);Ui.Xi.add(ab.a.newComment);Ui.Xi.add(ab.a.GXe);Ui.Xi.add(ab.a.eNa);Ui.Xi.add(ab.a.HTf);Ui.Xi.add(ab.a.GTf);Ui.Xi.add(ab.a.ITf);Ui.Xi.add(ab.a.xzd);Ui.Xi.add(ab.a.Aja);Ui.Xi.add(ab.a.d1f);Ui.Xi.add(ab.a.x4i);Ui.Xi.add(ab.a.close);Ui.Xi.add(ab.a.Q1d);Ui.Xi.add(ab.a.b1d);Ui.Xi.add(ab.a.jZd);Ui.Xi.add(ab.a.X8d);
Ui.Xi.add(ab.a.c9d);Ui.Xi.add(ab.a.vHb);Ui.Xi.add(ab.a.renameFile);Ui.Xi.add(ab.a.p5b);Ui.Xi.add(ab.a.S0f);Ui.Xi.add(ab.a.Wec);Ui.Xi.add(ab.a.downloadACopy);Ui.Xi.add(ab.a.jdc);Ui.Xi.add(ab.a.$_d);Ui.Xi.add(ab.a.ZHb);Ui.Xi.add(ab.a.GIi);Ui.Xi.add(ab.a.eoh);Ui.Xi.add(ab.a.rvd);Ui.Xi.add(ab.a.FXe);Ui.Xi.add(ab.a.goh);Ui.Xi.add(ab.a.foh);Ui.Xi.add(ab.a.GXe);Ui.Xi.add(ab.a.svd);Ui.Xi.add(Oa.a.Iee);Ui.Xi.add(Oa.a.Nag);Ui.Xi.add(Oa.a.zoomToPageWidth);Ui.Xi.add(Oa.a.tWf);Ui.Xi.add(Oa.a.ijb);Ui.Xi.add(Oa.a.k2d);
Ui.Xi.add(Oa.a.vha);Ui.Xi.add(ab.a.gfb);Ui.Xi.add(ab.a.Kbb);Ui.Xi.add(ab.a.afc);Ui.Xi.add(ab.a.Omj);Ui.Xi.add(ab.a.NIi);Ui.Xi.add(Fb.a.hHb);Ui.Xi.add(Fb.a.Ufa)}}Ui.Xi=new Set;Object(n.a)(Ui,"CommentRibbonCommands",null,[]);class hL{constructor(b,h,r,z,R,ba){this.dui=b;this.ui=h;this.$p=r;this.hr=z;this.jf=R;this.p8n=ba;this.hUb=null;this.Mwa=new Ub.a(0);this.Cnb=new Ub.a(0);this.Tie=new Ub.a(0);this.BLe=!1;this.x2l();this.dnn()}V$l(b){return this.hUb&&this.$p.Ly?!Ui.Xi.has(b):!1}wKc(b,h,r){if(b===
ab.a.Ag)return 32;if(!this.Mwa.xb(b)&&!this.Cnb.xb(b)||!this.hUb)return 2;const z=this.Cnb.xb(b);var R=z?this.Cnb.J(b):this.Mwa.J(b);const ba=z?2:this.Tie.J(r);z||1!==ba||(this.sdm(vb.App.xa.$o.og.name)||vb.App.xa.$o.Jg(this.ui.mn?ke.AFrame.gr:ke.AFrame.xL),vb.App.xa.updateCommandUI(!0));r=new gL;if(this.hr.ZCb)switch(R){case 1:r.highlight={color:this.xXh(h.Color)};break;case 6:r.fontColor={color:this.xXh(h.Color)}}R=this.hUb.executeCommand(R,ba,r);2===R&&z&&(b===Fb.a.wbc?h[Yf.a.On]=!!r.bold:b===
Fb.a.Cbc?h[Yf.a.On]=!!r.italic:b===Fb.a.Nbc?h[Yf.a.On]=!!r.underline:b===Fb.a.Ibc?h[Yf.a.On]=!!r.strikethrough:b===Fb.a.IX?h[Yf.a.On]=!!r.highlight:b===Fb.a.Ls&&(h[Yf.a.On]=!!r.fontColor));return 2===R?32:1===R?2:8}lkn(b){this.hUb=b;this.hUb.registerSelectionChangeHandler(()=>{this.BLe||(this.BLe=!0,vb.App.xa.updateCommandUI(!0),this.BLe=!1)});this.hUb.registerKeypressHandler(h=>{if(h.shortKey)switch(h.key){case wb.a.iNb:case wb.a.dge:case wb.a.ige:case wb.a.ZQa:vb.App.xa.updateCommandUI(!0)}h.key!==
wb.a.bB&&h.key!==wb.a.W_||vb.App.xa.updateCommandUI(!0)})}dnn(){this.dui.wMi(ke.AFrame.gr,this);this.dui.wMi(ke.AFrame.xL,this)}x2l(){this.Mwa.Z(Fb.a.bold,0);this.Mwa.Z(Fb.a.setItalic,3);this.Mwa.Z(Fb.a.strikethrough,4);this.Mwa.Z(Fb.a.underline,5);this.hr.ZCb&&(this.Mwa.Z(Fb.a.IX,1),this.Mwa.Z(Fb.a.Xja,1),this.Mwa.Z(Fb.a.Ls,6),this.Mwa.Z(Fb.a.G5,6),this.Mwa.Z(Fb.a.Kga,6));this.Cnb.Z(Fb.a.wbc,0);this.Cnb.Z(Fb.a.Cbc,3);this.Cnb.Z(Fb.a.Ibc,4);this.Cnb.Z(Fb.a.Nbc,5);this.Tie.Z(1,0);this.Tie.Z(2,1)}sdm(b){return b===
ke.AFrame.gr||b===ke.AFrame.xL}xXh(b){return b?cq.a.MC(this.p8n.yza(this.jf.rd,b)):""}}Object(n.a)(hL,"CommentRibbonCommandHandler",null,[303,304]);class xG{constructor(){this.W=null}get name(){return"WordEditor.CommentsRibbonHandler"}init(){this.W.resolve("WordEditor.Comments.ICommentRibbonCommandHandler");this.W.resolve("WordEditor.Comments.CommentsState").OPf?this.W.resolve("WordEditor.Comments.CommentRibbonCommands"):this.W.resolve("WordEditor.Comments.WordCommentEventsActor").oga("OnCommentRenderedOnce",
()=>{this.W.resolve("WordEditor.Comments.CommentRibbonCommands")})}dispose(){}yc(b){this.W=b;this.W.ha("WordEditor.Comments.CommentRibbonCommandHandler",()=>new hL(this.W.Pa("Common.INonCanvasCuiUser"),this.W.resolve("WordEditor.Comments.CommentsState"),this.W.resolve("Common.Comments.ICommentModel"),this.W.resolve("WordEditor.Comments.CommentsSettings"),ja.App.fm.jb.Ic,xq.a.instance)).as("WordEditor.Comments.ICommentRibbonCommandHandler").singleInstance();this.W.ha("WordEditor.Comments.CommentRibbonCommands",
()=>new Ui).singleInstance()}static main(){O.a.instance.Oc(new xG)}}Object(n.a)(xG,"PackageManager",null,[1,2]);var JM=d(1838);class eE{constructor(b,h){this.jRk=2E3;this.O6g=null;this.qKf=b.pDi;this.maxLength=t.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.WordOnline.MaxCanvasContextChars",this.jRk);h&&h.execute(r=>{this.O6g=r})}Vbf(b){b=this.ukl(b,this.maxLength);return{semantic:oo.ObjectSemantic.CanvasContext,type:oo.ObjectSchemaType.WordCanvasContext,value:b}}ukl(b,h){try{return this.tkl(b,
h)}catch(r){return v.ULS.sendTraceTag(522725067,1303,15,"Error processing selection for Canvas Context: {0}",r),null}}GIl(b,h){const r={wXa:[],Aua:0,selection:{start:null,end:null},cursor:null,tiles:[]},z=b.length;for(let ba=0;ba<z;ba++){const ta=b.J(ba);var R=ta.node;if(!ie.ParagraphReader.nc(R)||Array.contains(r.wXa,R.vn))continue;r.wXa.push(R.vn);const Wa=ie.ParagraphReader.textLength(R);if(r.Aua+Wa>h)break;R=this.qKf.dxb(R);r.tiles.push(R);r.Aua+=Wa;1!==z||r.cursor||(r.cursor=eE.Lol(ta,r.tiles.length-
1));null===r.selection.start&&0===ba&&(r.selection.start=this.T_h(ta,!0,r.tiles.length-1));null===r.selection.end&&ba===z-1&&(r.selection.end=this.T_h(ta,!1,r.tiles.length-1))}return r}Xzl(b,h,r){const z={m2c:[],Kaj:[],Aua:0};var R=b.J(0).node;let ba=b.J(b.length-1).node;for(b=h;0<b&&(R||ba);){var ta=eE.mHi(R,!0,b,r);if(R=ta.node)R=this.qKf.dxb(R),z.m2c.push(R),b-=ta.Aua,R=ta.node,r=ta.wXa;ta=eE.mHi(ba,!1,b,r);if(ba=ta.node)r=this.qKf.dxb(ba),z.Kaj.push(r),b-=ta.Aua,ba=ta.node,r=ta.wXa}z.Aua=h-b;
return z}vkl(b,h){let r=0;var z=this.GIl(b,h);const R={tiles:z.tiles,selection:z.selection,cursor:z.cursor};r+=z.Aua;z=z.wXa;r<h&&(b=this.Xzl(b,h-r,z),R.tiles.unshift.apply(R.tiles,b.m2c),R.tiles.push.apply(R.tiles,b.Kaj),R.selection.start&&(R.selection.start.index+=b.m2c.length),R.selection.end&&(R.selection.end.index+=b.m2c.length),R.cursor&&(R.cursor.index+=b.m2c.length));return R}tkl(b,h){var r;if(!b)return null;b=this.vkl(b,h);return{contentType:null===(r=this.O6g)||void 0===r?void 0:r.contentType,
formattedContext:b.tiles,selection:b.selection,cursor:b.cursor}}T_h(b,h,r){if(b.contextId===kc.a.Gd||b.contextId===kc.a.paragraph||b.contextId===kc.a.Wc){if(h&&-1!==b.hl)return{index:r,offset:b.hl};if(!h&&-1!==b.ut)return{index:r,offset:b.ut}}return null}static Lol(b,h){return b.contextId===kc.a.Wc?{index:h,offset:b.hl}:null}static mHi(b,h,r,z){z={node:null,Aua:0,wXa:z};if(!b||0>=r||!z.wXa)return z;do z.node=ie.ParagraphReader.Vg(b,h,!1,!1),z.Aua=z.node?ie.ParagraphReader.textLength(z.node):0,b=z.node;
while(z.node&&(Array.contains(z.wXa,z.node.vn)||!ie.ParagraphReader.nc(z.node)||!z.Aua));z.node&&(z.Aua>r?z.node=null:z.wXa.push(z.node.vn));return z}}Object(n.a)(eE,"Box4CanvasContextProvider",null,[127]);class yG{get name(){return"Box4.CanvasContext"}init(){}dispose(){}yc(b){b.ha("Box4.CanvasContext.Box4CanvasContextProvider",()=>new eE(b.resolve("Box4.AugmentationLoop.INodeToTileConverterHolder"),b.Za("Common.IActionContextProvider"))).as("Box4.CanvasContext.ICanvasContextProvider").singleInstance()}static main(){O.a.instance.Oc(new yG)}}
Object(n.a)(yG,"Box4CanvasContextPackage",null,[1,2]);class iL{constructor(b,h){this.XD=null;this.jz={};this.Hb=b;this.ff=h;this.zMe=new Map;this.Fpd=new Map}start(){this.XD=new Ic.a(0,2,3E4,this.YAn.bind(this),216);this.Hb.$b(this.XD)}stop(){this.XD&&this.Hb.We(this.XD)}f6j(b,h){this.zMe.set(b,h)}YAn(){if(this.ff.io)v.ULS.sendTraceTag(520974675,306,50,"Session has been kicked out"),this.stop();else{var b=50;this.jz.ScanTime=Date.now();this.jz.NumWatchDogs=this.Fpd.size;this.Fpd.forEach((h,r)=>{this.jz[r]=
{["WatchDogStatus"]:h.jJm()};h.xnm()||(b=15)});v.ULS.sendTraceTag(520974674,306,b,JSON.stringify(this.jz))}}Mxn(){this.zMe.forEach((b,h)=>{b.execute(r=>{r?(this.Fpd.set(h,r),this.XD||this.start()):v.ULS.sendTraceTag(512550848,306,10,"{0} resolved to null",h)})})}get gak(){return this.zMe.size===this.Fpd.size}}Object(n.a)(iL,"WatchDogManager",null,[21]);class zG{constructor(){this.W=this.qWb=null}get name(){return"Box4.WatchDogManager.WatchDogManager"}init(){this.Hgb&&(this.qWb=this.W.resolve(this.name),
this.u4l())}dispose(){this.qWb&&this.qWb.stop()}yc(b){this.Hgb&&(this.W=b,b.ha(this.name,this.HOk.bind(this)).as("Box4.WatchDogManager.IWatchDogManager").singleInstance())}static main(){O.a.instance.Oc(new zG)}Xpo(){if(!this.qWb.gak){let b=[],h=0;this.qgd.forEach((r,z)=>{r&&(this.W.Pa(z)||(b[h++]=z))});v.ULS.sendTraceTag(512550819,306,10,"{0} did not resolve",b)}}HOk(){return new iL(t.AFrameworkApplication.uc,this.W.resolve("Common.ISessionStatus")||Xh.SessionStatusManager.instance)}$5j(){let b=new Ic.a(1,
1,12E4,this.Xpo.bind(this),216);t.AFrameworkApplication.uc.$b(b)}g6j(){this.qgd=new Map;this.qgd.set("WordEditor.RunawayDataLossMonitorWatchDog",(vb.App.Bm||vb.App.As)&&this.aQd);this.qgd.set("WordEditor.LastSavedToHostDetailsManagerWatchDog",this.mPd)}u4l(){this.g6j();this.qgd.forEach((b,h)=>{b&&this.qWb.f6j(h,this.W.Za(h))});this.qWb.Mxn();this.$5j()}get Hgb(){return t.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.WatchDogManagerIsEnabled",!1)}get mPd(){return t.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.LastSavedToHostDetailsWatchDogEnabled",
!1)}get aQd(){return t.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.RunawayDataLossWatchDogEnabled",!1)}}Object(n.a)(zG,"WatchDogManagerPackage",null,[1,2]);Type.registerNamespace("CommandUI");Type.registerNamespace("CommandUI.Controls");Type.registerNamespace("CommandUI.Controls.SearchBoxComponents");Type.registerNamespace("CommandUI.React");Type.registerNamespace("B4A11Y");Type.registerNamespace("B4Ac");Type.registerNamespace("B4AuC");Type.registerNamespace("B4CS");
Type.registerNamespace("B4IE");Type.registerNamespace("B4Im");Type.registerNamespace("B4Intent");Type.registerNamespace("B4LE");Type.registerNamespace("B4NLE");Type.registerNamespace("B4OLE");Type.registerNamespace("B4S");Type.registerNamespace("B4TLE");Type.registerNamespace("B4TaE");Type.registerNamespace("B4UI");Type.registerNamespace("B4Up");Type.registerNamespace("Box3");Type.registerNamespace("Box4.AtMentions");Type.registerNamespace("Box4.AugmentationLoop");Type.registerNamespace("Box4.AugmentationLoop.TilingSchema");
Type.registerNamespace("Box4.ClipArt");Type.registerNamespace("Box4.Clipboard");Type.registerNamespace("Box4.Insights");Type.registerNamespace("Box4.ListMarker");Type.registerNamespace("Box4.ListMarkerGallery");Type.registerNamespace("Box4.Media");Type.registerNamespace("Box4.Proofing");Type.registerNamespace("Box4.TaskPaneManager");Type.registerNamespace("Box4.WorkerShared");Type.registerNamespace("Box4.Workers");Type.registerNamespace("CanvasAtMentions");Type.registerNamespace("Common.App.CatchUpActivity");
Type.registerNamespace("GC2");Type.registerNamespace("PUTSOMETHINGHERE");Type.registerNamespace("WEAc");Type.registerNamespace("WEB");Type.registerNamespace("WECX");Type.registerNamespace("WEDCE");Type.registerNamespace("WEIE");Type.registerNamespace("WEIL");Type.registerNamespace("WELE");Type.registerNamespace("WENLE");Type.registerNamespace("WEOLE");Type.registerNamespace("WETaE");Type.registerNamespace("WEUI");Type.registerNamespace("Wac.Common");Type.registerNamespace("Wac.Common.Actors");Type.registerNamespace("Wac.Common.SendUsYourFile");
Type.registerNamespace("Wonca.UI");Type.registerNamespace("WordEditor.AtMentions");Type.registerNamespace("WordEditor.CanvasContextualProvider");Type.registerNamespace("WordEditor.CatchUpActivity");Type.registerNamespace("WordEditor.CatchUpActivity.NetworkShared");Type.registerNamespace("WordEditor.ContextualSearch");Type.registerNamespace("WordEditor.CritiqueCounts");Type.registerNamespace("WordEditor.Designer.Common");Type.registerNamespace("WordEditor.Designer.Common.AL");Type.registerNamespace("WordEditor.Designer.Common.Conditions");
Type.registerNamespace("WordEditor.Designer.Common.Review");Type.registerNamespace("WordEditor.DocumentUnderstanding.RLM");Type.registerNamespace("WordEditor.Embed");Type.registerNamespace("WordEditor.FindReplace");Type.registerNamespace("WordEditor.FootnoteEndnote");Type.registerNamespace("WordEditor.FootnoteEndnoteInteractive");Type.registerNamespace("WordEditor.Goals");Type.registerNamespace("WordEditor.GraphicsEditor");Type.registerNamespace("WordEditor.HeaderFooter");Type.registerNamespace("WordEditor.Insights");
Type.registerNamespace("WordEditor.IntelligentPlaceholder");Type.registerNamespace("WordEditor.RibbonIntelligence");Type.registerNamespace("WordEditor.Ruler");Type.registerNamespace("WordEditor.SendUsYourFile");Type.registerNamespace("WordEditor.SignalAggregator");Type.registerNamespace("WordEditor.TableStyle");Type.registerNamespace("WordEditor.TaskPaneManager");Type.registerNamespace("WordEditor.Tasks");Type.registerNamespace("WordEditor.WordCount");Type.registerNamespace("WordEditor.WorkerShared");
Type.registerNamespace("WordEditor.Workers");Type.registerNamespace("Common.App.AccountSwitching");H.main();Type.registerNamespace("Common.App.WopiIdentity");ra.main();Type.registerNamespace("Common");Type.registerNamespace("Common.App.ApplicationFeatureHelper");ib.main();Object(JM.a)(!1);Tb.main();Eb.main();tc.main();vG.main();Type.registerNamespace("Common.App.AccessibilityHelpDialog");Type.registerNamespace("Common.App.ActivityAggregator");Yc.main();Type.registerNamespace("Common.App.AltTextDialog");
Type.registerNamespace("Common.App.ChromeExtensionHelper");Type.registerNamespace("Common.App.CommandUIActors");Type.registerNamespace("Common");Hc.main();Type.registerNamespace("Common.App.WildFire");qd.main();Type.registerNamespace("Common.App.BrowserInfoLogger");Ig.main();Type.registerNamespace("Common.App.HostNotification");Ng.main();Type.registerNamespace("Common.App.Embed");Type.registerNamespace("Common.App.FloatPane");Xf.main();Type.registerNamespace("Common.App.InsertFile");Type.registerNamespace("Common.App.InsertPicture");
Type.registerNamespace("Common.App.LivePersonaUtils");fg.main();Type.registerNamespace("CNT");sk.main();Type.registerNamespace("Common.App.NewAndOpen.Core");O.a.instance.Oc(new fl);Type.registerNamespace("Common.App.NewAndOpen.UX");O.a.instance.Oc(new Fk);Type.registerNamespace("Common.App.OneDriveFilePickerApi");Uf.main();Type.registerNamespace("Common.App.OpenInClient");Type.registerNamespace("Common.App.SafeLinks");Type.registerNamespace("Common.App.SafeLinks");Hn.main();Type.registerNamespace("Common.Search");
Type.registerNamespace("Common.App.SessionExpiration");Type.registerNamespace("Common.App.SessionExpiration");gg.main();Type.registerNamespace("Common.App.TaskPaneManager");Type.registerNamespace("CAUI");jd.main();Type.registerNamespace("CADWLTR");Ud.main();Type.registerNamespace("Common.App.DirectPrint");O.a.instance.Oc(new Xg);Type.registerNamespace("Common.App.SearchOAuthManager");ig.main();Cb.main();ql.main();Hj.main();Di.main();zh.main();Th.main();O.a.instance.Oc(new Nj);Sd.main();ue.main();
xj.main();O.a.instance.Oc(new zk);Type.registerNamespace("Common.App.SaveStatus");O.a.instance.Oc(new Hk);Type.registerNamespace("Common.App.EventsCacheManager");Xo.main();Type.registerNamespace("CUIB");Hr.main();Type.registerNamespace("CommandUI.TaskPane");try{O.a.instance.Oc(new of(vb.App.xa.jb))}catch(b){v.ULS.shipAssertTag(575930383,3016,!1,b.message)}gp.main();Type.registerNamespace("Common.App.Insights");Iq;O.a.instance.Oc(new Jp);Type.registerNamespace("Common.App.Policy.Contracts");Type.registerNamespace("Common.App.AugmentationLoop");
Type.registerNamespace("Common.App.CommentsSmartReply");Type.registerNamespace("Common.App.AppsForOfficeCommon");Type.registerNamespace("Common.App.AugmentationLoop.SDX");ln("Begin");O.a.instance.Oc(new hk);try{O.a.instance.Oc(new zj(Si.a.get_instance(),vb.App.xa.jb,vb.App.xa.Sb))}catch(b){v.ULS.shipAssertTag(575930384,3016,!1,b.message)}Ap.main();O.a.instance.Oc(new za);wi.main();Ln.main();Mr.main();Pp.main();Bs.main();Us.main();At.main();Au.main();O.a.instance.Oc(new av);bv.main();dv.main();gx.main();
Ms.main();yG.main();xG.main();O.a.instance.Oc(new Fu);O.a.instance.Oc(new rA);sA.main();zz.main();js.main();O.a.instance.Oc(new Rv);O.a.instance.Oc(new ti);Sv;Rz.main();ky.main();x.main();us.main();sr;O.a.instance.Oc(new Ix);O.a.instance.Oc(new Mo);Hw.main();Iw.main();ns.main();O.a.instance.Oc(new Wf);O.a.instance.Oc(new zC);Type.registerNamespace("Common.App.AppsForOffice");window.Common.App.AppsForOffice.AddinShortcutsPreferenceSettingHelper=Zv;Type.registerNamespace("Common.App.AppsForOfficeCommon");
Type.registerNamespace("Common.App.AppsForOfficeCommon");Type.registerNamespace("Common.App.AppsForOfficeCommon");nF.main();rF.main();sF.main();rL;NF.main();XL;window.MSOJS=cB;hG.main();kG.main();O.a.instance.Oc(new dL);O.a.instance.Oc(new fL);(()=>Object(Ht.__awaiter)(void 0,void 0,void 0,function*(){t.AFrameworkApplication.K.$("WPMPackageIsEnabled")&&(yield d.e(21).then(d.bind(null,1936)).then(b=>{b.initializeOnDemandPackage()}))}))();zG.main()},1940:function(C,N,d){C=d(0);var l=d(8),e=d(1570);
class a{static get ZFm(){return 50}static wHd(n){if(""===n)return"";let v=0,u="";try{const t=e.a.C2b(n);for(const y of t.ops)if(a.GF(y))v||(u+=a.nsl(y.attributes.atmention.fullName)),v+=1;else{const B=y.insert?y.insert:"";" "!==B&&0<B.length&&(v=0,u+=B)}}catch(t){l.ULS.sendTraceTag(558428681,327,10,"Comment formatString could not be deserialized since it is not in a proper Delta Format.")}return u}static pml(n){n=a.wHd(n);return 0<n.length&&n.split(" ").length<=a.ZFm?n:null}static nsl(n){let v="";
n&&(n=n.split(" "),0<n.length&&(v=n[0]));return v}static GF(n){return!!n.attributes&&!!n.attributes.atmention}}Object(C.a)(a,"BaseCommentSmartReplyHelpers",null,[]);d.d(N,"a",function(){return k});class k extends a{constructor(){super()}static Uzb(n,v,u=!1){if(!n)return null;n=n.text&&0<n.text.length?n.text[0]:"";v=!v||!v.Rf||""===v.Rf;return 0<n.length&&v&&!u?a.pml(n):null}}Object(C.a)(k,"CommentSmartReplyHelpers",a,[])},703:function(C,N,d){Object.defineProperty(N,"__esModule",{value:!0});var l=
d(79);l.__exportStar(d(921),N);l.__exportStar(d(1193),N);l.__exportStar(d(922),N);l.__exportStar(d(1194),N);l.__exportStar(d(1195),N);l.__exportStar(d(1196),N);C.exports.getChangeGateDictionary||Object.defineProperty(C.exports,"getChangeGateDictionary",{enumerable:!0,get:function(){return C.exports.uNh}});C.exports.getFeatureGateDictionary||Object.defineProperty(C.exports,"getFeatureGateDictionary",{enumerable:!0,get:function(){return C.exports.vQh}});C.exports.makeGetTypedFeatureGate||Object.defineProperty(C.exports,
"makeGetTypedFeatureGate",{enumerable:!0,get:function(){return C.exports.spi}});C.exports.makeTypedIsChangeGateEnabled||Object.defineProperty(C.exports,"makeTypedIsChangeGateEnabled",{enumerable:!0,get:function(){return C.exports.xpi}})},848:function(C,N,d){function l(){return d(848)}function e(Ua){for(var Ab=[],mb=1;mb<arguments.length;mb++)Ab[mb-1]=arguments[mb];return e.R2c.apply(e,Object(ia.__spreadArray)([Ua,void 0],Ab,!1))}function a(Ua){return k(Ua)&&"WorkerError"===Ua.name&&"object"===typeof Ua.info}
function k(Ua){return null==Ua?!1:Ua instanceof Error?!0:"string"===typeof Ua.name&&"string"===typeof Ua.message&&(null==Ua.stack||"string"===typeof Ua.stack)}function n(Ua){if(k(Ua))var Ab=Ua;else{Ab=Error;var mb="(non-Error object) ".concat;a:{var Rb=typeof Ua;switch(Rb){case "function":case "symbol":case "undefined":Ua="<".concat(Rb,">");break a;case "object":Ua=JSON.stringify(Ua);break a;default:Ua="".concat(Ua)}}Ab=Ab(mb.call("(non-Error object) ",Ua))}return Ab}function v(Ua){var Ab=Ua.name,
mb=a(Ua)?Ua.shk:Ua.message,Rb=Ua.stack;a(Ua)?(Ua=Ua.info,Ua=Object(ia.__assign)(Object(ia.__assign)({},Ua),{error:Ua.error?v(Ua.error):void 0})):Ua=void 0;return{name:Ab,message:mb,stack:Rb,info:Ua}}function u(Ua){return k(Ua)?{cfa:!0,value:v(Ua)}:{cfa:!1,value:Ua}}function t(Ua){if("WorkerError"===Ua.name){var Ab=Ua.message;var mb=Ua.info;mb=Object(ia.__assign)(Object(ia.__assign)({},mb),{error:mb.error?t(mb.error):void 0});Ab=new va(Ab,mb)}else(Ab=Ka[Ua.name])?Ab=new Ab(Ua.message):(Ab=Error(Ua.message),
Ab.name=Ua.name);null!=Ua.stack&&(Ab.stack=Ua.stack);return Ab}function y(Ua){return Ua.cfa?t(Ua.value):Ua.value}function B(){return"undefined"!==typeof Blob&&"undefined"!==typeof URL&&void 0!==URL.createObjectURL&&void 0!==URL.revokeObjectURL&&"undefined"!==typeof Worker}function G(Ua){if(Xa)throw new TypeError("setConfig has already been called");Xa=Ua}function F(){var Ua=null!==Xa&&void 0!==Xa?Xa:{};return{createTimeout:Ua.createTimeout,createMode:Ua.createMode,importScriptUrls:Ua.importScriptUrls?
Object(ia.__spreadArray)([],Ua.importScriptUrls,!0):void 0,typedWorkersUrl:Ua.typedWorkersUrl,typedWorkersName:Ua.typedWorkersName,zmf:Ua.zmf}}function K(Ua){var Ab,mb;return null!==(mb=null!==(Ab=null===Ua||void 0===Ua?void 0:Ua.createTimeout)&&void 0!==Ab?Ab:null===Xa||void 0===Xa?void 0:Xa.createTimeout)&&void 0!==mb?mb:3E5}function O(Ua){var Ab,mb;Ua=null!==(mb=null!==(Ab=null===Ua||void 0===Ua?void 0:Ua.createMode)&&void 0!==Ab?Ab:null===Xa||void 0===Xa?void 0:Xa.createMode)&&void 0!==mb?mb:
"Thread";return"ThreadOrLocal"===Ua?B()?"Thread":"Local":Ua}function H(Ua){setTimeout(function(){throw Ua;})}function I(){return"undefined"!==typeof self&&"__typed_workers_thread"in self?self:void 0}function J(Ua){var Ab=I();void 0!==Ab?(Ua={kind:1,error:u(Ua)},Ab.postMessage(Ua)):console.warn(Ua)}function L(Ua){var Ab;try{(null!==(Ab=null===Xa||void 0===Xa?void 0:Xa.OIo)&&void 0!==Ab?Ab:J)(Ua)}catch(mb){console.warn(Ua),H(mb)}}function S(Ua){var Ab=I();void 0!==Ab&&Ab.postMessage({kind:2,stats:Ua})}
function E(Ua){var Ab;try{(null!==(Ab=null===Xa||void 0===Xa?void 0:Xa.jIo)&&void 0!==Ab?Ab:S)(Ua)}catch(mb){H(mb)}}function P(Ua,Ab){return Ua.then(function(mb){Ab();return mb},function(mb){Ab();return Promise.reject(mb)})}function T(Ua,Ab,mb){if(1073741824<Ua)return mb;var Rb=setTimeout(Ab,Math.max(0,Ua));return{resolve:function(hc){clearTimeout(Rb);mb.resolve(hc)},reject:function(hc){clearTimeout(Rb);mb.reject(hc)}}}function U(){var Ua=Object.create(null);Ua.key=void 0;delete Ua.key;return Ua}
function X(){try{return"function"===typeof Proxy&&!0===(new Proxy({},{get:function(){return!0}})).k}catch(Ua){return!1}}function Y(Ua,Ab){var mb=U(),Rb=Ma("OfficeVSO:5592319_TypedWorkersProxyPromiseFix")?function(hc,Hb){var Ta;return"then"===Hb?void 0:null!==(Ta=hc[Hb])&&void 0!==Ta?Ta:hc[Hb]=Ua(Hb)}:function(hc,Hb){var Ta;return null!==(Ta=hc[Hb])&&void 0!==Ta?Ta:hc[Hb]=Ua(Hb)};if(!Ab)return new Proxy(mb,{get:Rb});Ab.forEach(function(hc){return Rb(mb,hc)});return mb}function ca(Ua){throw Ua;}function da(){return{status:"Pending",
start:zb()}}function ua(Ua,Ab,mb){"Pending"===Ua.status&&(Ua.status=Ab,Ua.end=Math.max(Ua.start,null!==mb&&void 0!==mb?mb:zb()))}function ra(Ua,Ab){function mb(Rb){ua(Ua,a(Rb)&&"Timeout"===Rb.info.cZ?"Timeout":"Error");throw Rb;}try{return Ab().then(function(Rb){var hc;return null!==(hc=ua(Ua,"Success"))&&void 0!==hc?hc:Rb},mb)}catch(Rb){mb(Rb)}}function qa(Ua,Ab,mb){var Rb,hc,Hb,Ta=null!==(Rb=null===Ua||void 0===Ua?void 0:Ua.start)&&void 0!==Rb?Rb:Infinity;Rb=Ta<Ab?Ab:Ta>mb?mb:Ta;Ta=null!==(hc=null===
Ua||void 0===Ua?void 0:Ua.end)&&void 0!==hc?hc:Infinity;mb=Ta<Ab?Ab:Ta>mb?mb:Ta;return{status:null!==(Hb=null===Ua||void 0===Ua?void 0:Ua.status)&&void 0!==Hb?Hb:"Pending",start:Math.round(1E3*(Rb-Ab))/1E3,end:Math.round(1E3*(mb-Ab))/1E3,duration:Math.round(1E3*(mb-Rb))/1E3}}function ka(Ua,Ab,mb){mb="def"in mb?mb:e(mb);var Rb=mb.def,hc=mb.args;return"function"!==typeof Rb?Promise.reject(new va("Loading an InsideScript to create a local worker is unimplemented",{cZ:"InternalError",cD:{type:"Endpoint",
FKb:"Inside",id:Ua.options.id}})):Promise.resolve().then(function(){return ra(Ab.sof=da(),function(){return Rb.apply(void 0,Object(ia.__spreadArray)([{config:F(),importTypedWorkers:l,connection:Ua}],hc,!1)).then(function(){})})})}function la(Ua,Ab,mb,Rb,hc){var Hb=new MessageChannel,Ta=Hb.port2,Aa;return Promise.all([Rb({port:Hb.port1,options:Ua,createMode:Ab}),ra(mb.Nxd=da(),function(){return Sa.Nxd({port:Ta,options:Ua,createMode:Ab},function(ma){return hc(Aa=ma)})})]).then(function(){return Aa},
function(ma){Aa?Aa.close("Force"):Ta.close();return Promise.reject(ma)})}function Ha(Ua,Ab,mb,Rb){return la(Ua,"Local",Ab,function(hc){return ka(hc,Ab,mb)},Rb)}function wa(Ua,Ab,mb,Rb){Ab.Xxd=da();try{var hc=new eb(Ua,mb)}catch(Hb){return ua(Ab.Xxd,"Error"),Promise.reject(Hb)}ua(Ab.Xxd,"Success");return la(Ua,"Thread",Ab,function(Hb){return hc.g0e(Hb,Ab)},Rb).then(function(Hb){Hb.CVl()?hc.terminate():Hb.RNj=hc.terminate.bind(hc);return Hb},function(Hb){hc.terminate();return Promise.reject(Hb)})}function Ca(Ua,
Ab,mb){void 0===mb&&(mb=function(){});var Rb=O(Ua),hc="local"in Ab?"Local"===Rb?Ab.local:Ab.r8n:Ab,Hb="Local"===Rb?Ha:wa,Ta={id:Ua.id,createMode:Rb,e1e:da()};Ab=ra(Ta.e1e,function(){return Hb({id:Ua.id,createTimeout:Ua.createTimeout,createMode:Ua.createMode,importScriptUrls:Ua.importScriptUrls,zmf:Ua.zmf},Ta,hc,mb)});return P(Ab,function(){var Aa=Ta.createMode;var ma=Ta.e1e,Ga=Ta.sof,Fa=Ta.Nxd,ib=Ta.Xxd,ob=ma.status,fb=ma.start;ma=ma.end;Aa="Pending"!==ob&&void 0!==ma?{id:Ta.id,createMode:Aa,e1e:{status:ob,
aBo:fb,duration:Math.round(1E3*(ma-fb))/1E3},Xxd:"Thread"===Aa?qa(ib,fb,ma):void 0,Nxd:qa(Fa,fb,ma),sof:qa(Ga,fb,ma)}:void 0;Aa&&E(Aa)})}function Ja(Ua,Ab){if(0===Ab)importScripts.apply(void 0,Ua);else for(var mb=0;mb<Ua.length;mb++)a:{for(var Rb=void 0,hc=Ua[mb],Hb=Ab,Ta=0;Ta<=Hb;Ta+=1)try{Rb=importScripts;if(0<Ta){var Aa=hc,ma=String(Ta),Ga=Aa.indexOf("?");if(0>Ga)var Fa="".concat(Aa,"?").concat("retries","=").concat(ma);else{var ib=Aa.slice(0,Ga+1),ob=Aa.slice(Ga+1).split("&");for(Aa=0;Aa<ob.length&&
("="!==ob[Aa][7]||"retries"!==ob[Aa].slice(0,7));Aa+=1);ob[Aa]="".concat("retries","=").concat(ma);Fa=ib+ob.join("&")}}else Fa=hc;Rb(Fa);break a}catch(fb){Rb=fb}throw Rb;}}function bb(){return"undefined"!==typeof WorkerGlobalScope}function ha(){return self.name}d.r(N);var ia=d(79),va=function(Ua){function Ab(mb,Rb){var hc=this.constructor,Hb;var Ta=Ua.call(this,"".concat(mb,"; info = ").concat(JSON.stringify(Object(ia.__assign)(Object(ia.__assign)({},Rb),{error:null===(Hb=Rb.error)||void 0===Hb?void 0:
Hb.message}))))||this;Ta.shk=mb;Ta.info=Rb;Ta.name="WorkerError";mb=hc.prototype;Object.getPrototypeOf(Ta)!==mb&&(null!=Object.setPrototypeOf?Object.setPrototypeOf(Ta,mb):Ta.__proto__=mb);return Ta}Object(ia.__extends)(Ab,Ua);return Ab}(Error),Ka={Error,EvalError,RangeError,ReferenceError,SyntaxError,TypeError,URIError},Xa;e.R2c=function(Ua,Ab){for(var mb=[],Rb=2;Rb<arguments.length;Rb++)mb[Rb-2]=arguments[Rb];return{def:Ua,args:mb,transferables:null!==Ab&&void 0!==Ab?Ab:[]}};var xa=d(703),Ma=Object(xa.makeTypedIsChangeGateEnabled)(["OfficeVSO:WINum_CGExample",
"OfficeVSO:5592319_TypedWorkersProxyPromiseFix"]);Object(xa.makeGetTypedFeatureGate)({"Microsoft.Office.Shared.FGExample":!0});var Na,pa=-1,Ra=function(){function Ua(Ab,mb){function Rb(){var Ga;return null===(Ga=Ta.onClose)||void 0===Ga?void 0:Ga.call(Ta)}var hc,Hb,Ta=this;this.cD=Ab;this.port=mb;this.isClosed=!1;this.exports={};this.r3c=U();var Aa=(hc={},hc[0]=this.CXd.bind(this),hc[1]=this.onResult.bind(this),hc[2]=function(Ga){var Fa;Ga=Ga.Nel;null===(Fa=Ta.lTm)||void 0===Fa?void 0:Fa.call(Ta,
Y(Ta.BMk.bind(Ta),Ga),Y(Ta.hIk.bind(Ta),Ga))},hc[3]=Rb,hc),ma=(Hb={},Hb[0]=this.iXm.bind(this),Hb[1]=this.eAi.bind(this),Hb[2]=Rb,Hb[3]=Rb,Hb);this.port.onmessage=function(Ga){Ga=Ga.data;return Aa[Ga.kind](Ga)};this.port.onmessageerror=function(Ga){Ga=Ga.data;return ma[Ga.kind](Ga)}}Ua.prototype.zJn=function(Ab){this.exports=Ab;if(null!==Na&&void 0!==Na?Na:Na=X())Ab=void 0;else{for(var mb=U();null!=Ab;){for(var Rb=0,hc=Object.getOwnPropertyNames(Ab);Rb<hc.length;Rb++){var Hb=hc[Rb];try{"function"===
typeof Ab[Hb]&&(mb[Hb]=!0)}catch(Ta){}}Ab=Object.getPrototypeOf(Ab)}Ab=Object.getOwnPropertyNames(mb)}this.port.postMessage({kind:2,Nel:Ab})};Ua.prototype.close=function(){if(!this.isClosed){this.isClosed=!0;this.port.postMessage({kind:3});this.port.close();for(var Ab in this.r3c){var mb=this.r3c[Ab],Rb=mb.reject;mb=mb.tZ;var hc={cZ:"Connection",cD:this.cD,tZ:mb};mb=new va("Importing Endpoint closed while waiting for ".concat(mb," result"),hc);Rb(mb)}}};Ua.prototype.CXd=function(Ab){var mb=this,Rb=
Ab.uda,hc=Ab.tZ,Hb=Ab.args;Ab=Promise.resolve().then(function(){var Ta=mb.exports[hc];if(Ta)return Ta.apply(mb.exports,Hb);Ta={cZ:"Connection",cD:mb.cD,uda:Rb,tZ:hc};throw new va("Exporting Endpoint received a ".concat(0<=Rb?"call":"post"," to unknown function ").concat(hc),Ta);});0<=Rb?Ab.then(function(Ta){return mb.QWf(Rb,hc,!0,Ta)},function(Ta){return mb.QWf(Rb,hc,!1,Ta)}):Ab.catch(function(Ta){Ta=n(Ta);Ta={cZ:"UnhandledError",cD:mb.cD,error:Ta,uda:Rb,tZ:hc};L(new va("Exporting Endpoint's ".concat(hc,
" implementation threw or rejected"),Ta))})};Ua.prototype.QWf=function(Ab,mb,Rb,hc){hc=u(hc);Ab={kind:1,uda:Ab,tZ:mb,Ldm:Rb,nSi:hc};try{this.port.postMessage(Ab,void 0)}catch(Hb){this.eAi(Ab,n(Hb))}};Ua.prototype.eAi=function(Ab,mb){var Rb=Ab.uda,hc=Ab.tZ;Ab=Ab.nSi;var Hb=mb?"Exporting Endpoint failed to send ".concat(hc," result"):"Importing Endpoint failed to deserialize ".concat(hc," result");mb=new va(Hb,{cZ:"MessageError",cD:this.cD,error:mb,uda:Rb,tZ:hc});Ab.cfa?L(mb):this.QWf(Rb,hc,!1,mb)};
Ua.prototype.lae=function(Ab){var mb=this.r3c[Ab];mb&&delete this.r3c[Ab];return mb};Ua.prototype.SHn=function(Ab,mb,Rb,hc){var Hb=this;return 1073741824<Rb?hc:T(Rb,function(){var Ta=Hb.lae(Ab);if(Ta){var Aa={cZ:"Timeout",cD:Hb.cD,timeout:Rb,uda:Ab,tZ:mb};Ta.reject(new va("Importing Endpoint's call to ".concat(mb," timed out"),Aa))}},hc)};Ua.prototype.OEn=function(Ab,mb,Rb,hc){var Hb=this;return new Promise(function(Ta,Aa){var ma=pa+=1,Ga={kind:0,uda:ma,tZ:Ab,args:mb};Hb.r3c[ma]=Object(ia.__assign)(Object(ia.__assign)({},
Hb.SHn(ma,Ab,Rb,{resolve:Ta,reject:Aa})),{tZ:Ab});try{Hb.port.postMessage(Ga,hc)}catch(Fa){if(Ta=Hb.lae(ma))Aa=n(Fa),ma={cZ:"MessageError",cD:Hb.cD,error:Aa,uda:ma,tZ:Ab},Ta.reject(new va("Importing Endpoint failed to send call to ".concat(Ab),ma))}})};Ua.prototype.GFn=function(Ab,mb,Rb,hc){mb={kind:0,uda:-1,tZ:Ab,args:mb};try{this.port.postMessage(mb,hc)}catch(Hb){hc=n(Hb),hc={cZ:"MessageError",cD:this.cD,error:hc,uda:-1,tZ:Ab},Rb(new va("Importing Endpoint failed to post to ".concat(Ab),hc))}};
Ua.prototype.iXm=function(Ab){var mb,Rb=Ab.uda;Ab=Ab.tZ;var hc={cZ:"MessageError",cD:this.cD,uda:Rb,tZ:Ab};Ab=new va("Exporting Endpoint failed to deserialize ".concat(0<=Rb?"call":"post"," to ").concat(Ab),hc);Rb=0<=Rb?this.lae(Rb):void 0;(null!==(mb=null===Rb||void 0===Rb?void 0:Rb.reject)&&void 0!==mb?mb:L)(Ab)};Ua.prototype.onResult=function(Ab){var mb=Ab.uda,Rb=Ab.tZ,hc=Ab.Ldm;Ab=Ab.nSi;0<=mb?(Rb=this.lae(mb))&&(hc?Rb.resolve:Rb.reject)(y(Ab)):(hc={cZ:"InternalError",cD:this.cD,uda:mb,tZ:Rb},
L(new va("Exporting Endpoint sent a result for a post to ".concat(Rb),hc)))};Ua.prototype.BMk=function(Ab){function mb(){for(var hc=[],Hb=0;Hb<arguments.length;Hb++)hc[Hb]=arguments[Hb];return mb.R2c.apply(mb,Object(ia.__spreadArray)([void 0],hc,!1))}var Rb=this;mb.R2c=function(hc){for(var Hb,Ta,Aa,ma=[],Ga=1;Ga<arguments.length;Ga++)ma[Ga-1]=arguments[Ga];Rb.isClosed||(Ga=null!==(Aa=null!==(Hb=mb.lzi)&&void 0!==Hb?Hb:null===(Ta=Rb.sBl)||void 0===Ta?void 0:Ta.call(Rb))&&void 0!==Aa?Aa:ca,Rb.GFn(Ab,
ma,Ga,hc))};return mb};Ua.prototype.hIk=function(Ab){function mb(){for(var hc=[],Hb=0;Hb<arguments.length;Hb++)hc[Hb]=arguments[Hb];return mb.R2c.apply(mb,Object(ia.__spreadArray)([void 0],hc,!1))}var Rb=this;mb.R2c=function(hc){for(var Hb,Ta,Aa,ma=[],Ga=1;Ga<arguments.length;Ga++)ma[Ga-1]=arguments[Ga];if(Rb.isClosed)return Hb={cZ:"Connection",cD:Rb.cD,tZ:Ab},Promise.reject(new va("".concat(Rb.cD.FKb," Endpoint's call.").concat(Ab," called after close"),Hb));Ga=null!==(Aa=null!==(Hb=mb.hVe)&&void 0!==
Hb?Hb:null===(Ta=Rb.rkl)||void 0===Ta?void 0:Ta.call(Rb))&&void 0!==Aa?Aa:Infinity;return Rb.OEn(Ab,ma,Ga,hc)};mb.hVe=void 0;return mb};return Ua}(),Sa=function(){function Ua(Ab,mb,Rb){function hc(Hb){return function(){var Ta="Outside"===Ab.FKb?"inside":"outside",Aa={cZ:"Connection",cD:Ab};throw new va("".concat(Ab.FKb," Endpoint's ").concat(Hb," referenced before the ").concat(Ta," Endpoint started"),Aa);}}this.hVe=Infinity;this.lzi=ca;this.dcd=Ab;this._state=mb;this.createMode=Rb;Object.defineProperties(this,
{post:{configurable:!0,enumerable:!1,get:hc("post")},call:{configurable:!0,enumerable:!1,get:hc("call")}})}Ua.Kzg=function(Ab,mb,Rb){var hc=mb.port,Hb=mb.options;mb=mb.createMode;var Ta={type:"Endpoint",FKb:Ab,id:null===Hb||void 0===Hb?void 0:Hb.id};try{var Aa=new Ra(Ta,hc);var ma=new Ua(Ta,Aa,mb)}catch(Ga){return Promise.reject(Ga)}return(new Promise(function(Ga,Fa){var ib;Aa.rkl=function(){return ma.hVe};Aa.sBl=function(){return ma.lzi};Aa.lTm=function(Tb,rc){Object.defineProperties(ma,{post:{configurable:!0,
enumerable:!1,writable:!1,value:Tb},call:{configurable:!0,enumerable:!1,writable:!1,value:rc}});fb.resolve()};Aa.onClose=function(){return ma.close("Force")};var ob=K(Hb),fb=T(ob,function(){var Tb="Outside"===Ab?"inside":"outside",rc={cZ:"Timeout",cD:Ta,timeout:ob};Tb=new va("".concat(Ab," Endpoint timed out waiting for the ").concat(Tb," to start"),rc);fb.reject(Tb)},{resolve:Ga,reject:Fa});ma.Y7c=function(){fb.resolve()};try{var Mb=Rb(ma)}catch(Tb){return fb.reject(Tb)}null===(ib=ma._state)||void 0===
ib?void 0:ib.zJn(Mb)})).then(function(){ma.Y7c=void 0;return ma},function(Ga){ma.Y7c=void 0;ma.close();return Promise.reject(Ga)})};Ua.prototype.CVl=function(){return void 0===this._state};Ua.prototype.close=function(Ab){var mb;if(this._state){if(this.Y7c)if("Force"===Ab)this.Y7c();else{var Rb={cZ:"Connection",cD:this.dcd};throw new va("".concat(this.dcd.FKb," Endpoint's close called during creation"),Rb);}Ab=this._state;this._state=void 0;try{Ab.close(),null===(Rb=this.RNj)||void 0===Rb?void 0:Rb.call(this),
null===(mb=this.onClose)||void 0===mb?void 0:mb.call(this)}catch(hc){Rb={cZ:"Connection",cD:this.dcd,error:n(hc)},L(new va("".concat(this.dcd.FKb," Endpoint's close threw an error"),Rb))}}};Ua.Nxd=function(Ab,mb){void 0===mb&&(mb=function(){});return Ua.Kzg("Outside",Ab,mb)};Ua.g0e=function(Ab,mb){return Ua.Kzg("Inside",Ab,mb)};return Ua}(),ab=-1,eb=function(){function Ua(Ab,mb){var Rb;try{var hc=void 0;var Hb="def"in mb?mb:e(mb),Ta=Hb.def,Aa=Hb.args,ma=Hb.transferables;if("function"!==typeof Ta)var Ga=
[Ta,Aa,ma,void 0];else{var Fa="__generatedInsideInit".concat(ab+=1),ib="var ".concat(Fa," = ").concat(Ta.toString(),";");Ga=[{scriptUrl:void 0,insideInitName:Fa},Aa,ma,ib]}this.script=Ga[0];this.args=Ga[1];this.transferables=Ga[2];hc=Ga[3];this.Psd=URL.createObjectURL(new Blob(void 0===hc?['!function(e){var t={};function r(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)r.d(n,o,function(t){return e[t]}.bind(null,o));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=12)}([function(e,t,r){"use strict";r.r(t),r.d(t,"__extends",(function(){return o})),r.d(t,"__assign",(function(){return i})),r.d(t,"__rest",(function(){return a})),r.d(t,"__decorate",(function(){return u})),r.d(t,"__param",(function(){return c})),r.d(t,"__metadata",(function(){return f})),r.d(t,"__awaiter",(function(){return l})),r.d(t,"__generator",(function(){return s})),r.d(t,"__createBinding",(function(){return d})),r.d(t,"__exportStar",(function(){return p})),r.d(t,"__values",(function(){return y})),r.d(t,"__read",(function(){return v})),r.d(t,"__spread",(function(){return _})),r.d(t,"__spreadArrays",(function(){return g})),r.d(t,"__spreadArray",(function(){return b})),r.d(t,"__await",(function(){return h})),r.d(t,"__asyncGenerator",(function(){return m})),r.d(t,"__asyncDelegator",(function(){return w})),r.d(t,"__asyncValues",(function(){return O})),r.d(t,"__makeTemplateObject",(function(){return j})),r.d(t,"__importStar",(function(){return S})),r.d(t,"__importDefault",(function(){return P})),r.d(t,"__classPrivateFieldGet",(function(){return T})),r.d(t,"__classPrivateFieldSet",(function(){return x})),r.d(t,"__classPrivateFieldIn",(function(){return E}));var n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(e,t)};function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var i=function(){return(i=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};function a(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(r[n[o]]=e[n[o]])}return r}function u(e,t,r,n){var o,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var u=e.length-1;u>=0;u--)(o=e[u])&&(a=(i<3?o(a):i>3?o(t,r,a):o(t,r))||a);return i>3&&a&&Object.defineProperty(t,r,a),a}function c(e,t){return function(r,n){t(r,n,e)}}function f(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}function l(e,t,r,n){return new(r||(r=Promise))((function(o,i){function a(e){try{c(n.next(e))}catch(e){i(e)}}function u(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,u)}c((n=n.apply(e,t||[])).next())}))}function s(e,t){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}}var d=Object.create?function(e,t,r,n){void 0===n&&(n=r);var o=Object.getOwnPropertyDescriptor(t,r);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,o)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]};function p(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||d(t,e,r)}function y(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function v(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,o,i=r.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(n=i.next()).done;)a.push(n.value)}catch(e){o={error:e}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return a}function _(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(v(arguments[t]));return e}function g(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;var n=Array(e),o=0;for(t=0;t<r;t++)for(var i=arguments[t],a=0,u=i.length;a<u;a++,o++)n[o]=i[a];return n}function b(e,t,r){if(r||2===arguments.length)for(var n,o=0,i=t.length;o<i;o++)!n&&o in t||(n||(n=Array.prototype.slice.call(t,0,o)),n[o]=t[o]);return e.concat(n||Array.prototype.slice.call(t))}function h(e){return this instanceof h?(this.v=e,this):new h(e)}function m(e,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n,o=r.apply(e,t||[]),i=[];return n={},a("next"),a("throw"),a("return"),n[Symbol.asyncIterator]=function(){return this},n;function a(e){o[e]&&(n[e]=function(t){return new Promise((function(r,n){i.push([e,t,r,n])>1||u(e,t)}))})}function u(e,t){try{(r=o[e](t)).value instanceof h?Promise.resolve(r.value.v).then(c,f):l(i[0][2],r)}catch(e){l(i[0][3],e)}var r}function c(e){u("next",e)}function f(e){u("throw",e)}function l(e,t){e(t),i.shift(),i.length&&u(i[0][0],i[0][1])}}function w(e){var t,r;return t={},n("next"),n("throw",(function(e){throw e})),n("return"),t[Symbol.iterator]=function(){return this},t;function n(n,o){t[n]=e[n]?function(t){return(r=!r)?{value:h(e[n](t)),done:"return"===n}:o?o(t):t}:o}}function O(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,r=e[Symbol.asyncIterator];return r?r.call(e):(e=y(e),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(r){t[r]=e[r]&&function(t){return new Promise((function(n,o){(function(e,t,r,n){Promise.resolve(n).then((function(t){e({value:t,done:r})}),t)})(n,o,(t=e[r](t)).done,t.value)}))}}}function j(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}var G=Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t};function S(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&d(t,e,r);return G(t,e),t}function P(e){return e&&e.__esModule?e:{default:e}}function T(e,t,r,n){if("a"===r&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?n:"a"===r?n.call(e):n?n.value:t.get(e)}function x(e,t,r,n,o){if("m"===n)throw new TypeError("Private method is not writable");if("a"===n&&!o)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!o:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===n?o.call(e,r):o?o.value=r:t.set(e,r),r}function E(e,t){if(null===t||"object"!=typeof t&&"function"!=typeof t)throw new TypeError("Cannot use \'in\' operator on non-object");return"function"==typeof e?t===e:e.has(t)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setFeatureGateDictionaryGetter=t.getIntFeatureGate=t.getNumberFeatureGate=t.getBooleanFeatureGate=t.getStringFeatureGate=t.getFeatureGateDictionary=void 0;var n=r(4),o={};function i(){return"undefined"==typeof __get_feature_gate_dictionary_variable?o:__get_feature_gate_dictionary_variable()}function a(e,t){var r;return null!==(r=i()[e])&&void 0!==r?r:t}t.getFeatureGateDictionary=i,t.getStringFeatureGate=a,t.getBooleanFeatureGate=function(e,t){var r,n=null===(r=a(e))||void 0===r?void 0:r.trim().toLowerCase();return"true"===n||"false"!==n&&t},t.getNumberFeatureGate=function(e,t){var r,n=null===(r=a(e))||void 0===r?void 0:r.trim().toLowerCase();if(void 0===n)return t;if("infinity"===n||"+infinity"===n)return 1/0;if("-infinity"===n)return-1/0;var o=parseFloat(n);return isNaN(o)?t:o},t.getIntFeatureGate=function(e,t){var r,n=null===(r=a(e))||void 0===r?void 0:r.trim();if(void 0===n)return t;var o=parseInt(n,10);return isNaN(o)?t:o},t.setFeatureGateDictionaryGetter=function(e){var t=n.globalThis.__get_feature_gate_dictionary_variable;return n.globalThis.__get_feature_gate_dictionary_variable=e,t}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setChangeGateDictionaryGetter=t.isChangeGateEnabled=t.getChangeGateDictionary=void 0;var n=r(4);function o(){return"undefined"==typeof __get_change_gate_dictionary_variable?{}:__get_change_gate_dictionary_variable()}t.getChangeGateDictionary=o,t.isChangeGateEnabled=function(e){var t;return null===(t=o()[e])||void 0===t||t},t.setChangeGateDictionaryGetter=function(e){var t=n.globalThis.__get_change_gate_dictionary_variable;return n.globalThis.__get_change_gate_dictionary_variable=e,t}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0);n.__exportStar(r(1),t),n.__exportStar(r(8),t),n.__exportStar(r(2),t),n.__exportStar(r(9),t),n.__exportStar(r(10),t),n.__exportStar(r(11),t)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.globalThis=void 0;var n=r(5);t.globalThis=n},function(e,t,r){"use strict";e.exports=r(6)()?globalThis:r(7)},function(e,t,r){"use strict";e.exports=function(){return"object"==typeof globalThis&&(!!globalThis&&globalThis.Array===Array)}},function(e,t){var r=function(){if("object"==typeof self&&self)return self;if("object"==typeof window&&window)return window;throw new Error("Unable to resolve global `this`")};e.exports=function(){if(this)return this;try{Object.defineProperty(Object.prototype,"__global__",{get:function(){return this},configurable:!0})}catch(e){return r()}try{return __global__||r()}finally{delete Object.prototype.__global__}}()},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.makeGetTypedFeatureGate=void 0;var n=r(1);t.makeGetTypedFeatureGate=function(e){return function(t){var r=e[t];switch(typeof r){case"boolean":return(0,n.getBooleanFeatureGate)(t,r);case"number":return(0,n.getNumberFeatureGate)(t,r);case"string":return(0,n.getStringFeatureGate)(t,r);default:throw new Error("Wrong defaultValue type")}}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.makeTypedIsChangeGateEnabled=void 0;var n=r(2);t.makeTypedIsChangeGateEnabled=function(e){return function(e){return(0,n.isChangeGateEnabled)(e)}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.overrideTypedChangeGates=t.overrideChangeGates=void 0;var n=r(0),o=r(2);function i(e){var t=(0,o.setChangeGateDictionaryGetter)(void 0);return(0,o.setChangeGateDictionaryGetter)((function(){var r=void 0!==t?t():{};return n.__assign(n.__assign({},r),e)})),t}t.overrideChangeGates=i,t.overrideTypedChangeGates=function(e,t){return i(t)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.overrideTypedFeatureGates=t.overrideFeatureGates=void 0;var n=r(0),o=r(1);function i(e){for(var t,r,i={},a=0,u=Object.keys(e);a<u.length;a++){var c=u[a];i[c]=null===(t=e[c])||void 0===t?void 0:t.toString()}var f=null!==(r=(0,o.setFeatureGateDictionaryGetter)(void 0))&&void 0!==r?r:function(){return{}};return(0,o.setFeatureGateDictionaryGetter)((function(){return n.__assign(n.__assign({},f()),i)})),f}t.overrideFeatureGates=i,t.overrideTypedFeatureGates=function(e,t){return i(t)}},function(e,t,r){"use strict";r.r(t);var n=r(0);function o(e){return i(e)&&"WorkerError"===e.name&&"object"==typeof e.info}function i(e){if(null==e)return!1;if(e instanceof Error)return!0;var t=e;return"string"==typeof t.name&&"string"==typeof t.message&&(null==t.stack||"string"==typeof t.stack)}function a(e){return i(e)?e:new Error("(non-Error object) ".concat(function(e){var t=typeof e;switch(t){case"function":case"symbol":case"undefined":return"<".concat(t,">");case"object":return JSON.stringify(e);default:return"".concat(e)}}(e)))}function u(e){return{name:e.name,message:o(e)?e.baseMessage:e.message,stack:e.stack,info:o(e)?(t=e.info,Object(n.__assign)(Object(n.__assign)({},t),{error:t.error?u(t.error):void 0})):void 0};var t}function c(e){throw new ReferenceError("".concat(e," is not defined"))}function f(e,t,r){void 0===r&&(r=c);try{for(var n=t.split("."),o=0,i=n;o<i.length;o++){e=e[i[o]]}return null!=e?e:r(t)}catch(e){return r(t)}}var l=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];return l.transfer.apply(l,Object(n.__spreadArray)([e,void 0],t,!1))};l.transfer=function(e,t){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];return{def:e,args:r,transferables:null!=t?t:[]}};var s="undefined"!=typeof performance&&void 0!==performance.timeOrigin?function(){return performance.now()+performance.timeOrigin}:function(){return Date.now()};function d(e,t,r){"Pending"===e.status&&(e.status=t,e.end=Math.max(e.start,null!=r?r:s()))}function p(e,t,r){var n=e.indexOf("?");if(n<0)return"".concat(e,"?").concat(t,"=").concat(r);for(var o=e.slice(0,n+1),i=e.slice(n+1).split("&"),a=0;a<i.length&&("="!==i[a][t.length]||i[a].slice(0,t.length)!==t);a+=1);return i[a]="".concat(t,"=").concat(r),o+i.join("&")}function y(e,t){for(var r,n=0;n<=t;n+=1)try{return void importScripts(n>0?p(e,"retries",String(n)):e)}catch(e){r=e}throw r}function v(e,t){if(0!==t)for(var r=0,n=e;r<n.length;r++){y(n[r],t)}else importScripts.apply(void 0,e)}var _=r(3);self.onmessage=function(e){var t,r,c=e.data,l=c.config,p=c.port,y=c.options,g=c.script,b=c.args,h=c.featureGateDictionary,m=c.changeGateDictionary;self.onmessage=null,self.__typed_workers_thread=!0,Object(_.setFeatureGateDictionaryGetter)((function(){return h})),Object(_.setChangeGateDictionaryGetter)((function(){return m}));var w,O=null!==(r=null!==(t=y.importScriptsMaxRetries)&&void 0!==t?t:l.importScriptsMaxRetries)&&void 0!==r?r:0;function j(){var e;if(w)return w;if(void 0===l.typedWorkersUrl)throw new TypeError("importTypedWorkers: typedWorkersUrl is not defined");return v([l.typedWorkersUrl],O),(w=f(self,null!==(e=l.typedWorkersName)&&void 0!==e?e:"typedWorkers")).setConfig(l),w}var G={status:"Pending",start:s()};function S(e,t){var r,n={kind:0,error:e?void 0:i(r=a(t))?{isError:!0,value:u(r)}:{isError:!1,value:r},stopwatch:G};self.postMessage(n),e||setTimeout(self.close.bind(self),6e4)}try{(function(e,t){function r(t){throw d(e,o(t)&&"Timeout"===t.info.cause?"Timeout":"Error"),t}try{return t().then((function(t){var r;return null!==(r=d(e,"Success"))&&void 0!==r?r:t}),r)}catch(e){r(e)}})(G,(function(){var e,t;return v(Object(n.__spreadArray)(Object(n.__spreadArray)([],null!==(t=null!==(e=null==y?void 0:y.importScriptUrls)&&void 0!==e?e:l.importScriptUrls)&&void 0!==t?t:[],!0),void 0!==g.scriptUrl?[g.scriptUrl]:[],!0),O),f(self,g.insideInitName).apply(void 0,Object(n.__spreadArray)([{config:l,importTypedWorkers:j,connection:{port:p,options:y,createMode:"Thread"}}],b,!1))})).then((function(){return S(!0)}),(function(e){return S(!1,e)}))}catch(e){S(!1,e)}}}]);']:
[hc,"\n\n",'!function(e){var t={};function r(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)r.d(n,o,function(t){return e[t]}.bind(null,o));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=12)}([function(e,t,r){"use strict";r.r(t),r.d(t,"__extends",(function(){return o})),r.d(t,"__assign",(function(){return i})),r.d(t,"__rest",(function(){return a})),r.d(t,"__decorate",(function(){return u})),r.d(t,"__param",(function(){return c})),r.d(t,"__metadata",(function(){return f})),r.d(t,"__awaiter",(function(){return l})),r.d(t,"__generator",(function(){return s})),r.d(t,"__createBinding",(function(){return d})),r.d(t,"__exportStar",(function(){return p})),r.d(t,"__values",(function(){return y})),r.d(t,"__read",(function(){return v})),r.d(t,"__spread",(function(){return _})),r.d(t,"__spreadArrays",(function(){return g})),r.d(t,"__spreadArray",(function(){return b})),r.d(t,"__await",(function(){return h})),r.d(t,"__asyncGenerator",(function(){return m})),r.d(t,"__asyncDelegator",(function(){return w})),r.d(t,"__asyncValues",(function(){return O})),r.d(t,"__makeTemplateObject",(function(){return j})),r.d(t,"__importStar",(function(){return S})),r.d(t,"__importDefault",(function(){return P})),r.d(t,"__classPrivateFieldGet",(function(){return T})),r.d(t,"__classPrivateFieldSet",(function(){return x})),r.d(t,"__classPrivateFieldIn",(function(){return E}));var n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(e,t)};function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var i=function(){return(i=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};function a(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(r[n[o]]=e[n[o]])}return r}function u(e,t,r,n){var o,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var u=e.length-1;u>=0;u--)(o=e[u])&&(a=(i<3?o(a):i>3?o(t,r,a):o(t,r))||a);return i>3&&a&&Object.defineProperty(t,r,a),a}function c(e,t){return function(r,n){t(r,n,e)}}function f(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}function l(e,t,r,n){return new(r||(r=Promise))((function(o,i){function a(e){try{c(n.next(e))}catch(e){i(e)}}function u(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,u)}c((n=n.apply(e,t||[])).next())}))}function s(e,t){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}}var d=Object.create?function(e,t,r,n){void 0===n&&(n=r);var o=Object.getOwnPropertyDescriptor(t,r);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,o)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]};function p(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||d(t,e,r)}function y(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function v(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,o,i=r.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(n=i.next()).done;)a.push(n.value)}catch(e){o={error:e}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return a}function _(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(v(arguments[t]));return e}function g(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;var n=Array(e),o=0;for(t=0;t<r;t++)for(var i=arguments[t],a=0,u=i.length;a<u;a++,o++)n[o]=i[a];return n}function b(e,t,r){if(r||2===arguments.length)for(var n,o=0,i=t.length;o<i;o++)!n&&o in t||(n||(n=Array.prototype.slice.call(t,0,o)),n[o]=t[o]);return e.concat(n||Array.prototype.slice.call(t))}function h(e){return this instanceof h?(this.v=e,this):new h(e)}function m(e,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n,o=r.apply(e,t||[]),i=[];return n={},a("next"),a("throw"),a("return"),n[Symbol.asyncIterator]=function(){return this},n;function a(e){o[e]&&(n[e]=function(t){return new Promise((function(r,n){i.push([e,t,r,n])>1||u(e,t)}))})}function u(e,t){try{(r=o[e](t)).value instanceof h?Promise.resolve(r.value.v).then(c,f):l(i[0][2],r)}catch(e){l(i[0][3],e)}var r}function c(e){u("next",e)}function f(e){u("throw",e)}function l(e,t){e(t),i.shift(),i.length&&u(i[0][0],i[0][1])}}function w(e){var t,r;return t={},n("next"),n("throw",(function(e){throw e})),n("return"),t[Symbol.iterator]=function(){return this},t;function n(n,o){t[n]=e[n]?function(t){return(r=!r)?{value:h(e[n](t)),done:"return"===n}:o?o(t):t}:o}}function O(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,r=e[Symbol.asyncIterator];return r?r.call(e):(e=y(e),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(r){t[r]=e[r]&&function(t){return new Promise((function(n,o){(function(e,t,r,n){Promise.resolve(n).then((function(t){e({value:t,done:r})}),t)})(n,o,(t=e[r](t)).done,t.value)}))}}}function j(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}var G=Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t};function S(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&d(t,e,r);return G(t,e),t}function P(e){return e&&e.__esModule?e:{default:e}}function T(e,t,r,n){if("a"===r&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?n:"a"===r?n.call(e):n?n.value:t.get(e)}function x(e,t,r,n,o){if("m"===n)throw new TypeError("Private method is not writable");if("a"===n&&!o)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!o:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===n?o.call(e,r):o?o.value=r:t.set(e,r),r}function E(e,t){if(null===t||"object"!=typeof t&&"function"!=typeof t)throw new TypeError("Cannot use \'in\' operator on non-object");return"function"==typeof e?t===e:e.has(t)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setFeatureGateDictionaryGetter=t.getIntFeatureGate=t.getNumberFeatureGate=t.getBooleanFeatureGate=t.getStringFeatureGate=t.getFeatureGateDictionary=void 0;var n=r(4),o={};function i(){return"undefined"==typeof __get_feature_gate_dictionary_variable?o:__get_feature_gate_dictionary_variable()}function a(e,t){var r;return null!==(r=i()[e])&&void 0!==r?r:t}t.getFeatureGateDictionary=i,t.getStringFeatureGate=a,t.getBooleanFeatureGate=function(e,t){var r,n=null===(r=a(e))||void 0===r?void 0:r.trim().toLowerCase();return"true"===n||"false"!==n&&t},t.getNumberFeatureGate=function(e,t){var r,n=null===(r=a(e))||void 0===r?void 0:r.trim().toLowerCase();if(void 0===n)return t;if("infinity"===n||"+infinity"===n)return 1/0;if("-infinity"===n)return-1/0;var o=parseFloat(n);return isNaN(o)?t:o},t.getIntFeatureGate=function(e,t){var r,n=null===(r=a(e))||void 0===r?void 0:r.trim();if(void 0===n)return t;var o=parseInt(n,10);return isNaN(o)?t:o},t.setFeatureGateDictionaryGetter=function(e){var t=n.globalThis.__get_feature_gate_dictionary_variable;return n.globalThis.__get_feature_gate_dictionary_variable=e,t}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setChangeGateDictionaryGetter=t.isChangeGateEnabled=t.getChangeGateDictionary=void 0;var n=r(4);function o(){return"undefined"==typeof __get_change_gate_dictionary_variable?{}:__get_change_gate_dictionary_variable()}t.getChangeGateDictionary=o,t.isChangeGateEnabled=function(e){var t;return null===(t=o()[e])||void 0===t||t},t.setChangeGateDictionaryGetter=function(e){var t=n.globalThis.__get_change_gate_dictionary_variable;return n.globalThis.__get_change_gate_dictionary_variable=e,t}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0);n.__exportStar(r(1),t),n.__exportStar(r(8),t),n.__exportStar(r(2),t),n.__exportStar(r(9),t),n.__exportStar(r(10),t),n.__exportStar(r(11),t)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.globalThis=void 0;var n=r(5);t.globalThis=n},function(e,t,r){"use strict";e.exports=r(6)()?globalThis:r(7)},function(e,t,r){"use strict";e.exports=function(){return"object"==typeof globalThis&&(!!globalThis&&globalThis.Array===Array)}},function(e,t){var r=function(){if("object"==typeof self&&self)return self;if("object"==typeof window&&window)return window;throw new Error("Unable to resolve global `this`")};e.exports=function(){if(this)return this;try{Object.defineProperty(Object.prototype,"__global__",{get:function(){return this},configurable:!0})}catch(e){return r()}try{return __global__||r()}finally{delete Object.prototype.__global__}}()},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.makeGetTypedFeatureGate=void 0;var n=r(1);t.makeGetTypedFeatureGate=function(e){return function(t){var r=e[t];switch(typeof r){case"boolean":return(0,n.getBooleanFeatureGate)(t,r);case"number":return(0,n.getNumberFeatureGate)(t,r);case"string":return(0,n.getStringFeatureGate)(t,r);default:throw new Error("Wrong defaultValue type")}}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.makeTypedIsChangeGateEnabled=void 0;var n=r(2);t.makeTypedIsChangeGateEnabled=function(e){return function(e){return(0,n.isChangeGateEnabled)(e)}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.overrideTypedChangeGates=t.overrideChangeGates=void 0;var n=r(0),o=r(2);function i(e){var t=(0,o.setChangeGateDictionaryGetter)(void 0);return(0,o.setChangeGateDictionaryGetter)((function(){var r=void 0!==t?t():{};return n.__assign(n.__assign({},r),e)})),t}t.overrideChangeGates=i,t.overrideTypedChangeGates=function(e,t){return i(t)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.overrideTypedFeatureGates=t.overrideFeatureGates=void 0;var n=r(0),o=r(1);function i(e){for(var t,r,i={},a=0,u=Object.keys(e);a<u.length;a++){var c=u[a];i[c]=null===(t=e[c])||void 0===t?void 0:t.toString()}var f=null!==(r=(0,o.setFeatureGateDictionaryGetter)(void 0))&&void 0!==r?r:function(){return{}};return(0,o.setFeatureGateDictionaryGetter)((function(){return n.__assign(n.__assign({},f()),i)})),f}t.overrideFeatureGates=i,t.overrideTypedFeatureGates=function(e,t){return i(t)}},function(e,t,r){"use strict";r.r(t);var n=r(0);function o(e){return i(e)&&"WorkerError"===e.name&&"object"==typeof e.info}function i(e){if(null==e)return!1;if(e instanceof Error)return!0;var t=e;return"string"==typeof t.name&&"string"==typeof t.message&&(null==t.stack||"string"==typeof t.stack)}function a(e){return i(e)?e:new Error("(non-Error object) ".concat(function(e){var t=typeof e;switch(t){case"function":case"symbol":case"undefined":return"<".concat(t,">");case"object":return JSON.stringify(e);default:return"".concat(e)}}(e)))}function u(e){return{name:e.name,message:o(e)?e.baseMessage:e.message,stack:e.stack,info:o(e)?(t=e.info,Object(n.__assign)(Object(n.__assign)({},t),{error:t.error?u(t.error):void 0})):void 0};var t}function c(e){throw new ReferenceError("".concat(e," is not defined"))}function f(e,t,r){void 0===r&&(r=c);try{for(var n=t.split("."),o=0,i=n;o<i.length;o++){e=e[i[o]]}return null!=e?e:r(t)}catch(e){return r(t)}}var l=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];return l.transfer.apply(l,Object(n.__spreadArray)([e,void 0],t,!1))};l.transfer=function(e,t){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];return{def:e,args:r,transferables:null!=t?t:[]}};var s="undefined"!=typeof performance&&void 0!==performance.timeOrigin?function(){return performance.now()+performance.timeOrigin}:function(){return Date.now()};function d(e,t,r){"Pending"===e.status&&(e.status=t,e.end=Math.max(e.start,null!=r?r:s()))}function p(e,t,r){var n=e.indexOf("?");if(n<0)return"".concat(e,"?").concat(t,"=").concat(r);for(var o=e.slice(0,n+1),i=e.slice(n+1).split("&"),a=0;a<i.length&&("="!==i[a][t.length]||i[a].slice(0,t.length)!==t);a+=1);return i[a]="".concat(t,"=").concat(r),o+i.join("&")}function y(e,t){for(var r,n=0;n<=t;n+=1)try{return void importScripts(n>0?p(e,"retries",String(n)):e)}catch(e){r=e}throw r}function v(e,t){if(0!==t)for(var r=0,n=e;r<n.length;r++){y(n[r],t)}else importScripts.apply(void 0,e)}var _=r(3);self.onmessage=function(e){var t,r,c=e.data,l=c.config,p=c.port,y=c.options,g=c.script,b=c.args,h=c.featureGateDictionary,m=c.changeGateDictionary;self.onmessage=null,self.__typed_workers_thread=!0,Object(_.setFeatureGateDictionaryGetter)((function(){return h})),Object(_.setChangeGateDictionaryGetter)((function(){return m}));var w,O=null!==(r=null!==(t=y.importScriptsMaxRetries)&&void 0!==t?t:l.importScriptsMaxRetries)&&void 0!==r?r:0;function j(){var e;if(w)return w;if(void 0===l.typedWorkersUrl)throw new TypeError("importTypedWorkers: typedWorkersUrl is not defined");return v([l.typedWorkersUrl],O),(w=f(self,null!==(e=l.typedWorkersName)&&void 0!==e?e:"typedWorkers")).setConfig(l),w}var G={status:"Pending",start:s()};function S(e,t){var r,n={kind:0,error:e?void 0:i(r=a(t))?{isError:!0,value:u(r)}:{isError:!1,value:r},stopwatch:G};self.postMessage(n),e||setTimeout(self.close.bind(self),6e4)}try{(function(e,t){function r(t){throw d(e,o(t)&&"Timeout"===t.info.cause?"Timeout":"Error"),t}try{return t().then((function(t){var r;return null!==(r=d(e,"Success"))&&void 0!==r?r:t}),r)}catch(e){r(e)}})(G,(function(){var e,t;return v(Object(n.__spreadArray)(Object(n.__spreadArray)([],null!==(t=null!==(e=null==y?void 0:y.importScriptUrls)&&void 0!==e?e:l.importScriptUrls)&&void 0!==t?t:[],!0),void 0!==g.scriptUrl?[g.scriptUrl]:[],!0),O),f(self,g.insideInitName).apply(void 0,Object(n.__spreadArray)([{config:l,importTypedWorkers:j,connection:{port:p,options:y,createMode:"Thread"}}],b,!1))})).then((function(){return S(!0)}),(function(e){return S(!1,e)}))}catch(e){S(!1,e)}}}]);'],
{type:"application/javascript"}));mb={};null!=Ab.id&&(mb.name=Ab.id);this.worker=new Worker(this.Psd,mb)}catch(ob){throw null===(Rb=this.worker)||void 0===Rb?void 0:Rb.terminate(),this.RSi(),ob;}}Ua.prototype.RSi=function(){void 0!==this.Psd&&(URL.revokeObjectURL(this.Psd),this.Psd=void 0)};Ua.prototype.g0e=function(Ab,mb){var Rb=this,hc=Ab.port,Hb=Ab.options,Ta={type:"Thread",FKb:"Outside",id:Hb.id},Aa=this.worker;Ab=new Promise(function(ma,Ga){Rb.ZZb={resolve:ma,reject:Ga};ma={config:F(),port:hc,
options:Hb,script:Rb.script,args:Rb.args,featureGateDictionary:Object(xa.getFeatureGateDictionary)(),lCo:Object(xa.getChangeGateDictionary)()};Aa.postMessage(ma,Object(ia.__spreadArray)([hc],Rb.transferables,!0));Aa.onerror=function(Fa){Fa.preventDefault();if(k(Fa.error))if(a(Fa.error))var ib=Fa.error;else ib={cZ:"UnhandledError",cD:Ta,error:Fa.error},ib=new va("".concat("worker.onerror"," received an unhandled error"),ib);else null==Fa.message?(ib={cZ:"UnhandledError",cD:Ta},ib=new va("".concat("worker.onerror",
" received a non-error (worker script fetch probably failed)"),ib)):(ib={cZ:"UnhandledError",cD:Ta},Fa="".concat(Fa.message," at ").concat(Fa.filename,":").concat(Fa.lineno,":").concat(Fa.colno),ib=new va("".concat("worker.onerror"," received an unhandled error: ").concat(Fa),ib));Rb.ZZb?Rb.ZZb.reject(ib):L(ib)};Aa.onmessage=function(Fa){var ib,ob;Fa=Fa.data;switch(Fa.kind){case 0:return mb.sof=Fa.hx,void 0===Fa.error?null===(ib=Rb.ZZb)||void 0===ib?void 0:ib.resolve():null===(ob=Rb.ZZb)||void 0===
ob?void 0:ob.reject(y(Fa.error));case 1:return L(y(Fa.error));case 2:return E(Fa.stats)}}});return P(Ab,function(){return void(Rb.ZZb=void 0)})};Ua.prototype.terminate=function(){var Ab;if(this.worker){var mb=this.worker;this.worker=void 0;null===(Ab=this.ZZb)||void 0===Ab?void 0:Ab.resolve();mb.terminate();this.RSi()}};return Ua}(),zb="undefined"!==typeof performance&&void 0!==performance.timeOrigin?function(){return performance.now()+performance.timeOrigin}:function(){return Date.now()};d.d(N,"WorkerError",
function(){return va});d.d(N,"isThreadingSupported",function(){return B});d.d(N,"setConfig",function(){return G});d.d(N,"dispatchWorkerError",function(){return L});d.d(N,"paramInsideDef",function(){return e});d.d(N,"Endpoint",function(){return Sa});d.d(N,"createWorker",function(){return Ca});d.d(N,"importScriptsWithRetry",function(){return Ja});d.d(N,"isWorkerThread",function(){return bb});d.d(N,"workerName",function(){return ha})},921:function(C,N,d){function l(){return"undefined"===typeof __get_feature_gate_dictionary_variable?
k:__get_feature_gate_dictionary_variable()}function e(n,v){var u;return null!==(u=l()[n])&&void 0!==u?u:v}Object.defineProperty(N,"__esModule",{value:!0});N.VXf=N.getIntFeatureGate=N.hVh=N.getBooleanFeatureGate=N.getStringFeatureGate=N.vQh=void 0;var a=d(1005),k={};N.vQh=l;N.getStringFeatureGate=e;N.getBooleanFeatureGate=function(n,v){var u;n=null===(u=e(n))||void 0===u?void 0:u.trim().toLowerCase();return"true"===n?!0:"false"===n?!1:v};N.hVh=function(n,v){var u;n=null===(u=e(n))||void 0===u?void 0:
u.trim().toLowerCase();if(void 0===n)return v;if("infinity"===n||"+infinity"===n)return Infinity;if("-infinity"===n)return-Infinity;u=parseFloat(n);return isNaN(u)?v:u};N.getIntFeatureGate=function(n,v){var u;n=null===(u=e(n))||void 0===u?void 0:u.trim();if(void 0===n)return v;u=parseInt(n,10);return isNaN(u)?v:u};N.VXf=function(n){var v=a.globalThis.tuj;a.globalThis.tuj=n;return v}},922:function(C,N,d){function l(){return"undefined"===typeof __get_change_gate_dictionary_variable?{}:__get_change_gate_dictionary_variable()}
Object.defineProperty(N,"__esModule",{value:!0});N.CXf=N.isChangeGateEnabled=N.uNh=void 0;var e=d(1005);N.uNh=l;N.isChangeGateEnabled=function(a){var k;return null!==(k=l()[a])&&void 0!==k?k:!0};N.CXf=function(a){var k=e.globalThis.suj;e.globalThis.suj=a;return k}},933:function(C,N,d){d.d(N,"a",function(){return l});C=d(0);class l{constructor(){this.method=this.api=0}}Object(C.a)(l,"Message",null,[])}}]);

//# sourceMappingURL=https://res-dev.cdn.officeppe.net/1js/build/16477519/wdjs/WordEditorDS.box4.dll1.js.map