define("metaserver/static/js/cloud_docs/cloud_doc_acl_fixer",["require","exports","tslib","lodash","react-intl","react","metaserver/static/js/sharing/async_share_modal_util","metaserver/static/js/api_v2/types","metaserver/static/js/clean/ui/snackbar","metaserver/static/js/sharing/access_level","metaserver/static/js/sharing/actions/sharing_actions","metaserver/static/js/sharing/api/client","metaserver/static/js/sharing/stores/sharing_info","metaserver/static/js/core/i18n","metaserver/static/js/cloud_docs/types","metaserver/static/js/cloud_docs/utils"],(function(e,t,o,s,r,a,i,n,c,d,l,p,u,m,h,g){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CloudDocAclFixer=void 0,s=o.__importStar(s),a=o.__importDefault(a);t.CloudDocAclFixer=class{constructor(e){this.loadCloudDocMembersToStore=e=>new Promise((t,s)=>o.__awaiter(this,void 0,void 0,(function*(){l.SharingActions.listMembers({user:this.user,contentId:e.docInfo.fileId,isFolder:!1,client:this.shareApiClient}).then(()=>t({success:!0,processed:e})).catch(()=>t({success:!1,processed:e}))}))),this.processEmails=()=>o.__awaiter(this,void 0,void 0,(function*(){for(this.processing=!0;this.toProcess.length>0;){const e=this.toProcess.pop(),{success:t,processed:o}=yield this.loadCloudDocMembersToStore(e);if(!t){const e=this.getCurrentDocInfo();if(!s.isEqual(e,o.docInfo))continue;this.showSnackbar("fail",o.emails,o.docInfo);continue}const r=this.getEmailsToAdd(o);0!==r.length&&(yield this.addEmailsToFileAcl(r,o.docInfo).then(e=>this.processAddToAclResponse(e)))}return this.processing=!1,Promise.resolve()})),this.processAddToAclResponse=e=>{const{emails:t,success:o,result:r,docInfo:a}=e,i=this.getCurrentDocInfo();if(!s.isEqual(i,a))return;if(!o)return void this.showSnackbar("fail",t,a);const n=r.every(e=>"success"===e.result[".tag"]),c=r.every(e=>"success"!==e.result[".tag"]);if(n)this.showSnackbar("complete",t,a);else if(c)this.showSnackbar("fail",t,a);else{const e=r.filter(e=>"success"!==e.result[".tag"]).map(e=>e.member.email);this.showSnackbar("warn",e,a)}},this.addEmailsToFileAcl=(e,t)=>o.__awaiter(this,void 0,void 0,(function*(){const o=e.map(e=>new n.UnionScalar("email",e));return this.shareApiClient.addMembers({contentId:t.fileId,accessLevel:d.ACCESS_LEVEL.WRITER,members:o}).then(o=>({docInfo:t,emails:e,result:o,success:!0})).catch(()=>({docInfo:t,emails:e,success:!1,result:[]}))})),this.closeSnackbar=()=>c.Snackbar.close(),this.displayShareModal=(e,t,o)=>()=>o.prefilled?(0,i.asyncShowPrefilledShareModal)({user:this.user,sharePrefillEmails:e,content:{fileId:t.fileId,fqPath:t.fqPath,origin:(0,g.integrationNameToShareActionOrigin)(t.integrationName),isFolder:!1}}):(0,i.asyncShowShareModal)(this.user,{fileId:t.fileId,fqPath:t.fqPath,isFolder:!1},{origin:(0,g.integrationNameToShareActionOrigin)(t.integrationName)}),this.toProcess=[],this.user=e.user,this.getCurrentDocInfo=e.getDocInfo,this.shareApiClient=new p.FileShareApiClient({userId:e.user.id})}addEmails(e,t){return t.integrationName===h.IntegrationName.GOOGLE_DSS?(this.displayShareModal(e,t,{prefilled:!0})(),Promise.resolve()):(this.toProcess=this.toProcess.concat({docInfo:t,emails:e}),this.processing?Promise.resolve():this.processEmails())}showSnackbar(e,t,o){const s="warn"===e?m.intl.formatMessage({id:"ow64Ns",defaultMessage:"Invite members"}):m.intl.formatMessage({id:"TWZWgd",defaultMessage:"View members"});let i;const n=m.intl.formatMessage({id:"u/p3Pl",defaultMessage:"Close"});let d,l=null;switch(e){case"complete":if(i=this.displayShareModal(t,o,{prefilled:!1}),1===t.length){const e=(0,r.defineMessage)({id:"gYv2NF",defaultMessage:"Doc shared with <bold>{email}</bold>."});d=m.intl.formatMessage(e,{bold:e=>a.default.createElement("b",null,e),email:t[0]})}else{d=m.intl.formatMessage({id:"ofLB4B",defaultMessage:"{count, plural, one{Doc shared with {count} person.} other{Doc shared with {count} people.}}"},{count:t.length})}break;case"warn":i=this.displayShareModal(t,o,{prefilled:!0}),d=m.intl.formatMessage({id:"oEguDz",defaultMessage:"Couldn’t add some people to this doc. Try inviting them instead."});break;case"fail":i=this.displayShareModal(t,o,{prefilled:!0}),d=m.intl.formatMessage({id:"+a6RMC",defaultMessage:"Couldn’t share doc. Try again a bit later."});break;default:return}l=a.default.createElement(c.ControlledSnackbar,{title:d,variant:e,actionButtonText:s,onActionClick:i,closeButtonText:n,onCloseClick:this.closeSnackbar}),c.Snackbar.show(l)}getEmailsToAdd(e){const t=this.getEmailsFromSharingInfo(e.docInfo);return e.emails.filter(e=>-1===t.indexOf(e))}getEmailsFromSharingInfo(e){const t=u.sharingInfoStore.getSharingInfo(this.user.id,e.fileId);if(!t)return[];const o=t.members(),s=this.getUserMemberEmails(o),r=this.getInviteeMemberEmails(o);return s.concat(r)}getInviteeMemberEmails(e){return e.invitees.valueSeq().toArray().reduce((e,t)=>(e.push(t.contact),e),[])}getUserMemberEmails(e){return e.users.valueSeq().toArray().reduce((e,t)=>(t.account&&t.account.email&&e.push(t.account.email),e),[])}}})),define("metaserver/static/js/cloud_docs/cloud_doc_host_page",["require","exports","tslib","react","metaserver/static/js/cloud_docs/google_dss/gdd_direct_iframe_wrapper","metaserver/static/js/cloud_docs/google_dss/gdd_iframe_wrapper","metaserver/static/js/cloud_docs/paper/paper_iframe_wrapper","metaserver/static/js/cloud_docs/types","metaserver/static/js/cloud_docs/wopi/wopi_iframe_wrapper","metaserver/static/js/cloud_docs/errors","metaserver/static/js/bug_reporting/routing"],(function(e,t,o,s,r,a,i,n,c,d,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CloudDocHostPageComponent=void 0,s=o.__importDefault(s);t.CloudDocHostPageComponent=e=>e.integrationName===n.IntegrationName.PAPER_INTEGRATION?s.default.createElement(l.RegisterComponentWithBugReporter,{componentId:"paper.unknown",componentName:"Cloud Docs Host Page"},s.default.createElement(d.ErrorBoundary,{tags:[d.PAPER_EXCLOG_TAG_NAME]},s.default.createElement(i.PaperIframeWrapper,Object.assign({},e)))):e.integrationName===n.IntegrationName.GOOGLE_DSS?e.gddArgs&&!0===e.gddArgs.enableDirectIFrame?s.default.createElement(l.RegisterComponentWithBugReporter,{componentId:"web.cloud_docs",componentName:"Cloud Docs Host Page"},s.default.createElement(d.ErrorBoundary,{tags:[d.GDD_DIRECT_EXCLOG_TAG_NAME]},s.default.createElement(r.GDDDirectIframeWrapper,Object.assign({},e,{gddArgs:e.gddArgs,loadingStrings:e.loadingStrings})))):s.default.createElement(l.RegisterComponentWithBugReporter,{componentId:"web.cloud_docs",componentName:"Cloud Docs Host Page"},s.default.createElement(d.ErrorBoundary,{tags:[d.GDD_INTERMEDIATE_EXCLOG_TAG_NAME]},s.default.createElement(a.GDDIframeWrapper,Object.assign({},e,{gddArgs:e.gddArgs,loadingStrings:e.loadingStrings})))):e.integrationName===n.IntegrationName.OFFICE_ONLINE?s.default.createElement(l.RegisterComponentWithBugReporter,{componentId:"web.cloud_docs",componentName:"Cloud Docs Host Page"},s.default.createElement(d.ErrorBoundary,{tags:[d.WOPI_EXCLOG_TAG_NAME]},s.default.createElement(c.WopiIframeWrapper,Object.assign({},e,{wopiArgs:e.wopiArgs,iframeCreatedTime:Date.now()})))):null,t.CloudDocHostPageComponent.displayName="CloudDocHostPageComponent"})),define("metaserver/static/js/cloud_docs/cloud_doc_iframe",["require","exports","tslib","react","metaserver/static/js/cloud_docs/cloud_doc_api_client","metaserver/static/js/cloud_docs/cloud_doc_iframe_helpers","metaserver/static/js/cloud_docs/cloud_doc_status_api","metaserver/static/js/cloud_docs/shared_components/cloud_doc_snackbar_controller","metaserver/static/js/cloud_docs/event_logging","metaserver/static/js/cloud_docs/cloud_doc_acl_fixer","metaserver/static/js/cloud_docs/types","metaserver/static/js/clean/viewer","metaserver/static/js/clean/web_timing_logger","metaserver/static/js/core/browser","metaserver/static/js/core/uri","metaserver/static/js/cloud_docs/utils","metaserver/static/js/cloud_docs/loading_page","metaserver/static/js/metrics/index","metaserver/static/js/cloud_docs/constants","typescript/libraries/shared/apex-metrics/src/index","metaserver/static/js/filepath/filepath","metaserver/static/js/cloud_docs/errors","metaserver/static/js/core/notify","metaserver/static/js/cloud_docs/shared_components/routing"],(function(e,t,o,s,r,a,i,n,c,d,l,p,u,m,h,g,f,_,v,C,D,S,M,b){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ProviderIframeContainer=void 0,s=o.__importDefault(s),p=o.__importStar(p),u=o.__importStar(u),m=o.__importStar(m);class E extends s.default.Component{constructor(t){super(t),this.getCurrentDocInfo=()=>({fileId:this.state.fileId,fqPath:null===this.state.fqPath?void 0:this.state.fqPath,integrationName:this.props.integrationName}),this.loadPostTTI=()=>o.__awaiter(this,void 0,void 0,(function*(){if(this.snackbarController.showSnackbars(),this.pollCloudDocState(this.props.userData.id),this.props.userData.id)yield this.maybeShowShareModal(this.props.userData.id),this.aclFixer=new d.CloudDocAclFixer({user:p.Viewer.get_viewer().get_user_by_id(this.props.userData.id),getDocInfo:this.getCurrentDocInfo}),(0,c.checkAndLogNpu)(this.props.userData.id,(0,l.GetPartnerIntegration)(this.props.integrationName),this.props.filename,this.props.editorType,(0,l.getPlatform)(this.props.platform)),this.updateTokenSeenTime(this.props.userData.id);else{const e=this.state.maxAccessUrl?this.state.maxAccessUrl:m.get_href();yield this.showSigninComponent("titlebar",e)}this.props.postTTIProviderCallback&&this.props.postTTIProviderCallback(this.state.fileId)})),this.showSigninComponent=(t,s)=>o.__awaiter(this,void 0,void 0,(function*(){(yield new Promise((t,o)=>{e(["metaserver/static/js/cloud_docs/shared_components/cloud_doc_signin_component"],t,o)}).then(o.__importStar)).showCloudDocSignInComponent(t,this.clientFrame,s,(0,D.file_extension)(this.props.filename),this.props.editorType,this.props.loggedOutUXGoogleVariant,this.props.loggedOutUXPaperVariant)})),this.maybeShowShareModal=t=>o.__awaiter(this,void 0,void 0,(function*(){yield new Promise((t,o)=>{e(["metaserver/static/js/sharing/async_share_modal_util"],t,o)}).then(o.__importStar);const{shareModalMode:s}=this.props;s&&s.variant===l.ShareModalVariant.prefilled&&s.emails?yield this.showPrefilledShareModal(t,s.emails.split(",")):s&&s.variant===l.ShareModalVariant.unfilled?yield this.showShareModal(t,{origin:(0,g.integrationNameToShareActionOrigin)(this.props.integrationName)}):s&&s.variant===l.ShareModalVariant.linkSettings&&(yield this.showShareModal(t,{openLinkSettings:!0,origin:(0,g.integrationNameToShareActionOrigin)(this.props.integrationName)}))})),this.pollCloudDocState=e=>o.__awaiter(this,void 0,void 0,(function*(){const t=e?yield(0,i.getCloudDocState)(e,this.state.docId,this.state.tpatData.tpat):yield(0,i.getCloudDocStateLoggedOut)(this.state.docId,this.state.tpatData.tpat),o=(0,i.getNewCloudDocState)(this.state,t);if(o.docId===this.state.docId){if((0,i.continuePolling)(this.state,t)){let o=6e4;t.docState===i.DocState.Deleted&&(o=1e4),setTimeout(()=>this.pollCloudDocState(e),o)}this.setState(o)}else setTimeout(()=>this.pollCloudDocState(e),6e4)})),this.updateTokenSeenTime=e=>o.__awaiter(this,void 0,void 0,(function*(){(0,r.logTokenInUse)(e,this.state.docId,this.state.tpatData.tpat),setTimeout(()=>this.updateTokenSeenTime(e),9e5)})),this.showPrefilledShareModal=(t,s)=>new Promise((t,o)=>{e(["metaserver/static/js/sharing/async_share_modal_util"],t,o)}).then(o.__importStar).then(({asyncShowPrefilledShareModal:e})=>e({user:p.Viewer.get_viewer().get_user_by_id(t),sharePrefillEmails:s,content:{fileId:this.state.fileId,origin:(0,g.integrationNameToShareActionOrigin)(this.props.integrationName),isFolder:!1}})),this.showShareModal=(t,s)=>new Promise((t,o)=>{e(["metaserver/static/js/sharing/async_share_modal_util"],t,o)}).then(o.__importStar).then(({asyncShowShareModal:e})=>e(t,{fileId:this.state.fileId,origin:(0,g.integrationNameToShareActionOrigin)(this.props.integrationName),isFolder:!1},s)),this.logClientEventWithPerformanceExtras=(e,t,o)=>{const s=this.props.entryPoint?String(this.props.entryPoint):"UNKNOWN",r=(0,_.getMetricsReporter)(),a={editor:this.props.editorType,event:e[".tag"],entryPoint:s,trafficType:this.props.userData.trafficType};r.createStats({ns:v.CLOUD_DOCS_AMP_NAMESPACE,name:"web/openClientEvent"},a).recordDuration((t||Date.now())-(0,c.getStartTime)(),C.TimeUnit.MILLISECONDS);const i=o||[];i.push({key:"time_now",value:(t||Date.now()).toString()},{key:"entry_point",value:s}),this.logClientEventWithExtras(e,i)},this.logLoadIframeAttempt=()=>{let e=window._iframe_load_attempt;null==e&&(e=Date.now()),this.logClientEventWithPerformanceExtras(l.LoadIframeAttempt,e,[{key:"load_iframe_attempt_time",value:String(e-(0,c.getStartTime)())}])},this.registerClient=(e,t)=>(this.clientFrame=e,this.props.showClientFrameWhileLoading||this.clientFrame.setAttribute("style","visibility: hidden"),this.cloudDocFrameMessengerHost=this.props.constructProviderSpecificFrameMessengerHost(this.handleMessageEventWithExceptionHandling,this.clientFrame,this.props.actionUrl,this.props.providerSpecificActions,t),[a.WindowEvent.hashchange,a.WindowEvent.popstate].forEach(e=>{window.addEventListener(e,t=>{this.handleWindowEvent(e,t)})}),this.cloudDocFrameMessengerHost),this.startNavigatingToDoc=(e,t)=>{t&&window.history.pushState(null,this.state.filename||"",this.state.maxAccessUrl),this.setState({pendingDocId:e,iframeLoaded:!1})},this.completeNavigatingToDoc=(e,t,o,s,r,a,n,c,d,l,p)=>{this.setState({docId:e,pendingDocId:null,tpatData:t,boltData:o,nsid:r,fileId:s,fqPath:n,editorType:c,maxAccessUrl:p,filename:a,iframeLoaded:!0,canEdit:void 0,canRestore:void 0,docState:i.DocState.Undefined,usage:void 0,quota:void 0},()=>{this.handleNavigationStateChanges(l,p)})},this.handleNavigationStateChanges=(e,t)=>{const o=this.state.filename||"";e===a.BrowserHistoryUpdateAction.push?window.history.pushState(null,o,t):e===a.BrowserHistoryUpdateAction.replace&&window.history.replaceState(null,o,t),!this.isPaperEditor()&&u.waitForTTI().then(()=>{if(this.props.userData.id){const e=this.props.userData.id;setTimeout(()=>{(0,c.logViewEvent)(e,t,(0,l.getPlatform)(this.props.platform))},v.CLOUD_DOCS_PASS_LOG_DELAY_MS)}})},this.handleMessageEventWithExceptionHandling=e=>{try{this.handleMessageEvent(e)}catch(e){throw(0,S.reportCloudDocsException)(e,this.props.exceptionLoggingTags),e}},this.handleMessageEvent=e=>{const t=e.action;if(e.action==l.CloudDocActionsToDropbox.ChildReady){const t=e.parameters.sentTimestampMs||0;this.logClientReadyEvent(t)}else this.logMessageReceivedClientEvent(e.action);if(this.props.onProviderSpecificMessage(e,this.dropLoadingScreenAndDisplayChildFrame))return;if(e.action===l.GDDSpecificActionsToDropbox.FrameLoaded&&this.snackbarController.clearPreviewSnackbarTimer(),t===l.CloudDocActionsToDropbox.ChildReady||t===l.WopiSpecificActionsToDropbox.AppLoadingStatus)return this.cloudDocFrameMessengerHost.postMessageToChildren(l.CloudDocActionsToProvider.HostReady),this.logClientEvent(l.SentMessageHostReady),this.state.initialIframeLoaded||this.logClientEventWithPerformanceExtras(l.LoadIframeSuccess),this.setState({iframeLoaded:!0,initialIframeLoaded:!0}),void this.dropLoadingScreenAndDisplayChildFrame();if(t===l.CloudDocActionsToDropbox.ChildViewable)return;if(t===l.CloudDocActionsToDropbox.ChildInteractive)return void u.mark_time_to_interactive();if(t===l.CloudDocActionsToDropbox.ProviderFrameCalled)return void this.setState({providerFrameCalled:!0});const o=this.state.pendingDocId||this.state.docId;if(e.parameters.docId===o){if(this.props.userData.id)if(t===l.CloudDocActionsToDropbox.OpenAddAccessUI){const t=e.parameters.emailAddresses;this.aclFixer.addEmails(t,this.getCurrentDocInfo())}else if(t===l.CloudDocActionsToDropbox.OpenSharingUI){const t=e,o=t.parameters.emailAddresses,s=t.parameters.initialScreen;o&&o.length>0?this.showPrefilledShareModal(this.props.userData.id,o):this.showShareModal(this.props.userData.id,{initialScreen:s,origin:(0,g.integrationNameToShareActionOrigin)(this.props.integrationName)})}if(t===l.CloudDocActionsToDropbox.NavigateNewFragment){const t=e,o=t.parameters.token,s=t.parameters.queryParams,r=h.URI.parse(m.get_href());if("string"==typeof o&&r.setFragment(o.replace(/^#/,"")),s){const e={};for(const t in s)null===s[t]?r.removeQuery(t):e[t]=s[t];r.updateQuery(e)}t.parameters.browserHistoryUpdateAction&&t.parameters.browserHistoryUpdateAction!==a.BrowserHistoryUpdateAction.replace?t.parameters.browserHistoryUpdateAction===a.BrowserHistoryUpdateAction.push&&window.history.pushState(null,document.title,r.toString()):window.history.replaceState(null,document.title,r.toString())}else if(t===l.CloudDocActionsToDropbox.TitleChanged){const t=e,o=(0,b.getCloudEditorString)(this.props.editorType,(0,D.file_extension)(this.props.filename)),s=o&&o===v.PaperFileTypes.PAPER?t.parameters.title+" - "+v.CLOUD_EDITOR_TO_PRODUCT_NAME[o]:t.parameters.title;window.history.replaceState(null,t.parameters.title,(0,a.hrefWithNewTitle)(m.get_href(),t.parameters.title)),document.title=s,(0,a.setFavicon)(t.parameters.faviconUrl)}else t===l.CloudDocActionsToDropbox.ReloadHost?m.reload(!0):t===l.CloudDocActionsToDropbox.BroadcastError&&M.Notify.error(e.parameters.errorMessage)}},this.handleMessageEventInjectedInTest=e=>{this.handleMessageEvent(e)},this.setContainerEl=e=>{this.containerEl=e},this.dropLoadingScreenAndDisplayChildFrame=()=>{this.state.dropLoadingScreen||this.logClientEvent(l.LoadingScreenEnd),this.setState({dropLoadingScreen:!0}),"hidden"===this.clientFrame.style.visibility&&this.clientFrame.setAttribute("style","visibility: visible")},this.onLoadingScreenTimeout=()=>{this.logClientEvent(l.LoadingScreenTimeout)},this.maybeRenderLoadingScreen=()=>{if(!this.state.dropLoadingScreen)return s.default.createElement(f.LoadingController,{onTimeout:this.onLoadingScreenTimeout,timeoutMs:25e3,loadingStrings:this.getLoadingStrings(),fqPath:this.props.fqPath,editorType:this.props.editorType})},this.state={docId:this.props.docId,docState:i.DocState.Undefined,iframeLoaded:!1,initialIframeLoaded:!1,tpatData:this.props.tpatData,boltData:this.props.boltData,nsid:this.props.nsid,fileId:this.props.apiFileId,filename:this.props.filename,fqPath:this.props.fqPath,editorType:this.props.editorType,maxAccessUrl:this.props.maxAccessUrl,pendingDocId:null,dropLoadingScreen:!1,providerFrameCalled:!1},this.props.maxAccessUrl&&this.handleNavigationStateChanges(a.BrowserHistoryUpdateAction.replace,(0,a.addParametersAndFragmentsFromBrowserUri)(this.props.maxAccessUrl,m.get_uri())),this.snackbarController=new n.CloudDocSnackbarController(this.props.userData.id,this.state.docId,this.state.fileId,this.props.filename,this.props.openId,(0,g.integrationNameToShareActionOrigin)(this.props.integrationName),this.props.copyRedirect,this.props.userData.email,this.props.userData.isEmailVerified),this.props.previewTimeout&&this.snackbarController.showPreviewSnackbarWithTimeout(this.props.previewTimeout)}maybeRenderCatchpointMarker(){if(this.state.iframeLoaded)return s.default.createElement("div",{id:"cloud-doc-iframe-loaded"})}componentDidMount(){this.logLoadIframeAttempt(),this.props.onMountIframeContainer(this.containerEl,this.registerClient,this.dropLoadingScreenAndDisplayChildFrame,this.startNavigatingToDoc,this.completeNavigatingToDoc),u.log_js_modules_fetched_data_required_for_tti(),u.waitForTTI().then(this.loadPostTTI),window.addEventListener("message",e=>{"static/thirdpartycookie:supported"===e.data?this.logClientEventWithExtras(l.LoadIframeBrowserCapabilities,[{key:"third_party_cookies",value:"on"}]):"static/thirdpartycookie:not_supported"===e.data&&this.logClientEventWithExtras(l.LoadIframeBrowserCapabilities,[{key:"third_party_cookies",value:"off"}])},!1),setTimeout(()=>{this.state.initialIframeLoaded||this.logClientEventWithPerformanceExtras(l.LoadIframeFailed)},3e4)}shouldComponentUpdate(e,t){return this.state.iframeLoaded!==t.iframeLoaded||this.state.providerFrameCalled!==t.providerFrameCalled||this.state.dropLoadingScreen!==t.dropLoadingScreen||this.state.maxAccessUrl!==t.maxAccessUrl||(0,i.shouldDisplayModalFromStates)(this.state,t,this.state.editorType)}componentDidUpdate(e,t){if((0,i.shouldDisplayModalFromStates)(t,this.state,this.state.editorType)){this.cloudDocFrameMessengerHost&&this.cloudDocFrameMessengerHost.postMessageToChildren(l.CloudDocActionsToProvider.MetadataChanged,{docId:this.state.docId}),(0,i.displayModalFromStates)(t,this.state,this.props.userData.id,this.state.editorType,this.state.tpatData.tpat)&&this.clientFrame.remove()}!t.maxAccessUrl&&this.state.maxAccessUrl&&this.handleNavigationStateChanges(a.BrowserHistoryUpdateAction.replace,(0,a.addParametersAndFragmentsFromBrowserUri)(this.state.maxAccessUrl,m.get_uri()))}handleWindowEvent(e,t){if(!(this.props.onWindowEventProvider&&this.props.onWindowEventProvider(e,t)||e!==a.WindowEvent.hashchange&&e!==a.WindowEvent.popstate)){const t=e===a.WindowEvent.hashchange?l.CloudDocActionsToProvider.NavigateNewFragment:l.CloudDocActionsToProvider.NavigateNewHistory,o=h.URI.parse(m.get_href());this.cloudDocFrameMessengerHost.postMessageToChildren(t,{cloudDocId:this.state.docId,docId:this.state.docId,token:o.getFragment(),queryParams:o.getQuery()})}}getLoadingStrings(){return this.state.providerFrameCalled&&this.props.loadingStringsAfterProviderCalled?this.props.loadingStringsAfterProviderCalled:this.props.loadingStrings}logClientEvent(e){this.logClientEventWithExtras(e,[])}logClientEventWithExtras(e,t){const o=null==t?this.props.loggingExtras:(this.props.loggingExtras||[]).concat(t);(0,c.logClientEvent)(this.props.docId,this.props.editorType,e,this.props.tpatData.tpat,o)}logMessageReceivedClientEvent(e){const t=l.actionReceivedToEvent[e];t&&this.logClientEvent(t)}logClientReadyEvent(e){const t=l.actionReceivedToEvent[l.CloudDocActionsToDropbox.ChildReady];null!=t&&this.logClientEventWithExtras(t,[{key:"receiptDelayMs",value:(Date.now()-e).toString()}])}isPaperEditor(){return"paper"===this.props.editorType.toLowerCase()}render(){return s.default.createElement("div",null,s.default.createElement("iframe",{src:"https://cfl.dropboxstatic.com/static/metaserver/static/cloud_docs/thirdpartycookie/detect.html",className:"third-party-cookie-iframe"}),this.maybeRenderLoadingScreen(),s.default.createElement("div",{ref:this.setContainerEl,className:"cloud-doc-iframe-container"}),this.maybeRenderCatchpointMarker())}}t.ProviderIframeContainer=E,E.displayName="ProviderIframeContainer"})),define("metaserver/static/js/cloud_docs/cloud_doc_status_api",["require","exports","tslib","react","metaserver/static/js/core/assert","metaserver/static/js/cloud_docs/cloud_doc_iframe_helpers","metaserver/static/js/cloud_docs/types","metaserver/static/js/clean/ui/snackbar","spectrum/snackbar/index","spectrum/button/index","metaserver/static/js/cloud_docs/shared_components/cloud_docs_error_modal","metaserver/static/js/cloud_docs/shared_components/cloud_docs_file_locking_modal","metaserver/static/js/cloud_docs/event_logging","metaserver/static/js/deprecated_ajax/ajax_jquery","metaserver/static/js/core/browser","metaserver/static/js/core/uri","metaserver/static/js/core/i18n"],(function(e,t,o,s,r,a,i,n,c,d,l,p,u,m,h,g,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getNewCloudDocState=t.shouldDisplayModalFromStates=t.continuePolling=t.handleError=t.handleResult=t.getCloudDocStateLoggedOut=t.getCloudDocState=t.displayModalFromStates=t.hasMaxAccessUrlChanged=t.LockState=t.DocState=t.getDocStateAndActions=void 0,s=o.__importDefault(s),m=o.__importStar(m),h=o.__importStar(h);t.getDocStateAndActions=(t,s,r)=>o.__awaiter(void 0,void 0,void 0,(function*(){return(yield(function(){return o.__awaiter(this,void 0,void 0,(function*(){const{UserApiV2Client:t}=yield new Promise((t,o)=>{e(["metaserver/static/js/api_v2/user_client"],t,o)}).then(o.__importStar);return(new t).ns("cloud_docs")}))})()).rpc("get_doc_state_and_actions",{doc_id:s,auth_token:r},{subjectUserId:t})}));var _,v;(function(e){e[e.Undefined=0]="Undefined",e[e.Active=1]="Active",e[e.Deleted=2]="Deleted",e[e.DocNotFound=3]="DocNotFound",e[e.PermanentError=4]="PermanentError",e[e.PermissionDenied=5]="PermissionDenied",e[e.Purged=6]="Purged",e[e.Other=7]="Other",e[e.OtherError=8]="OtherError",e[e.Unauthenticated=9]="Unauthenticated",e[e.UserNotLoggedInError=10]="UserNotLoggedInError"})(_=t.DocState||(t.DocState={})),(function(e){e[e.Unknown=0]="Unknown",e[e.LockedWithAccess=1]="LockedWithAccess",e[e.LockedWithNoAccess=2]="LockedWithNoAccess",e[e.Unlocked=3]="Unlocked"})(v=t.LockState||(t.LockState={}));const C=e=>e.docState===_.Active||e.docState===_.Deleted&&!0===e.moveInProgress,D=(e,t)=>!(!C(e)||!C(t))&&(!1===e.canEdit&&!0===t.canEdit),S=(e,t)=>!(!C(e)||!C(t))&&(!0===e.canEdit&&!1===t.canEdit),M=(e,t)=>!0!==t.moveInProgress&&(e.docState===_.Deleted&&t.docState===_.Deleted);function b(e,t){return t.docState===_.Active&&e.maxAccessUrl!==t.maxAccessUrl}function E(e,t){return e.docState===_.Undefined&&t.fileLockState===v.LockedWithNoAccess}function y(e){return e.docState===_.Active&&(e.quota>0&&e.usage>=e.quota)}function w(e){return e.docState===_.Active&&(0!==e.quota&&(e.usage>.9*e.quota||268435456>e.quota-e.usage))}t.hasMaxAccessUrlChanged=b;function A(e){switch(e[".tag"]){case"lock_state_unknown":case"other":return v.Unknown;case"locked_with_access":return v.LockedWithAccess;case"locked_with_no_access":return v.LockedWithNoAccess;case"unlocked":return v.Unlocked}return v.Unknown}function I(e,t){const o=t.state_and_actions.state_and_actions_tag;switch(o[".tag"]){case"active":const s=o;return{docId:e,canEdit:s.edit,docState:_.Active,filename:t.filename,maxAccessUrl:t.max_access_url,usage:s.usage,quota:s.quota,fileLockState:A(s.file_lock_state)};case"deleted":const r=o;return{docId:e,canRestore:r.restore,docState:_.Deleted,moveInProgress:r.move_in_progress};case"purged":return{docId:e,docState:_.Purged};case"other":default:return{docId:e,docState:_.Other}}}function k(e,t){switch((function(e){if(void 0!==e&&void 0!==e.error&&void 0!==e.error[".tag"])return e.error[".tag"];return})(t)){case"user_not_logged_in":return{docId:e,docState:_.UserNotLoggedInError};case"invalid_csrf_token":case"no_team_api_access":case"other":return{docId:e,docState:_.Unauthenticated}}switch((function(e){if(void 0!==e&&void 0!==e.error&&void 0!==e.error.error_tag&&void 0!==e.error.error_tag[".tag"])return e.error.error_tag[".tag"];return})(t)){case"generic_error":switch(t.error.error_tag.generic_error[".tag"]){case"permission_denied":return{docId:e,docState:_.PermissionDenied};case"unauthenticated":return{docId:e,docState:_.Unauthenticated};case"doc_not_found":return{docId:e,docState:_.DocNotFound};case"invalid_argument":case"other":return{docId:e,docState:_.PermanentError}}break;case"other":return{docId:e,docState:_.OtherError}}return{docId:e,docState:_.Undefined}}t.displayModalFromStates=(e,t,o,C,A)=>{const I=t.docId;(0,r.assert)(I===e.docId,"Unexpected call to displayModalFromStates with mismatched doc ids.");const k=()=>(n.Snackbar.sync("Restoring file...",!1,"cloud-docs-restore"),(0,u.logClientEvent)(I,C,i.RestoreAttempt,A),m.WebRequest({url:new g.URI({path:`/cloud_docs/restore/${I}`}).toString(),success:()=>((0,u.logClientEvent)(I,C,i.RestoreSuccess,A),n.Snackbar.complete("Successfully restored!","cloud-docs-restore"),h.reload()),error(e,t,o){(0,u.logClientEvent)(I,C,i.RestoreFailed,A),n.Snackbar.fail(`Unable to restore: ${o}`,"cloud-docs-restore")},skipNotifyError:!0})),T=()=>((0,u.logClientEvent)(I,C,i.BackHome,A),h.redirect("https://www.dropbox.com")),P=()=>h.reload(),x=()=>window.open("https://www.dropbox.com/help/space/over-storage-limit#full","_blank");if(b(e,t)){(0,u.logClientEvent)(I,C,i.MaxAccessUrlChanged,A);const e=(0,a.isGoogleDoc)(C)?a.addParametersAndFragmentsFromBrowserUriForGdd:a.addParametersAndFragmentsFromBrowserUri;window.history.replaceState(null,t.filename,e(t.maxAccessUrl,h.get_uri())),(0,a.isPaperDoc)(C)||(document.title=t.filename)}if(E(e,t)&&((0,u.logClientEvent)(I,C,i.FileLocked,A),p.CloudDocsFileLockingModal.showFileLockingModal(!0)),!y(e)&&y(t)&&!(0,a.isProviderCanonical)(C)){(0,u.logClientEvent)(I,C,i.OverQuota,A);const e=f.intl.formatMessage({id:"CyRaJu",defaultMessage:"Your Dropbox account is full."});return n.Snackbar.show(s.default.createElement(n.Snackbar,{variant:"fail",title:e,closeButtonText:f.intl.formatMessage({id:"u/p3Pl",defaultMessage:"Close"}),timeoutDelayMs:6e4},s.default.createElement(c.SnackbarAction,{onClick:x},"See your options"))),!1}if(!w(e)&&w(t)&&!(0,a.isProviderCanonical)(C)){(0,u.logClientEvent)(I,C,i.NearQuota,A);const e=f.intl.formatMessage({id:"ppfHwd",defaultMessage:"You only have {storage} MB of space left in Dropbox."},{st:e=>s.default.createElement("strong",null,e),storage:Number((t.quota-t.usage)/1024/1024).toFixed(2)});return n.Snackbar.show(s.default.createElement(n.Snackbar,{variant:"warn",title:e,closeButtonText:f.intl.formatMessage({id:"u/p3Pl",defaultMessage:"Close"}),timeoutDelayMs:6e4},s.default.createElement(c.SnackbarAction,{onClick:x},"See your options"))),!1}if(D(e,t)){(0,u.logClientEvent)(I,C,i.PermissionUpgraded,A);const e=f.intl.formatMessage({id:"4gKZhu",defaultMessage:"You just got edit access!"});return n.Snackbar.show(s.default.createElement(n.Snackbar,{title:e,timeoutDelayMs:6e4},s.default.createElement(c.SnackbarAction,{onClick:P},"Reload"))),!1}return S(e,t)?(function(e){return e.fileLockState===v.LockedWithNoAccess})(t)?((0,u.logClientEvent)(I,C,i.FileLocked,A),p.CloudDocsFileLockingModal.showFileLockingModal(!1),!1):((0,u.logClientEvent)(I,C,i.PermissionDowngraded,A),l.CloudDocsErrorModal.showInstance({title:f.intl.formatMessage({id:"g971tv",defaultMessage:"Looks like someone changed your access"}),body:f.intl.formatMessage({id:"aMTr6g",defaultMessage:"Now you can only view <st>{filename}</st>. If you still need to make edits, try contacting someone with edit access."},{st:e=>s.default.createElement("strong",null,e),filename:t.filename}),primaryAction:()=>s.default.createElement(d.Button,{onClick:P},f.intl.formatMessage({id:"nOO9Qi",defaultMessage:"OK"}))}),!1):t.docState===_.Unauthenticated?((0,u.logClientEvent)(I,C,i.Unauthenticated,A),l.CloudDocsErrorModal.showInstance({title:f.intl.formatMessage({id:"XDW1tJ",defaultMessage:"Your session timed out"}),body:f.intl.formatMessage({id:"0vZjXC",defaultMessage:"Please reload the page to keep working."}),primaryAction:()=>s.default.createElement(d.Button,{onClick:P},f.intl.formatMessage({id:"zOcVU3",defaultMessage:"Reload"}))}),!0):t.docState===_.PermissionDenied?((0,u.logClientEvent)(I,C,i.PermissionDenied,A),l.CloudDocsErrorModal.showInstance({title:f.intl.formatMessage({id:"Uk7/ur",defaultMessage:"Looks like someone removed you from this file"}),body:f.intl.formatMessage({id:"sVSjKv",defaultMessage:"If you think this was an error, request access to <st>{filename}</st>."},{st:e=>s.default.createElement("strong",null,e),filename:void 0!==e.filename?e.filename:"the doc"}),primaryAction:()=>s.default.createElement(d.Button,{onClick:P},f.intl.formatMessage({id:"hZymwk",defaultMessage:"Request access"})),secondaryAction:()=>s.default.createElement(d.Button,{variant:"secondary",onClick:T},f.intl.formatMessage({id:"XFPaPp",defaultMessage:"Back home"}))}),!0):M(e,t)?!0===t.canRestore?((0,u.logClientEvent)(I,C,i.DeletedCanRestore,A),l.CloudDocsErrorModal.showInstance({title:f.intl.formatMessage({id:"Kd8+qd",defaultMessage:"Looks like someone deleted this file"}),body:f.intl.formatMessage({id:"A0KR8q",defaultMessage:"Someone deleted <st>{filename}</st>. Restore it to keep working on your latest version."},{st:e=>s.default.createElement("strong",null,e),filename:void 0!==e.filename?e.filename:"the doc"}),primaryAction:()=>s.default.createElement(d.Button,{onClick:k},f.intl.formatMessage({id:"PL5ta5",defaultMessage:"Restore"})),secondaryAction:()=>s.default.createElement(d.Button,{variant:"secondary",onClick:T},f.intl.formatMessage({id:"XFPaPp",defaultMessage:"Back home"}))}),!0):((0,u.logClientEvent)(I,C,i.DeletedCantRestore,A),l.CloudDocsErrorModal.showInstance({title:f.intl.formatMessage({id:"Kd8+qd",defaultMessage:"Looks like someone deleted this file"}),body:f.intl.formatMessage({id:"Y6FDpY",defaultMessage:"If you think this was an error, try contacting the creator of <st>{filename}</st>."},{st:e=>s.default.createElement("strong",null,e),filename:void 0!==e.filename?e.filename:"the doc"}),primaryAction:()=>s.default.createElement(d.Button,{variant:"secondary",onClick:T},f.intl.formatMessage({id:"XFPaPp",defaultMessage:"Back home"}))}),!0):t.docState===_.Purged||t.docState===_.DocNotFound?((0,u.logClientEvent)(I,C,i.PermanentlyDeleted,A),l.CloudDocsErrorModal.showInstance({title:f.intl.formatMessage({id:"ymINbT",defaultMessage:"Looks like someone permanently deleted this file"}),body:f.intl.formatMessage({id:"bmMN8X",defaultMessage:"<st>{filename}</st> can’t be restored."},{st:e=>s.default.createElement("strong",null,e),filename:void 0!==e.filename?e.filename:"The doc"}),primaryAction:()=>s.default.createElement(d.Button,{variant:"secondary",onClick:T},f.intl.formatMessage({id:"XFPaPp",defaultMessage:"Back home"}))}),!0):t.docState===_.UserNotLoggedInError&&((0,u.logClientEvent)(I,C,i.UserNotLoggedIn,A),l.CloudDocsErrorModal.showInstance({title:f.intl.formatMessage({id:"FNJvCl",defaultMessage:"You’re not signed in"}),body:f.intl.formatMessage({id:"EH4Xhy",defaultMessage:"Sign in to dropbox.com to keep working."}),primaryAction:()=>s.default.createElement(d.Button,{variant:"secondary",onClick:T},f.intl.formatMessage({id:"raLp6W",defaultMessage:"Sign in"}))}),!0)},t.getCloudDocState=function(e,s,r){return o.__awaiter(this,void 0,void 0,(function*(){return(0,t.getDocStateAndActions)(e,s,r).then(e=>I(s,e)).catch(e=>k(s,e))}))},t.getCloudDocStateLoggedOut=function(t,s){return o.__awaiter(this,void 0,void 0,(function*(){return((t,s)=>o.__awaiter(void 0,void 0,void 0,(function*(){const{NoAuthApiV2Client:r}=yield new Promise((t,o)=>{e(["metaserver/static/js/api_v2/noauth_client"],t,o)}).then(o.__importStar);return(new r).ns("cloud_docs").rpc("get_doc_state_and_actions_logged_out",{doc_id:t,auth_token:s},{})})))(t,s).then(e=>I(t,e)).catch(e=>k(t,e))}))},t.handleResult=I,t.handleError=k,t.continuePolling=function(e,t){return e.docId!==t.docId||(S(e,t)?!(y(e)||!y(t)):!M(e,t)&&!(function(e){switch(e.docState){case _.DocNotFound:case _.Other:case _.PermanentError:case _.PermissionDenied:case _.Purged:case _.Unauthenticated:case _.Undefined:case _.UserNotLoggedInError:return!0;default:return!1}})(t))},t.shouldDisplayModalFromStates=function(e,t,o){return e.docId===t.docId&&(b(e,t)||!w(e)&&w(t)&&!(0,a.isProviderCanonical)(o)||!y(e)&&y(t)&&!(0,a.isProviderCanonical)(o)||D(e,t)||S(e,t)||M(e,t)||E(e,t)||(function(e){switch(e.docState){case _.DocNotFound:case _.PermissionDenied:case _.Purged:case _.Unauthenticated:case _.UserNotLoggedInError:return!0;default:return!1}})(t))},t.getNewCloudDocState=function(e,t){return{docId:t.docId,docState:t.docState,canEdit:void 0!==t.canEdit?t.canEdit:e.canEdit,canRestore:void 0!==t.canRestore?t.canRestore:e.canRestore,filename:void 0!==t.filename?t.filename:e.filename,maxAccessUrl:void 0!==t.maxAccessUrl?t.maxAccessUrl:e.maxAccessUrl,quota:void 0!==t.quota?t.quota:e.quota,usage:void 0!==t.usage?t.usage:e.usage,moveInProgress:t.moveInProgress,fileLockState:t.fileLockState}}})),define("metaserver/static/js/cloud_docs/cloud_doc_file_locking_api",["require","exports","tslib"],(function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.decodeFileLockResponse=t.getFileLockState=void 0;t.getFileLockState=(t,s)=>o.__awaiter(void 0,void 0,void 0,(function*(){return(yield(function(){return o.__awaiter(this,void 0,void 0,(function*(){const{UserApiV2Client:t}=yield new Promise((t,o)=>{e(["metaserver/static/js/api_v2/user_client"],t,o)}).then(o.__importStar);return(new t).ns("files")}))})()).rpc("get_file_lock_batch",{entries:[{path:s}]},{subjectUserId:t})}));t.decodeFileLockResponse=e=>{const t={isLocked:!1,lockholderName:""},o=e.entries[0];if("success"===o[".tag"])try{const e=o.metadata.file_lock_info;t.isLocked=!1===e.is_lockholder,t.lockholderName=e.lockholder_name}catch(e){return t}return t}})),define("metaserver/static/js/cloud_docs/cloud_doc_frame_messenger",["require","exports","tslib","lodash","typescript/libraries/file-viewer/src/libraries/frame_messenger/index","metaserver/static/js/cloud_docs/types","metaserver/static/js/core/uri"],(function(e,t,o,s,r,a,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MockCloudDocFrameMessengerHost=t.DefaultCloudDocFrameMessengerHost=void 0,s=o.__importStar(s);t.DefaultCloudDocFrameMessengerHost=class{constructor(e,t,o,n,c,d,l){const p=i.URI.parse(o),u=`${p.getScheme()}://${p.getAuthority()}`,m=s.values(a.CloudDocActionsToDropbox),h=new r.FrameMessengerHost([u].concat(c||[]),d,l);h.configureChildMessaging(()=>[e],t,m.concat(s.values(n))),h.startListening(),this._frameMessengerHost=h}get frameMessengerHost(){return this._frameMessengerHost}postMessageToChildren(e,t={}){this._frameMessengerHost.postMessageToChildren(e,t)}isOriginAllowed(e){return this._frameMessengerHost.isOriginAllowed(e)}};t.MockCloudDocFrameMessengerHost=class{postMessageToChildren(e,t){}}})),define("metaserver/static/js/cloud_docs/cloud_doc_iframe_helpers",["require","exports","metaserver/static/js/core/uri","metaserver/static/js/cloud_docs/constants","metaserver/static/js/core/persistence/storage","metaserver/static/js/cloud_docs/utils"],(function(e,t,o,s,r,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createDefaultForm=t.GetFormPropertyConsts=t.WindowEvent=t.setFavicon=t.isProviderCanonical=t.isPaperDoc=t.isGoogleDoc=t.BrowserHistoryUpdateAction=t.getExtraNavigationEnvironmentParametersForPaper=t.addParametersAndFragmentsFromBrowserUriForGdd=t.addParametersAndFragmentsFromBrowserUri=t.extractSCLToken=t.hrefWithNewTitle=void 0;const i=["disco","cloud_editor","rlkey","skip_browser_check"];function n(e,t,r={}){const a=o.URI.parse(e),i=a.getQuery(),n=t.getFragment(),c=t.getQuery();return Object.keys(c).filter(e=>s.QueryParamBlackList.hasOwnProperty(e)||i.hasOwnProperty(e)).forEach(e=>delete c[e]),a.updateQuery(c),a.updateQuery(r),a.setFragment(n),o.URI.decode(a.toString())}function c(){return{formName:"cloud-doc-form",frameName:"cloud-doc-iframe"}}t.hrefWithNewTitle=(e,t)=>{const s=o.URI.parse(e);return s.setPath(s.getPath().replace(/(.*\/)([^\/]+)(\.\w+$)/,"$1"+(0,a.replaceInvalidURLFilenameChars)(t)+"$3")),s.toString()},t.extractSCLToken=function(e){const t=e.match(/\/scl\/fi\/([^\/]+)/);return t?t[1]:null},t.addParametersAndFragmentsFromBrowserUri=n,t.addParametersAndFragmentsFromBrowserUriForGdd=function(e,t){const o=t.getQuery(),s=t.clone();return Object.keys(o).filter(e=>!i.includes(e)).forEach(e=>s.removeQuery(e)),n(e,s)},t.getExtraNavigationEnvironmentParametersForPaper=function(){const e={};if(window.performance&&window.performance.timing){const t={};["fetchStart","requestStart","navigationStart"].forEach(e=>{e in window.performance.timing&&(t[e]=window.performance.timing[e])}),e.parent_frame_performance=JSON.stringify(t)}return e.parent_frame_referrer=document.referrer||"",e},(function(e){e.none="none",e.push="push",e.replace="replace"})(t.BrowserHistoryUpdateAction||(t.BrowserHistoryUpdateAction={})),t.isGoogleDoc=function(e){return["gdoc","gsheet","gslides"].indexOf(e)>=0},t.isPaperDoc=function(e){return"paper"===e||"paper_template"===e},t.isProviderCanonical=function(e){return"paper"===e||"paper_template"===e||"paper_binder"===e||"dropbox_form"===e},t.setFavicon=function(e){const t=document.querySelector("link[rel='shortcut icon']");if(t){const o=t,s=o.href;let a=r.SessionStorage.get("originalFavicon");a||(a=s,r.SessionStorage.set("originalFavicon",s)),o.href=e||a}},(function(e){e.hashchange="hashchange",e.popstate="popstate"})(t.WindowEvent||(t.WindowEvent={})),t.GetFormPropertyConsts=c,t.createDefaultForm=function(e,t,o,s){const r={formName:"cloud-doc-form",frameName:"cloud-doc-iframe"},a=document.createElement("form");a.name=r.formName,a.target=r.frameName,a.action=e,a.method="post";const i=document.createElement("input");i.type="hidden",i.name="auth_token",i.value=t.tpat,a.appendChild(i);const n=document.createElement("input");if(n.type="hidden",n.name="auth_token_ttl",n.value=t.tpatExpirationTime.toString(),a.appendChild(n),o.id){const e=document.createElement("input");e.type="hidden",e.name="user_id",e.value=o.id.toString(),a.appendChild(e)}const c=document.createElement("input");c.type="hidden",c.name="user_email",c.value=o.email,a.appendChild(c);const d=document.createElement("input");return d.type="hidden",d.name="doc_id",d.value=s,a.appendChild(d),a}})),define("metaserver/static/js/cloud_docs/errors",["require","exports","tslib","react","metaserver/static/js/core/exception"],(function(e,t,o,s,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ErrorBoundary=t.reportCloudDocsException=t.GENERIC_EXCLOG_TAG_NAME=t.WOPI_EXCLOG_TAG_NAME=t.PAPER_EXCLOG_TAG_NAME=t.GDD_DIRECT_EXCLOG_TAG_NAME=t.GDD_INTERMEDIATE_EXCLOG_TAG_NAME=t.GDD_HOST_PAGE_EXCLOG_TAG_NAME=void 0,s=o.__importDefault(s);const a="cloud_docs_host_page";function i(e,t){(0,r.reportException)({err:e,tags:[a].concat(t)})}t.GDD_HOST_PAGE_EXCLOG_TAG_NAME="google_gdd_host_page",t.GDD_INTERMEDIATE_EXCLOG_TAG_NAME="google_intermediate_iframe_wrapper",t.GDD_DIRECT_EXCLOG_TAG_NAME="google_direct_iframe_wrapper",t.PAPER_EXCLOG_TAG_NAME="paper_iframe_wrapper",t.WOPI_EXCLOG_TAG_NAME="wopi_iframe_wrapper",t.GENERIC_EXCLOG_TAG_NAME="generic_iframe_wrapper",t.reportCloudDocsException=i;class n extends s.default.Component{constructor(e){super(e)}componentDidCatch(e,t){i(e,this.props.tags)}render(){return this.props.children}}t.ErrorBoundary=n,n.displayName="ErrorBoundary"})),define("metaserver/static/js/cloud_docs/google_dss/gdd_direct_iframe_wrapper",["require","exports","tslib","react","metaserver/static/js/cloud_docs/cloud_doc_iframe","metaserver/static/js/cloud_docs/types","metaserver/static/js/cloud_docs/event_logging","metaserver/static/js/core/browser","metaserver/static/js/cloud_docs/preferred_editor_modal","metaserver/static/js/cloud_docs/preferred_editor_constants","metaserver/static/js/filepath/filepath","metaserver/static/js/cloud_docs/cloud_doc_iframe_helpers","metaserver/static/js/cloud_docs/errors","metaserver/static/js/cloud_docs/errors","metaserver/static/js/cloud_docs/google_dss/gdd_message_handler","metaserver/static/js/cloud_docs/google_dss/gdd_frame_messenger","metaserver/static/js/cloud_docs/google_dss/gdd_signin_snackbar","metaserver/static/js/cloud_docs/google_dss/gdd_intermediate_mock_iframe"],(function(e,t,o,s,r,a,i,n,c,d,l,p,u,m,h,g,f,_){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.GDDDirectIframeWrapper=t.GDD_DIRECT_IFRAME_WRAPPER_CLASSNAME=void 0,s=o.__importDefault(s),n=o.__importStar(n);t.GDD_DIRECT_IFRAME_WRAPPER_CLASSNAME="gdd-direct-iframe-wrapper";class v extends s.default.Component{constructor(t){super(t),this.constructProviderSpecificFrameMessengerHost=e=>{const t=new g.GddFrameMessengerHost(this.gapiIFrameObject,this.props.docId,[m.GDD_DIRECT_EXCLOG_TAG_NAME],u.reportCloudDocsException);return t.registerMessageCallbacks(e),t},this.handleProviderSpecificMessage=(e,t)=>(0,h.handleGDDSpecificMessage)(e,t,this.handleShowPreferredEditorPrompt,this.cloudDocFrameMessengerHost,this.props),this.handleMountIframeContainer=(t,s,r)=>o.__awaiter(this,void 0,void 0,(function*(){try{let a;this.containerEl=t,a=(yield new Promise((t,o)=>{e(["gapi"],t,o)}).then(o.__importStar)).default,this.loadEditorViaGAPI(a,this.containerEl,s,r)}catch(e){throw(0,u.reportCloudDocsException)(e,[m.GDD_DIRECT_EXCLOG_TAG_NAME]),e}})),this.loadEditorViaGAPI=(e,t,o,s)=>{this.logCallAttempt(),e.load("fsip",()=>{try{const r={},a={actionUrl:(0,p.addParametersAndFragmentsFromBrowserUriForGdd)(this.props.gddArgs.actionUrl,n.get_uri()),tpat:this.props.tpatData.tpat,tpatExpirationTime:this.props.tpatData.tpatExpirationTime,authEmail:this.props.userData.email,organizationType:this.props.userData.organizationType,previewUrl:this.props.previewUrl};this.gapiIFrameObject=e.fsip.createIframe(t,a,r),this.editorIframeElement=document.getElementById("docs_editor_frame"),this.editorIframeElement||(this.editorIframeElement=document.createElement("iframe"),this.editorIframeElement.setAttribute("class","cloud-doc-iframe"),this.editorIframeElement.name="cloud-doc-iframe",this.editorIframeElement.id="cloud-doc-iframe",this.editorIframeElement.title="Cloud Doc iframe",this.editorIframeElement.src=this.props.actionUrl,t.appendChild(this.editorIframeElement)),this.cloudDocFrameMessengerHost=o(this.editorIframeElement),this.editorIframeElement.focus(),this.clientFrameAlreadyLoaded(this.editorIframeElement)?this.onIframeLoaded(s):this.editorIframeElement.onload=()=>{this.onIframeLoaded(s)}}catch(e){throw(0,u.reportCloudDocsException)(e,[m.GDD_DIRECT_EXCLOG_TAG_NAME]),e}})},this.clientFrameAlreadyLoaded=e=>null!==e.contentDocument&&"complete"===e.contentDocument.readyState,this.onIframeLoaded=e=>{e(),this.props.userData.id&&f.GddSignInSnackbar.asyncMayShowInstance(this.props.userData.id,this.props.userData.organizationType)},this.logCallAttempt=()=>{this.frameCalledTs=Date.now(),this.logRegisterClientCalled()},this.logRegisterClientCalled=()=>{!this.frameCalledLogged&&this.frameCalledTs&&((0,i.logClientEvent)(this.props.docId,this.props.editorType,a.GddRegisterClientCalled,this.props.tpatData.tpat,[{key:"frame_called_ts",value:this.frameCalledTs.toString()},{key:"entry_point",value:this.props.entryPoint?String(this.props.entryPoint):"UNKNOWN"}]),this.frameCalledLogged=!0)},this.handleShowPreferredEditorPrompt=e=>{this.setState({preferred_editor_modal:{title:e.title,body:e.body,isOpen:!0}})},this.closePreferredEditorPrompt=()=>{this.setState({preferred_editor_modal:{title:"",body:"",isOpen:!1}})},this.state={preferred_editor_modal:{title:"",body:"",isOpen:!1}}}render(){return s.default.createElement("div",{className:t.GDD_DIRECT_IFRAME_WRAPPER_CLASSNAME},s.default.createElement(r.ProviderIframeContainer,Object.assign({},this.props,{onProviderSpecificMessage:this.handleProviderSpecificMessage,onMountIframeContainer:this.handleMountIframeContainer,constructProviderSpecificFrameMessengerHost:this.constructProviderSpecificFrameMessengerHost,providerSpecificActions:[a.GDDSpecificActionsToDropbox.LogEvent,a.GDDSpecificActionsToDropbox.Ready,a.GDDSpecificActionsToDropbox.FrameLoaded],previewTimeout:2e4,showClientFrameWhileLoading:!0,exceptionLoggingTags:[m.GDD_DIRECT_EXCLOG_TAG_NAME]})),this.props.userData.id&&s.default.createElement(c.PreferredEditorModal,{title:this.state.preferred_editor_modal.title,body:this.state.preferred_editor_modal.body,userId:this.props.userData.id,integrationName:this.props.integrationName,editorType:d.EXTENSION_TO_DOC_TYPE["."+(0,l.file_extension)(this.props.filename)],isOpen:this.state.preferred_editor_modal.isOpen,handleRequestClose:this.closePreferredEditorPrompt}))}}t.GDDDirectIframeWrapper=v,v.displayName="GDDDirectIframeWrapper"})),define("metaserver/static/js/cloud_docs/google_dss/gdd_frame_messenger",["require","exports","metaserver/static/js/cloud_docs/google_dss/google_dss_types","metaserver/static/js/cloud_docs/types"],(function(e,t,o,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.GddFrameMessengerHost=void 0;t.GddFrameMessengerHost=class{constructor(e,t,o=[],s){this.clientFrame=e,this.docId=t,this.exceptionLoggingTags=o,this.exceptionLoggerCallback=s}postMessageToChildren(e,t={}){if(e===s.CloudDocActionsToProvider.HostReady&&this.clientFrame)this.clientFrame.sendMessage(o.GoogleMessageToEditor.HostReady,{}),this.registerMessageCallbacksPostTTI();else if(e===s.CloudDocActionsToProvider.MetadataChanged)this.clientFrame.sendMessage(o.GoogleMessageToEditor.MetadataChanged,{});else if(e===s.CloudDocActionsToProvider.AddAccessUIResponse)this.clientFrame.sendMessage(o.GoogleMessageToEditor.AclFixerClosed,{});else if(e===s.CloudDocActionsToProvider.NavigateNewFragment){const s={action:e,parameters:t};this.clientFrame.sendMessage(o.GoogleMessageToEditor.HostFragmentsChanged,{token:s.parameters.token})}}registerMessageCallbacks(e){this.dropboxMessageCallback=e,this.clientFrame.registerCallback(o.GoogleMessageToHost.ClientReady,()=>{this.translateMessageAndSendToDropbox(o.GoogleMessageToHost.ClientReady)})}registerMessageCallbacksPostTTI(){this.clientFrame.registerCallback(o.GoogleMessageToHost.AclFixerOpened,()=>{this.translateMessageAndSendToDropbox(o.GoogleMessageToHost.AclFixerOpened)}),this.clientFrame.registerCallback(o.GoogleMessageToHost.ClientFragmentsChanged,e=>{this.translateMessageAndSendToDropbox(o.GoogleMessageToHost.ClientFragmentsChanged,e)}),this.clientFrame.registerCallback(o.GoogleMessageToHost.ReloadHost,()=>{this.translateMessageAndSendToDropbox(o.GoogleMessageToHost.ReloadHost)}),this.clientFrame.registerCallback(o.GoogleMessageToHost.SharingOpened,()=>{this.translateMessageAndSendToDropbox(o.GoogleMessageToHost.SharingOpened)}),this.clientFrame.registerCallback(o.GoogleMessageToHost.TitleChanged,e=>{this.translateMessageAndSendToDropbox(o.GoogleMessageToHost.TitleChanged,e)})}translateMessageAndSendToDropbox(e,t){try{const o=this.translateGoogleMessage(e,t);null!=o&&this.dropboxMessageCallback(o)}catch(e){throw this.exceptionLoggerCallback&&this.exceptionLoggerCallback(e,this.exceptionLoggingTags),e}}translateGoogleMessage(e,t){switch(e){case o.GoogleMessageToHost.AclFixerOpened:return{action:s.CloudDocActionsToDropbox.OpenAddAccessUI,parameters:{docId:this.docId,emailAddresses:[]}};case o.GoogleMessageToHost.ClientFragmentsChanged:return t?{action:s.CloudDocActionsToDropbox.NavigateNewFragment,parameters:{docId:this.docId,token:t.token}}:null;case o.GoogleMessageToHost.ClientReady:return{action:s.CloudDocActionsToDropbox.ChildReady,parameters:{}};case o.GoogleMessageToHost.ReloadHost:return{action:s.CloudDocActionsToDropbox.ReloadHost,parameters:{docId:this.docId}};case o.GoogleMessageToHost.SharingOpened:return{action:s.CloudDocActionsToDropbox.OpenSharingUI,parameters:{docId:this.docId}};case o.GoogleMessageToHost.TitleChanged:return t?{action:s.CloudDocActionsToDropbox.TitleChanged,parameters:{docId:this.docId,title:t.title}}:null}return null}}})),define("metaserver/static/js/cloud_docs/google_dss/gdd_iframe_wrapper",["require","exports","tslib","react","metaserver/static/js/cloud_docs/cloud_doc_iframe","metaserver/static/js/cloud_docs/types","metaserver/static/js/cloud_docs/preferred_editor_modal","metaserver/static/js/cloud_docs/preferred_editor_constants","metaserver/static/js/filepath/filepath","metaserver/static/js/cloud_docs/cloud_doc_frame_messenger","metaserver/static/js/cloud_docs/errors","metaserver/static/js/cloud_docs/google_dss/gdd_message_handler"],(function(e,t,o,s,r,a,i,n,c,d,l,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.GDDIframeWrapper=void 0,s=o.__importDefault(s);class u extends s.default.Component{constructor(e){super(e),this.handleProviderSpecificMessage=(e,t)=>(0,p.handleGDDSpecificMessage)(e,t,this.handleShowPreferredEditorPrompt,this.cloudDocFrameMessengerHost,this.props),this.handleMountIframeContainer=(e,t)=>{let o=document.getElementById("cloud-doc-iframe");o||(o=document.createElement("iframe"),o.setAttribute("class","cloud-doc-iframe"),o.name="cloud-doc-iframe",o.id="cloud-doc-iframe",o.title="Cloud Doc iframe",o.src=this.props.actionUrl,e.appendChild(o)),this.cloudDocFrameMessengerHost=t(o)},this.constructProviderSpecificFrameMessengerHost=(e,t,o,s,r)=>new d.DefaultCloudDocFrameMessengerHost(t,e,o,s,r),this.handleShowPreferredEditorPrompt=e=>{this.setState({preferred_editor_modal:{title:e.title,body:e.body,isOpen:!0}})},this.closePreferredEditorPrompt=()=>{this.setState({preferred_editor_modal:{title:"",body:"",isOpen:!1}})},this.state={preferred_editor_modal:{title:"",body:"",isOpen:!1}}}render(){return s.default.createElement("div",null,s.default.createElement(r.ProviderIframeContainer,Object.assign({},this.props,{onProviderSpecificMessage:this.handleProviderSpecificMessage,onMountIframeContainer:this.handleMountIframeContainer,constructProviderSpecificFrameMessengerHost:this.constructProviderSpecificFrameMessengerHost,providerSpecificActions:[a.GDDSpecificActionsToDropbox.LogEvent,a.GDDSpecificActionsToDropbox.Ready,a.GDDSpecificActionsToDropbox.FrameLoaded],previewTimeout:2e4,exceptionLoggingTags:[l.GDD_INTERMEDIATE_EXCLOG_TAG_NAME]})),this.props.userData.id&&s.default.createElement(i.PreferredEditorModal,{title:this.state.preferred_editor_modal.title,body:this.state.preferred_editor_modal.body,userId:this.props.userData.id,integrationName:this.props.integrationName,editorType:n.EXTENSION_TO_DOC_TYPE["."+(0,c.file_extension)(this.props.filename)],isOpen:this.state.preferred_editor_modal.isOpen,handleRequestClose:this.closePreferredEditorPrompt}))}}t.GDDIframeWrapper=u,u.displayName="GDDIframeWrapper"})),define("metaserver/static/js/cloud_docs/google_dss/gdd_intermediate_mock_iframe",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MockGapi=t.MockGddIframeObject=void 0;const o=new RegExp("https://docs.google.com/(document|spreadsheets|presentation)/fsip/edit.*fileUrl=.*");class s{constructor(e,t){this.messageTypeToHandler={},this.handleMessage=e=>{let t,o;try{o=JSON.parse(e.data),t=o.messageType}catch(t){throw new SyntaxError(`JSON.parse() failed for ${JSON.stringify(e.data)}`)}t in this.messageTypeToHandler&&this.messageTypeToHandler[t](o)},this.mockIframe=e,this.mockIframeUrl=t,window.addEventListener("message",this.handleMessage,!1)}cleanup(){window.removeEventListener("message",this.handleMessage)}registerCallback(e,t){this.messageTypeToHandler[e]=t}sendMessage(e,t){const o={title:"",token:"",messageType:e,sentTime:Date.now(),extra:t};this.mockIframe.contentWindow&&this.mockIframe.contentWindow.postMessage(JSON.stringify(o),this.mockIframeUrl)}}t.MockGddIframeObject=s;t.MockGapi=class{constructor(e){this.loadedModules=[],this.fsip={},this.mockIframeUrl=e,this.fsip.createIframe=this.createIframe.bind(this)}load(e,t){this.loadedModules.push(e),t()}createIframe(e,t,r){if(!o.test(t.actionUrl))throw new Error(`ActionUrl ${t.actionUrl} is incorrect in mock iframe`);const a=document.createElement("iframe");return a.setAttribute("class","gdd-doc-iframe"),a.setAttribute("id","docs_editor_frame"),a.src=this.mockIframeUrl,e.appendChild(a),new s(a,this.mockIframeUrl)}}})),define("metaserver/static/js/cloud_docs/google_dss/gdd_message_handler",["require","exports","tslib","metaserver/static/js/cloud_docs/types","metaserver/static/js/cloud_docs/event_logging","metaserver/static/js/cloud_docs/google_dss/gdd_signin_snackbar","metaserver/static/js/cloud_docs/cloud_doc_iframe_helpers","metaserver/static/js/core/browser","metaserver/static/js/clean/web_timing_logger","metaserver/static/js/cloud_docs/preferred_editor_utils"],(function(e,t,o,s,r,a,i,n,c,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.handleGDDSpecificMessage=void 0,n=o.__importStar(n),c=o.__importStar(c);t.handleGDDSpecificMessage=(e,t,o,l,p)=>{if(e.action===s.GDDSpecificActionsToDropbox.Ready)return l.postMessageToChildren(s.CloudDocActionsToIntermediateFrame.Init,{action_url:(0,i.addParametersAndFragmentsFromBrowserUriForGdd)(p.gddArgs.actionUrl,n.get_uri()),auth_token:p.tpatData.tpat,auth_token_ttl:p.tpatData.tpatExpirationTime,user_email:p.userData.email,doc_id:p.docId,mock_iframe_url:p.gddArgs.mockIframeUrl,organization_type:p.userData.organizationType,preview_url:p.previewUrl}),!0;if(e.action===s.CloudDocActionsToDropbox.ProviderFrameCalled){const t=e;return(0,r.logClientEvent)(p.docId,p.editorType,s.GddRegisterClientCalled,p.tpatData.tpat,[{key:"frame_called_ts",value:t.parameters.frameCalledTs.toString()},{key:"entry_point",value:p.entryPoint?String(p.entryPoint):"UNKNOWN"}]),!1}if(e.action===s.GDDSpecificActionsToDropbox.FrameLoaded)return t(),p.userData.id&&a.GddSignInSnackbar.asyncMayShowInstance(p.userData.id,p.userData.organizationType),!1;if(e.action===s.CloudDocActionsToDropbox.ChildReady){c.mark_time_to_interactive();const e=n.get_uri().getFragment();if(e&&l.postMessageToChildren(s.CloudDocActionsToProvider.NavigateNewFragment,{cloudDocId:p.docId,docId:p.docId,token:e}),p.showPreferredEditorPrompt){const e=(0,d.getPreferredEditorPrompt)(p.filename,p.integrationName);e&&o(e)}return!1}if(e.action===s.GDDSpecificActionsToDropbox.LogEvent){const t=e;return(0,r.logClientEvent)(p.docId,p.editorType,t.parameters.eventName,p.tpatData.tpat),!0}return!1}})),define("metaserver/static/js/cloud_docs/google_dss/gdd_signin_snackbar",["require","exports","tslib","react","metaserver/static/js/core/i18n","metaserver/static/js/core/uri","metaserver/static/js/clean/ui/snackbar","metaserver/static/js/core/browser","metaserver/static/js/cloud_docs/cloud_doc_api_client","metaserver/static/js/core/exception","metaserver/static/js/components/ui/css"],(function(e,t,o,s,r,a,i,n,c,d,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.GddSignInSnackbar=void 0,s=o.__importDefault(s),n=o.__importStar(n);const p="https://help.dropbox.com/desktop-web/create-google-docs#signin",u=["owner:cloud-docs"];t.GddSignInSnackbar={handleLearnMore(){n.open_tab(p)},handleShowPreview(e){const t=a.URI.parse(n.get_href()).updateQuery("cloud_editor","preview").toString();n.redirect(t)},setGoogleEditorLoaded(e){(0,c.setSignInSnackbarAsync)(e).catch(e=>{(0,d.reportException)({err:e,severity:"non-critical",tags:u})}),i.Snackbar.close()},asyncMayShowInstance(e,o){let a=r.intl.formatMessage({id:"vHIwL3",defaultMessage:"To open this file, make sure you’re signed in to G Suite and Dropbox with the same email address."});"CONSUMER"===o&&(a=r.intl.formatMessage({id:"Vy0v7n",defaultMessage:"To open this file, make sure you’re signed in to Google and Dropbox with the same email address."})),(0,c.getSignInSnackbarAsync)(e).then(o=>{if(!o.has_loaded_google_editor){const o=(0,l.requireCssWithComponent)(i.Snackbar,["/static/metaserver/static/css/cloud_docs/snackbar-vflf9_-Pk.css"]);return i.Snackbar.show(s.default.createElement(o,{variant:"generic",title:a,actionButtonText:r.intl.formatMessage({id:"N4y79U",defaultMessage:"Learn More"}),onActionClick:t.GddSignInSnackbar.handleLearnMore,closeButtonText:r.intl.formatMessage({id:"oW4yFu",defaultMessage:"Preview instead"}),onCloseClick:()=>t.GddSignInSnackbar.handleShowPreview(e),timeoutDelayMs:void 0}))}}).catch(e=>{(0,d.reportException)({err:e,severity:"non-critical",tags:u})})}}})),define("metaserver/static/js/cloud_docs/google_dss/google_dss_types",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.GoogleMessageToEditor=t.GoogleMessageToHost=t.GoogleMessageValues=void 0,(function(e){e.AclFixerClosed="AclFixerClosed",e.AclFixerOpened="AclFixerOpened",e.ClientFragmentsChanged="ClientFragmentsChanged",e.ClientReady="ClientReady",e.HostFragmentsChanged="HostFragmentsChanged",e.HostReady="HostReady",e.MetadataChanged="MetadataChanged",e.ReloadHost="ReloadHost",e.SharingOpened="SharingOpened",e.TitleChanged="TitleChanged"})(t.GoogleMessageValues||(t.GoogleMessageValues={})),(function(e){e.AclFixerOpened="AclFixerOpened",e.ClientFragmentsChanged="ClientFragmentsChanged",e.ClientReady="ClientReady",e.SharingOpened="SharingOpened",e.TitleChanged="TitleChanged",e.ReloadHost="ReloadHost"})(t.GoogleMessageToHost||(t.GoogleMessageToHost={})),(function(e){e.AclFixerClosed="AclFixerClosed",e.HostFragmentsChanged="HostFragmentsChanged",e.HostReady="HostReady",e.MetadataChanged="MetadataChanged"})(t.GoogleMessageToEditor||(t.GoogleMessageToEditor={}))})),define("metaserver/static/js/cloud_docs/loading_page",["require","exports","tslib","react","metaserver/static/js/components/ui/css","metaserver/static/js/core/browser","metaserver/static/js/core/i18n","metaserver/static/js/clean/static_urls","metaserver/static/js/clean/ui/image","metaserver/static/js/filepath/filepath","metaserver/static/js/cloud_docs/constants","metaserver/static/js/cloud_docs/shared_components/routing"],(function(e,t,o,s,r,a,i,n,c,d,l,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LoadingController=t.LoadingPage=void 0,s=o.__importDefault(s),a=o.__importStar(a);class u extends s.default.Component{constructor(e){if(super(e),this.state={timedOut:!1,currentString:0,loadingStringClass:"string show",fileClass:"file"},this.props.fqPath){const e=this.props.fqPath.split("/");this.filename=e[e.length-1],this.filepath=e.slice(0,e.length-1).join("/"),this.iconClass=(0,d.file_extension)(this.filename)}const t=(0,p.getCloudEditorString)(this.props.editorType,this.iconClass);if(t){const e=l.CLOUD_EDITOR_TO_PRODUCT_NAME[t],{name:o}=(0,d.split_filename)(this.filename);document.title=o+" - "+e}setTimeout(()=>{this.setState({fileClass:"file show"})},10),this.listenForTimeout=this.listenForTimeout.bind(this)}listenForTimeout(){this.setState({timedOut:!1}),this.props.timeoutMs&&(this.timeoutListener=setTimeout(()=>{this.setState({timedOut:!0}),this.props.onTimeout&&this.props.onTimeout()},this.props.timeoutMs))}componentWillUnmount(){clearTimeout(this.timeoutListener),this.interval&&clearInterval(this.interval)}static backToDropbox(){a.replace_location("/home")}componentDidMount(){this.interval=setInterval(()=>{for(let e=1;e<3;e++)setTimeout(()=>{const e="string hide"===this.state.loadingStringClass?"string show":"string hide";this.setState({loadingStringClass:e})},500*e);setTimeout(()=>{this.setState({timedOut:this.state.timedOut,currentString:(this.state.currentString+1)%this.props.loadingStrings.length})},800)},4e3),this.listenForTimeout()}render(){let e,t;return this.props.fqPath&&(t=s.default.createElement("div",{className:this.state.fileClass},s.default.createElement("span",{className:"icon "+this.iconClass}),s.default.createElement("div",{className:"fileTitle"},s.default.createElement("div",{className:"title1"},s.default.createElement("span",{className:"name"},this.filename)),s.default.createElement("div",{className:"title2"},s.default.createElement("span",null,this.filepath))))),e=this.state.timedOut?s.default.createElement("div",{className:"loading-error"},s.default.createElement(c.Image,{className:"error-img",src:(0,n.static_url)("/static/metaserver/static/images/illustration_catalog/404_error-illo-vfl1HwwVY.png"),srcHiRes:(0,n.static_url)("/static/metaserver/static/images/illustration_catalog/404_error-illo@2x-vflYfgmUv.png"),alt:""}),s.default.createElement("div",{className:"loading-msg"},s.default.createElement("div",null,i.intl.formatMessage({id:"6kdzvy",defaultMessage:"Oops, something went wrong"}))),s.default.createElement("div",{className:"loading-msg-lower"},s.default.createElement("a",{className:"loading-back",href:"#",onClick:u.backToDropbox},i.intl.formatMessage({id:"C2jCcj",defaultMessage:"Back to Dropbox"})))):s.default.createElement("div",{className:"content-container"},t,s.default.createElement("div",{className:"loading-loading"},s.default.createElement("video",{className:"loading-img",autoPlay:!0,loop:!0,muted:!0,playsInline:!0,preload:"none",src:(0,n.static_url)("/static/metaserver/static/videos/cloud_docs/loading-boxes-320px-vflg0s5R2.mp4")}),s.default.createElement("div",{className:"meta"},s.default.createElement("div",{className:this.state.loadingStringClass},s.default.createElement("span",null,this.props.loadingStrings?this.props.loadingStrings[this.state.currentString]:null))))),s.default.createElement("div",{className:"loading-container"},e)}}t.LoadingPage=u,u.displayName="LoadingPage";const m=(0,r.requireCssWithComponent)(u,["/static/metaserver/static/css/cloud_docs/loading_page-vflcAQpM9.css"]);t.LoadingController=e=>s.default.createElement(m,Object.assign({},e))})),define("metaserver/static/js/cloud_docs/paper/cloud_doc_notifications_dropdown_loadable",["require","exports","tslib","metaserver/static/js/async/loadable","metaserver/static/js/clean/web_timing_logger"],(function(e,t,o,s,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CloudDocNotificationsDropdownLoadable=void 0,r=o.__importStar(r),t.CloudDocNotificationsDropdownLoadable=(0,s.Loadable)({loader:()=>r.waitForTTI().then(()=>new Promise((t,o)=>{e(["metaserver/static/js/cloud_docs/paper/cloud_doc_notifications_dropdown"],t,o)}).then(o.__importStar).then(({CloudDocNotificationsDropdown:e})=>e))})})),define("metaserver/static/js/cloud_docs/paper/cloud_doc_search_ui_loadable",["require","exports","tslib","metaserver/static/js/async/loadable","metaserver/static/js/clean/web_timing_logger"],(function(e,t,o,s,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CloudDocSearchUiLoadable=void 0,r=o.__importStar(r),t.CloudDocSearchUiLoadable=(0,s.Loadable)({loader:()=>r.waitForTTI().then(()=>new Promise((t,o)=>{e(["metaserver/static/js/cloud_docs/paper/cloud_doc_search_ui"],t,o)}).then(o.__importStar).then(({CloudDocSearchUiController:e})=>e))})})),define("metaserver/static/js/cloud_docs/paper/paper_iframe_wrapper",["require","exports","tslib","react","metaserver/static/js/cloud_docs/cloud_doc_iframe_helpers","metaserver/static/js/cloud_docs/cloud_doc_iframe","metaserver/static/js/cloud_docs/types","metaserver/static/js/cloud_docs/cloud_doc_api_client","metaserver/static/js/cloud_docs/paper/cloud_doc_notifications_dropdown_loadable","metaserver/static/js/cloud_docs/paper/cloud_doc_search_ui_loadable","metaserver/static/js/clean/viewer","metaserver/static/js/core/browser","metaserver/static/js/core/exception","metaserver/static/js/cloud_docs/cloud_doc_frame_messenger","metaserver/static/js/cloud_docs/errors"],(function(e,t,o,s,r,a,i,n,c,d,l,p,u,m,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PaperIframeWrapper=void 0,s=o.__importDefault(s),p=o.__importStar(p);class g extends s.default.Component{constructor(t){super(t),this.sclToCloudDocMap={},this.handleWindowEvent=(e,t)=>{if(e===r.WindowEvent.popstate){const e=p.get_href(),t=this.getCloudDocForLink(e);if(!t)throw new Error("Attempted navigation to unknown url: "+e);return t!==this.state.currentCloudDocId&&(!!this.props.userData.id&&(this.onNavigateSharedContentLink(this.props.userData.id,t),!0))}return!1},this.handlePaperSpecificMessage=(e,t)=>{if(this.props.userData.id){if(e.action===i.PaperSpecificActionsToDropbox.GetToken)return this.onGetTokenMessageReceived(this.props.userData.id,e.parameters.docId),!0;if(e.action===i.PaperSpecificActionsToDropbox.NavigateNewDoc)return this.onNavigateNewDocMessageReceived(this.props.userData.id,e.parameters.docId),!0;if(e.action===i.PaperSpecificActionsToDropbox.NavigateCompleted){if(this.navigatingCloudDoc&&this.navigatingCloudDoc.cloudDocId===e.parameters.docId){const t=this.navigatingCloudDoc.isRequestedByPaper?r.BrowserHistoryUpdateAction.replace:r.BrowserHistoryUpdateAction.none,o=this.navigatingCloudDoc.navigationProperties,s=void 0!==o.fq_path?o.fq_path:null;this.completeNavigatingToDoc(e.parameters.docId,{tpat:o.auth_token,tpatExpirationTime:o.auth_token_expiry},{uniqueId:o.bolt_data.unique_id,revision:o.bolt_data.revision,token:o.bolt_data.token},o.api_file_id,o.ns_id,o.file_name,s,this.props.editorType,(0,i.getPlatform)(this.props.platform),t,o.shared_content_link),this.clearNavigatingState()}return!0}}return e.action===i.PaperSpecificActionsToDropbox.OpenSearchUi?(this.setState({searchUiData:{visible:!0,left:null,right:e.parameters.right,top:e.parameters.top,searchResultClickAction:i.SearchResultClickAction.Navigate,shouldRenderDarkMode:e.parameters.shouldRenderDarkMode}}),!0):e.action===i.PaperSpecificActionsToDropbox.MountDropboxNotificationsDropdown?(!0===e.parameters.isInverse?document.documentElement.classList.add("dig-Theme--dark"):!1===e.parameters.isInverse&&document.documentElement.classList.remove("dig-Theme--dark"),this.setState({notificationsDropdownData:{visible:e.parameters.visible,top:e.parameters.top,right:e.parameters.right,useDigStyling:e.parameters.useDigStyling,hideDropboxNotificationBell:e.parameters.hideDropboxNotificationBell}}),!0):e.action===i.PaperSpecificActionsToDropbox.ToggleNotificationDropdown&&(this.setState({toggleNotificationDropdown:!this.state.toggleNotificationDropdown}),!0)},this.pollForIframeContent=(e,t)=>{e&&null!==e.contentDocument?t():setTimeout(()=>{this.pollForIframeContent(e,t)},100)},this.onMountIframeContainer=(e,t,o,s,r)=>{const a=document.querySelector(".cloud-doc-iframe");this.cloudDocFrameMessengerHost=t(a),this.pollForIframeContent(a,o),this.startNavigatingToDoc=s,this.completeNavigatingToDoc=r,this.setCloudDocForLink(p.get_href(),this.state.currentCloudDocId)},this.constructProviderSpecificFrameMessengerHost=(e,t,o,s,r)=>new m.DefaultCloudDocFrameMessengerHost(t,e,o,s,r),this.handleSearchUiBlurEvent=e=>{const t=this.state.searchUiData.searchResultClickAction;this.setState({searchUiData:{visible:!1,top:0,left:0,right:null,searchResultClickAction:i.SearchResultClickAction.Navigate}}),t===i.SearchResultClickAction.Navigate&&this.cloudDocFrameMessengerHost.postMessageToChildren(i.PaperSpecificActionsToProvider.SearchUiClosed,{docId:this.state.currentCloudDocId})},this.handleNotificationCountChangeEvent=e=>{this.cloudDocFrameMessengerHost.postMessageToChildren(i.PaperSpecificActionsToProvider.NotificationCountChanged,{docId:this.state.currentCloudDocId,actionableCount:e})},this.postTTIProviderCallback=t=>{const s=this.props.userData.id;if(s)return new Promise((t,o)=>{e(["metaserver/static/js/sharing/stores/sharing_info"],t,o)}).then(o.__importStar).then(({sharingInfoStore:e})=>{const o=()=>{const o=e.getSharingInfo(s,t);o&&this.memberCount!==o.memberNum()&&(this.cloudDocFrameMessengerHost.postMessageToChildren(i.PaperSpecificActionsToProvider.MemberCountChanged,{docId:this.state.currentCloudDocId}),this.memberCount=o.memberNum())};e.remove_change_listener(o),e.add_change_listener(o)}).catch(e=>{(0,u.reportException)({err:e,severity:"non-critical",tags:["owner:cloud-docs"]})})},this.state={currentCloudDocId:t.docId,toggleNotificationDropdown:!1,notificationsDropdownData:{visible:!1,top:0,right:0,useDigStyling:!1},searchUiData:{visible:!1,top:0,left:0,right:null,searchResultClickAction:i.SearchResultClickAction.Navigate}}}setCloudDocForLink(e,t){const o=(0,r.extractSCLToken)(e);o&&(this.sclToCloudDocMap[o]=t)}getCloudDocForLink(e){const t=(0,r.extractSCLToken)(e);return t?this.sclToCloudDocMap[t]:null}postTokenMessageWithError(e,t,o){null!==this.cloudDocFrameMessengerHost&&this.cloudDocFrameMessengerHost.postMessageToChildren(e,{docId:t,errorReason:o})}postTokenMessageWithToken(e,t,o){null!==this.cloudDocFrameMessengerHost&&this.cloudDocFrameMessengerHost.postMessageToChildren(e,{docId:t,authToken:o.auth_token,authTokenExpiry:o.auth_token_expiry})}onGetTokenMessageReceived(e,t){(0,n.getCloudDocToken)(e,t,e=>{(0,r.isPaperDoc)(e.cloud_doc_type[".tag"])?this.postTokenMessageWithToken(i.PaperSpecificActionsToProvider.GrantToken,t,e):this.postTokenMessageWithError(i.PaperSpecificActionsToProvider.GrantToken,t,Error("Requested file is not a Paper doc"))},e=>this.postTokenMessageWithError(i.PaperSpecificActionsToProvider.GrantToken,t,e))}onNavigateNewDocMessageReceived(e,t){(0,n.getNavigationProperties)(e,t,e=>{(0,r.isPaperDoc)(e.cloud_doc_type[".tag"])?this.handleGetPropsSuccessForNavigation(t,!0,e):this.handleGetPropsErrorForNavigation(t,Error("Requested file is not a Paper doc"))},e=>{this.handleGetPropsErrorForNavigation(t,e)})}handleGetPropsSuccessForNavigation(e,t,o){o.shared_content_link&&(this.navigatingCloudDoc={cloudDocId:e,navigationProperties:o,isRequestedByPaper:t},this.setCloudDocForLink(o.shared_content_link,e)),this.setState({currentCloudDocId:e},()=>{this.startNavigatingToDoc(e,t),this.postTokenMessageWithToken(i.PaperSpecificActionsToProvider.NavigateNewDoc,e,o)})}handleGetPropsErrorForNavigation(e,t){this.navigatingCloudDoc&&this.navigatingCloudDoc.cloudDocId===e&&this.clearNavigatingState(),this.postTokenMessageWithError(i.PaperSpecificActionsToProvider.NavigateNewDoc,e,t)}onNavigateSharedContentLink(e,t){(0,n.getNavigationProperties)(e,t,e=>{this.handleGetPropsSuccessForNavigation(t,!1,e)},e=>{this.handleGetPropsErrorForNavigation(t,e)})}clearNavigatingState(){this.navigatingCloudDoc=null}render(){const e=(0,r.getExtraNavigationEnvironmentParametersForPaper)(),t=(0,r.addParametersAndFragmentsFromBrowserUri)(this.props.actionUrl,p.get_uri(),e);return s.default.createElement("div",null,s.default.createElement(a.ProviderIframeContainer,Object.assign({},this.props,{actionUrl:t,postTTIProviderCallback:this.postTTIProviderCallback,onProviderSpecificMessage:this.handlePaperSpecificMessage,onWindowEventProvider:this.handleWindowEvent,onMountIframeContainer:this.onMountIframeContainer,constructProviderSpecificFrameMessengerHost:this.constructProviderSpecificFrameMessengerHost,providerSpecificActions:[i.PaperSpecificActionsToDropbox.OpenSearchUi,i.PaperSpecificActionsToDropbox.GetToken,i.PaperSpecificActionsToDropbox.NavigateNewDoc,i.PaperSpecificActionsToDropbox.NavigateCompleted,i.PaperSpecificActionsToDropbox.OpenDocMentionUI,i.PaperSpecificActionsToDropbox.MountDropboxNotificationsDropdown,i.PaperSpecificActionsToDropbox.ToggleNotificationDropdown],exceptionLoggingTags:[h.PAPER_EXCLOG_TAG_NAME]})),this.props.userData.id&&this.cloudDocFrameMessengerHost&&s.default.createElement(d.CloudDocSearchUiLoadable,Object.assign({},this.state.searchUiData,{user:l.Viewer.get_viewer().get_user_by_id(this.props.userData.id),onBlur:this.handleSearchUiBlurEvent})),s.default.createElement(c.CloudDocNotificationsDropdownLoadable,Object.assign({},this.state.notificationsDropdownData,{shouldOpenDropdown:this.state.toggleNotificationDropdown,handleNotificationCountChange:this.handleNotificationCountChangeEvent})))}}t.PaperIframeWrapper=g,g.displayName="PaperIframeWrapper"})),define("metaserver/static/js/cloud_docs/preferred_editor_modal",["require","exports","tslib","react","metaserver/static/js/components/ui/css","metaserver/static/js/components/ui/modal","spectrum/modal/index","spectrum/button/index","spectrum/checkbox/index","metaserver/static/js/core/i18n","metaserver/static/js/cloud_docs/types","metaserver/static/js/clean/ux_analytics_modal_tracking","metaserver/static/js/account_page/widgets/preferred_editor/api","metaserver/static/js/cloud_docs/event_logging","metaserver/static/js/cloud_docs/cloud_doc_api_client","metaserver/static/js/cloud_docs/shared_components/cloud_docs_error_modal","metaserver/static/js/cloud_docs/preferred_editor_constants"],(function(e,t,o,s,r,a,i,n,c,d,l,p,u,m,h,g,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PreferredEditorModal=t.PreferredEditorModalComponent=void 0,s=o.__importDefault(s);class _ extends s.default.Component{constructor(e){super(e),this.handleDontAskAgain=()=>o.__awaiter(this,void 0,void 0,(function*(){if("checked"===this.state.dontAskAgain)try{yield(0,h.dismissPreferredEditorPrompt)(this.props.userId,{".tag":this.props.integrationName.toLowerCase()},{".tag":this.props.editorType})}catch(e){g.CloudDocsErrorModal.showInstance({title:d.intl.formatMessage({id:"rnywgf",defaultMessage:"Couldn’t save preference"}),body:d.intl.formatMessage({id:"o4tdpN",defaultMessage:"Couldn’t save the preference you selected this time."}),primaryAction:()=>s.default.createElement(n.Button,{onClick:g.CloudDocsErrorModal.close},d.intl.formatMessage({id:"nOO9Qi",defaultMessage:"OK"}))})}})),this.handlePrimaryAction=()=>o.__awaiter(this,void 0,void 0,(function*(){this.handleDontAskAgain();try{yield(0,u.preferredEditorSet)(this.props.userId,this.props.editorType,f.IntegrationNameToPreferredEditorEnums[this.props.integrationName]),(0,m.logFileOpenPromptAction)(this.props.userId,this.props.editorType,this.props.integrationName,l.PromptActionTypes.Yes,"checked"===this.state.dontAskAgain?"false":"true")}catch(e){g.CloudDocsErrorModal.showInstance({title:d.intl.formatMessage({id:"gtyX8V",defaultMessage:"Couldn’t save default editor"}),body:d.intl.formatMessage({id:"6T6/7h",defaultMessage:"You can still choose a default editor in your Dropbox settings."}),primaryAction:()=>s.default.createElement(n.Button,{onClick:g.CloudDocsErrorModal.close},d.intl.formatMessage({id:"nOO9Qi",defaultMessage:"OK"}))})}})),this.handleSecondaryAction=()=>{this.handleDontAskAgain(),(0,m.logFileOpenPromptAction)(this.props.userId,this.props.editorType,this.props.integrationName,l.PromptActionTypes.No,"checked"===this.state.dontAskAgain?"false":"true")},this.updateDontAskAgain=e=>{this.setState({dontAskAgain:e})},this.renderDontAskAgain=()=>s.default.createElement("div",{className:"preferred-editor--checkbox-view"},s.default.createElement(c.Checkbox,{className:"preferred-editor--checkbox-box",checked:this.state.dontAskAgain,onChange:this.updateDontAskAgain}),s.default.createElement("label",{className:"preferred-editor--checkbox-label",htmlFor:"preferred-editor--checkbox-box"},d.intl.formatMessage({id:"s0mqEc",defaultMessage:"Don’t ask me this again"}))),this.handleRequestClose=()=>{this.props.handleRequestClose?this.props.handleRequestClose():this.setState({isOpen:!1})},this.state={dontAskAgain:"unchecked",isOpen:!0}}static showInstance(e){return a.Modal.showInstance(s.default.createElement(v,Object.assign({},e)))}componentDidMount(){(0,m.logFileOpenPromptAction)(this.props.userId,this.props.editorType,this.props.integrationName,l.PromptActionTypes.Impression,"true")}render(){return s.default.createElement(i.UtilityModal,{title:this.props.title,ariaLabel:"Gdd Promotion Modal",primaryAction:d.intl.formatMessage({id:"ZbJFCw",defaultMessage:"Yes, set as default"}),secondaryAction:d.intl.formatMessage({id:"5FcUkH",defaultMessage:"Not now"}),onPrimaryAction:this.handlePrimaryAction,onSecondaryAction:this.handleSecondaryAction,open:this.props.isOpen&&this.state.isOpen,shouldRequestCloseOnActions:!0,onRequestClose:this.handleRequestClose,variant:"regular",link:this.renderDontAskAgain},s.default.createElement(p.UXAnalyticsModalTracking,{id:"preferred-editor-promotion-modal"}),s.default.createElement("p",null,this.props.body))}}t.PreferredEditorModalComponent=_,_.displayName="PreferredEditorModalComponent";const v=(0,r.requireCssWithComponent)(_,["/static/metaserver/static/css/spectrum/index.web-vflJy4G-t.css","/static/metaserver/static/css/cloud_docs/preferred_editor_modal-vfl9_ef_x.css"]);t.PreferredEditorModal=v})),define("metaserver/static/js/cloud_docs/shared_components/cloud_doc_pass_snackbar",["require","exports","tslib","react","metaserver/static/js/core/i18n","metaserver/static/js/clean/ui/snackbar","metaserver/static/js/core/browser","metaserver/static/js/cloud_docs/cloud_doc_api_client","metaserver/static/js/core/exception","metaserver/static/js/components/ui/css"],(function(e,t,o,s,r,a,i,n,c,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CloudDocPassSnackbar=void 0,s=o.__importDefault(s),i=o.__importStar(i);const l="https://help.dropbox.com/files-folders/viewer-information",p=["owner:cloud-docs"];t.CloudDocPassSnackbar={handleOnAction(){i.open_tab(l)},handleOnClose(e){(0,n.setPassSnackbarAsync)(e).catch(e=>{(0,c.reportException)({err:e,severity:"non-critical",tags:p})})},showInstance(e,i,l){return o.__awaiter(this,void 0,void 0,(function*(){let o=!1;if(yield(0,n.getPassSnackbarAsync)(e,i).then(e=>{o=e.has_dismissed}).catch(e=>{o=!0,(0,c.reportException)({err:e,severity:"non-critical",tags:p})}),!o){const o=(0,d.requireCssWithComponent)(a.Snackbar,["/static/metaserver/static/css/cloud_docs/snackbar-vflf9_-Pk.css"]);return a.Snackbar.show(s.default.createElement(o,{variant:"generic",title:r.intl.formatMessage({id:"0VN65R",defaultMessage:"People who view this file may be able to see when you last opened it. This info may show for other Dropbox files you open."}),actionButtonText:r.intl.formatMessage({id:"gk12sS",defaultMessage:"Learn more"}),onActionClick:t.CloudDocPassSnackbar.handleOnAction,closeButtonText:r.intl.formatMessage({id:"u/p3Pl",defaultMessage:"Close"}),onCloseClick:()=>{l(),t.CloudDocPassSnackbar.handleOnClose(e)},timeoutDelayMs:void 0}))}l()}))}}})),define("metaserver/static/js/cloud_docs/shared_components/cloud_doc_preview_snackbar",["require","exports","tslib","react","metaserver/static/js/core/i18n","metaserver/static/js/clean/ui/snackbar","metaserver/static/js/core/browser","metaserver/static/js/components/ui/css","metaserver/static/js/core/uri"],(function(e,t,o,s,r,a,i,n,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CloudDocPreviewSnackbar=void 0,s=o.__importDefault(s),i=o.__importStar(i);t.CloudDocPreviewSnackbar={handleShowPreview(){const e=c.URI.parse(i.get_href()).updateQuery("cloud_editor","preview").toString();i.open_tab(e)},closeInstance(){a.Snackbar.close("cloud-docs-preview-snackbar-id")},showInstance(e){return o.__awaiter(this,void 0,void 0,(function*(){const o=(0,n.requireCssWithComponent)(a.Snackbar,["/static/metaserver/static/css/cloud_docs/snackbar-vflf9_-Pk.css"]);return a.Snackbar.show(s.default.createElement(o,{id:"cloud-docs-preview-snackbar-id",variant:"generic",title:r.intl.formatMessage({id:"E/Jy6H",defaultMessage:"While you wait, you can preview this file in another tab."}),actionButtonText:r.intl.formatMessage({id:"HjYlKs",defaultMessage:"Go to preview"}),closeButtonText:r.intl.formatMessage({id:"u/p3Pl",defaultMessage:"Close"}),onActionClick:()=>{e(),t.CloudDocPreviewSnackbar.handleShowPreview()},timeoutDelayMs:void 0}))}))}}}));var __createBinding=this&&this.__createBinding||(Object.create?function(e,t,o,s){void 0===s&&(s=o);var r=Object.getOwnPropertyDescriptor(t,o);r&&("get"in r?t.__esModule:!r.writable&&!r.configurable)||(r={enumerable:!0,get:function(){return t[o]}}),Object.defineProperty(e,s,r)}:function(e,t,o,s){void 0===s&&(s=o),e[s]=t[o]}),__setModuleDefault=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),__importStar=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var o in e)"default"!==o&&Object.prototype.hasOwnProperty.call(e,o)&&__createBinding(t,e,o);return __setModuleDefault(t,e),t};define("metaserver/static/js/cloud_docs/shared_components/cloud_doc_snackbar_controller",["require","exports","metaserver/static/js/cloud_docs/shared_components/cloud_doc_pass_snackbar","metaserver/static/js/cloud_docs/shared_components/cloud_doc_email_verification_snackbar","metaserver/static/js/cloud_docs/shared_components/cloud_doc_user_education_snackbar","metaserver/static/js/cloud_docs/shared_components/cloud_doc_preview_snackbar","metaserver/static/js/cloud_docs/shared_components/cloud_doc_copy_redirect_snackbar","metaserver/static/js/cloud_docs/types","metaserver/static/js/cloud_docs/event_logging"],(function(e,t,o,s,r,a,i,n,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CloudDocSnackbarController=void 0;t.CloudDocSnackbarController=class{constructor(t,d,l,p,u,m,h,g,f){this.showPreviewSnackbarWithTimeout=e=>{this.previewTimer=setTimeout(()=>{this.logShowPreviewSnackbar(),a.CloudDocPreviewSnackbar.showInstance(this.logOpenPreview)},e)},this.showShareModal=()=>{const t=this.userId;t&&new Promise((t,o)=>{e(["metaserver/static/js/sharing/async_share_modal_util"],t,o)}).then(__importStar).then(({asyncShowShareModal:e})=>{e(t,{fileId:this.fileId,isFolder:!1},{origin:this.origin})})},this.onPassSnackbarClose=()=>{this.userId&&r.CloudDocUserEducationSnackbar.showInstance(this.userId,this.docId,this.showShareModal)},this.onEmailVerificationSnackbarClose=()=>{this.userId&&o.CloudDocPassSnackbar.showInstance(this.userId,this.docId,this.onPassSnackbarClose)},this.clearPreviewSnackbarTimer=()=>{this.previewTimer&&(clearTimeout(this.previewTimer),this.previewTimer=void 0),a.CloudDocPreviewSnackbar.closeInstance()},this.showSnackbars=()=>(this.clearPreviewSnackbarTimer(),this.copyRedirect?i.CloudDocCopyRedirectSnackbar.showInstance(this.copyRedirect):this.userId?this.isEmailVerified?o.CloudDocPassSnackbar.showInstance(this.userId,this.docId,this.onPassSnackbarClose):s.CloudDocEmailVerificationSnackbar.showInstance(this.userId,this.email,this.onEmailVerificationSnackbarClose):void 0),this.logShowPreviewSnackbar=()=>{(0,c.logUserAction)({actionEvent:n.UserActionEventType.LOADING_SNACKBAR_IMPRESSION,userId:this.userId,docPathOrId:this.fileId,data:{webOpenId:this.openId}})},this.logOpenPreview=()=>{(0,c.logUserAction)({actionEvent:n.UserActionEventType.LOADING_SNACKBAR_OPEN_PREVIEW,userId:this.userId,docPathOrId:this.fileId,data:{webOpenId:this.openId}})},this.userId=t,this.docId=d,this.fileId=l,this.filename=p,this.openId=u,this.origin=m,this.copyRedirect=h,this.email=g,this.isEmailVerified=f}}})),define("metaserver/static/js/cloud_docs/shared_components/cloud_doc_user_education_snackbar",["require","exports","tslib","react","metaserver/static/js/core/i18n","metaserver/static/js/clean/ui/snackbar","metaserver/static/js/cloud_docs/cloud_doc_api_client","metaserver/static/js/core/exception","metaserver/static/js/components/ui/css"],(function(e,t,o,s,r,a,i,n,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CloudDocUserEducationSnackbar=void 0,s=o.__importDefault(s);const d=["owner:cloud-docs"];t.CloudDocUserEducationSnackbar={handleOnClose(e){(0,i.setUserEducationSnackbarAsync)(e).catch(e=>{(0,n.reportException)({err:e,severity:"non-critical",tags:d})})},showInstance(e,l,p){return o.__awaiter(this,void 0,void 0,(function*(){let o=!1;if(yield(0,i.getUserEducationSnackbarAsync)(e).then(e=>{o=e.has_dismissed}).catch(e=>{o=!0,(0,n.reportException)({err:e,severity:"non-critical",tags:d})}),!o){const o=(0,c.requireCssWithComponent)(a.Snackbar,["/static/metaserver/static/css/cloud_docs/snackbar-vflf9_-Pk.css"]);return a.Snackbar.show(s.default.createElement(o,{variant:"generic",title:r.intl.formatMessage({id:"nans2u",defaultMessage:"To share this Dropbox file, just copy the URL from your browser. Keep in mind, anyone with the URL may be able to edit."}),actionButtonText:r.intl.formatMessage({id:"YC4s0t",defaultMessage:"Change settings"}),onActionClick:()=>{p(),t.CloudDocUserEducationSnackbar.handleOnClose(e),a.Snackbar.close()},closeButtonText:r.intl.formatMessage({id:"u/p3Pl",defaultMessage:"Close"}),onCloseClick:()=>t.CloudDocUserEducationSnackbar.handleOnClose(e),timeoutDelayMs:void 0}))}}))}}})),define("metaserver/static/js/cloud_docs/shared_components/cloud_doc_email_verification_snackbar",["require","exports","tslib","react","metaserver/static/js/core/i18n","metaserver/static/js/clean/ui/snackbar","metaserver/static/js/core/browser","metaserver/static/js/clean/viewer","metaserver/static/js/account/email_verify_reasons","metaserver/static/js/components/ui/css","metaserver/static/js/account/email_verify"],(function(e,t,o,s,r,a,i,n,c,d,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CloudDocEmailVerificationSnackbar=void 0,s=o.__importDefault(s),i=o.__importStar(i),l=o.__importDefault(l),t.CloudDocEmailVerificationSnackbar={showEmailSent(){return o.__awaiter(this,void 0,void 0,(function*(){const e=(0,d.requireCssWithComponent)(a.Snackbar,["/static/metaserver/static/css/cloud_docs/snackbar-vflf9_-Pk.css"]);a.Snackbar.show(s.default.createElement(e,{variant:"complete",title:r.intl.formatMessage({id:"HSPEq6",defaultMessage:"Email sent. Once your email is verified, reload the page to edit the file."}),actionButtonText:r.intl.formatMessage({id:"zOcVU3",defaultMessage:"Reload"}),onActionClick:()=>{i.reload()},timeoutDelayMs:void 0}))}))},handleOnAction(e,o){const s=n.Viewer.get_viewer().get_user_by_id(e);l.default.send_verification_email(s,o,c.EmailVerificationReasons.CLOUD_DOCS,()=>{t.CloudDocEmailVerificationSnackbar.showEmailSent()})},showInstance(e,i,n){return o.__awaiter(this,void 0,void 0,(function*(){const o=(0,d.requireCssWithComponent)(a.Snackbar,["/static/metaserver/static/css/cloud_docs/snackbar-vflf9_-Pk.css"]);return a.Snackbar.show(s.default.createElement(o,{variant:"generic",title:r.intl.formatMessage({id:"2ejwnd",defaultMessage:"To edit this file, we need to verify your email. Check your inbox."}),actionButtonText:r.intl.formatMessage({id:"DKSsPd",defaultMessage:"Resend verification email"}),onActionClick:()=>t.CloudDocEmailVerificationSnackbar.handleOnAction(e,i),timeoutDelayMs:void 0}))}))}}})),define("metaserver/static/js/cloud_docs/shared_components/cloud_doc_copy_redirect_snackbar",["require","exports","tslib","react","metaserver/static/js/core/i18n","metaserver/static/js/clean/ui/snackbar","metaserver/static/js/components/ui/css"],(function(e,t,o,s,r,a,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CloudDocCopyRedirectSnackbar=void 0,s=o.__importDefault(s);const n="cloud-docs-copy-redirect-snackbar-id";t.CloudDocCopyRedirectSnackbar={closeInstance(){a.Snackbar.close(n)},showInstance(e){return o.__awaiter(this,void 0,void 0,(function*(){setTimeout(()=>{const e=(0,i.requireCssWithComponent)(a.Snackbar,["/static/metaserver/static/css/cloud_docs/snackbar-vflf9_-Pk.css"]);return a.Snackbar.show(s.default.createElement(e,{id:n,variant:"generic",title:s.default.createElement(s.default.Fragment,null,"Couldn't open your copy of ",s.default.createElement("b",null,"filename"),". You've been redirected to the original version."),closeButtonText:r.intl.formatMessage({id:"u/p3Pl",defaultMessage:"Close"}),timeoutDelayMs:void 0}))},500)}))}}})),define("metaserver/static/js/cloud_docs/shared_components/cloud_docs_error_modal",["require","exports","tslib","react","metaserver/static/js/components/ui/css","metaserver/static/js/components/ui/modal","spectrum/modal/index"],(function(e,t,o,s,r,a,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CloudDocsErrorModal=void 0,s=o.__importDefault(s);class n extends s.default.Component{constructor(e){super(e)}static showInstance(e){return a.Modal.showInstance(s.default.createElement(c,Object.assign({},e)))}render(){return s.default.createElement(i.UtilityModal,{shouldFocusAfterRender:!0,title:this.props.title,ariaLabel:"Cloud Docs Error Modal",primaryAction:this.props.primaryAction,secondaryAction:this.props.secondaryAction,open:!0,shouldRequestCloseOnActions:!1,variant:"regular"},s.default.createElement("p",null),s.default.createElement("p",null,this.props.body))}}t.CloudDocsErrorModal=n,n.close=()=>a.Modal.close(),n.displayName="CloudDocsErrorModal";const c=(0,r.requireCssWithComponent)(n,["/static/metaserver/static/css/spectrum/index.web-vflJy4G-t.css","/static/metaserver/static/css/cloud_docs/cloud_docs_errors-vflGhu13M.css"])})),define("metaserver/static/js/cloud_docs/shared_components/cloud_docs_image_modal",["require","exports","tslib","react","spectrum/button/index","metaserver/static/js/components/ui/modal","metaserver/static/js/components/ui/css"],(function(e,t,o,s,r,a,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CloudDocsImageModal=void 0,s=o.__importStar(s);class n extends s.Component{static showInstance(e){return a.Modal.showInstance(s.createElement(t.CloudDocsImageModal,Object.assign({},e)))}render(){const e=s.createElement("div",{className:"view-buttons"},s.createElement(r.Button,{className:"main-button",onClick:this.props.primaryAction},this.props.primaryText));return s.createElement(a.Modal,{id:"cloud-docs-image-modal-id",className:"cloud-docs-image-modal",buttonComponent:e,style:"clean",showX:this.props.isClosable,autoClose:this.props.isClosable,clickOutToClose:this.props.isClosable,escapeOrBackspaceToClose:this.props.isClosable,dismissButtonDisabled:!this.props.isClosable},s.createElement("div",{className:"cloud-docs-image-modal-div"},s.createElement("img",{className:this.props.imageClassName,alt:"",src:this.props.imageURL}),s.createElement("div",{className:"main-text"},this.props.title),s.createElement("div",{className:"sub-text"},this.props.body)))}}n.close=()=>a.Modal.close(),n.displayName="CloudDocsImageModalWithoutCss",t.CloudDocsImageModal=(0,i.requireCssWithComponent)(n,["/static/metaserver/static/css/spectrum/index.web-vflJy4G-t.css","/static/metaserver/static/css/cloud_docs/cloud_docs_image_modal-vfliLJ974.css"])})),define("metaserver/static/js/cloud_docs/shared_components/cloud_docs_file_locking_modal",["require","exports","tslib","react","metaserver/static/js/cloud_docs/shared_components/cloud_docs_image_modal","metaserver/static/js/cloud_docs/cloud_doc_file_locking_api","metaserver/static/js/clean/static_urls","metaserver/static/js/core/browser","metaserver/static/js/core/i18n"],(function(e,t,o,s,r,a,i,n,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CloudDocsFileLockingModal=void 0,s=o.__importStar(s),n=o.__importStar(n);class d{constructor(e){this.userId=e,this.isLocked=!1}static showFileLockingModal(e,t){const o=void 0===t||""===t?c.intl.formatMessage({id:"4WH8Fc",defaultMessage:"Someone locked editing for this file. You can still view the file and keep up to date on changes here."}):c.intl.formatMessage({id:"TIFdVv",defaultMessage:"<st>{username}</st> locked editing for this file. You can still view the file and keep up to date on changes here."},{st:e=>s.createElement("strong",null,e),username:t});r.CloudDocsImageModal.showInstance({title:c.intl.formatMessage({id:"ej/CxO",defaultMessage:"Editing for this file is locked"}),body:o,primaryAction:e?r.CloudDocsImageModal.close:n.reload,primaryText:c.intl.formatMessage({id:"RgLuHS",defaultMessage:"Continue in View-only mode"}),imageClassName:"cloud-docs-file-locking",imageURL:(0,i.static_url)("/static/metaserver/static/images/cloud_docs/file_locking-vflzWVKmy.png"),isClosable:e})}mayShowFileLockingModal(e,t){return(0,a.getFileLockState)(this.userId,e).then(e=>{const o=(0,a.decodeFileLockResponse)(e);return!1===this.isLocked&&o.isLocked&&d.showFileLockingModal(t,o.lockholderName),this.isLocked=o.isLocked,!0}).catch(e=>(this.isLocked=!1,!1))}}t.CloudDocsFileLockingModal=d})),define("metaserver/static/js/cloud_docs/wopi/wopi_constants",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.WOPI_IFRAME_ALLOWED_ORIGINS=void 0,t.WOPI_IFRAME_ALLOWED_ORIGINS=["https://excel.purple.officeapps.live-int.com","https://onenote.purple.officeapps.live-int.com","https://powerpoint.purple.officeapps.live-int.com","https://visio.purple.officeapps.live-int.com","https://word-view.purple.officeapps.live-int.com","https://word-edit.purple.officeapps.live-int.com","https://officeapps-df.live.com","https://excel.officeapps-df.live.com","https://onenote.officeapps-df.live.com","https://powerpoint.officeapps-df.live.com","https://word-view.officeapps-df.live.com","https://word-edit.officeapps-df.live.com","https://officeapps.live.com","https://excel.officeapps.live.com","https://onenote.officeapps.live.com","https://powerpoint.officeapps.live.com","https://word-view.officeapps.live.com","https://word-edit.officeapps.live.com","https://www.dropbox.com"]})),define("metaserver/static/js/cloud_docs/wopi/wopi_iframe_wrapper",["require","exports","tslib","react","metaserver/static/js/cloud_docs/cloud_doc_iframe_helpers","metaserver/static/js/cloud_docs/cloud_doc_iframe","metaserver/static/js/cloud_docs/types","metaserver/static/js/core/browser","metaserver/static/js/cloud_docs/wopi/wopi_constants","metaserver/static/js/cloud_docs/cloud_doc_frame_messenger","metaserver/static/js/cloud_docs/errors","metaserver/static/js/clean/web_timing_logger","metaserver/static/js/openwith/binary_conversion_modal","metaserver/static/js/filepath/filepath","metaserver/static/js/cloud_docs/utils"],(function(e,t,o,s,r,a,i,n,c,d,l,p,u,m,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.WopiIframeWrapper=void 0,s=o.__importDefault(s),n=o.__importStar(n),p=o.__importStar(p),m=o.__importStar(m);class g extends s.default.Component{constructor(){super(...arguments),this.handleProviderSpecificMessage=(e,t)=>{switch(e.action){case i.WopiSpecificActionsToDropbox.AppLoadingStatus:return this.onAppLoadedStatus(),this.mayShowBinaryConversionPrompt(),!1;case i.WopiSpecificActionsToDropbox.UIEdit:return this.mayShowBinaryConversionPrompt(),!0;default:return!1}},this.convertWopiMessageEventToMessage=e=>{let t;switch(e.data&&(t=JSON.parse(e.data)),t.MessageId){case i.WopiSpecificActionsToDropbox.UISharing:return{action:i.CloudDocActionsToDropbox.OpenSharingUI,parameters:{docId:this.props.docId}};case i.WopiSpecificActionsToDropbox.BroadcastError:return{action:i.CloudDocActionsToDropbox.BroadcastError,parameters:{docId:this.props.docId,errorMessage:t.Values.message}};default:return{action:t.MessageId,parameters:Object.assign(Object.assign({},t.Values),{docId:this.props.docId})}}},this.convertMessageToWopiMessage=e=>{let t=e.action;return e.action===i.CloudDocActionsToProvider.HostReady&&(t=i.WopiSpecificActionsToProvider.HostReady),JSON.stringify({MessageId:t,SendTime:Date.now(),Values:e.parameters})},this.handleMountIframeContainer=(e,t,o)=>{let s=document.getElementById("cloud-doc-iframe");if(!s){const t=(0,r.GetFormPropertyConsts)();s=document.createElement("iframe"),s.setAttribute("class",t.frameName),s.setAttribute("sandbox","allow-scripts allow-same-origin allow-forms allow-popups allow-top-navigation allow-popups-to-escape-sandbox"),s.name=t.frameName,s.id=t.frameName,s.title="Cloud Doc iframe",e.appendChild(s)}this.cloudDocFrameMessengerHost=t(s,c.WOPI_IFRAME_ALLOWED_ORIGINS);const a=this.createWopiForm();e.appendChild(a),a.submit(),this.clientFrameAlreadyLoaded(s)?this.onIframeLoaded(o):s.onload=()=>{this.onIframeLoaded(o)}},this.clientFrameAlreadyLoaded=e=>null!==e.contentDocument&&"complete"===e.contentDocument.readyState&&"about:blank"!==e.src,this.onIframeLoaded=e=>{e()},this.constructProviderSpecificFrameMessengerHost=(e,t,o,s,r)=>new d.DefaultCloudDocFrameMessengerHost(t,e,o,s,r,this.convertWopiMessageEventToMessage,this.convertMessageToWopiMessage),this.createWopiForm=()=>{const e=(0,r.addParametersAndFragmentsFromBrowserUri)(this.props.actionUrl,n.get_uri()),t=(0,r.GetFormPropertyConsts)(),o=document.createElement("form");o.name=t.formName,o.target=t.frameName,o.action=e,o.method="post";const s=document.createElement("input");s.type="hidden",s.name="access_token",s.value=this.props.wopiArgs.accessToken,o.appendChild(s);const a=document.createElement("input");return a.type="hidden",a.name="access_token_ttl",a.value=this.props.wopiArgs.accessTokenTTL.toString(),o.appendChild(a),o}}onAppLoadedStatus(){p.mark_time_to_interactive();let e=0;window.performance&&window.performance.timing&&(e=window.performance.timing.fetchStart);let t=0;window.performance&&window.performance.navigation&&(t=window.performance.navigation.redirectCount),this.cloudDocFrameMessengerHost.postMessageToChildren(i.WopiSpecificActionsToProvider.PerformanceTiming,{Click:this.props.linkClickTime,Iframe:this.props.iframeCreatedTime,HostFrameFetchStart:e,RedirectCount:t})}mayShowBinaryConversionPrompt(){if(this.props.wopiArgs.showBinaryConversionPrompt){const e=(0,u.getBinaryConversionPrompt)(m.filename(this.props.fqPath)),t=(0,h.getFileExt)(this.props.fqPath);e&&t&&this.props.userData.id&&u.BinaryConversionModal.showInstance({title:e.title,body:e.body,userId:this.props.userData.id,integrationName:i.IntegrationName.OFFICE_ONLINE,file_extension:t})}}render(){return s.default.createElement("div",null,s.default.createElement(a.ProviderIframeContainer,Object.assign({},this.props,{onProviderSpecificMessage:this.handleProviderSpecificMessage,onMountIframeContainer:this.handleMountIframeContainer,constructProviderSpecificFrameMessengerHost:this.constructProviderSpecificFrameMessengerHost,providerSpecificActions:[i.WopiSpecificActionsToDropbox.AppLoadingStatus,i.WopiSpecificActionsToDropbox.AppNavigated,i.WopiSpecificActionsToDropbox.BroadcastError,i.WopiSpecificActionsToDropbox.BroadcastInitialized,i.WopiSpecificActionsToDropbox.BroadcastMediaState,i.WopiSpecificActionsToDropbox.BroadcastState,i.WopiSpecificActionsToDropbox.EditNotification,i.WopiSpecificActionsToDropbox.FileRename,i.WopiSpecificActionsToDropbox.QueryLoadingStatus,i.WopiSpecificActionsToDropbox.UIClose,i.WopiSpecificActionsToDropbox.UIEdit,i.WopiSpecificActionsToDropbox.UIFileVersions,i.WopiSpecificActionsToDropbox.UIReportAbuse,i.WopiSpecificActionsToDropbox.UIShareForm,i.WopiSpecificActionsToDropbox.UISharing,i.WopiSpecificActionsToDropbox.UISignIn],exceptionLoggingTags:[l.WOPI_EXCLOG_TAG_NAME]})))}}t.WopiIframeWrapper=g,g.displayName="WopiIframeWrapper"})),define("metaserver/static/js/openwith/binary_conversion_modal",["require","exports","tslib","react","metaserver/static/js/components/ui/css","metaserver/static/js/components/ui/modal","spectrum/modal/index","metaserver/static/js/core/i18n","metaserver/static/js/core/browser","metaserver/static/js/cloud_docs/event_logging","metaserver/static/js/cloud_docs/types","metaserver/static/js/clean/ux_analytics_modal_tracking"],(function(e,t,o,s,r,a,i,n,c,d,l,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getBinaryConversionPrompt=t.BinaryConversionModal=void 0,s=o.__importDefault(s),c=o.__importStar(c);class u extends s.default.Component{constructor(e){super(e),this.handleConvertAction=()=>{(0,d.logFileConvertPromptAction)(this.props.userId,l.PromptActionTypes.Yes,this.props.integrationName,this.props.file_extension),c.redirect(c.get_uri().updateQuery({cloud_action:"convert"}).toString())},this.handleSecondaryAction=()=>{(0,d.logFileConvertPromptAction)(this.props.userId,l.PromptActionTypes.No,this.props.integrationName,this.props.file_extension)},this.handleRequestClose=()=>{this.setState({isOpen:!1})},this.state={isOpen:!0}}static showInstance(e){return a.Modal.showInstance(s.default.createElement(m,Object.assign({},e)))}componentDidMount(){(0,d.logFileConvertPromptAction)(this.props.userId,l.PromptActionTypes.Impression,this.props.integrationName,this.props.file_extension)}render(){return s.default.createElement(i.UtilityModal,{title:this.props.title,ariaLabel:"Doc Conversion Modal",primaryAction:n.intl.formatMessage({id:"LgJiOW",defaultMessage:"Continue"}),secondaryAction:n.intl.formatMessage({id:"d9/SE1",defaultMessage:"Cancel"}),onPrimaryAction:this.handleConvertAction,onSecondaryAction:this.handleSecondaryAction,open:this.state.isOpen,shouldRequestCloseOnActions:!0,onRequestClose:this.handleRequestClose,variant:"regular"},s.default.createElement(p.UXAnalyticsModalTracking,{id:"binary-conversionr-promotion-modal"}),s.default.createElement("p",null,this.props.body))}}t.BinaryConversionModal=u,u.displayName="BinaryConversionModal";const m=(0,r.requireCssWithComponent)(u,["/static/metaserver/static/css/spectrum/index.web-vflJy4G-t.css","/static/metaserver/static/css/cloud_docs/preferred_editor_modal-vfl9_ef_x.css"]);t.getBinaryConversionPrompt=function(e){return{title:n.intl.formatMessage({id:"0xQrtT",defaultMessage:"Convert <b>{filename}</b> to make edits"},{filename:e,b:e=>s.default.createElement("b",null,e)}),body:n.intl.formatMessage({id:"13ARWl",defaultMessage:"<b>{filename}</b> is in read-only mode. Convert it if you’d like to make edits."},{filename:e,b:e=>s.default.createElement("b",null,e)})}}}));
//# sourceMappingURL=pkg-cloud_docs_iframe.min.js-vflpqfcA-.map