'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[6],{1466:function(C,N,d){C=d(0);var l=d(17),e=d(45),a=d(5),k=d(110),n=d(150),v=d(789),u=d(216),t=d(619),y=d(2),B=d(387),G=d(22),F=d(44),K=d(244),O=d(1),H=d(1531);class I{constructor(P,T){this.ICj=P;this.Dz=T}J(P){return this.ICj.Jy(P,this.Dz)}}Object(C.a)(I,"PropertyMergeStrategies",null,[]);var J=d(1589),L=d(1550);class S extends L.a{constructor(){super();this.KSc=this.KUd=this.Bn=null;this.R0d=0}get hea(){return"Property"}fAb(){this.detail.Z("Type",
this.hea);this.detail.Z("ComplexMerger",null!=this.Bn?this.Bn:-1);this.detail.Z("Strategy",null!=this.KUd?this.KUd:-1);this.detail.Z("ClassId",null!=this.KSc?this.KSc:-1);this.detail.Z("PropId",this.R0d);return this.detail}}Object(C.a)(S,"PropertyMergeFailureDetail",L.a,[]);d.d(N,"a",function(){return E});class E{constructor(P=null){this.SWg=this.Ac=null;this.BSb=P||this.KIc()}get Bn(){return 1}get whb(){return this.BSb}KIc(){return[Object(F.a)(this,this.Oco,"tryPreProcessFavoredRevision"),Object(F.a)(this,
this.Wxk,"cloneObjectAndRemoveNeededProperties"),Object(F.a)(this,this.Fco,"tryMergeNodeInternal")]}set Qb(P){this.Ac=P}get Dz(){return 5}get T0d(){return this.SWg||(this.SWg=new I(this.nk(),this.Dz))}aB(P,T){const U=P.Ng.value.Df;n.a.instance.Wa(4016352,1,4,"GenericNodeComplexMerge: Failing to merge object with [Id: {0}] [ClassId: {1}] because not all of its properties changes were ignorable.",U.id,U.Qc);P.Yo.logger.Pg(Object.assign(new S,{Bn:this.Bn,KSc:U.Qc,R0d:T}));return!1}V6f(P){const T=P.Ng.value;
n.a.instance.Wa(4016353,1,5,"TryMergeNode: Complex merge begin for object: [Id: {0}] [ClassId: {1}]",T.Df.id,T.Df.Qc);for(let U=0;U<this.whb.length;U++)if(!(0,this.whb[U])(P))return n.a.instance.Wa(4016354,1,4,"TryMergeNode: Complex Merge failed for object: [Id: {0}] [ClassId: {1}] [Step: {2}]",T.Df.id,T.Df.Qc,U),P.Yo.logger.sTd("GraphNodeComplexMerge.GetMergeFunctions()",U),this.axm(P),P.Nk=null,!1;n.a.instance.Wa(4016355,1,5,"TryMergeNode: Complex Merge succeeded for object: [Id: {0}] [ClassId: {1}]",
T.Df.id,T.Df.Qc);return!0}axm(P){P.J$f||(P.J$f=!0,J.a(P.Ng.value.ku,"Base",1),J.a(P.Ng.value.Df,"Favored",1),J.a(P.Zm.value.Df,"Conflict",1))}Oco(P){const T=P.Ng.value,U=this.T0d;if(!T.YW)return!0;let X=!0;T.vna.forEach((Y,ca)=>{if(!ca.YW||P.yg.contains(Y))return!0;ca=U.J(Y);if(5===ca){const da=T.ku.Qc;n.a.instance.Wa(4018176,1,2,"TryPreProcessFavoredRevision: Failed for [ClassId: {0}] [Property: {1}] was different from the base revision, but has a [MergeStrategy: {2}].",da,Y,ca);P.Yo.logger.Pg(Object.assign(new S,
{Bn:this.Bn,KSc:da,R0d:Y,KUd:ca}));return X=!1}6===ca&&P.cOf.add(Y);return!0});return X}Wxk(P){P.Nk=P.Ng.value.Df.HG();const T=P.cOf,U=P.Nk;T&&T.forEach(X=>{U.removeProperty(v.a.yW(X));return!0});return!0}Fco(P){const T=P.Zm.value,U=T.ku.Qc,X=this.T0d;let Y=!0;T.vna.forEach((ca,da)=>{const ua=X.J(ca);Y=this.Gco(P,da,ca,ua);Y||(P.Nk=null,n.a.instance.Wa(4018177,1,4,"TryMergeProperty: Failed for [ClassId: {0}] [Property: {1}] [MergeStrategy: {2}].",U,ca,ua),P.Yo.logger.Pg(Object.assign(new S,{Bn:this.Bn,
KSc:U,R0d:ca,KUd:ua})));return Y});return Y}Gco(P,T,U,X){const Y=P.Nk;if(!T.YW&&8!==X||2===X||7===X||P.yg.contains(U))return!0;if(5===X)return!1;if(4===X||3===X){let ca;if(({value:ca}=P.Ng.value.vna.Dc(U)).returnValue&&ca.YW)return 4!==X;X=0}8===X&&(X=0);if(0===X){if(!T.isDeleted)return P=v.a.yW(U),(E.Fpo(T,U,P)||E.tUn())&&Y.Jva(P,T.newValue),!0;X=6}return 6===X?(Y.removeProperty(v.a.yW(U)),!0):1===X?this.aB(P,U):!1}zHm(P,T,U,X,Y,ca){P=P||new u.a;T=T||new u.a;U=U||new u.a;var da=String.format("TryMergePurelyAdditiveObjectIds: Expected [baseList.Length: {0}] to not exceed [favoredList.Length: {1}] or [conflictList.Length: {2}]",
P.length,T.length,U.length),ua=P.length<=T.length&&P.length<=U.length;this.xei()&&ua&&n.a.instance.Wa(541181455,1,1,da);if(!ua&&this.Fci(ca.runtime.Qb))return null;if(this.xei())for(da=0;da<P.length;da++){ua=P.lg(da);var ra=T.lg(da);let qa=U.lg(da);ua=String.format("TryMergePurelyAdditiveObjectIds: Expected [baseVal: {0}] [favoredVal: {1}] and [conflictVal: {2}] [index: {3}] [baseList.Count {4}] to all be the same.",ua,ra,qa,da,P.length);n.a.instance.Wa(541181457,1,1,ua)}if(this.Fci(ca.runtime.Qb))for(ca=
0;ca<P.length;ca++)if(da=P.lg(ca),ua=T.lg(ca),ra=U.lg(ca),!X(da,ua)||!X(da,ra))return null;P=P.x3();X=new t.a;ca=P.length;for(da=ca;da<T.length;da++)ua=T.lg(da),P.add(ua),X.add(ua);for(;ca<U.length;ca++)T=U.lg(ca),X.contains(T)?n.a.instance.Wa(4018180,1,5,"MergePurelyAdditiveLists: Both favored and conflict lists contained a reference to {0}. Only adding one copy of it.",T):(P.add(T),Y(T));return P}xei(){return!!y.AFrameworkApplication.K&&y.AFrameworkApplication.K.$("LogMPALErrors")}Fci(P){if(!P)return!1;
P.Jjf(1000008);return P.oBb(1000008)}Hkm(P){if(!P)return!1;P.Jjf(1000009);return P.oBb(1000009)}Yqi(P,T,U,X){return H.a(P,T,U,X)}PCa(P,T,U){P=P||new u.a;T=T||new u.a;U=U||new u.a;const X=P.cG(),Y=T.cG(),ca=U.cG();P=E.filter(P,da=>Y.contains(da)&&ca.contains(da));P.cG();P.EA(P.length,E.filter(T,da=>!X.contains(da)));P.EA(P.length,E.filter(U,da=>!X.contains(da)&&!Y.contains(da)));return P}sHm(P,T){const U=v.a.yW(T),X=P.$d;var Y=X.getPropertyObjectIds(P.Ng.value.ku,U),ca=X.getPropertyObjectIds(P.Ng.value.Df,
U);const da=X.getPropertyObjectIds(P.Zm.value.Df,U);Y=this.PCa(Y,ca,da);ca=P.Nk;0<Y.length?X.setPropertyObjectIds(ca,U,Y):ca.removeProperty(U);P.yg.add(T)}pbb(P,T,U){P.hasProperty(U)?T.Jva(U,P.$P(U)):T.removeProperty(U)}Ztn(P,T){var U=T.Mj();for(const X of U)T.removeProperty(X);U=P.Mj();for(const X of U)T.Jva(X,P.$P(X))}$uf(P,T,U,X,Y){T=P.getPropertyInt32(T,Y);U=P.getPropertyInt32(U,Y);U=null!=T&&null!=U?Math.max(T,U):null!=U?U:null!=T?T:null;null!=U?P.setPropertyInt32(X,Y,U):X.removeProperty(Y)}tWe(P,
T,U,X,Y,ca){T=P(T,Y);U=P(U,Y);P=P(X,Y);X=T.cG();let da=!1;ca&&(da=ca(T,U,P));da?(ca=!0,X=!1):(ca=X.Dqh(U),X=X.Dqh(P));n.a.instance.Wa(588011013,1,4,"CheckForMaterialDifferences: Property:{0}, [BaseValue: {1}, FavoredValue: {2}, ConflictingValue: {3}][isFavoredEquivalentToBase:{4}, isConflictEquivalentToBase:{5}]",v.a.yb(Y),T.Dq(),U.Dq(),P.Dq(),ca,X);return{MBc:P,g_a:ca,b_a:X}}Ttk(P,T,U,X,Y){let ca;T=P(T,Y);U=P(U,Y);P=P(X,Y);X=this.yhi(T,U);ca=this.yhi(T,P);n.a.instance.Wa(588011014,1,4,"CheckForMaterialDifferencesInDictionaryProperty: Property:{0}, [BaseValue: {1}, FavoredValue: {2}, ConflictingValue: {3}][isFavoredEquivalentToBase:{4}, isConflictEquivalentToBase:{5}]",
v.a.yb(Y),T.Dq(),U.Dq(),P.Dq(),X,ca);return{MBc:P,g_a:X,b_a:ca}}yhi(P,T){if(!P&&!T)return!0;if(!P||!T)return!1;if(!P.count&&!T.count)return!0;let U=!1;T.forEach((X,Y)=>U=P.xb(X)&&Y==P.J(X));return U}nk(){let P;P=this.Hkm(this.Ac)?E.WKj.value:E.VKj.value;const T=new B.a(0);for(let U=0;U<P.length;U++)T.Z(P[U],7);return T}static Nda(){return new E}static get instance(){return E._instance.value}static tUn(){return G.a.instance.Pa("Box4.IFeatureHelper").isFeatureEnabled(79)}static Fpo(P,T,U){if(void 0!==
P.newValue&&null!==P.newValue||O.a.efi(U.type))return!0;E.oym(P,T,U);return!1}static oym(P,T,U){U=U.type===O.a.string;T=String.format("TryMergeProperty: Failed to Merge Property [ID: {0}]",T);U||(T+=String.format(" [NewValue: {0}] [OldValue: {1}]",P.newValue,P.oldValue));n.a.instance.Wa(19145822,1,2,T)}static Uzf(P,T,U){const X=v.a.yb(U),Y=P.$d;var ca=Y.getPropertyObjectIds(P.Ng.value.ku,U);const da=Y.getPropertyObjectIds(P.Ng.value.Df,U);var ua=Y.getPropertyObjectIds(P.Zm.value.Df,U);ua=E.GOl(ua,
P.Yo.runtime.ffc);T=T.PCa(ca,da,ua);ca=P.Nk;0<T.length?Y.setPropertyObjectIds(ca,U,T):ca.removeProperty(U);P.yg.add(X);return!0}static GOl(P,T){const U=new u.a;P.forEach(X=>{T.contains(X,(Y,ca)=>Y.equals(ca))||U.add(X);return!0});return U}static filter(P,T){const U=new u.a;P.forEach(X=>{T(X)&&U.add(X);return!0});return U}static Vul(){return[v.a.yb(l.a.P6e),v.a.yb(l.a.lastModifiedTime),v.a.yb(l.a.sK),v.a.yb(l.a.VIb),v.a.yb(l.a.dVf),v.a.yb(e.a.ISc),v.a.yb(a.a.fwd),v.a.yb(a.a.bcb),v.a.yb(k.a.gUi)]}static Wul(){return[v.a.yb(l.a.P6e),
v.a.yb(l.a.lastModifiedTime),v.a.yb(l.a.sK),v.a.yb(l.a.VIb),v.a.yb(l.a.dVf),v.a.yb(e.a.ISc),v.a.yb(a.a.fwd),v.a.yb(k.a.gUi)]}}E._instance=new K.a(E.Nda);E.VKj=new K.a(E.Vul);E.WKj=new K.a(E.Wul);Object(C.a)(E,"GraphNodeComplexMerge",null,[1833])},1467:function(C,N,d){d.r(N);C=d(0);var l=d(120),e=d(1486),a=d(1473),k=d(1593),n=d(1594);class v{constructor(t,y){this.P7a=!1;this.Bfa=null;if(!t)throw Error.argumentNull("annotations");if(!t.$7b(y))throw Error.argument("structTypeID","Invalid struct type ID");
this.Ov=t;this.h9b=this.Ov.gVh(y);this.zWj=y}get vXb(){return this.Ov}get isReadOnly(){return this.P7a}get TPa(){return this.zWj}Edb(t){if(0>t||t>=this.h9b)throw Error.argument("iField","Invalid field index");return this.Bfa&&null!=this.Bfa[t]?this.Bfa[t]:this.Ov.EZh(this.TPa,t)}WXf(t,y){if(this.isReadOnly)throw Error.invalidOperation("Attempt to set annotation on read-only StructValue");if(0>t||t>=this.h9b)throw Error.argument("iField","Invalid field index");if(!this.Ov.R6b(this.Ov.YAb(this.TPa,
t),y))throw Error.argument("value","Value is not of the correct type for the specified field");(this.Bfa||(this.Bfa=Array(this.h9b)))[t]=y}Hba(){const {Annotations:t}=d(1467);let y="[";if(this.Bfa){let B=!0;for(let G=0;G<this.h9b;++G){if(null==this.Bfa[G])continue;const F=this.Ov.YAb(this.TPa,G);if(t.vmb(F,this.Bfa[G],this.Ov.EZh(this.TPa,G)))continue;B?B=!1:y+=", ";y+=this.Ov.FZh(this.TPa,G);y+="=";const K=this.Ov.Hba(F,this.Bfa[G]);F===t.N7?(y+='"',y+=e.a.I7e(K),y+='"'):y+=K}}return y+"]"}isEqual(t){const {Annotations:y}=
d(1467);if(this===t)return!0;if(!t||this.Ov!==t.vXb||this.TPa!==t.TPa)return!1;for(let B=0;B<this.h9b;++B)if(!y.vmb(this.Ov.YAb(this.TPa,B),this.Edb(B),t.Edb(B)))return!1;return!0}clone(){const t=new v(this.Ov,this.TPa);this.Bfa&&(t.Bfa=Array.clone(this.Bfa));return t}wS(){return this.isReadOnly?this.clone():this}kxf(){const {Annotations:t}=d(1467);if(!this.isReadOnly&&(this.P7a=!0,this.Bfa))for(let y=0;y<this.h9b;++y){const B=this.Bfa[y];null!=B&&t.SEb(B)}}toString(){return this.Hba()}}Object(C.a)(v,
"StructValue",null,[1252,1250]);d.d(N,"Annotations",function(){return u});class u{constructor(t,y){if(!t)throw Error.argumentNull("initData");if(!y)throw Error.argumentNull("objectFetcher");this.bDm=y.a_k;let B=0;var G=y.qdb(t.J(B));++B;this.Pyf=new k.a(new n.a(G));this.FCj=t.J(B);++B;this.Coi=Array(this.kBd);this.xRc=Array(this.kBd);this.phb=Array(this.kBd);for(G=0;G<this.kBd;++G){this.Coi[G]=y.nE(t.J(B));++B;this.xRc[G]=t.J(B);++B;var F=t.J(B);++B;this.phb[G]=Array(F);for(var K=0;K<F;++K)this.phb[G][K]=
y.nE(t.J(B)),++B}this.yWj=t.J(B);++B;this.jpi=Array(this.p1c);this.aUd=Array(this.p1c);this.bUd=Array(this.p1c);this.$Td=Array(this.p1c);for(G=0;G<this.p1c;++G)for(this.jpi[G]=y.nE(t.J(B)),++B,F=t.J(B),++B,this.aUd[G]=Array(F),this.bUd[G]=Array(F),this.$Td[G]=Array(F),K=0;K<F;++K)this.aUd[G][K]=y.nE(t.J(B)),++B,this.bUd[G][K]=t.J(B),++B,this.$Td[G][K]=({Rea:B}=this.pKa(this.bUd[G][K],t,B,null,null,null)).returnValue,u.SEb(this.$Td[G][K]);this.wwj=t.J(B);++B;this.tyf=Array(this.UXb);this.uyf=Array(this.UXb);
this.syf=Array(this.UXb);for(G=0;G<this.UXb;++G)this.tyf[G]=y.nE(t.J(B)),++B,this.uyf[G]=t.J(B),++B,this.syf[G]=({Rea:B}=this.pKa(this.uyf[G],t,B,null,null,null)).returnValue,u.SEb(this.syf[G])}mHc(t){for(let y=0;y<this.UXb;++y)if(this.tyf[y]===t)return y;return-1}sMh(t){if(!this.X7b(t))throw Error.argument("attrID","Invalid attribute ID");return this.tyf[t]}getAttributeType(t){if(!this.X7b(t))throw Error.argument("attrID","Invalid attribute ID");return this.uyf[t]}YAb(t,y){if(!this.$7b(t))throw Error.argument("structTypeID",
"Invalid struct type ID");t=this.bUd[u.q1c(t)];if(0>y||y>=t.length)throw Error.argument("iField","Invalid field index");return t[y]}Hba(t,y){if(!this.wuf(t))throw Error.argument("typeID","Invalid type ID");if(!this.R6b(t,y))throw Error.argument("value","Value is not of the correct type");switch(t){case u.N7:return y;case u.ewa:return y?"True":"False";case u.eFa:case u.voa:return y.toString();case u.EU:return y.Hba();default:if(!u.uH(t)&&u.l3c(t)){t=u.A7e(t);const F=this.phb[t].length;switch(this.xRc[t]){case 0:return this.phb[t][y];
case 1:if(y){var B="";for(var G=1;G<F;++G)y&1<<G-1&&(0<B.length&&(B+=" & "),B+=this.phb[t][G]);return B}return this.phb[t][0];case 2:B="";for(G=0;G<F;++G)y&1<<G&&(0<B.length&&(B+=" & "),B+=this.phb[t][G]);return B;default:throw Error.invalidOperation("Unrecognized enum type flavor "+this.xRc[t]);}}else return y.Hba()}}wuf(t){switch(t){case u.N7:case u.ewa:case u.eFa:case u.voa:case u.EU:return!0;default:return u.uH(t)?this.wuf(u.zYa(t)):u.l3c(t)?this.Rmm(t):this.$7b(t)}}Rmm(t){t=u.A7e(t);return 0<=
t&&t<this.Coi.length}$7b(t){t=u.q1c(t);return 0<=t&&t<this.jpi.length}X7b(t){return 0<=t&&t<this.UXb}R6b(t,y){if(null==y)return!1;switch(t){case u.N7:return"string"===typeof y;case u.ewa:return"boolean"===typeof y;case u.eFa:return"number"===typeof y;case u.voa:return"number"===typeof y;case u.EU:return Object(l.a)(1249,y);default:if(u.uH(t))return Object(l.a)(1251,y)&&y.O2===u.zYa(t);if(u.l3c(t)){if("number"!==typeof y)return!1;t=u.A7e(t);const B=this.phb[t].length;switch(this.xRc[t]){case 0:return 0<=
y&&y<B;case 1:return!(y&-1<<B-1);case 2:return!!y&&!(y&-1<<B);default:throw Error.invalidOperation("Unrecognized enum type flavor "+this.xRc[t]);}}else return Object(l.a)(1252,y)&&y.TPa===t}}get UXb(){return this.wwj}get kBd(){return this.FCj}get p1c(){return this.yWj}Gil(t){if(!this.X7b(t))throw Error.argument("attrID","Invalid attribute ID");return this.syf[t]}gVh(t){if(!this.$7b(t))throw Error.argument("structTypeID","Invalid struct type ID");return this.aUd[u.q1c(t)].length}FZh(t,y){if(!this.$7b(t))throw Error.argument("structTypeID",
"Invalid struct type ID");return this.aUd[u.q1c(t)][y]}EZh(t,y){if(!this.$7b(t))throw Error.argument("structTypeID","Invalid struct type ID");t=this.$Td[u.q1c(t)];if(0>y||y>=t.length)throw Error.argument("iField","Invalid field index");return t[y]}pKa(t,y,B,G,F,K){if(!y)throw Error.argumentNull("initData");if(u.uH(t)){var O=y.J(B);++B;t=u.zYa(t);var H=new a.a(this,t);for(var I=0;I<O;++I)Array.add(H.items,({Rea:B}=this.pKa(t,y,B,G,F,K)).returnValue);return{returnValue:H,Rea:B}}switch(t){case u.N7:return{returnValue:(G||
this.Pyf).nE(y.J(B++)),Rea:B};case u.ewa:return{returnValue:1===y.J(B++),Rea:B};case u.eFa:return{returnValue:y.J(B++),Rea:B};case u.voa:return{returnValue:(F||this.bDm)[y.J(B++)],Rea:B};case u.EU:t=y.J(B++);O=new e.a(this);for(H=0;H<t;++H)I=y.J(B),++B,K&&(I=K[I]),O.hy(I,({Rea:B}=this.pKa(this.getAttributeType(I),y,B,G,F,K)).returnValue);return{returnValue:O,Rea:B};default:if(u.l3c(t))return{returnValue:y.J(B++),Rea:B};if(u.Hej(t)){O=y.J(B++);H=new v(this,t);for(I=0;I<O;++I){const J=y.J(B);++B;H.WXf(J,
({Rea:B}=this.pKa(this.YAb(t,J),y,B,G,F,K)).returnValue)}return{returnValue:H,Rea:B}}throw Error.argument("typeID","Invalid type ID");}}static l3c(t){return 16<=(t&16383)&&16384!==(t&16384)&&32768!==(t&32768)}static Hej(t){return 16<=(t&16383)&&16384===(t&16384)&&32768!==(t&32768)}static uH(t){return 32768===(t&32768)}static iyl(t){if(u.uH(t))throw Error.argument("nonListTypeID","Non-list type ID required");return t|32768}static zYa(t){if(!u.uH(t))throw Error.argument("listTypeID","List type ID required");
return t&-32769}static vmb(t,y,B){switch(t){case u.N7:case u.ewa:case u.eFa:case u.voa:return y===B;case u.EU:return y.isEqual(B);default:return u.uH(t)?y.isEqual(B):u.l3c(t)?y===B:y.isEqual(B)}}static SEb(t){Object(l.a)(1250,t)&&t.kxf()}static wS(t){return Object(l.a)(1250,t)?t.wS():t}static A7e(t){return t-16}static q1c(t){return(t&-16385)-16}}u.N7=1;u.ewa=2;u.eFa=3;u.voa=5;u.EU=9;Object(C.a)(u,"Annotations",null,[1253])},1470:function(C,N,d){C=d(0);var l=d(282);class e{constructor(){this.userId=
this.email=this.displayName=null}}Object(C.a)(e,"InsertMentionParameters",null,[]);class a{constructor(){this.neighborhood=null;this.mentionLength=this.mentionStart=0}}Object(C.a)(a,"InsightsParameters",null,[]);var k=d(1671),n=d(1672),v=d(1673),u=d(1674),t=d(2),y=d(1516),B=d(1527),G=d(35),F=d(15),K=d(16),O=d(28);d.d(N,"a",function(){return H});class H{static get tof(){return"Insights_16x16x32"}static get D9k(){return"Find_16x16x32"}static get sDi(){return"-Parameterized"}static get q1f(){return"Parameterized"}static get Vbe(){return"bTryQuery"}static get b7f(){return"TellMeSuggestion_"}static get hej(){return"bTryQueryAlternate"}static get G4f(){return"MenuTellMe"}static get P3m(){const I=
{},J=[];Array.add(J,{Term:{PeopleType:"Person"}});I.And=J;return I}static g1e(I){return I+H.sDi}static getParameter(I){let J="",L="";if(I)for(let S=0;S<I.RGh;++S)"Type"===I.Rdf(S)?J=I.getValue(S):"Value"===I.Rdf(S)&&(L=I.getValue(S));return new l.a(J,L)}static Axb(I){I=Object.assign(new a,{neighborhood:I,mentionStart:0,mentionLength:I.length});return G.c(I)}static mvh(I,J,L){I=Object.assign(new e,{displayName:I,email:J,userId:L});return G.c(I)}static MWa(I,J,L=null){I=Object.assign(new B.a,{neighborhood:I,
mentionStart:0,mentionLength:I?I.length:0});J=Object.assign(new y.a,{selection:I,userIntent:null,entryPoint:J,launchData:L});return G.c(J)}static qyn(I,J){return H.MWa(I,H.ryn(J))}static ryn(I){switch(I){case "Answer":return 3;case "Definition":return 2;case "DocFindResult":return 15;case "Entity":return 16;case "InsightsResult":return 1;default:return 0}}static hdi(){return!!t.AFrameworkApplication.K&&t.AFrameworkApplication.K.$("IsGoLocalEnvironment")}static JDb(){const I=t.AFrameworkApplication.K?
t.AFrameworkApplication.K.lb("SovereignEnvironmentName"):null;return!!I&&0<I.length}static isEnterpriseUser(){const I=t.AFrameworkApplication.K?t.AFrameworkApplication.K.lb("HostAuthType"):null;return!!I&&"aad"===I.toLowerCase()||"external"===I&&H.cqf()}static l_f(I){return I.o7n&&!H.JDb()}static Tgi(){const I=t.AFrameworkApplication.K?t.AFrameworkApplication.K.lb("UiHostIntegrationType"):"";return!!t.AFrameworkApplication.K&&"UnifiedUiHostTeams"===I&&t.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.UnifiedAppsShowSearchInHeader",
!1)}static k_f(I){return I.jQa&&I.N7k&&(I.$1c||I.Y1c||I.Bgb)&&!H.Tgi()&&H.isEnterpriseUser()&&!H.JDb()}static xCa(){return t.AFrameworkApplication.K?t.AFrameworkApplication.g3a||t.AFrameworkApplication.K.$("SmartLookupEnableNativePane"):t.AFrameworkApplication.g3a}static ZW(I){return!I||H.uhi(I.Fg)}static uhi(I){return!I||!I.trim().length}static F6f(I){if(!I)return 0;const J=Math.pow(10,5);return Math.round(I*J)/J}static r9n(){var I=new Date;return I?new Date(I.getUTCFullYear(),I.getUTCMonth(),I.getUTCDate(),
I.getUTCHours(),I.getUTCMinutes(),I.getUTCSeconds(),I.getUTCMilliseconds()):null}static Kif(I){I=new Date(I);return(H.r9n().getTime()-I.getTime())/1E3}static cii(I){const {InsightsMenuItemFactory:J}=d(1670);switch(I){case k.a.elf:case n.a.yIh:case J.t9h:case v.a.Vti:case "FindParameterized":case "FindWithMatchesParameterized":case "AnswerForSearch":case "AnswerForSearchSingleLine":case "WolframForSearch":case "LearningForSearch":case "ImageForSearch":case "TellMeFeedback":case "TemplateForSearch":case "LaunchAddinDialogFromTellMe":return!0}return I.startsWith(H.Vbe)||
I.startsWith(H.b7f)||I.startsWith(H.hej)||I.startsWith("PeopleSuggestion")||I.startsWith("FileSuggestion")||I.startsWith("FindInDocumentSuggestion")||I.startsWith("NotesSuggestion")||I.startsWith("OnenoteNotesSuggestion")||I.startsWith("SmartLookupFromTellMe")||I.startsWith("GetHelpFromTellMe")||I.startsWith("GetHelpWithDescriptionFromTellMe")||I.startsWith("AddinSuggestion")||I.startsWith("OfficeScripts")?!0:!1}static kef(I,J){const L=[];Array.add(L,new u.a(400,I));Array.add(L,new u.a(200,J));I=
{};I.parts=L;return JSON.stringify(I)}static odb(I){const J=I.indexOf("<b0>"),L=I.lastIndexOf("</b0>"),S=[];Array.add(S,new u.a(400,I.substring(0,J)));Array.add(S,new u.a(600,I.substring(J+4,L)));Array.add(S,new u.a(400,I.substring(L+5,I.length)));I={};I.parts=S;return JSON.stringify(I)}static a0h(I){const J=H.Kif(I);return 60>J?CommonUIStrings.l_TimeSince_SecsAgo:3600>J?String.format(CommonUIStrings.l_TimeSince_MinsAgo,Math.floor(J/60).toString()):86400>J?String.format(CommonUIStrings.l_TimeSince_HoursAgo,
Math.floor(J/3600).toString()):172800>J?CommonUIStrings.l_TimeSince_Yesterday:String.format(CommonUIStrings.l_TimeSince_Date,(new Date(I)).localeFormat("MMMM dd, yyyy"))}static Xll(I){const J=Array(I.length);for(let L=0;L<I.length;L++)J[L]=I[L].commandId;return J}static cqf(){if("Dev Box"===t.AFrameworkApplication.K.lb("StatusBarEnvironmentNameToUse"))return!0;let I=t.AFrameworkApplication.K.lb("UserPrincipalName");I=O.c(I)?"":K.a.mh(I);const J=t.AFrameworkApplication.K.yu("TellMeIntEnabledForFeatureCrew")?
t.AFrameworkApplication.K.KB("TellMeIntEnabledForFeatureCrew"):[];return 0<=Array.indexOf(J,I)&&"inner"===t.AFrameworkApplication.K.lb("Microsoft365Ring")}static Rul(I){switch(I.toLowerCase()){case "pptx":case "ppt":case "pot":case "ppa":case "pps":case "pptm":case "odp":case "ppsx":case "ppsm":case "potx":case "potm":return"SaveAsPowerPointPotx_20";case "docx":case "doc":case "docm":case "dot":case "dotx":case "odt":case "dotm":return"SaveAsWordDocx_20";case "xlsx":case "xls":case "xlb":case "xlc":case "xlsb":case "xlsm":case "xlt":case "odc":case "ods":return"SaveAsExcelXlsx_20";
case "pdf":return"PdfFile_32";case "one":case "onepkg":return"OneNote_32";case "vsd":case "vsdx":case "vss":case "vst":case "vdx":case "vtx":case "vsx":case "vstx":case "vssm":case "vdw":case "vsdm":case "vssx":case "vstm":case "vsw":return"Visio_32"}return""}static S$(){return F.a.v2&&!F.a.rp}}H.ibe=9E5;Object(C.a)(H,"TellMeUtils",null,[])},1471:function(C,N,d){d.r(N);C=d(0);var l=d(44),e=d(120),a=d(72),k=d(1604),n=d(221);class v{constructor(jb,Zb,Eb,tc,lc,Lc){this.groupType=jb;this.resultType=Zb;
this.$2f=Eb;this.l6=tc;this.N4e=lc;this.resultIndex=Lc}}Object(C.a)(v,"ClickLoggingInfo",null,[]);const u=jb=>{const Zb=[];for(;jb;)Array.add(Zb,"{ContextId:"+jb.contextId+", IsGraphNodeContext:"+jb.vl+"}"),jb=jb.vk;Zb.reverse();return"{"+Zb.join(", ")+"}"};class t{constructor(){this.Rla=this.sessionId=null}}Object(C.a)(t,"CorrelationRecord",null,[1104]);var y=d(1492);class B{constructor(jb,Zb){this.Id=null;this.TimeStamp=0;this.Id=jb;this.TimeStamp=Zb}}Object(C.a)(B,"MRUControl",null,[]);var G=d(1595),
F=d(1591),K=d(1470),O=d(2),H=d(1360);class I{constructor(jb,Zb){this.jMj=10;this.V4=[];this.Qxa=[];this.yLg=this.xLg=!1;this.Wrc=this.Vrc="";this.zSb=Zb;this.qc=jb;this.rMg=jb.fq}LHc(){!this.xLg&&this.rMg&&this.qc&&F.a.Cei()&&(this.Vrc="58F514FD-AA7A-4A06-BF46-85FF3444BEA4-"+this.qc.application,this.V4=this.hNh(),this.xLg=!0);return this.V4}CFl(){!this.yLg&&this.rMg&&this.qc&&F.a.Cei()&&(this.Wrc="21E7F47B-086F-41D1-9E5D-8A9FD31A7C4B-"+this.qc.application,this.Qxa=this.hNh(!0),this.yLg=!0);return this.Qxa}Slm(jb){return jb.startsWith("TellMeUpsell")||
"OpenInClientUpsell"===jb||"TryOfficeUpsell"===jb}Jpf(jb){return this.x9l(jb)||this.Slm(jb)||K.a.cii(jb)?!1:!0}Pya(jb){jb=jb.ControlId;this.Jpf(jb)&&(jb=this.BSf(jb),this.iqn(jb),this.TDm(),Array.insert(this.V4,0,new B(jb,Date.now())),this.Vrc.length&&(jb=JSON.stringify(this.V4),H.a.instance.setItem(this.Vrc,jb)))}TH(jb){this.SDm();Array.insert(this.Qxa,0,new B(G.a[jb],Date.now()));this.Wrc.length&&(jb=JSON.stringify(this.Qxa),H.a.instance.setItem(this.Wrc,jb))}hNh(jb=!1){if(!this.V4.length){var Zb=
jb?H.a.instance.getItem(this.Wrc):H.a.instance.getItem(this.Vrc);if(!Zb||""===Zb)return jb?this.Qxa:this.V4;let Eb=null;try{Eb=JSON.parse(Zb)}catch(tc){this.cwk(jb),Eb=null}if(!Eb||!Eb.length||10<Eb.length)return jb?this.Qxa:this.V4;Zb=0;for(const tc of Eb)if(jb||this.qc.PQd(tc.Id)&&this.Jpf(tc.Id))if(jb?Array.insert(this.Qxa,Zb++,tc):Array.insert(this.V4,Zb++,tc),Zb===this.zSb)break}return jb?this.Qxa:this.V4}YYe(jb){jb=this.BSf(jb);for(const Zb of this.V4)if(Zb.Id===jb)return!0;return!1}cwk(jb=
!1){H.a.instance.setItem(jb?this.Wrc:this.Vrc,"")}Iam(jb){jb=this.BSf(jb.ControlId);return this.Jpf(jb)?this.YYe(jb):!1}iqn(jb){if(0<this.V4.length){let Zb=0;for(const Eb of this.V4){if(Eb.Id===jb){Array.removeAt(this.V4,Zb);break}Zb++}}}BSf(jb){return"Excel"===this.qc.application&&jb.startsWith("m_excelWebRenderer_ewaCtl_")?jb.substr(26,jb.length):jb}TDm(){this.V4.length===this.zSb&&Array.removeAt(this.V4,this.V4.length-1)}SDm(){this.Qxa.length===this.jMj&&Array.removeAt(this.Qxa,this.Qxa.length-
1)}x9l(jb){jb=jb.split("|");let Zb="";if(6<=jb.length)Zb=jb[0];else if(3<=jb.length){if("3"===jb[0])return!0;Zb=jb[1]}return Zb.startsWith("WA")}static createInstance(jb){let Zb=3;O.AFrameworkApplication.K&&(Zb=O.AFrameworkApplication.K.rc("TellMeMaxRecommendedResultsToReturn",3));return new I(jb,Zb)}}Object(C.a)(I,"MruControlsManager",null,[1102]);class J{constructor(jb){this.jsb=jb}Qda(jb,Zb){let Eb;return jb.$B&&(Eb=this.jsb[jb.value])?Eb.Qda(jb,Zb):(Eb=this.gOh(jb.value))?Eb.Qda(Eb.nJm,Zb):null}sDl(jb,
Zb){if(jb=this.jsb[jb])for(const Eb of Zb)if(Zb=K.a.getParameter(Eb),Zb.key===jb.xKf)return Zb.value;return null}JMm(jb){(jb=this.gOh(jb))&&jb.GMm()}gOh(jb){const Zb=jb.indexOf(K.a.sDi);return 0<Zb?this.jsb[jb.substring(0,Zb)]:null}}Object(C.a)(J,"ParameterizedCommandManager",null,[1101]);var L=d(1501);class S{constructor(jb,Zb){this.Fg=jb;this.jjb=Zb}}Object(C.a)(S,"TellMeQuery",null,[]);var E=d(1592);class P{constructor(jb,Zb){this.Id=null;this.TimeElapsedSinceClick=0;this.Id=jb;this.TimeElapsedSinceClick=
Zb}}Object(C.a)(P,"CommandClickedEvent",null,[]);var T=d(28);class U{constructor(jb,Zb){this.BOj=jb;this.zqa=Zb}resultsUpdated(jb){this.BOj(T.c(jb.query)?"":jb.query.Fg,jb.Un,jb.attributes,this.zqa,jb.l7b)}}Object(C.a)(U,"ResultsUpdatedCallback",null,[1100]);var X=d(76);class Y{constructor(jb,Zb){this.menuModel=jb;this.lSi=Zb}}Object(C.a)(Y,"GeneratedMenuModel",null,[]);class ca{constructor(){this.ariaLabel=this.sections=this.title=null;this.shouldAutoOpen=!1;this.ariaRoleDescription=null}}Object(C.a)(ca,
"MenuModel",null,[]);class da{constructor(jb,Zb,Eb){this.qc=jb;this.jsb=Zb;this.Wca=Eb}Ufl(jb,Zb,Eb){const {TellMeActor:tc}=d(1471);let lc=0;const Lc=new ca,Bb=[];let jc="";Lc.sections=[];let dc=new X.a;const nb=!!this.qc&&this.qc.L_a;var Gb=!!this.qc&&this.qc.Kkb||O.AFrameworkApplication.ua.Sb.Kkb;for(const Kb of jb){jb=0;nb||(dc=new X.a);const Vb=new X.a;let vc=Kb.displayName;for(const Fc of Kb.results){if(0<=Fc.value.indexOf(K.a.q1f)){if(Fc.$B){var lb=this.jsb[Fc.value];if(lb&&Fc.value.endsWith(K.a.q1f)){if("FindParameterized"!==
Fc.value&&!Gb){const Zc=[];Zc.push(appChrome.actions.setControlLabel(Fc.value,lb.uGd(Fc)));Zc.push(appChrome.actions.setButtonCommandValueId(Fc.value,lb.jcf(Fc)));appChrome.api.dispatch(Zc)}lb=Fc.value.replace(K.a.q1f,"");dc.remove(lb)?jb--:Vb.add(lb);dc.add(Fc.value);jb++}}}else switch(Fc.type){case 5:Vb.contains(Fc.value)||(dc.add(Fc.value),jb++);break;case 7:dc.add(Fc.$B);jb++;break;case 10:case 4:case 8:case 0:case 9:case 1:case 2:case 3:case 11:case 12:case 22:case 23:case 24:case 6:case 19:case 20:case 21:case 25:case 27:case 26:dc.add(Fc.value),
jb++}13===Kb.groupType&&(vc=K.a.xCa()?0<Zb.length?String.format(CommonUIStrings.l_SeeMoreResultsButtonText,Zb):CommonUIStrings.l_SeeMoreResultsButtonTextNonParameteried:String.format(CommonUIStrings.l_InsightsButtonText,Zb));21===Kb.groupType&&(vc=CommonUIStrings.l_LearningUILiveText)}lc+=jb;""!==vc&&0<jb&&(jc+=" , "+jb.toString()+" "+CommonUIStrings.l_TellMeSectionLiveNotification+" "+vc+" , ");0<dc.count&&!nb&&(jb=appChrome.api.menuSection(dc.toArray(),Kb.displayName,null,L.a[Kb.groupType]),Bb.push(jb))}Gb=
null;0<lc&&(Gb=0<Zb.length?1!==lc?String.format(CommonUIStrings.l_SearchLiveNotificationForTermedQueryResults,lc,Zb):String.format(CommonUIStrings.l_SearchLiveNotificationForTermedQueryResult,Zb):1!==lc?String.format(CommonUIStrings.l_LookupLiveNotificationResultPluralFormText,lc):CommonUIStrings.l_LookupLiveNotificationResultSingularFormText,nb?(Zb=appChrome.api.menuSection(dc.toArray(),"",null,null),Bb.push(Zb)):Gb+=jc);Eb&&(this.qc.qBa?tc.instance.actions.push(appChrome.actions.updateTellMeAriaLiveRegionText(Gb)):
appChrome.api.dispatch(appChrome.actions.updateTellMeAriaLiveRegionText(Gb)));Lc.sections=Bb;return new Y(Lc,lc,[])}static get x6e(){return da.UCg||(da.UCg=new Y(Object.assign(new ca,{sections:[]}),0,[]))}}da.UCg=null;Object(C.a)(da,"TellMeMenuDefintionGenerator",null,[]);var ua;(function(jb){jb[jb.TellMeControlActivated=0]="TellMeControlActivated";jb[jb.TellMeQueryExecuted=1]="TellMeQueryExecuted";jb[jb.TellMeResultsRendered=2]="TellMeResultsRendered";jb[jb.TellMeControlDeactivated=3]="TellMeControlDeactivated"})(ua||
(ua={}));Object(C.b)("PerformanceMarker",ua);var ra;(function(jb){jb[jb.TellMeTimeToRender=0]="TellMeTimeToRender";jb[jb.TellMeSessionLength=1]="TellMeSessionLength";jb[jb.TellMeResultTriageTime=2]="TellMeResultTriageTime"})(ra||(ra={}));Object(C.b)("PerformanceMeasure",ra);class qa{mark(jb){window.performance.mark(ua[jb])}measure(jb,Zb,Eb){const {TellMeActor:tc}=d(1471);try{window.performance.measure(ra[jb],ua[Zb],ua[Eb])}catch(lc){tc.instance.Ze.onError("TellMePerformance:Measure","error measuring "+
ra[jb])}}Gxf(jb,Zb,Eb){const {TellMeActor:tc}=d(1471);tc.instance.Ze.Qxf(Zb,Eb,jb,this.Ryl(jb))}Dwk(){var jb=[0,1,2,3];for(const Zb of jb)window.performance.clearMarks(ua[Zb])}clearMeasures(jb){for(const Zb of jb)window.performance.clearMeasures(ra[Zb])}Ryl(jb){let Zb=0;(jb=this.vhl(jb))&&0<jb.length&&(Zb=jb[jb.length-1].duration);return Zb}vhl(jb){return window.performance.getEntriesByName(ra[jb],"measure")}}Object(C.a)(qa,"TellMePerformance",null,[]);var ka=d(1534),la=d(1533),Ha=d(35);class wa{constructor(jb){this.yXj=
jb}CGb(jb,Zb,Eb){const {TellMeActor:tc}=d(1471);tc.instance.Ze.V6(Zb,la.a.Abc,jb.data.wf.toString(),Math.round(window.performance.now()-Eb),la.a.Abc,!0,ka.a.YLa);jb=Ha.b(jb.data.Ge);Zb=-1;jb.Index&&(Zb=jb.Index);tc.instance.Ze.CAm(Zb,this.yXj)}oGb(jb,Zb,Eb){const {TellMeActor:tc}=d(1471);tc.instance.Ze.V6(Zb,la.a.Abc,jb.data.wf.toString(),Math.round(window.performance.now()-Eb),la.a.Abc,!1,ka.a.YLa)}IFl(jb){if(jb&&""!==jb.trim()){const Eb=window.performance.now(),tc=O.AFrameworkApplication.X$i;var Zb=
{};Zb.Text=jb;Zb.IsFileHash="false";Zb=Ha.c(Zb);O.AFrameworkApplication.Xe.Lj(tc,2,Zb,{"Content-Type":"application/json",Accept:"application/json"},!1,0,lc=>{this.CGb(lc,jb.length,Eb)},lc=>{this.oGb(lc,jb.length,Eb)},null,null,!1,4E3,6E3)}}}Object(C.a)(wa,"TellMeQueryIndexCallback",null,[]);var Ca=d(1474);class Ja{constructor(jb,Zb,Eb){this.xml=jb;this.lSi=Zb;this.VXk=Eb}}Object(C.a)(Ja,"GeneratedMenuXml",null,[]);var bb=d(1671),ha=d(16);class ia{constructor(jb,Zb){this.M8c=jb||{};this.wTa=Zb}get KIb(){return 5}Qda(jb,
Zb=null){return this.wTa.Qda(jb,Zb)||this.Vkk(jb.value)}Vkk(jb){return ia.qUe(jb,this.M8c[jb]||null)}static qUe(jb,Zb=null){jb=String.format('<ClonedControl Id="{0}" ',jb);for(let lc in Zb){var Eb=lc,tc=Zb[lc];tc=tc?ha.a.If(tc.toString()):"";jb+=String.format('{0}="{1}" ',Eb,tc)}return jb+"/>"}}Object(C.a)(ia,"CommandMenuItemFactory",null,[967]);var va=d(236);class Ka{constructor(){this.zDj=CommonUIStrings.l_FindInDocumentText}get KIb(){return 8}Qda(jb){var Zb=jb.$B;jb=ha.a.If(jb.value);const Eb=
ha.a.If(Zb);Zb=ha.a.If(String.format(this.zDj,Zb));return this.jfl(jb,Eb,Zb)}jfl(jb,Zb,Eb){return va.a(jb,"1540292897",Eb,K.a.D9k,null,Zb,Eb,null,null)}}Object(C.a)(Ka,"FindInDocumentMenuItemFactory",null,[967]);var Xa=d(1672),xa=d(1670),Ma=d(1673);class Na{get KIb(){return 7}Qda(jb){const Zb=Object(a.a)(E.a,jb);return this.bgl(ha.a.If(jb.value),Zb.id)}bgl(jb,Zb){return va.a(Zb,"1404166600",jb,null,null,jb,jb,null,null)}}Object(C.a)(Na,"TryQueryMenuItemFactory",null,[967]);class pa{constructor(jb){this.z4=
[];this.qc=jb}vrl(jb){for(const Zb of this.z4)if(Zb.KIb===jb)return Zb;return null}ha(jb){this.z4.push(jb)}xkn(jb){this.ha(new ia(this.qc.$Ek,jb));this.ha(new Ma.a(this.qc.FLm));this.ha(new bb.a(this.qc.oDn,this.qc.nDn,this.qc.y7n,this.qc.OXl,this.qc.BTn));this.ha(new xa.InsightsMenuItemFactory);this.ha(new Ka);this.ha(new Xa.a);this.ha(new Na)}}Object(C.a)(pa,"MenuItemFactoryRegistry",null,[]);var Ra=d(1475);class Sa{constructor(jb,Zb){this.qc=jb;this.CQg=new pa(this.qc);this.CQg.xkn(Zb)}Vfl(jb,
Zb){let Eb=0;const tc=[],lc=[];for(const Bb of jb){jb=K.a.G4f;var Lc=[];for(const jc of Bb.results){const dc=this.CQg.vrl(jc.type).Qda(jc,Zb);jb=K.a.G4f;Lc.push(dc);if(13===jc.type||14===jc.type)jb="Menu32";17===jc.type&&(jb="MenuTellMeExtended");jc.groupType=Bb.groupType;lc.push(Object(a.a)(Ra.a,jc))}Eb=Eb?Eb:Lc.length;Lc=va.d("TellMeDropdownControls",Lc);jb=va.h("TellMeDropdownMenuSection",Lc,jb,Bb.displayName);tc.push(jb)}Zb=va.i(tc,"LookupDropdownMenu");return new Ja(Zb,Eb,lc)}static get CAd(){return Sa.VCg||
(Sa.VCg=new Ja(va.i([],"LookupDropdownMenu"),0,[]))}}Sa.VCg=null;Object(C.a)(Sa,"TellMeXmlGenerator",null,[]);class ab{}ab.cKm="MRU";ab.test="Test";Object(C.a)(ab,"ActionType",null,[]);var eb=d(1519),zb;(function(jb){jb[jb.Service=0]="Service";jb[jb.Local=1]="Local";jb[jb.MRU=2]="MRU";jb[jb.TestResult=3]="TestResult";jb[jb.Unknown=4]="Unknown"})(zb||(zb={}));Object(C.b)("SubResultType",zb);var Ua=d(77);class Ab{constructor(jb,Zb,Eb,tc,lc=null){this.CommandId=null;this.IsEnabled=!1;this.OptionalData=
this.SubResultType=this.ResultType=null;this.CommandId=jb;this.IsEnabled=Zb;this.ResultType=G.a[Eb];this.SubResultType=zb[tc];this.OptionalData=lc?Ua.a.toJSON(lc):null}}Object(C.a)(Ab,"ResultInfo",null,[]);var mb=d(103),Rb=d(137),hc=d(248);class Hb{constructor(jb,Zb=null){this.Ycd="TellMeWAC.";this.gQj=jb;this.wYj=Zb}iEa(jb,Zb,Eb){Zb=mb.a.PJ(Zb);jb=mb.a.b1e(jb,this.gQj,this.wYj,Eb,Zb);Rb.a.iEa(jb,this.Ycd)}hEa(jb,Zb,Eb=0){Zb=mb.a.PJ(Zb);Rb.a.hEa(Object.assign(new hc.a,{name:jb,dataFields:Zb,durationMs:Eb}),
this.Ycd)}}Object(C.a)(Hb,"TellMeOtelLogger",null,[1141]);var Ta=d(121);class Aa{constructor(jb,Zb,Eb,tc,lc,Lc,Bb){this.X4=this.Y8=this.Byg=null;this.tnb=jb;this.ROb=Zb;this.qIa=Eb;this.O7a=tc;this.MSa=lc;this.bKj=Lc;this.X4=Bb?Bb:new Hb(this.O7a?n.CuiHelper.p1f:n.CuiHelper.vae)}get fq(){return this.O7a}get Ana(){return this.qIa}m7d(jb){this.Byg=jb;switch(jb){case Ca.a.contextMenu:this.Y8=Ca.a.contextMenu;break;default:this.Y8=Ca.a.tellMe}}Lhk(jb,Zb){this.qIa.Rla||(this.qIa.Rla=Ta.a.create().toString(),
this.fmi(jb,!0,Zb))}xDh(jb,Zb=!0){this.qIa.Rla&&this.Pwm(jb,Zb);this.O7a&&appChrome.api.updateTellMeCorrelationId("");this.qIa.Rla=null}fmi(jb,Zb,Eb){const {TellMeActor:tc}=d(1471),lc=this.Q5(y.a.TZa);lc[eb.a.culture]=this.ROb;lc[eb.a.appName]=this.tnb;lc[eb.a.context]=jb;lc[eb.a.fQd]=this.MSa;lc[eb.a.Olm]=this.bKj;lc[eb.a.Akm]=Eb;lc[eb.a.Tem]=Zb;lc[eb.a.contentType]=tc.instance.nyd;this.X4.iEa(y.a.TZa,lc,this.Byg);this.O7a&&appChrome.api.updateTellMeCorrelationId(this.qIa.Rla)}Pwm(jb,Zb){const Eb=
this.Q5(y.a.zCb);Eb[eb.a.D_k]=jb;Eb[eb.a.Sem]=Zb;this.X4.hEa(y.a.zCb,Eb)}BAm(jb,Zb,Eb){let tc=0;!Eb&&0<jb.length&&(tc=jb.trim().split(" ").length);const lc=this.Q5(y.a.query);lc[eb.a.query]="!";lc[eb.a.MHb]=Zb;lc[eb.a.yIi]=jb.length;lc[eb.a.fji]=Eb;lc[eb.a.Quo]=tc;this.X4.iEa(y.a.query,lc,this.Y8)}wym(jb,Zb,Eb,tc,lc,Lc,Bb,jc=null){const dc=this.Q5(y.a.latency);dc[eb.a.culture]=this.ROb;dc[eb.a.yIi]=jb;dc[eb.a.Lej]=Zb;dc[eb.a.statusCode]=Eb;dc[eb.a.KGn]=lc;dc[eb.a.isSuccess]=Lc;dc[eb.a.Rpm]=Bb;jc&&
(dc[eb.a.P9n]=jc);this.X4.hEa(y.a.latency,dc,tc)}Qxf(jb,Zb,Eb,tc){const lc=this.Q5(y.a.performance);lc[eb.a.culture]=this.ROb;lc[eb.a.Phk]=ua[jb];lc[eb.a.O1k]=ua[Zb];lc[eb.a.f4m]=ra[Eb];this.X4.hEa(y.a.performance,lc,tc)}MAm(jb,Zb){var {TellMeActor:Eb}=d(1471);const {CommandResultsUtility:tc}=d(1508);if(jb.results.length){var lc=this.Q5(y.a.VPi);lc[eb.a.l6]=Zb.toString();lc[eb.a.groupType]=L.a[jb.groupType];16===jb.groupType&&(lc[eb.a.bkm]=Eb.instance.p4c);Zb=[];Eb=[];var Lc=[];for(const Bb of jb.results)lc[eb.a.resultType]||
(lc[eb.a.resultType]=G.a[Bb.type]),jb={},25===Bb.type&&(jb.AssetId=Bb.UH),Eb.push(tc.rNc(Bb.value)),Zb.push(Bb.value),Lc.push(new Ab(Bb.value,tc.rNc(Bb.value),Bb.type,Bb.b9i,jb));0<Zb.length&&(lc[eb.a.tyn]="{"+Zb.join(", ")+"}",lc[eb.a.t1k]="{"+Eb.join(", ")+"}",lc[eb.a.oyn]=Ha.c(Lc));this.X4.iEa(y.a.VPi,lc,this.Y8)}}Dgl(jb,Zb){if(4===jb)return ab.cKm;switch(Zb){case 5:case 16:case 17:case 18:return"Command";case 0:case 1:case 2:case 10:case 12:return"Insights";case 19:case 20:case 21:return"Notes"}return G.a[Zb]}owm(jb,
Zb,Eb,tc,lc){const Lc=this.Q5(y.a.click);Lc[eb.a.Lej]=jb;Lc[eb.a.j2m]=Zb;Lc[eb.a.commandId]=Eb;Lc[eb.a.zda]=tc;Lc[eb.a.actionType]=this.Dgl(lc.groupType,lc.resultType);Lc[eb.a.resultType]=G.a[lc.resultType];Lc[eb.a.$2f]=zb[lc.$2f];Lc[eb.a.groupType]=L.a[lc.groupType];Lc[eb.a.l6]=lc.l6.toString();Lc[eb.a.N4e]=lc.N4e.toString();Lc[eb.a.resultIndex]=lc.resultIndex.toString();this.X4.iEa(y.a.click,Lc,this.Y8)}uwm(jb,Zb){this.qIa.Rla||(this.qIa.Rla=Ta.a.create().toString(),this.fmi("",!1,Zb));Zb=this.Q5(y.a.qrh);
Zb[eb.a.MHb]=jb;this.X4.hEa(y.a.qrh,Zb)}zmi(jb,Zb,Eb){if(jb){if(Eb)for(let tc in Eb)jb[tc]=Eb[tc];this.X4.hEa(y.a.events,jb,Zb)}}laa(jb,Zb,Eb=null){const tc=this.Q5(y.a.events);tc[eb.a.event]=jb;this.zmi(tc,Math.round(Zb),Eb)}l0a(jb,Zb,Eb=null){const tc=this.Q5(y.a.events);tc[eb.a.event]=y.a.error;tc[eb.a.module]=jb;tc[eb.a.errorMessage]=Zb;tc[eb.a.message]=Zb;this.zmi(tc,Math.round(window.performance.now()),Eb)}mwm(jb){const Zb=this.Q5(y.a.woh);Zb[eb.a.value]=jb;Zb[eb.a.L2d]=this.O7a;this.X4.iEa(y.a.woh,
Zb,this.Y8)}Hvm(jb){const Zb=this.Q5(y.a.P6g);Zb[eb.a.value]=jb;Zb[eb.a.L2d]=this.O7a;this.X4.iEa(y.a.P6g,Zb,this.Y8)}nxm(jb){const Zb=this.Q5(y.a.mHh);Zb[eb.a.value]=jb;Zb[eb.a.L2d]=this.O7a;this.X4.iEa(y.a.mHh,Zb,this.Y8)}zAm(jb){const Zb=this.Q5(y.a.PHi);Zb[eb.a.value]=jb;Zb[eb.a.L2d]=this.O7a;this.X4.iEa(y.a.PHi,Zb,this.Y8)}Tvm(jb){const Zb=this.Q5(y.a.uXi);Zb[eb.a.value]=jb;this.X4.iEa(y.a.uXi,Zb,this.Y8)}DAm(jb,Zb){const Eb=this.Q5(y.a.tIi);Eb[eb.a.Abc]=jb;Zb&&(Eb[eb.a.Rla]=Zb);this.X4.hEa(y.a.tIi,
Eb)}Q5(jb){return{["SessionID"]:this.qIa.sessionId,["CorrelationID"]:this.qIa.Rla,["Time"]:(new Date).getTime(),["Event"]:jb,["Scenario"]:this.Y8}}}Object(C.a)(Aa,"UsageLogger",null,[1099]);var ma=d(56),Ga=d(1627),Fa=d(1186),ib=d(80),ob=d(27),fb=d(224),Mb=d(378),Tb=d(15),rc=d(594),vb=d(60),Ya=d(13);d.d(N,"TellMeActor",function(){return wb});class wb{constructor(){this.wTa=this.U0=this.Wb=this.Oa=this.DO=this.qy=this.Hb=this.ga=this.Ze=this.DJ=this.Yye=this.j6g=this.Bqa=this.qc=null;this.RRb=!1;this.Gke=
[];this.xyg=[];this.sRg=[];this.tRg=[];this.pMg=!1;this.BOb=this.Wca=null;this.Tpc=this.MSa=!1;this.jgd=!0;this.UY=this.Noc=this.EGg=this.mze=this.cRg=null;this.ZX=[];this.k6a=this.jPb=this.exa=null;this.kRb=!1;this.fze=0;this.cOb=null;this.zqa=-1;this.EQg=0;this.Zpc=!1;this.L6a=null;this.R4g=!1;this.Pt=null}get nyd(){return this.DO?this.DO.contentType:wb.unknown}get actions(){return this.ZX}set actions(jb){this.ZX=jb}AId(){return this.Ze?this.Ze.Ana.Rla:null}ON(){return this.qc}get TIm(){return this.jgd}get Vqo(){return this.cRg}performance(){return this.DJ}get p4c(){return this.R4g}set p4c(jb){this.R4g=
jb}hG(jb){const Zb=window.performance.now();this.Wca&&!T.c(jb)&&(this.Wca(jb),this.Ze.WB(y.a.hG,window.performance.now()-Zb))}initialize(jb,Zb=null,Eb=null,tc=null,lc=null,Lc=null,Bb=null,jc=null,dc=null,nb=null,Gb=null){const {InteractionLogger:lb}=d(1850),{GroupsPlacementInfo:Kb}=d(1846),{AggregatorResultsProvider:Vb}=d(1694);this.qc=jb;this.MSa=!!O.AFrameworkApplication.ua&&O.AFrameworkApplication.ua.Sb.A7b;this.Ze=tc;if(!tc){tc=new t;tc.sessionId=O.AFrameworkApplication.userSessionId;const vc=
rc.a.pg(O.AFrameworkApplication.lcid)||rc.a.WMc;this.Ze=new lb(new Aa(this.qc.application,vc.name,tc,this.qc.fq,this.MSa,jb.jQa,null),this.qc.gFk,this.qc)}this.wTa=new J(this.qc.parameterData);this.j6g=Eb||new Sa(this.qc,this.wTa);this.Wca=Bb;this.Yye=this.Yye||new da(this.qc,this.qc.parameterData,Bb);this.Wb=ma.FocusManager.instance();this.U0=I.createInstance(this.qc);this.EGg=new Kb(jb);this.ga=lc||O.AFrameworkApplication.ya;this.Hb=Lc||O.AFrameworkApplication.uc;this.qy=dc;this.Bqa=Zb;this.Pt=
Gb;this.DJ=new qa;dc?dc.execute(vc=>{vc.isFeatureEnabled(wb.n7n,!0).then(Fc=>{const {AggregatorResultsProvider:Zc}=d(1694);this.Zpc=Fc;this.Bqa=this.Bqa||Zc.createInstance(this.U0,this.qc,this.wTa,this.Zpc);return null})}):(this.Zpc=!0,this.Bqa=this.Bqa||Vb.createInstance(this.U0,this.qc,this.wTa,this.Zpc));this.Oa=jc;this.exa=Sa.CAd;this.cRg=new Promise(vc=>{this.mze=vc});nb&&nb.execute(vc=>{this.DO=vc});this.qc.fq&&K.a.Tgi()&&(jb=String.format(CommonUIStrings.l_TeamsUnifiedAppHelpText,this.qc.application),
appChrome.api.dispatch(appChrome.actions.updateTellMePlaceholderText(jb,jb)))}Vb(){this.A5j()}Oln(jb){this.Noc=jb}A5j(){this.ga.gb(Ya.a.tellMe,vb.a.frame,Object(l.a)(this,this.tellMe,"tellMe"),96);this.ga.gb(Ya.a.F4f,vb.a.frame,Object(l.a)(this,this.uih,"cacheAsyncMenuRefreshFunction"),96);this.ga.gb(Ya.a.K4f,vb.a.frame,Object(l.a)(this,this.Rmi,"logItemExecuted"),96);this.ga.gb(Ya.a.N4f,vb.a.frame,Object(l.a)(this,this.pmi,"logControlDeactivation"),96);this.ga.gb(Ya.a.M4f,vb.a.frame,Object(l.a)(this,
this.Mmi,"logInputFocus"),96);this.ga.gb(Ya.a.I4f,vb.a.frame,Object(l.a)(this,this.TZa,"interactionBegin"),96);this.ga.gb(Ya.a.P4f,vb.a.frame,Object(l.a)(this,this.TZa,"interactionBegin"),96);this.ga.gb(Ya.a.L4f,vb.a.frame,Object(l.a)(this,this.Lmi,"logInputBlur"),96);this.ga.gb(Ya.a.O4f,vb.a.frame,Object(l.a)(this,this.omi,"logControlActivated"),96);this.ga.gb(Ya.a.Z1c,vb.a.frame,Object(l.a)(this,this.sJh,"focusSearchBox"),96);this.ga.gb(Ya.a.E4f,vb.a.frame,Object(l.a)(this,this.qqh,"constructLiveNotificationForMenu"),
96);this.ga.gb(Ya.a.Q4f,vb.a.frame,Object(l.a)(this,this.qof,"insertTryQuery"),96);this.ga.gb(Ya.a.owf,vb.a.frame,Object(l.a)(this,this.qof,"insertTryQuery"),96);this.ga.gb(Ya.a.R8e,vb.a.frame,Object(l.a)(this,this.$Na,"openOrInsertUrl"),96);this.ga.gb(Ya.a.S8e,vb.a.frame,Object(l.a)(this,this.$Na,"openOrInsertUrl"),96);this.ga.gb(Ya.a.T8e,vb.a.frame,Object(l.a)(this,this.$Na,"openOrInsertUrl"),96);this.ga.gb(Ya.a.U8e,vb.a.frame,Object(l.a)(this,this.$Na,"openOrInsertUrl"),96);this.ga.gb(Ya.a.V8e,
vb.a.frame,Object(l.a)(this,this.$Na,"openOrInsertUrl"),96);this.ga.gb(Ya.a.fJf,vb.a.frame,Object(l.a)(this,this.$Na,"openOrInsertUrl"),96);this.ga.gb(Ya.a.gJf,vb.a.frame,Object(l.a)(this,this.$Na,"openOrInsertUrl"),96);this.ga.gb(Ya.a.hJf,vb.a.frame,Object(l.a)(this,this.$Na,"openOrInsertUrl"),96);this.ga.gb(Ya.a.dLf,vb.a.frame,Object(l.a)(this,this.PZa,"insertMention"),96);this.ga.gb(Ya.a.eLf,vb.a.frame,Object(l.a)(this,this.PZa,"insertMention"),96);this.ga.gb(Ya.a.fLf,vb.a.frame,Object(l.a)(this,
this.PZa,"insertMention"),96);this.ga.gb(Ya.a.H4f,vb.a.frame,Object(l.a)(this,this.tBi,"openFeedback"),96);this.ga.gb(Ya.a.R4f,vb.a.frame,Object(l.a)(this,this.$Na,"openOrInsertUrl"),96);this.ga.gb(Ya.a.LPe,vb.a.frame,Object(l.a)(this,this.ARd,"launchAddin"),96);this.ga.gb(Ya.a.MPe,vb.a.frame,Object(l.a)(this,this.ARd,"launchAddin"),96);this.ga.gb(Ya.a.NPe,vb.a.frame,Object(l.a)(this,this.ARd,"launchAddin"),96);this.ga.gb(Ya.a.CKb,vb.a.frame,Object(l.a)(this,this.CKb,"showTellMeCoachmark"),96);this.ga.gb(Ya.a.Ovf,
vb.a.frame,Object(l.a)(this,this.oki,"launchAddinStore"),96)}Tjn(jb){this.jgd=!1;const Zb=window.performance.now();jb.h0a.isCompleted?(this.jgd=!0,this.mze(!0)):jb.VV(()=>{this.jgd=!0;this.mze(!0);this.Ze.WB(y.a.ITk,window.performance.now()-Zb)});this.Ckn(jb)}Ckn(jb){Mb.a.pXc(Object(l.a)(this,this.J4e,"dispatcher"));Mb.a.iFc([new fb.a(Ya.a.tellMe,vb.a.frame,96),new fb.a(Ya.a.F4f,vb.a.frame,96),new fb.a(Ya.a.K4f,vb.a.frame,96),new fb.a(Ya.a.N4f,vb.a.frame,96),new fb.a(Ya.a.M4f,vb.a.frame,96),new fb.a(Ya.a.I4f,
vb.a.frame,96),new fb.a(Ya.a.P4f,vb.a.frame,96),new fb.a(Ya.a.L4f,vb.a.frame,96),new fb.a(Ya.a.O4f,vb.a.frame,96),new fb.a(Ya.a.Z1c,vb.a.frame,96),new fb.a(Ya.a.E4f,vb.a.frame,96),new fb.a(Ya.a.Q4f,vb.a.frame,96),new fb.a(Ya.a.owf,vb.a.frame,96),new fb.a(Ya.a.R8e,vb.a.frame,96),new fb.a(Ya.a.S8e,vb.a.frame,96),new fb.a(Ya.a.T8e,vb.a.frame,96),new fb.a(Ya.a.U8e,vb.a.frame,96),new fb.a(Ya.a.V8e,vb.a.frame,96),new fb.a(Ya.a.fJf,vb.a.frame,96),new fb.a(Ya.a.gJf,vb.a.frame,96),new fb.a(Ya.a.hJf,vb.a.frame,
96),new fb.a(Ya.a.dLf,vb.a.frame,96),new fb.a(Ya.a.eLf,vb.a.frame,96),new fb.a(Ya.a.fLf,vb.a.frame,96),new fb.a(Ya.a.H4f,vb.a.frame,96),new fb.a(Ya.a.R4f,vb.a.frame,96),new fb.a(Ya.a.LPe,vb.a.frame,96),new fb.a(Ya.a.MPe,vb.a.frame,96),new fb.a(Ya.a.NPe,vb.a.frame,96),new fb.a(Ya.a.CKb,vb.a.frame,96),new fb.a(Ya.a.Ovf,vb.a.frame,96)],jb)}J4e(jb,Zb,Eb,tc,lc){if(Zb.contextId===vb.a.frame)switch(jb){case Ya.a.tellMe:return this.tellMe(jb,Zb,Eb,tc,lc);case Ya.a.F4f:return this.uih(jb,Zb,Eb,tc,lc);case Ya.a.K4f:return this.Rmi(jb,
Zb,Eb,tc,lc);case Ya.a.N4f:return this.pmi(jb,Zb,Eb,tc,lc);case Ya.a.M4f:return this.Mmi(jb,Zb,Eb,tc,lc);case Ya.a.I4f:return this.TZa(jb,Zb,Eb,tc,lc);case Ya.a.P4f:return this.$xn(Eb);case Ya.a.L4f:return this.Lmi(jb,Zb,Eb,tc,lc);case Ya.a.O4f:return this.omi(jb,Zb,Eb,tc,lc);case Ya.a.Z1c:return this.sJh(jb,Zb,Eb,tc,lc);case Ya.a.E4f:return this.qqh(jb,Zb,Eb,tc,lc);case Ya.a.Q4f:case Ya.a.owf:return this.qof(jb,Zb,Eb,tc,lc);case Ya.a.R8e:case Ya.a.S8e:case Ya.a.T8e:case Ya.a.U8e:case Ya.a.V8e:case Ya.a.fJf:case Ya.a.gJf:case Ya.a.hJf:case Ya.a.R4f:return this.$Na(jb,
Zb,Eb,tc,lc);case Ya.a.dLf:case Ya.a.eLf:case Ya.a.fLf:return this.PZa(jb,Zb,Eb,tc,lc);case Ya.a.H4f:return this.tBi(jb,Zb,Eb,tc,lc);case Ya.a.LPe:case Ya.a.MPe:case Ya.a.NPe:return this.ARd(jb,Zb,Eb,tc,lc);case Ya.a.CKb:return this.CKb(jb,Zb,Eb,tc,lc);case Ya.a.Ovf:return this.oki(jb,Zb,Eb,tc,lc)}return 2}sJh(jb,Zb,Eb){if(1===Eb)return 32;this.m0i();jb=!1;(this.qc.jQa||this.MSa)&&(Zb=document.getElementById("SearchButton"))&&Zb.click();if(!this.qc.jQa&&this.MSa)for(Zb=document.getElementsByClassName("ms-suiteux-search-box"),
Eb=0;Eb<Zb.length;Eb++){const tc=Zb[Eb].querySelector("input[type=search]");tc&&(jb=ma.FocusManager.AK(tc))}else jb=ma.FocusManager.AK($get(this.qc.fq?n.CuiHelper.p1f:n.CuiHelper.vae));this.Tpc=!0;return jb?32:8}qof(jb,Zb,Eb,tc,lc){if(1===Eb)return 32;if(T.c(lc))return this.Ze.onError("TellMeActor:InsertTryQuery","actiondata comes null"),16;this.m0i();jb=lc.CommandValueId;Zb=this.qc.fq?n.CuiHelper.p1f:n.CuiHelper.vae;this.qc.fq&&!T.c(lc[Fa.a.T2a])&&(lc[Fa.a.T2a]=!1);if(jb){if(this.qc.fq)return appChrome.api.dispatch(appChrome.actions.updateTellMeSearchText(jb)),
this.L6a=[19],32;if(lc=$get(Zb))lc.value=jb}return ma.FocusManager.AK($get(Zb))?32:8}m0i(){this.Wb.uK(this.qc.jQa||this.MSa?this.qc.FBb:this.qc.l2a,!1)}vgl(jb,Zb){switch(jb){case 0:return String.format(CommonUIStrings.l_TellMeClassifierCommandAccessibleLabelFormat,Zb);case 4:return String.format(CommonUIStrings.l_TellMeRecentlyUsedAccessibleLabelFormat,Zb);case 5:return String.format(CommonUIStrings.l_TellMeTryQueryAccessibleLabelFormat,Zb);case 7:case 16:return String.format(CommonUIStrings.l_TellMeTryCommandAccessibleLabelFormat,
Zb)}return Zb}qqh(jb,Zb,Eb,tc,lc){if(1===Eb)return 32;if(T.c(lc))return this.Ze.onError("TellMeActor:ConstructLiveNotificationForMenu","actiondata comes null"),16;jb=this.exa?this.exa.lSi:0;lc.Value=1!==jb?String.format(CommonUIStrings.l_LookupLiveNotificationResultPluralFormText,jb):CommonUIStrings.l_LookupLiveNotificationResultSingularFormText;if(this.exa)for(const Lc of this.exa.VXk)lc=Object(e.a)(E.a,Lc)?Lc.id:ha.a.replaceAll(Lc.value,'"',""),(lc=$get(lc+"-"+K.a.G4f))&&ob.a.Iq(lc,ob.a.lda,ha.a.If(this.vgl(Lc.groupType,
lc.innerText)));return 32}uih(jb,Zb,Eb,tc,lc){if(1===Eb)return 32;if(T.c(lc))return this.Ze.onError("TellMeActor:CacheAsyncMenuRefreshFunction","actiondata comes null"),16;this.cOb=new ib.a(2,1,0,()=>{lc[Ga.a.Callback]()},97);this.exa&&this.Hb.$b(this.cOb);return 32}Rmi(jb,Zb,Eb,tc,lc){if(1===Eb)return 32;if(T.c(lc))return this.Ze.onError("TellMeActor:LogItemExecuted","actiondata comes null"),16;lc.CloseAllMenus&&(jb=void 0===lc.ParentControlId||null===lc.ParentControlId?"<NA>":lc.ParentControlId,
Zb=this.BOb?this.BOb[lc.ControlId]:null,!Zb&&this.BOb&&"<NA>"!==jb&&(Zb=this.BOb[jb]),Zb||(Zb=this.RRb&&this.U0.Iam(lc),Zb=this.bVk(Zb,lc.ControlId),Zb=new v(Zb,28,4,-1,-1,-1),this.Ze.onError("TellMeActor:ItemExecuted","Missing ClickLoggingInfo for "+lc.ControlId+" determined group:"+L.a[Zb.groupType])),this.Ze.mQm(lc.ControlId,jb,lc.CommandId,lc.CloseAllMenus,Zb),this.wTa.JMm(lc.ControlId),lc.Location!==Ca.a.contextMenu&&(this.U0.Pya(lc),this.U0.TH(Zb.resultType),this.qc.j8d&&this.Bqa.n3j(lc.CommandId)));
return 32}pmi(jb,Zb,Eb,tc,lc){if(1===Eb)return 32;F.a.Qlm()&&(new wa(this.AId())).IFl(this.jPb);jb=this.jPb;Zb=this.zqa;Eb=this.Ze.m9c;if(T.c(lc))return this.Ze.onError("TellMeActor:LogControlDeactivation","actiondata comes null"),16;lc=lc.UILocation;jb&&0<jb.length&&this.Zpc&&K.a.l_f(this.qc)&&this.qc.AQd&&19!==lc&&Zb>Eb&&!this.qc.VQ&&(this.Ze.Sxf(jb),this.Ze.KXf(Zb));this.Ze.Lwn();this.qc.ude&&19!==lc&&(this.DJ.mark(3),this.DJ.measure(1,0,3),this.DJ.measure(2,2,3),this.DJ.Gxf(0,1,2),this.DJ.Gxf(2,
2,3),this.DJ.Gxf(1,0,3),this.DJ.Dwk(),this.DJ.clearMeasures([0,2,1]));this.Ze.UQm(window.performance.now()-this.fze);this.qc.fq&&(this.k6a=null,this.Ze.Hua());this.Tpc=this.kRb=!1;this.jPb="";return 32}Mmi(jb,Zb,Eb){if(1===Eb)return 32;this.Ze.kib(u(Zb),this.Tpc);return 32}Lmi(jb,Zb,Eb){if(1===Eb)return 32;this.Ze.Hua();this.kRb=!1;return 32}omi(jb,Zb,Eb,tc,lc){if(1===Eb)return 32;this.UY=null;lc&&(this.UY=lc);this.qc.ude&&(T.c(this.UY)||this.UY.Location!==Ca.a.contextMenu)&&this.DJ.mark(0);this.Ze.m7d(T.c(this.UY)||
T.c(this.UY.Location)?Ca.a.unknown:this.UY.Location);this.Ze.TQm(this.EQg,this.Tpc);this.kRb||this.V0a();return 32}Eth(jb,Zb){const Eb=[],tc=Date.now();for(let lc of jb)jb=(tc-lc.timeStamp)/1E3,jb=K.a.F6f(jb),Array.add(Eb,new P(Zb?lc.commandId:lc.controlId,jb));return Eb}juh(jb=!1){var Zb=jb?this.U0.CFl():this.U0.LHc();jb=[];const Eb=Date.now();for(const tc of Zb)Zb=(Eb-tc.TimeStamp)/1E3,Zb=K.a.F6f(Zb),Array.add(jb,new P(tc.Id,Zb));return jb}V0a(){if(!this.kRb){this.RRb=this.kRb=!0;""!==this.qc.iWf&&
O.AFrameworkApplication.Hl(this.qc.iWf);if(!this.pMg){this.pMg=!0;const jb={};jb.IsMLREnabled=this.qc.tgm;jb.IsReactRibbonEnabled=this.qc.fq;jb.IsSharedHeaderEnabled=!!O.AFrameworkApplication.ua&&O.AFrameworkApplication.ua.Sb.BI;jb.IsSearchUxEnabled=this.MSa;jb.IsTellMeInHeaderEnabled=this.qc.jQa;jb.IsGoLocalEnv=K.a.hdi();jb.IsSovereignEnvironment=K.a.JDb();jb.IsTellMeServiceResultsEnabled=K.a.l_f(this.qc);jb.IsSubstrateProviderEnabled=K.a.k_f(this.qc);jb.ShouldFetchTokens=!!O.AFrameworkApplication.ua&&
O.AFrameworkApplication.ua.Sb.iKb;jb.IsSerpletEnabled=K.a.xCa();jb.FirstOnClickTimeInMS=Math.round(window.performance.now());jb.IsHeaderHidden=O.AFrameworkApplication.hideHeader||O.AFrameworkApplication.eQ;jb.IsSearchInHeaderHidden=O.AFrameworkApplication.cLc;void 0!==window.performance.timing&&null!==window.performance.timing&&(jb.TimeSinceFetchStart=Math.round(Date.now()-window.performance.timing.fetchStart));jb.IsFindWithMatchesEnabled=this.qc.ECd;jb.HelpShowsTopSearchResult=this.qc.k0c;jb.HelpShowsNumberOfMatches=
this.qc.j0c;O.AFrameworkApplication.K&&(jb.UiHost=O.AFrameworkApplication.K.lb("UiHostIntegrationType"));this.Ze.gBm(JSON.stringify(jb))}this.Gke=this.Eth(k.a.instance.t2b(),!1);this.xyg=this.Eth(k.a.instance.gdb(),!0);this.sRg=this.juh();this.tRg=this.juh(!0);this.Ze.V0a()}}TZa(jb,Zb,Eb,tc,lc){if(1===Eb)return 32;if(T.c(lc))return this.Ze.onError("TellMeActor:InteractionBegin","actiondata comes null"),16;if(Tb.a.iOc)return 32;this.fze=window.performance.now();this.V0a();jb=new U(Object(l.a)(this,
this.Kua,"onRequestCompleted"),0);this.zqa++;this.Ze.beginQuery("",this.zqa,this.RRb);this.exa=Sa.CAd;this.k6a=da.x6e;if(this.Bqa)wb.instance.actions=[],this.Bqa.DI(new S("",this.zqa),jb,this.qc.fq);else this.Ze.onError("TellMeActor:ExecuteTellMeQuery","Aggregator provider not resolved yet");this.cOb&&this.Hb.$b(this.cOb);return 32}$xn(jb){if(1===jb)return 32;this.Wb.NQ(this.qc.jQa||this.MSa?this.qc.FBb:this.qc.l2a,!1);return 32}tellMe(jb,Zb,Eb,tc,lc){if(1===Eb)return 32;if(T.c(lc))return this.Ze.onError("TellMeActor:TellMe",
"actiondata comes null"),16;this.UY=lc;this.Ze.m7d(T.c(this.UY.Location)?Ca.a.unknown:this.UY.Location);jb=this.UY.Value;this.qc.fq||jb&&""!==jb.trim()?(!this.k6a&&this.qc.fq&&(this.Ze.kib(u(Zb),this.Tpc),this.V0a()),this.g5k(jb,this.UY.Location),this.UY.PopulationXML=this.exa.xml):this.RRb?this.UY.PopulationXML=this.exa.xml:(this.UY.PopulationXML=Sa.CAd.xml,this.k6a=da.x6e,this.jPb="");return 32}g5k(jb,Zb){this.fze=window.performance.now();this.qc.ude&&Zb!==Ca.a.contextMenu&&this.DJ.mark(1);this.qc.fq&&
appChrome.api.dispatch(appChrome.actions.updateTellMeSearchText(jb));jb&&0<jb.trim().length&&(this.RRb=!1);this.qc.K3k();Zb=T.c(Zb)?Ca.a.tellMe:Zb;if(jb!==this.jPb||this.qc.fq){this.zqa++;this.Ze.beginQuery(jb,this.zqa,this.RRb);const Eb=new S(jb,this.zqa),tc=new U(Object(l.a)(this,this.Kua,"onRequestCompleted"),this.zqa);this.exa=Sa.CAd;this.k6a=da.x6e;if(this.Bqa)wb.instance.actions=[],this.Bqa.DI(Eb,tc,this.qc.fq,Zb,this.L6a),this.L6a=null;else this.Ze.onError("TellMeActor:ExecuteTellMeQuery",
"Aggregator provider not resolved yet");this.EQg=this.zqa;this.jPb=jb}}Ajo(jb){if(this.qc.fq){var Zb=appChrome.selectors.getActiveControlStates();if(Zb=Object(a.a)(Object,Zb[jb.value])){jb.label=Zb.label;let Eb=null;"description"in Zb&&(Eb=Zb.description);Eb&&Object.getType(Eb)===String?jb.description=Eb:"secondaryText"in Zb?jb.description=Zb.secondaryText:"fullDescriptionLabel"in Zb&&(jb.description=Zb.fullDescriptionLabel)}}}I5m(jb){this.BOb={};let Zb=0,Eb=0;for(const tc of jb){jb=0;for(const lc of tc.results)this.BOb[lc.value]=
new v(lc.groupType,lc.type,lc.b9i,Zb,jb,Eb),jb++,Eb++,lc.label||5!==lc.type||this.Ajo(lc);0<jb&&Zb++}}jac(jb,Zb,Eb,tc,lc){if(1===Eb)return 32;if(T.c(lc))return this.Ze.onError("TellMeActor:OpenUrlInNewTab","actiondata comes null"),16;(jb=lc.CommandValueId)&&window.open(jb,"_blank");return 32}PZa(jb,Zb,Eb,tc,lc){if(1===Eb)return 32;if(T.c(lc))return this.Ze.onError("TellMeActor:InsertMention","actiondata comes null"),16;jb=lc.UILocation;let Lc;lc=lc.CommandValueId;try{Lc=Ha.a(lc)}catch(Bb){return this.Ze.onError("TellMeActor:InsertMention",
"commandValueId is not in proper format"),16}return T.c(Lc)?(this.Ze.onError("TellMeActor:InsertMention","insertMentionParameters comes null"),16):T.c(this.Noc)?(this.Ze.onError("TellMeActor:InsertMention","_iInsertContentHandler comes null"),16):19!==jb?(this.Ze.onError("TellMeActor:InsertMention","location "+jb+" is unexpected"),16):this.Noc.PZa(Lc.displayName,Lc.email,Lc.userId)?32:(this.Ze.onError("TellMeActor:InsertMention","mention is not inserted"),16)}$Na(jb,Zb,Eb,tc,lc){return 1===Eb?32:
T.c(lc)?(this.Ze.onError("TellMeActor:OpenOrInsertUrl","actiondata comes null"),16):19===lc.UILocation?this.V6l(Eb,lc):this.jac(jb,Zb,Eb,tc,lc)}tBi(jb,Zb,Eb,tc,lc){if(1===Eb)return 32;if(T.c(lc))return this.Ze.onError("TellMeActor:OpenFeedback","actiondata comes null"),16;this.Pt&&this.Pt.execute(Lc=>{Lc.MPa("TellMeSurvey",null)});return 32}V6l(jb,Zb){if(1===jb)return 32;if(T.c(Zb))return this.Ze.onError("TellMeActor:InsertUrl","actiondata comes null"),16;if(T.c(this.Noc))return this.Ze.onError("TellMeActor:InsertUrl",
"_iInsertContentHandler comes null"),16;jb=Zb.CommandValueId;return T.c(jb)?(this.Ze.onError("TellMeActor:InsertUrl","commandValueId comes null"),16):this.Noc.insertHtmlText(jb)?32:(this.Ze.onError("TellMeActor:InsertUrl","url is not inserted"),16)}Kua(jb,Zb,Eb,tc,lc){Eb=window.performance.now();this.I5m(Zb);this.Ze.vLn(Zb);this.qc.fq?(this.k6a=this.Yye.Ufl(Zb,jb,lc),this.qc.qBa?(this.ZX.push(appChrome.actions.updateTellMeSearchResults(this.k6a.menuModel,jb,lc)),appChrome.api.dispatch(this.ZX)):appChrome.api.dispatch(appChrome.actions.updateTellMeSearchResults(this.k6a.menuModel,
jb,lc)),this.qc.ude&&this.kRb&&(T.c(this.UY)||this.UY.Location!==Ca.a.contextMenu)&&(this.DJ.mark(2),this.DJ.measure(0,1,2))):this.exa=this.j6g.Vfl(Zb,this.Ze.Ana);this.cOb&&this.Hb.$b(this.cOb);lc={};lc.GroupsCount=Zb.length;lc.QueryID=tc;lc.QueryLength=jb.length;this.Ze.WB(y.a.YMk,window.performance.now()-Eb,lc)}bVk(jb,Zb){return Zb.startsWith(this.qc.fq?K.a.b7f:K.a.Vbe)?5:jb?4:"bSearchHelp"===Zb||Zb.startsWith("GetHelpFromTellMe")?8:"bInsights"===Zb||Zb.startsWith("SmartLookupFromTellMe")?13:Zb===
this.qc.j9e?2:0}TH(jb,Zb){this.Bqa&&this.Bqa.TH(jb,Zb)}oki(jb,Zb,Eb,tc,lc){return this.ga.Xb(Ya.a.BRd,2,lc)}ARd(jb,Zb,Eb,tc,lc){({AddinResultsProvider:jb}=d(1605));lc=lc.CommandValueId;if(T.b(lc))return this.Ze.onError("TellMeActor:LaunchAddin","Add-in assetId is null"),16;if(!jb.svb[lc])return this.Ze.onError("TellMeActor:LaunchAddin","Add-in with assetId "+lc+" doesn't not exist in entitlements"),16;jb=d(1605).AddinResultsProvider.svb[lc];Zb={};Zb.solutionId=jb.id;Zb.version=jb.appVersion;Zb.storeType=
jb.storeType;Zb.storeId=jb.storeId;Zb.assetId=jb.assetId;Zb.assetStoreId=jb.assetStoreId;Zb.displayName=jb.displayName;Zb.targetType=jb.targetType;Zb.height=jb.height;Zb.width=jb.width;jb=this.ga.Xb(Ya.a.dof,2,Zb);if(32!==jb)this.Ze.onError("TellMeActor:LaunchAddin","CommonCommands.InsertOfficeAddin failed. Response: "+jb+". AssetId: "+lc);return jb}CKb(){if(!T.c(this.Pt))for(let jb of k.a.instance.gdb()){if("ShowContextMenuWithFloatie"===jb.commandId)return this.Pt.execute(Zb=>{Zb.logActivity("TellMe1TabSwitchCoachMarkActivity",
null)}),32;if(jb.commandId&&-1===jb.commandId.indexOf("Tab"))break}return 8}static get instance(){return wb._instance||(wb._instance=new wb)}}wb._instance=null;wb.n7n="mso_tellMeService";wb.unknown="Unknown";Object(C.a)(wb,"TellMeActor",null,[])},1473:function(C,N,d){d.d(N,"a",function(){return e});C=d(0);var l=d(1486);class e{constructor(a,k){this.P7a=!1;const {Annotations:n}=d(1467);if(!a)throw Error.argumentNull("annotations");if(!a.wuf(k))throw Error.argument("memberTypeID","Invalid type ID");
if(n.uH(k))throw Error.argument("memberTypeID","Lists of lists are not permitted");this.Ov=a;this.uMj=k;this.Qo=[]}get vXb(){return this.Ov}get isReadOnly(){return this.P7a}get O2(){return this.uMj}get items(){return this.Qo}Hba(){const {Annotations:a}=d(1467);let k="[";for(let n=0,v=this.items.length;n<v;++n){0<n&&(k+=", ");const u=this.Ov.Hba(this.O2,this.items[n]);this.O2===a.N7?(k+='"',k+=l.a.I7e(u),k+='"'):k+=u}return k+"]"}isEqual(a){const {Annotations:k}=d(1467);if(this===a)return!0;if(!a||
a.vXb!==this.Ov||a.O2!==this.O2||a.items.length!==this.items.length)return!1;for(let n=0;n<this.items.length;++n)if(!k.vmb(this.O2,this.items[n],a.items[n]))return!1;return!0}clone(){const a=new e(this.Ov,this.O2);Array.addRange(a.items,this.items);return a}wS(){return this.isReadOnly?this.clone():this}kxf(){const {Annotations:a}=d(1467);if(!this.isReadOnly){this.P7a=!0;for(const k of this.items)a.SEb(k)}}toString(){return this.Hba()}}Object(C.a)(e,"ListValue",null,[1251,1250])},1474:function(C,N,
d){d.d(N,"a",function(){return l});C=d(0);class l{}l.tellMe="TellMe";l.contextMenu="ContextMenu";l.unknown="Unknown";Object(C.a)(l,"TellMeScenario",null,[])},1475:function(C,N,d){d.d(N,"a",function(){return l});C=d(0);class l{constructor(e,a,k=null,n=null,v=4,u=-99999,t=0){this.UH="";this.zrd=-1;this.value=e;this.type=a;this.b9i=v;this.label=this.$B=k;this.groupType=27;this.description=n;this.score=u;this.count=t}}Object(C.a)(l,"ResultBinding",null,[])},1477:function(C,N,d){d.d(N,"a",function(){return l});
C=d(0);class l{constructor(e){this.attributes=null;this.query=e;this.Un=[]}iw(e){this.Un.push(e)}lOi(e){const a=[];for(const k of this.Un)k.groupType!==e&&a.push(k);this.Un.length!==a.length&&(this.Un=a)}get l7b(){return!1}}Object(C.a)(l,"SimpleResultsUpdatedEventArgs",null,[1071])},1478:function(C,N,d){d.d(N,"a",function(){return l});C=d(0);class l{constructor(e=27,a=""){this.Nt=[];this.groupType=e;this.displayName=a}get results(){return this.Nt}yz(e){e.groupType=this.groupType;Array.add(this.results,
e)}qSf(e=1){if(this.results.length>=e)for(let a=0;a<e;a++)Array.removeAt(this.results,this.results.length-1)}}Object(C.a)(l,"SimpleResultGroup",null,[1072])},1486:function(C,N,d){C=d(0);class l{constructor(a,k){this.hab=a;this.value=k}}Object(C.a)(l,"AttrValuePair",null,[]);d.d(N,"a",function(){return e});class e{constructor(a){this.P7a=!1;if(!a)throw Error.argumentNull("annotations");this.Ov=a;this.nX=[]}get vXb(){return this.Ov}get isReadOnly(){return this.P7a}get vkf(){return 0<this.nX.length}kq(a){if(!this.Ov.X7b(a))throw Error.argument("attributeID",
"Invalid attribute ID");for(const k of this.nX)if(a===k.hab)return a=k.value,{returnValue:!0,value:a};return{returnValue:!1,value:null}}hy(a,k){var {Annotations:n}=d(1467);if(this.isReadOnly)throw Error.invalidOperation("Attempt to set annotation on read-only FeatureBundle");if(!this.Ov.X7b(a))throw Error.argument("attributeID","Invalid attribute ID");if(!this.Ov.R6b(this.Ov.getAttributeType(a),k))throw Error.argument("value","Value is not of the correct type for the specified attribute");n.SEb(k);
for(n=0;n<this.nX.length;++n){const v=this.nX[n];if(a===v.hab){v.value=k;return}}Array.add(this.nX,new l(a,k))}KOa(a){if(this.isReadOnly)throw Error.invalidOperation("Attempt to remove annotation from read-only FeatureBundle");if(!this.Ov.X7b(a))throw Error.argument("attributeID","Invalid attribute ID");for(let k=0;k<this.nX.length;++k)if(a===this.nX[k].hab){Array.removeAt(this.nX,k);break}}zDd(a){if(!a)throw Error.argumentNull("action");for(const k of this.nX)a(k.hab,k.value)}clone(){const a=new e(this.Ov);
a.zWa(this);return a}zWa(a){if(this.isReadOnly)throw Error.invalidOperation("Attempt to copy annotations onto read-only FeatureBundle");if(!a)throw Error.argumentNull("other");if(a.vXb!==this.Ov)throw Error.argument("other","Incompatible feature bundle");Array.clear(this.nX);a.zDd((k,n)=>{this.hy(k,n)})}Hba(){const {Annotations:a}=d(1467);let k="[",n=!0;for(const v of this.nX){n?n=!1:k+=", ";k+=this.Ov.sMh(v.hab);k+="=";const u=this.Ov.getAttributeType(v.hab),t=this.Ov.Hba(u,v.value);u===a.N7?(k+=
'"',k+=e.I7e(t),k+='"'):k+=t}return k+"]"}isEqual(a){const {Annotations:k}=d(1467);if(!a)throw Error.argumentNull("other");if(this===a)return!0;if(!a||this.Ov!==a.vXb||this.vkf!==a.vkf)return!1;let n=0,v=null,u=!1;a.zDd((t,y)=>{++n;if(!u){var B=-1;for(let G=0,F=this.nX.length;G<F;++G)if(this.nX[G].hab===t){B=G;break}0>B?u=!0:(v||(v=Array(this.nX.length)),v[B]=y)}});if(this.nX.length!==n||u)return!1;for(let t=0,y=this.nX.length;t<y;++t)if(!k.vmb(this.Ov.getAttributeType(this.nX[t].hab),this.nX[t].value,
v[t]))return!1;return!0}wS(){return this.isReadOnly?this.clone():this}kxf(){const {Annotations:a}=d(1467);if(!this.isReadOnly){this.P7a=!0;for(const k of this.nX)a.SEb(k.value)}}toString(){return this.Hba()}static I7e(a){return a.replace("\\","\\\\").replace("[","\\[").replace("]","\\]").replace(",","\\,")}}Object(C.a)(e,"FeatureBundle",null,[1249,1250])},1492:function(C,N,d){d.d(N,"a",function(){return l});C=d(0);class l{}l.click="Click";l.TZa="InteractionBegin";l.zCb="InteractionEnd";l.qrh="ControlActivated";
l.query="Query";l.tIi="QueryIndexRecorded";l.woh="Clicks";l.P6g="ActionEvents";l.mHh="FilteredActionEvents";l.uXi="SessionContext";l.latency="Latency";l.performance="Performance";l.VPi="RenderedResults";l.events="Events";l.YMk="CreateResultsMenu";l.hG="UpdateRibbonControls";l.syn="ResultsAggregation";l.DI="IssueQuery";l.cAk="CommandSuggestions";l.error="Error";l.Ywf="LoadModelData";l.ITk="DepsResolveTime";l.UIm="ModelDataWaitTime";l.timedOut="TimedOut";l.D9j="AddinQueryCommandReady";l.Ugl="GetAddinEntitlements";
l.PHi="ProviderMRUEvents";Object(C.a)(l,"EventNames",null,[])},1496:function(C,N,d){d.d(N,"a",function(){return l});C=d(0);class l{constructor(){this.Myf=null;this.oaa=this.Oyf=0}eaf(e,a,k){if(!e)throw Error.argumentNull("referenceList");if(0>a||a>e.length)throw Error.argumentOutOfRange("startIndex");if(0>k||k>e.length)throw Error.argumentOutOfRange("length");if(a+k>e.length)throw Error.argument("Invalid start-length range");this.Myf=e;this.Oyf=a;this.oaa=k}bdb(e,a,k){this.eaf(e.Myf,e.Oyf+a,k)}J(e){if(0>
e||e>=this.oaa)throw Error.argumentOutOfRange("index");return this.Myf[this.Oyf+e]}get count(){return this.oaa}static E0e(e){const a=new l;a.eaf(e,0,e.length);return a}}Object(C.a)(l,"ReadOnlyList",null,[1286])},1501:function(C,N,d){d.d(N,"a",function(){return l});C=d(0);var l;(function(e){e[e.Classifier=0]="Classifier";e[e.AppsForOffice=1]="AppsForOffice";e[e.FindInDocument=2]="FindInDocument";e[e.FindInDocumentScopedSearch=3]="FindInDocumentScopedSearch";e[e.RecentlyUsed=4]="RecentlyUsed";e[e.TryQuery=
5]="TryQuery";e[e.Empty=6]="Empty";e[e.TryCommand=7]="TryCommand";e[e.Assistance=8]="Assistance";e[e.Answer=9]="Answer";e[e.Definition=10]="Definition";e[e.Entity=11]="Entity";e[e.WolframAnswer=12]="WolframAnswer";e[e.Insights=13]="Insights";e[e.People=14]="People";e[e.Document=15]="Document";e[e.Recommended=16]="Recommended";e[e.ServiceClassifier=17]="ServiceClassifier";e[e.ServiceRecommended=18]="ServiceRecommended";e[e.Image=19]="Image";e[e.Notes=20]="Notes";e[e.Learning=21]="Learning";e[e.Feedback=
22]="Feedback";e[e.Template=23]="Template";e[e.Addin=24]="Addin";e[e.OfficeScript=25]="OfficeScript";e[e.AddinStoreEntry=26]="AddinStoreEntry";e[e.None=27]="None";e[e.MergedActions=28]="MergedActions";e[e.MergedScopedSearches=29]="MergedScopedSearches";e[e.MergedSuggestedSearches=30]="MergedSuggestedSearches"})(l||(l={}));Object(C.b)("ResultGroupType",l)},1506:function(C,N,d){d.d(N,"a",function(){return l});C=d(0);d=d(1550);class l extends d.a{constructor(){super();this.info=this.lj=this.eventId=
null}get hea(){return"Misc"}fAb(){this.detail.Z("Type",this.hea);this.detail.Z("EventId",this.eventId);this.detail.Z("Func",this.lj);this.detail.Z("Info",this.info);return this.detail}}Object(C.a)(l,"BasicMergeFailureDetail",d.a,[])},1507:function(C,N,d){d.d(N,"a",function(){return k});C=d(0);var l=d(619),e=d(789),a=d(1522);class k{constructor(n,v=!0){this.im=v&&n?n.HG():n;this.OVb=new l.a}nB(n){this.OVb.add(e.a.yb(n))}HPn(n){this.OVb=n}bri(n){this.im&&(new a.a(this.im,n)).vna.forEach((v,u)=>{u.YW&&
!this.OVb.contains(v)&&(this.OVb.add(v),u.isDeleted?(u=this.im,u.hasProperty(e.a.yW(v))&&u.removeProperty(e.a.yW(v))):this.im.Jva(e.a.yW(v),u.newValue));return!0})}}Object(C.a)(k,"PartialMergeResult",null,[])},1508:function(C,N,d){d.r(N);d.d(N,"CommandResultsUtility",function(){return y});C=d(0);var l=d(1519),e=d(1492),a=d(1520),k=d(1475),n=d(1478),v=d(1471),u=d(1470),t=d(2);class y{static w3c(B,G){if(G&&G.fq){const F={};for(const K of B)G.PQd(K)&&(F[K]=appChrome.selectors.getModelType(K));v.TellMeActor.instance.hG(F)}}static z7n(B){return B.startsWith("btnTellMeOfficeAddIn")}static rNc(B){const G=
v.TellMeActor.instance.ON();return!!G&&G.fq&&!appChrome.selectors.isControlDisabled(B)}static mTd(B,G,F,K){if(v.TellMeActor.instance.Ze&&B){const O=[];for(const H of B)O.push(String.format('{{"Id":"{0}","Score":{1}}}',H.commandId,H.score));B={};B[l.a.suggestions]="[{"+O.join(",")+"}]";B[l.a.fji]=G;B[l.a.groupType]=F;B[l.a.provider]=K;v.TellMeActor.instance.Ze.WB(e.a.cAk,window.performance.now(),B)}}static Knl(B,G){const F=[],K=[];for(const O of G){G=O.commandId;let H=O;O.commandId in B&&(G=B[O.commandId],
H=new a.a(G,O.score));Array.contains(K,G)||(F.push(H),K.push(G))}return F}static RHd(B,G,F,K,O,H,I,J){F.Mcf&&(G=y.Knl(F.Mcf,G));var L=u.a.Xll(G);y.w3c(L,F);var S=[],E=[];L=[];const P=new n.a(I);I=16===I||18===I||7===I||4===I?t.AFrameworkApplication.K?t.AFrameworkApplication.K.rc("TellMeMaxRecommendedResultsToReturn",3):3:0===I||17===I?5:0;for(const T of G)if(!y.Gam(T.commandId)){G=y.z7n(T.commandId);if(F.PQd(T.commandId)&&!G){if(u.a.cii(T.commandId))continue;G=null;O&&H&&(G=O.sDl(T.commandId,H));
y.rNc(T.commandId)?Array.add(S,new k.a(T.commandId,5,G,null,J,T.score)):Array.add(E,new k.a(T.commandId,5,G,null,J,T.score))}else F.Cvb&&G&&K&&Array.add(L,T.commandId.substr(21));if(S.length+L.length>=I)break}F=0;for(O=0;O<S.length&&F<I;O++,F++)P.yz(S[O]);for(S=0;S<E.length&&F<I;S++,F++)P.yz(E[S]);for(E=0;E<L.length&&F<I;E++,F++)K.XMo(B,L[E],P);return P}static Gam(B){y.Ifh||(t.AFrameworkApplication.K&&t.AFrameworkApplication.K.yu("TellMeControlPredictionBlockList")&&t.AFrameworkApplication.K.KB("TellMeControlPredictionBlockList").forEach(G=>
{Array.add(y.Hfh,G.toLowerCase())}),y.Ifh=!0);return Array.contains(y.Hfh,B.toLowerCase())}static zpf(B){return 2<B.length&&";"===B.charAt(0)&&";"===B.charAt(B.length-1)&&!!t.AFrameworkApplication.K&&(t.AFrameworkApplication.K.$("TellMeCommandHookIsEnabled")||t.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeCommandHookIsEnabled",!1))}static iOh(B){const G=new n.a(0);var F=B.split(";");B=v.TellMeActor.instance.ON();for(const K of F)if(0<K.length){F=K.split(":");
const O=2===F.length?F[0]:K;if(!B.PQd(O))break;if(1===F.length)F=new k.a(O,5,null,null,1),G.yz(F);else if(2===F.length)F=new k.a(O,5,F[1],null,1),G.yz(F);else break}return G}static U2j(B,G,F){if(!(G&&G.results&&B&&B.results&&B.results.length))return{returnValue:!1,fOe:B,UOe:G};const K=[];for(var O of G.results)Array.add(K,O.value);O=0;const H=0<G.results.length?G.results[0].score:0;for(const I of B.results)if(I.score>F&&!Array.contains(K,I.value)&&y.rNc(I.value)&&(0<H&&(I.score=H),Array.insert(G.results,
O,I),O++),2===O)break;return 0<O?(F=G.results.length-5,0<F&&G.qSf(F),{returnValue:!0,fOe:B,UOe:G}):{returnValue:!1,fOe:B,UOe:G}}}y.Ifh=!1;y.Hfh=[];Object(C.a)(y,"CommandResultsUtility",null,[])},1518:function(C,N,d){d.d(N,"a",function(){return l});C=d(0);class l{static f9n(e){return e.toString().charCodeAt(0)}static plm(e){return 55296<=e&&57343>=e}static charAt(e,a){return e.charAt(a)}static Jdh(e,a){if(e===a)return!0;"\u00a0"===e&&(e=" ");"\u00a0"===a&&(a=" ");return e===a}static Idh(e,a){if(e===
a)return!0;if(!e||!a||e.length!==a.length)return!1;e=l.eQi(e);a=l.eQi(a);return e===a}static eQi(e){return e.replace(l.LRc," ")}static glb(e,a,k){return e.substring(a,a+k)}}l.LRc=RegExp("\u00a0","g");Object(C.a)(l,"CharUtils",null,[])},1519:function(C,N,d){d.d(N,"a",function(){return l});C=d(0);class l{}l.appName="AppName";l.zda="CloseAllMenus";l.commandId="CommandId";l.context="Context";l.culture="Culture";l.message="Message";l.errorMessage="ErrorMessage";l.event="Event";l.Rla="CorrelationID";l.j2m=
"ParentUiElement";l.query="Input";l.MHb="QueryID";l.yIi="QueryLength";l.Abc="QueryIndex";l.tyn="ResultsList";l.suggestions="Suggestions";l.scenario="Scenario";l.sessionId="SessionID";l.source="Source";l.timeStamp="Time";l.Lej="UiElement";l.L2d="ReactUx";l.value="Val";l.statusCode="StatusCode";l.KGn="Service";l.isSuccess="IsSuccess";l.P9n="TokenAcquired";l.Rpm="LatencyType";l.groupName="GroupName";l.l6="GroupIndex";l.groupType="GroupType";l.oyn="ResultInfoList";l.resultType="ResultType";l.$2f="SubResultType";
l.Sem="IsInputBlur";l.Tem="IsInputFocus";l.Akm="IsShortCutUsed";l.actionType="ActionType";l.count="Count";l.D_k="DwellTime";l.fji="IsZeroTerm";l.Quo="WordsCount";l.fQd="IsSearchUxEnabled";l.Olm="IsTellMeInHeaderEnabled";l.module="Module";l.resultIndex="ResultIndex";l.N4e="DisplayIndex";l.t1k="EnableList";l.provider="Provider";l.contentType="ContentType";l.bkm="IsSelectionBased";l.Phk="BeginPerformanceMarker";l.O1k="EndPerformanceMarker";l.f4m="PerformanceMeasure";Object(C.a)(l,"Columns",null,[])},
1520:function(C,N,d){d.d(N,"a",function(){return l});C=d(0);class l{constructor(e,a){this.commandId=e;this.score=a}}Object(C.a)(l,"CommandSuggestion",null,[])},1522:function(C,N,d){C=d(0);var l=d(387),e=d(789),a=d(244),k=d(44);class n{constructor(u,t,y){this.uRj=u;this.LNj=t;this.gNj=y;this.Ute=new a.a(Object(k.a)(this,this.fuk,"checkIfDifferent"))}get ejb(){return this.uRj}get oldValue(){return this.LNj}get newValue(){return this.gNj}get Ffb(){return!(void 0===this.newValue||null===this.newValue)&&
(void 0===this.oldValue||null===this.oldValue)}get isDeleted(){return(void 0===this.newValue||null===this.newValue)&&!(void 0===this.oldValue||null===this.oldValue)}get YW(){return this.Ffb||this.isDeleted||this.Ute.value}fuk(){return this.Ffb||this.isDeleted?!0:!e.a.Pdh(this.ejb,this.oldValue,this.newValue)}}Object(C.a)(n,"PropertyDiff",null,[]);d.d(N,"a",function(){return v});class v{constructor(u,t){this.INj=u;this.dNj=t;this.Ute=new a.a(()=>this.BNc());this.wRj=new a.a(Object(k.a)(this,this.v4k,
"evaluatePropertyDiffs"))}get ku(){return this.INj}get Df(){return this.dNj}get Ffb(){return!!this.Df&&!this.ku}get isDeleted(){return!this.Df&&!!this.ku}get YW(){return this.Ffb||this.isDeleted||this.Ute.value}get vna(){return this.wRj.value}BNc(u=null){let t=!1;this.vna.forEach((y,B)=>{t=B.YW&&(!u||7!==u.J(y));return!t});return t}v4k(){const u=new l.a;var t=this.Df,y=this.ku;if(this.Ffb){y=t.Mj();for(var B=0;B<y.length;B++){var G=y[B];u.Z(e.a.yb(G),new n(G,null,t.$P(G)))}}else if(this.isDeleted)for(t=
y.Mj(),B=0;B<t.length;B++)G=t[B],u.Z(e.a.yb(G),new n(G,y.$P(G),null));else{B=y.Mj();for(G=0;G<B.length;G++){var F=B[G],K=e.a.yb(F),O=y.$P(F);const H=t.hasProperty(F)?t.$P(F):null;u.Z(K,new n(F,O,H))}B=t.Mj();for(G=0;G<B.length;G++)F=B[G],y.hasProperty(F)||(K=e.a.yb(F),O=t.$P(F),u.Z(K,new n(F,null,O)))}return u}}Object(C.a)(v,"MergeableObjectDiff",null,[])},1531:function(C,N,d){d.d(N,"b",function(){return n});d.d(N,"a",function(){return u});var l=d(216),e=d(387),a=d(619),k=d(1662);const n=(y,B,G)=>
{const F=v(y,B,G);let K=0,O=0,H=0,I=new k.a;const J=new l.a;for(let L=0;L<F.length;L++){const S=F.lg(L+1);I.Nrd(y.lg(K));I.Qrd(B.lg(O));I.Vrd(G.lg(H));K++;O++;for(H++;K<y.length&&(!S||!S.equals(y.lg(K)));)I.Nrd(y.lg(K)),K++;for(;O<B.length&&(!S||!S.equals(B.lg(O)));)I.Qrd(B.lg(O)),O++;for(;H<G.length&&(!S||!S.equals(G.lg(H)));)I.Vrd(G.lg(H)),H++;J.add(I);I=new k.a}for(;K<y.length;)I.Nrd(y.lg(K)),K++;for(;O<B.length;)I.Qrd(B.lg(O)),O++;for(;H<G.length;)I.Vrd(G.lg(H)),H++;I.isEmpty||J.add(I);return J},
v=(y,B,G)=>{const F=new l.a,K=B.cG(),O=G.cG();y.forEach(H=>{K.contains(H)&&O.contains(H)&&F.add(H);return!0});return F},u=(y,B,G)=>{y=y||new l.a;B=B||new l.a;G=G||new l.a;const F=new l.a,K=new e.a(0),O=new a.a;for(var H=0;H<y.length;H++){var I=y.lg(H);K.Z(I,H)}for(y=H=0;H<B.length&&y<G.length;){I=B.lg(H);let J=G.lg(y),L=K.Jy(I,-1),S=K.Jy(J,-1);-1===L?(t(O,F,I),H++):-1===S?(t(O,F,J),y++):L===S?(t(O,F,I),H++,y++):L<S?H++:y++}for(;H<B.length;H++)I=B.lg(H),-1===K.Jy(I,-1)&&t(O,F,I);for(;y<G.length;y++)B=
G.lg(y),-1===K.Jy(B,-1)&&t(O,F,B);return F},t=(y,B,G)=>{y.contains(G)||(B.add(G),y.add(G))}},1532:function(C,N,d){d.d(N,"a",function(){return e});C=d(0);var l=d(59);class e{constructor(){this.cp=0;this.id=l.a.create()}}Object(C.a)(e,"LcsUpdateHint",null,[1378,79])},1533:function(C,N,d){d.d(N,"a",function(){return l});C=d(0);class l{}l.tellMe="TellMe";l.loki="Loki";l.substrate="Substrate";l.Abc="QueryIndex";l.Y$i="TellMeRanker";l.Z$i="TellMeRankerLogging";Object(C.a)(l,"Services",null,[])},1534:function(C,
N,d){d.d(N,"a",function(){return l});C=d(0);class l{}l.YLa="HttpRequest";l.provider="Provider";Object(C.a)(l,"LatencyTypes",null,[])},1537:function(C,N,d){C=d(0);var l=d(17),e=d(5),a=d(216),k=d(150),n=d(205),v=d(59),u=d(619),t=d(44),y=d(250),B=d(1550);class G extends B.a{constructor(){super();this.SIb=null}get hea(){return"CreateMergeBlock"}fAb(){this.detail.Z("Type",this.hea);this.detail.Z("Revision",this.SIb);return this.detail}}Object(C.a)(G,"CreateMergeBlockFailureDetail",B.a,[]);var F=d(1587),
K=d(1589),O=d(1661),H=d(1551),I=d(1507),J=d(1714);d.d(N,"a",function(){return L});class L{static Jxd(S,E,P,T,U,X,Y){let ca;ca="";const da=new a.a;for(let ra=0;ra<P.length;ra++){var ua=void 0;let qa;ua=F.a.bol(E,P.J(ra),T,U,X,Y,S);if(!ua)return{returnValue:null,y0a:ca};({Tzf:qa,y0a:ua}=ua.qUh());if(!qa)return{returnValue:null,y0a:ca};ca+=ua;da.EA(da.length,qa)}return{returnValue:da,y0a:ca}}static muh(S,E,P,T,U,X,Y,ca){let da,ua,ra,qa,ka,la;la=ka=qa=ra=ua=da=null;({y0a:qa,returnValue:da}=L.Jxd(E,Ha=>
S.runtime.lk.J(Ha),P,1,X,Y,ca));if(!da)return k.a.instance.Wa(17044299,1,1,"ParagraphMergeUtils:CreateMergeBlocksForMergeInputObjects returned failure as we were unable to create merge blocks for base revision"),S.logger.Pg(Object.assign(new G,{SIb:"Base"})),{returnValue:!1,MJ:da,RFc:ua,p3c:ra,Isd:qa,gCd:ka,oce:la};({y0a:ka,returnValue:ua}=L.Jxd(E,Ha=>S.runtime.Yt.J(Ha)||S.runtime.lk.J(Ha),T,2,X,Y,ca));if(!ua)return k.a.instance.Wa(17044300,1,1,"ParagraphMergeUtils:CreateMergeBlocksForMergeInputObjects returned failure as we were unable to create merge blocks for favoured revision"),
S.logger.Pg(Object.assign(new G,{SIb:"Favored"})),{returnValue:!1,MJ:da,RFc:ua,p3c:ra,Isd:qa,gCd:ka,oce:la};({y0a:la,returnValue:ra}=L.Jxd(E,Ha=>S.runtime.lq.J(Ha)||S.runtime.lk.J(Ha),U,4,X,Y,ca));return ra?{returnValue:!0,MJ:da,RFc:ua,p3c:ra,Isd:qa,gCd:ka,oce:la}:(k.a.instance.Wa(17044301,1,1,"ParagraphMergeUtils:CreateMergeBlocksForMergeInputObjects returned failure as we were unable to create merge blocks for unfavoured revision"),S.logger.Pg(Object.assign(new G,{SIb:"Unfavored"})),{returnValue:!1,
MJ:da,RFc:ua,p3c:ra,Isd:qa,gCd:ka,oce:la})}static uoh(S,E=!1){const P=new a.a;let T=0;for(;T<S.length;){var U=S.J(T);if(1===U.type||4===U.type||2===U.type)P.add(U),T++;else if(3===U.type){let Y="";Y+=U.character;T++;let ca=U.EMa,da=!1;for(;T<S.length;T++){var X=S.J(T);3===X.type?U.runId===X.runId&&U.oI.equals(X.oI)&&(U.x$===X.x$||U.vBa===X.vBa)&&U.wE.Oz(X.wE)&&(!E||U.xt&&U.xt.equals(X.xt))?(Y+=X.character,X.EMa&&(ca=!0)):da=!0:da=!0;if(da){U=new J.a(null,U.source,U.Cj,U.Bg,U.runId,U.oI,Y,U.Mhb,!0,
ca,U.x$,U.vBa,U.tOa,U.wE,U.xt);P.add(U);break}}}}k.a.instance.Wa(17044302,1,4,"CombineGranularMergeBlocks: List of non granular merge blocks after merge {0}",P.Dq());return P}static Uzk(S,E=!1){const P=new a.a;let T=0;for(;T<S.length;){var U=S.J(T);if(1===U.type||4===U.type||2===U.type)P.add(U),T++;else if(3===U.type){let Y=U.character.toString();T++;let ca=U.EMa;for(;T<S.length;T++){var X=S.J(T);if(3===X.type&&L.FTn(U,X,E))Y+=X.character,X.EMa&&(ca=!0);else break}U=new J.a(null,U.source,U.Cj,U.Bg,
U.runId,U.oI,Y,U.Mhb,!0,ca,U.x$,U.vBa,U.tOa,U.wE,U.xt);P.add(U)}}k.a.instance.Wa(50931345,1,4,"CombineGranularMergeBlocks: List of non granular merge blocks after merge {0}",P.Dq());return P}static FTn(S,E,P){return S.runId===E.runId&&S.oI.equals(E.oI)&&(S.x$===E.x$||S.vBa===E.vBa)&&S.wE.Oz(E.wE)&&(!P||!!S.xt&&S.xt.equals(E.xt))}static ANn(S,E,P,T,U,X,Y,ca,da,ua,ra,qa,ka,la,Ha,wa){S.setPropertyString(P.im,l.a.lo,U);S.setPropertyUint32(P.im,e.a.Nc,T);S.setPropertyUint32s(P.im,e.a.Hq,X);S.setPropertyUint32s(P.im,
e.a.gt,Y);S.setPropertyObjectIds(P.im,l.a.un,da);S.hasProperty(P.im,e.a.nj)&&S.setPropertyUint32(P.im,e.a.nj,L.Afl());E&&E(10)&&S.setPropertyObjectIds(P.im,e.a.Wu,wa);T=!1;for(U=0;U<ua.length;U++)if(ua.J(U)){T=!0;break}T&&S.setPropertyBools(P.im,e.a.PDf,ua);L.Qok(E,S,P,ra,qa,ka,la);L.Rok(S,P,Ha);P.nB(l.a.lo);P.nB(e.a.Nc);P.nB(e.a.Hq);P.nB(e.a.gt);P.nB(l.a.un);P.nB(e.a.PDf);P.nB(l.a.mm);P.nB(l.a.Zkb);P.nB(e.a.KLa);P.nB(e.a.BDa);P.nB(l.a.xua);P.nB(e.a.Wu);S.hasProperty(P.im,e.a.nj)&&P.nB(e.a.nj);0<
ca.length?S.setPropertyUint32s(P.im,l.a.mm,ca):P.im.removeProperty(l.a.mm)}static Qok(S,E,P,T,U,X,Y){if(S(103)){S=T.contains(!0,(ca,da)=>da);L.RYf(E,P,l.a.xua,S?T:null);L.RYf(E,P,l.a.Zkb,L.KRi(T,U));L.RYf(E,P,e.a.KLa,L.KRi(T,X));T=!1;for(U=0;U<Y.length;U++)0!==Y.J(U)&&(T=!0);T?E.setPropertyUint32s(P.im,e.a.BDa,Y):P.im.removeProperty(e.a.BDa)}}static Rok(S,E,P){const T=Y=>Y;var U=Object(t.a)(S,S.setPropertyBools,"setPropertyBools");L.AJa(E,P.vfb,T,U,e.a.UBa);L.AJa(E,P.Nbb,T,U,e.a.Vda);L.AJa(E,P.z1a,
T,U,e.a.ADa);U=Y=>0<Y.length;var X=Object(t.a)(S,S.setPropertyStrings,"setPropertyStrings");L.AJa(E,P.ufb,U,X,e.a.VBa);L.AJa(E,P.Mbb,U,X,e.a.kAa);L.AJa(E,P.Zib,U,X,e.a.VEa);U=Y=>!!Y;X=Object(t.a)(S,S.setPropertyListOfMilliseconds,"setPropertyListOfMilliseconds");L.AJa(E,P.wfb,U,X,e.a.WBa);L.AJa(E,P.$Wa,U,X,e.a.lAa);L.AJa(E,P.ajb,U,X,e.a.WEa);P.z1a.any(T)?L.AJa(E,P.$ib,()=>!0,Object(t.a)(S,S.setPropertyObjectIds,"setPropertyObjectIds"),e.a.cwa):E.im.removeProperty(e.a.cwa)}static KRi(S,E){const P=
new a.a;let T=!1;for(let U=0;U<S.length;U++){const X=E.J(U)&&!S.J(U);P.add(X);T=X||T}return T?P:null}static RYf(S,E,P,T){T?S.setPropertyBools(E.im,P,T):E.im.removeProperty(P)}static Afl(){return n.a.RF()}static mVh(S,E){return S.runtime.Yt.Jy(E,S.runtime.lk.J(E)||S.runtime.lq.get(E))}static LIc(S,E,P,T,U){let X;X=new a.a;const Y=!!P&&P(10);if(S.runtime.Qb.isFeatureEnabled(78)){var ca=L.Uzk(T,Y);var da=L.uoh(T,Y);ca.length!==da.length&&S.runtime.Qb.Vq(78)}else ca=L.uoh(T,Y);da=0;let ua="",ra=new a.a,
qa=new a.a,ka=new a.a,la=new a.a,Ha=new a.a,wa=new a.a,Ca=new a.a,Ja=new a.a,bb=new a.a;const ha=new O.a;let ia=new a.a;var va=ca.J(ca.length-1);if(2!==va.type&&4!==va.type)return k.a.instance.Wa(17044304,1,2,"GetMergeableObjectsFromMergeBlocks: Last merge block not an EOP or table but is [Type: {0}] instead",va.type),S.logger.Pg(Object.assign(new H.a,{lj:"GetMergeableObjectsFromMergeBlocks",eventId:"bbbnq",info:String.format("Last merge block is not EOP or table but {0}",va.type)})),{returnValue:!1,
m_d:X};var Ka=0;for(va=0;va<ca.length;va++){var Xa=ca.J(va),xa=null;if(1===Xa.type||3===Xa.type)xa=Xa,ua+=xa.text;else if(4===Xa.type){Xa=L.mVh(S,Xa.Cj);Xa=new I.a(Xa);X.add(Xa);continue}xa?(ra.add(xa.runId),qa.add(xa.Bg),Ka+=xa.text.length,ka.add(Ka),la.add(xa.oI),Ha.add(xa.Mhb),wa.add(xa.EMa),Ca.add(xa.x$),Ja.add(xa.vBa),bb.add(xa.tOa),ha.vfb.add(xa.wE.lWl),ha.Nbb.add(xa.wE.OVl),ha.z1a.add(xa.wE.LWl),ha.ufb.add(xa.wE.insertion.author),ha.Mbb.add(xa.wE.deletion.author),ha.Zib.add(xa.wE.zDa.author),
ha.wfb.add(xa.wE.insertion.fSc),ha.$Wa.add(xa.wE.deletion.fSc),ha.ajb.add(xa.wE.zDa.fSc),ha.$ib.add(xa.wE.zDa.QMf),Y&&ia.add(xa.xt)):ra.length||(ra.add(0),qa.add(0),ka.add(0),la.add(v.a.nil),Ha.add(!1),wa.add(!1),Ca.add(!1),Ja.add(!1),bb.add(0),ha.vfb.add(!1),ha.Nbb.add(!1),ha.z1a.add(!1),ha.ufb.add(""),ha.Mbb.add(""),ha.Zib.add(""),ha.wfb.add(0),ha.$Wa.add(0),ha.ajb.add(0),ha.$ib.add(v.a.nil));if(2===Xa.type){Ka=Xa;Xa=Ka.Nc;ka.mF(ka.length-1);xa=U.J(da);if(!xa)return k.a.instance.Wa(17044307,1,2,
"GetMergeableObjectsFromMergeBlocks: Failed to get a paragraphId. [ParagraphIdx: {0}] [ParagraphIds.Count: {1}] [MergeBlocks.Length: {2}] [CombinedMergeBlockIdx: {3}] [CombinedMergeBlocks.Length: {4}]",da,U.length,T.length,va,ca.length),S.logger.Pg(Object.assign(new H.a,{lj:"GetMergeableObjectsFromMergeBlocks",eventId:"bbbnt",info:"Failed to get ParaId"})),k.a.instance.nha(17044308,1,4,"GetMergeableObjectsFromMergeBlocks Paragraphs",U.Dq()),k.a.instance.nha(17044309,1,4,"GetMergeableObjectsFromMergeBlocks MergeBlocks",
T.Dq()),k.a.instance.nha(17044310,1,4,"GetMergeableObjectsFromMergeBlocks CombinedMergeBlocks",ca.Dq()),{returnValue:!1,m_d:X};if(xa=L.mVh(S,xa))xa=new I.a(xa.HG()),L.ANn(E,P,xa,Ka.Nc,ua,ra,qa,ka,la,Ha,wa,Ca,Ja,bb,ha,ia),X.add(xa);k.a.instance.Wa(17044312,1,4,"Merge result for: [GraphNode: {0}] [WordId: {1}] [RunIds: {2}] [ParaIds: {3}] [RunIndices: {4}] [ProofingRequired: {5}] [HasSpellingError: {6}] [HasGrammarError: {7}] [FormattingIds: {8}] {9} [ProofingErrorHint: {10}]",Ka.Cj,Xa,ra.Dq(),qa.Dq(),
ka.Dq(),wa.Dq(),Ca.Dq(),Ja.Dq(),la.Dq(),"",bb.Dq());da++;ua="";ra=new a.a;qa=new a.a;ka=new a.a;la=new a.a;Ha=new a.a;wa=new a.a;Ca=new a.a;Ja=new a.a;bb=new a.a;ha.reset();Ka=0;ia=new a.a}}return{returnValue:!0,m_d:X}}static exn(S,E){const P=S.runtime.Rm.J(y.a.CK),T=E.getPropertyObjectIds(P.im,e.a.R_);for(let U=0;U<T.length;U++)S.runtime.Rm.remove(T.J(U));E.setPropertyObjectIds(P.im,e.a.R_,new a.a);E.setPropertyString(P.im,e.a.DQa,v.a.nil.toString());P.nB(e.a.R_);P.nB(e.a.DQa)}static r4l(S,E){if(S.runtime.Rm.xb(y.a.CK))return null;
const P=new I.a(S.runtime.lk.J(y.a.CK).HG());E.setPropertyString(P.im,e.a.DQa,S.output.ZL.last().id.toString());E.setPropertyObjectIds(P.im,e.a.R_,new a.a);P.nB(e.a.R_);P.nB(e.a.DQa);S.runtime.Rm.Z(y.a.CK,P);return P}static Cff(S){const E=new a.a;S.forEach(P=>{E.add(P.id);return!0});return E}static $8b(S,E,P,T){let U=0;P.forEach(X=>{K.a(X,E+U++,1);393230===X.Qc&&S.getPropertyObjectIds(X,l.a.un).forEach(Y=>{T.add(Y);return!0});return!0})}static $wm(S,E){const P=new u.a;let T=0;E.forEach(U=>{if(P.contains(U))return!0;
P.add(U);if(({index:T}=L.Axf("BaseFormatting_",T,U,X=>S.runtime.lk.J(X))).returnValue||({index:T}=L.Axf("FavoredFormatting_",T,U,X=>S.runtime.Yt.J(X))).returnValue||({index:T}=L.Axf("ConflictingFormatting_",T,U,X=>S.runtime.lq.J(X))).returnValue)return!0;T++;return!0})}static Axf(S,E,P,T){if(P=T(P))if(K.a(P,S+E,1),1179649===P.Qc)return E++,{returnValue:!0,index:E};return{returnValue:!1,index:E}}static p5e(S){return!!S.runtime.lk.J(y.a.CK)}static AJa(S,E,P,T,U){E.any(P)?(T(S.im,U,E),S.nB(U)):S.im.removeProperty(U)}static P_i(S,
E){const P=new a.a;P.add(0);const T=S?S.length:0;for(let U=0;U<T;U++)P.insert(U+1,S.lg(U));P.insert(P.length,E);return P}}Object(C.a)(L,"ParagraphMergeUtils",null,[])},1548:function(C,N,d){d.d(N,"a",function(){return e});C=d(0);var l=d(216);class e{constructor(a,k,n){this.om=null;this.Fl=a;this.source=k;this.Cj=n}get type(){return this.Fl}get v3a(){return!1}get Idm(){return 1===(this.source&1)}get Jdm(){return 2===(this.source&2)}get Kdm(){return 4===(this.source&4)}I2(){return!1}toString(){return String.format("[Source: {0}] [Type: {1}]",
this.rjl(),this.h2b())}rjl(){let a="";this.Idm&&(a+="Base");this.Jdm&&(a+="FavoredUpdate");this.Kdm&&(a+="UnfavoredUpdate");return a}h2b(){return""}Oz(a){return this.type===a.type}d1c(){const a=new l.a;a.add(this);return a}get length(){return 0}}Object(C.a)(e,"AMergeBlock",null,[91,92])},1549:function(C,N,d){d.d(N,"a",function(){return l});C=d(0);d=d(1548);class l extends d.a{constructor(e,a,k){super(2,e,a);this.Nc=k}toString(){return String.format("{0} [WordId: {1}] [GraphNodeId: {2}]",super.toString(),
this.Nc,this.Cj)}h2b(){return"Eop"}clone(){return new l(this.source,this.Cj,this.Nc)}Oz(e,a,k,n=!1,v=!0){return super.Oz(e,a,k,n)?v?e.Nc===this.Nc:e.Cj===this.Cj&&e.Nc===this.Nc:!1}get length(){return 1}}Object(C.a)(l,"EopMergeBlock",d.a,[])},1550:function(C,N,d){d.d(N,"a",function(){return e});C=d(0);var l=d(387);class e{constructor(){this.detail=new l.a}}Object(C.a)(e,"AMergeFailureDetail",null,[1776])},1551:function(C,N,d){d.d(N,"a",function(){return l});C=d(0);d=d(1506);class l extends d.a{constructor(){super()}get hea(){return"ParagraphMerge"}}
Object(C.a)(l,"ParagraphMergeFailureDetail",d.a,[])},1552:function(C,N,d){d.d(N,"a",function(){return l});C=d(0);d=d(1506);class l extends d.a{constructor(){super()}get hea(){return"RdOpLcs"}}Object(C.a)(l,"ReducedOpsLcsFailureDetail",d.a,[])},1553:function(C,N,d){d.d(N,"a",function(){return l});C=d(0);d=d(1506);class l extends d.a{constructor(){super()}get hea(){return"TableMerge"}}Object(C.a)(l,"TableMergeFailureDetail",d.a,[])},1556:function(C,N,d){C=d(0);class l{constructor(){this.y2c=this.uMc=
null;this.zzf=this.score=this.NRc=0}DKf(F,K,O){this.score=F.J(K);++K;this.uMc=F.J(K)?O.kla(F.J(K)):null;++K;this.y2c=F.J(K)?O.kla(F.J(K)):null;++K;this.NRc=F.J(K);++K;this.zzf=F.J(K);++K;return K}}Object(C.a)(l,"TokenStringGeneratorInit",null,[]);class e{constructor(F,K,O,H,I){this.Qcb=F;this.count=K;this.$Cd=O;this.IN=H;this.depth=I}}Object(C.a)(e,"ErrorTolerantTrieMatch",null,[]);var a=d(1601),k=d(1679);class n{constructor(F=null,K=0,O=0,H=0){this.vYj=F||new k.a;this.Ksa=K;this.IN=O;this.depth=
H}get M3(){return this.vYj}getKey(){return this.M3.Vw.toString()+":"+this.Ksa.toString()}}Object(C.a)(n,"TrieBookmark",null,[]);class v{constructor(F,K){this.sNa=F;this.Gyf=K}LCm(F){if(null==F)throw Error.argumentNull("prefix");let K={};var O=K[""]=new n;this.FLd(O,K);for(O=0;O<F.length;++O){const H=F.charCodeAt(O),I={};for(let J in K)this.u$j(H,K[J],I);K=I}return this.zao(K)}FLd(F,K){if(!(F.IN>=this.Gyf)&&(F=new n(a.a.tXe(F.M3),F.Ksa,F.IN+1,F.depth),F.M3.DE&a.a.X4a&&(F.Ksa+=1),this.sNa.HLb(F.M3))){F.depth+=
1;let O=!0;for(;O;)v.Wce(F,K),this.FLd(F,K),F.Ksa+=this.sNa.x2b(F.M3,!0)+(F.M3.DE&a.a.X4a?1:0),O=this.sNa.T2c(F.M3)}}u$j(F,K,O){K.IN+1<=this.Gyf&&(K.IN+=1,v.Wce(K,O),--K.IN);K.M3.DE&a.a.X4a&&(K.Ksa+=1);if(this.sNa.HLb(K.M3)){K.depth+=1;let H=!0;for(;H;)K.M3.JMb===F?(v.Wce(K,O),this.FLd(K,O)):K.IN+1<=this.Gyf&&(K.IN+=1,v.Wce(K,O),this.FLd(K,O),--K.IN),K.Ksa+=this.sNa.x2b(K.M3,!0)+(K.M3.DE&a.a.X4a?1:0),H=this.sNa.T2c(K.M3)}}zao(F){const K=[];for(var O in F){const H=F[O];if(!H.M3.Vw)continue;const I=
!!(H.M3.DE&a.a.X4a),J=this.sNa.x2b(H.M3,!1)+(I?1:0);Array.add(K,new e(H.Ksa,J,I,H.IN,H.depth))}K.sort((H,I)=>{let J=H.Qcb-I.Qcb;return J||(J=-(H.count-I.count))?J:J=H.depth-I.depth});if(2>K.length)return K;F=[];for(O=0;O<K.length;)O+=v.xcj(O,K,F);return F}static Wce(F,K){const O=F.getKey();O in K?(K=K[O],K.IN=Math.min(K.IN,F.IN)):K[O]=new n(a.a.tXe(F.M3),F.Ksa,F.IN,F.depth)}static xcj(F,K,O){const H=K[F];let I=H.Qcb;const J=I+H.count;let L=1,S=H.$Cd;for(;F+L<K.length&&K[F+L].Qcb<J;){const E=K[F+L];
E.Qcb>I&&(Array.add(O,new e(I,E.Qcb-I,S,H.IN,H.depth)),S=!1);L+=v.xcj(F+L,K,O);I=E.Qcb+E.count}I<J&&Array.add(O,new e(I,J-I,S,H.IN,H.depth));return L}}Object(C.a)(v,"ErrorTolerantTrieLookupEngine",null,[1340]);class u extends l{constructor(F,K,O){super();this.e7h=this.oBi=!1;this.TEh=null;if(F){var H=0;try{H=this.DKf(F,H,K);this.oBi=1===F.J(H);++H;this.e7h=1===F.J(H);++H;const I=F.J(H);this.TEh=this.C2m(O,I)}catch(I){throw Error.argument("initData");}}}C2m(F,K){return new v(F,K)}}Object(C.a)(u,"FuzzyMatchTokenStringGeneratorInit",
l,[]);class t extends l{constructor(F,K){super();this.query=this.name=null;if(F){this.annotations=K.annotations;var O=0;try{O=this.DKf(F,O,K),this.name=K.nE(F.J(O)),++O,this.query=K.VJ(F.J(O))}catch(H){throw Error.argument("initData");}}}}Object(C.a)(t,"QueryTokenStringGeneratorInit",l,[]);class y extends l{constructor(F,K){super();if(F)try{this.DKf(F,0,K)}catch(O){throw Error.argument("initData");}}}Object(C.a)(y,"SurfaceStringTokenStringGeneratorInit",l,[]);var B=d(1496);d.d(N,"a",function(){return G});
class G{constructor(F){this.wyf=F}get uMc(){return this.wyf.uMc}get y2c(){return this.wyf.y2c}get NRc(){return this.wyf.NRc}static create(F,K,O){const {SurfaceStringTokenStringGenerator:H}=d(1811),{QueryTokenStringGenerator:I}=d(1812),{FuzzyMatchTokenStringGenerator:J}=d(1813);let L=0;try{if(F.J(L)!==G.ewb)throw Error.argument("initData","Input does not represent a token string generator");++L;const S=F.J(L);++L;const E=new B.a;E.bdb(F,L,F.count-L);switch(S){case H.Wzc:return new H(new y(E,K));case I.Wzc:return new I(new t(E,
K));case J.Wzc:return new J(new u(E,K,O));default:throw Error.argument("initData");}}catch(S){throw Error.argument("initData");}}static z9g(F,K,O,H,I,J){F=F.U9n.getId(K,null);if(0>F)return++J,J;G.A9g(F,O,H,I);return J}static A9g(F,K,O,H){Array.add(H.R2f,F);Array.add(H.M8i,K);++H.zgc[O]}}G.ewb=1099767983;Object(C.a)(G,"TokenStringGenerator",null,[1303])},1586:function(C,N,d){d.d(N,"a",function(){return a});C=d(0);var l=d(216);N=d(1548);var e=d(1518);class a extends N.a{constructor(k,n,v){super(k,n,
v)}C0n(k){let n;n=null;if(!this.text||!this.v3a||0>=k||k>=this.length)return{returnValue:!1,l7i:n};n=new l.a;const v=this.clone();v.W_c(e.a.glb(this.text,0,k));const u=this.clone();u.W_c(e.a.glb(this.text,k,this.length-k));n.add(v);n.add(u);return{returnValue:!0,l7i:n}}I2(){return!0}get length(){return this.text.length}}Object(C.a)(a,"ATextMergeBlock",N.a,[])},1587:function(C,N,d){d.d(N,"a",function(){return e});C=d(0);var l=d(150);class e{SQe(a,k){return a+("[Block: "+k+"] ")}static bol(a,k,n,v,
u,t,y){const {ParagraphMergeBlockCreator:B}=d(1851),{TableMergeBlockCreator:G}=d(1854);if(393230===k.Qc)return new B(a,k,n,u,t,v(10),y);if(393250===k.Qc)return new G(k,n);l.a.instance.Wa(4051652,1,1,"Trying to Run GetMergeBlockList on unknown Runtime Class ID {0}.",k.Qc);return null}}Object(C.a)(e,"MergeBlockCreator",null,[])},1588:function(C,N,d){d.d(N,"a",function(){return k});C=d(0);var l=d(5),e=d(59);N=d(1586);var a=d(1522);class k extends N.a{constructor(n,v,u,t,y,B,G,F,K,O,H,I,J,L){super(v,
u,t);this.Bg=y;this.runId=B;this.Mhb=F;this.oEj=G;this.Ahe=n;this.EMa=K;this.x$=O;this.vBa=H;this.tOa=I;this.wE=J;this.xt=L}get Cyc(){return this.Ahe}get oI(){return this.oEj}get yzb(){return this.Cyc(this.oI)}toString(){return String.format("{0} [ParaId: {1}] [RunId: {2}] [NewlyTypedRun: {3}] [GraphNodeId: {4}] [FormatId: {5}] [ChangeId: {6}]",super.toString(),this.Bg,this.runId,this.Mhb,this.Cj,this.oI.toString(),this.xt?this.xt.toString():"NULL")}Oz(n,v,u,t=!1){if(!super.Oz(n,v,u,t))return!1;if(t)return!0;
if(!this.wE.Oz(n.wE)||this.xt&&!this.xt.equals(n.xt))return!1;if(this.oI.equals(n.oI)||this.oI.equals(e.a.nil)||n.oI.equals(e.a.nil))return!0;n=new a.a(this.yzb,n.yzb);v=v.Qth(this.yzb,u);return n.BNc(v.T0d)?!1:!0}get I9l(){return this.I2()&&"\ufffc"===this.text&&this.yzb?this.yzb.hasProperty(l.a.Eq)||1179725!==this.yzb.Qc?!0:!1:!1}}Object(C.a)(k,"AUserRunMergeBlock",N.a,[])},1589:function(C,N,d){d.d(N,"a",function(){return e});var l=d(150);const e=(a,k,n=4)=>{a?l.a.instance.nha(4273285,n,4,k,a.r2c()):
l.a.instance.Wa(4293845,n,1,k,"{0}: Node was null.",k)}},1590:function(C,N,d){d.d(N,"e",function(){return v});d.d(N,"a",function(){return u});d.d(N,"d",function(){return t});d.d(N,"b",function(){return y});d.d(N,"c",function(){return B});var l=d(5),e=d(17),a=d(59),k=d(1002),n=d(1531);const v=(K,O,H)=>{const I=new k.a;let J=a.a.nil;O=I.getPropertyObjectId(O,l.a.qlb);O.equals(a.a.nil)||(K=K.runtime.lk.J(O),H&&(K=H.Jy(O,K)),K&&(J=I.getPropertyObjectId(K,l.a.qlb)));return J},u=(K,O,H,I,J)=>{const L=new k.a;
let S=null;var E=L.getPropertyObjectId(H,l.a.qlb);E!==a.a.nil&&(S=K.runtime.lk.J(E),O&&(S=O.Jy(E,S)));if(S){E=L.getPropertyObjectIds(S,e.a.qf);for(J=0;J<E.length&&!E.J(J).equals(H.id);J++);J===E.length&&(J=-1)}H=v(K,H,O);if(!H.equals(a.a.nil)&&(K=K.runtime.lk.J(H),O&&(K=O.Jy(H,K)),K)){O=L.getPropertyObjectIds(K,e.a.qf);for(I=0;I<O.length&&!O.J(I).equals(S.id);I++);I===O.length&&(I=-1)}return{rowIndex:I,nZb:J}},t=(K,O,H,I,J)=>{var L=new k.a;let S=null;var E=K.runtime.lk.J(H);O&&(E=O.Jy(H,E));if(!E)return null;
E=L.getPropertyObjectIds(E,e.a.qf);H=null;I<E.length&&(I=E.J(I),H=K.runtime.lk.J(I),O&&(H=O.Jy(I,H)));H&&(L=L.getPropertyObjectIds(H,e.a.qf),J<L.length&&(J=L.J(J),S=K.runtime.lk.J(J),O&&(S=O.Jy(J,S))));return S},y=(K,O,H)=>{let I,J;J=I=-1;const L=(new k.a).getPropertyObjectId(H,l.a.qlb);var S=v(K,H,O);if(S.equals(a.a.nil)||L.equals(a.a.nil))return{rowIndex:I,nZb:J};O=K.runtime.Z3f;var E=O.J(S);if(!E){E=G(K,S);if(!E)return{rowIndex:I,nZb:J};O.Z(S,E)}for(S=0;S<E.length;S++)if(E.J(S).equals(L)){I=S;
break}E=O.J(L);if(!E){E=F(K,L);if(!E)return{rowIndex:I,nZb:J};O.Z(L,E)}for(K=0;K<E.length;K++)if(E.J(K).equals(H.id)){J=K;break}return{rowIndex:I,nZb:J}},B=(K,O,H,I)=>{if(0>H||0>I)return a.a.nil;new k.a;const J=K.runtime.Z3f;let L=J.J(O);if(!L){L=G(K,O);if(!L)return a.a.nil;J.Z(O,L)}if(H<L.length)O=L.J(H);else return a.a.nil;H=J.J(O);if(!H){H=F(K,O);if(!H)return a.a.nil;J.Z(O,H)}if(I<H.length)K=H.J(I);else return a.a.nil;return K},G=(K,O)=>{var H=new k.a;const I=K.runtime.lk.J(O);if(I){var J=K.runtime.Yt.Jy(O,
I);K=K.runtime.lq.Jy(O,I);O=H.getPropertyObjectIds(I,e.a.qf);J=H.getPropertyObjectIds(J,e.a.qf);H=H.getPropertyObjectIds(K,e.a.qf);return O.Fp(J,(L,S)=>L.equals(S))?H:O.Fp(H,(L,S)=>L.equals(S))?J:n.a(O,J,H,(L,S)=>L.equals(S))}return(J=K.runtime.Yt.J(O))?H.getPropertyObjectIds(J,e.a.qf):(J=K.runtime.lq.J(O))?H.getPropertyObjectIds(J,e.a.qf):null},F=(K,O)=>{var H=new k.a;const I=K.runtime.lk.J(O);if(I){var J=K.runtime.Yt.Jy(O,I);K=K.runtime.lq.Jy(O,I);O=H.getPropertyObjectIds(I,e.a.qf);J=H.getPropertyObjectIds(J,
e.a.qf);H=H.getPropertyObjectIds(K,e.a.qf);return O.Fp(J,(L,S)=>L.equals(S))?H:O.Fp(H,(L,S)=>L.equals(S))?J:null}return(J=K.runtime.Yt.J(O))?H.getPropertyObjectIds(J,e.a.qf):(J=K.runtime.lq.J(O))?H.getPropertyObjectIds(J,e.a.qf):null}},1591:function(C,N,d){d.d(N,"a",function(){return e});C=d(0);var l=d(1470);d=d(2);class e{static Qlm(){return!l.a.hdi()&&!l.a.JDb()&&e.isFeatureEnabled(0)}static qhi(){return e.isFeatureEnabled(1)}static Cei(){return e.isFeatureEnabled(2)}static isFeatureEnabled(a){return!!(e.fDj&
1<<a)}}e.fDj=d.AFrameworkApplication.K?d.AFrameworkApplication.K.rc("TellMeFeatureConfigValue",0):0;Object(C.a)(e,"TellMeFeatureAvailability",null,[])},1592:function(C,N,d){d.d(N,"a",function(){return l});C=d(0);d=d(1475);class l extends d.a{constructor(e,a,k,n,v=null){super(e,a,v,null,k);this.id=n}}Object(C.a)(l,"TryQueryResultBinding",d.a,[])},1593:function(C,N,d){d.d(N,"a",function(){return l});C=d(0);class l{constructor(e){this.Ab=e}get O0a(){return this.Ab.O0a}get w4n(){return 4!==this.Ab.style}get y4n(){return!0}get trie(){return this.Ab.trie}getId(e,
a){if(!this.w4n)throw Error.invalidOperation("ID lookup not supported on this string table");switch(this.Ab.style){case 0:return this.Tul(e,a);default:throw Error.notImplemented();}}nE(e){if(!this.y4n)throw Error.invalidOperation("String lookup not supported on this string table");if(0>e||e>=this.O0a)throw Error.argumentOutOfRange("id","Invalid string ID");switch(this.Ab.style){case 0:return this.cKl(e);case 4:return this.bKl(e);default:throw Error.notImplemented();}}Tul(e,a){e=this.Ab.trie.aoi(e,
0,e.length,a);if(!e.succeeded)return-1;if(0>e.Ngc||e.Ngc>=this.Ab.O0a)throw Error.invalidOperation("Trie with invalid trie ID in StringTable");return this.Ab.U2c?this.Ab.VWc.fy(this.Ab.U2c+4*e.Ngc,4):e.Ngc}cKl(e){if(this.Ab.U2c){let a=0;for(;a<this.Ab.O0a&&this.Ab.VWc.fy(this.Ab.U2c+4*a,4)!==e;++a);if(a>=this.Ab.O0a)throw Error.invalidOperation("Malformed TrieId2StringTableId in StringTable");return this.Ab.trie.DZh(a)}return this.Ab.trie.DZh(e)}bKl(e){const a=this.Ab.VWc.fy(this.Ab.J8i+4*e,4);e=
this.Ab.VWc.fy(this.Ab.K8i+4*e,4);if(0>e||0>a)throw Error.invalidOperation("Hash table string invalid byte range in StringTable");const k=Array(a);for(let n=0;n<a;++n)k[n]=({WZl:e}=this.bgn(e)).returnValue;return String.fromCharCode.apply(null,k)}bgn(e){let a=0;for(let k=0;3>k;++k){const n=this.Ab.VWc.J(this.Ab.nlh+e)^182;++e;a|=(n&127)<<7*k;if(!(n&128))break}return{returnValue:a,WZl:e}}}Object(C.a)(l,"StringTable",null,[1288])},1594:function(C,N,d){d.d(N,"a",function(){return e});C=d(0);var l=d(1601);
class e{constructor(a){this.trie=null;this.nlh=this.J8i=this.K8i=this.U2c=0;if(a){this.VWc=a;var k=0;if(a.fy(k,4)!==e.ewb)throw Error.argument("bytes","Input does not represent a string table");k+=4;this.O0a=a.fy(k,4);k+=4;this.style=a.fy(k,4);k+=4;switch(this.style){case 0:const n=1===a.fy(k,4);k+=4;n||(this.U2c=k,k+=4*this.O0a);a.fy(k,4);this.trie=this.c3m(a,k+4);break;case 4:this.K8i=k;this.J8i=k+=4*this.O0a;k+=4*this.O0a;a.fy(k,4);this.nlh=k+4;break;default:throw Error.argument("bytes");}}}c3m(a,
k){return new l.a(a,k)}}e.ewb=1025118440;Object(C.a)(e,"StringTableInit",null,[])},1595:function(C,N,d){d.d(N,"a",function(){return l});C=d(0);var l;(function(e){e[e.Answer=0]="Answer";e[e.Definition=1]="Definition";e[e.Entity=2]="Entity";e[e.WolframAnswer=3]="WolframAnswer";e[e.Assistance=4]="Assistance";e[e.Command=5]="Command";e[e.Document=6]="Document";e[e.TryQuery=7]="TryQuery";e[e.FindInDocument=8]="FindInDocument";e[e.HelpAction=9]="HelpAction";e[e.Insights=10]="Insights";e[e.People=11]="People";
e[e.Image=12]="Image";e[e.FirstRunResult=13]="FirstRunResult";e[e.NoCommandsFoundResult=14]="NoCommandsFoundResult";e[e.TestResult=15]="TestResult";e[e.AppsForOffice_Installed=16]="AppsForOffice_Installed";e[e.AppsForOffice_Recommandation=17]="AppsForOffice_Recommandation";e[e.AppsForOffice_Query=18]="AppsForOffice_Query";e[e.Notes_Onenote=19]="Notes_Onenote";e[e.Notes_Samsung=20]="Notes_Samsung";e[e.Notes_Sticky=21]="Notes_Sticky";e[e.Learning=22]="Learning";e[e.Feedback=23]="Feedback";e[e.Template=
24]="Template";e[e.Addin=25]="Addin";e[e.OfficeScript=26]="OfficeScript";e[e.AddinStoreEntry=27]="AddinStoreEntry";e[e.Unknown=28]="Unknown"})(l||(l={}));Object(C.b)("ResultType",l)},1598:function(C,N,d){C=d(0);var l=d(5),e=d(619),a=d(150),k=d(216),n=d(59),v=d(387),u=d(72),t;(function(Ta){Ta[Ta.none=0]="none";Ta[Ta.mergeConflict=1]="mergeConflict";Ta[Ta.containerBaseIdValidationFailure=2]="containerBaseIdValidationFailure";Ta[Ta.failedToApplyHints=3]="failedToApplyHints";Ta[Ta.validateUpdateHintsAreComplete=
4]="validateUpdateHintsAreComplete";Ta[Ta.other=5]="other"})(t||(t={}));Object(C.b)("ParagraphMergeUsingHintsFailureReason",t);var y=d(1002),B=d(250),G=d(883);const F=Ta=>{const Aa=new k.a;Ta.forEach(ma=>{Aa.add(ma);return!0});return Aa};var K=d(1549),O=d(1531),H=d(1552);const I=(Ta,Aa)=>{if(Ta.length!==Aa.length)return!1;for(let ma=0;ma<Ta.length;ma++)Ta.J(ma).om=Aa.J(ma),Aa.J(ma).om=Ta.J(ma);return!0},J=(Ta,Aa,ma)=>{let Ga,Fa,ib;Ga=0;Fa=!1;ib=0;var ob;if(!({idx:ob}=T(Ta,Aa)).returnValue)return a.a.instance.Wa(18969440,
1,5,"TryFindMergeBlockToSplit: Unable to find MergeBlock for [GraphNodeId: {0}] [MergeBlocks: {1}]",Aa,Ta.Dq()),{returnValue:!1,lKc:Ga,Ihb:Fa,wSc:ib};if(!ma&&2===Ta.J(ob).type)return{returnValue:!0,lKc:ob,Ihb:Fa,wSc:ib};if(!Ta.J(ob).I2())return a.a.instance.Wa(17044256,1,2,"TryFindMergeBlockToSplit: MergeBlock that at [Index: {0}] [Cp: {1}] is of Unexpected type [MergeBlocks: {2}]",ob,ma,Ta.Dq()),{returnValue:!1,lKc:Ga,Ihb:Fa,wSc:ib};let fb=!1,Mb=0;for(;ob<Ta.length&&Ta.J(ob).Cj.equals(Aa);ob++){if(ma===
Mb){fb=!0;break}if(ma>Mb&&ma<Mb+Ta.J(ob).length){Fa=fb=!0;ib=ma-Mb;break}Mb+=Ta.J(ob).length}fb||ma!==Mb||(fb=!0);fb&&(Ga=ob);return{returnValue:fb,lKc:Ga,Ihb:Fa,wSc:ib}},L=(Ta,Aa,ma)=>{let Ga,Fa,ib;ib=Fa=0;Ga=!1;let ob=0,fb=!1;for(;Fa<Ta.length;Fa++){if(Aa===ob){fb=!0;break}if(Aa>ob&&Aa<ob+Ta.J(Fa).length){Ga=fb=!0;ib=Aa-ob;break}ob+=Ta.J(Fa).length}fb||Aa!==ob||(fb=!0);fb||(Ta=String.format("Unable to find block idx to split at cp [Blocks: {0}][Length: {1}][CP: {2}]",Ta.length,ob,Aa),a.a.instance.Wa(573178201,
1,2,Ta),ma.Pg(Object.assign(new H.a,{eventId:"8k6fz",info:Ta})));return{returnValue:fb,Ihb:Ga,Gfh:Fa,Ffh:ib}},S=(Ta,Aa,ma)=>{let Ga;if(Ta.J(Aa).I2()&&({l7i:Ga}=Ta.J(Aa).C0n(ma)).returnValue)return Ta.EA(Aa+1,Ga),Ta.mF(Aa),!0;a.a.instance.Wa(18969441,1,5,"TrySplitMergeBlockInListAtIndexAndCp: Unable to split at [Index: {0}] [Cp: {1}] [MergeBlocks: {2}]",Aa,ma,Ta.Dq());return!1},E=(Ta,Aa,ma)=>{let Ga,Fa;if(!({lKc:ma,Ihb:Fa,wSc:Ga}=J(Ta,Aa,ma)).returnValue)return{returnValue:!1,index:0};if(!Fa)return{returnValue:!0,
index:ma};if(S(Ta,ma,Ga))return{returnValue:!0,index:ma+1};a.a.instance.Wa(18969442,1,5,"TrySplitMergeBlockListAtCp: Unable to split at [GraphNodeId: {0}] [Cp: {1}] [MergeBlocks: {2}]",Aa,Ga,Ta.Dq());return{returnValue:!1,index:0}},P=(Ta,Aa,ma)=>{let Ga;if(!({Ihb:Ga,Gfh:Aa,Ffh:ma}=L(Ta,Aa,ma)).returnValue)return{returnValue:!1,index:0};if(!Ga)return{returnValue:!0,index:Aa};if(S(Ta,Aa,ma))return{returnValue:!0,index:Aa+1};a.a.instance.Wa(574433311,1,5,"TrySplitMergeBlockListAtCp: Unable to split at [Cp: {1}] [MergeBlocks: {2}]",
ma,Ta.Dq());return{returnValue:!1,index:0}},T=(Ta,Aa)=>{let ma;ma=0;for(let Ga=0;Ga<Ta.length;Ga++)if(Ta.J(Ga).Cj.equals(Aa))return ma=Ga,{returnValue:!0,idx:ma};a.a.instance.Wa(18969443,1,5,"TryGetFirstIdxForGraphNodeId: Unable to find first idx [GraphNodeId: {0}] [MergeBlocks: {1}]",Aa,Ta.Dq());return{returnValue:!1,idx:ma}},U=(Ta,Aa)=>{let ma;ma=-1;for(let Ga=Aa;Ga<Ta.length;Ga++)if(2===Ta.J(Ga).type)return ma=Ga,{returnValue:!0,fea:ma};a.a.instance.Wa(18969472,1,5,"TryGetIdxNextEop: Unable to find first idx [Index: {0}] [MergeBlocks: {1}]",
Aa,Ta.Dq());return{returnValue:!1,fea:ma}},X=(Ta,Aa,ma)=>{let Ga;Ga=-1;for(let Fa=ma;Fa<Ta.length;Fa++)if(2===Ta.J(Fa).type&&Ta.J(Fa).Cj.equals(Aa))return Ga=Fa,{returnValue:!0,fea:Ga};a.a.instance.Wa(18969473,1,5,"TryGetIdxNextEopForGraphNodeId: Unable to find EOP [GraphNodeId: {0}] [Index: {1}] [MergeBlocks: {2}]",Aa,ma,Ta.Dq());return{returnValue:!1,fea:Ga}},Y=(Ta,Aa)=>{let ma;ma=0;var Ga;if(!({idx:Ga}=T(Ta,Aa)).returnValue)return a.a.instance.Wa(17342616,1,2,"Unable to find [GraphNodeId: {0}] [MergeBlocks: {1}]",
Aa,Ta),{returnValue:!1,length:ma};for(;Ga<Ta.length;Ga++)if(6!==Ta.J(Ga).type){if(2===Ta.J(Ga).type)return{returnValue:!0,length:ma};a.a.instance.shipAssertTag(17342617,1,Ta.J(Ga).I2(),"We found something other than text with type "+Ta.J(Ga).type);a.a.instance.shipAssertTag(17877021,1,Ta.J(Ga).Cj.equals(Aa),"Unexpected GraphNodeId {0} for ParaId {1}",Ta.J(Ga).Cj,Aa);ma+=Ta.J(Ga).length}a.a.instance.Wa(18969474,1,5,"Unable to find [GraphNodeId: {0}] [MergeBlocks: {1}]",Aa,Ta);return{returnValue:!1,
length:ma}},ca=Ta=>{const Aa=new k.a;for(let ma=0;ma<Ta.length;ma++)Aa.add(Ta.J(ma).clone());return Aa};var da=d(1551),ua=d(1518);class ra{constructor(Ta,Aa,ma=null,Ga=null){this.Cj=Ta;this.type=Aa;this.text=ma;this.Nc=Ga}isEqual(Ta){return Ta.Cj.equals(this.Cj)&&this.type===Ta.type&&this.Nc===Ta.Nc&&ua.a.Idh(this.text,Ta.text)}toString(){let Ta=String.format("[GraphNodeId: {0}] [WordId: {1}] [MergeBlockType: {2}]",this.Cj,this.Nc,this.type);this.text&&(Ta+=String.format(" [TextLength: {0}]",this.text.length));
return Ta}}Object(C.a)(ra,"MergeBlockValidationState",null,[]);var qa=d(120),ka=d(928),la=d(851),Ha=d(553),wa=d(499),Ca=d(927),Ja=d(850),bb=d(1506),ha=d(1669),ia;(function(Ta){Ta[Ta.base=1]="base";Ta[Ta.favoredUpdate=2]="favoredUpdate";Ta[Ta.unfavoredUpdate=4]="unfavoredUpdate";Ta[Ta.min=1]="min";Ta[Ta.max=7]="max"})(ia||(ia={}));Object(C.b)("MergeBlockSource",ia);class va{constructor(Ta,Aa,ma,Ga){this.Bg=Ta;this.cp=Aa;this.Hsd=ma;this.Z3c=Ga}}Object(C.a)(va,"MergedListBlocksWithUpdatedFormattingIds",
null,[]);var Ka=d(1548);class Xa extends Ka.a{constructor(Ta,Aa){super(6,Ta,Aa);this.Nc=0}toString(){return String.format("{0} [GraphNodeId: {1}]",super.toString(),this.Cj)}h2b(){return"Selection"}clone(){return new Xa(this.source,this.Cj)}Oz(){return!1}get length(){return 0}}Object(C.a)(Xa,"SelectionMergeBlock",Ka.a,[]);var xa;(function(Ta){Ta[Ta.success=0]="success";Ta[Ta.selfSplit=1]="selfSplit";Ta[Ta.noSecondaryBlockToSplit=2]="noSecondaryBlockToSplit";Ta[Ta.unexpected=3]="unexpected"})(xa||(xa=
{}));Object(C.b)("SplitTwinListResult",xa);var Ma=d(1586);class Na extends Ma.a{constructor(Ta,Aa,ma,Ga){super(5,Ta,Aa);this._text=null;this.W_c(ma);this.ZYj=Ga}get text(){return this._text}W_c(Ta){this._text=Ta}get D3c(){return this.ZYj}clone(){return new Na(this.source,this.Cj,this.text,this.D3c)}get v3a(){return this.text&&this.text.length?!0:!1}toString(){return String.format("{0}",super.toString())}}Object(C.a)(Na,"UpdateHintTextMergeBlock",Ma.a,[]);class pa{constructor(Ta,Aa,ma,Ga){this.T0=
!1;this.r9a=new v.a;this.ge=Ta;this.u4g=Ga;this.fxg=ma;this._base=Aa;this.Nme=ca(Aa);if(!I(this.base,this.Je))throw a.a.instance.Wa(574133957,1,2,"LcsTwinList ConnectList: Length not equal"),Ta.logger.Pg(Object.assign(new bb.a,{info:"TwinList ConnectList: Length not equal"})),Error.create("ConnectList");}get base(){return this._base}get Je(){return this.Nme}get mergeConflict(){return this.T0}CRe(Ta,Aa){switch(Ta.type){case 1:return this.fdk(Ta,Aa);case 2:return this.dRe(Ta,Aa);case 3:return this.Zdk(Ta,
Aa);case 4:return this.xdk(Ta);case 5:return this.xck(Ta,Aa);case 6:return this.bRe(Ta);default:return!1}}BRe(Ta,Aa){switch(Ta.type){case 1:return this.hRe(Ta,Aa);case 2:return this.cRe(Ta,Aa);case 3:return this.Ydk(Ta,Aa);case 4:return this.wdk(Ta);case 5:return this.wck(Ta,Aa);case 6:return this.aRe(Ta);default:return{returnValue:!1,Kt:null}}}fdk(Ta,Aa){let ma;const Ga=({Tea:ma}=this.zEa(Ta.Bg,Aa,!1,Ta.cp,!1,"ApplyInsertTextHintToDerived")).returnValue;if(0!==Ga&&1!==Ga)return 3!==Ga&&(a.a.instance.Wa(590202197,
1,2,"Fatal SplitTwinListAtCpForHint failure in ApplyInsertTextHintToDerived for mergeBlockSource {0}: {1}",ia[Aa],xa[Ga]),this.ge.logger.Pg(Object.assign(new ha.a,{lj:"ParagraphMergeUsingHintsTwinList",eventId:"9l2vv"}))),!1;this.T0=!1;Aa=new Na(Aa,Ta.Bg,Ta.text,Ta.id);this.Rnf(Ta,ma,Aa);return!0}dRe(Ta,Aa){let ma,Ga=({Tea:ma}=this.zEa(Ta.Bg,Aa,!1,Ta.cp,!1,"ApplyDeleteTextHintToDerived Start")).returnValue;if(0!==Ga&&1!==Ga)return 3!==Ga&&(a.a.instance.Wa(590202198,1,2,"Fatal SplitTwinListAtCpForHint failure in ApplyDeleteTextHintToDerived (start) for mergeBlockSource {0}: {1}",
ia[Aa],xa[Ga]),this.ge.logger.Pg(Object.assign(new ha.a,{lj:"ParagraphMergeUsingHintsTwinList",eventId:"9l2vw"}))),!1;let Fa;({Tea:Fa,returnValue:Ga}=this.zEa(Ta.Bg,Aa,!1,Ta.cp+Ta.text.length,!1,"ApplyDeleteTextHintToDerived End"));if(0!==Ga&&1!==Ga)return 3!==Ga&&(a.a.instance.Wa(590202199,1,2,"Fatal SplitTwinListAtCpForHint failure in ApplyDeleteTextHintToDerived (end) for mergeBlockSource {0}: {1}",ia[Aa],xa[Ga]),this.ge.logger.Pg(Object.assign(new ha.a,{lj:"ParagraphMergeUsingHintsTwinList",eventId:"9l2vx"}))),
!1;this.T0=!1;this.Z2e(Ta,ma,Fa);return!0}Zdk(Ta,Aa){let ma;const Ga=({dmf:ma}=this.CSh(Ta,Aa,!1)).returnValue;if(0!==Ga&&1!==Ga)return 3!==Ga&&(a.a.instance.Wa(590202200,1,2,"Fatal GetIndicesAndCpForSplitPara failure in ApplySplitParaHintToDerived for mergeBlockSource {0}: {1}",ia[Aa],xa[Ga]),this.ge.logger.Pg(Object.assign(new ha.a,{lj:"ParagraphMergeUsingHintsTwinList",eventId:"9l2vy"}))),!1;this.T0=!1;Aa=new K.a(Aa,Ta.tt,Ta.ira);this.Rnf(Ta,ma,Aa);return!0}xdk(Ta){let Aa;if(!({KLd:Aa}=this.DSh(Ta,
this.Je,"Derived")).returnValue)return!1;this.Z2e(Ta,Aa,Aa+1);return!0}xck(Ta,Aa){let ma;if(!({Szf:Aa,cmf:ma}=this.pUh(Ta,!1,Aa)).returnValue)return!1;this.Rnf(Ta,ma,Aa);return!0}bRe(Ta){let Aa;if(!({JLd:Aa}=this.tSh(Ta,this.Je,"Derived")).returnValue)return!1;this.Z2e(Ta,Aa,Aa+1);return!0}Rch(Ta,Aa,ma){const Ga=({Tea:Aa}=this.zEa(Ta,ma,!1,Aa,!0,"ApplyInsertCpPlaceHolderHintToDerived")).returnValue;if(0!==Ga&&1!==Ga)return 3!==Ga&&(a.a.instance.Wa(590202201,1,2,"Fatal SplitTwinListAtCpForHint failure in ApplyInsertCpPlaceHolderHintToDerived for mergeBlockSource {0}: {1}",
ia[ma],xa[Ga]),this.ge.logger.Pg(Object.assign(new ha.a,{lj:"ParagraphMergeUsingHintsTwinList",eventId:"9l2vz"}))),!1;this.T0=!1;Ta=new Xa(ma,Ta);this.Je.insert(Aa,Ta);return!0}hRe(Ta,Aa){var ma=null;if(pa.tci(Ta.text.length))return{returnValue:!1,Kt:ma};let Ga,Fa,ib;var ob=({Tea:Ga,sta:Fa,Lda:ib}=this.zEa(Ta.Bg,Aa,!0,Ta.cp,!1,"ApplyInsertTextHintToBaseAndDerived")).returnValue;if(0!==ob&&2!==ob)return 3!==ob&&(a.a.instance.Wa(590202202,1,2,"Fatal SplitTwinListAtCpForHint failure in ApplyInsertTextHintToBaseAndDerived for mergeBlockSource {0}: {1}",
ia[Aa],xa[ob]),this.ge.logger.Pg(Object.assign(new ha.a,{lj:"ParagraphMergeUsingHintsTwinList",eventId:"9l2v0"}))),{returnValue:!1,Kt:ma};this.T0=!1;({fea:ob}=U(this.Je,Fa));ob=this.Je.J(ob).Cj;ma=new Na(Aa,Ta.Bg,Ta.text,Ta.id);Aa=new Na(Aa,ob,Ta.text,Ta.id);ma.om=Aa;Aa.om=ma;this.base.insert(Ga,ma);this.Je.insert(Fa,Aa);ma=new k.a;ma.add(new wa.a(ob,ib,Ta.text,Ta.id,Ta.au));return{returnValue:!0,Kt:ma}}cRe(Ta,Aa){let ma;ma=null;if(pa.tci(Ta.text.length))return{returnValue:!1,Kt:ma};let Ga;var Fa,
ib=({Tea:Ga,sta:ob,Lda:Fa}=this.zEa(Ta.Bg,Aa,!0,Ta.cp,!1,"ApplyDeleteTextHintToBaseAndDerived Start")).returnValue;if(0!==ib){if(2!==ib)return 3!==ib&&(a.a.instance.Wa(590202203,1,2,"Fatal SplitTwinListAtCpForHint failure in ApplyDeleteTextHintToBaseAndDerived (start) for mergeBlockSource {0}: {1}",ia[Aa],xa[ib]),this.ge.logger.Pg(Object.assign(new ha.a,{lj:"ParagraphMergeUsingHintsTwinList",eventId:"9l2v1"}))),{returnValue:!1,Kt:ma};var ob=0;for({idx:Fa}=T(this.base,Ta.Bg);Fa<this.base.length&&ob<
Ta.cp;Fa++)ob+=this.base.J(Fa).length;ob-=this.base.J(Fa-1).length;({sta:ob,Lda:Fa,returnValue:ib}=this.zEa(Ta.Bg,Aa,!0,ob,!1,"ApplyDeleteTextHintToBaseAndDerived Start"));if(0!==ib)return 3!==ib&&(a.a.instance.Wa(590202204,1,2,"Fatal SplitTwinListAtCpForHint failure in ApplyDeleteTextHintToBaseAndDerived (fallback start) for mergeBlockSource {0}: {1}",ia[Aa],xa[ib]),this.ge.logger.Pg(Object.assign(new ha.a,{lj:"ParagraphMergeUsingHintsTwinList",eventId:"9l2v2"}))),{returnValue:!1,Kt:ma};this.T0=
!1}var fb,Mb;({Tea:fb,sta:Mb,Lda:Tb,returnValue:ib}=this.zEa(Ta.Bg,Aa,!0,Ta.cp+Ta.text.length,!1,"ApplyDeleteTextHintToBaseAndDerived End"));if(0!==ib){if(2!==ib)return 3!==ib&&(a.a.instance.Wa(590202205,1,2,"Fatal SplitTwinListAtCpForHint failure in ApplyDeleteTextHintToBaseAndDerived (end) for mergeBlockSource {0}: {1}",ia[Aa],xa[ib]),this.ge.logger.Pg(Object.assign(new ha.a,{lj:"ParagraphMergeUsingHintsTwinList",eventId:"9l2v3"}))),{returnValue:!1,Kt:ma};var Tb=0;for({idx:Mb}=T(this.base,Ta.Bg);Mb<
this.base.length&&Tb<Ta.cp+Ta.text.length;Mb++)Tb+=this.base.J(Mb).length;({sta:Mb,Lda:Tb,returnValue:ib}=this.zEa(Ta.Bg,Aa,!0,Tb,!1,"ApplyDeleteTextHintToBaseAndDerived Start"));if(0!==ib)return 3!==ib&&(a.a.instance.Wa(590202206,1,2,"Fatal SplitTwinListAtCpForHint failure in ApplyDeleteTextHintToBaseAndDerived (fallback end) for mergeBlockSource {0}: {1}",ia[Aa],xa[ib]),this.ge.logger.Pg(Object.assign(new ha.a,{lj:"ParagraphMergeUsingHintsTwinList",eventId:"9l2v4"}))),{returnValue:!1,Kt:ma};this.T0=
!1}Aa="";ma=new k.a;for(--Mb;Mb>=ob;Mb--)if(6!==this.Je.J(Mb).type)if(this.Je.J(Mb).om)Aa=this.Je.J(Mb).text+Aa,this.Je.mF(Mb);else{if(5===this.Je.J(Mb).type)ib=Tb-Aa.length;else if(2===this.Je.J(Mb).type){if(ib=0,!({length:Tb}=Y(this.Je,this.Je.J(Mb).Cj)).returnValue)return a.a.instance.Wa(589603462,1,2,"ApplyDeleteTextHintToBaseAndDerived: TryGetTextLengthForParaId failed"),this.ge.logger.Pg(Object.assign(new ha.a,{lj:"ParagraphMergeUsingHintsTwinList",eventId:"9jkkg"})),{returnValue:!1,Kt:ma}}else return a.a.instance.Wa(589898051,
1,2,"ApplyDeleteTextHintToBaseAndDerived: Unexpected block type missing twin"),this.ge.logger.Pg(Object.assign(new ha.a,{lj:"ParagraphMergeUsingHintsTwinList",eventId:"9ksfd"})),{returnValue:!1,Kt:ma};if(!({fea:rc}=U(this.Je,Mb+1)).returnValue)return a.a.instance.Wa(589603463,1,2,"ApplyDeleteTextHintToBaseAndDerived: TryGetIdxNextEop failed"),this.ge.logger.Pg(Object.assign(new ha.a,{lj:"ParagraphMergeUsingHintsTwinList",eventId:"9jkkh"})),{returnValue:!1,Kt:ma};var rc=this.Je.J(rc).Cj;ma.add(new Ha.DeleteTextUpdateHint(rc,
ib,Aa));Aa=""}for(--fb;fb>=Ga;fb--)this.base.mF(fb);if(!({fea:rc}=U(this.Je,ob)).returnValue)return a.a.instance.Wa(589603464,1,2,"ApplyDeleteTextHintToBaseAndDerived: TryGetIdxNextEop failed"),this.ge.logger.Pg(Object.assign(new ha.a,{lj:"ParagraphMergeUsingHintsTwinList",eventId:"9jkki"})),{returnValue:!1,Kt:ma};rc=this.Je.J(rc).Cj;Aa&&Aa.length&&ma.add(new Ha.DeleteTextUpdateHint(rc,Fa,Aa,Ta.id,Ta.au));return{returnValue:!0,Kt:ma}}Ydk(Ta,Aa){var ma=null;let Ga,Fa,ib;var ob=({dmf:Ga,A6h:Fa,Lda:ib}=
this.CSh(Ta,Aa,!0)).returnValue;if(0!==ob)return 3!==ob&&(a.a.instance.Wa(590202207,1,2,"Fatal GetIndicesAndCpForSplitPara failure in ApplySplitParaHintToBaseAndDerived for mergeBlockSource {0}: {1}",ia[Aa],xa[ob]),this.ge.logger.Pg(Object.assign(new ha.a,{lj:"ParagraphMergeUsingHintsTwinList",eventId:"9l2v5"}))),{returnValue:!1,Kt:ma};var fb;if(!({fea:fb}=U(this.Je,Fa)).returnValue)return a.a.instance.Wa(17342618,1,2,"ApplySplitParaHintToBaseAndDerived: Could not find corrsponding block in derived list."),
{returnValue:!1,Kt:ma};ob=this.Je.J(fb).Cj;const Mb=this.Je.J(fb).Nc;let Tb,rc,vb;({tt:fb,y5:Tb,ira:rc,x9:vb}=this.hAl(Ta,fb));this.ilh(this.Je,fb,Tb,vb,Fa);ma=new K.a(Aa,Ta.tt,Ta.ira);Aa=new K.a(Aa,fb,rc);ma.om=Aa;Aa.om=ma;this.base.insert(Ga,ma);this.Je.insert(Fa,Aa);ma=new k.a;ma.add(new Ja.a(ob,Mb,ib,fb,rc,Tb,vb,Ta.id,Ta.au));return{returnValue:!0,Kt:ma}}wdk(Ta){let Aa;Aa=null;let ma,Ga;var Fa;if(!({KLd:ma}=this.DSh(Ta,this.base,"Base")).returnValue)return{returnValue:!1,Kt:Aa};if(!this.base.J(ma).om||
!({fea:Ga}=X(this.Je,this.base.J(ma).om.Cj,0)).returnValue)return a.a.instance.Wa(17342619,1,2,"ApplyMergeParaHintToBaseAndDerived: We don't support operation where same para was deleted or split para was deleted by one"),this.ge.logger.Pg(Object.assign(new ha.a,{lj:"ParagraphMergeUsingHintsTwinList",eventId:"bckc1"})),this.T0=!0,{returnValue:!1,Kt:Aa};if(!({fea:Fa}=U(this.Je,Ga+1)).returnValue)return a.a.instance.Wa(17342620,1,2,"ApplyMergeParaHintToBaseAndDerived: We don't support operation as the below para on derived after merge is null"),
this.ge.logger.Pg(Object.assign(new ha.a,{lj:"ParagraphMergeUsingHintsTwinList",eventId:"bckc2"})),this.T0=!0,{returnValue:!1,Kt:Aa};let ib,ob,fb,Mb,Tb,rc;({A0a:Fa,B0a:fb,HDf:ib,oLm:Mb,XKm:ob,YKm:Tb}=this.Aol(Ta,Ga,Fa));if(!({length:rc}=Y(this.Je,Fa)).returnValue)return{returnValue:!1,Kt:Aa};this.hlh(this.Je,Fa,fb,Ga);this.Je.mF(Ga);this.base.mF(ma);Aa=new k.a;Aa.add(new Ca.MergeParagraphUpdateHint(ib,Mb,rc,ob,Tb,Fa,fb,Ta.id,Ta.au));return{returnValue:!0,Kt:Aa}}wck(Ta,Aa){var ma=null;let Ga,Fa,ib;
if(!({Szf:ib,cmf:Ga}=this.pUh(Ta,!0,Aa)).returnValue)return{returnValue:!1,Kt:ma};if(!({Veb:Fa}=this.yIc(this.base,this.Je,Ga,!0)).returnValue)return a.a.instance.Wa(17146332,1,2,"ApplyAddParaHintToBaseAndDerived: We could not find the corresponding index in the Derived list."),{returnValue:!1,Kt:ma};if(0<Fa&&2!==this.Je.J(Fa-1).type)return a.a.instance.Wa(17342621,1,2,"ApplyAddParaHintToBaseAndDerived: We cannot insert a new para in a middle of an existing para"),this.ge.logger.Pg(Object.assign(new ha.a,
{lj:"ParagraphMergeUsingHintsTwinList",eventId:"bckc3"})),this.T0=!0,{returnValue:!1,Kt:ma};let ob;if(!({tt:ob}=this.yLh(Fa)).returnValue)return{returnValue:!1,Kt:ma};Aa=new K.a(Aa,Ta.Bg,Ta.Nc);ma=ib;ma.om=Aa;Aa.om=ma;this.base.insert(Ga,ib);this.Je.insert(Fa,Aa);ma=new k.a;ma.add(new ka.AddParagraphUpdateHint(Ta.Bg,Ta.Nc,ob,Ta.id,Ta.au));return{returnValue:!0,Kt:ma}}aRe(Ta){let Aa;Aa=null;let ma;var Ga;if(!({JLd:Ga}=this.tSh(Ta,this.base,"Base")).returnValue)return{returnValue:!1,Kt:Aa};if(!this.base.J(Ga).om||
!this.base.J(Ga).om.Cj.equals(Ta.Bg))return a.a.instance.Wa(17135243,1,2,"ApplyDeleteParaHintToBaseAndDerived: We don't support operation where same para was deleted or split para was deleted by one"),this.ge.logger.Pg(Object.assign(new ha.a,{lj:"ParagraphMergeUsingHintsTwinList",eventId:"bbx0l"})),this.T0=!0,{returnValue:!1,Kt:Aa};if(!({Veb:ma}=this.yIc(this.base,this.Je,Ga,!0)).returnValue)return a.a.instance.Wa(17135244,1,2,"ApplyDeleteParaHintToBaseAndDerived: Possibly bad merge hints provided"),
{returnValue:!1,Kt:Aa};if(0<ma&&2!==this.Je.J(ma).type)return a.a.instance.Wa(17135245,1,2,"ApplyDeleteParaHintToBaseAndDerived: Detected new or leftover content in the list"),this.ge.logger.Pg(Object.assign(new ha.a,{lj:"ParagraphMergeUsingHintsTwinList",eventId:"bbx0n"})),this.T0=!0,{returnValue:!1,Kt:Aa};const Fa=this.Je.J(ma).Cj,ib=this.Je.J(ma).Nc;this.Je.mF(ma);this.base.mF(Ga);({tt:Ga}=this.yLh(ma));0<ma&&6===this.Je.J(ma-1).type&&this.u6m(ma-1,Ga);Aa=new k.a;Aa.add(new la.a(Fa,ib,Ga,Ta.id,
Ta.au));return{returnValue:!0,Kt:Aa}}Qch(Ta,Aa,ma){let Ga;var Fa=({Tea:Aa,sta:Ga}=this.zEa(Ta,ma,!0,Aa,!0,"ApplyInsertCpPlaceHolderHintToBaseAndDerived")).returnValue;if(0!==Fa)return 3!==Fa&&(a.a.instance.Wa(590202208,1,2,"Fatal SplitTwinListAtCpForHint failure in ApplyInsertCpPlaceHolderHintToBaseAndDerived for mergeBlockSource {0}: {1}",ia[ma],xa[Fa]),this.ge.logger.Pg(Object.assign(new ha.a,{lj:"ParagraphMergeUsingHintsTwinList",eventId:"9l2v6"}))),!1;({fea:Fa}=U(this.Je,Ga));Fa=this.Je.J(Fa).Cj;
Ta=new Xa(ma,Ta);ma=new Xa(ma,Fa);Ta.om=ma;ma.om=Ta;this.base.insert(Aa,Ta);this.Je.insert(Ga,ma);return!0}Aol(Ta,Aa,ma){let Ga,Fa,ib;Ga=Ta.A0a.equals(Ta.Bg)?this.Je.J(Aa).Cj:this.Je.J(ma).Cj;Ta=Ta.B0a===Ta.Nc?this.Je.J(Aa).Nc:this.Je.J(ma).Nc;Fa=this.Je.J(Aa).Cj;Aa=this.Je.J(Aa).Nc;ib=this.Je.J(ma).Cj;ma=this.Je.J(ma).Nc;return{A0a:Ga,B0a:Ta,HDf:Fa,oLm:Aa,XKm:ib,YKm:ma}}hAl(Ta,Aa){let ma;var Ga=Ta.Bg.equals(Ta.tt)?Ta.y5:Ta.tt;const Fa=Ta.Nc===Ta.ira?Ta.x9:Ta.ira;Ta.Bg.equals(Ta.tt)?ma=this.Je.J(Aa).Cj:
(ma=Ga,Ga=this.Je.J(Aa).Cj);Ta.Nc===Ta.ira?(Ta=this.Je.J(Aa).Nc,Aa=Fa):(Ta=Fa,Aa=this.Je.J(Aa).Nc);return{tt:ma,y5:Ga,ira:Ta,x9:Aa}}jlh(Ta,Aa,ma,Ga){for(;Ga<Ta.length;Ga++){if(!Ta.J(Ga).I2()&&6!==Ta.J(Ga).type&&2!==Ta.J(Ga).type){a.a.instance.shipAssertTag(17311188,1,!1,"Found merge block of type "+Ta.J(Ga).type);break}Ta.J(Ga).Cj=Aa;if(2===Ta.J(Ga).type){Ta.J(Ga).Nc=ma;break}}}ilh(Ta,Aa,ma,Ga,Fa){this.jlh(Ta,ma,Ga,Fa);pa.klh(Ta,Aa,Fa)}hlh(Ta,Aa,ma,Ga){this.jlh(Ta,Aa,ma,Ga+1);pa.klh(Ta,Aa,Ga)}DSh(Ta,
Aa,ma){let Ga,Fa=-1;if(!({fea:Ga}=X(Aa,Ta.Bg,0)).returnValue)return a.a.instance.Wa(17342622,1,2,"GetIndicesForMergePara: Failed to find index of EOP in "+ma+"for GraphNodeId "+Ta.Bg),{returnValue:!1,KLd:Ga};if(!({fea:Fa}=U(Aa,Ga+1)).returnValue||!Aa.J(Fa).Cj.equals(Ta.y5))return a.a.instance.Wa(17342623,1,2,"GetIndicesForMergePara: Failed to find index "+Ga+1+" in "+ma+" of length "+Aa.length),{returnValue:!1,KLd:Ga};this.hlh(Aa,Ta.A0a,Ta.B0a,Ga);return{returnValue:!0,KLd:Ga}}CSh(Ta,Aa,ma){let Ga;
const Fa=ma?this.base:this.Je,ib=ma?"Base":"Derived",ob=({Tea:Aa,sta:ma,Lda:Ga}=this.zEa(Ta.Bg,Aa,ma,Ta.cp,!1,"GetIndicesAndCpForSplitPara")).returnValue;if(3===ob||2===ob)return a.a.instance.Wa(17311189,1,2,"GetIndicesAndCpForSplitPara: Failed to find indices and Cp for "+ib),{returnValue:ob,dmf:Aa,A6h:ma,Lda:Ga};this.ilh(Fa,Ta.tt,Ta.y5,Ta.x9,Aa);return{returnValue:ob,dmf:Aa,A6h:ma,Lda:Ga}}tSh(Ta,Aa,ma){return({idx:Ta}=T(Aa,Ta.Bg)).returnValue?2!==Aa.J(Ta).type?(a.a.instance.Wa(17156034,1,2,"GetIndexForDeletePara: Found merge block that is not a zero length merge block "+
ma),{returnValue:!1,JLd:-1}):{returnValue:!0,JLd:Ta}:(a.a.instance.Wa(17156033,1,2,"GetIndexForDeletePara: Failed to find the para in "+ma),{returnValue:!1,JLd:-1})}u6m(Ta,Aa){var ma=this.Je.J(Ta);if(Aa){let Ga;({fea:Ga}=X(this.Je,Aa,0));ma=ma.clone();ma.Cj=Aa;this.Je.mF(Ta);this.Je.insert(Ga,ma)}else this.Je.length>Ta&&(this.Je.J(Ta+1).I2()||2===this.Je.J(Ta+1).type)&&(ma.Cj=this.Je.J(Ta+1).Cj)}pUh(Ta,Aa,ma){var Ga=Aa?this.base:this.Je;Aa=Aa?"Base":"Derived";ma=new K.a(ma,Ta.Bg,Ta.Nc);if(Ta.tt){if(!({fea:Ga}=
X(Ga,Ta.tt,0)).returnValue)return a.a.instance.Wa(17146333,1,2,"GetMergeBlockAndIndexToInsertForAddPara: We could not find [AboveParaId: {0}] in {1}",Ta.tt,Aa),{returnValue:!1,Szf:ma,cmf:Ga};Ga+=1}else Ga=0;return{returnValue:!0,Szf:ma,cmf:Ga}}yLh(Ta){let Aa;Aa=null;let ma=Ta-1;if(-1===ma)return{returnValue:!0,tt:Aa};6===this.Je.J(ma).type&&ma--;if(2===this.Je.J(ma).type||4===this.Je.J(ma).type)return Aa=this.Je.J(ma).Cj,{returnValue:!0,tt:Aa};a.a.instance.Wa(17342934,1,2,"GetAboveParaIdFromDerived: We found an unexpected block [Type: {0}] above",
this.Je.J(Ta-1).type);return{returnValue:!1,tt:Aa}}yIc(Ta,Aa,ma,Ga){let Fa,ib=!0;Fa=-1;if(ma>Ta.length)return a.a.instance.Wa(17146334,1,2,"GetIndexInSecondary: Index supplied for the primary is out of bounds"),{returnValue:!1,Veb:Fa};if(ma<Ta.length){if(-1<ma&&ma<Ta.length&&!Ta.J(ma).om){ib=!1;for(var ob=ma+1;ob<Ta.length;ob++)if(Ta.J(ob).om){ma=ob;ib=!0;break}}if(!ib)return{returnValue:!1,Veb:Fa};ib=!1;for(ob=0;Ta.J(ma)&&ob<Aa.length;ob++)if(Aa.J(ob).om===Ta.J(ma)){Fa=ob;ib=!0;break}if(!ib)return{returnValue:!1,
Veb:Fa}}else Fa=Aa.length;if(0<Fa&&Ga&&!Aa.J(Fa-1).om){for(Ta=Fa-1;0<=Ta&&!Aa.J(Ta).om;Ta--);Fa=Ta+1;6===Aa.J(Fa).type&&5!==this.ge.input.source&&Fa++}return{returnValue:!0,Veb:Fa}}zEa(Ta,Aa,ma,Ga,Fa,ib){let ob;var fb;let Mb;var Tb=this.base;let rc=this.Je,vb=!1;ma||(Tb=this.Je,rc=this.base);Mb=fb=ob=0;let Ya,wb,jb=0;if(!({lKc:Ga,Ihb:Ya,wSc:wb}=J(Tb,Ta,Ga)).returnValue)return a.a.instance.Wa(17044295,1,2,"SplitTwinListAtCpForHint: Unable to find the merge block to split at given Cp. It most likely means that our update hints are not complete"),
{returnValue:3,Tea:ob,sta:fb,Lda:Mb};0<=Ga&&Ga<Tb.length&&!Tb.J(Ga).om&&Ya&&!Fa&&(a.a.instance.Wa(17044296,1,4,"SplitTwinListAtCpForHint: We are trying to split a merge block that is deleted in the other revision. Failing merge. Called from {0}",ib),this.T0=!0,jb=Aa===Tb.J(Ga).source?1:2,vb=!0);Fa&&!Tb.J(Ga)&&Ga--;Fa&&Ya&&!Tb.J(Ga).om&&(Ya=!1,wb=0);if(!ma&&!({idx:Ta}=T(rc,Ta)).returnValue&&!Ya)return{returnValue:0,Tea:Ga,sta:fb,Lda:Mb};if(!({Veb:Ta}=this.yIc(Tb,rc,Ga,ma&&!Ya)).returnValue&&!vb&&(Aa=
!1,1===this.u4g&&0<Ga&&!wb&&(Ga--,{Veb:Ta,returnValue:Aa}=this.yIc(Tb,rc,Ga,ma&&!Ya),Aa&&(Ga++,Ta<rc.length-1?Ta++:Aa=!1)),!Aa))return a.a.instance.Wa(17156037,1,2,"SplitTwinListAtCpForHint: We are trying to find index in derived when the para most likley doesn't exist."),this.ge.logger.Pg(Object.assign(new ha.a,{lj:"ParagraphMergeUsingHintsTwinList",eventId:"bb25f"})),this.T0=!0,{returnValue:3,Tea:ob,sta:fb,Lda:Mb};if(Ya&&(!S(Tb,Ga,wb)||!vb&&!S(rc,Ta,wb)))return a.a.instance.shipAssertTag(17044297,
1,!1,"SplitTwinListAtCpForHint: Unable find the twin in secondary or unable to split the lists when a split was needed"),{returnValue:3,Tea:ob,sta:fb,Lda:Mb};ob=Ga;fb=Ta;Ya&&(ob=Ga+1,vb||(fb=Tb.J(Ga),ma=rc.J(Ta),fb.om=ma,ma.om=fb,Tb=Tb.J(Ga+1),fb=rc.J(Ta+1),Tb.om=fb,fb.om=Tb,fb=Ta+1));if(fb>=rc.length)return a.a.instance.shipAssertTag(17311190,1,!1,"SplitTwinListAtCpForHint: We are in bad state. indexInSecondary was "+fb+" secondaryList length was "+rc.length),{returnValue:3,Tea:ob,sta:fb,Lda:Mb};
for(Tb=0;Tb<fb;Tb++)rc.J(Tb).Cj.equals(rc.J(fb).Cj)&&(Mb+=rc.J(Tb).length);return{returnValue:jb,Tea:ob,sta:fb,Lda:Mb}}Z2e(Ta,Aa,ma){this.fxg.contains(Ta.id)&&this.r9a.Z(Ta.id,new k.a);for(--ma;ma>=Aa;ma--)this.fxg.contains(Ta.id)?this.r9a.J(Ta.id).insert(this.r9a.J(Ta.id).length,this.Je.J(ma)):this.Je.J(ma).om&&(this.Je.J(ma).om.om=null),this.Je.mF(ma)}Rnf(Ta,Aa,ma){if(this.r9a.xb(Ta.au)){const Ga=this.r9a.J(Ta.au);for(let Fa=0;Fa<Ga.length;Fa++)Ga.J(Fa).Cj=ma.Cj,Object(qa.a)(K.a,ma)&&Object(qa.a)(K.a,
Ga.J(Fa))&&(Ga.J(Fa).Nc=ma.Nc);this.Je.EA(Aa,this.r9a.J(Ta.au));this.r9a.remove(Ta.au)}else this.Je.insert(Aa,ma)}ENl(Ta){let Aa,ma;ma=Aa=-1;if(!Ta.om)return{returnValue:!1,Y_b:Aa,t3e:ma};var Ga;let Fa=0,ib=!1;if(!({idx:Ga}=T(this.Je,Ta.om.Cj)).returnValue)return{returnValue:!1,Y_b:Aa,t3e:ma};for(;Ga<this.Je.length;Ga++){if(Ta.om===this.Je.J(Ga)){Aa=Ga;ma=Fa;ib=!0;break}Fa+=this.Je.J(Ga).length}return{returnValue:ib,Y_b:Aa,t3e:ma}}n9e(Ta){let Aa;Aa=new k.a;let ma=0,Ga=0;for(;ma<Ta.length;){if(Ga>=
this.base.length)return a.a.instance.shipAssertTag(17335388,1,!1,"FindMergeBlocksInUnfavoredWithUpdatedFormattingInfo: idxBase out of range"),{returnValue:!1,hhc:Aa};if(Ta.J(ma).length>this.base.J(Ga).length){if(!S(Ta,ma,this.base.J(Ga).length))return a.a.instance.Wa(17335389,1,2,"FindMergeBlocksInUnfavoredWithUpdatedFormattingInfo: Unable to split UnfavoredRevision MergeBlock [Idx: {0}] at [Cp: {1}]",ma,this.base.J(Ga).length),{returnValue:!1,hhc:Aa}}else if(Ta.J(ma).length<this.base.J(Ga).length){var Fa=
!!this.base.J(Ga).om,ib=0;if(Fa&&!({Veb:ib}=this.yIc(this.base,this.Je,Ga,!1)).returnValue)return a.a.instance.shipAssertTag(17335390,1,!1,"FindMergeBlocksInUnfavoredWithUpdatedFormattingInfo: Base Merge Block at [Idx: {0}] has a Twin, but we are unable to find it",Ga),{returnValue:!1,hhc:Aa};if(!S(this.base,Ga,Ta.J(ma).length)||Fa&&!S(this.Je,ib,Ta.J(ma).length))return a.a.instance.Wa(17335391,1,2,"FindMergeBlocksInUnfavoredWithUpdatedFormattingInfo: Unable to split Base and/or Derived Merge blocks"),
{returnValue:!1,hhc:Aa};if(Fa){Fa=this.base.J(Ga);var ob=this.Je.J(ib);Fa.om=ob;ob.om=Fa;Fa=this.base.J(Ga+1);ib=this.Je.J(ib+1);Fa.om=ib;ib.om=Fa}}if(this.base.J(Ga).om&&5!==this.base.J(Ga).type&&this.base.J(Ga).I2()&&(ib=this.base.J(Ga),Fa=Ta.J(ma),!ib.oI.equals(Fa.oI)||!ib.wE.Oz(Fa.wE))){let fb;if(!({Y_b:ob,t3e:fb}=this.ENl(this.base.J(Ga))).returnValue)return{returnValue:!1,hhc:Aa};Aa.add(new va(this.Je.J(ob).Cj,fb,ib,Fa))}ma++;Ga++}return{returnValue:!0,hhc:Aa}}static klh(Ta,Aa,ma){for(--ma;0<=
ma;ma--){if(!Ta.J(ma).I2()&&6!==Ta.J(ma).type){a.a.instance.shipAssertTag(17311187,1,2===Ta.J(ma).type||4===Ta.J(ma).type,"Found merge block of type "+Ta.J(ma).type);break}Ta.J(ma).Cj=Aa}}static tci(Ta){return Ta?!1:(a.a.instance.Wa(17156036,1,2,"IsEmptyRunUpdateHint: We are trying to insert an empty run. It is likely we have bad merge hints."),!0)}}Object(C.a)(pa,"ParagraphMergeUsingHintsTwinList",null,[1774]);var Ra=d(1667),Sa=d(1668),ab=d(1664),eb=d(1666),zb=d(1665);class Ua{constructor(Ta,Aa,
ma,Ga){this.cp=Ta;this.length=Aa;this.Hsd=ma;this.Z3c=Ga}}Object(C.a)(Ua,"UpdateFormattingIdsPosInfo",null,[]);class Ab{constructor(Ta,Aa,ma){this.T0=!1;this.r9a=new v.a;this.ge=Ta;this.u4g=ma;this._base=Aa;this.Nme=ca(Aa);if(!I(this.base,this.Je))throw a.a.instance.Wa(574133956,1,2,"LcsTwinList ConnectList: Length not equal"),Ta.logger.Pg(Object.assign(new H.a,{info:"LcsTwinList ConnectList: Length not equal"})),Error.create("ConnectList");}get base(){return this._base}get Je(){return this.Nme}get mergeConflict(){return this.T0}CRe(Ta,
Aa){switch(Ta.type){case 11:return this.ddk(Ta,Aa);case 8:return this.dRe(Ta,Aa);case 10:return this.bRe(Ta);default:return!1}}BRe(Ta,Aa){switch(Ta.type){case 11:return this.cdk(Ta,Aa);case 8:return this.cRe(Ta,Aa);case 10:return this.aRe(Ta);default:return{returnValue:!1,Kt:null}}}Rch(){a.a.instance.Wa(574433295,1,2,"ApplyInsertCpPlaceHolderHintToDerived not implemented");this.ge.logger.Pg(Object.assign(new H.a,{lj:"ApplyInsertCpPlaceHolderHintToDerived",eventId:"8ps6p"}));return!1}Qch(){a.a.instance.Wa(574433296,
1,2,"ApplyInsertCpPlaceHolderHintToBaseAndDerived not implemented");this.ge.logger.Pg(Object.assign(new H.a,{lj:"ApplyInsertCpPlaceHolderHintToBaseAndDerived",eventId:"8ps6q"}));return!1}n9e(Ta){let Aa;Aa=new k.a;let ma=0,Ga=0,Fa=0;for(;ma<Ta.length;){if(Ga>=this.base.length)return a.a.instance.shipAssertTag(574433297,1,!1,"FindMergeBlocksInUnfavoredWithUpdatedFormattingInfo: idxBase out of range"),this.ge.logger.Pg(Object.assign(new H.a,{lj:"FindMergeBlocksInUnfavoredWithUpdatedFormattingInfo",eventId:"8ps6r"})),
{returnValue:!1,Y3c:Aa};if(Ta.J(ma).length>this.base.J(Ga).length){if(!S(Ta,ma,this.base.J(Ga).length))return a.a.instance.Wa(574433298,1,2,"FindMergeBlocksInUnfavoredWithUpdatedFormattingInfo: Unable to split UnfavoredRevision"),this.ge.logger.Pg(Object.assign(new H.a,{lj:"FindMergeBlocksInUnfavoredWithUpdatedFormattingInfo",eventId:"8ps6s"})),{returnValue:!1,Y3c:Aa}}else if(Ta.J(ma).length<this.base.J(Ga).length&&!this.l3a(Fa+Ta.J(ma).length,!0).returnValue)return a.a.instance.Wa(574433299,1,2,
"FindMergeBlocksInUnfavoredWithUpdatedFormattingInfo: Unable to split"),this.ge.logger.Pg(Object.assign(new H.a,{lj:"FindMergeBlocksInUnfavoredWithUpdatedFormattingInfo",eventId:"8ps6t"})),{returnValue:!1,Y3c:Aa};if(this.base.J(Ga).om&&5!==this.base.J(Ga).type&&this.base.J(Ga).I2()){const ib=this.base.J(Ga),ob=Ta.J(ma);if(!ib.oI.equals(ob.oI)||!ib.wE.Oz(ob.wE)){let fb,Mb;if(({Y_b:fb,Jyh:Mb}=this.FNl(this.base.J(Ga))).returnValue)Aa.add(new Ua(Mb,this.Je.J(fb).length,ib,ob));else return a.a.instance.Wa(571757956,
1,2,"FindMergeBlocksInUnfavoredWithUpdatedFormattingInfo: Enable to find unfavored formatting"),this.ge.logger.Pg(Object.assign(new H.a,{lj:"FindMergeBlocksInUnfavoredWithUpdatedFormattingInfo",eventId:"8ffwe"})),{returnValue:!1,Y3c:Aa}}}Fa+=this.base.J(Ga).length;ma++;Ga++}return{returnValue:!0,Y3c:Aa}}ddk(Ta,Aa){let ma;if(!({mAa:ma}=this.l3a(Ta.cp,!0)).returnValue)return a.a.instance.Wa(574433300,1,2,"ApplyInsertTextHintToDerived"),this.ge.logger.Pg(Object.assign(new H.a,{lj:"ApplyInsertTextHintToDerived",
eventId:"8ps6u"})),!1;for(let Fa=0;Fa<Ta.AZ.length;Fa++)switch(Ta.AZ.J(Fa).type){case 7:var Ga=Ta.AZ.J(Fa);this.Je.insert(ma,new Na(Aa,null,Ga.text,Ga.id));break;case 9:Ga=Ta.AZ.J(Fa);this.Je.insert(ma,new K.a(Aa,Ga.Bg,Ga.Nc));break;default:return a.a.instance.Wa(574433301,1,2,"ApplyInsertHintToDerived invalid hint"),this.ge.logger.Pg(Object.assign(new H.a,{lj:"ApplyInsertHintToDerived",eventId:"8ps6v"})),!1}return!0}dRe(Ta,Aa){let ma,Ga;if(!({mAa:ma}=this.l3a(Ta.cp,!0)).returnValue||!({mAa:Ga}=this.l3a(Ta.cp+
Ta.text.length,!1)).returnValue)return a.a.instance.Wa(575706433,1,2,"ApplyDeleteTextHintToDerived"),this.ge.logger.Pg(Object.assign(new H.a,{lj:"ApplyDeleteTextHintToDerived",eventId:"8ujvb"})),!1;for(Ta=Ga;Ta>=ma;Ta--)this.Je.J(Ta).source!==Aa&&this.Xyd(this.Je,Ta);return!0}bRe(Ta){let Aa;if(!({mAa:Aa}=this.l3a(Ta.cp,!0)).returnValue)return a.a.instance.Wa(574433302,1,2,"ApplyDeleteParaHintToDerived"),this.ge.logger.Pg(Object.assign(new H.a,{lj:"ApplyDeleteParaHintToDerived",eventId:"8ps6w"})),
!1;this.c3e(this.Je,Ta,Aa);return!0}cdk(Ta,Aa){let ma;ma=null;let Ga,Fa;if(!({Pvb:Ga,mAa:Fa}=this.l3a(Ta.cp,!0)).returnValue)return a.a.instance.Wa(574433303,1,2,"ApplyInsertTextHintToBaseAndDerived unable to split"),this.ge.logger.Pg(Object.assign(new H.a,{lj:"ApplyInsertTextHintToBaseAndDerived",eventId:"8ps6x"})),{returnValue:!1,Kt:ma};var ib=this.Ocf(this.Je,Fa-1);ib=new zb.a(ib);for(let ob=0;ob<Ta.AZ.length;ob++)switch(Ta.AZ.J(ob).type){case 7:ib.AZ.add(this.hRe(Ta.AZ.J(ob),Aa,Ga,Fa));break;
case 9:ib.AZ.add(this.edk(Ta.AZ.J(ob),Aa,Ga,Fa));break;default:return a.a.instance.Wa(574433304,1,2,"ApplyInsertHintToDerived invalid hint"),this.ge.logger.Pg(Object.assign(new H.a,{lj:"ApplyInsertHintToDerived",eventId:"8ps6y"})),{returnValue:!1,Kt:ma}}ma=new k.a;ma.add(ib);return{returnValue:!0,Kt:ma}}hRe(Ta,Aa,ma,Ga){const Fa=new Na(Aa,Ta.Bg,Ta.text,Ta.id);Aa=new Na(Aa,Ta.Bg,Ta.text,Ta.id);Fa.om=Aa;Aa.om=Fa;this.base.insert(ma,Fa);this.Je.insert(Ga,Aa);ma=new eb.a(Ta.Bg,Ta.text);ma.id=Ta.id;return ma}edk(Ta,
Aa,ma,Ga){const Fa=new K.a(Aa,Ta.Bg,Ta.Nc);Aa=new K.a(Aa,Ta.Bg,Ta.Nc);Fa.om=Aa;Aa.om=Fa;this.base.insert(ma,Fa);this.Je.insert(Ga,Aa);return new ab.a(Ta.Bg,Ta.Nc)}cRe(Ta){let Aa;Aa=new k.a;let ma;var Ga;let Fa;if(!({Pvb:ma,mAa:Ga}=this.l3a(Ta.cp,!0)).returnValue||!({Pvb:Fa,mAa:ib}=this.l3a(Ta.cp+Ta.text.length,!1)).returnValue)return a.a.instance.Wa(588001990,1,2,"ApplyDeleteTextHintToBaseAndDerived"),this.ge.logger.Pg(Object.assign(new H.a,{lj:"ApplyDeleteTextHintToBaseAndDerived",eventId:"9ddlg"})),
{returnValue:!1,Kt:Aa};for(Ta=ib;Ta>=Ga;Ta--)if(this.Je.J(Ta).om){var ib=Ta;Aa.add(({fLm:Ta}=this.h9k(Ta,Ga)).returnValue);this.Xyd(this.Je,Ta,ib)}for(Ga=Fa;Ga>=ma;Ga--)this.Xyd(this.base,Ga);return{returnValue:!0,Kt:Aa}}aRe(Ta){let Aa;Aa=null;let ma,Ga;if(!({Pvb:ma,mAa:Ga}=this.l3a(Ta.cp,!0)).returnValue)return a.a.instance.Wa(574433305,1,2,"ApplyDeleteParaHintToBaseAndDerived"),this.ge.logger.Pg(Object.assign(new H.a,{lj:"ApplyDeleteParaHintToBaseAndDerived",eventId:"8ps6z"})),{returnValue:!1,Kt:Aa};
if(!this.c3e(this.base,Ta,ma))return a.a.instance.Wa(574433306,1,2,"ApplyDeleteParaHintToBaseAndDerived EOP mismatch"),this.ge.logger.Pg(Object.assign(new H.a,{lj:"ApplyDeleteParaHintToBaseAndDerived",eventId:"8ps60"})),{returnValue:!1,Kt:Aa};this.c3e(this.Je,Ta,Ga)&&(Aa=new k.a,Aa.add(new Ra.a(this.Ocf(this.Je,Ga-1),Ta.Bg,Ta.Nc)));return{returnValue:!0,Kt:Aa}}l3a(Ta,Aa){var ma;var Ga=ma=-1;let Fa,ib;if(!({Ihb:ib,Gfh:Ta,Ffh:Fa}=L(this.base,Ta,this.ge.logger)).returnValue)return{returnValue:!1,Pvb:ma,
mAa:Ga};const ob=Ta>=this.base.length;ob&&Ta--;if(this.base.J(Ta).om){const fb=this.E$k(this.Je,this.base.J(Ta));if(ib){if(0>fb||!S(this.base,Ta,Fa)||!S(this.Je,fb,Fa))return a.a.instance.Wa(575706444,1,2,"SplitTwinListAndFindIdx"),this.ge.logger.Pg(Object.assign(new H.a,{lj:"SplitTwinListAndFindIdx",eventId:"8ujvm"})),{returnValue:!1,Pvb:ma,mAa:Ga};ma=this.base.J(Ta);Ga=this.Je.J(fb);ma.om=Ga;Ga.om=ma;ma=this.base.J(Ta+1);Ga=this.Je.J(fb+1);ma.om=Ga;Ga.om=ma;ma=Aa?Ta+1:Ta;Ga=Aa?fb+1:fb}else Aa?(ma=
ob?Ta+1:Ta,Ga=ob?fb+1:fb):(ma=ob?Ta:Ta-1,Ga=ob?fb:fb-1)}else if(ib){if(S(this.base,Ta,Fa))ma=Aa?Ta+1:Ta;else return a.a.instance.Wa(575706445,1,2,"SplitTwinListAndFindIdx"),this.ge.logger.Pg(Object.assign(new H.a,{lj:"SplitTwinListAndFindIdx",eventId:"8ujvn"})),{returnValue:!1,Pvb:ma,mAa:Ga};Aa?(Ga=({VBb:Ga}=this.x1b(this.base,this.Je,Ta,!1)).returnValue?Ga+1:0,Ga=Ga>=this.Je.length?this.Je.length-1:Ga):(Ga=({VBb:Ga}=this.x1b(this.base,this.Je,Ta,!0)).returnValue?Ga-1:this.Je.length-1,Ga=0>Ga?0:Ga)}else Aa?
(({VBb:Ga}=this.x1b(this.base,this.Je,Ta,!0)).returnValue||(({VBb:Ga}=this.x1b(this.base,this.Je,Ta,!1)).returnValue?Ga+=1:(Ga=ob?this.Je.length-1:0,Ga=0>Ga?0:Ga)),ma=ob?Ta+1:Ta):(({VBb:Ga}=this.x1b(this.base,this.Je,Ta,!1)).returnValue||(({VBb:Ga}=this.x1b(this.base,this.Je,Ta,!0)).returnValue?--Ga:(Ga=Ta?this.Je.length-1:0,Ga=0>Ga?0:Ga)),ma=ob?Ta:Ta-1);return{returnValue:!0,Pvb:ma,mAa:Ga}}x1b(Ta,Aa,ma,Ga){let Fa=null;if(Ga)for(;ma<Ta.length;ma++){if(Ta.J(ma).om){Fa=Ta.J(ma).om;break}}else for(;0<=
ma;ma--)if(Ta.J(ma).om){Fa=Ta.J(ma).om;break}if(Fa)for(Ta=0;Ta<Aa.length;Ta++)if(Aa.J(Ta)===Fa)return Aa=Ta,{returnValue:!0,VBb:Aa};return{returnValue:!1,VBb:-1}}E$k(Ta,Aa){for(let ma=0;ma<Ta.length;ma++)if(Ta.J(ma).om===Aa)return ma;return-1}Xyd(Ta,Aa,ma=-1){for(ma=0>ma?Aa:ma;ma>=Aa;ma--)Ta.J(ma).om&&(Ta.J(ma).om.om=null),Ta.mF(ma)}Ocf(Ta,Aa){let ma=0;for(;0<=Aa;Aa--)ma+=Ta.J(Aa).length;return ma}ZLl(Ta){Ta=Object(u.a)(Ma.a,Ta);Ta||(a.a.instance.Wa(575706448,1,2,"GetTextBlock"),this.ge.logger.Pg(Object.assign(new H.a,
{lj:"GetTextBlock",eventId:"8ujvq"})));return Ta}h9k(Ta,Aa){let ma="";for(;Ta>=Aa&&this.Je.J(Ta).om&&2!==this.Je.J(Ta).type;)ma=this.ZLl(this.Je.J(Ta)).text+ma,Ta--;Aa=0>Ta?0:this.Ocf(this.Je,Ta);Ta+=1;return{returnValue:new Sa.a(Aa,ma),fLm:Ta}}FNl(Ta){let Aa,ma,Ga=!1;ma=Aa=0;if(!Ta.om)return{returnValue:!1,Y_b:Aa,Jyh:ma};for(Aa=0;Aa<this.Je.length;Aa++){if(this.Je.J(Aa).om===Ta){Ga=!0;break}ma+=this.Je.J(Aa).length}return{returnValue:Ga,Y_b:Aa,Jyh:ma}}c3e(Ta,Aa,ma){ma=ma===Ta.length?--ma:ma;ma>Ta.length-
1&&(a.a.instance.Wa(571757957,1,2,"DeleteEopInList: Idx out of range"),this.ge.logger.Pg(Object.assign(new H.a,{lj:"DeleteEopInList",eventId:"8ffwf"})));if(2===Ta.J(ma).type){const Ga=Ta.J(ma);if(Ga.Cj!==Aa.Bg||Ga.Nc!==Aa.Nc)return!1;this.Xyd(Ta,ma);return!0}return!1}}Object(C.a)(Ab,"ParagraphMergeUsingHintsTwinListLcs",null,[1774]);var mb=d(1537),Rb=d(1507),hc=d(1663);d.d(N,"a",function(){return Hb});class Hb{constructor(Ta,Aa,ma,Ga,Fa,ib,ob=null,fb=null,Mb=null){this.$O=this.$qa=this.OGa=this.Voa=
null;this._initialized=!1;this.ge=Ta;this.GE=Aa;this.Cya=Ga;this.rxa=ma;this.Bpa=Fa;this.Eie=new e.a;for(Ta=0;Ta<this.GE.length;Ta++)this.Eie.add(this.GE.J(Ta).id);this.XDg=new e.a;for(Ta=0;Ta<this.rxa.length;Ta++)this.XDg.add(this.rxa.J(Ta).id);this.h4g=new e.a;for(Ta=0;Ta<this.Cya.length;Ta++)this.h4g.add(this.Cya.J(Ta).id);this.Lg=ib;this.GLe=ob||G.a.instance;this.FH=fb;this.MV=Mb;this.Jqb=1===(this.FH&&this.MV&&1===this.FH.lFa&&1===this.MV.lFa?1:0);this.zpa=0}get RUf(){return 1!==this.zpa}q4l(){var Ta=
!0;if(this.FH&&this.MV)return Ta;if(this.FH||this.MV)return a.a.instance.Wa(593826832,1,2,"ParagraphMergeUsingHints.InitializeUpdateHints : Unexpected input to constructor: need to supply both or neither of favored and unfavored update hints, just supplying one is unsupported"),!1;this.ge.runtime.Yt.xb(B.a.CK)&&(Ta=this.ge.runtime.Yt.J(B.a.CK),Ta=this.g$f(Ta,this.ge.runtime.Dza.id,"favored")&&({updateHints:this.FH}=this.k8h(Ta,this.Eie,this.XDg,this.ge.runtime.Yt,"favored")).returnValue);Ta&&this.ge.runtime.lq.xb(B.a.CK)&&
(Ta=this.ge.runtime.lq.J(B.a.CK),Ta=this.g$f(Ta,this.ge.runtime.Dza.id,"unfavored")&&({updateHints:this.MV}=this.k8h(Ta,this.Eie,this.h4g,this.ge.runtime.lq,"unfavored")).returnValue);this.FH=this.FH?this.FH:new hc.a(new k.a,0);this.MV=this.MV?this.MV:new hc.a(new k.a,0);Ta&&this.ge.input.X4b&&(Ta=this.ge.input.G3.last().AYa(B.a.CK),Ta=this.g$f(Ta,this.ge.input.G3.last().z1.id,"alreadyMerged"));return Ta}A2l(){const Ta=new e.a;if(this.Jqb)return Ta;const Aa=this.FH?this.FH.updateHints.x3():new k.a;
let ma=0;for(;ma<Aa.length-1;){const Ga=Aa.J(ma);let Fa,ib=!1;for(Fa=ma+1;Fa<Aa.length;Fa++){const ob=Aa.J(Fa);if(Ga.Tdi(ob)){Ta.add(Ga.id);Aa.mF(Fa);Aa.mF(ma);ib=!0;break}}ib||ma++}return Ta}g$f(Ta,Aa,ma){Ta=this.Lg.getPropertyString(Ta,l.a.DQa);Ta=n.a.Of(Ta);return Aa.equals(Ta)?!0:(this.s_c(2),a.a.instance.Wa(17162307,1,2,"ParagraphMergeUsingHints: ValidateUpdateHintsContainerBaseId returned failure [MergeBaseId: {0}] [UpdateHintsContainerBaseId: {1}] [RevisionType: {2}]",this.ge.runtime.Dza.id,
Ta,ma),!1)}k8h(Ta,Aa,ma,Ga,Fa){let ib;ib=new hc.a(new k.a,0);Ta=this.Lg.getPropertyObjectIds(Ta,l.a.R_).x3();for(let fb=0;fb<Ta.length;fb++){if(!Ga.xb(Ta.J(fb)))return a.a.instance.Wa(17044257,1,2,"ParagraphMergeUsingHints: InitializeUpdateHintsListForParagraphs unable to find [UpdateHintObject: {0}] in [RevisionType: {1}]",Ta.J(fb),Fa),{returnValue:!1,updateHints:ib};const Mb=Ga.J(Ta.J(fb));var ob=n.a.Of(this.Lg.getPropertyString(Mb,l.a.tha));if(Aa.contains(ob)||ma.contains(ob)){ob=this.GLe.VJc(Mb);
if(!ob)return a.a.instance.Wa(17044258,1,2,"ParagraphMergeUsingHints: InitializeUpdateHintsListForParagraphs unable to create a updateHint for [UpdateHintObject: {0}]  in [RevisionType: {1}]",Mb.id,Fa),{returnValue:!1,updateHints:ib};ib.updateHints.add(ob)}}0<Ta.length&&a.a.instance.Wa(17162308,1,5,"ParagraphMergeUsingHints: InitializeUpdateHintsListForParagraphs for [RevisionType: {0}] [UpdateHintIds: {1}] [UpdateHints: {2}]",Fa,Ta.Dq(),ib.updateHints.Dq());return{returnValue:!0,updateHints:ib}}C3l(){return({MJ:this.Voa,
RFc:this.OGa,p3c:this.$qa}=mb.a.muh(this.ge,this.Lg,this.GE,this.rxa,this.Cya,this.Bpa,!0,!0)).returnValue?!0:!1}n4l(Ta){const Aa=mb.a.Jxd(this.Lg,ma=>this.ge.runtime.lk.J(ma),this.GE,1,this.Bpa,!0,!0).returnValue;if(!Aa)return a.a.instance.Wa(17044259,1,2,"InitializeTwinTextMergeBlocks:Unable to create merge blocks for the base or derived"),!1;this.$O=this.Jqb?new Ab(this.ge,Aa,1):new pa(this.ge,Aa,Ta,this.FH?this.FH.lFa:0);return!0}initialize(){if(this._initialized)return!1;this._initialized=!0;
if(!this.q4l()||!this.C3l())return!1;const Ta=this.A2l();return this.n4l(Ta)?!0:!1}rUh(Ta){const Aa=new k.a;let ma="";for(let Ga=0;Ga<Ta.length;Ga++){const Fa=Ta.J(Ga);Fa.I2()?ma+=Ta.J(Ga).text:2===Fa.type?(Aa.add(new ra(Fa.Cj,Fa.type,ma,Fa.Nc)),ma=""):4===Fa.type&&(Aa.add(new ra(Fa.Cj,Fa.type)),ma="")}return Aa}validateUpdateHintsAreComplete(Ta,Aa,ma){Aa=this.rUh(Aa);Ta=this.rUh(Ta);let Ga=Aa.length===Ta.length;if(Ga)for(let Fa=0;Fa<Aa.length;Fa++)if(!Aa.J(Fa).isEqual(Ta.J(Fa))){Ga=!1;break}Ga||
(this.s_c(4),a.a.instance.Wa(17044288,1,2,"ValidateUpdateHintsAreComplete: Validation of update hints from [Revision: {0}] was unsuccessful [MergeValidationState: {1}] [RevisionValidationState: {2}]",ma,Ta.Dq(),Aa.Dq()));return Ga}wdh(Ta,Aa,ma){(Aa=({j4a:Ta}=this.uek(Ta,Aa,ma)).returnValue)||this.s_c(this.$O.mergeConflict?1:3);return{returnValue:Aa,j4a:Ta}}uek(Ta,Aa,ma){let Ga;Ga=new k.a;let Fa=!0;var ib=0;let ob=null,fb=this.FH?this.FH.updateHints.length:0;for(var Mb=0;Mb<fb&&Fa;Mb++)ob=this.FH.updateHints.J(Mb),
ib<this.MV.updateHints.length&&ob.id.equals(this.MV.updateHints.J(ib).id)&&5!==this.ge.input.source?({returnValue:Fa}=this.$O.BRe(ob,2),ib++):Fa=this.$O.CRe(ob,2);if(!Fa)return a.a.instance.Wa(17044289,1,2,"ApplyUpdateHints: Failed to apply favored [UpdateHint: {0}]",ob.toString()),{returnValue:!1,j4a:Ga};if(!this.validateUpdateHintsAreComplete(this.$O.Je,this.OGa,"Favored"))return{returnValue:!1,j4a:Ga};if(Ta&&1===this.ge.input.P2&&!this.$O.Rch(Aa,ma,2))return a.a.instance.Wa(17409920,1,2,"ApplyUpdateHints: Unable to insert placeholder Cp in [ParaId: {0}] [Cp: {1}]",
Aa,ma),{returnValue:!1,j4a:Ga};Fa=!0;Mb=new k.a;for(fb=this.MV?this.MV.updateHints.length:0;ib<fb&&Fa;ib++){ob=this.MV.updateHints.J(ib);let Tb;({Kt:Tb,returnValue:Fa}=this.$O.BRe(ob,4));Fa&&Tb&&Mb.EA(Mb.length,Tb)}return Fa?this.validateUpdateHintsAreComplete(this.$O.base,this.$qa,"Unfavored")?Ta&&2===this.ge.input.P2&&!this.$O.Qch(Aa,ma,4)?(a.a.instance.Wa(17409921,1,2,"ApplyUpdateHints: Unable to insert placeholder Cp in [ParaId: {0}] [Cp: {1}]",Aa,ma),{returnValue:!1,j4a:Ga}):{returnValue:!0,
j4a:Mb}:{returnValue:!1,j4a:Ga}:(a.a.instance.Wa(17044291,1,2,"ApplyUpdateHints: Failed to apply unfavored [UpdateHint: {0}] [Type: {1}]",ob.id,ob.type),{returnValue:!1,j4a:Ga})}Uyl(){let Ta,Aa=0;let ma=0,Ga=n.a.nil;for(Ta=new v.a;ma<this.$O.base.length;){const ob=this.$O.base.J(ma);Ga.equals(ob.Cj)||(Aa=0,Ga=ob.Cj);if(5===ob.type){var Fa=Aa+ob.length;var ib=void 0;let fb;const Mb=ca(this.$qa);if(!({index:ib}=E(Mb,ob.Cj,Aa)).returnValue||!({index:fb}=E(Mb,ob.Cj,Fa)).returnValue)return a.a.instance.Wa(17335384,
1,2,"GetMergeBlocksToInsertForUnfavoredUpdateHints: Unable to extract merge blocks from unfavored to insert in favored for [UpdateHintId: {0}]",ob.D3c),{returnValue:!1,Qqi:Ta};for(Fa=new k.a;ib<fb;ib++)Fa.add(Mb.J(ib));Ta.Z(ob.D3c,Fa)}Aa+=ob.length;ma++}return{returnValue:!0,Qqi:Ta}}Vyl(){let Ta;Ta=new v.a;let Aa=0;for(let Ga=0;Ga<this.$O.base.length;Ga++){const Fa=this.$O.base.J(Ga);if(5===Fa.type){var ma=void 0;let ib;const ob=ca(this.$qa);if(!({index:ma}=P(ob,Aa,this.ge.logger)).returnValue||!({index:ib}=
P(ob,Aa+Fa.length,this.ge.logger)).returnValue)return a.a.instance.Wa(574433309,1,2,"GetMergeBlocksToInsertForUnfavoredUpdateHints: Unable to extract merge blocks"),{returnValue:!1,Rqi:Ta};const fb=new k.a;for(;ma<ib;ma++)fb.add(ob.J(ma));Ta.Z(Fa.D3c,fb)}Aa+=Fa.length}return{returnValue:!0,Rqi:Ta}}ydk(Ta){let Aa;Aa=new k.a;let ma;if(this.Jqb){if(!({Rqi:ma}=this.Vyl()).returnValue)return{returnValue:!1,dSc:Aa}}else if(!({Qqi:ma}=this.Uyl()).returnValue)return{returnValue:!1,dSc:Aa};let Ga;Ga=this.Jqb?
new Ab(this.ge,ca(this.OGa),1):new pa(this.ge,ca(this.OGa),new e.a,this.FH?this.FH.lFa:0);for(var Fa=0;Fa<Ta.length;Fa++)if(!Ga.CRe(Ta.J(Fa),4))return{returnValue:!1,dSc:Aa};for(Ta=Ga.Je.length-1;0<=Ta;Ta--)5===Ga.Je.J(Ta).type&&(Fa=Ga.Je.J(Ta).D3c,Ga.Je.mF(Ta),Ga.Je.EA(Ta,ma.J(Fa)));this.Jqb&&(this.cxh(Ga.Je),this.cxh(this.$O.Je));if(!this.validateUpdateHintsAreComplete(this.$O.Je,Ga.Je,"Merged"))return{returnValue:!1,dSc:Aa};Aa=Ga.Je;return{returnValue:!0,dSc:Aa}}cxh(Ta){const Aa=new v.a;for(let ma=
Ta.length-1;0<=ma;ma--){const Ga=Object(u.a)(K.a,Ta.J(ma));Ga&&(Aa.xb(Ga.Nc)?Aa.J(Ga.Nc).source!==Ga.source&&Ta.mF(ma):Aa.add(Ga.Nc,Ga))}}tek(Ta){let Aa;if(!({Y3c:Aa}=this.$O.n9e(ca(this.$qa))).returnValue)return!1;for(let Ga=0;Ga<Aa.length;Ga++){const Fa=Aa.J(Ga);let ib,ob;if(!({index:ib}=P(Ta,Fa.cp,this.ge.logger)).returnValue||!({index:ob}=P(Ta,Fa.cp+Fa.length,this.ge.logger)).returnValue)return a.a.instance.Wa(572379488,1,2,"ApplyUnfavoredFormattingChangesLcs: Unable to split"),this.ge.logger.Pg(Object.assign(new H.a,
{lj:"ApplyUnfavoredFormattingChangesLcs",eventId:"8h3f6"})),!1;var ma=!1;for(let fb=ib;fb<ob&&!ma;fb++)ma=!Fa.Hsd.oI.equals(Ta.J(fb).oI);if(!ma){for(ma=ib;ma<ob;ma++)Ta.mF(ib);Ta.insert(ib,Fa.Z3c)}}return!0}sek(Ta){let Aa;if(!({hhc:Aa}=this.$O.n9e(ca(this.$qa))).returnValue)return!1;for(let Fa=0;Fa<Aa.length;Fa++){var ma=Aa.J(Fa);let ib,ob;if(({index:ib}=E(Ta,ma.Bg,ma.cp)).returnValue&&({index:ob}=E(Ta,ma.Bg,ma.cp+ma.Z3c.length)).returnValue){var Ga=!1;for(let fb=ib;fb<ob&&!Ga;fb++)Ga=!ma.Hsd.oI.equals(Ta.J(fb).oI)||
!ma.Hsd.wE.Oz(Ta.J(fb).wE);if(Ga){if(this.FH&&1===this.FH.lFa||this.MV&&1===this.MV.lFa)return!1}else{for(Ga=ib;Ga<ob;Ga++)Ta.mF(ib);Ta.insert(ib,ma.Z3c)}}else if(ma=ma.Z3c.I9l,a.a.instance.Wa(51500353,1,2,"ApplyUnfavoredFormattingChanges: Unable to find corresponding merge blocks with update formatting in merged list. IsEmbeddedObject {0}",ma),ma||this.FH&&1===this.FH.lFa||this.MV&&1===this.MV.lFa)return!1}return!0}IDl(Ta){let Aa,ma;ma=new k.a;Aa=this.ge.runtime.Rm.J(B.a.CK);let Ga;({$zf:Ga}=Hb.WLh(this.ge,
this.Lg));const Fa=new k.a;for(let ob=0;ob<Ta.length;ob++){if(Ga.contains(Ta.J(ob).id,(Mb,Tb)=>Mb.equals(Tb)))continue;if(this.ge.runtime.Rm.xb(Ta.J(ob).id))return a.a.instance.shipAssertTag(17044293,1,!1,"[UpdateHint: {0}] is already in the merged object. Failing merge.",Ta.J(ob).id),{returnValue:!1,o_d:Aa,n_d:ma};Fa.add(Ta.J(ob).id);var ib=Ta.J(ob).EYa();const fb=new Rb.a(ib);ib=ib.Mj();for(const Mb of ib)fb.nB(Mb);ma.add(fb)}Ta=this.Lg.getPropertyObjectIds(Aa.im,l.a.R_);Ta.EA(Ta.length,Fa);this.Lg.setPropertyObjectIds(Aa.im,
l.a.R_,Ta);return{returnValue:!0,o_d:Aa,n_d:ma}}zFd(Ta){return String.format("Name: {0}, Message: {1}, Stack: {2}",Ta.name,Ta.message,Ta.stack)}s_c(Ta){0===this.zpa&&(this.zpa=Ta)}Ugc(){let Ta;Ta=null;let Aa,ma;var Ga;try{if({Rm:Ta,o_d:Aa,n_d:ma,returnValue:Ga}=this.Ebo(),Ga){if(Aa&&ma){this.ge.runtime.Rm.Z(Aa.im.id,Aa);for(Ga=0;Ga<ma.length;Ga++){const fb=ma.J(Ga);this.ge.runtime.Rm.Z(fb.im.id,fb)}const Fa=Aa.im,ib=this.Lg.getPropertyObjectIds(Fa,l.a.R_),ob=this.Lg.getPropertyString(Fa,l.a.DQa);
a.a.instance.Wa(17162312,1,5,"ParagraphMergeUsingHints returned success [UpdateHintsContainerNodeIds: {0}] [UpdateHintsContainerBaseId: {1}]",ib.Dq(),ob)}else a.a.instance.Wa(593826831,1,5,"ParagraphMergeUsingHints returned success and did not update UpdateHint objects");return{returnValue:!0,Rm:Ta}}}catch(Fa){a.a.instance.Wa(17162313,1,2,"ParagraphMergeUsingHints Crashed! Retrying ParagraphMerge [{0}]",this.zFd(Fa))}this.s_c(5);a.a.instance.Wa(17409922,1,2,"TryDoMerge: ParagraphMergeUsingHints returned failure [MergeFailureReason:{0}] [RetryMergeWithoutHints:{1}]",
this.zpa,this.RUf);this.m0a();this.FH&&1===this.FH.lFa&&this.ge.logger.Pg(Object.assign(new da.a,{eventId:"bc04c",lj:"ParagraphMergeUsingHints.TryDoMerge",info:t[this.zpa]+"/LCS"}));return{returnValue:!1,Rm:Ta}}Ebo(){let Ta,Aa,ma;ma=Aa=Ta=null;let Ga;Ga=this.initialize();this.ge.logger.YT("PMUH Initialize");let Fa=null;Ga=Ga&&({j4a:Fa}=this.wdh(!1,n.a.nil,0)).returnValue;this.ge.logger.YT("PMUH ApplyUpdateHints");let ib=new k.a;Ga=Ga&&({dSc:ib}=this.ydk(Fa)).returnValue;this.ge.logger.YT("PMUH ApplyMergedUnfavoredHintsToFavoredToMergeFavoredFormattingChanges");
Ga=this.Jqb?Ga&&this.tek(ib):Ga&&this.sek(ib);this.ge.logger.YT("PMUH ApplyUnfavoredFormattingChanges");this.Jqb&&!this.gzn(ib)&&(a.a.instance.shipAssertTag(571552961,1,!1,"ReuseParaIdsIfPossible"),this.ge.logger.Pg(Object.assign(new H.a,{lj:"ReuseParaIdsIfPossible",eventId:"8ettb"})),Ga=!1);const ob=this.hHd(ib);Ga=Ga&&({m_d:Ta}=mb.a.LIc(this.ge,this.Lg,this.Bpa,ib,ob)).returnValue;this.ge.logger.YT("PMUH GetMergeableObjectsFromMergeBlocks");this.FH&&1===this.FH.lFa&&this.MV&&1===this.MV.lFa||(Ga=
Ga&&({o_d:Aa,n_d:ma}=this.IDl(F(Fa))).returnValue,this.ge.logger.YT("PMUH GetPartialMergeResultForUpdateHintNodes"));return{returnValue:Ga,mergeConflict:!!this.$O&&this.$O.mergeConflict,Rm:Ta,o_d:Aa,n_d:ma}}hHd(Ta){const Aa=new k.a;for(let ma=0;ma<Ta.length;ma++)2===Ta.J(ma).type&&Aa.add(Ta.J(ma).Cj);return Aa}Gdf(Ta){const Aa=new k.a;for(let ma=0;ma<Ta.length;ma++)2===Ta.J(ma).type&&Aa.add(Ta.J(ma));return Aa}gzn(Ta){var Aa=this.Gdf(this.Voa),ma=this.Gdf(this.OGa),Ga=this.Gdf(this.$qa),Fa=this.hHd(Aa),
ib=this.hHd(ma),ob=this.hHd(Ga);ib=O.b(Fa,ib,ob);Fa=new k.a;for(ob=0;ob<ib.length;ob++)Fa.EA(Fa.length,ib.J(ob).G$k());ib=this.L$k(Ta);Aa=this.H$k(ib,Fa,Aa,ma,Ga);ma=0;Ga=new e.a;for(Fa=0;Fa<Ta.length;Fa++)if(ib=Ta.J(Fa),2===ib.type)if(Ga.contains(ib.Cj))if(ma<Aa.length)Ta.mF(Fa),Ta.insert(Fa,Aa.J(ma)),ma++;else return!1;else Ga.add(ib.Cj);0<Ta.length&&2!==Ta.J(Ta.length-1).type&&ma<Aa.length&&Ta.insert(Ta.length,Aa.J(ma));return!0}L$k(Ta){const Aa=new e.a;for(let ma=0;ma<Ta.length;ma++)2===Ta.J(ma).type&&
Aa.add(Ta.J(ma).Cj);return Aa}H$k(Ta,Aa,ma,Ga,Fa){const ib=new k.a;for(let ob=0;ob<Aa.length;ob++){const fb=Aa.J(ob);if(!Ta.contains(fb)){let Mb;(({block:Mb}=this.e9e(Ga,fb)).returnValue||({block:Mb}=this.e9e(Fa,fb)).returnValue||({block:Mb}=this.e9e(ma,fb)).returnValue)&&Mb&&ib.add(Mb)}}return ib}e9e(Ta,Aa){for(let ma=0;ma<Ta.length;ma++)if(2===Ta.J(ma).type&&Ta.J(ma).Cj===Aa)return Ta=Ta.J(ma),{returnValue:!0,block:Ta};return{returnValue:!1,block:null}}m0a(){const Ta=new k.a;mb.a.$8b(this.Lg,"BaseObjects_",
this.GE,Ta);mb.a.$8b(this.Lg,"FavoredObjects_",this.rxa,Ta);mb.a.$8b(this.Lg,"ConflictObjects_",this.Cya,Ta)}Rpk(){let Ta,Aa;Ta=n.a.nil;Aa=-1;let ma=0;for(let Ga=0;Ga<this.$O.Je.length;Ga++){const Fa=this.$O.Je.J(Ga);if(Fa.I2())ma+=Fa.length;else if(6!==Fa.type)ma=0;else return Ta=Fa.Cj,Aa=ma,{returnValue:!0,objectId:Ta,cp:Aa}}a.a.instance.Wa(17409923,1,2,"CalculatePositionOfPlaceHolderCp: Unable to find placeholder Cp");return{returnValue:!1,objectId:Ta,cp:Aa}}A3c(Ta,Aa){let ma,Ga;Ga=Aa;ma=Ta;try{let Fa=
this.initialize();if(Fa=(Fa=Fa&&this.wdh(!0,Ta,Aa).returnValue)&&({objectId:ma,cp:Ga}=this.Rpk()).returnValue)return a.a.instance.Wa(17409924,1,5,"UpdateCpAccordingToIncomingChange returned success [ResultObjectId: {0}] [ResultCp: {1}]",ma,Ga),{returnValue:!0,i2a:ma,Hna:Ga}}catch(Fa){a.a.instance.Wa(17409925,1,2,"UpdateCpAccordingToIncomingChange Crashed! Retrying using the old method [{0}]",this.zFd(Fa))}this.s_c(5);a.a.instance.Wa(17409926,1,2,"UpdateCpAccordingToIncomingChange: ParagraphMergeUsingHints returned failure [MergeFailureReason:{0}] [RetryMergeWithoutHints:{1}]",
this.zpa,this.RUf);this.m0a();return{returnValue:!1,i2a:ma,Hna:Ga}}static WLh(Ta,Aa){let ma;ma=new k.a;if(!Ta.input.X4b)return{returnValue:!0,$zf:ma};Ta=Ta.input.G3.last().AYa(B.a.CK);ma=Aa.getPropertyObjectIds(Ta,l.a.R_);return{returnValue:!0,$zf:ma}}static Y6m(Ta){if(!mb.a.p5e(Ta))return!0;const Aa=new y.a;Ta.runtime.Rm.Z(B.a.CK,mb.a.r4l(Ta,Aa));return!0}static G6m(Ta){if(!Ta.runtime.Rm.xb(B.a.CK)||!Ta.runtime.lq.xb(B.a.CK))return!0;const Aa=new y.a,ma=Ta.runtime.Rm.J(B.a.CK);var Ga=Aa.getPropertyString(ma.im,
l.a.DQa);if(n.a.Of(Ga).equals(n.a.nil))return!0;Ga=Aa.getPropertyObjectIds(ma.im,l.a.R_);const Fa=Aa.getPropertyObjectIds(Ta.runtime.lq.J(B.a.CK),l.a.R_);let ib;({$zf:ib}=Hb.WLh(Ta,Aa));for(let ob=0;ob<Fa.length;ob++)Ga.contains(Fa.J(ob),(fb,Mb)=>fb.equals(Mb))||ib.contains(Fa.J(ob),(fb,Mb)=>fb.equals(Mb))||(Ga.add(Fa.J(ob)),Ta.runtime.Rm.Z(Fa.J(ob),new Rb.a(Ta.runtime.lq.J(Fa.J(ob)).HG())));Aa.setPropertyObjectIds(ma.im,l.a.R_,Ga);return!0}}Object(C.a)(Hb,"ParagraphMergeUsingHints",null,[1741])},
1601:function(C,N,d){C=d(0);class l{constructor(u){this.Iti=u;this.succeeded=!1;this.Ngc=u?u.Ngc:0;this.Jlm=!1;this.length=this.z6n=0}}Object(C.a)(l,"TrieResult",null,[]);class e{constructor(u,t,y){this.rhb=new l(null);this.jDm=u;this.zRc=t;this.Boi=t+y-1}get result(){return this.rhb}JUh(){let u;return this.zRc<=this.Boi?(u=this.jDm.charAt(this.zRc),++this.zRc,{returnValue:!0,ch:u}):{returnValue:!1,ch:"\x00"}}xRf(u,t,y){u&&(this.rhb.Jlm=!0,this.rhb.z6n=t);this.rhb.length=this.zRc;this.rhb.succeeded=
!0;this.rhb.Ngc=y;this.zRc!==this.Boi+1&&(this.rhb=new l(this.rhb))}}Object(C.a)(e,"LookUpStringVisitor",null,[1302]);var a=d(1679);class k{constructor(){this.Pkh=this.oih=this.qih=this.nih=this.pih=this.OUe=this.MUe=this.QUe=this.LUe=0}}Object(C.a)(k,"TRIESTATS",null,[]);class n{constructor(){this.symbol=this.USc=0}}Object(C.a)(n,"TrieSymbol",null,[]);d.d(N,"a",function(){return v});class v{constructor(u,t){this.M2=null;this.VTd=this.Qoi=this.Ooi=this.Soi=this.Koi=this.Roi=this.Poi=this.Toi=this.Loi=
0;this.HI=u;if(u.fy(t,4)!==v.ewb)throw Error.argument("Input does not represent a trie");t+=4;this.Doi=1===u.fy(t,4);t+=4;this.gDm=1===u.fy(t,4);t+=4;this.cDm=u.fy(t,4);t+=4;if(u.fy(t,4)){u=t+4;this.M2=this.kgn(u);this.Loi=t=u+v.lok;this.Toi=t+=v.vtd*(this.M2.LUe+(this.M2.LUe%2?1:0));this.Poi=t+=v.vtd*(this.M2.QUe+(this.M2.QUe%2?1:0));this.Roi=t+=v.vtd*(this.M2.MUe+(this.M2.MUe%2?1:0));this.Koi=t+=v.vtd*(this.M2.OUe+(this.M2.OUe%2?1:0));this.Soi=t+=v.SUe*this.M2.nih;this.Ooi=t+=v.TUe*this.M2.qih;
this.Qoi=t+=v.TUe*this.M2.oih;t+=v.TUe*this.M2.pih;if(t!==u+this.M2.Pkh)throw Error.argument("Corrupted trie binary");this.VTd=t}else this.M2=null}aoi(u,t,y,B){u=new e(u,t,y);this.Zkj(u,B);return u.result}DZh(u){if(this.Doi)if(u)--u;else return"";if(!this.M2)throw Error.argument("Invalid trieID");const t=new a.a;t.DE=0;this.HLb(t);const y=[];for(;;){if(t.DE&v.X4a)if(u)--u;else return Array.add(y,t.JMb),String.fromCharCode.apply(null,y);const B=!!(t.DE&v.Tfe),G=this.x2b(t,!0);if(B||u<G){if(Array.add(y,
t.JMb),!this.HLb(t))throw Error.argument("Invalid trieID");}else if(u-=G,!this.T2c(t))throw Error.argument("Invalid trieID");}}Zkj(u,t){let y=0;this.Doi&&(u.xRf(this.gDm,this.cDm,0),++y);if(this.M2){var B=new a.a;B.DE=0;if(this.HLb(B))for(;;){var G=void 0;if(!({ch:G}=u.JUh()).returnValue)break;t&&(G=t(G));G=G.toString().charCodeAt(0);let F=!1;for(;!F;){const K=!!(B.DE&v.X4a);if(B.JMb===G){if(F=!0,K&&u.xRf(!!(B.DE&v.hfg),B.kae,y),!this.HLb(B))return}else if(y+=this.x2b(B,!0),!this.T2c(B))return;K&&
++y}}}}HLb(u){if(!u.DE)return this.y6f(u),!0;if(!(u.DE&v.Sfe))return!1;u.$La=0;u.Vw=u.Ueb;this.y6f(u);return!0}T2c(u){if(u.DE&v.Tfe)return!1;this.y6f(u);return!0}x2b(u,t){return u.DE&v.gfg?u.utd:u.DE&v.Sfe?!t&&u.DE&v.Tfe?this.Pnl(u):1:0}Pnl(u){u=v.tXe(u);if(!this.HLb(u))return 0;let t=0;do u.DE&v.X4a&&++t,t+=this.x2b(u,!1);while(this.T2c(u));return t}y6f(u){u.DE||(u.$La=0,u.Vw=this.VTd);var t=this.Fyd(this.Loi,u.Vw),y=t.symbol;u.Vw+=t.USc;t=this.HI.fy(this.Koi+v.SUe*y,v.SUe);u.JMb=t&65535;u.DE=t>>
16;u.DE&v.gfg&&(u.utd=this.EQk(u));u.DE&v.hfg&&(t=this.Fyd(this.Toi,u.Vw),y=t.symbol,u.Vw+=t.USc,u.kae=this.HI.fy(this.Soi+4*y,4));u.DE&v.Bsj?(u.Ueb=this.VTd+((this.HI.J(u.Vw)<<8|this.HI.J(u.Vw+1))<<8|this.HI.J(u.Vw+2)),u.Vw+=3):u.DE&v.Csj?(u.Ueb=u.Vw,u.$La=u.Ueb):u.DE&v.Dsj?(t=this.Fyd(this.Poi,u.Vw),y=t.symbol,u.Vw+=t.USc,u.Ueb=this.VTd+this.HI.fy(this.Ooi+4*y,4)):u.DE&v.Sfe&&(t=this.Fyd(this.Roi,u.Vw),y=t.symbol,u.Vw+=t.USc,u.$La||(u.$La=u.Vw),u.$La+=this.HI.fy(this.Qoi+4*y,4),u.Ueb=u.$La)}Fyd(u,
t){const y=new n;let B=0;for(;;){B+=this.HI.J(t);++t;++y.USc;const G=this.HI.fy(u,2);if(B<G)break;y.symbol+=G;B-=G;u+=2;B<<=8}y.symbol+=B;return y}EQk(u){let t=this.HI.J(u.Vw);192<=t?(t=(t&63)<<15|(this.HI.J(u.Vw+1)&127)<<8,t|=this.HI.J(u.Vw+2),u.Vw+=3):128<=t?(t=(t&127)<<8|this.HI.J(u.Vw+1),u.Vw+=2):u.Vw+=1;return t}kgn(u){const t=new k;t.LUe=this.HI.fy(u+12,2);t.QUe=this.HI.fy(u+14,2);t.MUe=this.HI.fy(u+16,2);t.OUe=this.HI.fy(u+18,2);t.pih=this.HI.fy(u+24,4);t.nih=this.HI.fy(u+28,4);t.qih=this.HI.fy(u+
32,4);t.oih=this.HI.fy(u+36,4);t.Pkh=this.HI.fy(u+40,4);return t}static tXe(u){const t=new a.a;t.JMb=u.JMb;t.DE=u.DE;t.utd=u.utd;t.Vw=u.Vw;t.Ueb=u.Ueb;t.$La=u.$La;t.kae=u.kae;return t}}v.ewb=1654263084;v.lok=48;v.vtd=2;v.TUe=4;v.SUe=4;v.X4a=1;v.Tfe=2;v.gfg=4;v.hfg=8;v.Sfe=16;v.Csj=64;v.Dsj=128;v.Bsj=256;Object(C.a)(v,"Trie",null,[1305])},1605:function(C,N,d){d.r(N);C=d(0);d(1474);var l=d(1492),e=d(1471),a=d(2),k=d(80),n=d(13);class v{constructor(){this.nIe=0}COf(K,O){this.nIe=window.performance.now();
this.MQa(()=>{const H=window.performance.now(),I={};O.F9j&&(I.callback=J=>{K(J,OSF.StoreTypeEnum.MarketPlace,H)},a.AFrameworkApplication.ya.Xb(n.a.KHb,2,I));O.G9j&&(I.callback=J=>{K(J,OSF.StoreTypeEnum.PrivateCatalog,H)},a.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeFixOSFUndefinedBug",!0)?I.storeType=10:I.storeType=OSF.StoreTypeEnum.PrivateCatalog,a.AFrameworkApplication.ya.Xb(n.a.KHb,2,I))},0,()=>{if(e.TellMeActor.instance.Ze)e.TellMeActor.instance.Ze.onError("AddinEntitlementsQuery:QueryEntitlementAsync",
"Query entitlements timeout after "+(window.performance.now()-this.nIe)+" ms")})}MQa(K,O=0,H=null){2!==a.AFrameworkApplication.ya.processAction(n.a.KHb,1)?(e.TellMeActor.instance.Ze&&e.TellMeActor.instance.Ze.WB(l.a.D9j,window.performance.now()-this.nIe),K()):20>O?a.AFrameworkApplication.uc.$b(new k.a(2,1,500,()=>{this.MQa(K,O+1,H)})):H&&H()}static get instance(){v._instance||(v._instance=new v);return v._instance}}v._instance=null;Object(C.a)(v,"AddinEntitlementsQuery",null,[]);class u{constructor(){this.description=
this.id=this.displayName=null;this.targetType=0;this.assetStoreId=this.assetId=this.appVersion=null;this.height=this.width=0;this.hvf=this.storeType=this.storeId=this.providerName=this.iconUrl=null}}Object(C.a)(u,"AddinInfo",null,[]);var t=d(1475),y=d(1478),B=d(1477),G=d(1470);d.d(N,"AddinResultsProvider",function(){return F});class F{constructor(K){this.qc=K;this.FSm=(O,H,I)=>{if(O){const J=O.errorCode;if(e.TellMeActor.instance.Ze){const L={};L.StoreType=H;L.ErrorCode=J;L.AddinCount=O.value?O.value.length:
0;e.TellMeActor.instance.Ze.WB(l.a.Ugl,window.performance.now()-I,L)}if(0===J&&O.value){F.svb=F.svb||{};O=O.value;for(const L of O)O=new u,O.displayName=L[0],O.id=L[1],O.description=L[2],O.targetType=L[3],O.appVersion=4<L.length?L[4]:"",O.assetId=5<L.length?L[5]:"",O.assetStoreId=6<L.length?L[6]:"",O.width=7<L.length?L[7]:0,O.height=8<L.length?L[8]:0,O.iconUrl=9<L.length?L[9]:"",O.providerName=10<L.length?L[10]:"",O.storeId=11<L.length?L[11]:"",O.storeType=12<L.length?L[12]:"",this.qc.AVi&&(O.hvf=
this.Cwl(O)),F.svb[O.id]=O,0<O.iconUrl.length&&appChrome.addInApi.registerAddinIcon("AddinIcon_"+O.id,O.iconUrl)}}};v.instance.COf(this.FSm,this.qc)}FL(){return"Add-ins"}FW(){return 0===this.qc.Kv?0:1===this.qc.Kv?1:2}DI(K,O,H,I,J=null){H=new B.a(K);J&&!Array.contains(J,24)||G.a.ZW(K)||(J=new y.a(24),J.displayName=CommonUIStrings.l_TellMeAddinProviderTitle,this.dwl(K.Fg,J),H.iw(J));O.resultsUpdated(H)}dwl(K,O){if((K=this.mDn(K))&&0<K.length){let H=0;K.forEach(I=>{if(!(3<++H)){var J="AddinSuggestion"+
H,L={};L["default"]=0<I.iconUrl.length?"AddinIcon_"+I.id:"AppForOfficeLogo_20";var S=[];S.push(appChrome.actions.setControlLabel(J,I.displayName));S.push(appChrome.actions.setControlIconSet(J,L));S.push(appChrome.actions.setCompoundButtonCommandValueId(J,I.id));S.push(appChrome.actions.updateCompoundButtonDescription(J,I.description));appChrome.api.dispatch(S);J=new t.a(J,25,void 0,void 0,1);J.UH=Telemetry.PrivacyRules.GetPrivacyCompliantId(I.id,I.storeType,I.assetId,null,null,I.storeId);O.yz(J)}})}}mDn(K){if(!F.svb)return null;
const O=[],H=F.svb;for(let J in H){var I=H[J];I&&(this.qc.AVi?F.oFm(K,I)&&Array.add(O,I):0<=I.displayName.toLowerCase().indexOf(K.toLowerCase())?Array.add(O,I):this.qc.Sjm&&0<=I.description.toLowerCase().indexOf(K.toLowerCase())&&Array.add(O,I))}return O}Cwl(K){const O=F.o7i(K.displayName);this.qc.E9j&&Array.addRange(O,F.o7i(K.description));return O}static oFm(K,O){if(!O.hvf)return!1;for(const H of K.split(" ")){K=!1;for(const I of O.hvf)if(I.toLowerCase().startsWith(H.toLowerCase())){K=!0;break}if(!K)return!1}return!0}static o7i(K){const O=
[];for(const H of K.split(" ")){K=0;for(let I=0;I<H.length;I++){const J=H.charAt(I);J.toString().toUpperCase()===J.toString()&&I>K&&(Array.add(O,H.substring(K,I)),K=I)}Array.add(O,H.substring(K,H.length));K&&Array.add(O,H.substring(0,H.length))}return O}}F.svb=null;Object(C.a)(F,"AddinResultsProvider",null,[1098])},1661:function(C,N,d){d.d(N,"a",function(){return e});C=d(0);var l=d(216);class e{constructor(){this.$ib=this.ajb=this.$Wa=this.wfb=this.Zib=this.Mbb=this.ufb=this.z1a=this.Nbb=this.vfb=
null;this.reset()}reset(){this.vfb=new l.a;this.Nbb=new l.a;this.z1a=new l.a;this.ufb=new l.a;this.Mbb=new l.a;this.Zib=new l.a;this.wfb=new l.a;this.$Wa=new l.a;this.$Wa=new l.a;this.ajb=new l.a;this.$ib=new l.a}Gpo(a){return this.RLa(this.vfb,a)&&this.RLa(this.Nbb,a)&&this.RLa(this.z1a,a)&&this.RLa(this.ufb,a)&&this.RLa(this.Mbb,a)&&this.RLa(this.Zib,a)&&this.RLa(this.wfb,a)&&this.RLa(this.$Wa,a)&&this.RLa(this.ajb,a)&&this.RLa(this.$ib,a)}RLa(a,k){return!a||!a.length||a.length===k}}Object(C.a)(e,
"MergeableTrackedChangesProperties",null,[])},1662:function(C,N,d){d.d(N,"a",function(){return a});C=d(0);var l=d(216),e=d(619);class a{constructor(){this.QFa=new l.a;this.NGa=new l.a;this.ZIa=new l.a}get Nvb(){return this.QFa}get E8e(){return this.NGa}get dmb(){return this.ZIa}get isEmpty(){return!this.QFa.length&&!this.NGa.length&&!this.ZIa.length}get xzf(){return Math.max(Math.max(this.QFa.length,this.NGa.length),this.ZIa.length)}get HIm(){return Math.min(Math.min(this.QFa.length,this.NGa.length),
this.ZIa.length)}Nrd(k){this.QFa.add(k)}Qrd(k){this.NGa.add(k)}Vrd(k){this.ZIa.add(k)}G$k(){const k=new e.a,n=new l.a;let v=0;for(;v<this.QFa.length||v<this.NGa.length||v<this.ZIa.length;)v<this.QFa.length&&!k.contains(this.QFa.J(v))&&(n.add(this.QFa.J(v)),k.add(this.QFa.J(v))),v<this.NGa.length&&!k.contains(this.NGa.J(v))&&(n.add(this.NGa.J(v)),k.add(this.NGa.J(v))),v<this.ZIa.length&&!k.contains(this.ZIa.J(v))&&(n.add(this.ZIa.J(v)),k.add(this.ZIa.J(v))),v++;return n}}Object(C.a)(a,"ObjectCollection",
null,[])},1663:function(C,N,d){d.d(N,"a",function(){return l});C=d(0);class l{constructor(e,a){this.lFa=a;this.updateHints=e}}Object(C.a)(l,"UpdateHintCollection",null,[])},1664:function(C,N,d){d.d(N,"a",function(){return l});C=d(0);d=d(1532);class l extends d.a{constructor(e,a){super();this.Bg=e;this.Nc=a}get type(){return 9}toString(){return String.format("[Cp:{0}] [Type:{1}] [ParaId:{2}] [WordId:{3}]",this.cp,this.type,this.Bg,this.Nc)}}Object(C.a)(l,"LcsInsertParaUpdateHint",d.a,[])},1665:function(C,
N,d){d.d(N,"a",function(){return e});C=d(0);var l=d(216);d=d(1532);class e extends d.a{constructor(a){super();this.AZ=new l.a;this.cp=a}get type(){return 11}toString(){let a="";for(let k=0;k<this.AZ.length;k++)a+=String.format("({0}), ",this.AZ.J(k).toString());return String.format("[Cp:{0}] {1}",this.cp,a)}}Object(C.a)(e,"LcsInsertUpdateHint",d.a,[])},1666:function(C,N,d){d.d(N,"a",function(){return l});C=d(0);d=d(1532);class l extends d.a{constructor(e,a){super();this.text=a;this.Bg=e}get type(){return 7}toString(){return String.format("[Cp:{0}] [Type:{1}] [ParaId:{2}] [Text:{3}]",
this.cp,this.type,this.Bg,this.text)}}Object(C.a)(l,"LcsInsertTextUpdateHint",d.a,[])},1667:function(C,N,d){d.d(N,"a",function(){return l});C=d(0);d=d(1532);class l extends d.a{constructor(e,a,k){super();this.cp=e;this.Bg=a;this.Nc=k}get type(){return 10}toString(){return String.format("[Cp:{0}] [Type:{1}] [ParaId:{2}] [WordId:{3}]",this.cp,this.type,this.Bg,this.Nc)}}Object(C.a)(l,"LcsDeleteParaUpdateHint",d.a,[])},1668:function(C,N,d){d.d(N,"a",function(){return l});C=d(0);d=d(1532);class l extends d.a{constructor(e,
a){super();this.cp=e;this.text=a}get type(){return 8}toString(){return String.format("[Cp:{0}] [Type:{1}] [Text:{2}]",this.cp,this.type,this.text)}}Object(C.a)(l,"LcsDeleteTextUpdateHint",d.a,[])},1669:function(C,N,d){d.d(N,"a",function(){return l});C=d(0);d=d(1506);class l extends d.a{constructor(){super()}get hea(){return"Conflict"}}Object(C.a)(l,"ConflictMergeFailureDetail",d.a,[])},1670:function(C,N,d){d.r(N);d.d(N,"InsightsMenuItemFactory",function(){return k});C=d(0);var l=d(1470),e=d(236),
a=d(16);class k{constructor(n=null){this.IHj=n||CommonUIStrings.l_InsightsButtonText}get KIb(){return 10}Qda(n){var v=n.$B;n=l.a.xCa()?l.a.MWa(v,1):l.a.Axb(v);v=String.format(this.IHj,v);return this.sfl(n,v)}sfl(n,v){return e.a(k.t9h,l.a.xCa()?"1914896509":"3317204163",a.a.If(v),l.a.tof,null,a.a.If(n),a.a.If(v),null,null)}}k.t9h="bInsights";Object(C.a)(k,"InsightsMenuItemFactory",null,[967])},1671:function(C,N,d){d.d(N,"a",function(){return a});C=d(0);var l=d(236),e=d(16);class a{constructor(k,n,
v,u,t){this.eGe=k;this.dGe=n;this.CXj=v;this.mGj=u;this.sIg=t}get KIb(){return 4}Qda(k,n=null){n=n.sessionId+"|"+n.Rla+"|"+k.$B;if(this.sIg||this.mGj){let v=this.sIg||e.a.Wz(CommonUIStrings.l_HelpTooltip)===e.a.Wz(k.$B.trim());if(this.CXj&&2<k.$B.length){const u=k.$B;";"===u.charAt(0)&&";"===u.charAt(u.length-1)&&u.substring(1,u.length-1)===a.elf&&(v=!0)}k=v?CommonUIStrings.l_HelpButtonTextNoPlaceholder:String.format(CommonUIStrings.l_TextWithQuotation,k.$B);return this.lLh(n,e.a.If(k),v)}return this.lLh(n,
e.a.If(String.format(CommonUIStrings.l_TextWithQuotation,k.$B)),!1)}lLh(k,n,v){return l.a(a.elf,v?this.dGe:this.eGe,n,"OfficeAssistant_16x16x32","A0",e.a.If(k),n,null,null)}}a.elf="bSearchHelp";Object(C.a)(a,"AssistanceMenuItemFactory",null,[967])},1672:function(C,N,d){d.d(N,"a",function(){return n});C=d(0);var l=d(2),e=d(236),a=d(96),k=d(16);class n{get KIb(){return 13}Qda(){return n.slk()}static slk(){return e.b(n.yIh,"798637440",k.a.If(CommonUIStrings.l_LookupFirstRunExperienceTitle),l.AFrameworkApplication.pr,
a.getImageClass("Info_32x32x32"),null,null,k.a.If(CommonUIStrings.l_LookupFirstRunExperienceTitle),"Menu32",null,null,k.a.If(CommonUIStrings.l_LookupFirstRunExperienceDescription),null,null)}}n.yIh="bTellMeFirstRun";Object(C.a)(n,"FirstRunMenuItemFactory",null,[967])},1673:function(C,N,d){d.d(N,"a",function(){return k});C=d(0);var l=d(2),e=d(236),a=d(16);class k{constructor(n=null,v=null){this.WRg=n;this.oNj=v||CommonUIStrings.l_LookupNoResultsDescription}get KIb(){return 14}Qda(n){n=String.format(this.oNj,
n.$B);return this.rmk(n)}rmk(n){return e.b(k.Vti,"798637440",a.a.If(CommonUIStrings.l_LookupNoResultsTitle),this.WRg?l.AFrameworkApplication.pr:null,this.WRg,null,null,a.a.If(CommonUIStrings.l_LookupNoResultsTitle),"Menu32",null,null,a.a.If(n),null,null)}}k.Vti="lookupNoResults";Object(C.a)(k,"NoCommandsFoundMenuItemFactory",null,[967])},1674:function(C,N,d){d.d(N,"a",function(){return l});C=d(0);class l{constructor(e,a){this.FontWeight=0;this.Text=null;this.FontWeight=e;this.Text=a}}Object(C.a)(l,
"LabelFormatted",null,[])},1675:function(C,N,d){d.d(N,"a",function(){return v});C=d(0);d(1474);var l=d(1475),e=d(1478),a=d(1477),k=d(1470),n=d(16);class v{constructor(u){this.qc=u}FL(){return"Assistance"}FW(){return 0===this.qc.Kv?0:1===this.qc.Kv?1:this.qc.aUc?3:2}DI(u,t,y=!1,B,G=null){B=new a.a(u);if((!G||Array.contains(G,8))&&!k.a.ZW(u)){G=new e.a(8);if(y){y=n.a.Wz(CommonUIStrings.l_HelpTooltip)===n.a.Wz(u.Fg.trim())?CommonUIStrings.l_HelpButtonTextNoPlaceholder:String.format(CommonUIStrings.l_TextWithQuotation,
u.Fg);const F=[];this.qc.L_a&&(this.qc.r8d||F.push(appChrome.actions.setControlIconSet("GetHelpFromTellMe",{"default":"search_20"})),y=this.aVh(u.Fg));const K="||"+u.Fg;F.push(appChrome.actions.setControlLabel("GetHelpFromTellMe",y));F.push(appChrome.actions.setButtonCommandValueId("GetHelpFromTellMe",K));appChrome.api.dispatch(F);u=new l.a("GetHelpFromTellMe",4,u.Fg,null,1)}else u=new l.a("bSearchHelp",4,u.Fg,null,1);G.yz(u);G.displayName=CommonUIStrings.l_HelpButtonTitle;B.iw(G)}t.resultsUpdated(B)}xeb(u,
t=null){const y=new e.a(8),B=n.a.Wz(CommonUIStrings.l_HelpTooltip)===n.a.Wz(u.Fg.trim())?CommonUIStrings.l_HelpButtonTextNoPlaceholder:String.format(CommonUIStrings.l_TextWithQuotation,u.Fg);for(let F=0;F<t.length&&2>F;F++){var G=void 0;G=[];let K="GetHelpWithDescriptionFromTellMe"+(F+1).toString(),O=4;if(this.qc.j0c)G.push(appChrome.actions.setControlLabel(K,B)),G.push(appChrome.actions.setCompoundButtonCommandValueId(K,u.Fg)),G.push(appChrome.actions.updateCompoundButtonDescription(K,this.Qif(t.length)));
else if(this.qc.k0c){let H=this.l0h(t[F]);K="GetHelpFromTellMe"+(F+1).toString();this.qc.L_a&&(H=this.aVh(H));O=9;G.push(appChrome.actions.setControlLabel(K,H));G.push(appChrome.actions.setButtonCommandValueId(K,this.UMl(t[F])))}appChrome.api.dispatch(G);G=new l.a(K,O,null,null,0);G.label=this.l0h(t[F]);G.description=this.TMl(t[F]);y.yz(G);if(this.qc.k0c)break}y.displayName=CommonUIStrings.l_HelpButtonTitle;return y}Qif(u){return 1===u?String.format(CommonUIStrings.l_SearchResultText,u):String.format(CommonUIStrings.l_SearchResultsText,
u)}aVh(u){return this.qc.Ltf?k.a.kef(u,CommonUIStrings.l_HelpScopedButtonText):u+CommonUIStrings.l_HelpScopedButtonText}l0h(u){return u.name?u.name:""}TMl(u){return u.description?u.description:""}UMl(u){return u.id?"AssetID="+u.id:""}}Object(C.a)(v,"AssistanceResultsProvider",null,[1098])},1676:function(C,N,d){d.d(N,"a",function(){return u});C=d(0);d(1474);var l=d(1475),e=d(1478),a=d(1477),k=d(1471),n=d(1470),v=d(1530);class u{constructor(t){this.qc=t}FL(){return"Image"}FW(){return 0===this.qc.Kv?
0:1===this.qc.Kv?1:3===this.qc.Kv?3:2}DI(t,y,B,G,F=null){B=new a.a(t);(!F||Array.contains(F,19))&&n.a.ZW(t)&&this.qc.VQ&&this.xeb(t,B,1);y.resultsUpdated(B)}xeb(t,y,B,G=null){var F=[];let K;k.TellMeActor.instance.ON()&&k.TellMeActor.instance.ON().L_a?(K=this.qc.Ltf?n.a.kef(t.Fg,CommonUIStrings.l_TellMeImageSuggestionScopedButtonTextNoHeader):t.Fg+CommonUIStrings.l_TellMeImageSuggestionScopedButtonTextNoHeader,this.qc.r8d||F.push(appChrome.actions.setControlIconSet("ImageForSearch",{"default":"search_20"}))):
K=this.qc.VQ?n.a.ZW(t)?this.qc.dab?n.a.odb(CommonUIStrings.l_TellMeImageSuggestionButtonTextV2Bolded):CommonUIStrings.l_TellMeImageSuggestionButtonTextV2:this.qc.dab?n.a.odb(String.format(CommonUIStrings.l_TellMeScopedImageSuggestionButtonTextBolded,t.Fg)):String.format(CommonUIStrings.l_TellMeScopedImageSuggestionButtonText,t.Fg):this.qc.yec?CommonUIStrings.l_TellMeImageSuggestionButtonText:t.Fg+CommonUIStrings.l_TellMeImageSuggestionScopedButtonTextWithHeader;this.qc.qBa?(k.TellMeActor.instance.actions.push(appChrome.actions.setControlLabel("ImageForSearch",
K)),F=n.a.MWa(t.Fg,9,Object.assign(new v.a,{landingTab:"Image"})),k.TellMeActor.instance.actions.push(appChrome.actions.setButtonCommandValueId("ImageForSearch",F))):(F.push(appChrome.actions.setControlLabel("ImageForSearch",K)),t=n.a.MWa(t.Fg,9,Object.assign(new v.a,{landingTab:"Image"})),F.push(appChrome.actions.setButtonCommandValueId("ImageForSearch",t)),appChrome.api.dispatch(F));B=new l.a("ImageForSearch",12,null,null,B);G&&(B.score=G.ConfidenceScore);G=new e.a(19,this.qc.yec?CommonUIStrings.l_TellMeImageTitleV2:
CommonUIStrings.l_TellMeImageTitle);G.yz(B);y.iw(G)}}Object(C.a)(u,"ImageResultsProvider",null,[1098])},1677:function(C,N,d){d.d(N,"a",function(){return v});C=d(0);d(1474);var l=d(1475),e=d(1478),a=d(1477),k=d(1470),n=d(2);class v{constructor(u){this.qc=u}FL(){return"Template"}FW(){return 0===this.qc.Kv?0:1===this.qc.Kv?1:3}DI(u,t){u=new a.a(u);t.resultsUpdated(u)}xeb(u,t,y){var B=[];let G;G=this.qc.VQ?this.qc.dab?k.a.odb(String.format(CommonUIStrings.l_TellMeTemplateButtonTextV2Bolded,u.Fg)):String.format(CommonUIStrings.l_TellMeTemplateButtonTextV2,
u.Fg):String.format(CommonUIStrings.l_TellMeTemplateButtonText,u.Fg);B.push(appChrome.actions.setControlLabel("TemplateForSearch",G));B.push(appChrome.actions.setButtonCommandValueId("TemplateForSearch",String.format(n.AFrameworkApplication.K.lb("TellMeTemplateProviderURL"),n.AFrameworkApplication.uiCulture,u.Fg)));appChrome.api.dispatch(B);u=new e.a(23);u.displayName=CommonUIStrings.l_TellMeTemplateProviderTitle;B=new l.a("TemplateForSearch",24,null,null,0);B.label=y[0].Title?y[0].Title:"";B.description=
y[0].Description?y[0].Description:"";u.yz(B);t.iw(u)}}Object(C.a)(v,"TemplateResultsProvider",null,[1098])},1678:function(C,N,d){d.d(N,"a",function(){return y});C=d(0);d(1474);var l=d(1508),e=d(1475),a=d(1478),k=d(1477),n=d(1592),v=d(1471),u=d(1470),t=d(16);class y{constructor(B,G,F,K){this.U0=B;this.o$a=G;this.T3g=K;this.JDj=F;this.qc=v.TellMeActor.instance.ON()}FL(){return"EmptyQuery"}FW(){return 1===this.qc.Kv?1:0}DI(B,G,F=!1,K,O=null){K=new k.a(B);if((!O||Array.contains(O,5)||Array.contains(O,
6)||Array.contains(O,4))&&u.a.ZW(B)){this.U0.LHc().length||!this.JDj||this.T3g||(B=new a.a(6),O=new e.a(null,13,void 0,void 0,1),B.yz(O),K.iw(B));B=new a.a(4);if(0<this.U0.LHc().length){B.displayName=CommonUIStrings.l_TellMeRecentlyUsedTitle;O=this.U0.LHc();var H=[];for(var I of O)H.push(I.Id);l.CommandResultsUtility.w3c(H,this.qc);for(var J of O)l.CommandResultsUtility.rNc(J.Id)&&B.yz(new e.a(J.Id,5,null,null,2));K.iw(B)}if(this.T3g&&0<this.o$a.length&&this.U0.LHc().length<y.maxResults){I=new a.a(5);
I.displayName=CommonUIStrings.l_TellMeTryQueryTitle;J=y.maxResults-B.results.length;B=[];for(O=0;O<this.o$a.length&&O<J;++O){if(F){H=u.a.b7f+(O+1);const L=this.o$a[O].key,S=t.a.replaceAll(L,'"',"");B.push(appChrome.actions.setControlLabel(H,L));B.push(appChrome.actions.setButtonCommandValueId(H,S));H=new n.a(L,7,0,S,H)}else H=new n.a(this.o$a[O].key,7,0,this.o$a[O].value);I.yz(H)}0<B.length&&appChrome.api.dispatch(B);K.iw(I)}}G.resultsUpdated(K)}}y.maxResults=5;Object(C.a)(y,"EmptyQueryResultsProvider",
null,[1098])},1679:function(C,N,d){d.d(N,"a",function(){return l});C=d(0);class l{constructor(){this.kae=this.$La=this.Ueb=this.Vw=this.utd=this.DE=this.JMb=0}}Object(C.a)(l,"TRIESCAN",null,[])},1694:function(C,N,d){d.r(N);var l=d(0),e=d(1474),a=d(1519),k=d(1492),n=d(1605);class v{constructor(db,Db){this.Ewa=db;this.Ik=Db}resultsUpdated(db){this.Ewa.UNn(this.Ik,db)}}Object(l.a)(v,"AggregatorResultsProviderCallback",null,[1100]);var u=d(1478),t=d(1477);class y{constructor(db){this.Ooa=null;this.qc=
db;this.qc.Cvb&&(this.Ooa=null)}FL(){return"AppsForOffice"}FW(){return 0===this.qc.Kv?0:1===this.qc.Kv?1:2}DI(db,Db,Yb,zc,Vc=null){Yb=new t.a(db);if(!Vc||Array.contains(Vc,1))Vc=new u.a(1),this.Ooa.lBo(Vc,db.Fg),Yb.iw(Vc);Db.resultsUpdated(Yb)}}Object(l.a)(y,"AppsForOfficeRecommendationResultsProvider",null,[1098]);var B=d(1675),G=d(1467),F=d(1486),K=d(120);class O{constructor(db,Db){this.Ab=db;this.fDm=Db}isMatch(db,Db){if(!Object(K.a)(1249,db))throw Error.argument("objToTest","Expected feature bundle");
let Yb;return({value:Yb}=db.kq(this.Ab.yra)).returnValue?this.Ab.i$f.isMatch(Yb,Db):this.fDm}}Object(l.a)(O,"AnnotatedWithAndValueMatchesAnnotationFilter",null,[1289]);class H{constructor(db,Db){this.Ab=db;this.Cyf=Db}isMatch(db){if(!Object(K.a)(1249,db))throw Error.argument("objToTest","Expected feature bundle");return!!(this.Cyf^db.kq(this.Ab.yra).returnValue)}}Object(l.a)(H,"AnnotatedWithAnnotationFilter",null,[1289]);class I{constructor(db){this.Ab=db}isMatch(db,Db){if(!Object(K.a)(1252,db))throw Error.argument("objToTest",
"Expected struct value");return this.Ab.i$f.isMatch(db.Edb(this.Ab.UKa),Db)}}Object(l.a)(I,"FieldValueMatchesStructFilter",null,[1289]);class J{constructor(db,Db){db&&(this.UKa=db.J(0),this.i$f=Db.kla(db.J(1)))}}Object(l.a)(J,"FieldValueMatchesStructFilterInit",null,[]);class L{constructor(db){this.Cyf=db}isMatch(db){if(!Object(K.a)(1249,db))throw Error.argument("objToTest","Expected feature bundle");return!!(this.Cyf^db.vkf)}}Object(l.a)(L,"HasAnnotationsAnnotationFilter",null,[1289]);class S{constructor(db,
Db){this.Ab=db;this.O6=Db}isMatch(db,Db){if(!Object(K.a)(1251,db))throw Error.argument("objToTest","Expected list value");switch(this.O6){case 0:for(const Yb of db.items)if(this.Ab.filter.isMatch(Yb,Db))return!0;return!1;case 1:for(const Yb of db.items)if(!this.Ab.filter.isMatch(Yb,Db))return!1;return!0;default:throw Error.notImplemented();}}}Object(l.a)(S,"ItemTestListFilter",null,[1289]);class E{constructor(db){this.Ab=db}isMatch(db,Db){if(!Object(K.a)(1251,db))throw Error.argument("objToTest",
"Expected list value");return this.Ab.filter.isMatch(db.items.length,Db)}}Object(l.a)(E,"LengthMatchesListFilter",null,[1289]);class P{constructor(db,Db){this.Ab=db;this.O6=Db}isMatch(db,Db,Yb=null){let zc=0===this.O6;for(const Vc of this.Ab.kmh)if((zc=Vc.isMatch(db,Db,Yb))?1===this.O6:0===this.O6)return zc;2===this.O6&&(zc=!zc);return zc}}Object(l.a)(P,"NonterminalFilter",null,[1289]);class T{constructor(db,Db){if(db){var Yb=db.J(0);this.kmh=Array(Yb);for(let zc=0;zc<Yb;++zc)this.kmh[zc]=Db.kla(db.J(1+
zc))}}}Object(l.a)(T,"NonterminalFilterInit",null,[]);class U{constructor(db,Db){this.Ab=db;this.O6=Db}isMatch(db,Db){if("number"!==typeof db)throw Error.argument("objToTest","Expected number value");let Yb=this.Ab.number;if(this.Ab.query){Db=this.Ab.query.at(null,Db);if("number"!==typeof Db)throw Error.invalidOperation("Query did not return number");Yb+=Db}switch(this.O6){case 0:return db===Yb;case 1:return db<Yb;case 2:return db<=Yb;case 3:return db>Yb;case 4:return db>=Yb;default:throw Error.notImplemented();
}}}Object(l.a)(U,"NumberFilter",null,[1289]);class X{constructor(db,Db){db&&(this.number=db.J(0),this.query=db.J(1)?Db.VJ(db.J(1)):null)}}Object(l.a)(X,"NumberFilterInit",null,[]);class Y{constructor(db,Db,Yb){this.DFd=this.Brl;this.lDm=db;this.Hoi=Db;this.Goi=Yb}$Ve(db){this.Hoi=db}Brl(db){if(!db)throw Error.argument("name","Invalid named feature bundle reference");const Db=db.substr(1);return 1===db.charCodeAt(0)&&Db===this.lDm?this.Hoi:this.Goi?this.Goi.DFd(db):null}}Object(l.a)(Y,"SimpleNamedFeatureBundleResolver",
null,[1314]);class ca{constructor(db){this.Ab=db}isMatch(db,Db){if(!Object(K.a)(1249,db))throw Error.argument("objToTest","Expected feature bundle");db=this.Ab.query.at(null,new Y(this.Ab.Jde,db,Db));if("boolean"!==typeof db)throw Error.invalidOperation("Query did not return bool");return db}}Object(l.a)(ca,"PredicateAnnotationFilter",null,[1289]);class da{constructor(db,Db){db&&(this.Jde=Db.nE(db.J(0)),this.query=Db.VJ(db.J(1)))}}Object(l.a)(da,"PredicateAnnotationFilterInit",null,[]);class ua{constructor(db){this.Ab=
db}isMatch(db,Db){if("boolean"!==typeof db)throw Error.argument("objToTest","Expected bool value");Db=this.Ab.query.at(null,Db);if("boolean"!==typeof Db)throw Error.invalidOperation("Query did not return bool");return db===Db}}Object(l.a)(ua,"QueryBooleanFilter",null,[1289]);class ra{constructor(db,Db){this.Ab=db;this.O6=Db}isMatch(db,Db){if("number"!==typeof db)throw Error.argument("objToTest","Expected integer");Db=this.Ab.query.at(null,Db);if("number"!==typeof Db)throw Error.invalidOperation("Query did not return an enum value");
switch(this.O6){case 0:return db===Db;case 1:return 0!==(db&Db);case 2:return db===(db&Db);case 3:return Db===(db&Db);default:throw Error.notImplemented();}}}Object(l.a)(ra,"QueryEnumFilter",null,[1289]);class qa{constructor(db,Db){db&&(this.xPd=1===db.J(0),this.query=Db.VJ(db.J(1)))}}Object(l.a)(qa,"QueryEnumFilterInit",null,[]);class ka{constructor(db,Db){this.Ab=db;this.O6=Db}isMatch(db,Db){if(!Object(K.a)(1251,db))throw Error.argument("objToTest","Expected list value");Db=this.Ab.query.at(null,
Db);if(!Object(K.a)(1251,Db))throw Error.invalidOperation("Query did not return list value");if(db.O2!==Db.O2)return!1;switch(this.O6){case 0:return G.Annotations.vmb(G.Annotations.iyl(db.O2),db,Db);case 1:for(const Yb of db.items)for(const zc of Db.items)if(G.Annotations.vmb(db.O2,Yb,zc))return!0;return!1;case 2:for(const Yb of db.items)for(const zc of Db.items)if(!G.Annotations.vmb(db.O2,Yb,zc))return!1;return!0;case 3:for(const Yb of Db.items)for(const zc of db.items)if(!G.Annotations.vmb(db.O2,
Yb,zc))return!1;return!0;default:throw Error.notImplemented();}}}Object(l.a)(ka,"QueryListFilter",null,[1289]);class la{constructor(db,Db){this.Ab=db;this.O6=Db}isMatch(db,Db){if("string"!==typeof db)throw Error.argument("objToTest","Expected string");Db=this.Ab.query.at(null,Db);if("string"!==typeof Db)throw Error.invalidOperation("Query did not return string");this.Ab.tpf&&(db=db.toUpperCase(),Db=Db.toUpperCase());switch(this.O6){case 0:return db===Db;case 1:return 0<=db.indexOf(Db);case 2:return db.startsWith(Db);
case 3:return db.endsWith(Db);case 4:return 0<=Db.indexOf(db);case 5:return Db.startsWith(db);case 6:return Db.endsWith(db);default:throw Error.notImplemented();}}}Object(l.a)(la,"QueryStringFilter",null,[1289]);class Ha{constructor(db,Db){db&&(this.query=Db.VJ(db.J(0)),this.tpf=1===db.J(1))}}Object(l.a)(Ha,"QueryStringFilterInit",null,[]);class wa{constructor(db){this.Ab=db}isMatch(db,Db){if(!Object(K.a)(1252,db))throw Error.argument("objToTest","Expected struct value");Db=this.Ab.query.at(null,
Db);if(!Object(K.a)(1252,Db))throw Error.invalidOperation("Query did not return struct value");return db.isEqual(db)}}Object(l.a)(wa,"QueryStructFilter",null,[1289]);class Ca{constructor(db){this.Ab=db}isMatch(db,Db){db=this.Ab.query.at(null,Db);if("boolean"!==typeof db)throw Error.invalidOperation("Query did not return bool");return db}}Object(l.a)(Ca,"QueryWhereConstraintFilter",null,[1289]);class Ja{constructor(db){this.Ab=db}isMatch(db){if("string"!==typeof db)throw Error.argument("objToTest",
"Expected string");return this.Ab.TQf.test(db)}}Object(l.a)(Ja,"RegexStringFilter",null,[1289]);class bb{constructor(db,Db){db&&(this.TQf=Db.w3b(db.J(0)))}}Object(l.a)(bb,"RegexStringFilterInit",null,[]);class ha{constructor(db,Db){db&&(this.filter=Db.kla(db.J(0)))}}Object(l.a)(ha,"SingleFilterFilterInit",null,[]);class ia{constructor(db,Db){db&&(this.query=Db.VJ(db.J(0)))}}Object(l.a)(ia,"SingleQueryFilterInit",null,[]);class va{constructor(db){this.Ab=db}isMatch(db){if("boolean"!==typeof db)throw Error.argument("objToTest",
"Expected bool value");return db===this.Ab.value}}Object(l.a)(va,"StoredValueBooleanFilter",null,[1289]);class Ka{constructor(db){db&&(this.value=1===db.J(0))}}Object(l.a)(Ka,"StoredValueBooleanFilterInit",null,[]);class Xa{constructor(db,Db){this.Ab=db;this.O6=Db}isMatch(db){if("number"!==typeof db)throw Error.argument("objToTest","Expected integer");switch(this.O6){case 0:return this.Ab.xPd?this.Ab.value?!!(db&this.Ab.value):!db:db===this.Ab.value;case 1:return this.Ab.xPd?(db&this.Ab.value)===
this.Ab.value:32>db&&(1<<db&this.Ab.value)===this.Ab.value;case 2:return this.Ab.xPd?!!(db&this.Ab.value):32>db&&!!(1<<db&this.Ab.value);default:throw Error.notImplemented();}}}Object(l.a)(Xa,"StoredValueEnumFilter",null,[1289]);class xa{constructor(db){db&&(this.xPd=1===db.J(0),this.value=db.J(1))}}Object(l.a)(xa,"StoredValueEnumFilterInit",null,[]);class Ma{constructor(){this.i2m=null;this.RUe=this.UBb=0}}Object(l.a)(Ma,"WHEREConstraintData",null,[]);class Na{constructor(db){this.Ab=db}isMatch(db,
Db){if(!Object(K.a)(Ma,db))throw Error.argument("objToTest","Expected WHERE constraint data");let Yb=-1,zc=-1;const Vc=db.i2m;switch(this.Ab.IVe){case 4:Yb=Vc.tGc;zc=Vc.E1f;break;case 5:Yb=db.UBb;zc=Vc.tGc-db.UBb;break;case 6:Yb=Vc.tGc+Vc.E1f;zc=db.UBb+db.RUe-Yb;break;case 1:case 2:case 3:let bd=!1;for(let ce=Vc.fCo;ce;ce=ce.next)if(this.Ab.soo===ce.name){bd=!0;1===this.Ab.IVe?(Yb=ce.tGc,zc=ce.E1f):2===this.Ab.IVe?(Yb=db.UBb,zc=ce.tGc-db.UBb):(Yb=ce.tGc+ce.E1f,zc=db.UBb+db.RUe-Yb);break}if(!bd)return!1;
break;case 7:Yb=db.UBb;zc=db.RUe;break;default:throw Error.notImplemented();}return null!==this.Ab.d1n.kFo(Vc.RLo,Yb,zc,Yb,!0,2,Db)}}Object(l.a)(Na,"SubSreWhereConstraintFilter",null,[1289]);class pa{constructor(db,Db){if(db){var Yb=Db.nE(db.J(0));this.IVe=Yb.charCodeAt(0);this.soo=Yb.substr(1);this.d1n=Db.CHl(db.J(1))}}}Object(l.a)(pa,"SubSreWhereConstraintFilterInit",null,[]);class Ra{constructor(db){this.Ab=db}isMatch(db,Db,Yb=null){if(!Object(K.a)(1249,db))throw Error.argument("objToTest","Expected feature bundle");
if(null==Yb)throw Error.argumentNull("parentTextForSpan");if(this.Ab.nbh&&!this.Ab.nbh.isMatch(db,Db))return!1;if(this.Ab.c5f){let zc;if(({value:zc}=db.kq(this.Ab.a0n)).returnValue){if(!this.Ab.c5f.isMatch(zc,Db))return!1}else{let Vc,bd;if(!({value:Vc}=db.kq(this.Ab.M6i)).returnValue||!({value:bd}=db.kq(this.Ab.L6i)).returnValue||0>Vc||0>bd||Vc+bd>Yb.length||!this.Ab.c5f.isMatch(Yb.substr(Vc,bd),Db))return!1}}if(this.Ab.I7i){let zc;if(!({value:zc}=db.kq(this.Ab.M6i)).returnValue||!this.Ab.I7i.isMatch(zc,
Db))return!1}if(this.Ab.Ski){let zc;if(!({value:zc}=db.kq(this.Ab.L6i)).returnValue||!this.Ab.Ski.isMatch(zc,Db))return!1}return!0}}Object(l.a)(Ra,"TextSpanFilter",null,[1289]);class Sa{constructor(db,Db){db&&(this.annotations=Db.annotations,this.M6i=db.J(0),this.L6i=db.J(1),this.a0n=db.J(2),this.c5f=db.J(3)?Db.kla(db.J(3)):null,this.nbh=db.J(4)?Db.kla(db.J(4)):null,this.I7i=db.J(5)?Db.kla(db.J(5)):null,this.Ski=db.J(6)?Db.kla(db.J(6)):null)}}Object(l.a)(Sa,"TextSpanFilterInit",null,[]);class ab{constructor(db,
Db){db&&(this.annotations=Db.annotations,this.yra=db.J(0),this.i$f=db.J(1)?Db.kla(db.J(1)):null)}}Object(l.a)(ab,"ValueFilterAnnotationFilterInit",null,[]);var eb=d(1496);class zb{kla(db,Db){const Yb=db.J(0),zc=new eb.a;zc.bdb(db,1,db.count-1);switch(Yb){case 1:return new P(new T(zc,Db),0);case 2:return new P(new T(zc,Db),1);case 3:return new P(new T(zc,Db),2);case 101:return new Ja(new bb(zc,Db));case 103:return new la(new Ha(zc,Db),0);case 104:return new la(new Ha(zc,Db),1);case 105:return new la(new Ha(zc,
Db),2);case 106:return new la(new Ha(zc,Db),3);case 107:return new la(new Ha(zc,Db),4);case 108:return new la(new Ha(zc,Db),5);case 109:return new la(new Ha(zc,Db),6);case 201:return new va(new Ka(zc));case 202:return new ua(new ia(zc,Db));case 301:return new U(new X(zc,Db),0);case 302:return new U(new X(zc,Db),1);case 303:return new U(new X(zc,Db),2);case 304:return new U(new X(zc,Db),3);case 305:return new U(new X(zc,Db),4);case 401:return new Xa(new xa(zc),0);case 402:return new Xa(new xa(zc),
1);case 403:return new Xa(new xa(zc),2);case 404:return new ra(new qa(zc,Db),0);case 405:return new ra(new qa(zc,Db),1);case 406:return new ra(new qa(zc,Db),2);case 407:return new ra(new qa(zc,Db),3);case 501:return new I(new J(zc,Db));case 502:return new wa(new ia(zc,Db));case 601:return new S(new ha(zc,Db),0);case 602:return new S(new ha(zc,Db),1);case 603:return new E(new ha(zc,Db));case 604:return new ka(new ia(zc,Db),0);case 605:return new ka(new ia(zc,Db),1);case 606:return new ka(new ia(zc,
Db),2);case 607:return new ka(new ia(zc,Db),3);case 701:return new L(!1);case 702:return new L(!0);case 703:return new H(new ab(zc,Db),!1);case 704:return new H(new ab(zc,Db),!0);case 705:return new O(new ab(zc,Db),!1);case 706:return new O(new ab(zc,Db),!0);case 707:return new ca(new da(zc,Db));case 901:return new Ra(new Sa(zc,Db));case 1002:return new Ca(new ia(zc,Db));case 1001:return new Na(new pa(zc,Db));default:throw Error.argument("initData");}}}Object(l.a)(zb,"FilterFactory",null,[1248]);
var Ua=d(1473);class Ab{constructor(db){this.Ab=db}get dD(){return this.Ab.dD}get p3(){return this.Ab.p3}get G$d(){return this.Ab.G$d}get bOd(){return this.Ab.bOd}load(db,Db){return this.at(db,db?new Y("root",db,Db):Db)}store(db,Db,Yb){this.vfc(db,Db,db?new Y("root",db,Yb):Yb,null)}at(db,Db){if(!this.bOd&&!this.Ab.annotations.R6b(this.dD,db))throw Error.argument("input","Input value not of expected type");let Yb=this.Ab.EIh;for(;Yb;)db=Yb.load(db,Db),Yb=Yb.next;return db}vfc(db,Db,Yb,zc){if(!this.G$d)throw Error.invalidOperation("Attempt to store into query that supports only loading");
if(!this.bOd&&!this.Ab.annotations.R6b(this.dD,db))throw Error.argument("lvalue","Lvalue not of expected type");if(!this.Ab.annotations.R6b(this.p3,Db))throw Error.argument("rvalue","Rvalue not of expected type");return this.Ab.EIh.store(db,Db,Yb,zc)}static ioh(db,Db,Yb,zc){if(Yb===zc)return Db;if(G.Annotations.uH(Yb)&&G.Annotations.uH(zc)){Yb=G.Annotations.zYa(Yb);zc=G.Annotations.zYa(zc);const Vc=new Ua.a(db,zc);for(const bd of Db.items)Array.add(Vc.items,Ab.ioh(db,bd,Yb,zc));return Vc}if(Yb===
G.Annotations.eFa){if(zc===G.Annotations.voa)return Db;if(zc===G.Annotations.N7)return Db.toString()}else if(Yb===G.Annotations.voa){if(zc===G.Annotations.eFa)return Math.floor(Db);if(zc===G.Annotations.N7)return Db.toString()}else if(Yb===G.Annotations.N7){if(zc===G.Annotations.eFa)return parseInt(Db);if(zc===G.Annotations.voa)return parseFloat(Db)}throw Error.invalidOperation("Type conversion failure in query step");}}Object(l.a)(Ab,"AnnotationQuery",null,[1294]);class mb{constructor(){this.p3=
this.dD=0;this.next=null}store(){throw Error.invalidOperation("Store not supported");}DYa(db){if(this.next)return{returnValue:this.next,CEa:db};if(db){const Db=db.orh;db=db.qGi;return{returnValue:Db,CEa:db}}return{returnValue:null,CEa:db}}}Object(l.a)(mb,"AnnotationQueryStep",null,[1323]);class Rb extends mb{constructor(db){super();this.Ab=db}load(db,Db){Db=this.Ab.query.at(db,Db);if(G.Annotations.uH(this.dD)){var Yb=G.Annotations.zYa(this.dD);let Vc=new Ua.a(this.Ab.annotations,Yb);if(G.Annotations.uH(this.Ab.query.p3)){if(db.items.length!==
Db.items.length)throw Error.invalidOperation("List length mismatch in itemwise numeric query step");for(let bd=0,ce=db.items.length;bd<ce;++bd)Array.add(Vc.items,this.ztd(db.items[bd],Db.items[bd],Yb===G.Annotations.voa))}else for(var zc of db.items)Array.add(Vc.items,this.ztd(zc,Db,Yb===G.Annotations.voa));return Vc}if(G.Annotations.uH(this.Ab.query.p3)){zc=new Ua.a(this.Ab.annotations,this.dD);for(Yb of Db.items)Array.add(zc.items,this.ztd(db,Yb,this.dD===G.Annotations.voa));return zc}return this.ztd(db,
Db,this.dD===G.Annotations.voa)}ztd(db,Db,Yb){db=this.FYb(db,Db);return Yb?db:Math.floor(db)}}Object(l.a)(Rb,"NumericAnnotationQueryStep",mb,[]);class hc extends Rb{constructor(db){super(db)}FYb(db,Db){return db+Db}}Object(l.a)(hc,"AddAnnotationQueryStep",Rb,[]);class Hb extends mb{constructor(db){super();this.Ab=db}load(db,Db){if(this.dD===G.Annotations.ewa&&this.Ab.query.p3===G.Annotations.ewa){let Vc;if(({result:Vc}=this.Yjh(db)).returnValue)return Vc}if(G.Annotations.uH(this.dD)){var Yb=new Ua.a(this.Ab.annotations,
G.Annotations.ewa);Db=this.Ab.query.at(db,Db);if(G.Annotations.uH(this.Ab.query.p3)){if(db.items.length!==Db.items.length)throw Error.invalidOperation("List length mismatch in itemwise boolean query step");for(let Vc=0,bd=db.items.length;Vc<bd;++Vc)Array.add(Yb.items,this.IBc(Db.items[Vc],db.items[Vc]))}else for(var zc of db.items)Array.add(Yb.items,this.IBc(Db,zc));return Yb}zc=this.Ab.query.at(db,Db);if(G.Annotations.uH(this.Ab.query.p3)){Db=new Ua.a(this.Ab.annotations,G.Annotations.ewa);for(Yb of zc.items)Array.add(Db.items,
this.IBc(Yb,db));return Db}return this.IBc(zc,db)}}Object(l.a)(Hb,"BinaryBooleanAnnotationQueryStep",mb,[]);class Ta extends Hb{constructor(db){super(db)}Yjh(db){return{returnValue:!db,result:!1}}IBc(db,Db){return db&&Db}}Object(l.a)(Ta,"AndAnnotationQueryStep",Hb,[]);class Aa{constructor(db){db&&(this.annotations=db)}}Object(l.a)(Aa,"AnnotationsOnlyQueryStepInit",null,[]);class ma extends mb{constructor(db){super();this.Ab=db}load(db,Db){Db=this.Ab.query.at(db,Db);db=db.clone();G.Annotations.uH(this.Ab.query.p3)?
Array.addRange(db.items,Db.items):Array.add(db.items,Db);return db}}Object(l.a)(ma,"AppendAnnotationQueryStep",mb,[]);class Ga extends mb{constructor(db){super();this.Ab=db}load(db,Db){if(this.dD===G.Annotations.EU)return this.FFc(db,Db);const Yb=new Ua.a(this.Ab.annotations,G.Annotations.EU);for(const zc of db.items)Array.add(Yb.items,this.FFc(zc,Db));return Yb}FFc(db,Db){const Yb=new F.a(this.Ab.annotations);Yb.zWa(db);db=new F.a(this.Ab.annotations);this.Ab.script.KKa(null,new Y("Input",Yb,new Y("Output",
db,Db)));return db}}Object(l.a)(Ga,"ApplyAnnotationQueryStep",mb,[]);class Fa extends mb{constructor(db){super();this.Ab=db}load(db,Db){if(this.dD===G.Annotations.EU)return Db=this.FFc(db,Db),Db.kq(this.Ab.lbh).returnValue||new Ua.a(this.Ab.annotations,G.Annotations.EU),Db;const Yb=new Ua.a(this.Ab.annotations,G.Annotations.EU);for(const zc of db.items)if(db=this.FFc(zc,Db),({value:db}=db.kq(this.Ab.lbh)).returnValue)for(const Vc of db.items)Array.add(Yb.items,Vc);return Yb}FFc(db,Db){const Yb=new F.a(this.Ab.annotations);
Yb.zWa(db);db=new F.a(this.Ab.annotations);this.Ab.script.KKa(null,new Y("Input",Yb,new Y("Output",db,Db)));return db}}Object(l.a)(Fa,"ApplyExpandAnnotationQueryStep",mb,[]);class ib{constructor(db,Db){db&&(this.annotations=Db.annotations,this.script=Db.Izb(db.J(0)),this.lbh=db.J(1))}}Object(l.a)(ib,"ApplyExpandQueryStepInit",null,[]);class ob{constructor(db,Db){db&&(this.annotations=Db.annotations,this.script=Db.Izb(db.J(0)))}}Object(l.a)(ob,"ApplyQueryStepInit",null,[]);class fb extends mb{constructor(db){super();
this.Ab=db}load(db){if(this.dD===G.Annotations.EU)return this.cTd(db);const Db=new Ua.a(this.Ab.annotations,this.Ab.annotations.getAttributeType(this.Ab.yra));for(const Yb of db.items)Array.add(Db.items,this.cTd(Yb));return Db}store(db,Db,Yb,zc){if(this.dD===G.Annotations.EU){var Vc=Db,bd=({CEa:zc}=this.DYa(zc)).returnValue;bd&&(Vc=bd.store(G.Annotations.wS(this.cTd(db)),Db,Yb,zc));db.hy(this.Ab.yra,Vc)}else{var ce=Db;if(Vc=({CEa:zc}=this.DYa(zc)).returnValue){ce=new Ua.a(this.Ab.annotations,this.Ab.annotations.getAttributeType(this.Ab.yra));
for(bd of db.items)Array.add(ce.items,this.cTd(bd));ce=Vc.store(ce,Db,Yb,zc)}Db=ce;if(Db.items.length!==db.items.length)throw Error.invalidOperation("RValue list length mismatch in Attr query step store");for(let ud=0,Sb=db.items.length;ud<Sb;++ud)Yb=db.items[ud],Yb.isReadOnly&&(Yb=Yb.clone(),db.items[ud]=Yb),Yb.hy(this.Ab.yra,Db.items[ud])}return db}cTd(db){({value:db}=db.kq(this.Ab.yra)).returnValue||(db=this.Ab.annotations.Gil(this.Ab.yra));return db}}Object(l.a)(fb,"AttrAnnotationQueryStep",mb,
[]);class Mb{constructor(db,Db){db&&(this.annotations=Db,this.yra=db.J(0))}}Object(l.a)(Mb,"AttrQueryStepInit",null,[]);class Tb extends mb{constructor(db){super();this.Ab=db}load(db){const Db=new F.a(this.Ab.annotations);Db.zWa(db);return this.Ab.module.execute(Db)}}Object(l.a)(Tb,"CallModuleAnnotationQueryStep",mb,[]);class rc{constructor(db,Db){db&&(this.annotations=Db.annotations,this.module=Db.Hff(db.J(0)))}}Object(l.a)(rc,"CallModuleQueryStepInit",null,[]);class vb extends mb{constructor(db){super();
this.Ab=db}load(db,Db){if(G.Annotations.uH(this.dD)){var Yb=this.Ab.query.at(db,Db);Db=new Ua.a(this.Ab.annotations,G.Annotations.N7);let bd="string"===typeof Yb;for(var zc of db.items)if(bd)Array.add(Db.items,zc+Yb);else for(var Vc of Yb.items)Array.add(Db.items,zc+Vc);return Db}zc=this.Ab.query.at(db,Db);if("string"===typeof zc)return db+zc;Vc=new Ua.a(this.Ab.annotations,G.Annotations.N7);for(Yb of zc.items)Array.add(Vc.items,db+Yb);return Vc}}Object(l.a)(vb,"ConcatAnnotationQueryStep",mb,[]);
class Ya extends mb{constructor(db){super();this.Ab=db}load(db){return Ab.ioh(this.Ab.annotations,db,this.dD,this.p3)}}Object(l.a)(Ya,"ConvertAnnotationQueryStep",mb,[]);class wb extends mb{constructor(){super()}load(db){return db.items.length}}Object(l.a)(wb,"CountAnnotationQueryStep",mb,[]);class jb extends Rb{constructor(db){super(db)}FYb(db,Db){return db/Db}}Object(l.a)(jb,"DivideAnnotationQueryStep",Rb,[]);class Zb extends mb{constructor(db){super();this.Ab=db}load(db,Db){Db=new Y(this.Ab.Jde,
null,Db);for(const Yb of db.items)if(Db.$Ve(Yb),this.Ab.query.at(Yb,Db))return!0;return!1}}Object(l.a)(Zb,"ExistsAnnotationQueryStep",mb,[]);class Eb extends Rb{constructor(db){super(db)}FYb(db,Db){return Math.pow(db,Db)}}Object(l.a)(Eb,"ExpAnnotationQueryStep",Rb,[]);class tc{constructor(db,Db){db&&(this.SKa=Db.nE(db.J(0)))}}Object(l.a)(tc,"FeatureBundleNameQueryStepInit",null,[]);class lc extends mb{constructor(db){super();this.Ab=db}load(db){if(G.Annotations.uH(this.dD)){const Db=new Ua.a(this.Ab.annotations,
this.Ab.annotations.YAb(G.Annotations.zYa(this.dD),this.Ab.UKa));for(const Yb of db.items)Array.add(Db.items,Yb.Edb(this.Ab.UKa));return Db}return db.Edb(this.Ab.UKa)}store(db,Db,Yb,zc){if(G.Annotations.uH(this.dD)){var Vc=Db,bd=({CEa:zc}=this.DYa(zc)).returnValue;if(bd){Vc=new Ua.a(this.Ab.annotations,this.Ab.annotations.YAb(G.Annotations.zYa(this.dD),this.Ab.UKa));for(var ce of db.items)Array.add(Vc.items,ce.Edb(this.Ab.UKa));Vc=bd.store(Vc,Db,Yb,zc)}Db=Vc;if(Db.items.length!==db.items.length)throw Error.invalidOperation("RValue list length mismatch in Field query step store");
for(let ud=0,Sb=db.items.length;ud<Sb;++ud)Yb=db.items[ud],Yb.isReadOnly&&(Yb=Yb.clone(),db.items[ud]=Yb),Yb.WXf(this.Ab.UKa,Db.items[ud])}else bd=Db,(ce=({CEa:zc}=this.DYa(zc)).returnValue)&&(bd=ce.store(G.Annotations.wS(db.Edb(this.Ab.UKa)),Db,Yb,zc)),db.WXf(this.Ab.UKa,bd);return db}}Object(l.a)(lc,"FieldAnnotationQueryStep",mb,[]);class Lc{constructor(db,Db){db&&(this.annotations=Db,this.UKa=db.J(0))}}Object(l.a)(Lc,"FieldQueryStepInit",null,[]);class Bb extends mb{constructor(db){super();this.Ab=
db}load(db,Db){for(const Yb of db.items)if(this.Ab.filter.isMatch(Yb,Db))return Yb;throw Error.invalidOperation("No matching item found in FirstItemMatching load step");}store(db,Db,Yb,zc){let Vc=Db,bd=-1;for(let ud=0,Sb=db.items.length;ud<Sb;ud++)if(this.Ab.filter.isMatch(db.items[ud],Yb)){bd=ud;break}if(0>bd)throw Error.invalidOperation("No matching item found in FirstItemMatching store step");const ce=({CEa:zc}=this.DYa(zc)).returnValue;ce&&(Vc=ce.store(G.Annotations.wS(db.items[bd]),Db,Yb,zc));
db.items[bd]=Vc;return db}}Object(l.a)(Bb,"FirstItemMatchingAnnotationQueryStep",mb,[]);class jc extends mb{constructor(db){super();this.Ab=db}load(db,Db){Db=new Y(this.Ab.Jde,null,Db);for(const Yb of db.items)if(Db.$Ve(Yb),!this.Ab.query.at(Yb,Db))return!1;return!0}}Object(l.a)(jc,"ForAllAnnotationQueryStep",mb,[]);class dc extends mb{constructor(db){super();this.Ab=db}load(db,Db){db=Db?Db.DFd(this.Ab.SKa):null;if(!db)throw Error.invalidOperation('Feature bundle resolution failure: "'+this.Ab.SKa+
'"');return db}store(db,Db,Yb,zc){db=Yb?Yb.DFd(this.Ab.SKa):null;if(!db)throw Error.invalidOperation('Feature bundle resolution failure: "'+this.Ab.SKa+'"');let Vc=Db;const bd=({CEa:zc}=this.DYa(zc)).returnValue;bd&&(Vc=bd.store(db,Db,Yb,zc));db!==Vc&&db.zWa(Vc);return db}}Object(l.a)(dc,"GetAnnotationQueryStep",mb,[]);class nb{constructor(db,Db){this.kAj=db;this.$Qj=Db}get orh(){return this.kAj}get qGi(){return this.$Qj}}Object(l.a)(nb,"AnnotationQueryStoreContinuation",null,[1326]);class Gb extends mb{constructor(db){super();
this.Ab=db}load(db,Db){return this.Ab.Bae.at(db,Db)?this.Ab.jdj.at(db,Db):this.Ab.cCd?this.Ab.cCd.at(db,Db):db}store(db,Db,Yb,zc){var Vc=this.Ab.Bae.at(db,Yb);this.next&&(zc=new nb(this.next,zc));if(Vc)return this.Ab.jdj.vfc(db,Db,Yb,zc);if(this.Ab.cCd)return this.Ab.cCd.vfc(db,Db,Yb,zc);Vc=Db;let bd=null;zc&&(bd=zc.orh,zc=zc.qGi);bd&&(Vc=bd.store(G.Annotations.wS(db),Db,Yb,zc));return Vc}}Object(l.a)(Gb,"IfAnnotationQueryStep",mb,[]);class lb{constructor(db,Db){db&&(this.Bae=Db.VJ(db.J(0)),this.jdj=
Db.VJ(db.J(1)),this.cCd=db.J(2)?Db.VJ(db.J(2)):null)}}Object(l.a)(lb,"IfQueryStepInit",null,[]);class Kb{constructor(db,Db){db&&(this.Z0l=Db.VJ(db.J(0)),this.iji=Db.VJ(db.J(1)))}}Object(l.a)(Kb,"IndexAndItemQueryStepInit",null,[]);class Vb extends mb{constructor(db){super();this.Ab=db}load(db,Db){const Yb=this.Ab.Z0l.at(db,Db);Db=this.Ab.iji.at(db,Db);db=db.clone();if(0>Yb||Yb>db.items.length)throw Error.invalidOperation("Index out of range in InsertAt() query step");if(G.Annotations.uH(this.Ab.iji.p3))for(let zc=
0;zc<Db.items.length;++zc)Array.insert(db.items,Yb+zc,Db.items[zc]);else Array.insert(db.items,Yb,Db);return db}}Object(l.a)(Vb,"InsertAtAnnotationQueryStep",mb,[]);class vc extends mb{constructor(db){super();this.Ab=db}load(db,Db){return!(!Db||!Db.DFd(this.Ab.SKa))}}Object(l.a)(vc,"IsDefinedAnnotationQueryStep",mb,[]);class Fc extends mb{constructor(db){super();this.Ab=db}load(db,Db){Db=this.rI(db,Db);return db.items[Db]}store(db,Db,Yb,zc){const Vc=this.rI(db,Yb);let bd=Db;const ce=({CEa:zc}=this.DYa(zc)).returnValue;
ce&&(bd=ce.store(G.Annotations.wS(db.items[Vc]),Db,Yb,zc));db.items[Vc]=bd;return db}rI(db,Db){Db=this.Ab.query.at(db,Db);if(0>Db||Db>=db.items.length)throw Error.invalidOperation("Index out of range in Item store step");return Db}}Object(l.a)(Fc,"ItemAnnotationQueryStep",mb,[]);class Zc extends mb{constructor(db){super();this.Ab=db}load(db,Db){const Yb=new Ua.a(this.Ab.annotations,G.Annotations.zYa(this.dD));for(const zc of db.items)this.Ab.filter.isMatch(zc,Db)&&Array.add(Yb.items,zc);return Yb}}
Object(l.a)(Zc,"ItemsMatchingAnnotationQueryStep",mb,[]);class td extends mb{constructor(db){super();this.Ab=db}load(db,Db){Db=this.rI(db,Db);return db.items[db.items.length-Db-1]}store(db,Db,Yb,zc){const Vc=this.rI(db,Yb);let bd=Db;const ce=({CEa:zc}=this.DYa(zc)).returnValue;ce&&(bd=ce.store(G.Annotations.wS(db.items[db.items.length-Vc-1]),Db,Yb,zc));db.items[db.items.length-Vc-1]=bd;return db}rI(db,Db){Db=this.Ab.query?this.Ab.query.at(db,Db):0;if(0>Db||Db>=db.items.length)throw Error.invalidOperation("Index out of range in LastItem load step");
return Db}}Object(l.a)(td,"LastItemAnnotationQueryStep",mb,[]);class xd extends mb{constructor(db){super();this.Ab=db}load(db){if(G.Annotations.uH(this.dD)){const Db=new Ua.a(this.Ab.annotations,G.Annotations.eFa);for(const Yb of db.items)Array.add(Db.items,Yb.length);return Db}return db.length}}Object(l.a)(xd,"LengthAnnotationQueryStep",mb,[]);class le extends mb{constructor(db){super();this.Ab=db}load(db,Db){if(G.Annotations.uH(this.dD)){const Yb=new Ua.a(this.Ab.annotations,G.Annotations.ewa);
for(const zc of db.items)Array.add(Yb.items,this.Ab.filter.isMatch(zc,Db));return Yb}return this.Ab.filter.isMatch(db,Db)}}Object(l.a)(le,"MatchesAnnotationQueryStep",mb,[]);class Yc extends mb{constructor(db){super();this.Ab=db}load(db,Db){return this.Ab.filter.isMatch(db,Db)}}Object(l.a)(Yc,"MatchesAsListAnnotationQueryStep",mb,[]);class xc extends Rb{constructor(db){super(db)}FYb(db,Db){return db%Db}}Object(l.a)(xc,"ModuloAnnotationQueryStep",Rb,[]);class md extends Rb{constructor(db){super(db)}FYb(db,
Db){return db*Db}}Object(l.a)(md,"MultiplyAnnotationQueryStep",Rb,[]);class Ie extends mb{constructor(db){super();this.Ab=db}load(db){if(G.Annotations.uH(this.dD)){const Db=new Ua.a(this.Ab.annotations,G.Annotations.ewa);for(const Yb of db.items)Array.add(Db.items,!Yb);return Db}return!db}}Object(l.a)(Ie,"NotAnnotationQueryStep",mb,[]);class Te extends Hb{constructor(db){super(db)}Yjh(db){return{returnValue:db,result:!0}}IBc(db,Db){return db||Db}}Object(l.a)(Te,"OrAnnotationQueryStep",Hb,[]);class rf extends mb{constructor(db){super();
this.Ab=db}load(db,Db){const Yb=this.Ab.x2f.at(db,Db);db=this.Ab.uCc.at(db,Db);Db=new Ua.a(this.Ab.annotations,G.Annotations.eFa);for(let zc=0;zc<db;++zc)Array.add(Db.items,Yb+zc);return Db}}Object(l.a)(rf,"RangeAnnotationQueryStep",mb,[]);class ke{constructor(db,Db){db&&(this.annotations=Db.annotations,this.filter=Db.kla(db.J(0)))}}Object(l.a)(ke,"SingleFilterQueryStepInit",null,[]);class xe{constructor(db,Db){db&&(this.annotations=Db.annotations,this.query=db.J(0)?Db.VJ(db.J(0)):null)}}Object(l.a)(xe,
"SingleOptionalQueryQueryStepInit",null,[]);class zf{constructor(db,Db){db&&(this.annotations=Db.annotations,this.query=Db.VJ(db.J(0)))}}Object(l.a)(zf,"SingleQueryQueryStepInit",null,[]);class $c{constructor(db,Db){db&&(this.annotations=Db.annotations,this.x2f=Db.VJ(db.J(0)),this.uCc=db.J(1)?Db.VJ(db.J(1)):null)}}Object(l.a)($c,"StartAndCountOrLengthQueryStepInit",null,[]);class Hg extends mb{constructor(db){super();this.Ab=db}load(db,Db){let Yb;({startIndex:Db,length:Yb}=this.hId(db,Db));const zc=
new Ua.a(this.Ab.annotations,db.O2);for(let Vc=0;Vc<Yb;++Vc)Array.add(zc.items,db.items[Db+Vc]);return zc}store(db,Db,Yb,zc){let Vc,bd;({startIndex:Vc,length:bd}=this.hId(db,Yb));var ce=Db;const ud=({CEa:zc}=this.DYa(zc)).returnValue;if(ud){ce=new Ua.a(this.Ab.annotations,db.O2);for(let Sb=0;Sb<bd;++Sb)Array.add(ce.items,db.items[Vc+Sb]);ce=ud.store(ce,Db,Yb,zc)}Db=ce;for(Yb=0;Yb<bd;++Yb)Array.removeAt(db.items,Vc);for(let Sb=0,Gf=Db.items.length;Sb<Gf;++Sb)Array.insert(db.items,Vc+Sb,Db.items[Sb]);
return db}hId(db,Db){let Yb;Yb=this.Ab.x2f.at(db,Db);if(0>Yb)throw Error.invalidOperation("Invalid start index in Sublist() query step");Db=this.Ab.uCc?this.Ab.uCc.at(db,Db):db.items.length-Yb;if(0>Db||Yb+Db>db.items.length)throw Error.invalidOperation("Start index or length out of range in Sublist() query step");return{startIndex:Yb,length:Db}}}Object(l.a)(Hg,"SublistAnnotationQueryStep",mb,[]);class Rc extends mb{constructor(db){super();this.Ab=db}load(db,Db){if(G.Annotations.uH(this.dD)){const Yb=
new Ua.a(this.Ab.annotations,G.Annotations.N7);for(let zc=0,Vc=db.items.length;zc<Vc;++zc)Array.add(Yb.items,this.PZh(db.items[zc],Db));return Yb}return this.PZh(db,Db)}store(){throw Error.invalidOperation("Substring() store not yet supported by the runtime");}PZh(db,Db){let Yb;({startIndex:Db,length:Yb}=this.hId(db,Db));return db.substr(Db,Yb)}hId(db,Db){let Yb;Yb=this.Ab.x2f.at(db,Db);if(0>Yb)throw Error.invalidOperation("Invalid start index in Substring() query step");Db=this.Ab.uCc?this.Ab.uCc.at(db,
Db):db.length-Yb;if(0>Db||Yb+Db>db.length)throw Error.invalidOperation("Start index or length out of range in Substring() query step");return{startIndex:Yb,length:Db}}}Object(l.a)(Rc,"SubstringAnnotationQueryStep",mb,[]);class Ed extends Rb{constructor(db){super(db)}FYb(db,Db){return db-Db}}Object(l.a)(Ed,"SubtractAnnotationQueryStep",Rb,[]);class Yd extends mb{constructor(db){super();this.Ab=db}load(db){const Db=new Ua.a(this.Ab.annotations,G.Annotations.N7);for(let Yb=0;Yb<db.length;++Yb)Array.add(Db.items,
db.charAt(Yb).toString());return Db}}Object(l.a)(Yd,"ToCharListAnnotationQueryStep",mb,[]);class Zf extends mb{constructor(db){super();this.Ab=db}load(db){const Db=new Ua.a(this.Ab.annotations,this.dD);Array.add(Db.items,db);return Db}}Object(l.a)(Zf,"ToListAnnotationQueryStep",mb,[]);class Hc extends mb{constructor(db){super();this.Ab=db}load(){return this.Ab.value}}Object(l.a)(Hc,"ValueAnnotationQueryStep",mb,[]);class sc{constructor(db,Db){if(db){var Yb=db.J(0),zc=1;this.value=({Rea:zc}=Db.pKa(Yb,
db,zc,null,null,null)).returnValue;G.Annotations.SEb(this.value)}}}Object(l.a)(sc,"ValueQueryStepInit",null,[]);class pd{constructor(db,Db){db&&(this.Jde=Db.nE(db.J(0)),this.query=Db.VJ(db.J(1)))}}Object(l.a)(pd,"VarNameAndQueryQueryStepInit",null,[]);class Ub{constructor(db,Db){this.NEg=null;if(db){this.annotations=Db.annotations;var Yb=0;this.dD=db.J(Yb);++Yb;this.p3=db.J(Yb);++Yb;this.G$d=1===db.J(Yb);++Yb;this.bOd=1===db.J(Yb);++Yb;var zc=db.J(Yb);++Yb;if(zc){var Vc=Yb,bd=Yb+zc,ce=Yb+2*zc;Yb+=
3*zc;var ud=db.count-Yb,Sb=null;for(let gg=0;gg<zc;++gg){var Gf=Yb+db.J(ce+gg);const mi=(gg===zc-1?ud:db.J(ce+gg+1))-db.J(ce+gg),ni=new eb.a;ni.bdb(db,Gf,mi);Gf=Ub.jAl(db.J(bd+gg),ni,Db);Gf.dD=db.J(Vc+gg);Gf.p3=gg===zc-1?this.p3:db.J(Vc+gg+1);Sb?Sb.next=Gf:this.NEg=Gf;Sb=Gf}}}}get EIh(){return this.NEg}static jAl(db,Db,Yb){switch(db){case 1:return new dc(new tc(Db,Yb));case 2:return new vc(new tc(Db,Yb));case 3:return new fb(new Mb(Db,Yb.annotations));case 4:return new lc(new Lc(Db,Yb.annotations));
case 5:return new Gb(new lb(Db,Yb));case 6:return new le(new ke(Db,Yb));case 43:return new Yc(new ke(Db,Yb));case 45:return new Ga(new ob(Db,Yb));case 49:return new Fa(new ib(Db,Yb));case 46:return new Hc(new sc(Db,Yb.annotations));case 51:return new Tb(new rc(Db,Yb));case 52:return new rf(new $c(Db,Yb));case 53:return new Ya(new Aa(Yb.annotations));case 13:return new Fc(new zf(Db,Yb));case 14:return new td(new xe(Db,Yb));case 15:return new wb;case 18:return new Bb(new ke(Db,Yb));case 16:return new jc(new pd(Db,
Yb));case 17:return new Zb(new pd(Db,Yb));case 22:return new Vb(new Kb(Db,Yb));case 24:return new ma(new zf(Db,Yb));case 26:return new Hg(new $c(Db,Yb));case 27:return new Zc(new ke(Db,Yb));case 30:return new Zf(new Aa(Yb.annotations));case 31:return new Rc(new $c(Db,Yb));case 32:return new vb(new zf(Db,Yb));case 47:return new xd(new Aa(Yb.annotations));case 48:return new Yd(new Aa(Yb.annotations));case 34:return new hc(new zf(Db,Yb));case 35:return new Ed(new zf(Db,Yb));case 36:return new md(new zf(Db,
Yb));case 37:return new jb(new zf(Db,Yb));case 38:return new xc(new zf(Db,Yb));case 39:return new Eb(new zf(Db,Yb));case 40:return new Ta(new zf(Db,Yb));case 41:return new Te(new zf(Db,Yb));case 42:return new Ie(new Aa(Yb.annotations));default:throw Error.argument("currStepInitData");}}}Object(l.a)(Ub,"AnnotationQueryInit",null,[]);class uc{constructor(db){this.Ab=db}execute(db,Db){this.KKa(db,db?new Y("root",db,Db):Db)}KKa(db,Db){for(const Yb of this.Ab.commands)Db=Yb.execute(db,Db)}}Object(l.a)(uc,
"AnnotationScript",null,[1292]);class Tc{constructor(db){this.Ab=db}execute(db,Db){const Yb=this.Ab.U4l.at(db,Db),zc=this.Ab.d0m.at(db,Db);this.Ab.script.KKa(db,new Y("Input",Yb,new Y("Output",zc,Db)));return Db}}Object(l.a)(Tc,"ApplyAnnotationScriptCommand",null,[1325]);class qd{constructor(db,Db){db&&(this.U4l=Db.VJ(db.J(0)),this.d0m=Db.VJ(db.J(1)),this.script=Db.Izb(db.J(2)))}}Object(l.a)(qd,"ApplyScriptCommandInit",null,[]);class re{constructor(db){this.Ab=db}execute(db,Db){const Yb=this.Ab.EVf.at(db,
Db);this.Ab.MTd.vfc(db,Yb,Db,null);return Db}}Object(l.a)(re,"AssignAnnotationScriptCommand",null,[1325]);class Je{constructor(db){this.Ab=db}execute(db,Db){const Yb=this.Ab.MTd.at(db,Db);db=this.Ab.EVf.at(db,Db);Yb!==db&&Yb.zWa(db);return Db}}Object(l.a)(Je,"CopyAnnotationScriptCommand",null,[1325]);class Jf{constructor(db){this.Ab=db}execute(db,Db){let Yb=this.Ab.Owf.at(db,Db);if(this.Ab.Owf.G$d){Yb=G.Annotations.wS(Yb);var zc=new Y(this.Ab.SKa,null,Db);for(let bd=0,ce=Yb.items.length;bd<ce;++bd){var Vc=
this.sFh(db,Yb.items[bd],zc);if(0>this.Ab.F4d)Yb.items[bd]=Vc;else if(({value:Vc}=Vc.kq(this.Ab.F4d)).returnValue)Yb.items[bd]=Vc;else throw Error.invalidOperation("Expected result attribute missing in Enumerate() script command");}this.Ab.Owf.vfc(db,Yb,Db,null)}else{zc=new Y(this.Ab.SKa,null,Db);for(let bd=0,ce=Yb.items.length;bd<ce;++bd)this.sFh(db,Yb.items[bd],zc)}return Db}sFh(db,Db,Yb){let zc;0>this.Ab.F4d?zc=G.Annotations.wS(Db):(zc=new F.a(this.Ab.annotations),zc.hy(this.Ab.F4d,Db));Yb.$Ve(zc);
this.Ab.Oik.KKa(db,Yb);return zc}}Object(l.a)(Jf,"EnumerateAnnotationScriptCommand",null,[1325]);class Ig{constructor(db,Db){db&&(this.annotations=Db.annotations,this.SKa=Db.nE(db.J(0)),this.Owf=Db.VJ(db.J(1)),this.Oik=Db.Izb(db.J(2)),this.F4d=db.J(3))}}Object(l.a)(Ig,"EnumerateScriptCommandInit",null,[]);class pb{constructor(db){this.Ab=db}execute(db,Db){this.Ab.Bae.at(db,Db)?this.Ab.nbo.KKa(db,Db):this.Ab.tGh&&this.Ab.tGh.KKa(db,Db);return Db}}Object(l.a)(pb,"IfAnnotationScriptCommand",null,[1325]);
class Lb{constructor(db,Db){db&&(this.Bae=Db.VJ(db.J(0)),this.nbo=Db.Izb(db.J(1)),this.tGh=db.J(2)?Db.Izb(db.J(2)):null)}}Object(l.a)(Lb,"IfScriptCommandInit",null,[]);class Ic{constructor(db,Db){db&&(this.annotations=Db.annotations,this.MTd=Db.VJ(db.J(0)),this.EVf=Db.VJ(db.J(1)))}}Object(l.a)(Ic,"LvalueAndRvalueQueryScriptCommandInit",null,[]);class Ad{constructor(db){this.Ab=db}execute(db,Db){const Yb=this.Ab.EVf.at(this.Ab.MTd.at(db,Db),Db);this.Ab.MTd.vfc(db,Yb,Db,null);return Db}}Object(l.a)(Ad,
"ModifyAnnotationScriptCommand",null,[1325]);class oe{constructor(db){this.Ab=db}execute(db,Db){const Yb=new F.a(this.Ab.annotations);this.Ab.query&&Yb.zWa(this.Ab.query.at(db,Db));return Db=new Y(this.Ab.SKa,Yb,Db)}}Object(l.a)(oe,"NewAnnotationScriptCommand",null,[1325]);class gf{constructor(db,Db){db&&(this.annotations=Db.annotations,this.SKa=Db.nE(db.J(0)),this.query=db.J(1)?Db.VJ(db.J(1)):null)}}Object(l.a)(gf,"NewScriptCommandInit",null,[]);class Oe{constructor(db){this.Ab=db}execute(db,Db){db=
this.Ab.query.at(db,Db);if(this.Ab.query.p3===G.Annotations.EU)db.KOa(this.Ab.yra);else for(const Yb of db.items)Yb.KOa(this.Ab.yra);return Db}}Object(l.a)(Oe,"RemoveAnnotationScriptCommand",null,[1325]);class Sg{constructor(db,Db){db&&(this.annotations=Db.annotations,this.query=Db.VJ(db.J(0)),this.yra=db.J(1))}}Object(l.a)(Sg,"RemoveScriptCommandInit",null,[]);class Ng{constructor(db,Db){if(db){var Yb=0,zc=db.J(Yb);++Yb;if(zc){var Vc=Yb,bd=Yb+zc;Yb+=2*zc;var ce=db.count-Yb;this.commands=Array(zc);
for(let ud=0;ud<zc;++ud){const Sb=Yb+db.J(bd+ud),Gf=(ud===zc-1?ce:db.J(bd+ud+1))-db.J(bd+ud),gg=new eb.a;gg.bdb(db,Sb,Gf);this.commands[ud]=Ng.$zl(db.J(Vc+ud),gg,Db)}}}}static $zl(db,Db,Yb){switch(db){case 1:return new re(new Ic(Db,Yb));case 2:return new Ad(new Ic(Db,Yb));case 3:return new Oe(new Sg(Db,Yb));case 6:return new oe(new gf(Db,Yb));case 7:return new Jf(new Ig(Db,Yb));case 8:return new pb(new Lb(Db,Yb));case 9:return new Je(new Ic(Db,Yb));case 10:return new Tc(new qd(Db,Yb));default:throw Error.argument("initData");
}}}Object(l.a)(Ng,"AnnotationScriptInit",null,[]);var Nh=d(1601);class Eg{constructor(db){this.g0=db;this.rx=0}g7(){const db=this.g0.fy(this.rx,4);this.rx+=4;return db}get fzc(){return this.g0}get offset(){return this.rx}set offset(db){this.rx=db}}Object(l.a)(Eg,"ByteArrayReader",null,[]);class Wh{constructor(){this.HI=null;this.Moi=this.oaa=0}J(db){if(0>db||db>=this.oaa)throw Error.argumentOutOfRange("index");return this.HI.fy(this.Moi+4*db,4)}get count(){return this.oaa}static PJk(db,Db,Yb){const zc=
new Wh;zc.HI=db;zc.Moi=Db;zc.oaa=Yb;return zc}}Object(l.a)(Wh,"ReadOnlyListOverByteArray",null,[1286]);class Bf{constructor(db,Db){this.Foi=this.Eoi=!1;this.Ov=this.sNa=this.ryf=this.Ioi=null;try{this.Ov=Db.annotations;const Yb=Db.qdb(db.J(0)),zc=new Eg(Yb);if(-914743053!==zc.g7())throw Error.argument("Input does not represent a flat lexicon");this.Eoi=1===zc.g7();this.Foi=1===zc.g7();const Vc=zc.g7();zc.offset+=Vc;const bd=zc.g7();this.ryf=Bf.n2m(zc,bd,this.Ov);const ce=zc.g7();this.Ioi=Bf.E2m(zc,
ce);const ud=zc.g7();this.sNa=new Nh.a(zc.fzc,zc.offset);zc.offset+=ud}catch(Yb){throw Error.argument("initData");}}get trie(){return this.sNa}xkl(db){return"i"===db&&this.Foi?"\u0130":db.toUpperCase()}tpf(){return this.Eoi}Vhl(db){let Db;Db=new Ua.a(this.Ov,G.Annotations.EU);if(1!==db)if(0===db)db=new F.a(this.Ov),Array.add(Db.items,db);else if(db&1073741824){db=this.Ioi[db&-1073741825];for(let zc=0;zc<db.length;++zc){var Yb=db[zc];Yb=0===Yb?new F.a(this.Ov):this.ryf[Yb-2];Array.add(Db.items,Yb)}}else Array.add(Db.items,
this.ryf[db-2]);return{returnValue:!0,nrm:Db}}static n2m(db,Db,Yb){if(Db%4)throw Error.argument("reader");const zc=Wh.PJk(db.fzc,db.offset,Db/4);db.offset+=Db;db=[];for(Db=0;Db<zc.count;){const Vc=({Rea:Db}=Yb.pKa(G.Annotations.EU,zc,Db,null,null,null)).returnValue;Array.add(db,Vc)}return db}static E2m(db,Db){Db=db.offset+Db;const Yb=[];for(;db.offset<Db;){const zc=db.g7(),Vc=Array(zc);for(let bd=0;bd<zc;++bd){const ce=db.g7();Vc[bd]=ce}Array.add(Yb,Vc)}return Yb}}Object(l.a)(Bf,"RawFlatLexicon",
null,[1291]);var vf=d(1593),Fj=d(1594);class Pe{constructor(db){if(null==db)throw Error.argumentNull("base64String");const Db=db.length;if(Db%4)throw Error.argument("base64String's length must be a multiple of 4");this.oaa=.75*Db;this.cFb=Array(Math.ceil(this.oaa/4));db.endsWith("==")?this.oaa-=2:db.endsWith("=")&&--this.oaa;let Yb=0;for(let zc=0;zc<Db;zc+=4){const Vc=Pe.q5d[db.charCodeAt(zc)-43]<<18|Pe.q5d[db.charCodeAt(zc+1)-43]<<12|Pe.q5d[db.charCodeAt(zc+2)-43]<<6|Pe.q5d[db.charCodeAt(zc+3)-43];
let bd=Vc>>16&255;this.cFb[Math.floor(Yb/4)]|=bd<<Yb%4*8;++Yb;bd=Vc>>8&255;this.cFb[Math.floor(Yb/4)]|=bd<<Yb%4*8;++Yb;bd=Vc&255;this.cFb[Math.floor(Yb/4)]|=bd<<Yb%4*8;++Yb}}get length(){return this.oaa}J(db){if(0>db||db>=this.oaa)throw Error.argumentOutOfRange("i");return this.aNh(db)}fy(db,Db){if(0>db||0>Db||db+Db>this.oaa)throw Error.argument("Bad range");let Yb=0;for(let zc=0;zc<Db;++zc)Yb|=this.aNh(db+zc)<<8*zc;return Yb}mgn(db,Db){let Yb=0,zc=0,Vc=Math.floor(db/8);for(db%=8;zc<Db;){const bd=
8-db>Db-zc?Db-zc:8-db,ce=this.J(Vc);Yb|=(ce>>db&~(255<<bd))<<zc;zc+=bd;++Vc;db=0}return Yb}aNh(db){return this.cFb[Math.floor(db/4)]>>db%4*8&255}}Pe.q5d=[62,0,0,0,63,52,53,54,55,56,57,58,59,60,61,0,0,0,0,0,0,0,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,0,0,0,0,0,0,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51];Object(l.a)(Pe,"ByteArray",null,[]);class sf{constructor(db,Db,Yb){this.iD=db;this.hDm=Db;this.kDm=Yb;this.Uoi=Array(db.b?db.b.length:
0);this.Pyf=new vf.a(new Fj.a(this.qdb(this.iD.s)));this.M6=Array(db.t.length);this.BD=new G.Annotations(this.ndb(0),this)}get annotations(){return this.BD}get a_k(){return this.iD.d}xzl(){if(!(""in this.iD.m))throw Error.argument("name","Unrecognized module");return this.Hff(this.iD.m[""])}qdb(db){if(0>db||!this.iD.b||db>=this.iD.b.length)throw Error.argumentOutOfRange("byteArrayID");return this.Uoi[db]||(this.Uoi[db]=new Pe(this.iD.b[db]))}nE(db){if(1>db||db>=this.iD.t.length)throw Error.argumentOutOfRange("blobID");
if(1!==this.iD.t[db])throw Error.argument("blobID","Requested blob is not a string");if(null==this.M6[db]){const Db=this.ndb(db).J(0);this.M6[db]=this.Pyf.nE(Db)}return this.M6[db]}w3b(db){if(1>db||db>=this.iD.t.length)throw Error.argumentOutOfRange("blobID");if(2!==this.iD.t[db])throw Error.argument("blobID","Requested blob is not a Regex");if(!this.M6[db]){var Db=this.ndb(db);const Yb=this.nE(Db.J(0));Db=1===Db.J(1);this.M6[db]=new RegExp(Yb,Db?"i":"")}return this.M6[db]}CHl(db){if(1>db||db>=this.iD.t.length)throw Error.argumentOutOfRange("blobID");
if(3!==this.iD.t[db])throw Error.argument("blobID","Requested blob is not an SRE");throw Error.notImplemented();}Hff(db){if(1>db||db>=this.iD.t.length)throw Error.argumentOutOfRange("blobID");if(4!==this.iD.t[db])throw Error.argument("blobID","Requested blob is not an NL module");return this.M6[db]||(this.M6[db]=this.kDm.Qzl(this.ndb(db),this))}VJ(db){if(1>db||db>=this.iD.t.length)throw Error.argumentOutOfRange("blobID");if(5!==this.iD.t[db])throw Error.argument("blobID","Requested blob is not an annotation query");
return this.M6[db]||(this.M6[db]=new Ab(new Ub(this.ndb(db),this)))}Izb(db){if(1>db||db>=this.iD.t.length)throw Error.argumentOutOfRange("blobID");if(6!==this.iD.t[db])throw Error.argument("blobID","Requested blob is not an annotation script");return this.M6[db]||(this.M6[db]=new uc(new Ng(this.ndb(db),this)))}kla(db){if(1>db||db>=this.iD.t.length)throw Error.argumentOutOfRange("blobID");if(7!==this.iD.t[db])throw Error.argument("blobID","Requested blob is not a filter");return this.M6[db]||(this.M6[db]=
this.hDm.kla(this.ndb(db),this))}NFl(db){if(1>db||db>=this.iD.t.length)throw Error.argumentOutOfRange("blobID");if(10!==this.iD.t[db])throw Error.argument("blobID","Requested blob is not a raw flat lexicon");return this.M6[db]||(this.M6[db]=new Bf(this.ndb(db),this))}ndb(db){const Db=this.iD.n[db];db=(db<this.iD.t.length-1?this.iD.n[db+1]:this.iD.n.length)-Db;if(0>Db||0>db||Db+db>this.iD.n.length)throw Error.invalidOperation("Resource contains illegal int array range ("+Db+","+db+")");const Yb=new eb.a;
Yb.eaf(this.iD.n,Db,db);return Yb}}Object(l.a)(sf,"ObjectFetcher",null,[1246]);class Xf{constructor(db,Db,Yb){if(!db)throw Error.argumentNull("prediction");if(!Db)throw Error.argumentNull("fieldNames");if(!Yb)throw Error.argumentNull("values");if(Db.length!==Yb.length)throw Error.argument("values","fieldNames and values do not have same length");this.OQj=db;this.dFb=Db;this.DRc=Yb}get prediction(){return this.OQj}get RGh(){return this.dFb.length}Rdf(db){return 0<=db&&db<this.dFb.length?this.dFb[db]:
null}getValue(db){return 0<=db&&db<this.DRc.length?this.DRc[db]:null}}Object(l.a)(Xf,"PredictionData",null,[]);class Se{constructor(db,Db){if(!db)throw Error.argumentNull("predictions");if(!Db)throw Error.argumentNull("tokenAttributes");this.nDm=db;this.rDm=Db}Qgf(){return this.nDm}TLh(){return this.rDm}}Object(l.a)(Se,"PredictionDataWithTokenAttributes",null,[]);class $f{constructor(db,Db){this.prediction=null;this.score=0;this.prediction=db;this.score=Db}}Object(l.a)($f,"PredictionWithScore",null,
[]);class Jg{constructor(db,Db){if(!db)throw Error.argumentNull("predictions");if(!Db)throw Error.argumentNull("attributes");this.PQj=db;this.ywj=Db}Qgf(){return this.PQj}TLh(){return this.ywj}}Object(l.a)(Jg,"PredictionsWithTokenAttributes",null,[]);class fg{constructor(db,Db,Yb){if(!db)throw Error.argumentNull("attributeName");if(!Db)throw Error.argumentNull("fieldNames");if(!Yb)throw Error.argumentNull("values");if(Db.length!==Yb.length)throw Error.argument("values","fieldNames and values do not have same length");
this.xwj=db;this.dFb=Db;this.DRc=Yb}get attributeName(){return this.xwj}get RGh(){return this.dFb.length}Rdf(db){return 0<=db&&db<this.dFb.length?this.dFb[db]:null}getValue(db){return 0<=db&&db<this.DRc.length?this.DRc[db]:null}}Object(l.a)(fg,"TokenAttributes",null,[]);var Lg=d(44),Af=d(687);class Jh{constructor(db,Db,Yb,zc,Vc){this.l5c=0;this.Rag=null;this.m5c=this.mic=0;this.Jee=this.SMb=this.Koa=this.nic=null;this.Sag=0;this.Rze=this.dB=null;this._state=-1;this.$$ge=this.getEnumerator;this.$$cu=
this.get_current;this.$$mn=this.moveNext;this.$$rst=this.reset;this.gR=db;this.Rmj=this.Vmj=Db;this.Qmj=this.Tmj=Yb;this.j5c=this.Smj=zc;this.k5c=this.Umj=Vc}Wmj(){this.m5c=0;return this.Pag}Pag(){if(!(this.m5c<this.j5c))return this.Qag;this.nic=this.Rmj.items[this.m5c+this.Qmj];this.Koa=new F.a(this.gR.Ab.annotations);1!==this.j5c&&this.gR.Ab.oNc||this.Koa.zWa(this.nic);if(0<=this.gR.Ab.vVd){({value:this.SMb}=this.Koa.kq(this.gR.Ab.vVd)).returnValue?this.SMb=this.SMb.wS():this.SMb=new Ua.a(this.gR.Ab.annotations,
G.Annotations.EU);this.Jee=this.k5c.items;this.Sag=this.Jee.length;for(this.l5c=0;this.l5c<this.Sag;++this.l5c)this.Rag=this.Jee[this.l5c],Array.add(this.SMb.items,this.Rag);this.Koa.hy(this.gR.Ab.vVd,this.SMb)}else 0<=this.gR.Ab.r1f?this.Koa.hy(this.gR.Ab.r1f,this.k5c.items[0]):0<=this.gR.Ab.zTe?this.Koa.hy(this.gR.Ab.zTe,!0):this.gR.Ab.wfi?this.k5c.items[0].zDd((db,Db)=>this.Koa.hy(db,Db)):(this.Koa.zWa(this.k5c.items[0]),1!==this.j5c&&this.gR.Ab.oNc||(({value:this.mic}=this.nic.kq(this.gR.Ab.w1)).returnValue&&
this.Koa.hy(this.gR.Ab.w1,this.mic),({value:this.mic}=this.nic.kq(this.gR.Ab.w5)).returnValue&&this.Koa.hy(this.gR.Ab.w5,this.mic),this.nic.kq(this.gR.Ab.iab).returnValue&&this.Koa.hy(this.gR.Ab.iab,this.mic)));this.dB=this.Koa;this._state=2;return this.Ymj}Qag(){this._state=3}Xmj(){this.m5c++;return this.Pag}Ymj(){return 1<this.j5c&&this.gR.Ab.oNc?this.Qag:this.Xmj}dispose(){}getEnumerator(){return-1===this._state?(this._state=0,this):(new Jh(this.gR,this.Vmj,this.Tmj,this.Smj,this.Umj)).getEnumerator()}[Symbol.iterator](){return Object(Af.a)(this.getEnumerator())}moveNext(){if(3===
this._state)return!1;this._state?this._state=1:(this._state=1,this.Rze=this.Wmj());for(;1===this._state;)this.Rze=this.Rze();return 3!==this._state}reset(){throw Error.invalidOperation("Reset() is not supported");}get_current(){return this.dB}}Object(l.a)(Jh,"$$sm_Microsoft$NaturalLanguage$Runtime$ScriptSharp$NLModules$FlatLexiconNLModule$CreateNewTokenAndApplyLexicalAnalyses",null,[9,71,96]);class Vi{constructor(db,Db,Yb){this.ARc=this.Noi=0;this.i9b=null;this.Qyf=this.xyf=this.g9b=this.TTd=this.Ayf=
0;this.UTd=!1;this.Kyf=db;this.Syf=Db;this.mDm=Yb}JUh(){null===this.i9b&&({naj:this.i9b,t6h:this.Ayf,length:this.TTd,G6k:db}=this.Kyf.j0h(this.Syf.items[this.ARc],this.mDm),this.UTd=db||this.UTd);if(this.g9b<this.TTd){var db=this.i9b.charAt(this.Ayf+this.g9b);++this.g9b;return{returnValue:!0,ch:db}}if(this.ARc===this.Syf.items.length-1)return{returnValue:!1,ch:"\x00"};++this.ARc;this.g9b=0;this.i9b=null;return{returnValue:!0,ch:" "}}xRf(db,Db){this.g9b===this.TTd&&this.i9b&&(this.Qyf=Db,this.xyf=
this.ARc-this.Noi+1)}Ywn(db){if(0>db||db>=this.Syf.items.length)throw Error.argumentOutOfRange("iToken");this.ARc=this.Noi=db;this.i9b=null;this.xyf=this.g9b=this.TTd=this.Ayf=0;this.Qyf=-1;this.UTd=!1}zyl(){return{jok:this.xyf,Pom:this.Qyf,F6k:this.UTd}}}Object(l.a)(Vi,"TriePrefixVisitor",null,[1302]);class Ze{constructor(db){this.Ab=db}execute(db){if(!({value:Yb}=db.kq(this.Ab.wJa)).returnValue)throw Error.argument("Expected input parameter NLMod.Tokens not found");let Db;({value:Db}=db.kq(this.Ab.FVa)).returnValue||
(Db=null);var Yb=this.dhl(Yb,Db);db=G.Annotations.wS(db);db.hy(this.Ab.wJa,Yb);return db}dhl(db,Db){let Yb=null;const zc=this.Ab.flatLexicon.trie,Vc=new Vi(this,db,Db);let bd=null;this.Ab.flatLexicon.tpf()&&(bd=Object(Lg.a)(this.Ab.flatLexicon,this.Ab.flatLexicon.xkl,"getCaseInsensitiveForm"));let ce=0,ud;var Sb;let Gf;for(;ce<db.items.length;){const gg=db.items[ce];Vc.Ywn(ce);zc.Zkj(Vc,bd);({jok:ud,Pom:Sb,F6k:Gf}=Vc.zyl());if(0<ud){({nrm:Sb}=this.Ab.flatLexicon.Vhl(Sb));for(let mi of this.FLk(db,
ce,ud,Sb)){1<ud&&this.Ab.oNc&&this.vMk(db,Db,ce,gg,ud,Gf,mi);if(!Yb)for(Yb=new Ua.a(this.Ab.annotations,G.Annotations.EU),Sb=0;Sb<ce;++Sb)Array.add(Yb.items,db.items[Sb]);Array.add(Yb.items,mi)}ce+=ud}else Yb&&Array.add(Yb.items,gg),++ce}return Yb||db}vMk(db,Db,Yb,zc,Vc,bd,ce){if(bd)bd=!0;else if(this.Ab.cfi){bd=!1;var ud=-1;for(var Sb=0;Sb<Vc;Sb++){var Gf=db.items[Yb+Sb];let hi;var gg=void 0;if(!({value:hi}=Gf.kq(this.Ab.w1)).returnValue||!({value:gg}=Gf.kq(this.Ab.w5)).returnValue)throw Error.invalidOperation("FlatLexiconNLModule: token unexpectedly missing one or more required Span.* annotations");
if(0<Sb){if(hi>ud+1){bd=!0;break}if(0>ud||null===Db||ud>=Db.length)throw Error.invalidOperation("FlatLexiconNLModule: token with unexpectedly out of range Span.StartIndex/Span.Length annotations");if(" "!==Db.charAt(ud)){bd=!0;break}}ud=hi+gg}}else bd=!1;if(bd){gg=new Sys.StringBuilder;for(bd=0;bd<Vc;++bd)({naj:ud,t6h:Sb,length:Gf}=this.j0h(db.items[Yb+bd],Db)),0<bd&&gg.append(" "),gg.append(ud.substr(Sb,Gf));ce.hy(this.Ab.iab,gg.toString())}db=db.items[Yb+Vc-1];let mi,ni;({value:zc}=zc.kq(this.Ab.w1)).returnValue&&
({value:mi}=db.kq(this.Ab.w1)).returnValue&&({value:ni}=db.kq(this.Ab.w5)).returnValue?(ce.hy(this.Ab.w1,zc),ce.hy(this.Ab.w5,mi+ni-zc)):(ce.KOa(this.Ab.w1),ce.KOa(this.Ab.w5))}FLk(db,Db,Yb,zc){return new Jh(this,db,Db,Yb,zc)}j0h(db,Db){let Yb,zc;if(({value:Yb}=db.kq(this.Ab.iab)).returnValue)zc=!0,Db=0,db=Yb.length;else{zc=!1;if(null===Db)throw Error.argument("parentText","Expected parameter NLMod.ParentText not found");Yb=Db;if(!({value:Db}=db.kq(this.Ab.w1)).returnValue)throw Error.argument("Token missing required Span.StartIndex annotation",
"token");if(!({value:db}=db.kq(this.Ab.w5)).returnValue)throw Error.argument("Token missing required Span.Length annotation","token");if(0>Db||0>db||Db+db>Yb.length)throw Error.argument("Token start/length values out of range","token");}return{naj:Yb,t6h:Db,length:db,G6k:zc}}}Object(l.a)(Ze,"FlatLexiconNLModule",null,[1285]);class sd{constructor(db,Db){this.zTe=this.vVd=this.r1f=this.iab=this.w5=this.w1=this.FVa=this.wJa=0;this.wfi=this.cfi=this.oNc=!1;this.flatLexicon=null;this.annotations=Db.annotations;
let Yb=0;try{this.wJa=db.J(Yb),++Yb,this.FVa=db.J(Yb),++Yb,this.w1=db.J(Yb),++Yb,this.w5=db.J(Yb),++Yb,this.iab=db.J(Yb),++Yb,this.r1f=db.J(Yb),++Yb,this.vVd=db.J(Yb),++Yb,this.zTe=db.J(Yb),++Yb,this.oNc=1===db.J(Yb),++Yb,this.cfi=1===db.J(Yb),++Yb,this.wfi=1===db.J(Yb),++Yb,this.flatLexicon=Db.NFl(db.J(Yb))}catch(zc){throw Error.argument("initData");}}}Object(l.a)(sd,"FlatLexiconNLModuleInit",null,[]);class fh{constructor(){this.xLc=0;this.a9e=null;this.tZc=0}}Object(l.a)(fh,"FeatureGenStackRec",
null,[]);class vh{constructor(db){this.T5f=Array(db);this.zgc=Array(db);this.R2f=[];this.M8i=[]}}Object(l.a)(vh,"TokenStringLattice",null,[]);const am=(db,Db,Yb)=>{for(let zc=0;zc<db.length;zc++)Yb=Db(Yb,db[zc]);return Yb},aj=(db,Db)=>{const Yb=Array(db.length);for(let zc=0;zc<db.length;zc++)Yb[zc]=Db(db[zc]);return Yb},nk=(db,Db)=>{Db=Array(Math.min(Db,db.length));for(let Yb=0;Yb<Db.length;Yb++)Db[Yb]=db[Yb];return Db},sk=(db,Db)=>{const Yb=[];for(const zc of db)Db(zc)&&Array.add(Yb,zc);return Yb};
class De{constructor(db,Db){this.key=db;this.value=Db}}Object(l.a)(De,"KeyValuePair",null,[]);const Ai=(db,Db)=>({returnValue:Db in db,value:db[Db]}),Mk=db=>{const Db=[];for(let Yb in db){const zc=new De(Yb,db[Yb]);Array.add(Db,zc)}return Db};class pl{constructor(db){this.i0h=this.IMl;this.Ab=db;this.XTd=this.Hyf=this.Iyf=0;for(const Db of this.Ab.iCd)this.Iyf=Math.max(this.Iyf,Db.nMf),this.Hyf=Math.max(this.Hyf,Db.iMf),this.XTd=Math.max(this.XTd,Db.Vkb.length)}get I8k(){return this.Ab.jbe.trie}execute(db){if(!db)throw Error.argumentNull("input");
let Db,Yb;({tokens:Db,Upm:Yb}=this.JMl(db));let zc=null,Vc=null,bd={};if(this.Ab.SNc){Db=G.Annotations.wS(Db);for(var ce=0;ce<Db.items.length;++ce)Db.items[ce]=G.Annotations.wS(Db.items[ce])}else({BGh:Vc,returnValue:zc}=this.AVh(db,bd));ce=Array(this.XTd);const ud=Array(this.XTd);for(var Sb=0;Sb<ud.length;++Sb)ud[Sb]=new fh;for(Sb=-this.Iyf;Sb<Db.items.length+this.Hyf;++Sb){let Gf=null;this.Ab.SNc&&(Gf=Db.items[Sb],bd={},{BGh:Vc,returnValue:zc}=this.AVh(Gf,bd));for(const gg of this.Ab.iCd){if(0>Sb&&
-Sb>gg.nMf||Sb>=Db.items.length&&Sb-Db.items.length+1>gg.iMf)continue;let mi=!0;for(let ni=0;ni<gg.Vkb.length;++ni){const hi=Sb+gg.Vkb[ni];ce[ni]=hi;if(0>hi?0>this.Ab.oMf:hi>=Db.items.length?0>this.Ab.jMf:!Yb.zgc[hi]){mi=!1;break}}mi&&({rPk:zc,sPk:Vc}=this.e7l(gg,Yb,zc,Vc,bd,ud,ce))}this.Ab.SNc&&(Gf.hy(this.Ab.m_a?this.Ab.TXb:this.Ab.RXb,zc),this.Ab.m_a&&Gf.hy(this.Ab.SXb,Vc))}db=G.Annotations.wS(db);this.Ab.SNc?db.hy(this.Ab.wJa,Db):(db.hy(this.Ab.m_a?this.Ab.TXb:this.Ab.RXb,zc),this.Ab.m_a&&db.hy(this.Ab.SXb,
Vc));return db}JMl(db){let Db,Yb;if(!db||!({value:Db}=db.kq(this.Ab.wJa)).returnValue)throw Error.argument("Expected input parameter NLMod.Tokens not found");let zc;({value:zc}=db.kq(this.Ab.FVa)).returnValue||(zc="");Yb=new vh(Db.items.length);const Vc=sk(this.Ab.V5f,bd=>!bd.uMc||bd.uMc.isMatch(db,null));for(let bd=0;bd<Db.items.length;++bd){const ce=Db.items[bd];let ud=null;Yb.T5f[bd]=Yb.R2f.length;let Sb=Yb.zgc[bd]=0;for(const Gf of Vc)0<Gf.NRc&&Yb.zgc[bd]+Sb>=Gf.NRc||Gf.y2c&&!Gf.y2c.isMatch(ce,
null)||({z2c:ud,Vzc:Sb}=Gf.apply(this,ce,bd,Yb,zc,ud,Sb))}return{tokens:Db,Upm:Yb}}e7l(db,Db,Yb,zc,Vc,bd,ce){let ud=0;bd[0].xLc=-1;for(bd[0].a9e=db.rTi;;){var Sb=ce[ud],Gf=0>Sb||Sb>=Db.zgc.length?1:Db.zgc[Sb];let ni=!1;for(;bd[ud].xLc<Gf-1;){++bd[ud].xLc;var gg=void 0,mi=void 0;0>Sb?(gg=this.Ab.oMf,mi=1):Sb>=Db.T5f.length?(gg=this.Ab.jMf,mi=1):(mi=Db.T5f[Sb]+bd[ud].xLc,gg=Db.R2f[mi],mi=Db.M8i[mi]);bd[ud].tZc=mi*(ud?bd[ud-1].tZc:db.score);if(({value:gg}=Ai(bd[ud].a9e,gg.toString())).returnValue){ud===
db.Vkb.length-1?(Sb=gg,bd[ud].tZc&&(({value:Gf}=Ai(Vc,Sb.toString())).returnValue||(Gf=-1),0>Gf&&(Yb=G.Annotations.wS(Yb),Array.add(Yb.items,Sb)),this.Ab.m_a&&(zc=G.Annotations.wS(zc),0>Gf?Array.add(zc.items,bd[ud].tZc):zc.items[Gf]+=bd[ud].tZc),0>Gf&&(this.Ab.Fii||this.Ab.m_a)&&(Vc[Sb.toString()]=Yb.items.length-1))):(++ud,bd[ud].xLc=-1,bd[ud].a9e=gg);ni=!0;break}}if(!ni&&(--ud,0>ud))break}return{rPk:Yb,sPk:zc}}AVh(db,Db){let Yb;if(({value:Yb}=db.kq(this.Ab.m_a?this.Ab.TXb:this.Ab.RXb)).returnValue)for(let zc=
0;zc<Yb.items.length;++zc)Db[Yb.items[zc].toString()]=zc;else Yb=new Ua.a(this.Ab.annotations,G.Annotations.eFa);if(this.Ab.m_a){if(({value:Db}=db.kq(this.Ab.SXb)).returnValue||(Db=new Ua.a(this.Ab.annotations,G.Annotations.voa)),Db.items.length!==Yb.items.length)throw Error.argument("Length mismatch between NLMod.FloatingPointFeatureIDs and NLMod.FloatingPointFeatureValues on item "+this.Ab.annotations.Hba(G.Annotations.EU,db));}else Db=null;return{returnValue:Yb,BGh:Db}}get U9n(){return this.Ab.jbe}IMl(db,
Db){var Yb;if(({value:Yb}=Db.kq(this.Ab.iab)).returnValue)db=Yb;else{if(!({value:Yb}=Db.kq(this.Ab.w1)).returnValue)throw Error.argument("Token is missing Span.StartIndex");if(!({value:Db}=Db.kq(this.Ab.w5)).returnValue)throw Error.argument("Token is missing Span.Length");if(0>Yb||0>Db||Yb+Db>db.length)throw Error.argument("Token indices are out of range");db=db.substr(Yb,Db)}return db}}Object(l.a)(pl,"NGramNLModule",null,[1285,1287]);class Og{constructor(db){this.Vkb=null;this.score=this.iMf=this.nMf=
0;this.rTi=null;if(db){var Db=0;try{if(db.J(Db)!==Og.ewb)throw Error.argument("initData","Input does not represent a feature template");++Db;const Yb=db.J(Db);++Db;this.Vkb=Array(Yb);for(let zc=0;zc<Yb;++zc)this.Vkb[zc]=db.J(Db),++Db;this.nMf=db.J(Db);++Db;this.iMf=db.J(Db);++Db;this.score=db.J(Db);++Db;this.rTi=({n6h:Db}=Og.dKi(db,Db)).returnValue}catch(Yb){throw Error.argument("initData");}}}static dKi(db,Db){const Yb=db.J(Db);++Db;const zc={};for(let Vc=0;Vc<Yb;++Vc){const bd=db.J(Db);++Db;db.J(Db)?
zc[bd.toString()]=({n6h:Db}=Og.dKi(db,Db)).returnValue:(++Db,zc[bd.toString()]=db.J(Db),++Db)}return{returnValue:zc,n6h:Db}}}Og.ewb=240803228;Object(l.a)(Og,"FeatureTemplate",null,[1304]);var Rk=d(1556);class xf{constructor(db,Db){this.m_a=this.Fii=this.SNc=!1;this.iab=this.w5=this.w1=this.wJa=this.FVa=this.SXb=this.TXb=this.RXb=0;this.jbe=null;this.jMf=this.oMf=0;this.iCd=this.V5f=null;if(db){this.annotations=Db.annotations;var Yb=0;try{this.SNc=1===db.J(Yb);++Yb;this.Fii=1===db.J(Yb);++Yb;this.m_a=
1===db.J(Yb);++Yb;this.RXb=db.J(Yb);++Yb;this.TXb=db.J(Yb);++Yb;this.SXb=db.J(Yb);++Yb;this.FVa=db.J(Yb);++Yb;this.wJa=db.J(Yb);++Yb;this.w1=db.J(Yb);++Yb;this.w5=db.J(Yb);++Yb;this.iab=db.J(Yb);++Yb;this.jbe=this.Z2m(Db.qdb(db.J(Yb)));++Yb;this.oMf=db.J(Yb);++Yb;this.jMf=db.J(Yb);++Yb;const zc=db.J(Yb);++Yb;this.V5f=Array(zc);for(let bd=0;bd<zc;++bd){const ce=db.J(Yb);++Yb;const ud=this.jbe.trie,Sb=new eb.a;Sb.bdb(db,Yb,ce);this.V5f[bd]=this.b3m(Sb,Db,ud);Yb+=ce}const Vc=db.J(Yb);++Yb;this.iCd=Array(Vc);
for(Db=0;Db<Vc;++Db){const bd=db.J(Yb);++Yb;const ce=new eb.a;ce.bdb(db,Yb,bd);this.iCd[Db]=this.F2m(ce);Yb+=bd}}catch(zc){throw Error.argument("initData");}}}Z2m(db){return new vf.a(new Fj.a(db))}b3m(db,Db,Yb){return Rk.a.create(db,Db,Yb)}F2m(db){return new Og(db)}}Object(l.a)(xf,"NGramNLModuleInit",null,[]);class Ql{constructor(db){this.Ab=db}execute(db){if(!db)throw Error.argumentNull("input");db=db.clone();this.Ab.script.execute(db,null);return db}}Object(l.a)(Ql,"ScriptNLModule",null,[1285]);
class yd{constructor(db,Db){db&&(this.script=Db.Izb(db.J(0)))}}Object(l.a)(yd,"ScriptNLModuleInit",null,[]);const Zk=db=>{db=aj(db,Db=>Db*Db);return Math.sqrt(am(db,(Db,Yb)=>Db+Yb,0))},Kl=db=>am(db,(Db,Yb)=>Db>Yb?Db:Yb,db[0]);class tk{constructor(db){this.Ab=db}execute(db){if(!db)throw Error.argumentNull("input");var Db=[],Yb=[];this.mzk(db,Db,Yb);this.T9j(Db,Yb);const zc={};for(let bd=0;bd<Db.length;++bd){var Vc=Db[bd];const ce=this.Ab.U9h.J(Vc);Vc=this.Ab.V9h.J(Vc);for(let ud=0;ud<Vc;++ud){const Sb=
this.Ab.F5.J(this.Ab.tmh.J(ce+ud)),Gf=this.Ab.umh.J(ce+ud);let gg;({value:gg}=Ai(zc,Sb)).returnValue||(gg=0);zc[Sb]=gg+Yb[bd]*Gf}}Yb=Mk(zc);Yb.sort((bd,ce)=>{var ud=bd.value,Sb=ce.value;(ud=-(ud>Sb?1:ud<Sb?-1:0))||(ud=bd.key.localeCompare(ce.key));return ud});Db=new Ua.a(this.Ab.annotations,G.Annotations.EU);for(const bd of nk(Yb,this.Ab.AFm))Yb=new F.a(this.Ab.annotations),Yb.hy(this.Ab.Zfk,bd.key),Yb.hy(this.Ab.agk,bd.value),Array.add(Db.items,Yb);db.hy(this.Ab.$fk,Db);return db}mzk(db,Db,Yb){if(({value:db}=
db.kq(this.Ab.Yfk)).returnValue){let zc;if(({value:zc}=db.kq(this.Ab.TXb)).returnValue){let Vc;if(!({value:Vc}=db.kq(this.Ab.SXb)).returnValue||zc.items.length!==Vc.items.length)throw Error.argument("NLMod.FloatingPointFeatureIDs and NLMod.FloatingPointFeatureIDValues are mismatched");this.zvd(zc,Vc,Db,Yb)}if(({value:zc}=db.kq(this.Ab.cgk)).returnValue){let Vc;if(!({value:Vc}=db.kq(this.Ab.dgk)).returnValue||zc.items.length!==Vc.items.length)throw Error.argument("NLMod.FloatingPointFeatureNames and NLMod.FloatingPointFeatureValues are mismatched");
this.zvd(zc,Vc,Db,Yb)}({value:zc}=db.kq(this.Ab.RXb)).returnValue&&this.zvd(zc,null,Db,Yb);({value:zc}=db.kq(this.Ab.bgk)).returnValue&&this.zvd(zc,null,Db,Yb)}}zvd(db,Db,Yb,zc){for(let bd=0;bd<db.items.length;++bd){var Vc=void 0;db.O2===G.Annotations.N7?({value:Vc}=Ai(this.Ab.dCh,db.items[bd])).returnValue||(Vc=-1):(Vc=db.items[bd],Vc=Vc>=this.Ab.pAf&&Vc<=this.Ab.eGm?this.Ab.aEf?this.Ab.aEf.J(Vc-this.Ab.pAf)-1:Vc-this.Ab.pAf:-1);if(0<=Vc){let ce;ce=Db?Db.items[bd]:1;0<ce&&(Array.add(Yb,Vc),Array.add(zc,
ce))}}}T9j(db,Db){if(db.length){switch(this.Ab.Mbn){case 0:break;case 1:for(var Yb=0;Yb<Db.length;++Yb)Db[Yb]=1+Math.log(Db[Yb]);break;case 2:Yb=Kl(Db);for(let zc=0;zc<Db.length;++zc)Db[zc]=.5+Db[zc]/Yb*.5;break;case 3:for(Yb=0;Yb<Db.length;++Yb)Db[Yb]=1;break;default:throw Error.notImplemented();}if(this.Ab.$Md)for(Yb=0;Yb<Db.length;++Yb)Db[Yb]*=this.Ab.$Md.J(db[Yb]);db=Zk(Db);for(Yb=0;Yb<Db.length;++Yb)Db[Yb]/=db}}}Object(l.a)(tk,"TfIdfRankerNLModule",null,[1285]);class $k{constructor(db,Db=0){if(!db)throw Error.argumentNull("byteArray");
this.YTd=Db;if(604662927!==db.fy(this.YTd+0,4))throw Error.argument("byteArray","Input does not represent a compact int array");this.ej=db.fy(this.YTd+4,4);this.woi=db.fy(this.YTd+8,4);this.aDm=db}J(db){if(0>db||db>=this.count)throw Error.argumentOutOfRange("index");return this.aDm.mgn(8*this.YTd+96+db*this.woi,this.woi)}get count(){return this.ej}}Object(l.a)($k,"CompactIntArray",null,[1286]);const un=(db,Db)=>{Db=Array(Db);for(let bd=0;bd<Db.length;bd++){var Yb=bd,zc=db.g7(),Vc=1===(zc>>31&1)?-1:
1;const ce=zc&8388607;zc=zc>>23&255;256===zc+1?Vc=ce?Number.NaN:1===Vc?Number.POSITIVE_INFINITY:Number.NEGATIVE_INFINITY:zc?(zc-=127,Vc=Vc*bm(ce,1)*Math.pow(2,zc)):Vc=Vc*bm(ce,0)*Math.pow(2,-126);Db[Yb]=Vc}return Db},bm=(db,Db)=>{let Yb=0;for(let zc=0;23>zc;zc++)Yb+=(db>>22-zc&1)/Math.pow(2,zc+1);return Db+Yb};class yh{constructor(db,Db){this.aEf=null;this.Lui=0;this.V9h=this.U9h=this.$Md=null;this.Kui=0;this.umh=this.tmh=null;this.annotations=Db.annotations;let Yb=0;this.bgk=db.J(Yb);++Yb;this.RXb=
db.J(Yb);++Yb;this.cgk=db.J(Yb);++Yb;this.dgk=db.J(Yb);++Yb;this.TXb=db.J(Yb);++Yb;this.SXb=db.J(Yb);++Yb;this.Yfk=db.J(Yb);++Yb;this.$fk=db.J(Yb);++Yb;this.Zfk=db.J(Yb);++Yb;this.agk=db.J(Yb);++Yb;var zc=db.J(Yb);++Yb;var Vc=Array(zc);for(var bd=0;bd<zc;++bd)Vc[bd]=Db.nE(db.J(Yb)),++Yb;this.F5=eb.a.E0e(Vc);this.AFm=db.J(Yb);++Yb;this.Mbn=db.J(Yb);++Yb;zc=db.J(Yb);++Yb;this.dCh={};for(Vc=0;Vc<zc;++Vc){bd=Db.nE(db.J(Yb));++Yb;const ce=db.J(Yb);++Yb;this.dCh[bd]=ce}this.pAf=db.J(Yb);++Yb;this.eGm=db.J(Yb);
++Yb;zc=db.J(Yb);++Yb;0<zc&&(zc=Db.qdb(db.J(Yb)),++Yb,this.aEf=this.h_d(new Eg(zc)));++Yb;db=Db.qdb(db.J(Yb));this.M2m(db)}h_d(db){return new $k(db.fzc,db.offset)}M2m(db){try{const Db=new Eg(db);this.Lui=Db.g7();1===Db.g7()?this.$Md=eb.a.E0e(un(Db,this.Lui)):this.$Md=null;const Yb=Db.g7();this.U9h=this.h_d(Db);Db.offset+=Yb;const zc=Db.g7();this.V9h=this.h_d(Db);Db.offset+=zc;this.Kui=Db.g7();const Vc=Db.g7();this.tmh=this.h_d(Db);Db.offset+=Vc;this.umh=eb.a.E0e(un(Db,this.Kui))}catch(Db){throw Error.argument("byteReader");
}}}Object(l.a)(yh,"TfIdfRankerNLModuleInit",null,[]);class fn{constructor(db,Db,Yb,zc){this.BKf=db;this.rIh=Yb;this.tokens=zc;this.tka=Db;this.Ddc=-1;this.b6d=0}}Object(l.a)(fn,"TokenizerData",null,[]);class Sj{constructor(db){this.Ab=db}execute(db){if(!db)throw Error.argumentNull("input");if(!({value:zc}=db.kq(this.Ab.FVa)).returnValue)throw Error.argument("input","Expected to see annotation for attribute NLMod.ParentText");let Db;({value:Db}=db.kq(this.Ab.w1)).returnValue||(Db=0);let Yb;({value:Yb}=
db.kq(this.Ab.w5)).returnValue||(Yb=zc.length-Db);if(0>Db||Db>zc.length)throw Error.argument("input","Start index out of range");if(0>Yb||Yb>zc.length)throw Error.argument("input","Length out of range");if(Db+Yb>zc.length)throw Error.argument("input","Bad start-length range");var zc=new fn(zc,Db,Db+Yb,new Ua.a(this.Ab.annotations,G.Annotations.EU));this.V9n(zc);db=db.isReadOnly?db.clone():db;db.hy(this.Ab.wJa,zc.tokens);return db}V9n(db){for(;db.tka<db.rIh;){if(this.Ab.Ojf){var Db=this.Ab.Ojf.aoi(db.BKf,
db.tka,db.rIh-db.tka,null);!Db.succeeded&&Db.Iti&&(Db=Db.Iti);if(Db.succeeded){this.Dyi(db,Db.length,this.Ab.n2h);db.tka+=Db.length;continue}}Db=db.BKf.substr(db.tka);let Yb=-1,zc=-1,Vc=-1;for(let bd=0;bd<this.Ab.g5d.length;++bd){const ce=this.Ab.g5d[bd].exec(Db);ce&&0<ce[1].length&&(0>Yb||ce[0].length>zc)&&(Yb=bd,zc=ce[0].length,Vc=ce[1].length)}0<=Yb?(this.Dyi(db,Vc,this.Ab.yVf[Yb]),db.tka+=Vc):db.tka+=1}}Dyi(db,Db,Yb){if(this.Ab.Zgi)Yb!==Sj.sok&&(0>db.Ddc&&(db.Ddc=db.tka),db.b6d=db.tka+Db-db.Ddc,
Yb===Sj.rok&&(0<=db.Ddc&&0<db.b6d&&(Db=new F.a(this.Ab.annotations),Db.hy(this.Ab.w1,db.Ddc),Db.hy(this.Ab.w5,db.b6d),Db.hy(this.Ab.nSe,Sj.tok),Db.hy(this.Ab.FVa,db.BKf),Array.add(db.tokens.items,Db)),db.Ddc=-1,db.b6d=0));else{let zc=new F.a(this.Ab.annotations);zc.hy(this.Ab.w1,db.tka);zc.hy(this.Ab.w5,Db);zc.hy(this.Ab.nSe,Yb);Array.add(db.tokens.items,zc)}}}Sj.sok="GAP";Sj.rok="EOS_CHUNK";Sj.tok="SENTENCE";Object(l.a)(Sj,"TokenizerNLModule",null,[1285]);class qg{constructor(db,Db){this.w5=this.w1=
this.nSe=this.wJa=this.FVa=0;this.Zgi=!1;this.yVf=this.g5d=this.n2h=this.Ojf=null;if(db){this.annotations=Db.annotations;var Yb=0;try{this.FVa=db.J(Yb);++Yb;this.wJa=db.J(Yb);++Yb;this.nSe=db.J(Yb);++Yb;this.w1=db.J(Yb);++Yb;this.w5=db.J(Yb);++Yb;this.Zgi=1===db.J(Yb);++Yb;var zc=db.J(Yb);++Yb;0<zc&&(this.Ojf=Db.Hff(zc).I8k);this.n2h=db.J(Yb)?Db.nE(db.J(Yb)):"";++Yb;const Vc=db.J(Yb);++Yb;this.g5d=Array(Vc);this.yVf=Array(Vc);for(zc=0;zc<Vc;++zc)this.g5d[zc]=new RegExp(Db.nE(db.J(Yb))),++Yb,this.yVf[zc]=
Db.nE(db.J(Yb)),++Yb}catch(Vc){throw Error.argument("initData");}}}}Object(l.a)(qg,"TokenizerNLModuleInit",null,[]);class fl{constructor(db){this.Ab=db}execute(db){if(!db)throw Error.argumentNull("input");let Db;if(!({value:Db}=db.kq(this.Ab.Feh)).returnValue)throw Error.argument("Expected input parameter NLMod.StringToTransliterate not found");for(const Yb of this.Ab.g2f)Db=Yb.apply(Db);db=G.Annotations.wS(db);db.hy(this.Ab.Geh,Db);return db}static ARe(db,Db){const Yb=new Sys.StringBuilder;for(let zc=
0;zc<db.length;++zc)Yb.append(Db(db.substr(zc,1)));return Yb.toString()}}Object(l.a)(fl,"TransliteratorNLModule",null,[1285]);class gm{constructor(db){db&&(this.style=db.J(0))}apply(db){return fl.ARe(db,Db=>gm.Ksk(Db,this.style))}static Ksk(db,Db){switch(Db){case 0:return db.toLowerCase();case 1:return"I"===db?"\u0131":db.toLowerCase();case 2:return db.toUpperCase();case 3:return"i"===db?"\u0130":db.toUpperCase();default:throw Error.invalidOperation();}}}gm.fwb=0;Object(l.a)(gm,"ChangeCaseTransliterationStage",
null,[1300]);class xl{apply(db){return fl.ARe(db,xl.oao)}static oao(db){const Db=db.charCodeAt(0);return 65281<=Db&&65374>=Db?String.fromCharCode(Db-65248):db}}xl.fwb=4;Object(l.a)(xl,"LatinFullWidthToHalfWidthTransliterationStage",null,[1300]);class Ch{constructor(db,Db){db&&(this.TQf=Db.w3b(db.J(0)),this.Gun=Db.nE(db.J(1)))}apply(db){return db.replace(this.TQf,this.Gun)}}Ch.fwb=1;Object(l.a)(Ch,"RegexReplaceTransliterationStage",null,[1300]);class gi{constructor(db,Db){if(db){var Yb=db.J(0),zc=
Db.nE(db.J(1)),Vc=new $k(Db.qdb(db.J(2)));db=0>db.J(3)?null:new $k(Db.qdb(db.J(3)));this.i3f={};for(Db=0;Db<Yb;++Db)this.i3f[zc.charAt(Db).toString()]=zc.substr(Vc.J(Db),db?db.J(Db):1)}}apply(db){return fl.ARe(db,Db=>Db in this.i3f?this.i3f[Db]:Db)}}gi.fwb=2;Object(l.a)(gi,"SingleCharSubstitutionsTransliterationStage",null,[1300]);class Dh{constructor(db,Db){this.Geh=this.Feh=0;this.g2f=null;if(db){this.annotations=Db.annotations;var Yb=0;try{this.Feh=db.J(Yb);++Yb;this.Geh=db.J(Yb);++Yb;const zc=
db.J(Yb);++Yb;this.g2f=Array(zc);for(let Vc=0;Vc<zc;++Vc){const bd=db.J(Yb);++Yb;const ce=db.J(Yb);++Yb;const ud=new eb.a;ud.bdb(db,Yb,ce);Yb+=ce;this.g2f[Vc]=this.Y2m(bd,ud,Db)}}catch(zc){throw Error.argument("initData");}}}Y2m(db,Db,Yb){switch(db){case gm.fwb:return new gm(Db);case Ch.fwb:return new Ch(Db,Yb);case gi.fwb:return new gi(Db,Yb);case xl.fwb:return new xl;default:throw Error.invalidOperation("Unrecognized or unsupported transliteration stage flavor");}}}Object(l.a)(Dh,"TransliteratorNLModuleInit",
null,[]);class Yj{Qzl(db,Db){const Yb=db.J(0),zc=new eb.a;zc.bdb(db,1,db.count-1);switch(Yb){case 0:return new Ql(new yd(zc,Db));case 2:return new Sj(new qg(zc,Db));case 3:return new pl(new xf(zc,Db));case 5:return new Ze(new sd(zc,Db));case 9:return new fl(new Dh(zc,Db));case 10:return new tk(new yh(zc,Db));default:throw Error.notImplemented();}}}Object(l.a)(Yj,"NLModuleFactory",null,[1254]);class Ek{constructor(db){this.pok=";";if(!db)throw Error.argumentNull("resource");this.Cfa=new sf(db,new zb,
new Yj);this.Kyf=this.Cfa.xzl();this.voi=this.Cfa.annotations.mHc("Text.Text");this.toi=this.Cfa.annotations.mHc("Classification.Predictions");this.vyf=this.Cfa.annotations.mHc("Classification.PredictionString");this.uoi=this.Cfa.annotations.mHc("Classification.Probability");this.$Cm=this.Cfa.annotations.mHc("NLMod.Tokens");if(0>this.voi||0>this.toi||0>this.vyf||0>this.uoi)throw Error.argument("resourceObj","Resource does not represent a ranker");}cjl(){const db=[];this.T7e(void 0,this.EMh(db),null);
return db}ejl(db,Db){const Yb=[],zc=[];this.T7e(db,this.EMh(Yb),(Vc,bd)=>{const ce=this.Cfa.annotations.sMh(Vc),ud=[],Sb=[];Db&&Db.length&&-1===Array.indexOf(Db,ce)||(Vc=this.Cfa.annotations.getAttributeType(Vc),this.tFi(Vc,bd,ud,Sb),bd=new fg(ce,ud,Sb),Array.add(zc,bd))});return new Jg(Yb,zc)}djl(db){const Db=[];this.T7e(db,Yb=>{let zc;if(({value:zc}=Yb.kq(this.vyf)).returnValue){let Vc;({value:Vc}=Yb.kq(this.uoi)).returnValue&&Array.add(Db,new $f(zc,Vc))}},null);return Db}T7e(db,Db,Yb){var zc=new F.a(this.Cfa.annotations);
zc.hy(this.voi,db);db=this.Kyf.execute(zc);if(({value:zc}=db.kq(this.toi)).returnValue)for(const Vc of zc.items)Db(Vc);if(Yb&&({value:Db}=db.kq(this.$Cm)).returnValue)for(const Vc of Db.items)Vc.zDd(Yb)}tFi(db,Db,Yb,zc){if(G.Annotations.uH(db))for(var Vc of Db.items)this.tFi(Db.O2,Vc,Yb,zc);else if(G.Annotations.Hej(db)){Vc=this.Cfa.annotations.gVh(db);for(let bd=0;bd<Vc;bd++)Array.add(Yb,this.Cfa.annotations.FZh(db,bd)),Array.add(zc,this.Cfa.annotations.Hba(this.Cfa.annotations.YAb(db,bd),Db.Edb(bd)))}else Array.add(Yb,
"VALUE"),Array.add(zc,this.Cfa.annotations.Hba(db,Db))}EMh(db){return Db=>{let Yb;({value:Yb}=Db.kq(this.vyf)).returnValue&&Array.add(db,this.tEl(Yb))}}tEl(db){const Db=db.indexOf(this.pok);return 0>Db?db:db.substring(0,Db)}}Object(l.a)(Ek,"Ranker",null,[]);var wg=d(1508),ye=d(1520),Td=d(1475),cg=d(1471),Hi=d(1470),ee=d(2);class Fk{constructor(db,Db){this.cOg="";this.VDe=null;this.WDe=!1;this.Ooa=null;this.Awj=["TellMe.TellMeParamCollection"];this.qc=db;this.wTa=Db;this.qc.Cvb&&(this.Ooa=null)}get L1d(){if(!this.VDe&&
!this.WDe){let db=null;try{db=window.TellMeModel}catch(Db){if(cg.TellMeActor.instance.Ze)cg.TellMeActor.instance.Ze.onError("QueryRanker","TellMeModel not found. Exception: "+Db)}if(db){try{this.VDe=new Ek(db)}catch(Db){if(cg.TellMeActor.instance.Ze)cg.TellMeActor.instance.Ze.onError("QueryRanker","Exception thrown while loading classifier. Exception: "+Db)}this.WDe=!0}else if(cg.TellMeActor.instance.Ze)cg.TellMeActor.instance.Ze.onError("QueryRanker","Classifier model not found")}return this.VDe}FL(){return"Command"}FW(){return 0===
this.qc.Kv?0:1===this.qc.Kv?1:2}DI(db,Db,Yb=!1,zc=e.a.tellMe,Vc=null){const bd=new t.a(db);if((!Vc||Array.contains(Vc,0))&&!Hi.a.ZW(db)){if(!this.L1d&&this.WDe){if(cg.TellMeActor.instance.Ze)cg.TellMeActor.instance.Ze.onError("CRASH","CommandResultsProvider: Found invalid Model data");throw Error.create("CommandResultsProvider: Model data invalid/corrupted");}this.qc.Cvb&&this.Ooa&&this.Ooa.initialize();if(wg.CommandResultsUtility.zpf(db.Fg)&&(Vc=wg.CommandResultsUtility.iOh(db.Fg),0<Vc.results.length)){Vc.displayName=
"Classifier Debug";bd.iw(Vc);Db.resultsUpdated(bd);return}Vc=db?this.cOg=db.Fg:this.cOg;if(ee.AFrameworkApplication.K.$("TellMeParameterizedQueriesEnabled")){Vc=this.vEl(Vc);var ce=this.KEd(Vc.Qgf());Vc=Vc.TLh()}else Vc=this.uEl(Vc),ce=this.$ll(Vc),Vc=[];wg.CommandResultsUtility.mTd(ce,!1,"Classifier","TFIDF");ce=wg.CommandResultsUtility.RHd(db,ce,this.qc,this.Ooa,this.wTa,Vc,0,1);0<ce.results.length&&zc!==e.a.contextMenu&&(ce.displayName=CommonUIStrings.l_TellMeCommandProviderTitle);Yb||ce.results.length||
this.qc.EZ||this.qc.g3a||(db=new Td.a("lookupNoResults",14,db.Fg,null,1),ce.yz(db));0<ce.results.length&&bd.iw(ce);bd.attributes=Vc}Db.resultsUpdated(bd)}Qgf(){let db=[];try{db=this.L1d.cjl()}catch(Db){if(cg.TellMeActor.instance.Ze)cg.TellMeActor.instance.Ze.onError("GetPredictions","Exception: "+Db)}return db}uEl(db){let Db=[];try{Db=this.L1d.djl(db)}catch(Yb){if(cg.TellMeActor.instance.Ze)cg.TellMeActor.instance.Ze.onError("GetPredictionsWithScore","Exception: "+Yb)}return Db}vEl(db){try{return this.L1d.ejl(db,
this.Awj)}catch(Db){if(cg.TellMeActor.instance.Ze)cg.TellMeActor.instance.Ze.onError("GetPredictionsWithTokenAttributes","Exception: "+Db)}return new Jg([],[])}KEd(db){const Db=[];if(db)for(const Yb of db)Db.push(new ye.a(Yb,-99999));return Db}$ll(db){const Db=[];if(db)for(const Yb of db)Db.push(new ye.a(Yb.prediction,Yb.score));return Db}}Object(l.a)(Fk,"CommandResultsProvider",null,[1098]);var te=d(1678);class Cg{constructor(db){this.qc=db}FL(){return"Feedback"}FW(){return 0===this.qc.Kv?0:1===
this.qc.Kv?1:2}DI(db,Db,Yb,zc,Vc=null){db=new t.a(db);if(!Vc||Array.contains(Vc,21))Vc=[],Vc.push(appChrome.actions.setControlLabel("TellMeFeedback",CommonUIStrings.l_TellMeFeedbackText)),appChrome.api.dispatch(Vc),Vc=new u.a(22),Vc.displayName="",Vc.yz(new Td.a("TellMeFeedback",23,null,null,1)),db.iw(Vc);Db.resultsUpdated(db)}}Object(l.a)(Cg,"FeedbackResultsProvider",null,[1098]);class cc{constructor(db,Db,Yb,zc){this.InputText=this.CommandValueId=this.CommandId=this.Label=null;this.Label=db;this.CommandId=
Db;this.CommandValueId=Yb;this.InputText=zc}}Object(l.a)(cc,"FindInDocumentProp",null,[]);var rh=d(1530),pe=d(16);class ah{constructor(db){this.Mye=2;this.xrb=[];this.A8a=[];this.qc=db;ah.HAa=db.j9e;ah.KHh="FindInDocumentSuggestion";ah.HEi="FindInDocumentSuggestion3";this.yxe=Object.assign(new rh.a,{landingTab:"Indoc",data:null});this.rUj=this.qc.Kkb||!!ee.AFrameworkApplication.ua&&ee.AFrameworkApplication.ua.Sb.Kkb}FL(){return"FindInDocument"}FW(){return 0===this.qc.Kv?0:1===this.qc.Kv?1:3===this.qc.Kv?
this.qc.f6i?2:3:2}DI(db,Db,Yb=!1,zc,Vc=null){const bd=new t.a(db);if(Vc&&!Array.contains(Vc,2))Db.resultsUpdated(bd);else if(Array.clear(this.xrb),Hi.a.ZW(db)){if(Yb&&this.E3i()){Yb=new u.a(2);Yb.displayName=CommonUIStrings.l_TellMeFindInDocProviderTitle;Vc=1;zc="";if(0<this.A8a.length&&!this.qc.yec)for(var ce of this.A8a)if(""!==ce.Label.toLowerCase()){if(Vc>=this.Mye)break;this.pij(Yb,ce.Label,ce.CommandValueId,ah.KHh+Vc,ce.InputText);Vc++}ce="";this.qc.VQ?(bd.iw(Yb),Yb=new u.a(3),ce=this.qc.dab?
Hi.a.odb(CommonUIStrings.l_TellMeOpenFindPaneTextV2Bolded):CommonUIStrings.l_TellMeOpenFindPaneTextV2):ce=CommonUIStrings.l_TellMeOpenFindPaneText;zc=this.hOh("");this.pij(Yb,ce,zc,ah.HEi,"");bd.iw(Yb)}Db.resultsUpdated(bd)}else ce="",Yb&&(Yb=this.hOh(db.Fg),zc=[],this.qc.L_a?(this.qc.r8d&&zc.push(appChrome.actions.setControlIconSet(ah.HAa,{"default":"FindInDocument_20"})),ce=this.qc.Ltf?Hi.a.kef(db.Fg,CommonUIStrings.l_FindInDocumentScopedButtonText):db.Fg+CommonUIStrings.l_FindInDocumentScopedButtonText):
this.qc.VQ?(ce=this.qc.dab?Hi.a.odb(String.format(CommonUIStrings.l_FindInDocumentScopedButtonTextV2Bolded,db.Fg)):String.format(CommonUIStrings.l_FindInDocumentScopedButtonTextV2,db.Fg),zc.push(appChrome.actions.setControlIconSet(ah.HAa,{"default":"FindInDocument_20"}))):ce=this.qc.yec?CommonUIStrings.l_TellMeOpenFindPaneText:String.format(CommonUIStrings.l_TextWithQuotation,db.Fg),this.qc.qBa?(cg.TellMeActor.instance.actions.push(appChrome.actions.setControlLabel(ah.HAa,ce)),cg.TellMeActor.instance.actions.push(appChrome.actions.setButtonCommandValueId(ah.HAa,
Yb))):(zc.push(appChrome.actions.setControlLabel(ah.HAa,ce)),zc.push(appChrome.actions.setButtonCommandValueId(ah.HAa,Yb)),appChrome.api.dispatch(zc)),this.c_i(ce,ah.HAa,Yb,db.Fg)),this.qc.f6i?(ce=new Td.a(ah.HAa,8,db.Fg),Yb=new u.a(2),Yb.displayName=CommonUIStrings.l_TellMeFindInDocProviderTitle,Yb.yz(ce),bd.iw(Yb),Db.resultsUpdated(bd)):this.qc.GFd(db.Fg).then(ud=>{const Sb=new Td.a(ah.HAa,8,db.Fg,null,1);Sb.count=ud;ud=new u.a(2);ud.displayName=CommonUIStrings.l_TellMeFindInDocProviderTitle;ud.yz(Sb);
bd.iw(ud);Db.resultsUpdated(bd)},ud=>{cg.TellMeActor.instance.Ze.onError("FindInDocumentResultsProvider:issueQuery","Find manager promise rejected: "+ud);ud=new Td.a(ah.HAa,8,db.Fg,null,1);const Sb=new u.a(2);Sb.displayName=CommonUIStrings.l_TellMeFindInDocProviderTitle;Sb.yz(ud);bd.iw(Sb);Db.resultsUpdated(bd)})}E3i(){return!!this.qc&&this.qc.j8d}pij(db,Db,Yb,zc,Vc=null){const bd=[];Db&&bd.push(appChrome.actions.setControlLabel(zc,Db));this.qc.VQ&&bd.push(appChrome.actions.setControlIconSet(zc,{"default":"FindInDocument_20"}));
bd.push(appChrome.actions.setButtonCommandValueId(zc,Yb));appChrome.api.dispatch(bd);this.c_i(Db,zc,Yb,"");db.yz(new Td.a(zc,8,Vc,null,1,-99999))}hOh(db){return this.rUj?Hi.a.MWa(db,15,this.yxe):pe.a.If(db)}c_i(db,Db,Yb,zc){this.E3i()&&this.xrb.length<this.Mye&&(db=new cc(db,Db,Yb,zc),Array.add(this.xrb,db))}aMn(db){for(let Db=0;Db<this.xrb.length;Db++)if(this.xrb[Db].CommandId===db){const Yb=this.xrb[Db].Label;let zc=!1;if(0<this.A8a.length){let Vc=0;for(const bd of this.A8a){if(bd.Label===Yb){Array.removeAt(this.A8a,
Vc);zc=!0;break}Vc++}}!zc&&this.A8a.length>=this.Mye-1&&Array.removeAt(this.A8a,1);Array.insert(this.A8a,0,this.xrb[Db])}}}ah.HAa=null;ah.KHh=null;ah.HEi=null;Object(l.a)(ah,"FindInDocumentResultsProvider",null,[1098]);var Tg=d(1676);class ri{constructor(db){this.qc=db}FL(){return"Insights"}FW(){return 0===this.qc.Kv?0:1===this.qc.Kv?1:2}DI(db,Db,Yb=!1,zc,Vc=null){zc=new t.a(db);if(!Vc||Array.contains(Vc,13))if(this.VUn()||!Hi.a.ZW(db)){Vc=new u.a(13);var bd=""===db.Fg.trim(),ce=bd?"SmartLookupFromTellMeZeroTerm":
"SmartLookupFromTellMe",ud=new Td.a(ce,10,db.Fg,null,1);Yb&&(Yb=null,Hi.a.xCa()?bd?bd=CommonUIStrings.l_SeeMoreOpenSearchPaneLabel:(bd=this.qc.yec?CommonUIStrings.l_SeeMoreResultsButtonTextNonParameteriedV2:String.format(CommonUIStrings.l_SeeMoreResultsButtonText,db.Fg),Yb=Hi.a.MWa(db.Fg,1)):(bd=String.format(CommonUIStrings.l_InsightsButtonText,db.Fg),Yb=Hi.a.Axb(db.Fg)),this.qc.qBa?(cg.TellMeActor.instance.actions.push(appChrome.actions.setControlLabel(ce,bd)),Yb&&cg.TellMeActor.instance.actions.push(appChrome.actions.setButtonCommandValueId("SmartLookupFromTellMe",
Yb))):(db=[],db.push(appChrome.actions.setControlLabel(ce,bd)),Yb&&db.push(appChrome.actions.setButtonCommandValueId("SmartLookupFromTellMe",Yb)),appChrome.api.dispatch(db)),ud.label=bd);Vc.yz(ud);zc.iw(Vc)}Db.resultsUpdated(zc)}VUn(){return Hi.a.xCa()&&this.qc.m7n}}Object(l.a)(ri,"InsightsResultsProvider",null,[1098]);var Rl=d(1674);class Tf{constructor(db){this.qc=db}FL(){return"Learning"}FW(){return 0===this.qc.Kv?0:1===this.qc.Kv?1:2}DI(db,Db,Yb,zc,Vc=null){Yb=new t.a(db);Vc&&!Array.contains(Vc,
21)||!Hi.a.ZW(db)||(Vc=[],zc=this.qc.Yqm,Vc.push(appChrome.actions.setButtonCommandValueId("LearningForSearch",zc)),zc=Tf.jtl(zc),Vc.push(appChrome.actions.setControlLabel("LearningForSearch",zc)),appChrome.api.dispatch(Vc),db=new Td.a("LearningForSearch",22,db.Fg,null,1),Vc=new u.a(21),Vc.yz(db),Yb.iw(Vc));Db.resultsUpdated(Yb)}static jtl(db){const Db=[];Array.add(Db,new Rl.a(600,CommonUIStrings.l_TellMeLearningButtonTipText));Array.add(Db,new Rl.a(400,CommonUIStrings.l_TellMeLearningButtonText));
Array.add(Db,new Rl.a(600,db));Array.add(Db,new Rl.a(400,CommonUIStrings.l_TellMeLearningButtonPunctuation));db={};db.parts=Db;return JSON.stringify(db)}}Object(l.a)(Tf,"LearningProvider",null,[1098]);var hm=d(485);class mh{constructor(db,Db){this.VRb=this.ZVb=this.d9a=this.igd=null;this.Iw=!1;this.DSb=db;this.IAj=Db;db&&this.cGh(db)}Rbe(){this.DSb.Rbe()&&this.cGh(this.DSb)}FKl(db){let Db=[];var Yb=[];db=mh.dMm(db);var zc="";Array.clear(Yb);for(let Vc=0;Vc<db.length;Vc++){const bd=db.charAt(Vc);-1!==
" ".indexOf(bd)?(zc.length&&Array.add(Yb,zc),zc=""):-1!=="_-,@;.[]{}()$%*&^!\"':?/<>~`+=|\\".indexOf(bd)?(zc.length&&Array.add(Yb,zc),zc=bd,Array.add(Yb,zc),zc=""):zc+=bd}zc.length&&Array.add(Yb,zc);for(db=0;db<Yb.length;db++)zc=this.Zll(Yb[db]),zc=this.QFk(zc),Db=mh.fHm(Db,zc);return Db=this.j4j(Db)}$rf(){this.Iw||this.Rbe();return this.Iw}Eyd(db){return this.igd[db.toString()]}j4j(db){for(let Db=0;Db<db.length;Db++){const Yb=this.d9a[Db];if(db[Db].commandId!==this.Eyd(Yb[0]))throw Error.create("Incorrect Tcid orders with Priors data");
let zc;(zc=db[Db]).score=zc.score+Yb[1]}return db}QFk(db){const Db=[];for(var Yb=0;Yb<this.d9a.length;Yb++)Db.push(new ye.a(this.Eyd(this.d9a[Yb][0]),-5));Yb=new hm.a;for(var zc=0;zc<db.length;zc++)Yb.add(this.Eyd(db[zc][0]));for(zc=0;zc<Db.length;zc++){const bd=Db[zc];for(let ce=0;ce<db.length;ce++){var Vc=db[ce];const ud=this.Eyd(Vc[0]);Vc=Vc[1];if(ud===bd.commandId){bd.score=Vc;Yb.remove(ud);break}}if(!Yb.count)break}return Db}Zll(db){const Db=1>db.length;for(let ce=0;2>=ce;ce++){const ud=this.VRb;
for(let Sb in ud){var Yb=ud[Sb],zc=db,Vc=Sb;const Gf=Vc.length+1,gg=Array((zc.length+1)*Gf);for(var bd=0;bd<=zc.length;bd++)gg[bd*Gf]=bd;for(bd=0;bd<=Vc.length;bd++)gg[bd]=bd;for(bd=0;bd<Vc.length;bd++)for(let mi=0;mi<zc.length;mi++)gg[(mi+1)*Gf+(bd+1)]=zc.charAt(mi)===Vc.charAt(bd)?gg[mi*Gf+bd]:Math.min(Math.min(gg[mi*Gf+(bd+1)]+1,gg[(mi+1)*Gf+bd]+1),gg[mi*Gf+bd]+1);zc=gg[zc.length*Gf+Vc.length];if((!zc||!Db)&&zc<=ce)return Yb}}return this.ZVb}cGh(db){this.igd=db.Gff();this.d9a=db.cFl();this.ZVb=
db.QNl();this.VRb=db.Ewl();if(this.Iw=!!this.igd&&!!this.d9a&&!!this.VRb&&!!this.ZVb)this.Iw=0<this.d9a.length&&mh.fpf(this.d9a);this.Iw&&(this.Iw=0<this.ZVb.length&&mh.fpf(this.ZVb));this.Iw&&(this.VRb=mh.FOl(this.VRb));this.Iw||(this.VRb=this.ZVb=this.d9a=this.igd=null)}VMl(db){db=this.FKl(db);return this.w8k(db,this.IAj)}w8k(db,Db){let Yb=[];for(let zc=0;zc<db.length;zc++)db[zc].score>=Db&&Yb.push(db[zc]);Yb.sort((zc,Vc)=>zc.score<Vc.score?1:zc.score>Vc.score?-1:0);0<Yb.length-10&&(Yb=Yb.slice(0,
10));return Yb}static fHm(db,Db){if(!db.length)return Db;if(db.length!==Db.length)throw Error.create("commandSuggestionsMerged and commandSuggestionsToMerge are not of same length");for(let Yb=0;Yb<db.length;Yb++){if(db[Yb].commandId!==Db[Yb].commandId)throw Error.create("Incorrect CommandId");let zc;(zc=db[Yb]).score=zc.score+Db[Yb].score}return db}static dMm(db){return pe.a.mh(db)}static fpf(db){for(let Db=0;Db<db.length;Db++)if(2!==db[Db].length)return!1;return!0}static FOl(db){const Db={};for(let Vc in db){var Yb=
Vc,zc=db[Vc];const bd=zc;bd.length&&mh.fpf(bd)&&(Db[Yb]=zc)}return Db}}Object(l.a)(mh,"NaiveBayesClassifierModel",null,[]);class ck{constructor(db,Db){this.Ooa=null;this.qc=db;this.Prc=new mh(Db,db.Rzl);this.qc.Cvb&&(this.Ooa=null)}FL(){return"NBCommand"}FW(){return 0===this.qc.Kv?0:1===this.qc.Kv?1:2}DI(db,Db,Yb=!1,zc=e.a.tellMe,Vc=null){const bd=new t.a(db);if((!Vc||Array.contains(Vc,0))&&!Hi.a.ZW(db)){if(wg.CommandResultsUtility.zpf(db.Fg)&&(Vc=wg.CommandResultsUtility.iOh(db.Fg),0<Vc.results.length)){Vc.displayName=
"Classifier Debug";bd.iw(Vc);Db.resultsUpdated(bd);return}if(!this.Prc.$rf()){if(cg.TellMeActor.instance.Ze)cg.TellMeActor.instance.Ze.onError("CRASH","NaiveBayesCommandProvider: Found invalid Model data");throw Error.create("NaiveBayesCommandProvider: Model data invalid/corrupted");}this.qc.Cvb&&this.Ooa&&this.Ooa.initialize();Vc=this.Prc.VMl(db.Fg);wg.CommandResultsUtility.mTd(Vc,!1,"Classifier","NaiveBayesian");Vc=wg.CommandResultsUtility.RHd(db,Vc,this.qc,this.Ooa,null,null,0,1);0<Vc.results.length&&
zc!==e.a.contextMenu&&(Vc.displayName=CommonUIStrings.l_TellMeCommandProviderTitle);Yb||Vc.results.length||this.qc.EZ||this.qc.g3a||(db=new Td.a("lookupNoResults",14,db.Fg,null,1),Vc.yz(db));0<Vc.results.length&&bd.iw(Vc)}Db.resultsUpdated(bd)}}Object(l.a)(ck,"NaiveBayesCommandProvider",null,[1098]);class Uf{constructor(){this.trb=null;this.Iw=!1;this.Rbe()}Rbe(){this.Iw||(this.trb=window.NBCRM)&&4===this.trb.length&&(this.Iw=!0);return this.Iw}cFl(){return this.Iw?this.trb[1]:null}QNl(){return this.Iw?
this.trb[2]:null}Ewl(){return this.Iw?this.trb[3][0]:null}Gff(){return this.Iw?this.trb[0][0]:null}}Object(l.a)(Uf,"NaiveBayesModelAdapter",null,[1145]);var al=d(212);class gl{constructor(db){this.qc=db}FL(){return"OfficeScript"}FW(){return 0===this.qc.Kv?0:1===this.qc.Kv?1:2}DI(db,Db){const Yb=new t.a(db);if(!Hi.a.ZW(db)){db=al.d(db.Fg);var zc=new u.a(25);zc.displayName=CommonUIStrings.l_TellMeOfficeScriptsTitle;zc=this.c9g(db,gl.qeo,"OfficeScriptsUnhideAllRowsCols","samples-11",CommonUIStrings.l_TellMeUnhideAllRowsColsTitle,
zc);zc=this.c9g(db,gl.Bel,"OfficeScriptsFreezeSelection","samples-12",CommonUIStrings.l_TellMeFreezeSelectionTitle,zc);Yb.iw(zc)}Db.resultsUpdated(Yb)}c9g(db,Db,Yb,zc,Vc,bd){const ce=[];for(const ud of Db)if(al.a(db,ud)){this.qc.qBa?(cg.TellMeActor.instance.actions.push(appChrome.actions.setControlLabel(Yb,Vc)),cg.TellMeActor.instance.actions.push(appChrome.actions.setButtonCommandValueId(Yb,zc))):(ce.push(appChrome.actions.setControlLabel(Yb,Vc)),ce.push(appChrome.actions.setButtonCommandValueId(Yb,
zc)),appChrome.api.dispatch(ce));bd.yz(new Td.a(Yb,26,null,null,1));break}return bd}}gl.qeo="unhide row rows col cols column columns".split(" ");gl.Bel=["freeze","selection","pane","panes"];Object(l.a)(gl,"OfficeScriptsSamplesProvider",null,[1098]);var nm=d(76),dj=d(282),bi=d(1534),Qd=d(1501),Mi=d(1533),Hn=d(35),Df=d(121),ci=d(28);class Ll{constructor(db){this.aP=null;this.u0=-1;this.Azf=14;this.Dzf=12;this.attributes=this.sLe=this.query=null;this.l7b=!1;this.aUb=[];this.rg=ee.AFrameworkApplication.Xe;
ee.AFrameworkApplication.K&&(this.Azf=ee.AFrameworkApplication.K.rc("TellMeMaxTermedResults",this.Azf),this.Dzf=ee.AFrameworkApplication.K.rc("TellMeMaxZeroTermResults",this.Dzf));this.ZT=db}get Un(){return this.aUb}get sce(){return this.sLe}iw(db){let Db=!1;for(let Yb=0;Yb<this.Un.length;Yb++)if(27!==this.Un[Yb].groupType&&this.Un[Yb].groupType===db.groupType){this.HOe(this.Un[Yb],db);Db=!0;break}Db||this.Un.push(db)}HOe(db,Db){for(let Yb=0;Yb<Db.results.length;Yb++)db.yz(Db.results[Yb])}lOi(db){const Db=
[];for(const Yb of this.Un)Yb.groupType!==db&&Db.push(Yb);this.Un.length!==Db.length&&(this.aUb=Db)}$pn(db){let Db=null,Yb=null,zc=null;for(let Vc=0;Vc<db.length;Vc++){const bd=db[Vc];if(bd&&bd.Un&&bd.Un.length)for(const ce of bd.Un)if(17===ce.groupType||18===ce.groupType)Db=ce;else if(0===ce.groupType||16===ce.groupType)Yb=ce,zc=bd}Db&&Yb&&0<Yb.results.length&&(17===Db.groupType&&({fOe:Yb,UOe:Db}=wg.CommandResultsUtility.U2j(Yb,Db,this.ZT.ON()?this.ZT.ON().yll:-.6)),zc.lOi(Yb.groupType))}E_n(){new nm.a;
this.W0c(this.ZT.bpi)}sPc(db,Db){return this.query.Fg.length>this.ZT.ON().JFl&&this.pim(db,Db)||this.query.Fg.length>this.ZT.ON().KFl&&this.blm(db,Db)?!0:!1}blm(db,Db){return db&&db.length&&Db&&Db.length?-1===Db.toLowerCase().indexOf(db.toLowerCase())?!1:!0:!1}pim(db,Db){return db&&db.length&&Db&&Db.length?Db.toLowerCase().startsWith(db.toLowerCase()):!1}G8k(db){const Db=[];for(const Yb of this.ZT.ON().VQ?this.sce:this.Un)db.contains(Yb.groupType)||Db.push(Yb);this.ZT.ON().VQ?this.sLe=Db:this.aUb=
Db}slo(db,Db){const Yb=[];for(const zc of this.Un){const Vc=zc;if(13!==Vc.groupType){const bd=db[Qd.a[Vc.groupType].toLowerCase()];let ce="False";bd<Db&&(ce="True");Vc.displayName=Vc.displayName+" ("+ce+": "+bd+")"}Yb.push(Vc)}this.aUb=Yb}W0c(db,Db=!1,Yb=null){if(this.ZT.ON().VQ){if(!Db)for(this.sLe=Array(this.Un.length),Db=0;Db<this.Un.length;Db++)this.sce[Db]=this.Un[Db];this.ZT.hpi.W0c(this.Un,this.sce,this.query,db,Yb)}else{for(Yb=new nm.a;this.Un.length;){Db=this.Un.pop();const zc=Qd.a[Db.groupType].toLowerCase(),
Vc=db[zc];if(ci.c(Vc))throw Error.create("GroupId "+zc+" missed from group SortingOrder");Yb.add(new dj.a(Vc,Db))}Yb.Sc((zc,Vc)=>zc.key<Vc.key?-1:1);for(db=0;db<Yb.count;db++)Db=Yb.J(db).value,this.Un.push(Db)}}F_n(){var db=!1;let Db=!1,Yb=!1;for(let Vc=0;Vc<this.Un.length;Vc++){var zc=this.Un[Vc];const bd=zc.groupType;if(8===bd||15===bd||14===bd){zc=zc.results;for(let ce=0;ce<zc.length;ce++){if(8===bd&&this.sPc(this.query.Fg,zc[ce].label)){db=!0;break}if(15===bd&&this.sPc(this.query.Fg,zc[ce].label)){Db=
!0;break}if(14===bd){if(this.sPc(this.query.Fg,zc[ce].label)||this.sPc(this.query.Fg,zc[ce].description)){Yb=!0;break}const ud=zc[ce].label.split(" ");for(const Sb of ud)if(this.sPc(this.query.Fg,Sb)){Yb=!0;break}}}}}db=this.ZT.wHl(db,Db,Yb);this.W0c(db)}BGb(db,Db,Yb,zc,Vc,bd){if(Vc===this.aP){var ce=db.data.Ge;Vc=null;try{Vc=Hn.b(ce)}catch(Da){cg.TellMeActor.instance.Ze.onError("OnSuccessCallBack","Exception occured while deserializing ranker inference response:"+Da);return}if("RankerResults"in Vc&&
Vc.RankerResults){this.wza();var ud=Vc.RankerResults,Sb=new nm.a,Gf=new nm.a;ce=0;for(var gg of ud){ud=gg.ProviderId;var mi=gg.Score;ce+=mi;Sb.add(new dj.a(ud,mi))}Sb.Sc((sb,ec)=>sb.value>ec.value?-1:1);mi=bd?bd.UYh:1E-6;gg={};ud={};let Da=0;for(var ni=0;ni<Sb.count;ni++){let sb=parseInt(Sb.J(ni).key),ec=Sb.J(ni).value/ce;1===sb&&(ud.answer=Da++,ud.entity=Da++,ud.definition=Da++,ud.wolframanswer=Da++,ec<mi&&(Gf.add(9),Gf.add(11),Gf.add(10),Gf.add(12)),gg.answer=ec,gg.entity=ec,gg.definition=ec,gg.wolframanswer=
ec);2===sb&&(ud.assistance=Da++,ec<mi&&Gf.add(8),gg.assistance=ec);3===sb&&(ud.classifier=Da++,ud.serviceclassifier=Da++,ec<mi&&(Gf.add(0),Gf.add(17)),gg.classifier=ec,gg.serviceclassifier=ec);4===sb&&(ud.people=Da++,ec<mi&&Gf.add(14),gg.people=ec);5===sb&&(ud.document=Da++,ec<mi&&Gf.add(15),gg.document=ec);6===sb&&(ud.findindocument=Da++,ec<mi&&Gf.add(2),gg.findindocument=ec);7===sb&&(ud.notes=Da++,ec<mi&&Gf.add(20),gg.notes=ec);8===sb&&(ud.image=Da++,ec<mi&&Gf.add(19),gg.image=ec)}Sb=new nm.a;Sb.add("classifier");
Sb.add("serviceclassifier");Sb.add("appsforoffice");Sb.add("addin");Sb.add("findindocument");Sb.add("assistance");Sb.add("document");Sb.add("people");Sb.add("answer");Sb.add("wolframanswer");Sb.add("definition");Sb.add("entity");Sb.add("image");Sb.add("template");Sb.add("officescript");for(ni=0;ni<Sb.count;ni++)Sb.J(ni)in ud||(ud[Sb.J(ni)]=Da++);ud.learning=Da++;ud.insights=Da++;ud.feedback=Da++;bd&&bd.Lei&&this.slo(gg,mi);bd&&bd.Mei&&this.G8k(Gf);Gf={};for(var hi in gg)Gf[hi]=gg[hi]*ce;this.W0c(ud,
!0,Gf)}if(bd.lQd&&"Intents"in Vc&&Vc.Intents){hi=Vc.Intents;for(var nh of hi)if(this.quf(nh)&&"Serplet"===nh.GroupType&&nh.ConfidenceScore>nh.ConfidenceThreshold){hi=!1;Vc=0;if(bd.mQd){ce=new Td.a("",28);for(Gf=0;Gf<this.Un.length;Gf++)if((Sb=this.Un[Gf].results)&&0<Sb.length){Vc=Gf;ce=Sb[0];break}2===ce.groupType&&(hi=!0)}ce=new u.a(13);hi&&bd.mQd&&(ce=new u.a(13,CommonUIStrings.l_TellMeWebTitle));Gf=new Td.a("SmartLookupFromTellMeQueryTermAtTop",10,this.query.Fg,null,0);Sb=[];gg=null;gg=Hi.a.xCa()?
Hi.a.MWa(this.query.Fg,1):Hi.a.Axb(this.query.Fg);Sb.push(appChrome.actions.setButtonCommandValueId("SmartLookupFromTellMeQueryTermAtTop",gg));gg=String.format(CommonUIStrings.l_SeeMoreResultsButtonTextAtTop,this.query.Fg);Sb.push(appChrome.actions.setControlLabel("SmartLookupFromTellMeQueryTermAtTop",gg));appChrome.api.dispatch(Sb);ce.yz(Gf);Gf=[];if(hi&&bd.mQd)for(Gf.push(this.Un[Vc]),Gf.push(ce),hi=Vc+1;hi<this.Un.length;hi++)(Vc=this.Un[hi].results)&&0<Vc.length&&Gf.push(this.Un[hi]);else for(Gf.push(ce),
hi=0;hi<this.Un.length;hi++)(Vc=this.Un[hi].results)&&0<Vc.length&&Gf.push(this.Un[hi]);this.aUb=Gf}}if(bd.BPc&&!bd.VQ){nh=hi=-1;for(Vc=0;Vc<this.Un.length;Vc++)switch(this.Un[Vc].groupType){case 23:hi=Vc;break;case 0:case 17:case 2:-1===nh&&(nh=Vc)}if(-1!==hi){nh=-1===nh?0:hi>nh?nh+1:nh;hi=this.Un[hi];Vc=Array(this.Un.length);ce=0;for(Gf=0;Gf<Vc.length;Gf++)Gf===nh?Vc[Gf]=hi:(23===this.Un[ce].groupType&&ce++,Vc[Gf]=this.Un[ce],ce++);this.aUb=Vc}}zc.resultsUpdated(this);zc=cg.TellMeActor.instance.Ze;
zc.V6(Db.length,"RankerInference",db.data.wf.toString(),Math.round(window.performance.now()-Yb),Mi.a.Y$i,!0,bi.a.YLa);this.l7b&&zc&&(db=this.query.jjb,Db=zc.m9c,bd.AQd&&db>Db&&!bd.VQ&&(zc.Sxf(this.query.Fg),zc.KXf(db)))}}quf(db){if("GroupType"in db&&db.GroupType&&"ConfidenceScore"in db&&"ConfidenceThreshold"in db)return!0;cg.TellMeActor.instance.Ze.onError("IsValidIntentGroup","Invalid intents found");return!1}nGb(db,Db,Yb,zc,Vc){zc===this.aP&&(this.wza(),cg.TellMeActor.instance.Ze.V6(Db.length,"RankerInference",
db.data.wf.toString(),Math.round(window.performance.now()-Yb),Mi.a.Y$i,!1,bi.a.YLa));Vc.resultsUpdated(this)}wza(){-1!==this.u0&&(window.clearTimeout(this.u0),this.u0=-1)}G_n(db){let Db;Db=this.ZT.ON().VQ?cg.TellMeActor.instance.Ze.aif(this.sce,this.query.Fg):cg.TellMeActor.instance.Ze.aif(this.Un,this.query.Fg);var Yb=this.ZT.ON().TYh;""!==Yb&&(Yb="_"+Yb);let zc="";this.ZT.ON().uPd&&(zc="RankerInference"+Yb+",");this.ZT.ON().lQd&&(zc+="SerpletClassifier");","===zc.charAt(zc.length-1)&&(zc=zc.substring(0,
zc.length-1));Yb=cg.TellMeActor.instance.Ze.G_h(zc);const Vc=this.aP=Df.a.create().toString();Yb["Client-Request-Id"]=Vc;const bd=window.performance.now(),ce=this.ZT.ON()?this.ZT.ON().VYh:600;this.wza();this.u0=window.setTimeout(()=>{if(Vc===this.aP){this.aP="";this.u0=-1;db.resultsUpdated(this);const ud={};ud[a.a.provider]="Ranker";ud[a.a.MHb]=this.query.jjb;cg.TellMeActor.instance.Ze.WB(k.a.timedOut,ce,ud)}},ce);this.rg.Lj(cg.TellMeActor.instance.Ze.H_h(),2,Db,Yb,!1,0,ud=>{this.BGb(ud,this.query.Fg,
bd,db,Vc,this.ZT.ON())},ud=>{this.nGb(ud,this.query.Fg,bd,Vc,db)},null,null,!1,4E3,6E3)}cbo(){var db=0,Db=new nm.a,Yb=this.ZT.Zoi,zc=this.ZT.$oi;for(var Vc=0;Vc<this.Un.length;Vc++){var bd=this.Un[Vc],ce=Qd.a[bd.groupType].toLowerCase(),ud=Yb[ce];db+=bd.results.length;bd.results.length>ud&&(ce=zc[ce],ci.c(ce)||Db.add(new dj.a(ce,bd)))}zc=!this.query||""===this.query.Fg.trim();Vc=db-(zc?this.Dzf:this.Azf);if(!(0>=Vc)){zc=window.performance.now();db=db.toString()+" total,"+Vc.toString()+" to remove.";
if(0<Db.count)for(Db.Sc((Sb,Gf)=>Sb.key>Gf.key?-1:1),bd=0;bd<Db.count&&0<Vc;bd++){ce=Db.J(bd).value;ud=Qd.a[ce.groupType].toLowerCase();let Sb=ce.results.length-Yb[ud];Sb>Vc&&(Sb=Vc);0<Sb&&(ce.qSf(Sb),db+=ud+": "+Sb.toString()+" results removed.",Vc-=Sb)}if(0<Vc){db+=Vc.toString()+" results left after trimming.";Db=new nm.a;Yb=this.ZT.fpi;for(bd=0;bd<this.Un.length;bd++)ce=this.Un[bd],ud=Yb[Qd.a[ce.groupType].toLowerCase()],ci.c(ud)||Db.add(new dj.a(ud,ce));Db.Sc((Sb,Gf)=>Sb.key<Gf.key?-1:1);for(Yb=
0;0<Vc;)bd=Db.J(Yb++).value,Vc>=bd.results.length?(Array.remove(this.Un,bd),db+=Qd.a[bd.groupType]+": "+bd.results.length.toString()+" results force removed.",Vc-=bd.results.length):(bd.qSf(Vc),db+=Qd.a[bd.groupType]+": "+Vc.toString()+" results force removed.",Vc=0)}cg.TellMeActor.instance.Ze&&(Db={},Db[a.a.message]=db,cg.TellMeActor.instance.Ze.WB("ShowOptimal",window.performance.now()-zc,Db))}}}Object(l.a)(Ll,"CombineResultsUpdatedEventArgs",null,[1071]);var Wc=d(1591);class dk{constructor(db,
Db,Yb,zc=!1,Vc=""){this.vCe=this.ZEe=!1;this.Pu=db;this.$sb=[];this.XWg=Db.length;this.qc=cg.TellMeActor.instance.ON();this.sed=zc;this.oja=Vc;this.sVb={};for(db=0;db<Db.length;++db)this.sVb[db.toString()]=Yb?0:Db[db].FW()}UNn(db,Db){Db&&Db.query&&Db.query.jjb<cg.TellMeActor.instance.zqa||(this.$sb[db]=Db,this.vCe?this.ZEe=!0:(!this.qc||3!==this.qc.Kv||3!==this.sVb[db.toString()]||this.Jzh())&&this.iNd())}E3m(){this.vCe=!0}Jeo(){this.vCe=!1;this.ZEe&&(this.ZEe=!1,this.iNd())}Jzh(){if(this.$sb.length<
this.XWg)return!1;for(let db=0;db<this.XWg;++db)if(!this.$sb[db])return!1;return!0}iNd(){var db=this.Jzh();const Db=window.performance.now(),Yb=new Ll(cg.TellMeActor.instance.EGg);Yb.$pn(this.$sb);for(var zc=0;zc<this.$sb.length;++zc){var Vc=this.$sb[zc];if(Vc&&Vc.Un&&Vc.Un.length&&(Yb.query=Vc.query,Vc.attributes&&0<Vc.attributes.length&&(Yb.attributes=Vc.attributes),Vc&&Vc.Un&&(db||this.Vuk(zc,this.$sb))))for(const bd of Vc.Un)Yb.iw(bd)}Yb.Un&&Yb.Un.length&&(Yb.l7b=db,this.qc&&this.qc.Abe&&Yb.cbo(),
Wc.a.qhi()&&(this.qc&&this.qc.Hjm&&Yb.query.Fg&&0<Yb.query.Fg.length?Yb.F_n():Yb.E_n()),Wc.a.qhi()&&this.qc&&(this.qc.uPd||this.qc.lQd)&&this.sed&&Yb.query.Fg&&0<Yb.query.Fg.length&&Yb.l7b&&this.oja!==e.a.contextMenu?(3===this.qc.Kv&&db||this.Pu.resultsUpdated(Yb),Yb.G_n(this.Pu)):this.Pu.resultsUpdated(Yb),db=cg.TellMeActor.instance.Ze,Yb.l7b&&db&&(zc=Yb.query.jjb,Vc=db.m9c,Yb.query.Fg&&0<Yb.query.Fg.length&&this.sed&&this.qc.AQd&&this.oja!==e.a.contextMenu&&zc>Vc&&!this.qc.uPd&&!this.qc.VQ&&(db.Sxf(Yb.query.Fg),
db.KXf(zc)),db.WB(k.a.syn,window.performance.now()-Db)))}Vuk(db,Db){if(!(this.sVb&&db.toString()in this.sVb)||Db.length<=db||!Db[db])return!1;if(!Db[db].Un.length)return!0;const Yb=this.sVb[db.toString()];if(0===Yb)return!0;const zc=this.sVb;for(let bd in zc){var Vc=zc[bd];const ce=Number.parseInvariant(bd);if(ce!==db&&Vc===Yb&&!(Db.length>ce&&Db[ce]))return!1}return!0}}Object(l.a)(dk,"ResultsAggregator",null,[]);var Ni=d(1703);class Ld{constructor(){this.tgc=this.ugc=this.sgc=this.logCount=this.logRank=
this.invertedRank=0}E2j(db,Db){switch(db){case 1:this.invertedRank=Db;break;case 3:this.logRank=Db;break;case 2:this.logCount=Db;break;case 5:this.sgc=Db;break;case 4:this.ugc=Db;break;case 6:this.tgc=Db}}}Object(l.a)(Ld,"CommandFeatures",null,[]);class Gk{constructor(db){this.bEg=0;this.IMj=db;this.$yj={}}get modelId(){return this.IMj}get featureIntercept(){return this.bEg}get jBc(){return this.$yj}C1j(db,Db,Yb){0===Db?this.bEg=Yb:(this.jBc[db]||(this.jBc[db]=new Ld),this.jBc[db].E2j(Db,Yb))}}Object(l.a)(Gk,
"CoefficientsModel",null,[]);const bl=(db,Db)=>Math.pow(10,-Db/(60*Math.LN10/Math.LN2*db));class Ae{constructor(db,Db){this.ej=1;this.cad=new Ld;this.features.logCount=1+Math.log(this.count)/Math.LN2;this.features.invertedRank=db?1/db:0;this.features.logRank=2/Math.pow(2,db);this.features.sgc=bl(10,Db);this.features.ugc=bl(2,Db);this.features.tgc=bl(1,Db)}get count(){return this.ej}get features(){return this.cad}i7h(){this.ej=this.count+1;this.features.logCount=1+Math.log(this.count)/Math.LN2}flo(db){const Db=
2/Math.pow(2,db);this.features.invertedRank=Math.max(this.features.invertedRank,db?1/db:0);this.features.logRank=Math.max(this.features.logRank,Db)}Gmo(db){const Db=bl(10,db),Yb=bl(2,db);db=bl(1,db);this.features.sgc=Math.max(this.features.sgc,Db);this.features.ugc=Math.max(this.features.ugc,Yb);this.features.tgc=Math.max(this.features.tgc,db)}}Object(l.a)(Ae,"CommandModel",null,[]);class mg{constructor(db){this.Mkc=null;if(!db&&cg.TellMeActor.instance.Ze)cg.TellMeActor.instance.Ze.onError("PredictionEngine",
"IModelAdapter can't be null");this.DSb=db;this.hgd=this.Ywf()}Ywf(){const db=this.DSb.qzl(),Db=this.DSb.Gff();if(void 0===db||null===db||void 0===Db||null===Db)return!1;try{window.performance.now();this.Mkc={};for(let Yb=0;Yb<db.length;Yb++){const zc=db[Yb],Vc=Db[zc[0].toString()].trim(),bd=zc[1],ce=0!==bd?Db[zc[2].toString()].trim():"",ud=zc[3];Vc in this.Mkc||(this.Mkc[Vc]=new Gk(Vc));this.Mkc[Vc].C1j(ce,bd,ud)}}catch(Yb){if(cg.TellMeActor.instance.Ze)cg.TellMeActor.instance.Ze.onError("LoadModelData",
"Error Loading Suggestions Model: "+Yb);return!1}return!0}rfl(){const db=this.DSb.Wvl(),Db={};if(!db)return Db;let Yb=1;for(let zc=0;zc<db.length;zc++){const Vc=db[zc];Vc.Id in Db?(Db[Vc.Id].i7h(),Db[Vc.Id].flo(Yb),Db[Vc.Id].Gmo(Vc.TimeElapsedSinceClick)):Db[Vc.Id]=new Ae(Yb,Vc.TimeElapsedSinceClick);Yb++}return Db}$rf(){this.hgd||(this.hgd=this.Ywf());return this.hgd}sEl(){let db=[];if(!this.hgd){if(cg.TellMeActor.instance.Ze)cg.TellMeActor.instance.Ze.onError("GetPredictedCommands","IModelAdapter returned no data");
return db}const Db=this.rfl(),Yb=this.Mkc;for(let Vc in Yb){const bd=Yb[Vc],ce=bd.modelId;let ud=0;for(let Sb in Db){var zc=Sb;const Gf=Db[Sb].features;(zc=zc in bd.jBc?bd.jBc[zc]:null)&&(ud+=Gf.invertedRank*zc.invertedRank+Gf.logRank*zc.logRank+Gf.logCount*zc.logCount+Gf.sgc*zc.sgc+Gf.ugc*zc.ugc+Gf.tgc*zc.tgc)}ud+=bd.featureIntercept;db.push(new ye.a(ce,ud))}db.sort((Vc,bd)=>Vc.score<bd.score?1:Vc.score>bd.score?-1:0);0<db.length-10&&(db=db.slice(0,10));return db}}Object(l.a)(mg,"PredictionEngine",
null,[]);class xk{constructor(){this.d_g={"Multiselect,Paragraph,SelectionRange":"LineSpacing WordCountSplitButton Find RemoveSpaceAfterParagraph ParagraphOptions SpacingAfter".split(" "),"Paragraph,SelectionRange":"Find LineSpacing WordCountSplitButton Strikethrough Superscript Subscript".split(" "),"Paragraph,SelectionRange,Image":"CropPictureMenu PrintDocument Find EditPictureAltText FormatPictureOptions MarginsCustom".split(" "),"Paragraph,SelectionRange,SpellingError":"LineSpacing WordCountSplitButton Spelling Find SetProofingLanguage Strikethrough".split(" "),
"Multiselect,Paragraph,SelectionRange,SpellingError":"LineSpacing WordCountSplitButton SetProofingLanguage Find RemoveSpaceAfterParagraph ParagraphOptions".split(" "),"Multiselect,Paragraph,SelectionRange,WhiteSpaceAtCursor":"LineSpacing WordCountSplitButton RemoveSpaceAfterParagraph Find WordCount ParagraphOptions".split(" "),"Paragraph,SelectionRange,Table":"Find Strikethrough CellShading Superscript Subscript OpenInClientWithIcon".split(" "),"Multiselect,Paragraph,SelectionRange,Table":"CellShading MergeCells Strikethrough Find LineSpacing NoBorder".split(" "),
"Paragraph,SelectionRange,List":"Find Strikethrough Superscript InsertLink Subscript Highlighter".split(" "),"Paragraph,SelectionRange,WhiteSpaceAtCursor":"WordCountSplitButton LineSpacing WordCount ApplyStyle Find Strikethrough".split(" "),"Multiselect,EmptyParagraph,SelectionRange":"LineSpacing WordCountSplitButton Find SetProofingLanguage ParagraphOptions RemoveSpaceAfterParagraph".split(" "),"Multiselect,Paragraph,SelectionRange,List":"LineSpacing Strikethrough WordCountSplitButton Find DistributeColumns SpacingAfter".split(" "),
"EmptyParagraph,SelectionRange":"Find InsertHeaderFooter LineSpacing BorderGallery_MLR InsertPageNumber LineSpacing".split(" "),"Multiselect,EmptyParagraph,SelectionRange,Table":"MergeCells CellShading DeleteRow BorderGallery_MLR NoBorder Find".split(" "),"EmptyParagraph,SelectionRange,Table":"MergeCells CellShading NoBorder Find BorderGallery_MLR DeleteRow".split(" "),"Multiselect,Paragraph,SelectionRange,SpellingError,WhiteSpaceAtCursor":"LineSpacing WordCountSplitButton SetProofingLanguage Find RemoveSpaceAfterParagraph ParagraphOptions".split(" "),
"Paragraph,SelectionRange,SpellingError,WhiteSpaceAtCursor":"WordCountSplitButton LineSpacing SetProofingLanguage WordCount Find IndentHanging".split(" "),"Paragraph,SelectionRange,SpellingError,Table":"Find Strikethrough SetProofingLanguage Spelling ChangeCaseUpper WordCountSplitButton".split(" "),"Paragraph,SelectionRange,Hyperlink":"IndentHanging Find InsertLink LineSpacing Strikethrough BorderGallery_MLR".split(" "),"Paragraph,SelectionRange,SpellingError,List":"Strikethrough Spelling Find WordCountSplitButton SetProofingLanguage Subscript".split(" "),
"Multiselect,Paragraph,SelectionRange,SpellingError,Table":"SetProofingLanguage LineSpacing Find CellShading MergeCells Strikethrough".split(" "),"Multiselect,Paragraph,SelectionRange,Hyperlink":"LineSpacing IndentHanging Find ParagraphOptions WordCountSplitButton RemoveSpaceAfterParagraph".split(" "),"Multiselect,Paragraph,SelectionRange,WhiteSpaceAtCursor,Table":"CellShading MergeCells LineSpacing Strikethrough Find NoBorder".split(" "),"Multiselect,Paragraph,SelectionRange,SpellingError,List":"LineSpacing SetProofingLanguage Strikethrough WordCountSplitButton Find ParagraphOptions".split(" ")}}KEd(db,
Db){return Db&&"word"===Db.application.toLowerCase()&&db in this.d_g?this.d_g[db]:[]}}Object(l.a)(xk,"SuggestionResultsUtility",null,[]);class lf{constructor(db,Db,Yb){this.qc=Db;this.Prc=new mg(db);this.U0=Yb;this.W1g=new xk}FL(){return"Suggestion"}FW(){return 0===this.qc.Kv?0:1===this.qc.Kv?1:2}DI(db,Db,Yb,zc=e.a.tellMe,Vc=null){Yb=new t.a(db);cg.TellMeActor.instance.p4c=!1;if((!Vc||Array.contains(Vc,16))&&Hi.a.ZW(db)){if(!this.Prc.$rf()){if(cg.TellMeActor.instance.Ze)cg.TellMeActor.instance.Ze.onError("CRASH",
"SuggestionResultsProvider: Found invalid Model data");throw Error.create("SuggestionResultsProvider: Model data invalid/corrupted");}if(this.gQd()&&0<this.W1g.KEd(cg.TellMeActor.instance.nyd,this.qc).length){const ce=this.W1g.KEd(cg.TellMeActor.instance.nyd,this.qc);Vc=[];for(var bd of ce)this.qc.j8d&&"Find"===bd||Vc.push(new ye.a(bd,0));cg.TellMeActor.instance.p4c=!0}else Vc=this.Prc.sEl();wg.CommandResultsUtility.mTd(Vc,!0,"Recommended","LRE");bd=[];for(const ce of Vc)this.U0&&this.U0.YYe(ce.commandId)||
bd.push(ce);db=wg.CommandResultsUtility.RHd(db,bd,this.qc,null,null,null,16,1);0<db.results.length&&zc!==e.a.contextMenu&&(db.displayName=CommonUIStrings.l_TellMeTryCommandTitle);0<db.results.length&&Yb.iw(db)}Db.resultsUpdated(Yb)}gQd(){return!!this.qc&&(this.qc.gQd||this.qc.Onm)}}Object(l.a)(lf,"SuggestionResultsProvider",null,[1098]);class ej{Wvl(){return cg.TellMeActor.instance.Gke}qzl(){return window.TellMeSuggestionModel}Gff(){return window.CoefficientModelIdMap}}Object(l.a)(ej,"SuggestionsModelAdapter",
null,[1144]);var hl=d(1717),Xh=d(1677);d.d(N,"AggregatorResultsProvider",function(){return Cd});class Cd{constructor(db=!1){this.OTb={};this.OTb[e.a.tellMe]=[];this.OTb[e.a.contextMenu]=[];this.sed=db}hji(db,Db,Yb,zc,Vc=null){let bd;var ce=!1;switch(zc){case e.a.contextMenu:bd=this.OTb[e.a.contextMenu];ce=!0;break;default:bd=this.OTb[e.a.tellMe]}Db=new dk(Db,bd,ce,this.sed,zc);Db.E3m();for(let ud=0;ud<bd.length;++ud){const Sb=window.performance.now(),Gf=new v(Db,ud);(ce=cg.TellMeActor.instance.ON())&&
ce.Yjk?window.setTimeout(()=>{bd[ud].DI(db,Gf,Yb,zc,Vc);if(cg.TellMeActor.instance.Ze){const gg={};gg[a.a.provider]=bd[ud].FL();gg[a.a.MHb]=db.jjb;cg.TellMeActor.instance.Ze.WB(k.a.DI,window.performance.now()-Sb,gg)}},0):(bd[ud].DI(db,Gf,Yb,zc,Vc),cg.TellMeActor.instance.Ze&&(ce={},ce[a.a.provider]=bd[ud].FL(),ce[a.a.MHb]=db.jjb,cg.TellMeActor.instance.Ze.WB(k.a.DI,window.performance.now()-Sb,ce)))}Db.Jeo()}FL(){return"Aggregator"}FW(){return 0}DI(db,Db,Yb=!1,zc=e.a.tellMe,Vc=null){if(cg.TellMeActor.instance.TIm)this.hji(db,
Db,Yb,zc,Vc);else{const bd=window.performance.now();cg.TellMeActor.instance.Vqo.then(()=>{cg.TellMeActor.instance.Ze&&cg.TellMeActor.instance.Ze.WB(k.a.UIm,window.performance.now()-bd);this.hji(db,Db,Yb,zc,Vc);return!0})}}TH(db,Db){this.OTb[Db].push(db)}n3j(db){switch(db){case "FindParameterized":case "FindInDocumentSuggestion1":case "FindInDocumentSuggestion2":const Db=this.OTb[e.a.tellMe];for(const Yb of Db)if("FindInDocument"===Yb.FL()){Yb.aMn(db);break}}}static createInstance(db,Db,Yb,zc){const Vc=
zc&&Hi.a.l_f(Db);var bd=Vc&&Db.iJf;const ce=Db.buf&&!Hi.a.JDb(),ud=Db.lsf,Sb=new Cd(Vc);if(Db.WUn){var Gf=new Tf(Db);Sb.TH(Gf,e.a.tellMe)}Gf=Db.fq?ee.AFrameworkApplication.K.$("TellMeIsSuggestionsForSimplifiedUxEnabled"):ee.AFrameworkApplication.K.$("TellMeSuggestionsIsEnabled");const gg=!Gf&&ee.AFrameworkApplication.K.$("TellMeFirstRunExperienceIsEnabled");Sb.TH(new te.a(db,Db.Sco,gg,!1),e.a.tellMe);Gf&&Sb.TH(new lf(new ej,Db,db),e.a.tellMe);db=ee.AFrameworkApplication.ua.Sb.dii?new ck(Db,new Uf):
new Fk(Db,Yb);Sb.TH(db,e.a.contextMenu);(Vc&&Db.jJf||bd)&&Sb.TH(hl.a.Dvh(Db,!0),e.a.tellMe);Sb.TH(db,e.a.tellMe);!Db.HHh||"Word"===Db.application&&Db.ECd||Sb.TH(new ah(Db),e.a.tellMe);Db.Cvb&&(bd=new y(Db),Sb.TH(bd,e.a.tellMe),Sb.TH(bd,e.a.contextMenu));!Db.Jvb||Db.k0c||Db.j0c||Sb.TH(new B.a(Db),e.a.tellMe);zc&&(Db.EZ||Hi.a.xCa())&&(bd=new ri(Db),Sb.TH(bd,e.a.tellMe),Sb.TH(bd,e.a.contextMenu));Vc&&Sb.TH(hl.a.Dvh(Db,!1),e.a.tellMe);zc&&!Db.k3f&&Hi.a.k_f(Db)&&(Sb.TH(new Ni.a(Db),e.a.tellMe),Db.k9i&&
Sb.TH(new Ni.a(Db),e.a.contextMenu));ce&&Sb.TH(new Cg(Db),e.a.tellMe);(Db.Dec||Db.VQ)&&Sb.TH(new Tg.a(Db),e.a.tellMe);Db.BPc&&Sb.TH(new Xh.a(Db),e.a.tellMe);zc&&Db.uNd&&Sb.TH(new n.AddinResultsProvider(Db),e.a.tellMe);ud&&"Excel"===Db.application&&Sb.TH(new gl(Db),e.a.tellMe);return Sb}}Object(l.a)(Cd,"AggregatorResultsProvider",null,[1098])},1696:function(C,N,d){C=d(0);var l=d(17),e=d(5),a=d(150),k=d(216),n=d(387),v=d(59),u=d(72),t=d(928),y=d(851),B=d(553);d(499);var G=d(1667),F=d(1668),K=d(1664),
O=d(1666),H=d(1665),I=d(927),J=d(850);class L{constructor(ka,la,Ha){this.Oel=ka;this.phk=la;this.Zsk=Ha}}Object(C.a)(L,"BacktraceAndMakeUpdateHintsInput",null,[]);var S=d(1518),E;(function(ka){ka[ka.EOP=0]="EOP";ka[ka.character=1]="character";ka[ka.embeddedMarker=2]="embeddedMarker"})(E||(E={}));Object(C.b)("LCSBlockType",E);class P{toString(){return String.format("[Type: {0}]",E[this.type])}}Object(C.a)(P,"ALCSBlock",null,[]);class T extends P{constructor(ka,la){super();this.Oje=la;this.fCe=ka}get type(){return 1}get character(){return this.Oje}get fv(){return this.fCe}Oz(ka){return 1===
ka.type&&S.a.Jdh(ka.character,this.character)}toString(){return String.format("{0} [Char: {1}]",super.toString(),this.character)}}Object(C.a)(T,"CharacterLCSBlock",P,[]);class U extends P{constructor(ka,la,Ha){super();this.fCe=ka;this.LMe=la;this.Oqc=Ha}get type(){return 0}get Nc(){return this.LMe}get length(){return this.Oqc}get fv(){return this.fCe}Oz(ka){return 0!==ka.type?!1:ka.fv===this.fv&&ka.Nc===this.Nc}toString(){return String.format("{0} [ParaId: {1}] [WordId: {2}] [Length: {3}]",super.toString(),
this.fv.toString(),this.Nc,this.length)}}Object(C.a)(U,"EOPLCSBlock",P,[]);class X extends T{constructor(ka,la,Ha){super(ka,"\ufffc");this.WLj=la;this.Uad=Ha}get type(){return 2}get Yl(){return this.WLj}get Bj(){return this.Uad}Oz(ka){return 2!==ka.type?!1:ka.Yl===this.Yl&&this.Bj.equals(ka.Bj)}toString(){return String.format("{0} [Marker: {1}] [FId: {2}]",super.toString(),this.Yl,this.Bj)}}Object(C.a)(X,"EmbeddedMarkerLCSBlock",T,[]);class Y{constructor(ka,la){this.x=ka;this.y=la}equals(ka){return ka.x===
this.x&&ka.y===this.y}toString(){return"("+this.x+", "+this.y+")"}}Object(C.a)(Y,"IntPair",null,[880]);var ca=d(1551),da=d(1537),ua=d(1552),ra=d(1663);d.d(N,"a",function(){return qa});class qa{constructor(ka,la){this.Lg=ka;this.ge=la}Ovh(ka,la,Ha,wa,Ca,Ja,bb){return this.uOk(ka,la,Ha,wa,Ca,Ja,bb)}uOk(ka,la,Ha,wa,Ca,Ja,bb){let ha;ha=null;({returnValue:ka}=this.tGd(ka,la));if(!ka)return a.a.instance.Wa(575706449,1,2,"Failed to get LCS blocks from objects for base"),this.ge.logger.YT("GetLCSBlocksFromObject"),
{returnValue:!1,updateHints:ha};({returnValue:Ha}=this.tGd(Ha,wa));if(!Ha)return a.a.instance.Wa(575706450,1,2,"Failed to get LCS blocks from objects for changed"),this.ge.logger.YT("GetLCSBlocksFromObject"),{returnValue:!1,updateHints:ha};this.ge.logger.YT("GetLCSBlocksFromObject");ha=this.tOk(ka,Ha,Ca,Ja,bb);return ha?{returnValue:!0,updateHints:ha}:(a.a.instance.Wa(575706451,1,2,"Failed to Create UpdateHints"),{returnValue:!1,updateHints:ha})}xHh(ka,la,Ha,wa){({returnValue:ka}=this.tGd(ka,la));
if(!ka)return-1;({returnValue:Ha}=this.tGd(Ha,wa));if(!Ha)return-1;({e2e:Ha}=this.AHh(ka,Ha));return Ha}tGd(ka,la){let Ha;const wa=new k.a;Ha=new k.a;if(!ka.length)return a.a.instance.Wa(594124833,1,2,"Abandoning LCS due to empty list of paragraphs"),this.ge.logger.Pg(Object.assign(new ca.a,{lj:"GetLCSBlocksFromObject",eventId:"900a7"})),{returnValue:null,B7e:Ha};for(let bb=0;bb<ka.length;bb++)if(this.ge.runtime.bG("GetLCSBlocksFromObject: paraObjs#"+bb),393230===ka.J(bb).Qc){const ha=this.Lg.getPropertyString(ka.J(bb),
l.a.lo),ia=this.Lg.getPropertyUint32(ka.J(bb),e.a.Nc);if(null==ia)return a.a.instance.Wa(594124835,1,2,"Abandoning LCS due to missing WordId"),this.ge.logger.Pg(Object.assign(new ca.a,{lj:"GetLCSBlocksFromObject",eventId:"900a9"})),{returnValue:null,B7e:Ha};let va=this.Lg.getPropertyUint32s(ka.J(bb),l.a.mm);va=da.a.P_i(va,ha.length);const Ka=this.Lg.getPropertyObjectIds(ka.J(bb),l.a.un);let Xa;for(Xa=0;Xa<va.length-1;Xa++){var Ca=la(Ka.lg(Xa)),Ja=void 0;Ja=Ca?(Ja=this.Lg.getPropertyBool(Ca,l.a.K7))?
Ja:!1:!1;if(Ja)wa.add(this.oJk(ka.J(bb).id,Ca));else for(Ca=va.lg(Xa);Ca<va.lg(Xa+1);Ca++)wa.add(new T(ka.J(bb).id,S.a.charAt(ha,Ca)))}wa.add(new U(ka.J(bb).id,ia,va.J(Xa)));Ha.add(wa.length-1)}else return a.a.instance.Wa(594124864,1,2,"Abandoning LCS due to presence of non-paragraph object of type {0}",ka.J(bb).Qc),this.ge.logger.Pg(Object.assign(new ca.a,{lj:"GetLCSBlocksFromObject",eventId:"900ba"})),{returnValue:null,B7e:Ha};this.ge.runtime.bG("LCS: GetLCSBlocks for base");return{returnValue:wa,
B7e:Ha}}oJk(ka,la){const Ha=null==this.Lg.getPropertyInt32(la,e.a.Eq)?0:this.Lg.getPropertyInt32(la,e.a.Eq);return new X(ka,Ha,la.id)}tOk(ka,la,Ha,wa,Ca){wa=({e2e:Ha}=this.AHh(ka,la,Ha,wa,Ca)).returnValue;this.ge.logger.YT("FindFurthestPaths");ka=new L(wa,ka,la);ka=new ra.a(this.fhk(ka,Ha),1);this.ge.logger.YT("BacktraceAndMakeUpdateHints");return ka}AHh(ka,la,Ha=-1,wa=-1,Ca=-1){let Ja;if(-1===Ha||-1===wa||-1===Ca)Ca=wa=Ha=-1;Ja=-1;const bb=new n.a;bb.Z(new Y(-1,1),new Y(0,-1));if(-1!==Ha){bb.Z(new Y(0,
0),new Y(Ha,Ha));var ha=1}else ha=0,wa=ka.length,Ca=la.length;for(Ha=0;ha<=ka.length+la.length;ha++){let ia=!1;for(let va=-ha;va<=ha;va+=2){let Ka,Xa;va===-ha?(Ka=bb.J(new Y(ha-1,va+1)).x,Xa=bb.J(new Y(ha-1,va+1)).y+1):va===ha?(Ka=bb.J(new Y(ha-1,va-1)).x+1,Xa=bb.J(new Y(ha-1,va-1)).y):bb.J(new Y(ha-1,va-1)).x>=bb.J(new Y(ha-1,va+1)).x?(Ka=bb.J(new Y(ha-1,va-1)).x+1,Xa=bb.J(new Y(ha-1,va-1)).y):(Ka=bb.J(new Y(ha-1,va+1)).x,Xa=bb.J(new Y(ha-1,va+1)).y+1);for(;Ka<wa&&Xa<Ca&&ka.J(Ka).Oz(la.J(Xa));)Ka++,
Xa++;bb.Z(new Y(ha,va),new Y(Ka,Xa));if(Ka===wa&&Xa===Ca){ia=!0;Ja=ha;Ha=va;break}}if(ia)break;this.ge.runtime.bG("LCS FindFurthestPaths")}if(Ha!==wa-Ca)return{returnValue:null,e2e:Ja};bb.Z(new Y(Ja,Ha),new Y(wa+1,Ca+1));a.a.instance.Wa(593826837,1,4,"FindFurthestPaths finished. Length of base: {0} Length of changed: {1} Size of diff: {2}",ka.length,la.length,Ja);return{returnValue:bb,e2e:Ja}}fhk(ka,la){const Ha=ka.Oel,wa=ka.phk;ka=ka.Zsk;const Ca=new k.a;let Ja=wa.length,bb=ka.length;for(;0<Ja||
0<bb;){var ha=Ja-1,ia=bb-1;if(this.D3m(Ha,la,Ja,bb)){ha=ka.J(ia);if(1===ha.type||2===ha.type)this.R6l(Ca,Ja,ha);else if(0===ha.type)this.r6l(Ca,Ja,ha);else return a.a.instance.Wa(575706452,1,2,"Abandoning LCS due to unexpected block of type {0}",ha.type),this.ge.logger.Pg(Object.assign(new ua.a,{lj:"BacktraceAndMakeUpdateHintsReducedOps",eventId:"0"})),null;bb--;la--}else if(this.C3m(Ha,la,Ja,bb)){ia=wa.J(ha);if(1===ia.type||2===ia.type)this.xTk(Ca,ha,ia);else if(0===ia.type)this.cTk(Ca,ha,ia);else return a.a.instance.Wa(575706453,
1,2,"Abandoning LCS due to unexpected block of type {0}",ia.type),this.ge.logger.Pg(Object.assign(new ua.a,{lj:"BacktraceAndMakeUpdateHintsReducedOps",eventId:"0"})),null;Ja--;la--}else if(Ja&&bb&&wa.J(ha).Oz(ka.J(ia)))Ja--,bb--;else return a.a.instance.Wa(575706454,1,2,"Abandoning LCS due to being unable to find a path"),this.ge.logger.Pg(Object.assign(new ua.a,{lj:"BacktraceAndMakeUpdateHints",eventId:"0"})),null}this.ge.runtime.bG("LCS: CreateUpdateHintsFromLCSBlocks");return Ca}C3m(ka,la,Ha,wa){la=
new Y(la-1,Ha-wa-1);return ka.xb(la)&&ka.J(la).x===Ha-1&&ka.J(la).y===wa}D3m(ka,la,Ha,wa){la=new Y(la-1,Ha-wa+1);return ka.xb(la)&&ka.J(la).x===Ha&&ka.J(la).y===wa-1}addPara(ka,la,Ha,wa,Ca,Ja){var bb=null;Ha.block?bb=Ha.block.fv:0<=Ca&&0===ka.J(Ca).type&&(bb=ka.J(Ca).fv);Ha=ka=Ja.fv;if(wa.qXb.contains(ka))for(Ca=0,ka=v.a.Of("{00000000-0000-0000-0000-000000000000}{"+Ca+"}");wa.qXb.contains(ka);)Ca++,ka=v.a.Of("{00000000-0000-0000-0000-000000000000}{"+Ca+"}");bb=new t.AddParagraphUpdateHint(ka,Ja.Nc,
bb);bb.u_m=Ha;la.updateHints.add(bb);wa.fv=ka;wa.Nc=Ja.Nc;wa.qXb.add(ka);wa.eOa=0}r6l(ka,la,Ha){Ha=new K.a(Ha.fv,Ha.Nc);let wa=!1;if(0<ka.length&&11===ka.lg(ka.length-1).type){const Ca=ka.lg(ka.length-1);Ca.cp===la&&(wa=!0,Ca.AZ.add(Ha))}wa||(la=new H.a(la),la.AZ.add(Ha),ka.add(la))}splitPara(ka,la,Ha,wa,Ca,Ja,bb,ha){ka=this.V9k(Ja.fv,ka,la,wa);if(!ka)return!1;la=new J.a(Ja.fv,Ja.Nc,Ja.eOa,ka.fv,ka.Nc,bb.fv,bb.Nc);Ha.updateHints.add(la);Ja.Nc=ka.Nc;ka!==ha?(Ca.block=ka,Ca.JCo=Ja.eOa,Ca=new t.AddParagraphUpdateHint(ha.fv,
ha.Nc,ka.fv),Ha.updateHints.add(Ca),Ja.fv=ha.fv,Ja.Nc=ha.Nc,Ja.qXb.add(ha.fv),Ja.eOa=0):Ja.qXb.add(bb.fv);return!0}R6l(ka,la,Ha){var wa=!1;if(0<ka.length&&11===ka.lg(ka.length-1).type){const Ca=ka.lg(ka.length-1);Ca.cp===la&&((wa=Object(u.a)(O.a,Ca.AZ.J(Ca.AZ.length-1)))?wa.text=Ha.character.toString()+wa.text:Ca.AZ.add(new O.a(Ha.fv,Ha.character.toString())),wa=!0)}wa||(la=new H.a(la),la.AZ.add(new O.a(Ha.fv,Ha.character.toString())),ka.add(la))}deletePara(ka,la,Ha,wa,Ca,Ja){let bb=-1;for(let ha=
0;ha<Ca.length;ha++)if(Ca.J(ha)===Ja){0<ha&&(bb=ha-1);break}Ja=null;0<=bb&&(Ja=wa.J(Ca.J(bb)));wa=new y.a(Ha.fv,Ha.Nc,Ja?Ja.fv:null);ka.updateHints.add(wa);Ja&&la.fv.equals(Ha.fv)&&(la.eOa=Ja.length,la.fv=Ja.fv,la.Nc=Ja.Nc);la.qXb.remove(Ha.fv)}cTk(ka,la,Ha){la=new G.a(la,Ha.fv,Ha.Nc);ka.add(la)}mergePara(ka,la,Ha){ka.updateHints.add(new I.MergeParagraphUpdateHint(Ha.fv,Ha.Nc,Ha.length,la.fv,la.Nc,Ha.fv,la.Nc));la.eOa=Ha.length;la.qXb.remove(la.fv);la.fv=Ha.fv}deleteText(ka,la,Ha){let wa=!1;if(0<
ka.updateHints.length&&2===ka.updateHints.lg(ka.updateHints.length-1).type){const Ca=ka.updateHints.lg(ka.updateHints.length-1);Ca.Bg.equals(la.fv)&&Ca.cp===la.eOa&&(Ca.cp=la.eOa-1,Ca.text=Ha.character.toString()+Ca.text,wa=!0)}wa||ka.updateHints.add(new B.DeleteTextUpdateHint(la.fv,la.eOa-1,Ha.character.toString()));--la.eOa}xTk(ka,la,Ha){let wa=!1;if(0<ka.length&&8===ka.lg(ka.length-1).type){const Ca=ka.lg(ka.length-1);Ca.cp===la+1&&(Ca.text=Ha.character.toString()+Ca.text,--Ca.cp,wa=!0)}wa||ka.add(new F.a(la,
Ha.character.toString()))}V9k(ka,la,Ha,wa){for(;0<=wa;){var Ca=la.J(Ha.J(wa));if(0!==Ca.type)break;if(Ca.fv.equals(ka))return Ca;wa--}return null}}Object(C.a)(qa,"LCSUpdateHintGenerator",null,[])},1702:function(C,N,d){d.r(N);C=d(0);var l=d(17),e=d(5),a=d(150),k=d(387),n=d(619),v=d(216),u=d(59),t=d(44),y=d(1506);class B extends y.a{constructor(){super()}get hea(){return"ChildNodeListMerge"}}Object(C.a)(B,"ChildNodeListMergeFailureDetail",y.a,[]);class G{Zlb(Y,ca,da){return ca.Jy(Y,da.J(Y))}Fdj(Y,ca,
da,ua){let ra;return({value:ra}=ca.Dc(Y)).returnValue||({value:ra}=da.Dc(Y)).returnValue?ra:ua.J(Y)}}Object(C.a)(G,"ChildNodeListMergeUtils",null,[1834]);var F=d(1531),K=d(1716),O=d(1589);class H{constructor(Y,ca){this.classId=Y;this.sdo=ca}}Object(C.a)(H,"NodeChildrenTransformation",null,[]);var I=d(789),J=d(1522);class L{constructor(Y,ca,da){this.bE=Y;this.zoa=da;this.X5=ca}S0d(Y){let ca,da;return({MHi:ca}=this.Ldj(this.zoa,Y)).returnValue&&ca.YW||({MHi:da}=this.Ldj(this.X5,Y)).returnValue&&da.YW}Ldj(Y,
ca){let da;return{returnValue:({value:da}=(new J.a(this.bE,Y)).vna.Dc(I.a.yb(ca))).returnValue,MHi:da}}}Object(C.a)(L,"NodeTriplet",null,[]);var S=d(1662);class E{constructor(Y,ca,da){this.ge=Y;this.Lg=ca;this.QV=da;this.R1g=!0}get Yo(){return this.ge}get $d(){return this.Lg}get pwa(){return this.QV}get success(){return this.R1g}HDl(){a.a.instance.Wa(4220310,1,5,"Evaluating ParentObjects");const Y=new k.a;this.zUe(Y,ca=>this.Yo.runtime.lk.J(ca));this.zUe(Y,ca=>this.pwa.Zlb(ca,this.Yo.runtime.Yt,this.Yo.runtime.lk));
this.zUe(Y,ca=>this.pwa.Zlb(ca,this.Yo.runtime.lq,this.Yo.runtime.lk));return Y}zUe(Y,ca){const da=ca(d(1702).ChildNodeListMerge.FZd);this.$d.getPropertyObjectIds(da,l.a.qf).forEach(ua=>{this.$d.getPropertyObjectIds(ca(ua),l.a.qf).forEach(ra=>{Y.xb(ra)&&!ua.equals(Y.J(ra))&&(this.R1g=!1,a.a.instance.Wa(4220311,1,1,"OutlineGroup {0} should have parent {1} but instead has a different parent {2}.",ra,ua,Y.J(ra)));Y.Z(ra,ua);return!0});return!0})}}Object(C.a)(E,"OutlineGroupParentFinder",null,[]);var P=
d(1507),T=d(1553),U=d(1590);d.d(N,"ChildNodeListMerge",function(){return X});class X{constructor(Y,ca=null,da=null,ua=null,ra=null){this.Lg=Y;this.V1m=ca||K.a.eej;this.RVd=da||this.NAl();this.pwa=ua||new G;this.Uqi=ra||this.Wyl()}get $d(){return this.Lg}NAl(){return[new H(393227,Object(t.a)(this,this.I0m,"pageContentNodeThreewayChildMerge")),new H(1073872968,Object(t.a)(this,this.Iuo,"wordSectionNodeThreewayChildMerge")),new H(393241,Object(t.a)(this,this.wZd,"outlineElementContainerThreewayChildMerge")),
new H(393252,Object(t.a)(this,this.C5n,"tableCellThreewayChildMergev2")),new H(1074135125,Object(t.a)(this,this.wZd,"outlineElementContainerThreewayChildMerge")),new H(1074135123,Object(t.a)(this,this.wZd,"outlineElementContainerThreewayChildMerge")),new H(1074135127,Object(t.a)(this,this.wZd,"outlineElementContainerThreewayChildMerge"))]}Wyl(){return[Object(t.a)(this,this.H7m,"prepareObjectGroupings"),Object(t.a)(this,this.sTl,"handleInterOutlineGroupMerge"),Object(t.a)(this,this.e4m,"performThreewayChildMerge")]}eHm(Y){let ca=
0;for(;ca<this.Uqi.length;ca++)if(!(0,this.Uqi[ca])(Y))return a.a.instance.Wa(4273296,1,4,"MergeChildNodeLists: Merged failed. [Function: {0}]",ca),Y.logger.sTd("ChildNodeListMerge.GetMergeChildNodeListsFunctions()",ca),!1;return!0}H7m(Y){const ca=new k.a,da=new k.a,ua=new n.a;Y.runtime.Yt.forEach((ra,qa)=>X.LDi(qa,ca));Y.runtime.lq.forEach((ra,qa)=>X.LDi(qa,da));for(let ra=0;ra<this.RVd.length;ra++){const qa=this.RVd[ra].classId;Y.runtime.Nhb.Z(qa,new k.a);ca.xb(qa)&&ca.J(qa).forEach(ka=>{var la=
Y.runtime.lk.J(ka.id);la&&(la=new L(la,ka,Y.runtime.lq.Jy(ka.id,la)),Y.runtime.Nhb.J(qa).add(ka.id,la),ua.add(ka.id));return!0});da.xb(qa)&&da.J(qa).forEach(ka=>{if(ua.contains(ka.id))return!0;const la=Y.runtime.lk.J(ka.id);la&&Y.runtime.Nhb.J(qa).add(ka.id,new L(la,la,ka));return!0})}Y.runtime.bG("PrepareObjectGroupings");Y.logger.yfa("PrepareObjectGroupings");return!0}e4m(Y){let ca=!0;for(let da=0;ca&&da<this.RVd.length;da++){const ua=this.RVd[da];Y.runtime.bG("Before function#"+da);const ra=ua.classId;
Y.runtime.Nhb.J(ra).forEach((qa,ka)=>{Y.runtime.JJa.contains(ka.bE.id)||(ca=ua.sdo(Y,ka)&&ca);ca||(a.a.instance.Wa(4273297,1,4,"PerformThreewayChildMerge: Failed. [ClassId: {0}] [BaseObject.Id: {1}]",ra,ka.bE.id),Y.logger.Pg(Object.assign(new B,{lj:"PerformThreewayChildMerge",eventId:"aqtsr"})));return ca});Y.runtime.bG("PerformThreewayChildMerge"+da)}Y.logger.yfa("PerformThreewayChildMerge");return ca}I0m(Y,ca){if(ca.S0d(l.a.qf)){var da=this.$d.getPropertyObjectIds(ca.bE,l.a.qf);const ua=this.$d.getPropertyObjectIds(ca.X5,
l.a.qf);ca=this.$d.getPropertyObjectIds(ca.zoa,l.a.qf);da=String.format("Child node count: Base={0}, Favored={1}, Unfavored={2}, GraphMergeSource={3}",da.length,ua.length,ca.length,Y.input.source);a.a.instance.Wa(4030551,1,4,"Punting attempted merge as there appears to be an added or removed WordSection. {0}",da);Y.logger.Pg(Object.assign(new B,{lj:"PageContentNodeThreewayChildMerge",eventId:"apybx",info:da}));return!1}return!0}Iuo(Y,ca){if(ca.S0d(l.a.qf)){const Ha=new n.a,wa=new n.a,Ca=new n.a,Ja=
new n.a;var da=this.$d.getPropertyObjectIds(ca.bE,l.a.qf),ua=da.cG(),ra,qa=({wsh:ra}=this.Kkj(ca.X5,ua,Ha,"Favored")).returnValue,ka=({wsh:la}=this.Kkj(ca.zoa,ua,wa,"Unfavored")).returnValue;if(!qa||!ka)return da=String.format("Unexpected OG node added. Base OG count: {0}. Favored OG count: {1}. Unfavored OG count: {2}. Favored OGs not found in base: {3}. Unfavored OGs not found in base: {4}.",ua.count,Ha.count,wa.count,ra,la),Y.logger.Pg(Object.assign(new B,{lj:"WordSectionNodeThreewayChildMerge",
info:da})),!1;da.forEach(bb=>{Ha.contains(bb)||Ca.add(bb);wa.contains(bb)||Ja.add(bb);return!0});ca=ca.bE.HG();ua=new v.a;for(ra=0;ra<da.length;ra++){var la=da.lg(ra);if(Ca.contains(la)||Ja.contains(la)){if(Y.runtime.JJa.add(la),ua.length&&(qa=ua.lg(ua.length-1),qa=Y.runtime.Nhb.J(393241).J(qa),ka=Y.runtime.Nhb.J(393241).J(la),qa&&ka))Ca.contains(la)?Ja.contains(la)||(qa.bE=qa.bE.HG(),qa.zoa=qa.zoa.HG(),this.Ord(qa.bE,ka.bE),this.Ord(qa.zoa,ka.zoa)):(qa.bE=qa.bE.HG(),qa.X5=qa.X5.HG(),this.Ord(qa.bE,
ka.bE),this.Ord(qa.X5,ka.X5))}else ua.add(la)}this.$d.setPropertyObjectIds(ca,l.a.qf,ua);da=new P.a(ca);da.nB(l.a.qf);Y.runtime.Rm.Z(ca.id,da)}return!0}Ord(Y,ca){const da=this.$d.getPropertyObjectIds(Y,l.a.qf);ca=this.$d.getPropertyObjectIds(ca,l.a.qf);const ua=da.x3();ca.forEach(ra=>{ua.add(ra);return!0});this.$d.setPropertyObjectIds(Y,l.a.qf,ua)}Kkj(Y,ca,da,ua){let ra=0,qa=!0;this.$d.getPropertyObjectIds(Y,l.a.qf).forEach(ka=>{ca.contains(ka)?da.add(ka):(qa=!1,a.a.instance.Wa(573912977,1,4,"VerifyWordSectionChildren {0}: Failed to find {1} in baseObjects.",
ua,ka),ra++);return!0});return{returnValue:qa,wsh:ra}}sTl(Y){let ca=!0;Y.runtime.Nhb.J(393241).forEach((da,ua)=>{if(this.cfm(ua)){a.a.instance.Wa(4220302,1,4,"OutlineGroup {0} requires inter-OG merge.",ua.bE.id);let ra;const qa=new E(Y,this.$d,this.pwa);if(({fCi:da,omj:ra}=this.Qbo(Y,qa.HDl(),ua)).returnValue)return a.a.instance.Wa(4220303,1,4,"Merging WordSection {0} as a unit.",ra),ca=qa.success&&this.UHm(Y,ra,da)&&ca,ca||(a.a.instance.Wa(4273299,1,2,"Inter-OG merge failed. [ObjectId: {0}] [OutlineGroupParentFinder.Success: {1}].",
ua.bE.id,qa.success),Y.logger.Pg(Object.assign(new B,{lj:"HandleInterOutlineGroupMerge",eventId:"aqtst",info:String.format("Inter-OG Failure [OutlineGroupParentFinder.Success: {0}]",qa.success)}))),ca}return!0});return ca}cfm(Y){if(!Y.S0d(l.a.qf))return!1;const ca=this.$d.getPropertyObjectIds(Y.bE,l.a.qf).J(0),da=this.$d.getPropertyObjectIds(Y.X5,l.a.qf);Y=this.$d.getPropertyObjectIds(Y.zoa,l.a.qf);return!da.contains(ca,(ua,ra)=>ua.equals(ra))||!Y.contains(ca,(ua,ra)=>ua.equals(ra))}Qbo(Y,ca,da){ca=
ca.J(da.bE.id);a.a.instance.Wa(4220304,1,4,"While inspecting OG {0}, it appears an inter-OG merge is taking place. All children of WordSection {1} will be merged as a unit.",da.bE.id,ca);if(Y.runtime.JJa.contains(ca))return a.a.instance.Wa(4220305,1,5,"Trying to merge WordSection {0} for an inter-OG merge, but an another OG caused us to do that already. Skipping the attempt.",ca),{returnValue:!1,fCi:null,omj:ca};const ua=new S.a;da=Y.runtime.lk.J(ca);this.$d.getPropertyObjectIds(da,l.a.qf).forEach(ra=>
{ua.Nrd(ra);return!0});da=this.pwa.Zlb(ca,Y.runtime.Yt,Y.runtime.lk);this.$d.getPropertyObjectIds(da,l.a.qf).forEach(ra=>{ua.Qrd(ra);return!0});Y=this.pwa.Zlb(ca,Y.runtime.lq,Y.runtime.lk);this.$d.getPropertyObjectIds(Y,l.a.qf).forEach(ra=>{ua.Vrd(ra);return!0});return{returnValue:!0,fCi:ua,omj:ca}}HMf(Y,ca,da,ua,ra){let qa=!0;Y.forEach(ka=>{const la=ca(ka);this.$d.getPropertyObjectIds(la,l.a.qf).forEach(Ha=>{da.add(Ha);if(ua.xb(Ha))return(qa=ua.J(Ha).equals(ka)&&qa)||a.a.instance.Wa(4273300,1,2,
"PreprocessRevisionOutlineGroups {0}: Failed. [OutlineElementId: {1}] [OutlineGroupId: {2}] [OutputMapping: {3}]",ra,Ha,ka,ua.J(Ha)),qa;ua.Z(Ha,ka);return!0});return!0});return qa}VBl(Y,ca){let da,ua,ra,qa;da=new v.a;ua=new v.a;ra=new v.a;qa=new k.a;const ka=Y.runtime.lk;return this.HMf(ca.Nvb,la=>ka.J(la),da,qa,"Base")&&this.HMf(ca.E8e,la=>this.pwa.Zlb(la,Y.runtime.Yt,ka),ua,qa,"Favored")&&this.HMf(ca.dmb,la=>this.pwa.Zlb(la,Y.runtime.lq,ka),ra,qa,"Unfavored")?{returnValue:!0,lfh:da,vGh:ua,afj:ra,
avi:qa}:{returnValue:!1,lfh:da,vGh:ua,afj:ra,avi:qa}}Q$k(Y,ca,da,ua){let ra=!0;const qa=Y.runtime.lk,ka=Y.runtime.Yt,la=Y.runtime.lq,Ha=Y.runtime.Rm,wa=new v.a,Ca=new k.a;da.forEach(Ja=>{const bb=ua.J(Ja);if(!bb)return a.a.instance.Wa(4220306,1,1,"OutlineElementId {0} does not have an OutlineGroup parent in oeToOgMapping.",Ja),Y.logger.Pg(Object.assign(new B,{lj:"FinishInterOutlineGroupMerge",eventId:"aqgws"})),ra=!1;bb.equals(wa.last())||(wa.add(bb),Ca.add(bb,new v.a));Ca.J(bb).add(Ja);Y.runtime.JJa.add(Ja);
return!0});if(!ra)return!1;Ca.forEach((Ja,bb)=>{const ha=this.pwa.Fdj(Ja,ka,la,qa).HG();this.$d.setPropertyObjectIds(ha,l.a.qf,bb);Ha.Z(Ja,new P.a(ha));Ha.J(Ja).nB(l.a.qf);Y.runtime.JJa.add(Ja);return ra});da=this.pwa.Fdj(ca,ka,la,qa).HG();this.$d.setPropertyObjectIds(da,l.a.qf,wa);Ha.Z(ca,new P.a(da));Ha.J(ca).nB(l.a.qf);Y.runtime.JJa.add(ca);return ra}UHm(Y,ca,da){let ua,ra;if(!({lfh:qa,vGh:ua,afj:ra,avi:da}=this.VBl(Y,da)).returnValue)return!1;var qa=F.b(qa,ua,ra);qa=this.BJf(Y,qa);return!!qa&&
this.Q$k(Y,ca,qa,da)}wZd(Y,ca){return this.aCi(Y,ca)}aCi(Y,ca){if(ca.S0d(l.a.qf)){var da=this.SBl(ca);da=this.BJf(Y,da);if(!da)return a.a.instance.Wa(4220308,1,1,"OutlineElementContainerThreewayChildMerge: While attempting to merge node {0}, OutlineElementCollectionsThreewayChildMerge returned null list -- rejecting the change.",ca.bE.id),Y.logger.Pg(Object.assign(new B,{lj:"OutlineElementContainerThreewayChildMerge",eventId:"aqgwu"})),O.a(ca.bE,"OutlineElementContainerThreewayChildMerge_Base",1),
O.a(ca.X5,"OutlineElementContainerThreewayChildMerge_Favored",1),O.a(ca.zoa,"OutlineElementContainerThreewayChildMerge_Unfavored",1),!1;var ua=this.$d.getPropertyObjectIds(ca.bE,l.a.qf);const ra=da.cG();ua.forEach(qa=>{ra.contains(qa)||(qa=this.$d.getPropertyObjectIds(ca.bE,l.a.oL),0<qa.length&&Y.runtime.gKf.add(qa.J(0)));return!0});ua=ca.X5.HG();this.$d.setPropertyObjectIds(ua,l.a.qf,da);Y.runtime.Rm.Z(ua.id,new P.a(ua));Y.runtime.Rm.J(ua.id).nB(l.a.qf)}return!0}SDb(Y){if(!Y)return a.a.instance.Wa(573957964,
1,2,"Feature helper is null"),!1;Y.Vq(111);return Y.isFeatureEnabled(111)}C5n(Y,ca){if(!this.SDb(Y.runtime.Qb))return this.W3f(Y,ca);var da=ca.bE.id,ua=U.e(Y,ca.bE,null);if(ua.equals(u.a.nil))return a.a.instance.Wa(573957965,1,2,"Table node ID could not be found for table cell. Table cell ID: {0}",da),Y.logger.Pg(Object.assign(new T.a,{info:"Table node ID could not be found for table cell"})),!1;var ra=Y.runtime.Qwb.J(ua);if(ra&&(ra=ra.J(da)))if(ra.qg)ca=ca.X5.HG(),ca.removeProperty(l.a.qf),this.$d.setPropertyBool(ca,
e.a.ghostCell,!0),null!=ra.colSpan?this.$d.setPropertyUint32(ca,e.a.colSpan,ra.colSpan):ca.removeProperty(e.a.colSpan),Y.runtime.Rm.Z(ca.id,new P.a(ca)),Y.runtime.Rm.J(ca.id).nB(l.a.qf),Y.runtime.Rm.J(ca.id).nB(e.a.ghostCell),Y.runtime.Rm.J(ca.id).nB(e.a.colSpan);else{let qa,ka;({Fsd:ua,eCd:qa,mce:ka}=this.Zxl(Y,ca,ra,ua));if(!qa.length&&!ka.length)return a.a.instance.Wa(573957966,1,2,"A non-ghost cell does not have OE nodes on either side. Table cell ID: {0}",da),Y.logger.Pg(Object.assign(new T.a,
{info:"A non-ghost cell does not have OE nodes on either side"})),!1;qa.length?ka.length?(da=F.b(ua,qa,ka),da=this.BJf(Y,da)):da=qa:da=ka;if(!da)return a.a.instance.Wa(573957920,1,1,"TableCellThreewayChildMergev2: While attempting to merge node {0}, OutlineElementCollectionsThreewayChildMerge returned null list -- rejecting the change.",ca.bE.id),Y.logger.Pg(Object.assign(new B,{lj:"TableCellThreewayChildMergev2",eventId:"8n426"})),O.a(ca.bE,"TableCellThreewayChildMergev2_Base",1),O.a(ca.X5,"TableCellThreewayChildMergev2_Favored",
1),O.a(ca.zoa,"TableCellThreewayChildMergev2_Unfavored",1),!1;ca=ca.X5.HG();this.$d.setPropertyObjectIds(ca,l.a.qf,da);ca.removeProperty(e.a.ghostCell);da=ra.rowSpan;ra=ra.colSpan;null!=da&&null!=ra&&(1<da||1<ra)?(this.$d.setPropertyUint32(ca,e.a.rowSpan,da),this.$d.setPropertyUint32(ca,e.a.colSpan,ra)):(ca.removeProperty(e.a.rowSpan),ca.removeProperty(e.a.colSpan));Y.runtime.Rm.Z(ca.id,new P.a(ca));Y.runtime.Rm.J(ca.id).nB(l.a.qf);Y.runtime.Rm.J(ca.id).nB(e.a.ghostCell);Y.runtime.Rm.J(ca.id).nB(e.a.rowSpan);
Y.runtime.Rm.J(ca.id).nB(e.a.colSpan)}else return this.W3f(Y,ca);Y.logger.yfa("TableCellThreewayChildMergev2");return!0}Zxl(Y,ca,da,ua){let ra,qa;({Fsd:ca,eCd:ra,mce:qa}=this.$Ph(ca));ca||(ca=new v.a);ra||(ra=new v.a);qa||(qa=new v.a);var ka=ca.cG(),la=ra.cG(),Ha=qa.cG(),wa=da.rWd;if(wa)for(var Ca=0;Ca<wa.length;Ca++){var Ja=wa.J(Ca),bb=Y.runtime.lk.J(Ja);!ka.contains(Ja)&&bb&&(ka.add(Ja),ca.add(Ja));!la.contains(Ja)&&Y.runtime.Yt.Jy(Ja,bb)&&(la.add(Ja),ra.add(Ja));!Ha.contains(Ja)&&Y.runtime.lq.Jy(Ja,
bb)&&(Ha.add(Ja),qa.add(Ja))}Y.logger.yfa("OENodesAddedToChildrenList");if(wa=da.vjf)for(Ca=0;Ca<wa.length;Ca++)if(Ja=wa.J(Ca),bb=Y.runtime.lk.J(Ja)){var ha=this.$d.getPropertyObjectIds(bb,l.a.qf);if(ha)for(var ia=0;ia<ha.length;ia++){var va=ha.J(ia);ka.contains(va)||(ka.add(va),ca.add(va))}ha=Y.runtime.Yt.Jy(Ja,bb);if(ha=this.$d.getPropertyObjectIds(ha,l.a.qf))for(ia=0;ia<ha.length;ia++)va=ha.J(ia),la.contains(va)||(la.add(va),ra.add(va));Ja=Y.runtime.lq.Jy(Ja,bb);if(Ja=this.$d.getPropertyObjectIds(Ja,
l.a.qf))for(bb=0;bb<Ja.length;bb++)ha=Ja.J(bb),Ha.contains(ha)||(Ha.add(ha),qa.add(ha))}Y.logger.yfa("GhostCellOENodesAddedToChildrenList");if(da=da.bEf)for(ka=0;ka<da.length;ka++)if(la=da.J(ka),la=Y.runtime.Qwb.J(ua).J(la))if(la=la.rWd){la=la.cG();Ha=new v.a;for(wa=0;wa<ca.length;wa++)la.contains(ca.J(wa))||Ha.add(ca.J(wa));ca=Ha;Ha=new v.a;for(wa=0;wa<ra.length;wa++)la.contains(ra.J(wa))||Ha.add(ra.J(wa));ra=Ha;Ha=new v.a;for(wa=0;wa<qa.length;wa++)la.contains(qa.J(wa))||Ha.add(qa.J(wa));qa=Ha}Y.logger.yfa("NonGhostCellsOENodesRemovedFromChildrenList");
return{Fsd:ca,eCd:ra,mce:qa}}W3f(Y,ca){let da=ca.X5.hasProperty(l.a.qf),ua=ca.zoa.hasProperty(l.a.qf);da&&(da=!!this.$d.getPropertyObjectIds(ca.X5,l.a.qf).length);ua&&(ua=!!this.$d.getPropertyObjectIds(ca.zoa,l.a.qf).length);if(da!==ua)if(this.ylm(Y.runtime.Qb))Y.logger.dmi(Object.assign(new T.a,{info:"TableCell OE missing children, ghost cell likely touched"}));else return Y.logger.Pg(Object.assign(new T.a,{info:"TableCell OE missing children, ghost cell likely touched"})),!1;return this.aCi(Y,ca)}SBl(Y){let ca,
da;({Fsd:Y,eCd:ca,mce:da}=this.$Ph(Y));return F.b(Y,ca,da)}BJf(Y,ca){a.a.instance.Wa(4220309,1,5,"Considering {0} OutlineElement collections for merge.",ca.length);const da=new v.a;let ua=!0;ca.forEach(ra=>{if(!ra)return a.a.instance.shipAssertTag(4740611,1,!1,"Mapping is null."),Y.logger.Pg(Object.assign(new B,{lj:"OutlineElementCollectionsThreewayChildMerge",eventId:"asfyd"})),ua=!1;if(1===ra.HIm&&1===ra.xzf){const ha=ra.Nvb.J(0),ia=ra.E8e.J(0),va=ra.dmb.J(0);if(ha&&ha.equals(ia)&&ha.equals(va))return da.add(ha),
!0;if(1!==ca.length)return a.a.instance.shipAssertTag(4030554,1,!1,"OutlineElementCollectionsThreewayChildMerge: A 1-1-1 mapping found which somehow contains differing objects. [Base: {0}] [Favored: {1}] [Unfavored: {2}] [Total Collections: {3}].",ha,ia,va,ca.length),Y.logger.Pg(Object.assign(new B,{lj:"OutlineElementCollectionsThreewayChildMerge",eventId:"apyb0"})),ua=!1}const qa=new k.a,ka=new v.a,la=new v.a,Ha=new v.a,wa=new v.a,Ca=new v.a,Ja=new v.a,bb=Y.runtime.lk;ra.Nvb.forEach(ha=>ua=this.yNf(Y,
ha,ia=>bb.J(ia),ka,wa,qa,"Base"));if(!ua)return a.a.instance.Wa(4285026,1,4,"OutlineElementCollectionsThreewayChildMerge: Failed to process base outlines."),Y.logger.Pg(Object.assign(new B,{lj:"OutlineElementCollectionsThreewayChildMerge",eventId:"aqwj8"})),!1;ra.E8e.forEach(ha=>ua=this.yNf(Y,ha,ia=>this.pwa.Zlb(ia,Y.runtime.Yt,bb),la,Ca,qa,"Favored"));if(!ua)return a.a.instance.Wa(4285027,1,4,"OutlineElementCollectionsThreewayChildMerge: Failed to process favored outlines."),Y.logger.Pg(Object.assign(new B,
{lj:"OutlineElementCollectionsThreewayChildMerge",eventId:"aqwj9"})),!1;ra.dmb.forEach(ha=>ua=this.yNf(Y,ha,ia=>this.pwa.Zlb(ia,Y.runtime.lq,bb),Ha,Ja,qa,"Unfavored"));if(!ua)return a.a.instance.Wa(4285056,1,4,"OutlineElementCollectionsThreewayChildMerge: Failed to process unfavored outlines."),Y.logger.Pg(Object.assign(new B,{lj:"OutlineElementCollectionsThreewayChildMerge",eventId:"aqwka"})),!1;Y.runtime.Qb&&Y.runtime.Qb.oBb(1000005)&&(Ca.length&&this.a7k(Ca,Y.runtime.Yt)?(this.y9g(Ca,Y,da,qa),
this.$qd(Y,qa,Ja)):this.y9g(Ja,Y,da,qa));if(ka.length){ra=null;if(!({Rm:ra}=this.V1m(Y,ka,la,Ha,ra)).returnValue||!ra)return ua=!1;ra.forEach(ha=>{0<ha.OVb.count&&Y.runtime.Rm.Z(ha.im.id,ha);da.add(qa.J(ha.im.id));return!0})}return!0});return ua?da:null}a7k(Y,ca){for(let da=0;da<Y.length;da++)if(ca.get(Y.lg(da).id))return!0;return!1}$qd(Y,ca,da){da.length&&(da.forEach(ua=>{Y.runtime.ffc.add(ua.id);Y.runtime.ffc.add(ca.J(ua.id));return!0}),K.a.$qd(Y,this.$d,da.J(0)))}y9g(Y,ca,da,ua){Y.forEach(ra=>
{const qa=new P.a(ra.HG());ca.runtime.Rm.Z(ra.id,qa);da.add(ua.J(ra.id));return!0})}yNf(Y,ca,da,ua,ra,qa,ka){var la=da(ca);if(!la)return a.a.instance.Wa(4285057,1,1,"ProcessOutlineElement {0}: Failed to find OutlineElement with [Id: {1}]",ka,ca),Y.logger.Pg(Object.assign(new B,{lj:"ProcessOutlineElement",eventId:"aqwkb",info:String.format("[Revision: {0}] Failed to find OutlineElement",ka)})),!1;const Ha=this.$d.getPropertyObjectIds(la,l.a.oL);if(!Ha||!Ha.length)return a.a.instance.Wa(4285058,1,1,
"ProcessOutlineElement {0}: OutlineElement [Id: {1}] has no children.",ka,ca),Y.logger.Pg(Object.assign(new B,{lj:"ProcessOutlineElement",eventId:"aqwkc",info:String.format("[Revision: {0}] OutlineElement has no children",ka)})),O.a(la,"ProcessOutlineElement_"+ka,1),!1;la=Ha.lg(0);da=da(la);if(!da)return a.a.instance.Wa(4285059,1,1,"ProcessOutlineElement {0}: Failed to find ParagraphNode with [Id: {1}] as a child of OutlineElement with [Id: {2}]",ka,la,ca),Y.logger.Pg(Object.assign(new B,{lj:"ProcessOutlineElement",
eventId:"aqwkd",info:String.format("[Revision: {0}] Failed to find correct ParagraphNode in OutlineElement",ka)})),!1;if((ka=this.$d.getPropertyString(da,e.a.zM))&&""!==ka&&Y.runtime.Qb&&(Y.runtime.Qb.Jjf(1000005),Y.runtime.Qb.oBb(1000005)))return ra.add(da),qa.add(la,ca),Y.runtime.JJa.add(la),!0;ua.add(da);qa.add(la,ca);Y.runtime.JJa.add(la);return!0}$Ph(Y){let ca,da;ca=this.$d.getPropertyObjectIds(Y.bE,l.a.qf);da=this.$d.getPropertyObjectIds(Y.X5,l.a.qf);Y=this.$d.getPropertyObjectIds(Y.zoa,l.a.qf);
return{Fsd:ca,eCd:da,mce:Y}}ylm(Y){if(!Y)return a.a.instance.Wa(51422868,1,2,"Feature Helper is null"),!1;Y.Vq(110);return Y.isFeatureEnabled(110)}static LDi(Y,ca){ca.xb(Y.Qc)||ca.Z(Y.Qc,new v.a);ca.J(Y.Qc).add(Y);return!0}}X.FZd=u.a.Of("{4215CA2B-DF37-4aaa-89ED-F1646178CD20}{1}");Object(C.a)(X,"ChildNodeListMerge",null,[1777])},1703:function(C,N,d){C=d(0);var l=d(1474),e=d(1583),a=d(1519),k=d(1492),n=d(1534);class v{constructor(Y,ca){this.DimensionValue=this.DimensionName=null;this.DimensionName=
Y;this.DimensionValue=ca}}Object(C.a)(v,"Dimension",null,[]);class u{constructor(Y,ca,da,ua,ra){this.Query=this.EntityType=null;this.Size=this.From=0;this.Filter=null;this.EntityType=Y;this.Query=ca;this.From=da;this.Size=ua;ra&&(this.Filter=ra)}}Object(C.a)(u,"EntityRequest",null,[]);class t{constructor(Y){this.QueryString=null;this.QueryString=Y}}Object(C.a)(t,"Query",null,[]);var y=d(1475);class B{constructor(Y,ca){this.Dimensions=this.Name=null;this.Name=Y;this.Dimensions=ca}}Object(C.a)(B,"Scenario",
null,[]);var G=d(1478),F=d(1477);class K{constructor(Y,ca,da,ua){this.Scenario=this.Cvid=this.TimeZone=this.EntityRequests=null;this.EntityRequests=Y;this.TimeZone=ca;this.Cvid=da;this.Scenario=ua}}Object(C.a)(K,"SubstrateBody",null,[]);var O=d(1533),H=d(1471),I=d(1470),J=d(2),L=d(1647),S=d(1646),E=d(1530),P=d(35),T=d(16),U=d(121);d.d(N,"a",function(){return X});class X{constructor(Y){this.Msc=this.B9a=this.Igd=this.wnc=this.ztc=0;this.bSg=this.OVg=this.aP=null;this.Vqb=0;this.u0=-1;this.hwc="";this.rg=
J.AFrameworkApplication.Xe;this.qc=Y;this.Wmd=this.bif();this.hGe=new e.a;this.nQg=this.qc.Abe?3:2;this.G2g=this.qc.Abe&&this.qc.b5i?5:3;this.k6g=this.qc.j8d?2:3;this.l6g=1;this.Ofd=this.qc.jVh;this.$0g=this.qc.Kkm;this.zuc=Y.jZh;J.AFrameworkApplication.K&&(this.OVg=J.AFrameworkApplication.K.lb("AppCatalogUrl")+J.AFrameworkApplication.K.lb("SearchPersonaPhotoBaseUrl"))}FL(){return"Substrate"}FW(){return 0===this.qc.Kv?0:1===this.qc.Kv?1:3}DI(Y,ca,da,ua=l.a.tellMe,ra=null){const qa=new F.a(Y);if(!ra||
Array.contains(ra,14)||Array.contains(ra,15)||Array.contains(ra,20))if(!this.Vqb||window.performance.now()-this.Vqb>=I.a.ibe)if(da=this.hGe.NZh())this.Vqb=window.performance.now(),da.then(ka=>{ka&&""!==ka?(this.hwc=ka,""!==this.aP&&this.MZh(Y,ua,this.hwc,ca,ra)):(H.TellMeActor.instance.Ze.onError("SubstrateResultsProvider:IssueQuery","Empty or null token returned"),ca.resultsUpdated(qa))},ka=>{H.TellMeActor.instance.Ze.onError("SubstrateResultsProvider:IssueQuery","SubstrateTokenPromise rejected "+
ka);ca.resultsUpdated(qa)});else{if(H.TellMeActor.instance.Ze)H.TellMeActor.instance.Ze.onError("SubstrateResultsProvider:IssueQuery","undefined token promise");ca.resultsUpdated(qa)}else this.hwc&&""!==this.hwc?this.MZh(Y,ua,this.hwc,ca,ra):(ca.resultsUpdated(qa),H.TellMeActor.instance.Ze.onError("SubstrateResultsProvider:IssueQuery","Not able to acquire token"));else ca.resultsUpdated(qa)}zcc(){this.B9a=this.Msc=this.Igd=this.wnc=this.ztc=0}MZh(Y,ca,da,ua,ra){this.zcc();const qa=new F.a(Y),ka=this.aP=
U.a.create().toString();this.wza();this.u0=window.setTimeout(()=>{if(ka===this.aP){this.aP="";this.u0=-1;ua.resultsUpdated(qa);const wa={};wa[a.a.provider]=this.FL();wa[a.a.MHb]=Y.jjb;H.TellMeActor.instance.Ze.WB(k.a.timedOut,this.zuc,wa)}},this.zuc);const la={"Content-Type":"application/json",Accept:"application/json"};la.Authorization="Bearer "+da;la["X-Office-Version"]=J.AFrameworkApplication.buildVersion;la["X-Office-Application"]=J.AFrameworkApplication.K.lb("Application");la["X-Office-Platform"]=
"WAC";la["X-TellMe-SessionId"]=H.TellMeActor.instance.AId();la["X-TellMe-Culture"]=J.AFrameworkApplication.uiCulture;la["X-TellMe-ProcessSessionId"]=J.AFrameworkApplication.userSessionId;la["Client-Request-Id"]=ka;const Ha=window.performance.now();this.rg.Lj(this.yKl(),2,this.zKl(Y.Fg,this.qc.application,H.TellMeActor.instance.AId(),I.a.ZW(Y)),la,!1,0,wa=>{this.BGb(wa,Y,ua,ka,Ha,ca,ra)},wa=>{this.nGb(wa,Y,ua,ka,Ha)},null,null,!1,4E3,6E3)}wza(){-1!==this.u0&&(window.clearTimeout(this.u0),this.u0=-1)}BGb(Y,
ca,da,ua,ra,qa,ka){H.TellMeActor.instance.Ze.V6(ca.Fg.length,this.Wmd.join(","),Y.data.wf.toString(),Math.round(window.performance.now()-ra),O.a.substrate,!0,n.a.YLa);const la=I.a.ZW(ca),Ha=new F.a(ca);if(ua===this.aP){this.wza();Y=P.b(Y.data.Ge);if(Y.Groups){Y=Y.Groups;for(const wa of Y)"People"===wa.Type&&this.qc.$1c&&(ka?Array.contains(ka,14):1)?(Y=this.uWh(wa.Suggestions,la,qa),0<Y.results.length&&Ha.iw(Y)):"File"===wa.Type&&this.qc.Y1c&&(ka?Array.contains(ka,15):1)?(Y=this.CQh(wa.Suggestions,
la,qa),0<Y.results.length&&Ha.iw(Y)):"Notes"===wa.Type&&this.qc.Bgb&&qa!==l.a.contextMenu&&(ka?Array.contains(ka,20):1)&&(Y=this.fVh(wa.Suggestions,la,ca),0<Y.results.length&&Ha.iw(Y))}da.resultsUpdated(Ha);H.TellMeActor.instance.Ze.V6(ca.Fg.length,this.Wmd.join(","),"",Math.round(window.performance.now()-ra),"",!0,n.a.provider)}else da.resultsUpdated(Ha)}fVh(Y,ca,da){const ua=new G.a(20);ua.displayName=CommonUIStrings.l_TellMeNotesProviderTitle;for(const ra of Y)this.cnm(ra)&&(Y=ra.NotesType,Y=T.a.mh(Y),
Y=this.$Al(Y,ra.LastModifiedTime,ra.BodyPreview,ra.Subject,ca,da,ra))&&(Y.groupType=20,ua.yz(Y));return ua}uWh(Y,ca,da){const ua=new G.a(14);ua.displayName=CommonUIStrings.l_TellMePeopleProviderTitle;for(const qa of Y)if(this.dnm(qa)){var ra=qa.Id.split("@")[0];Y=qa.EmailAddresses[0];let ka=qa.Type;if(void 0===ka||null===ka)ka="User";if(ra=this.UDl(ka,qa.DisplayName,qa.JobTitle,Y,ra,da,ca))ra.description=Y,Y=qa.JobTitle,"Department"in qa&&"CompanyName"in qa&&(Y+="@"+qa.Department+"@"+qa.CompanyName),
ra.UH=Y,ua.yz(ra)}return ua}CQh(Y,ca,da){const ua=new G.a(15);ua.displayName=CommonUIStrings.l_TellMeFileProviderTitle;for(const ka of Y)if(this.Tmm(ka)){var ra=ka.FileName;Y=ka.FileExtension;const la=ra.length>Y.length?ra.substr(0,ra.length-Y.length-1):ka.Title;var qa=void 0;Y=0;"DateCreated"in ka?(Y=I.a.Kif(ka.DateCreated),qa=I.a.a0h(ka.DateCreated),qa=String.format(CommonUIStrings.l_CreatedTimeFormatString,ka.Author,qa)):qa=ka.Author;const Ha=ka.AccessUrl+"?web=1",wa=T.a.sLc(Ha);ra=String.format('<a href="{0}">{1}</a>',
wa,T.a.BZ(ra));if(da!==l.a.contextMenu||T.a.aX(Ha))if(ra=this.Mrl(la,da===l.a.contextMenu?ra:Ha,qa,ka.FileExtension,ka.Text,ca))ra.description=ka.Author,ra.zrd=Y,ua.yz(ra)}return ua}nGb(Y,ca,da,ua,ra){ua===this.aP&&(this.wza(),H.TellMeActor.instance.Ze.V6(ca.Fg.length,this.Wmd.join(","),Y.data.wf.toString(),Math.round(window.performance.now()-ra),O.a.substrate,!1,n.a.YLa));Y=new F.a(ca);da.resultsUpdated(Y)}UDl(Y,ca,da,ua,ra,qa,ka){ka=ka?this.l6g:this.nQg;if(!window.LPC&&!I.a.cqf()||this.ztc===ka)return null;
this.ztc+=1;ka="PeopleSuggestion"+this.ztc.toString();var la=this.OVg+"?size=1&accountName="+ua;Y=Object.assign(new L.a,{PersonaType:Y,Smtp:ua,ProfilePictureUrl:la,AadObjectId:ra});const Ha=Object.assign(new S.a,{identifiers:Y,displayName:ca});Y=qa===l.a.contextMenu;this.qc.qBa?(H.TellMeActor.instance.actions.push(appChrome.actions.setPersonaButtonCoauthor(ka,Ha,ca,da)),qa===l.a.contextMenu&&(da=I.a.mvh(ca,ua,ra),H.TellMeActor.instance.actions.push(appChrome.actions.setButtonCommandValueId(ka,da))),
H.TellMeActor.instance.actions.push(appChrome.actions.updatePersonaButtonLPCEnabledDisabledState(ka,Y))):(la=[],la.push(appChrome.actions.setPersonaButtonCoauthor(ka,Ha,ca,da)),qa===l.a.contextMenu&&(da=I.a.mvh(ca,ua,ra),la.push(appChrome.actions.setButtonCommandValueId(ka,da))),la.push(appChrome.actions.updatePersonaButtonLPCEnabledDisabledState(ka,Y)),appChrome.api.dispatch(la));return new y.a(ka,11,ca,ua,0)}$Al(Y,ca,da,ua,ra,qa,ka){if(ra&&!this.qc.hii||this.Igd===this.Ofd||this.Msc===this.Ofd||
this.B9a===this.Ofd)return null;var la=null;this.Igd+=1;ra="";const Ha=[],wa={};ka.type="Notes";this.bSg=Object.assign(new E.a,{landingTab:"Notes",data:ka});qa=I.a.MWa(qa.Fg,33,this.bSg);if("onenotepagepreviews"===Y){if(!("ClickthroughUrl"in ka&&ka.ClickthroughUrl)||""===ka.ClickthroughUrl)return null;this.Msc+=1;ra="OnenoteNotesSuggestion"+this.Msc.toString();wa["default"]="SaveAsonetoc2_20";la=ka.ClickthroughUrl;Ha.push(appChrome.actions.setControlIconSet(ra,wa));Ha.push(appChrome.actions.setCompoundButtonCommandValueId(ra,
la));la=new y.a(ra,19,null,null,0)}else if("stickynote"===Y){if(!this.$0g)return null;this.B9a+=1;ra="NotesSuggestion"+this.B9a.toString();wa["default"]="ShowAllNotes_20";Ha.push(appChrome.actions.setControlIconSet(ra,wa));Ha.push(appChrome.actions.setCompoundButtonCommandValueId(ra,qa));la=new y.a(ra,21,null,null,0)}else if("samsung"===Y){if(!this.$0g)return null;this.B9a+=1;ra="NotesSuggestion"+this.B9a.toString();wa["default"]="CategoryCollapsed_20";Ha.push(appChrome.actions.setControlIconSet(ra,
wa));Ha.push(appChrome.actions.setCompoundButtonCommandValueId(ra,qa));la=new y.a(ra,20,null,null,0)}""!==ra&&(Y=I.a.a0h(ca),Y=String.format(CommonUIStrings.l_LastModifiedString,Y),la.label=ua,la.zrd=I.a.Kif(ca),Ha.push(appChrome.actions.setControlLabel(ra,ua)),Ha.push(appChrome.actions.updateCompoundButtonDescription(ra,Y)),Ha.push(appChrome.actions.setControlCustomTooltip(ra,da)),appChrome.api.dispatch(Ha));return la}Mrl(Y,ca,da,ua,ra,qa){if(this.wnc===(qa?this.k6g:this.G2g))return null;this.wnc+=
1;qa="FileSuggestion"+this.wnc.toString();const ka=[],la={};la["default"]=I.a.Rul(ua);this.qc.qBa?(H.TellMeActor.instance.actions.push(appChrome.actions.setControlLabel(qa,Y)),H.TellMeActor.instance.actions.push(appChrome.actions.setControlIconSet(qa,la)),H.TellMeActor.instance.actions.push(appChrome.actions.updateCompoundButtonDescription(qa,da)),H.TellMeActor.instance.actions.push(appChrome.actions.setCompoundButtonCommandValueId(qa,ca)),H.TellMeActor.instance.actions.push(appChrome.actions.setControlCustomTooltip(qa,
ra))):(ka.push(appChrome.actions.setControlLabel(qa,Y)),ka.push(appChrome.actions.setControlIconSet(qa,la)),ka.push(appChrome.actions.updateCompoundButtonDescription(qa,da)),ka.push(appChrome.actions.setCompoundButtonCommandValueId(qa,ca)),ka.push(appChrome.actions.setControlCustomTooltip(qa,ra)),appChrome.api.dispatch(ka));return new y.a(qa,6,Y,da,0)}bif(){const Y=[];this.qc.$1c&&Array.add(Y,"People");this.qc.Y1c&&Array.add(Y,"File");this.qc.Bgb&&Array.add(Y,"Notes");return Y}zKl(Y,ca,da,ua){var ra=
new t(Y);Y=new u("File",ra,0,ua?this.k6g:this.G2g,null);ua=new u("People",ra,0,ua?this.l6g:this.nQg,I.a.P3m);ra=new u("Notes",ra,0,this.Ofd,null);ca=new v("app",ca.toLowerCase());var qa=[];Array.add(qa,ca);ca=new B("tellmesearch",qa);qa=[];this.qc.Y1c&&Array.add(qa,Y);this.qc.$1c&&Array.add(qa,ua);this.qc.Bgb&&Array.add(qa,ra);da=new K(qa,"UTC",da,ca);return P.c(da)}yKl(){let Y=this.qc.V3n;this.qc.Bgb&&(Y+="?&setflight=NotesFrom3S");""!==this.qc.OZh&&(Y=Y+"&"+this.qc.OZh);return Y}dnm(Y){return"DisplayName"in
Y&&"Id"in Y&&"EmailAddresses"in Y&&!!Y.Id&&!!Y.EmailAddresses}Tmm(Y){return"FileExtension"in Y&&!!Y.FileExtension&&"FileName"in Y&&!!Y.FileName&&""!==Y.FileName&&"AccessUrl"in Y&&!!Y.AccessUrl&&""!==Y.AccessUrl}cnm(Y){return"Id"in Y&&!!Y.Id&&"NotesType"in Y&&!!Y.NotesType&&"Subject"in Y&&!!Y.Subject&&""!==Y.Subject}}Object(C.a)(X,"SubstrateResultsProvider",null,[1098])},1704:function(C,N,d){C=d(0);var l=d(47),e=d(5),a=d(17),k=d(150),n=d(83),v=d(148),u=d(216),t=d(619),y=d(59),B=d(387),G=d(2),F=d(1430),
K=d(753);class O{constructor(ka,la=0){this.S_e=null;this.MKf=0;this.ZL=ka;this.AHm=la}}Object(C.a)(O,"GraphMergerResponse",null,[]);var H=d(44),I=d(1),J=d(161),L=d(709),S=d(1506),E=d(1550);class P extends E.a{constructor(){super();this.v7i=null;this.Alj=!1}get hea(){return"Crash"}fAb(){this.detail.Z("Type",this.hea);this.detail.Z("Trace",this.obo(this.v7i));this.detail.Z("Continue",this.Alj);return this.detail}obo(ka){ka=ka.split("\n");const la=4<ka.length?4:ka.length,Ha=new Sys.StringBuilder;for(let wa=
0;wa<la;wa++)wa===la-1?Ha.append(String.format("{0}...",ka[wa])):Ha.append(String.format("{0}\n",ka[wa]));return Ha.toString()}}Object(C.a)(P,"CrashMergeFailureDetail",E.a,[]);var T=d(1848),U=d(1522),X=d(1598),Y=d(1507);class ca{constructor(){this.ajk=new B.a;this.YAk=new B.a;this.iEk=new B.a}}Object(C.a)(ca,"RangeMarkers",null,[]);class da{constructor(){this.colSpan=this.rowSpan=null;this.qg=!1;this.Uqe=new u.a;this.Xze=new u.a;this.pAe=new u.a}get vjf(){return this.Uqe.x3()}set vjf(ka){ka||(this.Uqe=
new u.a);this.Uqe=ka.x3()}get bEf(){return this.Xze.x3()}set bEf(ka){ka||(this.Xze=new u.a);this.Xze=ka.x3()}get rWd(){return this.pAe.x3()}set rWd(ka){ka||(this.pAe=new u.a);this.pAe=ka.x3()}}Object(C.a)(da,"TableCellStructureInfo",null,[]);var ua=d(1553),ra=d(1590);d.d(N,"a",function(){return qa});class qa{constructor(){this.lJd=0;this.yGg=this.j7a=this.BSb=this.Lg=this.NYg=this.cUb=null;this.lQg=0;this.bNg=50;this.aEg=this.Pxg=null}get OSi(){return this.cUb}get rzn(){return this.NYg}get $d(){return this.Lg}get whb(){return this.BSb}get h2h(){return this.j7a}get YQl(){return this.yGg}get u9b(){return this.lQg}get lmh(){return this.Pxg}get SFc(){return this.aEg}A9b(ka,
la,Ha,wa,Ca,Ja,bb){Ha=this.mLk(ka,la,wa,Ca,Ja,bb,this.SFc);wa=0;const ha=Ha.runtime.n8d;let ia=null;try{this.Wym(ha,Ha,bb,ka,la,Ca,Ja);for(ka=1;wa<this.whb.length;wa++)if(!(0,this.whb[wa])(Ha)){ka=2;Ha.logger.sTd("GraphMerger.GetMergeFunctions()",wa);break}return ia=new O(Ha.output.ZL,ka)}catch(va){const Ka=!Ha.output.timeout;Ha.output.crash=Ka;const Xa=this.zFd(va),xa=String.format("Merge {0}! [MergeId: {1}] Failing the merge. [Will continue: {2}] [{3}]",Ka?"Crashed":"Timed Out",Ha.input.uFb,!!Ha.output.ZL,
Xa);Ka?(k.a.instance.Wa(4051608,1,1,"MergeChanges Crash. [Error: {0}]",xa),Ha.logger.Pg(Object.assign(new P,{v7i:Xa,Alj:!!Ha.output.ZL}))):k.a.instance.Wa(4993346,1,2,"MergeChanges Timeout. [Error: {0}]",xa);if(Ha.output.ZL)return ia=new O(Ha.output.ZL,2);throw va;}finally{Ha.output.succeeded?this.Tym(ha,Ha,wa):Ha.output.timeout?this.Vym(Ha,wa):Ha.output.crash?Ha.output.ZL?this.Uym(Ha,wa):this.Sym(Ha,wa):this.Rym(Ha,wa);Ha.logger.Qym();k.a.instance.nha(42350232,1,Ha.output.succeeded?4:2,"MergeLogger",
Ha.logger.Zyl());Ha.logger.KRc.V3h()&&k.a.instance.nha(559015903,1,2,"MarkerInfo",Ha.logger.KRc.toString());if(Ha.runtime.Qb&&Ha.runtime.Qb.isFeatureEnabled(75))try{this.Kvm(Ha)}catch(va){k.a.instance.Wa(571619421,1,4,"Error logging references: {0}",va.toString())}this.AAm(Ha);ia.MKf|=(Ha.output.succeeded?2:1)<<2*(bb-1);if(ia)try{ia.S_e=this.o7m(Ha)}catch(va){k.a.instance.shipAssertTag(51663492,1,!1,"Failed to create merge report {0}",va)}}}AAm(ka){if(!ka.output.succeeded){ka=ka.output.timeout?"Timeout":
ka.logger.VHi?ka.logger.VHi.hea:"Unknown";const la=new J.a;n.Health.instance.recordQosError(ka,["MergeFailure"],!0,!0,!1,!1,la)}}Kvm(ka){const la=Ca=>{const Ja=this.TAa()-ka.input.QPa>this.u9b;if(0<this.u9b&&Ja)throw k.a.instance.Wa(571619422,1,2,"Timed out while calculating added and deleted nodes: {0}",Ca),v.a.invalidOperation(Ca);};let Ha=ka.runtime.Yt.keys,wa=Ca=>ka.runtime.Yt.J(Ca);this.nxf(ka,la,Ha,wa,"Favored");Ha=ka.runtime.lq.keys;wa=Ca=>ka.runtime.lq.J(Ca);this.nxf(ka,la,Ha,wa,"Unfavored");
Ha=ka.runtime.Rm.keys;wa=Ca=>{const Ja=ka.runtime.Rm.J(Ca);return Ja?Ja.im:ka.runtime.Yt.J(Ca)};this.nxf(ka,la,Ha,wa,"Merged")}nxf(ka,la,Ha,wa,Ca){var Ja=new u.a;const bb=new u.a;for(let ha=0;ha<Ha.length;ha++){la("LogAddedAndDeletedNodes");const ia=wa(Ha.J(ha));if(4325465===ia.Qc)continue;const va=ka.runtime.lk.J(ia.id);va&&this.Lvm(Ja,bb,ia,va)}this.Xmi(bb,ha=>ka.runtime.lk.J(ha),la);this.Xmi(Ja,wa,la);la=new Sys.StringBuilder;for(Ha=0;Ha<Ja.length;Ha++)la.append(Ja.J(Ha).toString()+",");Ja=new Sys.StringBuilder;
for(Ha=0;Ha<bb.length;Ha++)Ja.append(bb.J(Ha).toString()+",");k.a.instance.nha(571619423,1,4,Ca+" revision: Added references",la.toString());k.a.instance.nha(571619424,1,4,Ca+" revision: Deleted references",Ja.toString())}Lvm(ka,la,Ha,wa){const Ca=Ha.Mj();for(let bb=0;bb<Ca.length;bb++){const ha=Ca[bb];if(this.fai(ha)){var Ja=this.$d.getPropertyObjectIds(Ha,ha);this.Mxm(ka,la,wa,ha,Ja)}else this.ifi(ha)&&(Ja=this.$d.getPropertyObjectId(Ha,ha),this.Lxm(ka,la,wa,ha,Ja))}}Xmi(ka,la,Ha){Ha("LogNestedReferences");
Ha=new u.a;const wa=new t.a;for(let Ca=0;Ca<ka.length;Ca++){const Ja=ka.J(Ca);this.Oxf(Ja,Ha,wa,la)}for(la=0;la<Ha.length;la++)ka.add(Ha.J(la))}Oxf(ka,la,Ha,wa){const Ca=wa(ka);if(Ca){const bb=Ca.Mj();for(let ha=0;ha<bb.length;ha++){var Ja=bb[ha];if(this.fai(Ja)){Ja=this.$d.getPropertyObjectIds(Ca,Ja);for(let ia=0;ia<Ja.length;ia++)Ha.contains(Ja.J(ia))||(la.add(Ja.J(ia)),Ha.add(Ja.J(ia)),this.Oxf(Ja.J(ia),la,Ha,wa))}else this.ifi(Ja)&&(Ja=this.$d.getPropertyObjectId(Ca,Ja),Ha.contains(Ja)||(la.add(Ja),
Ha.add(Ja),this.Oxf(ka,la,Ha,wa)))}}}Mxm(ka,la,Ha,wa,Ca){if(this.$d.hasProperty(Ha,wa)){Ha=this.$d.getPropertyObjectIds(Ha,wa);const Ja=Ha.cG();wa=Ca.cG();for(let bb=0;bb<Ca.length;bb++)Ja.contains(Ca.J(bb))||ka.add(Ca.J(bb));for(ka=0;ka<Ha.length;ka++)wa.contains(Ha.J(ka))||la.add(Ha.J(ka))}else for(la=0;la<Ca.length;la++)ka.add(Ca.J(la))}Lxm(ka,la,Ha,wa,Ca){Ca&&(this.$d.hasProperty(Ha,wa)?(Ha=this.$d.getPropertyObjectId(Ha,wa),Ca.equals(Ha)||(ka.add(Ca),la.add(Ha))):ka.add(Ca))}Pym(ka){k.a.instance.Wa(4535064,
1,4,"Sending merge backup. [MergeId: {0}] [Crash: {1}] [Timeout: {2}]",ka.input.uFb,ka.output.crash,ka.output.timeout)}Wym(ka,la,Ha,wa,Ca,Ja,bb){if(ka){ka=wa.length?wa.lg(wa.length-1):null;var ha=Ca.length?Ca.lg(Ca.length-1):null;Ha=String.format("MergeChanges: Begin. [MergeId: {0}] [TheirChanges - Length:{1} Last:{2} Base:{3}] [YourChanges - Length:{4} Last:{5} Base:{6}] [MergeHint: {7}] [IgnoreConflictsInLastServerRevision: {8}] [MaxMergeTimeInMs: {9}] [Source: {10}]",la.input.uFb,wa.length,ka?
ka.id:y.a.nil,ka?ka.z1?ka.z1.id:y.a.nil:y.a.nil,Ca.length,ha?ha.id:y.a.nil,ha?ha.z1?ha.z1.id:y.a.nil:y.a.nil,Ja,bb,this.u9b,Ha);switch(la.input.source){case 5:k.a.instance.Wa(51663493,1,4,Ha);break;default:k.a.instance.Wa(4051606,1,4,Ha)}}}Tym(ka,la,Ha){if(ka)switch(ka=this.ZHc(la,Ha,"Succeeded"),la.input.source){case 5:k.a.instance.Wa(51663494,1,4,ka);break;default:k.a.instance.Wa(4059162,1,4,ka)}}Vym(ka,la){la=this.ZHc(ka,la,"Timeout");switch(ka.input.source){case 5:k.a.instance.Wa(51663495,1,4,
la);break;default:k.a.instance.Wa(4059163,1,2,la)}}Rym(ka,la){la=this.ZHc(ka,la,"Rejection");switch(ka.input.source){case 5:k.a.instance.Wa(51663496,1,4,la);break;default:k.a.instance.Wa(4059164,1,2,la)}}Uym(ka,la){la=this.ZHc(ka,la,"Crash - Rejection");switch(ka.input.source){case 5:k.a.instance.Wa(51663497,1,4,la);break;default:k.a.instance.Wa(4059165,1,2,la)}}Sym(ka,la){la=this.ZHc(ka,la,"Crash - Failed");switch(ka.input.source){case 5:k.a.instance.Wa(51663498,1,4,la);break;default:k.a.instance.Wa(4059166,
1,2,la)}}ZHc(ka,la,Ha){const wa=ka.output.ZL,Ca=wa&&wa.length?wa.lg(wa.length-1):null;return String.format("MergeChanges: End for [MergeId: {0}] with result {1}. [ElapsedTime: {2}ms] [Function: {3}] [MergedRevisions - Length:{4} Last:{5} Base:{6}] [Source: {7}]",ka.input.uFb,Ha,this.TAa()-ka.input.QPa,la,wa?wa.length:0,Ca?Ca.id:y.a.nil,Ca?Ca.z1?Ca.z1.id:y.a.nil:y.a.nil,ka.input.source)}mLk(ka,la,Ha,wa,Ca,Ja,bb){const ha=new T.a,ia=ha.input;ia.G3=ka;ia.zwa=la;ia.Zl=Ha;ia.P2=wa;ia.X4b=Ca;ia.source=
Ja;ia.SFc=bb;ia.QPa=this.TAa();ha.logger.TOn(ia.QPa);ka=ha.runtime;ka.q0c=k.a.instance.A7(1,5);ka.n8d=k.a.instance.A7(1,4);let va="";ka.bG=Ka=>{if(this.u9b){var Xa=this.TAa()-ia.QPa,xa=Xa>this.u9b;va+=String.format(" ({0}: {1})",Ka,Xa);xa&&(ha.output.timeout=!0,Ka=String.format("[MergeId: {0}] Exceeded [MaxMergeTimeInMs: {1}] when we reached [Details: {2}] [Elapsed Time: {3}] [Timeline: {4}]",ia.uFb,this.u9b,Ka,Xa,va),k.a.instance.Wa(528061012,1,2,Ka),this.v8n(Ka))}};return ha}KIc(){return[Object(H.a)(this,
this.z_m,"otherAuthorsHaveChangesToMerge"),Object(H.a)(this,this.Uem,"isInputValid"),Object(H.a)(this,this.I3l,"initializeOutputMergeState"),Object(H.a)(this,this.sMd,"initializeRuntimeMergeState"),X.a.Y6m,Object(H.a)(this,this.X6m,"preProcessTableStructure"),Object(H.a)(this.lmh,this.lmh.eHm,"mergeChildNodeLists"),Object(H.a)(this,this.Kco,"tryObjectMerge"),X.a.G6m,Object(H.a)(this,this.M8k,"finalizeObjectMerge"),Object(H.a)(this,this.xpo,"validateMarkers"),Object(H.a)(this,this.q3j,"addMergeResultsToOutput")]}z_m(ka){const la=
ka.input.G3;ka=ka.output;return la?la.length?!0:(k.a.instance.Wa(4051610,1,5,"OtherAuthorsHaveChangesToMerge: Received an empty list of changes to merge."),ka.ZL=la,ka.succeeded=!0,!1):(k.a.instance.Wa(4051609,1,5,"OtherAuthorsHaveChangesToMerge: Didn't receive any changes to merge."),ka.ZL=la,ka.succeeded=!0,!1)}Uem(ka){var la=ka.input;const Ha=la.G3,wa=la.zwa,Ca=la.Zl,Ja=la.P2;la=la.X4b;ka=ka.output;if(!wa||!wa.length)return k.a.instance.Wa(42350233,1,5,"IsInputValid: No local changes to merge."),
ka.ZL=Ha,ka.succeeded=!0,!1;let bb=!0;if(2!==Ja&&1!==Ja)return ka.ZL=Ha,!1;Ca&&Ca!==y.a.nil||(bb=!1);Ha.length<(la?2:1)&&(k.a.instance.Wa(4051614,1,5,"IsInputValid: Too few revisions. This will happen if the server failed its merge and rejected your change.  [ignoreConflictsInLastServerRevision: {0}]",la),bb=!1);bb||(ka.ZL=2===Ja?Ha:wa);return bb}sMd(ka){var la=ka.input,Ha=la.G3,wa=la.zwa,Ca=la.P2,Ja;let bb;({$7n:Ja,rvo:bb,Dza:la}=this.$wl(ka,Ha,wa,la.X4b));if(!la)return k.a.instance.Wa(4273301,1,
2,"MergeChanges: Couldn't find a common base change. [TheirLastChange.Id: {0}] [YourLastChange.Id: {1}]",Ja.id,bb.id),ka.logger.Pg(Object.assign(new S.a,{lj:"InitializeRuntimeMergeState",eventId:"aqtsv",info:"Couldn't find a common base change"})),this.vni(Ja,Ha.length,"TheirChanges"),this.vni(bb,wa.length,"YourChanges"),ka.output.ZL=2===Ca?Ha:wa,!1;ka.runtime.Dza=la;({leo:Ha,b7k:wa}=this.sVk(Ca,Ja,bb));({meo:la,c7k:Ca,thk:Ja}=this.tzl(ka,Ha,wa,la));ka.runtime.lk=Ja;ka.runtime.lq=la;ka.runtime.Yt=
Ca;ka.runtime.Rm=new B.a;ka.runtime.fCd=wa.id;ka.runtime.nce=Ha.id;ka.runtime.Nhb=new B.a;ka.runtime.JJa=new t.a;ka.runtime.U2e=new B.a;ka.runtime.Qwb=new B.a;ka.runtime.Z3f=new B.a;ka.runtime.K2d=new ca;ka.runtime.MUd=new u.a;ka.runtime.gKf=new t.a;ka.runtime.ffc=new u.a;ka.runtime.Qb=ka.input.SFc(ka);ka.runtime.Qb.Yqd(1000001,"Microsoft.Office.WordOnline.WordTestCrossCompiledFeature","WoWor220;WoWor220cf",l.a.A7n);ka.runtime.Qb.Yqd(1000005,"Microsoft.Office.WordOnline.TOCMerge","Word-TOCMerge;Word-TOCMergecf",
l.a.v9n);ka.runtime.Qb.Yqd(1000008,"Microsoft.Office.WordOnline.FailOnMPALAsserts","69bca399;0362i899",l.a.L6k);ka.runtime.Qb.Yqd(1000009,"Microsoft.Office.WordOnline.RemoveEditedImageUrlFromIgnoredProperties","mergeeditedimageurl;mergeeditedimageurlcf",l.a.opn);ka.runtime.n8h=!0;G.AFrameworkApplication.K&&(this.bNg=G.AFrameworkApplication.K.rc("WordEditorGraphMergeMaxIterationsPerCycle",50));return!0}vni(ka,la,Ha){const wa=new u.a;for(;ka;)wa.add(ka),ka=ka.z1;const Ca=new Sys.StringBuilder;Ca.append(String.format("{0} [PartialChainLength: {1}] [FullChainLength: {2}]",
Ha,la,wa.length));let Ja=wa.length,bb=0;wa.forEach(ha=>({s6h:Ja,Wni:bb}=this.e5j(Ca,ha,wa,Ja,bb)).returnValue);k.a.instance.Wa(4273302,1,4,Ca.toString())}e5j(ka,la,Ha,wa,Ca){ka.append(String.format(" [{0} {1} {2}]",wa,la.Wta?"S":"B",la.id));wa--;Ca++;return 50<Ca&&Ha.length!==Ca?(ka.append(" ...Truncated."),{returnValue:!1,s6h:wa,Wni:Ca}):{returnValue:!0,s6h:wa,Wni:Ca}}$wl(ka,la,Ha,wa){la=la.lg(la.length-1-(wa?1:0));Ha=Ha.lg(Ha.length-1);wa=la.wdb(Ha);ka.runtime.bG("GetCommonBase");ka.logger.yfa("GetCommonBase");
return{$7n:la,rvo:Ha,Dza:wa}}tzl(ka,la,Ha,wa){let Ca,Ja;({result:Ca}=la.B9b(wa));ka.runtime.bG("GetUnfavoredChanges");ka.logger.yfa("GetUnfavoredChanges");({result:Ja}=Ha.B9b(wa));5===ka.input.source&&(ka.runtime.f7k=L.a.RXh(Ha),ka.runtime.oeo=L.a.RXh(la));ka.runtime.bG("GetFavoredChanges");ka.logger.yfa("GetFavoredChanges");la=new F.a(Object(H.a)(wa,wa.AYa,"getMergeableObject"));ka.runtime.bG("GetModifiedObjects");ka.logger.yfa("GetModifiedObjects");return{meo:Ca,c7k:Ja,thk:la}}sVk(ka,la,Ha){2===
ka?(ka=la,la=Ha):ka=Ha;return{leo:la,b7k:ka}}I3l(ka){const la=ka.input,Ha=la.G3,wa=la.zwa;ka.output.ZL=(2===la.P2?Ha:wa).x3();ka.runtime.bG("InitializeOutputMergeState");ka.logger.yfa("InitializeOutputMergeState");return!0}q3j(ka){var la=ka.input.Zl;const Ha=ka.runtime.Rm,wa=ka.output.ZL;la=this.nLk(ka,wa.lg(wa.length-1),la,y.a.create());this.m8k(ka,la,Ha);wa.add(la);return ka.output.succeeded=!0}nLk(ka,la,Ha,wa){ka.runtime.n8d&&k.a.instance.Wa(4051616,1,4,"AddMergeRevisionToList: Creating mergeRevision with [objectSpaceId: {0}] [revisionId: {1}].",
Ha,wa);ka=this.rzn(wa);ka.Rhk(la,Ha);return ka}m8k(ka,la,Ha){ka.runtime.n8d&&k.a.instance.Wa(4059167,1,4,"FillRevision: Adding {0} objects to merged revision.",Ha.count);Ha.forEach((wa,Ca)=>{la.H4j(Ca.im);return!0})}SDb(ka){if(!ka)return k.a.instance.Wa(573957952,1,2,"Feature helper is null"),!1;ka.Vq(111);return ka.isFeatureEnabled(111)}X6m(ka){if(!this.SDb(ka.runtime.Qb))return!0;const la=ka.runtime.Yt,Ha=ka.runtime.lq,wa=ka.runtime.lk;let Ca=!0;la.forEach((Ja,bb)=>{393252===bb.Qc&&(Ca=this.MFi(ka,
Ja,bb,wa,la));return Ca});if(!Ca)return!1;Ha.forEach((Ja,bb)=>{393252===bb.Qc&&(Ca=this.MFi(ka,Ja,bb,wa,Ha));return Ca});ka.logger.yfa("PreProcessTableStructure");return Ca}MFi(ka,la,Ha,wa,Ca){const Ja=null==this.$d.getPropertyBool(Ha,e.a.ghostCell)?!1:this.$d.getPropertyBool(Ha,e.a.ghostCell),bb=null==this.$d.getPropertyUint32(Ha,e.a.rowSpan)?1:this.$d.getPropertyUint32(Ha,e.a.rowSpan),ha=null==this.$d.getPropertyUint32(Ha,e.a.colSpan)?1:this.$d.getPropertyUint32(Ha,e.a.colSpan);if(Ja)return!0;var ia=
wa.J(la);if(ia){wa=null==this.$d.getPropertyBool(ia,e.a.ghostCell)?!1:this.$d.getPropertyBool(ia,e.a.ghostCell);var va=null==this.$d.getPropertyUint32(ia,e.a.rowSpan)?1:this.$d.getPropertyUint32(ia,e.a.rowSpan);var Ka=null==this.$d.getPropertyUint32(ia,e.a.colSpan)?1:this.$d.getPropertyUint32(ia,e.a.colSpan);wa=wa!==Ja;va=va!==bb;Ka=Ka!==ha}else Ka=va=wa=!0;const Xa=ra.e(ka,Ha,Ca);if(Xa.equals(y.a.nil))return k.a.instance.Wa(573957953,1,2,"Table cell's containing table node id could not be found. Table Cell ID: {0}",
la),ka.logger.Pg(Object.assign(new ua.a,{info:"Table Cell's containing table node ID could not be found"})),!1;let xa=ka.runtime.Qwb.J(Xa);xa||(ka.runtime.Qwb.Z(Xa,new B.a),xa=ka.runtime.Qwb.J(Xa));let Ma=xa.J(la),Na=new u.a;const pa=new u.a,Ra=new u.a;wa&&(Ma||(Na=this.$d.getPropertyObjectIds(Ha,a.a.qf)));if(va||Ka)if(Ma){if(Ma.qg)return k.a.instance.Wa(573957961,1,4,"Table cell has conflicting ghostcell properties we are not handling"),ka.logger.Pg(Object.assign(new ua.a,{info:"A table cell is ghost in one revision while non-ghost in another."})),
!1;if(null!=Ma.rowSpan&&bb!==Ma.rowSpan||null!=Ma.colSpan&&ha!==Ma.colSpan)return k.a.instance.Wa(573957962,1,4,"Same table cell has different rowSpan/colSpan in conflicting revisions"),ka.logger.Pg(Object.assign(new ua.a,{info:"A table cell has different rowSpan/colSpan in the conflicting revisions"})),!1}else{var Sa;({rowIndex:Ha,nZb:Sa}=ra.b(ka,Ca,Ha));if(-1===Ha||-1===Sa)return k.a.instance.Wa(573957954,1,2,"Table cell location could not be found. Table Cell ID: {0}",la),ka.logger.Pg(Object.assign(new ua.a,
{info:"Table cell location could not be found"})),!1;for(var ab=Ha;ab<Ha+bb;ab++)for(var eb=Sa;eb<Sa+ha;eb++){var zb=ra.c(ka,Xa,ab,eb);if(zb.equals(y.a.nil))return k.a.instance.Wa(573957955,1,4,"Other revision deleted the table cells this revision is trying to merge"),ka.logger.Pg(Object.assign(new ua.a,{info:"Ghost cell not found in the table bounds"})),!1;var Ua=Ca.Jy(zb,ka.runtime.lk.J(zb));if(!Ua)return k.a.instance.Wa(573957956,1,4,"Other revision has inserted cells in between the cells this revision is trying to merge"),
ka.logger.Pg(Object.assign(new ua.a,{info:"Newly inserted cell in another revision cannot be merged with the cell in current revision"})),!1;if(!zb.equals(la)){if(null==this.$d.getPropertyBool(Ua,e.a.ghostCell)||!this.$d.getPropertyBool(Ua,e.a.ghostCell))return k.a.instance.Wa(573957957,1,4,"Other revision deleted some of the cells this revision is trying to merge"),ka.logger.Pg(Object.assign(new ua.a,{info:"Cannot merge a non-ghost cell with the controlling cell"})),!1;var Ab=xa.J(zb);if(Ab)return k.a.instance.Wa(573957958,
1,4,"The ghost cell is already merged with some other cells in the other revision"),ka.logger.Pg(Object.assign(new ua.a,{info:"Ghost cell is already merged with some other cell"})),!1;pa.add(zb);Ab=new da;Ab.qg=!0;Ua=this.$d.getPropertyUint32(Ua,e.a.colSpan);null!=Ua&&(Ab.colSpan=Ua);xa.Z(zb,Ab)}}if(ia&&(null==this.$d.getPropertyBool(ia,e.a.ghostCell)||!this.$d.getPropertyBool(ia,e.a.ghostCell))&&(Ca=null==this.$d.getPropertyUint32(ia,e.a.rowSpan)?1:this.$d.getPropertyUint32(ia,e.a.rowSpan),Ha=null==
this.$d.getPropertyUint32(ia,e.a.colSpan)?1:this.$d.getPropertyUint32(ia,e.a.colSpan),Ca>bb||Ha>ha)){ab=Sa=-1;({rowIndex:Sa,nZb:ab}=ra.a(ka,null,ia,Sa,ab));if(-1===Sa||-1===ab)return k.a.instance.Wa(573957959,1,2,"Table cell location could not be found in base revision. Table Cell ID: {0}",la),ka.logger.Pg(Object.assign(new ua.a,{info:"Table cell location could not be found in base revision, although the object is present itself"})),!1;ia=pa.cG();for(eb=Sa;eb<Sa+Ca;eb++)for(zb=ab;zb<ab+Ha;zb++){Ab=
ra.d(ka,null,Xa,eb,zb);if(!Ab)return k.a.instance.Wa(573957960,1,2,"Table cell could not be found within table bounds"),ka.logger.Pg(Object.assign(new ua.a,{info:"Ghost cell not found in the table bounds"})),!1;Ab.id.equals(la)||ia.contains(Ab.id)||Ra.add(Ab.id)}}}!Ma&&(wa||va||Ka)&&(k.a.instance.Wa(573957963,1,4,"Adding cell info structure to the ComplexTableStructure Dictionary for table cell id: {0}",la),Ma=new da,Ma.rowSpan=bb,Ma.colSpan=ha,Ma.qg=Ja,Ma.rWd=Na,Ma.vjf=pa,Ma.bEf=Ra,xa.add(la,Ma));
return!0}Kco(ka){return this.aej(ka,!1)}M8k(ka){return this.aej(ka,!0)}aej(ka,la){const Ha=ka.runtime,wa=Ha.lk,Ca=Ha.Yt,Ja=la?Ha.U2e:Ha.lq,bb=Ha.Rm;let ha=!0;const ia=ka.runtime.q0c;let va=0,Ka=0,Xa=0;Ja.forEach((xa,Ma)=>{ia&&k.a.instance.Wa(4051617,1,5,"Merging Object: [Id: {0}] [ClassId: {1}] [Finalize: {2}]",xa,Ma.Qc,la);Ka++;this.bNg===Ka&&(va++,ka.runtime.bG(String.format("ObjectMerge [Cycles: {0}] [ComplexMerges: {1}] [Finalize: {2}]",va,Xa,la)),Ka=0);if(ka.runtime.Qb&&ka.runtime.Qb.oBb(1000005)&&
ka.runtime.ffc.contains(Ma.id,(Ra,Sa)=>Ra.equals(Sa))||this.TZn(Ma.Qc))return!0;if(!la&&this.$Rk(Ma.Qc,ka.runtime.Qb))return Ha.U2e.Z(xa,Ma),!0;var Na=Ca.get(xa);if(!Na)return bb.xb(xa)?bb.J(xa).bri(Ma):bb.Z(xa,new Y.a(Ma,!1)),!0;if(!wa.J(xa)&&!this.THm(Na.Qc)){var pa=!!ka.input.G3&&!!ka.input.G3.last()&&ka.input.G3.last().C2(xa);const Ra=!!ka.input.zwa&&!!ka.input.zwa.last()&&ka.input.zwa.last().C2(xa),Sa=new U.a(Na,Ma);if(!Sa.YW)return bb.Z(xa,new Y.a(Na,!1)),!0;k.a.instance.Wa(4051618,1,2,"Merging Object: [Id: {0}] [ClassId: {1}] [Finalize: {2}]. Object wasn't in base revision, but was in conflict and favored. [ReferencedInFavored: {3}] [ReferencedInUnfavored: {4}] [Identical: {5}] [Source: {6}].",
xa,Ma.Qc,la,pa,Ra,!Sa.YW,ka.input.source);ka.logger.Pg(Object.assign(new S.a,{lj:"GraphMerger.TryObjectMerge",eventId:"ap3k8"}));return ha=!1}pa=bb.Jy(xa,new Y.a(wa.J(xa)));({Nk:Na,returnValue:ha}=this.YQl.merge(ka,this.h2h,this.$d,pa,Na,Ma));Xa++;ha&&(ka.runtime.bG(String.format("ObjectMerge [Id: {0}] [ClassId: {1}] [ComplexMerges: {2}] [Cycles: {3}] [Finalize: {4}]",xa,Ma.Qc,Xa,va,la)),Na&&(bb.xb(Na.im.id)?bb.J(Na.im.id).bri(Na.im):bb.Z(Na.im.id,Na)));return ha});ka.logger.yfa("ObjectMerge");ia&&
k.a.instance.Wa(4059168,1,5,"TryObjectMerge: Merged {0} objects. {1} were complex merges, finalize: {2}.",Ja.count,Xa,la);return ha}xpo(ka){try{for(let la=0;la<ka.runtime.MUd.length;la++){const Ha=ka.runtime.MUd.J(la);if(ka.runtime.Rm.J(Ha)){if(!this.egm(ka,Ha))return!1}else k.a.instance.Wa(527034192,1,2,"ValidateMerge: Couldn't find merged node to verify");ka.runtime.bG("Validate markers taking too long")}}catch(la){k.a.instance.Wa(559535579,1,2,"ValidateMerge threw an exception: {0}",la)}return ka.logger.KRc.V3h()?
!1:!0}jVn(ka){return 38===ka||39===ka||40===ka||41===ka||44===ka||45===ka||33===ka||34===ka?!1:!0}Lyl(ka){switch(ka){case 38:case 39:case 40:case 41:return e.a.pe;case 44:case 45:return e.a.Tsd;case 33:case 34:return e.a.Qj}return K.CommonProperties.nil}wpo(ka,la){const Ha=this.$d.getPropertyUint32(ka,e.a.Eq);if(!Ha||this.jVn(Ha))return!0;ka=this.$d.getPropertyObjectId(ka,this.Lyl(Ha));return qa.Q2b(la,ka)?!0:(la.logger.KRc.bNd=Ha,!1)}egm(ka,la){if(ka.runtime.gKf.contains(la))return!1;if(la=qa.Q2b(ka,
la)){la=this.$d.getPropertyObjectIds(la,a.a.un);for(let Ha=0;Ha<la.length;Ha++){const wa=qa.Q2b(ka,la.lg(Ha));if(wa&&!this.wpo(wa,ka))return!1}}return!0}TZn(ka){switch(ka){case 1074135137:case 1074135138:case 1074135139:case 1074135140:case 131162:case 4325465:return!0}return!1}$Rk(ka,la){let Ha=!1;if(1074135145===ka)return!0;la&&la.Vq(131);la&&la.isFeatureEnabled(131)&&1074135153===ka&&(Ha=!0);return Ha}THm(ka){switch(ka){case 1074135162:return!0}return!1}tNk(ka,la){const Ha=new u.a,wa=new u.a,Ca=
new u.a;var Ja=ka.runtime.Dza;const bb=Ja?Ja.id:y.a.nil;this.Pwf(Ja).forEach(ha=>{Ha.add(la(ha));return!0});Ja=ka.input.G3.lg(ka.input.G3.length-1);this.Pwf(Ja,bb).forEach(ha=>{wa.add(la(ha));return!0});ka=ka.input.zwa.lg(ka.input.zwa.length-1);this.Pwf(ka,bb).forEach(ha=>{Ca.add(la(ha));return!0});return{rhk:Ha,a8n:wa,svo:Ca}}Pwf(ka,la=null){const Ha=new u.a;la||(la=y.a.nil);for(;ka&&!la.equals(ka.id);)Ha.add(ka),ka=ka.z1;Ha.reverse();return Ha}x4n(ka){const la=3===this.lJd;let Ha=!1;!ka.output.succeeded&&
(2===this.lJd||ka.output.crash&&1===this.lJd)&&(Ha=!0);let wa=!1;ka.input.G3&&0<ka.input.G3.length&&(la||Ha)&&ka.runtime.Yt&&ka.runtime.lk&&ka.runtime.Qb&&(wa=ka.runtime.Qb.isFeatureEnabled(50));return wa}fai(ka){return 9===I.a.WAb(I.a.haf(ka))}ifi(ka){return 8===I.a.WAb(I.a.haf(ka))}static Atl(ka){return ka.output.crash?2:ka.output.succeeded?3:1}static Q2b(ka,la){if(!la||la===y.a.nil)return null;const Ha=ka.runtime.Rm.J(la);return Ha?Ha.im:ka.runtime.lk.J(la)}}qa.kJd=y.a.Of("{0B310978-27EA-4A49-A620-7E588CFE64C6}{1}");
Object(C.a)(qa,"GraphMergerBase",null,[1427])},1714:function(C,N,d){C=d(0);var l=d(216),e=d(1588),a=d(148),k=d(1518);class n extends e.a{constructor(u,t,y,B,G,F,K,O,H,I,J,L,S,E){super(u,3,t,y,B,G,F,O,H,I,J,L,S,E);this.Oje=K}get character(){return this.Oje}get text(){return this.character.toString()}W_c(){throw a.a.notImplemented();}toString(){return String.format("{0}",super.toString())}h2b(){return"CharRun"}clone(){return new n(this.Cyc,this.source,this.Cj,this.Bg,this.runId,this.oI,this.character,
this.Mhb,this.EMa,this.x$,this.vBa,this.tOa,this.wE,this.xt)}Oz(u,t,y,B=!1){return super.Oz(u,t,y,B)?u.character===this.character?!0:k.a.Jdh(u.character,this.character):!1}}Object(C.a)(n,"CharRunMergeBlock",e.a,[]);d.d(N,"a",function(){return v});class v extends e.a{constructor(u,t,y,B,G,F,K,O,H,I,J,L,S,E,P){super(u,1,t,y,B,G,F,O,I,J,L,S,E,P);this._text=K;this.YIe=H}get text(){return this._text}W_c(u){this._text=u}get v3a(){return this.YIe&&this._text&&this._text.length?!0:!1}toString(){return String.format("{0} [SupportsSplit: {1}]",
super.toString(),this.YIe)}h2b(){return"TextRun"}clone(){return new v(this.Cyc,this.source,this.Cj,this.Bg,this.runId,this.oI,this._text,this.Mhb,this.YIe,this.EMa,this.x$,this.vBa,this.tOa,this.wE,this.xt)}Oz(u,t,y,B=!1){return super.Oz(u,t,y,B)?k.a.Idh(this._text,u._text):!1}d1c(){const u=new l.a;for(let y=0;y<this.text.length;y++){var t=k.a.charAt(this._text,y);if(k.a.plm(k.a.f9n(t))){let B="";B+=t;t=k.a.charAt(this._text,++y);B+=t;t=new v(this.Cyc,this.source,this.Cj,this.Bg,this.runId,this.oI,
B,this.Mhb,!1,this.EMa,this.x$,this.vBa,this.tOa,this.wE,this.xt);u.add(t)}else t=new n(this.Cyc,this.source,this.Cj,this.Bg,this.runId,this.oI,t,this.Mhb,this.EMa,this.x$,this.vBa,this.tOa,this.wE,this.xt),u.add(t)}return u}}Object(C.a)(v,"TextRunMergeBlock",e.a,[])},1715:function(C,N,d){C=d(0);var l=d(982),e=d(17),a=d(387),k=d(216),n=d(59);d(789);var v=d(619),u=d(150),t=d(148),y=d(1002),B;(function(H){H[H.none=0]="none";H[H.browser=1]="browser";H[H.serverPutChanges=2]="serverPutChanges";H[H.syncDiff=
3]="syncDiff";H[H.docxMerge=4]="docxMerge";H[H.undo=5]="undo"})(B||(B={}));Object(C.b)("GraphMergeSource",B);var G=d(1702),F=d(1531),K=d(1696);d.d(N,"a",function(){return O});class O{constructor(H){this.fA=new y.a;this.YO=new a.a;this.p3g=new a.a(0);this.E6c=new k.a;this.KHg=new k.a;this.ARg=new k.a;this.LOg=new k.a;this.IQg="";this.iSa=null;this.Fr=this.bxe=0;this.$hd=new a.a(0);this.npe=this.hVg=this.Ved=0;const {MarkerValidation:I}=d(1809);this._state=H;this.XLj=new I}get KRc(){return this.XLj}get VHi(){return this.iSa}TOn(H){this.bxe=
H}sTd(H,I){this.IQg=String.format("{0}-{1}",H,I)}e7d(H){this.nwk();this.npe=H}BYf(){this.npe=0}nwk(){this.iSa&&this.E6c.add(this.iSa);this.iSa=null}Pg(H){this.iSa||(this.iSa=H);switch(this.npe){case 1:this.KHg.add(H);break;case 2:this.ARg.add(H);break;case 3:this.LOg.add(H);break;default:this.iSa&&this.E6c.add(H)}}dmi(H){this.E6c.add(H)}Qym(){this.Fr=this.TAa();this.yfa("MergeEnd")}yfa(H){const I=this.TAa();this.p3g.Z(H,I-this.bxe);this.bxe=I}YMn(){this.Ved=this.TAa();this.hVg++}YT(H){const I=this.TAa();
let J;({value:J}=this.$hd.Dc(H)).returnValue?(J+=I-this.Ved,this.$hd.Z(H,J)):this.$hd.Z(H,I-this.Ved);this.Ved=I}Zyl(){this.YO.Z("Id",this._state.input.uFb.toString());this.YO.Z("Source",B[this._state.input.source]);this.YO.Z("Base",O.ywa(this.Wil()));this.YO.Z("Favored",O.ywa(this.eYh(!0)));this.YO.Z("Unfavored",O.ywa(this.eYh(!1)));this.YO.Z("NodesRolledBackIfFailed",O.ywa(this.SAl()));if(!this._state.output.succeeded){let H,I,J,L,S;({uhk:H,d7k:I,neo:J,zhk:L,peo:S}=this.R8k(this._state.runtime));
this.YO.Z("CharactersLost",this.fll(H,I,J));this.YO.Z("CharactersLostInComments",this.eml());this.YO.Z("CharactersLostInTables",this.Nhl(S,L))}this.YO.Z("FuncStep",this.IQg);this.YO.Z("FailureDetail",O.ywa(this.fAb()));this.YO.Z("FailDetailHints",this.BFd(this.KHg));this.YO.Z("FailDetailNaiveMerge",this.BFd(this.ARg));this.YO.Z("FailDetailLcs",this.BFd(this.LOg));this.YO.Z("ExtraDetails",this.BFd(this.E6c));this.YO.Z("Timeline",O.ywa(this.p3g));this.YO.Z("ParagraphMergesCount",this.hVg);this.YO.Z("ParagraphMergeDurations",
O.ywa(this.$hd));this.YO.Z("MarkerInfo",O.ywa(this.KRc.DPh()));this.YO.Z("Result",O.ywa(this.azl()));return JSON.stringify(O.ywa(this.YO))}TAa(){return(new Date).getTime()}Wil(){const H=new a.a,I=this._state.input.zwa,J=this._state.runtime.Dza?this._state.runtime.Dza.id:n.a.nil;let L=!1,S=0;for(;S<I.length;S++)if(I.J(S).id.equals(J)){L=!0;break}H.Z("LastId",J.toString());H.Z("Length",L?S+1:-1);return H}eYh(H){const I=new a.a;if(0===this._state.input.P2)return null;H=H?2===this._state.input.P2?this._state.input.G3:
this._state.input.zwa:2===this._state.input.P2?this._state.input.zwa:this._state.input.G3;I.Z("FirstId",H.J(0).id.toString());I.Z("LastId",H.length?H.J(H.length-1).id.toString():null);I.Z("Length",H.length);return I}SAl(){if(!this._state.runtime.n8h)return null;const H=this._state.runtime.lq,I=new a.a(0);H.forEach((J,L)=>{({value:J}=I.Dc(L.Qc.toString()));I.Z(L.Qc.toString(),J+1);return!0});return I}fll(H,I,J){let L=null,S=null,E=null;const P=this._state.runtime.lq;let T=0;try{E=new K.a(this.fA,this._state);
L=F.b(H,I,J);S=new v.a;for(H=0;H<L.length;H++)if(!L.J(H).Nvb.Fp(L.J(H).dmb,(U,X)=>U.equals(X))){const U=this.Mzh(L.J(H),E);T+=U;S.add(L.J(H))}L&&P.forEach((U,X)=>{if(393230===X.Qc){X=null;for(let Y=0;Y<L.length;Y++)if(!S.contains(L.J(Y))&&L.J(Y).dmb.contains(U,(ca,da)=>ca===da)){X=L.J(Y);break}X&&(U=this.Mzh(X,E),S.add(X),T+=U)}return!0});return T}catch(U){return u.a.instance.Wa(579190992,1,2,"Exception in GetCharactersLost: "+U.toString()),-1}}R8k(H){let I,J,L,S,E;H.bG=T=>{if(750<this.TAa()-this._state.input.QPa)throw u.a.instance.Wa(579190991,
1,2,"Timed out while calculating characters lost: {0}",T),t.a.invalidOperation(T);};I=new k.a;J=new k.a;L=new k.a;S=new k.a;const P=new k.a;E=new k.a;try{if(H.lk){const T=H.lk.J(G.ChildNodeListMerge.FZd);let U,X;U=H.Yt.J(G.ChildNodeListMerge.FZd)||T;X=H.lq.J(G.ChildNodeListMerge.FZd)||T;this.c9e(T,Y=>H.lk.J(Y),I,S);this.c9e(U,Y=>H.Yt.J(Y)||H.lk.J(Y),J,P);this.c9e(X,Y=>H.lq.J(Y)||H.lk.J(Y),L,E)}}catch(T){u.a.instance.Wa(573089732,1,2,"Exception in FindAllParagraphAndTableIds: "+T.toString())}return{uhk:I,
d7k:J,neo:L,zhk:S,peo:E}}Nhl(H,I){try{let L=0;const S=this._state.runtime;var J=T=>S.lq.J(T)||S.lk.J(T);const E=new v.a,P=this.A$k(H,S,J,E);for(H=0;H<P.count;H++){let T=P.keys.J(H);const U=P.J(T);if(!E.contains(T)){let X=this.$Zh(S,J,E,T,U);if(-1!==X)L+=X;else return u.a.instance.Wa(573089733,1,2,"Error calculating characters lost between base and unfavored tables"),-1}}for(J=0;J<I.length;J++){let T=I.J(0);if(!E.contains(T)){let U=this.CId(S.lk.J(T));if(-1===U)return u.a.instance.Wa(573089734,1,2,
"Error calculating characters lost in table deleted from base"),-1;L+=U}}return L}catch(L){return u.a.instance.Wa(573089735,1,2,"Exception in GetAllTablesCharactersLost: "+L.toString()),-1}}$Zh(H,I,J,L,S){H.bG("GetTableCharactersLost");let E=0;S=this.fA.getPropertyObjectIds(S,e.a.qf);for(let Y=0;Y<S.length;Y++){var P=I(S.J(Y));P=this.fA.getPropertyObjectIds(P,e.a.qf);for(let ca=0;ca<P.length;ca++){var T=I(P.J(ca));if(H.lk.J(S.J(Y))&&H.lk.J(P.J(ca))){var U=H.lk.J(P.J(ca));if(!U)return u.a.instance.Wa(573089737,
1,2,"Base cell unexpectedly null"),-1;T=this.fA.getPropertyObjectIds(U,e.a.qf);var X=H.Yt.J(P.J(ca))||H.lk.J(P.J(ca));X=this.fA.getPropertyObjectIds(X,e.a.qf);U=this.fA.getPropertyObjectIds(U,e.a.qf);T=F.b(T,X,U);for(U=0;U<T.length;U++){X=T.J(U);const da=this.vLl(H,I,J,X);if(-1===da)return u.a.instance.Wa(573089738,1,2,"Error getting characters lost for parition {0}",X.toString()),-1;E+=da}}else{U=this.cMl(I,T,J);if(-1===U)return u.a.instance.Wa(573089736,1,2,"Error getting text length of cell {0}",
T.id.toString()),-1;E+=U}}}J.add(L);return E}vLl(H,I,J,L){let S=0;var E=new k.a,P=new k.a;const T=new a.a;new a.a;for(var U=0;U<L.Nvb.length;U++){var X=H.lk.J(L.Nvb.J(U));X=this.fA.getPropertyObjectIds(X,e.a.oL);if(1!==X.length)return u.a.instance.Wa(573089739,1,2,"Unexpected number of ContentNodes: {0}",X.length),-1;var Y=H.lk.J(X.J(0));393230===Y.Qc?E.add(Y):393250===Y.Qc&&T.add(X.J(0),Y)}for(U=0;U<L.dmb.length;U++){X=I(L.dmb.J(U));X=this.fA.getPropertyObjectIds(X,e.a.oL);if(1!==X.length)return u.a.instance.Wa(573089740,
1,2,"Unexpected number of ContentNodes: {0}",X.length),-1;Y=I(X.J(0));if(393230===Y.Qc)P.add(Y);else if(393250===Y.Qc){Y=this.$Zh(H,I,J,X.J(0),Y);if(-1===Y)return u.a.instance.Wa(573089741,1,2,"Error diffing table {0}",X.J(0).toString()),-1;S+=Y}}U=new K.a(this.fA,this._state);if(0<E.length&&0<P.length){E=U.xHh(E,ca=>H.lk.J(ca),P,ca=>I(ca));if(-1===E)return u.a.instance.Wa(573089742,1,2,"Problem diffing parition {0} with LCS",L.toString()),-1;S+=E}else if(0<E.length)for(L=0;L<E.length;L++)S+=this.fA.getPropertyString(E.J(L),
e.a.lo).length+1;else if(0<P.length)for(L=0;L<P.length;L++)S+=this.fA.getPropertyString(P.J(L),e.a.lo).length+1;for(L=0;L<T.count;L++)if(E=T.keys.J(L),!J.contains(E)){P=this.CId(T.J(E));if(-1===P)return u.a.instance.Wa(573089743,1,2,"Error getting length of table {0}",E.toString()),-1;S+=P}return S}cMl(H,I,J){let L=0;I=this.fA.getPropertyObjectIds(I,e.a.qf);for(let P=0;P<I.length;P++){var S=H(I.J(P));S=this.fA.getPropertyObjectIds(S,e.a.oL);if(1!==S.length)return u.a.instance.Wa(573089744,1,2,"Unexpected number of ContentNodes: {0}",
S.length),-1;var E=H(S.J(0));if(393230===E.Qc)L+=this.fA.getPropertyString(E,e.a.lo).length+1;else if(393250===E.Qc){E=this.CId(E);if(-1===E)return u.a.instance.Wa(573089745,1,2,"Problem finding text length of table {0}",S.J(0).toString()),-1;L+=E;J.add(S.J(0))}}return L}CId(H){this._state.runtime.bG("GetTextLengthOfTable");let I=0;const J=T=>this._state.runtime.lq.J(T)||this._state.runtime.lk.J(T);H=this.fA.getPropertyObjectIds(H,e.a.qf);for(let T=0;T<H.length;T++){var L=J(H.J(T));L=this.fA.getPropertyObjectIds(L,
e.a.qf);for(let U=0;U<L.length;U++){var S=J(L.J(U));S=this.fA.getPropertyObjectIds(S,e.a.qf);for(let X=0;X<S.length;X++){var E=J(S.J(X));E=this.fA.getPropertyObjectIds(E,e.a.oL);if(1!==E.length)return u.a.instance.Wa(573089746,1,2,"Unexpected number of ContentNodes: {0}",E.length),-1;var P=J(E.J(0));if(393230===P.Qc)I+=this.fA.getPropertyString(P,e.a.lo).length+1;else if(393250===P.Qc){P=this.CId(P);if(-1===P)return u.a.instance.Wa(573089747,1,2,"Error finding the text length of table {0}",E.J(0)),
-1;I+=P}}}}return I}A$k(H,I,J,L){const S=new a.a;for(let E=0;E<H.length;E++){let P=!1;I.lq.J(H.J(E))&&(P=!0);const T=J(H.J(E)),U=this.fA.getPropertyObjectIds(T,e.a.qf);if(!P)for(let X=0;X<U.length;X++)if(I.lq.J(U.J(X))){P=!0;break}P?S.add(H.J(E),T):L.add(H.J(E))}return S}Mzh(H,I){return this.Lzh(H.Nvb,H.dmb,I)}Lzh(H,I,J){const L=new k.a;for(var S=0;S<H.length;S++)L.add(this._state.runtime.lk.J(H.J(S)));H=new k.a;for(S=0;S<I.length;S++)H.add(this._state.runtime.lq.J(I.J(S))||this._state.runtime.lk.J(I.J(S)));
return J.xHh(L,E=>this._state.runtime.lk.J(E),H,E=>this._state.runtime.lq.J(E)||this._state.runtime.lk.J(E))}c9e(H,I,J,L){if(393227===H.Qc){H=this.fA.getPropertyObjectIds(H,e.a.qf);for(let S=0;S<H.length;S++){const E=this.fA.getPropertyObjectIds(I(H.J(S)),e.a.qf);for(let P=0;P<E.length;P++){const T=this.fA.getPropertyObjectIds(I(E.J(P)),e.a.qf);for(let U=0;U<T.length;U++){const X=this.fA.getPropertyObjectIds(I(T.J(U)),e.a.oL);if(1!==X.length)return;const Y=I(X.J(0));393230===Y.Qc?J.add(X.J(0)):393250===
Y.Qc?L.add(X.J(0)):u.a.instance.Wa(573089748,1,2,"Unsupported class id in GetCharactersLost: "+l.a[Y.Qc])}}}}}d9e(H,I){H=this.fA.getPropertyObjectIds(H,e.a.qf);const J=new k.a;for(let L=0;L<H.length;L++){const S=this.fA.getPropertyObjectIds(I(H.J(L)),e.a.oL);if(1!==S.length)return null;J.add(S.J(0))}return J}eml(){let H=0;const I=this._state.runtime,J=I.lq,L=E=>I.lq.J(E)||I.lk.J(E);let S=null;I.bG=E=>{if(750<this.TAa()-this._state.input.QPa)throw u.a.instance.Wa(573089749,1,2,"Timed out while calculating comment characters lost: {0}",
E),t.a.invalidOperation(E);};try{J.forEach((E,P)=>{if(1074135127===P.Qc){E=this.d9e(P,L);var T=I.lk.J(P.id);if(T)T=this.d9e(T,X=>I.lk.J(X)),S||(S=new K.a(this.fA,this._state)),H+=this.Lzh(T,E,S);else for(T=0;T<E.length;T++)H+=this.fA.getPropertyString(I.lq.J(E.J(T)),e.a.lo).length+1}if(1074135126===P.Qc&&(E=this.fA.getPropertyObjectIds(P,e.a.qf).cG(),P=I.lk.J(P.id)))for(P=this.fA.getPropertyObjectIds(P,e.a.qf),T=0;T<P.length;T++)if(!E.contains(P.J(T))){var U=I.lk.J(P.J(T));U=this.d9e(U,X=>I.lk.J(X));
for(let X=0;X<U.length;X++)H+=this.fA.getPropertyString(I.lk.J(U.J(X)),e.a.lo).length+1}return!0})}catch(E){return u.a.instance.Wa(573089750,1,2,"Exception in GetCommentCharactersLost: "+E.toString()),-1}return H}fAb(){return this.iSa?this.iSa.fAb():null}BFd(H){const I=new k.a;H.forEach(J=>{I.add(O.ywa(J.fAb()));return!0});return I.toArray()}azl(){const H=new a.a;H.Z("Succeeded",this._state.output.succeeded);H.Z("Timeout",this._state.output.timeout);H.Z("Crash",this._state.output.crash);H.Z("MergedRevisions",
this._state.output.ZL?this._state.output.ZL.length:-1);H.Z("Duration",this.Fr-this._state.input.QPa);return H}static ywa(H){if(!H)return null;const I={};H.forEach((J,L)=>{I[J.toString()]=L;return!0});return I}}Object(C.a)(O,"MergeLogger",null,[])},1716:function(C,N,d){C=d(0);var l=d(244),e=d(17),a=d(5),k=d(110),n=d(789),v=d(150),u=d(216),t=d(387),y=d(1466);class B{constructor(K,O,H){this.position=K;this.leader=O;this.val=H}equals(K){return this.position===K.position&&this.leader===K.leader&&this.val===
K.val}toString(){return this.position.toString()}}Object(C.a)(B,"TabStop",null,[]);var G=d(1810);d.d(N,"a",function(){return F});class F extends y.a{constructor(){super()}get Bn(){return 20}get Dz(){return 0}nk(){const K=super.nk();K.Z(n.a.yb(e.a.lo),1);K.Z(n.a.yb(e.a.un),1);K.Z(n.a.yb(e.a.mm),1);K.Z(n.a.yb(a.a.gt),1);K.Z(n.a.yb(a.a.Hq),1);K.Z(n.a.yb(a.a.Nc),1);K.Z(n.a.yb(e.a.Zkb),1);K.Z(n.a.yb(a.a.KLa),1);K.Z(n.a.yb(a.a.BDa),1);K.Z(n.a.yb(e.a.xua),1);K.Z(n.a.yb(a.a.UBa),1);K.Z(n.a.yb(a.a.Vda),1);
K.Z(n.a.yb(a.a.VBa),1);K.Z(n.a.yb(a.a.kAa),1);K.Z(n.a.yb(a.a.WBa),1);K.Z(n.a.yb(a.a.lAa),1);K.Z(n.a.yb(a.a.ADa),1);K.Z(n.a.yb(a.a.VEa),1);K.Z(n.a.yb(a.a.WEa),1);K.Z(n.a.yb(a.a.cwa),1);K.Z(n.a.yb(a.a.Wu),1);K.Z(n.a.yb(a.a.Ty),1);K.Z(n.a.yb(a.a.Uy),1);K.Z(n.a.yb(a.a.Qv),1);K.Z(n.a.yb(k.a.mK),6);K.Z(n.a.yb(k.a.NQa),6);K.Z(n.a.yb(a.a.Ewb),7);K.Z(n.a.yb(k.a.mK),6);K.Z(n.a.yb(a.a.m6i),2);K.Z(n.a.yb(k.a.RDk),2);K.Z(n.a.yb(k.a.H1m),2);K.Z(n.a.yb(a.a.Kgc),2);K.Z(n.a.yb(a.a.O2c),2);K.Z(n.a.yb(a.a.GLb),2);K.Z(n.a.yb(a.a.Tlb),
2);K.Z(n.a.yb(a.a.P2c),2);K.Z(n.a.yb(a.a.Q2c),2);K.Z(n.a.yb(a.a.lockNotFullySupportedParagraphInBlockContentControl),2);return K}aB(K,O){if(O===n.a.yb(e.a.lo)||O===n.a.yb(e.a.un)||O===n.a.yb(e.a.mm)||O===n.a.yb(a.a.gt)||O===n.a.yb(a.a.Hq)||O===n.a.yb(a.a.Nc)||O===n.a.yb(e.a.Zkb)||O===n.a.yb(a.a.KLa)||O===n.a.yb(a.a.BDa)||O===n.a.yb(e.a.xua)||O===n.a.yb(a.a.UBa)||O===n.a.yb(a.a.Vda)||O===n.a.yb(a.a.VBa)||O===n.a.yb(a.a.kAa)||O===n.a.yb(a.a.WBa)||O===n.a.yb(a.a.lAa)||O===n.a.yb(a.a.ADa)||O===n.a.yb(a.a.VEa)||
O===n.a.yb(a.a.WEa)||O===n.a.yb(a.a.cwa)||O===n.a.yb(a.a.Wu)||O===n.a.yb(a.a.zM)){var H=K.Zm.value.ku,I=K.Zm.value.Df;O=K.Ng.value.Df;if(K.Yo.runtime.JJa.contains(H.id))return v.a.instance.Wa(18989579,1,4,"ParagraphNodeComplexMerge: Skipping merge for [Paragraph: {0}] as it was already merged during ChildNodeListMerge.",H.id),!0;if(K.Yo.runtime.Qb.oBb(1000005)&&this.$Zn(K,O,I))return K.Nk=O.HG(),F.w8g(K),F.$qd(K.Yo,K.$d,I),!0;const J=new u.a;J.add(H);H=new u.a;H.add(I);I=new u.a;I.add(O);if(!({Rm:O}=
F.eej(K.Yo,J,I,H)).returnValue)return K.J$f=!0,K.Nk=null,!1;F.w8g(K);K.Nk=O.lg(0).im;return!0}return O===n.a.yb(a.a.Ty)||O===n.a.yb(a.a.Uy)||O===n.a.yb(a.a.Qv)?(this.Abo(K),K.yg.add(n.a.yb(a.a.Ty)),K.yg.add(n.a.yb(a.a.Uy)),K.yg.add(n.a.yb(a.a.Qv)),!0):!1}$Zn(K,O,H){O=K.$d.getPropertyString(O,a.a.zM);K=K.$d.getPropertyString(H,a.a.zM);return O||K?!0:!1}Abo(K){const O=K.$d,H=K.Nk;var I=K.Zm.value.Df,J=K.Ng.value.Df;K=this.cdf(K.Zm.value.ku,O);J=this.cdf(J,O);I=this.cdf(I,O);({WHm:I,XHm:K,YHm:J}=this.czl(K,
J,I));I.length?(O.setPropertyUint32s(H,a.a.Qv,I),O.setPropertyUint32s(H,a.a.Ty,K),O.setPropertyUint32s(H,a.a.Uy,J)):this.bpn(H)}cdf(K,O){const H=O.getPropertyUint32s(K,a.a.Qv),I=O.getPropertyUint32s(K,a.a.Ty);K=O.getPropertyUint32s(K,a.a.Uy);O=new u.a;if(!H)return O;for(let J=0;J<H.length;++J)O.add(new B(H.J(J),I.J(J),K.J(J)));return O}czl(K,O,H){({VBi:O,WBi:S,XBi:L}=this.mPh(K,O));let I,J;({VBi:H,WBi:I,XBi:J}=this.mPh(K,H));K=this.vSl(K,S,L,I,J);var L=this.uSl(K,O,H);K=new u.a;O=new u.a;var S=new u.a;
for(H=0;H<L.length;++H)K.add(L.J(H).position),O.add(L.J(H).leader),S.add(L.J(H).val);return{WHm:K,XHm:O,YHm:S}}mPh(K,O){let H,I,J;H=new u.a;I=new t.a;J=new t.a;let L,S;for(L=S=0;L<K.length&&S<O.length;)K.J(L).position===O.J(S).position?(K.J(L).equals(O.J(S))||J.Z(K.J(L).position,O.J(S)),++L,++S):K.J(L).position<O.J(S).position?(I.Z(K.J(L).position,K.J(L)),++L):(H.add(O.J(S)),++S);for(;L<K.length;)I.Z(K.J(L).position,K.J(L)),++L;for(;S<O.length;)H.add(O.J(S)),++S;return{VBi:H,WBi:I,XBi:J}}vSl(K,O,
H,I,J){const L=new u.a;for(let S=0;S<K.length;++S){const E=K.J(S).position;O.xb(E)||(H.xb(E)?L.add(H.J(E)):I.xb(E)||(J.xb(E)?L.add(J.J(E)):L.add(K.J(S))))}return L}uSl(K,O,H){O=this.$qi(O,H);return this.$qi(K,O)}$qi(K,O){const H=new u.a;let I,J;for(I=J=0;I<K.length&&J<O.length;)K.J(I).position<=O.J(J).position?(H.add(K.J(I)),K.J(I).position===O.J(J).position&&++J,++I):H.add(O.J(J++));for(;I<K.length;)H.add(K.J(I++));for(;J<O.length;)H.add(O.J(J++));return H}bpn(K){K.removeProperty(a.a.Qv);K.removeProperty(a.a.Ty);
K.removeProperty(a.a.Uy)}static nh(){return new F}static get instance(){return F.Kg.value}static w8g(K){K.yg.add(n.a.yb(e.a.lo));K.yg.add(n.a.yb(e.a.un));K.yg.add(n.a.yb(e.a.mm));K.yg.add(n.a.yb(a.a.gt));K.yg.add(n.a.yb(a.a.Hq));K.yg.add(n.a.yb(a.a.Nc));K.yg.add(n.a.yb(e.a.Zkb));K.yg.add(n.a.yb(a.a.KLa));K.yg.add(n.a.yb(a.a.BDa));K.yg.add(n.a.yb(e.a.xua));K.yg.add(n.a.yb(a.a.UBa));K.yg.add(n.a.yb(a.a.Vda));K.yg.add(n.a.yb(a.a.VBa));K.yg.add(n.a.yb(a.a.kAa));K.yg.add(n.a.yb(a.a.WBa));K.yg.add(n.a.yb(a.a.lAa));
K.yg.add(n.a.yb(a.a.ADa));K.yg.add(n.a.yb(a.a.VEa));K.yg.add(n.a.yb(a.a.WEa));K.yg.add(n.a.yb(a.a.cwa));K.yg.add(n.a.yb(a.a.Wu));K.yg.add(n.a.yb(a.a.zM))}static eej(K,O,H,I){return(new G.a(K,O,H,I)).Ugc()}static $qd(K,O,H){H=O.getPropertyObjectIds(H,e.a.un);for(let J=0;J<H.length;J++){var I=K.runtime.lq.J(H.lg(J));if(I&&(I=O.getPropertyObjectId(I,a.a.pe))){K.runtime.ffc.add(I);break}}}}F.Kg=new l.a(F.nh);Object(C.a)(F,"ParagraphNodeComplexMerge",y.a,[])},1717:function(C,N,d){C=d(0);var l=d(76),e=
d(1474),a=d(1583),k=d(1519),n=d(1492),v=d(1534),u=d(1475),t=d(1478),y=d(1477),B=d(1471),G=d(1470);class F{constructor(X){this.qc=X;this.Wmd=this.bif()}FL(){return"Add-ins"}FW(){return 0===this.qc.Kv?0:1===this.qc.Kv?1:3}DI(X,Y){X=new y.a(X);Y.resultsUpdated(X)}xeb(X,Y,ca){const da=new t.a(26);da.displayName=CommonUIStrings.l_TellMeAddinProviderTitle;ca&&this.MYn(X.Fg,Y,da)}MYn(X,Y,ca){const da=[];let ua;ua=this.qc.d9l?this.qc.VQ&&this.qc.dab?G.a.odb(String.format(CommonUIStrings.l_TellMeLaunchAddinDialogButtonText_1_Bolded,
X)):String.format(CommonUIStrings.l_TellMeLaunchAddinDialogButtonText_1,X):this.qc.e9l?this.qc.VQ&&this.qc.dab?G.a.odb(String.format(CommonUIStrings.l_TellMeLaunchAddinDialogButtonText_2_Bolded,X)):String.format(CommonUIStrings.l_TellMeLaunchAddinDialogButtonText_2,X):this.qc.VQ&&this.qc.dab?G.a.odb(String.format(CommonUIStrings.l_TellMeLaunchAddinDialogButtonText_0_Bolded,X)):String.format(CommonUIStrings.l_TellMeLaunchAddinDialogButtonText_0,X);this.qc.qBa?(B.TellMeActor.instance.actions.push(appChrome.actions.setControlLabel("LaunchAddinDialogFromTellMe",
ua)),B.TellMeActor.instance.actions.push(appChrome.actions.setButtonCommandValueId("LaunchAddinDialogFromTellMe",X))):(da.push(appChrome.actions.setControlLabel("LaunchAddinDialogFromTellMe",ua)),da.push(appChrome.actions.setButtonCommandValueId("LaunchAddinDialogFromTellMe",X)),appChrome.api.dispatch(da));ca.yz(new u.a("LaunchAddinDialogFromTellMe",27));Y.iw(ca)}bif(){const X=[];this.qc.uNd&&Array.add(X,"Addin");return X}}Object(C.a)(F,"AddinStoreResultsProvider",null,[1098]);var K=d(1675),O=d(1508),
H=d(1520),I=d(1676),J=d(1703),L=d(1677),S=d(1533),E=d(2),P=d(35),T=d(121);d.d(N,"a",function(){return U});class U{constructor(X,Y,ca){this.Gvc=this.bmd=this.dmd=this.amd=!1;this.aP=null;this.u0=-1;this.oja=this.gwc=null;this.ywc="";this.Vqb=0;this.qc=X;const da=G.a.xCa();this.L6a=Y||[];this.rg=E.AFrameworkApplication.Xe;this.v0g=X.jJf;this.emd=X.iJf;this.mHe=da&&this.mKb();this.nHe=da&&this.nKb();this.eVj=da&&this.oKb();this.pHe=this.qKb();this.x0g=this.Dec();X.k3f&&G.a.k_f(X)&&(this.gwc=new J.a(X),
this.amd=X.Y1c,this.dmd=X.$1c,this.bmd=X.Bgb,this.Gvc=this.amd&&this.fD("File")||this.dmd&&this.fD("People")||this.bmd&&this.fD("Notes"));this.$ld=this.JUn();this.hmd=X.aUc;this.oHe=this.bVn();this.u0g=this.IUn();this.b8=this.VLl();this.jvg=new K.a(X);this.cHj=new I.a(X);this.AXj=new L.a(X);this.mvj=new F(X);this.zuc=ca;this.hGe=new a.a;this.hmd&&(this.jvg=new K.a(X))}fD(X){return Array.contains(this.L6a,X)?!0:!1}FL(){return"TellMeService"}FW(){return 0===this.qc.Kv?0:1===this.qc.Kv?1:this.fD("Command")||
this.fD("Recommended")?2:3}SLl(X){let Y="";if(!X&&this.fD("Command")&&this.qc.bsf){Y+="CommandSearch_DLIS,";var ca=this.qc.baj;0<ca.length&&(Y+=ca+",")}X&&this.fD("Recommended")&&this.emd&&(ca=this.qc.caj,0<ca.length&&(Y+=ca+","));!X&&this.fD("Help")&&(X=this.qc.aaj,0<X.length&&(Y+=X+","));0<Y.length&&(Y=Y.substr(0,Y.length-1));return Y}DI(X,Y,ca,da=e.a.tellMe,ua=null){const ra=new y.a(X);ca=G.a.ZW(X);if(this.Gvc&&(!this.Vqb||window.performance.now()-this.Vqb>=G.a.ibe)){var qa=this.hGe.WLl();if(qa)this.Vqb=
window.performance.now(),qa.then(wa=>{this.ywc=wa},wa=>{B.TellMeActor.instance.Ze.onError("TellMeServiceProvider:issueQuery","tellMeServiceToken promise rejected: "+wa)});else if(B.TellMeActor.instance.Ze)B.TellMeActor.instance.Ze.onError("TellMeServiceProvider:IssueQuery","undefined token promise")}var ka=this.Gvc&&!!this.ywc;qa=ka||ca&&this.fD("Recommended")&&this.emd;ka=ka||!ca&&(this.v0g&&this.fD("Command")||this.mHe&&this.fD("Answer")||this.nHe&&this.fD("Definition")||this.x0g&&this.fD("Image")||
this.hmd&&this.fD("Help")||this.pHe&&this.fD("WolframAnswer")||this.oHe&&this.fD("Template")||this.u0g&&this.fD("Addin"));if(qa||ka)if(this.oja=da,da={"Content-Type":"application/json",Accept:"application/json"},da["X-Office-Version"]=E.AFrameworkApplication.buildVersion,da["X-Office-Application"]=E.AFrameworkApplication.K.lb("Application"),da["X-Office-Platform"]="WAC",da["X-TellMe-SqmUserId"]=E.AFrameworkApplication.K.lb("LoggableUserId")||"",da["X-TellMe-SessionId"]=B.TellMeActor.instance.AId(),
this.ywc&&(da.Authorization="Bearer "+this.ywc),qa=this.SLl(ca),0<qa.length&&(da["X-TellMe-Flights"]=qa),qa=[],!ca&&this.fD("Answer")&&this.mHe&&(ua?Array.contains(ua,9):1)&&Array.add(qa,"Answer"),!ca&&this.fD("Command")&&this.v0g&&!O.CommandResultsUtility.zpf(X.Fg)&&(ua?Array.contains(ua,17):1)&&Array.add(qa,"Command"),!ca&&this.fD("Definition")&&this.nHe&&(ua?Array.contains(ua,10):1)&&Array.add(qa,"Definition"),!ca&&this.fD("Help")&&this.hmd&&(ua?Array.contains(ua,8):1)&&Array.add(qa,"Help"),!ca&&
this.fD("WolframAnswer")&&this.pHe&&(ua?Array.contains(ua,12):1)&&Array.add(qa,"WolframAnswer"),ca&&this.fD("Recommended")&&this.emd&&!B.TellMeActor.instance.p4c&&(ua?Array.contains(ua,18):1)&&Array.add(qa,"Recommended"),!ca&&this.fD("Image")&&this.x0g&&(ua?Array.contains(ua,19):1)&&Array.add(qa,"Image"),this.ywc&&this.Gvc&&(ua?Array.contains(ua,14)||Array.contains(ua,15)||Array.contains(ua,20):1)&&(this.gwc.zcc(),this.amd&&this.fD("File")&&Array.add(qa,"File"),this.dmd&&this.fD("People")&&Array.add(qa,
"People"),this.bmd&&this.fD("Notes")&&Array.add(qa,"Notes")),!ca&&this.fD("Template")&&this.oHe&&(ua?Array.contains(ua,23):1)&&Array.add(qa,"Template"),!ca&&this.fD("Addin")&&this.u0g&&(ua?Array.contains(ua,24):1)&&Array.add(qa,"Addin"),qa.length){da["X-TellMe-SuggestionTypes"]=qa.join(",");da["X-TellMe-Culture"]=E.AFrameworkApplication.uiCulture;da["X-TellMe-ProcessSessionId"]=E.AFrameworkApplication.userSessionId;var la=this.aP=T.a.create().toString();da["Client-Request-Id"]=la;var Ha=window.performance.now();
this.wza();this.u0=window.setTimeout(()=>{if(la===this.aP){this.aP="";this.u0=-1;Y.resultsUpdated(ra);const wa={};wa[k.a.provider]=this.FL();wa[k.a.MHb]=X.jjb;B.TellMeActor.instance.Ze.WB(n.a.timedOut,this.zuc,wa)}},this.zuc);this.rg.Lj(this.b8,2,this.ULl(X.Fg),da,!1,0,wa=>{this.BGb(wa,X,Y,la,Ha,ua)},wa=>{this.nGb(wa,X,Y,la,Ha)},null,null,!1,4E3,6E3)}else B.TellMeActor.instance.Ze.onError("IssueQuery","Empty Online Provider List: No online calls by provider"),Y.resultsUpdated(ra);else Y.resultsUpdated(ra)}wza(){-1!==
this.u0&&(window.clearTimeout(this.u0),this.u0=-1)}BGb(X,Y,ca,da,ua,ra){const qa=new y.a(Y);if(da===this.aP){this.wza();B.TellMeActor.instance.Ze.V6(Y.Fg.length,this.L6a.join(","),X.data.wf.toString(),Math.round(window.performance.now()-ua),S.a.tellMe,!0,v.a.YLa);da=X.data.Ge;X=null;try{X=P.b(da)}catch(Ja){B.TellMeActor.instance.Ze.onError("OnSuccessCallBack","Exception occured while deserializing response:"+Ja);return}da=G.a.ZW(Y);if("Groups"in X&&X.Groups){var ka=X.Groups;for(var la of ka)if("GroupType"in
la&&"Suggestions"in la&&la.Suggestions)if("Commands"===la.GroupType&&(ra?Array.contains(ra,17):1)||"Recommended"===la.GroupType&&(ra?Array.contains(ra,18):1)){var Ha=(ka="Recommended"===la.GroupType)?"DLIS":"NaiveBayes";"Source"in la&&la.Source&&(Ha=la.Source);var wa=la.Suggestions;new l.a;var Ca=[];for(const Ja of wa)this.Nmm(Ja)&&(wa=Ja.Type,("Command"===wa||ka&&"Recommended"===wa)&&Ca.push(new H.a(Ja.CommandId,Ja.Score)));O.CommandResultsUtility.mTd(Ca,!Y.Fg.trim().length,la.GroupType,Ha);Ha=B.TellMeActor.instance.U0;
wa=[];for(const Ja of Ca)ka&&Ha&&Ha.YYe(Ja.commandId)||wa.push(Ja);Ca=O.CommandResultsUtility.RHd(Y,wa,this.qc,null,null,null,ka?18:17,0);0<Ca.results.length&&(this.oja!==e.a.contextMenu&&(Ca.displayName=ka?CommonUIStrings.l_TellMeTryCommandTitle:CommonUIStrings.l_TellMeCommandProviderTitle),qa.iw(Ca))}else if("Answer"===la.GroupType){wa=la.Suggestions;ka=null;Ca=2147483647;Ha="";for(const Ja of wa)if(this.Mmm(Ja))if(Ha=Ja.Type,wa=this.FHd(Ha),"Answer"===Ha&&this.mHe){ka=this.$uh(Ha,Ja,Y.Fg);break}else wa&&
wa<Ca&&(Ca=wa,ka=this.$uh(Ha,Ja,Y.Fg));Ca=G.a.qyn(Y.Fg,Ha);ka&&(ra?Array.contains(ra,ka.type):1)&&(Ha=[],this.$ld?this.qc.qBa?(B.TellMeActor.instance.actions.push(appChrome.actions.setControlLabel(ka.value,ka.$B)),B.TellMeActor.instance.actions.push(appChrome.actions.updateCompoundButtonDescription(ka.value,ka.description)),B.TellMeActor.instance.actions.push(appChrome.actions.setCompoundButtonCommandValueId(ka.value,Ca))):(Ha.push(appChrome.actions.setControlLabel(ka.value,ka.$B)),Ha.push(appChrome.actions.updateCompoundButtonDescription(ka.value,
ka.description)),Ha.push(appChrome.actions.setCompoundButtonCommandValueId(ka.value,Ca)),appChrome.api.dispatch(Ha)):this.qc.qBa?(B.TellMeActor.instance.actions.push(appChrome.actions.setControlLabel(ka.value,ka.$B+" - "+ka.description)),B.TellMeActor.instance.actions.push(appChrome.actions.setButtonCommandValueId(ka.value,Ca))):(Ha.push(appChrome.actions.setControlLabel(ka.value,ka.$B+" - "+ka.description)),Ha.push(appChrome.actions.setButtonCommandValueId(ka.value,Ca)),appChrome.api.dispatch(Ha)),
Ca=this.zNk(ka.type),Ca.yz(ka),qa.iw(Ca))}else"Help"===la.GroupType&&la.Suggestions.length&&(ra?Array.contains(ra,8):1)?this.hmd&&(ka=this.jvg.xeb(Y,la.Suggestions))&&0<ka.results.length&&qa.iw(ka):"Template"===la.GroupType&&(ra?Array.contains(ra,23):1)?(ka=la.Suggestions)&&0<ka.length&&this.AXj.xeb(Y,qa,ka):"Addin"===la.GroupType&&(ra?Array.contains(ra,24):1)?(ka=la.Suggestions)&&0<ka.length&&this.mvj.xeb(Y,qa,ka):"Substrate"===la.GroupType&&this.Gvc&&"Type"in la&&("File"===la.Type&&this.amd&&(ra?
Array.contains(ra,15):1)?(ka=this.gwc.CQh(la.Suggestions,da,this.oja))&&0<ka.results.length&&qa.iw(ka):"People"===la.Type&&this.dmd&&(ra?Array.contains(ra,14):1)?(ka=this.gwc.uWh(la.Suggestions,da,this.oja))&&0<ka.results.length&&qa.iw(ka):"Notes"===la.Type&&this.bmd&&(ra?Array.contains(ra,14):1)&&(ka=this.gwc.fVh(la.Suggestions,da,Y))&&0<ka.results.length&&qa.iw(ka));else B.TellMeActor.instance.Ze.onError("OnSuccessCallBack","GroupType"in la?"Invalid group suggestions found for "+la.GroupType:"Invalid group found")}if(X.Intents){la=
X.Intents;for(const Ja of la)this.quf(Ja)&&("Image"===Ja.GroupType&&Ja.ConfidenceScore>Ja.ConfidenceThreshold&&(ra?Array.contains(ra,19):1)?this.cHj.xeb(Y,qa,0,Ja):"Commands"===Ja.GroupType&&Ja.ConfidenceScore<Ja.ConfidenceThreshold&&(ra?Array.contains(ra,17):1)&&(la=new t.a(17),qa.iw(la)))}ca.resultsUpdated(qa);B.TellMeActor.instance.Ze.V6(Y.Fg.length,this.L6a.join(","),"",Math.round(window.performance.now()-ua),"",!0,v.a.provider)}}nGb(X,Y,ca,da,ua){const ra=new y.a(Y);da===this.aP&&(this.wza(),
B.TellMeActor.instance.Ze.V6(Y.Fg.length,this.L6a.join(","),X.data.wf.toString(),Math.round(window.performance.now()-ua),S.a.tellMe,!1,v.a.YLa));ca.resultsUpdated(ra)}FHd(X){switch(X){case "Entity":return this.eVj?3:0;case "Definition":return this.nHe?5:0;case "WolframAnswer":return this.pHe?2:0;default:return 0}}$uh(X,Y,ca){switch(X){case "Answer":return new u.a(this.$ld?"AnswerForSearch":"AnswerForSearchSingleLine",0,""===Y.Title?ca:Y.Title,Y.Description,0);case "Entity":return new u.a(this.$ld?
"AnswerForSearch":"AnswerForSearchSingleLine",2,""===Y.Title?ca:Y.Title,Y.Description,0);case "Definition":return new u.a(this.$ld?"AnswerForSearch":"AnswerForSearchSingleLine",1,""===Y.Title?ca:Y.Title,Y.Description,0);case "WolframAnswer":return new u.a("WolframForSearch",3,""===Y.Title?ca:Y.Title,Y.Description,0);default:return null}}zNk(X){switch(X){case 0:return new t.a(9,CommonUIStrings.l_TellMeAnswersTitle);case 2:return new t.a(11,CommonUIStrings.l_TellMeEntityTitle);case 1:return new t.a(10,
CommonUIStrings.l_TellMeDefinitionTitle);case 3:return new t.a(12,CommonUIStrings.l_TellMeAnswersTitle);case 12:return new t.a(19,this.qc.yec?CommonUIStrings.l_TellMeImageTitleV2:CommonUIStrings.l_TellMeImageTitle);default:return null}}Mmm(X){return"Type"in X&&!!X.Type&&""!==X.Type&&"Description"in X&&!!X.Description&&""!==X.Description}Nmm(X){return"Type"in X&&!!X.Type&&""!==X.Type&&"CommandId"in X&&!!X.CommandId&&""!==X.CommandId&&"Score"in X&&!!X.Score}quf(X){if("GroupType"in X&&X.GroupType&&"ConfidenceScore"in
X&&"ConfidenceThreshold"in X)return!0;B.TellMeActor.instance.Ze.onError("IsValidIntentGroup","Invalid intents found");return!1}ULl(X){const Y=G.a.uhi(X),ca={};ca.Query=X;Y&&this.emd&&(ca.CommandClickedEvents=B.TellMeActor.instance.Gke,ca.CommandActionEvents=B.TellMeActor.instance.xyg,ca.TellMeCommandClickMruEvents=B.TellMeActor.instance.sRg,ca.ContentType=B.TellMeActor.instance.nyd);this.oHe&&(X={},X.Application=this.qc.application,ca.TemplateInfo=X);return P.c(ca)}mKb(){return!!this.qc&&this.qc.mKb||
!!E.AFrameworkApplication.ua&&E.AFrameworkApplication.ua.Sb.mKb}nKb(){return!!this.qc&&this.qc.nKb||!!E.AFrameworkApplication.ua&&E.AFrameworkApplication.ua.Sb.nKb}oKb(){return!!this.qc&&this.qc.oKb||!!E.AFrameworkApplication.ua&&E.AFrameworkApplication.ua.Sb.oKb}qKb(){return!!this.qc&&this.qc.qKb||!!E.AFrameworkApplication.ua&&E.AFrameworkApplication.ua.Sb.qKb}Dec(){return!!this.qc&&(this.qc.Dec||this.qc.VQ)}JUn(){return!!this.qc&&!this.qc.L_a}bVn(){return!!this.qc&&this.qc.BPc}IUn(){return!!this.qc&&
this.qc.f9l&&this.qc.c9l}eii(){return!!E.AFrameworkApplication.K&&E.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeServiceEdogEndpointOverride",!1)}fii(){return!!E.AFrameworkApplication.K&&E.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeServiceProdEndpointOverride",!1)}VLl(){if(!E.AFrameworkApplication.K)return"";if(this.fii())return E.AFrameworkApplication.K.lb("TellMeServiceProdEndpointForSearch");if(this.eii())return E.AFrameworkApplication.K.lb("TellMeServiceEdogEndpointForSearch");
if(G.a.cqf())return E.AFrameworkApplication.K.lb("TellMeServiceIntEndpointForSearch");let X=E.AFrameworkApplication.K.lb("TellMeServiceSearchEndpoint");X&&""!==X||(X=E.AFrameworkApplication.$$i);return X}static Dvh(X,Y){if(Y)return new U(X,["Command","Recommended"],X.yrl);Y=G.a.xCa()?"Answer Definition Help WolframAnswer Image File People Notes Template Addin".split(" "):"Help WolframAnswer File People Notes Template Addin".split(" ");return new U(X,Y,X.jZh)}}Object(C.a)(U,"TellMeServiceProvider",
null,[1098])},1809:function(C,N,d){d.r(N);d.d(N,"MarkerValidation",function(){return a});C=d(0);var l=d(387),e=d(1715);class a{constructor(){this.bNd=this.e$h=this.d$h=this.c$h=0}DPh(){const k=new l.a(0);k.Z("InvalidBookmarks",this.c$h);k.Z("InvalidComments",this.d$h);k.Z("InvalidContentControls",this.e$h);0!==this.bNd&&k.Z("InvalidMarkerType",this.bNd);return k}V3h(){return 0<this.c$h||0<this.d$h||0<this.e$h||0!==this.bNd?!0:!1}toString(){return JSON.stringify(e.a.ywa(this.DPh()))}}Object(C.a)(a,
"MarkerValidation",null,[])},1810:function(C,N,d){d.d(N,"a",function(){return v});C=d(0);var l=d(150),e=d(1002),a=d(250),k=d(1598),n=d(1537);class v{constructor(u,t,y,B,G=null,F=null,K=null,O=null){this.ge=u;this.GE=t;this.rxa=y;this.Cya=B;this.yMj=G;this.eDj=F;this.OYj=K;this.Bpa=O||this.C_e()}C_e(){return u=>!!this.ge.runtime.Qb&&this.ge.runtime.Qb.isFeatureEnabled(u)}BJk(){return()=>this.ge.runtime.Qb}p5e(){return!!this.ge.runtime.lk.J(a.a.CK)}F6i(){let u;if(1===this.ge.input.source||2===this.ge.input.source)u=
82;else if(4===this.ge.input.source||3===this.ge.input.source)u=38;else if(5===this.ge.input.source)u=125;else return!1;return this.p5e()&&this.Bpa(u)}I8i(u,...t){return String.format.apply(null,[u].concat(t))}jHd(u){const {ParagraphMerge:t}=d(1849);let y=this.ge,B=this.rxa,G=this.Cya;u||(y=this.yMj||this.ge,B=this.eDj||B,G=this.OYj||G);var F=n.a.Cff(this.GE);const K=n.a.Cff(B),O=n.a.Cff(G);F=this.I8i("[MergeSource: {0}] [BaseRevisionId: {1}] [FavoredRevisionId: {2}] [UnfavoredRevisionId: {3}] [BaseObjects: {4}] [FavoredObjects: {5}] [UnfavoredObjects: {6}]",
y.input.source,y.runtime.Dza.id,y.runtime.fCd,y.runtime.nce,F.Dq(),K.Dq(),O.Dq());return u?{returnValue:new k.a(y,this.GE,B,G,this.C_e(),new e.a),Dq:F}:{returnValue:new t(y,this.GE,B,G,this.C_e(),this.BJk(),new e.a),Dq:F}}Ugc(){this.ge.logger.YMn();var u=this.F6i();var t=({Dq:B}=this.jHd(u)).returnValue;l.a.instance.Wa(18994389,1,4,"ParagraphMergeSelector TryDoMerge: [UseHints: {0}] {1}",u,B);this.ge.logger.YT("ParagraphMergeSelector initialization");u?this.ge.logger.e7d(1):this.ge.logger.e7d(2);
let y=({Rm:t}=t.Ugc()).returnValue;this.ge.logger.BYf();var B=!y;u=!!this.ge.runtime.lk.J(a.a.CK)&&(u&&!y||!u);B&&({Dq:B,returnValue:t}=this.jHd(!1),{Rm:t,returnValue:y}=t.Ugc(),l.a.instance.Wa(18994390,1,y?4:2,"ParagraphMergeSelector TryDoMerge Fallback: [Success: {0}] {1}",y,B));u&&(B=new e.a,n.a.exn(this.ge,B));this.ge.logger.YT("ParagraphMergeSelector finalization");return{returnValue:y,Rm:t}}A3c(u,t){let y,B,G;const F=this.F6i()&&this.Bpa(126);let K=({Dq:G}=this.jHd(F)).returnValue,O=({i2a:y,
Hna:B}=K.A3c(u,t)).returnValue;l.a.instance.Wa(18994391,1,4,"ParagraphMergeSelector UpdateCpAccordingToIncomingChange: [UseHints: {0}] {1}",F,G);F&&!O&&K.RUf&&({Dq:G,returnValue:K}=this.jHd(!1),{i2a:y,Hna:B,returnValue:O}=K.A3c(u,t),l.a.instance.Wa(18994392,1,O?4:2,"ParagraphMergeSelector UpdateCpAccordingToIncomingChange Fallback: [Success: {0}] {1}",O,G));return{returnValue:O,i2a:y,Hna:B}}}Object(C.a)(v,"ParagraphMergeSelector",null,[1741])},1811:function(C,N,d){d.r(N);d.d(N,"SurfaceStringTokenStringGenerator",
function(){return e});C=d(0);var l=d(1556);class e extends l.a{constructor(a){super(a);this.Ab=a}apply(a,k,n,v,u,t,y){null==t&&(t=a.i0h(u,k));y=l.a.z9g(a,t,this.Ab.score,n,v,y);return{z2c:t,Vzc:y}}}e.Wzc=0;Object(C.a)(e,"SurfaceStringTokenStringGenerator",l.a,[])},1812:function(C,N,d){d.r(N);d.d(N,"QueryTokenStringGenerator",function(){return a});C=d(0);var l=d(1556),e=d(1467);class a extends l.a{constructor(k){super(k);this.Ab=k}apply(k,n,v,u,t,y,B){n=this.Ab.query.load(n,null);t=0;let G=null;this.Ab.query.p3===
e.Annotations.ewa?n&&(G=this.Ab.name):((G=this.Ab.name)&&(G+="_"),G+=this.Ab.annotations.Hba(this.Ab.query.p3,n));null!=G&&(t=l.a.z9g(k,G,this.Ab.score,v,u,t));return{z2c:y,Vzc:B+t}}}a.Wzc=1;Object(C.a)(a,"QueryTokenStringGenerator",l.a,[])},1813:function(C,N,d){d.r(N);d.d(N,"FuzzyMatchTokenStringGenerator",function(){return e});C=d(0);var l=d(1556);class e extends l.a{constructor(a){super(a);this.Ab=a}apply(a,k,n,v,u,t,y){null==t&&(t=a.i0h(u,k));a=this.Ab.TEh.LCm(t);if(this.Ab.oBi)for(var B of a)if(!B.IN&&
B.$Cd)return{z2c:t,Vzc:y};B=0;for(const G of a)if(G.IN&&!({PUe:B}=this.ydh(G,!0,n,v,B)).returnValue)return{z2c:t,Vzc:y};if(this.Ab.e7h)for(const G of a)if(!({PUe:B}=this.ydh(G,!1,n,v,B)).returnValue)break;return{z2c:t,Vzc:y}}ydh(a,k,n,v,u){let t;k?(k=0,t=a.$Cd?1:0):(k=a.$Cd?1:0,t=a.count-k);for(let y=0;y<t;++y)if(l.a.A9g(a.Qcb+k+y,this.Ab.score,n,v),++u,0<this.Ab.zzf&&u>=this.Ab.zzf)return{returnValue:!1,PUe:u};return{returnValue:!0,PUe:u}}}e.Wzc=2;Object(C.a)(e,"FuzzyMatchTokenStringGenerator",l.a,
[])},1839:function(C,N,d){C=d(0);var l=d(5),e=d(45),a=d(244),k=d(1466);class n extends k.a{constructor(){super()}get Bn(){return 2}get Dz(){return 7}static nh(){return new n}static get instance(){return n.Kg.value}}n.Kg=new a.a(n.nh);Object(C.a)(n,"AppBindingNodeComplexMerge",k.a,[]);var v=d(17),u=d(789),t=d(150),y=d(1507);class B extends k.a{constructor(){super()}get Bn(){return 3}get Dz(){return 7}nk(){const Bb=super.nk();Bb.Z(u.a.yb(v.a.UT),1);return Bb}aB(Bb,jc){if(jc===u.a.yb(v.a.UT)){const nb=
Bb.Nk;var dc=Bb.$d;t.a.instance.Wa(6633221,1,4,"AppNodeComplexMerge: Running custom merge for [ObjectId: {0}] [ClassId: {1}] [PropertyId: {2}]",nb.id,nb.Qc,jc);jc=dc.getPropertyMilliseconds(Bb.Ng.value.Df,v.a.UT);dc=dc.getPropertyMilliseconds(Bb.Zm.value.Df,v.a.UT);jc<dc&&this.Gml(Bb);Bb.yg.add(u.a.yb(v.a.UT));return!0}t.a.instance.Wa(6633222,1,1,"AppNodeComplexMerge: Failed to merge AppNode [Id: {0}] due to a conflicting change on [PropertyId: {1}]",Bb.Ng.value.Df.id,jc);return!1}Gml(Bb){this.Ztn(Bb.Zm.value.Df,
Bb.Nk);this.rcf(Bb,l.a.NQe);this.rcf(Bb,l.a.Fbh);this.rcf(Bb,l.a.ubh)}rcf(Bb,jc){var dc=Bb.$d,nb=Bb.Nk;if(dc.hasProperty(nb,jc)&&(jc=dc.getPropertyObjectIds(nb,jc))&&jc.length)for(dc=Bb.Yo.runtime.lq,Bb=Bb.Yo.runtime.Rm,nb=0;nb<jc.length;nb++){const Gb=jc.J(nb);if(!dc.xb(Gb))continue;const lb=dc.J(Gb).HG();Bb.add(Gb,new y.a(lb,!1))}}static nh(){return new B}static get instance(){return B.Kg.value}}B.Kg=new a.a(B.nh);Object(C.a)(B,"AppNodeComplexMerge",k.a,[]);class G extends k.a{constructor(){super()}get Bn(){return 4}get Dz(){return 7}static nh(){return new G}static get instance(){return G.Kg.value}}
G.Kg=new a.a(G.nh);Object(C.a)(G,"AppPropNodeComplexMerge",k.a,[]);class F extends k.a{constructor(){super()}get Bn(){return 5}get Dz(){return 7}static nh(){return new F}static get instance(){return F.Kg.value}}F.Kg=new a.a(F.nh);Object(C.a)(F,"AppRefNodeComplexMerge",k.a,[]);var K=d(387),O=d(619),H=d(216),I=d(16);class J{constructor(Bb,jc){this.id=Bb;this.r1n=jc}}Object(C.a)(J,"IdAndTime",null,[]);class L extends k.a{constructor(){super()}get Bn(){return 6}nk(){const Bb=super.nk();Bb.Z(u.a.yb(l.a.yVa),
1);return Bb}aB(Bb,jc){if(jc===u.a.yb(l.a.yVa)){const dc=Bb.Nk,nb=Bb.$d;t.a.instance.Wa(6633224,1,4,"AppsNodeComplexMerge: Running custom merge for [ObjectId: {0}] [ClassId: {1}] [PropertyId: {2}]",dc.id,dc.Qc,jc);jc=nb.getPropertyObjectIds(Bb.Ng.value.ku,l.a.yVa);const Gb=nb.getPropertyObjectIds(Bb.Ng.value.Df,l.a.yVa),lb=nb.getPropertyObjectIds(Bb.Zm.value.Df,l.a.yVa);jc=this.UGm(Bb,jc,Gb,lb);0<jc.length?nb.setPropertyObjectIds(dc,l.a.yVa,jc):dc.removeProperty(l.a.yVa);Bb.yg.add(u.a.yb(l.a.yVa));
return!0}t.a.instance.Wa(6633225,1,1,"AppsNodeComplexMerge: Failed to merge AppsNode [Id: {0}] due to a conflicting change on [PropertyId: {1}]",Bb.Ng.value.Df.id,jc);return!1}UGm(Bb,jc,dc,nb){const Gb=this.PCa(jc,dc,nb),lb=jc.cG(),Kb=dc.cG(),Vb=nb.cG();jc=k.a.filter(Gb,Zc=>!lb.contains(Zc)&&Kb.contains(Zc));dc=k.a.filter(Gb,Zc=>!lb.contains(Zc)&&Vb.contains(Zc));if(!jc.length||!dc.length)return Gb;const vc=new K.a;jc.forEach(Zc=>{const td=new J(Zc,this.pMh(Bb,Zc,!1));this.lMh(Bb,Zc,!1).forEach(xd=>
{vc.add(xd,td);return!0});return!0});const Fc=new O.a;dc.forEach(Zc=>{const td=this.pMh(Bb,Zc,!0);this.lMh(Bb,Zc,!0).forEach(xd=>vc.xb(xd)?(Fc.add(vc.J(xd).r1n>=td?Zc:vc.J(xd).id),!1):!0);return!0});return k.a.filter(Gb,Zc=>!Fc.contains(Zc))}pMh(Bb,jc,dc){return(jc=this.bta(Bb,jc,dc))?Bb.$d.getPropertyMilliseconds(jc,v.a.UT):0}bta(Bb,jc,dc){Bb=dc?Bb.Yo.runtime.lq:Bb.Yo.runtime.Yt;return Bb.xb(jc)?Bb.J(jc):null}lMh(Bb,jc,dc){const nb=new H.a,Gb=new O.a,lb=Bb.$d;jc=this.bta(Bb,jc,dc);var Kb=this.IXh(lb,
jc);if(Kb)for(nb.add(Kb),Gb.add(Kb),jc=lb.getPropertyObjectIds(jc,l.a.NQe),Kb=0;jc&&Kb<jc.length;Kb++){const Vb=this.IXh(lb,this.bta(Bb,jc.J(Kb),dc));if(!Vb)break;Gb.contains(Vb)||(nb.add(Vb),Gb.add(Vb))}return nb}IXh(Bb,jc){if(!Bb.hasProperty(jc,l.a.W$a)||!Bb.hasProperty(jc,l.a.zXb)||!Bb.hasProperty(jc,l.a.AXb))return null;const dc=Bb.getPropertyString(jc,l.a.W$a),nb=Bb.getPropertyString(jc,l.a.zXb);Bb=Bb.getPropertyString(jc,l.a.AXb);return I.a.Wz(dc+";"+nb+";"+Bb)}static nh(){return new L}static get instance(){return L.Kg.value}}
L.Kg=new a.a(L.nh);Object(C.a)(L,"AppsNodeComplexMerge",k.a,[]);class S extends k.a{constructor(){super()}get Bn(){return 36}nk(){const Bb=super.nk();Bb.Z(u.a.yb(l.a.o8f),1);Bb.Z(u.a.yb(l.a.OYf),1);return Bb}aB(Bb,jc){t.a.instance.Wa(51430790,1,4,"AutoSaveParametersNode PropertyId {0}: Using CustomMerge Strategy",jc);if(jc===u.a.yb(l.a.o8f)||jc===u.a.yb(l.a.OYf)){const lb=u.a.yW(jc);var dc=Bb.Ng.value.Df,nb=Bb.Zm.value.Df;const Kb=Bb.Nk;var Gb=Bb.$d.getPropertyStrings(Bb.Ng.value.ku,lb);dc=Bb.$d.getPropertyStrings(dc,
lb);nb=Bb.$d.getPropertyStrings(nb,lb);Gb=this.PCa(Gb,dc,nb);Bb.$d.setPropertyStrings(Kb,lb,Gb);Bb.yg.add(jc);return!0}return!1}static nh(){return new S}static get instance(){return S.Kg.value}}S.Kg=new a.a(S.nh);Object(C.a)(S,"AutoSaveParametersNodeComplexMerge",k.a,[]);class E extends k.a{constructor(){super()}get Bn(){return 44}nk(){const Bb=super.nk();Bb.Z(u.a.yb(v.a.qf),1);return Bb}aB(Bb,jc){const dc=Bb.Yo.runtime.Qb;if(jc===u.a.yb(v.a.qf))return t.a.instance.Wa(589608865,1,4,"BookmarkContainerNodeComplexMerge: Running custom merge for [ObjectId: {0}] [ClassId: {1}] [PropertyId: {2}]",
Bb.Nk.id,Bb.Nk.Qc,jc),dc.Vq(131),dc.isFeatureEnabled(131)?this.XGm(Bb,jc):this.sHm(Bb,jc),!0;t.a.instance.Wa(589608912,1,1,"BookmarkContainerNodeComplexMerge: Failed to merge BookmarkContainer [Id: {0}].Custom merge is not handled on [PropertyId: {1}]",Bb.Ng.value.Df.id,jc);return!1}XGm(Bb,jc){const dc=u.a.yW(jc),nb=Bb.$d;var Gb=nb.getPropertyObjectIds(Bb.Ng.value.ku,dc),lb=nb.getPropertyObjectIds(Bb.Ng.value.Df,dc),Kb=nb.getPropertyObjectIds(Bb.Zm.value.Df,dc);Kb=E.ONl(Bb,lb,Kb);Gb=this.PCa(Gb,lb,
Kb);lb=Bb.Nk;0<Gb.length?nb.setPropertyObjectIds(lb,dc,Gb):lb.removeProperty(dc);Bb.yg.add(jc)}static nh(){return new E}static get instance(){return E.Kg.value}static ONl(Bb,jc,dc){const nb=new H.a,Gb=new K.a;jc.forEach(lb=>{const Kb=Bb.Yo.runtime.Yt.J(lb);Kb&&Gb.add(Kb.$P(l.a.Ts).toString(),lb);return!0});dc.forEach(lb=>{var Kb=Bb.Yo.runtime.lq.J(lb);Kb?(Kb=Kb.$P(l.a.Ts).toString(),Gb.xb(Kb)&&Gb.get(Kb)!==lb?t.a.instance.Wa(557061773,1,4,"BookmarkContainerNodeComplexMerge: Similar name bookmark found during merge, skipping conflict revision bookmark"):
nb.add(lb)):nb.add(lb);return!0});return nb}}E.Kg=new a.a(E.nh);Object(C.a)(E,"BookmarkContainerNodeComplexMerge",k.a,[]);class P extends k.a{constructor(){super()}get Bn(){return 41}nk(){const Bb=super.nk();Bb.Z(u.a.yb(l.a.Xvb),1);Bb.Z(u.a.yb(l.a.Ts),1);return Bb}aB(Bb,jc){return jc===u.a.yb(l.a.Xvb)?(Bb.yg.add(u.a.yb(l.a.Xvb)),!0):jc===u.a.yb(l.a.Ts)?(Bb.yg.add(u.a.yb(l.a.Ts)),!0):!1}mf(Bb){return Bb&&Bb.length?!1:!0}static nh(){return new P}static get instance(){return P.Kg.value}}P.Kg=new a.a(P.nh);
Object(C.a)(P,"BookmarkNodeComplexMerge",k.a,[]);class T extends k.a{constructor(){super();this.RNd=!1}get Bn(){return 7}nk(){const Bb=super.nk();Bb.Z(u.a.yb(v.a.qf),1);return Bb}aB(Bb,jc){if(jc===u.a.yb(v.a.qf)){const Gb=Bb.Nk,lb=Bb.$d;var dc=Bb.Yo.runtime.Qb;dc&&(this.RNd=dc.isFeatureEnabled(76));t.a.instance.Wa(4511579,1,4,"CommentContentNodeComplexMerge: Running custom merge for [ObjectId: {0}] [ClassId: {1}] [PropertyId: {2}]",Gb.id,Gb.Qc,jc);jc=lb.getPropertyObjectIds(Bb.Ng.value.ku,v.a.qf);
dc=lb.getPropertyObjectIds(Bb.Ng.value.Df,v.a.qf);var nb=lb.getPropertyObjectIds(Bb.Zm.value.Df,v.a.qf);jc=this.gHm(jc,dc,nb);if(this.RNd&&0<jc.length){dc=new Sys.StringBuilder;for(nb=0;nb<jc.length;nb++)dc.append(jc.J(nb).toString()+",");t.a.instance.Wa(559710276,1,4,"Merge result for CommentContentNode {0}: {1}",Gb.id,dc.toString())}0<jc.length?lb.setPropertyObjectIds(Gb,v.a.qf,jc):Gb.removeProperty(v.a.qf);Bb.yg.add(u.a.yb(v.a.qf));return!0}t.a.instance.Wa(4511580,1,1,"CommentContentNodeComplexMerge: Failed to merge CommentContainer [Id: {0}] due to a conflicting change on [PropertyId: {1}]",
Bb.Ng.value.Df.id,jc);return!1}gHm(Bb,jc,dc){const nb=new H.a,Gb=new K.a(0);this.k8k(Bb,dc,nb,Gb);return this.iVk(jc,Gb,nb)}k8k(Bb,jc,dc,nb){Bb=Bb||new H.a;jc=jc||new H.a;Bb.forEach(Gb=>{nb.Z(Gb,1);return!0});jc.forEach(Gb=>{nb.Dc(Gb).returnValue?nb.Z(Gb,2):(nb.Z(Gb,0),dc.add(Gb));return!0})}iVk(Bb,jc,dc){Bb=Bb||new H.a;const nb=new H.a,Gb=new H.a,lb=new H.a;Bb.forEach(Kb=>{let Vb=!0,vc;({value:vc}=jc.Dc(Kb)).returnValue&&(0===vc?jc.Z(Kb,2):1===vc&&(Vb=!1));Vb?nb.add(Kb):this.RNd&&Gb.add(Kb);return!0});
dc.forEach(Kb=>{let Vb=!1,vc;({value:vc}=jc.Dc(Kb)).returnValue?0===vc&&(Vb=!0,jc.Z(Kb,2)):t.a.instance.Wa(4511585,1,4,"DetermineMergedListOfCommentNodes: Expected to find Conflicting Comment with [ObjectID: {0}] in conflictChangesMap, but it was not there.",Kb);Vb?nb.add(Kb):this.RNd&&lb.add(Kb);return!0});this.sni(Gb,"Favored");this.sni(lb,"Unfavored");return nb}sni(Bb,jc){if(Bb.length){var dc=new Sys.StringBuilder;for(let nb=0;nb<Bb.length;nb++)dc.append(Bb.J(nb).toString()+",");t.a.instance.Wa(561637572,
1,4,"DetermineMergedListOfCommentNodes: Removed {0} ObjectIds: {1}",jc,dc.toString())}}static nh(){return new T}static get instance(){return T.Kg.value}}T.Kg=new a.a(T.nh);Object(C.a)(T,"CommentContentNodeComplexMerge",k.a,[]);class U extends k.a{constructor(){super()}get Bn(){return 8}nk(){const Bb=super.nk();Bb.Z(u.a.yb(l.a.F9),3);Bb.Z(u.a.yb(l.a.iE),3);Bb.Z(u.a.yb(l.a.tBc),2);Bb.Z(u.a.yb(l.a.commentId),2);Bb.Z(u.a.yb(l.a.jph),2);Bb.Z(u.a.yb(l.a.Aza),2);Bb.Z(u.a.yb(l.a.WJa),1);Bb.Z(u.a.yb(l.a.Heb),
1);Bb.Z(u.a.yb(l.a.Lfb),1);Bb.Z(u.a.yb(l.a.H5),1);Bb.Z(u.a.yb(l.a.HF),1);Bb.Z(u.a.yb(l.a.sBc),2);Bb.Z(u.a.yb(l.a.Fvd),2);Bb.Z(u.a.yb(l.a.sZb),2);Bb.Z(u.a.yb(l.a.eYe),2);Bb.Z(u.a.yb(l.a.mL),1);Bb.Z(u.a.yb(v.a.qf),0);Bb.Z(u.a.yb(l.a.JG),0);return Bb}aB(Bb,jc){if(jc===u.a.yb(l.a.mL)){var dc=Bb.$d.getPropertyString(Bb.Zm.value.Df,l.a.mL);this.mf(dc)?Bb.Nk.removeProperty(l.a.mL):Bb.Nk.Jva(l.a.mL,dc);return!0}if(jc!==u.a.yb(l.a.WJa)&&jc!==u.a.yb(l.a.Heb)&&jc!==u.a.yb(l.a.Lfb)&&jc!==u.a.yb(l.a.HF)&&jc!==
u.a.yb(l.a.H5))return!1;var nb=Bb.Ng.value.Df,Gb=Bb.Zm.value.Df;dc=Bb.Nk;if(jc===u.a.yb(l.a.WJa)){nb=Bb.$d.getPropertyString(nb,l.a.WJa);Gb=Bb.$d.getPropertyString(Gb,l.a.WJa);Gb=this.mf(nb)?Gb:this.mf(Gb)?nb:null;if(this.mf(Gb))return!0;Bb.$d.setPropertyString(dc,l.a.WJa,Gb);Bb.yg.add(u.a.yb(l.a.WJa));return!0}if(jc===u.a.yb(l.a.Lfb))return nb=Bb.$d.getPropertyBool(nb,l.a.Lfb),Gb=Bb.$d.getPropertyBool(Gb,l.a.Lfb),nb=null!=nb?nb:!1,nb=(null!=Gb?Gb:!1)||nb,Bb.$d.setPropertyBool(dc,l.a.Lfb,nb),Bb.yg.add(u.a.yb(l.a.Lfb)),
!0;if(jc===u.a.yb(l.a.Heb)){nb=Bb.$d.getPropertyBool(nb,l.a.Heb);Gb=Bb.$d.getPropertyBool(Gb,l.a.Heb);if(nb===Gb)return!0;nb=null!=nb?nb:!1;nb=(null!=Gb?Gb:!1)||nb;Bb.$d.setPropertyBool(dc,l.a.Heb,nb);return!0}if(jc===u.a.yb(l.a.HF)){nb=Bb.$d.getPropertyBool(nb,l.a.HF);Gb=Bb.$d.getPropertyBool(Gb,l.a.HF);if(nb===Gb)return!0;nb=null!=nb?nb:!1;nb=(null!=Gb?Gb:!1)||nb;Bb.$d.setPropertyBool(dc,l.a.HF,nb);Bb.yg.add(u.a.yb(l.a.HF));return!0}if(jc===u.a.yb(l.a.H5)){jc=Bb.Yo.runtime.Qb;jc.Vq(15);if(!jc.isFeatureEnabled(15))return!1;
nb=Bb.$d.getPropertyString(nb,l.a.H5);Gb=Bb.$d.getPropertyString(Gb,l.a.H5);if(nb===Gb)return!0;Bb.$d.setPropertyString(dc,l.a.H5,Gb||nb);Bb.yg.add(u.a.yb(l.a.H5));return!0}return!1}mf(Bb){return Bb&&Bb.length?!1:!0}static nh(){return new U}static get instance(){return U.Kg.value}}U.Kg=new a.a(U.nh);Object(C.a)(U,"CommentNodeComplexMerge",k.a,[]);class X extends k.a{constructor(){super()}get Bn(){return 46}nk(){const Bb=super.nk();Bb.Z(u.a.yb(l.a.contentControlNode),1);Bb.Z(u.a.yb(v.a.lastModifiedTime),
0);Bb.Z(u.a.yb(l.a.YBc),2);return Bb}aB(Bb,jc){if(jc===u.a.yb(l.a.contentControlNode))return t.a.instance.Wa(556865370,1,4,"ContentControlContainerNodeComplexMerge: Running custom merge for [ObjectId: {0}] [ClassId: {1}] [PropertyId: {2}]",Bb.Nk.id,Bb.Nk.Qc,jc),k.a.Uzf(Bb,this,l.a.contentControlNode);t.a.instance.Wa(556865371,1,1,"ContentControlContainerNodeComplexMerge: Failed to merge ContentControlContainerNode [Id: {0}].Custom merge is not handled on [PropertyId: {1}]",Bb.Ng.value.Df.id,jc);return!1}static nh(){return new X}static get instance(){return X.Kg.value}}
X.Kg=new a.a(X.nh);Object(C.a)(X,"ContentControlContainerNodeComplexMerge",k.a,[]);var Y=d(59),ca=d(1704);class da extends k.a{constructor(){super()}get Bn(){return 37}nk(){const Bb=super.nk();Bb.Z(u.a.yb(l.a.J5),1);Bb.Z(u.a.yb(l.a.Nlb),1);Bb.Z(u.a.yb(l.a.ywd),2);Bb.Z(u.a.yb(l.a.JZb),2);Bb.Z(u.a.yb(l.a.contentControlNode),1);Bb.Z(u.a.yb(l.a.u6),1);Bb.Z(u.a.yb(l.a.Hda),1);Bb.Z(u.a.yb(l.a.MZb),1);Bb.Z(u.a.yb(l.a.$Bc),1);Bb.Z(u.a.yb(l.a.ibb),1);Bb.Z(u.a.yb(l.a.hbb),1);Bb.Z(u.a.yb(l.a.oZe),2);Bb.Z(u.a.yb(l.a.ZBc),
1);Bb.Z(u.a.yb(l.a.zwd),1);Bb.Z(u.a.yb(l.a.I5),1);return Bb}aB(Bb,jc){var dc=Bb.Ng.value.Df,nb=Bb.Zm.value.Df;const Gb=Bb.Nk;if(jc===u.a.yb(l.a.contentControlNode))return k.a.Uzf(Bb,this,l.a.contentControlNode);if(jc===u.a.yb(l.a.u6)){jc=Bb.$d.getPropertyBool(dc,l.a.u6);nb=Bb.$d.getPropertyBool(nb,l.a.u6);if(null!=jc&&jc||null!=nb&&nb)Bb.$d.setPropertyBool(Gb,l.a.u6,!0),Bb.yg.add(u.a.yb(l.a.u6));return!0}if(jc===u.a.yb(l.a.Hda))return jc=Bb.$d.getPropertyBool(dc,l.a.Hda),nb=Bb.$d.getPropertyBool(nb,
l.a.Hda),Bb.$d.setPropertyBool(Gb,l.a.Hda,null!=jc&&!!jc&&null!=nb&&!!nb),Bb.yg.add(u.a.yb(l.a.Hda)),!0;if(jc===u.a.yb(l.a.MZb))return jc=Bb.$d.getPropertyUint32(nb,l.a.MZb),null!=jc&&(Bb.$d.setPropertyUint32(Gb,l.a.MZb,jc),Bb.yg.add(u.a.yb(l.a.MZb))),!0;if(jc===u.a.yb(l.a.$Bc)||jc===u.a.yb(l.a.ibb)||jc===u.a.yb(l.a.hbb))return(nb=Bb.$d.getPropertyString(nb,u.a.yW(jc)))&&0<nb.length&&(Bb.$d.setPropertyString(Gb,u.a.yW(jc),nb),Bb.yg.add(jc)),!0;if(jc===u.a.yb(l.a.ZBc)||jc===u.a.yb(l.a.zwd)){dc=Bb.$d.getPropertyObjectId(dc,
u.a.yW(jc));if(ca.a.Q2b(Bb.Yo,dc))return!0;if((nb=Bb.$d.getPropertyObjectId(nb,u.a.yW(jc)))&&nb!==Y.a.nil)return Bb.$d.setPropertyObjectId(Gb,u.a.yW(jc),nb),Bb.yg.add(jc),!0;Gb.removeProperty(u.a.yW(jc));Bb.yg.add(jc);return!0}if(jc===u.a.yb(l.a.I5)){dc=Bb.$d.getPropertyObjectId(dc,l.a.I5);if((dc=ca.a.Q2b(Bb.Yo,dc))&&Bb.$d.getPropertyObjectIds(dc,l.a.contentControlNode).cG().contains(Bb.Nk.id))return!0;nb=Bb.$d.getPropertyObjectId(nb,l.a.I5);return(dc=ca.a.Q2b(Bb.Yo,nb))&&Bb.$d.getPropertyObjectIds(dc,
l.a.contentControlNode).cG().contains(Bb.Nk.id)?(Bb.$d.setPropertyObjectId(Gb,l.a.I5,nb),Bb.yg.add(jc),!0):!1}if(jc===u.a.yb(l.a.J5))return jc=Bb.$d.getPropertyBool(nb,l.a.J5),null==jc||jc||(Bb.$d.setPropertyBool(Gb,l.a.J5,!1),Bb.yg.add(u.a.yb(l.a.J5))),!0;if(jc===u.a.yb(l.a.Nlb)){jc=Bb.$d.getPropertyObjectId(dc,l.a.Nlb);nb=Bb.$d.getPropertyObjectId(nb,l.a.Nlb);if(jc&&!jc.equals(nb))return!1;if(jc=jc||nb)Bb.$d.setPropertyObjectId(Gb,l.a.Nlb,jc),Bb.yg.add(u.a.yb(l.a.Nlb));return!0}return!1}static nh(){return new da}static get instance(){return da.Kg.value}}
da.Kg=new a.a(da.nh);Object(C.a)(da,"ContentControlNodeComplexMerge",k.a,[]);class ua extends k.a{constructor(){super()}get Bn(){return 10}nk(){const Bb=super.nk();Bb.Z(u.a.yb(l.a.customXmlPartNode),1);return Bb}aB(Bb,jc){if(jc===u.a.yb(l.a.customXmlPartNode)){jc=Bb.Nk;const nb=Bb.$d;var dc=nb.getPropertyObjectIds(Bb.Ng.value.ku,l.a.customXmlPartNode);const Gb=nb.getPropertyObjectIds(Bb.Ng.value.Df,l.a.customXmlPartNode),lb=nb.getPropertyObjectIds(Bb.Zm.value.Df,l.a.customXmlPartNode);dc=this.lHm(dc,
Gb,lb);0<dc.length?nb.setPropertyObjectIds(jc,l.a.customXmlPartNode,dc):jc.removeProperty(l.a.customXmlPartNode);Bb.yg.add(u.a.yb(l.a.customXmlPartNode));return!0}return!1}lHm(Bb,jc,dc){return this.PCa(Bb,jc,dc)}static nh(){return new ua}static get instance(){return ua.Kg.value}}ua.Kg=new a.a(ua.nh);Object(C.a)(ua,"CustomXmlPartContainerNodeComplexMerge",k.a,[]);class ra extends k.a{constructor(){super()}get Bn(){return 9}get Dz(){return 0}static nh(){return new ra}static get instance(){return ra.Kg.value}}
ra.Kg=new a.a(ra.nh);Object(C.a)(ra,"CustomXmlPartNodeComplexMerge",k.a,[]);class qa extends k.a{constructor(){super()}get Bn(){return 29}get Dz(){return 3}nk(){const Bb=super.nk();Bb.Z(u.a.yb(l.a.embeddedFontNode),1);return Bb}aB(Bb,jc){if(jc===u.a.yb(l.a.embeddedFontNode)){jc=Bb.$d;var dc=jc.getPropertyObjectIds(Bb.Ng.value.ku,l.a.embeddedFontNode),nb=jc.getPropertyObjectIds(Bb.Ng.value.Df,l.a.embeddedFontNode);const Gb=jc.getPropertyObjectIds(Bb.Zm.value.Df,l.a.embeddedFontNode);dc=this.PCa(dc,
nb,Gb);nb=Bb.Nk;0<dc.length?jc.setPropertyObjectIds(nb,l.a.embeddedFontNode,dc):nb.removeProperty(l.a.embeddedFontNode);Bb.yg.add(u.a.yb(l.a.embeddedFontNode));return!0}return!1}static nh(){return new qa}static get instance(){return qa.Kg.value}}qa.Kg=new a.a(qa.nh);Object(C.a)(qa,"EmbeddedFontContainerNodeComplexMerge",k.a,[]);class ka extends k.a{constructor(){super()}get Bn(){return 30}get Dz(){return 3}static nh(){return new ka}static get instance(){return ka.Kg.value}}ka.Kg=new a.a(ka.nh);Object(C.a)(ka,
"EmbeddedFontNodeComplexMerge",k.a,[]);class la extends k.a{constructor(){super()}get Bn(){return 11}nk(){const Bb=super.nk();Bb.Z(u.a.yb(l.a.a6),4);Bb.Z(u.a.yb(l.a.SXa),1);return Bb}aB(Bb,jc){if(jc===u.a.yb(l.a.SXa)){const dc=Bb.Nk,nb=Bb.$d;t.a.instance.Wa(4063307,1,4,"FootnoteEndnoteContainerNodeComplexMerge: Running custom merge for [ObjectId: {0}] [ClassId: {1}] [PropertyId: {2}]",dc.id,dc.Qc,jc);jc=nb.getPropertyObjectIds(Bb.Ng.value.ku,l.a.SXa);const Gb=nb.getPropertyObjectIds(Bb.Ng.value.Df,
l.a.SXa),lb=nb.getPropertyObjectIds(Bb.Zm.value.Df,l.a.SXa);jc=this.Yqi(jc,Gb,lb,(Kb,Vb)=>Kb.equals(Vb));0<jc.length?nb.setPropertyObjectIds(dc,l.a.SXa,jc):dc.removeProperty(l.a.SXa);Bb.yg.add(u.a.yb(l.a.SXa));return!0}t.a.instance.Wa(4063308,1,1,"FootnoteEndnoteContainerNodeComplexMerge: Failed to merge FootnoteEndnoteContainer [Id: {0}] due to a conflicting change on [PropertyId: {1}]",Bb.Ng.value.Df.id,jc);return!1}static nh(){return new la}static get instance(){return la.Kg.value}}la.Kg=new a.a(la.nh);
Object(C.a)(la,"FootnoteEndnoteContainerNodeComplexMerge",k.a,[]);class Ha extends k.a{constructor(){super()}get Bn(){return 12}get Dz(){return 3}nk(){const Bb=super.nk();Bb.Z(u.a.yb(l.a.Zka),1);return Bb}aB(Bb,jc){const dc=Bb.Nk,nb=Bb.$d;if(jc===u.a.yb(l.a.Zka)){let Gb=-1;t.a.instance.Wa(5002527,1,4,"FootnoteEndnoteNodeComplexMerge: Running custom merge for [ObjectId: {0}] [ClassId: {1}] [PropertyId: {2}]",dc.id,dc.Qc,jc);const lb=nb.getPropertyInt32(Bb.Ng.value.Df,l.a.Zka),Kb=nb.getPropertyInt32(Bb.Zm.value.Df,
l.a.Zka);null!=lb&&-1!==lb?Gb=lb:null!=Kb&&(Gb=Kb);nb.setPropertyInt32(dc,l.a.Zka,Gb);Bb.yg.add(jc);return!0}t.a.instance.Wa(5002528,1,4,"FootnoteEndnoteNodeComplexMerge: Failed to merge FootnoteEndnoteNodeComplexMerge [Id: {0}] due to a conflicting change on [PropertyId: {1}]",Bb.Ng.value.ku.id,jc);return!1}static nh(){return new Ha}static get instance(){t.a.instance.Wa(5002526,1,4,"FootnoteEndnoteNodeComplexMerge: Got Instance");return Ha.Kg.value}}Ha.Kg=new a.a(Ha.nh);Object(C.a)(Ha,"FootnoteEndnoteNodeComplexMerge",
k.a,[]);class wa extends k.a{constructor(){super()}get Bn(){return 47}nk(){const Bb=super.nk();Bb.Z(u.a.yb(l.a.glossaryPageContentNode),1);return Bb}aB(Bb,jc){return jc===u.a.yb(l.a.glossaryPageContentNode)?(t.a.instance.Wa(525099865,1,4,"GlossaryPageManifestNodeComplexMerge: Running custom merge for [ObjectId: {0}] [ClassId: {1}] [PropertyId: {2}]",Bb.Nk.id,Bb.Nk.Qc,jc),k.a.Uzf(Bb,this,l.a.glossaryPageContentNode)):!1}static nh(){return new wa}static get instance(){return wa.Kg.value}}wa.Kg=new a.a(wa.nh);
Object(C.a)(wa,"GlossaryPageManifestNodeComplexMerge",k.a,[]);class Ca extends k.a{constructor(){super()}get Bn(){return 13}get Dz(){return 3}nk(){const Bb=super.nk();Bb.Z(u.a.yb(l.a.Ega),4);return Bb}static nh(){return new Ca}static get instance(){return Ca.Kg.value}}Ca.Kg=new a.a(Ca.nh);Object(C.a)(Ca,"HeaderFooterContainerNodeComplexMerge",k.a,[]);class Ja extends k.a{constructor(){super()}get Bn(){return 14}get Dz(){return 3}nk(){const Bb=super.nk();Bb.Z(u.a.yb(l.a.runId),3);Bb.Z(u.a.yb(l.a.Nc),
3);Bb.Z(u.a.yb(l.a.V$h),3);Bb.Z(u.a.yb(l.a.yT),1);Bb.Z(u.a.yb(e.a.CZ),1);Bb.Z(u.a.yb(v.a.imageAltText),1);Bb.Z(u.a.yb(l.a.PW),1);Bb.Z(u.a.yb(v.a.Laa),1);Bb.Z(u.a.yb(e.a.B4a),1);Bb.Z(u.a.yb(l.a.R$a),1);return Bb}aB(Bb,jc){if(jc===u.a.yb(v.a.imageAltText)||jc===u.a.yb(l.a.PW)||jc===u.a.yb(l.a.yT)||jc===u.a.yb(l.a.QW)||jc===u.a.yb(v.a.Teb)||jc===u.a.yb(v.a.Laa)||jc===u.a.yb(e.a.CZ)||jc===u.a.yb(e.a.B4a)||jc===u.a.yb(l.a.R$a)){const nb=Bb.Nk;var dc=Bb.$d;t.a.instance.Wa(4018185,1,4,"ImageNodeComplexMerge: Running custom merge for [ObjectId: {0}] [ClassId: {1}] [PropertyId: {2}]",
nb.id,nb.Qc,jc);const Gb=dc.getPropertyInt32(Bb.Ng.value.Df,e.a.CZ);dc=dc.getPropertyInt32(Bb.Zm.value.Df,e.a.CZ);if(null!=Gb&&(0===Gb||2===Gb))return!0;if(null!=dc&&(0===dc||2===dc))return jc=Bb.Zm.value.Df,this.pbb(jc,nb,v.a.imageAltText),this.pbb(jc,nb,l.a.PW),this.pbb(jc,nb,l.a.QW),jc.hasProperty(l.a.yT)&&this.pbb(jc,nb,l.a.yT),this.pbb(jc,nb,v.a.Teb),this.pbb(jc,nb,v.a.Laa),this.pbb(jc,nb,e.a.CZ),this.pbb(jc,nb,e.a.B4a),Bb.yg.add(u.a.yb(v.a.imageAltText)),Bb.yg.add(u.a.yb(l.a.PW)),Bb.yg.add(u.a.yb(l.a.QW)),
Bb.yg.add(u.a.yb(l.a.yT)),Bb.yg.add(u.a.yb(v.a.Teb)),Bb.yg.add(u.a.yb(v.a.Laa)),Bb.yg.add(u.a.yb(e.a.CZ)),Bb.yg.add(u.a.yb(e.a.B4a)),Bb.yg.add(u.a.yb(l.a.R$a)),!0}t.a.instance.Wa(4018186,1,4,"ImageNodeComplexMerge: Failed to merge ImageNode [Id: {0}] due to a conflicting change on [PropertyId: {1}]",Bb.Ng.value.ku.id,jc);return!1}static nh(){return new Ja}static get instance(){return Ja.Kg.value}}Ja.Kg=new a.a(Ja.nh);Object(C.a)(Ja,"ImageNodeComplexMerge",k.a,[]);class bb extends k.a{constructor(){super()}get Bn(){return 40}get Dz(){return 0}static nh(){return new bb}static get instance(){return bb.Kg.value}}
bb.Kg=new a.a(bb.nh);Object(C.a)(bb,"IntelligenceAnnotationNodeComplexMerge",k.a,[]);class ha extends k.a{constructor(){super()}get Bn(){return 32}get Dz(){return 0}static nh(){return new ha}static get instance(){return ha.Kg.value}}ha.Kg=new a.a(ha.nh);Object(C.a)(ha,"IntelligenceContentLocatorNodeComplexMerge",k.a,[]);class ia extends k.a{constructor(){super()}get Bn(){return 34}get Dz(){return 0}nk(){const Bb=super.nk();Bb.Z(u.a.yb(l.a.yfb),1);return Bb}aB(Bb,jc){const dc=Bb.Nk,nb=Bb.$d;if(jc===
u.a.yb(l.a.yfb)){jc=nb.getPropertyObjectIds(Bb.Ng.value.ku,l.a.yfb);const Gb=nb.getPropertyObjectIds(Bb.Ng.value.Df,l.a.yfb),lb=nb.getPropertyObjectIds(Bb.Zm.value.Df,l.a.yfb);jc=this.PCa(jc,Gb,lb);nb.setPropertyObjectIds(dc,l.a.yfb,jc);Bb.yg.add(u.a.yb(l.a.yfb));return!0}return!1}static nh(){return new ia}static get instance(){return ia.Kg.value}}ia.Kg=new a.a(ia.nh);Object(C.a)(ia,"IntelligenceRegionNodeComplexMerge",k.a,[]);class va extends k.a{constructor(){super()}get Bn(){return 35}get Dz(){return 0}static nh(){return new va}static get instance(){return va.Kg.value}}
va.Kg=new a.a(va.nh);Object(C.a)(va,"IntelligenceRejectionNodeComplexMerge",k.a,[]);class Ka extends k.a{constructor(){super()}get Bn(){return 39}get Dz(){return 0}static nh(){return new Ka}static get instance(){return Ka.Kg.value}}Ka.Kg=new a.a(Ka.nh);Object(C.a)(Ka,"IntelligenceReviewedNodeComplexMerge",k.a,[]);class Xa extends k.a{constructor(){super()}get Bn(){return 33}get Dz(){return 0}nk(){const Bb=super.nk();Bb.Z(u.a.yb(l.a.OMc),1);Bb.Z(u.a.yb(l.a.SMd),1);Bb.Z(u.a.yb(l.a.wof),1);Bb.Z(u.a.yb(l.a.yof),
1);return Bb}aB(Bb,jc){const dc=Bb.Nk,nb=Bb.$d;if(jc===u.a.yb(l.a.OMc)||jc===u.a.yb(l.a.SMd)||jc===u.a.yb(l.a.wof)||jc===u.a.yb(l.a.yof)){jc=jc===u.a.yb(l.a.OMc)?l.a.OMc:l.a.SMd;var Gb=nb.getPropertyObjectIds(Bb.Ng.value.ku,jc);const lb=nb.getPropertyObjectIds(Bb.Ng.value.Df,jc),Kb=nb.getPropertyObjectIds(Bb.Zm.value.Df,jc);Gb=this.PCa(Gb,lb,Kb);nb.setPropertyObjectIds(dc,jc,Gb);Bb.yg.add(u.a.yb(jc));return!0}return!1}static nh(){return new Xa}static get instance(){return Xa.Kg.value}}Xa.Kg=new a.a(Xa.nh);
Object(C.a)(Xa,"IntelligenceRootNodeComplexMerge",k.a,[]);class xa extends k.a{constructor(){super()}get Bn(){return 42}get Dz(){return 0}static nh(){return new xa}static get instance(){return xa.Kg.value}}xa.Kg=new a.a(xa.nh);Object(C.a)(xa,"IntelligenceSettingNodeComplexMerge",k.a,[]);class Ma extends k.a{constructor(){super()}get Bn(){return 45}get Dz(){return 0}static nh(){return new Ma}static get instance(){return Ma.Kg.value}}Ma.Kg=new a.a(Ma.nh);Object(C.a)(Ma,"IntelligenceWorkflowNodeComplexMerge",
k.a,[]);class Na extends k.a{constructor(){super()}get Bn(){return 15}get Dz(){return 3}static nh(){return new Na}static get instance(){return Na.Kg.value}}Na.Kg=new a.a(Na.nh);Object(C.a)(Na,"NumberListNodeComplexMerge",k.a,[]);var pa=d(110);class Ra extends k.a{constructor(){super()}get Bn(){return 16}get Dz(){return 0}nk(){const Bb=super.nk();Bb.Z(u.a.yb(l.a.Bvb),1);Bb.Z(u.a.yb(pa.a.lYe),7);Bb.Z(u.a.yb(pa.a.jYe),7);return Bb}aB(Bb,jc){const dc=Bb.Nk,nb=Bb.$d;if(jc===u.a.yb(l.a.Bvb))return this.$uf(nb,
Bb.Ng.value.Df,Bb.Zm.value.Df,dc,l.a.Bvb),Bb.yg.add(jc),!0;t.a.instance.Wa(4207940,1,4,"OutlineElementNodeComplexMerge: Failed to merge OutlineElementNode [Id: {0}] due to a conflicting change on [PropertyId: {1}]",Bb.Ng.value.ku.id,jc);return!1}static nh(){return new Ra}static get instance(){return Ra.Kg.value}}Ra.Kg=new a.a(Ra.nh);Object(C.a)(Ra,"OutlineElementNodeComplexMerge",k.a,[]);class Sa extends k.a{constructor(){super()}get Bn(){return 17}nk(){const Bb=super.nk();Bb.Z(u.a.yb(l.a.Bvb),1);
Bb.Z(u.a.yb(l.a.Fka),1);Bb.Z(u.a.yb(pa.a.nI),1);Bb.Z(u.a.yb(pa.a.y8b),1);Bb.Z(u.a.yb(pa.a.Xfa),8);return Bb}aB(Bb,jc){const dc=Bb.Nk,nb=Bb.$d;if(jc===u.a.yb(l.a.Bvb))return this.$uf(nb,Bb.Ng.value.Df,Bb.Zm.value.Df,dc,l.a.Bvb),Bb.yg.add(jc),!0;if(jc===u.a.yb(l.a.Fka)){var Gb=nb.getPropertyBool(Bb.Ng.value.Df,l.a.Fka),lb=nb.getPropertyBool(Bb.Zm.value.Df,l.a.Fka);nb.setPropertyBool(dc,l.a.Fka,null==Gb?!1:Gb&&null==lb?!1:lb);Bb.yg.add(jc);return!0}if(jc===u.a.yb(pa.a.y8b))return this.$uf(nb,Bb.Ng.value.Df,
Bb.Zm.value.Df,dc,pa.a.y8b),Bb.yg.add(jc),!0;if(jc===u.a.yb(pa.a.nI))return Gb=nb.getPropertyBool(Bb.Ng.value.Df,pa.a.nI),lb=nb.getPropertyBool(Bb.Zm.value.Df,pa.a.nI),nb.setPropertyBool(dc,pa.a.nI,null==Gb?!0:Gb||null==lb?!0:lb),Bb.yg.add(jc),!0;t.a.instance.Wa(4057305,1,4,"OutlineGroupNodeComplexMerge: Failed to merge OutlineGroupNode [Id: {0}] due to a conflicting change on [PropertyId: {1}]",Bb.Ng.value.ku.id,jc);return!1}static nh(){return new Sa}static get instance(){return Sa.Kg.value}}Sa.Kg=
new a.a(Sa.nh);Object(C.a)(Sa,"OutlineGroupNodeComplexMerge",k.a,[]);var ab=d(47),eb=d(44);class zb extends k.a{constructor(){super()}get Bn(){return 18}get Dz(){return 2}nk(){const Bb=super.nk();Bb.Z(u.a.yb(l.a.LKd),3);Bb.Z(u.a.yb(v.a.Daa),this.Dz);Bb.Z(u.a.yb(l.a.$s),1);Bb.Z(u.a.yb(l.a.n9),1);Bb.Z(u.a.yb(l.a.c3),1);Bb.Z(u.a.yb(l.a.tQ),1);Bb.Z(u.a.yb(l.a.vp),1);Bb.Z(u.a.yb(ab.a.uQ),1);Bb.Z(u.a.yb(ab.a.i$b),1);return Bb}aB(Bb,jc){const dc=Bb.$d;if(Bb.Yo.runtime.Qb.isFeatureEnabled(71)){var nb=Bb.Yo.runtime.Qb.isFeatureEnabled(130),
Gb=this.HTh(nb),lb=this.LTh(nb);if(jc===u.a.yb(l.a.$s)||jc===u.a.yb(l.a.c3)||jc===u.a.yb(Gb)||jc===u.a.yb(l.a.vp)||jc===u.a.yb(lb))return this.ldo(dc,Bb,nb)}else if(jc===u.a.yb(l.a.$s)||jc===u.a.yb(l.a.vp)){({MBc:jc,g_a:nb,b_a:Gb}=this.tWe(Object(eb.a)(dc,dc.getPropertyUint32s,"getPropertyUint32s"),Bb.Ng.value.ku,Bb.Ng.value.Df,Bb.Zm.value.Df,l.a.$s,null));if(!Gb&&!nb)return t.a.instance.Wa(4318873,1,2,"PageContentNodeComplexMerge: Failed to merge PageContentNode [Id: {0}] due to  material difference in [PropertyId: {1}]",
Bb.Ng.value.Df.id,u.a.yb(l.a.$s)),!0;let Kb,Vb;({MBc:lb,g_a:Kb,b_a:Vb}=this.tWe(Object(eb.a)(dc,dc.getPropertyObjectIds,"getPropertyObjectIds"),Bb.Ng.value.ku,Bb.Ng.value.Df,Bb.Zm.value.Df,l.a.vp,null));if(!Kb&&!Vb)return t.a.instance.Wa(4318874,1,2,"PageContentNodeComplexMerge: Failed to merge PageContentNode [Id: {0}] due to  material difference in [PropertyId: {1}]",Bb.Ng.value.Df.id,u.a.yb(l.a.vp)),!0;const vc=Kb&&!Vb;if((nb&&!Gb)!==vc)return t.a.instance.Wa(4318875,1,2,"PageContentNodeComplexMerge: Failed to merge PageContentNode [Id: {0}] due to wanting to merge [PropertyId: {1}] and [PropertyId: {2}] differently.",
Bb.Ng.value.Df.id,u.a.yb(l.a.$s),u.a.yb(l.a.vp)),!1;vc&&(dc.setPropertyObjectIds(Bb.Nk,l.a.vp,lb),dc.setPropertyUint32s(Bb.Nk,l.a.$s,jc));t.a.instance.Wa(4318877,1,4,"PageContentNodeComplexMerge: Merging PageContentNode [Id: {0}]. [PropertyId: {1}] [favoredEquivalentToBase: {1}] [conflictEquivalentToBase: {2}]. [PropertyId: {3}] [favoredEquivalentToBase: {4}] [conflictEquivalentToBase: {5}]",Bb.Ng.value.Df.id,u.a.yb(l.a.$s),nb,Gb,u.a.yb(l.a.vp),Kb,Vb);Bb.yg.add(u.a.yb(l.a.vp));Bb.yg.add(u.a.yb(l.a.$s));
return!0}t.a.instance.Wa(4318878,1,2,"PageContentNodeComplexMerge: Failed to merge PageContentNode [Id: {0}] due to a conflicting change on [PropertyId: {1}]",Bb.Ng.value.Df.id,jc);return!1}v4h(Bb,jc,dc,nb){let Gb;({MBc:jc,g_a:nb,b_a:Gb}=this.tWe(jc,dc.Ng.value.ku,dc.Ng.value.Df,dc.Zm.value.Df,Bb,nb));return Gb||nb?{returnValue:!0,KYe:jc,g_a:nb,b_a:Gb}:(t.a.instance.Wa(592545113,1,2,"PageContentNodeComplexMerge: Failed to merge PageContentNode [Id: {0}] due to  material difference in [PropertyId: {1}]",
dc.Ng.value.Df.id.toString(),u.a.yb(Bb)),{returnValue:!1,KYe:jc,g_a:nb,b_a:Gb})}A3h(Bb,jc,dc,nb,Gb){let lb;let Kb,Vb,vc,Fc;({KYe:lb,g_a:Zc,b_a:Kb,returnValue:vc}=this.v4h(Bb,Object(eb.a)(dc,dc.getPropertyUint32s,"getPropertyUint32s"),nb,null));({KYe:dc,g_a:Gb,b_a:Vb,returnValue:Fc}=this.v4h(jc,Object(eb.a)(dc,dc.getPropertyObjectIds,"getPropertyObjectIds"),nb,Gb));var Zc=Zc&&!Kb;return vc&&Fc?Zc!==(Gb&&!Vb)?(t.a.instance.Wa(592545114,1,2,"PageContentNodeComplexMerge: Failed to merge PageContentNode [Id: {0}] due to wanting to merge [PropertyId: {1}] and [PropertyId: {2}] differently.",
nb.Ng.value.Df.id.toString(),u.a.yb(Bb),u.a.yb(jc)),{returnValue:2,hwd:lb,gwd:dc,mae:Zc}):{returnValue:0,hwd:lb,gwd:dc,mae:Zc}:{returnValue:1,hwd:lb,gwd:dc,mae:Zc}}tqf(Bb){let jc=!0;Bb.forEach(dc=>dc!==Y.a.nil?jc=!1:!0);return jc}prl(Bb,jc,dc){return this.tqf(Bb)&&this.tqf(jc)&&this.tqf(dc)?!0:!1}ldo(Bb,jc,dc){const nb=this.HTh(dc);dc=this.LTh(dc);let Gb,lb,Kb,Vb,vc,Fc;var Zc=({hwd:Vb,gwd:vc,mae:lb}=this.A3h(nb,l.a.vp,Bb,jc,null)).returnValue;if(2===Zc||1===Zc)return!0;({hwd:Kb,gwd:Fc,mae:Gb,returnValue:Zc}=
this.A3h(l.a.$s,l.a.c3,Bb,jc,Object(eb.a)(this,this.prl,"getExtendedGuidEquivalence")));if(2===Zc||1===Zc)return!0;let td;({MBc:Zc,g_a:xd,b_a:td}=this.Ttk(Object(eb.a)(Bb,Bb.getPropertyDictionary,"getPropertyDictionary"),jc.Ng.value.ku,jc.Ng.value.Df,jc.Zm.value.Df,dc));if(!td&&!xd)return t.a.instance.Wa(592545115,1,2,"PageContentNodeComplexMerge: Failed to merge PageContentNode [Id: {0}] due to  material difference in [PropertyId: {1}]",jc.Ng.value.Df.id.toString(),u.a.yb(dc)),!0;var xd=xd&&!td;
if(Gb!==lb||Gb!==xd)return t.a.instance.Wa(592545116,1,2,"PageContentNodeComplexMerge: Failed to merge PageContentNode [Id: {0}] due to wanting to merge [PropertyId: {1}], [PropertyId: {2}] and [PropertyId: {3}] differently. [takeConflictingAbsListId: {4}] [takeConflictingListId: {5}] [takeConflictingMap: {6}]",jc.Ng.value.Df.id.toString(),u.a.yb(l.a.$s),u.a.yb(nb),u.a.yb(dc),lb,Gb,xd),!0;Gb&&(Bb.setPropertyObjectIds(jc.Nk,l.a.vp,vc),Bb.setPropertyUint32s(jc.Nk,nb,Vb),Bb.setPropertyObjectIds(jc.Nk,
l.a.c3,Fc),Bb.setPropertyUint32s(jc.Nk,l.a.$s,Kb),Bb.setPropertyDictionary(jc.Nk,dc,Zc));t.a.instance.Wa(592545118,1,4,"PageContentNodeComplexMerge: Merging PageContentNode [Id: {0}]. [takeConflictingAbsListId: {1}] [takeConflictingListId: {2}] [takeConflictingMap: {3}]",jc.Ng.value.Df.id.toString(),lb,Gb,xd);jc.yg.add(u.a.yb(nb));jc.yg.add(u.a.yb(l.a.vp));jc.yg.add(u.a.yb(l.a.$s));jc.yg.add(u.a.yb(l.a.c3));jc.yg.add(u.a.yb(dc));return!0}HTh(Bb){return Bb?ab.a.i$b:l.a.n9}LTh(Bb){return Bb?ab.a.uQ:
l.a.tQ}static nh(){return new zb}static get instance(){return zb.Kg.value}}zb.Kg=new a.a(zb.nh);Object(C.a)(zb,"PageContentNodeComplexMerge",k.a,[]);class Ua extends k.a{constructor(){super()}get Bn(){return 19}nk(){const Bb=super.nk();Bb.Z(u.a.yb(l.a.pEa),1);Bb.Z(u.a.yb(l.a.appsNode),2);Bb.Z(u.a.yb(l.a.customXmlPartContainerNode),2);Bb.Z(u.a.yb(l.a.intelligenceRootNode),1);return Bb}aB(Bb,jc){const dc=Bb.$d;if(jc===u.a.yb(l.a.pEa)){var nb=dc.getPropertyObjectIds(Bb.Ng.value.ku,l.a.pEa),Gb=dc.getPropertyObjectIds(Bb.Ng.value.Df,
l.a.pEa),lb=dc.getPropertyObjectIds(Bb.Zm.value.Df,l.a.pEa);if((nb=this.zHm(nb,Gb,lb,(Kb,Vb)=>Kb.equals(Vb),Kb=>{let Vb;({value:Vb}=Bb.Yo.runtime.lq.Dc(Kb)).returnValue?Bb.Yo.runtime.Rm.Z(Kb,new y.a(Vb,!1)):t.a.instance.shipAssertTag(4034653,1,!1,"PageManifestNodeComplexMerge failed to shared formatting object with [id: {0}] in conflicting revision.")},Bb.Yo))&&0<nb.length)return dc.setPropertyObjectIds(Bb.Nk,l.a.pEa,nb),Bb.yg.add(u.a.yb(l.a.pEa)),!0}if(jc===u.a.yb(l.a.intelligenceRootNode))return nb=
dc.getPropertyObjectIds(Bb.Ng.value.ku,l.a.intelligenceRootNode),Gb=dc.getPropertyObjectIds(Bb.Ng.value.Df,l.a.intelligenceRootNode),lb=dc.getPropertyObjectIds(Bb.Zm.value.Df,l.a.intelligenceRootNode),nb=this.PCa(nb,Gb,lb),dc.setPropertyObjectIds(Bb.Nk,l.a.intelligenceRootNode,nb),Bb.yg.add(jc),!0;t.a.instance.Wa(4018187,1,4,"PageManifestNodeComplexMerge: Failed to merge PageManifestNode [Id: {0}] due to a conflicting change on [PropertyId: {1}]",Bb.Ng.value.Df.id,jc);return!1}static nh(){return new Ua}static get instance(){return Ua.Kg.value}}
Ua.Kg=new a.a(Ua.nh);Object(C.a)(Ua,"PageManifestNodeComplexMerge",k.a,[]);class Ab extends k.a{constructor(){super()}get Bn(){return 43}nk(){const Bb=super.nk();Bb.Z(u.a.yb(l.a.Bja),0);Bb.Z(u.a.yb(l.a.dHb),0);Bb.Z(u.a.yb(l.a.KDb),0);Bb.Z(u.a.yb(l.a.Dla),1);Bb.Z(u.a.yb(l.a.sessionId),3);Bb.Z(u.a.yb(l.a.buildVersion),3);Bb.Z(u.a.yb(l.a.hX),1);Bb.Z(u.a.yb(l.a.cdi),1);Bb.Z(u.a.yb(l.a.Iu),1);return Bb}aB(Bb,jc){if(jc===u.a.yb(l.a.hX)||jc===u.a.yb(l.a.cdi)||jc===u.a.yb(l.a.Iu)){var dc=Bb.Zm.value.Df,nb=
Bb.Ng.value.Df,Gb=u.a.yW(jc);nb=Bb.$d.getPropertyBool(nb,Gb);dc=Bb.$d.getPropertyBool(dc,Gb);Bb.$d.setPropertyBool(Bb.Nk,Gb,null==nb?!1:nb&&null==dc?!1:dc);Bb.yg.add(jc);return!0}if(jc===u.a.yb(l.a.Dla)){jc=Bb.$d;dc=Bb.Ng.value.ku;nb=Bb.Zm.value.Df;Gb=Bb.Ng.value.Df;dc=dc?jc.getPropertyObjectId(dc,l.a.Dla):null;nb=nb?jc.getPropertyObjectId(nb,l.a.Dla):null;Gb=Gb?jc.getPropertyObjectId(Gb,l.a.Dla):null;t.a.instance.Wa(589657691,1,4,"GraphFeatureChild Merge Attempt: [Base: {0}] [Conflict: {1}] [Favored: {2}]",
dc?dc.toString():"NULL",nb?nb.toString():"NULL",Gb?Gb.toString():"NULL");if(nb){if(Gb&&nb.equals(Gb))return Bb.yg.add(u.a.yb(l.a.Dla)),jc.setPropertyObjectId(Bb.Nk,l.a.Dla,nb),!0;if(ca.a.kJd.equals(nb))return Bb.yg.add(u.a.yb(l.a.Dla)),jc.setPropertyObjectId(Bb.Nk,l.a.Dla,ca.a.kJd),!0}if(Gb&&ca.a.kJd.equals(Gb))return Bb.yg.add(u.a.yb(l.a.Dla)),jc.setPropertyObjectId(Bb.Nk,l.a.Dla,ca.a.kJd),!0;t.a.instance.Wa(589657692,1,2,"GraphFeatureChild Merge Failure: [Base: {0}] [Conflict: {1}] [Favored: {2}]",
dc?dc.toString():"NULL",nb?nb.toString():"NULL",Gb?Gb.toString():"NULL")}return!1}static nh(){return new Ab}static get instance(){return Ab.Kg.value}}Ab.Kg=new a.a(Ab.nh);Object(C.a)(Ab,"PageMetadataNodeComplexMerge",k.a,[]);var mb=d(1716),Rb=d(106);class hc extends k.a{constructor(){super()}get Bn(){return 31}nk(){const Bb=super.nk();Bb.Z(u.a.yb(Rb.a.Nv),1);Bb.Z(u.a.yb(l.a.listID),3);Bb.Z(u.a.yb(l.a.listLevel),1);Bb.Z(u.a.yb(l.a.we),3);Bb.Z(u.a.yb(l.a.eYb),3);Bb.Z(u.a.yb(l.a.runId),3);Bb.Z(u.a.yb(l.a.nBd),
3);Bb.Z(u.a.yb(v.a.fontColor),3);Bb.Z(u.a.yb(l.a.dqh),3);Bb.Z(u.a.yb(l.a.Nc),1);Bb.Z(u.a.yb(Rb.a.MNd),3);Bb.Z(u.a.yb(Rb.a.Muf),3);Bb.Z(u.a.yb(Rb.a.lOc),3);Bb.Z(u.a.yb(l.a.Ncl),3);Bb.Z(u.a.yb(pa.a.Dfj),3);for(let jc=0;jc<hc.b0a.length;jc++)Bb.Z(hc.b0a[jc],1);return Bb}aB(Bb,jc){var dc=Bb.$d;const nb=Bb.Nk;var Gb=Bb.Yo.runtime.Qb.isFeatureEnabled(129);u.a.yW(jc);if(jc===u.a.yb(l.a.Nc)){dc=Bb.$d.getPropertyInt32(Bb.Zm.value.Df,l.a.Nc);if(null==dc||!dc)return!0;Bb.$d.setPropertyInt32(nb,l.a.Nc,dc);Bb.yg.add(jc);
return!0}if(jc===u.a.yb(Rb.a.Nv)){Gb=dc.getPropertyUint32(Bb.Ng.value.Df,Rb.a.Nv);const lb=dc.getPropertyUint32(Bb.Zm.value.Df,Rb.a.Nv);if(null!=Gb&&null!=lb&&Gb===lb)return dc.setPropertyUint32(nb,Rb.a.Nv,Gb),Bb.yg.add(jc),!0;if(null==Gb&&null==lb)return nb.removeProperty(Rb.a.Nv),Bb.yg.add(u.a.yb(Rb.a.Nv)),!0;if(null!=Gb&&null==lb)return dc.setPropertyUint32(nb,Rb.a.Nv,Gb),Bb.yg.add(jc),!0;if(null==Gb&&null!=lb)return dc.setPropertyUint32(nb,Rb.a.Nv,lb),Bb.yg.add(jc),!0}else{if(jc===u.a.yb(l.a.listLevel))return this.Eco(dc,
Bb);if(jc===u.a.yb(e.a.paragraphStyle)){if(Gb)return this.Ydj(Bb)}else if(Array.contains(hc.b0a,jc))return this.Ydj(Bb)}return!1}Ydj(Bb){let jc=!0,dc=!0,nb,Gb;({Kcm:jc,gam:dc,e7k:nb,OCk:Gb}=this.Utk(Bb));t.a.instance.Wa(578932993,1,4,"PersistablePropertySetComplexMerge: Merging ListDef properties [Id: {0}]. [favoredEquivalentToBase: {1}] [conflictEquivalentToBase: {2}].",Bb.Ng.value.Df.id.toString(),jc,dc);return jc&&!dc?(this.Ori(Gb,Bb),!0):jc?!1:(this.Ori(nb,Bb),!0)}Utk(Bb){let jc,dc,nb,Gb;const lb=
Bb.Zm.value;let Kb;const Vb=Bb.Ng.value;let vc;dc=jc=!0;nb=new K.a;Gb=new K.a;for(let Fc=0;Fc<hc.b0a.length;Fc++){const Zc=hc.b0a[Fc],td=({value:Kb}=lb.vna.Dc(Zc)).returnValue;({value:vc}=Vb.vna.Dc(Zc)).returnValue&&(jc=this.Kdj(Bb.Ng,nb,vc,Zc)&&jc);td&&(dc=this.Kdj(Bb.Zm,Gb,Kb,Zc)&&dc)}return{Kcm:jc,gam:dc,e7k:nb,OCk:Gb}}Kdj(Bb,jc,dc,nb){const Gb=u.a.yW(nb);Bb=Bb.value.Df;jc.Z(nb,Bb.hasProperty(Gb)?Bb.$P(Gb):null);return!dc.YW}Ori(Bb,jc){const dc=jc.Nk;for(let Gb=0;Gb<hc.b0a.length;Gb++){var nb=
hc.b0a[Gb];const lb=u.a.yW(nb);(nb=Bb.J(nb))?dc.Jva(lb,nb):dc.removeProperty(lb)}for(Bb=0;Bb<hc.b0a.length;Bb++)jc.yg.add(hc.b0a[Bb]);t.a.instance.Wa(578932994,1,4,"PersistablePropertySetComplexMerge: Completed Merging ListDef properties [Id: {0}].",jc.Ng.value.Df.id.toString())}Eco(Bb,jc){const dc=jc.Nk,nb=Bb.getPropertyInt32(jc.Ng.value.Df,l.a.listLevel),Gb=Bb.getPropertyInt32(jc.Zm.value.Df,l.a.listLevel);return null!=nb&&null!=Gb&&nb===Gb?(Bb.setPropertyInt32(dc,l.a.listLevel,nb),jc.yg.add(u.a.yb(l.a.listLevel)),
!0):null==nb&&null==Gb?(dc.removeProperty(l.a.listLevel),jc.yg.add(u.a.yb(l.a.listLevel)),!0):null!=nb&&null==Gb?(Bb.setPropertyInt32(dc,l.a.listLevel,nb),jc.yg.add(u.a.yb(l.a.listLevel)),!0):null==nb&&null!=Gb?(Bb.setPropertyInt32(dc,l.a.listLevel,Gb),jc.yg.add(u.a.yb(l.a.listLevel)),!0):!1}static nh(){return new hc}static get instance(){return hc.Kg.value}}hc.Kg=new a.a(hc.nh);hc.b0a=[u.a.yb(l.a.fe),u.a.yb(l.a.ht),u.a.yb(v.a.U2),u.a.yb(l.a.jaa),u.a.yb(l.a.Ur),u.a.yb(l.a.vr),u.a.yb(v.a.kX),u.a.yb(l.a.NSe),
u.a.yb(v.a.font),u.a.yb(pa.a.khb),u.a.yb(e.a.paragraphStyle)];Object(C.a)(hc,"PersistablePropertySetComplexMerge",k.a,[]);class Hb extends k.a{constructor(){super()}get Bn(){return 21}get Dz(){return 0}static nh(){return new Hb}static get instance(){return Hb.Kg.value}}Hb.Kg=new a.a(Hb.nh);Object(C.a)(Hb,"RevisionMetadataNodeComplexMerge",k.a,[]);class Ta extends k.a{constructor(){super()}get Bn(){return 48}nk(){const Bb=super.nk();Bb.Z(u.a.yb(l.a.xGi),3);return Bb}static nh(){return new Ta}static get instance(){return Ta.Kg.value}}
Ta.Kg=new a.a(Ta.nh);Object(C.a)(Ta,"ShadowNumberListNodeComplexMerge",k.a,[]);class Aa extends k.a{constructor(){super()}get Bn(){return 22}nk(){const Bb=super.nk();Bb.Z(u.a.yb(l.a.languageHint),7);Bb.Z(u.a.yb(l.a.NOc),2);return Bb}static nh(){return new Aa}static get instance(){return Aa.Kg.value}}Aa.Kg=new a.a(Aa.nh);Object(C.a)(Aa,"SharedPersistablePropertySetComplexMerge",k.a,[]);class ma extends k.a{constructor(){super()}get Bn(){return 38}get Dz(){return 3}static nh(){return new ma}static get instance(){return ma.Kg.value}}
ma.Kg=new a.a(ma.nh);Object(C.a)(ma,"StylePropertySetComplexMerge",k.a,[]);var Ga=d(1553),Fa=d(1590);class ib extends k.a{constructor(){super()}get Bn(){return 23}get Dz(){return 0}nk(){const Bb=super.nk();Bb.Z(u.a.yb(v.a.qf),4);Bb.Z(u.a.yb(l.a.rowSpan),1);Bb.Z(u.a.yb(l.a.colSpan),1);Bb.Z(u.a.yb(l.a.ghostCell),1);Bb.Z(u.a.yb(ab.a.vMerge),1);Bb.Z(u.a.yb(ab.a.gridSpan),1);Bb.Z(u.a.yb(l.a.T3a),2);Bb.Z(u.a.yb(l.a.Ulb),2);Bb.Z(u.a.yb(l.a.KEa),2);Bb.Z(u.a.yb(l.a.qlb),5);return Bb}SDb(Bb){if(!Bb)return t.a.instance.Wa(573957923,
1,2,"Feature helper is null"),!1;Bb.Vq(111);return Bb.isFeatureEnabled(111)}lK(Bb){if(!Bb)return t.a.instance.Wa(540120285,1,2,"Feature helper is null"),!1;Bb.Vq(112);return Bb.isFeatureEnabled(112)}aB(Bb,jc){Bb.Yo.runtime.bG("TableCellNodeComplexMerge.TryMergeCustomProperty, propertyId:"+jc);var dc=jc===u.a.yb(l.a.rowSpan)||jc===u.a.yb(l.a.colSpan)||jc===u.a.yb(l.a.ghostCell);this.lK(Bb.Yo.runtime.Qb)&&(dc=dc||jc===u.a.yb(ab.a.vMerge)||jc===u.a.yb(ab.a.gridSpan));if(!this.SDb(Bb.Yo.runtime.Qb))return!dc;
var nb=Bb.Zm.value.ku,Gb=Fa.e(Bb.Yo,nb,null);if(Gb.equals(Y.a.nil))return t.a.instance.Wa(573845783,1,2,"Table node ID could not be found for table cell. Table cell ID: {0}",nb.id),Bb.Yo.logger.Pg(Object.assign(new Ga.a,{info:"Table node ID could not be found for table cell"})),!1;var lb=Bb.Yo.runtime.Qwb.J(Gb).J(nb.id);if(!lb)return!dc;nb=Bb.Nk;Gb=Bb.$d;if(jc===u.a.yb(l.a.ghostCell))return Gb.setPropertyBool(nb,l.a.ghostCell,lb.qg),Bb.yg.add(u.a.yb(l.a.ghostCell)),!0;if(jc===u.a.yb(l.a.rowSpan))return jc=
lb.rowSpan,lb=lb.colSpan,null!=jc&&null!=lb&&(1<jc||1<lb)?Gb.setPropertyUint32(nb,l.a.rowSpan,jc):nb.removeProperty(l.a.rowSpan),Bb.yg.add(u.a.yb(l.a.rowSpan)),!0;if(jc===u.a.yb(l.a.colSpan))return jc=lb.rowSpan,dc=lb.colSpan,lb=lb.qg,null!=jc&&null!=dc&&(1<jc||1<dc)?Gb.setPropertyUint32(nb,l.a.colSpan,dc):lb&&null!=dc?Gb.setPropertyUint32(nb,l.a.colSpan,dc):nb.removeProperty(l.a.colSpan),Bb.yg.add(u.a.yb(l.a.colSpan)),!0;t.a.instance.Wa(573690910,1,2,"TableCellNodeComplexMerge.TryMergeCustomProperty called for a property whose merge strategy is not custom merge. PropertyID:{0}",
jc);Bb.Yo.logger.Pg(Object.assign(new Ga.a,{info:"TableCellNodeComplexMerge.TryMergeCustomProperty called for a property which should not be custom merged"}));return!dc}static nh(){return new ib}static get instance(){return ib.Kg.value}}ib.Kg=new a.a(ib.nh);Object(C.a)(ib,"TableCellNodeComplexMerge",k.a,[]);class ob extends k.a{constructor(){super()}get Bn(){return 24}SDb(Bb){if(!Bb)return t.a.instance.Wa(573845782,1,2,"Feature helper is null"),!1;Bb.Vq(111);return Bb.isFeatureEnabled(111)}get Dz(){return 0}nk(){const Bb=
super.nk();Bb.Z(u.a.yb(v.a.qf),1);Bb.Z(u.a.yb(v.a.z_),1);Bb.Z(u.a.yb(v.a.Sva),1);Bb.Z(u.a.yb(l.a.Ofc),1);Bb.Z(u.a.yb(l.a.J7),1);Bb.Z(u.a.yb(l.a.T3a),2);Bb.Z(u.a.yb(l.a.Ulb),2);Bb.Z(u.a.yb(l.a.KEa),2);return Bb}aB(Bb,jc){Bb.Yo.runtime.bG("TableNodeComplexMerge.TryMergeCustomProperty, PropertyId:"+jc);if(jc===u.a.yb(v.a.qf)||jc===u.a.yb(v.a.z_)||jc===u.a.yb(l.a.Ofc)||jc===u.a.yb(l.a.J7)||jc===u.a.yb(v.a.Sva)){const Gb=Bb.Nk;var dc=Bb.$d;t.a.instance.Wa(4273303,1,4,"TableNodeComplexMerge: Running custom merge for [ObjectId: {0}] [ClassId: {1}] [PropertyId: {2}]",
Gb.id,Gb.Qc,jc);if(this.uYk(Bb))return!1;var nb=dc.getPropertyObjectIds(Bb.Ng.value.ku,v.a.qf);const lb=dc.getPropertyObjectIds(Bb.Ng.value.Df,v.a.qf),Kb=dc.getPropertyObjectIds(Bb.Zm.value.Df,v.a.qf);nb=this.Yqi(nb,lb,Kb,(Vb,vc)=>Vb.equals(vc));if(0<nb.length)return dc.setPropertyObjectIds(Gb,v.a.qf,nb),dc.setPropertyInt32(Gb,v.a.Sva,nb.length),this.SDb(Bb.Yo.runtime.Qb)&&({value:jc}=Bb.Zm.value.vna.Dc(u.a.yb(v.a.z_)),{value:dc}=Bb.Ng.value.vna.Dc(u.a.yb(v.a.z_)),jc.YW?Gb.Jva(v.a.z_,jc.newValue):
Gb.Jva(v.a.z_,dc.newValue)),Bb.yg.add(u.a.yb(v.a.qf)),Bb.yg.add(u.a.yb(v.a.z_)),Bb.yg.add(u.a.yb(v.a.Sva)),Bb.yg.add(u.a.yb(l.a.Ofc)),Bb.yg.add(u.a.yb(l.a.J7)),!0}t.a.instance.Wa(4018189,1,4,"TableNodeComplexMerge: Failed to merge TableNode [Id: {0}] due to a conflicting change on [PropertyId: {1}]",Bb.Ng.value.Df.id,jc);return!1}uYk(Bb){const jc=Bb.Zm.value,dc=Bb.Ng.value;let nb,Gb;({value:nb}=jc.vna.Dc(u.a.yb(v.a.z_)));({value:Gb}=dc.vna.Dc(u.a.yb(v.a.z_)));return nb.YW||Gb.YW?nb.YW&&Gb.YW?(t.a.instance.Wa(4273304,
1,4,"TableNodeComplexMerge: Failed to merge TableNode due to columns being changed in both. [Base: {0}] [Favored: {1}] [Conflicting: {2}]",nb.oldValue,Gb.newValue,nb.newValue),Bb.Yo.logger.Pg(Object.assign(new Ga.a,{lj:"DoColumnsConflict",eventId:"aqtsy",info:"Columns changed"})),!0):ob.DAh(Bb.Yo,nb,dc,"BaseConflict")||ob.DAh(Bb.Yo,Gb,jc,"BaseFavored")?!0:!1:!1}static nh(){return new ob}static get instance(){return ob.Kg.value}static DAh(Bb,jc,dc,nb){return jc.YW&&({value:jc}=dc.vna.Dc(u.a.yb(v.a.qf)),
jc.YW)?(t.a.instance.Wa(4273305,1,4,"TableNodeComplexMerge {0}: Failed to merge TableNode due to columns and rows being changed on different sides of the conflict.",nb),Bb.logger.Pg(Object.assign(new Ga.a,{lj:"DoColumnsConflictWithRows",eventId:"aqtsz"})),!0):!1}}ob.Kg=new a.a(ob.nh);Object(C.a)(ob,"TableNodeComplexMerge",k.a,[]);class fb extends k.a{constructor(){super()}get Bn(){return 25}get Dz(){return 0}nk(){const Bb=super.nk();Bb.Z(u.a.yb(l.a.Nc),3);Bb.Z(u.a.yb(v.a.qf),4);Bb.Z(u.a.yb(l.a.T3a),
2);Bb.Z(u.a.yb(l.a.Ulb),2);Bb.Z(u.a.yb(l.a.KEa),2);Bb.Z(u.a.yb(ab.a.e4f),2);Bb.Z(u.a.yb(ab.a.d4f),2);Bb.Z(u.a.yb(l.a.qlb),5);return Bb}static nh(){return new fb}static get instance(){return fb.Kg.value}}fb.Kg=new a.a(fb.nh);Object(C.a)(fb,"TableRowNodeComplexMerge",k.a,[]);class Mb extends k.a{constructor(){super()}nk(){const Bb=super.nk();Bb.Z(u.a.yb(l.a.R6n),2);Bb.Z(u.a.yb(v.a.qf),1);return Bb}aB(Bb,jc){if(jc===u.a.yb(v.a.qf)){const nb=Bb.Nk,Gb=Bb.$d;t.a.instance.Wa(42754251,1,4,"TaskContentNodeComplexMerge: Running custom merge for [ObjectId: {0}] [ClassId: {1}] [PropertyId: {2}]",
nb.id,nb.Qc,jc);var dc=Gb.getPropertyObjectIds(Bb.Ng.value.ku,v.a.qf);const lb=Gb.getPropertyObjectIds(Bb.Ng.value.Df,v.a.qf),Kb=Gb.getPropertyObjectIds(Bb.Zm.value.Df,v.a.qf);if(dc=this.KHm(dc,lb,Kb))return 0<dc.length?Gb.setPropertyObjectIds(nb,v.a.qf,dc):nb.removeProperty(v.a.qf),Bb.yg.add(u.a.yb(v.a.qf)),!0}t.a.instance.Wa(42754252,1,1,"TaskContentNodeComplexMerge: Failed to merge TaskContent [Id: {0}] due to a conflicting change on [PropertyId: {1}]",Bb.Ng.value.Df.id,jc);return!1}KHm(Bb,jc,
dc){const nb=new K.a(0);Bb.forEach(lb=>{nb.Z(lb,0);return!0});jc.forEach(lb=>{nb.xb(lb)?nb.Z(lb,1):nb.Z(lb,3);return!0});dc.forEach(lb=>{let Kb;({value:Kb}=nb.Dc(lb)).returnValue?1===Kb?nb.Z(lb,5):3===Kb?(t.a.instance.Wa(42754253,1,2,"TaskNode was found added by both sides of merge"),nb.Z(lb,3)):nb.Z(lb,2):nb.Z(lb,4);return!0});const Gb=new H.a;nb.forEach((lb,Kb)=>{0!==Kb&&2!==Kb&&1!==Kb&&Gb.add(lb);return!0});return Gb}static nh(){return new Mb}static get instance(){return Mb.Kg.value}}Mb.Kg=new a.a(Mb.nh);
Object(C.a)(Mb,"TaskContentNodeComplexMerge",k.a,[]);class Tb{equals(Bb,jc){return Bb&&jc?Bb.UserId===jc.UserId&&Bb.Provider===jc.Provider&&Bb.DisplayName===jc.DisplayName&&Bb.Email===jc.Email:!Bb&&!jc}XJ(){return 0}}Object(C.a)(Tb,"CommentTaskPersonComparer",null,[198]);class rc{equals(Bb,jc){return Bb&&jc?Bb.startDate?Bb.endDate?Bb.startDate.getTime()===jc.startDate.getTime()&&Bb.endDate.getTime()===jc.endDate.getTime():!jc.endDate:!jc.startDate:!Bb&&!jc}XJ(){return 0}}Object(C.a)(rc,"CommentTaskScheduleEqualityComparer",
null,[198]);class vb{equals(Bb,jc){if(!Bb||!jc)return!Bb&&!jc;if(!Bb.extensions&&!jc.extensions)return!0;if(!Bb.extensions||!jc.extensions||Bb.extensions.count!==jc.extensions.count)return!1;let dc=!0;Bb.extensions.forEach((nb,Gb)=>{let lb;return({value:lb}=jc.extensions.Dc(nb)).returnValue&&Gb===lb?!0:dc=!1});return dc}XJ(){return 0}}Object(C.a)(vb,"ExtensionListEqualityComparer",null,[198]);class Ya{Z3k(Bb,jc){return Bb&&jc?Bb.recordId===jc.recordId&&Ya.Lyg.equals(Bb.user,jc.user)&&Ya.Lyg.equals(Bb.assignee,
jc.assignee)&&Bb.type===jc.type&&Bb.title===jc.title&&Bb.priority===jc.priority&&Bb.isLossy===jc.isLossy&&Bb.completion===jc.completion&&Bb.commentId===jc.commentId&&Bb.time===jc.time&&Ya.pzj.equals(Bb.schedule,jc.schedule):!Bb&&!jc}equals(Bb,jc){return this.Z3k(Bb,jc)}XJ(){return 0}}Ya.Lyg=new Tb;Ya.pzj=new rc;new vb;Object(C.a)(Ya,"HistoryRecordEqualityComparer",null,[198]);var wb=d(1939),jb=d(1522);class Zb extends k.a{constructor(Bb){super();this.SIa=Bb}nk(){const Bb=super.nk();Bb.Z(u.a.yb(l.a.kLb),
5);Bb.Z(u.a.yb(l.a.taskId),2);Bb.Z(u.a.yb(l.a.E6n),2);Bb.Z(u.a.yb(l.a.I6n),2);Bb.Z(u.a.yb(l.a.Wva),1);return Bb}V6f(Bb){if(!Bb.Zm.value.ku&&!Bb.Ng.value.ku){const jc=Bb.Ng.value.Df.HG();jc.removeProperty(l.a.Wva);const dc=Bb.Ng.value.Df,nb=Bb.Zm.value.Df;Bb.Ng=new a.a(()=>new jb.a(jc,dc));Bb.Zm=new a.a(()=>new jb.a(jc,nb))}return super.V6f(Bb)}aB(Bb,jc){if(jc!==u.a.yb(l.a.Wva))return t.a.instance.Wa(42754254,1,1,"TaskSingleNodeComplexMerge: Failed to merge TaskSingle [Id: {0}] due to a conflicting change on [PropertyId: {1}]",
Bb.Ng.value.Df.id,jc),!1;const dc=Bb.Nk,nb=Bb.$d;t.a.instance.Wa(42754255,1,4,"TaskSingleNodeComplexMerge: Running custom merge for [ObjectId: {0}] [ClassId: {1}] [PropertyId: {2}]",dc.id,dc.Qc,jc);jc=nb.getPropertyString(Bb.Ng.value.ku,l.a.Wva);const Gb=nb.getPropertyString(Bb.Ng.value.Df,l.a.Wva),lb=nb.getPropertyString(Bb.Zm.value.Df,l.a.Wva);jc=this.JHm(jc,Gb,lb);if(!jc)return!1;0<jc.length?nb.setPropertyString(dc,l.a.Wva,jc):dc.removeProperty(l.a.Wva);Bb.yg.add(u.a.yb(l.a.Wva));return!0}JHm(Bb,
jc,dc){Bb=this.SIa.Z_b(Bb);jc=this.SIa.Z_b(jc);dc=this.SIa.Z_b(dc);if(!Zb.Vfi(Bb,jc))return t.a.instance.Wa(42754256,1,1,"MergeTaskHistory: base must be a prefix of the favored entries"),null;if(!Zb.Vfi(Bb,dc))return t.a.instance.Wa(42754257,1,1,"MergeTaskHistory: base must be a prefix of the conflict entries"),null;dc=Zb.Vzk(Bb.length,jc,dc);return this.SIa.$Wf(dc)}static nh(){const Bb=new wb.a;return new Zb(Bb)}static get instance(){return Zb.Kg.value}static Vzk(Bb,jc,dc){const nb=new H.a;for(let Gb=
0;Gb<jc.length;Gb++)nb.add(jc.J(Gb));for(;Bb<dc.length;Bb++)nb.add(dc.J(Bb));return nb}static Vfi(Bb,jc){const dc=Bb.length;if(dc>jc.length)return!1;for(let nb=0;nb<dc;nb++)if(!Zb.sGj.equals(jc.J(nb),Bb.J(nb)))return jc.J(nb).recordId===Bb.J(nb).recordId&&t.a.instance.Wa(50357519,1,1,"MergeTaskHistory: History records with same RecordId must have all other fields equal"),!1;return!0}}Zb.Kg=new a.a(Zb.nh);Zb.sGj=new Ya;Object(C.a)(Zb,"TaskSingleNodeComplexMerge",k.a,[]);class Eb extends k.a{constructor(){super()}get Bn(){return 26}nk(){const Bb=
super.nk();Bb.Z(u.a.yb(v.a.qf),1);return Bb}aB(Bb,jc){const dc=v.a.qf;if(jc===u.a.yb(dc)){jc=Bb.Nk;const Gb=Bb.$d;var nb=Gb.getPropertyObjectIds(Bb.Ng.value.ku,dc);const lb=Gb.getPropertyObjectIds(Bb.Ng.value.Df,dc),Kb=Gb.getPropertyObjectIds(Bb.Zm.value.Df,dc);nb=this.QHm(nb,lb,Kb);Gb.setPropertyObjectIds(jc,dc,nb);Bb.yg.add(u.a.yb(dc));return!0}return!1}QHm(Bb,jc,dc){return this.PCa(Bb,jc,dc)}static nh(){return new Eb}static get instance(){return Eb.Kg.value}}Eb.Kg=new a.a(Eb.nh);Object(C.a)(Eb,
"VectorClockContainerNodeComplexMerge",k.a,[]);class tc extends k.a{constructor(){super()}get Bn(){return 27}nk(){const Bb=super.nk();Bb.Z(u.a.yb(l.a.YX),1);return Bb}aB(Bb,jc){const dc=l.a.YX;if(jc===u.a.yb(dc)){jc=Bb.Nk;const nb=Bb.$d,Gb=nb.getPropertyUint32(Bb.Ng.value.Df,dc)||0,lb=nb.getPropertyUint32(Bb.Zm.value.Df,dc)||0;nb.setPropertyUint32(jc,dc,this.Qyl(Gb,lb));Bb.yg.add(u.a.yb(dc));return!0}return!1}Qyl(Bb,jc){return Bb>jc?Bb:jc}static nh(){return new tc}static get instance(){return tc.Kg.value}}
tc.Kg=new a.a(tc.nh);Object(C.a)(tc,"VectorClockNodeComplexMerge",k.a,[]);class lc extends k.a{constructor(){super()}get Bn(){return 28}get Dz(){return 0}nk(){const Bb=super.nk();Bb.Z(u.a.yb(l.a.XAh),3);Bb.Z(u.a.yb(l.a.Nc),3);Bb.Z(u.a.yb(l.a.hZk),5);Bb.Z(u.a.yb(l.a.gri),5);Bb.Z(u.a.yb(l.a.Ega),5);return Bb}static nh(){return new lc}static get instance(){return lc.Kg.value}}lc.Kg=new a.a(lc.nh);Object(C.a)(lc,"WordSectionNodeComplexMerge",k.a,[]);d.d(N,"a",function(){return Lc});class Lc{Qth(Bb,jc){switch(Bb.Qc){case 131073:return Bb.hasProperty(l.a.imageType)||
Bb.hasProperty(e.a.CZ)?this.Mo(Ja.instance,jc):this.Mo(hc.instance,jc);case 1074135140:return this.Mo(n.instance,jc);case 1074135137:return this.Mo(B.instance,jc);case 1074135139:return this.Mo(G.instance,jc);case 1074135138:return this.Mo(F.instance,jc);case 1074135136:return this.Mo(L.instance,jc);case 1074135157:return this.Mo(S.instance,jc);case 1074135152:return this.Mo(E.instance,jc);case 1074135153:return this.Mo(P.instance,jc);case 1074135126:return this.Mo(T.instance,jc);case 1074135127:return this.Mo(U.instance,
jc);case 1074135145:return this.Mo(da.instance,jc);case 1074135144:return this.Mo(X.instance,jc);case 1074135142:return this.Mo(ua.instance,jc);case 1074135143:return this.Mo(ra.instance,jc);case 1074135163:return this.Mo(qa.instance,jc);case 1074135164:return this.Mo(ka.instance,jc);case 1074135124:return this.Mo(la.instance,jc);case 1074135125:return this.Mo(Ha.instance,jc);case 1074135122:return this.Mo(Ca.instance,jc);case 393233:return this.Mo(Ja.instance,jc);case 1073872970:return this.Mo(Ja.instance,
jc);case 1074135170:return this.Mo(bb.instance,jc);case 1074135168:return this.Mo(ha.instance,jc);case 1074135166:return this.Mo(ia.instance,jc);case 1074135167:return this.Mo(va.instance,jc);case 1074135169:return this.Mo(Ka.instance,jc);case 1074135165:return this.Mo(Xa.instance,jc);case 393234:return this.Mo(Na.instance,jc);case 393229:return this.Mo(Ra.instance,jc);case 393241:return this.Mo(Sa.instance,jc);case 393227:return this.Mo(zb.instance,jc);case 131120:return this.Mo(Ab.instance,jc);
case 393271:return this.Mo(Ua.instance,jc);case 393230:return this.Mo(mb.a.instance,jc);case 131140:return this.Mo(Hb.instance,jc);case 1179649:return this.Mo(Aa.instance,jc);case 1073872969:return this.Mo(ma.instance,jc);case 393252:return this.Mo(ib.instance,jc);case 393250:return this.Mo(ob.instance,jc);case 393251:return this.Mo(fb.instance,jc);case 1074135154:return this.Mo(Eb.instance,jc);case 1074135161:return this.Mo(Mb.instance,jc);case 1074135162:return this.Mo(Zb.instance,jc);case 1074135155:return this.Mo(tc.instance,
jc);case 1073872968:return this.Mo(lc.instance,jc);case 1074135172:return this.Mo(Ma.instance,jc);case 1074135171:return this.Mo(xa.instance,jc);case 1074135149:return this.Mo(wa.instance,jc);case 1074135151:return this.Mo(Ta.instance,jc)}return this.Mo(k.a.instance,jc)}Mo(Bb,jc){Bb.Qb=jc?jc():null;return Bb}}Object(C.a)(Lc,"GraphNodeComplexMergeFactory",null,[1789])},1846:function(C,N,d){d.r(N);C=d(0);var l=d(1501),e=d(76),a=d(282),k=d(72),n=d(1478);class v{constructor(H,I,J,L=0){this.v2h=H;this.groupType=
I;this.Rjf=L;this.TYc=J}}Object(C.a)(v,"SortingGroup",null,[]);class u{constructor(H,I,J,L){this.order=H;this.l6=I;this.tRl=J;this.groupType=L}}Object(C.a)(u,"SortingProp",null,[]);var t=d(1471),y=d(1474),B=d(1470),G=d(28);class F{constructor(H,I){this.epi={};this.cpi={};this.Yoi=this.kpi=1;this.Lhh(H,I)}H_n(H,I,J){var L=B.a.ZW(J)?this.epi:this.cpi;J=new e.a;for(var S of I)I=Object(k.a)(u,L[l.a[S.groupType].toLowerCase()]),G.c(I)||J.add(new a.a(I,S));J.Sc((P,T)=>P.key.order<T.key.order?-1:1);Array.clear(H);
S=t.TellMeActor.instance.UY;for(I=0;I<J.count;){L=J.J(I).key.l6;var E=J.J(I).value;const P=new n.a(J.J(I).key.groupType);G.c(S)||S.Location===y.a.contextMenu||(P.displayName=J.J(I).key.tRl);for(const T of E.results)P.yz(T);for(E=++I;E<J.count&&J.J(E).key.l6===L;)this.HOe(P,J.J(E).value),E=++I;H.push(P)}}Qlo(H,I){this.Yoi=this.kpi=1;this.Lhh(H,I)}Lhh(H,I){this.D6i(H);for(var J=0;J<H.length;J++){let L=H[J];for(const S of L.TYc)this.S2j(S,J,L.v2h,L.groupType)}this.D6i(I);for(H=0;H<I.length;H++){J=I[H];
for(const L of J.TYc)this.R2j(L,H,J.v2h,J.groupType)}}D6i(H){H.sort((I,J)=>Object(k.a)(v,I).Rjf>Object(k.a)(v,J).Rjf?-1:1)}S2j(H,I,J,L){this.epi[l.a[H].toLowerCase()]=new u(this.kpi++,I,J,L)}R2j(H,I,J,L){this.cpi[l.a[H].toLowerCase()]=new u(this.Yoi++,I,J,L)}HOe(H,I){for(let J=0;J<I.results.length;J++)H.yz(I.results[J])}}Object(C.a)(F,"BaseGroupingSorter",null,[]);class K{constructor(){this.dUd=[new v(CommonUIStrings.l_TellMeRecentlyUsedTitleV2,4,[4,2]),new v(CommonUIStrings.l_TellMeCommandProviderTitle,
7,[18,16,7]),new v(CommonUIStrings.l_TellMeSuggestionsProviderTitle,30,[15,14,19,3]),new v("",13,[13]),new v("",22,[22])];this.ZTd=[new v(CommonUIStrings.l_TellMeCommandProviderTitle,28,[17,0,1,8,25]),new v(CommonUIStrings.l_TellMeSuggestedSearchesProviderTitle,29,[2,19,23,26]),new v(CommonUIStrings.l_TellMePotentialMatchesProviderTitle,30,[15,14,20,9,12,10,11,24]),new v("",13,[13]),new v("",22,[22])];this.Joi=new F(this.dUd,this.ZTd)}W0c(H,I,J,L=null,S=null){let E=!1;if(L){for(const P of B.a.ZW(J)?
this.dUd:this.ZTd)this.pfn(P,L);E=!0}if(S){for(const P of B.a.ZW(J)?this.dUd:this.ZTd)this.Rlo(I,P,S);E=!0}E&&this.Joi.Qlo(this.dUd,this.ZTd);this.Joi.H_n(H,I,J)}pfn(H,I){const J=new e.a;for(var L of H.TYc){const S=I[l.a[L].toLowerCase()];J.add(new a.a(G.c(S)?Number.MAX_VALUE:S,L))}if(J.count){J.Sc((S,E)=>S.key<E.key?-1:1);I=Array(J.count);for(L=0;L<J.count;L++)I[L]=J.J(L).value;H.TYc=I}}Rlo(H,I,J){let L=0;for(const S of I.TYc)if(l.a[S].toLowerCase()in J&&J[l.a[S].toLowerCase()])for(const E of H)if(E.groupType===
S){L+=J[l.a[S].toLowerCase()];break}I.Rjf=L}}Object(C.a)(K,"SimplifiedGroupingSorter",null,[]);d.d(N,"GroupsPlacementInfo",function(){return O});class O{constructor(H){this.bpi={};this.Zoi={};this.$oi={};this.fpi={};this.Nyf={};this.gpi=this.tDm=this.oDm=this.qDm=1;this.hpi=null;this.hD=H;this.lnk();this.b6m();this.Omk();this.Hlk();H.VQ&&(this.hpi=new K)}RH(H){this.bpi[l.a[H].toLowerCase()]=this.qDm++}fL(H,I){this.Zoi[l.a[H].toLowerCase()]=I}hJa(H){this.$oi[l.a[H].toLowerCase()]=this.oDm++}l1(H){this.fpi[l.a[H].toLowerCase()]=
this.tDm++}ZD(H){this.Nyf[l.a[H].toLowerCase()]=this.gpi++}lnk(){const H=!!this.hD&&this.hD.L_a,I=!!this.hD&&this.hD.aUc,J=!!this.hD&&this.hD.Bgb,L=!!this.hD&&this.hD.buf&&!B.a.JDb(),S=!!this.hD&&this.hD.BPc,E=!!this.hD&&this.hD.uNd,P=!!this.hD&&this.hD.lsf;this.RH(4);this.RH(18);this.RH(16);this.RH(7);this.RH(17);this.RH(0);this.RH(1);P&&this.RH(25);S&&this.RH(23);H||this.RH(2);H&&!I||this.RH(8);this.RH(15);J&&this.RH(20);this.RH(14);this.RH(9);this.RH(12);this.RH(10);this.RH(11);H&&this.RH(2);H&&
!I&&this.RH(8);this.RH(19);E&&this.RH(24);this.RH(21);this.RH(13);L&&this.RH(22)}b6m(){this.fL(21,1);this.fL(4,3);this.fL(18,3);this.fL(16,3);this.fL(7,3);this.fL(17,5);this.fL(0,5);this.fL(1,1);this.fL(25,2);this.fL(2,1);this.fL(8,2);this.fL(15,3);this.fL(14,2);this.fL(24,3);this.fL(9,1);this.fL(12,1);this.fL(10,1);this.fL(11,1);this.fL(19,1);this.fL(23,1);this.fL(13,1);this.fL(20,2);this.fL(22,1)}Omk(){this.hJa(4);this.hJa(0);this.hJa(17);this.hJa(7);this.hJa(16);this.hJa(18);this.hJa(15);this.hJa(20);
this.hJa(8);this.hJa(14)}Hlk(){this.l1(14);this.l1(10);this.l1(12);this.l1(9);this.l1(11);this.l1(20);this.l1(15);this.l1(8);this.l1(2);this.l1(1);this.l1(24);this.l1(7);this.l1(18);this.l1(16);this.l1(17);this.l1(0);this.l1(4)}Vwn(){this.Nyf={};this.gpi=1}wHl(H,I,J){this.Vwn();const L=!!this.hD&&this.hD.L_a,S=!!this.hD&&this.hD.aUc,E=!!this.hD&&this.hD.Bgb,P=!!this.hD&&this.hD.buf&&!B.a.JDb(),T=!!this.hD&&this.hD.BPc,U=!!this.hD&&this.hD.uNd,X=!!this.hD&&this.hD.lsf;H=H&&S;this.ZD(4);this.ZD(18);
this.ZD(16);this.ZD(7);this.ZD(17);this.ZD(0);this.ZD(1);X&&this.ZD(25);T&&this.ZD(23);L&&!S||!H||this.ZD(8);I&&this.ZD(15);L||this.ZD(2);U&&this.ZD(24);J&&this.ZD(14);L&&!S||H||this.ZD(8);I||this.ZD(15);E&&this.ZD(20);J||this.ZD(14);this.ZD(9);this.ZD(12);this.ZD(10);this.ZD(11);L&&this.ZD(2);L&&!S&&this.ZD(8);this.ZD(19);this.ZD(21);this.ZD(13);P&&this.ZD(22);return this.Nyf}ON(){return this.hD}}Object(C.a)(O,"GroupsPlacementInfo",null,[])},1848:function(C,N,d){C=d(0);var l=d(1715),e=d(59);class a{constructor(){this.source=
0;this.Zl=this.zwa=this.G3=null;this.P2=0;this.X4b=!1;this.mode=this.QPa=0;this.SFc=null;this.uFb=e.a.create()}}Object(C.a)(a,"InputState",null,[]);class k{constructor(){this.timeout=this.succeeded=this.crash=!1;this.ZL=null}}Object(C.a)(k,"OutputState",null,[]);class n{constructor(){this.n8h=this.n8d=this.q0c=!1;this.Qb=this.MUd=this.gKf=this.K2d=this.Z3f=this.Qwb=this.JJa=this.bG=this.Nhb=this.ffc=this.oeo=this.f7k=this.Rm=this.U2e=this.lq=this.Yt=this.lk=this.nce=this.fCd=this.Dza=null}}Object(C.a)(n,
"RuntimeState",null,[]);d.d(N,"a",function(){return v});class v{constructor(){this.input=new a;this.runtime=new n;this.output=new k;this.logger=new l.a(this)}}Object(C.a)(v,"MergeState",null,[])},1849:function(C,N,d){d.r(N);C=d(0);var l=d(619),e=d(216),a=d(150),k=d(120),n=d(1588),v=d(1669),u=d(1696),t=d(5),y=d(1839);class B{constructor(J,L){this.start=J;this.end=L}}Object(C.a)(B,"MergeDiffIdx",null,[]);class G{constructor(J,L,S,E=!1,P=null,T=null,U=!0){this.R9c=this.Q9c=this.FBg=this.Jrc=0;this.aWb=
this.Die=null;this.j7a=P||new y.a;this.Lg=S;this.Voa=J.x3();this.fZj=L.x3();this.FO=new B(0,0);this.nS=new B(0,0);this.wse=E;this.Toc=U;this.Cpa=T;this.fpk();this.fMn()}get MJ(){return this.Voa}get eJ(){return this.fZj}get Py(){return this.Jrc}get Fz(){return this.FBg}get ksa(){return this.Q9c}get Bka(){return this.R9c}get fWk(){const J=new e.a;for(let L=this.Die.start;L<this.Die.end;L++)J.add(this.MJ.lg(L));return J}get j4e(){const J=new e.a;for(let L=this.aWb.start;L<this.aWb.end;L++)J.add(this.eJ.lg(L));
return J}o5e(J){if(this.Fz<J.Fz){if(this.Fz+this.ksa>J.Fz)return!0}else if(this.Fz>J.Fz){if(J.Fz+J.ksa>this.Fz)return!0}else if(2===this.Py&&3===J.Py||3===this.Py&&2===J.Py||2===this.Py&&2===J.Py||3===this.Py&&3===J.Py)return!0;return!1}cQi(J,L,S,E){J.mF(L);J.EA(L,S);return E+=S.length-1}$6i(J,L,S,E,P){let T=this.MJ.lg(J),U=this.eJ.lg(L);if(!T||!U||!T.v3a&&!U.v3a)return{returnValue:!1,gza:E,kFa:P};let X=new e.a,Y=new e.a;T.v3a&&(X=T.d1c(),T=X.lg(S?0:X.length-1));U.v3a&&(Y=U.d1c(),U=Y.lg(S?0:Y.length-
1));if(!T.Oz(U,this.j7a,this.Cpa,this.wse,this.Toc))return{returnValue:!1,gza:E,kFa:P};X.length&&(E=this.cQi(this.MJ,J,X,E));Y.length&&(P=this.cQi(this.eJ,L,Y,P));return{returnValue:!0,gza:E,kFa:P}}v9k(J,L,S,E,P,T){for(;P<=S&&T<=E;){const U=J.lg(P),X=L.lg(T);if(!U.Oz(X,this.j7a,this.Cpa,this.wse,this.Toc))break;this.FO.start+=U.length;this.nS.start+=X.length;P++;T++}return{MSe:P,g8f:T}}t9k(J,L,S,E,P,T){for(;P>=S&&T>=E;){const U=J.lg(P),X=L.lg(T);if(!U.Oz(X,this.j7a,this.Cpa,this.wse,this.Toc))return{returnValue:!0,
gza:P,kFa:T};P--;T--}return{returnValue:!1,gza:P,kFa:T}}u9k(J,L,S,E){let P=!1;do({MSe:J,g8f:L}=this.v9k(this.MJ,this.eJ,S,E,J,L)),{gza:S,kFa:E,returnValue:P}=this.$6i(J,L,!0,S,E);while(P);return{MSe:J,g8f:L,gza:S,kFa:E}}s9k(J,L,S,E){let P=!1;do{if(!({gza:S,kFa:E}=this.t9k(this.MJ,this.eJ,J,L,S,E)).returnValue)break;({gza:S,kFa:E,returnValue:P}=this.$6i(S,E,!1,S,E))}while(P);return{gza:S,kFa:E}}fpk(){var J=0,L=0,S=this.MJ.length-1,E=this.eJ.length-1;0<=S&&this.MJ.lg(S);0<=E&&this.eJ.lg(E);({MSe:J,
g8f:L,gza:S,kFa:E}=this.u9k(J,L,S,E));if(J<S||L<E)({gza:S,kFa:E}=this.s9k(J,L,S,E));S++;E++;this.Die=new B(J,S);this.aWb=new B(L,E);this.FO.end=this.FO.start;this.nS.end=this.nS.start;for(var P=J;P<S;P++){var T=this.MJ.lg(P);this.FO.end+=T.length}for(P=L;P<E;P++)T=this.eJ.lg(P),this.nS.end+=T.length;a.a.instance.Wa(3993809,1,4,"CalculateDiffIndexes: NonGranularList idxs [Base.Start: {0}] [Base.End: {1}] [Update.Start: {2}] [Update.End: {3}]",J,S,L,E);a.a.instance.Wa(3993810,1,4,"CalculateDiffIndexes: GranularList idxs [Base.Start: {0}] [Base.End: {1}] [Update.Start: {2}] [Update.End: {3}]",
this.FO.start,this.FO.end,this.nS.start,this.nS.end);this.FO.start<=this.FO.end&&this.nS.start<=this.nS.end&&(J=this.MJ.lg(J),L=this.eJ.lg(L),P=this.MJ.lg(S),T=this.eJ.lg(E),S=this.MJ.lg(S-1),E=this.eJ.lg(E-1),a.a.instance.Wa(3993811,1,4,"CalculateDiffIndexes: Merge Blocks [Base.Start: {0}] [Base.End: {1}] [Update.Start: {2}] [Update.End: {3}] [Base.UnequalEnd: {4}] [Update.UnequalEnd: {5}]",J,P,L,T,S,E))}fMn(){this.FBg=this.FO.start;this.Q9c=this.R9c=0;this.FO.start===this.FO.end&&this.nS.start===
this.nS.end?this.Jrc=0:this.FO.start===this.FO.end&&this.nS.start<this.nS.end?(this.Jrc=1,this.R9c=this.nS.end-this.nS.start):this.nS.start===this.nS.end&&this.FO.start<this.FO.end?(this.Jrc=2,this.Q9c=this.FO.end-this.FO.start):(this.Jrc=3,this.Q9c=this.FO.end-this.FO.start,this.R9c=this.nS.end-this.nS.start);a.a.instance.Wa(3993814,1,4,"SetMergeDiffType: [MergeDiffType: {0}] [DiffIndex: {1}] [DiffLengthBase: {2}] [DiffLengthUpdate: {3}]",this.Py,this.Fz,this.ksa,this.Bka)}jgm(J,L){return J.I2()&&
L.I2()?J.runId===L.runId&&J.Bg===L.Bg:!1}hlm(J){if(!J.I2()||"\ufffc"!==J.text)return!1;J=J.yzb;return J?J.hasProperty(t.a.Qj)||J.hasProperty(t.a.Tsd)||J.hasProperty(t.a.R5e)||J.hasProperty(t.a.a6)||J.hasProperty(t.a.imageType)||J.hasProperty(t.a.MMa)||J.hasProperty(t.a.ODb)||J.hasProperty(t.a.Eq)&&(J=this.Lg.getPropertyInt32(J,t.a.Eq))&&(36===J||35===J||24===J||23===J||33===J||34===J||44===J||45===J||42===J||43===J)?!0:!1:!1}tOc(J){return J.I2()&&!this.hlm(J)}Oqk(){if(2===this.Py)return!1;var J=this.aWb.start;
if(!J)return!1;let L=null;for(var S=this.aWb.start;S<this.aWb.end;S++){const E=this.eJ.lg(S);if(this.tOc(E)){L=E;break}}if(!L)return!1;--J;for(S=this.eJ.lg(J);S&&!this.tOc(S);)J--,S=this.eJ.lg(J);return S&&this.jgm(S,L)?!0:!1}wRh(J){const L=new e.a;for(let S=0;S<J.length;S++)J.J(S).v3a?L.EA(L.length,J.J(S).d1c()):L.insert(L.length,J.J(S));return L}lgm(){if(3!==this.Py||this.ksa!==this.Bka)return!1;const J=this.wRh(this.fWk),L=this.wRh(this.j4e);if(J.length!==L.length)return!1;for(let S=0;S<J.length;S++)if(!J.J(S).Oz(L.J(S),
this.j7a,this.Cpa,!0,this.Toc))return!1;return!0}kgm(){if(0!==this.Py&&3!==this.Py||this.MJ.length!==this.eJ.length)return!1;let J=!1;for(let L=0;L<this.MJ.length;L++){if(!this.MJ.J(L).Oz(this.eJ.J(L),this.j7a,this.Cpa,!0,this.Toc))return!1;if(3===this.MJ.J(L).type||1===this.MJ.J(L).type){const S=this.MJ.J(L),E=this.eJ.J(L);J=S.runId!==E.runId||S.Bg!==E.Bg||J}}return J}}Object(C.a)(G,"MergeBlockDiff",null,[]);var F=d(1551);class K{constructor(J,L){this.id=J;this.index=L}}Object(C.a)(K,"ParagraphStartIndex",
null,[]);var O=d(1598),H=d(1537);d.d(N,"ParagraphMerge",function(){return I});class I{constructor(J,L,S,E,P,T,U){this.bUb=this.fsb=this.Ao=this.Ew=null;this.Bh=!1;this.i4g=this.YDg=this.Nvg=this.$qa=this.OGa=this.Voa=null;this.ge=J;this.GE=L;this.Cya=E;this.rxa=S;this.Bpa=P;this.Cpa=T;this.Lg=U}QXh(J){const L=new l.a;J.MJ.forEach(S=>{2===S.type&&L.add(S.Cj);return!0});J.eJ.forEach(S=>{2===S.type&&L.remove(S.Cj);return!0});return L}sUh(J){const L=new e.a;J.eJ.forEach(S=>{2===S.type&&L.add(S.Cj);return!0});
return L}Rph(J){const L=new e.a;let S=0,E=0;J.eJ.forEach(P=>{2===P.type&&(L.add(new K(P.Cj,S<J.Fz?S:S<J.Fz+J.Bka?J.Fz:S-J.Bka+J.ksa)),S=E);E+=P.length;return!0});return L}qCk(J,L){var S=this.Rph(J);const E=this.Rph(L);J=this.QXh(J);const P=this.QXh(L);L=new e.a;const T=new l.a;let U=0;for(let X=0;X<S.length;X++){const Y=S.J(X);if(U<E.length){let ca=E.J(U);for(;U<E.length&&ca.index<=Y.index;){if(ca.id.equals(Y.id)){U++;break}J.contains(ca.id)||T.contains(ca.id)||(L.add(ca.id),T.add(ca.id));U++;ca=
E.J(U)}}P.contains(Y.id)||(L.add(Y.id),T.add(Y.id))}for(;U<E.length;)S=E.J(U),J.contains(S.id)||T.contains(S.id)||(L.add(S.id),T.add(S.id)),U++;return L}initialize(){if(this.Bh){const J=!!this.Ew&&!!this.Ao;this.ge.logger.Pg(Object.assign(new F.a,{lj:"ParagraphMerge.Initialize",info:"MergeDiff objects not initialized"}));return J}this.Bh=!0;if(!({MJ:this.Voa,RFc:this.OGa,p3c:this.$qa,Isd:this.Nvg,gCd:this.YDg,oce:this.i4g}=H.a.muh(this.ge,this.Lg,this.GE,this.rxa,this.Cya,this.Bpa,!1,!1)).returnValue)return!1;
this.Ew=new G(this.Voa,this.OGa,this.Lg,void 0,void 0,this.Cpa);this.Ao=new G(this.Voa,this.$qa,this.Lg,void 0,void 0,this.Cpa);a.a.instance.Wa(593272919,1,4,String.format("FavoredBaseDiffLen: {0} FavoredUpdateDiffLen: {1} UnfavoredBaseDiffLen: {2} UnfavoredUpdateDiffLen {3}",this.Ew.ksa,this.Ew.Bka,this.Ao.ksa,this.Ao.Bka));return!0}$Ea(){a.a.instance.Wa(593826836,1,4,"Attempting to merge with LCS");let J=!1;const L=new u.a(this.Lg,this.ge);let S=null,E=null;var P=null;const T=X=>this.ge.runtime.lk.J(X),
U=X=>this.ge.runtime.lq.J(X)||this.ge.runtime.lk.J(X);this.Ew=new G(this.Voa,this.OGa,this.Lg,void 0,void 0,this.Cpa,!1);this.Ao=new G(this.Voa,this.$qa,this.Lg,void 0,void 0,this.Cpa,!1);({updateHints:S}=L.Ovh(this.GE,T,this.rxa,X=>this.ge.runtime.Yt.J(X)||this.ge.runtime.lk.J(X),this.Ew.Fz,this.Ew.Fz+this.Ew.ksa,this.Ew.Fz+this.Ew.Bka)).returnValue&&({updateHints:E}=L.Ovh(this.GE,T,this.Cya,U,this.Ao.Fz,this.Ao.Fz+this.Ao.ksa,this.Ao.Fz+this.Ao.Bka)).returnValue&&(J=!0);J||(a.a.instance.Wa(593826835,
1,2,"Failed to create update hints with LCS"),J=!1);J&&(P=new O.a(this.ge,this.GE,this.rxa,this.Cya,X=>this.ge.runtime.Qb?this.ge.runtime.Qb.isFeatureEnabled(X):!1,this.Lg,null,S,E),({Rm:P}=P.Ugc()).returnValue||(a.a.instance.Wa(593826834,1,2,"Failed to merge using LCS generated UpdateHints"),this.ge.logger.Pg(Object.assign(new F.a,{lj:"TryLCSMerge",eventId:"9zrqs"})),J=!1));a.a.instance.Wa(593826833,1,J?4:2,"TryLCSMerge: [Success: {0}]",J);return{returnValue:J,Rm:P}}Ugc(){let J;J=null;if(!this.initialize())return this.ge.logger.YT("ParagraphMerge Initialize"),
this.m0a(),{returnValue:!1,Rm:J};this.ge.logger.YT("ParagraphMerge Initialize");let L;this.ge.logger.e7d(2);let S=({$Ea:L}=this.IYk()).returnValue;S=S&&({Rm:J,$Ea:L}=this.LIc(this.ge,this.Lg,this.Bpa,this.bUb,this.fsb)).returnValue;this.ge.logger.BYf();if(!S){this.ge.logger.YT("ParagraphMerge DoMergeInteral");if(L){this.ge.logger.e7d(3);({Rm:J,returnValue:S}=this.$Ea());this.ge.logger.BYf();if(S)return{returnValue:!0,Rm:J};this.m0a();return{returnValue:!1,Rm:J}}this.m0a();return{returnValue:!1,Rm:J}}if(!({Rm:J,
$Ea:L}=this.LIc(this.ge,this.Lg,this.Bpa,this.bUb,this.fsb)).returnValue)return this.ge.logger.YT("ParagraphMerge DoMergeInteral"),this.m0a(),{returnValue:!1,Rm:J};this.ge.logger.YT("ParagraphMerge DoMergeInteral");return{returnValue:!0,Rm:J}}LIc(){let J;if(!({m_d:J}=H.a.LIc(this.ge,this.Lg,this.Bpa,this.bUb,this.fsb)).returnValue)return this.ge.logger.YT("ParagraphMerge GetMergeableObjectsFromMergeBlocks"),this.m0a(),{returnValue:!1,Rm:J,$Ea:!0};this.ge.logger.YT("ParagraphMerge GetMergeableObjectsFromMergeBlocks");
return{returnValue:!0,Rm:J,$Ea:!1}}m0a(J=!1){a.a.instance.nha(4478665,1,1,"ParagraphMergeFailed: [IsCpMerge: "+J+"] BaseRevisionMergeBlocksList: {0}",this.Nvg);a.a.instance.nha(4478666,1,1,"FavoredRevisionMergeBlocksList: {0}",this.YDg);a.a.instance.nha(4478667,1,1,"UnfavoredRevisionMergeBlocksList: {0}",this.i4g);J=new e.a;H.a.$8b(this.Lg,"BaseObjects_",this.GE,J);H.a.$8b(this.Lg,"FavoredObjects_",this.rxa,J);H.a.$8b(this.Lg,"ConflictObjects_",this.Cya,J);H.a.$wm(this.ge,J)}djh(J){let L,S;S=L=0;
if(0===this.Ew.Py)L=this.Ao.Fz;else if(1===this.Ew.Py)L=this.Ao.Fz<this.Ew.Fz?this.Ao.Fz:this.Ao.Fz===this.Ew.Fz?J||1!==this.Ao.Py?this.Ao.Fz+this.Ew.Bka:this.Ao.Fz:this.Ao.Fz+this.Ew.Bka;else if(2===this.Ew.Py||3===this.Ew.Py)L=this.Ao.Fz<=this.Ew.Fz?this.Ao.Fz:this.Ao.Fz+(this.Ew.Bka-this.Ew.ksa);if(2===this.Ao.Py||3===this.Ao.Py)S=L+this.Ao.ksa;return{e2h:L,PQl:S}}MHh(J,L){let S;S=0;if(!L)return{returnValue:!0,OSc:S};let E=0,P=0;for(;E<J.length;){let T;for(let U=E;U<J.length;U++){E=U;T=J.J(U);
const X=T.length;P+=X;if(!(P<L)){if(P>L)if(T.v3a)J.mF(E),J.EA(E,T.d1c()),P-=X;else return a.a.instance.Wa(3993819,1,1,"ParagraphMerge:FindNonGranularListIndex: ParagraphMerge returned failure as we were unable to find index for [GranularListIndex: {0}] as the block could not be split",L),this.ge.logger.Pg(Object.assign(new F.a,{lj:"FindNonGranularListIndex",eventId:"appd1"})),{returnValue:!1,OSc:S};break}}if(P===L)return E++,S=E,{returnValue:!0,OSc:S}}a.a.instance.Wa(3993820,1,1,"ParagraphMerge:FindNonGranularListIndex: ParagraphMerge returned failure as we were unable to find index for [GranularListIndex: {0}]",
L);this.ge.logger.Pg(Object.assign(new F.a,{lj:"FindNonGranularListIndex",eventId:"appd2"}));return{returnValue:!1,OSc:S}}gek(J,L,S){let E=0;var P=0,T=!1;const U=this.Ao.j4e.x3();if(this.Ao.Oqk())for(--L;0<=L;L--){let X=J.J(L);if(this.Ao.tOc(X)){P=J.J(L);E=P.runId;P=P.Bg;T=!0;break}}T||((P=J.J(S))&&this.Ao.tOc(P)?(E=P.runId,P=P.Bg):P=E=0);for(J=0;J<U.length;J++)S=U.J(J),S.I2()&&(T=S,this.Ao.tOc(S)?(T.runId=E,T.Bg=P):(T.runId=0,T.Bg=0));return U}lfi(J){if(2===J.length){const L=1===J.J(0).type?J.J(0):
null;J=2===J.J(1).type;if(L&&J&&""===L.text)return!0}return!1}IYk(){const J=this.Ew.kgm();if(!J&&0===this.Ew.Py)return this.bUb=this.Ao.eJ.x3(),this.fsb=this.sUh(this.Ao),{returnValue:!0,$Ea:!1};if(0===this.Ao.Py)return this.bUb=this.Ew.eJ.x3(),this.fsb=this.sUh(this.Ew),{returnValue:!0,$Ea:!1};(this.lfi(this.Ew.eJ)||this.lfi(this.Ao.eJ))&&this.ge.logger.dmi(Object.assign(new F.a,{info:"DoMergeInternal - OneParaEmpty"}));if(!J){var L=this.Ew.o5e(this.Ao);L&&this.Bpa(55)&&(a.a.instance.Wa(17326359,
1,2,"DoMergeInternal: Diff overlaps when we take formatting ids into account. Running another diff without formatting ids"),this.Ew=new G(this.Voa,this.OGa,this.Lg,!0,void 0,this.Cpa),this.Ao=new G(this.Voa,this.$qa,this.Lg,!0,void 0,this.Cpa),L=this.Ew.o5e(this.Ao));if(L)return a.a.instance.Wa(3993821,1,2,"DoMergeInternal: We were unable to merge as there was an overlap in the changes in the 2 revisions"),this.ge.logger.Pg(Object.assign(new v.a,{lj:"ParagraphMerge",eventId:"appd3"})),{returnValue:!1,
$Ea:!0}}var S;L=0;this.fsb=this.qCk(this.Ew,this.Ao);({e2h:S,PQl:P}=this.djh(!1));const E=this.Ew.eJ.x3();if(!({OSc:S}=this.MHh(E,S)).returnValue||(2===this.Ao.Py||3===this.Ao.Py)&&!({OSc:L}=this.MHh(E,P)).returnValue)return{returnValue:!1,$Ea:!1};if(2===this.Ao.Py||3===this.Ao.Py){this.Kdc(E,L);this.Kdc(E,S-1);var P=null;for(var T=L-1;T>=S;T--)2===E.J(T).type&&(P=E.J(T)),E.mF(T);0<E.length&&(T=E.J(E.length-1),2!==T.type&&4!==T.type&&P&&(this.ge.runtime.Qb.Vq(78),this.ge.runtime.Qb.isFeatureEnabled(78)&&
(E.add(P),this.fsb.add(P.Cj))));a.a.instance.Wa(4019726,1,4,"DoMergeInternal deleted [Length: {0}] merge blocks at [Index: {1}]",L-S-1,S)}if(1===this.Ao.Py||3===this.Ao.Py)P=this.Ao.j4e,J&&(P=this.gek(E,S,L)),this.Kdc(E,S-1),this.Kdc(E,S),this.Kdc(P,0),this.Kdc(P,P.length-1),E.EA(S,P),a.a.instance.Wa(4019727,1,4,"DoMergeInternal: Inserted merge blocks at [Index: {0}] [Syncdiff merge: {1}] [Merge Blocks: {2}]",S,J,P.Dq());this.bUb=E;return{returnValue:!0,$Ea:!1}}Kdc(J,L){0>L||L>=J.length||(J=J.J(L),
Object(k.a)(n.a,J)&&(J.EMa=!0))}A3c(J,L){let S;S=L;if(!this.initialize())return{returnValue:!1,i2a:J,Hna:S};if(this.Ao.o5e(this.Ew))return this.m0a(!0),this.ge.logger.Pg(Object.assign(new v.a,{lj:"ParagraphMerge",info:"Is a CpMerge"})),{returnValue:!1,i2a:J,Hna:S};if(0===this.Ao.Py||3===this.Ao.Py&&this.Ao.lgm())return{returnValue:!0,i2a:J,Hna:L};let E;({e2h:E}=this.djh(!0));L<E||L===E&&(1!==this.Ao.Py||1===this.Ao.Py&&1===this.Ew.Py&&L===this.Ew.Fz+this.Ew.Bka)?S=L:(S=L+this.Ao.Bka-this.Ao.ksa,S<
E&&(S=E));return{returnValue:!0,i2a:J,Hna:S}}}Object(C.a)(I,"ParagraphMerge",null,[1741])},1850:function(C,N,d){d.r(N);C=d(0);var l=d(1604),e=d(1534),a=d(1501),k=d(1717),n=d(1533);class v{constructor(O="",H="",I="",J=-99999,L=-1,S=0){this.Type=this.Description=this.Title=null;this.Count=this.Age=this.Score=0;this.Title=O?O:"";this.Description=H?H:"";this.Type=I?I:"";this.Score=J;this.Age=L;this.Count=S}}Object(C.a)(v,"Suggestion",null,[]);class u{constructor(O,H){this.GroupType=this.Suggestions=null;
this.Suggestions=O;this.GroupType=H}}Object(C.a)(u,"SuggestionGroup",null,[]);class t{}t.help="help";t.answer="answer";t.commands="commands";t.LGn="servicecommands";t.template="template";Object(C.a)(t,"SuggestionGroupType",null,[]);var y=d(1471),B=d(1470),G=d(2),F=d(35);d.d(N,"InteractionLogger",function(){return K});class K{constructor(O,H,I){this.eoe=0;this.DJe=this.Iqc=null;this.Wd=O;this.HHe=this.tle=this.Tse=!1;this.oAj=H;this.rg=G.AFrameworkApplication.Xe;this.qc=I;this.m9c=this.lCe=0}get Ana(){return this.Wd.Ana}m7d(O){this.Wd.m7d(O)}tni(){if(this.Iqc){var O=
0;for(const H of this.Iqc)this.Wd.MAm(H,O++);this.Iqc=null}}beginQuery(O,H,I){this.Wd.BAm(O,H,I)}kib(O,H){this.Wd.Lhk(O,H);this.Tse=!0;this.HHe=!1}Hua(){this.Tse=!1;this.tle||(this.tni(),this.Wd.xDh(this.eoe))}CAm(O,H){this.Wd.DAm(O,H)}mQm(O,H,I,J,L){for(const S of this.oAj)if(O.startsWith(S)){this.HHe=!0;break}this.Wd.owm(O,H,I,J,L)}UQm(O){this.tle=!1;this.eoe=O;this.Tse||this.HHe||(this.tni(),this.Wd.xDh(this.eoe,!1))}TQm(O,H){this.Wd.uwm(O,H);this.tle=!0}yaf(O,H){if(!O.count)return"";let I="";
const J=Date.now();for(let L of O)O=(J-L.timeStamp)/1E3,O=B.a.F6f(O),0<I.length&&(I+=";"),I+=H?L.commandId:L.controlId,I+=":",I+=O.toString();return I}V0a(){var O=this.yaf(l.a.instance.t2b(),!1);0<O.length&&this.Wd.mwm(O);O=this.yaf(l.a.instance.gdb(),!0);0<O.length&&this.Wd.Hvm(O);O=this.yaf(l.a.instance.xnc,!0);0<O.length&&this.Wd.nxm(O);O=y.TellMeActor.instance.tRg;0<O.length&&this.Wd.zAm(F.c(O))}gBm(O){this.Wd.Tvm(O)}V6(O,H,I,J,L,S,E,P=null){this.Wd.wym(O,H,I,J,L,S,E,P)}Qxf(O,H,I,J){this.Wd.Qxf(O,
H,I,J)}WB(O,H,I=null){this.Wd.laa(O,H,I)}onError(O,H,I=null){this.Wd.l0a(O,H,I)}vLn(O){this.Iqc=O}CKl(O){const H=[];if(!O)return H;for(let I=0;I<O.length;I++){const J=a.a[O[I].groupType].toLowerCase(),L=[],S=O[I].results;if(S){for(let E=0;E<S.length;E++)"findindocument"===J?Array.add(L,new v("","",J,S[E].score,S[E].zrd,S[E].count)):Array.add(L,new v(S[E].label,S[E].description,J,S[E].score,S[E].zrd,S[E].count));"answer"===J||"definition"===J||"wolframanswer"===J||"entity"===J?Array.add(H,new u(L,
t.answer)):"classifier"===J||"appsforoffice"===J?Array.add(H,new u(L,t.commands)):"serviceclassifier"===J?Array.add(H,new u(L,t.LGn)):"assistance"===J?Array.add(H,new u(L,t.help)):("document"===J||"people"===J||"findindocument"===J||"notes"===J||"image"===J||"template"===J)&&Array.add(H,new u(L,J))}}return H}aif(O,H){const I={};I.Query=H;I.SuggestionGroups=F.c(this.CKl(O));return F.c(I)}G_h(O){const H={"Content-Type":"application/json",Accept:"application/json"};H["X-Office-Version"]=G.AFrameworkApplication.buildVersion;
H["X-Office-Application"]=G.AFrameworkApplication.K.lb("Application");H["X-Office-Platform"]="WAC";H["X-TellMe-SqmUserId"]=G.AFrameworkApplication.K.lb("LoggableUserId")||"";H["X-TellMe-SessionId"]=this.Wd.Ana.Rla;H["X-TellMe-SuggestionTypes"]="Ranker";H["X-TellMe-Culture"]=G.AFrameworkApplication.uiCulture;H["X-TellMe-ProcessSessionId"]=G.AFrameworkApplication.userSessionId;H["X-TellMe-Flights"]=O;H["X-TellMe-PartialQueryIndex"]=this.lCe;return H}BGb(O,H,I){this.V6(H.length,"RankerLogging",O.data.wf.toString(),
Math.round(window.performance.now()-I),n.a.Z$i,!0,e.a.YLa)}nGb(O,H,I){this.V6(H.length,"RankerLogging",O.data.wf.toString(),Math.round(window.performance.now()-I),n.a.Z$i,!1,e.a.YLa)}H_h(){this.DJe||(this.DJe=new k.a(this.qc,null,6E3));return this.DJe.b8}Sxf(O){const H=this.aif(this.Iqc,O),I=this.G_h("RankerLogging"),J=window.performance.now();this.rg.Lj(this.H_h(),2,H,I,!1,0,L=>{this.BGb(L,O,J)},L=>{this.nGb(L,O,J)},null,null,!1,4E3,6E3);this.lCe++}Lwn(){this.lCe=0}KXf(O){this.m9c=O}}Object(C.a)(K,
"InteractionLogger",null,[])},1851:function(C,N,d){d.r(N);C=d(0);var l=d(17),e=d(5),a=d(150),k=d(216),n=d(59),v=d(1661),u=d(1587),t=d(1549),y=d(1537);class B{constructor(O,H,I=null){this.author=O;this.fSc=H;this.QMf=I||n.a.nil}Oz(O){return O?this.author===O.author&&this.fSc===O.fSc&&this.QMf===O.QMf:!1}}Object(C.a)(B,"RunMergeBlockTrackedChangeAttribute",null,[]);class G{constructor(O,H,I){this.insertion=O||G.u6e;this.deletion=H||G.u6e;this.zDa=I||G.u6e}get lWl(){return 0<this.insertion.author.length}get OVl(){return 0<
this.deletion.author.length}get LWl(){return 0<this.zDa.author.length}Oz(O){return O?this.insertion.Oz(O.insertion)&&this.deletion.Oz(O.deletion)&&this.zDa.Oz(O.zDa):!1}}G.u6e=new B("",0);Object(C.a)(G,"RunMergeBlockTrackedChangeInfo",null,[]);var F=d(1714);d.d(N,"ParagraphMergeBlockCreator",function(){return K});class K extends u.a{constructor(O,H,I,J,L,S,E){super();this.maxValue=Number.MAX_VALUE;this.gA=new v.a;this.kOb=null;this.dN=0;this.EKg=!1;this.Irc="";this.Ahe=O;this.vs=H;this.Ot=I;this.KVj=
J;this.Pad=L;this.NJg=S;this.Lg=E;if(this.Lg.hasProperty(this.vs,l.a.lo))if(this.Lg.hasProperty(this.vs,e.a.Nc))if(this.Lg.hasProperty(this.vs,e.a.Hq))if(this.Lg.hasProperty(this.vs,e.a.gt))if(this.Lg.hasProperty(this.vs,l.a.un))if(this.V0=this.Lg.getPropertyString(this.vs,l.a.lo),this.LMe=this.Lg.getPropertyUint32(this.vs,e.a.Nc),this.Jr=this.Lg.getPropertyUint32s(this.vs,e.a.Hq),this.Vhd=this.Lg.getPropertyUint32s(this.vs,e.a.gt),this.kqe=this.Lg.getPropertyObjectIds(this.vs,l.a.un),this.V0||""===
this.V0)if(this.V0.length||1!==this.kqe.length||(this.Jr.length||(this.Jr.add(0),a.a.instance.Wa(4322134,1,2,"MergeBlockIterator: Paragraph contains one formattingID, but no runIDs, fixing it")),this.Vhd.length||(this.Vhd.add(0),a.a.instance.Wa(4322135,1,2,"MergeBlockIterator: Paragraph contains one formattingID, but no paraIDs, fixing it"))),this.hNj=this.pEd(this.vs,e.a.PDf,this.Jr.length),this.vtc=this.pEd(this.vs,l.a.xua,this.Jr.length),this.bja=this.pEd(this.vs,l.a.Zkb,this.Jr.length),this.ria=
this.pEd(this.vs,e.a.KLa,this.Jr.length),this.Oia=this.JNl(this.vs,e.a.BDa,this.Jr.length),this.c2l(),O=this.Lg.hasProperty(this.vs,l.a.mm)?this.Lg.getPropertyUint32s(this.vs,l.a.mm):new k.a,this.Rkd=y.a.P_i(O,this.V0.length),this.Jr.length!==this.Vhd.length)a.a.instance.Wa(3993799,1,1,"MergeBlockIterator: Length of RunIds and ParaIds does not match on [Object: {0}]",H.id);else if(this.Jr.length!==this.kqe.length)a.a.instance.Wa(3993800,1,1,"MergeBlockIterator: Length of FormattingIds and ParaIds does not match on [Object: {0}]",
H.id);else{this.NJg&&(this.Lg.hasProperty(this.vs,e.a.Wu)?this.kOb=this.Lg.getPropertyObjectIds(this.vs,e.a.Wu):(a.a.instance.Wa(40939931,1,2,"MergeBlockIterator: ChangeIds are null on [Object: {0}]",H.id),this.kOb=this.kZ(this.Jr.length,n.a.nil)),this.Jr.length!==this.kOb.length&&(a.a.instance.Wa(40939932,1,2,"MergeBlockIterator: Length of RunIds and ChangeIds don't match on [Object: {0}]. RunIds Length: {1} ChangeIds Length: {2}",H.id,this.Jr.length,this.kOb.length),this.kOb=this.kZ(this.Jr.length,
n.a.nil)));if(this.Jr.length!==this.vtc.length||this.Jr.length!==this.bja.length||this.Jr.length!==this.ria.length||this.Jr.length!==this.Oia.length)this.Jr.length===this.vtc.length||this.Pad||a.a.instance.Wa(8266445,1,1,"MergeBlockIterator: Length of NotProofedRuns and ParaIds does not match on [Object: {0}] [RunIds Length: {1}] [NotProofedRuns Length: {2}]",H.id,this.Jr.length,this.vtc.length),this.Jr.length===this.bja.length||this.Pad||a.a.instance.Wa(8266446,1,1,"MergeBlockIterator: Length of SpellErrorRuns and ParaIds does not match on [Object: {0}] [RunIds Length: {1}] [SpellErrorRuns Length: {2}]",
H.id,this.Jr.length,this.bja.length),this.Jr.length===this.ria.length||this.Pad||a.a.instance.Wa(20742792,1,1,"MergeBlockIterator: Length of GrammarErrorRuns and ParaIds does not match on [Object: {0}] [RunIds Length: {1}] [GrammarErrorRuns Length: {2}]",H.id,this.Jr.length,this.ria.length),this.Jr.length===this.Oia.length||this.Pad||a.a.instance.Wa(25274202,1,1,"MergeBlockIterator: Length of ProofingErrorHints and ParaIds does not match on [Object: {0}] [RunIds Length: {1}] [ProofingErrorHints Length: {2}]",
H.id,this.Jr.length,this.Oia.length),O=this.Lg.getPropertyBool(this.vs,l.a.eZe),a.a.instance.Wa(17877020,1,4,"MergeBlockIterator: Reproofing Para {0}. [ForceProofing: {1}] [ContainsIgnoredSpellingErrors: {2}]",H.id,L,null==O?!1:O),this.vtc=this.kZ(this.Jr.length,!0),this.bja=this.kZ(this.Jr.length,!1),this.ria=this.kZ(this.Jr.length,!1),this.Oia=this.kZ(this.Jr.length,0),this.Lg.setPropertyBool(this.vs,l.a.eZe,!1);this.gA.Gpo(this.Jr.length)?(this.Rkd.length!==this.Jr.length+1&&a.a.instance.Wa(3993801,
1,1,"MergeBlockIterator: Length of RunIdexes is different than expected for [Object: {0}] [RunIds Length: {1}] [RunIndices Length: {2}]",H.id,this.Jr.length,this.Rkd.length),this.lKj=!0):a.a.instance.Wa(23205786,1,1,"MergeBlockIterator: Length of RunIds and tracked changes properties does not match on [Object: {0}]",H.id)}else a.a.instance.Wa(4322133,1,1,"MergeBlockIterator: RichEditTextUnicode is null on [Object: {0}]",H.id);else a.a.instance.Wa(3993798,1,1,"MergeBlockIterator: FormattingIds is null on [Object: {0}]",
H.id);else a.a.instance.Wa(3993797,1,1,"MergeBlockIterator: ParaIds is null on [Object: {0}]",H.id);else a.a.instance.Wa(3993796,1,1,"MergeBlockIterator: RunIds is null on [Object: {0}]",H.id);else a.a.instance.Wa(3993795,1,1,"MergeBlockIterator: RichEditTextUnicode is null on [Object: {0}]",H.id);else a.a.instance.Wa(3993794,1,1,"MergeBlockIterator: RichEditTextUnicode is null on [Object: {0}]",H.id)}c2l(){this.Lg.hasProperty(this.vs,e.a.UBa)?this.gA.vfb=this.Lg.getPropertyBools(this.vs,e.a.UBa):
this.gA.vfb=this.kZ(this.Jr.length,!1);this.Lg.hasProperty(this.vs,e.a.Vda)?this.gA.Nbb=this.Lg.getPropertyBools(this.vs,e.a.Vda):this.gA.Nbb=this.kZ(this.Jr.length,!1);this.Lg.hasProperty(this.vs,e.a.VBa)?this.gA.ufb=this.Lg.getPropertyStrings(this.vs,e.a.VBa):this.gA.ufb=this.kZ(this.Jr.length,"");this.Lg.hasProperty(this.vs,e.a.kAa)?this.gA.Mbb=this.Lg.getPropertyStrings(this.vs,e.a.kAa):this.gA.Mbb=this.kZ(this.Jr.length,"");this.Lg.hasProperty(this.vs,e.a.WBa)?this.gA.wfb=this.Lg.getPropertyListOfMilliseconds(this.vs,
e.a.WBa):this.gA.wfb=this.kZ(this.Jr.length,0);this.Lg.hasProperty(this.vs,e.a.lAa)?this.gA.$Wa=this.Lg.getPropertyListOfMilliseconds(this.vs,e.a.lAa):this.gA.$Wa=this.kZ(this.Jr.length,0);this.Lg.hasProperty(this.vs,e.a.ADa)?this.gA.z1a=this.Lg.getPropertyBools(this.vs,e.a.ADa):this.gA.z1a=this.kZ(this.Jr.length,!1);this.Lg.hasProperty(this.vs,e.a.VEa)?this.gA.Zib=this.Lg.getPropertyStrings(this.vs,e.a.VEa):this.gA.Zib=this.kZ(this.Jr.length,"");this.Lg.hasProperty(this.vs,e.a.WEa)?this.gA.ajb=this.Lg.getPropertyListOfMilliseconds(this.vs,
e.a.WEa):this.gA.ajb=this.kZ(this.Jr.length,0);this.Lg.hasProperty(this.vs,e.a.cwa)?this.gA.$ib=this.Lg.getPropertyObjectIds(this.vs,e.a.cwa):this.gA.$ib=this.kZ(this.Jr.length,n.a.nil)}pEd(O,H,I){return this.Lg.hasProperty(O,H)?this.Lg.getPropertyBools(O,H):this.kZ(I,!1)}JNl(O,H,I){return this.Lg.hasProperty(O,H)?this.Lg.getPropertyUint32s(O,H):this.kZ(I,0)}kZ(O,H){const I=new k.a;for(let J=0;J<O;J++)I.add(H);return I}bMl(O){const H=this.Rkd.lg(O);O=this.Rkd.lg(O+1);return this.V0.substring(H,O)}HUh(){if(this.EKg)return null;
var O=this.dN<this.Jr.length?this.Jr.lg(this.dN):this.maxValue;if(O===this.maxValue||this.KVj&&!this.V0.length)return this.EKg=!0,O=new t.a(this.Ot,this.vs.id,this.LMe),this.Irc=this.SQe(this.Irc,O.toString()),O;const H=this.Vhd.lg(this.dN),I=this.kqe.lg(this.dN),J=this.hNj.lg(this.dN),L=this.vtc.lg(this.dN),S=this.bja.lg(this.dN),E=this.ria.lg(this.dN),P=this.Oia.lg(this.dN),T=this.NJg?this.kOb.lg(this.dN):null;var U=null;this.gA.vfb.lg(this.dN)&&(U=new B(this.gA.ufb.lg(this.dN)||"",this.gA.wfb.lg(this.dN)));
var X=null;this.gA.Nbb.lg(this.dN)&&(X=new B(this.gA.Mbb.lg(this.dN)||"",this.gA.$Wa.lg(this.dN)));var Y=null;this.gA.z1a.lg(this.dN)&&(Y=new B(this.gA.Zib.lg(this.dN)||"",this.gA.ajb.lg(this.dN),this.gA.$ib.lg(this.dN)));U=new G(U,X,Y);X=this.bMl(this.dN);this.dN++;Y=X.startsWith("\ufddfHYPERLINK ");O=new F.a(this.Ahe,this.Ot,this.vs.id,H,O,I,X,J,!Y,L,S,E,P,U,T);this.Irc=this.SQe(this.Irc,O.toString());return O}qUh(){let O;O=null;var H="";if(!this.lKj)return{Tzf:O,y0a:H};if(H=this.HUh())O=new k.a,
O.add(H);for(;H=this.HUh();)O.add(H);H=this.Irc;return{Tzf:O,y0a:H}}}Object(C.a)(K,"ParagraphMergeBlockCreator",u.a,[])},1854:function(C,N,d){d.r(N);C=d(0);var l=d(216),e=d(1587),a=d(1548);class k extends a.a{constructor(v,u){super(4,v,u)}toString(){return String.format("{0} [GraphNodeId: {1}]",super.toString(),this.Cj)}h2b(){return"Table"}clone(){return new k(this.source,this.Cj)}Oz(v,u,t,y=!1){return super.Oz(v,u,t,y)?this.Cj.equals(v.Cj):!1}get length(){return 1}}Object(C.a)(k,"TableMergeBlock",
a.a,[]);d.d(N,"TableMergeBlockCreator",function(){return n});class n extends e.a{constructor(v,u){super();this.Wvg=new k(u,v.id)}qUh(){let v;v=new l.a;v.add(this.Wvg);return{Tzf:v,y0a:this.SQe("",this.Wvg.toString())}}}Object(C.a)(n,"TableMergeBlockCreator",e.a,[])},1931:function(C,N,d){d.r(N);var l=window.AssistanceTaskPaneData={name:"CommandUI",attrs:{xmlns:"http://schemas.microsoft.com/sharepoint/"},children:[{name:"TaskPane",attrs:{Id:"AssistanceTaskPane",Title:"Office Assistance",Width:"330"},
children:[{name:"Groups",attrs:{},children:[{name:"Group",attrs:{Id:"AssistanceIFrameContainer",IsStretched:"true"}}]}]}]},e=d(0),a=d(44),k=d(67);class n extends Sys.EventArgs{constructor(Q,ya){super();this.Nae=Q;this.actualValue=ya}}Object(e.a)(n,"CpuMeterMonitorThresholdExceededEventArgs",Sys.EventArgs,[]);var v=d(31);class u{constructor(){this.LOb=[];this.Izg=this.Kle=0;this.Ih=null;this.sa=new k.a}init(Q,ya,gb){this.Ih=Q;this.Kle=ya;this.Izg=gb;this.Ih.hrd(Object(a.a)(this,this.iGb,"onCpuMeterFrameAvailable"));
this.u7j(Object(a.a)(this,this.hHk,"cpuPercentThresholdExceeded"))}iGb(Q,ya){ya.BSc&&(Array.enqueue(this.LOb,ya.BSc.CP),this.LOb.length>this.Izg&&(Array.dequeue(this.LOb),this.ztk()))}ztk(){var Q=this.LOb.length;let ya=0;for(let gb=0;gb<Q;gb++){const Ob=Array.dequeue(this.LOb);ya+=Ob;Array.enqueue(this.LOb,Ob)}Q=ya/Q;Q>this.Kle&&this.sa.raiseEvent("CPTTE",new n(this.Kle,Q))}hHk(Q,ya){v.b(16782158,306,50,"CpuMeter KPI Average Threshold Exceeded: [{0}]",this.xxd(ya.Nae,ya.actualValue))}u7j(Q){this.sa.addHandler("CPTTE",
Q)}xxd(Q,ya){const gb={};gb.ThresholdValue=Q;gb.ActualValue=ya;return gb}}Object(e.a)(u,"CpuMeterMonitor",null,[1988]);var t=d(433);class y{constructor(){this.S=this.T=this.M=this.C=0}}Object(e.a)(y,"ProfileInformation",null,[]);var B=d(7),G=d(29),F=d(205),K=d(77);class O{constructor(Q=0,ya=0){this.cqb=!1;this.ypb={};this.Dfd=Q;this.Vfd=ya;this.oLe=0;G.a.addHandler(window.self,B.a.Lah,()=>{this.cqb=!0});G.a.addHandler(window.self,B.a.Mah,()=>{this.cqb=!1})}Oah(Q,ya,gb){const Ob=O.generateKey(ya,gb);
Ob in this.ypb?ya=this.ypb[Ob]:(ya=new y,ya.S=gb?1:0,this.ypb[Ob]=ya,this.oLe++);ya.C++;ya.M=Q>ya.M?Q:ya.M;ya.T+=Q}Xya(Q,ya){this.Oah(Q,ya,!1);this.cqb&&this.Oah(Q,ya,!0)}getData(){if(0<this.Vfd&&this.oLe>this.Vfd)return this.mol();const Q=0<this.Dfd,ya={},gb=this.ypb;for(let mc in gb){var Ob=mc;const dd=gb[mc];this.zTi(dd);Q&&dd.T>=this.Dfd&&(ya[Ob]=dd)}return Q?K.a.mf(ya)?null:ya:this.ypb}mol(){var Q=0<this.Dfd,ya=[];const gb=this.ypb;for(let Ob in gb){const mc={key:Ob,value:gb[Ob]};let dd=mc.value;
(!Q||dd.T>=this.Dfd)&&Array.add(ya,mc)}if(ya.length>this.Vfd)ya.sort((Ob,mc)=>mc.value.T-Ob.value.T),ya=ya.slice(0,this.Vfd);else if(!ya.length)return null;Q={};for(const Ob of ya)ya=Ob.value,this.zTi(ya),Q[Ob.key]=ya;return Q}zTi(Q){Q.M=F.a.nU(Q.M,0);Q.T=F.a.nU(Q.T,0)}reset(){this.ypb={};this.oLe=0}static generateKey(Q,ya){return ya?Q+" [it]":Q}}Object(e.a)(O,"FunctionCallAggregator",null,[847]);var H=d(2),I=d(1198);class J{}Object(e.a)(J,"CpuMeterFrame",null,[]);class L extends Sys.EventArgs{constructor(Q){super();
this.BSc=Q}}Object(e.a)(L,"CpuMeterFrameAvailableEventArgs",Sys.EventArgs,[]);class S{}Object(e.a)(S,"MiniTaskItemInfo",null,[]);class E{}Object(e.a)(E,"TaskItemInfo",null,[]);var P=d(1006),T=d(1384),U=d(195);class X{constructor(Q,ya,gb,Ob,mc){this.Etb=0;this.LY=null;this.Tkd=this.u1g=0;this.wZg=!1;this.hQb=0;this.Opc=!1;this.mqa=null;this.Xcd=0;this.EAe=new k.a;this.Bnd=[];this.uy=Q;this.Aye=ya;this.pqe=gb;this.VPg=Ob;H.AFrameworkApplication.K&&H.AFrameworkApplication.K.$("WrapSetTimeoutForTelemetryIsEnabled")&&
this.n8b();this.QCj=mc;this.qqe=new O(100);this.SLj=P.a.sF(1,5,new T.a)}hrd(Q){this.EAe.addHandler("OnCpuMeterFrameAvailable",Q)}KSf(Q){this.EAe.removeHandler("OnCpuMeterFrameAvailable",Q)}cjb(Q,ya,gb,Ob=null){gb=Ob?Ob.priority:7;const mc=this.uy();this.start(ya,gb);try{Q()}finally{this.stop(ya,Ob),Q=this.uy()-mc,this.VPg.track(Q,ya)}}Pd(Q,ya){const gb=this.uy();try{Q()}finally{Q=this.uy()-gb,this.pqe.Xya(Q,ya),0<this.Etb&&this.qqe.Xya(Q,ya),this.VPg.track(Q,ya)}}DIf(Q){const ya=new E;ya.TN=Q.iyf;
ya.TP=Q.priority;this.CJi(1,ya)}p9b(Q){this.Xcd|=Q}start(Q,ya){if(!this.Etb){this.qqe.reset();const gb=this.Mii(Q);gb&&this.nUd(1);this.LY=new E;this.LY.TN=Q;this.LY.TP=ya;this.LY.ST=(new Date).toISOString();this.LY.STS=F.a.nU(this.uy(),2);gb?this.LY.UI=1:this.qgm(Q)?this.LY.UI=2:this.LY.UI=0}this.Etb++}nUd(Q){this.hQb|=Q}Rud(Q=!0,ya=0){this.hQb=Q?0:this.hQb&~ya}stop(Q,ya=null){let gb;this.Etb--;0>=this.Etb&&this.LY&&(gb=this.uy()-this.LY.STS,this.Tkd+=gb,this.Aye.Xya(gb,Q),this.Mii(Q)&&this.Rud(!1,
1),this.LY.TRT=F.a.nU(gb,2),ya&&(this.LY.TQT=F.a.nU(ya.ydn,2),this.LY.TDT=F.a.nU(ya.Oji,2)),this.QCj&&(this.CJi(0,this.LY),this.hvn()),this.Etb=0);0<=Q.indexOf(I.a.Ado)&&this.p9b(2);0<=Q.indexOf(I.a.iQi)&&this.p9b(4);1===(this.hQb&1)&&this.p9b(1);2===(this.hQb&2)&&this.p9b(8)}hvn(){var Q=this.LY.TRT;if(750<Q){let gb=this.qqe.getData();if(gb){const Ob={};for(let mc in gb){var ya=gb[mc];const dd=mc;dd.startsWith("SiOp_")||dd.endsWith("[it]")||(Ob[dd]=Math.round(100*ya.T/Q))}gb=Ob}Q=Object.assign(new S,
{B:this.LY.STS,T:Q,S:gb});this.SLj.track(Q,this.LY.TN)}}w_n(){var Q=this.uy()-this.u1g,ya=F.a.nU(this.Tkd/Q*100,2);Q=new J;Q.CP=ya;Q.II=this.Xcd;ya=this.Aye.getData();K.a.count(ya)&&(Q.LRT=ya);ya=this.pqe.getData();K.a.count(ya)&&(Q.FP=ya);this.EAe.raiseEvent("OnCpuMeterFrameAvailable",new L(Q));this.G7i()}G7i(){this.Aye.reset();this.pqe.reset();this.Tkd=this.Etb=0;this.u1g=this.uy();this.Xcd=0;this.LY=null}run(){this.wZg?this.w_n():(this.G7i(),this.wZg=!0);this.mqa?this.mqa(Object(a.a)(this,this.run,
"run"),1E3):window.setTimeout(Object(a.a)(this,this.run,"run"),1E3)}zqd(Q,ya,gb){const Ob=Array(2);Ob[0]=ya;Ob[1]=gb;this.Bnd[Q]||(this.Bnd[Q]=[]);this.Bnd[Q].push(Ob)}CJi(Q,ya){Q=this.Bnd[Q];if(!U.a.mf(Q))for(let Ob=0;Ob<Q.length;Ob++){var gb=Q[Ob];const mc=gb[0];gb=gb[1];mc&&!mc(ya)||gb(ya)}}n8b(){if(!this.Opc){const Q=window.setTimeout;this.mqa=(ya,gb)=>Q(ya,gb);this.Opc=!0}}Mii(Q){return Q.startsWith("key")||Q.startsWith("input")}qgm(Q){return Q.startsWith("click")||Q.startsWith("mouse")||Q.startsWith("pointer")}}
Object(e.a)(X,"CpuMeter",null,[148]);class Y{constructor(Q){this.rlc=null;this.fr=new t.a;this.uy=Q}initialize(Q,ya,gb,Ob=!1){this.rlc||(this.rlc=new X(this.uy,Q,ya,gb,Ob),this.fr.Gg(this.rlc));return this.rlc}}Object(e.a)(Y,"CpuMeterProvider",null,[1987]);var ca=d(178),da=d(155);class ua{constructor(Q=1){this.HC=[];this.K9c=[];this.ej=Q}F9k(){let Q=0;for(let ya=0;ya<this.HC.length;ya++)this.HC[ya]<this.HC[Q]&&(Q=ya);return Q}Xya(Q,ya){Q=F.a.nU(Q,2);if(this.HC.length<this.ej)Array.add(this.HC,Q),
Array.add(this.K9c,ya);else{var gb=this.F9k();Q>this.HC[gb]&&(this.HC[gb]=Q,this.K9c[gb]=ya)}}getData(){return this.HC.length?{["Vals"]:this.HC,["Desc"]:this.K9c}:null}reset(){this.HC=[];this.K9c=[]}}Object(e.a)(ua,"MaxDataAggregator",null,[847]);var ra=d(37),qa=d(22);class ka{get name(){return"Common.App.CpuMeter"}yc(Q){Q.register(Y,"Common.App.CpuMeter.CpuMeterProvider").as("Common.ICpuMeterProvider").singleInstance().Yd(()=>new Y(ra.a.lf));Q.register(u,"Common.App.CpuMeter.CpuMeterMonitor").as("Common.App.CpuMeter.ICpuMeterMonitor").singleInstance().Yd(()=>
new u)}init(){const Q=H.AFrameworkApplication.K;if(Q.$("CpuMeterIsEnabled")){const ya=qa.a.instance.resolve("Common.App.CpuMeter.CpuMeterProvider");da.a.instance.Lyc.continueWith(()=>{ka.M2l(Q,ya)})}}dispose(){}static M2l(Q,ya){const gb=P.a.sF(10,5,new O(Q.rc("TaskManagerLoggingThreshold",0),Q.rc("CpuMeterMaximumEntriesToLog",0)));ya=ya.initialize(new ua(5),new O,gb,Q.$("CPUMeterExposeTaskDetailsIsEnabled"));ya.run();Q.$("CpuMeterMonitorIsEnabled")&&qa.a.instance.resolve("Common.App.CpuMeter.ICpuMeterMonitor").init(ya,
Q.XP("CpuMeterAverageCpuPercentThreshold",80),Q.rc("CpuMeterRollingAverageFramesCount",15));v.b(16827671,306,50,"Initializing CpuMeter")}static main(){ca.a.instance.Oc(new ka)}}Object(e.a)(ka,"CpuMeterPackage",null,[1,2]);var la=d(8),Ha=d(83),wa=d(1032),Ca=d(1012),Ja=d(15),bb=d(1385);class ha{constructor(){this.tqa=this.ojc=null;this.oWb=!0;this.Ypc=!1}yc(Q){H.AFrameworkApplication.K.$("EventTimingMeterIsEnabled")&&Q.register(1942,"Common.IEventTimingMeter").singleInstance().Yd(()=>new EventTiming.EventTimingMeter)}get name(){return"Common.App.EventTimingMeter"}init(){var Q=
new Ca.a(H.AFrameworkApplication.K.rc("EventTimingMeterEventSamplingPercent",0)/100);Q=new wa.a(Object(a.a)(Q,Q.S2a,"shouldBeInSample"));const ya=P.a.sF(16,1,Q);this.tqa=new bb.a("TypingDuration-SlowPercentileAtValue","Percentile",H.AFrameworkApplication.K.XP("AshaVetoForTypingThresholdInMS",150),H.AFrameworkApplication.K.XP("AshaVetoForTypingThresholdPercentile",95),this.oWb);(this.Ypc=!Ja.a.E_a)&&H.AFrameworkApplication.xK(()=>{this.AWe()});this.ojc=gb=>{gb=gb.rawEvent.detail;for(const Ob of gb)ya.track(Ob,
"EventTimingData"),"false"!==Ob.metadata.altPressed.toString()||"false"!==Ob.metadata.ctrlPressed.toString()||"false"!==Ob.metadata.repeat.toString()||"CharacterKey"!==Ob.metadata.key.toString()&&"Space"!==Ob.metadata.key.toString()||!this.Ypc||this.tqa.gva(Ob.timeToRequestAnimationFrameMs)};G.a.addHandler(window.self,B.a.Kah,this.ojc)}dispose(){this.ojc&&(G.a.removeHandler(window.self,B.a.Kah,this.ojc),this.ojc=null)}AWe(){this.tqa.COa();this.tqa.kCi&&(la.ULS.sendTraceTag(588649307,209,15,"Report SlowTypingSession Veto with SlowTypingSession error"),
Ha.Health.instance.recordQosError("SlowTypingSession",["SlowTypingSession"],!1,!0,!0,!1,null))}static main(){ca.a.instance.Oc(new ha)}}Object(e.a)(ha,"EventTimingMeterPackage",null,[1,2]);var ia=d(76),va=d(72),Ka=d(35);class Xa{constructor(Q,ya,gb,Ob=null,mc=null){this.UK=Q;this.doc=ya;this.Znc=gb;this.bWg=Ob;this.Htc=mc}GBd(Q){const ya=new Sys.StringBuilder(this.UK.cZc);ya.append("RoamingServiceHandler.ashx?action=");ya.append("getFirstRunExperienceSettings");ya.append("&");ya.append(this.Xgf(Q));
ya.append("&");ya.append(H.AFrameworkApplication.xm);H.AFrameworkApplication.Xe.Lj(ya.toString(),1,null,null,!0,2,Object(a.a)(this,this.MYa,"getRequestSuccessCallback"),Object(a.a)(this,this.lBa,"getRequestFailureCallback"),null)}j1b(Q){var ya=new Sys.StringBuilder(this.UK.cZc);ya.append("RoamingServiceHandler.ashx?action=");ya.append("saveFirstRunExperienceSettings");ya.append("&");ya.append(H.AFrameworkApplication.xm);ya=ya.toString();Q=Ka.c(Q);H.AFrameworkApplication.Xe.Lj(ya,2,Q,null,!0,4,Object(a.a)(this,
this.J6m,"postRequestSuccessCallback"),Object(a.a)(this,this.qna,"postRequestFailureCallback"),null)}MYa(Q){let ya=!1,gb=null;try{if(0<Q.data.Ge.length){const Ob=Object(va.a)(Object,Ka.a(Q.data.Ge)),mc=Ob?Ob[this.UK.KQe]:null;mc&&(gb=Object(va.a)(Object,Ka.a(mc.toString())))}ya=!0}catch(Ob){this.lBa(null)}ya&&this.doc&&this.doc(Q.data,gb)}lBa(Q){this.Znc&&this.Znc(Q?Q.data:null)}J6m(Q){this.bWg&&this.bWg(Q?Q.data:null)}qna(Q){this.Htc&&this.Htc(Q?Q.data:null)}Xgf(Q){const ya=new Sys.StringBuilder("requestedsettings=");
for(let gb=0;gb<Q.count;gb++)ya.append(Q.J(gb)),gb<Q.count-1&&ya.append(";");return ya.toString()}}Object(e.a)(Xa,"FirstRunExperienceRequestHandler",null,[]);var xa=d(200);class Ma{constructor(){this.Gnc=this.yad=this.UK=null}kXn(Q){Q?(this.UK=Q,this.ngm()&&(la.ULS.sendTraceTag(51675532,306,50,"Initiating call to get FRE data for current user from Roaming Settings Service"),Q=new ia.a,Q.add(this.UK.KQe),this.yad=new Xa(this.UK,Object(a.a)(this,this.MYa,"getRequestSuccessCallback"),Object(a.a)(this,
this.lBa,"getRequestFailureCallback"),null,Object(a.a)(this,this.qna,"postRequestFailureCallback")),this.yad.GBd(Q)),(this.UK.iii||H.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FirstRunExperienceUITest",!1))&&this.t0f()):la.ULS.sendTraceTag(51675531,306,10,"Invalid launcherSettings")}ngm(){try{if(this.UK.iii)return!0;if(!H.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FirstRunExperienceEnabled",!0)||H.AFrameworkApplication.K.$("IsAnonymousUser"))return!1;
if(this.UK.hbm||this.UK.S7b||H.AFrameworkApplication.K.$("IsO365ConsumerHost"))return!0;const Q=H.AFrameworkApplication.K.lb("FlightId");return-1!==(Q?Q.toString().toLowerCase():"").indexOf("firstrunexperienceui")}catch(Q){la.ULS.sendTraceTag(576582624,306,10,"Error checking setting {0}",Q?Q.toString():null)}return!1}vUi(Q){const ya={},gb={};gb.FREDisplayedDate=(new Date).toUTCString();gb.VersionDisplayed=Q;gb.RemindMeLater=!1;ya[this.UK.KQe]=Ka.c(gb);la.ULS.sendTraceTag(51675533,306,50,"Initiating call to save FRE data for current user from Roaming Settings Service");
this.yad&&this.yad.j1b(ya)}MYa(Q,ya){Q=Q?+Q.AS-+Q.eH:-1;Q>this.UK.mTi?la.ULS.sendTraceTag(51675534,306,50,"Call to Roaming Settings Service took {0}ms. This is more than the {1}ms threshold. A new attempt will be made next time the user starts a new session.",Q,this.UK.mTi):ya?this.hWn(ya)?(la.ULS.sendTraceTag(51675536,306,50,"FRE data already exists for current user. FRE UI should be displayed again. User selected 'Remind me later' option more than {0} hours ago.",this.UK.yri),this.t0f()):(this.I4e(!1),
la.ULS.sendTraceTag(51675537,306,100,"Current user has already seen this version of the FRE. No further action required.")):(la.ULS.sendTraceTag(51675535,306,50,"No FRE data found for current user. FRE UI should be displayed."),this.t0f())}lBa(Q){this.I4e(!1);la.ULS.sendTraceTag(51675541,306,10,"First Run Experience failed to GET data from Roaming Settings Service with status: {0}",Q?Q.wf:-1)}qna(Q){la.ULS.sendTraceTag(51675542,306,10,"First Run Experience failed to POST data to Roaming Settings Service with status: {0}",
Q?Q.wf:-1)}t0f(){this.I4e(!0);var Q=qa.a.instance.Pa("Common.ISystemInitiatedFeedback");Q?this.z4i(Q):(la.ULS.sendTraceTag(51675543,306,50,"Error resolving ISystemInitiatedFeedback"),H.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FirstRunExperienceUIResolveFuture",!0)&&((Q=qa.a.instance.Za("Common.ISystemInitiatedFeedback"))?Q.execute(ya=>{this.z4i(ya)}):la.ULS.sendTraceTag(539494111,306,50,"Error resolving ISystemInitiatedFeedback Future")))}z4i(Q){if(Q){var ya=this.UK.Abl;
ya&&(H.AFrameworkApplication.Hl(ya),H.AFrameworkApplication.maa(ya));la.ULS.sendTraceTag(51675544,306,50,"Attempting to display First Run Experience UI using floodgate.",ya);Q.logActivity("ShowFirstRunExperienceUIV2",null);window.addEventListener?(this.Gnc=Object(a.a)(this,this.iSm,"onFirstRunExperienceCampaignEvent"),window.addEventListener("FGWebSurfaceEvent",this.Gnc,!0),window.addEventListener("FRELaunchedEvent",this.Gnc,!0)):(la.ULS.sendTraceTag(51675545,306,50,"FRE V2 UI triggered. Attempting to save FRE data."),
this.vUi(this.UK.currentVersion))}else la.ULS.sendTraceTag(539494112,306,50,"Invalid ISystemInitiatedFeedback")}iSm(Q){if(Q){var ya=Q.detail;Q=Q.type;var gb=this.UK&&this.UK.Ejh?this.UK.Ejh.split("-")[0]:null;if("FRELaunchedEvent"===Q||gb&&ya&&ya.id&&-1!==ya.id.indexOf(gb))ya.success&&(la.ULS.sendTraceTag(51675546,306,50,"FRE V2 UI has been launched. Attempting to save FRE data."),this.vUi(this.UK.currentVersion)),window.removeEventListener&&(window.removeEventListener("FGWebSurfaceEvent",this.Gnc,
!0),window.removeEventListener("FRELaunchedEvent",this.Gnc,!0))}}hWn(Q){if("RemindMeLater"in Q&&"FREDisplayedDate"in Q){if("true"===Q.RemindMeLater.toString()&&(+new Date-+new Date(Q.FREDisplayedDate.toString()))/36E5>this.UK.yri)return!0}else if(H.AFrameworkApplication.K.$("WacShowVersionBasedFREToAllUsers")&&"VersionDisplayed"in Q&&Q.VersionDisplayed<this.UK.currentVersion)return la.ULS.sendTraceTag(528262853,306,50,"Current version is higher so FRE V2 UI should be displayed again."),!0;return!1}I4e(Q){H.AFrameworkApplication.K.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.DispatchFREDecisionEvent")&&
xa.a.dispatch("FREDecisionEvent",{["show"]:Q})}}Object(e.a)(Ma,"FirstRunExperienceLauncher",null,[1939]);class Na{constructor(){this.W=null}get name(){return"Common.App.FirstRunExperienceLauncher"}yc(Q){this.W=Q;this.W.register(1939,"Common.App.FirstRunExperienceLauncher.IFirstRunExperienceLauncher").singleInstance().Yd(()=>new Ma)}init(){}dispose(){}static main(){ca.a.instance.Oc(new Na)}}Object(e.a)(Na,"FirstRunExperienceLauncherPackage",null,[1,2]);class pa{constructor(){this.y=this.x=0}}Object(e.a)(pa,
"HammerPoint",null,[]);var Ra=d(13);class Sa{constructor(Q,ya,gb,Ob,mc){this.dOg=this.DSa=this.Kcd=1;this.Nod=this.$wc=this.TUa=0;this.Sze=this.iGa=null;this.inb=this.xpe=this.mjd=!1;this.Ki=Q;this.DIa=ya;this.htb=gb;this.ga=Ob;mc&&(this.mjd=mc.$("PromoteLayerPinchToZoomIsEnabled"),this.xpe=mc.$("FinalizeWithInitialPinchScaleIsEnabled"),this.inb=mc.$("AdjustPinchStartXWithPageMarginIsEnabled"))}get wK(){return this.DIa}Qdm(){return!!this.Ki.instance}ESm(Q){this.ga&&this.ga.processAction(Ra.a.T7i,
2);const ya=this.Ki.instance;this.mjd&&ya.rJi();this.DSa=ya.vj;this.Kcd=Q.WGc.scale;this.dOg=1;this.Sze=this.hjh();this.iGa=this.DIa.getBounds();if(!this.iGa)return la.ULS.sendTraceTag(42821145,353,15,"Unexpected null bounds"),!1;Q=this.GWh(Q);this.inb?this.m_i(this.DIa.scrollWidth,this.iGa.width,Q,this.DSa,ya):this.TUa=this.DIa.scrollWidth>this.iGa.width?this.aAc(this.htb.scrollLeft,Q.x,this.DSa):null;this.Nod=this.DIa.scrollHeight>this.iGa.height?this.aAc(this.htb.scrollTop,Q.y,this.DSa):null;return!0}gUf(){this.TUa=
null;this.$wc=0}m_i(Q,ya,gb,Ob,mc){Q>ya?this.TUa?(Q=mc.swf,Q!==this.$wc&&(this.TUa-=this.$wc-Q,this.$wc=Q)):(this.TUa=this.aAc(this.htb.scrollLeft,gb.x,Ob),this.$wc=mc.swf):this.gUf()}DSm(Q){const ya=this.GWh(Q);if(!ya)return la.ULS.sendTraceTag(42821147,353,15,"Unexpected null pinch center"),!1;Q=this.IJn(Q.WGc.scale/this.Kcd)*this.DSa;this.Elo(ya,Q);this.Flo(ya,Q);return!0}Elo(Q,ya){const gb=this.DIa.scrollWidth,Ob=this.iGa.width;this.inb?this.m_i(gb,Ob,Q,ya,this.Ki.instance):!this.TUa&&gb>Ob&&
(this.TUa=this.aAc(this.htb.scrollLeft,Q.x,ya));if(Q=this.pjh(Q.x,this.TUa,gb,Ob,ya))this.htb.scrollLeft=Q}Flo(Q,ya){const gb=this.DIa.scrollHeight,Ob=this.iGa.height;!this.Nod&&gb>Ob&&(this.Nod=this.aAc(this.htb.scrollTop,Q.y,ya));if(Q=this.pjh(Q.y,this.Nod,gb,Ob,ya))this.htb.scrollTop=Q}pjh(Q,ya,gb,Ob,mc){return gb<=Ob||!ya||!Ob?null:Math.max(0,Math.min(ya*mc-Q,gb-Ob))}aAc(Q,ya,gb){return(Q+ya)/gb}CSm(Q){Q=Q.WGc.scale;this.xpe&&(Q/=this.Kcd);this.nHh(Q);this.mjd&&this.Ki.instance.LPf();this.ga&&
this.ga.processAction(Ra.a.M6e,2);this.inb&&this.gUf()}BSm(Q){Q=Q.WGc.scale;this.xpe&&(Q/=this.Kcd);this.nHh(Q,!0);this.mjd&&this.Ki.instance.LPf();this.ga&&this.ga.processAction(Ra.a.M6e,2);this.inb&&this.gUf()}IJn(Q){const ya=this.Ki.instance,gb=new Date>=this.Sze;gb&&(this.Sze=this.hjh());Math.abs(Q-this.dOg)>=.01*Q&&ya.sQn(Q*this.DSa,gb);return ya.vj/this.DSa}nHh(Q,ya=!1){Q*=this.DSa;this.Ki.instance.DZf(Q,!1);const gb={};gb.initialScale=this.DSa;gb.finalScale=Q;gb.cancelled=ya;la.ULS.sendTraceTag(42821150,
353,50,"Pinch zoom ended: {0}",gb)}GWh(Q){return(Q=Q.WGc.center)&&this.iGa?Object.assign(new pa,{x:Q.x-this.iGa.x,y:Q.y-this.iGa.y}):null}hjh(){const Q=(new Date).getTime();return new Date(Q+1E3)}}Object(e.a)(Sa,"PinchZoomAdapter",null,[2010]);class ab{constructor(Q){this._element=Q}get scrollWidth(){return this._element.scrollWidth}get scrollHeight(){return this._element.scrollHeight}getBounds(){return Sys.UI.DomElement.getBounds(this._element)}}Object(e.a)(ab,"ScrollContainerElement",null,[2009]);
var eb=d(124);class zb{constructor(Q,ya,gb,Ob,mc,dd){this.AIe=this.g7a=null;this.W=Q;this.le=ya;this.Wdd=gb;this.VLg=Ob;this.AJj=mc;this.QQb=dd;this.w8c=new ia.a}register(Q,ya){this.Wdd&&(4===H.AFrameworkApplication.ua.Sb.jo&&H.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.OneNoteOnline.OneNoteDelayLoadHammerJs",!1)?eb.a.get_instance().tl(8,()=>{this.VRi(Q,ya)}):this.VRi(Q,ya))}VRi(Q,ya){this.W.Za("Common.IGestureInputManager").execute(gb=>{this.c2n();this.g7a=gb;this.w8c.add(Q);
if(this.VLg){if(this.AJj&&0!==gb.wtl()){this.u8i();return}var Ob=this.W.Za("Common.IZoomManager");this.W.resolve("Common.IAppSettingsManager");const mc=new ab(Q);Ob=new Sa(Ob,mc,ya,H.AFrameworkApplication.ya,H.AFrameworkApplication.K);gb.tln(Q,Ob)}this.u8i()})}unregister(){if(this.g7a&&this.w8c){if(this.VLg){for(let Q of this.w8c)this.g7a.Zeo(Q);this.w8c.clear()}this.g7a=null}}c2n(){this.QQb&&(this.le?this.AIe=this.le.hg("Task","Register"):la.ULS.sendTraceTag(590387076,310,10,"_stopwatchBuilder is null"))}u8i(){this.QQb&&
(this.AIe?this.AIe.stop():la.ULS.sendTraceTag(590387077,310,10,"_stopwatchForRegister is null"))}}Object(e.a)(zb,"GestureInputRegistrar",null,[1941]);class Ua{constructor(){this.W=null;this.Bh=!1}get name(){return"Common.App.GestureInput"}init(){this.Bh||(this.W.resolve("Common.IGestureInputRegistrar"),this.Bh=!0)}dispose(){}yc(Q){this.W=Q;Q.register(1941,"Common.IGestureInputRegistrar").singleInstance().Yd(()=>new zb(Q,H.AFrameworkApplication.ua.jq,H.AFrameworkApplication.wOc(),H.AFrameworkApplication.Sfi(),
!!H.AFrameworkApplication.K&&H.AFrameworkApplication.K.$("PinchZoomOnlyPointerEventsIsEnabled"),!!H.AFrameworkApplication.K&&H.AFrameworkApplication.K.$("HammerJsPerformanceTimersIsEnabled")))}static main(){ca.a.instance.Oc(new Ua)}}Object(e.a)(Ua,"GestureInputPackage",null,[1,2]);var Ab=d(323),mb=d(86);class Rb{constructor(){this.ojb=this.wLh=null}}Object(e.a)(Rb,"GestureAdapterInfo",null,[]);var hc=d(378),Hb=d(238);class Ta{constructor(){this.Cob=null}Swf(){if(!this.Cob){var Q="hammer.min.js";H.AFrameworkApplication.K.yu("IsServerFlavorDebug")&&
(Q=H.AFrameworkApplication.K.$("IsServerFlavorDebug")?"hammer.js":"hammer.min.js");Q=H.AFrameworkApplication.Aw(String.format("{0}",Q),5);Q=Hb.a.create(Q,null,null);hc.a.XS(Q);this.Cob=Q.h0a}return this.Cob}static get instance(){Ta._instance||(Ta._instance=new Ta);return Ta._instance}}Ta._instance=null;Object(e.a)(Ta,"HammerJsDependencyLoader",null,[2011]);const Aa=(Q,ya,gb=null)=>{if(void 0===ya||null===ya)throw la.ULS.sendTraceTag(42256258,310,10,"manager cannot be null"),Error.argumentNull("manager can not be null");
let Ob=null;switch(Q){case B.a.pinch:Ob=new Hammer.Pinch(gb);break;case B.a.pan:Ob=new Hammer.Pan(gb)}Ob&&(Ob.manager=ya);return Ob};var ma;(function(Q){Q[Q.none=-1]="none";Q[Q.pinch=0]="pinch";Q[Q.pan=1]="pan";Q[Q.swipe=2]="swipe"})(ma||(ma={}));Object(e.b)("GestureEvent",ma);var Ga=d(55);class Fa extends Ga.a{constructor(Q,ya,gb,Ob,mc,dd,Md,He){super(Q,gb,Ob,dd);this.Ekc=ya;this.vUa=Md;this.hpa=He;this.zEj=mc}get shiftKey(){return this.vUa}get ctrlKey(){return this.hpa}get clientPoint(){return this.Ekc}get WGc(){return this.zEj}static create(Q,
ya,gb,Ob,mc,dd){if(gb.rawEvent)if(dd){var Md=gb.rawEvent;Md=new Sys.UI.Point(Md.clientX,Md.clientY)}else Md=Ga.a.yEd(gb);else Md=new Sys.UI.Point(gb.clientX,gb.clientY);return new Fa(Q,Md,ya,gb,Ob,mc,gb.shiftKey,gb.ctrlKey,dd)}}Object(e.a)(Fa,"GestureEventArgs",Ga.a,[]);class ib{constructor(){this.srcEvent=this.pointerType=this.changedPointers=this.pointers=null;this.maxPointers=this.rotation=this.scale=this.angle=this.distance=this.overallVelocity=this.overallVelocityY=this.overallVelocityX=0;this.additionalEvent=
this.center=this.target=null;this.isFinal=this.isFirst=!1;this.deltaTime=this.timeStamp=this.deltaY=this.deltaX=this.eventType=0;this.offsetDirection=null}}Object(e.a)(ib,"GestureManagerData",null,[]);class ob{}ob.Trj=2;ob.Urj=4;ob.Vrj=8;ob.Wrj=8;Object(e.a)(ob,"HammerConstants",null,[]);var fb=d(73),Mb=d(100),Tb=d(16),rc=d(91);class vb extends G.a{constructor(Q,ya){super();this.sHa=Ab.a.lgl;this.QCe=!!window.PointerEvent;this.C3g=window.hasOwnProperty("ontouchstart");this.Cpb=this.Bsc=null;this.fHa=
!1;this.Nia=new mb.a;this.Ftc=new mb.a;this.PFg=new ia.a;this.m6a=null;this.dOb=this.QQb=this.Dxg=this.Sje=this.mye=this.qYg=this.Uxg=this.hxc=!1;this.zrc=-1;this.curRecognizer=this.element=this.handlers=this.session=this.BIe=null;this.tg=fb.EventHandlerManager.instance;this.QCe?(la.ULS.sendTraceTag(593893141,310,50,"Using pointer events"),this.Bsc=Object(a.a)(this,this.cYd,"onPointerEvent"),this.Cpb=B.a.ngl):this.C3g?(la.ULS.sendTraceTag(593893140,310,50,"Using touch events"),this.Bsc=Object(a.a)(this,
this.vib,"onTouchEvent"),this.Cpb=B.a.touchEvents):(la.ULS.sendTraceTag(593893139,310,50,"Using mouse events"),this.Bsc=Object(a.a)(this,this.RXd,"onMouseEvent"),this.Cpb=B.a.mgl);this.le=ya;this.z0=Q;H.AFrameworkApplication.K&&(this.hxc=H.AFrameworkApplication.K.$("UsePointerCaptureIsEnabled"),this.Uxg=H.AFrameworkApplication.K.$("ClearCacheOnPrimaryPointerIsEnabled"),this.qYg=H.AFrameworkApplication.K.$("ResetHandledBeforeInputHandlerIsEnabled"),this.mye=H.AFrameworkApplication.K.$("LogCoalescedEventsIsEnabled"),
this.Sje=H.AFrameworkApplication.K.$("CheckExistenceOfGetCoalescedEventsIsEnabled"),this.Dxg=H.AFrameworkApplication.K.$("CheckIfHammerExistsAfterDownloadIsEnabled"),this.QQb=H.AFrameworkApplication.K.$("HammerJsPerformanceTimersIsEnabled"),this.dOb=this.hxc&&H.AFrameworkApplication.K.$("CancelDragFromGestureInputManagerIsEnabled")&&H.AFrameworkApplication.K.$("UseGestureInputManagerPointerCacheIsEnabled"))}wtl(){return this.QCe?0:this.C3g?1:2}Gu(Q){super.Gu(Q);this.tg.MBa(this.Cpb,Q,0,this.Bsc)}Au(Q){super.Au(Q);
this.tg.YWa(Q,this.Cpb)}tln(Q,ya){H.AFrameworkApplication.wOc()?Ta.instance.Swf().continueWith(gb=>{this.b2n();if(gb.Ji||gb.ho)la.ULS.sendTraceTag(591192778,310,10,"Hammer did not download correctly: {0}",gb.status);else{la.ULS.sendTraceTag(591192779,310,50,"Hammer download status: {0}",gb.status);if(this.Dxg){gb=window.Hammer;if("undefined"===typeof gb){la.ULS.sendTraceTag(590901389,310,10,"Hammer does not exist");this.g$d();return}if("undefined"===typeof gb.inputHandler){la.ULS.sendTraceTag(590901390,
310,10,"Hammer.inputHandler does not exist");this.g$d();return}}if(!Q)throw this.g$d(),Error.argumentNull("source element can not be null");gb=Mb.a.Eb(Q,this.sHa);if(void 0===gb||null===gb)gb=new mb.a,Mb.a.Il(Q,this.sHa,gb),this.uln(Q);if(!gb.xb(ma[0])){var Ob=Object.assign(new Rb,{ojb:Aa(ma[0],this,null),wLh:ya});gb.add(ma[0],Ob)}}this.g$d()}):la.ULS.sendTraceTag(42256219,310,10,"Multi Touch is not enabled either from common BRS or from your app BRS")}b2n(){this.QQb&&(this.le?this.BIe=this.le.hg("Task",
"RegisterGestureAdapterAfterLoad"):la.ULS.sendTraceTag(590387074,310,10,"_stopwatchBuilder is null"))}g$d(){this.QQb&&(this.BIe?this.BIe.stop():la.ULS.sendTraceTag(590387075,310,10,"_stopwatchForRegisterGestureAdapterAfterLoad is null"))}Zeo(Q){la.ULS.sendTraceTag(42256223,310,Q?100:10,"source element {0} ",Q.id);const ya=Mb.a.Eb(Q,this.sHa);void 0!==ya&&null!==ya&&(ya.remove(ma[0]),ya.count||(Mb.a.l_(Q,this.sHa),this.curRecognizer=null,this.$eo(Q)))}uln(Q){this.PFg.add(Q);this.tg.MBa(this.Cpb,Q,
0,this.Bsc)}$eo(Q){this.PFg.remove(Q);this.tg.YWa(Q,this.Cpb)}recognize(Q){var ya=Array(Q.pointers.length);for(var gb=0;gb<Q.pointers.length;gb++)ya[gb]=Q.pointers[gb].target;gb=null;for(this.m6a=this.Ayl(ya);void 0!==this.m6a&&null!==this.m6a&&(gb=Mb.a.Eb(this.m6a,this.sHa),void 0===gb||null===gb);this.m6a=this.m6a.parentNode);if(void 0!==gb&&null!==gb){this.curRecognizer&&this.curRecognizer.state===ob.Wrj&&(this.curRecognizer=null);ya=gb.keys;for(let Ob of ya){ya=gb.J(Ob);void 0!==ya&&null!==ya&&
void 0!==ya.ojb&&null!==ya.ojb&&(void 0===this.curRecognizer||null===this.curRecognizer||ya.ojb===this.curRecognizer||ya.ojb.canRecognizeWith(this.curRecognizer))&&ya.ojb.recognize(Q);const mc=ya.ojb.state;this.curRecognizer||ob.Trj!==mc&&ob.Urj!==mc&&ob.Vrj!==mc||(this.curRecognizer=ya.ojb)}}}emit(Q,ya){if("hammer.input"!==Q){this.fHa=!1;ya=Fa.create(Q,this.m6a,ya.srcEvent,ya,3,this.QCe);var gb=Mb.a.Eb(this.m6a,this.sHa);if(this.bim(Q))var Ob=0;else if(this.Chm(Q))Ob=1;else if(this.slm(Q))Ob=2;else{la.ULS.sendTraceTag(42256256,
310,15,"Event can not be recognized by current manager");return}({value:gb}=gb.Dc(ma[Ob]));void 0!==gb&&null!==gb&&((gb=gb.wLh,gb.Qdm())?Q.endsWith("start")?this.fHa=gb.ESm(ya):Q.endsWith("end")?(gb.CSm(ya),this.fHa=!0):Q.endsWith("cancel")?(gb.BSm(ya),this.fHa=!0):Q.endsWith("move")&&(this.fHa=gb.DSm(ya)):la.ULS.sendTraceTag(42256257,310,50,"App rejected to perform gesture now : {0}",Q))}}get(Q){return Object(va.a)(Hammer.Recognizer,Q)}Ayl(Q){if(1>Q.length)return null;if(1===Q.length)return Q[0];
var ya=Q[0],gb=!0;for(let Ob=1;Ob<Q.length;Ob++){if(!Q[Ob])return null;if(ya!==Q[Ob]){gb=!1;break}}if(gb)return ya;ya=this.YLh(Q[0]);gb=0;for(const Ob of Q){Q=this.YLh(Ob);if(ya.J(ya.count-1)!==Q.J(Q.count-1))return null;for(let mc=ya.count-2,dd=Q.count-2;mc>=gb&&0<=dd;mc--,dd--)if(ya.J(mc)!==Q.J(dd)){gb=mc+1;break}}return ya.J(gb)}YLh(Q){const ya=new ia.a;for(;void 0!==Q&&null!==Q;Q=Q.parentNode)ya.add(Q);return ya}KSh(Q){switch(Q){case B.a.yO:case B.a.awb:return 1;case B.a.xO:case B.a.kUe:return 2;
case B.a.bJ:case B.a.bwb:return 4;case B.a.mbe:case B.a.jUe:return 8}return 0}vib(Q,ya,gb){Q=this.KSh(Q);ya=this.Vvl(gb);Hammer.inputHandler(this,Q,ya);this.fHa&&gb.preventDefault();return this.fHa}v3h(){return 1<this.Nia.count}Rtd(){la.ULS.sendTraceTag(594055960,310,50,"CancelPendingPointerEvents");if(this.hxc)for(let Q of this.Nia)this.hOi(Q.key);else this.Nia=new mb.a;this.session=null}L3j(Q,ya,gb){la.ULS.sendTraceTag(594055959,310,50,"AddOrReplacePointerInCaches: pointerId: {0}",Q);if(!this.Ftc.xb(Q)){try{ya.setPointerCapture(Q)}catch(Ob){la.ULS.sendTraceTag(594055958,
310,10,"Exception: {0}",Ob)}this.Ftc.add(Q,ya)}this.Nia.Z(Q,gb);this.dOb&&1<this.Nia.count&&this.z0&&!this.z0.mAc&&(this.z0.mAc=!0)}hOi(Q){la.ULS.sendTraceTag(594055957,310,50,"RemovePointerFromCaches: pointerId: {0}",Q);if(this.Ftc.xb(Q)){try{this.Ftc.J(Q).releasePointerCapture(Q)}catch(ya){la.ULS.sendTraceTag(594055956,310,10,"Exception: {0}",ya)}this.Ftc.remove(Q)}else la.ULS.sendTraceTag(594055955,310,10,"RemovePointerFromCaches: pointerId should be in cache: {0}",Q);this.Nia.remove(Q);this.dOb&&
1>=this.Nia.count&&this.z0&&this.z0.mAc&&(this.z0.mAc=!1)}cYd(Q,ya,gb){var Ob=gb.rawEvent.pointerType.toString();const mc=gb.rawEvent.pointerId.toString();if("touch"!==Ob)return!1;Q=this.KSh(Q);if(1!==Q&&!this.Nia.xb(mc))return!1;this.Uxg&&1===Q&&gb.rawEvent.isPrimary&&this.Nia.count&&(la.ULS.sendTraceTag(593839564,310,10,"Pointer cache should be empty"),this.Rtd());this.hxc?this.L3j(mc,ya,gb):this.Nia.Z(mc,gb);this.mye&&2===Q&&(!this.Sje||this.Sje&&"function"===typeof gb.rawEvent.getCoalescedEvents)&&
(ya=gb.rawEvent.getCoalescedEvents())&&this.v3h()&&(this.zrc=Math.max(this.zrc,ya.length));this.qYg&&(this.fHa=!1);Ob=this.Uvl(this.Nia,gb,Ob);Hammer.inputHandler(this,Q,Ob);if(4===Q||8===Q)this.hxc?this.hOi(mc):this.Nia.remove(mc),this.Nia.count||(this.session=null,this.mye&&-1!==this.zrc&&(la.ULS.sendTraceTag(593597138,310,50,"Max number of coalesced events: {0}",this.zrc),this.zrc=-1));this.fHa&&gb.preventDefault();return this.fHa}RXd(){return!1}Vvl(Q){const ya=new ib;var gb=Q.rawEvent;const Ob=
gb.touches;gb=gb.changedTouches;ya.pointers=Array.clone(Ob);ya.pointers=Array.clone(0<Ob.length?Ob:gb);ya.changedPointers=Array.clone(gb);ya.srcEvent=Q;ya.pointerType="touch";return ya}Uvl(Q,ya,gb){const Ob=new ib;Ob.pointers=rc.toArray(Q.values);Ob.changedPointers=[ya];Ob.pointerType=gb;Ob.srcEvent=ya;return Ob}bim(Q){return Tb.a.startsWith(Q,B.a.pinch)}Chm(Q){return Tb.a.startsWith(Q,B.a.pan)}slm(Q){return Tb.a.startsWith(Q,B.a.swipe)}}Object(e.a)(vb,"GestureInputManager",G.a,[1990,1991]);var Ya=
d(241);class wb{constructor(){this.W=null;this.Bh=!1}get name(){return"Common.App.GestureInputManager"}yc(Q){Q.register(vb,"Common.App.GestureManager.GestureInputManager").as("Common.IGestureInputManager").singleInstance().Yd(()=>new vb(Ya.a.instance,H.AFrameworkApplication.ua.jq));this.W=Q}init(){this.Bh||(this.W.resolve("Common.App.GestureManager.GestureInputManager"),this.Bh=!0)}dispose(){}static main(){ca.a.instance.Oc(new wb)}}Object(e.a)(wb,"GestureInputManagerPackage",null,[1,2]);var jb=d(244),
Zb=d(46),Eb=d(1525);class tc{constructor(Q,ya,gb){this.WGe=this.VGe=null;this.NUb=new t.a;this.rg=Q;this.tsc=gb;this.k5=ya.appSettings[tc.kro]||""}get PRn(){return this.NUb.task}get Zja(){return this.rg.value}Kvn(){const Q={};Q[tc.rVl]=H.AFrameworkApplication.xm;Q["Content-Type"]="application/json; charset=utf-8";la.ULS.sendTraceTag(6612806,215,50,"Client is sending a request to get the code for the O365 switcher");const ya=Zb.a.Ep(this.k5+tc.QRn,tc.TNm,H.AFrameworkApplication.ua.Sb.jo.toString());
this.Zja.Lj(ya,1,"",Q,!0,2,Object(a.a)(this,this.CGb,"onSuccessCallback"),Object(a.a)(this,this.oGb,"onFailureCallback"),null,void 0,void 0,void 0,void 0,"20")}gzm(Q){try{const ya={};ya.FlightName=Q.FlightName;ya.SessionID=Q.SessionID;la.ULS.sendTraceTag(594883776,215,50,Ka.c(ya))}catch(ya){la.ULS.sendTraceTag(594883747,215,10,"Unable to log NavBarData")}}CGb(Q){if((Q=Q.data.Ge)&&Q.length)try{const ya=Ka.a(Q);this.VGe=ya.NavBarDataJson;la.ULS.sendTraceTag(41551899,215,50,"Skipping call to TryLoadResources for React Shared Header.");
this.VGe?({Fv:this.WGe}=Ka.d(ya.NavBarDataJson)).returnValue?(this.gzm(this.WGe),this.NUb.Gg(this.WGe)):(la.ULS.sendTraceTag(7660113,215,10,"Failed to deserialize : {0}",{["ShellData"]:Eb.a.X2c(this.VGe)}),this.NUb.Yaa()):(la.ULS.sendTraceTag(9000737,215,15,"ShellData is null"),this.NUb.Yaa())}catch(ya){la.ULS.sendTraceTag(6362370,215,10,"Unable to parse the response from O365ShellServiceProxy."),this.NUb.Yaa()}else la.ULS.sendTraceTag(6362369,215,10,"Response from O365ShellServiceProxy is null.")}oGb(){this.NUb.Yaa();
la.ULS.sendTraceTag(7608091,215,10,"Call to O365ShellServiceProxy failed.")}static get instance(){return tc._instance||(tc._instance=tc.Gzb())}static Gzb(){return new tc(new jb.a(()=>H.AFrameworkApplication.Xe),H.AFrameworkApplication.K,H.AFrameworkApplication.ua.Sb.jo)}}tc.rVl="X-qs";tc.TNm="at";tc.QRn="O365ShellServiceProxy.ashx";tc._instance=null;tc.kro="ShellWebServiceBase";Object(e.a)(tc,"O365ShellActor",null,[1984]);class lc{constructor(){this.W=null}get name(){return"Common.App.O365Shell"}yc(Q){this.W=
Q;this.W.register(tc,"Common.App.O365Shell.O365ShellActor").as("Common.App.O365Shell.IO365ShellActor").singleInstance().Yd(()=>new tc(new jb.a(()=>H.AFrameworkApplication.Xe),H.AFrameworkApplication.K,H.AFrameworkApplication.ua.Sb.jo))}init(){H.AFrameworkApplication.K.zq(Object(a.a)(this,this.ax,"onFullAppSettingsReady"))}ax(){H.AFrameworkApplication.C9f&&H.AFrameworkApplication.ua.Sb.BI&&this.W.resolve("Common.App.O365Shell.O365ShellActor").Kvn()}dispose(){}static main(){ca.a.instance.Oc(new lc)}}
Object(e.a)(lc,"PackageManager",null,[1,2]);class Lc{g0a(){}init(){}dispose(){}}Object(e.a)(Lc,"NoOpOfflineLogger",null,[2014,9]);var Bb=d(604);class jc{}jc.Jrd=0;Object(e.a)(jc,"OfflineLoggerConstants",null,[]);var dc=d(80),nb=d(229),Gb=d(321);class lb{constructor(Q,ya,gb,Ob,mc){this.LSa=!1;this.R4=null;this.Dlc=this.$Rb=this.pob=0;this.zJ=this.l8a=this.aS=null;this.Cl=!1;this.Uxa=gb;this.Aya=Ob;this.qya=mc;this.rg=ya;this.Hb=Q}init(){this.PZf();this.Usm();this.LSa=!1;this.rg.SWb(this);this.aS=new dc.a(3,
2,2500,Object(a.a)(this,this.sendOfflineLogs,"sendOfflineLogs"),104);this.Hb.$b(this.aS)}Ozc(Q){return"OfflineLog|"+Q}Usm(){const Q=this.Uxa.getItem("OfflineLoggerManifest");void 0!==Q&&null!==Q&&0<Q.length&&(this.R4=lb.chc(Q));this.R4||(this.R4={});if(void 0===this.R4.end||null===this.R4.end)this.R4.end=0;if(void 0===this.R4.offset||null===this.R4.offset)this.R4.offset=0;this.pob=this.R4.offset;isFinite(this.pob)||(this.pob=0);this.$Rb=this.R4.end;isFinite(this.$Rb)||(this.$Rb=0);this.Dlc=this.$Rb}PZf(){this.l8a=
new Gb.a;this.zJ=new nb.a;this.Aya.m$g(Object(a.a)(this,this.RIf,"onUlsReadyToBeSent"));this.Aya.P$g(Object(a.a)(this,this.TIf,"onUlsSentSuccessfully"));this.Aya.O$g(Object(a.a)(this,this.SIf,"onUlsSentFailed"));this.Aya.d$g(Object(a.a)(this,this.eFf,"onAfterUlsHostDisposed"))}RIf(Q,ya){if(void 0!==ya&&null!==ya&&void 0!==ya.args&&null!==ya.args){Q=!1;if(!this.l8a.xb(ya.args.tag)){if(!this.l8a.xb(jc.Jrd))return;Q=!0}this.l8a.remove(Q?jc.Jrd:ya.args.tag);this.zJ.xb(ya.AM)||this.zJ.Z(ya.AM,new ia.a);
this.zJ.J(ya.AM).add(ya.args)}}TIf(Q,ya){this.zJ.remove(ya.AM)}SIf(Q,ya){if(void 0!==ya&&null!==ya&&this.zJ.xb(ya.AM)){Q=this.zJ.J(ya.AM);for(let gb=0,Ob=Q.count;gb<Ob;++gb)ya=lb.serialize(Q.J(gb),this.qya),this.d3c(this.Ozc(this.Dlc++),ya)}}eFf(){this.dispose()}d3c(Q,ya){try{return this.Uxa.setItem(Q,ya),!0}catch(gb){return la.ULS.sendTraceTag(18614232,222,15,"OfflineLogger SetItem failed with exception: {0}",gb.message),!1}}sendOfflineLogs(){if(!this.LSa){for(var Q=this.pob,ya=new ia.a,gb=null;Q<
this.$Rb&&5>=ya.count;++Q){var Ob=this.Ozc(Q);const mc=this.Uxa.getItem(Ob);this.Uxa.removeItem(Ob);if(void 0===mc||null===mc)continue;const dd=({sessionId:Ob}=lb.deserialize(mc)).returnValue;if(dd){if(!gb)gb=Ob;else if(Ob!==gb)break;ya.add(dd)}else la.ULS.sendTraceTag(18614233,222,15,"Unable to deserialze the offline log: {0}",mc)}0<ya.count&&this.Aya.tRi(this,rc.toArray(ya),gb);this.pob=Q;Q>=this.$Rb&&(this.Hb.We(this.aS),this.aS=null)}}g0a(Q,ya,gb){!this.Cl&&la.ULS.A7(ya,gb)&&this.l8a.Z(Q,!0)}dispose(){if(!this.Cl){this.aS&&
this.Hb.We(this.aS);var Q=rc.toArray(this.zJ.keys);Q.sort();for(const ya of Q){Q=this.zJ.J(ya);for(let gb=0,Ob=Q.count;gb<Ob;++gb){const mc=lb.serialize(Q.J(gb),this.qya);this.d3c(this.Ozc(this.Dlc++),mc)}}this.pob<this.Dlc?(this.R4.end=this.Dlc,this.R4.offset=this.pob,this.d3c("OfflineLoggerManifest",JSON.stringify(this.R4))):this.Uxa.removeItem("OfflineLoggerManifest")}this.Cl=!0}HNa(){this.LSa=!0}Jhb(){this.LSa=!1}static serialize(Q,ya){const gb={};gb.t=Q.tag;gb.c=Q.category;gb.l=Q.level;gb.m=
Q.message;gb.lt=Q.logType;gb.s=ya;gb.ts=Q.timestamp;gb.o=Q.isMinified;gb.a=Q.args;return JSON.stringify(gb)}static deserialize(Q){return(Q=lb.chc(Q))?{returnValue:new Bb.a(Q.ts,Q.c,Q.t,Q.l,Q.m,Q.lt,Q.o,Q.a),sessionId:Q.s}:{returnValue:null,sessionId:null}}static chc(Q){try{return JSON.parse(Q)}catch(ya){la.ULS.sendTraceTag(18614234,222,10,"OfflineLogger TryParseString failed with exception: {0}",ya.message)}return null}}Object(e.a)(lb,"OfflineLoggerImpl",null,[2014,9,257]);class Kb{constructor(Q,
ya,gb,Ob){this.sessionId=Q;this.version=ya;this.zsd=gb;this.xJf=Ob;this.mua=new ia.a}}Object(e.a)(Kb,"CachedLogUpload",null,[]);class Vb{constructor(Q){Q.name&&(this.n=Q.name);Q.stack&&(this.s=Q.stack);Q.message&&(this.m=Q.message);Q.file&&(this.f=Q.file);null!=Q.line&&(this.l=Q.line);null!=Q.column&&(this.c=Q.column)}}Object(e.a)(Vb,"LoggingExceptionArgsLocalStorage",null,[]);class vc{constructor(Q){this.t=Q.tag;this.c=Q.category;this.l=Q.level;this.m=Q.message;this.lt=Q.logType;this.ts=Q.timestamp;
this.o=Q.isMinified;this.a=Q.args;Q.exceptionArgs&&(this.e=new Vb(Q.exceptionArgs))}}Object(e.a)(vc,"LoggingArgsLocalStorage",null,[]);var Fc=d(361);class Zc{constructor(Q,ya,gb,Ob,mc,dd){this.t=Q;this.m=ya;this.s=gb;this.v=Ob;this.i=mc;this.a=dd;this.op="Log"}}Object(e.a)(Zc,"LoggingKeyLocalStorage",null,[]);var td=d(121);const xd=(Q,ya,gb)=>!(void 0===Q||null===Q)&&!(void 0===Q.i||null===Q.i)&&!(void 0===Q.t||null===Q.t)&&!(void 0===Q.s||null===Q.s)&&"Log"===Q.op&&Q.t===ya&&isFinite(Q.t)&&td.a.Rd(Q.s)&&
(void 0===Q.m||null===Q.m||Q.m===gb);class le{constructor(Q,ya,gb,Ob,mc,dd,Md,He,Ue,Sf,of){this.LSa=this.GPg=this.vPg=this.wPg=!1;this.zJ=this.l8a=this.R4=this.aS=null;this.Cl=!1;this.Mqb=[];this.URb=[];this.Uxa=gb;this.Aya=Ob;this.qya=mc;this.rg=ya;this.Hb=Q;this.tsc=dd;this.qAe=Md;this.BYg=He;this.$Sa=Ue;this.zLj=Sf;this.Ive=of}get manifest(){return this.R4}get $Qc(){return this.l8a}get lNa(){return this.zJ}init(){this.PZf();this.LSa=!1;this.rg.SWb(this);this.aS=new dc.a(3,1,2500,Object(a.a)(this,
this.determineLogsToSendAtBoot,"determineLogsToSendAtBoot"),103);this.Hb.$b(this.aS)}determineLogsToSendAtBoot(){this.izh(!0)}determineLogsToSendOnReconnect(){this.izh(!1)}izh(Q){this.hBd();this.Mqb=[];Q&&(this.URb=[]);for(var ya=0;ya<this.Uxa.length;ya++){const gb=this.Uxa.key(ya),Ob=le.chc(gb,!1);xd(Ob,this.tsc,this.qAe)&&(Ob.s===this.qya?Array.add(this.Mqb,gb):Q&&Array.add(this.URb,gb))}if(this.Mqb.length||Q&&this.URb.length)if(ya=this.Ive?Object(a.a)(this,this.z_n,"sortDescendKeysToUpload"):Object(a.a)(this,
this.C_n,"sortKeysToUpload"),this.Mqb.sort(ya),Q&&this.URb.sort(ya),0<this.Mqb.length||0<this.URb.length)this.aS=new dc.a(3,2,2500,Object(a.a)(this,this.sendOfflineLogs,"sendOfflineLogs"),105),this.Hb.$b(this.aS)}C_n(Q){return Q.s!==Q.s?Q.s.localeCompare(Q.s):Q.i-Q.i}z_n(Q){return Q.s!==Q.s?Q.s.localeCompare(Q.s):Q.i-Q.i}Ozc(Q,ya,gb,Ob){return JSON.stringify(new Zc(this.tsc,this.qAe,ya,gb,Q,Ob))}PZf(){this.l8a=new Gb.a;this.zJ=new nb.a;this.Aya.m$g(Object(a.a)(this,this.RIf,"onUlsReadyToBeSent"));
this.Aya.P$g(Object(a.a)(this,this.TIf,"onUlsSentSuccessfully"));this.Aya.O$g(Object(a.a)(this,this.SIf,"onUlsSentFailed"));this.Aya.d$g(Object(a.a)(this,this.eFf,"onAfterUlsHostDisposed"))}RIf(Q,ya){if(void 0!==ya&&null!==ya&&void 0!==ya.args&&null!==ya.args){if(this.$Qc.xb(ya.args.tag))this.$Qc.remove(ya.args.tag);else if(this.$Qc.xb(jc.Jrd))this.$Qc.remove(jc.Jrd);else if(!(this.zLj&&50>ya.args.level))return;({value:Q}=this.lNa.Dc(ya.AM)).returnValue||(Q=new Kb(ya.sessionId,ya.version,ya.zsd,ya.xJf),
this.lNa.Z(ya.AM,Q));this.lNa.J(ya.AM).mua.add(ya.args)}}TIf(Q,ya){this.lNa.remove(ya.AM)}SIf(Q,ya){void 0!==ya&&null!==ya&&this.lNa.xb(ya.AM)&&this.Xri(ya.AM)&&!this.GPg&&(this.GPg=!0,la.ULS.sendTraceTag(37290073,222,50,"Added logs to local storage."))}Xri(Q){let ya=!1;if(({value:Ob}=this.lNa.Dc(Q)).returnValue&&Ob&&0<Ob.mua.count){if(Ob.zsd>=this.$Sa)return!1;var gb=Ob.mua;const mc=Array(gb.count);for(let dd=0,Md=gb.count;dd<Md;++dd)mc[dd]=new vc(gb.J(dd));gb=le.serialize(mc);var Ob=this.Ozc(Ob.xJf,
Ob.sessionId,Ob.version,Ob.zsd);this.d3c(Ob,gb)&&(this.lNa.remove(Q),ya=!0)}return ya}eFf(){this.dispose()}d3c(Q,ya){try{return this.Uxa.setItem(Q,ya),!0}catch(gb){return la.ULS.sendTraceTag(37290074,222,15,"OfflineLogger SetItem failed with exception: {0}",gb.message),!1}}sendOfflineLogs(){if(!this.LSa){var Q=0<this.Mqb.length?this.Mqb:this.URb,ya=Q.length;if(ya)for(;0<ya;){H.AFrameworkApplication.Hl("Microsoft.Office.Web.SessionSettings.IWacWordSendOfflineLogsV2ImprovementSettings");ya--;var gb=
this.Ive?Q.pop():Q[0];this.Ive||Array.removeAt(Q,0);const dd=le.chc(gb,!0);if(xd(dd,this.tsc,this.qAe)){var Ob=this.Uxa.getItem(gb);this.Uxa.removeItem(gb);if(void 0!==Ob&&null!==Ob)if(dd.a>this.$Sa)la.ULS.sendTraceTag(37290075,222,50,"Log has more attempt {0} than the max allowed {1}.",dd.a,this.$Sa);else if(gb=le.chc(Ob,!0),void 0!==gb&&null!==gb&&isFinite(gb.length))if(gb.length){Ob=gb[gb.length-1];var mc=(new Date).getTime()-Ob.ts;if(mc<-le.Naj)la.ULS.sendTraceTag(37290078,222,50,"Log came from more than a day in the future.  Let's throw it away and not trust it. {0}",
Ob.ts);else if(mc>this.BYg*le.Naj)la.ULS.sendTraceTag(37290079,222,50,"Log is older than our retention period of {0} days.  Throwing it away. {1}",this.BYg,Ob.ts);else{dd.s===this.qya?this.wPg||(this.wPg=!0,la.ULS.sendTraceTag(37290080,222,50,"Attempted to re-send logs from this session.")):this.vPg||(this.vPg=!0,la.ULS.sendTraceTag(37290081,222,50,"Attempted to re-send logs from another session {0}.",dd.s));ya=Array(gb.length);for(Ob=0;Ob<gb.length;Ob++){Q=Ob;a:{mc=gb[Ob];if(void 0===mc||null===
mc){mc=null;break a}let Md=null;mc.e&&(Md=new Fc.a(null),Md.name=mc.e.n,Md.stack=mc.e.s,Md.message=mc.e.m,Md.file=mc.e.f,Md.line=mc.e.l,Md.column=mc.e.c);mc=new Bb.a(mc.ts,mc.c,mc.t,mc.l,mc.m,mc.lt,mc.o,mc.a,Md)}ya[Q]=mc}this.Aya.tRi(this,ya,dd.s,dd.v,dd.a+1,dd.i);break}}else la.ULS.sendTraceTag(37290077,222,15,"Deserialize an empty array from local storage: {0}",Ob);else la.ULS.sendTraceTag(37290076,222,15,"Unable to deserialize the offline log: {0}",Ob)}}else this.hBd()}}g0a(Q,ya,gb){!this.Cl&&
la.ULS.A7(ya,gb)&&this.$Qc.Z(Q,!0)}dispose(){if(!this.Cl){this.aS&&this.Hb.We(this.aS);var Q=rc.toArray(this.lNa.keys);for(const ya of Q)this.Xri(ya)}this.Cl=!0}HNa(){this.LSa=!0;this.hBd()}Jhb(){this.LSa=!1;this.hBd();this.aS&&this.Hb.We(this.aS);this.aS=new dc.a(3,1,2500,Object(a.a)(this,this.determineLogsToSendOnReconnect,"determineLogsToSendOnReconnect"),102);this.Hb.$b(this.aS)}hBd(){this.aS&&(this.Hb.We(this.aS),this.aS=null)}static serialize(Q){return JSON.stringify(Q)}static chc(Q,ya){try{return JSON.parse(Q)}catch(gb){ya&&
la.ULS.sendTraceTag(37290082,222,10,"OfflineLogger TryParseString failed with exception: {0}",gb.message)}return null}}le.Naj=864E5;Object(e.a)(le,"OfflineLoggerImplV2",null,[2014,9,257]);class Yc{constructor(){localStorage.getItem("{CBEDE940-2407-4B58-BA27-B8CBF0B0DDE6}{5}")}get length(){try{return localStorage.length}catch(Q){return this.handleError("Length",Q),-1}}key(Q){try{return localStorage.key(Q)}catch(ya){return this.handleError("Key",ya),null}}getItem(Q){try{return localStorage.getItem(Q)}catch(ya){return this.handleError("GetItem",
ya),null}}setItem(Q,ya){try{return localStorage.setItem(Q,ya)}catch(gb){return this.handleError("SetItem",gb),null}}removeItem(Q){try{localStorage.removeItem(Q)}catch(ya){this.handleError("RemoveItem",ya)}}clear(){try{localStorage.clear()}catch(Q){this.handleError("Clear",Q)}}handleError(Q,ya){la.ULS.sendTraceTag(19170128,222,10,"Invoking localStorage function[{0}] failed, message: {1}",Q,ya.message)}}Object(e.a)(Yc,"OfflineStorage",null,[2015]);class xc{create(Q){let ya=null;try{void 0!==localStorage&&
null!==localStorage&&(ya=new Yc)}catch(gb){la.ULS.sendTraceTag(18641093,222,50,"window.localStorage is not accessable: {0}",gb.message)}Object.getType(la.ULS.host).implementsInterface(1057)&&ya||(la.ULS.sendTraceTag(18614230,222,50,"OfflineLogger is not supported: offline storage is {0}, ULS host hook is {1}",ya?"supported":"not supported",Object.getType(la.ULS.host).implementsInterface(1057)?"supported":"not supported"),Q=0);Q=1===Q?new lb(H.AFrameworkApplication.uc,H.AFrameworkApplication.Xe,ya,
la.ULS.host,H.AFrameworkApplication.userSessionId):2===Q?new le(H.AFrameworkApplication.uc,H.AFrameworkApplication.Xe,ya,la.ULS.host,H.AFrameworkApplication.userSessionId,H.AFrameworkApplication.ua.Sb.jo,H.AFrameworkApplication.ua.Sb.Mfa,H.AFrameworkApplication.K.rc("OfflineLoggerRetentionInDays",30),H.AFrameworkApplication.K.rc("OfflineLoggerMaxAttempts",5),H.AFrameworkApplication.K.$("OfflineLoggerListenForAllMonitorableLogsIsEnabled"),H.AFrameworkApplication.K.$("SendOfflineLogsV2ImprovementIsEnabled")):
new Lc;Q.init();return Q}}Object(e.a)(xc,"OfflineLoggerFactory",null,[]);class md{yc(){}get name(){return"Common.App.OfflineLogger"}init(){const Q=H.AFrameworkApplication.K;let ya=0;Q.$("OneNoteOfflineLoggerIsEnabled")?ya=1:Q.$("OfflineLoggerV2IsEnabled")&&(ya=2);0!==ya&&(H.AFrameworkApplication.q5f=(new xc).create(ya))}dispose(){}}Object(e.a)(md,"OfflineLoggerPackage",null,[1,2]);var Ie=d(57),Te=d(1360);class rf{constructor(Q){this.Woi=null;la.ULS.sendTraceTag(527574681,306,50,"PhoneLinkManager - Initialize");
this.CRc=H.AFrameworkApplication.K.lb("PhoneLinkServiceEndpoint");(this.N6=Q)||la.ULS.sendTraceTag(527574720,306,10,"PhoneLinkManager - OAuthManager is null");this.CRc&&this.CRc.length||la.ULS.sendTraceTag(527574721,306,10,"PhoneLinkManager - Missing service endpoint")}D7k(Q){Q&&(this.CRc="https://dcg-df.microsoft.com/",la.ULS.sendTraceTag(526697302,306,50,"PhoneLinkManager::FetchPhoneLinkData override endpoint to dogfood"));this.C7k()}C7k(){la.ULS.sendTraceTag(527214155,306,50,"PhoneLinkManager::FetchPhoneLinkData...");
if(864E5>=+new Date-+this.Woi)la.ULS.sendTraceTag(527574722,306,10,"PhoneLinkManager::FetchPhoneLinkData - Can't get more than 1 time within 1 day");else{this.Woi=new Date;var Q=new Date;this.N6.uoa("BayBridge",this.CRc).then(ya=>{const gb=+new Date-+Q;ya.IsSuccess?(la.ULS.sendTraceTag(527574723,306,50,"PhoneLinkManager::FetchPhoneLinkData Phone Link Authentication Latency: {0}",gb),this.t7k(ya.Token,this.oil())):la.ULS.sendTraceTag(527574724,306,15,"PhoneLinkManager::FetchPhoneLinkData Failed to get AAD token with error, authDuration: {0}, ErrorCode: {1}, ErrorMessage: {2}",
gb,ya.ErrorCode,ya.ErrorMessage)}).catch(ya=>{la.ULS.sendTraceTag(527574725,306,15,"PhoneLinkManager::FetchPhoneLinkData - Token retrival failed: {0}, Latency: {1}",ya,+new Date-+Q)})}}t7k(Q,ya){const gb={};gb.Authorization="Bearer "+Q;gb["Authorization-Type"]="AAD";gb.Accept="application/json";gb["DCG-SessionId"]=H.AFrameworkApplication.userSessionId;H.AFrameworkApplication.Xe.Lj(ya,1,null,gb,!1,2,Object(a.a)(this,this.ZJl,"getStatusSucceeded"),Object(a.a)(this,this.XJl,"getStatusFailed"),null,void 0,
void 0,void 0,void 0,"39");Ie.a("FetchAccountLinkedStatus")}mkl(){const Q=Te.a.instance.getItem("AccountLinkedStatusCache");return Q&&Q.length?"true"===Q.toLowerCase()?!0:!1:!1}oil(){return this.CRc+"DeviceAuthProxy/IsAccountLinked?api-version=1.0.0"}XJl(){la.ULS.sendTraceTag(527214156,306,15,"PhoneLinkManager FetchAccountLinkedStatus request failed")}ZJl(Q){la.ULS.sendTraceTag(527214157,352,50,"GetStatusSucceeded FetchAccountLinkedStatus request was successful");Q=Ka.a(Q.data.Ge).state+"";Te.a.instance.setItem("AccountLinkedStatusCache",
Q)}}Object(e.a)(rf,"PhoneLinkManager",null,[1938]);class ke{constructor(){this.W=null}get name(){return"Common.App.PhoneLink"}yc(Q){this.W=Q;this.W.register(1938,"Common.App.PhoneLink.IPhoneLinkManager").singleInstance().Yd(()=>new rf(this.W.resolve("Common.App.OAuth.IOAuthManager")))}init(){H.AFrameworkApplication.K.zq(()=>{this.EZa()})}EZa(){this.W.resolve("Common.App.PhoneLink.IPhoneLinkManager")}dispose(){}static main(){ca.a.instance.Oc(new ke)}}Object(e.a)(ke,"PhoneLinkPackage",null,[1,2]);const xe=
Q=>{try{return Ka.a(Q)}catch(ya){}return null};class zf{constructor(Q,ya,gb,Ob,mc,dd){this.xY=!1;this.Oq=null;this.DCe=!1;this.ga=Q;this.rg=ya;this.Zj=gb;this.GOg=Ob;this.Oa=mc;this.dLj=dd}init(Q,ya){ya&&Q.Za("Common.Interface.IRtcBasicProvider").execute(Object(a.a)(this,this.CSe,"awaitRtc"))}CSe(Q){const ya=Q.BIc();ya.continueWith(()=>{this.Oq=ya.result;this.DCe&&(this.Oq.oO(2,null,!0),this.DCe=!1);this.Oq.p1((gb,Ob)=>{2===Ob.type&&this.zc.processAction(Ra.a.fileNameUpdate,2)});this.Oq.Vya((gb,Ob)=>
{2===Ob.newState&&this.zc.processAction(Ra.a.fileNameUpdate,2)});2===this.Oq.connectionState&&this.zc.processAction(Ra.a.fileNameUpdate,2)})}LKa(Q){this.CFh(Q,!0)}CFh(Q,ya){const gb=this.Gmk(Q.d6i),Ob={};Ob[zf.grh]=zf.hrh;this.hRi.Lj(gb,2,"",Ob,!1,2,Object(a.a)(this,this.S$b,"onRefreshFilenameSuccess"),ya?Object(a.a)(this,this.$Vm,"onRefreshFilenameFailureRetry"):Object(a.a)(this,this.xzi,"onRefreshFilenameFailureNoRetry"),Q)}S$b(Q){this.xY=!1;const ya=xe(Q.data.Ge);Q.data.state.onSuccess(ya,this.GOg.value)}$Vm(Q){5!==
Q.data.status||this.xY?this.xzi(Q):(this.xY=!0,this.CFh(Q.data.state,!1))}xzi(Q){Q.data.state.onFailure(-1)}Syb(Q){this.DFh(Q,!0)}DFh(Q,ya){const gb=this.Hmk(),Ob={};Ob[zf.grh]=zf.hrh;Ob[zf.pVl]=Tb.a.Ij(Q.oRi);Ob[zf.nVl]=this.dLj.value.Myk;this.hRi.Lj(gb,2,"",Ob,!1,2,Object(a.a)(this,this.STc,"onRenameFileSuccess"),ya?Object(a.a)(this,this.eWm,"onRenameFileFailureRetry"):Object(a.a)(this,this.zzi,"onRenameFileFailureNoRetry"),Q)}Hmk(){return this.Khh()}Gmk(Q){let ya=this.Khh();return ya=Zb.a.Ep(ya,
zf.tVl,Q?"2":"1")}Khh(){let Q=(this.Oa.value.appSettings.RenameWebServiceBase||"")+zf.oVl;Q=Zb.a.Ep(Q,zf.qVl,Tb.a.Ij(H.AFrameworkApplication.xm));this.Gp&&this.Gp.Fqf&&(Q=Zb.a.Ep(Q,zf.sVl,"1"));return Q}STc(Q){this.xY=!1;const ya=xe(Q.data.Ge);Q.data.state.onSuccess(ya,this.GOg.value);this.wui()}wui(){this.Oq?this.Oq.oO(2,null,!0):this.DCe=!0}eWm(Q){5!==Q.data.status||this.xY?this.zzi(Q):(this.xY=!0,this.DFh(Q.data.state,!1))}zzi(Q){Q.data.state.onFailure(-1)}get zc(){return this.ga.value}get hRi(){return this.rg.value}get Gp(){return this.Zj.value}static get instance(){return zf._instance||
(zf._instance=zf.Gzb())}static Gzb(){return new zf(new jb.a(()=>H.AFrameworkApplication.ya),new jb.a(()=>H.AFrameworkApplication.Xe),new jb.a(()=>H.AFrameworkApplication.Gp),new jb.a(()=>qa.a.instance.resolve("Postmessage.IHostPostmessenger")),new jb.a(()=>H.AFrameworkApplication.K),new jb.a(()=>qa.a.instance.resolve("Common.IRenameProps")))}}zf.grh="Content-Type";zf.hrh="application/json; charset=utf-8";zf.oVl="renamehandler.ashx";zf.qVl="qs";zf.pVl="n";zf.sVl="sl";zf.nVl="X-CoauthLockId";zf.tVl=
"u";zf._instance=null;Object(e.a)(zf,"ExecuteRenameFileHandler",null,[]);class $c{constructor(){this.onFailure=this.onSuccess=null;this.d6i=!1}}Object(e.a)($c,"ExecuteRefreshFilenameData",null,[]);class Hg{constructor(){this.onFailure=this.onSuccess=this.oRi=null}}Object(e.a)(Hg,"ExecuteRenameFileData",null,[]);class Rc{constructor(){this.W=null;this.ape=zf.instance}get name(){return"Common.App.RenameFile.RenameExecutor"}yc(Q){this.W=Q}init(){H.AFrameworkApplication.K.zq(Object(a.a)(this,this.ax,
"onFullAppSettingsReady"))}ax(){H.AFrameworkApplication.$Oc()&&(zf.instance.init(this.W,H.AFrameworkApplication.fYc),H.AFrameworkApplication.Syb=Object(a.a)(this,this.Syb,"executeRenameFile"),H.AFrameworkApplication.LKa=Object(a.a)(this,this.LKa,"executeRefreshFilename"),H.AFrameworkApplication.MZc=Object(a.a)(this,this.MZc,"sendFileNameAndLocationUpdateNotification"))}Syb(Q,ya,gb){const Ob=new Hg;Ob.oRi=Q;Ob.onSuccess=ya;Ob.onFailure=gb;this.ape.Syb(Ob)}LKa(Q,ya,gb){const Ob=new $c;Ob.onSuccess=
Q;Ob.onFailure=ya;Ob.d6i=gb;this.ape.LKa(Ob)}MZc(){this.ape.wui()}dispose(){}}Object(e.a)(Rc,"PackageManager",null,[1,2]);var Ed=d(142);class Yd{constructor(Q,ya,gb){this.H0f=this.I0f=this.J0f=!1;this.X0f=!Q&&!ya;this.Y0f=!Q&&!gb;this.X0f||this.Y0f||(this.J0f=!Q,this.I0f=!ya,this.H0f=!gb)}}Object(e.a)(Yd,"RenameDisabledDialogInfo",null,[]);class Zf extends Ed.StandardDialog{constructor(Q,ya,gb,Ob,mc){super();this.Z4f=[];this.pca=new Yd(Q,ya,gb);this.w$a=Ob;this.Q7a=mc;this.kg="RenameDisabledDialog";
this.Fd=0;this.Ve(1,CommonUIStrings.l_DialogClose);this.wPn();this.ptn()}wPn(){this.pca.X0f?this.G0c(this.w$a?this.Q7a?CommonUIStrings.l_RenameFileRenameReadOnlyRecommended:CommonUIStrings.l_RenameFileRenameNotEveryoneSupportsRename:CommonUIStrings.l_RenameFileRenameDisabledCoauthFull):this.pca.Y0f?this.G0c(CommonUIStrings.l_RenameFileRenameDisabledPermissionFull):this.m3j();this.Zxc(this.Z4f)}G0c(Q){Array.add(this.Z4f,Q)}m3j(){const Q=[];this.pca.J0f||Array.add(Q,CommonUIStrings.l_RenameFileRenameDisabledSignIn);
this.pca.I0f||Array.add(Q,CommonUIStrings.l_RenameFileRenameDisabledPermission);this.pca.H0f||Array.add(Q,CommonUIStrings.l_RenameFileRenameDisabledCoauth);0<Q.length&&Array.add(this.Z4f,Q)}}Object(e.a)(Zf,"ReactRenameDisabledDialogBase",Ed.StandardDialog,[]);class Hc extends Zf{constructor(Q,ya,gb,Ob,mc){super(Q,ya,gb,Ob,mc)}ptn(){this.xhb(CommonUIStrings.l_RenameFileRenameDisabledTitle,null,null,null,null,null)}}Object(e.a)(Hc,"ReactRenameDisabledDialog",Zf,[]);var sc=d(153);class pd{static get vg(){return sc.a.Px(pd.sl,
CommonUIStrings.l_RenameFileRenameDisabled,CommonUIStrings.l_RenameFileRenameDisabledSignIn,CommonUIStrings.l_RenameFileRenameDisabledPermission,CommonUIStrings.l_RenameFileRenameDisabledCoauth)}}pd.sl="<div class='WACDialogRow' id='RenameRow'> <label id='labelDisabledMessage' class='WACDialogLabel' >{0}</label> <div class='WACDialogRow' id='MultipleSuggestionsRow'> <ul id='ulRenameFileDisabled' class='WACDialogUList'> <li id='liRenameFileRenameDisabledSignIn'>{1}</li> <li id='liRenameFileRenameDisabledPermission'>{2}</li> <li id='liRenameFileRenameDisabledCoauth'>{3}</li> </ul> </div> </div>";
Object(e.a)(pd,"RenameDisabledDialogHtml",null,[]);class Ub extends sc.a{constructor(Q,ya,gb,Ob,mc){super();this.pca=new Yd(Q,ya,gb);this.w$a=Ob;this.Q7a=mc;this.kg="RenameDisabledDialog";this.Fd=0;this.Ve(1,CommonUIStrings.l_DialogClose);this.vg=pd.vg;this.showDialog(CommonUIStrings.l_RenameFileRenameDisabledTitle,null);this.u3("RenameRow")}cU(){if(this.pca.X0f){let Q;Q=this.w$a?this.Q7a?CommonUIStrings.l_RenameFileRenameReadOnlyRecommended:CommonUIStrings.l_RenameFileRenameNotEveryoneSupportsRename:
CommonUIStrings.l_RenameFileRenameDisabledCoauthFull;Ub.G0c(document.getElementById("ulRenameFileDisabled"),document.getElementById("labelDisabledMessage"),Q)}else this.pca.Y0f?Ub.G0c(document.getElementById("ulRenameFileDisabled"),document.getElementById("labelDisabledMessage"),CommonUIStrings.l_RenameFileRenameDisabledPermissionFull):this.pYl()}pYl(){this.pca.J0f&&(document.getElementById("liRenameFileRenameDisabledSignIn").style.display="none");this.pca.I0f&&(document.getElementById("liRenameFileRenameDisabledPermission").style.display=
"none");this.pca.H0f&&(document.getElementById("liRenameFileRenameDisabledCoauth").style.display="none")}static G0c(Q,ya,gb){Q.style.display="none";ya.innerText=gb}}Object(e.a)(Ub,"RenameDisabledDialog",sc.a,[]);var uc=d(60);class Tc{constructor(Q,ya){this.prb=0;this.ga=Q;this.yGa=ya}initialize(Q){if(!this.ga||!this.yGa)return!1;this.prb=Q;this.Vb();return!0}Vb(){this.ga.pa(Ra.a.mYe,uc.a.frame,Object(a.a)(this,this.mYe,"commitNewDocumentTitle"))}mYe(Q,ya,gb,Ob,mc){if(1===gb)return this.ga.processAction(Ra.a.renameFile,
1);Q=Tb.a.qI(this.yGa.Bz);mc=(0,mc.getNewDocumentTitle)();mc.length>this.prb&&(mc=mc.substr(0,this.prb));if(32!==this.ga.Xb(Ra.a.renameFile,2,mc))return this.whc(Q),8;this.whc(mc);return 32}whc(Q){appChrome.api.dispatch(appChrome.actions.updateDocumentTitle(Q))}static Gl(){return new Tc(H.AFrameworkApplication.ya,H.AFrameworkApplication.zt)}}Object(e.a)(Tc,"ReactRenameUIHandler",null,[2013]);var qd=d(221),re=d(1025),Je=d(471),Jf=d(84),Ig=d(143),pb=d(27);class Lb{constructor(Q,ya,gb,Ob,mc,dd,Md,He,
Ue,Sf,of,cj){this._initialized=!1;this._element=null;this.prb=0;this.tGe=this.yse=!1;this.ga=Q;this.Kha=ya;this.ke=gb;this.Gr=Ob;this.yGa=mc;this.CZg=dd;this.mld=Md;this.mke=He;this.p7a=Ue;this.LLg=Sf;this.Ai=of;this.fue=cj}get isActive(){return"true"===this._element.getAttribute("contentEditable")}initialize(Q,ya,gb){if(!(this.ga&&this.yGa&&this.CZg&&this.mld&&this.mke&&ya)||0>=Q)return!1;this._element=ya;this._element.title=gb;this._element.setAttribute(pb.a.Ch,pb.a.t1);this._element.setAttribute("Unselectable",
"on");this.prb=Q;this.QA();return this._initialized=!0}QA(){this.Kha&&(this.Kha.mb(B.a.blur,this._element,Object(a.a)(this,this.onBlur,"onBlur")),this.Kha.mb(B.a.paste,this._element,Object(a.a)(this,this.OTc,"onPaste")));this.ke.mb(B.a.li,this._element,Object(a.a)(this,this.onKeyDown,"onKeyDown"));this.Gr.mb(B.a.pointerDown,this._element,Object(a.a)(this,this.XB,"onPointerDown"));this.Gr.mb(B.a.fM,this._element,Object(a.a)(this,this.Iua,"onPointerUp"))}onBlur(){this.isActive&&!this.yse&&(this.LLg||
this.mke(this._element),this.tph(),this.r2e(!1));return this.yse=!1}OTc(){la.ULS.sendTraceTag(4281482,203,15,"Attempting to paste into the document title");return!0}onKeyDown(Q){return this.isActive?this.JTm(Q):this.KTm(Q)}JTm(Q){let ya=!1;switch(Q.Ib.keyCode){case Sys.UI.Key.enter:this.tph();this.r2e(this.Ai||this.fue);ya=!0;break;case Sys.UI.Key.tab:this.LLg&&this.mke(this._element);break;case Sys.UI.Key.esc:this.yUf(),this.r2e(this.Ai||this.fue),ya=!0}return ya}KTm(Q){let ya=!1;switch(Q.Ib.keyCode){case Sys.UI.Key.enter:case Sys.UI.Key.space:this.kdj(this.fue),
this.isActive&&this.mld(this._element),ya=!0}return ya}XB(){this.isActive||(this.kdj(!1),this.isActive&&(this._element.focus(),this.mld(this._element),this.tGe=!0));return!1}Iua(){return this.tGe?(this.mld(this._element),this.tGe=!1,!0):!1}q7b(){return 32===this.ga.processAction(Ra.a.renameFile,1)}tph(){const Q=Tb.a.qI(this.yGa.Bz);let ya=this._element.innerText.trim();ya.length>this.prb&&(ya=ya.substr(0,this.prb));ya!==Q&&""!==ya?32!==this.ga.Xb(Ra.a.renameFile,2,ya)?this.yUf():this.whc(ya):this.yUf()}yUf(){this.whc(Tb.a.qI(this.yGa.Bz))}whc(Q){this._initialized&&
(this._element.innerText=Q,this.CZg())}kdj(Q){this.q7b()?this.isActive||(Q&&(this.yse=!0,this._element.blur()),this._element.setAttribute("contentEditable","true"),this._element.removeAttribute("Unselectable"),this._element.setAttribute(pb.a.Ch,pb.a.jeh),this._element.style.width="auto",Sys.UI.DomElement.addCssClass(this._element,qd.CuiHelper.mCh),this.p7a&&this.p7a.execute(ya=>{ya.uJi(!0)}),Q&&this._element.focus(),la.ULS.sendTraceTag(9234188,203,50,"Rename document from header.")):this.ga.processAction(Ra.a.Vec,
2)}r2e(Q){this._element.removeAttribute("contentEditable");this._element.setAttribute("Unselectable","on");this._element.setAttribute(pb.a.Ch,pb.a.t1);Sys.UI.DomElement.removeCssClass(this._element,qd.CuiHelper.mCh);this.p7a&&this.p7a.execute(ya=>{ya.uJi(!1)});Q&&(this._element.blur(),this._element.focus())}static vva(){re.a.vva(H.AFrameworkApplication.isRtl)}static Gl(){return new Lb(H.AFrameworkApplication.ya,Je.a.instance,Jf.KeyInputManager.instance,Ig.a.instance,H.AFrameworkApplication.zt,Lb.vva,
ra.a.LDn,ra.a.jnh,qa.a.instance.Za("Common.App.Header.HeaderEventSource"),Ja.a.QB,Ja.a.ki,Ja.a.gj)}}Object(e.a)(Lb,"RenameUIHandler",null,[2013]);class Ic{static get instance(){return H.AFrameworkApplication.ua.Sb.BI?Ic._instance||(Ic._instance=Tc.Gl()):Ic._instance||(Ic._instance=Lb.Gl())}}Ic._instance=null;Object(e.a)(Ic,"RenameUIHandlerFactory",null,[]);var Ad=d(112);class oe{constructor(){this.zDf=this.aLm=this.uPk=null}}Object(e.a)(oe,"RenameMruEntryProperties",null,[]);var gf=d(163),Oe=d(87),
Sg=d(1524),Ng;(function(Q){Q[Q.unknown=-1]="unknown";Q[Q.success=0]="success";Q[Q.renameInvalidFileName=1]="renameInvalidFileName";Q[Q.renameInCoauthNotSupported=2]="renameInCoauthNotSupported";Q[Q.renameNotSupportedInViewMode=3]="renameNotSupportedInViewMode";Q[Q.permissionDenied=4]="permissionDenied";Q[Q.serverCommunicationFailure=5]="serverCommunicationFailure";Q[Q.fileNameTooLong=6]="fileNameTooLong"})(Ng||(Ng={}));Object(e.b)("CommonOperationResult",Ng);class Nh{constructor(Q,ya,gb,Ob,mc,dd,
Md,He,Ue,Sf,of,cj){this.fMg=Q;this.ga=ya;this.Zj=gb;this.MK=Ob;this.Yqb=mc;this.sZj=dd;this.w$a=Md;this.A4g=He;this.jSj=Ue;this.Q7a=Sf;this.Oa=of;this.iSj=cj}Vb(){H.AFrameworkApplication.ua&&H.AFrameworkApplication.ua.Sb.BI||this.zc.pa(Ra.a.p5b,uc.a.frame,Object(a.a)(this,this.p5b,"initializeRenameUIHandler"));this.zc.pa(Ra.a.Vec,uc.a.frame,Object(a.a)(this,this.Vec,"showRenameDisabledDialog"));this.zc.pa(Ra.a.renameFile,uc.a.frame,Object(a.a)(this,this.renameFile,"renameFile"));this.zc.gb(Ra.a.fileNameUpdate,
uc.a.frame,Object(a.a)(this,this.Fjn,"refreshFilename"),64);this.zc.gb(Ra.a.nVd,uc.a.frame,Object(a.a)(this,this.nVd,"moveToFolderCompleteByHost"),64);this.zc.pa(Ra.a.CFb,uc.a.frame,Object(a.a)(this,this.CFb,"moveToFolder"));H.AFrameworkApplication.ua&&(H.AFrameworkApplication.K.$("PostMessageEmbedded")||H.AFrameworkApplication.K.$("IsJsApi"))&&H.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.MoveRenameProcess",!0)&&H.AFrameworkApplication.bQ().execute(Q=>{Q.xv(Oe.a.qsi);
Q.cC(Oe.a.qsi,Nh.Bgn);Q.xv(Oe.a.P8e);Q.cC(Oe.a.P8e,Nh.zgn)})}q7b(){return 0===this.iSj.SXh()?32:8}qoo(){return this.Gp?this.w$a?this.Gp.sBh:this.Gp.kdb:!0}p5b(){return Ic.instance.initialize(H.AFrameworkApplication.sCd,H.AFrameworkApplication.kBh,H.AFrameworkApplication.tPi||CommonUIStrings.l_RenameFileTooltip)?32:8}Vec(){const Q=this.qoo(),ya=this.sZj();la.ULS.sendTraceTag(4059649,203,50,"ShowRenameDisabledDialog: userIsAnonymous = {0}, userCanRename = {1}, userCanRenameInCurrentSession = {2}, userCanRenameInCoauthSessionsWithRenameCapableUsers = {3}",
this.Yqb,ya,Q,this.w$a);H.AFrameworkApplication.ua&&H.AFrameworkApplication.ua.Sb.KA&&H.AFrameworkApplication.K.$("ReactRenameDisabledDialogIsEnabled")?new Hc(this.Yqb,!ya,!Q,this.w$a,this.Q7a()):new Ub(this.Yqb,!ya,!Q,this.w$a,this.Q7a());return 32}renameFile(Q,ya,gb,Ob,mc){if(1===gb)return this.q7b();if(!H.AFrameworkApplication.Syb)return 8;if(8===this.q7b())return this.zc.processAction(Ra.a.Vec,2),8;la.ULS.sendTraceTag(38114562,203,50,"RenameFileAttempt");H.AFrameworkApplication.Syb(mc,Object(a.a)(this,
this.STc,"onRenameFileSuccess"),Object(a.a)(this,this.dWm,"onRenameFileFailure"));return 32}STc(Q,ya){Q?0!==Q.OperationResult?this.M2h(Q.OperationResult):(this.vFn(ya,Q.NewName),this.ugo(Q,Object(a.a)(H.AFrameworkApplication.ua.Sb,H.AFrameworkApplication.ua.Sb.Khj,"updateOpenInClientDocumentUrl")),H.AFrameworkApplication.K.$("DocumentNameInJewelInfoMenuIsEnabled")&&H.AFrameworkApplication.ua.updateCommandUI(),this.jSj.Ifj()):this.M2h(5)}vFn(Q,ya){const gb={};gb[gf.a.b8k]=ya;Q.sendMessage(Oe.a.P8e,
gb)}ugo(Q,ya){this.Fgo(Q);H.AFrameworkApplication.yzd=Q.DirectInvokeDavUrl;ya=ya(Q.EditDocInClientUrl);const gb=new oe;gb.zDf=this.MK.Bz;gb.uPk=ya;gb.aLm=Q.EditDocInClientUrl;this.zc.Xb(Ra.a.uPi,2,gb)}M2h(Q){switch(Q){case 1:Q=new Ed.StandardDialog,Q.Fd=0,Q.vU(CommonUIStrings.l_RenameFileInvalidNameTitle,CommonUIStrings.l_RenameFileInvalidName,null),this.hSi()}}Fgo(Q){this.MK.Bz=Nh.Sbk(this.MK.Bz,Q.NewName);Q.BreadcrumbFolderName&&(this.MK.breadcrumbFolderName=Q.BreadcrumbFolderName);Q.BreadcrumbFolderUrl&&
(this.MK.breadcrumbFolderUrl=Q.BreadcrumbFolderUrl);this.A4g(Q.NewName)}dWm(Q){const ya=new Ed.StandardDialog;ya.Fd=0;switch(Q){case 1:la.ULS.sendTraceTag(38114563,203,50,"OnRenameFileFailure: InvalidFileName");ya.Sga(CommonUIStrings.l_RenameFileInvalidNameTitle,CommonUIStrings.l_RenameFileInvalidName,null);break;case 6:la.ULS.sendTraceTag(38114564,203,50,"OnRenameFileFailure: FileNameTooLong");ya.Sga(CommonUIStrings.l_RenameFileInvalidNameTitle,CommonUIStrings.l_RenameFileNameTooLong,null);break;
default:la.ULS.sendTraceTag(38114565,203,15,"OnRenameFileFailure: {0}",{["Result"]:Q}),ya.Sga(CommonUIStrings.l_RenameFileGenericErrorTitle,CommonUIStrings.l_RenameFileGenericError,null)}H.AFrameworkApplication.bQ().execute(gb=>{gb.sendMessage(Oe.a.a8k,{["FailureMessage"]:Ng[Q]})});this.hSi()}Fjn(Q,ya,gb){if(1===gb)return this.q7b();if(!H.AFrameworkApplication.LKa)return 8;H.AFrameworkApplication.LKa(Object(a.a)(this,this.S$b,"onRefreshFilenameSuccess"),Object(a.a)(this,this.fYd,"onRefreshFilenameFailure"),
!1);return 32}CFb(Q,ya,gb,Ob,mc){if(1===gb)return H.AFrameworkApplication.K.$("UiHostSupportsMoveToFolder")?32:8;if(2===gb){const dd={};Q=H.AFrameworkApplication.WDb;ya=H.AFrameworkApplication.K.$("UiHostSupportsDocRebootFeatures");Q=(!Q||Q&&ya)&&H.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CrossSiteMove",!1);dd[gf.a.f4n]=Q;mc&&mc.MoveButtonClickedTime&&(dd[gf.a.uJm]=mc.MoveButtonClickedTime.getTime());H.AFrameworkApplication.bQ().execute(Md=>{Md.sendMessage(Oe.a.CFb,
dd)});if(mc&&mc.MoveButtonClickedTime){if(Q=Ad.a.iF())mc=(new Date).getTime()-mc.MoveButtonClickedTime.getTime(),Q.set("MovePostDuration",mc.toString());Ha.Health.instance.recordKpiUsage("MoveToFolder",0,"smartfio",Q)}return 32}return 8}nVd(Q,ya,gb,Ob,mc){if(1===gb)return H.AFrameworkApplication.K.$("UiHostSupportsMoveToFolder")?this.q7b():8;if(2===gb){if(!H.AFrameworkApplication.MZc)return Ha.Health.instance.recordKpiFailure("MoveToFolder","Null SendFileNameAndLocationUpdateNotification",!1,!1,null),
8;if(!mc)return Ha.Health.instance.recordKpiFailure("MoveToFolder","Null actiondata",!1,!1,null),8;if(mc[gf.a.Ram])if(mc[gf.a.ljj])if(Q=mc[gf.a.ljj].toLowerCase(),ya=H.AFrameworkApplication.K.$("UiHostSupportsDocRebootFeatures"),gb=H.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CrossSiteMove",!1),ya&&H.AFrameworkApplication.WDb&&gb){const dd={};dd[gf.a.Vbc]="1";dd[gf.a.documentUrl]=Q;dd[gf.a.reason]=Sg.a.LVf;Ha.Health.instance.recordKpiSuccess("MoveToFolder",null);
H.AFrameworkApplication.bQ().execute(Md=>{Md.sendMessage(Oe.a.ryb,dd)})}else if(!H.AFrameworkApplication.WDb&&gb)Ha.Health.instance.recordKpiSuccess("MoveToFolder",null),ra.a.Cm(Q,ra.a.Ioa(3),void 0,"RenameActor.MoveToFolderCompleteByHost");else return Ha.Health.instance.recordKpiFailure("MoveToFolder","CrossSite Unsupported",!1,!1,null),8;else Ha.Health.instance.recordKpiFailure("MoveToFolder","Null newDocUrl",!1,!1,null);else H.AFrameworkApplication.LKa(Object(a.a)(this,this.S$b,"onRefreshFilenameSuccess"),
Object(a.a)(this,this.fYd,"onRefreshFilenameFailure"),!1),H.AFrameworkApplication.MZc(),Ha.Health.instance.recordKpiSuccess("MoveToFolder",null)}return 32}HVn(Q,ya){return Q&&ya?Q!==this.MK.breadcrumbFolderName||ya!==this.MK.breadcrumbFolderUrl:!1}S$b(Q,ya){Q&&(Q.NewName!==Tb.a.qI(this.MK.Bz)||this.HVn(Q.BreadcrumbFolderName,Q.BreadcrumbFolderUrl))&&this.STc(Q,ya)}fYd(){}hSi(){this.A4g(Tb.a.qI(this.MK.Bz))}get zc(){return this.ga.value}get Gp(){return this.Zj.value}static get instance(){return Nh._instance||
(Nh._instance=Nh.Gzb())}static Gzb(){return new Nh(H.AFrameworkApplication.$Oc,new jb.a(()=>H.AFrameworkApplication.ya),new jb.a(()=>H.AFrameworkApplication.Gp),H.AFrameworkApplication.zt,H.AFrameworkApplication.Ama,()=>H.AFrameworkApplication.M9f,H.AFrameworkApplication.fYc,Object(a.a)(Ic.instance,Ic.instance.whc,"updateTitle"),qa.a.instance.resolve("Common.App.Rename.IRenamedFileChecker"),()=>H.AFrameworkApplication.Iu,H.AFrameworkApplication.K,qa.a.instance.resolve("Common.IRenameProps"))}static Sbk(Q,
ya){Q=Tb.a.rLa(Q);return ya+Q}static Bgn(Q){const ya=Q.Values[gf.a.sgm];la.ULS.sendTraceTag(560820289,204,50,"Host_MoveToFolder Received IsSuccessful: {0}",ya);ya?H.AFrameworkApplication.ya.Xb(Ra.a.nVd,2,Q.Values):Ha.Health.instance.recordKpiFailure("MoveToFolder","MoveToFolder Server Failure",!1,!1,null)}static zgn(Q){H.AFrameworkApplication.ya.Xb(Ra.a.renameFile,2,Q.Values.NewName)}}Nh._instance=null;Object(e.a)(Nh,"RenameActor",null,[]);var Eg=d(125),Wh=d(1364),Bf=d(537),vf=d(390);class Fj{constructor(Q,
ya){this.ga=Q;this.hmc=ya}Vb(){this.ga.pa(Ra.a.S0f,uc.a.frame,Object(a.a)(this,this.vYn,"showRenameDialogAction"))}vYn(Q,ya,gb){Q=32;if(1===gb)return vf.SessionStatusManager.instance.Sj||H.AFrameworkApplication.fma?8:32;2===gb&&(32!==this.ga.processAction(Ra.a.renameFile,1)?(this.ga.processAction(Ra.a.Vec,2),Eg.a.instance.Zb(Wh.a.Ska,{["Reason"]:Bf.a.ysn}),Q=8):32===this.ga.processAction(Ra.a.Wec,1)?this.ga.processAction(Ra.a.Wec,2):this.hmc.value.create().KPa());return Q}}Object(e.a)(Fj,"RenameDialogActor",
null,[2007]);class Pe{constructor(Q,ya,gb){this.dialog=null;this.ga=Q;this.MK=ya;this.Y6a=gb}lGl(){const Q={};Q.nameInputProps={["type"]:"AppInputProps",["id"]:Pe.s0b,["label"]:CommonUIStrings.l_RenameDialogLabel,["value"]:Tb.a.qI(this.MK.Bz),["maxLength"]:this.Y6a};return Q}KPa(){const Q={["id"]:"RenameDialog",["bodyControls"]:this.lGl()};this.dialog=new sc.a(!1,!1,!0);this.dialog.Fd=1;this.dialog.kg="RenameDialog";this.dialog.Wh(CommonUIStrings.l_RenameDialogTitle,Object(a.a)(this,this.RSf,"renameDialogHandler"),
Q)}RSf(Q,ya){if(ya&&1===Q){if(ya[Pe.s0b]&&(Q=Tb.a.qI(this.MK.Bz),ya=(ya[Pe.s0b]||"").trim(),ya!==Q&&""!==ya)){this.ga.Xb(Ra.a.renameFile,2,ya);return}Eg.a.instance.Zb(Wh.a.o0b,{["Reason"]:Bf.a.aHh})}}}Pe.s0b="txtDocumentName";Object(e.a)(Pe,"ReactRenameDialog",null,[2012]);class sf{static get vg(){return sc.a.Px(sf.sl,CommonUIStrings.l_RenameDialogLabel)}}sf.sl="<div class='WACDialogRow' id='DocumentNameBlock'> <label id='lblDocumentName' class='WACDialogLabel' for='txtDocumentName' >{0}</label> <input type='text' id='txtDocumentName' class='WACDialogInput' autocomplete=\"off\"/> </div>";
Object(e.a)(sf,"RenameDialogHtml",null,[]);class Xf extends sc.a{constructor(Q,ya,gb){super();this.ga=Q;this.MK=ya;this.Y6a=gb;this.kg="RenameDialog";this.vg=sf.vg}KPa(){var Q={["txtDocumentName"]:Tb.a.qI(this.MK.Bz)};this.Wh(CommonUIStrings.l_RenameDialogTitle,Object(a.a)(this,this.RSf,"renameDialogHandler"),Q);Q=document.getElementById(Xf.s0b);0<this.Y6a&&(Q.maxLength=this.Y6a);Q.focus()}RSf(Q,ya){if(1===Q&&(Q=Tb.a.qI(this.MK.Bz),ya=(ya[Xf.s0b]||"").trim(),ya!==Q&&""!==ya)){this.ga.Xb(Ra.a.renameFile,
2,ya);return}Eg.a.instance.Zb(Wh.a.o0b,{["Reason"]:Bf.a.aHh})}}Xf.s0b="txtDocumentName";Object(e.a)(Xf,"RenameDialog",sc.a,[2012]);class Se{constructor(Q){this.yGa=null;this.Y6a=0;this.ga=Q;this._initialized=!1}initialize(Q,ya){this.yGa=Q;this.Y6a=ya;this._initialized=!0}create(){return this._initialized?H.AFrameworkApplication.ua&&H.AFrameworkApplication.ua.Sb.KA&&H.AFrameworkApplication.K.$("ReactRenameDialogIsEnabled")?new Pe(this.ga,this.yGa,this.Y6a):new Xf(this.ga,this.yGa,this.Y6a):null}}Object(e.a)(Se,
"RenameDialogFactory",null,[2005]);var $f=d(159),Jg=d(158),fg=d(82);class Lg{constructor(Q,ya){this.ga=Q;this.Wb=ya}Vb(){this.ga.pa(Ra.a.Wec,uc.a.frame,Object(a.a)(this,this.wYn,"showRenameFlyoutAction"))}mrk(){return Jg.d("setDocumentTitleFlyoutOpened")&&H.AFrameworkApplication.ua.Sb.BI}wYn(Q,ya,gb){if(1===gb)return this.mrk()?32:8;appChrome.api.dispatch(appChrome.actions.setDocumentTitleFlyoutOpened(!0));return 32}c5j(){Lg.Bkm&&H.AFrameworkApplication.B2&&fg.a.instance.$b(new dc.a(5,1,5E3,()=>{32===
this.ga.processAction(Ra.a.Wec,1)&&this.Wb&&this.Wb.og.name===$f.AFrame.Zp&&(Ie.a("RenameFloatieShownOnNewDocumentLoad",!0),this.ga.processAction(Ra.a.Wec,2))}))}static get Bkm(){Lg.led&&null!=Lg.led||(H.AFrameworkApplication.Hf("ShowRenameFlyoutOnNewDocumentLoad;ShowRenameFlyoutOnNewDocumentLoadCf"),Lg.led=H.AFrameworkApplication.K?H.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ShowRenameFlyoutOnNewDocumentLoadIsEnabled",!1):!1);return Lg.led}}Lg.led=null;Object(e.a)(Lg,
"RenameFlyoutActor",null,[2008]);class Af{constructor(Q,ya,gb,Ob,mc){this.Myk=null;this.Zj=mc;this.gMg=gb;this.fMg=Ob;this.uZj=Q;this.Q7a=ya}get Gp(){return this.Zj.value}SXh(){if(!this.fMg())return 5;if(this.Q7a())return 1;if(this.Gp){if(this.gMg&&!this.Gp.sBh)return 3;if(!this.gMg&&!this.Gp.kdb)return 4}return this.uZj()?0:2}}Object(e.a)(Af,"RenameProps",null,[2006]);class Jh{constructor(Q,ya,gb,Ob,mc,dd){this.Pl=!1;this.ixe=new mb.a;this.JPb=ya;this.uy=gb;this.yOb=Ob;this.Oa=mc;this.eja=dd}enable(){this.Pl||
(this.Ifj(),this.y2f(),this.Pl=!0)}generateKey(Q,ya,gb){return String.format("{0}/{1}/{2}",gb,Q,ya)}Awl(){const Q=Tb.a.qI(this.JPb().Bz);return this.generateKey(this.JPb().breadcrumbFolderName,this.JPb().breadcrumbFolderUrl,Q)}Bwl(Q,ya,gb){return Q&&ya?this.generateKey(Q,ya,gb):gb}eWk(Q,ya,gb){return Q&&Q!==this.JPb().breadcrumbFolderName||ya&&ya!==this.JPb().breadcrumbFolderUrl?!0:gb!==Tb.a.qI(this.JPb().Bz)}Ifj(){const Q=this.Awl();this.ixe.Z(Q,new Date)}oLf(Q){this.UTn(Q)&&this.K6g(Q)}UTn(Q){const ya=
this.yOb();return ya?this.eja&&this.eja.io||!ya.Fqf||!H.AFrameworkApplication.LKa?(this.x8i(Q),this.Pl=!1):!0:!1}tAi(Q,ya,gb,Ob){const mc=this.eWk(Q,ya,gb);Q=this.Bwl(Q,ya,gb);ya=this.ixe.Dc(Q).returnValue;mc&&!ya&&(this.O2h(Ob),la.ULS.sendTraceTag(591734297,203,50,"{0} forced FileNameUpdate",this.Mxf));mc||this.ixe.Z(Q,this.uy())}}Object(e.a)(Jh,"ARenamedFileChecker",null,[1983]);class Vi extends Jh{constructor(Q,ya,gb,Ob,mc,dd,Md,He){super(Q,ya,gb,Ob,mc,dd);this.EJ=mc;this.hSj=Md;this.ase=He}get Mxf(){return"RenamedFileCheckerUsingSettingsRefresh"}y2f(){this.EJ.qyc(Object(a.a)(this,
this.g3h,"handleSettingsRefresh"))}g3h(Q,ya){ya&&ya.LFb&&ya.svi&&(ya.KMa("BreadcrumbDocName")||ya.KMa("BreadcrumbFolderName")||ya.KMa("BreadcrumbFolderUrl")||ya.KMa("DirectInvokeDAVUrl")||ya.KMa("EditDocInClientUrl"))&&(la.ULS.sendTraceTag(591229211,203,50,"{0}: Possible rename detected.",this.Mxf),this.oLf(ya))}x8i(){this.EJ.kPi(Object(a.a)(this,this.g3h,"handleSettingsRefresh"))}K6g(Q){if(Q&&Q.LFb){const ya=Q.LFb;this.tAi(ya.lb("BreadcrumbFolderName"),ya.lb("BreadcrumbFolderUrl"),ya.lb("BreadcrumbDocName"),
Q)}}O2h(Q){const ya={OperationResult:0,classId:1};Q=Q.LFb;ya.BreadcrumbFolderName=Q.lb("BreadcrumbFolderName");ya.BreadcrumbFolderUrl=Q.lb("BreadcrumbFolderUrl");ya.DirectInvokeDavUrl=Q.lb("DirectInvokeDAVUrl");ya.EditDocInClientUrl=Q.lb("EditDocInClientUrl");Q=Q.lb("BreadcrumbDocName");ya.NewName=H.AFrameworkApplication.vEc?Q:Tb.a.qI(Q);this.ase.execute(gb=>{this.B8l(ya,gb)})}B8l(Q,ya){this.hSj().STc(Q,ya)}}Object(e.a)(Vi,"RenamedFileCheckerUsingSettingsRefresh",Jh,[]);class Ze extends Jh{constructor(Q,
ya,gb,Ob,mc,dd,Md,He,Ue,Sf){super(Q,gb,Ob,mc,dd,Ue);this.nuc=this.Nn=null;this.zQj=ya;this.ga=Md;this.Hb=He;Sf&&Sf.execute(of=>{this.Nnn(of)})}get Mxf(){return"RenamedFileCheckerUsingTask"}Nnn(Q){this.Nn=Q;this.Nn.mvb(Object(a.a)(this,this.w$,"handleVisibilityChange"))}w$(Q,ya){!this.Pl||0!==ya.newState&&1!==ya.newState||this.nuc||(this.y2f(),this.oLf(this.nuc))}y2f(){this.nuc=new dc.a(3,2,this.zQj(),Object(a.a)(this,this.oLf,"performRenameFileCheckTick"),89);this.Hb.$b(this.nuc)}x8i(Q){this.Hb.We(Q)}K6g(Q){this.Nn&&
2===this.Nn.$D?this.Cpn(Q):H.AFrameworkApplication.LKa(Object(a.a)(this,this.S$b,"onRefreshFilenameSuccess"),Object(a.a)(this,this.fYd,"onRefreshFilenameFailure"),!0)}Cpn(Q){this.Hb.We(Q);this.nuc=null}S$b(Q){Q&&this.tAi(Q.BreadcrumbFolderName,Q.BreadcrumbFolderUrl,Q.NewName,null)}O2h(){this.ga.processAction(Ra.a.fileNameUpdate,2)}fYd(){}}Object(e.a)(Ze,"RenamedFileCheckerUsingTask",Jh,[]);var sd=d(56);class fh{constructor(){this.Oa=this.W=null}get name(){return"Common.App.RenameFile"}yc(Q){this.W=
Q;this.Oa=H.AFrameworkApplication.K;this.W.register(Fj,"Common.App.Rename.RenameDialogActor").as("Common.App.Rename.IRenameDialogActor").Yd(()=>new Fj(H.AFrameworkApplication.ya,this.W.ef("Common.App.Rename.IRenameDialogFactory"))).singleInstance();this.W.register(Se,"Common.App.Rename.RenameDialogFactory").as("Common.App.Rename.IRenameDialogFactory").Yd(()=>new Se(H.AFrameworkApplication.ya)).singleInstance();this.W.register(1983,"Common.App.Rename.IRenamedFileChecker").Yd(()=>this.PMk()).singleInstance();
this.W.register(Lg,"Common.App.Rename.RenameFlyoutActor").as("Common.App.Rename.IRenameFlyoutActor").Yd(()=>new Lg(H.AFrameworkApplication.ya,sd.FocusManager.instance())).singleInstance()}PMk(){if(this.Oa.$("RenamedFileCheckerWithSettingsRefreshIsEnabled")){const Q=this.W.Pa("Common.IRefreshableAppSettings");if(Q&&Q.vgi)return new Vi(()=>Q.rc("RenamedFileCheckerMaxCachedAgeInMs",48E4),()=>H.AFrameworkApplication.zt,()=>new Date,()=>H.AFrameworkApplication.Gp,Q,this.W.Pa("Common.ISessionStatus"),()=>
Nh.instance,this.W.Za("Postmessage.IHostPostmessenger"))}return new Ze(()=>this.Oa.rc("RenamedFileCheckerMaxCachedAgeInMs",48E4),()=>this.Oa.rc("RenamedFileCheckerPingIntervalInMs",12E4),()=>H.AFrameworkApplication.zt,()=>new Date,()=>H.AFrameworkApplication.Gp,H.AFrameworkApplication.K,H.AFrameworkApplication.ya,H.AFrameworkApplication.uc,this.W.Pa("Common.ISessionStatus"),this.W.Za("Common.App.VisibilityManagement.IVisibilityManager"))}init(){this.Oa.zq(Object(a.a)(this,this.ax,"onFullAppSettingsReady"))}ax(){const Q=
H.AFrameworkApplication.ua.Sb.BI;H.AFrameworkApplication.$Oc()&&Ic.instance.initialize(H.AFrameworkApplication.sCd,Q?null:H.AFrameworkApplication.kBh,Q?null:H.AFrameworkApplication.tPi||CommonUIStrings.l_RenameFileTooltip)&&(this.W.register(Af,"Common.App.Rename.RenameProps").as("Common.IRenameProps").Yd(()=>new Af(()=>H.AFrameworkApplication.M9f,()=>H.AFrameworkApplication.Iu,H.AFrameworkApplication.fYc,H.AFrameworkApplication.$Oc,new jb.a(()=>H.AFrameworkApplication.Gp))).singleInstance(),Nh.instance.Vb(),
this.Oa.$("RenameDialogIsEnabled")&&(this.W.resolve("Common.App.Rename.RenameDialogFactory").initialize(H.AFrameworkApplication.zt,H.AFrameworkApplication.sCd),this.W.resolve("Common.App.Rename.IRenameDialogActor").Vb()),this.W.resolve("Common.App.Rename.IRenameFlyoutActor").Vb(),H.AFrameworkApplication.fYc&&this.W.resolve("Common.App.Rename.IRenamedFileChecker").enable(),this.W.resolve("Common.App.Rename.IRenameFlyoutActor").c5j())}dispose(){}}Object(e.a)(fh,"PackageManager",null,[1,2]);class vh{static get vg(){return sc.a.Px(vh.sl,
CommonUIStrings.l_SaveACopyFileName)}}vh.sl="<div class='WACDialogRow' id='DocumentFolderBlock'> <label id='lblFolderName' class='WACDialogLabel' >{0}</label> </div> <div class='WACDialogRow' id='DocumentNameBlock'> <label id='lblFileName' class='WACDialogLabel' for='txtFileName' >{0}</label> <input type='text' id='txtFileName' class='WACDialogInput' autocomplete=\"off\"/> </div>";Object(e.a)(vh,"FileNameDialogHtml",null,[]);class am extends sc.a{constructor(Q,ya,gb,Ob){super();this.Iad=this.VGa=
null;this.ga=Q;this.Poa=ya;this.exc=gb;this.Ve(1,CommonUIStrings.l_SaveButtonLabel);this.vg=vh.vg;this.kg="FileNameDialog-SaveACopy";this.Km=Ob}qAa(Q,ya,gb){this.Iad=Q;this.VGa=gb;Q={["txtFileName"]:Tb.a.qI(H.AFrameworkApplication.zt.Bz),["lblFolderName"]:String.format(CommonUIStrings.l_DestinationFolder,ya)};this.Wh(CommonUIStrings.l_SaveToOneDrive,Object(a.a)(this,this.rCd,"fileNameDialogHandler"),Q);la.ULS.sendTraceTag(7174148,216,50,"The file name dialog is initialized and shown.");document.getElementById("txtFileName").focus()}rCd(Q,
ya){1!==Q?la.ULS.sendTraceTag(7165650,216,50,"User click cancel to cancel upload file in file name dialog."):(Q=ya.txtFileName.trim(),la.ULS.sendTraceTag(7165651,216,50,"User click save to upload file with new name."),ya=Tb.a.rLa(H.AFrameworkApplication.fileName),Q&&""!==Q&&""!==ya&&(Q+=ya),this.exc.BEa(this.Iad,this.VGa,Q,this.Km))}}Object(e.a)(am,"FileNameDialog",sc.a,[2004]);class aj{constructor(Q,ya,gb){this.ga=Q;this.Poa=ya;this.exc=gb}create(Q){return new am(this.ga,this.Poa,this.exc,Q)}}Object(e.a)(aj,
"FileNameDialogFactory",null,[1982]);class nk extends Ed.StandardDialog{constructor(Q){super();this.Fd=1;this.Ve(1,CommonUIStrings.l_RetryButtonLabel);this.Ve(0,CommonUIStrings.l_DialogClose);this.ga=Q}MS(Q){la.ULS.sendTraceTag(7165652,216,50,"Show error dialog here {0}.",Q);this.jy(Q,CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_ErrorSavingToOneDrive,Object(a.a)(this,this.NUf,"retryDialogHandler"))}NUf(Q){1===Q?(la.ULS.sendTraceTag(7165653,216,50,"User click to retry the action."),this.ga.processAction(Ra.a.gdc,
2)):la.ULS.sendTraceTag(7165654,216,50,"User cancel the error dialog.")}}Object(e.a)(nk,"RetryDialog",Ed.StandardDialog,[1979]);var sk=d(224);class De{constructor(Q,ya,gb,Ob){this.skd=null;this.yTj=Q;this.Oa=gb;this.VTg=ya;this.$Og=new t.a;this.le=Ob}S7b(){return this.Oa.$("SaveToCloudStorageUIIsEnabled")}hdb(){return Ra.a.TVf}Atd(){hc.a.pXc(Object(a.a)(this,this.GUi,"saveToCloudActionDispatcher"));hc.a.iFc([new sk.a(Ra.a.TVf,uc.a.frame,0)],this.VTg.i3b())}Vb(){const Q=this.VTg.i3b();Q?(Q.VV(()=>
{this.$Og.Gg(!0)}),this.Atd()):la.ULS.sendTraceTag(6590596,216,15,"Failure with OneDrive API download as the onedrive url received is empty ")}IKi(){la.ULS.sendTraceTag(6590597,216,50,"User clicked on SaveToOneDrive button")}GUi(Q,ya,gb,Ob,mc){return ya.contextId!==uc.a.frame||Q!==this.hdb()?2:this.S7b()?1===gb?vf.SessionStatusManager.instance.Sj||H.AFrameworkApplication.fma?8:32:2===gb?(this.IKi(),mc&&mc.FileDownloadUrl&&la.ULS.sendTraceTag(50708835,216,50,"SaveToCloudStorageActor FileDownloadUrl is there"),
this.le&&(this.skd=this.le.hg("DialogShown","SaveToOneDriveReponseTime")),this.$Og.task.continueWith(()=>{this.skd&&(this.skd.stop(),this.skd=null);this.yTj.start(mc)}),32):8:8}}Object(e.a)(De,"SaveToCloudStorageActor",null,[1976]);class Ai extends De{constructor(Q,ya,gb,Ob){super(Q,ya,gb,Ob);this.ZOj=ya}S7b(){return this.Oa.$("SaveACopyBrsIsEnabled")}hdb(){return Ra.a.gdc}Atd(){hc.a.pXc(Object(a.a)(this,this.GUi,"saveToCloudActionDispatcher"));hc.a.iFc([new sk.a(Ra.a.gdc,uc.a.frame,0)],this.ZOj.i3b())}IKi(){la.ULS.sendTraceTag(7205456,
216,50,"User clicked on SaveAs button from the backstage.")}}Object(e.a)(Ai,"SaveACopyActor",De,[]);class Mk{}Mk.default=0;Object(e.a)(Mk,"SaveToCloudErrorCodes",null,[]);class pl{constructor(Q,ya,gb,Ob,mc,dd){this.Km=null;this.tVj=Q;this.Jqa=ya;this.exc=gb;this.Oa=Ob;this.S6c=mc;this.pG=dd}start(Q){this.Km=Q;if("SharePointOnlineConsumer"===this.Oa.lb("FileSource")){const ya=qa.a.instance.resolve("Common.App.SaveToSharePoint.ISaveToSharePointManager");if(ya){ya.start(null,Q);return}}this.Jqa.dNc?
(la.ULS.sendTraceTag(6590559,216,50,"User is signed in. We will show file picker."),this.kqk()):(la.ULS.sendTraceTag(6590560,216,50,"User is not signed in. We will show sign in dialog."),this.FYn())}FYn(){this.tVj.create().qAa()}xp(){this.pG().MS(Mk.default)}kqk(){try{la.ULS.sendTraceTag(6590561,216,50,"Initializing OneDrive API");let Q={["client_id"]:this.Oa.appSettings.UploadToSkyDriveClientId,["env"]:"INT"};if(1===this.S6c||2===this.S6c)Q={["client_id"]:this.Oa.appSettings.UploadToSkyDriveClientId};
WL.init(Q);la.ULS.sendTraceTag(6590562,216,50,"OneDrive API is initialized. Launching file dialogue");WL.fileDialog({["mode"]:"save",["lightbox"]:"grey"}).then(Object(a.a)(this,this.onSuccess,"onSuccess"),Object(a.a)(this,this.onFailure,"onFailure"))}catch(Q){la.ULS.sendTraceTag(6590563,216,10,"OneDrive API Failure. [Exception:{0}] [Stack:{1}]",Q,Q.stack),this.xp()}}onSuccess(Q){la.ULS.sendTraceTag(6590592,216,50,"Success Callback called. Calling UploadToCloudManger to start upload.");Q&&Q.data&&
Q.data.folders&&this.exc.BEa(Q.data.folders[0].id,Q.data.folders[0].urls.viewInBrowser,null,this.Km)}onFailure(Q){if(Q&&Q.error){if("user_canceled"===Q.error.code){la.ULS.sendTraceTag(6590593,216,50,"User cancelled upload to their OneDrive.");return}la.ULS.sendTraceTag(6590594,216,50,"File Dialog returned with error code:{0}, and error message: {1}",Q.error.code,Q.error.message)}else la.ULS.sendTraceTag(6590595,216,50,"File Dialog returned with no response");this.xp()}}Object(e.a)(pl,"SaveToCloudManager",
null,[1974]);class Og extends pl{constructor(Q,ya,gb,Ob,mc,dd,Md){super(ya,gb,Ob,mc,dd,Md);this.oDj=Q}onSuccess(Q){Q&&Q.data&&Q.data.folders?(la.ULS.sendTraceTag(7165655,216,50,"User selected which folder to upload file to."),this.oDj.create(this.Km).qAa(Q.data.folders[0].id,Q.data.folders[0].name,Q.data.folders[0].urls.viewInBrowser)):(la.ULS.sendTraceTag(7165656,216,10,"Fail to select folder to upload file."),this.xp())}onFailure(Q){Q&&Q.error&&"user_canceled"===Q.error.code&&la.ULS.sendTraceTag(7205457,
216,50,"User cancelled upload to their OneDrive in Save A Copy.");super.onFailure(Q)}xp(){la.ULS.sendTraceTag(7205458,216,50,"Error occur in Save A Copy Manager.");super.xp()}}Object(e.a)(Og,"SaveACopyManager",pl,[]);var Rk=d(185);class xf{constructor(Q,ya,gb,Ob,mc){this.VGa=this.Pk=this.okc=null;this.xY=!1;this.Km=this.WUa=null;this.NLe=Q;this.LTa=ya;this.pG=gb;this.zi=Ob;this.le=mc}b3a(){this.zi&&1===this.zi.state||(this.Pk=this.LTa(),this.Pk.message=CommonUIStrings.l_CommentProgressTooltip,this.Pk.Fd=
5,this.Pk.Bt=!1,this.Pk.qM(CommonUIStrings.l_DefaultDialogTitle,null,null))}Dka(){this.Pk&&(this.Pk.close(),this.Pk=null)}z3(){1!==H.AFrameworkApplication.ua.state&&this.pG().MS(Mk.default)}kIb(){la.ULS.sendTraceTag(6590599,216,50,"Redirecting to OneDrive Folder.");ra.a.Cm(this.VGa,ra.a.Ioa(3),void 0,"UploadToCloudManager.RedirectToFolder")}jIb(Q){let ya=!1,gb=!1;H.AFrameworkApplication.K&&(ya=H.AFrameworkApplication.K.$("SaveACopyIsEnabledForUiHost"),gb=H.AFrameworkApplication.K.$("UiHostSupportsDocRebootFeatures"));
la.ULS.sendTraceTag(6654163,216,50,"Redirecting to edit url {0}. IsEnabledForUiHost {1}",Q,ya);if(ya&&gb){la.ULS.sendTraceTag(594929733,216,50,"UploadToCloudManager.RedirectToEditUrl: Sending DocumentRefresh post message.");const Ob={};Ob[gf.a.Vbc]="1";Ob[gf.a.documentUrl]=Q;H.AFrameworkApplication.bQ().execute(mc=>{mc.sendMessage(Oe.a.ryb,Ob)})}else ra.a.Cm(Q,ra.a.Ioa(3),void 0,"UploadToCloudManager.RedirectToEditUrl")}BEa(Q,ya,gb=null,Ob=null){la.ULS.sendTraceTag(7143886,216,50,"Starting to upload file");
this.le&&(this.WUa=this.le.hg("DialogShown","SaveToOneDriveUploadTime"));this.b3a();this.VGa=ya;this.okc=this.NLe.create(Q,gb,Ob);this.Km=Ob;this.gea()}gea(){la.ULS.sendTraceTag(6590600,216,50,"Calling SkydriveUploadHandler.");this.okc.execute(Object(a.a)(this,this.QWm,"onSaveToCloudUploadFinished"),Object(a.a)(this,this.PWm,"onSaveToCloudUploadFailed"))}QWm(Q){this.Dka();this.xY=!1;if(Q&&Q.data&&Q.data.Ge){var ya;if(({Fv:ya}=Ka.d(Q.data.Ge)).returnValue)if(Q=ya,Q.StatusCode!==Rk.a.xD&&Q.StatusCode!==
Rk.a.bDc)la.ULS.sendTraceTag(6590602,216,10,"UploadToCloudManager upload failure. Response data is not JSON."),this.z3();else{la.ULS.sendTraceTag(6590603,216,50,"UploadToCloudManager upload success.");try{Q.NewDocumentUrl&&""!==Q.NewDocumentUrl?this.jIb(Q.NewDocumentUrl):this.kIb()}catch(gb){la.ULS.sendTraceTag(37025728,216,15,"Redirect failed with exception: {0}",gb.toString())}this.XUc()}else la.ULS.sendTraceTag(7660114,216,10,"Failed to deserialize : {0}",{["ResponseData"]:Eb.a.X2c(Q.data.Ge)}),
this.z3()}else la.ULS.sendTraceTag(6590601,216,10,"UploadToCloudManager upload failure. Response data is null"),this.z3()}PWm(Q){5!==Q.data.status&&12!==Q.data.status||this.xY?(la.ULS.sendTraceTag(6590605,216,10,"UploadToCloudManager HTTP failure with code: {0}",Q.data.status),this.Dka(),this.z3(),this.XUc()):(la.ULS.sendTraceTag(6590604,216,10,"UploadToCloudManager failure. Retrying."),this.xY=!0,this.gea())}XUc(){this.WUa&&(this.WUa.stop(),this.WUa=null)}}Object(e.a)(xf,"UploadToCloudManager",null,
[1978]);class Ql extends xf{constructor(Q,ya,gb,Ob,mc,dd){super(ya,gb,Ob,mc,dd);this.ga=Q}ptf(){return!!this.Km&&!!this.Km.SaveEntryPoint&&"VersionHistory"===this.Km.SaveEntryPoint.toString()}z3(){la.ULS.sendTraceTag(7205459,216,50,"Display Error for Save A Copy.");this.ptf()&&this.ga.Xb(Ra.a.p4d,2,{["FailureReason"]:"Unknown"});super.z3()}kIb(){la.ULS.sendTraceTag(7205460,216,50,"Redirecting to OneDrive Folder for Save A Copy.");this.ptf()&&this.ga.processAction(Ra.a.AYc,2);super.kIb()}jIb(Q){la.ULS.sendTraceTag(7205461,
216,50,"Redirecting to edit url {0} for Save A Copy.",Q);this.ptf()&&this.ga.processAction(Ra.a.AYc,2);super.jIb(Q)}gea(){this.Km&&"true"===this.Km.SkipSaveToHost?super.gea():32!==this.ga.processAction(Ra.a.eJb,1)?(la.ULS.sendTraceTag(8741711,216,15,"The save file change is not supported, this operation may result in data loss"),super.gea()):this.ga.Xb(Ra.a.eJb,2,[()=>{la.ULS.sendTraceTag(8741712,216,50,"Call the force save file change successfully.");xf.prototype.gea.call(this)},()=>{la.ULS.sendTraceTag(8741713,
216,15,"The file change is not saved successfully, this operation may lead to data loss.");this.z3()}])}}Object(e.a)(Ql,"SaveACopyUploadToCloudManager",xf,[]);var yd=d(744),Zk=d(1183);class Kl{constructor(){this.W=null}get name(){return"Common.App.SaveACopy"}init(){H.AFrameworkApplication.K.zq(Object(a.a)(this,this.ax,"onFullAppSettingsReady"))}ax(){H.AFrameworkApplication.K.$("SaveACopyBrsIsEnabled")&&this.W.resolve("Common.App.SaveACopy.SaveACopyActor").Vb()}dispose(){}yc(Q){this.W=Q;this.W.register(Ql,
"Common.App.SaveACopy.SaveACopyUploadToCloudManager").Yd(()=>new Ql(H.AFrameworkApplication.ya,Q.resolve("Common.App.SaveToCloudStorage.SkydriveUploadCallerFactory"),()=>(new Zk.a).create(),()=>new nk(H.AFrameworkApplication.ya),H.AFrameworkApplication.ua,H.AFrameworkApplication.ua.jq)).singleInstance();this.W.register(aj,"Common.App.SaveACopy.FileNameDialogFactory").as("Common.App.SaveACopy.IFileNameDialogFactory").Yd(()=>new aj(H.AFrameworkApplication.ya,H.AFrameworkApplication.ua.Sb,Q.resolve("Common.App.SaveACopy.SaveACopyUploadToCloudManager"))).singleInstance();
this.W.register(Ai,"Common.App.SaveACopy.SaveACopyActor").Yd(()=>new Ai(Q.resolve("Common.App.SaveACopy.SaveACopyManager"),Q.resolve("Common.App.OneDriveFilePickerApi.IOneDriveFilePickerApiManager"),H.AFrameworkApplication.K,H.AFrameworkApplication.ua.jq)).singleInstance();this.W.register(Og,"Common.App.SaveACopy.SaveACopyManager").Yd(()=>new Og(Q.resolve("Common.App.SaveACopy.FileNameDialogFactory"),Q.resolve("Common.App.SaveToCloudStorage.SignInDialogFactory"),yd.a.instance,Q.resolve("Common.App.SaveACopy.SaveACopyUploadToCloudManager"),
H.AFrameworkApplication.K,H.AFrameworkApplication.eea,()=>new nk(H.AFrameworkApplication.ya))).singleInstance()}static main(){ca.a.instance.Oc(new Kl)}}Object(e.a)(Kl,"PackageManager",null,[1,2]);var tk=d(41);class $k extends Ed.StandardDialog{constructor(Q,ya){super();this.aTb=!1;this.RM=null;this.ga=Q;this.lnc=ya;this.tEa=!1}MS(Q,ya,gb){this.RM=ya;this.aTb=gb;la.ULS.sendTraceTag(8194008,216,50,"Display error with code:{0}, overwriteTarget:{1}.",Q,gb);Q=this.qWe(Q);0===Q?(this.Fd=6,this.Ve(0,CommonUIStrings.l_DialogClose)):
(this.Fd=0,this.Ve(1,CommonUIStrings.l_DialogClose));0===Q&&la.ULS.sendTraceTag(8194009,216,50,"Show standard error dialog.");this.jy(tk.a.wBn,this.Ipl(Q),this.Hpl(Q,ya),Object(a.a)(this,this.NUf,"retryDialogHandler"),!0)}NUf(Q){1===Q?(la.ULS.sendTraceTag(8194010,216,50,"User click to retry button in error dialog."),this.RM?this.ga.Xb(Ra.a.qZc,2,[this.RM,this.aTb]):this.ga.processAction(Ra.a.qZc,2)):la.ULS.sendTraceTag(8194011,216,50,"User cancel the error dialog.")}qWe(Q){return 0>Q||6<Q?(la.ULS.sendTraceTag(8194012,
216,15,"Unexpected error code {0}.",Q),0):Q}Hpl(Q,ya){Q=this.qWe(Q);return this.lnc?[CommonUIStrings.l_FailToSaveFile,CommonUIStrings.l_InvalidFileNameAllowPercentOctothorpe,CommonUIStrings.l_EmptyNameText,CommonUIStrings.l_InvalidPermissionText,String.format(CommonUIStrings.l_OverwriteTargetText,ya),CommonUIStrings.l_LockTargetText,CommonUIStrings.l_InvalidFileNameDisallowPercentOctothorpe][Q]:[CommonUIStrings.l_FailToSaveFile,CommonUIStrings.l_InvalidFileNameText,CommonUIStrings.l_EmptyNameText,
CommonUIStrings.l_InvalidPermissionText,String.format(CommonUIStrings.l_OverwriteTargetText,ya),CommonUIStrings.l_LockTargetText,CommonUIStrings.l_InvalidFileNameText][Q]}Ipl(Q){Q=this.qWe(Q);return[CommonUIStrings.l_GeneralFailTitle,CommonUIStrings.l_InvalidFileNameTitle,CommonUIStrings.l_EmptyNameTitle,CommonUIStrings.l_GeneralFailTitle,CommonUIStrings.l_GeneralFailTitle,CommonUIStrings.l_GeneralFailTitle,CommonUIStrings.l_InvalidFileNameTitle][Q]}}Object(e.a)($k,"ErrorRetryDialog",Ed.StandardDialog,
[1999]);class un{constructor(Q,ya){this.Oa=Q;this.ga=ya;this.lnc=this.Oa.$("SaveToHostWithExtraCharsInFileName")}create(){return new $k(this.ga,this.lnc)}}Object(e.a)(un,"ErrorRetryDialogFactory",null,[1970]);class bm extends sc.a{constructor(Q,ya,gb,Ob,mc,dd,Md=null){super();this.A4=null;this.ga=ya;this.Poa=Ob;this.XUa=dd;this.Oa=Q;this.pG=mc;this.zi=gb;this.lnc=this.Oa.$("SaveToHostWithExtraCharsInFileName");this.Km=Md;this.Ve(1,CommonUIStrings.l_SaveButtonLabel)}get ua(){return this.zi}aAh(Q,ya){this.Iga(1,
!!Q&&Q!==ya);this.A4=document.getElementById(bm.$Gh);G.a.addHandler(this.A4,"change",Object(a.a)(this,this.jXd,"onFileNameChange"));G.a.addHandler(this.A4,"input",Object(a.a)(this,this.jXd,"onFileNameChange"));this.A4.focus()}ZGh(Q){return this.lnc?(new RegExp("["+this.UEh('\\/:*?"<>|')+"]")).test(Q):(new RegExp("["+this.UEh('\\/:*?"<>|#{}%~&')+"]")).test(Q)}UEh(Q){return Q.replace(RegExp("[.*+?|()\\[\\]{}\\\\]","g"),"\\\\$&")}ckf(){const Q=Tb.a.qI(H.AFrameworkApplication.zt.Bz);this.Iga(1,!!this.A4&&
""!==this.A4.value&&this.A4.value!==Q)}jXd(){this.A4&&window.setTimeout(()=>{this.ckf()},0)}rCd(Q,ya){if(1!==Q)la.ULS.sendTraceTag(23881882,216,50,"User click cancel to cancel upload file in file name dialog.");else{Q=ya[bm.$Gh];ya=bm.pCi in ya?ya[bm.pCi]:!1;la.ULS.sendTraceTag(23881883,216,50,"User click save to upload file with new name {0} and overwrite the target {1}.",Tb.a.jLi(Q),ya);const gb=Tb.a.rLa(H.AFrameworkApplication.fileName);(Q=Q?Q.trim():null)&&""!==Q&&""!==gb||1===this.ua.state?this.ZGh(Q)?
this.pG.create().MS(1,Q,ya):this.XUa.BEa(Q+gb,ya,this.Km):this.pG.create().MS(2,Q,ya)}}dispose(){this.A4&&(G.a.removeHandler(this.A4,"change",Object(a.a)(this,this.jXd,"onFileNameChange")),G.a.removeHandler(this.A4,"input",Object(a.a)(this,this.jXd,"onFileNameChange")),this.A4=null);super.dispose()}}bm.$Gh="txtFileName";bm.pCi="chkOverwrite";Object(e.a)(bm,"FileNameDialogBase",sc.a,[]);class yh{static get vg(){return sc.a.Px(yh.sl,CommonUIStrings.l_SaveACopyFileName,CommonUIStrings.l_SaveAsToHostOverwrite)}}
yh.sl="<div class='WACDialogRow' id='DocumentFolderBlock'> <label id='lblFolderName' class='WACDialogLabel' >{0}</label> </div> <div class='WACDialogRow' id='DocumentNameBlock'> <label id='lblFileName' class='WACDialogLabel' for='txtFileName' >{0}</label> <input type='text' id='txtFileName' class='WACDialogInput' autocomplete=\"off\"/> </div> <div class='WACDialogRow' id='OverwriteBlock'> <span id='OverwriteBlockSpan' class='WACDialogSpan'><input type='checkbox' id='chkOverwrite' class='WACDialogCheckBox'></input> <label id='lbcOverwrite' class='\"WACDialogInlineLabel\"' for='chkOverwrite'>{1}</label></span> </div>";
Object(e.a)(yh,"FileNameDialogHtml",null,[]);class fn extends bm{constructor(Q,ya,gb,Ob,mc,dd){super(Q,ya,gb,Ob,mc,dd);this.vg=yh.vg;this.kg="FileNameDialog-SaveAsToHost"}qAa(Q,ya){const gb=Tb.a.qI(H.AFrameworkApplication.zt.Bz);ya={["txtFileName"]:Q||gb,["lblFolderName"]:CommonUIStrings.l_ToCurrentFolder,["chkOverwrite"]:ya};this.Wh(CommonUIStrings.L_SaveAs,Object(a.a)(this,this.rCd,"fileNameDialogHandler"),ya);this.aAh(Q,gb)}}Object(e.a)(fn,"FileNameDialog",bm,[2E3]);class Sj{constructor(Q,ya,gb,
Ob,mc,dd){this.ga=ya;this.Oa=Q;this.Poa=Ob;this.XUa=dd;this.pG=mc;this.zi=gb}create(){return new fn(this.Oa,this.ga,this.zi,this.Poa,this.pG,this.XUa)}}Object(e.a)(Sj,"FileNameDialogFactory",null,[1969]);class qg{constructor(Q,ya,gb){this.XUa=gb;this.vpe=ya;this.Oa=Q}Vb(){2===H.AFrameworkApplication.ua.Sb.jo?H.AFrameworkApplication.ya.gb(Ra.a.qZc,uc.a.frame,Object(a.a)(this,this.pUi,"saveAsToHostActionDispatcher"),4):H.AFrameworkApplication.ya.pa(Ra.a.qZc,uc.a.frame,Object(a.a)(this,this.pUi,"saveAsToHostActionDispatcher"))}pUi(Q,
ya,gb,Ob,mc){return ya.contextId!==uc.a.frame||Q!==Ra.a.qZc?2:this.Oa.$("SaveAsToHostBrsIsEnabled")?1===gb?vf.SessionStatusManager.instance.Sj||H.AFrameworkApplication.fma?8:32:2===gb?(la.ULS.sendTraceTag(8194015,216,50,"User clicked on SaveAsToHost button from the backstage."),Q=this.vpe.create(),mc&&Object.getType(mc)===Array&&2===mc.length?Q.qAa(mc[0],!!mc[1]):Q.qAa(null,!1),32):8:8}}Object(e.a)(qg,"SaveAsToHostActor",null,[]);class fl{constructor(Q,ya,gb,Ob,mc,dd,Md,He){this.Pk=null;this.aTb=
this.xY=!1;this.WUa=this.Km=this.RM=null;this.Oa=ya;this.k5=this.Oa.appSettings.SaveAsToHostWebServiceBase;this.GJg=Ob;this.LTa=mc;this.rg=gb;this.pG=dd;this.le=He;this.zi=Md;this.ga=Q;this.sSa=ya.lb("SaveAsToHostUploadHandler")||"hostuploadhandler.ashx"}b3a(){1!==this.zi.state&&(this.Pk=this.LTa(),this.Pk.message=CommonUIStrings.l_CommentProgressTooltip,this.Pk.Fd=5,this.Pk.Bt=!1,this.Pk.qM(CommonUIStrings.l_DefaultDialogTitle,null,null))}z3(Q=0){1!==this.zi.state&&this.pG.create().MS(Q,Tb.a.qI(this.RM),
this.aTb)}kIb(){const Q=this.Oa.appSettings.BreadcrumbFolderUrl;la.ULS.sendTraceTag(8194016,216,50,"Redirecting to OneDrive for business Folder.");ra.a.Cm(Q,ra.a.Ioa(3),void 0,"UploadToHostManager.RedirectToFolder")}jIb(Q){let ya=!1,gb=!1;this.Oa&&(ya=this.Oa.$("SaveACopyIsEnabledForUiHost"),gb=this.Oa.$("UiHostSupportsDocRebootFeatures"));la.ULS.sendTraceTag(8194017,216,50,"Redirecting to edit url {0}. IsEnabledForUiHost {1} uiHostSupportsFeature {2}",Q,ya,gb);if(ya&&gb){la.ULS.sendTraceTag(51245197,
216,50,"UploadToHostManager.RedirectToEditUrl: Sending DocumentRefresh post message.");const Ob={};Ob[gf.a.Vbc]="1";Ob[gf.a.documentUrl]=Q;Ob[gf.a.reason]=Sg.a.LVf;H.AFrameworkApplication.bQ().execute(mc=>{mc.sendMessage(Oe.a.ryb,Ob)})}else ya&&!gb&&H.AFrameworkApplication.AMa?ra.a.Cm(Q,ra.a.Ioa(4),void 0,"UploadToHostManager.RedirectToEditUrl"):ra.a.Cm(Q,ra.a.Ioa(3),void 0,"UploadToHostManager.RedirectToEditUrl")}BEa(Q,ya,gb=null){la.ULS.sendTraceTag(8194018,216,50,"Starting to upload file");this.GJg&&
!this.GJg()&&this.rg&&(this.le&&(this.WUa=this.le.hg("DialogShown","SaveAsToHostUploadTime")),this.b3a(),this.aTb=ya,this.RM=Q,(this.Km=gb)&&"true"===this.Km.SkipSaveToHost?this.CBd():this.gea())}gea(){32!==this.ga.processAction(Ra.a.eJb,1)?(la.ULS.sendTraceTag(18989378,219,15,"The save file change is not supported, this operation may exist data losting."),this.CBd()):this.ga.Xb(Ra.a.eJb,2,[()=>{la.ULS.sendTraceTag(18989379,219,50,"Call the force save file change successfully.");this.CBd()},(Q,ya)=>
{la.ULS.sendTraceTag(18989380,219,15,"The file change is not saved successfully, this operation may lead to data loss.");this.z3(ya)}])}SYm(Q){this.Dka();this.xY=!1;if(Q&&Q.data&&Q.data.Ge)if(({Fv:ya}=Ka.d(Q.data.Ge)).returnValue)if(Q=ya,Q.StatusCode!==Rk.a.xD&&Q.StatusCode!==Rk.a.bDc){la.ULS.sendTraceTag(8194049,216,10,"UploadToHostManager failure. Response data is not JSON.");var ya={};ya.FailureReason=Q.StatusCode.toString();ya.ExtraInfo=Q.ExtraInfo;this.SOa(ya);this.z3(parseInt(Q.ExtraInfo))}else{la.ULS.sendTraceTag(8194050,
216,50,"UploadToHost execute success.");this.MTf();try{Q.NewDocumentUrl&&""!==Q.NewDocumentUrl?this.jIb(Q.NewDocumentUrl):this.kIb()}catch(gb){la.ULS.sendTraceTag(37025699,216,15,"Redirect failed with exception: {0}",gb.toString())}this.XUc()}else la.ULS.sendTraceTag(8194048,216,10,"Failed to deserialize : {0}",{["ResponseData"]:Eb.a.X2c(Q.data.Ge)}),this.SOa({["FailureReason"]:"Failed to deserialize response"}),this.z3();else la.ULS.sendTraceTag(8194019,216,10,"UploadToHostManager failure. Response data is null"),
this.SOa({["FailureReason"]:"null response"}),this.z3()}RYm(Q){5!==Q.data.status&&12!==Q.data.status||this.xY?(la.ULS.sendTraceTag(8194052,216,10,"UploadToHostManager HTTP failure with code: {0}",{["Status"]:Q.data.status,["HttpStatus"]:Q.data.wf}),this.SOa({["FailureReason"]:Q.data.wf.toString()}),this.Dka(),this.z3(),this.XUc()):(la.ULS.sendTraceTag(8194051,216,10,"UploadToHostManager failure. Retry automatically."),this.xY=!0,this.Km&&"true"===this.Km.SkipSaveToHost?this.CBd():this.gea())}Dka(){this.Pk&&
(this.Pk.close(),this.Pk=null)}XUc(){this.WUa&&(this.WUa.stop(),this.WUa=null)}MTf(){this.Km&&"VersionHistory"===this.Km.SaveEntryPoint&&this.ga.processAction(Ra.a.AYc,2)}SOa(Q){this.Km&&"VersionHistory"===this.Km.SaveEntryPoint&&this.ga.Xb(Ra.a.p4d,2,Q)}CBd(){let Q=this.k5+this.sSa;Q=Zb.a.Ep(Q,"qs",Tb.a.Ij(H.AFrameworkApplication.xm));Q=Zb.a.Ep(Q,"n",Tb.a.Ij((new Date).getTime().toString()));Q=Zb.a.Ep(Q,"ov",Tb.a.Ij(this.aTb.toString()));Q=Zb.a.Ep(Q,"fn",Tb.a.Ij(this.RM));this.Km&&this.Km.FileDownloadUrl&&
(Q=Zb.a.Ep(Q,"furl",Tb.a.Ij(this.Km.FileDownloadUrl)));this.rg.Lj(Q,1,"",{"Content-Type":"application/json; charset=utf-8"},!1,2,Object(a.a)(this,this.SYm,"onUploadFinished"),Object(a.a)(this,this.RYm,"onUploadFailed"),null,void 0,void 0,void 0,void 0,"1")}}Object(e.a)(fl,"UploadToHostManager",null,[1971]);class gm{constructor(){this.W=null}get name(){return"Common.App.SaveAsToHost"}init(){H.AFrameworkApplication.K.zq(Object(a.a)(this,this.ax,"onFullAppSettingsReady"))}ax(){H.AFrameworkApplication.K.$("SaveAsToHostBrsIsEnabled")&&
this.W.resolve("Common.App.SaveAsToHost.SaveAsToHostActor").Vb()}yc(Q){this.W=Q;this.W.register(un,"Common.App.SaveAsToHost.ErrorRetryDialogFactory").as("Common.App.SaveAsToHost.IErrorRetryDialogFactory").Yd(()=>new un(H.AFrameworkApplication.K,H.AFrameworkApplication.ya)).singleInstance();this.W.register(fl,"Common.App.SaveAsToHost.UploadToHostManager").as("Common.App.SaveAsToHost.IUploadToHostManager").Yd(()=>new fl(H.AFrameworkApplication.ya,H.AFrameworkApplication.K,H.AFrameworkApplication.Xe,
()=>H.AFrameworkApplication.Mk,()=>(new Zk.a).create(),Q.resolve("Common.App.SaveAsToHost.IErrorRetryDialogFactory"),H.AFrameworkApplication.ua,H.AFrameworkApplication.ua.jq)).singleInstance();this.W.register(Sj,"Common.App.SaveAsToHost.FileNameDialogFactory").as("Common.App.SaveAsToHost.IFileNameDialogFactory").Yd(()=>new Sj(H.AFrameworkApplication.K,H.AFrameworkApplication.ya,H.AFrameworkApplication.ua,H.AFrameworkApplication.ua.Sb,Q.resolve("Common.App.SaveAsToHost.IErrorRetryDialogFactory"),Q.resolve("Common.App.SaveAsToHost.UploadToHostManager"))).singleInstance();
this.W.register(qg,"Common.App.SaveAsToHost.SaveAsToHostActor").Yd(()=>new qg(H.AFrameworkApplication.K,Q.resolve("Common.App.SaveAsToHost.FileNameDialogFactory"),Q.resolve("Common.App.SaveAsToHost.UploadToHostManager"))).singleInstance()}dispose(){}static main(){ca.a.instance.Oc(new gm)}}Object(e.a)(gm,"SaveAsToHostPackage",null,[1,2]);class xl extends Ed.StandardDialog{constructor(){super();this.Fd=0;this.Ve(1,CommonUIStrings.l_DialogClose)}MS(Q){this.jy(Q,CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_ErrorSavingToOneDrive,
null)}}Object(e.a)(xl,"ErrorDialog",Ed.StandardDialog,[1979]);var Ch=d(192);class gi extends Ed.StandardDialog{constructor(Q,ya,gb){super();this.ga=Q;this.Jqa=ya;this.Poa=gb;this.q8=!1;this.Fd=1;this.tU(1);this.Ve(1,CommonUIStrings.l_SignIn);this.Ve(0,CommonUIStrings.l_SignInToSaveDialogCancelButton)}qAa(){this.Jqa.P9g(Object(a.a)(this,this.qAi,"onSignIn"));this.Pv(CommonUIStrings.l_SignInToSaveDialogTitle,CommonUIStrings.l_SaveToCloudSignInDialog,0,Object(a.a)(this,this.Q4l,"inputHandler"))}Q4l(Q){0===
Q?(la.ULS.sendTraceTag(6590598,216,50,"User dismissed SignIn Dialog."),this.hide()):this.D_d()}qtk(){let Q="2";if(this.Poa)switch(this.Poa.jo){case 3:Q="0";break;case 2:Q="3";break;case 1:Q="1"}return Q}hide(){this.Jqa.nrn(Object(a.a)(this,this.qAi,"onSignIn"));super.hide()}D_d(){const Q=new Ch.QueryStringBuilder("Signin.aspx");Q.Ie("prompt","1");Q.Ie("cbcxt",this.qtk());H.AFrameworkApplication.vja(Q);ra.a.Cm(Q.toString(),"LoginWindow",void 0,"SignInDialog")}qAi(){this.mma&&this.hide();la.ULS.sendTraceTag(7143885,
216,50,"User signed in successfully. Calling Savetocloudstorage action handler");this.ga.processAction(Ra.a.TVf,2)}}Object(e.a)(gi,"SignInDialog",Ed.StandardDialog,[2002]);class Dh{constructor(Q,ya,gb){this.ga=Q;this.Jqa=ya;this.Poa=gb}create(){return new gi(this.ga,this.Jqa,this.Poa)}}Object(e.a)(Dh,"SignInDialogFactory",null,[1975]);class Yj{constructor(Q,ya,gb,Ob,mc,dd,Md){this.k5=Q;this.RM=ya;this.nQb=gb;this.Iad=Ob;this.ODe=mc;this.sSa=dd;this.Km=Md}execute(Q,ya){if(!H.AFrameworkApplication.Mk&&
H.AFrameworkApplication.Xe){var gb=this.k5+this.sSa;gb=Zb.a.Ep(gb,"fo",Tb.a.Ij(this.Iad));gb=Zb.a.Ep(gb,"fn",Tb.a.Ij(this.RM));gb=Zb.a.Ep(gb,"qs",Tb.a.Ij(this.ODe));gb=Zb.a.Ep(gb,"n",Tb.a.Ij((new Date).getTime().toString()));this.Km&&this.Km.FileDownloadUrl&&(gb=Zb.a.Ep(gb,"furl",Tb.a.Ij(this.Km.FileDownloadUrl)));this.nQb&&(gb=Zb.a.Ep(gb,"fnn",Tb.a.Ij(this.nQb)));H.AFrameworkApplication.Xe.Lj(gb,1,"",{"Content-Type":"application/json; charset=utf-8"},!1,2,Q,ya,null)}}}Object(e.a)(Yj,"SkyDriveUploadCaller",
null,[2003]);class Ek{constructor(Q){this.Oa=Q;this.Bub=Q.appSettings.SkyDriveUploadWebServiceBase;this.RM=Q.appSettings.FileName;this.sSa=Q.lb("SkyDriveUploadHandler")||"skydriveuploadhandler.ashx"}create(Q,ya,gb){return new Yj(this.Bub,this.RM,ya,Q,H.AFrameworkApplication.xm,this.sSa,gb)}}Object(e.a)(Ek,"SkydriveUploadCallerFactory",null,[1980]);class wg{constructor(){this.W=null}get name(){return"Common.App.SaveToCloudStorage"}init(){H.AFrameworkApplication.K.$("SaveToCloudStorageUIIsEnabled")&&
this.W.resolve("Common.App.SaveToCloudStorage.SaveToCloudStorageActor").Vb()}dispose(){}yc(Q){this.W=Q;this.W.register(Dh,"Common.App.SaveToCloudStorage.SignInDialogFactory").as("Common.App.SaveToCloudStorage.ISignInDialogFactory").Yd(()=>new Dh(H.AFrameworkApplication.ya,yd.a.instance,H.AFrameworkApplication.ua.Sb)).singleInstance();this.W.register(Ek,"Common.App.SaveToCloudStorage.SkydriveUploadCallerFactory").as("Common.App.SaveToCloudStorage.ISkydriveUploadCallerFactory").Yd(()=>new Ek(H.AFrameworkApplication.K)).singleInstance();
this.W.register(De,"Common.App.SaveToCloudStorage.SaveToCloudStorageActor").Yd(()=>new De(Q.resolve("Common.App.SaveToCloudStorage.SaveToCloudManager"),Q.resolve("Common.App.OneDriveFilePickerApi.IOneDriveFilePickerApiManager"),H.AFrameworkApplication.K,H.AFrameworkApplication.ua.jq)).singleInstance();this.W.register(xf,"Common.App.SaveToCloudStorage.UploadToCloudManager").Yd(()=>new xf(Q.resolve("Common.App.SaveToCloudStorage.SkydriveUploadCallerFactory"),()=>(new Zk.a).create(),()=>new xl,H.AFrameworkApplication.ua,
H.AFrameworkApplication.ua.jq)).singleInstance();this.W.register(pl,"Common.App.SaveToCloudStorage.SaveToCloudManager").Yd(()=>new pl(Q.resolve("Common.App.SaveToCloudStorage.SignInDialogFactory"),yd.a.instance,Q.resolve("Common.App.SaveToCloudStorage.UploadToCloudManager"),H.AFrameworkApplication.K,H.AFrameworkApplication.eea,()=>new xl)).singleInstance()}static main(){ca.a.instance.Oc(new wg)}}Object(e.a)(wg,"PackageManager",null,[1,2]);class ye extends Ed.StandardDialog{constructor(){super();this.Fd=
0;this.Ve(1,CommonUIStrings.l_DialogClose)}MS(Q,ya){this.sAh(Q,ya,tk.a.yBn)}sAh(Q,ya,gb){la.ULS.sendTraceTag(25180161,216,10,"Show upload error dialog with error code {0}.",gb);this.jy(gb,Q,ya,null)}R4e(Q,ya){la.ULS.sendTraceTag(25235986,216,15,"Show warning dialog of Picker related issue.");this.jy(tk.a.ABn,Q,ya,null,!0)}}Object(e.a)(ye,"ErrorDialog",Ed.StandardDialog,[932]);class Td{static get vg(){return sc.a.Px(Td.sl,CommonUIStrings.l_FileNameLabel,CommonUIStrings.l_NewFileLocationLabel,CommonUIStrings.l_CurrentOnlineFolder,
"")}}Td.sl="<div class='WACDialogRow' id='DocumentNameBlock'> <label id='lblFileName' class='WACDialogLabel' for='txtFileName' >{0}</label> <input type='text' id='txtFileName' class='WACDialogInput' autocomplete=\"off\"/> </div> <div class='WACDialogRow' id='DocumentLocationBlock'> <label id='locationName' class='WACDialogLabel' for='locationName' >{1}</label> <div class='FolderLocationDiv' id='folderLocation'> <label id='currentLocation' class='WACDialogLabel' for='currentLocation' >{2}</label> <span id='anotherFolder' class='WACDialogSpan'>{3}</span> </div> </div>";
Object(e.a)(Td,"FileNameDialogHtml",null,[]);var cg=d(68);class Hi extends bm{constructor(Q,ya,gb,Ob,mc,dd,Md,He){super(Q,ya,gb,Ob,mc,dd,He);this.A7a=this.XFe=this.fP=null;this.eok=CommonUIStrings.l_SaveToAnotherFolder;this.vg=Td.vg;this.kg="FileNameDialog-SaveToSharePoint";this.Zuc=Md;this.lPj=He}qAa(Q){const ya=Tb.a.qI(H.AFrameworkApplication.zt.Bz),gb=H.AFrameworkApplication.breadcrumbFolderName,Ob=H.AFrameworkApplication.breadcrumbBrandName,mc={["txtFileName"]:Q||ya};let dd=CommonUIStrings.L_SaveAs;
2===H.AFrameworkApplication.ua.Sb.jo&&(dd=CommonUIStrings.L_SaveACopy);this.Wh(dd,Object(a.a)(this,this.rCd,"fileNameDialogHandler"),mc);this.aAh(Q,ya);this.J3e.style.width="450px";Sys.UI.DomElement.addCssClass(document.getElementById("DocumentLocationBlock"),"SaveAsDialogRow");H.AFrameworkApplication.K.$("HideSaveToAnotherFolderButtonforUIHost")||(this.fP=document.getElementById("anotherFolder"),Q=document.getElementById("folderLocation"),this.XFe=pb.a.Rrd(Q,this.fP,"anotherFolderDescribedBy",""),
this.fP.className="WACButton WACDialogButtonNormal",Q=!1,gb&&gb.length?(this.E7g(this.fP,this.XFe,String.format(CommonUIStrings.l_ScreenReader_CurrentFileLocation,Ob,gb)),Q=this.j1j(Ob,gb)):this.E7g(this.fP,this.XFe,CommonUIStrings.l_CurrentOnlineFolder),this.Z2j(this.fP),this.l1j(this.fP),Q?(document.getElementById("currentLocation").style.width="100%",Sys.UI.DomElement.addCssClass(this.fP,"SaveToAnotherLocationTwo"),la.ULS.sendTraceTag(24459297,216,50,"Move save to another folder button to second line.")):
Sys.UI.DomElement.addCssClass(this.fP,"SaveToAnotherLocationOne"),G.a.addHandler(this.fP,B.a.click,Object(a.a)(this,this.pIf,"onSaveToAnotherLocationClick")),G.a.addHandler(this.fP,B.a.li,Object(a.a)(this,this.Xzi,"onSaveToAnotherLocationKeyDown")))}j1j(Q,ya){let gb;gb=!1;const Ob=document.getElementById("currentLocation");Ob.innerText="";const mc=this.CUh(Ob,Q),dd=this.CUh(Ob,ya);let Md=255,He=255;255<mc+dd&&(Md=Math.max(238,408-mc),He=Math.max(170,408-dd),gb=!0);this.g5j(Ob,Q,He,ya,Md);return gb}CUh(Q,
ya){const gb=document.createElement("div");gb.innerText=ya;gb.style.visibility="hidden";Q.appendChild(gb);ya=gb.clientWidth;Q.removeChild(gb);return ya}g5j(Q,ya,gb,Ob,mc){ya&&(this.D7g(Q,ya,gb),this.X4j(Q));Ob&&this.D7g(Q,Ob,mc)}D7g(Q,ya,gb){const Ob=document.createElement("div");Ob.innerText=ya;Ob.title=ya;Ob.className="SaveToAnotherFolderBreadcrumb";Ob.style.maxWidth=gb.toString()+"px";Q.appendChild(Ob)}X4j(Q){const ya=document.createElement("span");ya.id="FolderSeparator";const gb=document.createElementNS("http://www.w3.org/2000/svg",
"svg");gb.setAttribute("class","SeparatorCaret");const Ob=document.createElementNS("http://www.w3.org/2000/svg","polygon");Ob.setAttribute("points","1 4 1 11 5 7.5");gb.appendChild(Ob);ya.appendChild(gb);Q.appendChild(ya)}E7g(Q,ya,gb){gb=String.format(CommonUIStrings.l_ScreenReader_SaveToAnotherFolderButton,gb);ya&&(ya.innerText=gb);Q.tabIndex=0;Q.setAttribute(pb.a.Ch,pb.a.t1)}l1j(Q){const ya=document.createElement("span");ya.id="anotherFolderText";ya.innerText=this.eok;ya.className="AnotherFolderTextSpan";
Q.appendChild(ya)}Z2j(Q){const ya=document.createElement("span");ya.className="cui-img-cont-float cui-img-16by16 ";this.A7a=document.createElementNS("http://www.w3.org/2000/svg","svg");this.A7a.setAttribute("class","FolderIconSVG");const gb=document.createElementNS("http://www.w3.org/2000/svg","path");gb.setAttribute("d","M0,14V4L1.25,3h6.5L9.606,1H13.25L14,2V6h1.5L16,7.25,14.25,14H0ZM13,6V2H10L8.25,4,1.957,3.914,1,4.75V12L3.25,6.75l1-.75H13Z");this.A7a.appendChild(gb);ya.appendChild(this.A7a);Q.appendChild(ya)}Xzi(Q){!Q||
Q.keyCode!==cg.a.es&&Q.keyCode!==cg.a.Gde||this.pIf(Q)}pIf(){if(this.A4){const Q=Tb.a.rLa(H.AFrameworkApplication.fileName);let ya=this.A4.value;this.hide();ya&&""!==ya&&""!==Q||1===this.ua.state?(""!==Q&&(ya+=Q),this.ZGh(ya)?this.pG.create().MS(1,ya,!1):this.Zuc.start(ya,this.lPj)):this.pG.create().MS(2,ya,!1)}}Xsk(Q){this.fP&&this.A7a&&(Q?(this.fP.tabIndex=0,Sys.UI.DomElement.removeCssClass(this.fP,"DisabledSaveAsButton"),Sys.UI.DomElement.removeCssClass(this.A7a,"DisabledFolderIconSVG")):(this.fP.tabIndex=
-1,Sys.UI.DomElement.containsCssClass(this.fP,"DisabledSaveAsButton")||Sys.UI.DomElement.containsCssClass(this.A7a,"DisabledFolderIconSVG")||(Sys.UI.DomElement.addCssClass(this.fP,"DisabledSaveAsButton"),Sys.UI.DomElement.addCssClass(this.A7a,"DisabledFolderIconSVG"))))}ckf(){super.ckf();this.Xsk(!!this.A4&&""!==this.A4.value)}dispose(){this.fP&&(G.a.removeHandler(this.fP,B.a.click,Object(a.a)(this,this.pIf,"onSaveToAnotherLocationClick")),G.a.removeHandler(this.fP,B.a.li,Object(a.a)(this,this.Xzi,
"onSaveToAnotherLocationKeyDown")),this.fP=null);super.dispose()}}Object(e.a)(Hi,"FileNameDialog",bm,[1096]);var ee=d(546),Fk=d(375),te=d(1521),Cg=d(1626);class cc{constructor(){this.extension=this.fileName=null;this.enableMoreLocations=!1;this.saveLocations=this.scenario=null}}Object(e.a)(cc,"SaveAsDialogInput",null,[]);class rh{constructor(){this.properties=this.friendlyPath=this.folderName=null}}Object(e.a)(rh,"SaveLocation",null,[]);var pe=d(161);class ah{constructor(Q,ya,gb,Ob,mc,dd,Md,He,Ue){this.Cxe=
null;this.RM="";this.Zuc=Q;this.pG=ya;this.Km=Ue;this.XUa=gb;this.zi=mc;this.MK=Ob;this.oub=Md;this.LUb=He;dd&&(this.Cxe=new jb.a(()=>new te.a(dd.value,null)))}zol(){const Q=new ee.a(Fk.a.Rj());Q.Z("type","currentHost");return Object.assign(new rh,{folderName:this.MK.breadcrumbFolderName,friendlyPath:this.MK.breadcrumbBrandName,properties:Q})}zkm(Q){return!!Q&&"ClassicMru"===Q.type&&!!Q.service_info&&!!Q.service_info.service_id&&-1!==Q.service_info.service_id.indexOf("SHAREPOINT")}aJl(){if(!this.Cxe||
!this.oub)return null;var Q=this.Cxe.value.fk("SaveAsToSharePointDialog",!1);if(!Q||3!==Q.state||!Q.zsi)return null;Q=Q.zsi;const ya=new ia.a;let gb=0,Ob=0;for(var mc=0;mc<Q.length;mc++){var dd=Q[mc];if(!this.zkm(dd))continue;gb++;if(!dd.sharepoint_info)continue;const Md=dd.url,He=dd.sharepoint_info.site_url,Ue=dd.title;dd=Cg.b(dd,H.AFrameworkApplication.isRtl);if(!(Md&&He&&Ue&&dd))continue;Ob++;const Sf=new ee.a(Fk.a.Rj());Sf.Z("type","SharePoint");Sf.Z("siteUrl",He);Sf.Z("folderUrl",Md);Ob++;ya.add(Object.assign(new rh,
{folderName:Ue,friendlyPath:dd,properties:Sf}))}mc=new Map;mc.set("NumPlaces",Q.length.toString());mc.set("NumSharepointPlaces",gb.toString());mc.set("placesWithMetadata",Ob.toString());Ha.Health.instance.recordKpiUsage("SharePointSaveAsDialogMru",0,"smartfio",mc);0<gb&&(Ob?.5>1*Ob/gb&&Ha.Health.instance.recordKpiFailure("SharePointSaveAsDialogMru","PartialPlacesMetadataMissing",!1,!1,null):Ha.Health.instance.recordKpiFailure("SharePointSaveAsDialogMru","AllPlacesMetadataMissing",!1,!1,null));return ya}Gpl(){const Q=
new ia.a;Q.add(this.zol());const ya=this.aJl();ya&&Q.addRange(ya);return Object.assign(new cc,{enableMoreLocations:!H.AFrameworkApplication.K.$("HideSaveToAnotherFolderButtonforUIHost"),fileName:this.RM,extension:Tb.a.rLa(this.MK.Bz),saveLocations:Q.toArray(),scenario:"SaveToSharePoint"})}ndf(){const Q=Object(a.a)(this,this.Gpl,"getDialogInput"),ya={};ya.inputPropsCallback=Q;return ya}qAa(Q){this.RM=Q;this.RM||(this.RM=String.format(CommonUIStrings.l_SaveACopy_Filename,Tb.a.qI(this.MK.Bz)));Q={["id"]:"SaveAsDialog",
["bodyControls"]:this.ndf()};let ya=CommonUIStrings.L_SaveAs;2===this.zi.Sb.jo&&(ya=CommonUIStrings.L_SaveACopy);const gb=new sc.a(!1,!1,!0);gb.Fd=1;gb.kg="SaveAsDialog";gb.Ve(1,CommonUIStrings.l_SaveButtonLabel);gb.Wh(ya,Object(a.a)(this,this.uBn,"saveAsDialogHandler"),Q)}UXn(Q,ya){Q&&""!==Q&&""!==ya||1===this.zi.state?this.ykm()?this.gtm(Q,ya):(""!==ya&&(Q+=ya),this.Zuc.start(Q,this.Km)):(la.ULS.sendTraceTag(579179796,216,10,"filename is empty but dialog should have handled this error case"),this.pG.create().MS(2,
Q,!1))}gtm(Q,ya){Ha.Health.instance.recordKpiUsage("SaveACopySFP",0,"smartfio",null);const gb=this.LUb.R_e(CommonUIStrings.l_PickerSaveACopyOkButton,CommonUIStrings.l_PickerSaveACopyTitle,!1,!0,!1,null,"SaveACopy",2);this.LUb.Udf(gb).then(Ob=>{if(Ob&&0<Ob.length){const mc=Ob[0][gf.a.B4m];Ob=Ob[0][gf.a.C4m];if(""!==mc&&""!==Ob)this.oub.BEa(Ob,Q+ya,mc,this.Km),Ha.Health.instance.recordKpiSuccess("SaveACopySFP",null);else{this.pG.create().MS(0,Q,!1);const dd=Ad.a.iF();dd&&(dd.set("SiteUrlAvailable",
""===mc?"false":"true"),dd.set("FolderUrlAvailable",""===Ob?"false":"true"));Ha.Health.instance.recordKpiFailure("SaveACopySFP","Not all values Available to start upload",!1,!1,Object.assign(new pe.a,{extendedProperties:dd}))}}else this.pG.create().MS(0,Q,!1),Ha.Health.instance.recordKpiFailure("SaveACopySFP","Picker Data is unavaliable",!1,!1,null)}).catch(Ob=>{"Canceled"===Ob?((Ob=Ad.a.iF())&&Ob.set("IsCanceled","true"),Ha.Health.instance.recordKpiSuccess("SaveACopySFP",Object.assign(new pe.a,{extendedProperties:Ob}))):
Ha.Health.instance.recordKpiFailure("SaveACopySFP",Ob,!1,!1,null)})}ykm(){return this.LUb?this.LUb.ztf():(la.ULS.sendTraceTag(572343636,216,50,"_sharedFilePickerManager is null"),!1)}uBn(Q,ya){if(ya&&1===Q){Q=ya.fileName;var gb=Tb.a.rLa(this.MK.Bz);ya.moreLocationsSelected&&this.UXn(Q,gb);if(ya.locationCallback){var Ob=ya.locationCallback();Ob?Ob.properties&&"currentHost"===Ob.properties.J("type")?this.XUa.BEa(Q+gb,!1,this.Km):Ob.properties&&"SharePoint"===Ob.properties.J("type")?(ya=Ob.properties.J("siteUrl"),
Ob=Ob.properties.J("folderUrl"),this.oub.BEa(Ob,Q+gb,ya,this.Km)):la.ULS.sendTraceTag(579179799,216,10,"unknown location type sent back"):la.ULS.sendTraceTag(579179798,216,10,"selected location is empty")}else la.ULS.sendTraceTag(579179797,216,10,"locationCallback is empty")}}}Object(e.a)(ah,"ReactSaveAsDialog",null,[1096]);class Tg{constructor(Q,ya,gb,Ob,mc,dd,Md,He=null,Ue=null,Sf=null){this.ga=ya;this.Oa=Q;this.Poa=Ob;this.XUa=dd;this.pG=mc;this.zi=gb;this.AZg=Md;this.XKj=He;this.oub=Ue;this.LUb=
Sf}create(Q){return this.zi&&this.zi.Sb.KA?new ah(this.AZg,this.pG,this.XUa,H.AFrameworkApplication.zt,this.zi,this.XKj,this.oub,this.LUb,Q):new Hi(this.Oa,this.ga,this.zi,this.Poa,this.pG,this.XUa,this.AZg,Q)}}Object(e.a)(Tg,"FileNameDialogFactory",null,[1069]);class ri{constructor(Q,ya,gb,Ob){this.Xv=this.Ksc=null;this.mpb=Q;this.zi=gb;this.yQj=Ob;this.qSa=new jb.a(()=>new te.a(ya.value,Object(a.a)(this,this.BAb,"getMoreInfoEventReceived")))}get kBi(){this.Ksc||(this.qSa.value.fk("Save As",!0),
this.Xv&&this.Xv.Kaa&&this.Xv.Kaa.length&&(this.Ksc=this.tBl(this.Xv.Kaa)));return this.Ksc}start(Q){if(!this.kBi)if(H.AFrameworkApplication.breadcrumbFolderUrl&&H.AFrameworkApplication.breadcrumbFolderUrl.length)this.Ksc=H.AFrameworkApplication.breadcrumbFolderUrl;else return la.ULS.sendTraceTag(23881884,216,10,"CachedGetMoreInfoResult is null, can't get OneDrive for Bussiness page url. BreadcrumbFolderUrl is null. Get more info result is null: ",!this.Xv),!1;const ya=this.yQj();ya.gYn();const gb=
ya.ZDl();if(!gb)return la.ULS.sendTraceTag(24664067,216,10,"Picker container is null, will not show picker."),!1;this.mpb.start((Ob,mc)=>{ya.hide();Q(Ob,mc)},()=>{this.cGb(ya)},gb,this.Ksc);return!0}cGb(Q){Q.hide();la.ULS.sendTraceTag(24664068,216,50,"User cancelled save to another folder.")}tBl(Q){Q=Q.toLowerCase();Q.endsWith("/")||(Q+="/");const ya=Q.indexOf("/documents/");return-1!==ya?Q.substring(0,ya+1)+"_layouts/15/onedrive.aspx":""}BAb(Q){this.Xv||3!==Q.state||(this.Xv=Q)}}Object(e.a)(ri,"OneDriveFilePickerHelper",
null,[1066]);class Rl extends sc.a{constructor(){super()}gYn(){this.tob="FilePickerDialog";this.vg="<div class='FilePickerDiv' id='FilePickerDiv'></div>";this.kg="PickerDialog-MsoSp";this.showDialog("",null)}ZDl(){return document.getElementById("FilePickerDiv")}rO(){}nga(){}}Object(e.a)(Rl,"PickerDialog",sc.a,[1067]);class Tf{constructor(Q,ya,gb,Ob,mc,dd,Md){this.Oa=Q;this.vpe=gb;this.ga=ya;this.Zuc=Ob;this.mpb=mc;this.Jsc=dd;this.jyj=Md}Vb(){const Q=this.mpb.i3b();Q?Ja.a.S$||this.Oa.$("SaveToSharePointOnDemandDownloadJsIsEnabled")?
this.ga.gb(Ra.a.jdc,uc.a.frame,Object(a.a)(this,this.JUi,"saveToSharePointActionDispatcher"),64):(Q.h0a.continueWith(ya=>{ya.Ji&&this.mpb.gHf(ya)}),this.Atd()):la.ULS.sendTraceTag(25180162,216,15,"Failure with OneDrive API download as the js url is empty.")}Atd(){hc.a.pXc(Object(a.a)(this,this.JUi,"saveToSharePointActionDispatcher"));hc.a.iFc([new sk.a(Ra.a.jdc,uc.a.frame,0)],this.mpb.i3b())}get S7b(){return this.Oa.$("SaveToAnotherFolderBrsIsEnabled")}get bkh(){return this.Oa.$("UserCanWriteRelative")}JUi(Q,
ya,gb,Ob,mc){return ya.contextId!==uc.a.frame||Q!==Ra.a.jdc?2:this.S7b&&(this.Jsc.kBi||this.bkh)?1===gb?vf.SessionStatusManager.instance.Sj||H.AFrameworkApplication.fma?8:this.jyj()?32:8:2===gb?(la.ULS.sendTraceTag(23881885,216,50,"User clicked on SaveToSharePoint button from "+(mc&&mc.SaveEntryPoint&&"VersionHistory"===mc.SaveEntryPoint.toString()?"version history.":"the backstage.")),this.bkh?(la.ULS.sendTraceTag(24524226,216,50,"Show save a copy dialog."),this.vpe.create(mc).qAa(null)):(la.ULS.sendTraceTag(24524225,
216,50,"No permission save to current folder, show Picker to save to another folder."),this.Zuc.start(null,mc)),32):8:8}}Object(e.a)(Tf,"SaveToSharePointActor",null,[]);class hm{constructor(Q,ya,gb,Ob){this.Km=this.KRg=null;this.oub=Q;this.pG=ya;this.Jsc=gb;this.zi=Ob}start(Q,ya){la.ULS.sendTraceTag(25180163,216,50,"Try launch Picker.");this.KRg=Q;this.Km=ya;this.Jsc.start((gb,Ob)=>{this.FNf(gb,Ob)})||this.N0f()}FNf(Q,ya){if(Q)this.onSuccess(ya);else this.onFailure(ya)}N0f(){1!==this.zi.state&&this.pG().R4e(CommonUIStrings.l_DefaultDialogTitle,
CommonUIStrings.l_OneDriveContactError)}onSuccess(Q){la.ULS.sendTraceTag(23881886,216,50,"Success Callback called. Calling UploadToSharePointManager to start upload.");if(Q&&Q.data&&Q.data.value&&Q.data.value.length&&Q.data.value[0].sharePoint){const ya=Q.data.value[0].sharePoint.url;Q=Q.data.value[0].sharePoint.listUrl;let gb=null;if(ya&&(gb=Q?this.sJl(Q):this.rJl(ya))){this.oub.BEa(ya,this.KRg,gb,this.Km);return}la.ULS.sendTraceTag(25180164,216,10,"Picker return invalid data, folder url is null: {0}, siteUrl url is null: {1}.",
!ya,!gb)}la.ULS.sendTraceTag(23881887,216,10,"Picker return invalid data or empty SharePoint url.");this.N0f()}rJl(Q){Q.endsWith("/")||(Q+="/");let ya=0;for(let gb=0;gb<Q.length;gb++)if("/"===Q.charAt(gb)&&5===++ya)return Q.substr(0,gb);return null}sJl(Q){Q.endsWith("/")&&(Q=Q.substring(0,Q.length-1));const ya=Q.lastIndexOf("/");return-1!==ya?Q.substring(0,ya):null}onFailure(Q){la.ULS.sendTraceTag(23881888,216,10,"Picker failure Callback called.");Q&&Q.error?la.ULS.sendTraceTag(23881889,216,10,"File Dialog returned with error code:{0}, and error message: {1}.",
Q.error.errorCode,Q.error.message):la.ULS.sendTraceTag(23881890,216,10,"File Dialog returned empty error.");this.N0f()}}Object(e.a)(hm,"SaveToSharePointManager",null,[1967]);class mh{constructor(Q,ya,gb,Ob,mc,dd,Md,He){this.k5=Q;this.RM=ya;this.nQb=Ob;this.ODe=dd;this.VGa=gb;this.HVj=mc;this.sSa=Md;this.Km=He}execute(Q,ya){if(!H.AFrameworkApplication.Mk&&H.AFrameworkApplication.Xe){var gb=this.k5+this.sSa;gb=Zb.a.Ep(gb,"fu",Tb.a.Ij(this.VGa));gb=Zb.a.Ep(gb,"su",Tb.a.Ij(this.HVj));gb=Zb.a.Ep(gb,"fn",
Tb.a.Ij(this.RM));gb=Zb.a.Ep(gb,"n",Tb.a.Ij((new Date).getTime().toString()));this.Km&&this.Km.FileDownloadUrl&&(gb=Zb.a.Ep(gb,"furl",Tb.a.Ij(this.Km.FileDownloadUrl)));gb=gb+"&"+this.ODe;this.nQb&&this.nQb.length?gb=Zb.a.Ep(gb,"fnn",Tb.a.Ij(this.nQb)):la.ULS.sendTraceTag(23881891,216,15,"No new file name in request.");la.ULS.sendTraceTag(23881920,216,50,"Trying send SharePointSaveAsHandler.ashx request.");H.AFrameworkApplication.Xe.Lj(gb,1,"",{"Content-Type":"application/json; charset=utf-8"},!1,
2,Q,ya,null,void 0,void 0,void 0,void 0,"9")}}}Object(e.a)(mh,"SharePointSaveAsCaller",null,[1998]);class ck{constructor(Q){this.Bub=Q.appSettings.SaveAsToHostWebServiceBase;this.RM=Q.appSettings.FileName;this.sSa=Q.lb("SharePointSaveAsHandler")||"sharepointsaveashandler.ashx"}create(Q,ya,gb,Ob){return new mh(this.Bub,this.RM,Q,ya,gb,H.AFrameworkApplication.xm,this.sSa,Ob)}}Object(e.a)(ck,"SharePointUploadCallerFactory",null,[1966]);var Uf=d(1362);class al{constructor(Q,ya,gb,Ob,mc){this.Pk=this.okc=
null;this.Fhe=!1;this.QFe=this.VGa=null;this.NLe=ya;this.LTa=gb;this.pG=Ob;this.zi=mc;this.ga=Q}BEa(Q,ya,gb,Ob){this.Fhe=!1;la.ULS.sendTraceTag(23881921,216,50,"UploadToSharePointManager.StartUpload : Starting to upload file");this.b3a();this.VGa=Q;Ob&&Ob.SaveEntryPoint&&(this.QFe=Ob.SaveEntryPoint);this.okc=this.NLe.create(Q,ya,gb,Ob);Ob&&"true"===Ob.SkipSaveToHost?this.gea():this.qdl()}qdl(){const Q=()=>{la.ULS.sendTraceTag(23881923,216,15,"The file change is not saved successfully, this operation may lead to data loss.");
this.gea()};32!==this.ga.Xb(Ra.a.eJb,2,[()=>{la.ULS.sendTraceTag(23881922,216,50,"Call the force save file change successfully.");this.gea()},Q])&&Q()}gea(){la.ULS.sendTraceTag(23881924,216,50,"Send SharePointSaveAsHandler.ashx request.");this.okc.execute(Object(a.a)(this,this.SWm,"onSaveToSharePointUploadFinished"),Object(a.a)(this,this.RWm,"onSaveToSharePointUploadFailed"))}SWm(Q){if(Q&&Q.data&&Q.data.Ge){var ya;if(({Fv:ya}=Ka.d(Q.data.Ge)).returnValue)if(ya.StatusCode!==Rk.a.xD&&ya.StatusCode!==
Rk.a.bDc)la.ULS.sendTraceTag(25235987,216,15,"UploadToSharePointManager upload failed with status: {0}, status code: {1}.",Q.data.status,ya.StatusCode),ya.StatusCode!==Rk.a.RTf&&this.VAh(Q.data.status)||(this.SOa(ya.StatusCode.toString()),this.cXn(ya.StatusCode));else{la.ULS.sendTraceTag(23881927,216,50,"UploadToSharePointManager upload success.");this.MTf();try{ya.NewDocumentUrl?this.jIb(ya.NewDocumentUrl):this.kIb()}catch(gb){la.ULS.sendTraceTag(37025729,216,15,"Redirect failed with exception: {0}",
gb.toString())}}else la.ULS.sendTraceTag(23881926,216,10,"Failed to deserialize : {0}",{["ResponseData"]:Eb.a.X2c(Q.data.Ge)}),this.Rzd()||(this.SOa("Failed to deserialize response"),this.M0c())}else la.ULS.sendTraceTag(23881925,216,10,"Upload failure. Response data is null"),this.Rzd()||(this.SOa("Unknown"),this.M0c())}RWm(Q){Q&&Q.data?this.VAh(Q.data.status)||(la.ULS.sendTraceTag(23881929,216,10,"Upload failed."),this.SOa(Uf.a[Q.data.status]),this.M0c()):(la.ULS.sendTraceTag(23881928,216,10,"Upload failure. Response data is null"),
this.Rzd()||(this.SOa("Unknown"),this.M0c()))}Rzd(){if(!this.Fhe)return la.ULS.sendTraceTag(23881930,216,10,"Upload fail. Retrying."),this.Fhe=!0,this.gea(),!0;la.ULS.sendTraceTag(23881931,216,10,"Upload fail. Already retry once but still fail.");return!1}VAh(Q){la.ULS.sendTraceTag(23881932,216,10,"HTTP failure with code: {0}",Q);return this.Rzd()}kIb(){la.ULS.sendTraceTag(23881933,216,50,"Redirecting to Folder.");ra.a.Cm(this.VGa,ra.a.Ioa(3),void 0,"UploadToSharePointManager.RedirectToFolder")}jIb(Q){let ya=
!1,gb=!1;H.AFrameworkApplication.K&&(ya=H.AFrameworkApplication.K.$("SaveACopyIsEnabledForUiHost"),gb=H.AFrameworkApplication.K.$("UiHostSupportsDocRebootFeatures"));la.ULS.sendTraceTag(23881934,216,50,"Redirecting to edit url {0}. IsEnabledForUiHost {1}",Q,ya);if(ya&&gb){la.ULS.sendTraceTag(51245198,216,50,"UploadToSharePointManager.RedirectToEditUrl: Sending DocumentRefresh post message.");const Ob={};Ob[gf.a.Vbc]="1";Ob[gf.a.documentUrl]=Q;Ob[gf.a.reason]=Sg.a.LVf;H.AFrameworkApplication.bQ().execute(mc=>
{mc.sendMessage(Oe.a.ryb,Ob)})}else ra.a.Cm(Q,ra.a.Ioa(3),void 0,"UploadToSharePointManager.RedirectToEditUrl")}b3a(){this.zi&&1===this.zi.state||(this.Pk=this.LTa(),this.Pk.message=CommonUIStrings.l_CommentProgressTooltip,this.Pk.Fd=5,this.Pk.Bt=!1,this.Pk.qM(CommonUIStrings.l_DefaultDialogTitle,null,null))}Dka(){this.Pk&&(this.Pk.close(),this.Pk=null)}M0c(){this.xp(CommonUIStrings.l_SaveFailedDialogTitle,CommonUIStrings.l_FailToSaveFile)}VXn(){this.xp(CommonUIStrings.l_NoSavePermissionDialogTitle,
CommonUIStrings.l_NoSavePermissionDialogMessage)}iXn(){const Q=String.format(CommonUIStrings.l_SaveAsFileTooLargeMessage,250);this.xp(CommonUIStrings.l_SaveAsFileTooLargeTitle,Q,tk.a.vBn)}xp(Q,ya,gb=tk.a.zBn){la.ULS.sendTraceTag(25180165,216,10,"Upload failure with title: {0}, message: {1}",Q,ya);this.Dka();1!==this.zi.state&&this.pG().sAh(Q,ya,gb)}cXn(Q){la.ULS.sendTraceTag(25180166,216,50,"Upload fail with status code: {0}.",Q);switch(Q){case Rk.a.hce:this.VXn();break;case Rk.a.RTf:this.iXn();break;
default:this.M0c()}}MTf(){"VersionHistory"===this.QFe&&this.ga.processAction(Ra.a.AYc,2)}SOa(Q){"VersionHistory"===this.QFe&&this.ga.Xb(Ra.a.p4d,2,{["FailureReason"]:Q})}}Object(e.a)(al,"UploadToSharePointManager",null,[1968]);var gl=d(741),nm=d(122);class dj{constructor(){this.Nld=this.yze=this.pze=this.W=null}get name(){return"Common.App.SaveToSharePoint"}init(){}dispose(){}yc(Q){this.W=Q;this.pze=gl.a.Kq(Q.Za("Common.IEventEmitter<Common.IGetMoreInfoResult>"));this.yze=gl.a.Kq(Q.Za("Common.IEventEmitter<Common.IMruResult>"));
this.Nld=gl.a.Kq(Q.Za("Common.App.SharedFilePicker.ISharedFilePicker"));nm.Task.WAA.call(null,this.pze,this.yze,this.Nld).continueWith(()=>{this.Wjn()})}Wjn(){this.W.register(ck,"Common.App.SaveToSharePoint.SharePointUploadCallerFactory").as("Common.App.SaveToSharePoint.ISharePointUploadCallerFactory").Yd(()=>new ck(H.AFrameworkApplication.K)).singleInstance();this.W.register(al,"Common.App.SaveToSharePoint.UploadToSharePointManager").as("Common.App.SaveToSharePoint.IUploadToSharePointManager").Yd(()=>
new al(H.AFrameworkApplication.ya,this.W.resolve("Common.App.SaveToSharePoint.SharePointUploadCallerFactory"),()=>(new Zk.a).create(),()=>new ye,H.AFrameworkApplication.ua)).singleInstance();this.W.register(hm,"Common.App.SaveToSharePoint.SaveToSharePointManager").as("Common.App.SaveToSharePoint.ISaveToSharePointManager").Yd(()=>new hm(this.W.resolve("Common.App.SaveToSharePoint.UploadToSharePointManager"),()=>new ye,this.W.resolve("Common.App.SaveToSharePoint.IOneDriveFilePickerHelper"),H.AFrameworkApplication.ua)).singleInstance();
this.W.register(ri,"Common.App.SaveToSharePoint.OneDriveFilePickerHelper").as("Common.App.SaveToSharePoint.IOneDriveFilePickerHelper").Yd(()=>new ri(this.W.resolve("Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV72"),new jb.a(()=>this.pze.result),H.AFrameworkApplication.ua,()=>new Rl)).singleInstance();this.W.register(Tg,"Common.App.SaveToSharePoint.FileNameDialogFactory").Yd(()=>new Tg(H.AFrameworkApplication.K,H.AFrameworkApplication.ya,H.AFrameworkApplication.ua,H.AFrameworkApplication.ua.Sb,
this.W.resolve("Common.App.SaveAsToHost.IErrorRetryDialogFactory"),this.W.resolve("Common.App.SaveAsToHost.IUploadToHostManager"),this.W.resolve("Common.App.SaveToSharePoint.ISaveToSharePointManager"),new jb.a(()=>this.yze.result),this.W.resolve("Common.App.SaveToSharePoint.UploadToSharePointManager"),this.Nld?this.Nld.result:null)).singleInstance();this.W.register(Tf,"Common.App.SaveToSharePoint.SaveToSharePointActor").Yd(()=>new Tf(H.AFrameworkApplication.K,H.AFrameworkApplication.ya,this.W.resolve("Common.App.SaveToSharePoint.FileNameDialogFactory"),
this.W.resolve("Common.App.SaveToSharePoint.ISaveToSharePointManager"),this.W.resolve("Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV72"),this.W.resolve("Common.App.SaveToSharePoint.IOneDriveFilePickerHelper"),()=>H.AFrameworkApplication.ua.vrk)).singleInstance();H.AFrameworkApplication.K.$("SaveToAnotherFolderBrsIsEnabled")&&this.W.resolve("Common.App.SaveToSharePoint.SaveToSharePointActor").Vb()}static main(){ca.a.instance.Oc(new dj)}}Object(e.a)(dj,"PackageManager",null,[1,2]);
class bi{}Object(e.a)(bi,"StringDifference",null,[1973]);class Qd{constructor(Q,ya){this.charCode=Q;this.description=ya}}Object(e.a)(Qd,"UBTableEntry",null,[]);class Mi{}new Qd(8,"C0 Controls 1");new Qd(9,"Horizontal tab (HT)");new Qd(10,"Line feed (LF)");new Qd(12,"C0 Controls 2");new Qd(13,"Carriage return (CR)");new Qd(31,"C0 Controls 3");new Qd(32,"Space");new Qd(47,"ASCII Punctuation and Symbols 1");new Qd(57,"ASCII Digits");new Qd(64,"ASCII Punctuation and Symbols 2");new Qd(90,"Uppercase Latin Alphabet");
new Qd(96,"ASCII Punctuation and Symbols 3");new Qd(122,"Lowercase Latin Alphabet");new Qd(127,"U+0000..U+007F Basic Latin");new Qd(159,"C1 Controls");new Qd(160,"NB Space");new Qd(191,"Latin-1 Punctuation and Symbols");new Qd(255,"U+0080..U+00FF Latin-1 Supplement");new Qd(383,"U+0100..U+017F Latin Extended-A");new Qd(591,"U+0180..U+024F Latin Extended-B");new Qd(687,"U+0250..U+02AF IPA Extensions");new Qd(767,"U+02B0..U+02FF Spacing Modifier Letters");new Qd(879,"U+0300..U+036F Combining Diacritical Marks");
new Qd(1023,"U+0370..U+03FF Greek and Coptic");new Qd(1279,"U+0400..U+04FF Cyrillic");new Qd(1327,"U+0500..U+052F Cyrillic Supplement");new Qd(1423,"U+0530..U+058F Armenian");new Qd(1535,"U+0590..U+05FF Hebrew");new Qd(1791,"U+0600..U+06FF Arabic");new Qd(1871,"U+0700..U+074F Syriac");new Qd(1919,"U+0750..U+077F Arabic Supplement");new Qd(1983,"U+0780..U+07BF Thaana");new Qd(2047,"U+07C0..U+07FF NKo");new Qd(2111,"U+0800..U+083F Samaritan");new Qd(2143,"U+0840..U+085F Mandaic");new Qd(2303,"U+08A0..U+08FF Arabic Extended-A");
new Qd(2431,"U+0900..U+097F Devanagari");new Qd(2559,"U+0980..U+09FF Bengali");new Qd(2687,"U+0A00..U+0A7F Gurmukhi");new Qd(2815,"U+0A80..U+0AFF Gujarati");new Qd(2943,"U+0B00..U+0B7F Oriya");new Qd(3071,"U+0B80..U+0BFF Tamil");new Qd(3199,"U+0C00..U+0C7F Telugu");new Qd(3327,"U+0C80..U+0CFF Kannada");new Qd(3455,"U+0D00..U+0D7F Malayalam");new Qd(3583,"U+0D80..U+0DFF Sinhala");new Qd(3711,"U+0E00..U+0E7F Thai");new Qd(3839,"U+0E80..U+0EFF Lao");new Qd(4095,"U+0F00..U+0FFF Tibetan");new Qd(4255,
"U+1000..U+109F Myanmar");new Qd(4351,"U+10A0..U+10FF Georgian");new Qd(4607,"U+1100..U+11FF Hangul Jamo");new Qd(4991,"U+1200..U+137F Ethiopic");new Qd(5023,"U+1380..U+139F Ethiopic Supplement");new Qd(5119,"U+13A0..U+13FF Cherokee");new Qd(5759,"U+1400..U+167F Unified Canadian Aboriginal Syllabics");new Qd(5791,"U+1680..U+169F Ogham");new Qd(5887,"U+16A0..U+16FF Runic");new Qd(5919,"U+1700..U+171F Tagalog");new Qd(5951,"U+1720..U+173F Hanunoo");new Qd(5983,"U+1740..U+175F Buhid");new Qd(6015,"U+1760..U+177F Tagbanwa");
new Qd(6143,"U+1780..U+17FF Khmer");new Qd(6319,"U+1800..U+18AF Mongolian");new Qd(6399,"U+18B0..U+18FF Unified Canadian Aboriginal Syllabics Extended");new Qd(6479,"U+1900..U+194F Limbu");new Qd(6527,"U+1950..U+197F Tai Le");new Qd(6623,"U+1980..U+19DF New Tai Lue");new Qd(6655,"U+19E0..U+19FF Khmer Symbols");new Qd(6687,"U+1A00..U+1A1F Buginese");new Qd(6831,"U+1A20..U+1AAF Tai Tham");new Qd(7039,"U+1B00..U+1B7F Balinese");new Qd(7103,"U+1B80..U+1BBF Sundanese");new Qd(7167,"U+1BC0..U+1BFF Batak");
new Qd(7247,"U+1C00..U+1C4F Lepcha");new Qd(7295,"U+1C50..U+1C7F Ol Chiki");new Qd(7375,"U+1CC0..U+1CCF Sundanese Supplement");new Qd(7423,"U+1CD0..U+1CFF Vedic Extensions");new Qd(7551,"U+1D00..U+1D7F Phonetic Extensions");new Qd(7615,"U+1D80..U+1DBF Phonetic Extensions Supplement");new Qd(7679,"U+1DC0..U+1DFF Combining Diacritical Marks Supplement");new Qd(7935,"U+1E00..U+1EFF Latin Extended Additional");new Qd(8191,"U+1F00..U+1FFF Greek Extended");new Qd(8303,"U+2000..U+206F General Punctuation");
new Qd(8351,"U+2070..U+209F Superscripts and Subscripts");new Qd(8399,"U+20A0..U+20CF Currency Symbols");new Qd(8447,"U+20D0..U+20FF Combining Diacritical Marks for Symbols");new Qd(8527,"U+2100..U+214F Letterlike Symbols");new Qd(8591,"U+2150..U+218F Number Forms");new Qd(8703,"U+2190..U+21FF Arrows");new Qd(8959,"U+2200..U+22FF Mathematical Operators");new Qd(9215,"U+2300..U+23FF Miscellaneous Technical");new Qd(9279,"U+2400..U+243F Control Pictures");new Qd(9311,"U+2440..U+245F Optical Character Recognition");
new Qd(9471,"U+2460..U+24FF Enclosed Alphanumerics");new Qd(9599,"U+2500..U+257F Box Drawing");new Qd(9631,"U+2580..U+259F Block Elements");new Qd(9727,"U+25A0..U+25FF Geometric Shapes");new Qd(9983,"U+2600..U+26FF Miscellaneous Symbols");new Qd(10175,"U+2700..U+27BF Dingbats");new Qd(10223,"U+27C0..U+27EF Miscellaneous Mathematical Symbols-A");new Qd(10239,"U+27F0..U+27FF Supplemental Arrows-A");new Qd(10495,"U+2800..U+28FF Braille Patterns");new Qd(10623,"U+2900..U+297F Supplemental Arrows-B");
new Qd(10751,"U+2980..U+29FF Miscellaneous Mathematical Symbols-B");new Qd(11007,"U+2A00..U+2AFF Supplemental Mathematical Operators");new Qd(11263,"U+2B00..U+2BFF Miscellaneous Symbols and Arrows");new Qd(11359,"U+2C00..U+2C5F Glagolitic");new Qd(11391,"U+2C60..U+2C7F Latin Extended-C");new Qd(11519,"U+2C80..U+2CFF Coptic");new Qd(11567,"U+2D00..U+2D2F Georgian Supplement");new Qd(11647,"U+2D30..U+2D7F Tifinagh");new Qd(11743,"U+2D80..U+2DDF Ethiopic Extended");new Qd(11775,"U+2DE0..U+2DFF Cyrillic Extended-A");
new Qd(11903,"U+2E00..U+2E7F Supplemental Punctuation");new Qd(12031,"U+2E80..U+2EFF CJK Radicals Supplement");new Qd(12255,"U+2F00..U+2FDF Kangxi Radicals");new Qd(12287,"U+2FF0..U+2FFF Ideographic Description Characters");new Qd(12351,"U+3000..U+303F CJK Symbols and Punctuation");new Qd(12447,"U+3040..U+309F Hiragana");new Qd(12543,"U+30A0..U+30FF Katakana");new Qd(12591,"U+3100..U+312F Bopomofo");new Qd(12687,"U+3130..U+318F Hangul Compatibility Jamo");new Qd(12703,"U+3190..U+319F Kanbun");new Qd(12735,
"U+31A0..U+31BF Bopomofo Extended");new Qd(12783,"U+31C0..U+31EF CJK Strokes");new Qd(12799,"U+31F0..U+31FF Katakana Phonetic Extensions");new Qd(13055,"U+3200..U+32FF Enclosed CJK Letters and Months");new Qd(13311,"U+3300..U+33FF CJK Compatibility");new Qd(19903,"U+3400..U+4DBF CJK Unified Ideographs Extension A");new Qd(19967,"U+4DC0..U+4DFF Yijing Hexagram Symbols");new Qd(40959,"U+4E00..U+9FFF CJK Unified Ideographs");new Qd(42127,"U+A000..U+A48F Yi Syllables");new Qd(42191,"U+A490..U+A4CF Yi Radicals");
new Qd(42239,"U+A4D0..U+A4FF Lisu");new Qd(42559,"U+A500..U+A63F Vai");new Qd(42655,"U+A640..U+A69F Cyrillic Extended-B");new Qd(42751,"U+A6A0..U+A6FF Bamum");new Qd(42783,"U+A700..U+A71F Modifier Tone Letters");new Qd(43007,"U+A720..U+A7FF Latin Extended-D");new Qd(43055,"U+A800..U+A82F Syloti Nagri");new Qd(43071,"U+A830..U+A83F Common Indic Number Forms");new Qd(43135,"U+A840..U+A87F Phags-pa");new Qd(43231,"U+A880..U+A8DF Saurashtra");new Qd(43263,"U+A8E0..U+A8FF Devanagari Extended");new Qd(43311,
"U+A900..U+A92F Kayah Li");new Qd(43359,"U+A930..U+A95F Rejang");new Qd(43391,"U+A960..U+A97F Hangul Jamo Extended-A");new Qd(43487,"U+A980..U+A9DF Javanese");new Qd(43615,"U+AA00..U+AA5F Cham");new Qd(43647,"U+AA60..U+AA7F Myanmar Extended-A");new Qd(43743,"U+AA80..U+AADF Tai Viet");new Qd(43775,"U+AAE0..U+AAFF Meetei Mayek Extensions");new Qd(43823,"U+AB00..U+AB2F Ethiopic Extended-A");new Qd(44031,"U+ABC0..U+ABFF Meetei Mayek");new Qd(55215,"U+AC00..U+D7AF Hangul Syllables");new Qd(55295,"U+D7B0..U+D7FF Hangul Jamo Extended-B");
new Qd(56191,"U+D800..U+DB7F High Surrogates");new Qd(56319,"U+DB80..U+DBFF High Private Use Surrogates");new Qd(57343,"U+DC00..U+DFFF Low Surrogates");new Qd(63743,"U+E000..U+F8FF Private Use Area");new Qd(64255,"U+F900..U+FAFF CJK Compatibility Ideographs");new Qd(64335,"U+FB00..U+FB4F Alphabetic Presentation Forms");new Qd(65023,"U+FB50..U+FDFF Arabic Presentation Forms-A");new Qd(65039,"U+FE00..U+FE0F Variation Selectors");new Qd(65055,"U+FE10..U+FE1F Vertical Forms");new Qd(65071,"U+FE20..U+FE2F Combining Half Marks");
new Qd(65103,"U+FE30..U+FE4F CJK Compatibility Forms");new Qd(65135,"U+FE50..U+FE6F Small Form Variants");new Qd(65279,"U+FE70..U+FEFF Arabic Presentation Forms-B");new Qd(65519,"U+FF00..U+FFEF Halfwidth and fullwidth forms");new Qd(65535,"U+FFF0..U+FFFF Specials");new Qd(65663,"U+10000..U+1007F Linear B Syllabary");new Qd(65791,"U+10080..U+100FF Linear B Ideograms");new Qd(65855,"U+10100..U+1013F Aegean Numbers");new Qd(65935,"U+10140..U+1018F Ancient Greek Numbers");new Qd(65999,"U+10190..U+101CF Ancient Symbols");
new Qd(66047,"U+101D0..U+101FF Phaistos Disc");new Qd(66207,"U+10280..U+1029F Lycian");new Qd(66271,"U+102A0..U+102DF Carian");new Qd(66351,"U+10300..U+1032F Old Italic");new Qd(66383,"U+10330..U+1034F Gothic");new Qd(66463,"U+10380..U+1039F Ugaritic");new Qd(66527,"U+103A0..U+103DF Old Persian");new Qd(66639,"U+10400..U+1044F Deseret");new Qd(66687,"U+10450..U+1047F Shavian");new Qd(66735,"U+10480..U+104AF Osmanya");new Qd(67647,"U+10800..U+1083F Cypriot Syllabary");new Qd(67679,"U+10840..U+1085F Imperial Aramaic");
new Qd(67871,"U+10900..U+1091F Phoenician");new Qd(67903,"U+10920..U+1093F Lydian");new Qd(67999,"U+10980..U+1099F Meroitic Hieroglyphs");new Qd(68095,"U+109A0..U+109FF Meoritic Cursive");new Qd(68191,"U+10A00..U+10A5F Kharoshthi");new Qd(68223,"U+10A60..U+10A7F Old South Arabian");new Qd(68415,"U+10B00..U+10B3F Avestan");new Qd(68447,"U+10B40..U+10B5F Inscriptional Parthian");new Qd(68479,"U+10B60..U+10B7F Inscriptional Pahlavi");new Qd(68687,"U+10C00..U+10C4F Old Turkic");new Qd(69247,"U+10E60..U+10E7F Rumi Numeral Symbols");
new Qd(69759,"U+11000..U+1107F Brahmi");new Qd(69839,"U+11080..U+110CF Kaithi");new Qd(69887,"U+110D0..U+110FF Sora Sompeng");new Qd(69967,"U+11100..U+1114F Chakma");new Qd(70111,"U+11180..U+111DF Sharada");new Qd(71375,"U+11680..U+116CF Takri");new Qd(74751,"U+12000..U+123FF Cuneiform");new Qd(74879,"U+12400..U+1247F Cuneiform Numbers and Punctuation");new Qd(78895,"U+13000..U+1342F Egyptian Hieroglyphs");new Qd(92735,"U+16800..U+16A3F Bamum Supplement");new Qd(94111,"U+16F00..U+16F9F Miao");new Qd(110847,
"U+1B000..U+1B0FF Kana Supplement");new Qd(119039,"U+1D000..U+1D0FF Byzantine Musical Symbols");new Qd(119295,"U+1D100..U+1D1FF Musical Symbols");new Qd(119375,"U+1D200..U+1D24F Ancient Greek Musical Notation");new Qd(119647,"U+1D300..U+1D35F Tai Xuan Jing Symbols");new Qd(119679,"U+1D360..U+1D37F Counting Rod Numerals");new Qd(120831,"U+1D400..U+1D7FF Mathematical Alphanumeric Symbols");new Qd(126719,"U+1EE00..U+1EEFF Arabic Mathematical Alphabetic Symbols");new Qd(127023,"U+1F000..U+1F02F Mahjong Tiles");
new Qd(127135,"U+1F030..U+1F09F Domino Tiles");new Qd(127231,"U+1F0A0..U+1F0FF Playing Cards");new Qd(127487,"U+1F100..U+1F1FF Enclosed Alphanumeric Supplement");new Qd(127743,"U+1F200..U+1F2FF Enclosed Ideographic Supplement");new Qd(128511,"U+1F300..U+1F5FF Miscellaneous Symbols and Pictographs");new Qd(128591,"U+1F600..U+1F64F Emoticons");new Qd(128767,"U+1F680..U+1F6FF Transport and Map Symbols");new Qd(128895,"U+1F700..U+1F77F Alchemical Symbols");new Qd(173791,"U+20000..U+2A6DF CJK Unified Ideographs Extension B");
new Qd(177983,"U+2A700..U+2B73F CJK Unified Ideographs Extension C");new Qd(178207,"U+2B740..U+2B81F CJK Unified Ideographs Extension D");new Qd(195103,"U+2F800..U+2FA1F CJK Compatibility Ideographs Supplement");new Qd(917631,"U+E0000..U+E007F Tags");new Qd(917999,"U+E0100..U+E01EF Variation Selectors Supplement");new Qd(1048575,"U+F0000..U+FFFFF Supplementary Private Use Area-A");new Qd(1114111,"U+100000..U+10FFFF Supplementary Private Use Area-B");Object(e.a)(Mi,"UnicodeBlocks",null,[1977]);class Hn{constructor(){this.W=
null}yc(Q){this.W=Q;this.W.register(bi,"Common.App.SensitiveLogging.StringDifference").as("Common.App.SensitiveLogging.IStringDifference").singleInstance();this.W.register(Mi,"Common.App.SensitiveLogging.UnicodeBlocks").as("Common.App.SensitiveLogging.IUnicodeBlocks").singleInstance()}get name(){return"Common.App.SensitiveLogging"}init(){this.W.resolve("Common.App.SensitiveLogging.IStringDifference");this.W.resolve("Common.App.SensitiveLogging.IUnicodeBlocks")}dispose(){}static main(){ca.a.instance.Oc(new Hn)}}
Object(e.a)(Hn,"SensitiveLoggingPackage",null,[1,2]);var Df;(function(Q){Q[Q.myFiles=0]="myFiles";Q[Q.recent=1]="recent";Q[Q.currentFolder=2]="currentFolder";Q[Q.yourPhone=3]="yourPhone"})(Df||(Df={}));Object(e.b)("SharedFilePickerLandingLocation",Df);class ci{constructor(Q){this.RBb=this.sbc=null;this._initialized=!1;this.Nlf=Q}l7e(Q){this._initialized||(Q.xv(Oe.a.kKi),Q.cC(Oe.a.kKi,Object(a.a)(this,this.WVm,"onReceivedPickerResponse")),this._initialized=!0)}Udf(Q){return this.RBb=new Promise((ya,
gb)=>{const Ob={};Ob[gf.a.A4m]=Q;this.sbc=(mc,dd)=>{""===dd?(la.ULS.sendTraceTag(572548163,306,50,"Resolving Promise with Picker Data"),ya(mc)):("Canceled"===dd?la.ULS.sendTraceTag(572548164,306,50,dd):la.ULS.sendTraceTag(556901065,306,10,dd),gb(dd))};this.Nlf.execute(mc=>{this.l7e(mc);mc.sendMessage(Oe.a.h_m,Ob)})})}WVm(Q){this.sbc(Q.Values[gf.a.mEn],void 0===Q.Values[gf.a.sLf]||null===Q.Values[gf.a.sLf]?"":Q.Values[gf.a.sLf])}ztf(){return H.AFrameworkApplication.K.$("UiHostCommonFilePicker")}R_e(Q,
ya,gb,Ob,mc,dd,Md,He,Ue=null){const Sf={};Sf[gf.a.NDn]=Q;Sf[gf.a.titleText]=ya;Sf[gf.a.lak]=gb;Sf[gf.a.mak]=Ob;Sf[gf.a.oak]=mc;Sf[gf.a.MXk]=!0;Sf[gf.a.g8k]=dd;Sf[gf.a.E4m]=Md;Sf[gf.a.D4m]=Df[He];Jg.a("isSharedUXDarkModeOn")&&appChrome.api.isSharedUXDarkModeOn()&&(Sf[gf.a.F4m]="Dark");Ue&&(null!=Ue.rXb&&(Sf[gf.a.rXb]=Ue.rXb),null!=Ue.h5b&&(Sf[gf.a.h5b]=Ue.h5b));return Sf}}Object(e.a)(ci,"SharedFilePickerManager",null,[1981]);class Ll{constructor(){this.W=null}get name(){return"Common.App.SharedFilePicker"}yc(Q){this.W=
Q;Q.register(ci,"Common.App.SharedFilePicker.SharedFilePickerManager").as("Common.App.SharedFilePicker.ISharedFilePicker").singleInstance().Yd(()=>new ci(Q.Za("Postmessage.IHostPostmessenger")))}init(){H.AFrameworkApplication.K.zq(()=>{this.EZa()})}EZa(){this.W.resolve("Common.App.SharedFilePicker.ISharedFilePicker")}dispose(){}static main(){ca.a.instance.Oc(new Ll)}}Object(e.a)(Ll,"SharedFilePickerPackage",null,[1,2]);class Wc extends Sys.EventArgs{constructor(Q){super();this.nLm=Q}}Object(e.a)(Wc,
"TypingSpeedMeterChangedEventArgs",Sys.EventArgs,[]);class dk{}Object(e.a)(dk,"TypingSpeedMeterWindow",null,[]);class Ni{constructor(Q,ya,gb,Ob,mc){this.yAf=null;this.jAg=this.aod=this.dKe=this.o$b=0;this.hLe=new k.a;this.uy=Q;this.Ih=ya;this.Ih.hrd(Object(a.a)(this,this.iGb,"onCpuMeterFrameAvailable"));this.FYj=gb;this.nMj=mc;this.YXj=Ob}w8j(Q){this.hLe.addHandler("TypingSpeedWindowAvailable",Q)}csn(Q){this.hLe.removeHandler("TypingSpeedWindowAvailable",Q)}iGb(Q,ya){this.yAf=ya.BSc}zji(){var Q=this.uy();
Q-this.aod>this.YXj&&this.QRi();this.o$b||(this.dKe=Q);this.aod=Q;this.o$b++;this.o$b>=this.nMj&&(this.hLe.raiseEvent("TypingSpeedWindowAvailable",new Wc(this.sjh())),Q=new dk,Q.TS=this.sjh(),this.yAf&&(Q.CP=this.yAf.CP),Q.EC=this.jAg,this.FYj.track(Q),this.QRi())}QRi(){this.aod=this.dKe=this.o$b=0}sjh(){return 2>this.o$b?0:Math.round(6E4*(this.o$b-1)/(this.aod-this.dKe))}Mko(Q){this.jAg=Q}dispose(){this.Ih.KSf(Object(a.a)(this,this.iGb,"onCpuMeterFrameAvailable"))}}Object(e.a)(Ni,"TypingSpeedMeter",
null,[2001]);class Ld{constructor(Q){this.gub=null;this.fr=new t.a;this.uy=Q}initialize(Q,ya,gb,Ob){this.gub||(this.gub=new Ni(this.uy,Q,ya,gb,Ob),this.fr.Gg(this.gub));return this.gub}}Object(e.a)(Ld,"TypingSpeedMeterProvider",null,[1972]);class Gk{constructor(){this.gLe=null}get name(){return"Common.App.TypingSpeedMeter"}init(){if(H.AFrameworkApplication.K.$("TypingSpeedMeterIsEnabled")){const Q=qa.a.instance.resolve("Common.App.TypingSpeedMeter.TypingSpeedMeterProvider"),ya=gl.a.Kq(qa.a.instance.Za("Common.ICpuMeterProvider"));
ya.continueWith(()=>{const gb=ya.result.fr.task;var Ob=new Ca.a(H.AFrameworkApplication.K.rc("TypingSpeedMeterWindowSamplingPercent",0)/100);Ob=new wa.a(Object(a.a)(Ob,Ob.S2a,"shouldBeInSample"));const mc=P.a.sF(12,1,Ob),dd=H.AFrameworkApplication.K.rc("TypingSpeedMeterWindowTimeoutMs",5E3),Md=H.AFrameworkApplication.K.rc("TypingSpeedMeterMaxKeystrokesPerWindow",5);gb.CWR(()=>this.gLe=Q.initialize(gb.result,mc,dd,Md))})}}dispose(){this.gLe&&this.gLe.dispose()}yc(Q){Q.register(Ld,"Common.App.TypingSpeedMeter.TypingSpeedMeterProvider").as("Common.ITypingSpeedMeterProvider").singleInstance().Yd(()=>
new Ld(ra.a.lf))}static main(){ca.a.instance.Oc(new Gk)}}Object(e.a)(Gk,"TypingSpeedMeterPackage",null,[1,2]);class bl{create(Q){return new Ca.a(Q)}}Object(e.a)(bl,"RandomSamplerFactory",null,[857]);var Ae=d(9),mg=d(1394);class xk{constructor(Q,ya,gb,Ob,mc){Q.S7j(()=>{Ob.sYc()});Q.n8j((dd,Md)=>{Ob.qYc(Md.revisionId,Md.Q0a)});Q.vPe((dd,Md)=>{Ob.t0l(Md.tzn,Md.Q0a,Md.Qaj)});Q.R7j(()=>{Ob.CTf()});ya.q8j((dd,Md)=>{Ob.K8n(Md.oQi,Md.Nae,Md.actualValue)});ya.e7j((dd,Md)=>{Ob.J8n(Md.oQi,Md.Nae,Md.actualValue)});
mc.grd(()=>{Ob.n3c()});gb.p1((dd,Md)=>{6===Md.type&&Ob.adc(Md.dJ)})}}Object(e.a)(xk,"EventForwarder",null,[]);class lf{constructor(Q,ya,gb){this.ANj=Q;this.KM=gb;this.FVb=ya}create(Q,ya){return new xk(this.ANj,this.FVb,Q,ya,this.KM)}}Object(e.a)(lf,"EventForwarderFactory",null,[]);var ej=d(438);class hl{}hl.Ddo="TypingToOutboundReplicationStart";hl.J_m="OutboundReplicationStartToOutboundReplicationEnd";hl.KTi="RtcNotificationToInboundReplicationEnd";hl.Kej="TypingToInboundReplicationEnd";Object(e.a)(hl,
"PerfTrackerPhases",null,[]);class Xh{constructor(Q,ya,gb,Ob,mc,dd,Md,He,Ue=null){this.rye=this.uPg=!1;this.kAe=5;this.UQg=50;this.Pye=20;this.mxe=this.zye=this.Ewa=null;this.zlc=this.qlc=0;this.mIe=this.wJe=!1;this.znd=Array(7);this.Tic=null;this.VGg=!1;this.Uje=null;this.gga={};this.Ecd=Q;this.JRa=ya;this.bMj=gb;this.KIg=Ob.create(hl.KTi,mc,dd,20,!1);this.Fod=Ob.create(hl.Kej,Md,He,20,!0);if(this.Oa=H.AFrameworkApplication.K)this.uPg=this.Oa.$("LogSteppedInboundFrameIsEnabled"),this.rye=this.Oa.$("LogTasksDetailsFromCPUMeterIsEnabled"),
this.Pye=this.Oa.rc("InboundFrameMaxNumberOfLongRunningTasks",20),this.UQg=this.Oa.rc("InboundFrameMinLengthForLongRunningTasksInMs",50),this.kAe=this.Oa.rc("InboundFrameNumberOfLastShortTasks",5);this.Xnb=Ue}get uuk(){null==this.Uje&&(this.Uje=!!this.Oa&&this.Oa.$("InboundRequestTakesTooLongToSendAfterRTCTelemetryIsEnabled"));return this.Uje}initialize(Q){this.Ewa=Q}Mun(Q,ya,gb=null){this.Cmh();la.ULS.shipAssertTag(8229761,324,0<Q.length);let Ob=!1;for(const dd of Q){const Md=dd.toString();if(Md in
this.gga){var mc=this.gga[Md];if(!mc.Gdc){mc.sXi(Q,ya,gb);if(this.rye&&!Ob){const He=this.B6k(),Ue=this.dgl(this.Tic);Ob=!0;this.Bni(dd.toString(),mc,He,this.mxe,this.znd,Ue)}else this.Bni(dd.toString(),mc,null,null,this.znd,null);delete this.gga[Md]}}else mc=this.Ecd.create(this.KIg,this.Fod),mc.sXi(Q,ya),this.gga[Md]=mc}this.mIe=!1}adc(Q){la.ULS.shipAssertTag(8257930,304,Q.Tii,"Expected data not sent on the wire");if(Q.Tii){if(Q.Q4d in this.gga){var ya=this.gga[Q.Q4d];ya.e5d||(ya.adc(Q.revisionId,
Q.YBi,Q.A3i,Q.Q0a),delete this.gga[Q.Q4d])}else ya=this.Ecd.create(this.KIg,this.Fod),ya.adc(Q.revisionId,Q.YBi,Q.A3i,Q.Q0a),this.gga[Q.Q4d]=ya;this.Cmh()}}Z1l(){this.wJe||(this.zye=Array(this.Pye),this.mxe=Array(this.kAe),this.zlc=this.qlc=0,this.znd=[0,0,0,0,0,0,0,0],this.Tic=Array(3),this.Tic[1]=[0,0],this.Tic[2]=[0,0],this.wJe=!0)}yUn(Q){return!Q.TP&&Q.TN===I.a.iQi&&(Q=ej.a(this.gga))&&Q[0]?!0:!1}$Qm(Q){this.wJe=!1;const ya=ej.a(this.gga);ya&&ya[0]&&(Q.TRT>=this.UQg&&this.qlc<this.Pye?this.zye[this.qlc++]=
Q:(this.mxe[this.zlc]=Q,this.zlc=this.zlc<this.kAe-1?this.zlc+1:0),this.uBm(Q),this.MBm(Q))}ZQm(){this.rye&&(this.Z1l(),this.mIe=!0)}uBm(Q){this.znd[Q.TP]++}MBm(Q){if(Q&&Q.UI){const ya=this.Tic[Q.UI];ya[0]+=1;ya[1]+=Q.TRT}}dgl(Q){const ya={};Q&&(Q[1]&&(ya.Typing=Q[1]),Q[2]&&(ya.Clicking=Q[2]));return ya}B6k(){return this.qlc?this.zye.slice(0,this.qlc-1):null}Cmh(){var Q=ej.a(this.gga);if(Q&&(this.VGg||this.xCm(Q),Q.length>this.bMj))for(const ya of Q){Q=this.gga[ya];const gb=Q.createdTime,Ob=this.JRa();
6E4<Ob-gb&&(v.b(8438528,304,50,"{0}",{["Not Received"]:Q.Gdc?"RtcNotification":"ServerRevision",["Duration"]:Ob-gb}),Q.Gdc||v.b(42075798,304,15,"{0}",{["RevisionId"]:ya,["Duration"]:Ob-gb}),delete this.gga[ya])}}xCm(Q){if(this.uuk&&this.Xnb)for(const ya of Q)if(Q=this.gga[ya],Q.e5d&&!Q.Gdc&&(Q=Q.createdTime,2E3<this.JRa()-Q)){let gb=null;Ae.App.xa&&Ae.App.xa.jb&&Ae.App.xa.jb.Yc&&(gb=Ae.App.xa.jb.Yc.contentReplicator);this.Xnb.execute(Ob=>{Ob.flush(gb,1)});this.VGg=!0}}Bni(Q,ya,gb,Ob,mc,dd){this.uPg&&
(ya=ya.Ofl())&&(ya.RevisionId=Q,ya.LRTWR=gb,ya.LSTWR=Ob,ya.TSD=mc,ya.UIWR=dd,this.Ewa&&this.Ewa.track(ya))}}Object(e.a)(Xh,"InboundMonitor",null,[1996]);class Cd{constructor(Q,ya,gb,Ob){this.dA=ya;this.Ecd=gb;this.VXj=Ob}create(Q,ya,gb,Ob,mc=null){return new Xh(this.Ecd,this.dA,50,this.VXj,Q,ya,gb,Ob,mc)}}Object(e.a)(Cd,"InboundMonitorFactory",null,[1960]);var db=d(299);class Db{}Db.yde="UserCount";Db.pzn="RevisionChainLength";Object(e.a)(Db,"PerfTrackerPivotNames",null,[]);class Yb{}Object(e.a)(Yb,
"PerfTrackingContext",null,[]);const zc=Q=>5>=Q?"5AndFewer":10>=Q?"6To10":15>=Q?"11To15":20>=Q?"15To20":25>=Q?"21To25":30>=Q?"26To30":"31AndAbove";class Vc{}Object(e.a)(Vc,"SteppedInboundFrame",null,[]);class bd{constructor(Q,ya,gb,Ob,mc){this.V8a=this.Gcd=null;this.FIg=500;this.Fcd=this.Vpa=this.dqb=this.dRb=this.f6c=-1;this.kgg=null;this.u_g=this.lZg=!1;this.PYg=null;this.xUg=this.XHa=0;this.wTb=Q;this.createdTime=ya();this.Yld=!1;this.wBe=0;this.Irb=gb;this.nHj=Ob;this.Fod=mc;H.AFrameworkApplication.K&&
(this.FIg=H.AFrameworkApplication.K.rc("InboundFrameSamplingMinimalTotalTimeMs",500))}get e5d(){return this.lZg}get Gdc(){return this.u_g}get QSi(){return this.PYg}get Q0a(){return this.XHa}get I_m(){return this.xUg}get Dyb(){return this.Irb()}adc(Q,ya,gb,Ob){this.e5d||(this.Yld=gb,this.wBe=ya,this.f6c=F.a.nU(ra.a.lf(),2),this.kgg=(new Date).toISOString(),this.V8a=Q,this.xUg=Ob,this.lZg=!0,this.Gdc?this.KDh():(this.$7i(),da.a.instance.Ey(Q.toString()+"Start"),db.a.instance.nUd(2)))}sXi(Q,ya,gb=null){this.Gdc||
(this.XHa=ya,this.u_g=!0,this.PYg=Q,this.Fcd=F.a.nU(ra.a.lf(),2),this.e5d&&(da.a.instance.Ey(this.V8a.toString()+"End"),gb&&(this.dRb=gb.Vvn,this.dqb=gb.d2a,this.Vpa=gb.Nun),db.a.instance.Rud(),this.KDh()))}Ofl(){if(!(0<this.f6c&&0<this.dRb&&0<this.dqb&&0<this.Vpa&&0<this.Fcd))return null;const Q=new Vc;Q.TT=F.a.nU(this.Fcd-this.f6c,2);if(Q.TT<this.FIg)return null;Q.ST=this.kgg;Q.UC=this.Dyb;Q.RS=F.a.nU(this.dRb-this.f6c,2);Q.SR=F.a.nU(this.dqb-this.dRb,2);Q.RRS=F.a.nU(this.Vpa-this.dqb,2);Q.RP=F.a.nU(this.Fcd-
this.Vpa,2);Q.ResponseLanded=F.a.nU(this.dqb,2);0<Q.RS?(da.a.instance.pX("RTCToRequestSent",this.V8a.toString()+"Start","RequestInvoked"+this.dRb),da.a.instance.pX("RequestSentToResponseReceived","RequestInvoked"+this.dRb,"RequestCompleted"+this.dqb),da.a.instance.pX("ResponseReceivedToReplicationStart","RequestCompleted"+this.dqb,"ReplicationStart"+this.Vpa)):da.a.instance.pX("RTCToReplicationStart",this.V8a.toString()+"Start","ReplicationStart"+this.Vpa);da.a.instance.pX("Replication","ReplicationStart"+
this.Vpa,this.V8a.toString()+"End");return Q}$7i(){this.Gcd=this.wTb.create();this.Gcd.start(hl.KTi,hl.Kej)}KDh(){this.Gcd||this.$7i();const Q=this.Gcd.end(this.Yld,this.sMk());this.nHj.o4d(Q);this.Fod.o4d(Q+this.wBe)}sMk(){const Q={};Q[Db.yde]=zc(this.Dyb);var ya=this.QSi.length;Q[Db.pzn]=9>=ya?ya.toString():"10AndAbove";return Object.assign(new Yb,{P:Q,FC:this.Q0a,CFC:this.I_m+this.Q0a,ID:this.V8a.toString(),CD:this.wBe,UC:this.Dyb,RCL:this.QSi.length})}}Object(e.a)(bd,"InboundOperation",null,[1995]);
class ce{constructor(Q,ya,gb){this.MGa=Q;this.JRa=ya;this.Irb=gb}create(Q,ya){return new bd(this.MGa,this.JRa,this.Irb,Q,ya)}}Object(e.a)(ce,"InboundOperationFactory",null,[1961]);class ud{constructor(Q,ya,gb,Ob,mc,dd,Md,He,Ue){this.Zld=!0;this.FVg=this.Aid=null;this.oO=Sf=>{this.jj.oO(6,Sf)};this.vBe=Q;this.zCj=ya;this.xQj=gb;this.jj=Ob;this.iLe=mc.create("TypingToOutboundReplicationStart",dd,Md,20,!1);this.CEe=mc.create("OutboundReplicationStartToOutboundReplicationEnd",He,Ue,20,!1)}get bLf(){return this.Aid}get w_d(){return this.FVg}n3c(){!this.bLf&&
this.Zld&&(this.Zld=this.zCj())&&(this.Aid=this.vBe.create(this.oO,this.xQj(),this.iLe,this.CEe),this.bLf.n3c())}sYc(){this.Zld=!0;this.FVg=this.bLf;this.w_d&&(this.Aid=null,this.w_d.sYc())}CTf(){this.Aid=null}qYc(Q,ya){this.w_d&&this.w_d.qYc(Q,ya)}}Object(e.a)(ud,"OutboundMonitor",null,[]);class Sb{constructor(Q,ya){this.vBe=Q;this.pPj=ya}create(Q,ya,gb,Ob,mc,dd,Md){return new ud(this.vBe,Q,ya,gb,this.pPj,Ob,mc,dd,Md)}}Object(e.a)(Sb,"OutboundMonitorFactory",null,[]);var Gf=d(59);class gg{constructor(Q){this.l9a=
Q}get tfn(){return this.l9a}xb(Q){return!!this.l9a&&Q in this.l9a}get Tii(){return this.xb(gg.mAd)&&this.xb(gg.TIb)&&this.xb(gg.L_f)}get revisionId(){if(this.xb(gg.TIb))return Gf.a.Of(this.l9a[gg.TIb]);throw Error.create("Unable to parse RevisionIdKey key from dictionary into string");}get Q4d(){if(this.xb(gg.TIb))return this.l9a[gg.TIb];throw Error.create("Unable to cast RevisionIdKey key from dictionary into string");}get YBi(){if(this.xb(gg.mAd))return Number.parseInvariant(this.l9a[gg.mAd]);throw Error.create("Unable to parse DurationKey key from dictionary into int");
}get A3i(){if(this.xb(gg.TIb))return Boolean.parse(this.l9a[gg.L_f]);throw Error.create("Unable to parse ShouldSample key from dictionary into bool");}get Q0a(){if(this.xb(gg.zEf))return Number.parseInvariant(this.l9a[gg.zEf]);throw Error.create("Unable to parse NumSequentailFailuresKey key from dictionary into int");}static RJk(Q){return new gg(Q)}static WJk(Q,ya,gb,Ob){const mc={};mc[gg.mAd]=Q.toString();mc[gg.TIb]=ya.toString();mc[gg.L_f]=gb.toString();mc[gg.zEf]=Ob.toString();return new gg(mc)}}
gg.TIb="RevisionID";gg.mAd="Duration";gg.L_f="ShouldSample";gg.zEf="NumSequentialFailures";Object(e.a)(gg,"ReplicationNotificationMessage",null,[1993]);class mi{constructor(Q,ya,gb,Ob,mc,dd,Md){this.Fr=this.Gi=0;this.Wrb=this.Xwc=null;this.ghe=[];this.DWg=null;this.T$c={};this.XHa=0;this.wTb=Q;this.STj=ya;this.JRa=gb;this.Irb=Ob;this.r0g=mc;this.V8a=null;this.T$c.TypingStartStage=null;this.T$c.ReplicationStartStage="TypingStartStage";this.T$c.ReplicationEndStage="ReplicationStartStage";this.P4g=1<
this.Dyb;this.iLe=dd;this.CEe=Md}get Dyb(){return this.Irb()}n3c(){this.oWe("TypingStartStage")&&(this.GQf("TypingStartStage"),la.ULS.shipAssertTag(8257931,324,!this.Wrb&&!this.Fr,"ReplicationStart or ReplicationEnd were calledbefore TypingStart"),this.Gi=this.JRa(),this.Xwc=this.wTb.create(),this.S7i(this.Xwc,hl.Ddo))}sYc(){if(this.oWe("ReplicationStartStage")){this.GQf("ReplicationStartStage");la.ULS.shipAssertTag(8257932,324,!!this.Xwc,"TypingStart not called");if(this.Xwc){const Q=this.FDh(this.Xwc,
this.V8a);this.iLe.o4d(Q)}this.Wrb=this.wTb.create();this.S7i(this.Wrb,hl.J_m)}}qYc(Q,ya){this.oWe("ReplicationEndStage")&&(this.GQf("ReplicationEndStage"),this.Fr=this.JRa(),this.XHa=ya,la.ULS.shipAssertTag(8257933,324,!!this.Wrb,"ReplicationStart not called"),this.Wrb&&(la.ULS.shipAssertTag(8193425,324,!!this.Wrb,"ReplicationStart not called"),ya=this.FDh(this.Wrb,Q),this.CEe.o4d(ya)),la.ULS.shipAssertTag(8257934,324,!!this.Gi,"StartTime not set. No message sent to other editors."),this.Gi&&(Q=
gg.WJk(this.Fr-this.Gi,Q,this.r0g,this.XHa),this.STj(Q.tfn)))}oWe(Q){if(this.T$c[Q]===this.DWg)return!0;la.ULS.shipAssertTag(8422940,324,!1,"{0}",{["Previous stage mismatch"]:this.H0j()});return!1}H0j(){const Q=new Sys.StringBuilder;Q.append("Actual Phase:");for(let ya=0;ya<this.ghe.length;ya++)Q.append(" "+this.ghe[ya]);return Q.toString()}GQf(Q){this.ghe.push(Q);this.DWg=Q}S7i(Q,ya){this.P4g&&Q.start(ya)}FDh(Q,ya){if(!this.P4g)return-1;const gb={};gb[Db.yde]=zc(this.Dyb);ya=Object.assign(new Yb,
{P:gb,FC:this.XHa,CFC:0,ID:ya?ya.toString():"",CD:0,UC:this.Dyb,RCL:0});return Q.end(this.r0g,ya)}}Object(e.a)(mi,"OutboundOperation",null,[1992]);class ni{constructor(Q,ya,gb){this.wTb=Q;this.JRa=ya;this.Irb=gb}create(Q,ya,gb,Ob){return new mi(this.wTb,Q,this.JRa,this.Irb,ya,gb,Ob)}}Object(e.a)(ni,"OutboundOperationFactory",null,[1959]);class hi{constructor(Q,ya){this.Uyg=this._name=this.a1=null;this.le=Q;this.Ewa=ya}start(Q,ya=null){this.a1=this.le.hg("UserAction",Q);this._name=Q;this.Uyg=ya}end(Q,
ya){let gb=-1;Q&&(gb=this.a1.oi,ya.D=gb,ya.CN=this.Uyg,ya.CD+=gb,this.Ewa.track(ya,this._name));return gb}}Object(e.a)(hi,"PerfTracker",null,[1994]);class nh{constructor(Q,ya){this.le=Q;this.Ewa=ya}create(){return new hi(this.le,this.Ewa)}}Object(e.a)(nh,"PerfTrackerFactory",null,[1962]);class Da{constructor(Q,ya,gb){this.Usc=null;this.oPj=Q;this.JIg=ya;this.PTb=gb}init(Q,ya,gb,Ob,mc,dd,Md){ya=this.PTb.create(ya/100);gb=this.PTb.create(gb/100);this.Usc=this.oPj.create(Object(a.a)(ya,ya.S2a,"shouldBeInSample"),
Object(a.a)(gb,gb.S2a,"shouldBeInSample"),Q,Ob,mc,dd,Md)}n3c(){this.Usc.n3c()}sYc(){this.Usc.sYc()}CTf(){this.Usc.CTf()}qYc(Q,ya){this.Usc.qYc(Q,ya)}t0l(Q,ya,gb=null){this.JIg.Mun(Q,ya,gb)}adc(Q){Q=gg.RJk(Q);this.JIg.adc(Q);da.a.instance.Ey(Q.revisionId+"Start")}K8n(Q,ya,gb){v.b(9041820,304,50,"ReplicationTelemetry KPI Threshold Exceeded: [{0}]",this.xxd(Q,ya,gb))}J8n(Q,ya,gb){v.b(9041821,304,50,"ReplicationTelemetry KPI Average Threshold Exceeded: [{0}]",this.xxd(Q,ya,gb))}xxd(Q,ya,gb){const Ob=
{};Ob.PhaseName=Q;Ob.ThresholdValue=ya;Ob.ActualValue=gb;return Ob}}Object(e.a)(Da,"ReplicationTelemetryManager",null,[]);var sb=d(929);class ec extends sb.a{constructor(Q,ya){super(Q,ya);this.ej=this.Xmd=0}gva(Q){this.Xmd+=Q;this.ej++}getValue(){return this.ej?this.Xmd/this.ej:0}XOa(){this.ej=this.Xmd=0}}Object(e.a)(ec,"AverageMetric",sb.a,[]);class Jc extends sb.a{constructor(Q,ya){super(Q,ya);this.Nxa=0}gva(Q){Q>this.Nxa&&(this.Nxa=Q)}getValue(){return this.Nxa}XOa(){this.Nxa=0}}Object(e.a)(Jc,
"MaxMetric",sb.a,[]);var jd=d(1814);class Ud extends sb.a{constructor(Q,ya,gb=100){super(Q,ya);this.Qfd=this.MSb=this.oVb=0;this.Fkd=gb;this.uFe=new jd.a(this.Fkd)}gva(Q){if(this.MSb===this.Fkd){const ya=this.uFe.dequeue();this.oVb-=ya;this.MSb--}this.uFe.enqueue(Q);this.oVb+=Q;this.MSb++;Q=this.oVb/this.MSb;Q>this.Qfd&&this.MSb===this.Fkd&&(this.Qfd=Q)}getValue(){return this.Qfd}XOa(){this.Qfd=0;this.uFe=new jd.a(this.Fkd);this.MSb=this.oVb=0}}Object(e.a)(Ud,"MaxRollingAverageMetric",sb.a,[]);class ve extends sb.a{constructor(Q,
ya){super(Q,ya);this.ej=0}gva(){this.ej++}getValue(){return this.ej}XOa(){this.ej=0}}Object(e.a)(ve,"CounterMetric",sb.a,[]);class bf{constructor(Q,ya){this.oWb=ya;this.uie=new ec(Q+"-AverageValue","Milliseconds");this.Nye=new Jc(Q+"-MaxValue","Milliseconds");this.Uye=new Ud(Q+"-MaxRollingAverageValue","Milliseconds");this.Ile=new ve(Q+"-NumberOfEvents","Count");this.tqa=new bb.a(Q+"-SlowPercentileAtValue","Percentile",H.AFrameworkApplication.K.XP("CoAuthLatencySlowTargetValue",3E3),H.AFrameworkApplication.K.XP("CoAuthLatencySlowThresholdPercentile",
95),this.oWb);this.HCe=new bb.a(Q+"-BrokenSlowPercentileAtValue","Percentile",H.AFrameworkApplication.K.XP("CoAuthLatencyBrokenSlowTargetValue",5E3),H.AFrameworkApplication.K.XP("CoAuthLatencyBrokenSlowThresholdPercentile",95),this.oWb)}j_(Q){this.uie.gva(Q);this.Nye.gva(Q);this.Uye.gva(Q);this.Ile.gva(Q);this.tqa.gva(Q);this.HCe.gva(Q)}Q2d(){this.uie.COa();this.Nye.COa();this.Uye.COa();this.Ile.COa();this.tqa.COa();this.HCe.COa();this.uie.XOa();this.Nye.XOa();this.Uye.XOa();this.Ile.XOa();this.tqa.XOa();
this.HCe.XOa()}}Object(e.a)(bf,"ReplicationLatencyMetrics",null,[]);class $e{constructor(){this.wxe=new mb.a}ZKi(Q,ya,gb){if(!(0>ya)){if(!({value:Ob}=this.wxe.Dc(Q,Ob)).returnValue){var Ob=new bf(Q,gb);this.wxe.Z(Q,Ob)}Ob.j_(ya)}}Q2d(){for(const Q of this.wxe.values)Q.Q2d()}}Object(e.a)($e,"ReplicationTelemetryMetricsManager",null,[1963]);class cf{ZKi(){}Q2d(){}}Object(e.a)(cf,"ReplicationTelemetryMetricsManagerStub",null,[1963]);class oi{constructor(Q,ya,gb,Ob,mc,dd,Md){this.MUa=this.ood=0;this.DMj=
Q;this.LCe=gb;this.Y2g=Ob;this.Jvg=mc;this.FVb=ya;this.EMj=dd;this.oWb=Md}o4d(Q){this.DMj.ZKi(this.LCe,Q,this.oWb);Q>this.Y2g&&this.FVb.t8n(this.LCe,this.Y2g,Q);this.ood+=Q;this.MUa++;this.ood/this.MUa>this.Jvg&&this.MUa>this.EMj&&this.FVb.Vgk(this.LCe,this.Jvg,this.ood/this.MUa)}}Object(e.a)(oi,"TimeSpanVerifier",null,[1997]);class Dc{constructor(Q,ya){this.zSj=Q;this.FVb=ya}create(Q,ya,gb,Ob,mc){return new oi(this.zSj,this.FVb,Q,ya,gb,Ob,mc)}}Object(e.a)(Dc,"TimeSpanVerifierFactory",null,[1965]);
class Ag extends Sys.EventArgs{constructor(Q,ya,gb){super();this.oQi=Q;this.Nae=ya;this.actualValue=gb}}Object(e.a)(Ag,"TimeSpanVerifierEventArgs",Sys.EventArgs,[]);class Uc{constructor(){this.sa=new k.a}t8n(Q,ya,gb){this.sa.raiseEvent("TSVTE",new Ag(Q,ya,gb))}Vgk(Q,ya,gb){this.sa.raiseEvent("TSVATE",new Ag(Q,ya,gb))}q8j(Q){this.sa.addHandler("TSVTE",Q)}e7j(Q){this.sa.addHandler("TSVATE",Q)}}Object(e.a)(Uc,"TimeSpanVerifierNotifier",null,[1964]);class cl{constructor(){this.W=this.Oa=null}get name(){return"Box4.ReplicationTelemetry"}yc(Q){this.Oa=
Q.resolve("Common.IAppSettingsManager");this.W=Q;if(this.Oa.$("Box4ReplicationTelemetryIsEnabled")){Q.ha("ReplicationTelemetry.IPerfTrackerFactory",()=>new nh(Ae.App.xa.jq,P.a.sF(20,1,new T.a))).singleInstance();Q.ha("ReplicationTelemetry.ITimeSpanVerifierNotifier",()=>new Uc).singleInstance();this.Oa.$("Box4ReplicationTelemetryMetricsIsEnabled")?Q.ha("ReplicationTelemetry.IReplicationTelemetryMetricsManager",()=>new $e).singleInstance():Q.ha("ReplicationTelemetry.IReplicationTelemetryMetricsManager",
()=>new cf).singleInstance();Q.ha("ReplicationTelemetry.ITimeSpanVerifierFactory",()=>new Dc(Q.resolve("ReplicationTelemetry.IReplicationTelemetryMetricsManager"),Q.resolve("ReplicationTelemetry.ITimeSpanVerifierNotifier"))).singleInstance();Q.ha("ReplicationTelemetry.OutboundOperationFactory",()=>new ni(Q.resolve("ReplicationTelemetry.IPerfTrackerFactory"),()=>(new Date).getTime(),cl.XPh)).singleInstance();Q.ha("ReplicationTelemetry.OutboundMonitorFactory",()=>new Sb(Q.resolve("ReplicationTelemetry.OutboundOperationFactory"),
Q.resolve("ReplicationTelemetry.ITimeSpanVerifierFactory"))).singleInstance();Q.ha("ReplicationTelemetry.InboundOperationFactory",()=>new ce(Q.resolve("ReplicationTelemetry.IPerfTrackerFactory"),()=>(new Date).getTime(),cl.XPh)).singleInstance();var ya=new Cd(Q.resolve("ReplicationTelemetry.IPerfTrackerFactory"),()=>(new Date).getTime(),Q.resolve("ReplicationTelemetry.InboundOperationFactory"),Q.resolve("ReplicationTelemetry.ITimeSpanVerifierFactory")),gb=this.Oa.$("ComponentStateLoggingPackageIsEnabled")?
this.W.Za("Common.IComponentStateLogManager"):null;Q.ha("ReplicationTelemetry.IInboundMonitor",()=>ya.create(this.Oa.rc("Box4ReplicationTelemetryInboundOperationThreshold",0),this.Oa.rc("Box4ReplicationTelemetryInboundOperationAverageThreshold",0),this.Oa.rc("Box4ReplicationTelemetryTypingToInboundEndThreshold",0),this.Oa.rc("Box4ReplicationTelemetryTypingToInboundEndAverageThreshold",0),gb)).singleInstance();Q.ha("Common.IRandomSamplerFactory",()=>new bl).singleInstance();Q.ha("ReplicationTelemetry.ReplicationTelemetryManager",
()=>new Da(Q.resolve("ReplicationTelemetry.OutboundMonitorFactory"),Q.resolve("ReplicationTelemetry.IInboundMonitor"),Q.resolve("Common.IRandomSamplerFactory"))).singleInstance();Q.ha("ReplicationTelemetry.EventForwarderFactory",()=>new lf(mg.a.instance,Q.resolve("ReplicationTelemetry.ITimeSpanVerifierNotifier"),Q.resolve("Box4.ContentEditableViewEventSource")))}}init(){if(this.Oa.$("Box4ReplicationTelemetryIsEnabled")){var Q=this.Oa.rc("Box4ReplicationTelemetrySamplePercent",0),ya=this.Oa.rc("Box4ReplicationTelemetryPhaseSamplePercent",
0),gb=this.Oa.rc("Box4ReplicationTelemetryTypingToReplicationStartThreshold",0),Ob=this.Oa.rc("Box4ReplicationTelemetryTypingToReplicationStartAverageThreshold",0),mc=this.Oa.rc("Box4ReplicationTelemetryReplicationStartToReplicationEndThreshold",0),dd=this.Oa.rc("Box4ReplicationTelemetryReplicationStartToReplicationEndAverageThreshold",0),Md=this;this.W.Za("Box4.Presence.IRtcProxyProvider").execute(Ue=>{Ue.tI().continueWith(()=>{const Sf=Ue.tI().result,of=Md.W.resolve("ReplicationTelemetry.ReplicationTelemetryManager");
of.init(Sf,Q,ya,gb,Ob,mc,dd);Md.W.resolve("ReplicationTelemetry.EventForwarderFactory").create(Sf,of);if(Md.Oa.$("LogSteppedInboundFrameIsEnabled")){const cj=gl.a.Kq(Md.W.Za("Common.ICpuMeterProvider"));cj.continueWith(()=>{const el=Md.W.resolve("ReplicationTelemetry.IInboundMonitor");var qk=new wa.a(()=>!0);qk=P.a.sF(19,1,qk);el.initialize(qk);const jm=cj.result.fr.task;jm.continueWith(()=>{jm.result.zqd(0,()=>el.mIe,Qk=>{el.$Qm(Qk)});jm.result.zqd(1,Qk=>el.yUn(Qk),()=>{el.ZQm()})})})}la.ULS.sendTraceTag(8257935,
305,50,"ReplicationTelemetry init")})});var He=this;H.AFrameworkApplication.xK(()=>{He.W.resolve("ReplicationTelemetry.IReplicationTelemetryMetricsManager").Q2d()})}}dispose(){}static XPh(){const Q=Ae.App.ud;return Q?Q.vCh:0}}Object(e.a)(cl,"ReplicationTelemetryPackage",null,[1,2]);var Sh=d(932),Kh=d(14),uk=d(145),Xg=d(3),nj=d(97),qj=d(65),Lj=d(228),bh=d(19),si=d(25),nf=d(11),ig=d(1918);class Nk{static get vg(){return sc.a.Px(Nk.sl,Box4Intl.Box4Strings.L_SymbolUnicodeNameLabel,"")}}Nk.sl="<div class='WACDialogRow' id='SymbolsTable'> <div id='symbolsContainer'></div> </div> <div class='WACDialogRow' id='SymbolName'> <label id='SymbolNameLabel' class='WACDialogLabel' >{0}</label> </div> <div class='WACDialogRow' id='SymbolNameValue'> <label id='SymbolNameValueLabel' class='WACDialogLabel' >{1}</label> </div>";
Object(e.a)(Nk,"InsertSymbolsDialogHtml",null,[]);class Nd extends ig.a{constructor(Q,ya,gb){super();this.YRb=this.RIa=this.Z9a=null;this.lte=0;this.E6l=Ob=>{1===Ob?(this.WGf("symbol_d_"+Nd.Bqc),this.Wb.uK(this.UJ,!0),this.Wb.Gs().Vj.oy(this.kG),this.kG.focus()):this.hide()};this.N9i=Ob=>{if(Ob.target!==this.YRb){const mc=this.Wb.Gs();mc&&mc.Vj&&(mc.Vj.oy(Ob.target),this.YRb=Ob.target)}this.eXm(Ob.target.id)};this.a5n=Ob=>{const mc=Ob.Af;if("a"!==mc.tagName.toLowerCase())return!1;Ob.eventName===B.a.VC&&
this.WGf(mc.id);this.Wb.uK(this.UJ,!0);this.Wb.Gs().Vj.oy(mc);mc.focus();return!0};this.c5n=Ob=>{var mc=Ob.Af;if("a"!==mc.tagName.toLowerCase())return!1;const dd=parseInt(mc.id.substr(mc.id.lastIndexOf("_")+1));if(Ob.Ib.ctrlKey||Ob.Ib.altKey||Ob.Ib.keyCode>=cg.a.kNb&&Ob.Ib.keyCode<=cg.a.lNb)return!1;if(Ob.eventName===B.a.li){Ob=Ob.Ib.keyCode;let Md=-1;Ob===Sys.UI.Key.enter?(this.WGf(mc.id),this.Wb.uK(this.UJ,!0),this.Wb.Gs().Vj.oy(mc),mc.focus()):Ob===Sys.UI.Key.up?Md=dd-15:Ob===Sys.UI.Key.down?Md=
dd+15:Ob===Sys.UI.Key.left?Md=H.AFrameworkApplication.isRtl?dd+1:dd-1:Ob===Sys.UI.Key.right&&(Md=H.AFrameworkApplication.isRtl?dd-1:dd+1);0<=Md&&(mc=this.gif("symbol_d_"+Md))&&mc.focus()}return!0};this.ga=Q;this.Wb=ya;this.$9a=gb;this.Ve(1,Box4Intl.Box4Strings.L_SymbolInsertButtonText);this.Ve(0,CommonUIStrings.l_DialogClose);this.q8=!1;this.vg=Nk.vg;this.kg="InsertSymbolsDialog"}dispose(){0<Nd.FKe&&la.ULS.sendTraceTag(8778014,348,50,"InsertSymbolsDialog: InsertedSymbolCount={0}, TotalInsertedSymbolCount={1}",
this.lte,Nd.FKe);Nd.mBg++;la.ULS.sendTraceTag(8778015,348,50,"InsertSymbolsDialog: DialogCloseCount={0}",Nd.mBg);this.ga=this.$9a=null;super.dispose()}KPa(){this.Wh(Box4Intl.Box4Strings.L_SymbolSingle,this.E6l,null);this.lte=0;Nd.sBg++;la.ULS.sendTraceTag(8778013,348,50,"InsertSymbolsDialog: DialogOpenCount={0}",Nd.sBg);const Q=this.gif("symbol_d_"+Nd.Bqc);Q&&Q.focus()}hide(){var Q=document.getElementById("symbolsContainer");if(Q&&(Q=Q.getElementsByTagName("a")))for(let ya=0;ya<Q.length;ya++)G.a.removeHandler(Q[ya],
B.a.focus,this.N9i);super.hide()}get Ugb(){return Nd.Hqc}set Ugb(Q){Nd.Hqc=Q}get Qgb(){return Nd.vqc}set Qgb(Q){Nd.vqc=Q}cU(){super.cU();var Q=document.getElementById("symbolsContainer");if(Q&&(Q.innerHTML=this.$9a.Dlk(),Q=Q.getElementsByTagName("a")))for(let ya=0;ya<Q.length;ya++)G.a.addHandler(Q[ya],B.a.focus,this.N9i)}Kja(){const Q=document.getElementById("symbolsContainer");Q&&(this.Z9a||(this.Z9a=this.a5n,this.mq.mb(B.a.click,Q,this.Z9a),this.mq.mb(B.a.VC,Q,this.Z9a)),this.RIa||(this.RIa=this.c5n,
this.ke.mb(B.a.li,Q,this.RIa),this.ke.mb(B.a.Ft,Q,this.RIa),this.ke.mb(B.a.oh,Q,this.RIa)));super.Kja()}Sbb(){const Q=document.getElementById("symbolsContainer");Q&&(this.Z9a&&(this.mq.sc(B.a.click,Q,this.Z9a),this.mq.sc(B.a.VC,Q,this.Z9a),this.Z9a=null),this.RIa&&(this.ke.sc(B.a.li,Q,this.RIa),this.ke.sc(B.a.Ft,Q,this.RIa),this.ke.sc(B.a.oh,Q,this.RIa),this.RIa=null));super.Sbb()}eXm(Q){this.n0i("symbol_d_"+Nd.Bqc,!1);Nd.Bqc=parseInt(Q.substr(Q.lastIndexOf("_")+1));this.n0i(Q,!0);if(Q=document.getElementById("SymbolNameValueLabel")){const ya=
this.oId(Nd.Bqc);Q.innerText=ya.altText}}oId(Q){const ya=this.$9a.Q$d.N3f.value,gb=ej.a(ya);return ya[gb[Q]]}WGf(Q){this.lte++;Nd.FKe++;Q=parseInt(Q.substr(Q.lastIndexOf("_")+1));const ya=this.oId(Q),gb={};gb.SourceControlId="symbol_"+Q+"_"+ya.O$d;this.ga.Xb(Xg.a.tfb,2,gb);la.ULS.sendTraceTag(8778016,348,50,"InsertSymbolsDialog: Insert symbol, index={0}",Q)}gif(Q){const ya=document.getElementById("symbolsContainer");return ya?ya.querySelector("#"+Q):null}n0i(Q,ya){(Q=this.gif(Q))&&(ya?Q.setAttribute("selected",
"true"):Q.removeAttribute("selected"))}}Nd.Bqc=0;Nd.Hqc=null;Nd.vqc=null;Nd.sBg=0;Nd.mBg=0;Nd.FKe=0;Object(e.a)(Nd,"InsertSymbolsDialog",ig.a,[]);class $d{constructor(Q,ya,gb,Ob,mc,dd,Md){this.PKl=()=>this.$9a.Fmk();this.DIi=(He,Ue,Sf,of,cj)=>{if(1===Sf)return 32;He=this.$9a.HDi(cj);He=String.format(this.$9a.b5n,He.character);cj[Sh.a.InnerHTML]=He;cj[Sh.a.On]=!1;return 32};this.hMa=(He,Ue,Sf,of,cj)=>{if(({ve:He,selected:Sf,hMa:jm}=this.vDc(Ue,Sf)).returnValue)return jm;var el=bh.SelectionEditor.xf(Sf);
let qk=!0;Sf=8;var jm=this.Hc.Rc(15);jm.Db(He.rd);el||(Sf=this.ga.Qf(Ue,Xg.a.Aka,2,!0,of,null),Ue=32===Sf,la.ULS.shipAssertTag(6407387,348,Ue,"DeleteForReplace did not succeed. Response is {0}",Sf),qk=Ue);qk&&(Ue=He.Cb.Rg,el=bh.SelectionEditor.xf(Ue),la.ULS.shipAssertTag(6407388,348,el,"Context is not an InsertionPointContext after DeleteForReplace. Context is {0}",Ue.contextId),Sf=8,el&&(Sf=this.ga.Qf(Ue,Xg.a.tfb,2,!1,of,cj),la.ULS.shipAssertTag(6407389,348,32===Sf,"Insertion at IP context did not succeed. Response is {0}",
Sf),32===Sf&&sd.FocusManager.instance().Jg(He.mI)));jm.dispose();return Sf};this.D6l=(He,Ue,Sf,of,cj)=>{if(1===Sf)return 32;if(bh.SelectionEditor.ZZa(Ue))return 2;He=this.$9a.HDi(cj);of.Lr=He.index;of=this.Xc.fg(Ue.node);Sf=of.Bb(11);la.ULS.shipAssertTag(6379466,324,Sf,"could not root iterator at ancestor of type OutlineElement. NodeType: {0}",uk.a[Ue.node.type]);Sf=this.Hc.Rc(15);Sf.Ou(of);$d.characterPropertiesEditor.replaceTextRange(Ue,He.character,!0,!1);Ue=si.SelectionFactory.xe(of.currentNode,
Ue.cpBegin+1);this.ib.setSelection(Ue);Sf.dispose();return 32};this.lHb=(He,Ue,Sf,of,cj)=>{if(1===Sf)return 32;cj.MenuItems=this.OWj.value;return 32};this.O9i=(He,Ue,Sf)=>{({hMa:He}=this.vDc(Ue,Sf));return He};this.Q4i=(He,Ue,Sf)=>{2===Sf&&(new Nd(this.ga,sd.FocusManager.instance(),qa.a.instance.resolve("Box4.Symbols.ISymbolsUIBuilder"))).KPa();return 32};this.QOf=()=>32;this.ga=Q;this.Xc=ya;this.OWj=new jb.a(this.PKl);this.Hc=gb;this.$9a=Ob;this.Ok=mc;this.ib=dd;this.Hm=Md}Vb(){this.ga.gb(Xg.a.QOf,
Kh.a.application,this.QOf,96);this.ga.pa(Xg.a.lHb,Kh.a.view,this.lHb);this.ga.pa(Xg.a.P$d,Kh.a.view,this.O9i);this.ga.pa(Xg.a.X1d,Kh.a.view,this.DIi);this.ga.pa(Xg.a.tfb,Kh.a.view,this.hMa);this.ga.pa(Xg.a.lHb,Kh.a.Wc,this.lHb);this.ga.pa(Xg.a.P$d,Kh.a.Wc,this.O9i);this.ga.pa(Xg.a.X1d,Kh.a.Wc,this.DIi);this.ga.pa(Xg.a.tfb,Kh.a.Wc,this.D6l);this.ga.Vc(Xg.a.lHb,1124);this.ga.Vc(Xg.a.P$d,1036);this.ga.Vc(Xg.a.X1d,1124);this.ga.Vc(Xg.a.tfb,1036);H.AFrameworkApplication.K&&H.AFrameworkApplication.K.$("InsertMoreSymbolsIsEnabled")&&
(this.ga.pa(Xg.a.CMc,Kh.a.view,this.Q4i),this.ga.pa(Xg.a.CMc,Kh.a.Wc,this.Q4i),this.ga.Vc(Xg.a.CMc,1124))}vDc(Q,ya){let gb,Ob=null;Q.view.ze&&(Ob=Q.view);gb=null;if(!Ob||!Ob.Cb)return v.b(16851359,315,50,"DefaultActionHandler would have crashed. The context passed in was {0} which does not contain a selection manager",Q.toString()),{returnValue:!0,ve:Ob,selected:gb,hMa:8};gb=Ob.Cb.Rg;if(!gb)return{returnValue:!0,ve:Ob,selected:gb,hMa:2};if(this.Ok.iZ(gb)||this.Ok.Jta(gb))return{returnValue:!0,ve:Ob,
selected:gb,hMa:8};if(Ob.Cb.hb.zI||this.Hm&&this.Hm.instance&&this.Hm.instance.HT(gb)||bh.SelectionEditor.ZZa(Q.vk))return{returnValue:!0,ve:Ob,selected:gb,hMa:2};if($d.Tg.swa(nf.ParagraphReader.UW,gb))return Q=8,$d.Mc.Zb(nj.a.zf,{["Reason"]:qj.a.uN}),{returnValue:!0,ve:Ob,selected:gb,hMa:Q};Q=32;return 1===ya?{returnValue:!0,ve:Ob,selected:gb,hMa:Q}:{returnValue:!1,ve:Ob,selected:gb,hMa:Q}}static get characterPropertiesEditor(){return $d.Vd||($d.Vd=qa.a.instance.resolve("Box4.ICharacterPropertiesEditor"))}static set characterPropertiesEditor(Q){$d.Vd=
Q}static get Tg(){return Lj.ContextSetEditor.instance}static get Mc(){return Eg.a.instance}}$d.Vd=null;Object(e.a)($d,"SymbolsActor",null,[1935]);class Xd{constructor(Q,ya){this.O$d=Q;this.altText=ya}}Object(e.a)(Xd,"Symbol",null,[]);class ie{constructor(){this.eJe=null;this.i2g=new jb.a(ie.U0e)}get N3f(){return this.i2g}gTh(Q){this.eJe||(this.eJe=ej.a(this.i2g.value));return Array.indexOf(this.eJe,Q)}static U0e(){const Q={};Q["\u2022"]=new Xd("\u2022",Box4Intl.Box4Strings.L_Bullet);Q["\u20ac"]=new Xd("\u20ac",
Box4Intl.Box4Strings.L_EuroSign);Q["\u00a3"]=new Xd("\u00a3",Box4Intl.Box4Strings.L_PoundSign);Q["\u00a5"]=new Xd("\u00a5",Box4Intl.Box4Strings.L_YenSign);Q["\u00a9"]=new Xd("\u00a9",Box4Intl.Box4Strings.L_CopyrightSign);Q["\u00ae"]=new Xd("\u00ae",Box4Intl.Box4Strings.L_RegisteredSign);Q["\u2122"]=new Xd("\u2122",Box4Intl.Box4Strings.L_TradeMarkSign);Q["\u00b1"]=new Xd("\u00b1",Box4Intl.Box4Strings.L_PlusMinusSign);Q["\u2260"]=new Xd("\u2260",Box4Intl.Box4Strings.L_NotEqualTo);Q["\u2264"]=new Xd("\u2264",
Box4Intl.Box4Strings.L_LessThanOrEqualTo);Q["\u2265"]=new Xd("\u2265",Box4Intl.Box4Strings.L_GreaterThanOrEqualTo);Q["\u00f7"]=new Xd("\u00f7",Box4Intl.Box4Strings.L_DivisionSign);Q["\u00d7"]=new Xd("\u00d7",Box4Intl.Box4Strings.L_MultiplicationSign);Q["\u221e"]=new Xd("\u221e",Box4Intl.Box4Strings.L_Infinity);Q["\u00b5"]=new Xd("\u00b5",Box4Intl.Box4Strings.L_MicroSign);Q["\u03b1"]=new Xd("\u03b1",Box4Intl.Box4Strings.L_GreekSmallLetterAlpha);Q["\u03b2"]=new Xd("\u03b2",Box4Intl.Box4Strings.L_GreekSmallLetterBeta);
Q["\u03c0"]=new Xd("\u03c0",Box4Intl.Box4Strings.L_GreekSmallLetterPi);Q["\u03a9"]=new Xd("\u03a9",Box4Intl.Box4Strings.L_OhmSign);Q["\u03a3"]=new Xd("\u03a3",Box4Intl.Box4Strings.L_NArySummation);Q["\u00b0"]=new Xd("\u00b0",Box4Intl.Box4Strings.L_DegreeSign);Q["\u0394"]=new Xd("\u0394",Box4Intl.Box4Strings.L_CapitalLetterDelta);Q["\u263a"]=new Xd("\u263a",Box4Intl.Box4Strings.L_WhiteSmilingFace);Q["\u2665"]=new Xd("\u2665",Box4Intl.Box4Strings.L_BlackHeartSuit);Q["\u20b9"]=new Xd("\u20b9",Box4Intl.Box4Strings.L_IndianRupeeSign);
Q["\u00bf"]=new Xd("\u00bf",Box4Intl.Box4Strings.L_InvertedQuestionMark);Q["\u00a1"]=new Xd("\u00a1",Box4Intl.Box4Strings.L_InvertedExclamationMark);Q["\u2014"]=new Xd("\u2014",Box4Intl.Box4Strings.L_EmDash);Q["\u2026"]=new Xd("\u2026",Box4Intl.Box4Strings.L_HorizontalEllipsis);Q["\u00c0"]=new Xd("\u00c0",Box4Intl.Box4Strings.L_LatinCapitalLetterAWithGrave);Q["\u00c1"]=new Xd("\u00c1",Box4Intl.Box4Strings.L_LatinCapitalLetterAWithAcute);Q["\u00c2"]=new Xd("\u00c2",Box4Intl.Box4Strings.L_LatinCapitalLetterAWithCircumflex);
Q["\u00c3"]=new Xd("\u00c3",Box4Intl.Box4Strings.L_LatinCapitalLetterAWithTilde);Q["\u00c4"]=new Xd("\u00c4",Box4Intl.Box4Strings.L_LatinCapitalLetterAWithDiaeresis);Q["\u00c5"]=new Xd("\u00c5",Box4Intl.Box4Strings.L_LatinCapitalLetterAWithRingAbove);Q["\u00c6"]=new Xd("\u00c6",Box4Intl.Box4Strings.L_LatinCapitalLetterAe);Q["\u00c7"]=new Xd("\u00c7",Box4Intl.Box4Strings.L_LatinCapitalLetterCWithCedilla);Q["\u00c8"]=new Xd("\u00c8",Box4Intl.Box4Strings.L_LatinCapitalLetterEWithGrave);Q["\u00c9"]=new Xd("\u00c9",
Box4Intl.Box4Strings.L_LatinCapitalLetterEWithAcute);Q["\u00ca"]=new Xd("\u00ca",Box4Intl.Box4Strings.L_LatinCapitalLetterEWithCircumflex);Q["\u00cb"]=new Xd("\u00cb",Box4Intl.Box4Strings.L_LatinCapitalLetterEWithDiaeresis);Q["\u00cc"]=new Xd("\u00cc",Box4Intl.Box4Strings.L_LatinCapitalLetterIWithGrave);Q["\u00cd"]=new Xd("\u00cd",Box4Intl.Box4Strings.L_LatinCapitalLetterIWithAcute);Q["\u00ce"]=new Xd("\u00ce",Box4Intl.Box4Strings.L_LatinCapitalLetterIWithCircumflex);Q["\u00cf"]=new Xd("\u00cf",Box4Intl.Box4Strings.L_LatinCapitalLetterIWithDiaeresis);
Q["\u00d1"]=new Xd("\u00d1",Box4Intl.Box4Strings.L_LatinCapitalLetterNWithTilde);Q["\u00d2"]=new Xd("\u00d2",Box4Intl.Box4Strings.L_LatinCapitalLetterOWithGrave);Q["\u00d3"]=new Xd("\u00d3",Box4Intl.Box4Strings.L_LatinCapitalLetterOWithAcute);Q["\u00d4"]=new Xd("\u00d4",Box4Intl.Box4Strings.L_LatinCapitalLetterOWithCircumflex);Q["\u00d5"]=new Xd("\u00d5",Box4Intl.Box4Strings.L_LatinCapitalLetterOWithTilde);Q["\u00d6"]=new Xd("\u00d6",Box4Intl.Box4Strings.L_LatinCapitalLetterOWithDiaeresis);Q["\u00d9"]=
new Xd("\u00d9",Box4Intl.Box4Strings.L_LatinCapitalLetterUWithGrave);Q["\u00da"]=new Xd("\u00da",Box4Intl.Box4Strings.L_LatinCapitalLetterUWithAcute);Q["\u00db"]=new Xd("\u00db",Box4Intl.Box4Strings.L_LatinCapitalLetterUWithCircumflex);Q["\u00dc"]=new Xd("\u00dc",Box4Intl.Box4Strings.L_LatinCapitalLetterUWithDiaeresis);Q["\u00df"]=new Xd("\u00df",Box4Intl.Box4Strings.L_LatinSmallLetterSharpS);Q["\u00e0"]=new Xd("\u00e0",Box4Intl.Box4Strings.L_LatinSmallLetterAWithGrave);Q["\u00e1"]=new Xd("\u00e1",
Box4Intl.Box4Strings.L_LatinSmallLetterAWithAcute);Q["\u00e2"]=new Xd("\u00e2",Box4Intl.Box4Strings.L_LatinSmallLetterAWithCircumflex);Q["\u00e3"]=new Xd("\u00e3",Box4Intl.Box4Strings.L_LatinSmallLetterAWithTilde);Q["\u00e4"]=new Xd("\u00e4",Box4Intl.Box4Strings.L_LatinSmallLetterAWithDiaeresis);Q["\u00e5"]=new Xd("\u00e5",Box4Intl.Box4Strings.L_LatinSmallLetterAWithRingAbove);Q["\u00e6"]=new Xd("\u00e6",Box4Intl.Box4Strings.L_LatinSmallLetterAe);Q["\u00e7"]=new Xd("\u00e7",Box4Intl.Box4Strings.L_LatinSmallLetterCWithCedilla);
Q["\u00e8"]=new Xd("\u00e8",Box4Intl.Box4Strings.L_LatinSmallLetterEWithGrave);Q["\u00e9"]=new Xd("\u00e9",Box4Intl.Box4Strings.L_LatinSmallLetterEWithAcute);Q["\u00ea"]=new Xd("\u00ea",Box4Intl.Box4Strings.L_LatinSmallLetterEWithCircumflex);Q["\u00eb"]=new Xd("\u00eb",Box4Intl.Box4Strings.L_LatinSmallLetterEWithDiaeresis);Q["\u00ec"]=new Xd("\u00ec",Box4Intl.Box4Strings.L_LatinSmallLetterIWithGrave);Q["\u00ed"]=new Xd("\u00ed",Box4Intl.Box4Strings.L_LatinSmallLetterIWithAcute);Q["\u00ee"]=new Xd("\u00ee",
Box4Intl.Box4Strings.L_LatinSmallLetterIWithCircumflex);Q["\u00ef"]=new Xd("\u00ef",Box4Intl.Box4Strings.L_LatinSmallLetterIWithDiaeresis);Q["\u00f1"]=new Xd("\u00f1",Box4Intl.Box4Strings.L_LatinSmallLetterNWithTilde);Q["\u00f2"]=new Xd("\u00f2",Box4Intl.Box4Strings.L_LatinSmallLetterOWithGrave);Q["\u00f3"]=new Xd("\u00f3",Box4Intl.Box4Strings.L_LatinSmallLetterOWithAcute);Q["\u00f4"]=new Xd("\u00f4",Box4Intl.Box4Strings.L_LatinSmallLetterOWithCircumflex);Q["\u00f5"]=new Xd("\u00f5",Box4Intl.Box4Strings.L_LatinSmallLetterOWithTilde);
Q["\u00f6"]=new Xd("\u00f6",Box4Intl.Box4Strings.L_LatinSmallLetterOWithDiaeresis);Q["\u00f9"]=new Xd("\u00f9",Box4Intl.Box4Strings.L_LatinSmallLetterUWithGrave);Q["\u00fa"]=new Xd("\u00fa",Box4Intl.Box4Strings.L_LatinSmallLetterUWithAcute);Q["\u00fb"]=new Xd("\u00fb",Box4Intl.Box4Strings.L_LatinSmallLetterUWithCircumflex);Q["\u00fc"]=new Xd("\u00fc",Box4Intl.Box4Strings.L_LatinSmallLetterUWithDiaeresis);Q["\u00ff"]=new Xd("\u00ff",Box4Intl.Box4Strings.L_LatinSmallLetterYWithDiaeresis);Q["\u011e"]=
new Xd("\u011e",Box4Intl.Box4Strings.L_LatinCapitalLetterGWithBreve);Q["\u011f"]=new Xd("\u011f",Box4Intl.Box4Strings.L_LatinSmallLetterGWithBreve);Q["\u0130"]=new Xd("\u0130",Box4Intl.Box4Strings.L_LatinCapitalLetterIWithDotAbove);Q["\u0131"]=new Xd("\u0131",Box4Intl.Box4Strings.L_LatinSmallLetterDotlessI);Q["\u0152"]=new Xd("\u0152",Box4Intl.Box4Strings.L_LatinCapitalLigatureOe);Q["\u0153"]=new Xd("\u0153",Box4Intl.Box4Strings.L_LatinSmallLigatureOe);Q["\u015e"]=new Xd("\u015e",Box4Intl.Box4Strings.L_LatinCapitalLetterSWithCedilla);
Q["\u015f"]=new Xd("\u015f",Box4Intl.Box4Strings.L_LatinSmallLetterSWithCedilla);Q["\u0178"]=new Xd("\u0178",Box4Intl.Box4Strings.L_LatinCapitalLetterYWithDiaeresis);return Q}}Object(e.a)(ie,"SymbolsLoader",null,[1937]);var Wk=d(443),nd=d(359),di=d(213),Cb=d(663),wc=d(1449),Dd=d(236),Le=d(96);class ff{constructor(Q){this.Q$d=Q}get b5n(){return'<div class="SymbolButtonInnerHTML" aria-hidden="true" style="color: black">{0}</div>'}HDi(Q){Q=Q.SourceControlId.split("_");const ya={};2===Q.length?(ya.character=
Q[1],ya.index=this.Q$d.gTh(ya.character)):(ya.character=Q[2],ya.index=parseInt(Q[1]));return ya}Fmk(){return this.WZh()}build(){return this.QKl()}Dlk(){const Q=new Sys.StringBuilder;Q.append('<table class="moreSymbolsTable">');const ya=this.Q$d.N3f.value,gb=ej.a(ya);let Ob=0;for(;Ob<gb.length;){Ob%15||Q.append('<tr role="presentation">');const mc=ya[gb[Ob]];Q.append(String.format('<td unselectable="on">\r\n\t\t\t\t\t<div unselectable="on" role="presentation">\r\n\t\t\t\t\t\t<a id="{0}" aria-label="{2}" title="{2}" role="button" tabindex="0" unselectable="on">{1}</a>\r\n\t\t\t\t\t</div></td>',
"symbol_d_"+Ob,Tb.a.BZ(mc.O$d),Tb.a.BZ(mc.altText)));Ob++;Ob%15&&Ob!==gb.length||Q.append("</tr>")}Q.append("</table>");return Q.toString()}QKl(){const Q=this.WZh();return Dd.q(Q)}WZh(){const Q=Object.assign(new Wk.a,{Id:"menuSymbolsDropDown",MenuSectionList:[]});Q.MenuSectionList.push(this.s5j());H.AFrameworkApplication.K&&H.AFrameworkApplication.K.$("InsertMoreSymbolsIsEnabled")&&Q.MenuSectionList.push(this.v3j());return Q}v3j(){const Q=Object.assign(new nd.a,{Id:"msMoreSymbols",Title:"",DisplayMode:"Menu16",
ControlsId:"ctrlMoreSymbols",ControlList:[]}),ya=Object.assign(new di.a,{Id:"btnMoreSymbols",Command:Xg.a.CMc.toString(),LabelText:Tb.a.If(Box4Intl.Box4Strings.L_InsertMoreSymbols),Alt:Tb.a.If(Box4Intl.Box4Strings.L_InsertMoreSymbols),Image16by16:H.AFrameworkApplication.pr,Image16by16Class:Le.getImageClass("Symbol_16x16x32"),KeyTip:CommonUIStrings.l_InsertMoreSymbolsKeytip});Q.ControlList.push(ya);return Q}s5j(){const Q=Object.assign(new nd.a,{Id:"msSymbolsPosition",ShowMenuSectionSeparator:!1,ControlList:[]}),
ya=Object.assign(new Cb.a,{Type:1,Id:"gallerySymbolsPosition",ExternalId:"InsertSymbols",ExternalGalleryId:"InsertSymbolGallery",Width:5,ElementDimensions:"Size16by16",GalleryItems:[]}),gb=this.Q$d.N3f.value,Ob=ej.a(gb),mc=Math.min(25,Ob.length);for(let Md=0;Md<mc;Md++){var dd=gb[Ob[Md]];dd=Object.assign(new wc.a,{Id:String.format("{0}{1}_{2}","symbol_",Md,dd.O$d),Character:dd.O$d,Command:Xg.a.tfb.toString(),QueryCommand:Xg.a.X1d.toString(),Alt:Tb.a.If(dd.altText)});ya.GalleryItems.push(dd)}Q.ControlList.push(ya);
return Q}}Object(e.a)(ff,"SymbolsUiBuilder",null,[1936]);var mf=d(53),Qf=d(247),yf=d(658),Hf=d(391);class Pg{constructor(){this.W=null}get name(){return"Box4.Symbols"}init(){H.AFrameworkApplication.K.$("InsertSymbolIsEnabled")&&this.W.resolve("Box4.Symbols.ISymbolsActor").Vb()}dispose(){}yc(Q){this.W=Q;this.W.register(ie,"Box4.Symbols.SymbolsLoader").as("Box4.Symbols.ISymbolsLoader").singleInstance();this.W.ha("Box4.Symbols.SymbolsUiBuilder",()=>new ff(this.W.resolve("Box4.Symbols.ISymbolsLoader"))).as("Box4.Symbols.ISymbolsUIBuilder").singleInstance();
this.W.ha("Box4.Symbols.SymbolsActor",()=>new $d(H.AFrameworkApplication.ya,new yf.a,new Hf.a,this.W.resolve("Box4.Symbols.ISymbolsUIBuilder"),Qf.a.instance,mf.a.instance,this.W.Za("Box4.IExternalSelectionManager"))).as("Box4.Symbols.ISymbolsActor").singleInstance()}static main(){ca.a.instance.Oc(new Pg)}}Object(e.a)(Pg,"Box4SymbolsPackage",null,[1,2]);var Qe=window.AccCheckerPaneData={name:"CommandUI",attrs:{xmlns:"http://schemas.microsoft.com/sharepoint/"},children:[{name:"TaskPane",attrs:{Id:"AccCheckerTaskPane",
Width:"300",Overflow:"auto"},children:[{name:"Groups",attrs:{},children:[{name:"Group",attrs:{Id:"AccCheckResultsPlaceHolder",IsStretched:"true",MinHeight:"400"}}]}]}]},Fb=d(1586),af=d(1548),Ih=d(1537),Yh=d(1839),ql=d(204),Hj=d(440);class Di{constructor(){this.IFa=null}yc(Q){this.container=Q}init(){this.IFa=this.container.resolve("Common.App.AccessibilityChecker.IAccessibilityCheckManager")}dispose(){this.IFa&&this.IFa.dispose()}}Object(e.a)(Di,"ALiveBooksAccessibilityCheckPackageManager",null,[1,
2]);class Mj{get zEk(){return CommonUIStrings.l_AccCheckerContentNotFoundDialogActionButton}get AEk(){return CommonUIStrings.l_AccCheckerContentNotFoundDialogBody}get BEk(){return CommonUIStrings.l_AccCheckerContentNotFoundDialogTitle}get E_m(){return CommonUIStrings.l_AccCheckerOutOfSyncNotificationMessageBody}get Lib(){return CommonUIStrings.l_AccCheckerPaneTitle}get g3m(){return CommonUIStrings.l_AccCheckerPartialResultNotification}}Object(e.a)(Mj,"AccessibilityCheckStringsProvider",null,[59]);
class Bi{constructor(){this.QTi=this.contentId=null}}Object(e.a)(Bi,"ResultIds",null,[]);class zh{constructor(Q,ya){this._element=null;this.ig=ya;this.ke=Q}get element(){this._element||(this._element=this.iJk(),this.Xy());return this._element}FZf(Q){this._element=Q}dispose(){this.element&&(this.Q7(),this.FZf(null))}Xy(){this.ig&&this.ke?(this.ig.mb(B.a.click,this.element,Object(a.a)(this,this.onClick,"onClick")),this.ke.mb(B.a.li,this.element,Object(a.a)(this,this.KF,"onKeyPress"))):la.ULS.shipAssertTag(19789026,
334,!1,String.format("ClickInputManager or KeyInputManager is null. Couldn't register events on element ( ID: {0}).",this.element.id))}Q7(){this.ig&&this.ke&&(this.ig.sc(B.a.click,this.element,Object(a.a)(this,this.onClick,"onClick")),this.ke.sc(B.a.li,this.element,Object(a.a)(this,this.KF,"onKeyPress")))}onClick(){this.CXd();return!0}KF(Q){return this.ufm(Q.Ib.keyCode)?(this.CXd(),!0):!1}ufm(Q){return Q===cg.a.Gde||Q===cg.a.es}}Object(e.a)(zh,"AInteractivePaneElement",null,[104,9]);var Th=d(480),
Ci=d(50);class tf extends zh{constructor(Q,ya,gb){super(Q,ya);this.GAe=gb}hide(){this.element.removeAttribute(pb.a.Ch);pb.a.Iq(this.element,pb.a.zz,pb.a.Ho);this.element.style.display="none"}show(){pb.a.Iq(this.element,pb.a.zz,pb.a.jL);pb.a.Iq(this.element,pb.a.Ch,pb.a.PRe);this.element.style.display="block"}iJk(){const Q=Th.b("div",this.oui,"AccCheckerNotification");pb.a.Iq(Q,pb.a.Sdh,pb.a.Ho);pb.a.Iq(Q,pb.a.mda,this.fEf);Q.tabIndex=0;const ya=Th.b("span",this.nui,"AccCheckerNotificationIcon");var gb=
Le.createClusteredImage(16,16,"Info_16x16x32","",!0,"");ya.appendChild(gb);gb=Th.b("span",this.fEf,"AccCheckerNotificationText");Ci.a.iy(gb,this.pui);Q.appendChild(ya);Q.appendChild(gb);return Q}CXd(){this.GAe()}}Object(e.a)(tf,"APopupNotification",zh,[690,104,9]);class Zh extends tf{constructor(Q,ya,gb,Ob){super(Q,ya,gb);this.Nqa=Ob}get oui(){return"AccCheckerOutOfSyncNotificationId"}get nui(){return"AccCheckerOutOfSyncNotificationIconId"}get fEf(){return"AccCheckerOutOfSyncNotificationTextId"}get pui(){return this.Nqa.E_m}}
Object(e.a)(Zh,"OutOfSyncNotification",tf,[]);class kc extends tf{constructor(Q,ya,gb,Ob){super(Q,ya,gb);this.Nqa=Ob}get oui(){return"AccCheckerPartialResultNotificationId"}get nui(){return"AccCheckerPartialResultNotificationIconId"}get fEf(){return"AccCheckerPartialResultNotificationTextId"}get pui(){return this.Nqa.g3m}}Object(e.a)(kc,"PartialResultNotification",tf,[]);var Nm=d(137),Nj=d(36),Sd=d(179);class ue{constructor(Q,ya,gb,Ob=null,mc=null,dd=null,Md=null){this.yYg=this.ZK=this.ke=this.IFa=
null;this.YMa=Ob;this.ig=Q;this.Wb=ya;this.Oo=gb;this.Nqa=Md||new Mj;this.tBe=mc||new Zh(this.YMa,this.ig,Object(a.a)(this,this.qWk,"dimissOutOfSyncNotification"),this.Nqa);this.nCe=dd||new kc(this.YMa,this.ig,Object(a.a)(this,this.rWk,"dimissPartialResultNotification"),this.Nqa)}show(){}hide(){}get YMa(){return this.ke||(this.ke=H.AFrameworkApplication.ua.my)}set YMa(Q){this.ke=Q}nth(){}Hla(){}dispose(){}c4a(){}w8l(Q){var ya=this.yYg[Q];Q=ya.contentId;if((ya=ya.QTi+"")&&ya.length){const gb=[];Array.add(gb,
Object.assign(new Nj.a,{name:"RuleID",string:ya}));Nm.a.sendTelemetryEvent(Object.assign(new Sd.a,{name:String.format("{0}.{1}",ue.D4f,"ViolationSelected"),dataFields:gb}))}this.EKm(Q)}EKm(Q){Q&&this.IFa.OJn(Q)||(this.Wb.uK($f.AFrame.r6g,!1),this.FWn())}qWk(){this.A0c(!1)}rWk(){this.H4i(!1)}FWn(){const Q=Object.assign(new Ed.StandardDialog(!0),{Bt:H.AFrameworkApplication.J$,Fd:1,tEa:!1});Q.tU(1);Q.Ve(1,this.Nqa.zEk);Q.Ve(0,CommonUIStrings.l_DialogCancel);Q.vU(this.Nqa.BEk,this.Nqa.AEk,ya=>{1===ya&&
this.Uof()})}Kmk(Q){let ya=null;if(Q.Results&&0<Q.Results.length){ya={};let gb=0;for(const Ob of Q.Results)Ob.ResultId=ue.N_j+ ++gb,Q=new Bi,Q.contentId=Ob.ContentId,Q.QTi=Ob.RuleId,ya[Ob.ResultId]=Q}return ya}mBm(){Nm.a.addNamespaceMapping(ue.D4f,ue.j7n);Nm.a.sendTelemetryEvent(Object.assign(new Sd.a,{name:String.format("{0}.{1}",ue.D4f,"ShowTaskpane")}))}}ue.N_j="AccCheckResult";ue.D4f="Office.UX.AccChecker";ue.j7n="c4388c977297413bb054bad1acf0ade1-cc58e53e-f5a4-4f37-b0d2-9a8079e34420-6879";Object(e.a)(ue,
"BaseAccessibilityCheckPane",null,[61,9]);class Ri{constructor(){this.type="AccCheckerTaskPaneProps";this.accessibilityCheckResultCollection=this.onRecheckExecute=null;this.resultsReady=!1;this.helpLink=this.onInvokeNavigateExecute=null;this.partialResult=this.outOfSync=!1;this.showHelpPane=this.updateLastScanTime=null}}Object(e.a)(Ri,"AccCheckerTaskPaneProps",null,[]);var Ei=d(1374),od=d(1388),co=d(1016),cd=d(171);class ii extends ue{constructor(Q,ya,gb,Ob,mc=null,dd=null,Md,He=null,Ue=null){super(ya,
gb,Ob,dd,void 0,void 0,He);this.Ptg=null;this.iXg=this.mCe=this.Fhd=this.Xkd=this.ukd=!1;this.HLe=null;this.zJe=!!H.AFrameworkApplication.ua&&!!H.AFrameworkApplication.ua.Sb&&H.AFrameworkApplication.ua.Sb.$tf;this.Fnc=this.W3=null;this.toc=0;this.Ibd=null;this.aY=mc;Ue&&(this.W3=Ue.fqd,this.Fnc=Ue.CEo,this.toc=Ue.IFo);this.iA=new od.a}get isVisible(){return this.iXg}EPa(Q){this.iXg=Q}P4e(Q){Q&&(this.Ptg=Q,Q.IsSuccess&&(this.yYg=this.Kmk(Q),Q.IsPartialResult&&this.H4i(!0)),this.ukd=!0,this.Xkd=!1,
this.Vm())}A0c(Q){this.isVisible&&Q!==this.Fhd&&(this.Fhd=Q,this.Vm())}H4i(Q){this.mCe=Q;this.Vm()}qO(){this.Xkd||cd.UISurfaces.$t().then(Q=>{da.a.instance.Ey(ii.Zmb+":PaneOpen:Start");Q.showTaskPane(ii.Zmb,this.wB());this.Uof();return null});this.isVisible?cd.UISurfaces.$t().then(Q=>{Q.setSelectedTaskPane(ii.Zmb);return null}):this.mBm()}Vm(){cd.UISurfaces.$t().then(Q=>{Q.updateTaskPane(ii.Zmb,this.wB());return null})}wB(){var Q=new Ri;this.iA.KJb(Q);Q=Object.assign(new co.a,{title:this.Nqa.Lib,
hideHeader:!1,width:320,location:2,contentProps:Q,onOpen:()=>{this.q7();this.EPa(!0);H.AFrameworkApplication.ua.updateCommandUI()},onClose:()=>{this.aba();this.EPa(!1);this.Xkd=this.ukd=!1;this.Vm();H.AFrameworkApplication.ua.updateCommandUI()},isModernPane:!0});this.zJe&&(Q.enableResize=!0,Q.minResizeWidth=268,Q.maxResizeWidth=920);return Q}initialize(Q){const ya=this.Wb.re(ii.Zmb);ya.parent=$f.AFrame.Np;ya.UL=!0;this.IFa=Q;this.K0j()}dispose(){this.c4a();this.tBe&&(this.tBe.dispose(),this.tBe=null);
this.nCe&&(this.nCe.dispose(),this.nCe=null);super.dispose()}K0j(){this.iA.vK(this.onRecheckExecute());this.iA.vK(this.tgl());this.iA.vK(this.DGl());this.iA.vK(this.onInvokeNavigateExecute());this.iA.vK(this.tul());this.iA.vK(this.QBl());this.iA.vK(this.JDl());this.iA.vK(this.updateLastScanTime());this.iA.vK(this.showHelpPane())}onRecheckExecute(){return Q=>{Q.onRecheckExecute=()=>{this.Uof()}}}tgl(){return Q=>{Q.accessibilityCheckResultCollection=this.Ptg}}DGl(){return Q=>{Q.resultsReady=this.ukd}}onInvokeNavigateExecute(){return Q=>
{Q.onInvokeNavigateExecute=ya=>{this.w8l(ya)}}}tul(){return Q=>{Q.helpLink=this.c6k}}QBl(){return Q=>{Q.outOfSync=this.Fhd}}JDl(){return Q=>{Q.partialResult=this.mCe}}updateLastScanTime(){return Q=>{Q.updateLastScanTime=ya=>{this.HLe=ya}}}showHelpPane(){return Q=>{Q.showHelpPane=()=>{H.AFrameworkApplication.K&&H.AFrameworkApplication.K.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.WordHelpPaneFix")?H.AFrameworkApplication.QJ||this.Ddh()?this.Ibd?this.Ibd():this.W3.value&&this.Fnc&&
this.toc&&this.W3.value.Xb(this.toc,2,this.Fnc):this.E5i():this.Ddh()?this.Ibd?this.Ibd():this.W3.value&&this.Fnc&&this.toc&&this.W3.value.Xb(this.toc,2,this.Fnc):this.E5i()}}}Ddh(){return!this.aY||!this.aY.value}E5i(){const Q=this.aY.value;if(Q){var ya={};ya.query=ii.ERj+ii.lGj;ya=Object.assign(new Ei.a,{sX:ya});Q.gba(ii.Jre,ya)}}Uof(){this.mCe=this.Fhd=this.ukd=!1;this.HLe&&this.HLe();this.Vm();this.Xkd=!0;this.IFa.ZPm()}q7(){this.Wb.Jg(ii.Zmb)}aba(){this.K_a()&&this.Wb.Jg(this.Wb.HS)}K_a(){return!!this.Wb.og&&
this.Wb.og.name===ii.Zmb}}ii.Zmb="AccessibilityCheckerPane";ii.lGj="a16f6de0-2f39-4a2b-8bd8-5ad801426c7f";ii.Jre="FA000000012";ii.ERj="AssetID=";Object(e.a)(ii,"ReactAccessibilityCheckPane",ue,[]);class pg extends ii{constructor(Q,ya,gb,Ob,mc,dd,Md,He,Ue=null){super(Q,ya,gb,Ob,mc,dd,void 0,Ue);this.TCj=He;this.lP=Md}get c6k(){return this.TCj}qO(){this.lP.iKa();super.qO()}}Object(e.a)(pg,"ReactLiveBooksAccessibilityCheckPane",ii,[]);var qn=d(1122),yk=d(133),xj=d(181),eo=d(78),ui=d(157),yc=d(527),rg;
(function(Q){Q[Q.error=0]="error";Q[Q.warning=1]="warning";Q[Q.tip=2]="tip";Q[Q.intelligentService=3]="intelligentService"})(rg||(rg={}));Object(e.b)("AccessibilityRuleCategory",rg);class Tj{constructor(Q,ya,gb=null){this.Fge=null;this.lLg=this.XJg=!1;this.gJa=Q;this.l6c=ya;this.ga=gb;this.zc.pa(Ra.a.kyk,uc.a.frame,Object(a.a)(this,this.AXe,"closePane"))}get zc(){return this.ga||(this.ga=H.AFrameworkApplication.ya)}set zc(Q){this.ga=Q}q2k(){this.XJg||(this.gJa.initialize(this),this.l6c.initialize(this),
this.XJg=!0)}ZPm(){v.b(19969184,200,50,"{0}",{["AccCheckInvoked"]:1});this.l6c.CAn()}qO(Q,ya,gb){if(1===gb)return vf.SessionStatusManager.instance.Sj?8:32;this.gJa.isVisible||this.q2k();this.eYn();return 32}AXe(Q,ya,gb){1!==gb&&this.gJa.Hla();return 32}hIf(){this.gJa.A0c(!0)}P4e(Q){if(Q){if(Q.AccessibilityRules&&Object.keys(Q.AccessibilityRules).length){const gb=Q.AccessibilityRules;for(let Ob in gb){var ya=Ob;const mc=gb[Ob].RuleId+"";ya!==mc&&v.b(36214998,200,15,"AccessibilityRules is malformed: rule ID {0} maps to rule with ID {1}",
ya,mc)}this.Fge=gb}else!this.Fge&&Q.Results&&0<Q.Results.length?(v.b(18993251,200,15,"No accessibility rule definitions available"),Q.IsSuccess=!1):Q.AccessibilityRules=this.Fge;Q.IsSuccess||v.b(19969185,200,50,"{0}",{["accCheckFailed"]:1});this.Tpn(Q);this.XAm(Q);this.gJa.P4e(Q)}}Tpn(Q){const ya=Q.AccessibilityRules;if(Q=Q.Results)for(let gb=Q.length-1;0<=gb;gb--){const Ob=Q[gb];let mc="";const dd=Ob.RuleId;Ob.ContentName||(mc+="Result does not have content name. ");dd in ya||(mc+=String.format("No accessibility check rule exists for ID {0}.",
dd));0<mc.length&&(v.b(36214999,200,15,"Omitting invalid accessibility check result: "+mc),Array.removeAt(Q,gb))}}MHl(){return H.AFrameworkApplication.K.$("DynamicBundlesIsEnabled")?appResourceLoader.loadChunk("accessibility-checker-pane-strings"):qa.a.instance.resolve("Common.IDynamicScriptLoaderProvider").JE.loadScript("accessibility-checker-pane-strings")}eYn(){this.lLg?this.gJa.qO():this.MHl().then(()=>{this.lLg=!0;this.gJa.qO()}).catch(Q=>la.ULS.sendTraceTag(540034694,334,10,"Failed to load the resources for the accessibilityChecker feature: {0}",
Q))}XAm(Q){var ya={};const gb={};var Ob=Q.Results,mc=[];Array.add(mc,Object.assign(new Nj.a,{name:"FinalViolationCount",int64:0}));Array.add(mc,Object.assign(new Nj.a,{name:"FinalErrorCount",string:"0"}));Array.add(mc,Object.assign(new Nj.a,{name:"FinalWarningCount",string:"0"}));Array.add(mc,Object.assign(new Nj.a,{name:"FinalTipCount",string:"0"}));Array.add(mc,Object.assign(new Nj.a,{name:"FinalIntelligentServiceCount",string:"0"}));if(Ob){for(const He of Ob)if(Q.AccessibilityRules){var dd=Q.AccessibilityRules[He.RuleId];
if(dd){if(ya[rg[dd.Category]]){let Ue=ya[rg[dd.Category]];ya[rg[dd.Category]]=++Ue}else ya[rg[dd.Category]]=1;gb[He.RuleId]?(dd=gb[He.RuleId],gb[He.RuleId]=++dd):gb[He.RuleId]=1}}mc[0].int64=Ob.length;for(var Md in ya)switch(Q=ya[Md],Ob=Md,Ob="Final"+Ob.charAt(0).toUpperCase()+Ob.substring(1,Ob.length)+"Count",Ob){case "FinalErrorCount":mc[1].string=Q.toString();break;case "FinalWarningCount":mc[2].string=Q.toString();break;case "FinalTipCount":mc[3].string=Q.toString();break;case "FinalIntelligentServiceCount":mc[4].string=
Q.toString()}}Nm.a.sendTelemetryEvent(Object.assign(new Sd.a,{name:String.format("{0}.{1}","Office.UX.AccChecker","AccCheckerViolationInformation"),dataFields:mc}));for(let He in gb)ya=He,mc=gb[He],Md=[],Array.add(Md,Object.assign(new Nj.a,{name:"RuleID",string:ya})),Array.add(Md,Object.assign(new Nj.a,{name:"FinalViolationCount",string:mc.toString()})),Nm.a.sendTelemetryEvent(Object.assign(new Sd.a,{name:String.format("{0}.{1}","Office.UX.AccChecker","AccCheckerFinalViolationCountPerRule"),dataFields:Md}))}dispose(){this.gJa&&
this.gJa.dispose();this.l6c&&this.l6c.dispose()}}Object(e.a)(Tj,"AAccessibilityCheckManager",null,[58,9]);var yl=d(333);class xg extends Tj{constructor(Q,ya,gb){super(ya,gb,Q);this.graph=null}FIi(Q,ya,gb,Ob,mc){if(1===gb)return 32;mc[yl.a.On]=this.gJa.isVisible;return 32}vmn(){for(const Q of this.bui){const ya=this.graph.Se(Q);ya.lp(Object(a.a)(this,this.Vh,"onPropertyChanged"));ya.ys(Object(a.a)(this,this.fO,"onConnected"));ya.zv(Object(a.a)(this,this.wTc,"onDisconnected"))}}hfo(){for(const Q of this.bui){const ya=
this.graph.Se(Q);ya.EX(Object(a.a)(this,this.Vh,"onPropertyChanged"));ya.jM(Object(a.a)(this,this.fO,"onConnected"));ya.Saa(Object(a.a)(this,this.wTc,"onDisconnected"))}}dispose(){super.dispose();this.hfo()}Vh(){this.hIf()}fO(){this.hIf()}wTc(){this.hIf()}}Object(e.a)(xg,"ALiveBooksAccessibilityCheckManager",Tj,[]);class zl extends xg{constructor(Q,ya,gb,Ob,mc,dd){super(Q,ya,gb);this.zc.pa(Ra.a.e0f,uc.a.frame,Object(a.a)(this,this.qO,"showPane"));this.zc.gb(Ra.a.edn,uc.a.frame,Object(a.a)(this,this.FIi,
"queryToggleAccCheckerPane"),96);this.graph=mc;this.UMj=Ob;this.pJj=dd;this.vmn()}get bui(){return[12,14,22,19,30,43,44]}OJn(Q){if(this.pJj)return la.ULS.sendTraceTag(20713608,334,15,"ODT file. Disable content navigation."),!0;la.ULS.shipAssertTag(20272215,334,!!Q);return this.UMj.zKm(Q)}}Object(e.a)(zl,"WordAccessibilityCheckManager",xg,[]);var Sl=d(93),Po=d(34),gn=d(140),Om=d(21),om=d(184),lk=d(5),Rf=d(18),We=d(502);class Ij{constructor(Q,ya,gb,Ob,mc,dd,Md){this.Fo=null;this.Ixb=0;this.Xc=ya;this.jB=
gb;this.ib=Ob;this.ga=mc;this.Zc=dd;this.rt=Q;this.qd=Md}get ZQ(){if(!this.Fo){const Q=this.Xc.fg(this.rt.Yc);this.jB.X6f(Q);if(Q.Bb(7)||Q.kd(7))this.Fo=Sl.a.Kr(Q,Q.origin)}return this.Fo}zKm(Q){if(!Q||!Q.Bg||0>=Q.Bg.length)return la.ULS.shipAssertTag(20272217,334,!1,"ContentId is null or invalid."),!1;var ya=Array(Q.Bg.length);let gb=7,Ob=null;for(let dd=0;dd<Q.Bg.length;dd++)if(Ob=this.R9k(Q.Bg[dd])){if(7===gb)gb=this.Ixb;else if(gb!==this.Ixb)return la.ULS.shipAssertTag(20272218,334,!1,"Two paragraphs in a range selections don't belong to the same view."),
!1;var mc=this.qd.hOa(Ob.characterData,Ob.qa);const Md=Q.cpBegin?this.qd.kxb(mc,Q.cpBegin):-1;mc=Q.cpEnd?this.qd.kxb(mc,Q.cpEnd):-1;if(-1>Md||-1>mc)return la.ULS.shipAssertTag(20272219,334,!1,"Fail to convert WordTextOffset to WAC cp. Reset Cps to -1."),!1;ya[dd]=Po.a.pL(Md,mc,!1,Ob);switch(Q.contentType){case 5:if(!gn.HyperlinkReader.T3h(ya[dd],!1))return!1;break;case 6:if(!Om.ImageReader.Q$(ya[dd]))return!1;break;case 7:ya[dd]=Po.a.pL(-1,-1,!1,Ob)}}else return!1;ya=new om.Selection(ya,!1);return this.GOn(Ob,
ya,Q.contentType)}R9k(Q){if(this.ZQ)for(this.ZQ.reset(),this.Ixb=7;this.ZQ.moveNext();){var ya=this.ZQ.currentNode.type;if(38===ya||36===ya||23===ya)this.Ixb=ya;else if(12===ya){ya=this.ZQ.currentNode;const gb=ya.ia(lk.a.Nc,0);if(Q===gb)return ya}}return null}K3f(Q){this.ga.processAction(Rf.a.KS,2);this.ga.processAction(Rf.a.T9,2);let ya=2;switch(this.Ixb){case 23:ya=32;break;case 38:ya=this.ga.Xb(Rf.a.xib,2,new We.a(Q));break;case 36:ya=this.ga.Xb(Rf.a.Wgb,2,new We.a(Q));break;default:la.ULS.shipAssertTag(20272220,
334,!1,"Unexpected search scope encountered: {0}",this.Ixb)}if(32===ya)return!0;la.ULS.shipAssertTag(20272221,334,!1,"Fail to switch to target view: {0}",this.Ixb);return!1}GOn(Q,ya,gb){if(this.K3f(Q)){Q=this.rt.wv;const Ob=this.ib.hb.kb;Ob&&Ob.equals(ya)&&this.Zc.$na(Q,null);this.Zc.$na(Q,ya);switch(gb){case 0:case 1:this.ga.processAction(Xg.a.lJb,2);break;case 2:this.ga.processAction(Xg.a.zZc,2);break;case 3:this.ga.processAction(Xg.a.yva,2)}return!0}return!1}}Object(e.a)(Ij,"WordAccessibilityCheckNavigateManager",
null,[1764]);class Al{constructor(Q){this.IFa=null;this.WFg=Q}get fileId(){return this.WFg?this.WFg():null}initialize(Q){this.IFa=Q}nwi(Q){this.IFa.P4e(Q)}}Object(e.a)(Al,"AAccessibilityCheckService",null,[60,9]);class fj{constructor(){this.AccessibilityRules=null;this.IsSuccess=this.IsPartialResult=!1;this.Results=null}static deserialize(Q){Q=Sys.Serialization.JavaScriptSerializer.deserialize(Q);const ya=Q.AccessibilityRules,gb={};if(ya)for(let Ob=0;Ob<ya.length;++Ob){const mc=ya[Ob];gb[mc.Key]=
mc.Value}Q.AccessibilityRules=gb;return Q}}Object(e.a)(fj,"AccessibilityCheckResultCollection",null,[]);class gj extends Al{constructor(Q){super(Q)}onFailure(Q,ya){la.ULS.shipAssertTag(20730842,334,!1,"Acc Checker force save failed! StatusCode:{0}",ya);Q=Object.assign(new fj,{IsSuccess:!1});this.nwi(Q)}onSuccess(Q){Q=gj.BGl(Q);let ya=null;if(Q)try{ya=this.RTk(Q)}catch(gb){la.ULS.shipAssertTag(20730843,334,!1,"AccChecker response data is invalid. [{0}]",gb.message),ya=Object.assign(new fj,{IsSuccess:!1})}else la.ULS.shipAssertTag(20730844,
334,!1,"AccChecker response is NULL."),ya=Object.assign(new fj,{IsSuccess:!1});this.nwi(ya)}dispose(){}static BGl(Q){let ya=null;Q&&Q.jk&&(ya=Q.jk[0]);return ya?ya.Body:null}}Object(e.a)(gj,"ALiveBooksAccessibilityCheckService",Al,[]);var Tl=d(1054),Em=d(245);class vn extends Em.a{constructor(){super();this.FileId=null;this.IsCoauthorable=!1}Wl(){return 56}static construct(Q,ya){const gb=new vn;gb.FileId=Q;gb.IsCoauthorable=ya;return gb}}Object(e.a)(vn,"WordAccessibilityCheckRequest",Em.a,[]);class tg{}
Object(e.a)(tg,"AccessibilityCheckRule",null,[]);var pm=d(148);class hn{static parse(Q){switch(Tb.a.mh(Q)){case "warnings":return 1;case "tips":return 2;case "errors":return 0;case "intelligentservices":return 3;default:throw Q=String.format("Invalid Accessibility result category: {0}",Q),pm.a.argument(Q);}}}Object(e.a)(hn,"AccessibilityRuleCategoryParser",null,[]);class Zn{constructor(){this.Category=this.Text=this.Id=null}static c9n(Q){const ya=new tg;ya.RuleId=Q.Id;ya.RuleName=Q.Text;ya.Category=
hn.parse(Q.Category);return ya}}Object(e.a)(Zn,"WordAccessibilityCheckRule",null,[]);class Ok{}Object(e.a)(Ok,"AccessibilityCheckResult",null,[]);class rl{constructor(){this.cpEnd=this.cpBegin=this.Bg=null;this.contentType=0}}Object(e.a)(rl,"WordAccessibilityCheckContentId",null,[]);const zm=Q=>{switch(Tb.a.mh(Q)){case "tableheading":return 0;case "tablerow":return 1;case "tablecolumn":return 2;case "table":return 3;case "textcontrast":return 4;case "hyperlink":return 5;case "inlinepicture":return 6;
case "anchoredepicture":return 7;default:return 8}};var il=d(1559);class Pn{constructor(){this.OE=this.OS=this.ContentType=this.Label=this.RuleId=this.ParaId=null}static a9n(Q){const ya=new Ok;ya.RuleId=Q.RuleId;ya.ContentName=Q.Label;const gb=new rl;gb.Bg=Q.ParaId;gb.cpBegin=il.b(Q.OS);gb.cpEnd=il.b(Q.OE);gb.contentType=zm(Q.ContentType);ya.ContentId=gb;return ya}}Object(e.a)(Pn,"WordAccessibilityViolation",null,[]);class up{constructor(){this.Violations=this.Rules=null}static b9n(Q){const ya=new fj;
try{var gb={};if(Q.Rules){for(let Ob=0;Ob<Q.Rules.length;++Ob){const mc=Zn.c9n(Q.Rules[Ob]);gb[mc.RuleId]=mc}ya.AccessibilityRules=gb}if(Q.Violations){const Ob=Array(Q.Violations.length);for(gb=0;gb<Q.Violations.length;++gb)Ob[gb]=Pn.a9n(Q.Violations[gb]);ya.Results=Ob}ya.IsPartialResult=!1;ya.IsSuccess=!0}catch(Ob){la.ULS.shipAssertTag(20272214,334,!1,"Failed to convert WordAccessibilityCheckResult to AccessibilityCheckResultCollection. [{0}]",Ob.message),ya.IsSuccess=!1}return ya}}Object(e.a)(up,
"WordAccessibilityCheckResult",null,[]);class Qn extends gj{constructor(Q,ya,gb){super(Q);this.AQb=ya;this.sqb=gb}CAn(){const Q=Object.assign(new Tl.a,{Yr:vn.construct(this.fileId,this.sqb),status:1,iH:"AccessibilityCheck"});this.AQb(12,!1,Object(a.a)(this,this.onSuccess,"onSuccess"),Object(a.a)(this,this.onFailure,"onFailure"),Q,null,Q)}RTk(Q){Q=Ka.b(Q);return up.b9n(Q)}}Object(e.a)(Qn,"WordAccessibilityCheckService",gj,[]);class Rn extends Di{constructor(){super()}get name(){return"WordEditor.AccessibilityChecker"}yc(Q){super.yc(Q);
Q.ha("Common.App.AccessibilityChecker.IAccessibilityCheckPane",()=>new pg(H.AFrameworkApplication.ya,ql.a.instance,sd.FocusManager.instance(),Hj.a.instance,Q.ef("Common.App.AppsForOfficeCommon.IAppsForOfficeUIActor"),Jf.KeyInputManager.instance,qn.a.instance,H.AFrameworkApplication.K.lb("AccessibilityCheckerHelpUrl"))).singleInstance();Q.ha("Common.App.AccessibilityChecker.IAccessibilityCheckService",()=>new Qn(()=>H.AFrameworkApplication.rootQuerySignature,yc.a.PP,yk.PageReader.instance.pGd(Ae.App.xa.jb.Yc))).singleInstance();
Q.ha("WordEditor.AccessibilityChecker.WordAccessibilityCheckNavigateManager",()=>new Ij(Ae.App.xa.jb,Q.resolve("Box4.Graph.IGraphIteratorFactory"),xj.PageNavigator.instance,Q.resolve("Box4.ISelectionManager"),H.AFrameworkApplication.ya,eo.InteractiveViewManager.instance,Q.resolve("WordEditor.WordTextOffsetTranslator.IWordTextOffsetTranslator"))).singleInstance();Q.ha("Common.App.AccessibilityChecker.IAccessibilityCheckManager",()=>new zl(H.AFrameworkApplication.ya,Q.resolve("Common.App.AccessibilityChecker.IAccessibilityCheckPane"),
Q.resolve("Common.App.AccessibilityChecker.IAccessibilityCheckService"),Q.resolve("WordEditor.AccessibilityChecker.WordAccessibilityCheckNavigateManager"),Ae.App.Xj.al,ui.App.COc)).singleInstance()}init(){ui.App.dee&&this.container.resolve("Box4.IFeatureHelper").Yk.continueWith(()=>{Di.prototype.init.call(this)})}}Object(e.a)(Rn,"WordAccCheckerPackageManager",Di,[]);class Uj{constructor(Q,ya){this.d2g=!1;this.Zao=()=>{this.Yao()};this.Zj=Q;this.hS=ya}iib(Q){Q.RW.h9j(this.Zao)}Yao(){!this.d2g&&this.Zj&&
(this.Zj.CCa?this.hS?this.hS.execute(Q=>{Q.logActivity("WordWebToWebActiveCoauth","WebToWebActiveCoauthFloodgateSurveyIsEnabled")}):la.ULS.sendTraceTag(51389134,304,10,"Future ISystemInitiatedFeedback not available"):this.d2g=!0)}}Object(e.a)(Uj,"CoauthSurveyManager",null,[1727]);class zk{constructor(){this.rt=this.W=null}get name(){return"WordEditor.CoauthSurveys"}init(){Ae.App.xa&&(this.rt=Ae.App.xa.jb)&&(this.rt.Ata?this.Uga():this.rt.hda(()=>{this.Uga()}))}Uga(){var Q=this.rt.Yc;Q&&(Q=Q.contentReplicator)&&
this.W.resolve("WordEditor.CoauthSurveys.CoauthSurveyManager").iib(Q)}dispose(){}yc(Q){this.W=Q;Q.ha("WordEditor.CoauthSurveys.CoauthSurveyManager",()=>new Uj(Q.resolve("WordEditor.IWordEditorCoauthManager"),Q.Za("Common.ISystemInitiatedFeedback"))).as("WordEditor.CoauthSurveys.ICoauthSurveyManager").singleInstance()}static main(){H.AFrameworkApplication.K.$("CoauthSurveysPackageIsEnabled")&&ca.a.instance.Oc(new zk)}}Object(e.a)(zk,"WordEditorCoauthSurveyManagerPackage",null,[1,2]);var cm;(function(Q){Q[Q.graphSpaceReplicatorNotSendingContent=
0]="graphSpaceReplicatorNotSendingContent";Q[Q.inboundRequestTakesTooLongToSendAfterRTC=1]="inboundRequestTakesTooLongToSendAfterRTC";Q[Q.docxSaveMonitorKickoutElapsed=2]="docxSaveMonitorKickoutElapsed"})(cm||(cm={}));Object(e.b)("ComponentLoggingScenario",cm);var Wo=d(1431);class In{flush(Q,ya){const gb=this.Fpl(Q);gb.LoggingScenario=cm[ya];ej.a(gb).length?la.ULS.sendTraceTag(594571986,3013,15,"{0}",gb):la.ULS.sendTraceTag(594571987,3013,15,"No log returned when component state log manager trying to log with {0}",
Wo.a[Q.nWa])}Fpl(Q){const ya={};if(!Q)return ya;const gb=new jd.a;for(gb.enqueue(Q);!gb.isEmpty;){Q=gb.dequeue();const Ob=Wo.a[Q.nWa];try{ya[Ob]=Q.pI()}catch(mc){la.ULS.sendTraceTag(594571985,3013,15,"Exception when component state log manager trying to log with {0}, details: {1}",Ob.toString(),{["Kind"]:"Exception",["Stack"]:mc.stack,["Message"]:mc.message,["FileName"]:mc.fileName,["LineNumber"]:mc.lineNumber})}if((Q=Q.awd)&&Q.length)for(let mc of Q)!mc||Wo.a[mc.nWa]in ya||gb.enqueue(mc)}return ya}}
Object(e.a)(In,"ComponentStateLogManager",null,[1728]);class Ul{flush(){}}Object(e.a)(Ul,"NoOpComponentStateLogManager",null,[1728]);class Ym{constructor(){this.W=null}get name(){return"WordEditor.ComponentStateLogging"}init(){this.W.resolve("Common.IComponentStateLogManager")}dispose(){}yc(Q){this.W=Q;H.AFrameworkApplication.K.$("ComponentStateLoggingPackageIsEnabled")?Q.ha("WordEditor.ComponentStateLogging.ComponentStateLogManager",()=>new In).as("Common.IComponentStateLogManager").singleInstance():
Q.ha("WordEditor.ComponentStateLogging.NoOpComponentStateLogManager",()=>new Ul).as("Common.IComponentStateLogManager").singleInstance()}static main(){ca.a.instance.Oc(new Ym)}}Object(e.a)(Ym,"WordEditorComponentStateLoggingPackage",null,[1,2]);var Fm=d(1919);class Hk{constructor(Q,ya,gb){this.rg=Q;this.omd=ya;this.gXg=gb}Lj(Q,ya,gb,Ob,mc,dd,Md,He,Ue,Sf=null,of=!1,cj=null,el=null,qk=null,jm=null,Qk=!1){return this.gXg?this.omd.Lj(Q,ya,gb,Ob,mc,dd,Md,He,Ue,Sf,of,el,qk):this.rg.Lj(Q,ya,gb,Ob,mc,dd,
Md,He,Ue,Sf,of,cj,el,qk,jm,Qk)}y3b(Q){return this.gXg?this.omd.y3b():this.rg.y3b(Q)}}Object(e.a)(Hk,"ClientRequestAdapter",null,[906]);var dm=d(182),Xo=d(263),Si=d(267),rj=d(1383),Gm=d(285),Ik=d(1396),Yf=d(1920),im=d(54),Zm=d(725),qf=d(600),Wi=d(126),jg=d(684),Oj=d(485),sj;(function(Q){Q[Q.none=0]="none";Q[Q.getCells=1]="getCells";Q[Q.hotStoreStatus=2]="hotStoreStatus";Q[Q.saveMonitor=3]="saveMonitor";Q[Q.saveMonitor_LineageTombstone=4]="saveMonitor_LineageTombstone";Q[Q.kickoutExecutor=5]="kickoutExecutor"})(sj||
(sj={}));Object(e.b)("MostRecentRevisionIdOrigin",sj);class jl extends Sys.EventArgs{constructor(Q,ya,gb,Ob){super();this.A8b=Q;this.xZm=ya;this.httpStatusCode=gb;this.nD=Ob}}Object(e.a)(jl,"UpdatedLastRevisionSaveIdEventArgs",Sys.EventArgs,[]);class oh{constructor(){this.d5=0}get isEmpty(){return!this.d5}lyc(Q){this.d5|=Q}aPc(Q){return!!(this.d5&Q)}clear(){this.d5=0}lAc(){return!1}}Object(e.a)(oh,"DocxSaveMonitorRetryAttemptOnce",null,[]);class Gl{constructor(Q,ya=3){this.d5=0;this.xkd=new Map;this.hMj=
Q;this.USj=ya}get isEmpty(){return!this.d5}lyc(Q){this.d5|=Q;let ya=this.xkd.get(Q)||0;this.xkd.set(Q,++ya)}aPc(Q){return!!(this.d5&Q)}clear(){this.d5=0;this.xkd.clear()}lAc(Q){return this.USj&Q?(this.xkd.get(Q)||0)<this.hMj:!1}}Object(e.a)(Gl,"DocxSaveMonitorRetryAttemptMany",null,[]);class oa{static create(Q=!1,ya=3,gb=0){return Q?new Gl(ya,gb):new oh}}Object(e.a)(oa,"DocxSaveMonitorRetryAttemptFactory",null,[]);var cb=d(1660),xb;(function(Q){Q[Q.UHo=-1]="noResultYet";Q[Q.WMo=0]="upToDate";Q[Q.IKo=
1]="sessionLost";Q[Q.bNo=2]="userSignedOut";Q[Q.sJo=3]="previousRequestPending";Q[Q.r4d=4]="requestFailed";Q[Q.cLo=5]="shuttingDown";Q[Q.ZHo=6]="nullResponseData";Q[Q.kGo=7]="invalidResponseData";Q[Q.wEo=8]="failedRevisionLookup";Q[Q.mKo=9]="savedWithinThreshold";Q[Q.WHo=10]="notSavedWarning";Q[Q.BGo=11]="kickoutThreshold";Q[Q.HMo=12]="unknownRevision";Q[Q.ECo=13]="contentNotYetLoaded";Q[Q.sessionExpired=14]="sessionExpired";Q[Q.canaryError=15]="canaryError";Q[Q.timeout=16]="timeout";Q[Q.CGo=17]=
"kickoutThreshold_Offline";Q[Q.HDo=18]="dssSessionDeleted";Q[Q.IDo=19]="dssSessionExpired";Q[Q.hNo=20]="waitingForSessionTokenRefresh";Q[Q.JDo=21]="dssSessionNotFound"})(xb||(xb={}));Object(e.b)("SaveMonitorResult",xb);class Qb{constructor(Q,ya,gb,Ob,mc,dd,Md,He,Ue,Sf,of,cj,el,qk,jm,Qk,Kn,yj,Mg,aq,as,zj,Rm,Lq,Cl,Qu=null,Jr,vr){this.Qrc=0;this.ERb=!1;this.yuc=null;this.uqc=this.bN=-1;this.iDe=null;this.Wid=0;this.Xid=!1;this.Lrb=null;this.ysc=0;this.YFe=this.k3g=null;this.sR=this.jOg=this.Lne=0;this.uxe=
null;this.oLg=!1;this.Nn=null;this.pmd=0;this.Wnd=void 0;this.Uld=this.p0g=!1;this.IYg=0;this.X$k=()=>{var ug;la.ULS.sendTraceTag(524871194,Qb.Rn,50,"DocxSaveMonitor tick: {0}",{["IsUpToDate"]:this.iX,["AppVisibilityState"]:rj.a[null===(ug=this.Nn)||void 0===ug?void 0:ug.$D]});ug=this.Uqb;this.Uqb=this.uy();if(this.UO())this.oz.event(5),this.stop("session has shut down");else{this.I7a===Qb.CSi&&this.iwa(this.kQb);var Aj=this.eoc();if(Aj)if(this.Jve()&&H.AFrameworkApplication.Hl("Microsoft.Office.Web.SessionSettings.IWacWordDocxSaveMonitorWaitForTokenRefreshSettings"),
this.iX)this.oz.event(0);else if(this.IRb())this.oz.event(1),this.stop("session is lost"),H.AFrameworkApplication.Hf("WordKickoutSafetyCheck;WordKickoutSafetyCheckcf"),this.oLg&&!this.vfm()&&(la.ULS.sendTraceTag(554726995,Qb.Rn,10,"DocxSaveMonitor: Session lost but not kicked out"),this.Zw(im.a.pBh));else if(this.Jve())20!==this.oz.currentState?(this.oz.event(20),this.k3g=this.uy(),la.ULS.sendTraceTag(593510691,Qb.Rn,15,"Detected that session is expired. DocxSaveMonitor will wait for {0}ms to see if we can refresh the access token.",
this.m3g)):this.uy().getTime()-this.k3g.getTime()>this.m3g&&(this.oz.event(14),this.Uld?this.mRd(20,im.a.wEc,"TokenExpired"):(this.stop("Waited too long for session token to be refreshed"),this.Zw(im.a.wEc)));else if(this.jKj())if(this.Uqb=ug,this.ERb)this.oz.event(3),this.uy().getTime()-this.yuc.getTime()>this.Gwe&&(ug=this.rke.y3b(this.bN),la.ULS.sendTraceTag(19161610,205,50,"DocxSaveMonitorKickout: Status for presumably pending request {0} is {1}",this.bN,Uf.a[ug]),this.ikd&&this.ikd.log(),this.stop("stuck on previousRequestPending"),
this.Zw());else if(ug=qf.b(cb.a.construct(Aj)),this.ERb=!0,this.yuc=this.ESj(),this.bN=this.rke.Lj(Qb.serviceUrl,2,ug,{"Content-Type":"application/json; charset=utf-8"},!1,0,this.Luk,this.Kuk,null,void 0,void 0,this.HRj,this.EGe,void 0,void 0,!0),0>=this.bN)this.ERb=!1,la.ULS.sendTraceTag(19161611,205,50,"DocxSaveMonitorKickout: Request {0} was not added to the queue.",this.bN.toString());else{ug=this.rke.y3b(this.bN);Aj=100;if(ug&&1!==ug||this.OIg)Aj=50;la.ULS.sendTraceTag(19161612,Qb.Rn,Aj,"DocxSaveMonitor: Sending Request {0}",
{["Id"]:this.bN,["Status"]:Uf.a[ug]});this.ikd&&this.ikd.start(this.bN)}else this.oz.event(2);else this.oz.event(13)}};this.Kuk=ug=>{this.sR=this.jwd+1;let Aj=this.ERb=!1,vg=!1;ug=ug.data;Ja.a.xl&&H.AFrameworkApplication.maa("MultipleRetriesForDocxSaveMonitor_t;MultipleRetriesForDocxSaveMonitor_c");ug?(la.ULS.sendTraceTag(22552773,Qb.Rn,15,"Request failed {0}",{["Status"]:ug.status,["HttpStatus"]:ug.wf,["Correlation"]:ug.rj?ug.rj[Gm.a.N5]:"",["Id"]:ug.id,["ConsecutiveErrors"]:this.jwd,["Request.InvokedTime"]:ug.eH,
["Request.EnqueueTime"]:ug.EKa,["Request.CompletedTime"]:ug.AS}),vg=7===ug.status||13===ug.status,this.lAc(2)&&vg?(this.BRa.lyc(2),Aj=!0,this.uqc=ug.wf,this.oz.event(16)):this.lAc(1)&&5===ug.status?(this.BRa.lyc(1),Aj=!0,this.uqc=ug.wf,this.oz.event(15)):(this.oz.event(4),this.uqc=ug.wf)):(this.oz.event(4),la.ULS.sendTraceTag(23425240,Qb.Rn,15,"RequestFailed and event data is null"));if(!Aj&&(this.BRa.clear(),vg?this.mRd(17,im.a.LZk,"while offline"):this.mRd(11,im.a.n5e,"while online")))return;this.iwa(Aj?
this.Qil(vg):this.kQb)};this.Luk=ug=>{this.sR=this.jwd+1;this.ERb=!1;var Aj={};this.BRa.clear();if(ug=ug.data){var vg=ug.rj?ug.rj[Gm.a.N5]:"";Aj.HttpStatus=ug.wf;Aj.Correlation=vg;Aj.Id=ug.id;la.ULS.sendTraceTag(23425242,Qb.Rn,this.OIg?50:100,"Request succeeded at the HTTP level {0}",Aj);this.uqc=ug.wf}else la.ULS.sendTraceTag(23425241,Qb.Rn,15,"Request succeeded with null response data");if(this.UO()||!this.bAd)this.oz.event(5),this.stop("session has shut down");else if(!this.skm())if(ug&&ug.Ge)if(ug=
this.isa(ug.Ge))if(this.B8.omb(ug),ug.StatusCode)this.lvf(ug,Aj)||this.oz.event(8,Aj);else{this.sR=0;this.Uqb=this.uy();this.bFe.clear();Aj={["LastSavedRevisionId"]:ug.LastSavedRevisionId,["LastSavedRevisionSequenceNumber"]:ug.RevisionSequenceNumber};ug=Wi.b(ug.LastSavedRevisionId);this.$dc(ug,3);var hr=this.Jcf().store.getRevision(ug);if(hr){ug=null;vg=this.Bdb();hr=(hr=hr.wdb(vg))?hr.id:Gf.a.nil;let Ap=vg;for(;Ap&&!Ap.id.equals(hr);)ug=Ap,Ap=Ap.il;this.gUl(ug,Aj,vg)||this.oz.event(9)}else this.TSl()||
this.oz.event(12,Aj);this.iwa(this.iwc)&&la.ULS.sendTraceTag(22552774,Qb.Rn,50,"Received response from server -- going back to normal interval")}else this.oz.event(7),this.mvf("invalid response",Aj);else this.oz.event(6),this.mvf("null response",Aj)};this.pyn=(ug,Aj)=>{ug={};ug.DocxSaveMonitorState=xb[Aj.newState];ug.PreviousState=xb[Aj.RMf];ug.PreviousStateHits=Aj.SMf;ug.PreviousStateTransitionTime=Aj.TMf.toISOString();ug.LastHttpStatus=this.uqc;ug.LastSuccessTime=this.Uqb.toISOString();this.yuc&&
(ug.LastRequestStartTime=this.yuc.toISOString());ug.LastSavedRevisionID=this.M9b.toString();ug.LastSavedRevisionIdOrigin=this.Qrc;ug.LastSavedRevisionIdSetTime=this.YFe?this.YFe.toISOString():null;ug.IsViable=this.ff.bua;ug.IsNetworkConnected=this.ff.jK;ug.IsExpired=this.ff.t2;ug.HasEmergencyViewModeBeenDeployed=this.ff.Sj;ug["Navigator.Online"]=window.navigator.onLine;const vg=Aj.t2n;vg&&Qb.Wqi(ug,vg);Aj=Aj.newState;switch(Aj){case 13:la.ULS.sendTraceTag(5830086,Qb.Rn,50,"{0}",ug);break;case 1:la.ULS.sendTraceTag(5884125,
Qb.Rn,50,"{0}",ug);break;case 0:la.ULS.sendTraceTag(5830087,Qb.Rn,50,"{0}",ug);break;case 2:la.ULS.sendTraceTag(5830088,Qb.Rn,50,"{0}",ug);break;case 3:la.ULS.sendTraceTag(5830089,Qb.Rn,50,"{0}",ug);break;case 4:la.ULS.sendTraceTag(5884126,Qb.Rn,50,"{0}",ug);break;case 5:la.ULS.sendTraceTag(5884127,Qb.Rn,50,"{0}",ug);break;case 6:la.ULS.shipAssertTag(5830090,Qb.Rn,!1,"{0}",ug);break;case 7:la.ULS.shipAssertTag(5830091,Qb.Rn,!1,"{0}",ug);break;case 8:la.ULS.sendTraceTag(5830092,Qb.Rn,15,"{0}",ug);
break;case 10:la.ULS.sendTraceTag(5830094,Qb.Rn,15,"{0}",ug);break;case 9:la.ULS.sendTraceTag(5884128,Qb.Rn,50,"{0}",ug);break;case 11:la.ULS.sendTraceTag(5830096,Qb.Rn,15,"{0}",ug);break;case 17:la.ULS.sendTraceTag(37835678,Qb.Rn,15,"{0}",ug);break;case 12:la.ULS.sendTraceTag(5830095,Qb.Rn,15,"{0}",ug);break;case 18:la.ULS.sendTraceTag(38122832,Qb.Rn,15,"{0}",ug);break;case 19:la.ULS.sendTraceTag(38122833,Qb.Rn,15,"{0}",ug);break;case 21:la.ULS.sendTraceTag(0,Qb.Rn,15,"{0}",ug);break;case 14:la.ULS.sendTraceTag(6575508,
Qb.Rn,15,"{0}",ug);break;case 15:la.ULS.sendTraceTag(36739287,Qb.Rn,50,"{0}",ug);break;case 16:la.ULS.sendTraceTag(36767649,Qb.Rn,15,"{0}",ug);break;case 20:la.ULS.sendTraceTag(593510690,Qb.Rn,15,"{0}",ug);break;default:la.ULS.shipAssertTag(5884129,Qb.Rn,!1,"Bad state:{0} logInfo:{1}",Aj,ug)}};this.iwc=Q;this.kQb=ya;this.I7a=Q;this.z5g=gb;this.PUj=Ob;this.HRj=dd;this.EGe=Md;this.RSb=He;this.ZBg=Ue;this.rke=Sf;this.EY=of;this.B8=cj;this.eoc=el;this.jKj=qk;this.IRb=jm;this.Jve=Qk;this.UO=Kn;this.uy=
yj;this.ESj=Mg;this.oLg=Cl;this.BRa=oa.create(vr.isEnabled,vr.maxRetries,zj.d5);this.bFe=new Oj.a;this.yqe=Rm;this.oz=new Ik.a(-1);this.ff=Qu;this.vv=Jr;this.oz.BPe(this.pyn);this.ikd=aq;this.Uqb=yj();this.OIg=as;this.vvj=vr.isEnabled?null:zj;this.Xnb=Lq;this.m3g=this.z5g;this.rze=Gf.a.nil;this.sa=new k.a;qa.a.instance.Za("Common.App.VisibilityManagement.IVisibilityManager").execute(ug=>{this.Nn=ug;this.Nn.mvb((Aj,vg)=>{this.w$(Aj,vg)});this.tDe=ug.$D});this.ff&&this.ff.mPe((ug,Aj)=>{this.$Fb(ug,
Aj)});this.p0g=H.AFrameworkApplication.K?H.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ShouldReportUpToDateKPI",!1):!1;this.Gwe=H.AFrameworkApplication.K?H.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.WordOnline.DocxSaveMonitorKickoutIntervalMs",mc):mc;if(this.Uld=H.AFrameworkApplication.K?H.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ShouldKickoutWithSessionExpiredOnlyWhenVisible",!1):!1)this.IYg=H.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.WordOnline.DocxSaveMonitorRetryIntervalAfterActive",
this.kQb);this.VSj=vr}$Fb(Q,ya){la.ULS.sendTraceTag(528577692,Qb.Rn,15,"DocxSaveMonitor: AppNetworkChanged event raised. OldState: [{0}], NewState: [{1}]",Yf.a[ya.TEf],Yf.a[ya.DSc]);1!==ya.DSc&&3!==ya.DSc&&(la.ULS.sendTraceTag(528566343,Qb.Rn,50,"Resetting list of current failed request retries. State before resetting is - Canary: [{0}], Timeout: [{1}]",this.BRa.aPc(1),this.BRa.aPc(2)),this.BRa.clear())}get bAd(){return this.Lne}get M9b(){return this.rze}get iX(){const Q=!this.Bdb()||this.M9b.equals(this.Bdb().id);
this.ovn(Q,this.vv.iX);Q||la.ULS.sendTraceTag(521413851,Qb.Rn,50,"Document has unSavedChanges: currentRevisionId [{0}], mostRecentRevisionIdResult [{1}]",this.Bdb().id.toString(),this.M9b.toString());return Q}get dei(){return this.uy().getTime()-this.Uqb.getTime()>this.Gwe}get jwd(){return this.sR}get nWa(){return 3}get awd(){let Q=null;Ae.App.xa&&Ae.App.xa.jb&&Ae.App.xa.jb.Yc&&(Q=Ae.App.xa.jb.Yc.contentReplicator);return[Q,ui.App.E_]}w$(Q,ya){var gb,Ob,mc;Q={["VisibilityState"]:rj.a[this.Nn.$D],
["IsVisible"]:this.Nn.isVisible,["DocxSaveMonitor"]:{["RequestPending"]:this.ERb,["KickoutIntervalElapsed"]:this.dei,["LastSuccessfulIterationTime"]:null!==(gb=this.Uqb)&&void 0!==gb?gb:"null",["RequestStartTime"]:null!==(Ob=this.yuc)&&void 0!==Ob?Ob:"null",["SkippedKickouts"]:this.pmd,["LastSkippedKickoutAt"]:null!==(mc=this.oOg)&&void 0!==mc?mc:"null"},["IsViable"]:this.ff.bua,["IsNetworkConnected"]:this.ff.jK,["IsExpired"]:this.ff.t2,["HasEmergencyViewModeBeenDeployed"]:this.ff.Sj,["Navigator.Online"]:window.navigator.onLine};
la.ULS.sendTraceTag(539874775,Qb.Rn,50,Ka.c(Q));this.tDe!=this.Nn.$D&&(this.Uld&&(0==ya.oldState||1==ya.oldState||0!==ya.newState&&1!==ya.newState||this.iwa(this.IYg)),0===this.Nn.$D?(Ie.c(Rf.a.jkk,void 0,void 0,void 0,void 0,void 0,Q),this.Wnd&&Ie.b("AvgTimeSpentOutsideOfWord",Date.now()-this.Wnd,1),this.Wnd=void 0):0===this.tDe&&(Ie.c(Rf.a.kkk,void 0,void 0,void 0,void 0,void 0,Q),this.Wnd=Date.now()),this.tDe=this.Nn.$D)}start(){this.Lne=this.ZBg.xbb(this.X$k,this.I7a)}iwa(Q){if(!this.bAd||this.I7a===
Q)return!1;const ya=this.I7a;this.I7a=Q;this.stop("changing save monitor interval from "+ya+"ms to "+Q+"ms");this.start();return!0}$dc(Q,ya){if(ya>=this.Qrc&&Q&&!Gf.a.nil.equals(Q)){var gb=!this.rze.equals(Q);this.Qrc=ya;this.rze=Q;const Ob=this.uy();this.YFe=Ob;const mc=this.iX;gb&&(ya={["Id"]:Q.toString(),["IsUpToDate"]:mc,["Origin"]:sj[ya]},this.uxe&&(ya.LastUpToDateTime=this.uxe.toISOString()),(gb=this.Jcf())&&gb.store&&(Q=gb.store.getRevision(Q))&&(ya.LastSavedCreationTime=Q.creationTime.toISOString()),
la.ULS.sendTraceTag(557320151,Qb.Rn,50,"Updating Last Saved Revision: {0}",ya));mc&&(this.uxe=Ob)}else ya<this.Qrc?la.ULS.sendTraceTag(572051800,Qb.Rn,50,'Deny lower rank origin: {{"CurrentOrigin":"{0}", "Attempt":"{1}"}}',this.Qrc,ya):la.ULS.sendTraceTag(572051801,Qb.Rn,15,'Deny null or Nil ID: {{"Attempt":"{0}"}}',ya)}stop(Q){this.We(Q)}We(Q){this.bAd&&(la.ULS.sendTraceTag(5830084,Qb.Rn,50,"Stopping DocxSaveMonitor because {0}!",Q),this.ZBg.We(this.bAd),this.Lne=0)}TSl(){if(0>=this.RSb)return!1;
var Q=this.igf();if(!Q)return this.iDe=null,this.Wid=0,this.Xid=!1;this.Lrb=Q.WCd;this.Lrb===this.iDe?this.Wid++:(this.iDe=this.Lrb,this.Wid=1,this.Xid=!1);if(this.Wid<Qb.CIm)return!1;this.ysc=+this.uy()-+this.Lrb;if(this.ysc<=this.RSb)return!1;if(!this.Xid)return this.Xid=!0,this.vJi(),!1;if(this.Xnb)this.Xnb.execute(ya=>{ya.flush(this,0)});else{Q="";try{this.yqe&&(Q=this.yqe())}catch(ya){Q=Ka.c({["Kind"]:"Exception",["Stack"]:ya.stack,["Message"]:ya.message,["FileName"]:ya.fileName,["LineNumber"]:ya.lineNumber}),
la.ULS.sendTraceTag(50426817,Qb.Rn,15,"Exception when getting log extra details for exceeding max allowed local revision age. {0}",Q)}la.ULS.sendTraceTag(50426818,Qb.Rn,15,"Oldest local revision was created at {0} which is {1}ms ago and exceeds max allowed age of {2}ms.  Extra Details: {3}",this.Lrb.toISOString(),this.ysc,this.RSb,Q)}this.RSb=-1;this.stop("Exceeded oldest allowed local revision");this.Zw(im.a.MZk);return!0}igf(){let Q=null,ya=this.Bdb();for(;ya&&!ya.Wta;)Q=ya,ya=ya.il;return Q}skm(){return this.IRb()?
(this.oz.event(1),this.stop("session is lost"),!0):this.Jve()?(this.oz.event(14),la.ULS.sendTraceTag(20029718,Qb.Rn,15,"ExpiredSessionNotLostYet"),this.stop("session is expired"),this.Zw(im.a.wEc),!0):!1}Jcf(){const Q=this.eoc();return Q?Q.Lc:null}Bdb(){const Q=this.Jcf();return Q?Q.Om:null}lAc(Q){return this.VSj.isEnabled?this.BRa.lAc(Q):this.vvj.aPc(Q)&&!this.BRa.aPc(Q)}Qil(Q){return Q?Qb.V8n:Qb.CSi}mRd(Q,ya,gb){if(this.dei)if(this.Nn&&!this.Nn.isVisible)la.ULS.sendTraceTag(540669727,Qb.Rn,15,"Kickout interval has elapsed, but browser tab is not visible. We will not kick out immediately"),
this.pmd+=1,this.oOg=this.uy();else return this.oz.event(Q,{}),this.stop("request failed after kickout interval "+gb),this.Xnb&&this.Xnb.execute(Ob=>{Ob.flush(this,2)}),this.Zw(ya),!0;return!1}lvf(Q,ya){const gb=Q.StatusCode;return 88===gb||89===gb||236===gb?(ya.KickoutDiagnostics=this.yqe(),88===gb?(ya.Result="deleted DSS session",this.oz.event(18,ya),this.stop("deleted DSS session"),this.Zw(im.a.localCobaltDeletedSessionFault)):89===gb?(ya.Result="expired DSS session",this.oz.event(19,ya),this.stop("expired DSS session"),
this.Zw(im.a.localCobaltExpiredSessionFault)):(H.AFrameworkApplication.Hl("Microsoft.Office.WordOnline.UpdateLastSavedRevisionIdOnDssSessionNotFoundIsEnabled"),H.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.UpdateLastSavedRevisionIdOnDssSessionNotFoundIsEnabled",!1)&&(Q=Wi.b(Q.LastSavedRevisionId),this.$dc(Q,4)),ya.Result="DSS session not found",this.oz.event(21,ya),this.stop("DSS session not found"),this.Zw(im.a.localCobaltSessionNotFound)),!0):14===gb?(this.stop("DSS returned an unspecified failure"),
this.Zw(im.a.svm),!0):104===gb?(this.stop("this operation is disabled on the server"),!0):this.mvf("unrecognized OperationResult: "+gb,ya)}mvf(Q,ya){if(!this.bFe.contains(Q))this.bFe.add(Q);else if(this.mRd(11,im.a.n5e,Q))return ya.ConsecutiveErrors=this.jwd,ya.Reason=Q,la.ULS.sendTraceTag(41997899,Qb.Rn,15,"DocxSaveMonitor kickout. {0}",ya),!0;this.iwa(this.kQb);return!1}gUl(Q,ya,gb){let Ob=!1;if(Q){const mc=this.uy().getTime()-Q.creationTime.getTime();mc>=this.z5g&&(Ob=!0,Qb.Wqi(ya,this.QGl(Q,mc,
gb)),mc>=this.Gwe&&10===this.oz.currentState?(this.oz.event(11,ya),this.stop("didn't save in time"),this.Zw()):(this.oz.event(10,ya),this.vJi(),this.I$e()))}return Ob}Y7j(Q){this.sa.addHandler(Qb.KFi,Q)}y$g(Q){this.sa.addHandler(Qb.Q$e,Q)}dPi(Q){this.sa.removeHandler(Qb.Q$e,Q)}vJi(){this.sa.raiseEvent(Qb.KFi)}isa(Q){let ya;return({group:ya}=jg.a.M7(Q)).returnValue?ya.Responses[0]:null}QGl(Q,ya,gb){const Ob={};Ob.FirstUnsavedRevisionId=Q.id.toString();Ob.FirstUnsavedRevisionLengthToRoot=Q.sQ;Ob.UnsavedTimeInMs=
ya;Ob.CurrentRevisionId=gb.id.toString();Ob.CurrentRevisionLengthToRoot=gb.sQ;return Ob}I$e(){yc.a.J$e(8)}Zw(Q=im.a.n5e){this.PUj?(this.stop(Qb.fpm),Q===im.a.wEc?this.EY.value.Zw(Q,Object.assign(new Zm.a,{Qja:4,D1:Box4Intl.Box4Strings.L_SessionExpiredMessageDescription,A9:Box4Intl.Box4Strings.L_SessionExpiredMessageTitle,showDescription:!0})):this.EY.value.Zw(Q,new Zm.a)):la.ULS.sendTraceTag(19247383,Qb.Rn,50,"Kickout disabled")}pI(){const Q={};this.Lrb&&(Q.ORT=this.Lrb.toISOString());0<this.ysc&&
(Q.AA=this.ysc);0<this.RSb&&(Q.MAA=this.RSb);0<this.pmd&&(Q.LSKO=this.oOg.toISOString());this.oz&&0<=this.oz.currentState&&(Q.SMS=xb[this.oz.currentState]);const ya={};H.AFrameworkApplication.oma&&(ya.S=1);Ae.App.lostSession&&(ya.LS=1);this.ff&&(this.ff.io&&(ya.KO=1),this.ff.t2&&(ya.TE=1));this.Nn&&(ya.VS=rj.a[this.Nn.$D]);window.navigator&&(ya.NW=!window.navigator.onLine);Q.AMD=ya;return Q}eul(){const Q={"Content-Type":"application/json; charset=utf-8","X-Requested-With":"Fetch"};H.AFrameworkApplication.buildVersion&&
(Q["X-OfficeVersion"]=Tb.a.gQ(H.AFrameworkApplication.buildVersion));H.AFrameworkApplication.accessToken&&(Q["X-AccessToken"]=Tb.a.gQ(H.AFrameworkApplication.accessToken),Q["X-AccessTokenTtl"]=H.AFrameworkApplication.fJa.toString());H.AFrameworkApplication.canary&&(Q["X-Key"]=Tb.a.gQ(H.AFrameworkApplication.canary));H.AFrameworkApplication.userType&&(Q["X-UserType"]=Tb.a.gQ(H.AFrameworkApplication.userType));const ya=H.AFrameworkApplication.Xe.U3;ya&&(Q["X-WacCluster"]=Tb.a.gQ(ya));H.AFrameworkApplication.userSessionId&&
(Q["X-UserSessionId"]=Tb.a.gQ(H.AFrameworkApplication.userSessionId));return Q}N$e(){var Q=this.ff?this.ff.networkState:null;if(1===Q||3===Q)la.ULS.sendTraceTag(558158790,Qb.Rn,15,"Not sending request because we dont have network.");else if(Q=this.eoc()){var ya=new Sys.Net.WebRequest;ya.set_httpVerb("POST");ya.set_url(Qb.serviceUrl);var gb={};gb.body=qf.b(cb.a.construct(Q));gb.headers=this.eul();gb.method=ya.get_httpVerb();try{"function"===typeof window.fetch?window.fetch(ya.getResolvedUrl(),gb).then(Ob=>
{la.ULS.sendTraceTag(561551382,Qb.Rn,50,"Request succeeded at the HTTP level {0}",Ob.statusText);this.jOg=Ob.status;return Ob.json()},Ob=>{la.ULS.sendTraceTag(561551383,Qb.Rn,15,"Request failed at the HTTP level {0}",Ob);return null}).then(Ob=>{Ob=JSON.stringify(Ob);this.Buk(Ob,this.jOg);return Ob},()=>{la.ULS.sendTraceTag(561551385,Qb.Rn,15,"Request succeeded with null response data");return""}):la.ULS.sendTraceTag(561002076,Qb.Rn,15,"Browser does not support Fetch.")}catch(Ob){la.ULS.sendTraceTag(561551386,
Qb.Rn,15,String.format("Exception when attempting to get last revision save id : {0}",Ob))}}else la.ULS.sendTraceTag(540079457,Qb.Rn,15,"Target node is null, not sending last saved revision request.")}Buk(Q,ya){let gb=Gf.a.nil,Ob=!1,mc=-1;ya===Rk.a.xD&&((Q=this.isa(Q))?(gb=Wi.b(Q.LastSavedRevisionId),Q.StatusCode||(Ob=!0,mc=Q.StatusCode)):la.ULS.sendTraceTag(561002077,Qb.Rn,50,"Response is null when attempting to get last revision save id"));this.sa.raiseEvent(Qb.Q$e,new jl(gb,Ob,ya,mc))}static Wqi(Q,
ya){for(let gb in ya)Q[gb]=ya[gb]}vfm(){return vf.SessionStatusManager.instance.io}ovn(Q,ya){if(this.p0g)if(Ha.Health.instance.recordKpiUsage(Qb.U7f,0,Qb.p1b,null),Q===ya)Ha.Health.instance.recordKpiSuccess(Qb.U7f,null);else{const gb=new Map;gb.set("DocxSaveMonitor",Q.toString());gb.set("RSNManager",ya.toString());gb.set("TimeSinceLastRSNUpdate",(+new Date-+this.vv.cki).toString());Ha.Health.instance.recordKpiFailure(Qb.U7f,"Inconsistency",!1,!1,Object.assign(new pe.a,{extendedProperties:gb}))}}}
Qb.CSi=0;Qb.serviceUrl=Ae.App.webServiceBase+"OneNote.ashx?perfTag=LastSavedRevisionRequest";Qb.fpm="kickout";Qb.KFi="PS";Qb.Q$e="FLSR";Qb.Rn=343;Qb.CIm=5;Qb.V8n=5E4;Qb.U7f="UpToDate";Qb.p1b="wwrelfc";Object(e.a)(Qb,"DocxSaveMonitor",null,[1722,145]);class qc{xbb(Q,ya){return window.setInterval(Q,ya)}We(Q){window.clearInterval(Q)}}qc.instance=new qc;Object(e.a)(qc,"DocxSaveMonitorTaskManager",null,[1721]);class Mc{constructor(Q){this.bN=0;this.Mqa=Q}start(Q){this.Mqa&&(this.bN=Q,this.Mqa.reset())}log(){if(this.Mqa){var Q=
{};Q.RequstId=this.bN;Q.InvokeCount=this.Mqa.XMc;Q.InvokeFailedCount=this.Mqa.YMc;Q.NoOpenConnectionCount=this.Mqa.HSc;Q.SynchronousNotificationCount=this.Mqa.I1c;Q.ResponseNotAvailable=this.Mqa.OYc;la.ULS.sendTraceTag(19161613,205,50,"ClientRequestManagerTelemetryStorage: {0}",Q)}}}Object(e.a)(Mc,"RequestLifeCycleTelemetryManager",null,[1720]);class Gd{constructor(){this.W=this.TFe=null;this.mNk=()=>{var Q=H.AFrameworkApplication.K;if(!Q.$("DocxSaveMonitorEnabled"))return null;var ya=Q.$("DocxSaveMonitorKickoutEnabled");
const gb=Q.rc("DocxSaveMonitorIntervalMs",6E4),Ob=Q.rc("DocxSaveMonitorFailureIntervalMs",5E3),mc=Q.rc("DocxSaveMonitorWarningTimeMs",12E4),dd=Q.rc("DocxSaveMonitorKickoutTimeMs",3E5),Md=Q.rc("DocxSaveMonitorQueueTimeoutMs",6E4),He=Q.rc("DocxSaveMonitorSentTimeoutMs",12E4),Ue=Q.rc("DocxSaveMonitorOldestAllowedLocalRevisionMs",3E5);var Sf=Q.$("DocxSaveMonitorTelemetryInfoEnabled");const of=Q.$("DocxSaveMonitorInfoRequestLoggingEnabled");var cj=H.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.DocxSaveMonitorBypassCRMIsEnabled",
!1),el=Q.$("DocxSaveMonitorRawWebRequestsEnabled")||cj;cj=Q.$("ComponentStateLoggingPackageIsEnabled");Q=Q.getBooleanFeatureGate("Microsoft.Office.WordOnline.DocxSaveMonitorKickoutIfSessionisLostButNotKickedOutIsEnabled",!1);var qk=H.AFrameworkApplication.Xe,jm=el?new Fm.a(H.AFrameworkApplication.userSessionId,qk.U3,qk.Jxh):null;jm=new Hk(qk,jm,el);Sf=Sf&&qk&&!el?new Mc(qk.zba):null;el=H.AFrameworkApplication.K?H.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.MultipleRetriesForDocxSaveMonitorIsEnabled",
!1):!1;qk=H.AFrameworkApplication.K?H.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.WordOnline.MultipleRetriesForDocxSaveMonitorMaxRetries",3):3;const Qk=oa.create(el,qk);Qk.lyc(1);Qk.lyc(2);cj=cj?this.W.Za("Common.IComponentStateLogManager"):null;ya=new Qb(gb,Ob,mc,ya,dd,Md,He,Ue,qc.instance,jm,qa.a.instance.ef("Box4.IKickoutExecutor"),Xo.a.instance,this.R3b,()=>!H.AFrameworkApplication.DVd||yd.a.instance.dNc,()=>Ae.App.lostSession,Object(a.a)(dm.a.instance,dm.a.instance.uza,"checkAndTriggerSessionHasExpired"),
()=>H.AFrameworkApplication.Mk,()=>new Date,()=>new Date,Sf,of,Qk,this.Ygl,cj,Q,qa.a.instance.Pa("Common.ISessionStatus")||vf.SessionStatusManager.instance,qa.a.instance.resolve("Box4.Revision.IRevisionSequenceNumberManager"),{isEnabled:el,maxRetries:qk});ya.start();la.ULS.sendTraceTag(5884131,Qb.Rn,50,"SaveMonitor initialized");return ya};this.R3b=()=>{const Q=Ae.App.xa.jb.Ic;return Q?Q.rd:null};this.Ygl=()=>{const Q={};H.AFrameworkApplication.uc&&(Q.TM=H.AFrameworkApplication.uc.pI());Si.WoncaApp.yE&&
(Q.RS=Si.WoncaApp.yE.pI());ui.App.E_&&(Q.CRS=ui.App.E_.pI());Ae.App.xa&&Ae.App.xa.jb&&Ae.App.xa.jb.Yc&&Ae.App.xa.jb.Yc.contentReplicator&&(Q.GSR=Ae.App.xa.jb.Yc.contentReplicator.pI());H.AFrameworkApplication.oma&&(Q.S=1);Ae.App.lostSession&&(Q.LS=1);Ae.App.ud&&Ae.App.ud.ZA.io&&(Q.KO=1);return Sys.Serialization.JavaScriptSerializer.serialize(Q)}}get name(){return"WordEditor.DocxSaveMonitor"}init(){if(Ae.App.As||Ae.App.Bm)this.TFe=this.W.resolve("WordEditor.DocxSaveMonitor.DocxSaveMonitor")}dispose(){this.TFe&&
this.TFe.stop("WordEditorDocxSaveMonitorPackage is being disposed")}yc(Q){this.W=Q;(Ae.App.As||Ae.App.Bm)&&Q.ha("WordEditor.DocxSaveMonitor.DocxSaveMonitor",this.mNk).as("Wonca.IDocxSaveMonitor").singleInstance()}static main(){ca.a.instance.Oc(new Gd)}}Object(e.a)(Gd,"WordEditorDocxSaveMonitorPackage",null,[1,2]);var de;(function(Q){Q[Q.version0=0]="version0";Q[Q.version1=1]="version1"})(de||(de={}));Object(e.b)("FirstRunExperienceVersion",de);class Id{get KQe(){return"Word"}get Ejh(){return"74eb3f02-206c-47c2-ad65-c4d21db60910"}get version(){return de.version0}get currentVersion(){return de.version1}get hbm(){return Id.isEnabled()&&
H.AFrameworkApplication.K.$("WordEditorFirstRunExperienceDataStoreIsEnabled")}get S7b(){return Id.isEnabled()&&H.AFrameworkApplication.K.$("WordEditorFirstRunExperienceUIV2IsEnabled")}get iii(){return H.AFrameworkApplication.K.$("WordEditorFirstRunExperienceTestIsEnabled")}get Abl(){return"Microsoft.Office.Web.SessionSettings.IWordEditorFirstRunExperienceUIV2Settings"}get yri(){return 24}get mTi(){return 4E3}get cZc(){return""}static isEnabled(){const Q=H.AFrameworkApplication.sessionStartInfoSettings?
H.AFrameworkApplication.sessionStartInfoSettings.AudienceGroup:"";return"Unknown"!==Q&&"Automation"!==Q}}Object(e.a)(Id,"FirstRunExperienceLauncherSettings",null,[1760]);class Xe{constructor(Q){this.LEg=Q}jXn(Q){this.LEg&&this.LEg.kXn(Q)}}Object(e.a)(Xe,"FirstRunExperienceManager",null,[1759]);class hf{constructor(){this.W=null}get name(){return"WordEditor.FirstRunExperience"}yc(Q){this.W=Q;this.W.ha("WordEditor.FirstRunExperience.IFirstRunExperienceManager",()=>new Xe(this.W.resolve("Common.App.FirstRunExperienceLauncher.IFirstRunExperienceLauncher"))).singleInstance()}init(){const Q=
this.W.resolve("WordEditor.FirstRunExperience.IFirstRunExperienceManager");Q&&Q.jXn(new Id)}dispose(){}}Object(e.a)(hf,"WordEditorFirstRunExperiencePackageManager",null,[1,2]);class Ef{constructor(Q,ya,gb){this.mIi=(Ob,mc,dd,Md,He)=>{if(1===dd)return 32;switch(Ob){case Rf.a.nIi:He[yl.a.On]=1===this.kHa.Gbb;break;case Rf.a.oIi:He[yl.a.On]=2===this.kHa.Gbb}return 32};this.coa=(Ob,mc,dd,Md,He)=>{if(1===dd)return 32;if(2===dd){mc=this.kHa.hh.isVisible;this.kHa.XA(!0,1===He);dd=0;switch(Ob){case Rf.a.u0f:He=
1;break;case Rf.a.v0f:He=2;break;case Rf.a.C8d:He=2;dd=1;break;case Rf.a.D8d:He=1;dd=2;break;case Rf.a.E8d:He=1;dd=3;break;case Rf.a.$ae:He=this.kHa.Gbb;this.HMg&&!He&&(He=1);break;default:dd=He=0}mc&&Ob===Rf.a.coa||this.kHa.jKn(He,dd);return 32}return 8};this.iLd=(Ob,mc,dd,Md,He)=>{this.toggleButton(He,!1);return this.vyk(dd)};this.$ae=(Ob,mc,dd,Md,He)=>this.kHa.hh.isVisible?this.iLd(Ob,mc,dd,Md,He):this.coa(Ob,mc,dd,Md,He);this.ga=Q;this.kHa=ya;this.HMg=gb}dispose(){this.kHa&&this.kHa.dispose()}Vb(){this.ga.pa(Rf.a.$ae,
Kh.a.view,this.$ae);this.ga.gb(Rf.a.coa,Kh.a.view,this.coa,4);this.ga.pa(Rf.a.iLd,Kh.a.view,this.iLd);this.ga.gb(Rf.a.C8d,Kh.a.view,this.coa,4);this.ga.pa(Rf.a.D8d,Kh.a.view,this.coa);this.ga.pa(Rf.a.E8d,Kh.a.view,this.coa);this.HMg&&(this.ga.gb(Rf.a.nIi,Kh.a.view,this.mIi,96),this.ga.pa(Rf.a.u0f,Kh.a.view,this.coa),this.ga.gb(Rf.a.oIi,Kh.a.view,this.mIi,96),this.ga.pa(Rf.a.v0f,Kh.a.view,this.coa))}vyk(Q){if(1===Q)return 32;this.kHa.XA(!1);return 32}toggleButton(Q,ya){Q&&(Q[yl.a.On]=ya)}}Object(e.a)(Ef,
"FormatPictureActor",null,[9]);class ng{constructor(Q){this.Rtb=!1;this.hh=Q}get Gbb(){return this.hh.xPk}jKn(Q,ya){switch(Q){case 0:case 1:this.hh.hYn(ya);break;case 2:this.hh.sYn(ya)}}XA(Q,ya=!1){this.Rtb||this.Enf();Q?this.hh.qO(ya):this.hh.Hla()}dispose(){this.hh.dispose()}Enf(){this.Rtb||(this.hh.initialize(),this.Rtb=!0)}}Object(e.a)(ng,"FormatPictureManager",null,[1724,9]);var Bh=d(374),fi=d(106),jj=d(336);class Qg{}Qg.wO=jj.a.PDd;Qg.vac=1;Qg.Lib=WordEditorIntl.WordEditorStrings.L_FormatPicture;
Qg.esa="FormatPictureTaskPaneData";Object(e.a)(Qg,"FormatPicturePaneConstants",null,[]);class sh{constructor(){this.type="FormatPictureTaskPaneProps";this.section=0;this.description=this.title=this.numberFormatInfo=null;this.rotationAngle=this.rightCrop=this.leftCrop=this.bottomCrop=this.topCrop=0;this.onRotationSpinButtonChange=this.onCropSpinButtonChange=this.onDescriptionChange=this.onTitleChange=null;this.disabled=!1}}Object(e.a)(sh,"FormatPictureTaskPaneProps",null,[]);class Sk{constructor(Q,
ya,gb,Ob){this.iGe=0;this.fmc=this.mja=null;this.Kkd=this.Bkd=this.kfd=this.u7c=this.kod=0;this.ru=this.EPb=!1;this.Yle=0;this.nXm=()=>{this.XYi()};this.yl=()=>{let mc=!1;mc=this.dcn()||mc;mc=this.J1a()||mc;mc=this.I1a()||mc;mc=this.ybc()||mc;(mc=this.$bn()||mc)&&this.Vm()};this.lP=Q;this.SKj=ya;this.Axe=gb;this.ig=Ob}initialize(){this.bZ();this.Rga()}get isVisible(){return this.ru}qO(Q){this.F0c(Q)}Hla(){this.aba();this.iYl()}hYn(Q){this.o0i(Q,1)}sYn(Q){this.o0i(Q,2)}o0i(Q,ya){this.Yle=ya;this.iGe=
Q}get xPk(){return this.Yle}dispose(){}bZ(){this.lP.iKa();this.iGe=this.Yle=0}get Ci(){return this.SKj.value}get zc(){return this.Axe.value}K_a(){return!!this.Ci.og&&this.Ci.og.name===Qg.wO}XYi(){this.Ci.Jg(Qg.wO)}Rga(){const Q=this.Ci.re(Qg.wO);Q.parent=$f.AFrame.Np;Q.eda(this.nXm)}aba(){this.K_a()&&this.Ci.Jg(this.Ci.HS)}F0c(Q){cd.UISurfaces.$t().then(ya=>{ya.showTaskPane(Qg.wO,this.wB(Q));this.isVisible&&Q&&this.Ci.Jg(Qg.wO);return null})}Vm(){cd.UISurfaces.$t().then(Q=>{Q.updateTaskPane(Qg.wO,
this.wB(!1));return null})}iYl(){cd.UISurfaces.$t().then(Q=>{Q.hideTaskPane(Qg.wO,2);return null})}wB(){const Q=new sh;this.hRn(Q);return Object.assign(new co.a,{title:Qg.Lib,hideHeader:!1,width:320,location:2,contentProps:Q,onOpen:ya=>{this.ru=!0;Ae.App.xa.pVa(this.yl);Ae.App.xa.updateCommandUI();this.XYi();this.ig.Eqd(Qg.wO,ya)},onClose:()=>{this.aba();this.ru=!1;Ae.App.xa.mcc(this.yl);Ae.App.xa.updateCommandUI()},isModernPane:!0,enableResize:!0,minResizeWidth:150,maxResizeWidth:920})}hRn(Q){const ya=
Jg.e().numberFormatInfo;Q.section=this.iGe;Q.numberFormatInfo="object"===typeof ya?ya:null;Q.title=this.mja;Q.description=this.fmc;Q.topCrop=this.kod;Q.bottomCrop=this.u7c;Q.leftCrop=this.kfd;Q.rightCrop=this.Bkd;Q.rotationAngle=this.Kkd;Q.onTitleChange=this.onTitleChange();Q.onDescriptionChange=this.onDescriptionChange();Q.onCropSpinButtonChange=this.onCropSpinButtonChange();Q.onRotationSpinButtonChange=this.onRotationSpinButtonChange();Q.disabled=this.EPb}onTitleChange(){return Q=>{if(Q!==this.mja){this.mja=
Q;var ya=new Bh.DictionaryPropertySet;ya.setValue(fi.a.Xeb,Q);this.zc.Xb(Xg.a.m_c,2,ya);this.Vm()}}}onDescriptionChange(){return Q=>{if(Q!==this.fmc){var ya=new Bh.DictionaryPropertySet;ya.setValue(fi.a.PW,Q);this.fmc=Q;this.zc.Xb(Xg.a.DJb,2,ya);this.Vm()}}}onCropSpinButtonChange(){return(Q,ya)=>{const gb=new Bh.DictionaryPropertySet;switch(ya){case 0:this.kod=Q;gb.setValue(fi.a.bfb,Q);this.zc.Xb(Rf.a.NLc,2,gb);break;case 1:this.u7c=Q;gb.setValue(fi.a.Zeb,Q);this.zc.Xb(Rf.a.GLc,2,gb);break;case 2:this.kfd=
Q;gb.setValue(fi.a.$eb,Q);this.zc.Xb(Rf.a.HLc,2,gb);break;case 3:this.Bkd=Q,gb.setValue(fi.a.afb,Q),this.zc.Xb(Rf.a.ILc,2,gb)}this.Vm()}}onRotationSpinButtonChange(){return Q=>{this.Kkd=Q;const ya=new Bh.DictionaryPropertySet;ya.setValue(fi.a.SLc,0);ya.setValue(fi.a.dK,Q);this.zc.Xb(Xg.a.imageRotate,2,ya);this.Vm()}}dcn(){const Q=2===this.zc.Xb(Xg.a.m_c,1,null),ya=Q!==this.EPb;this.EPb=Q;return ya}J1a(){var Q=new Bh.DictionaryPropertySet;this.zc.Xb(Xg.a.J1a,2,Q);Q=Q.ia(fi.a.Xeb,"");const ya=Q!==this.mja;
this.mja=Q;return ya}I1a(){var Q=new Bh.DictionaryPropertySet;this.zc.Xb(Xg.a.I1a,2,Q);Q=Q.ia(fi.a.PW,"");const ya=Q!==this.fmc;this.fmc=Q;return ya}ybc(){var Q=new Bh.DictionaryPropertySet;this.zc.Xb(Rf.a.eWc,2,Q);const ya=Q.ia(fi.a.bfb,0),gb=Q.ia(fi.a.Zeb,0),Ob=Q.ia(fi.a.$eb,0);Q=Q.ia(fi.a.afb,0);const mc=ya!==this.kod||gb!==this.u7c||Ob!==this.kfd||Q!==this.Bkd;this.kod=ya;this.u7c=gb;this.kfd=Ob;this.Bkd=Q;return mc}$bn(){var Q=new Bh.DictionaryPropertySet;this.zc.Xb(Xg.a.PHb,2,Q);Q=Q.ia(fi.a.dK,
0);const ya=Q!==this.Kkd;this.Kkd=Q;return ya}}Object(e.a)(Sk,"ReactFormatPicturePane",null,[1723,9]);class Vf{constructor(){this.Rad=this.W=null}get name(){return"WordEditor.FormatPicture"}yc(Q){this.W=Q;this.W.ha("WordEditor.FormatPicture.IFormatPictureManager",()=>new ng(this.W.resolve("WordEditor.FormatPicture.IFormatPicturePane"),ui.App.bmj)).singleInstance();this.W.ha("WordEditor.FormatPicture.IFormatPicturePane",()=>new Sk(qn.a.instance,new jb.a(()=>sd.FocusManager.instance()),new jb.a(()=>
H.AFrameworkApplication.ya),ql.a.instance)).singleInstance();this.W.ha("WordEditor.FormatPicture.FormatPictureActor",()=>new Ef(H.AFrameworkApplication.ya,this.W.resolve("WordEditor.FormatPicture.IFormatPictureManager"),ui.App.bmj)).singleInstance()}init(){if(ui.App.jee||ui.App.fag)this.Rad=this.W.resolve("WordEditor.FormatPicture.FormatPictureActor"),this.Rad.Vb(),Ae.App.xa.updateCommandUI()}dispose(){this.Rad&&this.Rad.dispose()}static main(){ca.a.instance.Oc(new Vf)}}Object(e.a)(Vf,"WordEditorFormatPicturePackage",
null,[1,2]);class Pk{constructor(){this.GQb=this.xuc=null;this.dkd=0}get name(){return"WordEditor.FrameTiming"}yc(){H.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.InteractivePerfFrameTimingMeterDisabled",!1)||(this.GQb=new EventTiming.FrameTimingMeter,this.dkd=H.AFrameworkApplication.K.rc("FrameTimingMeterReportingIntervalInSeconds",60),0>=this.dkd&&(this.dkd=60),this.xuc=Q=>{(Q=Q.rawEvent)&&la.ULS.sendTraceTag(24962208,306,50,Ka.c(Q.detail))},G.a.addHandler(window.self,
B.a.xQi,this.xuc))}init(){this.GQb&&this.GQb.start(this.dkd)}dispose(){this.GQb&&(this.GQb.stop(),this.GQb=null);this.xuc&&(G.a.removeHandler(window.self,B.a.xQi,this.xuc),this.xuc=null)}static main(){ca.a.instance.Oc(new Pk)}}Object(e.a)(Pk,"FrameTimingPackageManager",null,[1,2]);var oj=d(1457),vi=d(565);class kj extends Em.a{constructor(){super();this.Prompt=0;this.FileId=null}Wl(){return 100}static construct(Q,ya){const gb=new kj;gb.FileId=Q;gb.Prompt=ya;return gb}}Object(e.a)(kj,"GraphMergeConsentChangedRequest",
Em.a,[]);var Vl=d(590);class lh extends Vl.a{constructor(){super();this.Location=this.FileId=null}Wl(){return 34}static construct(Q,ya){const gb=new lh;gb.FileId=Q;gb.Location=ya;return gb}}Object(e.a)(lh,"PlayGraphMergeReplayRequest",Vl.a,[]);class Yg{constructor(Q,ya,gb,Ob,mc,dd=null,Md=null){this.Cl=!1;this.WM=null;this.m_g=this.lwe=!1;this.PYe=()=>{if(this.Lwa.RKd)this.lwe=!0;else if(this.lwe=!1,!this.qGn){this.m_g=!0;var He=this.gGa.cva;la.ULS.sendTraceTag(39084353,300,50,"GraphMerge consent given: {0}",
400===He);if(100===He||400===He)He=kj.construct(this.HR(),He),this.gy(He)}};this.$2h=(He,Ue)=>{Ue&&Ue.Xzf&&Ue.Xzf.S_e&&!this.Lwa.mii&&(this.Lwa.Hfj(),this.Lwa.RKd=!0,this.gy(Ue.Xzf.S_e))};this.X2h=(He,Ue)=>{Ue&&Ue.O4c&&this.Lwa.Hfj()};this.Y2h=(He,Ue)=>{Ue&&(Ue.ShowMergePrompt&&this.gGa.cRi(this.PYe),H.AFrameworkApplication.jh&&(H.AFrameworkApplication.jh.SessionMergeInfo|=Ue.PartMergeInfo))};this.HR=Q;this.Kpd=gb;this.Lwa=Ob;this.gGa=mc;this.Kpd&&this.Kpd.G7j(this.$2h);this.B8=dd||Xo.a.instance;
if(!Md){const He=new vi.a;Md=Ue=>He.bla(0,Ue)}this.$wj=Md}get wnm(){return this.lwe}get qGn(){return this.m_g}gy(Q){const ya=new Tl.a;ya.Yr=Q;ya.status=1;ya.iH="GraphMerge";const gb=this.$wj(()=>{this.NYc(ya,33===Q.Wl())});gb.JJ(ya);gb.qW()}NYc(Q,ya){this.Cl||(ya&&(this.Lwa.RKd=!1),2===Q.statusCode&&!U.a.oDb(Q.jk)&&1===Q.jk.length&&Q.jk[0]?(Q=Q.jk[0],Q.StatusCode?this.Lwa.NYf():ya&&this.gGa.cRi(this.PYe),this.B8.omb(Q),this.wnm&&this.PYe()):this.Lwa.NYf())}iib(Q){this.WM=Q;this.WM.eXb(this.X2h);this.WM.fXb(this.Y2h)}dispose(){this.Cl||
(this.Kpd&&this.Kpd.Mrn(this.$2h),this.WM&&(this.WM.vIb(this.X2h),this.WM.bYc(this.Y2h)),this.Cl=!0)}}Object(e.a)(Yg,"GraphMergeBackupManager",null,[1756,9]);class Fi{constructor(Q,ya=null,gb=null,Ob=null){this.zie=0;this.bve=!1;this.xNg=new Date(0);this.RKd=!1;this.gGa=Q;this.uy=ya||(()=>new Date);gb||(gb=H.AFrameworkApplication.K?H.AFrameworkApplication.K.rc("WordEditorGraphMergeBackupDelayInMs",12E4):12E4);this.FMj=gb;Ob||(Ob=H.AFrameworkApplication.K?H.AFrameworkApplication.K.rc("WordEditorGraphMergeMaxBackups",
1):1);this.gQg=Ob}get dmm(){return+this.uy()-+this.xNg<this.FMj}get mii(){return 500===this.gGa.cva?!1:100===this.gGa.cva?!0:this.bve||this.RKd||this.dmm}Hfj(){this.xNg=this.uy();this.zie++;this.zie>=this.gQg&&this.NYf()}NYf(){this.bve||(this.bve=!0,la.ULS.sendTraceTag(39084356,300,50,"Permanently throttling merge reports after creating {0} out of a maximum of {1} reports.",this.zie,this.gQg))}}Object(e.a)(Fi,"GraphMergeBackupThrottler",null,[1755]);class Zj{constructor(Q,ya,gb=null){this.PGg=!1;
this.PU=Q;this.iDj=ya;null==gb&&(gb=!!H.AFrameworkApplication.K&&H.AFrameworkApplication.K.$("WordEditorGraphMergeBypassConsentPrompt"));this.ADe=gb?500:300}get cva(){return this.ADe}cRi(Q){if(!this.PGg&&300===this.cva){var ya=this.iDj.value;ya&&ya.isFeatureEnabled(50)&&(this.PGg=!0,this.PU.execute(gb=>{gb.uXn(()=>{this.bDk(Q)},()=>{this.consentDenied(Q)})}))}}consentDenied(Q){300===this.cva&&(la.ULS.sendTraceTag(42333270,300,50,"Consent denied for investigating merge failures."),this.ADe=100,Q());
this.DNi()}bDk(Q){300===this.cva&&(la.ULS.sendTraceTag(42333271,300,50,"Consent received for investigating merge failures."),this.ADe=400,Q());this.DNi()}DNi(){this.PU.execute(Q=>{Q.bYl()})}}Object(e.a)(Zj,"GraphMergeCollectionConsentManager",null,[1754]);class Um extends Sys.EventArgs{constructor(Q){super();this.Xzf=Q}}Object(e.a)(Um,"GraphMergeCompleteEventArgs",Sys.EventArgs,[]);var kb=d(835),nc=d(709),Qc=d(1002),rd=d(638),fe=d(1704),df=d(1702),wf=d(216),ea=d(150);class Qa{constructor(Q,ya,gb,
Ob,mc,dd){this.cOf=this.yg=null;this.uPc=this.J$f=!1;this.Nk=null;this.q0c=Q.runtime.q0c;this.Yo=Q;this.$d=ya;this.Ng=gb;this.Zm=Ob;this.MCk=mc;this.graphNodeComplexMerge=dd}}Object(e.a)(Qa,"GraphNodeComplexMergeState",null,[]);var qb=d(1522),bc=d(1507);class Xb{constructor(Q,ya=null){this.Lg=Q;this.BSb=ya||this.KIc()}get whb(){return this.BSb}get $d(){return this.Lg}KIc(){return[Object(a.a)(this,this.JZn,"simpleMerge"),Object(a.a)(this,this.cCk,"complexMerge")]}lRn(Q,ya,gb,Ob,mc,dd){ya=new Qa(Q,
gb,new jb.a(()=>new qb.a(Ob?Ob.im:null,mc)),new jb.a(()=>new qb.a(Ob?Ob.im:null,dd)),new jb.a(()=>new qb.a(dd,mc)),ya.Qth(mc,()=>Q.runtime.Qb));ya.yg=Ob.OVb;ya.cOf=new wf.a;return ya}merge(Q,ya,gb,Ob,mc,dd){ya=this.lRn(Q,ya,gb,Ob,mc,dd);gb=!0;for(Ob=0;Ob<this.whb.length&&gb;Ob++)(gb=(0,this.whb[Ob])(ya))||Q.logger.sTd("GraphNodeMerge.GetMergeFunctions()",Ob);if(Q=ya.uPc&&ya.Nk?new bc.a(ya.Nk,!1):null)switch(Q.HPn(ya.yg),(Q?Q.im:mc).Qc){case 1074135145:ya.Yo.runtime.K2d.iEk.Z(Q.im.id,Q.im);break;case 1074135153:ya.Yo.runtime.K2d.ajk.Z(Q.im.id,
Q.im);break;case 1074135127:ya.Yo.runtime.K2d.YAk.Z(Q.im.id,Q.im);break;case 393230:ya.Yo.runtime.MUd.add(Q.im.id)}return{returnValue:ya.uPc,Nk:Q}}JZn(Q){if(Q.Yo.runtime.Qb&&Q.Yo.runtime.Qb.oBb(1000005)&&0<Q.yg.count)return!0;var ya=Q.graphNodeComplexMerge.T0d;return Q.Zm.value.BNc(ya)&&Q.MCk.value.BNc(ya)?Q.Ng.value.BNc(ya)?!0:(ya=Q.Zm.value.Df,Q.uPc=!0,Q.Nk=ya.HG(),!1):(Q.uPc=!0,!1)}cCk(Q){const ya=Q.Zm.value.Df;Q.q0c&&ea.a.instance.Wa(4018183,1,4,"ComplexMerge: Begin [Id: {0}] [ClassId: {1}]",
ya.id,ya.Qc);const gb=Q.graphNodeComplexMerge.V6f(Q);Q.uPc=gb;ea.a.instance.Wa(4018184,1,gb?5:4,"ComplexMerge: {0} for object: [Id: {1}] [ClassId: {2}] [MergedObject returned: {3}]",gb?"Succeeded":"Failed",ya.id,ya.Qc,!!Q.Nk);return gb}}Object(e.a)(Xb,"GraphNodeMerge",null,[1788]);class Cc extends Em.a{constructor(){super();this.YourRevisions=this.TheirRevisions=this.MergedRevision=this.BaseRevisions=this.FileId=null;this.IgnoreConflictsInLastServerRevision=!1;this.MergeHint=0;this.RequestId=this.ObjectSpaceId=
null;this.Prompt=this.Reason=this.Source=0}Wl(){return 33}static construct(Q,ya,gb,Ob,mc,dd,Md,He,Ue,Sf,of){const cj=new Cc;cj.FileId=Q;cj.BaseRevisions=ya;cj.TheirRevisions=gb;cj.YourRevisions=Ob;cj.IgnoreConflictsInLastServerRevision=mc;cj.MergeHint=dd;cj.ObjectSpaceId=Md?Wi.a(Md):null;cj.RequestId=He?Wi.a(He):null;cj.Source=Ue;cj.Reason=Sf;cj.Prompt=of;return cj}}Object(e.a)(Cc,"CreateGraphMergeReplayRequest",Em.a,[]);var kd=d(798),Vd=d(250),be=d(17),je=d(1810),Be=d(1848);class Lf{constructor(Q,
ya=null,gb=null){this.SYk=(Ob,mc)=>{let dd=Ob;var Md=mc,He=this.y8a.get(Ob);if(!He)return{XDa:dd,LIb:Md};Md=new wf.a;Md.add(He);var Ue=this.vrb.get(Ob)||this.GE.J(Ob);He=new wf.a;He.add(Ue);Ue=new wf.a;Ue.add(this.GE.J(Ob));la.ULS.sendTraceTag(17409890,318,50,"Performing CpMerge: [Source: {0}] [MergeHint: {1}] [LocalRevisionObjects: {2}] [ServerRevisionObjects: {3}]",this.yG.Kjf,this.yG.P2,this.eUh(He),this.eUh(Md));var Sf=this.tUh(this.yG.P2);this.Wal(Sf,Ob,Md);He=new je.a(Sf,Ue,1===Sf.input.P2?
He:Md,1===Sf.input.P2?Md:He,this.tUh(1),He,Md);Md=new wf.a;for(Ue=0;Ue<mc.length;Ue++){this.yG.bG("GraphMergeSelectionRecordUpdater.DoParagraphMergeForModifiedObject");const of=({i2a:dd,Hna:Sf}=He.A3c(Ob,mc.J(Ue))).returnValue;Md.add(Sf);of?la.ULS.sendTraceTag(17409891,318,50,"UpdateSelectionRecordsForParagraph: Updating the selection record for [Paragraph: {0}] [Cp: {1}] to [Result Paragraph: {2}] [Result Cp: {3}] ",Ob,mc.J(Ue),dd,Sf):la.ULS.sendTraceTag(4339677,318,15,"UpdateSelectionRecordsForParagraph: UpdateCpAccordingToIncomingChange was unable to update the cp for [Paragraph: {0}]",
Ob)}return{XDa:dd,LIb:Md}};this.yG=Q;this.GE=Q.lk;this.y8a=Q.b8n;this.vrb=Q.tvo;this.CLj=Q.rvm;this.Lg=ya||new Qc.a;this.dQj=gb||this.SYk}oEc(Q){const ya=new wf.a;for(let gb=0;gb<Q.length;gb++){const Ob=this.JYk(Q.J(gb));ya.add(Ob)}return ya}nEc(Q,ya,gb){const Ob=Q.mu===Q.Iz&&Q.startCp===Q.endCp;ya&&({XDa:Q.mu,Hna:Q.startCp}=this.GQa(Q.mu,Q.startCp,Q.mu),Ob&&(Q.Iz=Q.mu,Q.endCp=Q.startCp));gb&&!Ob&&({XDa:Q.Iz,Hna:Q.endCp}=this.GQa(Q.Iz,Q.endCp,Q.Iz));return Q}JYk(Q){if(Q.mu===Q.Iz){var ya=new wf.a;
ya.add(Q.startCp);ya.add(Q.endCp);({XDa:Q,LIb:ya}=this.$8f(Q.mu,ya));return new kd.a(Q,ya.J(0),Q,ya.J(1))}ya=new wf.a;var gb=new wf.a;let Ob;ya.add(Q.startCp);({XDa:ya,LIb:Ob}=this.$8f(Q.mu,ya));gb.add(Q.endCp);({XDa:Q,LIb:gb}=this.$8f(Q.Iz,gb));return new kd.a(ya,Ob.J(0),Q,gb.J(0))}$8f(Q,ya){let gb=Q,Ob=ya;if(!this.GE.J(Q))return la.ULS.sendTraceTag(4339675,318,50,"UpdateSelectionRecordsForParagraph: Not updating the selection record for [Paragraph: {0}] as it is new in this revision",Q),{XDa:gb,
LIb:Ob};if(this.y8a.get(Q))({XDa:gb,LIb:Ob}=this.dQj(Q,ya,gb,Ob));else if(this.yG.Qmf&&!this.yG.Qmf.J(this.yG.Qmf.length-1).C2(Q)){Ob=new wf.a;for(let mc=0;mc<ya.length;mc++){let dd;({XDa:gb,Hna:dd}=this.GQa(Q,ya.J(mc),gb));Ob.add(dd)}}return{XDa:gb,LIb:Ob}}eUh(Q){let ya="";Q.forEach(gb=>{ya+=gb.r2c();ya+=" ";return!0});return ya}tUh(Q){const ya=qa.a.instance.Pa("Box4.IFeatureHelper"),gb=new Be.a;gb.input.source=this.yG.Kjf;gb.input.P2=this.yG.P2;gb.input.SFc=()=>ya;gb.runtime.lk=this.GE;gb.runtime.Dza=
this.yG.ABk;1===Q?(gb.runtime.Yt=this.vrb,gb.runtime.lq=this.y8a,gb.runtime.fCd=this.yG.Sji,gb.runtime.nce=this.yG.iki):2===Q&&(gb.runtime.Yt=this.y8a,gb.runtime.lq=this.vrb,gb.runtime.fCd=this.yG.iki,gb.runtime.nce=this.yG.Sji);gb.runtime.Qb=ya;return gb}Wal(Q,ya,gb){if(Q.runtime.Yt.xb(Vd.a.CK)){var Ob=Q.runtime.Yt.J(Vd.a.CK);Ob=this.Lg.getPropertyObjectIds(Ob,lk.a.R_);if(1===Ob.length&&(Ob=Ob.J(0),Q.runtime.Yt.xb(Ob)&&(Ob=Q.runtime.Yt.J(Ob),3===this.Lg.getPropertyInt32(Ob,lk.a.kmb)))){const mc=
this.Lg.getPropertyString(Ob,lk.a.tha),dd=this.Lg.getPropertyString(Ob,lk.a.dMb);ya.toString()===mc&&mc===dd&&(ya=this.Lg.getPropertyObjectId(Ob,lk.a.C3c),Q.runtime.Yt.xb(ya)&&gb.add(Q.runtime.Yt.J(ya)))}}}XCl(Q,ya){let gb=0;for(let Ob=0;Ob<Q.length;Ob++)if(ya.equals(Q.J(Ob)))return gb=Ob,{returnValue:!0,idx:gb};return{returnValue:!1,idx:gb}}GQa(Q,ya){const gb=this.CLj&&!!this.vrb.J(Q)&&!this.GE.J(Q);let Ob=Q,mc=ya,dd=!1,Md=!1;(gb?this.vrb:this.y8a).forEach((He,Ue)=>{this.yG.bG("GraphMergeSelectionRecordUpdater.UpdateSelectionRecordForDeletedParagraph");
if(this.ssf(Ue.Qc)&&this.GE.J(He)){Ue=null;if(gb){Ue=this.hJc(of=>this.vrb.J(of)||this.GE.J(of),He);var Sf=this.zPd(Ue,Q)}else Sf=this.hJc(of=>this.GE.J(of),He),Sf=this.zPd(Sf,Q);if(Sf&&(Md=!0,Ue||(Ue=this.hJc(of=>this.vrb.J(of)||this.GE.J(of),He)),He=this.hJc(of=>this.y8a.J(of)||this.GE.J(of),He),Sf=0,({idx:Sf}=this.XCl(Ue,Q)).returnValue)){for(let of=Sf+1;of<Ue.length;of++)if(this.zPd(He,Ue.J(of)))return mc=0,Ob=Ue.J(of),dd=!0,!1;for(--Sf;0<=Sf;Sf--)if(this.zPd(He,Ue.J(Sf)))return mc=Number.MAX_VALUE,
Ob=Ue.J(Sf),dd=!0,!1}}return!0});dd||(la.ULS.sendTraceTag(4339678,318,15,"UpdateSelectionRecordForDeletedParagraph: Was unable to reposition the selection record [ObjectID : {0}] [Cp: {1}] [IsNewParaInRejectedLocalChange: {2}] [FoundDeletedNode: {3}]",Q,ya,gb,Md),5===this.yG.Kjf&&(la.ULS.sendTraceTag(17340240,318,50,"UpdateSelectionRecordForDeletedParagraph: Unable to position IP, Trying to update to first para in server revision for Undo",Ob),({uIh:ya}=this.vsl()).returnValue?(Ob=ya,mc=0,la.ULS.sendTraceTag(17340241,
318,15,"UpdateSelectionRecordForDeletedParagraph: Did not find any paragraphs that were common on client and server. Repositioning to the start of the first [Paragraph:{0}] in the incoming revision",Ob)):la.ULS.sendTraceTag(17340242,318,15,"UpdateSelectionRecordForDeletedParagraph: Unable to get the first para in an incoming change",Ob)));return{XDa:Ob,Hna:mc}}vsl(){let Q=Gf.a.nil,ya=new wf.a;this.y8a.forEach((gb,Ob)=>{this.yG.bG("GraphMergeSelectionRecordUpdater.UpdateSelectionRecordForDeletedParagraph");
return this.ssf(Ob.Qc)?(ya=this.hJc(mc=>this.y8a.J(mc)||this.GE.J(mc),gb),!1):!0});return 0<ya.length?(Q=ya.J(0),{returnValue:!0,uIh:Q}):{returnValue:!1,uIh:Q}}ssf(Q){return 393241===Q||393250===Q||393251===Q||393252===Q}hJc(Q,ya){var gb=Q(ya);ya=new wf.a;if(!this.ssf(gb.Qc))return ya;gb=this.Lg.getPropertyObjectIds(gb,be.a.qf);for(let Ob=0;Ob<gb.length;Ob++){const mc=new wf.a;this.Bgf(Q,gb.J(Ob),mc);ya.EA(ya.length,mc)}return ya}Bgf(Q,ya,gb){var Ob=Q(ya);if(Ob)if(393230===Ob.Qc)gb.add(ya);else if(393229===
Ob.Qc)ya=this.Lg.getPropertyObjectIds(Ob,be.a.oL).lg(0),this.Bgf(Q,ya,gb);else if(393250===Ob.Qc||393251===Ob.Qc||393252===Ob.Qc)for(ya=this.Lg.getPropertyObjectIds(Ob,be.a.qf),Ob=0;Ob<ya.length;Ob++)this.Bgf(Q,ya.J(Ob),gb)}zPd(Q,ya){for(let gb=0;gb<Q.length;gb++)if(ya.equals(Q.J(gb)))return!0;return!1}}Object(e.a)(Lf,"GraphMergeSelectionRecordUpdater",null,[]);class ph extends fe.a{constructor(Q=null,ya=null,gb=null,Ob=null,mc=null,dd=null,Md=null,He=null,Ue=-1,Sf=null,of=null,cj=null){super();this.nvh=
el=>{const qk=el.z1,jm=Ae.App.xa.jb.Yc;return new kb.a(el,qk,jm.zd,jm.fileId,jm.pIb,jm.contextId,qk?qk.id:Gf.a.nil,this.OSi,!1,!0)};this.HR=Q||(()=>H.AFrameworkApplication.rootQuerySignature);ya||(ya=el=>new nc.a(el));this.NYg=ya;this.Lg=gb||new Qc.a;this.Pxg=Md||new df.ChildNodeListMerge(this.$d);this.cUb=He;this.OSi||(this.cUb=(el,qk,jm)=>new rd.a(el,qk,jm));this.BSb=Ob||this.KIc();this.j7a=mc||new Yh.a;this.yGg=dd||new Xb(this.$d);this.lQg=void 0===Ue||null===Ue||-1===Ue?ui.App.cmj:Ue;this.Lwa=
Sf;this.gGa=of;this.lJd=this.aVk(cj);this.aEg=()=>qa.a.instance.Pa("Box4.IFeatureHelper")}aVk(Q){Q||(Q=H.AFrameworkApplication.K?H.AFrameworkApplication.K.rc("WordEditorGraphMergeBackupCasesBrowser",0):0);return Q}TAa(){return(new Date).getTime()}I8i(Q,...ya){return String.format.apply(null,[Q].concat(ya))}v8n(Q){throw pm.a.invalidOperation(Q);}zFd(Q){return String.format("Name: {0}, Message: {1}, Stack: {2}",Q.name,Q.message,Q.stack)}o7m(Q){if(this.Lwa&&this.Lwa.mii||!this.x4n(Q))return null;this.Pym(Q);
let ya;({rhk:Ob,a8n:mc,svo:ya}=this.tNk(Q,this.nvh));const gb=fe.a.Atl(Q);var Ob=Cc.construct(this.HR(),Ob.$va(),mc.$va(),ya.$va(),Q.input.X4b,Q.input.P2,Q.input.Zl,Q.input.uFb,Q.input.source,gb,this.gGa.cva);var mc=Q.output.ZL;3===gb&&0<mc.length&&(Ob.MergedRevision=this.nvh(Q.output.ZL.last()));return Ob}oEc(Q,ya){return(new Lf(Q)).oEc(ya)}nEc(Q,ya,gb,Ob){return(new Lf(Q)).nEc(ya,gb,Ob)}}Object(e.a)(ph,"GraphMerger",fe.a,[]);class ji extends ph{constructor(Q,ya=null,gb=null){super(Q,void 0,void 0,
void 0,void 0,void 0,void 0,void 0,void 0,ya,gb);this.sa=new k.a}get cva(){return this.gGa?this.gGa.cva:0}get delayedMergeOperation(){return null}set delayedMergeOperation(Q){}G7j(Q){this.sa.addHandler(ji.Ijf,Q)}Mrn(Q){this.sa.removeHandler(ji.Ijf,Q)}A_f(){return!1}A9b(Q,ya,gb,Ob,mc,dd,Md){(Q=super.A9b(Q,ya,gb,Ob,mc,dd,Md))&&this.sa.raiseEvent(ji.Ijf,new Um(Q));return Q}}ji.Ijf="GMC";Object(e.a)(ji,"WordEditorGraphMerger",ph,[1753,1426,1427]);class tj{constructor(){this.W=null}get name(){return"WordEditor.GraphMerge"}yc(Q){this.W=
Q;this.W.ha("WordEditor.GraphMerge.GraphMergeCollectionConsentManager",()=>new Zj(this.W.Za("WordEditor.IBusinessBarController"),new jb.a(()=>Q.Pa("Box4.IFeatureHelper")))).as("Box4.IGraphMergeCollectionConsentManager").singleInstance();this.W.ha("WordEditor.GraphMerge.GraphMergeBackupThrottler",()=>new Fi(this.W.resolve("Box4.IGraphMergeCollectionConsentManager"))).as("WordEditor.GraphMerge.IGraphMergeBackupThrottler").singleInstance();this.W.ha("WordEditor.GraphMerge.WordEditorGraphMerger",()=>
new ji(()=>H.AFrameworkApplication.rootQuerySignature,this.W.resolve("WordEditor.GraphMerge.IGraphMergeBackupThrottler"),this.W.resolve("Box4.IGraphMergeCollectionConsentManager"))).as("WordEditor.GraphMerge.IWordEditorGraphMerger").singleInstance();this.W.ha("WordEditor.GraphMerge.GraphMergeBackupManager",()=>new Yg(()=>H.AFrameworkApplication.rootQuerySignature,H.AFrameworkApplication.ya,this.W.resolve("WordEditor.GraphMerge.IWordEditorGraphMerger"),this.W.resolve("WordEditor.GraphMerge.IGraphMergeBackupThrottler"),
this.W.resolve("Box4.IGraphMergeCollectionConsentManager"))).as("Box4.IGraphMergeBackupManager").singleInstance()}init(){Ae.App.YQ||(Ae.App.YQ=oj.a.Nda());const Q=this.W.resolve("WordEditor.GraphMerge.IWordEditorGraphMerger");Ae.App.YQ.kik(Q);this.W.resolve("Box4.IGraphMergeBackupManager")}dispose(){let Q=this.W.Pa("Box4.IGraphMergeBackupManager");Q&&Q.dispose()}}Object(e.a)(tj,"GraphMergePackage",null,[1,2]);var hj=d(164);class Cj{constructor(Q){this.NSb=0;this.hh=Q}axh(Q){this.NSb=Math.max(0,--this.NSb);
this.EPi(Q);0<this.NSb&&window.setTimeout(()=>{this.axh(Q)},1E3)}EPi(Q){Q.style.backgroundColor="rgba(255,0,0,"+Math.min(1,this.NSb/20)+")"}itn(Q){this.hh&&this.hh.Y1m&&(this.NSb++,this.EPi(Q),this.hh.Oui=Ci.a.abf(Q,!1),1===this.NSb&&window.setTimeout(()=>{this.axh(Q)},1E3))}}Object(e.a)(Cj,"ParagraphRenderVisualizationManager",null,[1752]);class em{constructor(Q,ya,gb,Ob,mc){this.quc=this.V8c=this.Wwc=this.hh=null;this.Jle=new ia.a;this.suc=null;this.qSg=0;this.YAi=(dd,Md)=>{this.Wwc&&(this.Wwc.innerText=
Md.nLm+" CPM")};this.iGb=(dd,Md)=>{this.V8c&&(this.V8c.innerText=Md.BSc.CP+"%",this.Jle.add(Md.BSc.CP))};this.showTaskPane=()=>{if(!Ae.App.xa.Blb)return 16;this.hh||this.Wxd();this.lP.showTaskPane(this.hh);this.hh.element.style.overflow="scroll";return 32};this.LXk=()=>{const dd=ra.a.Cm("","LogFile","","InteractivePerf.DisplayCpuPercentLogs").document;dd.writeln("<HEAD>");dd.writeln('<STYLE type="text/css">');dd.writeln("* { padding: 0px; margin: 0px; font-family: monospace; }");dd.writeln("</STYLE>");
dd.writeln("</HEAD>");dd.writeln("<BODY style='BACKGROUND-COLOR: #f3f8fd;'>");const Md=document.createElement("div");var He=document.createElement("div");He.innerText=String.format("{0}, {1}","Frame","CpuPercent");Md.appendChild(He);for(He=0;He<this.Jle.count;He++){const Ue=this.hlk(He,this.Jle.J(He));Ue&&Md.appendChild(Ue)}dd.writeln(Md.innerHTML);dd.writeln("</BODY>");dd.close();return!0};this.ga=Q;this.lP=ya;this.ig=gb;this.Yqa=Ob;this.Hzg=mc}get Y1m(){return this.quc?this.quc.checked:!1}get Oui(){return this.qSg}set Oui(Q){this.suc&&
(this.suc.innerText=String.format("Total number of child elements in last rendered paragraph: {0}",Q));this.qSg=Q}Vb(){this.ga.pa(Rf.a.Ush,Kh.a.application,this.showTaskPane)}dispose(){null!==this.hh&&(this.lP.myb(em.ly,this.hh),this.hh=null);this.Yqa.execute(Q=>{this.oFh(Q,ya=>{ya.csn(this.YAi)})});this.Hzg.execute(Q=>{this.nFh(Q,ya=>{ya.KSf(this.iGb)})})}Wxd(){const Q=new qd.CuiHelper(hj.a.yab,Box4Intl.Box4Strings);this.hh=this.lP.Z0e(em.ly,0,em.width,"InteractivePerfTaskPaneData",Q);this.BHk();
this.yHk();this.AHk()}vef(Q){Q=document.getElementById(Q);return Ci.a.Ozb(Ci.a.Ozb(Q,"cui-groupContainer"),"cui-groupBody")}nFh(Q,ya){const gb=Q.fr.task;gb.continueWith(()=>{ya(gb.result)})}oFh(Q,ya){const gb=Q.fr.task;gb.continueWith(()=>{ya(gb.result)})}BHk(){const Q=this.vef("TypingSpeedMeterGroup");Q.style.margin="10px";Q.style.fontSize="15px";const ya=document.createElement("div");ya.innerText="Typing Speed";this.Wwc=document.createElement("div");this.Wwc.innerText="0 CPM";this.Yqa.execute(gb=>
{this.oFh(gb,Ob=>{Ob.w8j(this.YAi)})});Q.appendChild(ya);Q.appendChild(this.Wwc)}yHk(){const Q=this.vef("CpuMeterGroup");Q.style.margin="10px";Q.style.fontSize="15px";const ya=document.createElement("div");ya.innerText="CPU Meter";this.V8c=document.createElement("div");this.Hzg.execute(mc=>{this.nFh(mc,dd=>{dd.hrd(this.iGb)})});const gb=document.createElement("div"),Ob=document.createElement("button");Ob.innerText="View Cpu Percent";this.ig.mb(B.a.click,Ob,this.LXk);gb.appendChild(Ob);Q.appendChild(ya);
Q.appendChild(this.V8c);Q.appendChild(gb)}AHk(){const Q=this.vef("RenderGroup"),ya=document.createElement("label");ya.innerText="Enable render visualizations";this.quc=document.createElement("input");this.quc.setAttribute("type","checkbox");Q.appendChild(this.quc);Q.appendChild(ya);this.suc=document.createElement("div");this.suc.style.margin="10px";Q.appendChild(this.suc);qa.a.instance.ha("Box4.IParagraphRenderVisualizationManager",()=>new Cj(this))}hlk(Q,ya){Q=Q.toString();ya=ya.toString();const gb=
document.createElement("div");gb.innerText=String.format("{0}, {1}",Q,ya);return gb}}em.ly="InteractivePerfTaskPane";em.width=400;Object(e.a)(em,"InteractivePerfTaskPane",null,[]);class Bm{constructor(){this.hh=null}get name(){return"WordEditor.InteractivePerfTaskPane"}yc(Q){Q.ha("WordEditor.InteractivePerfTaskPane.InteractivePerfTaskPane",()=>new em(H.AFrameworkApplication.ya,qn.a.instance,H.AFrameworkApplication.ua.ez,Q.Za("Common.ITypingSpeedMeterProvider"),Q.Za("Common.ICpuMeterProvider"))).singleInstance()}init(){if(this.hh=
qa.a.instance.Pa("WordEditor.InteractivePerfTaskPane.InteractivePerfTaskPane"))this.hh.Vb(),"1"===Zb.a.rT(document.URL,"wdShowIPerfTaskPane")&&H.AFrameworkApplication.ya.processAction(Rf.a.Ush,2)}dispose(){this.hh&&(this.hh.dispose(),this.hh=null)}static main(){ca.a.instance.Oc(new Bm)}}Object(e.a)(Bm,"InteractivePerfTaskPanePackageManager",null,[1,2]);var dl=d(302);class fo{constructor(Q){this.Ike="FontPicker";this.Cue=null;this.o5a=Q;this.$$c=this.o5a.lva(dl.a.CEb,Object(a.a)(this,this.azb,"featureStateChangeCallback"));
this.o5a.isFeatureEnabled(dl.a.CEb,!1).then(ya=>{this.Cue=ya})}get isLicensed(){return this.Cue}azb(Q){this.Cue=Q.isEnabled;Q=appChrome.actions.updateFontPickerLicenseState(this.Ike,Q.isEnabled);appChrome.api.dispatch(Q)}dispose(){this.o5a.gcc(dl.a.CEb,this.$$c)}}Object(e.a)(fo,"ModernFontPickerFeatureHelper",null,[1064,9]);var bj=d(507),Pm=d(654),Bl=d(1620);class Tk{constructor(){this.type="FontInfoTaskPaneProps";this.onUpsellButtonClicked=null;this.isLicensed=!1;this.paneId=this.helpArticleUrl=
this.trigger=this.fontName=null}}Object(e.a)(Tk,"FontInfoTaskPaneProps",null,[]);class Vm{constructor(Q,ya,gb,Ob=null){this.$Ke=this.cV=this.$$c=null;this._state=this.ZRb=0;this.Axe=Q;this.o5a=ya;this.Ywj=gb;this.Wb=Ob}get zc(){return this.Axe.value}initialize(){this.zc.pa(Ra.a.STf,uc.a.frame,Object(a.a)(this,this.STf,"requestFontInfo"));this.$$c=this.o5a.lva(dl.a.CEb,Object(a.a)(this,this.azb,"featureStateChangeCallback"));this.Rga()}qO(Q=!1){const ya=cd.UISurfaces.$t(),gb=this.o5a.isFeatureEnabled(dl.a.CEb,
!1),Ob=[];Ob.push(ya);Ob.push(gb);Promise.all(Ob).then(mc=>{mc[0].showTaskPane(Bl.a.vzb,this.wB(mc[1]));Q&&this.AK()})}Kko(Q){cd.UISurfaces.$t().then(ya=>{ya.updateTaskPane(Bl.a.vzb,this.wB(Q));return null})}azb(Q){this.Kko(Q.isEnabled)}STf(Q,ya,gb,Ob,mc){this.cV=mc.CommandValueId;this.$Ke=mc.Trigger;this.ZRb=mc.InputMethod;this.qO(2===this._state&&1===this.ZRb);return 32}wB(Q){const ya=new Tk;ya.onUpsellButtonClicked=Object(a.a)(this,this.onUpsellButtonClicked,"onUpsellButtonClicked");ya.fontName=
this.cV;ya.isLicensed=Q;ya.trigger=this.$Ke;ya.helpArticleUrl=this.oDk();ya.paneId=Bl.a.vzb;Q=this.$1l();Q.contentProps=ya;return Q}$1l(){return Object.assign(new co.a,{title:Bl.a.Lib,hideHeader:!1,width:320,location:2,isModernPane:!0,enableResize:!0,minResizeWidth:320,maxResizeWidth:920,onOpen:Object(a.a)(this,this.onOpen,"onOpen"),onClose:Object(a.a)(this,this.onClose,"onClose"),onShow:Object(a.a)(this,this.onShow,"onShow"),onHide:Object(a.a)(this,this.onHide,"onHide")})}Rga(){if(this.Wb){var Q=
this.Wb.re(Bl.a.vzb);Q.parent=$f.AFrame.Np;Q.UL=!0}}onOpen(){this._state=2;this.AK()}onShow(Q){0!==this._state&&(this._state=2,1===Q&&(this.ZRb=Q),this.AK())}onClose(){this.ZRb=this._state=0;this.blur()}onHide(){this._state=1;this.ZRb=0}AK(){this.Wb&&1===this.ZRb&&this.Wb.Jg(Bl.a.vzb)}blur(){this.Wb&&this.Wb.og&&this.Wb.og.name===Bl.a.vzb&&this.Wb.Jg(this.Wb.HS)}onUpsellButtonClicked(){this.o5a.launchUpsellExperience(Bl.a.experienceId)}dispose(){this.o5a.gcc(dl.a.CEb,this.$$c)}oDk(){return String.format("{0}&EntryPoint=True&IsFontPane=True&HelpId={1}&ShowNav=False&NS={2}&uilcid={3}",
this.Ywj,this.sul(),"WDWAENDUSER",H.AFrameworkApplication.lcid)}sul(){switch(this.$Ke){case "missing":return"hlpFontInfoMissingFont";case "embedded":return"hlpFontInfoEmbeddedFont";case "compatible":return"hlpFontInfoCompatibilityFont";case "theme":return"hlpFontInfoThemeFont"}return Vm.Kkk(this.cV)}static Kkk(Q){let ya="hlpFontInfo";for(let gb=0;gb<Q.length;++gb){const Ob=Tb.a.charAt(Q,gb);if(255<Q.charCodeAt(gb)||Tb.a.xNd(Ob))ya+=Ob}return ya}}Object(e.a)(Vm,"FontInfoPane",null,[936,9]);class vp extends Vm{constructor(Q,
ya,gb,Ob,mc){super(Q,ya,Ob.lb("FontInfoHelpBaseUrl"),mc);this.lP=gb}qO(Q){this.bZ();super.qO(Q)}azb(Q){super.azb(Q);Ae.App.xa.updateCommandUI()}bZ(){this.lP.iKa()}}Object(e.a)(vp,"WordEditorFontInfoPane",Vm,[]);class Hr{constructor(){this.xQb=this.cgd=this.Mnc=this.W=null}get name(){return"WordEditor.ModernFontPicker"}yc(Q){this.W=Q;Q.ha("Common.ModernFontPicker.IModernFontPickerFeatureHelper",()=>new fo(this.W.resolve("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"))).singleInstance();
Q.ha("Common.ModernFontPicker.IFontInfoPane",()=>new vp(new jb.a(()=>H.AFrameworkApplication.ya),this.W.resolve("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"),qn.a.instance,H.AFrameworkApplication.K,sd.FocusManager.instance())).singleInstance()}init(){this.cgd=this.W.resolve("Common.ModernFontPicker.IModernFontPickerFeatureHelper");this.Mnc=this.W.resolve("Common.ModernFontPicker.IFontInfoPane");this.Mnc.initialize();H.AFrameworkApplication.K.$("IsAnonymousUser")||((this.xQb=this.W.Pa(Pm.a))?
this.xQb.initialize():la.ULS.sendTraceTag(557061451,3021,15,"IFontPinningStore service is not available."));Ae.App.xa.updateCommandUI()}dispose(){this.Mnc&&(this.Mnc.dispose(),this.Mnc=null);this.cgd&&(this.cgd.dispose(),this.cgd=null);this.xQb&&(this.xQb.RAc(),this.xQb=null)}static main(){Object(bj.a)()&&ca.a.instance.Oc(new Hr)}}Object(e.a)(Hr,"ModernFontPickerPackage",null,[1,2]);var qm=d(128),jn=d(6),Kf=d(270),pq=d(40),pi=d(20),ok=d(1073);class xo{constructor(Q,ya,gb,Ob,mc,dd,Md,He,Ue,Sf,of,cj=
null){this.bY=gb;this.Xc=Q;this.Hc=ya;this.Kh=mc;this.RFa=dd;this.hY=Md;this.txg=He;this.sxg=Ue;this.ox=Sf;this.rAj=cj||xo.ow}get yh(){return this.ox?this.ox.yh:!1}G8h(Q){return this.QBa(Q,0)}Z4l(Q){return this.QBa(Q,1)}QBa(Q,ya){let gb=null;if(this.yh&&this.hY&&(this.sxg.instance&&this.sxg.instance.bFa(Q),ya?1===ya&&(gb=this.hY.hUh(Q.node)):gb=this.hY.Ecf(Q.node,Q.cpBegin,Q.Fb),gb&&!gb.ia(lk.a.u6,!1)))return la.ULS.shipAssertTag(24749379,368,!1,"Try to insert page break to inconvertible inline content control"),
2;const Ob=jn.GraphIterator.xW(this.Xc.Dk());Ob.set(Q.node);Ob.Bb(10);const mc=this.Hc.Rc(15);mc.Ou(Ob);ya?pq.OutlineElementNavigator.Zd(Ob):(this.splitParagraph(Ob,Q),this.bY.ehc(Q.node,cg.a.es));Q=nf.ParagraphReader.en(Ob.currentNode);this.j6l(Ob);this.yh&&gb&&this.txg&&(ya=new ia.a,ya.add(Ob.currentNode),this.txg.z7g(ya,gb.id));this.jLn(Q);mc.dispose();return 32}jLn(Q){Q=si.SelectionFactory.xe(Q,0);mf.a.instance.setSelection(Q)}j6l(Q){this.Kh.eD(Q,!0,!0,null,!1,!1);Q=pq.OutlineElementNavigator.De(Q);
this.$4l(Q)}splitParagraph(Q,ya){const gb=pq.OutlineElementNavigator.Zd(Q);if(ya.cpBegin||this.yh&&(!this.yh||-1!==ya.Fb)){pi.a.instance.J(4)&&Ae.App.ud.Mp&&ya.cpBegin!==nf.ParagraphReader.textLength(ya.node)&&Ae.App.ud.Lq.CG(ya.node);this.Kh.eD(Q,!1,!0,null,!1,!0);var Ob=jn.GraphIterator.xW(this.Xc.Dk());Ob.set(gb);this.Kh.mba(Ob,Q,ya,!0,!0,!0)}}$4l(Q){Q=this.rAj(Q);this.RFa.c9h(Q)}static hE(){return new xo(new yf.a,new Hf.a,qa.a.instance.resolve("Box4.IAutoCorrectScheduler"),ok.a.instance,qa.a.instance.resolve("Box4.IOutlineElementEditor"),
qa.a.instance.resolve("Box4.IBlobEditor"),qa.a.instance.Pa("Box4.IContentControlReader"),qa.a.instance.Pa("Box4.IContentControlEditor"),qa.a.instance.Za("Box4.IContentControlConverter"),qa.a.instance.Pa("Box4.ContentControlConfigSettings"),qa.a.instance.resolve("Box4.List.IListReader"))}static get instance(){return null!=xo.Emg?xo.Emg:xo.Emg=xo.hE()}static ow(Q){return Po.a.ow(Q)}}Object(e.a)(xo,"PageBreakInserter",null,[1767]);class Eh{constructor(Q,ya,gb,Ob,mc,dd,Md,He){this.m6l=(Ue,Sf,of,cj)=>
{var el=Sf.view,qk=el.Cb.Rg;if(!qk)return 2;if(!this.mWe(Sf))return 8;if(1===of)return 32;let jm=!0;of=8;const Qk=this.Gve(qk);qk=this.Hc.Rc(15);qk.Db(el.rd);qk.Al=Ue;Qk||(of=this.ga.Qf(Sf,Xg.a.Aka,2,!0,cj,null),Ue=32===of,la.ULS.shipAssertTag(4208012,314,Ue),jm=Ue);jm&&(el=el.Cb.Rg,Ue=this.Gve(el),la.ULS.shipAssertTag(4208013,314,Ue,"{0}",{["ContextId"]:Sf.contextId}),of=8,Ue&&(of=this.mte.G8h(el),la.ULS.shipAssertTag(4208014,314,32===of)));qk.dispose();32===of&&this.Hd.zs(10);return of};this.l6l=
(Ue,Sf,of)=>{if(!Sf||Sf.contextId!==Kh.a.Wc)return 8;if(1===of)return Sf.contextId===Kh.a.Wc?32:8;if(2===of){if(!this.mWe(Sf))return 8;Ue=this.mte.G8h(Sf);32===Ue&&this.Hd.zs(10);return Ue}return 32};this.k6l=(Ue,Sf,of)=>{if(!Sf||Sf.contextId!==Kh.a.table)return 8;if(1===of)return 32;if(2===of){if(!this.mWe(Sf))return 8;Ue=this.mte.Z4l(Sf);32===Ue&&this.Hd.zs(10);return Ue}return 32};this.ga=Q;this.mte=ya;this.Hc=gb;this.Hm=Ob;this.Gve=mc;this.Ok=dd;this.fJj=Md;this.Hd=He}Vb(){this.ga.pa(Rf.a.QBa,
Kh.a.view,this.m6l);this.ga.pa(Rf.a.QBa,Kh.a.Wc,this.l6l);this.ga.pa(Rf.a.QBa,Kh.a.table,this.k6l);this.ga.Vc(Rf.a.QBa,4)}k3(){const Q=sd.FocusManager.instance().re(qm.AppFrame.pF);$f.AFrame.ri(Q,Jf.KeyInputManager.lc(cg.a.es,Jf.KeyInputManager.Mh),Rf.a.QBa)}ofm(Q){return this.Yw(Q.iterator)}Sim(Q){Q=Q.J(0);const ya=bh.SelectionEditor.Pj(Q,!0,!1);if(this.Yw(ya.Qa.iterator))return!0;Q=bh.SelectionEditor.Pj(Q,!1,!1);return this.Yw(Q.Qa.iterator)}Yw(Q){return Q.Bb(14)}mWe(Q){let ya=null,gb=Q;if(gb.contextId===
Kh.a.view){ya=gb.view;if(!ya.features.z3f)return!1;gb=ya.Cb.Rg;if(!gb)return!1}else{const Ob=jn.GraphIterator.$a(gb.node);if(Ob.Bb(36)||Ob.Bb(38)||Ob.Bb(40)||Ob.Bb(14))return!1}return Kf.a.gfa(Q)?!1:gb.contextId===Kh.a.table?this.Ok.$em(gb.node):!this.Ok.Yem(gb)||this.Hm&&this.Hm.instance&&this.Hm.instance.HT(gb)?!1:((Q=this.Gve(gb))?this.ofm(gb):this.Sim(ya.Cb.hb))||Q&&this.fJj(gb,!0)?!1:!0}static hE(){return new Eh(H.AFrameworkApplication.ya,xo.instance,new Hf.a,qa.a.instance.Za("Box4.IExternalSelectionManager"),
bh.SelectionEditor.xf,Qf.a.instance,gn.HyperlinkReader.cma,qa.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance)}static get instance(){return null!=Eh.xlg?Eh.xlg:Eh.xlg=Eh.hE()}}Object(e.a)(Eh,"PageBreakActor",null,[1748]);class fr{constructor(){this.HBe=this.W=null}get name(){return"WordEditor.PageBreak"}yc(Q){this.W=Q}init(){this.W.resolve("Box4.IFeatureHelper").Yk.continueWith(()=>{this.Tm()})}Tm(){this.HBe=Eh.instance;this.HBe.Vb();this.HBe.k3();Ae.App.xa.updateCommandUI()}dispose(){}}
Object(e.a)(fr,"PackageManager",null,[1,2]);var Qo=d(1459),qq=d(1460),dh=d(233),Pj=d(166),Ii=d(260),Yo=d(293),wp=d(473);class Eq{constructor(Q,ya,gb,Ob,mc,dd,Md){this.osb=null;this.sa=new k.a;this.cme=1;this.Ued=-1;this.rTa=null;this.Vma=()=>{this.$Ue()};this.ib=ya;this.Hb=gb;this.$9c=Ob;this.MH=mc;this.aA=dd;this.c9=Md;this.enable()}get gDc(){return this.cme}a1i(Q){this.cme!==Q&&(this.cme=Q,this.sa.raiseEvent("X"),this.xsf&&this.L8f())}get xsf(){const Q=qa.a.instance.Pa("WordEditor.Pagination.IPageEndMarkers");
return Q?Q.xsf:!0}get jf(){return this.MH.value}get fj(){return db.a.instance}J6j(Q){this.sa.addHandler("X",Q)}L8f(){this.fj.Pd(()=>{this.c9.MQ(wp.a.yCi)},"CPC:UPN")}enable(){this.ib.oB(this.Vma);this.$Ue()}$Ue(){if(!this.rTa||1>=this.rTa.count)this.a1i(1);else{var Q=this.ib.hb.kb;if(Q){var ya=Q.Wf?Q.Tc:Q.Qa;!ya||0>ya.cpBegin||(Q=ya.node)&&nf.ParagraphReader.nc(Q)&&this.Iem(Q)&&(this.osb&&(this.Hb.We(this.osb),this.osb=null),this.osb=new dc.a(2,1,400,gb=>{this.findCurrentPageFromIp(gb,ya)},62),this.Hb.$b(this.osb))}}}Iem(Q){Q=
jn.GraphIterator.$a(Q);return Q.Bb(35)||Q.Bb(37)||Q.Bb(39)?!1:!0}Uhj(Q){this.rTa=Q;this.Agj()}Agj(){if(-1!==this.Ued){var Q=this.c9k(this.Ued);-1!==Q&&this.a1i(Q)}}findCurrentPageFromIp(Q,ya){this.osb===Q&&(this.osb=null,this.Ued=this.ogl(ya),-1!==this.Ued&&this.Agj())}c9k(Q){if(!this.rTa)return-1;for(let ya=0;ya<this.rTa.count;ya++){const gb=this.rTa.J(ya);if(Q>gb.q6g&&Q<gb.q6g+gb.height)return gb.yj}return-1}ogl(Q){var ya=this.nDl(Q);if(!ya||!ya.htmlElement)return-1;const gb=ya.getBounds();Q=this.Qnl(Q,
ya);if(!Q)return-1;ya=ra.a.LYa(this.$9c.j1a,ya.htmlElement).y;return Q.y+Math.floor(Q.height/2)-gb.y+ya}nDl(Q){return Q.node.Ce(this.jf.Tb)}Qnl(Q,ya){Q=this.aA?this.aA.Kda(Q,!0):Q.cpBegin;return Yo.a.rq(ya,Q)}disable(){this.ib.uga(this.Vma)}}Object(e.a)(Eq,"CurrentPageCalculator",null,[1784,1779]);class Up{constructor(Q){Up.pY=Q}get I1e(){return Up.pY}get gDc(){return this.I1e.gDc}r1k(){this.I1e.enable()}yWk(){this.I1e.disable()}}Up.pY=null;Object(e.a)(Up,"CurrentPageManager",null,[1783]);var yo=
d(110);class Wl extends Sys.EventArgs{constructor(Q,ya){super();this.oti=ya}}Object(e.a)(Wl,"DocumentBottomChangeEventArgs",Sys.EventArgs,[]);class ek extends Sys.EventArgs{constructor(Q,ya,gb){super();this.delta=Q;this.oti=gb}}Object(e.a)(ek,"PageContentSizeChangeEventArgs",Sys.EventArgs,[]);class go{constructor(Q,ya,gb){this.wWg=this.ejd=-1;this.Ysc=null;this.sa=new k.a;this.Nze=!1;this.e1m=(Ob,mc)=>{this.Nze=this.Vtk();mc.Eib||this.pnc.value.measure(this.Qtk)};this.Qtk=()=>{const Ob=this.j1a.clientHeight;
this.Ptk(Ob);this.Ytk(Ob)};this.DJf=(Ob,mc)=>{mc.property===yo.a.nI&&(Ob=mc.node)&&Ob.ia(yo.a.nI,!1)&&(Ob=Ob.Ce(this.jf.Tb))&&(Ob=Ob.htmlElement)&&this.oTa.add(Ob)};this.MH=Q;this.pnc=ya;this.oTa=new ia.a;this.jf.f$g(this.e1m);this.Blf();this.taa=this.taa.bind(this);gb.kvb(this.taa)}get jf(){return this.MH.value}taa(){this.Ysc=null}get j1a(){this.Ysc||(this.Ysc=this.jf.rd.Ce(this.jf.Tb).j1a,la.ULS.shipAssertTag(34136386,336,!!this.Ysc));return this.Ysc}T7j(Q){this.sa.addHandler("OnPageContentSizeChangeKey",
Q)}Ptk(Q){Q!==this.wWg&&(this.sa.raiseEvent("OnDocumentBottomChangeKey",new Wl(Q,this.Nze)),this.wWg=Q)}Ytk(Q){Q!==this.ejd&&(-1!==this.ejd&&this.sa.raiseEvent("OnPageContentSizeChangeKey",new ek(Q-this.ejd,Q,this.Nze)),this.ejd=this.j1a.clientHeight)}Vtk(){let Q=!1;for(let ya=this.oTa.count-1;0<=ya;ya--)this.oTa.J(ya).hasChildNodes()&&(this.oTa.removeAt(ya),Q=!0);return Q}Blf(){Ae.App.Xj.al.Se(23).lp(this.DJf)}}Object(e.a)(go,"DocumentSizeManager",null,[]);var wn=d(58),zo=d(261);class uj{constructor(Q){this.MH=
Q}get jf(){const Q=this.MH.value;la.ULS.shipAssertTag(37820298,336,Q.wi,"OutlineManager.PageView is not a PageView.");return Q}h7d(Q,ya){const gb=wn.a.Pi(uj.Sg.uA(Q),1);ya+=gb;Q.Ce(this.jf.Tb).htmlElement.firstChild.style.minHeight=ya+"px"}VQh(){const Q=jn.GraphIterator.$a(this.jf.rd);Q.qo();Q.Xd();la.ULS.shipAssertTag(37820299,336,10===Q.Cn.type);return Q.Cn}xTh(){const Q=jn.GraphIterator.$a(this.jf.rd);Q.qo();Q.v$();la.ULS.shipAssertTag(37820300,336,10===Q.Cn.type);return Q.Cn}ZEl(Q){const ya=jn.GraphIterator.$a(this.jf.rd);
ya.qo();ya.Xd();let gb=ya.Cn,Ob=null;for(;Q!==gb&&ya.xj();)Ob=gb,gb=ya.Cn;la.ULS.shipAssertTag(37820301,336,10===ya.Cn.type);return Ob}static get Sg(){return zo.a.instance}}Object(e.a)(uj,"OutlineManager",null,[1782]);class ki{constructor(Q){this.Oxa=0;this.i0=null;this.g0f=ya=>{for(let gb of ya.customData)this.showAdornmentText(gb)};this.Hb=Q}TYd(){this.i0||(this.i0=this.PCc())}jvd(){this.i0&&0<ki.oHc(this.i0).length&&this.Hb.$b(this.i0);this.i0=null}PCc(){return Object.assign(new dc.a(3,1,250,this.g0f,
166),{customData:[]})}AYf(Q){this.Oxa=Q}x0c(Q){if(Q){Q.style.width=this.Oxa+"px";if(this.i0)var ya=this.i0;else ya=this.PCc(),this.Hb.$b(ya);ki.oHc(ya).push(Q)}}aLc(Q){Q&&(Q.style.width="0px",this.hlf(Q))}u3c(Q,ya){ya?this.x0c(Q):this.aLc(Q)}showAdornmentText(Q){Q.style.width===this.Oxa+"px"&&(this.zHc(Q).style.visibility="visible")}hlf(Q){Q&&(this.zHc(Q).style.visibility="hidden")}zHc(Q){Q=Q.childNodes;la.ULS.shipAssertTag(24958351,336,1===Q.length,"Expected 1 child div in the page adornment, found "+
Q.length);return Q[0]}static oHc(Q){return Q.customData}}Object(e.a)(ki,"PageAdornmentAnimationManager",null,[1781]);class Tn{constructor(Q){this.Nl=Q;this.G8=new nb.a;this.H8=new nb.a}Eza(Q){Q=jn.GraphIterator.$a(Q);if(Q.qo()&&Q.Jp()){Q.Xd();do 10===Q.Qe&&this.ULf(Q.currentNode),Q.Du();while(8!==Q.Qe)}}hKb(Q){const ya=Q.yj;var gb=this.UAb(Q.ALb);if(!this.G8.xb(gb))return la.ULS.sendTraceTag(24958352,336,10,"OutlineToHeaderFooterKindToContentMap does not contain a value for the section "+gb),!1;Q=
this.G8.J(gb);la.ULS.shipAssertTag(24958353,336,this.H8.xb(gb),"Outline to template mode map doesn't contain the section key in PageAdornmentContentManager.ShouldShowHeaderForPage().");gb=this.H8.J(gb);return this.clf(Q,ya,gb)}gKb(Q){const ya=Q.yj;var gb=this.UAb(Q.ALb);if(!this.G8.xb(gb))return la.ULS.sendTraceTag(24958354,336,10,"OutlineToHeaderFooterKindToContentMap does not contain a value for the section "+gb),!1;Q=this.G8.J(gb);la.ULS.shipAssertTag(24958355,336,this.H8.xb(gb),"Outline to template mode map doesn't contain the section key in PageAdornmentContentManager.ShouldShowFooterForPage().");
gb=this.H8.J(gb);return this.r$e(Q,ya,gb)}uif(Q){if(!Q)return la.ULS.sendTraceTag(24979136,336,10,"Null container input into GetTemplateSelectionFromContainer."),0;var ya=Q.$sd;if(!ya)return la.ULS.sendTraceTag(24979137,336,10,String.format("Container of page number {0} has a null EndSectionNode.",Q.yj)),0;ya=this.Nl.jAb(ya);if(!ya)return la.ULS.sendTraceTag(24979138,336,10,"Header footer container node expected not to be null."),0;ya=this.Nl.zla(ya);const gb=1===Q.yj;Q=!(Q.yj%2);return 1===ya?1:
2===ya?gb?2:1:3===ya?Q?3:4:gb?2:Q?3:4}ULf(Q){if(10===Q.type){var ya=new nb.a,gb=this.Nl.jAb(Q);la.ULS.shipAssertTag(24958356,336,!!gb,"Header footer container node expected to not be null in PageAdornmentContentManager.PopulateHeaderFooterKindToContentMap().");var Ob=this.Nl.zla(gb);Q=this.UAb(Q);this.Y8f(Q,Ob);this.X8f(Q,ya);gb=jn.GraphIterator.$a(gb);if(gb.Jp()){gb.Xd();do Q=gb.currentNode,Ob=this.Nl.XFd(Q),Q=this.Nl.J4h(Q),ya.add(Ob,Q),gb.Du();while(36===gb.Qe)}}}Y8f(Q,ya){this.H8.xb(Q)?this.H8.Z(Q,
ya):this.H8.add(Q,ya)}X8f(Q,ya){this.G8.xb(Q)?this.G8.Z(Q,ya):this.G8.add(Q,ya)}UAb(Q){la.ULS.shipAssertTag(24958358,336,10===Q.type,"Expected node of type Outline but received node of type "+Q.type);return Q.ia(lk.a.Ega,0)}clf(Q,ya,gb){const Ob=1===ya;ya=!(ya%2);switch(gb){case 2:if(Ob){if(Q.xb(2))return Q.J(2)}else if(Q.xb(0))return Q.J(0);break;case 3:if(ya){if(Q.xb(1))return Q.J(1)}else if(Q.xb(0))return Q.J(0);break;case 4:if(Ob){if(Q.xb(2))return Q.J(2)}else if(ya){if(Q.xb(1))return Q.J(1)}else if(Q.xb(0))return Q.J(0);
break;case 1:if(Q.xb(0))return Q.J(0)}return!1}r$e(Q,ya,gb){const Ob=1===ya;ya=!(ya%2);switch(gb){case 2:if(Ob){if(Q.xb(5))return Q.J(5)}else if(Q.xb(3))return Q.J(3);break;case 3:if(ya){if(Q.xb(4))return Q.J(4)}else if(Q.xb(3))return Q.J(3);break;case 4:if(Ob){if(Q.xb(5))return Q.J(5)}else if(ya){if(Q.xb(4))return Q.J(4)}else if(Q.xb(3))return Q.J(3);break;case 1:if(Q.xb(3))return Q.J(3)}return!1}}Object(e.a)(Tn,"PageAdornmentContentManager",null,[1780]);var Yr=d(1135);class kn{constructor(Q,ya,
gb,Ob,mc,dd,Md,He,Ue){this.b$f(Q,ya,gb,dd,Md,He,Ue);this.yj=Q;this.pq=ya;this.Zq=gb;this.ALb=Ob;this.$sd=mc;this.fbb=dd;this.B4b=Md;this.M1b=He;this.PCi=Ue}get top(){return this.pq}get height(){return this.Zq}O_c(Q){this.pq!==Q&&(this.fbb.style.top=Q+"px",this.pq=Q)}fYf(Q){this.height!==Q&&(this.fbb.style.height=Q+"px",this.Zq=Q)}b$f(Q,ya,gb,Ob,mc,dd,Md){la.ULS.shipAssertTag(37244961,336,0<Q,"PageAdornmentContainer: pageNumber parameter value {0} is unexpected value.",Q);la.ULS.shipAssertTag(37244962,
336,0<=ya,"PageAdornmentContainer: top parameter value {0} is unexpected value.",ya);la.ULS.shipAssertTag(37244963,336,0<=gb,"PageAdornmentContainer: height parameter value {0} is unexpected value.",gb,ya);la.ULS.shipAssertTag(37244992,336,!!Ob,"PageAdornmentContainer: containerDomElement parameter is null.");la.ULS.shipAssertTag(37244993,336,!!mc,"PageAdornmentContainer: headerLabelDomElement parameter is null.");la.ULS.shipAssertTag(37244994,336,!!dd,"PageAdornmentContainer: footerLabelDomElement parameter is null.");
la.ULS.shipAssertTag(37244995,336,!!Md,"PageAdornmentContainer: pageNumberLabelDomElement parameter is null.")}}Object(e.a)(kn,"PageAdornmentContainer",null,[1828]);class kl{constructor(Q,ya,gb,Ob,mc,dd,Md,He,Ue,Sf,of,cj,el){this.rHg="headerFooterTab";this.Hnd=null;this.ru=!0;this.Ere=0;this.Vwe=null;this.kZa=!1;this.rGb=qk=>{this.uOm(qk.Dv);return!0};this.mD=()=>!0;this.GBb=()=>{this.c_e()&&(this.kZa=!1,this.kgo(),this.Vwe=new Date)};this.tGb=qk=>{this.kZa||this.KU.x0c(qk.Dv);return!0};this.sGb=
qk=>{this.kZa||(qk=qk.Dv,this.Q_f(qk)||this.KU.aLc(qk));return!0};this.Nkn=()=>{let qk=Array.dequeue(this.oEe);for(;qk;)this.jU(qk),qk=Array.dequeue(this.oEe);this.Hnd=null};this.MH=Q;this.ig=ya;this.GD=gb;this.Kha=Ob;this.ga=mc;this.Kj=dd;this.KU=Md;this.bxa=He;this.hHa=Ue;this.Hb=Sf;this.Oa=of;this.oEe=[];this.f0=new Map;this.KH=cj;this.Hw=el;this.hHa.ird(this.GBb);this.ew=!!H.AFrameworkApplication.ua&&H.AFrameworkApplication.ua.Sb.A6;if(this.vdd=(this.yte=!!this.Oa&&this.Oa.$("AdaptiveLayoutForSmallScreenModeIsEnabled"))&&
!!this.Oa&&this.Oa.$("DisableHeaderFooterTabForSmallScreenModeIsEnabled"))"Small"===Ae.App.xa.wu.getLayoutBreakpoint()&&(this.ru=!1),Ae.App.xa.wu.registerLayoutBreakpointChanged(this.rHg,qk=>{switch(qk){case "Small":this.f5h();break;default:this.e5i()}})}get jf(){return this.MH.value}e5i(){try{this.$Xn()}catch(Q){la.ULS.shipAssertTag(37244997,336,!1,"Exception was caught in ShowPageAdornments. Message: {0} Stack: {1}",Q.message,Q.stack)}}f5h(){try{this.eYl()}catch(Q){la.ULS.shipAssertTag(37244998,
336,!1,"Exception was caught in HidePageAdornments. Message: {0} Stack: {1}",Q.message,Q.stack)}}oqn(){for(const Q of this.f0.keys())this.r3d(Q)}Eza(){try{this.nCk()}catch(Q){la.ULS.shipAssertTag(37244999,336,!1,"Exception was caught in HidePageAdornments. Message: {0} Stack: {1}",Q.message,Q.stack)}}Uhj(Q){try{this.Eko(Q)}catch(ya){la.ULS.shipAssertTag(37245E3,336,!1,"Exception was caught in UpdatePageElements. Message: {0}",ya.message)}}dispose(){try{this.Meo(),this.qfo(),this.hHa&&this.hHa.aPi(this.GBb)}catch(Q){la.ULS.shipAssertTag(37245001,
336,!1,"Exception was caught in PageAdornmentManager.Dispose. Message: {0} Stack: {1}",Q.message,Q.stack)}}uOm(Q){const ya=this.WNc(Q),gb=this.uOh(Q);gb?(Q=this.bxa.uif(gb),this.ga.Xb(ya?Rf.a.Qde:Rf.a.E4c,2,Q),this.kZa=!0):(la.ULS.sendTraceTag(37245002,336,10,"GetContainerFromElement returned a null container for element with id "+Q.id),this.ga.processAction(Rf.a.BMd,2))}Meo(){this.f0.forEach(Q=>{this.BQa(Q)})}qfo(){this.ew&&(this.vdd&&(Ae.App.xa.wu.unregisterLayoutBreakpointChanged(this.rHg),this.vdd=
!1),this.ew=!1)}BQa(Q){if(Q){var ya=Q.B4b;Q=Q.M1b;Ci.a.BCa(ya)&&Ci.a.BCa(Q)?(this.Kj.sc(B.a.yQ,ya,this.tGb),this.Kj.sc(B.a.yQ,Q,this.tGb),this.Kj.sc(B.a.oK,ya,this.sGb),this.Kj.sc(B.a.oK,Q,this.sGb),this.ig.sc(B.a.click,ya,this.rGb),this.ig.sc(B.a.click,Q,this.rGb),this.GD.sc(ya,kl.hGb),this.GD.sc(Q,kl.hGb),this.Kha.sc(B.a.$w,ya,this.mD),this.Kha.sc(B.a.$w,Q,this.mD)):la.ULS.sendTraceTag(37245003,336,15,"Invalid DOM element for the given adornment container in PageAdornmentManager.")}}odn(Q){this.oEe.push(Q);
this.Hnd||(this.Hnd=new dc.a(2,1,50,this.Nkn),this.Hb.$b(this.Hnd))}jU(Q){if(Q){var ya=Q.B4b;Q=Q.M1b;Ci.a.BCa(ya)&&Ci.a.BCa(Q)?(this.Kj.mb(B.a.yQ,ya,this.tGb),this.Kj.mb(B.a.yQ,Q,this.tGb),this.Kj.mb(B.a.oK,ya,this.sGb),this.Kj.mb(B.a.oK,Q,this.sGb),this.ig.mb(B.a.click,ya,this.rGb),this.ig.mb(B.a.click,Q,this.rGb),this.GD.mb(ya,kl.hGb),this.GD.mb(Q,kl.hGb),this.Kha.mb(B.a.$w,ya,this.mD),this.Kha.mb(B.a.$w,Q,this.mD)):la.ULS.sendTraceTag(37245004,336,15,"Invalid DOM element for the given adornment container in PageAdornmentManager.")}}$Xn(){if(!this.ru){for(let Q of this.f0.values())Q.fbb.style.display=
"block";this.ru=!0}}eYl(){this.ru&&(this.f0.forEach(Q=>{Q.fbb.style.display="none"}),this.ru=!1)}nCk(){this.bxa.Eza(this.jf.rd)}Eko(Q){this.KU.TYd();var ya=0;const gb=new ia.a;this.Eza();const Ob=this.Qwl();for(var mc of Q)Q=mc.yj,this.D0m(mc)||this.r3d(mc.yj),this.f0.has(Q)?this.who(mc):this.DIk(mc),ya=Q,gb.add(Q);for(mc=1;mc<=ya;mc++)gb.contains(mc)||this.r3d(mc);for(ya+=1;ya<=Ob;ya++)this.r3d(ya);this.KU.jvd()}D0m(Q){return this.f0.has(Q.yj)?this.f0.get(Q.yj).ALb.id===Q.ALb.id:!1}Qwl(){let Q=0;
this.f0.forEach((ya,gb)=>{gb>Q&&(Q=gb)});return Q}DIk(Q){const ya=Q.ALb.Ce(this.jf.Tb);if(ya){var gb=Q.yj;Q=this.CCc(gb,Q.top,Q.height,ya.U9,Q.ALb,Q.$sd);this.odn(Q);this.V7f(Q);this.l9f(Q);this.vdd&&!this.ru&&(Q.fbb.style.display="none");this.f0.set(gb,Q)}}CCc(Q,ya,gb,Ob,mc,dd){const Md=Th.b("div","","PageAdornmentContainer");Md.style.top=ya+"px";Md.style.height=gb+"px";Ob.appendChild(Md);this.aVe(Md,WordEditorIntl.WordEditorStrings.l_Header,WordEditorIntl.WordEditorStrings.l_Footer);Ob=this.y0e(Q);
Md.appendChild(Ob);const He=this.V_e(Q);Md.appendChild(He);const Ue=this.M_e(Q);Md.appendChild(Ue);H.AFrameworkApplication.isRtl&&(Md.classList.add("Rtl"),He.classList.add("Rtl"),Ue.classList.add("Rtl"));return new kn(Q,ya,gb,mc,dd,Md,He,Ue,Ob)}V_e(Q){Q=Th.b("div","h"+Q,this.Hw?"PageAdornmentHeaderLabelThemed":"PageAdornmentHeaderLabel");this.KH&&(this.Hw?Q.classList.add("PageAdornmentHeaderFooterBorderThemed"):Q.style.borderColor=Yr.a.bee);const ya=Th.b("span","","");ya.innerText=WordEditorIntl.WordEditorStrings.l_Header;
ya.style.whiteSpace="nowrap";Q.appendChild(ya);return Q}M_e(Q){Q=Th.b("div","f"+Q,this.Hw?"PageAdornmentFooterLabelThemed":"PageAdornmentFooterLabel");this.KH&&(this.Hw?Q.classList.add("PageAdornmentHeaderFooterBorderThemed"):Q.style.borderColor=Yr.a.bee);const ya=Th.b("span","","");ya.innerText=WordEditorIntl.WordEditorStrings.l_Footer;ya.style.whiteSpace="nowrap";Q.appendChild(ya);return Q}y0e(Q){const ya=Th.b("div","","PageAdornmentNumberLabel");ya.innerText=Q.toString();return ya}aVe(Q,ya,gb){if(!this.Ere){const Ob=
Th.b("p","","");Ob.innerText=ya;Ob.style.whiteSpace="nowrap";Ob.style.visibility="hidden";Q.appendChild(Ob);ya=Th.b("p","","");ya.innerText=gb;ya.style.whiteSpace="nowrap";ya.style.visibility="hidden";Q.appendChild(ya);this.Ere=Q.clientWidth;this.KU.AYf(this.Ere);Q.removeChild(Ob);Q.removeChild(ya)}}r3d(Q){if(this.f0.has(Q)){var ya=this.f0.get(Q);this.BQa(ya);Ci.a.gv(ya.fbb);this.f0.delete(Q)}}who(Q){if(this.f0.has(Q.yj)){var ya=this.f0.get(Q.yj);ya.O_c(Q.top);ya.fYf(Q.height);this.V7f(ya);this.l9f(ya)}else la.ULS.sendTraceTag(37245005,
324,15,"We called UpdateContainerForPage, but a container doesn't exist for the given page.")}kgo(){this.KU.TYd();this.Eza();this.f0.forEach(Q=>{this.V7f(Q);this.l9f(Q)});this.KU.jvd()}V7f(Q){const ya=Q.B4b,gb=Q.M1b,Ob=this.bxa.hKb(Q),mc=this.bxa.gKb(Q);this.Omo(Q,Ob,mc);this.KU.u3c(ya,Ob);this.KU.u3c(gb,mc)}Omo(Q,ya=!0,gb=!0){const Ob=Q.B4b;Q=Q.M1b;3!==H.AFrameworkApplication.ya.mode?(Ob.title=WordEditorIntl.WordEditorStrings.l_OpenHeader,Q.title=WordEditorIntl.WordEditorStrings.l_OpenFooter):(Ob.title=
ya?WordEditorIntl.WordEditorStrings.l_EditHeader:WordEditorIntl.WordEditorStrings.l_AddHeader,Q.title=gb?WordEditorIntl.WordEditorStrings.l_EditFooter:WordEditorIntl.WordEditorStrings.l_AddFooter)}Q_f(Q){const ya=this.uOh(Q);return ya?this.WNc(Q)?this.bxa.hKb(ya):this.bxa.gKb(ya):(la.ULS.sendTraceTag(37245006,336,10,"GetContainerFromElement returned null."),!1)}uOh(Q){Q=Q.id;Q=Q.substring(1,Q.length);Q=Number.parseInvariant(Q);return this.f0.has(Q)?this.f0.get(Q):(la.ULS.sendTraceTag(37245007,336,
10,"Adornment container map does not contain the page number "+Q),null)}WNc(Q){return Q.id.length?"h"===Q.id.substring(0,1):(la.ULS.sendTraceTag(37245008,336,10,"Empty ID found for adornment"),!0)}l9f(Q){const ya=Q.height;ya<kl.KIm?(Q.B4b.classList.add(kl.Meb),Q.M1b.classList.add(kl.Meb)):(Q.B4b.classList.remove(kl.Meb),Q.M1b.classList.remove(kl.Meb));ya<kl.LIm?(Q.PCi.classList.add(kl.Meb),Q.fbb.classList.add(kl.Meb)):(Q.PCi.classList.remove(kl.Meb),Q.fbb.classList.remove(kl.Meb))}c_e(){return!this.Vwe||
F.a.Wkf(this.Vwe,500)}static hGb(){return!0}}kl.Meb="Hidden";kl.KIm=120;kl.LIm=50;Object(e.a)(kl,"PageAdornmentManager",null,[1778,9,1779]);class rm{constructor(Q,ya){this.GZd=new ia.a;this.GZd.add(Q);this.GZd.add(ya)}}Object(e.a)(rm,"PageElementManagerList",null,[]);var Ao=d(70);class fk{constructor(Q,ya,gb){this.Mm=Q;this.dTb=[];this.QE=ya;this.KH=gb}XMi(){for(let Q=0,ya=this.dTb.length;Q<ya;Q++)Ci.a.gv(this.dTb[Q]);Array.clear(this.dTb)}SPh(Q,ya,gb,Ob,mc,dd){let Md=Math.min(Ob.x-dd.x,mc.x-dd.x);
Ob=Math.min(dd.x+dd.width-(Ob.x+Ob.width),dd.x+dd.width-(mc.x+mc.width));ya+=mc.y-dd.y;({Zfa:ya,leftMargin:Md,rightMargin:Ob}=this.j$j(ya,Md,Ob));Q=this.qCl(Q,Md,Ob,Md,Ob,gb);Q.style.top=ya+"px";Q.style.zIndex="0";this.dTb.push(Q);Ao.c(Q,!0);return Q}dHd(Q){return Q?Q.querySelector(".PageBreakBorderSpan"):null}qCl(Q,ya,gb,Ob,mc,dd){return Q?this.uLl(ya,gb,Ob,mc,dd):this.ICl(Ob,mc,dd)}j$j(Q,ya,gb){ya/=this.Mm.instance.vj;gb/=this.Mm.instance.vj;Q/=this.Mm.instance.vj;return{Zfa:Q,leftMargin:ya,rightMargin:gb}}$dm(Q){return this.Qii(Q)&&
this.FCi(Q)?(Q=this.LAb(Q))&&Q.offsetParent?!1:!0:!1}Zdm(Q){return!this.Qii(Q)||this.FCi(Q)?!1:!0}wQ(){}LAb(Q){if(!Q.AKf)return null;let ya=null;Q.Ufb&&!Q.caa?(Q=this.dHd(Q.AKf))&&(ya=Q):ya=Q.AKf;return ya}Qii(Q){return Q.Ufb&&!Q.caa&&Q.paragraphNode?!0:!1}FCi(Q){Q=Q.paragraphNode;return!!Q&&!!Q.anchor}njh(Q,ya){Q=ra.a.eLa(Q);ya=ra.a.eLa(ya);return(Q-ya)/this.Mm.instance.vj}dVe(Q,ya){Q=ra.a.eLa(Q);ya=ra.a.eLa(ya);return(Q-ya)/this.Mm.instance.vj}hUd(){this.Whj(!1)}gUd(){this.Whj(!0)}Whj(Q){for(let ya=
0,gb=this.dTb.length;ya<gb;ya++){const Ob=this.dTb[ya];"PageEndMarker.Para"===Ob.id?fk.Zhj(Ob,Q):"PageEndMarker.Table"===Ob.id&&fk.Rij(Ob,Q)}}ICl(Q,ya,gb){if(!fk.fWb){fk.fWb=Th.b("div","PageEndMarker.Para","PageEndMarker");var Ob=Th.b("div","","Current FullWidth");this.KH&&(Ob.style.borderTopColor=this.QE.ata());fk.fWb.appendChild(Ob);Ob=Th.b("div","","Stale LeftWing");const mc=Th.b("div","","Stale RightWing");this.KH&&(Ob.style.borderTopColor=this.QE.ata(),mc.style.borderTopColor=this.QE.ata());
fk.fWb.appendChild(Ob);fk.fWb.appendChild(mc)}Ob=fk.fWb.cloneNode(!0);Ob.childNodes[1].style.width=Q-10+"px";Ob.childNodes[2].style.width=ya-10+"px";fk.Zhj(Ob,gb);return Ob}uLl(Q,ya,gb,Ob,mc){if(!fk.nub){fk.nub=Th.b("div","PageEndMarker.Table","PageEndMarker");var dd=Th.b("div","","Current LeftWing"),Md=Th.b("div","","Current RightWing");this.KH&&(dd.style.borderTopColor=this.QE.ata(),Md.style.borderTopColor=this.QE.ata());fk.nub.appendChild(dd);fk.nub.appendChild(Md);dd=Th.b("div","","Stale LeftWing");
Md=Th.b("div","","Stale RightWing");this.KH&&(dd.style.borderTopColor=this.QE.ata(),Md.style.borderTopColor=this.QE.ata());fk.nub.appendChild(dd);fk.nub.appendChild(Md)}dd=fk.nub.cloneNode(!0);dd.childNodes[0].style.width=Q+"px";dd.childNodes[1].style.width=ya+"px";dd.childNodes[2].style.width=gb-10+"px";dd.childNodes[3].style.width=Ob-10+"px";fk.Rij(dd,mc);return dd}static Zhj(Q,ya){ya?fk.QDm(Q):fk.RDm(Q)}static RDm(Q){Q.childNodes[0].style.display="none";Q.childNodes[1].style.display="block";Q.childNodes[2].style.display=
"block"}static QDm(Q){Q.childNodes[0].style.display="block";Q.childNodes[1].style.display="none";Q.childNodes[2].style.display="none"}static Rij(Q,ya){ya?fk.VDm(Q):fk.WDm(Q)}static WDm(Q){Q.childNodes[0].style.display="none";Q.childNodes[1].style.display="none";Q.childNodes[2].style.display="block";Q.childNodes[3].style.display="block"}static VDm(Q){Q.childNodes[0].style.display="block";Q.childNodes[1].style.display="block";Q.childNodes[2].style.display="none";Q.childNodes[3].style.display="none"}}
fk.fWb=null;fk.nub=null;Object(e.a)(fk,"PageEndDOMHelper",null,[]);class Ho{constructor(Q,ya){this.wsb=this.CWg=null;this.Mm=Q;this.Ih=ya}O2f(Q,ya){try{this.o3n(Q,ya)}catch(gb){la.ULS.sendTraceTag(35005339,336,10,"Exception was caught in PageEndMarkerPositionComparer.StorePositions. Message: {0}",gb.message)}}MBk(Q,ya,gb,Ob,mc,dd,Md){this.Ih.Pd(()=>{try{this.NBk(Q,ya,gb,Ob,mc,dd,Md)}catch(He){la.ULS.sendTraceTag(35005341,336,10,"Exception was caught in PageEndMarkerPositionComparer.ComparePositions. Message: {0}",
He.message)}},"PEMPC:CP")}o3n(Q,ya){this.CWg=Q;this.wsb=ya}NBk(Q,ya,gb,Ob,mc,dd,Md){var He=this.CWg;if(He&&Q){var Ue=He.count,Sf=Q.count;if(Ue&&Sf){var of=this.E9k(He,Q);if(of.count){var cj=this.Mm.vj,el=this.DZb(of)/cj,qk=this.Sph(of)/cj;Q=this.QCd(He,Q);if(Q.count){He=this.DZb(Q)/cj;cj=this.Sph(Q)/cj;var jm=!0;for(var Qk=0;Qk<of.count;Qk++)if(of.J(Qk)){jm=!1;break}var Kn=Qk=0;this.wsb&&ya&&(Qk=this.Uok(this.wsb,ya),Kn=ya.count-this.wsb.count);la.ULS.sendTraceTag(35005343,336,50,"{0}",{["FlightEnabled"]:gb,
["HardPageBreakExists"]:mc,["EstimatedPageCount"]:Ue,["CalculatedPageCount"]:Sf,["InOrderAverageDelta"]:el,["InOrderStandardDeviation"]:qk,["ShortestAverageDelta"]:He,["ShortestStandardDeviation"]:cj,["PositionsShouldBeUpdated"]:Ob,["DocumentHeightChanged"]:dd,["DeltasAllZero"]:jm,["HeaderFooterOpenSinceLastResponse"]:Md,["DeltaInViewport"]:Qk,["ChangeInViewportMarkerCount"]:Kn});dd||Md||jm||(la.ULS.sendTraceTag(36557839,336,15,"Assumed redundant pagination request but there were changes in the page end marker positions."),
ya=of.toArray().toString(),gb=Q.toArray().toString(),la.ULS.sendTraceTag(35726603,336,50,"{0} {1}",ya,gb))}}}}else la.ULS.sendTraceTag(35005342,336,10,"estimatedPositions or calculatedPositions are null in PageEndMarkerPositionComparer.ComparePositionsInternal.")}Uok(Q,ya){const gb=new ia.a;for(let Ob of Q)gb.add(Ob.top);if(!gb.count)return-1;Q=new ia.a;for(let Ob of ya)Q.add(Ob.top);if(!Q.count)return-1;ya=this.QCd(gb,Q);return this.DZb(ya)/this.Mm.vj}DZb(Q){if(!Q.count)return 0;let ya=0;for(let gb=
0;gb<Q.count;gb++)ya+=Q.J(gb);return ya/Q.count}Sph(Q){if(!Q.count)return 0;const ya=this.DZb(Q);let gb=0;for(let Ob=0;Ob<Q.count;Ob++){const mc=Q.J(Ob)-ya;gb+=mc*mc}return Math.sqrt(gb/Q.count)}E9k(Q,ya){const gb=new ia.a;if(!Q.count||!ya.count)return gb;Q.Sc((mc,dd)=>mc-dd);ya.Sc((mc,dd)=>mc-dd);const Ob=Math.min(Q.count,ya.count);for(let mc=0;mc<Ob;mc++){const dd=Math.abs(Q.J(mc)-ya.J(mc));gb.add(dd)}return gb}QCd(Q,ya){const gb=new ia.a;if(!Q.count||!ya.count)return gb;var Ob=Q.count<=ya.count;
const mc=Ob?Q:ya;Q=Ob?ya:Q;for(ya=0;ya<mc.count;ya++){Ob=mc.J(ya);let Md=Math.abs(Ob-Q.J(0)),He=0;for(let Ue=1;Ue<Q.count;Ue++){var dd=Q.J(Ue);dd=Math.abs(Ob-dd);dd<Md&&(Md=dd,He=Ue)}gb.add(Md);Q.removeAt(He)}return gb}}Object(e.a)(Ho,"PageEndMarkerPositionComparer",null,[1762]);var sm=d(428),vk=d(524);class Uk{constructor(Q,ya,gb,Ob,mc,dd,Md,He,Ue,Sf){this.pq=Q;this._pageNumber=ya;this.Ufb=gb;this.caa=Ob;this.AKf=mc;this.outlineNode=dd;this.outlineGroupNode=Md;this.AUg=He;this.paragraphNode=Ue;this.gU=
Sf}get top(){return this.pq}get yj(){return this._pageNumber}get W_m(){return this.AUg}O_c(Q){this.pq=Q}i7d(Q){this._pageNumber=Q}o_i(Q){this.AUg=Q}}Object(e.a)(Uk,"PageEndMarker",null,[]);class vs{constructor(){this.pf=null;this.wti=0}}Object(e.a)(vs,"PageEndMarkerToRestore",null,[]);class Fq{constructor(Q,ya,gb,Ob,mc,dd,Md){this.DJf=(He,Ue)=>{Ue.property===yo.a.nI&&(He=Ue.node)&&He.ia(yo.a.nI,!1)&&this.wpd.contains(He.id)&&(Ue=He.Ce(this.jf.Tb))&&(Ue=Ue.htmlElement)&&(this.wpd.remove(He.id),this.oTa.add(Ue))};
this.MH=Q;this.Mm=ya;this.eIa=gb;this.Ax=Ob;this.LBe=mc;this.KY=dd;this.Jm=Md;this.qt=new ia.a;this.eTb=new ia.a;this.mub=new nb.a;this.wpd=new vk.a(new sm.a);this.oTa=new ia.a;this.hTb=!!mc;this.Blf()}get jf(){const Q=this.MH.value;la.ULS.shipAssertTag(37052750,336,Q.wi,"PageEndMarkerPositionUpdater.PageView is not a PageView.");return Q}I3c(Q){try{this.fko(Q)}catch(ya){this.Ax.wQ(ya.message+" "+ya.stack),la.ULS.sendTraceTag(38405270,336,10,"Exception caught in PageEndMarkerPositionUpdater.UpdateMarkers. Exception: {0}",
ya.message)}}u4j(Q){try{this.v4j(Q)}catch(ya){this.Ax.wQ(ya.message+" "+ya.stack),la.ULS.sendTraceTag(38405271,336,10,"Exception caught in PageEndMarkerPositionUpdater.AddRenderedMarker. Exception: {0}",ya.message)}}Spk(Q){try{return this.Tpk(Q)}catch(ya){this.Ax.wQ(ya.message+" "+ya.stack),la.ULS.sendTraceTag(37052752,336,10,"Exception caught in PageEndMarkerPositionUpdater.CalculatePositions. Exception: {0}",ya.message)}return!1}iyn(){try{this.jyn()}catch(Q){this.Ax.wQ(Q.message+" "+Q.stack),la.ULS.sendTraceTag(37052753,
336,10,"Exception caught in PageEndMarkerPositionUpdater.RestorePositions. Exception: {0}",Q.message)}}yJc(){try{return this.oGl()}catch(Q){return this.Ax.wQ(Q.message+" "+Q.stack),la.ULS.sendTraceTag(38405273,336,10,"Exception caught in PageEndMarkerPositionUpdater.GetRenderedPageEndMarkers. Exception: {0}",Q.message),null}}W8f(){try{this.Glo()}catch(Q){this.Ax.wQ(Q.message+" "+Q.stack),la.ULS.sendTraceTag(37820302,336,10,"Exception caught in PageEndMarkerPositionUpdater.UpdateSectionLastPageHeight. Exception: {0}",
Q.message)}}DWe(){try{return this.pvk()}catch(Q){return this.Ax.wQ(Q.message+" "+Q.stack),la.ULS.sendTraceTag(38405274,336,10,"Exception caught in PageEndMarkerPositionUpdater.CheckVirtualizedHardBreaks. Exception: {0}",Q.message),!1}}b6l(Q){try{this.c6l(Q)}catch(ya){this.Ax.wQ(ya.message+" "+ya.stack),la.ULS.sendTraceTag(38916953,336,10,"Exception caught in PageEndMarkerPositionUpdater.InsertOrDeleteRenderedMarkers. Exception: {0}",ya.message)}}fko(Q){if(Q){this.Twk();for(let ya=0;ya<Q.length;ya++){const gb=
ya+1,Ob=this.zDk(Q[ya],gb);this.qt.add(Ob);this.mub.add(gb,Ob)}}}c6l(Q){let ya=!1;for(let gb of Q)if(gb)if(0<gb.YB)for(let Ob of gb.rof)ya=this.Qqd(Ob,gb.outlineGroupNode)||ya;else if(0>gb.YB){ya=!0;for(let Ob of gb.gzd)this.bTk(Ob.yj)}ya&&this.lTf()}v4j(Q){const ya=this.wOh(Q.paragraphNode);this.Qqd(Q,ya)&&this.lTf()}bTk(Q){const ya=Q-1;0>ya||this.qt.count<=ya||(this.qt.removeAt(ya),this.mub.xb(Q)&&this.mub.remove(Q))}oGl(){const Q=new ia.a;for(let ya of this.qt)this.f7b(ya)&&Q.add(ya);return Q}Qqd(Q,
ya){if(!Q)return la.ULS.sendTraceTag(38385033,336,15,"pageEndDetails is null in PageEndMarkerPositionUpdater.AddRenderedMarkerInternal."),!1;ya=this.wDk(Q,ya);Q=Q.H$l?-1:Q.yj;let gb=!1,Ob;this.mub.xb(Q)?(Ob=this.mub.J(Q).yj,ya.i7d(Ob),this.qt.Z(Ob-1,ya),this.mub.remove(Q)):(Ob=ya.yj,this.qt.insert(Ob-1,ya),gb=!0);return gb}zDk(Q,ya){return new Uk(0,ya,Q.HardBreak,!1,null,null,null,0,null,null)}wDk(Q,ya){const gb=Q.Iib,Ob=Q.yj,mc=Q.gU,dd=!!mc&&mc.HardBreak,Md=Q.caa,He=Q.paragraphNode,Ue=this.HVh(ya),
Sf=Q.outlineNode;var of=this.rgf(Sf);if(!of)return la.ULS.sendTraceTag(37782370,336,15,"Given an outline node with a null DOM element in ConstructPageEndMarker."),null;let cj=null;dd&&(cj=this.Ax.dHd(Q.Iib));Q=this.Ax.njh(cj||gb,Ue);of=this.Ax.dVe(cj||gb,of);return new Uk(of,Ob,dd,Md,gb,Sf,ya,Q,He,mc)}Tpk(Q){this.eTb=new ia.a;this.hTb&&this.LBe.reset();this.ipn();this.D_n();this.k$j();this.Hpk(Q);return 0<this.eTb.count}ipn(){for(let Q=0;Q<this.qt.count;Q++){const ya=this.qt.J(Q);this.Ax.$dm(ya)?
this.nCm(ya):(this.Ax.Zdm(ya)||this.f7b(ya)&&!this.rgf(ya.outlineNode))&&this.bOi(ya)}}k$j(){let Q=0,ya=null;var gb=0;let Ob=0;for(let mc=0;mc<this.qt.count;mc++){const dd=this.qt.J(mc);this.f7b(dd)&&(dd.Ufb&&(Ob+=this.jjh(dd,gb,Ob)),ya&&ya.id===dd.outlineNode.id||(ya=dd.outlineNode,Ob=Q=0),dd.Ufb&&!dd.caa&&(Q=this.Fpk(dd)),gb=dd.top+Q+Ob,dd.O_c(gb))}this.jjh(null,gb,Ob);this.apn()}jjh(Q,ya,gb){let Ob=null;this.hTb&&(Ob=this.LBe.Ipk(Q,ya,gb));return Ob?Ob.delta:0}jyn(){if(this.eTb){for(let Q=0;Q<
this.eTb.count;Q++){const ya=this.eTb.J(Q);Ci.a.kJn(ya.pf,ya.wti)}this.hTb&&this.LBe.fyn()}}Glo(){if(!this.hTb){var Q=this.eIa.xTh();if(this.qt.count){var ya=this.eIa.VQh();for(let mc=0;mc<this.qt.count;mc++){var gb=this.qt.J(mc);if(this.f7b(gb)&&gb.caa){gb=this.eIa.ZEl(gb.outlineNode);var Ob=0<mc?this.qt.J(mc-1).outlineNode:ya;Ob=mc&&gb.id===Ob.id?this.qt.J(mc-1).top:0;this.eIa.h7d(gb,Ob)}}ya=this.qt.J(this.qt.count-1);ya.caa?this.eIa.h7d(Q,0):this.eIa.h7d(Q,ya.top)}else this.eIa.h7d(Q,0)}}D_n(){this.qt.Sc((Q,
ya)=>Q.yj-ya.yj)}lTf(){for(let Q=0;Q<this.qt.count;Q++)this.qt.J(Q).i7d(Q+1)}Fpk(Q){return Q?this.mjh(Q)-Q.top:(la.ULS.sendTraceTag(37306776,336,15,"CalculatePageEndMarkerDelta called with a null PageEndMarker."),0)}Qpk(Q){if(!Q)return 0;const ya=this.HVh(Q.outlineGroupNode);return ya?this.Ax.njh(this.Ax.LAb(Q),ya):0}mjh(Q){if(!Q)return 0;const ya=this.Ax.LAb(Q);Q=this.rgf(Q.outlineNode);return Q?this.Ax.dVe(ya,Q):(la.ULS.sendTraceTag(37782371,336,50,"The given pageEndMarker contains an outline node with a null DOM element in CalculatePageEndMarkerPosition."),
0)}apn(){let Q=0,ya=!1,gb=null,Ob=!1;for(let mc=this.qt.count-1;0<=mc;mc--){const dd=this.qt.J(mc);this.f7b(dd)&&(gb&&gb.id===dd.outlineNode.id||(ya=!gb,gb=dd.outlineNode,Q=this.YBl(gb)),dd.Ufb?(ya=!1,Q=dd.top):this.hTb&&ya||!(dd.top>Q)||(this.bOi(dd),Ci.a.gv(this.Ax.LAb(dd)),Ob=!0))}Ob&&this.lTf()}bOi(Q){this.qt.contains(Q)&&(this.hTb&&this.KY.pqn(Q),this.qt.remove(Q))}f7b(Q){return Q?(Q=this.Ax.LAb(Q))&&Q.offsetParent?!0:!1:(la.ULS.sendTraceTag(38385035,324,50,"PageEndMarker is null in IsPageEndMarkerRendered."),
!1)}pvk(){let Q=!1;for(let ya=this.oTa.count-1;0<=ya;ya--)this.oTa.J(ya).hasChildNodes()&&(this.oTa.removeAt(ya),Q=!0);return Q}nCm(Q){(Q=this.wOh(Q.paragraphNode))&&(this.wpd.contains(Q.id)||this.wpd.add(Q.id))}Blf(){this.Jm&&this.Jm.Se(23).lp(this.DJf)}Hpk(Q){for(let ya=this.qt.count-1;0<=ya;ya--){const gb=this.qt.J(ya);this.f7b(gb)&&this.Gpk(gb,Q)}}Gpk(Q,ya){const gb=this.mjh(Q),Ob=this.Qpk(Q);Q.Ufb?(Q.O_c(gb),Q.o_i(Ob)):(ya=ya?gb-Q.top:Ob-Q.W_m,Q.O_c(gb-ya),Q.o_i(Ob-ya),1<Math.abs(ya)&&this.TNn(this.Ax.LAb(Q),
ya))}rgf(Q){if(!Q)return null;Q=Q.Ce(this.jf.Tb);return Q?Q.htmlElement:(la.ULS.sendTraceTag(37782401,336,50,"outlineNodeHtmlViewElement is null in GetOutlineNodeTop."),null)}HVh(Q){return Q?(Q=Q.Ce(this.jf.Tb))?Q.htmlElement:null:null}wOh(Q){Q=jn.GraphIterator.$a(Q);return Q.Bb(23)?Q.kd(23):null}XBl(Q){if(!Q)return null;Q=Q.Ce(this.jf.Tb);return Q?ra.a.getElementBounds(Q.htmlElement):(la.ULS.sendTraceTag(37888197,336,50,"outlineNodeHtmlViewElement is null in GetOutlineNodeBounds."),null)}YBl(Q){return(Q=
this.XBl(Q))?Q.height/this.Mm.vj:0}TNn(Q,ya){ya=(Ci.a.Iql(Q)-ya)*this.Mm.vj;this.eTb.add(Object.assign(new vs,{pf:Q,wti:ya}))}Twk(){this.qt=new ia.a;this.mub=new nb.a}}Object(e.a)(Fq,"PageEndMarkerPositionUpdater",null,[1761]);var Qq=d(387),xn=d(38),Un=d(878),Gq=d(372),Jn=d(23);class Vn{constructor(Q,ya,gb,Ob,mc,dd,Md=!1,He=!1,Ue=!1,Sf=!1,of=!1){this.b$f(ya,gb,Ob,mc,dd,Ue,of);this.position=Q;this.yj=ya;this.paragraphNode=gb;this.gU=Ob;this.Iib=mc;this.outlineNode=dd;this.x_a=Md;this.qii=He;this.H$l=
Ue;this.caa=Sf;this.Gsf=of}i7d(Q){this.yj=Q}b$f(Q,ya,gb,Ob,mc,dd,Md){Md||(la.ULS.shipAssertTag(38326881,336,!!mc,"PageEndDetails: outlineNode parameter value is null."),la.ULS.shipAssertTag(24126528,336,0<=Q,"PageEndDetails: pageNumber parameter value {0} is unexpected value.",Q),la.ULS.shipAssertTag(24126529,336,!!ya||dd,"PageEndDetails: paragraphNode parameter is null for a page that is not client-only."),la.ULS.shipAssertTag(24126530,336,!!gb||dd,"PageEndDetails: pageEnd parameter is null for a page that is not client-only."),
la.ULS.shipAssertTag(24126531,336,!!Ob||dd,"PageEndDetails: pageEndDomElement parameter is null for a page that is not client-only."))}static BKk(Q,ya){return Vn.u_e(0,Q,null,ya,!0,!1)}static CKk(Q){return Vn.u_e(0,0,null,Q,!1,!0)}static u_e(Q,ya,gb,Ob,mc,dd){return new Vn(Q,ya,null,null,gb,Ob,mc,dd,!0)}static l_b(Q,ya){return new Vn(0,Q,null,ya,null,null,void 0,void 0,void 0,void 0,!0)}}Object(e.a)(Vn,"PageEndDetails",null,[]);class Hh{constructor(Q,ya,gb,Ob,mc,dd,Md,He,Ue,Sf,of,cj,el,qk,jm,Qk,Kn,
yj,Mg,aq,as){this.pqa=!0;this.Fle=0;this.Thd=this.Fre=this.Gre=this.Hne=this.JBe=this.pre=!1;this.Xjd=this.Usb=null;this.Wue=!0;this.gGb=()=>{this.hUd()};this.JGf=()=>{this.Gre=!1};this.KGf=()=>{this.Fre=this.Gre=!0};this.VUm=(zj,Rm)=>{1>=Math.abs(Rm.delta)||(this.Hne=!0,this.Vhj(!Rm.oti))};this.ojn=zj=>{zj===this.Usb&&(this.Usb=null);if(this.pqa){var Rm=zj.customData;if(zj=this.pTa.get(Rm.id))for(this.pTa.Z(Rm.id,new ia.a),la.ULS.sendTraceTag(6558539,336,50,"PageEndMarkers: Redraw page ends for Outline Group [Count: {0}] [Outline group: {1}]",
zj.count,Rm.id),this.I8&&this.I8.Eza(),Rm=0;Rm<zj.count;Rm++){const Lq=zj.J(Rm),Cl=Lq.gU;Cl.HardBreak||(Ci.a.gv(Lq.Iib),this.ZSf(Cl))}}};this.njn=()=>{this.Xjd=null;this.pqa&&this.$fa&&0<this.$fa.count&&(la.ULS.sendTraceTag(6579856,336,50,"PageEndMarkers: Redraw all page ends in the document"),this.I3c(this.$fa.toArray(),this.pqa))};this.MH=Q;this.Bi=ya;this.I8=gb;this.aN=Ob;this.KUg=mc;this.O8a=dd;Hh.Ax=He;this.gGg=Ue;this.OH=Sf;this.Hb=of;this.YEj=cj;this.le=qk;this.KY=Qk;this.NBe=Kn;this.kTb=yj;
this.pY=Mg;this.JSb=new Qq.a;this.fTb=new ia.a;this.$fa=new ia.a;this.pTa=new Qq.a;this.KM=el;this.GY=as;this.LZd=this.LZd.bind(this);this.NZd=this.NZd.bind(this);this.Y2d=this.Y2d.bind(this);this.taa=this.taa.bind(this);this.KM.grd(this.gGb);this.KBe=!1;this.LUg=aq;jm&&(jm.K$g(this.KGf),jm.ird(this.JGf));Md&&Md.T7j(this.VUm);this.GY.kvb(this.taa)}get xsf(){return this.Wue}get jf(){return this.MH.value}get Ui(){return this.Bi.value}I3c(Q,ya){const gb=this.le.hg("Task","UpdateMarkers");this.m3n();
this.pqa=ya;Hh.Ax.XMi();this.JSb=new Qq.a;this.fTb.clear();this.$fa.clear();this.pTa=new Qq.a;this.Wue=this.pre=!1;this.aN&&this.aN.I3c(Q);this.h3k();this.Fle=Q.length;this.KY&&this.KY.reset(Q);this.I8&&this.I8.Eza();for(let Ob of Q)this.$fa.add(Ob),this.ZSf(Ob);ya&&this.aN&&this.NBe&&this.NBe.isEnabled&&(Q=this.aN.yJc(),this.NBe.TVa(Q));this.LBk();this.Hne=this.JBe=!1;this.Fre=this.Gre;Si.WoncaApp.instance.cfb&&Hh.smf&&this.aN.W8f();this.O8a.Dko(this.aN.yJc(),this.$fa.count);this.Wue=!0;this.pY.L8f();
gb.stop();la.ULS.sendTraceTag(25048922,336,50,"UpdateMarkers stopwatch stopped: {0}",{["DurationInMs"]:gb.oi,["RenderedLineCount"]:this.Fle,["AvgDurationPerPageInMs"]:gb.oi/this.PVh()})}SVh(){const Q=this.aN.yJc();if(!Q)return null;const ya=Ci.a.l2(),gb=new ia.a;for(let Ob of Q)this.zhm(Ob,ya)&&gb.add(Ob);return gb}zhm(Q,ya){if(!Q)return!1;Q=Hh.Ax.LAb(Q);if(!Q)return!1;Q=ra.a.eLa(Q);return 0<=Q&&Q<=ya}zLh(){const Q=new ia.a;if(!this.pTa)return la.ULS.sendTraceTag(35005382,336,10,"_outlineGroupsWithPageEndDetails is null in PageEndMarkers.GetAbsolutePageEndMarkerPositions."),
Q;const ya=this.pTa.keys;for(let mc=0;mc<ya.length;mc++){var gb=ya.J(mc);if(gb=this.pTa.J(gb))for(let dd=0;dd<gb.count;dd++){var Ob=gb.J(dd);Ob.gU.HardBreak||Ob.Iib.classList.contains("Hidden")||(Ob=ra.a.eLa(Ob.Iib),Q.add(Ob))}}return Q}m3n(){const Q=this.zLh(),ya=this.SVh();this.KUg.O2f(Q,ya);this.kTb&&this.kTb.isEnabled&&this.kTb.O2f(ya)}LBk(){if(!(25<this.PVh())){var Q=this.zLh(),ya=this.SVh();this.KUg.MBk(Q,ya,this.LUg,this.JBe,this.pre,this.Hne,this.Fre);this.kTb&&this.kTb.isEnabled&&this.kTb.TVa(ya)}}taa(){this.I8.oqn();
this.dzh()}dzh(){this.Thd&&(this.jf.xrn(this.LZd),this.jf.fsn(this.NZd),this.jf.Nrn(this.Y2d),this.Thd=!1)}h3k(){this.Thd||(this.jf.f$g(this.LZd),this.jf.A8j(this.NZd),this.jf.E$g(this.Y2d),this.Thd=!0)}ZSf(Q){if(this.KBe)return!0;Q=this.ktn(Q);if(!Q)return!1;this.KY&&this.KY.RTl(Q);this.aN&&(this.aN.u4j(Q),this.O8a.Rhj(this.aN.yJc()),Si.WoncaApp.instance.cfb&&Hh.smf&&this.aN.W8f());return!0}ktn(Q){let ya=this.q$(Q.ParaId);if(!ya)return null;if(!ya.anchor||!ya.Qi)return this.x9g(Q,ya),null;let gb,
Ob;if(Q.HardBreak){var mc=nf.ParagraphReader.Vg(ya,!0,!0,!0);this.I1m(mc)&&(ya=mc);if(!({Zfa:mc,outlineGroupNode:gb,Hib:Ob}=this.bco(Q,ya)).returnValue)return null;this.pre=!0}else if(!({HZd:mc,outlineGroupNode:gb,Hib:Ob}=this.ltn(Q,ya)).returnValue)return null;return this.Qqd(ya,Q,mc,gb,Ob)}I1m(Q){return Q?(Q=Q.Ce(this.jf.Tb))?!!Hh.Ax.dHd(Q.htmlElement):!1:!1}ltn(Q,ya){var gb=Q.PageEndType;let Ob,mc=0,dd=null;if(!gb){if(!({Zfa:Q,lKf:Ob}=this.TVh(Q,ya)).returnValue)return{returnValue:!1,HZd:mc,outlineGroupNode:dd,
Hib:null}}else if(!({Zfa:Q,fae:Ob}=this.rCl(Q,ya)).returnValue)return{returnValue:!1,HZd:mc,outlineGroupNode:dd,Hib:null};var Md=jn.GraphIterator.$a(ya);Md.vd();dd=Md.kd(23);ya=dd.Ce(this.jf.Tb).getBounds();Md=Md.dPa().Ce(this.jf.Tb);if(!Md)return la.ULS.sendTraceTag(50997218,314,50,"outlineGroupViewElement is null for ViewId: {0}.",this.jf.Tb),{returnValue:!1,HZd:mc,outlineGroupNode:dd,Hib:null};const He=Md.getBounds();mc=Q-ya.y;gb=Hh.Ax.SPh(gb,mc,this.pqa,Ob,ya,He);Md.U9.appendChild(gb);return{returnValue:!0,
HZd:mc,outlineGroupNode:dd,Hib:gb}}bco(Q,ya){let gb=null;const Ob=ya.Ce(this.jf.Tb);var mc=0;let dd=null;if(this.VQd(Q,Ob,ya))return{returnValue:!1,Zfa:mc,outlineGroupNode:gb,Hib:dd};gb=Hh.Usi(ya);const Md=gb.Ce(this.jf.Tb);if(!Md)return la.ULS.sendTraceTag(50446550,314,15,"outlineGroupViewElement is null for ViewId: {0}.",this.jf.Tb),{returnValue:!1,Zfa:mc,outlineGroupNode:gb,Hib:dd};mc=Md.getBounds();mc=Yo.a.rq(Ob,Q.CP).y-mc.y;dd=this.Wtl(ya);return{returnValue:!0,Zfa:mc,outlineGroupNode:gb,Hib:dd}}Wtl(Q){return Q.Ce(this.jf.Tb).htmlElement}q$(Q){const ya=
this.OH.Vdb(Q);if(ya!==Gf.a.nil){const gb=this.Ui.Eb(ya);if(gb)return gb}la.ULS.sendTraceTag(6398172,336,10,"PageEndMarkers: Cannot find graph node for para Id {0} objectId {1}",Q,ya);return null}TVh(Q,ya){const gb=Q.CP;let Ob=0,mc=null;const dd=ya.Ce(this.jf.Tb);if(this.VQd(Q,dd,ya))return{returnValue:!1,Zfa:Ob,lKf:mc};mc=dd.getBounds();Ob=gb?this.gGg(Object(va.a)(86,dd),gb):mc.y-this.YEj(dd);return{returnValue:!0,Zfa:Ob,lKf:mc}}rCl(Q,ya){let gb=null,Ob=0;var mc=Q.PageEndType;let dd=jn.GraphIterator.$a(ya);
dd.vd();if(!xn.TableReader.Yw(dd))return la.ULS.sendTraceTag(6398173,336,50,"PageEndMarkers: Para {0} has moved out from inside the table, treating as normal paragraph.",Q.ParaId),{returnValue:({Zfa:Ob,lKf:gb}=this.TVh(Q,ya)).returnValue,Zfa:Ob,fae:gb};if(1===mc){Jn.returnToContainingRow(dd);mc=dd.currentNode.Ce(this.jf.Tb);if(this.VQd(Q,mc,ya))return{returnValue:!1,Zfa:Ob,fae:gb};Ob=mc.getBounds().y}else{mc=ya.Ce(this.jf.Tb);if(this.VQd(Q,mc,ya))return{returnValue:!1,Zfa:Ob,fae:gb};Ob=this.gGg(Object(va.a)(86,
mc),Q.CP)}--Ob;ya=null;do Q=ya,ya=dd.kd(14);while(ya);dd=jn.GraphIterator.$a(Q);dd.vd();Jn.moveToFirstRow(dd);gb=dd.currentNode.Ce(this.jf.Tb).getBounds();return{returnValue:!0,Zfa:Ob,fae:gb}}VQd(Q,ya,gb){if(!ya||ya.GNa(16))return this.x9g(Q,gb),!0;ya=ya.getBounds();return ya.width||ya.height?!1:(this.O8g(Q),!0)}O8g(Q){this.fTb.contains(Q)||this.fTb.add(Q)}x9g(Q,ya){ya=ya.id;let gb;({value:gb}=this.JSb.Dc(ya)).returnValue||(gb=new ia.a,this.JSb.Z(ya,gb));gb.add(Q)}LZd(){const Q=new ia.a;for(let ya=
this.fTb.count-1;0<=ya;ya--){const gb=this.fTb.J(ya);this.ZSf(gb)||Q.add(gb)}this.fTb=Q;this.DWe()}DWe(){this.aN&&this.aN.DWe()&&this.Vhj(!1)}Vhj(Q){this.aN&&(this.aN.Spk(Q)&&(this.JBe=!0),this.LUg&&this.aN.iyn(),this.O8a.Rhj(this.aN.yJc()),Si.WoncaApp.instance.cfb&&Hh.smf&&this.aN.W8f())}NZd(Q,ya){try{const gb=ya.id;if(this.JSb.xb(gb)){const Ob=this.JSb.J(gb);for(Q=0;Q<Ob.count;Q++)this.O8g(Ob.J(Q));this.JSb.remove(gb)}}catch(gb){}}hUd(){this.pqa&&(this.pqa=!1,Hh.Ax.hUd())}gUd(){this.pqa||(this.pqa=
!0,Hh.Ax.gUd())}aYn(){this.KBe=!1;this.$fa&&this.I3c(this.$fa.toArray(),this.pqa);this.I8&&this.I8.e5i()}fYl(){this.KBe=!0;Hh.Ax.XMi();this.I8&&this.I8.f5h();this.KY&&this.KY.gYl()}Qqd(Q,ya,gb,Ob,mc){const dd=this.$fa.indexOf(ya)+1;if(0>dd)return null;const Md=Ii.WordSectionNavigator.instance.$L(Q),He=this.caa(ya,Q);Q=new Vn(gb,dd,Q,ya,mc,Md,!Q||!ya||!mc,!1,!1,He);this.pTa.xb(Ob.id)||this.pTa.Z(Ob.id,new ia.a);this.pTa.J(Ob.id).add(Q);return Q}caa(Q,ya){if(!Q||!Q.HardBreak)return!1;Q=jn.GraphIterator.$a(ya);
Q.Bb(7);if(Q.bH())return!1;Q.kd(23);return Q.bH()?!1:!0}oLi(Q){this.pqa&&(Q.anchor&&Q.Qi?!(Q=Hh.Usi(Q))||this.Usb&&this.Usb.customData&&this.Usb.customData.id===Q.id||(this.Usb=Object.assign(new dc.a(3,1,500,this.ojn),{customData:Q}),this.Hb.$b(this.Usb)):la.ULS.sendTraceTag(6607198,336,10,"PageEndMarkers: Invalid node while redrawing page ends for outline group"))}Y2d(){this.pqa&&!this.Xjd&&this.$fa&&0<this.$fa.count&&(this.Xjd=new dc.a(3,1,500,this.njn),this.Hb.$b(this.Xjd))}dispose(){this.jf&&
this.dzh();this.GY.ISf(this.taa);this.KM.JSf(this.gGb)}static get smf(){null==Hh.Hse&&(Hh.Hse=H.AFrameworkApplication.K.$("ImageOverflowUpdateHeightIsEnabled"));return Hh.Hse}static Stl(Q){let ya=0;try{const gb=Q.htmlElement,Ob=Ci.a.eM(gb.firstChild.style.marginTop);Q=0;const mc=Hh.Vgf(gb.parentNode);if(mc){const dd=mc.firstChild;dd&&dd.classList.contains("ParaWrappingDiv")&&(Q=Ci.a.eM(dd.firstChild.style.marginBottom))}ya=Math.max(Ob,Q)/2}catch(gb){}return ya}static Vgf(Q){let ya=Q.previousSibling;
if(!ya){var gb=Q.parentNode;Ci.a.Nrf(gb)&&(gb=gb.parentNode)&&(ya=gb.previousSibling)}if(!ya&&(Q=Q.parentNode,Q.classList.contains(Un.a.eCi)||la.ULS.sendTraceTag(19711369,314,15,"Expected OutlineGroup but encountered a {0} element with classname {1}.",Q.tagName,Q.className),(Q=Q.previousSibling)&&Q.hasChildNodes())){ya=Q.lastChild;do{if(ya.classList.contains("OutlineElement")||Ci.a.Nrf(ya)&&ya.classList.contains(Gq.a.P8b))break;ya=ya.previousSibling}while(ya)}if(ya){if(ya.classList.contains(Gq.a.P8b))return ya.lastChild.lastChild;
if(Ci.a.Nrf(ya))return ya.lastChild}return ya}static Usi(Q){Q=jn.GraphIterator.$a(Q);return Q.Bb(23)?Q.kd(23):null}PVh(){return this.Fle+1}}Hh.Ax=null;Hh.Hse=null;Object(e.a)(Hh,"PageEndMarkers",null,[1757,1758,9]);var Rq=d(114);class yn{constructor(Q,ya,gb){this.U_m=".Outline";this.MH=Q;this.Mm=ya;this.Ax=gb}get jf(){const Q=this.MH.value;la.ULS.shipAssertTag(38416594,336,Q.wi,"Invalid PageView.");return Q}u2b(Q){return(Q=Q.outlineNode)?this.FVh(Q):(la.ULS.shipAssertTag(38336522,336,!0,"Error getting last Outline DOM."),
null)}FVh(Q){let ya,gb;return(ya=Q.Ce(this.jf.Tb))&&(gb=ya.htmlElement)?gb.querySelector(this.U_m):(la.ULS.shipAssertTag(39662425,336,!0,"Error getting last Outline DOM."),null)}vOh(Q){Q=pq.OutlineElementNavigator.Uk(Q.paragraphNode);let ya;return Q&&(ya=Q.Ce(this.jf.Tb))?ya.htmlElement:(la.ULS.shipAssertTag(38336525,336,!0,"Error calculating containing OE DOM."),null)}bjh(Q,ya){const gb=this.rPl(Q);return this.Mpk(Q,ya)-gb}MPh(Q){return this.LVh(Q.outlineNode,Q.yj)}LVh(Q,ya){if(!Q)return-1;var gb=
Q.ia(lk.a.ay,-1);gb=wn.a.Pi(gb,1);var Ob=Q.ia(lk.a.marginTop,-1);Ob=wn.a.Pi(Ob,1);Q=Q.ia(lk.a.marginBottom,-1);Q=wn.a.Pi(Q,1);return 1===ya?gb-Q:gb-(Ob+Q)}$Sk(Q){Q&&Ci.a.gv(Q.Iib)}Pgf(Q){if(Q.qii||Q.caa)return 0;if(Q.x_a)return Q=this.u2b(Q),ra.a.getElementBounds(Q).height/this.Mm.vj;const ya=this.u2b(Q);return this.Ax.dVe(this.RVh(Q),ya)}oIk(Q,ya,gb){gb=gb.Ce(this.jf.Tb).getBounds();Q=Q.Ce(this.jf.Tb);const Ob=Q.getBounds();gb.y=Ob.y;ya=this.Ax.SPh(0,ya*this.Mm.vj,!1,gb,gb,Ob);Q.U9.appendChild(ya);
return ya}q9h(Q,ya){if(Q&&!Q.Gsf)if(Q.x_a){if(Q=this.u2b(Q))Q.style.paddingBottom=ya+"px"}else if(Q.gU&&Q.gU.HardBreak)if(Q.caa){if(Q=this.eXh(Q))Q.style.paddingBottom=ya+"px"}else{if(Q=this.vOh(Q))Q.style.paddingTop=ya+"px"}else la.ULS.shipAssertTag(39077394,336,!1,"Applying blank space on a page which is not hard break or last page.")}Aah(Q,ya){ya=this.u2b(ya);Q=this.u2b(Q);return ra.a.eLa(ya)-ra.a.eLa(Q)}fXh(Q){Q=jn.GraphIterator.$a(Q.outlineNode);Q.Bb(7);return Q.bH()}xfi(Q){if(!Q||Q.Gsf)return!1;
if(Q.x_a||Q.qii)return!0;Q=this.RVh(Q);return!!Q&&Ci.a.X9(Q)}wQ(Q){this.Ax.wQ(Q)}eXh(Q){return(Q=this.fXh(Q))?(Q=Q.Ni(this.jf.Tb).htmlElement,Q?Q:(la.ULS.shipAssertTag(39126080,336,!0,"Section dom is null."),null)):null}RVh(Q){return Q.gU&&Q.gU.HardBreak&&!Q.caa?this.Ax.dHd(Q.Iib):Q.Iib}rPl(Q){if(Q.x_a){Q=this.u2b(Q);if(!Q)return la.ULS.shipAssertTag(38336528,336,!0,"Last outline dom is null."),-1;Q=Rq.a.IB(Q);return Ci.a.Hea(Q.paddingBottom)}if(Q.gU&&Q.gU.HardBreak){if(Q.caa)return(Q=this.eXh(Q))?
Ci.a.Hea(Q.style.paddingBottom):-1;Q=this.vOh(Q);return Q?Ci.a.Hea(Q.style.paddingTop):(la.ULS.shipAssertTag(38336529,336,!0,"Containing outline element Dom is null."),-1)}return 0}Mpk(Q,ya){return this.Pgf(Q)-ya}}Object(e.a)(yn,"PageFullHeightDOMHelper",null,[]);class Ip{constructor(){this.delta=this.wlj=this.YB=0;this.Yfa=null;this.NKa=this.kGi=0;this.outlineGroupNode=null;this.Iza=0;this.rof=new ia.a;this.gzd=new ia.a;this.kLm=new ia.a}}Object(e.a)(Ip,"PageFullHeightInfo",null,[]);class Io{constructor(Q,
ya){this.Zxa=Q;this.Bx=ya}kjh(Q,ya){try{return this.Jpk(Q,ya)}catch(gb){return this.Bx.wQ(gb.message+" "+gb.stack),la.ULS.sendTraceTag(38416595,336,10,"Exception caught in CalculatePageFullHeightInfo. Exception: {0}",gb.message),null}}Jpk(Q,ya){la.ULS.shipAssertTag(38416596,336,Q.x_a||Q.gU.HardBreak);const gb=this.Bx.Pgf(Q),Ob=this.Bx.bjh(Q,ya),mc=this.Zxa.Zih(Q,Ob);Q=Object.assign(new Ip,{Iza:Ob,NKa:mc,Yfa:Q});this.sjo(Q);Q.wlj=Q.NKa-Q.Iza;Q.delta=ya+mc+Q.delta-gb;return Q}sjo(Q){Q.Iza>Q.NKa?this.tjo(Q):
0>Q.Iza&&this.A8f(Q)}A8f(Q){let ya=Q.Yfa.yj;for(;0>Q.Iza;)Q.YB--,Q.delta-=this.Zxa.bIc(ya),Q.Iza+=this.Zxa.bIc(ya-1),ya--;Q.NKa=this.Zxa.bIc(ya)}tjo(Q){const ya=this.Bx.MPh(Q.Yfa);Q.YB=Math.floor((Q.Iza-Q.NKa)/ya)+1;Q.delta=Q.YB*ya;Q.Iza-=Q.NKa+(Q.YB-1)*ya;Q.NKa=ya}}Object(e.a)(Io,"PageFullHeightInfoCalculator",null,[]);class Hq{constructor(Q,ya,gb,Ob){this.NUa=0;this.cJa=null;this.Zxa=Q;this.asb=ya;this.RV=gb;this.Bx=Ob;this.SXg=new ia.a}get FX(){return this.SXg}RTl(Q){try{this.ikf(Q)}catch(ya){this.Bx.wQ(ya.message+
" "+ya.stack),la.ULS.sendTraceTag(38148114,336,10,"Exception caught in HandlePageFullHeight. Exception: {0}",ya.message)}}reset(Q){try{this.ywn(Q)}catch(ya){this.Bx.wQ(ya.message+" "+ya.stack),la.ULS.sendTraceTag(38637723,336,10,"Exception caught in PageFullHeightManager.Reset. Exception: {0}",ya.message)}}gYl(){try{this.hYl()}catch(Q){this.Bx.wQ(Q.message+" "+Q.stack),la.ULS.sendTraceTag(39153856,336,10,"Exception caught in PageFullHeightManager.HidePageFullHeights. Exception: {0}",Q.message)}}d6l(Q){try{this.e6l(Q)}catch(ya){this.Bx.wQ(ya.message+
" "+ya.stack),la.ULS.sendTraceTag(38916954,336,10,"Exception caught in PageFullHeightManager.InsertOrDeleteRenderedPages. Exception: {0}",ya.message)}}pqn(Q){try{this.qqn(Q)}catch(ya){this.Bx.wQ("Pagination: "+ya.message+" "+ya.stack),la.ULS.sendTraceTag(39387716,336,10,"Exception caught in PageFullHeightManager.RemovePageEndDetails. Exception: {0}",ya.message)}}b3l(){var Q=this.RV.Zdf(),ya=this.RV.nTh();Q=Vn.CKk(Q);ya=Vn.BKk(this.NUa,ya);this.FX.Z(0,Q);this.ikf(ya)}Cwn(){var Q=Ii.WordSectionNavigator.instance.nTh();
(Q=this.Bx.FVh(Q).parentNode)&&""!==Q.style.minHeight&&(Q.style.minHeight="")}Y3l(Q){this.SXg=new ia.a;this.FX.add(null);for(let ya=0;ya<Q.length;ya++){const gb=Vn.l_b(ya+1,Q[ya]);this.FX.add(gb)}this.FX.add(Vn.l_b(Q.length+1,null))}J3l(Q){this.Zxa.Jwn(Q)}gxn(){if(this.FX)for(let Q of this.FX)Q&&this.pdi(Q)&&this.Bx.q9h(Q,0)}ikf(Q){const ya=this.TEl(Q);if(this.Bx.xfi(ya)){let gb=this.Bx.Pgf(ya);Q.outlineNode!==ya.outlineNode&&(gb+=this.Bx.Aah(Q,ya));this.Sok(Q,gb);this.pdi(Q)&&this.$Sf(Q,gb)}else this.cJa.add(Q),
20<this.cJa.count&&la.ULS.sendTraceTag(39982428,336,15,"Count of _waitingForPreviousPage is "+this.cJa.count);this.FX.Z(Q.yj,Q);this.JTl(Q)}hYl(){this.gxn()}ywn(Q){this.NUa=Q.length+1;this.cJa=new ia.a;this.Y3l(Q);this.J3l(this.NUa);this.b3l();this.Cwn()}e6l(Q){this.Zxa.Gko(Q);for(let ya of Q){if(!ya){la.ULS.sendTraceTag(38916955,336,10,"info is null.");return}if(0<ya.YB){Q=ya.Yfa.yj;for(let gb of ya.rof)this.FX.insert(Q,gb),Q++}else if(0>ya.YB)for(let gb of ya.gzd)this.FX.remove(gb),this.cJa.contains(gb)&&
this.cJa.remove(gb)}this.bQi()}qqn(Q){Q=Q.yj;this.Zxa.rqn(Q);this.FX.removeAt(Q);for(let ya of this.cJa)ya.yj===Q&&this.cJa.remove(ya);this.bQi()}Sok(Q,ya){ya=this.Bx.bjh(Q,ya);this.Zxa.Zih(Q,ya)}$Sf(Q,ya){Q.gU&&Q.gU.HardBreak||this.asb.$Sf(Q,ya)}JTl(Q){Q=Q.yj+1;for(let ya of this.cJa)if(ya&&ya.yj===Q){this.ikf(ya);this.cJa.remove(ya);break}}bQi(){for(let Q=0;Q<this.FX.count;Q++){const ya=this.FX.J(Q);ya&&ya.i7d(Q)}}pdi(Q){Q=this.jCl(Q);return 2===Q||1===Q}TEl(Q){return this.FX.J(Q.yj-1)}jCl(Q){return Q.x_a?
2:Q.gU&&Q.gU.HardBreak?1:0}}Object(e.a)(Hq,"PageFullHeightManager",null,[1770]);class Vp{constructor(Q,ya,gb,Ob){this.asb=Q;this.Zxa=ya;this.RV=gb;this.Bx=Ob}create(){return new Hq(this.Zxa,this.asb,this.RV,this.Bx)}}Object(e.a)(Vp,"PageFullHeightManagerFactory",null,[]);var Zo=d(1064),gr=d(597);class $m{constructor(Q,ya,gb,Ob,mc){this.gTb=null;this.KY=Q;this.aN=ya;this.$sc=gb;this.asb=Ob;this.Bx=mc}reset(){this.gTb=new ia.a}Ipk(Q,ya,gb){try{return this.Kpk(Q,ya,gb)}catch(Ob){return la.ULS.sendTraceTag(38897350,
336,10,"Exception caught in PageFullHeightPositionUpdater.CalculatePageFullHeight. Exception: {0}",Ob.message),null}}fyn(){try{this.gyn()}catch(Q){la.ULS.sendTraceTag(38897351,336,10,"Exception caught in PageFullHeightPositionUpdater.RestorePageFullHeights. Exception: {0}",Q.message)}}Kpk(Q,ya,gb){if(!this.KY.FX.count)return null;const Ob=this.pCl(Q,!Q);if(!Ob||Ob.Gsf)return la.ULS.sendTraceTag(38897352,336,10,"PageEndDetail is null for the given PageEndMarker"),null;if(Ob.gU&&Ob.gU.HardBreak)return null;
var mc=this.KY.FX.J(Ob.yj-1);return this.Bx.xfi(mc)&&(ya-=gb,Ob.outlineNode!==mc.outlineNode&&(ya+=this.Bx.Aah(Ob,mc)),(mc=this.$sc.kjh(Ob,ya))&&1<Math.abs(mc.delta))?(mc.kGi=ya,mc.outlineGroupNode=this.WBl(Q,Ob),this.gTb.add(mc),this.A8f(mc),mc):null}WBl(Q,ya){return ya&&ya.x_a?(Q=Object(va.a)(gr.a,nf.ParagraphReader.ZJ(ya.outlineNode)),Q=jn.GraphIterator.$a(Q),Q.qo(),Object(va.a)(Zo.a,Q.kd(23))):Q&&Q.Ufb?Q.outlineGroupNode:null}gyn(){this.gTb.Sc((Q,ya)=>ya.Yfa.yj-Q.Yfa.yj);for(let Q of this.gTb)this.asb.JPi(Q);
this.Jko()}Jko(){this.aN.value.b6l(this.gTb);this.KY.d6l(this.gTb)}pCl(Q,ya){return ya?this.KY.FX.J(this.KY.FX.count-1):this.KY.FX.J(Q.yj)}A8f(Q){let ya=Q.Yfa.yj;const gb=-Q.YB;for(let Ob=0;Ob<gb;Ob++)ya--,Q.gzd.add(this.KY.FX.J(ya))}}Object(e.a)($m,"PageFullHeightPositionUpdater",null,[1769]);class gp{constructor(Q,ya,gb,Ob,mc){this.KY=Q;this.aN=ya;this.$sc=gb;this.asb=Ob;this.Bx=mc}create(){return new $m(this.KY,this.aN,this.$sc,this.asb,this.Bx)}}Object(e.a)(gp,"PageFullHeightPositionUpdaterFactory",
null,[]);class Iq{constructor(Q,ya){this.Bx=Q;this.$sc=ya}$Sf(Q,ya){try{this.otn(Q,ya)}catch(gb){this.Bx.wQ(gb.message+" "+gb.stack),la.ULS.sendTraceTag(38285912,336,10,"Exception caught in RenderPageFullHeight. Exception: {0}",gb.message)}}JPi(Q){try{this.ntn(Q)}catch(ya){this.Bx.wQ(ya.message+" "+ya.stack),la.ULS.sendTraceTag(38855577,336,10,"Exception caught in RenderPageFullHeightInfo. Exception: {0}",ya.message)}}otn(Q,ya){la.ULS.shipAssertTag(38285913,336,Q.x_a||Q.gU.HardBreak);Q=this.$sc.kjh(Q,
ya);this.JPi(Q)}ntn(Q){this.mtn(Q);this.etn(Q)}etn(Q){0<Q.YB?this.n6l(Q):0>Q.YB&&this.aTk(Q)}mtn(Q){this.Bx.q9h(Q.Yfa,Q.wlj)}n6l(Q){let ya=Q.kGi+Q.NKa;for(let Ob=0;Ob<Q.YB;Ob++){var gb=Q.Yfa.yj+Ob;const mc=Q.Yfa.caa?this.Bx.fXh(Q.Yfa):Q.Yfa.outlineNode;gb=this.nIk(mc,Q.outlineGroupNode,ya,gb);Q.rof.add(gb);Q.kLm.add(ya);ya+=Q.NKa}}aTk(Q){for(let ya of Q.gzd)this.Bx.$Sk(ya)}nIk(Q,ya,gb,Ob){ya=this.Bx.oIk(Q,gb,ya);return Vn.u_e(gb,Ob,ya,Q,!1,!1)}}Object(e.a)(Iq,"PageFullHeightRenderer",null,[]);class Wm{constructor(Q){this.QPf=
Q}}Object(e.a)(Wm,"PageHeightDeltaResult",null,[1768]);class Jp{constructor(Q,ya,gb){this.Tp=null;this.Bx=Q;this.Ih=ya;gb.execute(Ob=>{Ob.register(this)})}get eSc(){return"PageHeightDelta"}get result(){return this.Tp}get cEf(){return 1}get bWf(){return 500}get isEnabled(){return!0}iEf(){this.Tp=null}TVa(Q){this.Ih.Pd(()=>{try{this.bAc(Q)}catch(ya){la.ULS.sendTraceTag(39188045,324,10,"Exception caught in PageHeightDeltaMetric.Calculate. Exception: {0}",ya.message)}},"PHDM:C")}bAc(Q){this.Tp=null;Q=
this.cAc(Q);-1!==Q&&(this.Tp=new Wm(Q))}cAc(Q){if(!Q.count)return-1;let ya=0,gb=0;for(let Ob of Q)Q=this.Lpk(Ob),-1!==Q&&(ya+=Q,gb++);return gb?ya/gb:-1}Lpk(Q){if(!Q.Ecm)return-1;const ya=this.Bx.LVh(Q.$sd,Q.yj);return-1===ya?-1:Math.abs(Q.height-ya)}}Object(e.a)(Jp,"PageHeightDeltaMetric",null,[1750]);class ln{constructor(Q){this.hSa=null;this.Bx=Q}bIc(Q){return this.hSa.J(Q-1)}Jwn(Q){this.hSa=new ia.a;for(let ya=0;ya<Q;ya++)this.hSa.add(-1)}Zih(Q,ya){if(this.Ahm(Q))return this.hSa.J(Q.yj-1);ya=
this.ipk(Q,ya);this.n3n(Q,ya);return ya}Gko(Q){for(let ya of Q)this.Fko(ya)}n3n(Q,ya){this.hSa.Z(Q.yj-1,ya)}rqn(Q){this.hSa.removeAt(Q-1)}Fko(Q){if(Q)if(0<Q.YB){var ya=Q.Yfa.yj;for(var gb=0;gb<Q.YB;gb++)this.hSa.insert(ya,Q.NKa)}else if(0>Q.YB)for(ya=-Q.YB,Q=Q.Yfa.yj-ya,gb=0;gb<ya;gb++)this.hSa.removeAt(Q)}Ahm(Q){return-1!==this.hSa.J(Q.yj-1)}ipk(Q,ya){if(Q.x_a||Q.gU.HardBreak)Q=this.Bx.MPh(Q),ya=ya<Q?Q:ya;return ya}}Object(e.a)(ln,"PageHeightStorage",null,[]);var mn=d(120);class an{constructor(Q){this.QPf=
Q}}Object(e.a)(an,"PageLevelDeltaResult",null,[1768]);class Ro{constructor(Q,ya,gb,Ob){this.Tp=null;this.MH=Q;this.Sqa=ya;this.Ih=gb;Ob.execute(mc=>{mc.register(this)})}get jf(){const Q=this.MH.value;la.ULS.shipAssertTag(39081438,336,Q.wi,"PageLevelDeltaMetric.PageView is not a PageView.");return Q}get eSc(){return"PageLevelDelta"}get result(){return this.Tp}get cEf(){return 0}get bWf(){return 60}get isEnabled(){return!0}iEf(){this.Tp=null}TVa(Q){this.Ih.Pd(()=>{try{this.bAc(Q)}catch(ya){la.ULS.sendTraceTag(39081440,
324,10,"Exception caught in PageLevelDeltaMetric.Calculate. Exception: {0}",ya.message)}},"PLDM:C")}bAc(Q){this.Tp=null;Q=this.cAc(Q);-1!==Q&&(this.Tp=new an(Q))}cAc(Q){if(!Q.count)return-1;let ya=0,gb=0;for(let Ob of Q)Q=this.Npk(Ob),-1!==Q&&(ya+=Q,gb++);return gb?ya/gb:-1}Npk(Q){if(Q.Ufb)return-1;var ya=Q.gU.CP;Q=Q.paragraphNode;la.ULS.shipAssertTag(39081441,336,!!Q);Q=Q.Ce(this.jf.Tb);la.ULS.shipAssertTag(39081442,324,Object(mn.a)(86,Q));let gb;({ysh:ya,Nki:Q,fTi:gb}=this.ypk(Q,Ci.a.Lz(Q.htmlElement).length,
ya));return Q&&gb?Math.min(ya.x-Q.x,gb.x-ya.x):(la.ULS.sendTraceTag(39081443,336,50,"There was a problem calculating the line boundaries in PageLevelDeltaMetric.CalculatePageLevelDelta."),-1)}ypk(Q,ya,gb){let Ob,mc,dd,Md=mc=gb,He=dd=Ob=null;if(gb>ya)return la.ULS.sendTraceTag(39081472,336,50,"cp > paragraph text length in FidelityTelemetryManager.CalculatePageLevelDelta."),{ysh:He,Zqm:Md,Nki:dd,Qzn:mc,fTi:Ob};He=this.Sqa.rq(Q,gb);for(var Ue=0,Sf=gb;Ue<=Sf;){let of=Math.floor((Ue+Sf)/2),cj=this.Sqa.rq(Q,
of);if(Ue===Sf){Md=of;dd=cj;break}cj.y+cj.height<=He.y?Ue=of+1:Sf=of}for(;gb<=ya;){Ue=Math.ceil((gb+ya)/2);Sf=this.Sqa.rq(Q,Ue);if(gb===ya){mc=Ue;Ob=Sf;break}Sf.y>=He.y+He.height?ya=Ue-1:gb=Ue}return{ysh:He,Zqm:Md,Nki:dd,Qzn:mc,fTi:Ob}}}Object(e.a)(Ro,"PageLevelDeltaMetric",null,[1750]);class xp{constructor(Q,ya,gb,Ob,mc,dd,Md){this.yj=Q;this.top=ya;this.q6g=gb;this.height=Ob;this.ALb=mc;this.$sd=dd;this.Ecm=Md}}Object(e.a)(xp,"Page",null,[]);class Xl{constructor(Q,ya,gb,Ob,mc){this.ZSb=null;this.h2g=
0;this.MH=Q;this.$9c=ya;this.JUg=gb;this.eIa=Ob;this.MUg=mc;this.rTa=new ia.a}get jf(){const Q=this.MH.value;la.ULS.shipAssertTag(37007393,336,Q.wi,"PageManager.PageView is not a PageView.");return Q}get jm(){return this.rTa}Rhj(Q){Q=this.oKi(Q);this.Thj(Q)}Dko(Q,ya){this.h2g=ya;Q=this.oKi(Q);this.Thj(Q);this.MUg.isEnabled&&this.MUg.TVa(Q)}oKi(Q){this.rTa=new ia.a;this.ZSb=new Qq.a(0);const ya=new ia.a;if(!Q)return this.jm;var gb=0,Ob=null;for(let mc=0;mc<Q.count;mc++){const dd=Q.J(mc);gb=dd.yj;Ob=
this.Oxd(gb,Ob,dd);this.jm.add(Ob);!Xl.Mze&&0>Ob.height&&ya.add(Ob);Ob=dd}Q=this.Oxd(gb+1,Ob,null);this.jm.add(Q);!Xl.Mze&&0>Q.height&&ya.add(Q);for(let mc of ya)Xl.Mze=!0,la.ULS.shipAssertTag(50968670,336,!1,"Page: height parameter value is negative for page "+mc.yj);return this.jm}Oxd(Q,ya,gb){const Ob=ya?ya.outlineNode:this.eIa.VQh(),mc=gb?gb.outlineNode:this.eIa.xTh();var dd=this.MVh(Ob);const Md=this.MVh(mc),He=ya?this.ijh(ya):0;dd=He+dd;const Ue=gb?this.ijh(gb):this.$9c.j1a.clientHeight-Md;
return new xp(Q,He,dd,Ob.id===mc.id?Ue-He:Ue+Md-dd,Ob,mc,(gb?gb.yj:this.h2g+1)===(ya?ya.yj:0)+1)}ijh(Q){return Q.caa?0:Q.top}Thj(Q){if(this.JUg.GZd)for(let ya of this.JUg.GZd)ya&&ya.Uhj(Q)}MVh(Q){this.ZSb||(this.ZSb=new Qq.a(0));if(this.ZSb.xb(Q.id))return this.ZSb.J(Q.id);var ya=Q.Ce(this.jf.Tb);if(!ya)return la.ULS.sendTraceTag(37052758,336,15,"OutlineViewElement is null in PageManager.GetOutlineTop."),0;ya=ra.a.LYa(this.$9c.j1a,ya.htmlElement).y;this.ZSb.Z(Q.id,ya);return ya}}Xl.Mze=!1;Object(e.a)(Xl,
"PageManager",null,[1751]);var sl=d(635);class V{constructor(Q,ya,gb,Ob,mc,dd,Md){this.P9f=this.l1a=!1;this.ga=Q;this.c9=ya;this.FRa=gb;this.qt=Ob;this.zi=mc;this.OUg=dd;this.ND=Md;this.l1a=0===this.ND.Lw?!0:!1;this.hFf=this.hFf.bind(this);this.ND.h$g(this.hFf)}Vb(){this.ga.gb(Rf.a.GWc,Kh.a.application,this.GWc.bind(this),96);this.ga.gb(Rf.a.d2d,Kh.a.application,this.d2d.bind(this),96);this.ga.gb(Rf.a.ebe,Kh.a.application,this.ebe.bind(this),96);this.ga.gb(Rf.a.bbe,Kh.a.application,this.bbe.bind(this),
8)}ebe(Q,ya,gb){return 1===gb?32:this.ga.processAction(Rf.a.sQa,2)}bbe(Q,ya,gb,Ob){if(1===gb)return 0===this.ND.Lw?32:8;this.l1a?(this.Xzh(),this.P9f=!0):(this.mDh(),this.P9f=!1);this.zi.updateCommandUI();Ob.Lr=this.l1a?1:0;return 32}GWc(Q,ya,gb,Ob,mc){if(1===gb)return 32;Q=this.OUg.TJc();-1===Q?Q="":this.l1a||1===this.ND.Lw?(ya=this.OUg.Eol(),ya>Q&&(Q=ya),Q=String.format(WordEditorIntl.WordEditorStrings.l_CurrentPageAndCount,ya,Q)):Q=1===Q?String.format(WordEditorIntl.WordEditorStrings.l_TotalPageCountSingular,
Q):String.format(WordEditorIntl.WordEditorStrings.l_TotalPageCount,Q);mc[sl.a.Visible]=!0;mc[sl.a.LabelText]=Q;return 32}d2d(Q,ya,gb,Ob,mc){if(1===gb)return 32;mc[yl.a.On]=this.l1a;return 32}hFf(Q,ya){0!==ya.b$b||this.P9f?this.Xzh():this.mDh()}mDh(){this.l1a||(this.FRa.r1k(),this.qt.aYn(),this.l1a=!0)}Xzh(){this.l1a&&(this.FRa.yWk(),this.qt.fYl(),this.l1a=!1)}}Object(e.a)(V,"PaginationActor",null,[]);class ja{constructor(Q){this.QPf=Q}}Object(e.a)(ja,"PaginationDeltaResult",null,[1768]);class Oa{constructor(Q,
ya){this.wsb=this.ead=null;this.Ih=Q;ya.execute(gb=>{gb.register(this)})}get eSc(){return"PaginationDelta"}get result(){return this.ead}get cEf(){return 1}get bWf(){return 200}get isEnabled(){return!0}iEf(){this.ead=null}TVa(Q){this.Ih.Pd(()=>{try{this.bAc(Q)}catch(ya){la.ULS.sendTraceTag(39686615,324,10,"Exception caught in PaginationDeltaMetric.Calculate. Exception: {0}",ya.message)}},"PDM:C")}O2f(Q){this.wsb=Q}bAc(Q){this.ead=null;Q=this.cAc(this.wsb,Q);-1!==Q&&(this.ead=new ja(Q))}cAc(Q,ya){if(!(Q&&
ya&&Q.count&&ya.count))return-1;const gb=new ia.a;for(let Ob of Q)gb.add(Ob.top);Q=new ia.a;for(let Ob of ya)Q.add(Ob.top);ya=this.QCd(gb,Q);return this.DZb(ya)}DZb(Q){if(!Q.count)return 0;let ya=0;for(let gb=0;gb<Q.count;gb++)ya+=Q.J(gb);return ya/Q.count}QCd(Q,ya){const gb=new ia.a;if(!Q.count||!ya.count)return gb;var Ob=Q.count<=ya.count;const mc=Ob?Q:ya;Q=Ob?ya:Q;for(ya=0;ya<mc.count;ya++){Ob=mc.J(ya);let Md=Math.abs(Ob-Q.J(0)),He=0;for(let Ue=1;Ue<Q.count;Ue++){var dd=Q.J(Ue);dd=Math.abs(Ob-
dd);dd<Md&&(Md=dd,He=Ue)}gb.add(Md);Q.removeAt(He)}return gb}}Object(e.a)(Oa,"PaginationDeltaMetric",null,[1750]);var Nb=d(407),oc=d(1382),Oc=d(1912);class Fd extends Nb.a{constructor(Q,ya,gb,Ob,mc,dd,Md,He=null){super();this.WM=null;this.Ele=0;this.NUa=-1;this.Lpb=!1;this.U6=()=>{la.ULS.sendTraceTag(7422755,336,50,"PaginationReplicator: disabling replication as user kicked out");this.Zzh()};this.GGf=()=>{if(0==this.GY.Lw){var Ue=this.WM.eu;Gf.a.Fp(Ue,this.fSb)||(this.fSb=Ue,this.PTm(this.HHa,this.fSb))}};
this.GY=Q;this.taa=this.taa.bind(this);this.GY.kvb(this.taa);this.ga=ya;this.qt=gb;this.pY=Ob;this.Uia=mc;this.Hxe=He||Xo.a.instance;this.fSb=this.HHa=Gf.a.nil;this.QKj=Md;dd.CWR(()=>dd.result.ZA.qVa(this.U6));this.d0b();this.Wj=new oc.a(1E3);this.Wj.WWa();this.Uia.register(this)}get Mma(){return"Pagination"}get r0b(){return this.QKj.value}get Tpm(){return this.HHa}get Kbj(){return this.NUa}HQn(Q){this.NUa!==Q&&(this.NUa=Q,this.pY.L8f())}taa(){this.HHa=this.fSb=Gf.a.nil;this.d0b()}iib(Q){this.WM=
Q;this.WM.eXb(this.GGf);this.PWb(this.WM.node)}PTm(Q,ya){Gf.a.Fp(Q,ya)?(this.qt.gUd(),this.d0b()):(this.qt.hUd(),this.e2n())}y1k(){this.enabled=2}d0b(){this.enabled=0}e2n(){this.Ele=0;this.y1k();this.lE(null,null,null)}Fla(){return Ae.App.lostSession||Ae.App.ud.ZA.io?!1:!!(this.enabled&2)&&this.Wj.IW()}lE(){this.Wj.Ycb();this.Uia.oU()}forceOutbound(){}m2(){return 0===this.enabled?!1:this.he&&2===this.he.status?!0:this.Fla()}ROa(){if(1===this._state)this.he.Yr=Oc.a.I9(H.AFrameworkApplication.rootQuerySignature,
this.HHa),this.he.iH="Pagination",this.he.status=1,this._state=3;else if(3===this._state&&this.he&&2===this.he.status)if(H.AFrameworkApplication.Mk)this._state=4;else if(this.Wj.U_(),this.Wj.o6(),this._state=1,this.Ele++,2!==this.he.statusCode)this.e0b();else if(1!==(this.he.jk?this.he.jk.length:0))this.e0b();else{var Q=this.he.jk[0];this.Hxe.omb(Q);104===Q.StatusCode?this.Zzh():101===Q.StatusCode?this.e0b():3===Q.StatusCode?this.e0b():Q.StatusCode?this.e0b():Q.PageEnds?(this.HQn(Q.PageEnds.length+
1),this.HHa=Wi.b(Q.LastKnownPaginationRevision),la.ULS.sendTraceTag(7479449,336,50,"PaginationReplicator: Start rendering page ends on client after successful replication. [PageCount: {0}] for [Revision: {1}].",this.NUa,this.HHa),this.qt.I3c(Q.PageEnds,Gf.a.Fp(this.HHa,this.fSb)),this.r0b.$fa=Q.PageEnds,this.pY.$Ue(),la.ULS.sendTraceTag(5870302,336,50,"PaginationReplicator: Finished rendering page ends on client after successful replication. [PageCount: {0}] for [Revision: {1}].",this.NUa,this.HHa),
this.HWk()):this.e0b()}}Zzh(){this.WM&&this.WM.vIb(this.GGf);this.d0b()}e0b(){60<this.Ele&&this.d0b()}HWk(){Gf.a.Fp(this.HHa,this.fSb)&&this.d0b()}dispose(){this.WM&&(this.WM.vIb(this.GGf),this.WM.node&&this.LXc(this.WM.node),this.WM=null);this.GY.ISf(this.taa)}PWb(Q){Q&&(Q.addListener(this),this.Lpb=!0)}LXc(Q){this.Lpb&&Q&&(Q.removeListener(this),this.Lpb=!1)}qGb(Q){this.LXc(Q)}onBeforeLoadContent(){}onAfterLoadContent(Q){(Q=Q.zd.Om)&&this.PQm(this.HHa,Q.id)}onAfterFirstSaveContent(){}PQm(Q,ya){Gf.a.Fp(Q,
ya)&&this.qt.gUd()}}Object(e.a)(Fd,"PaginationReplicator",Nb.a,[1749,9,45]);class zd{constructor(){this.I8=this.qt=this.pY=this.FRa=this.Uu=null;this.fqa=!1;this.ybk=()=>{this.Abh()}}get name(){return"WordEditor.Pagination"}get qso(){return H.AFrameworkApplication.K.$("WordEditorPageEndMarkerPositionUpdaterIsEnabled")}yc(Q){this.W=Q;this.Ac=this.W.resolve("Box4.IFeatureHelper");this.W.ha("WordEditor.Pagination.PageElementManagerList",()=>new rm(this.W.resolve("WordEditor.Pagination.PageAdornmentManager"),
this.W.resolve("WordEditor.Pagination.CurrentPageCalculator"))).singleInstance();this.W.ha("WordEditor.Pagination.OutlineManager",()=>new uj(new jb.a(()=>Ae.App.xa.jb.Ic))).as("WordEditor.Pagination.IOutlineManager").singleInstance();this.W.ha("WordEditor.Pagination.PageManager",()=>new Xl(new jb.a(()=>Ae.App.xa.jb.Ic),this.W.resolve("WordEditor.Pagination.DocumentSizeManager"),this.W.resolve("WordEditor.Pagination.PageElementManagerList"),this.W.resolve("WordEditor.Pagination.OutlineManager"),this.W.resolve("WordEditor.Pagination.PageHeightDeltaMetric"))).as("WordEditor.Pagination.IPageManager").singleInstance();
this.W.ha("WordEditor.IPaginationReplicator",()=>new Fd(this.W.resolve("WordEditor.IMainViewModeManager"),H.AFrameworkApplication.ya,this.W.resolve("WordEditor.Pagination.IPageEndMarkers"),this.W.resolve("WordEditor.Pagination.CurrentPageCalculator"),ui.App.E_,Ae.App.Cla(),new jb.a(()=>this.W.resolve("WordEditor.TableOfContents.IDocumentHeadings")))).singleInstance();this.W.ha("WordEditor.ICurrentPageManager",()=>new Up(this.W.resolve("WordEditor.Pagination.CurrentPageCalculator"))).singleInstance();
this.W.ha("WordEditor.Pagination.PageLevelDeltaMetric",()=>new Ro(new jb.a(()=>Ae.App.xa.jb.Ic),this.W.resolve("Box4.ITextMetricsAdapter"),db.a.instance,this.W.Za("WordEditor.FidelityMetrics.IFidelityMetricManager"))).singleInstance();this.W.ha("WordEditor.Pagination.PageHeightDeltaMetric",()=>new Jp(this.W.resolve("WordEditor.Pagination.PageFullHeightDOMHelper"),db.a.instance,this.W.Za("WordEditor.FidelityMetrics.IFidelityMetricManager"))).singleInstance();this.W.ha("WordEditor.Pagination.PaginationDeltaMetric",
()=>new Oa(db.a.instance,this.W.Za("WordEditor.FidelityMetrics.IFidelityMetricManager"))).singleInstance();this.W.ha("WordEditor.Pagination.PageHeightStorage",()=>new ln(this.W.resolve("WordEditor.Pagination.PageFullHeightDOMHelper"))).singleInstance();this.W.ha("WordEditor.Pagination.PageFullHeightDOMHelper",()=>new yn(new jb.a(()=>Ae.App.xa.jb.Ic),this.W.resolve("Common.IZoomManager"),this.W.resolve("WordEditor.Pagination.PageEndDOMHelper"))).singleInstance();this.W.ha("WordEditor.Pagination.PageFullHeightInfoCalculator",
()=>new Io(this.W.resolve("WordEditor.Pagination.PageHeightStorage"),this.W.resolve("WordEditor.Pagination.PageFullHeightDOMHelper"))).singleInstance();this.W.ha("WordEditor.Pagination.PageFullHeightRenderer",()=>new Iq(this.W.resolve("WordEditor.Pagination.PageFullHeightDOMHelper"),this.W.resolve("WordEditor.Pagination.PageFullHeightInfoCalculator"))).singleInstance();this.W.ha("WordEditor.Pagination.PageFullHeightPositionUpdaterFactory",()=>new gp(this.W.resolve("WordEditor.Pagination.PageFullHeightManager"),
this.W.ef("WordEditor.Pagination.PageEndMarkerPositionUpdater"),this.W.resolve("WordEditor.Pagination.PageFullHeightInfoCalculator"),this.W.resolve("WordEditor.Pagination.PageFullHeightRenderer"),this.W.resolve("WordEditor.Pagination.PageFullHeightDOMHelper"))).singleInstance();this.W.ha("WordEditor.Pagination.PageFullHeightPositionUpdater",()=>this.W.resolve("WordEditor.Pagination.PageFullHeightPositionUpdaterFactory").create()).singleInstance();this.W.ha("WordEditor.Pagination.PageEndMarkerPositionUpdater",
()=>new Fq(new jb.a(()=>Ae.App.xa.jb.Ic),this.W.resolve("Common.IZoomManager"),this.W.resolve("WordEditor.Pagination.OutlineManager"),this.W.resolve("WordEditor.Pagination.PageEndDOMHelper"),this.W.resolve("WordEditor.Pagination.PageFullHeightPositionUpdater"),this.W.resolve("WordEditor.Pagination.PageFullHeightManager"),Ae.App.Xj.al)).as("WordEditor.Pagination.IPageEndMarkerPositionUpdater").singleInstance();this.W.ha("WordEditor.Pagination.PageFullHeightManagerFactory",()=>new Vp(this.W.resolve("WordEditor.Pagination.PageFullHeightRenderer"),
this.W.resolve("WordEditor.Pagination.PageHeightStorage"),Ii.WordSectionNavigator.instance,this.W.resolve("WordEditor.Pagination.PageFullHeightDOMHelper"))).singleInstance();this.W.ha("WordEditor.Pagination.PageFullHeightManager",()=>this.W.resolve("WordEditor.Pagination.PageFullHeightManagerFactory").create()).singleInstance();this.W.ha("WordEditor.Pagination.PageEndMarkerPositionComparer",()=>new Ho(this.W.resolve("Common.IZoomManager"),db.a.instance)).as("WordEditor.Pagination.IPageEndMarkerPositionComparer").singleInstance();
this.W.ha("WordEditor.Pagination.PaginationActor",()=>new V(H.AFrameworkApplication.ya,this.W.resolve("WordEditor.IStatusBarUser"),this.W.resolve("WordEditor.ICurrentPageManager"),this.W.resolve("WordEditor.Pagination.IPageEndMarkers"),H.AFrameworkApplication.ua,this.W.resolve("WordEditor.IPageNumberFinder"),this.W.resolve("WordEditor.IMainViewModeManager"))).singleInstance();this.W.ha("WordEditor.Pagination.DocumentSizeManager",()=>new go(new jb.a(()=>Ae.App.xa.jb.Ic),Qo.a.get_instance(),this.W.resolve("WordEditor.IMainViewModeManager"))).singleInstance();
this.W.ha("WordEditor.Pagination.CurrentPageCalculator",()=>new Eq(H.AFrameworkApplication.ya,mf.a.instance,fg.a.instance,this.W.resolve("WordEditor.Pagination.DocumentSizeManager"),new jb.a(()=>Ae.App.xa.jb.Ic),this.W.Pa("Box4.CpConversionManagerImpl"),this.W.resolve("WordEditor.IStatusBarUser"))).as("Common.ICurrentPageCalculator").singleInstance();this.W.ha("WordEditor.Pagination.PageEndMarkers",()=>this.qt=new Hh(new jb.a(()=>Ae.App.xa.jb.Ic),new jb.a(()=>Ae.App.xa.jb.Yc.zd),this.W.resolve("WordEditor.Pagination.IPageAdornmentManager"),
this.W.resolve("WordEditor.Pagination.IPageEndMarkerPositionUpdater"),this.W.resolve("WordEditor.Pagination.IPageEndMarkerPositionComparer"),this.W.resolve("WordEditor.Pagination.IPageManager"),this.W.resolve("WordEditor.Pagination.DocumentSizeManager"),this.W.resolve("WordEditor.Pagination.PageEndDOMHelper"),Yo.a.cJc,this.W.resolve("WordEditor.ParagraphWordIdMapping"),fg.a.instance,Hh.Stl,this.W.resolve("Box4.ContentEditableViewEventSource"),new qq.a,this.W.resolve("WordEditor.HeaderFooter.IHeaderFooterControlOwnerEvent"),
this.W.resolve("WordEditor.Pagination.PageFullHeightManager"),null,this.W.resolve("WordEditor.Pagination.PaginationDeltaMetric"),this.W.resolve("Common.ICurrentPageCalculator"),this.qso,this.W.resolve("WordEditor.IMainViewModeManager"))).as("WordEditor.Pagination.IPageEndMarkers").as("Box4.IPaginationRefreshHelper").singleInstance();this.W.ha("WordEditor.Pagination.PageEndDOMHelper",()=>new fk(this.W.Za("Common.IZoomManager"),this.W.resolve("WordEditor.PageBackground.PageBackgroundColorHandler"),
!!Ae.App.instance&&Ae.App.instance.JA)).singleInstance();this.W.ha("WordEditor.Pagination.PageAdornmentAnimationManager",()=>new ki(H.AFrameworkApplication.uc)).as("WordEditor.Pagination.IPageAdornmentAnimationManager").singleInstance();this.W.ha("WordEditor.Pagination.PageAdornmentContentManager",()=>new Tn(this.W.resolve("WordEditor.HeaderFooter.HeaderFooterReader"))).as("WordEditor.Pagination.IPageAdornmentContentManager").singleInstance();this.W.ha("WordEditor.Pagination.PageAdornmentManager",
()=>this.I8=new kl(new jb.a(()=>Ae.App.xa.jb.Ic),ql.a.instance,dh.a.instance,Je.a.instance,H.AFrameworkApplication.ya,Pj.a.instance,this.W.resolve("WordEditor.Pagination.IPageAdornmentAnimationManager"),this.W.resolve("WordEditor.Pagination.IPageAdornmentContentManager"),this.W.resolve("WordEditor.HeaderFooter.IHeaderFooterControlOwnerEvent"),fg.a.instance,H.AFrameworkApplication.K,!!Ae.App.instance&&Ae.App.instance.JA,!!Ae.App.instance&&Ae.App.instance.gma)).as("WordEditor.Pagination.IPageAdornmentManager").singleInstance()}init(){this.Ac.Yk.continueWith(()=>
{this.Tm()})}Tm(){const Q=Ae.App.xa.jb;Q.Ata?this.Abh():Q.hda(this.ybk)}Abh(){this.fqa||(this.fqa=!0,this.FRa=qa.a.instance.resolve("WordEditor.ICurrentPageManager"),this.pY=qa.a.instance.resolve("Common.ICurrentPageCalculator"),this.Uu=qa.a.instance.resolve("WordEditor.IPaginationReplicator"),qa.a.instance.resolve("WordEditor.Pagination.PaginationActor").Vb())}dispose(){this.I8&&(this.I8.dispose(),this.I8=null);this.qt&&(this.qt.dispose(),this.qt=null);this.Uu&&(this.Uu.dispose(),this.Uu=null);this.pY&&
(this.pY.disable(),this.pY=null);this.FRa&&(this.FRa=null)}}Object(e.a)(zd,"PackageManager",null,[1,2]);class Re{constructor(){this.W=null}yc(Q){this.W=Q||qa.a.instance}dispose(){}}Object(e.a)(Re,"TellMePackage",null,[1,2]);var dg=d(1471),ih=d(1474),Dg=d(282),Mf=d(1470),$g=d(1370);class eh{constructor(Q=null,ya=null,gb=null,Ob,mc=null){this.ohe=null;this.mug=!1;this.wEg=this.NNb=null;this.jVj=this.g0g=this.bwj=this.xEg=!1;this.M8c=null;this.rwj=null==ya?H.AFrameworkApplication.Jvb:ya;this.JHj=null==
gb?H.AFrameworkApplication.EZ:gb;this.SVj=null==mc?H.AFrameworkApplication.g3a:mc;this.nGj=!!H.AFrameworkApplication.K&&H.AFrameworkApplication.K.$("TellMeHelpOnHelpIsEnabled");this.DXj=!!H.AFrameworkApplication.K&&H.AFrameworkApplication.K.$("TellMeCommandHookIsEnabled");this.FQn(!!H.AFrameworkApplication.K&&H.AFrameworkApplication.K.$("TellMeIgnoreQueryForHelp"));this.uXj=!!H.AFrameworkApplication.ua&&H.AFrameworkApplication.ua.Sb.APc;this.vXj=!Mf.a.S$()&&!!H.AFrameworkApplication.K&&H.AFrameworkApplication.K.$("TellMePeopleSuggestionIsEnabled");
this.tXj=!!H.AFrameworkApplication.K&&H.AFrameworkApplication.K.$("TellMeFileSuggestionIsEnabled");this.kDj=!!H.AFrameworkApplication.ua&&H.AFrameworkApplication.ua.Sb.iKb;this.wXj=!!H.AFrameworkApplication.K&&H.AFrameworkApplication.K.$("TellMeSeeMoreButtonIsEnabledInZeroTerm");this.MUj=!!H.AFrameworkApplication.K&&H.AFrameworkApplication.K.$("HelpShowsTopSearchResult");this.cPj=this.k0c||this.j0c;this.aPj=!!H.AFrameworkApplication.K&&H.AFrameworkApplication.K.$("OnlineCommandSuggestionsIsEnabled");
this.bPj=this.bsf;this.UJj=!!H.AFrameworkApplication.K&&this.jQa&&H.AFrameworkApplication.K.$("StyledHeaderInLabelIsEnabled");this.PEj=H.AFrameworkApplication.K?H.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.SharedOnline.TellMeServiceFastSetRequestTimeOut",1400):1400;this.vFj=H.AFrameworkApplication.K?H.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.SharedOnline.TellMeServiceSlowSetRequestTimeOut",1400):1400;this.DEj=H.AFrameworkApplication.K?parseFloat(H.AFrameworkApplication.K.getStringFeatureGate("Microsoft.Office.SharedOnline.ClassifierHighConfidenceThreshold",
"-0.6")):-.6;this.RJj=!!H.AFrameworkApplication.K&&(H.AFrameworkApplication.K.$("SmartLookupNoteSearchIsEnabled")||H.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupNoteSearchIsEnabled",!1));this.CWj=H.AFrameworkApplication.K?H.AFrameworkApplication.K.getStringFeatureGate("Microsoft.Office.SharedOnline.SubstrateSearchEndpointUrl","https://substrate.office.com/search/api/v1/suggestions"):"https://substrate.office.com/search/api/v1/suggestions";this.zFj=H.AFrameworkApplication.K?
H.AFrameworkApplication.K.getStringFeatureGate("Microsoft.Office.SharedOnline.SubstrateUrlParameters",""):"";this.NUj=!!H.AFrameworkApplication.K&&H.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.ShouldHideQueryInResults",!1);this.DVj=!!H.AFrameworkApplication.K&&H.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.SimplifiedGroupingExpEnabled",!1);this.fVj=!!H.AFrameworkApplication.K&&H.AFrameworkApplication.K.$("ShowFindInDocumentInZeroTermSearchBox")||
this.VQ;this.dKj=!!H.AFrameworkApplication.K&&(H.AFrameworkApplication.K.$("TellMeTemplateProviderIsEnabled")||H.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.TemplateProviderEnabled",!1));this.qJj=!!H.AFrameworkApplication.K&&H.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.TellMe.OfficeScriptsSamplesProvidersEnabled",!1);this.KJj=!!H.AFrameworkApplication.K&&H.AFrameworkApplication.K.$("TellMeIsRuleBasedSortingEnabled")&&"en-US"===
H.AFrameworkApplication.uiCulture;this.aKj=!!H.AFrameworkApplication.K&&(H.AFrameworkApplication.K.$("TellMeFeedbackProviderIsEnabled")||H.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.FeedbackProviderEnabled",!1));this.oKj=!!H.AFrameworkApplication.K&&H.AFrameworkApplication.K.$("TellMeZeroTermContextualCommandSuggestionsEnabled");this.dwj=this.jQa&&!!H.AFrameworkApplication.K&&H.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.UseBoldedSuggestedSearchesStrings",
!1);this.XFj=!!H.AFrameworkApplication.K&&H.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.GroupReduxActionUpdates",!1);this.JVj=!!H.AFrameworkApplication.K&&(H.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.SkipFindCount",!1)||"Word"!==H.AFrameworkApplication.K.lb("Application"));this.Exj=!!H.AFrameworkApplication.K&&H.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.BreakIssueQueryIntoTasks",
!1);this.nZj=!!H.AFrameworkApplication.K&&(H.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.UsePerformanceMarker",!1)||H.AFrameworkApplication.K.$("TellMePerformanceMarkerEnabled"));this.eIj=!!H.AFrameworkApplication.K&&H.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinProviderEnabled",!1);this.iIj=!!H.AFrameworkApplication.K&&H.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinStoreLinkEnabled",
!1);this.LJj=!!H.AFrameworkApplication.K&&H.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinSearchDescriptionEnabled",!1);this.DTj=!!H.AFrameworkApplication.K&&H.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SearchAddinByKeywords",!1);this.jvj=!!H.AFrameworkApplication.K&&H.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinSearchKeywordsContainDescription",!1);this.uFj=H.AFrameworkApplication.K?
H.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.SharedOnline.TellMe.MenuUpdatePolicy",0):0;this.cKj=!!H.AFrameworkApplication.K&&H.AFrameworkApplication.K.$("TellMeNotesSuggestionIsEnabled")||this.Plm;this.gIj=!!H.AFrameworkApplication.K&&H.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinSearchStoreEntryButtonText1Enabled",!1);this.hIj=!!H.AFrameworkApplication.K&&H.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinSearchStoreEntryButtonText2Enabled",
!1);this.fIj=!!H.AFrameworkApplication.K&&H.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinSearchIntegratedTellMeServiceEnabled",!1);this.xXj=this.gii&&(this.iJf||this.jJf||this.aUc||this.jQa&&Mf.a.xCa()&&!!H.AFrameworkApplication.K&&(this.Dec||this.mKb||this.nKb||this.oKb||this.qKb||H.AFrameworkApplication.K.$("ShowAnswerSearchResults")||H.AFrameworkApplication.K.$("ShowDefinitionSearchResults")||H.AFrameworkApplication.K.$("ShowEntitySearchResults")||H.AFrameworkApplication.K.$("ShowWolframSearchResults")));
this.kvj=!!H.AFrameworkApplication.K&&!H.AFrameworkApplication.K.$("AppsForOfficeThirdPartyIsDisabled")&&H.AFrameworkApplication.K.$("AppsForOfficeAllowExternalMarketplace")&&H.AFrameworkApplication.Fvb;this.lvj=!!H.AFrameworkApplication.K&&H.AFrameworkApplication.K.$("AppsForOfficePrivateCatalogIsEnabled");this.L2l(Q||{});this.eGe="2918242107";this.dGe="1454393937";this.jsb={};this.o$a=[];this.gFk=[Mf.a.Vbe]}get application(){return this.NNb}get Jvb(){return this.rwj}get oDn(){return this.eGe}get nDn(){return this.dGe}get j9e(){return this.wEg}get HHh(){return this.xEg}get EZ(){return this.JHj}get g3a(){return this.SVj}get Cvb(){return this.bwj}get OXl(){return this.nGj}get y7n(){return this.DXj}get gii(){return!0}get o7n(){return this.xXj}get BTn(){return this.g0g}FQn(Q){this.g0g=
Q}get jQa(){return this.uXj}get $1c(){return this.vXj}get Y1c(){return this.tXj}get N7k(){return this.kDj}get m7n(){return this.wXj}get Abe(){return!1}get aUc(){return this.cPj}get iJf(){return this.aPj}get jJf(){return this.bPj}get L_a(){return!1}get AQd(){return!1}get Ltf(){return this.UJj}get r8d(){return this.jVj}get Dec(){return!1}get WUn(){return!1}get Yqm(){return""}get Aff(){return 2}get JFl(){return 4}get KFl(){return 5}get TYh(){return""}get yrl(){return this.PEj}get jZh(){return this.vFj}get VYh(){return 1E3}get UYh(){return 1E-6}get V3n(){return this.CWj}get k3f(){return!1}get k9i(){return!1}get Hjm(){return this.KJj}get lQd(){return!1}get mQd(){return!1}get Mei(){return!1}get Lei(){return!1}get Plm(){return!1}get hii(){return!1}get ECd(){return!1}get Kkb(){return!1}get mKb(){return!1}get nKb(){return!1}get oKb(){return!1}get qKb(){return!1}get k0c(){return this.MUj}get yec(){return this.NUj}get j0c(){return!1}get Mcf(){return null}get gQd(){return!1}get j8d(){return this.fVj}get jVh(){return 0}get yll(){return this.DEj}get OZh(){return this.zFj}get Kkm(){return this.RJj}get Rzl(){return-3.9}get VQ(){return this.DVj}get BPc(){return this.dKj}get lsf(){return this.qJj}get buf(){return this.aKj}get dab(){return this.dwj}get Onm(){return this.oKj}get qBa(){return this.XFj}get f6i(){return this.JVj}get Yjk(){return this.Exj}get ude(){return this.nZj}get uNd(){return this.eIj}get f9l(){return this.iIj}get Sjm(){return this.LJj}get AVi(){return this.DTj}get E9j(){return this.jvj}get Kv(){return this.uFj}get Bgb(){return this.cKj}get d9l(){return this.gIj}get e9l(){return this.hIj}get c9l(){return this.fIj}get F9j(){return this.kvj}get G9j(){return this.lvj}get HDb(){return!!H.AFrameworkApplication.ua&&
H.AFrameworkApplication.ua.Sb.fq}get fq(){return!!H.AFrameworkApplication.ua&&H.AFrameworkApplication.ua.Sb.fq}get tgm(){return!!H.AFrameworkApplication.ua&&H.AFrameworkApplication.ua.Sb.Bec}get FLm(){return Le.getImageClass("OfficeAssistant_32x32x32")}GFd(){return Promise.reject("GetFindMatchCount method is not overridden")}PQd(Q){return Array.contains(appChrome.selectors.getVisibleControlIds(),Q)}eOd(){return!1}get uPd(){return!!H.AFrameworkApplication.K&&H.AFrameworkApplication.K.$("TellMeModelRankerEnabled")}get aaj(){return H.AFrameworkApplication.K?
H.AFrameworkApplication.K.lb("TellMeServiceHelpClassifierModelName"):""}get bsf(){return!!H.AFrameworkApplication.K&&H.AFrameworkApplication.K.$("TellMeMultiLingualCommandModelEnabled")}get FBb(){return"NoOpHeaderUi"}get $Ek(){return this.M8c}get parameterData(){return this.jsb}get Sco(){return this.o$a}K3k(){if(this.ohe&&!this.mug&&(this.mug=!0,this.Akb(this.ohe),this.fq)){var Q=qa.a.instance.resolve("Common.IExternalUICommandDefinitionMapping");Q=(new $g.a(Q)).eEd(this.ohe.eG);appChrome.api.dispatch(Q)}}get iWf(){return""}Akb(){}qVk(Q){const ya=
[];for(let gb=0;gb<Q.length;++gb)Q[gb].SVn?ya.push(new Dg.a(Q[gb].alternate,Mf.a.hej+gb.toString())):ya.push(new Dg.a(Q[gb].standard,Mf.a.Vbe+gb.toString()));return ya}L2l(Q){const ya={};for(let gb in Q){const Ob=gb,mc=Q[gb];for(let dd in mc){const Md=dd,He=mc[dd];(ya[Md]||(ya[Md]={}))[Ob]=He}}this.M8c=ya}get caj(){return""}get baj(){return""}get b5i(){return!1}}Object(e.a)(eh,"TellMeApplicationData",null,[1070]);class Qj{constructor(Q,ya=null,gb=!1){this.standard=Q;this.alternate=ya;this.SVn=gb}}
Object(e.a)(Qj,"TryQuerySet",null,[]);class ij{constructor(){this.gRg=this.hRg=null}get nJm(){return this.gRg}Qda(Q){this.hRg=Q;return this.p0e(Q)}GMm(){this.gRg=this.hRg}uGd(Q){return 8===Q.type?String.format(CommonUIStrings.l_FindInDocumentText,Q.$B):Q.$B}jcf(Q){return Q.$B}}Object(e.a)(ij,"ParameterizedCommand",null,[]);class bn extends ij{constructor(Q){super();this.pPc=Q}get commandId(){return this.pPc?"DefinitionsParameterized":"DefinitionButton"}get xKf(){return"Definition"}p0e(Q){const ya=
Tb.a.If(String.format(WordEditorIntl.WordEditorStrings.L_TellMeButtonLabel_DefinitionsParam,Q.$B));return Dd.a(Mf.a.g1e(Q.value),Ra.a.N2e.toString(),ya,Mf.a.tof,null,Tb.a.If(Mf.a.Axb(Q.$B)),ya,null,null)}uGd(Q){return String.format(WordEditorIntl.WordEditorStrings.L_TellMeButtonLabel_DefinitionsParam,Q.$B)}jcf(Q){return Mf.a.Axb(Q.$B)}}Object(e.a)(bn,"DefinitionsParameterizedCommand",ij,[]);class Yl extends ij{constructor(Q){super();this.pPc=Q}get commandId(){return this.pPc?H.AFrameworkApplication.ua.Sb.Ucm?
"FindWithMatchesParameterized":"FindParameterized":"EditingFind"}get xKf(){return"Find"}p0e(Q){const ya=Tb.a.If(String.format(WordEditorIntl.WordEditorStrings.L_ParamFindInDocTitle,Q.$B));return Dd.a(Mf.a.g1e(Q.value),Ra.a.findInDocument.toString(),ya,"Find_16x16x32",null,Tb.a.If(Q.$B),ya,null,null)}uGd(Q){return String.format(CommonUIStrings.l_TextWithQuotation,Q.$B)}}Object(e.a)(Yl,"FindParameterizedCommand",ij,[]);class tm extends ij{constructor(Q){super();this.pPc=Q}get commandId(){return this.pPc?
"SynonymsParameterized":"SynonymButton"}get xKf(){return"Synonym"}p0e(Q){const ya=Tb.a.If(String.format(WordEditorIntl.WordEditorStrings.L_TellMeButtonLabel_SynonymsParam,Q.$B));return Dd.a(Mf.a.g1e(Q.value),Ra.a.N2e.toString(),ya,Mf.a.tof,null,Tb.a.If(Mf.a.Axb(Q.$B)),ya,null,null)}uGd(Q){return String.format(WordEditorIntl.WordEditorStrings.L_TellMeButtonLabel_DefinitionsParam,Q.$B)}jcf(Q){return Mf.a.Axb(Q.$B)}}Object(e.a)(tm,"SynonymsParameterizedCommand",ij,[]);var zn=d(1921),um=d(1842),Xk=d(1941),
ro=d(1916),qi=d(1917),cn=d(1547);class Rg extends zn.a{constructor(){super(...arguments);this.bS=null;this.JUa=um.FindManager.createInstance(this,Xk.a.instance,cn.a.instance,!0,!0)}static get instance(){return Rg._instance}w1b(){this.bS(this.JUa.Ej.lha);this.JUa.VVa(!0)}GFd(Q){const ya=new Promise((gb,Ob)=>{this.bS=gb;setTimeout(()=>{Ob("Find manager execution timed out");this.JUa.VVa(!0)},500)});Q=ro.a.createQuery(Q,qi.a.none);this.JUa.find(Q);return ya}}Rg._instance=new Rg;Object(e.a)(Rg,"TellMeFindStatusSpy",
zn.a,[]);class An extends eh{constructor(Q){super({});this.NNb="Word";this.bFj=Q;H.AFrameworkApplication.K.$("TellMeFindInDocumentIsEnabled")&&(this.xEg=!0,this.wEg=this.ECd?"FindWithMatchesParameterized":"FindParameterized");Q=new bn(this.HDb);const ya=new tm(this.HDb);this.parameterData[Q.commandId]=Q;this.parameterData[ya.commandId]=ya;H.AFrameworkApplication.K.$("WordEditorTellMeParameterizedFindIsEnabled")&&(Q=new Yl(this.HDb),this.parameterData[Q.commandId]=Q);H.AFrameworkApplication.K.$("TellMeTryQueriesIsEnabled")&&
(Q=[new Qj(WordEditorIntl.WordEditorStrings.L_TellMeTryQuery01,"",!1),new Qj(WordEditorIntl.WordEditorStrings.L_TellMeTryQuery02,"",!1),new Qj(WordEditorIntl.WordEditorStrings.L_TellMeTryQuery03,"",!1),new Qj(WordEditorIntl.WordEditorStrings.L_TellMeTryQuery04,"",!1),new Qj(WordEditorIntl.WordEditorStrings.L_TellMeTryQuery05,"",!1)],this.o$a=this.qVk(Q))}GFd(Q){return Rg.instance.GFd(Q)}get l2a(){return qm.AppFrame.Jna}get FBb(){return qm.AppFrame.ULa}get iWf(){return"Microsoft.Office.Web.SessionSettings.IWacWordSharedHeaderSearchBoxSettings"}Akb(Q){var ya=
H.AFrameworkApplication.K;Q=Q.eG;Q.WordCountFlyout=!this.bFj();Q.SelectAllButton=!ya.$("TellMeSelectAllResultIsEnabled");const gb=ya.$("TellMeDesktopUpSellIsEnabled");let Ob=H.AFrameworkApplication.Rlm;appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("TryOfficeUpsell",!Ob));Ob=!1;Q.TextBoxUpSellButton=!gb||Ob;Q.TableOfContentsUpSellButton=!gb||Ob;Q.SmartArtUpSellButton=!gb||Ob;Q.WordArtUpSellButton=!gb||Ob;Q.MultiColumnLayoutUpSellButton=!gb||Ob;Q.InsertEquationUpSellButton=!gb||
Ob;Q.TrackChangesUpSellButton=!gb||Ob;Q.ShapesUpSellButton=!gb||Ob;Q.LabelsUpSellButton=!gb||Ob;Q.InsertCitationUpSellButton=!gb||Ob;Q.TextBoxUpSellButtonEnterprise=!gb||!Ob;Q.TableOfContentsUpSellButtonEnterprise=!gb||!Ob;Q.SmartArtUpSellButtonEnterprise=!gb||!Ob;Q.WordArtUpSellButtonEnterprise=!gb||!Ob;Q.MultiColumnLayoutUpSellButtonEnterprise=!gb||!Ob;Q.InsertEquationUpSellButtonEnterprise=!gb||!Ob;Q.TrackChangesUpSellButtonEnterprise=!gb||!Ob;Q.ShapesUpSellButtonEnterprise=!gb||!Ob;Q.LabelsUpSellButtonEnterprise=
!gb||!Ob;Q.InsertCitationUpSellButtonEnterprise=!gb||!Ob;ya=!ya.$("WordEditorTellMeDefinitionsAndSynonymsIsEnabled")||!H.AFrameworkApplication.EZ;Q.SynonymButton=ya;Q.DefinitionButton=ya}get caj(){return H.AFrameworkApplication.K.getStringFeatureGate("Microsoft.Office.WordOnline.TellMeZeroTermModelName","")}get baj(){return H.AFrameworkApplication.K.getStringFeatureGate("Microsoft.Office.WordOnline.TellMeMultiLanguageModelName","")}get k3f(){return H.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.TellMeServiceAADAuthIsEnabled",
!1)}get aaj(){return H.AFrameworkApplication.K.getStringFeatureGate("Microsoft.Office.WordOnline.TellMeHelpClassifierModelName","")}get Dec(){return H.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ShowImageSearchResults",!1)}get bsf(){return H.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.TellMeMLCModelIsEnabled",!1)}get Aff(){return H.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.WordOnline.TellMeMenuUpdatePolicy",0)}get b5i(){return H.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ShowMoreFileResults",
!1)}get AQd(){return H.AFrameworkApplication.K.$("TellMeRankerLoggingIsEnabled")&&H.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.EnableTellMeRankerLogging",!1)}get uPd(){return H.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.IsModelRankerEnabled",!1)}get lQd(){return H.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.TellMe.IsSerpletClassifierEnabled",!1)}get mQd(){return H.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.TellMe.IsSerpletClassifierSwapLogicEnabled",
!1)}get VYh(){return H.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.WordOnline.TellMe.GetServiceRankerTimeOut",1E3)}get UYh(){return 1E-6*H.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.WordOnline.TellMe.GetServiceRankerSuppressionScore",1)}get Mei(){return H.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.IsModelRankerSuppressionEnabled",!1)}get Lei(){return H.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.IsModelRankerSuppressionDebugEnabled",
!1)}get TYh(){return H.AFrameworkApplication.K.getStringFeatureGate("Microsoft.Office.WordOnline.TellMe.GetServiceRankerModelName","")}get hii(){return H.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.TellMeZeroTermNotesSuggestionIsEnabled",!1)}get jVh(){return H.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.WordOnline.NumberOfNotesSuggestionsToShow",2)}get gii(){return H.AFrameworkApplication.K.$("TellMeServiceForSearchIsEnabled")}get Abe(){return H.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.TellMeTrimAndShowOptimalResults",
!1)}get L_a(){return H.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.TellMeNoHeadingUIV2",!1)}get r8d(){return H.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.TellMeUseFeatureIcons",!1)}get k9i(){return H.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.SubstrateResultsForContextMenuIsEnabled",!1)}get gQd(){return H.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.TellMe.SelectionBasedZeroTermSuggestionsEnabled",
!1)}get mKb(){return H.AFrameworkApplication.K.$("ShowAnswerSearchResults")}get nKb(){return H.AFrameworkApplication.K.$("ShowDefinitionSearchResults")}get oKb(){return H.AFrameworkApplication.K.$("ShowEntitySearchResults")}get qKb(){return H.AFrameworkApplication.K.$("ShowWolframSearchResults")}get Mcf(){return H.AFrameworkApplication.K.$("ModernFontPickerIsEnabled")?{["FontName"]:"FontPicker"}:{["FontPicker"]:"FontName"}}}Object(e.a)(An,"WordEditorTellMeApplicationData",eh,[]);var Sq=d(1530),rq;
(function(Q){Q[Q.none=0]="none";Q[Q.waitAll=1]="waitAll";Q[Q.synchronizeFast=2]="synchronizeFast";Q[Q.synchronizeSlow=3]="synchronizeSlow"})(rq||(rq={}));Object(e.b)("ProviderSynchronizationType",rq);var Wn;(function(Q){Q[Q.immediate=0]="immediate";Q[Q.waitAll=1]="waitAll";Q[Q.synchronizeAndWaitAll=2]="synchronizeAndWaitAll";Q[Q.synchronizeAndWaitForRanker=3]="synchronizeAndWaitForRanker"})(Wn||(Wn={}));Object(e.b)("MenuUpdatePolicy",Wn);var hp=d(1477),ag=d(1475),Tq=d(1595),Wp=d(1478),Xp=d(1501),
so=d(103),Zr=d(248);class $n extends zn.a{constructor(Q){super();this.n_j=Q}w1b(){this.n_j.update()}}Object(e.a)($n,"TellMeFindStatusManager",zn.a,[]);class Zg{constructor(Q){this.f$a=this.Qwg=null;this.Gi=0;this.Ycd="TellMeWAC.";const ya=Q.j9e;this.qc=Q;this.mad=ya;this.yxe=Object.assign(new Sq.a,{landingTab:"Indoc",data:null});Q=new $n(this);this.JUa=um.FindManager.createInstance(Q,Xk.a.instance,cn.a.instance,!0,!0)}FL(){return"WordFindInDocument"}FW(){return this.qc.Aff?this.qc.Aff===Wn.waitAll?
rq.waitAll:rq.synchronizeSlow:rq.none}DI(Q,ya){this.enm(Q)?(this.f$a=Q,this.Qwg=ya,Q=ro.a.createQuery(Q.Fg,qi.a.none),this.Gi=window.performance.now(),this.JUa.find(Q)):ya.resultsUpdated(new hp.a(Q))}update(){this.ZFn(Math.round(window.performance.now()-this.Gi));var Q=String.format(CommonUIStrings.l_TextWithQuotation,this.f$a.Fg);var ya=H.AFrameworkApplication.ua&&H.AFrameworkApplication.ua.Sb.Kkb?Mf.a.MWa(this.f$a.Fg,15,this.yxe):Tb.a.If(this.f$a.Fg);const gb=[];gb.push(appChrome.actions.setControlLabel(this.mad,
Q));gb.push(appChrome.actions.setCompoundButtonCommandValueId(this.mad,ya));gb.push(appChrome.actions.updateCompoundButtonDescription(this.mad,this.Qif()));appChrome.api.dispatch(gb);Q=new ag.a(this.mad,Tq.a.FindInDocument,this.f$a.Fg,this.JUa.Ej.lha.toString());ya=new Wp.a(Xp.a.FindInDocument);ya.displayName=WordEditorIntl.WordEditorStrings.L_FindInDocument;ya.yz(Q);const Ob=new hp.a(this.f$a);Ob.iw(ya);window.requestAnimationFrame(()=>{this.Qwg.resultsUpdated(Ob)});this.JUa.VVa(!0);this.$Fn(Math.round(window.performance.now()-
this.Gi))}Qif(){const Q=this.JUa.Ej.lha.toString();return"1"===Q?String.format(CommonUIStrings.l_SearchResultText,Q):String.format(CommonUIStrings.l_SearchResultsText,Q)}enm(Q){return!!Q&&!!Q.Fg&&""!==Q.Fg.trim()}ZFn(Q){const ya={["Time"]:(new Date).getTime(),["Event"]:"Latency",["LatencyType"]:"ApiCall",["Service"]:"FindApi",["UiElement"]:"FindWithMatchesParameterized",["QueryLength"]:this.f$a.Fg.length};this.sendActivityEvent(ya,Q)}$Fn(Q){const ya={["Time"]:(new Date).getTime(),["Event"]:"Latency",
["LatencyType"]:"Provider",["UiElement"]:"FindWithMatchesParameterized",["QueryLength"]:this.f$a.Fg.length};this.sendActivityEvent(ya,Q)}sendActivityEvent(Q,ya){Q=so.a.PJ(Q);Nm.a.hEa(Object.assign(new Zr.a,{name:"Latency",dataFields:Q,durationMs:ya}),this.Ycd)}}Object(e.a)(Zg,"WordFindInDocumentWithMatchesProvider",null,[1098]);class Bn{constructor(Q,ya){this.zc=Q;this.XMd=ya}PZa(Q,ya,gb){return this.XMd.PZa(0,Q,ya,gb)}insertHtmlText(Q){return Q?32===this.Unf(Q):!1}Unf(Q){return this.executeCommand(Xg.a.bza,
Q)}executeCommand(Q,ya){const gb=new Bh.DictionaryPropertySet;gb.setValue(fi.a.hU,ya);gb.setValue(fi.a.eEa,!1);ya=this.zc.processAction(Q,1);32===ya&&(ya=this.zc.Xb(Q,2,gb));return ya}}Object(e.a)(Bn,"WordInsertContentHandler",null,[1747]);class ho extends Re{constructor(){super();this.ax=()=>{if(H.AFrameworkApplication.J4f){var Q=Ae.App.xa.Sb.Lhf(Ra.a.tellMe);Q.ENc?this.gFi():Q.VV(this.VCn);var ya=new An(()=>!1);dg.TellMeActor.instance.initialize(ya,null,null,null,null,null,Object(a.a)(Ae.App.xa,
Ae.App.xa.MDd,"forceUpdateRibbonControls"),H.AFrameworkApplication.K,this.W.Za("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"),this.W.Za("Common.IActionContextProvider"),this.W.Za("Common.ISystemInitiatedFeedback"));dg.TellMeActor.instance.Tjn(Q);dg.TellMeActor.instance.Oln(new Bn(H.AFrameworkApplication.ya,this.W.Pa("WordEditor.IntelligentPlaceholder.IIntelligentPlaceholderEditor")));ya.HHh&&ya.ECd&&dg.TellMeActor.instance.TH(new Zg(ya),ih.a.tellMe)}};this.VCn=()=>{this.gFi()}}get name(){return"WordEditor.TellMe"}init(){H.AFrameworkApplication.K.zq(this.ax)}gFi(){Ae.App.xa.updateCommandUI()}}
Object(e.a)(ho,"WordEditorTellMePackage",Re,[]);class Xn{constructor(){this.W=null;this.daj=(Q,ya,gb)=>{2===gb&&(Q=new Ed.StandardDialog,Q.Fd=0,Q.Sga(WordEditorIntl.WordEditorStrings.L_WordTestFeature,WordEditorIntl.WordEditorStrings.L_WordTestFeatureDialogText,null));return 32}}get name(){return"WordEditor.TestFeature"}init(){this.W.resolve("Box4.IFeatureHelper").Yk.continueWith(()=>{this.Tm()})}dispose(){}Tm(){if(this.W.resolve("Box4.IFeatureHelper").isFeatureEnabled(135)){H.AFrameworkApplication.ya.gb(Rf.a.wordTestFeature,
Kh.a.view,this.daj,96);var Q=sd.FocusManager.instance().re(qm.AppFrame.pF);$f.AFrame.ri(Q,Jf.KeyInputManager.lc(cg.a.Y4a,5|Jf.KeyInputManager.Mh),Rf.a.wordTestFeature)}}yc(Q){this.W=Q}static main(){ca.a.instance.Oc(new Xn)}}Object(e.a)(Xn,"WordEditorTestFeaturePackage",null,[1,2]);var ip=d(113);class Uq{constructor(Q,ya){this.LTi=Q;this.zc=ya;this.$5d=(gb,Ob,mc,dd,Md)=>{if(1===mc)return 32;this.LTi.oO(9,Md,!1);return 32};this.Caa=(gb,Ob)=>{if(9===Ob.type){var mc;(gb=Ob.dJ)?("string"===typeof gb?mc=
gb:"data"===gb.type&&(mc=ip.a.ovh(gb.m8m,gb.newState,gb.IQn)),mc&&Uq.jyc(mc)):la.ULS.sendTraceTag(556103040,376,15,"TrackChangeSettingUpdateNotificationEventArgs is null")}};this.oXc()}oXc(){this.zc.pa(Rf.a.$5d,uc.a.frame,this.$5d);this.LTi.p1(this.Caa)}dispose(){}static jyc(Q){Q=Ae.App.xa.notificationBar.Yra(Q,!1);Q.image=5;Q.Nla="CoAuth_AuthorStatus_16x16x32";Ae.App.xa.notificationBar.mA(Q)}}Object(e.a)(Uq,"TrackChangeNotificationActor",null,[]);class to{constructor(){this.jj=this.SKe=this.W=null;
this.UTc=()=>{if(this.jj=Ae.App.ZId().result)this.W.ha("WordEditor.TrackChange.TrackChangeNotificationActor",()=>new Uq(this.jj,H.AFrameworkApplication.ya)).singleInstance(),this.SKe=this.W.resolve("WordEditor.TrackChange.TrackChangeNotificationActor")}}get name(){return"WordEditor.TrackChangeNotificationActor"}yc(Q){this.W=Q}init(){this.W.resolve("Box4.IFeatureHelper").Yk.continueWith(()=>{this.Tm()})}Tm(){Ae.App.ZId().continueWith(this.UTc)}dispose(){this.SKe&&this.SKe.dispose()}}Object(e.a)(to,
"WordEditorTrackChangeNotificationActorPackageManager",null,[1,2]);var $r=d(81),Yp=d(1454),Kp=d(1910);class ll{}ll.K7f="UnsavedChanges";ll.L7f="UnsavedChangesThemed";ll.kCn="SavedChanges";ll.rfj="UnsavedChangesOpenPipe";ll.Ifo="UnsavedChangesOpenPipeCssClassNameThemed";ll.qfj="UnsavedChangesClosePipe";ll.Ffo="UnsavedChangesClosePipeThemed";ll.Gfo="UnsavedChanges";ll.Hfo="UnsavedChangesThemed";ll.M7f="UnsavedChangesIndicatorPositionRef";Object(e.a)(ll,"UnsavedChangesHighlightUtils",null,[]);class Vq extends Yp.a{constructor(Q,
ya){super();this.kca=Q;this.Hw=ya;this.Opa=[this.Hw?new Kp.a(ll.L7f,ll.Hfo):new Kp.a(ll.K7f,ll.Gfo)]}get Ila(){return!0}get PBb(){return 4}get Qeb(){return this.Opa}WNa(Q,ya){if(this.kca){var gb=this.kca.uAf;if(gb&&gb.count&&gb.contains(Q.id))for(Q=ya.L1a("span"),ya=0;ya<Q.length;ya++)gb=Q[ya],ya||gb.classList.add(this.Hw?ll.Ifo:ll.rfj),ya===Q.length-1&&gb.classList.add(this.Hw?ll.Ffo:ll.qfj),gb.classList.add(this.Hw?ll.L7f:ll.K7f)}}Zdb(){}}Object(e.a)(Vq,"UnsavedChangesHighlightActor",Yp.a,[]);var ur=
d(1004);class sq{constructor(Q){this.eme=null;this.kca=Q;this.zue=!1}get key(){return"UnsavedChangesHighlight"}get mw(){return"UnsavedChanges"}reset(Q){if(this.kca){Q=Q.node;if(nf.ParagraphReader.nc(Q)){const ya=this.kca.uAf;if(ya&&ya.contains(Q.id)){this.zue=!0;this.eme=Q.id;return}}this.zue=!1;this.eme=Gf.a.nil}}ZEa(){let Q=null;return this.zue?(Q=Object.assign(new ur.a,{QF:this.key,contentObject:this.eme,description:null}),{returnValue:!0,XE:Q}):{returnValue:!1,XE:Q}}}Object(e.a)(sq,"UnsavedChangesHighlightCpContentDetailsProvider",
null,[268,269]);var ws=d(1455);class tq{constructor(Q,ya,gb,Ob,mc,dd,Md){this.eRg=null;this.g4=Q;this.ff=ya;this.zV=gb;this.L4=Ob;this.x3g=mc;this.mUb=dd;this.Hw=Md;this.ff.qVa(this.U6.bind(this))}get uAf(){return this.eRg}BYl(){if(this.g4){if(1===this.g4.OXe){if(0===this.g4.Dvf&&this.g4.nBi()){this.eRg=this.g4.YUd;const Q=this.g4.s3c;this.g4.lCn.forEach(this.mWk.bind(this));Q.forEach(this.CYl.bind(this));0<Q.length&&this.TXk(this.zV);return 0}return this.lgn(this.g4.Dvf)}return 2}return 1}lgn(Q){switch(Q){case 0:return this.g4.r4h()?
5:6;case 3:case 12:case 5:case 11:return 4;default:return 6}}k5h(Q,ya,gb){if(ya)if(gb){gb=ya.querySelectorAll("span");for(let Ob=0;Ob<gb.length;Ob++){const mc=gb[Ob];Ob||mc.classList.add(ll.rfj);Ob===gb.length-1&&mc.classList.add(ll.qfj);mc.classList.add(this.Hw?ll.L7f:ll.K7f)}ya.classList.add(ll.M7f);Q&&this.L4.qhc(Q)}else ya.classList.add(ll.kCn)}L4b(Q,ya){const gb=this.MMl(Q);if(Q&&(Q=Q.Ce(ui.App.xa.jb.Ic.Tb)))if(Q.zg&&Q.zg.Ii&&0!==Q.zg.Ii.count)for(let Ob of Q.zg.Ii)this.k5h(gb,Ob,ya);else this.k5h(gb,
Q.htmlElement,ya)}MMl(Q){return this.x3g&&(Q=this.x3g.HId(Q))&&Q&&(Q=Q.Ce(ui.App.xa.jb.Ic.Tb))?Q:null}CYl(Q){this.L4b(Q,!0);return!0}mWk(Q){this.L4b(Q,!1);return!0}TXk(Q){Q&&Q.continueWith(()=>{Q.result.logActivity("UnsavedChangesHighlightEnableSurvey","WordUnsavedChangesHighlightingSurveyGateIsEnabled",0)})}U6(Q,ya){if(ya===Sys.EventArgs.Empty)la.ULS.sendTraceTag(572364513,306,50,"HighlightUnsavedChanges Not Run: Empty Event Args");else if(ya&&ya.errorCode){if(tq.mUn?!this.mUb.iX:ws.a.cK.cK())Q=
this.BYl(),la.ULS.sendTraceTag(576528923,306,15,"HighlightUnsavedChanges Run Result: {0}",Q),Ha.Health.instance.recordKpiUsage("UnsavedChangesHighlight",0,"wwrelfc",null),0!==Q&&4!==Q&&this.X$n(Q)}else la.ULS.sendTraceTag(572364514,306,50,"HighlightUnsavedChanges Not Run: No {0}",ya?"Error Code":"Kickout Event Args")}static get mUn(){if(null!=tq.hqg)var Q=tq.hqg;else{var ya,gb;Q=null!==(gb=null===(ya=H.AFrameworkApplication.K)||void 0===ya?void 0:ya.getBooleanFeatureGate("Microsoft.Office.WordOnline.ShouldReportCSDLUsingRevisionSequencing",
!1))&&void 0!==gb?gb:!1;Q=tq.hqg=Q}return Q}X$n(Q){let ya;const gb=new pe.a;gb.extendedProperties=new Map;gb.extendedProperties.set("HighlightUnsavedChangesResult",Q.toString());gb.extendedProperties.set("UnsavedChangesCollectionResult","-1");switch(Q){case 1:case 2:case 6:ya="HighlightInternalError";break;case 5:ya="ChangeOutsideCanvas"}6!==Q&&5!==Q||gb.extendedProperties.set("UnsavedChangesCollectionResult",this.g4.Dvf.toString());ya&&(Ha.Health.instance.recordQosError(ya,["UnsavedContentNotHighlighted"],
!0,!0,!1,!1,gb),Ha.Health.instance.recordKpiFailure("UnsavedChangesHighlight",ya,!0,!0,gb))}dispose(){this.ff.ncc(this.U6.bind(this))}}Object(e.a)(tq,"UnsavedChangesHighlighter",null,[9]);var yp=d(526),Zp=d(469),tl=d(1452);class Cn extends tl.a{constructor(Q,ya){super();this.kca=Q;this.Hw=ya}eKb(Q){if(!this.kca)return!1;const ya=this.kca.uAf;return ya?ya.contains(Q.zb.id)||Q.htmlElement.querySelector(".UnsavedChanges")?!0:!1:!1}xpk(Q,ya){ya=Q.KBa?Q.KBa[ya]?Q.KBa[ya].style?Q.KBa[ya].style.marginLeft:
null:null:null;var gb=Q.leftMargin;Q=1440<=gb?-(gb/1440*96):Q.kwb(0,96,this.zoom);gb=0;ya&&(ya=ya.match(/^(\d+)px/))&&ya[1]&&(gb=Number(ya[1]));return Q-gb}cqk(Q,ya,gb){return Sys.UI.DomElement.getBounds(Q).y-gb.E$[ya].y}mpk(Q){return Sys.UI.DomElement.getBounds(Q).height}Iuh(Q,ya,gb,Ob){let mc;mc=this.xpk(gb,ya);ya=this.cqk(Q,ya,gb);Q=this.mpk(Q);Ob=yp.a.createElement(Ob,Zp.a.div);Ob.className=this.Hw?"UnsavedChangesIndicatorThemed":"UnsavedChangesIndicator";Ob.style.left=mc+"px";Ob.style.top=ya+
"px";Ob.style.height=Q+"px";return Ob}Yth(Q,ya,gb,Ob){const mc=[];let dd=Q.querySelectorAll("."+ll.M7f);if(0===dd.length&&Q.classList.contains(ll.M7f))gb=this.Iuh(Q,ya,gb,Ob),gb.qWa=ya,mc.push(gb);else for(Q=0;Q<dd.length;Q++){let Md=this.Iuh(dd[Q],ya,gb,Ob);Md.qWa=ya;mc.push(Md)}return mc}oxb(Q){let ya=[];var gb=Q.Y6;const Ob=gb.Ig.ownerDocument;if(gb.Uj){let mc=0;for(let dd of gb.zg.Ii)(gb=this.Yth(dd,mc,Q,Ob))&&(ya=ya.concat(gb)),mc+=1}else ya=this.Yth(gb.htmlElement,0,Q,Ob);return ya}}Object(e.a)(Cn,
"UnsavedChangesIndicatorActor",tl.a,[]);class Jq{constructor(){this.J4=this.pv=this.ZGa=this.L4=this.Jcd=this.kca=null}get name(){return"WordEditor.UnsavedChangesHighlight"}yc(){}init(){this.L4=qa.a.instance.resolve("Box4.Indicator.IIndicatorManagerFactory").instance;this.kca=new tq(qa.a.instance.resolve("Wonca.UnsavedChangesCollection.IUnsavedChangesCollector"),vf.SessionStatusManager.instance,gl.a.Kq(qa.a.instance.Za("Common.ISystemInitiatedFeedbackWithTimeLapse")),this.L4,qa.a.instance.resolve("WordEditor.Indicator.TopLevelOutlineElementCache"),
qa.a.instance.resolve("Box4.Revision.IRevisionSequenceNumberManager"),!!Ae.App.instance&&Ae.App.instance.gma);this.ZGa=qa.a.instance.Za("Box4.Accessibility.IAccessibilityContextManager");this.J4=qa.a.instance.resolve("Box4.Highlight.IHighlightManagerFactory").instance;this.Jcd=new Cn(this.kca,!!Ae.App.instance&&Ae.App.instance.gma);this.L4.ujb(this.Jcd);this.ZGa&&this.ZGa.execute(Q=>{Q.i3(new sq(this.kca))});this.pv=new Vq(this.kca,!!Ae.App.instance&&Ae.App.instance.gma);this.J4.tjb(this.pv)}dispose(){this.L4&&
this.Jcd&&this.L4.uce(this.Jcd);this.J4&&this.pv&&this.J4.F7f(this.pv);$r.a.VA(this.kca)}static main(){ca.a.instance.Oc(new Jq)}}Object(e.a)(Jq,"WordEditorUnsavedChangesHighlightPackage",null,[1,2,9]);var Lp=d(348);class uq{constructor(Q,ya,gb,Ob){gb=new wordVersionHistory.AppBootSettings;gb.logger=new Lp.a;gb.forcePdfDevEnv=!1;gb.userSessionId=H.AFrameworkApplication.userSessionId;gb.wacCluster=Ob;gb.publicScriptPath=H.AFrameworkApplication.C3;gb.userType=H.AFrameworkApplication.userType;gb.isDoubleClickFixEnabled=
Q.isDoubleClickFixEnabled;this.Nde=new wordVersionHistory.AppVersionControllerImpl(gb,ya)}onVersionSelected(Q,ya,gb,Ob){this.Nde.onVersionSelected(Q,ya,gb,Ob)}onDownloadTokenReady(Q,ya){this.Nde.onDownloadTokenReady(Q,ya)}getRenderFailureEvent(){return this.Nde.getRenderFailureEvent()}getLoadFinishEvent(){return this.Nde.getLoadFinishEvent()}}Object(e.a)(uq,"AppVersionControllerImplWrapper",null,[1829]);class xs{create(Q,ya,gb,Ob){return new uq(Q,ya,gb,Ob)}}Object(e.a)(xs,"AppVersionControllerImplWrapperFactory",
null,[1786]);class Qm{getVersionHistoryControllerInstance(Q){return versionHistory?versionHistory.FactoryGlobal.getVersionHistoryControllerInstance(Q):null}}Object(e.a)(Qm,"VersionHistoryControllerFactory",null,[1785]);class Hl{static addAppPLTEventToLog(Q){try{Microsoft.VersionHistory.VersionHistoryLogHelper.addAppPLTEventToLog(Q)}catch(ya){}}static setIsPageLoadForFirstTime(Q){try{Microsoft.VersionHistory.VersionHistoryLogHelper.setIsPageLoadForFirstTime(Q)}catch(ya){}}}Object(e.a)(Hl,"VersionHistoryLogConnector",
null,[]);var Ia=d(529),Za=d(1438),tb=d(1632);class gc{constructor(){this.revisionId=null;this.zUf=0}}Object(e.a)(gc,"ForceSaveData",null,[]);class Ac extends Em.a{constructor(){super();this.ExclusiveLockId=this.VersionToken=this.FileId=null}Wl(){return 106}static construct(Q,ya,gb){const Ob=new Ac;Ob.FileId=Q;Ob.VersionToken=ya;Ob.ExclusiveLockId=Wi.a(gb);return Ob}}Object(e.a)(Ac,"RestoreVersionRequest",Em.a,[]);class ad{static Ala(){return(new Date).getTime()}static rDk(Q){const ya=new pe.a;ya.durationMs=
Q;ya.extendedProperties=new Map;return ya}}Object(e.a)(ad,"VersionHistoryUtils",null,[]);var vd=d(315);class Kd{constructor(Q,ya,gb,Ob,mc,dd,Md,He,Ue,Sf,of,cj,el,qk,jm){this.zc=Q;this.Ci=ya;this.aT=gb;this.sdl=Ob;this.Ss=mc;this.$li=dd;this.a5c=Md;this.ktd=He;this.Zpo=Ue;this.K=Sf;this.Mbk=of;this.OSe=cj;this.Kmb=el;this.Ye=qk;this.m$f=jm;this.LQa=this.oGc=this.z0c=this.Q8d=this.M0f=this.o7f=this.perfTelemetryInfos=this.baseVersion=this.currentVersion=this.controller=null;this.t5d=0;this.CXb=this.Mde=
null;this.o$f=Za.b.None;this.r7b=!1;this.q$f="";this.f6k={0:"GeneralSaveError",1:"InvalidFileName",2:"EmptyFileName",3:"InvalidPermission",4:"OverwriteTarget",5:"TargetFileLocked",6:"InvalidFileNameDisallowPercentOctothorpe"};this.B5i=(Qk,Kn,yj)=>{if(1===yj)return vf.SessionStatusManager.instance.Sj?8:32;if(2===yj){this.Mde=td.a.create().toString();la.ULS.sendTraceTag(592196993,3005,50,"Execute ShowVersionHistoryDialogAction. VersionHistoryLaunchSessionId: {0}",this.Mde);H.AFrameworkApplication.Hl("Microsoft.Office.Web.SessionSettings.IDocsWordVersionHistorySaveACopyOverFlowMenuSettings");
H.AFrameworkApplication.maa("WoVer882;WoVer882cf");Object(tb.a)();this.Ye.logKpiUsage("WordVersionHistory",0,{isForAlertableKpi:!0});this.Ye.TB(Rf.a.l_m,{succeeded:!0});this.R$i.ShowVersionHistoryDialog=(new Date).getTime().toString();this.Nu.VersionHistoryLaunchSessionId=this.Mde;this.perfTelemetryInfos=[];this.controller||(this.q$f=this.K.lb("WacCluster"),this.controller=this.Zpo.getVersionHistoryControllerInstance({ulsLogger:new Lp.a,serviceBase:this.K.appSettings.VersionHistoryWebServiceBase,
docId:H.AFrameworkApplication.xm,appSettings:{appName:Za.a.Word,wdEnableDownloadTokens:this.a5c.xmj,wdEnableSaveACopy:!0,wdEnableRestore:this.a5c.vmj,userSessionId:H.AFrameworkApplication.userSessionId,wacCluster:this.q$f,uiLocale:H.AFrameworkApplication.uiCulture?H.AFrameworkApplication.uiCulture:"en-us",wdEnableHiddenButtonsUntilVersionLoadComplete:!0,wdEnableShowVersionChanges:!0,disabledChangeGates:H.AFrameworkApplication.K.lb("VHSDisabledChangeGates"),wdEnableSaveACopyOverFlowMenu:this.a5c.wmj,
isRtl:H.AFrameworkApplication.isRtl,wdEnableAppColorUpdate:this.K.$("AppColorUpdateIsEnabled"),useXhr:Ja.a.S$,retryCount:0,wdEnableDeleteVersions:!1,wdEnableIterator:!1,viewerRootPositionRelative:!1,disableSaveACopy:!1},perfTelemetryInfos:this.perfTelemetryInfos}));if(!this.controller)return this.Ye.logKpiFailure("WordVersionHistory","scriptDependencyUnavailable",{isIntentional:!1},{name:Kd.vetoName,errorNameOverride:"VersionHistoryLaunchFailed",isIntentional:!1}),8;this.controller.setDisableSaveACopy(this.KSn()||
this.HSn());this.hZn()}return 32};this.qvn=(Qk,Kn,yj)=>{if(1===yj)return vf.SessionStatusManager.instance.jK?32:8;2===yj&&(Qk=this.dbb(this.t5d),this.Ye.logKpiSuccess("WordVersionHistorySaveACopy",{additionalValues:Qk}),this.vQf());return 32};this.pvn=(Qk,Kn,yj,Mg,aq)=>{var as,zj,Rm;if(1===yj)return vf.SessionStatusManager.instance.jK?32:8;2===yj&&(Qk="Unknown",Kn="",aq&&(Qk=null!==(as=aq.FailureReason)&&void 0!==as?as:Qk,aq=null!==(zj=aq.ExtraInfo)&&void 0!==zj?zj:"",Kn=null!==(Rm=this.f6k[aq])&&
void 0!==Rm?Rm:aq),zj=this.dbb(this.t5d),""!==Kn&&zj.extendedProperties.set("ExtraInfo",Kn),Rm=this.Kmb.neb(Qk,3,Kn),this.Ye.logKpiFailure("WordVersionHistorySaveACopy",Qk,{isIntentional:Rm.isIntentional,additionalValues:zj},Rm),la.ULS.sendTraceTag(592197004,3005,10,"Save failed with {0} {1}",Qk,Kn));return 32};this.GRd=()=>{this.Dui();this.vQf();this.Ss&&this.Ss.refreshDocument({gWn:!0})};this.udl=Qk=>{la.ULS.sendTraceTag(592197010,3005,50,"DocumentSavedSuccessfully");var Kn=Qk.revisionId;const yj=
Gf.a.create();Kn=Ac.construct(H.AFrameworkApplication.rootQuerySignature,Kn,yj);const Mg=Object.assign(new Tl.a,{Yr:Kn,status:1,iH:"RestoreVersion"});Kn=this.OSe.bla(0,()=>{this.oUl(Mg,Qk.zUf)});Kn.JJ(Mg);Kn.qW()};this.cKh=(Qk,Kn)=>{this.r7b=!1;const yj=this.dbb(Qk.zUf);yj.extendedProperties.set("status",Ia.a[Kn]);const Mg=this.Kmb.neb("ForceSaveFailed",5);this.Ye.logKpiFailure("WordVersionHistoryRestore","forceSaveFailed",{isIntentional:Mg.isIntentional,additionalValues:yj},Mg);this.Ye.TB(Rf.a.$Ac,
{succeeded:!1});la.ULS.sendTraceTag(592197011,3005,10,"ForceSaveFailed with status"+Ia.a[Kn]+" for version "+Qk);this.controller.setRestoreFailedAtServer(this.GRd)};this.R$i={};this.Nu={};this.gZn=!1;this.A6=!!H.AFrameworkApplication.ua&&H.AFrameworkApplication.ua.Sb.A6}wud(){null===this.oGc&&(this.oGc=ad.Ala())}dbb(Q){const ya=new pe.a;null===Q?la.ULS.sendTraceTag(541693581,3005,10,"constructKpiAdditionalValuesWithDurationFromStartTime called with null startTime"):(ya.durationMs=ad.Ala()-Q,ya.extendedProperties=
new Map);return ya}k4l(){null===this.LQa&&(this.LQa=ad.Ala());this.Ye.logKpiUsage("WordVersionHistorySelectVersion",0,{isForAlertableKpi:!0})}vQf(){const Q=[],ya=Object.assign(new pe.a,{extendedProperties:new Map});if(null!=this.Q8d&&null!=this.M0f){var gb=this.Q8d-this.M0f;Q.push(Object.assign(new Nj.a,{name:"showPaneDuration",string:gb.toString()}));ya.extendedProperties.set("showPaneDuration",gb.toString())}null!=this.oGc&&null!=this.z0c&&(gb=this.oGc-this.z0c,Q.push(Object.assign(new Nj.a,{name:"firstActionDuration",
string:gb.toString()})),ya.extendedProperties.set("firstActionDuration",gb.toString()));(gb=this.o$f===Za.b.None)?this.Ye.logKpiSuccess("WordVersionHistory",{additionalValues:ya}):this.Ye.logKpiFailure("WordVersionHistory",Za.b[this.o$f],{isIntentional:!1,additionalValues:ya},{name:Kd.vetoName,errorNameOverride:"VersionHistoryLaunchFailed",isIntentional:!1});this.Ye.TB(Rf.a.Ayk,{succeeded:gb,customData:Q})}Vb(){this.zc.pa(Ra.a.d1f,uc.a.frame,this.B5i);this.zc.pa(Ra.a.AYc,uc.a.frame,this.qvn);this.zc.pa(Ra.a.p4d,
uc.a.frame,this.pvn)}hZn(){this.M0f=ad.Ala();this.oGc=this.z0c=this.Q8d=null;if(document.getElementById("VersionHistoryOverlay"))this.DG();else{this.lln();this.kln();this.Vkn();this.$kn();this.iln();this.Zkn();this.a5c.ymj&&this.Ykn();this.hln();this.jln();const Q=document.createElement("div");let ya=Q.id="VersionHistoryOverlay",gb=null;this.aln(Q);if(this.A6&&(gb=Object(vd.a)("Header"))){const Ob=document.getElementById("AppHeaderPanel");ya=Ob&&"none"===Ob.style.display?String.format("{0} {1} {2}",
ya,"RegionComposer","NoAppHeader"):String.format("{0} {1}",ya,"RegionComposer")}gb||(gb=document.getElementById("WACInnerFrame"));Q.className=ya;gb.appendChild(Q);this.o7f=this.controller.createVersionHistoryDialog(Q);this.Rga()}document.getElementById("VersionHistoryOverlay").style.display="block";this.controller.getVersions("")}KSn(){if(H.AFrameworkApplication.jO)return la.ULS.sendTraceTag(570770272,3005,15,"Version History is disabling Save a Copy because this is a protected file."),!0;const Q=
32==this.zc.processAction(Ra.a.gdc,1);let ya=32==this.zc.processAction(Ra.a.jdc,1);return Q||ya?!1:(la.ULS.sendTraceTag(545403476,3005,15,"Version History is disabling Save a Copy because the save commands are disabled."),!0)}HSn(){return H.AFrameworkApplication.jO?(la.ULS.sendTraceTag(545387291,3005,15,"Version History is disabling download version because this is a protected file."),!0):32!=this.zc.processAction(Ra.a.downloadACopy,1)?(la.ULS.sendTraceTag(545403477,3005,15,"Version History is disabling download version because the download command is disabled."),
!0):!1}$kn(){this.controller.getFullAppErrorEvent().addListener(Q=>{let ya=Q?Za.b[Q]:"";this.Nu[Kd.g7n]=ya;this.o$f=Q;la.ULS.sendTraceTag(592196994,3005,10,"Full App Error Event: {0}, VersionHistoryLaunchSessionId: {1}",ya,this.Mde)})}lln(){this.controller.getVersionsReadyEvent().addListener(Q=>{this.Q8d=ad.Ala();this.fwn(Q.containerDiv);this.m$f.initialize(this.CXb);this.DG()})}kln(){this.controller.getVersionSelectedEvent().addListener(Q=>{null===this.LQa&&(this.LQa=ad.Ala());this.m$f.display(Q)})}Ykn(){this.controller.getDownloadTokenReadyEvent().addListener(Q=>
{try{la.ULS.sendTraceTag(592196998,3005,50,"VersionHistoryPaneActor - GetDownloadTokenReadyEvent called."),this.fTl(Q)}catch(ya){la.ULS.sendTraceTag(592197002,3005,10,"VersionHistoryPaneActor: Exception in GetDownloadTokenReadyEvent callback: {0}",ya)}})}fTl(Q){Q&&Q.versionSelected?(this.currentVersion=Q.versionSelected.currentVersion,this.baseVersion=Q.versionSelected.baseVersion,this.k4l(),this.CXb.onVersionSelected(this.currentVersion,this.baseVersion,this.R$i,!this.gZn)):la.ULS.sendTraceTag(591697922,
3005,10,"handleGetDownloadTokenReadyEvent: downloadTokenReadyObject.versionSelected was null")}Vkn(){this.controller.getCloseSelectedEvent().addListener(()=>{this.Byk();this.Aqm()})}F3l(Q){const ya={};ya.FileDownloadUrl=Q;ya.SaveEntryPoint="VersionHistory";return ya}GHl(Q){let ya="Dialog Failure - ActionResponse "+Q.toString();2===Q?ya="DialogNotHandled":8===Q&&(ya="DialogFailed");return ya}iln(){this.controller.getSaveACopySelectedEvent().addListener(Q=>{this.t5d=ad.Ala();this.Ye.logKpiUsage("WordVersionHistorySaveACopy",
0);this.wud();la.ULS.sendTraceTag(592197003,3005,50,"VersionHistoryPaneActor: RegisterForSaveACopySelectedEvent");this.Dui();var ya=this.F3l(Q);Q=32==this.zc.processAction(Ra.a.gdc,1);ya=this.zc.Xb(Q?Ra.a.gdc:Ra.a.jdc,2,ya);const gb=this.dbb(this.t5d),Ob=32===ya;if(!Ob){const mc=this.GHl(ya),dd=this.Kmb.neb(mc,2);this.Ye.logKpiFailure("WordVersionHistorySaveACopy",mc,{isIntentional:dd.isIntentional,additionalValues:gb},dd);la.ULS.sendTraceTag(578033103,3005,10,Q?"SaveACopy":"SaveToSharePoint failed with ActionResponse: "+
ya.toString())}this.Ye.TB(Rf.a.xxk,{succeeded:Ob})})}Zkn(){this.controller.getDownloadVersionSelectedEvent().addListener(Q=>{var ya=ad.Ala();this.Ye.logKpiUsage("WordVersionHistoryDownloadVersion",0);this.wud();Q=new Ch.QueryStringBuilder(Q);Q.Ie("fn",H.AFrameworkApplication.fileName);Q=this.zc.Xb(Ra.a.downloadACopy,2,{["FileDownloadUrl"]:Q.toString()});ya=this.dbb(ya);const gb=32===Q;gb?this.Ye.logKpiSuccess("WordVersionHistoryDownloadVersion",{additionalValues:ya}):(this.Ye.logKpiFailure("WordVersionHistoryDownloadVersion",
Q.toString(),{isIntentional:!1,additionalValues:ya},{name:Kd.vetoName,errorNameOverride:"DownloadVersionFailed"}),la.ULS.sendTraceTag(592197005,3005,10,"Download version failed with result: "+Q.toString()));this.Ye.TB(Rf.a.wxk,{succeeded:gb})})}oUl(Q,ya){this.r7b=!1;if(2===Q.statusCode&&Q.jk&&0<Q.jk.length&&Q.jk[0])if(Q=Q.jk[0],ya=this.dbb(ya),this.$li&&Q.ShouldAvoidLockRelease&&this.$li.hkb(!1,"VersionHistory"),191===Q.StatusCode)Q=this.Kmb.neb("MultipleClientsInCoauthSession",5),this.Ye.logKpiFailure("WordVersionHistoryRestore",
"multipleClientsInCoauthSession",{isIntentional:!0,additionalValues:ya},Q),this.Ye.TB(Rf.a.$Ac,{succeeded:!1}),la.ULS.sendTraceTag(592197006,3005,10,"RestoreVersionRequest failed with MultipleClientsInCoauthSession"),this.controller.setCoauthRestoreError(),Kd.Bqm();else if(Q.StatusCode){ya.extendedProperties.set("status",Ia.a[Q.StatusCode]);const gb=this.Kmb.neb("ServerOperationFailed",5);this.Ye.logKpiFailure("WordVersionHistoryRestore","restoreVersionResponseFailed",{isIntentional:!1,additionalValues:ya},
gb);this.Ye.TB(Rf.a.$Ac,{succeeded:!1});la.ULS.sendTraceTag(592197007,3005,10,"RestoreVersionRequest failed with "+Ia.a[Q.StatusCode]);this.controller.setRestoreFailedAtServer(this.GRd)}else this.Ye.logKpiSuccess("WordVersionHistoryRestore",{additionalValues:ya}),this.Ye.TB(Rf.a.$Ac,{succeeded:!0}),la.ULS.sendTraceTag(592197008,3005,50,"Restore Version Successful."),this.GRd();else ya=this.Kmb.neb("ServerOperationFailed",5),this.Ye.logKpiFailure("WordVersionHistoryRestore","serverOperationFailed",
{isIntentional:ya.isIntentional},ya),la.ULS.sendTraceTag(592197009,3005,10,"serverOperation failed with "+Uf.a[Q.statusCode]),this.controller.setRestoreFailedAtServer(this.GRd)}hln(){this.controller.getRestoreVersionSelectedEvent().addListener(Q=>{if(this.r7b)la.ULS.sendTraceTag(536998742,3005,50,"restore already in progress");else{this.r7b=!0;this.wud();var ya=ad.Ala();this.Ye.logKpiUsage("WordVersionHistoryRestore",0);var gb=null;Q&&(gb=Q.split("-")[0]);gb&&""!==gb?(Q=Object.assign(new gc,{revisionId:gb,
zUf:ya}),la.ULS.sendTraceTag(592197013,3005,50,"VersionHistoryPaneActor: RegisterForRestoreVersionSelectedEvent: {0}",gb),this.controller.setRestoreInProgress(),this.sdl(19,!1,this.udl,this.cKh,Q,null,null)):(gb=this.Kmb.neb("InvalidRevisionId",5),this.Ye.logKpiFailure("WordVersionHistoryRestore","invalidRevisionId",{isIntentional:gb.isIntentional},gb),this.Ye.TB(Rf.a.$Ac,{succeeded:!1}),la.ULS.shipAssertTag(592197012,3005,!1),this.r7b=!1)}})}mln(){this.CXb.getRenderFailureEvent().addListener(Q=>
{const ya=this.Kmb.neb(Q,1),gb=this.dbb(this.LQa);this.LQa=null;this.Ye.logKpiFailure("WordVersionHistorySelectVersion",Q,{isIntentional:ya.isIntentional,additionalValues:gb},ya);try{this.Nu.ViewerErrorCode="ViewerErrorCode"in this.Nu?this.Nu.ViewerErrorCode+("; "+Q):Q,this.controller.setViewerError(!0),la.ULS.sendTraceTag(592197014,3005,10,"Versions viewer error code: {0}",Q)}catch(Ob){la.ULS.sendTraceTag(592197015,3005,10,"Failed to set viewer error: {0}",Ob)}})}bln(){this.CXb.getLoadFinishEvent().addListener(()=>
{null==this.z0c&&(this.z0c=ad.Ala());const Q=this.dbb(this.LQa);this.LQa=null;this.Ye.logKpiSuccess("WordVersionHistorySelectVersion",{additionalValues:Q});this.controller.setVersionLoadComplete()})}jln(){this.controller.getShowVersionChangesToggledEvent().addListener(()=>{null===this.LQa&&(this.LQa=ad.Ala());this.m$f.K9n()})}allowKeytips(Q){Jg.a("allowKeytips")&&appChrome.api.allowKeytips(Q)}DG(){this.aT.Mw(qm.AppFrame.Jna);this.allowKeytips(!1);this.aT.Mw($f.AFrame.Zp);this.aT.Mw(qm.AppFrame.koa);
this.Ci.uK("VersionHistoryViewer",!1);this.aT.DG("VersionHistoryViewer");this.Ci.uK("VersionHistoryHeader",!0);this.aT.DG("VersionHistoryHeader");this.Ci.uK("VersionHistoryOverlay",!0);this.aT.DG("VersionHistoryOverlay")}Mw(){this.aT.DG(qm.AppFrame.Jna);this.allowKeytips(!0);this.aT.DG($f.AFrame.Zp);this.aT.DG(qm.AppFrame.koa);this.aT.Mw("VersionHistoryOverlay");this.Ci.NQ("VersionHistoryOverlay");this.aT.Mw("VersionHistoryHeader");this.Ci.NQ("VersionHistoryHeader");this.aT.Mw("VersionHistoryViewer");
this.Ci.NQ("VersionHistoryViewer")}Byk(){this.r7b&&la.ULS.sendTraceTag(536998743,3005,10,"restore did not complete!");this.vQf();document.getElementById("VersionHistoryOverlay").style.display="none";this.Nu.browser=Ja.a.dF;Ja.a.s2&&(this.Nu.electronBrowserVersion=Ja.a.A0k);this.Mw();la.ULS.sendTraceTag(592197017,3005,50,Ka.c(this.Nu))}fwn(Q){try{if(this.CXb)Hl.setIsPageLoadForFirstTime(!1);else{Hl.setIsPageLoadForFirstTime(!0);const ya=this.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.IsVersionHistoryBadGatewayFixEnabled",
!1)?this.q$f:"";this.CXb=this.Mbk.create(this.a5c,Q,this.ktd,ya);this.mln();this.bln()}}catch(ya){la.ULS.sendTraceTag(592197018,3005,10,"WordVersionHistorySelectionHandler: ResetAppVersionController failed due to exception. {0}",ya)}}L_e(Q){const ya=this.Ci.re(Q);ya.parent=$f.AFrame.Np;this.aT.Rya(Q);ya.UL=!0;return ya}Rga(){this.L_e("VersionHistoryOverlay").dda((Q,ya)=>{try{null!=Q&&"dialog/modal"==Q.name?this.controller.setSaveACopyCanceled():"VersionHistoryOverlay"===ya.name&&this.o7f.then(gb=>
{gb.enterFocusTrapZone();return null})}catch(gb){la.ULS.sendTraceTag(592197019,3005,10,"VersionHistoryPaneActor: exception in SetupFocus callback: {0}.",gb)}});this.L_e("VersionHistoryHeader").dda((Q,ya)=>{try{"VersionHistoryHeader"===ya.name&&this.o7f.then(gb=>{gb.enterHeaderFocusTrapZone();return null})}catch(gb){la.ULS.sendTraceTag(592197020,3005,10,"VersionHistoryPaneActor: exception in SetupFocus callback: {0}.",gb)}});this.L_e("VersionHistoryViewer").dda((Q,ya)=>{try{"VersionHistoryViewer"===
ya.name&&sd.FocusManager.AK(document.getElementById("vhViewer"))}catch(gb){la.ULS.sendTraceTag(592197021,3005,10,"VersionHistoryPaneActor: exception in SetupFocus callback: {0}.",gb)}})}Aqm(){const Q=qa.a.instance.Pa("Common.ISystemInitiatedFeedback");Q?(Q.logActivity("VersionHistoryExited","WordVersionHistoryFGIsEnabled"),Q.logActivity("VersionHistoryCheckExited","WordVersionHistoryFGIsEnabled")):la.ULS.sendTraceTag(592197022,3005,10,"ISystemInitiatedFeedback was null")}Dui(){const Q=qa.a.instance.Pa("Common.ISystemInitiatedFeedback");
Q?Q.logActivity("VersionHistoryExited","WordVersionHistoryFGIsEnabled"):la.ULS.sendTraceTag(592197023,3005,10,"ISystemInitiatedFeedback was null")}static Bqm(){const Q=qa.a.instance.Pa("Common.ISystemInitiatedFeedback");Q?Q.logActivity("VersionHistoryRestoreCoauthFailed","VersionHistoryRestoreSurveyEnabled"):la.ULS.sendTraceTag(578359496,3005,10,"LaunchVHRestoreFailedDuringCoauthFloodgateSurvey::ISystemInitiatedFeedback was null")}aln(Q){Q&&Q.addEventListener("keydown",ya=>{ya.ctrlKey&&"KeyC"===ya.code&&
(this.wud(),this.Ye.logKpiUsage("WordVersionHistoryCopyText",0));ya.ctrlKey&&"KeyF"===ya.code&&this.Ye.logKpiUsage("WordVersionHistorySearchText",0)})}}Kd.g7n="ErrorCode";Kd.vetoName="VersionHistoryExperienceDegraded";Object(e.a)(Kd,"VersionHistoryPaneActor",null,[1746]);class Ne{constructor(){this.isDoubleClickFixEnabled=this.wmj=this.vmj=this.ymj=this.xmj=!1}}Object(e.a)(Ne,"WordVersionHistorySettings",null,[]);class Of{neb(Q,ya,gb){let Ob={name:"VersionHistoryExperienceDegraded",isIntentional:!1};
0==ya?Ob.errorNameOverride="VersionHistoryLaunchFailed":1==ya?Q.includes("Failed to fetch")?Ob.errorNameOverride="SelectVersionFailedBecauseFetchFailed":Q.includes("Unexpected server response (500) while retrieving PDF")?Ob.errorNameOverride="SelectVersionFailedServerResponseInternalError":Q.includes("Unexpected server response (502) while retrieving PDF")?Ob.errorNameOverride="SelectVersionFailedServerResponseBadGateway":Q.includes("Unexpected server response (415) while retrieving PDF")?(Ob.errorNameOverride=
"SelectVersionFailedServerResponseUnsupportedMediaType",Ob.isIntentional=!0):Q.includes("Unexpected server response (408) while retrieving PDF")?Ob.errorNameOverride="SelectVersionFailedServerResponseRequestTimeout":Q.includes("Unexpected server response (400) while retrieving PDF")?Ob.errorNameOverride="SelectVersionFailedServerResponseBadRequest":Q.includes("Unexpected server response (413) while retrieving PDF")?(Ob.errorNameOverride="SelectVersionFailedServerResponseRequestEntityTooLarge",Ob.isIntentional=
!0):Ob.errorNameOverride="SelectVersionFailed":5==ya?(Ob.errorNameOverride="RestoreVersionFailed"+Q,Ob.isIntentional="MultipleClientsInCoauthSession"===Q):4==ya?Ob.errorNameOverride="DownloadVersionFailed"+Q:2==ya?Ob.errorNameOverride=Of.OVf+Q:3==ya&&(gb?(Ob.errorNameOverride=Of.OVf+gb,Ob.isIntentional="OverwriteTarget"===gb||"TargetFileLocked"===gb):(Q=this.Mul(Q),Ob.errorNameOverride=Q?"SaveVersionFailedServerResponse"+Q:Of.OVf));return Ob}Mul(Q){switch(Q){case "400":return"BadRequest";case "401":return"Unauthorized";
case "403":return"Forbidden";case "404":return"NotFound";case "408":return"Timeout";case "500":return"InternalError";default:return""}}}Of.OVf="SaveVersionFailed";Object(e.a)(Of,"WordVersionHistoryVetoHelper",null,[1745]);var gh=d(1007),Yi=d(1E3);class og{constructor(Q,ya){this.Zde=Q;this.Ye=ya;this.RQe=null;this.mPc=!0}initialize(Q){this.RQe=Q}K9n(){this.mPc=!this.mPc;this.display(this.S4e)}display(Q){this.S4e=Q;this.dyf(Q);if(this.RQe){var ya=this.Zde.lPl(Q,this.mPc);if(2==ya)this.Zde.aZm(Q.currentVersion.RevisionID);
else{1==ya&&this.Ye.logKpiFailure("WordVersionHistoryShowChanges","BaseNotAvailable",{isIntentional:!1},{name:"VersionHistoryExperienceDegraded"});this.Zde.ARm(Q.currentVersion.RevisionID);try{this.RQe.onVersionSelected(this.S4e.currentVersion,this.S4e.baseVersion,null,this.mPc)}catch(gb){la.ULS.sendTraceTag(524957267,3005,10,"Exception thrown by onVersionSelected: {0}",gb)}}}else this.VBm()}dyf(Q){this.Zde.O9l(Q.currentVersion.RevisionID)||(this.Ye.logKpiUsage("WordVersionHistorySelectVersion",0,
{isForAlertableKpi:!0}),this.mPc&&!Q.noBaseToCompareTo&&this.Ye.logKpiUsage("WordVersionHistoryShowChanges",0))}VBm(){this.Ye.logKpiFailure("WordVersionHistorySelectVersion","VersionDisplayActorUninitialized",{isIntentional:!1},{name:"VersionHistoryExperienceDegraded"});la.ULS.sendTraceTag(524957266,3005,10,"AppVersionController was not initialized!")}}Object(e.a)(og,"VersionDisplayActor",null,[1744]);var Ji;(function(Q){Q[Q.notStarted=0]="notStarted";Q[Q.inProgress=1]="inProgress";Q[Q.complete=2]=
"complete"})(Ji||(Ji={}));Object(e.b)("WaitForBaseState",Ji);class Jk{constructor(Q,ya){this.revisionId=Q;this.Ye=ya;this.state=Ji.notStarted}get MPk(){return this.revisionId}begin(){this.state==Ji.notStarted&&(this.startTime=ad.Ala(),this.state=Ji.inProgress,this.Ye.logKpiUsage("WordVersionHistoryWaitForBase",1),la.ULS.sendTraceTag(524957265,3005,50,"WaitForBaseOperation.begin"))}end(Q){if(this.state==Ji.inProgress){this.state=Ji.complete;this.endTime=ad.Ala();const ya=ad.rDk(this.endTime-this.startTime);
this.revisionId==Q?this.Ye.logKpiSuccess("WordVersionHistoryWaitForBase",{additionalValues:ya}):this.Ye.logKpiFailure("WordVersionHistoryWaitForBase","WaitForBaseTimedOut",{additionalValues:ya},{name:"VersionHistoryExperienceDegraded"})}}}Object(e.a)(Jk,"WaitForBaseOperation",null,[]);class Ph{constructor(Q){this.Ye=Q}lPl(Q,ya){return Q.noBaseToCompareTo||!ya?0:Q.baseVersion?Q.baseVersion.DownloadUrl&&0<Q.baseVersion.DownloadUrl.length?0:void 0===Q.baseVersion.DownloadUrl||null===Q.baseVersion.DownloadUrl?
1:0==Q.baseVersion.DownloadUrl.length?2:1:1}O9l(Q){return this.GMb?this.GMb.MPk==Q:!1}ARm(Q){this.GMb&&this.C8i(Q)}aZm(Q){this.GMb&&this.C8i(Q);this.GMb=new Jk(Q,this.Ye);this.GMb.begin()}C8i(Q){this.GMb.end(Q);this.GMb=null}}Object(e.a)(Ph,"WaitForBaseController",null,[1743]);class ef{constructor(){this.Pno={crewAlias:"webasynccollabeng",featureName:"VersionHistory",topLevelKpiName:"VersionHistoryFeatureUsage",vetoPillar:7}}get name(){return"WordEditor.VersionHistory"}init(){H.AFrameworkApplication.xuf()?
(la.ULS.sendTraceTag(39966528,3005,50,"WordVersionHistoryPackage:init - Initializing the React VersionHistory package"),eb.a.get_instance().tl(7,()=>{const Q=this.container.resolve("Common.IDynamicScriptLoaderProvider").JE;(H.AFrameworkApplication.K.$("DynamicBundlesIsEnabled")?appResourceLoader.loadChunk("wordVersionHistory"):Q.loadScript("wordVersionHistory")).catch(ya=>la.ULS.sendTraceTag(39966529,3005,10,"Failed to load the resources for the versionHistory feature: {0}",ya)).then(()=>this.UYm()).catch(ya=>
la.ULS.sendTraceTag(39966530,3005,10,"Failed to initialize the versionHistory feature: {0}",ya))})):la.ULS.sendTraceTag(39966498,3005,50,"WordVersionHistoryPackage:init - Not initializing the React VersionHistory package because the feature is disabled")}UYm(){la.ULS.sendTraceTag(541942913,3005,50,"Finished loading resources for the versionHistory feature");this.container.resolve("IVersionHistoryPaneActor").Vb();return null}dispose(){}yc(Q){this.container=Q;this.K=this.container.resolve("Common.IAppSettingsManager");
if(this.K.$("AppSupportsVersionHistory")){var ya=this.container.resolve("Common.IBrowserUtils"),gb=new Ne;gb.xmj=this.K.$("WordWdDownloadTokenIsEnabled");gb.ymj=this.K.$("WordWdDownloadTokenRegisterIsEnabled");gb.vmj=this.K.$("WordVersionHistoryEnableRestore");gb.wmj=this.K.$("WordVersionHistorySaveACopyOverFlowMenuIsEnabled");gb.isDoubleClickFixEnabled=this.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.IsVersionHistoryDoubleClickFixEnabled",!1);this.container.ha("IFeatureUsageAndHealthLogger",
()=>new gh.a(Ha.Health.instance,new Yi.a,this.Pno)).singleInstance();this.container.ha("IWaitForBaseController",()=>new Ph(this.container.resolve("IFeatureUsageAndHealthLogger"))).singleInstance();this.container.ha("IVersionDisplayActor",()=>new og(this.container.resolve("IWaitForBaseController"),this.container.resolve("IFeatureUsageAndHealthLogger"))).singleInstance();this.container.ha("IVersionHistoryPaneActor",()=>new Kd(H.AFrameworkApplication.ya,sd.FocusManager.instance(),Hj.a.instance,yc.a.PP,
Ae.App.xa,Ae.App.F_,gb,ya,new Qm,H.AFrameworkApplication.K,new xs,new vi.a,new Of,this.container.resolve("IFeatureUsageAndHealthLogger"),this.container.resolve("IVersionDisplayActor"))).singleInstance()}}static main(){let Q=!1;H.AFrameworkApplication.K&&H.AFrameworkApplication.K.$("IsOnDemandVersionHistoryEnabled")&&H.AFrameworkApplication.xuf()&&(Q=!0);ca.a.instance.Oc(new ef,0,Q)}}Object(e.a)(ef,"WordVersionHistoryPackage",null,[1,2]);var Me=d(104);class kf{constructor(Q,ya,gb){this.ga=Q;this.Mm=
ya;this.Oa=gb}Vb(){this.Oa.$("ZoomPopupDialogIsEnabled")&&(this.ga.pa(Ra.a.afc,uc.a.frame,Object(a.a)(this.Mm,this.Mm.afc,"showZoomDialog")),this.ga.gb(Ra.a.kdn,uc.a.frame,Object(a.a)(this.Mm,this.Mm.tzi,"onQueryZoomText"),96),this.ga.pa(Ra.a.g5c,uc.a.frame,Object(a.a)(this.Mm,this.Mm.Lmj,"zoomDialogTabFocusHandler")),this.ga.pa(Ra.a.f5c,uc.a.frame,Object(a.a)(this.Mm,this.Mm.Lmj,"zoomDialogTabFocusHandler")));this.Oa.$("ZoomSliderIsEnabled")&&(this.ga.gb(Ra.a.NIi,uc.a.frame,Object(a.a)(this.Mm,this.Mm.OVm,
"onQueryZoomPercentage"),96),this.ga.gb(Ra.a.Omj,uc.a.frame,Object(a.a)(this.Mm,this.Mm.lZm,"onZoomToPercentage"),96),this.ga.pa(Ra.a.Hvo,uc.a.frame,Me.ActionManager.Nf))}}Object(e.a)(kf,"CommonZoomActor",null,[922]);class Nf extends kf{constructor(Q,ya,gb){super(Q,ya,gb);this.$ca=ya}Vb(){super.Vb();this.Oa.$("ZoomPopupDialogIsEnabled")&&(this.ga.pa(Rf.a.Nag,uc.a.frame,Me.ActionManager.Nf),this.ga.pa(Rf.a.Iee,uc.a.frame,Object(a.a)(this.$ca,this.$ca.Gvo,"zoomTo100")));this.ga.pa(Rf.a.zoomToPageWidth,
uc.a.frame,Object(a.a)(this.$ca,this.$ca.zoomToPageWidth,"zoomToPageWidth"));this.ga.pa(Ra.a.gfb,uc.a.frame,Object(a.a)(this.$ca,this.$ca.gfb,"increaseZoom"));this.ga.pa(Ra.a.Kbb,uc.a.frame,Object(a.a)(this.$ca,this.$ca.Kbb,"decreaseZoom"));this.ga.pa(Rf.a.tWf,uc.a.frame,Object(a.a)(this.$ca,this.$ca.tQn,"setZoomLevelFromRibbon"));this.ga.gb(Rf.a.ijb,uc.a.frame,Object(a.a)(this.$ca,this.$ca.tzi,"onQueryZoomText"),96);this.ga.gb(Rf.a.k2d,Kh.a.application,Object(a.a)(this.$ca,this.$ca.NVm,"onQueryZoomLevelLabelText"),
96);this.ga.pa(Xg.a.iwh,uc.a.frame,Me.ActionManager.Nf);this.ga.pa(Xg.a.hwh,uc.a.frame,Me.ActionManager.Nf);this.ga.pa(Xg.a.mwh,uc.a.frame,Me.ActionManager.Nf);this.ga.pa(Xg.a.jwh,uc.a.frame,Me.ActionManager.Nf);this.ga.pa(Rf.a.vha,uc.a.frame,Me.ActionManager.Nf)}}Object(e.a)(Nf,"WordEditorZoomActor",kf,[]);class Fg{constructor(Q,ya){this.zoom=Q;this.rak=ya}}Object(e.a)(Fg,"SetCustomZoomArgs",null,[]);var gk=d(1128);class yi{constructor(Q,ya){this.WQk=[CommonUIStrings.l_FullPage,CommonUIStrings.l_PageWidth,
"200%","150%","100%","75%","50%"];this.XQk=[yi.M3e,yi.uzd,"200","150","100","75","50"];this.xka=3;this.NM=0;this.delta=.1;this.swf=0;this.me=new k.a;this.jg=null;this.K=Q;this.zc=ya;this.c1i(1)}get vj(){return this.NM}c1i(Q){this.NM=Q}get kDc(){return Math.round(100*this.vj)}get tLm(){return Math.floor(this.kDc/10)/10+this.delta}get sLm(){return Math.ceil(this.kDc/10)/10-this.delta}get ga(){return H.AFrameworkApplication.ya}s9j(Q){this.me.addHandler("ZoomChanged",Q)}tsn(Q){this.me.removeHandler("ZoomChanged",
Q)}h7(Q){this.s9j(Q)}Bjb(Q){this.tsn(Q)}qMi(){}gOi(){}pMi(){}fOi(){}h5c(Q){this.Mmj(Q,this.vj)}Mmj(Q,ya){null!==Q&&Rq.a.kOn(Q,ya)}DZf(Q,ya=!0){let gb=Q*=100;this.K&&this.K.$("DoNotAutoScrollAfterPinchIsEnabled")&&(gb=new Fg(Q,ya));this.DYi(gb)}sQn(Q,ya=!1){this.vha(Q,3|(ya?0:4))}jZm(Q,ya,gb){if(1===Q)return 32;Q=gb/100;Q<this.hSc?Q=this.hSc:Q>this.RRc&&(Q=this.RRc);this.vha(Q,1);ya&&(ya.Lr=Math.floor(100*Q));return 32}tzi(Q,ya,gb,Ob,mc){if(1===gb)return 32;Q=Tb.a.NAa(this.kDc,6,H.AFrameworkApplication.numberFormat);
mc.Value=Q;mc.LabelText=Q;return 32}lZm(Q,ya,gb,Ob,mc){return 1===gb?32:this.jZm(gb,Ob,mc.value)}OVm(Q,ya,gb,Ob,mc){mc.MinValue=100*this.hSc;mc.MaxValue=100*this.RRc;mc.value=this.kDc;return 32}m1h(){return this.WQk}n1h(){return this.XQk}Kol(){let Q=Math.floor(100*this.vj).toString();1===this.xka?Q=yi.M3e:2===this.xka&&(Q=yi.uzd);return Q}gfb(Q,ya,gb){if(1===gb)return 32;this.rRc(this.zc?this.zc.IG:0,"IncreaseZoom");this.xka=0;this.vha(this.tLm);return 32}Kbb(Q,ya,gb){if(1===gb)return 32;this.rRc(this.zc?
this.zc.IG:0,"DecreaseZoom");this.xka=0;this.vha(this.sLm);return 32}tQn(Q,ya,gb,Ob,mc){if(1===gb)return 32;this.rRc(this.zc?this.zc.IG:0,"SetZoomLevelFromRibbon");Q=mc.Value;if(Q.toLowerCase().startsWith("fit"))return Q=new dc.a(0,1,0,()=>{this.zoomToPageWidth(0,null,2,null,null)},138,void 0,!0),fg.a.instance.$b(Q),32;Q=parseInt(Q)/100;if(isNaN(Q))return 2;this.xka=0;this.vha(Q);return 32}rRc(Q,ya){la.ULS.sendTraceTag(42341577,353,50,"Update Zoom. CommandLocation: {0}; Command: {1}; IsSLR: {2}",
Q,ya,H.AFrameworkApplication.ua.Sb.fq)}afc(Q,ya,gb){if(1===gb)return 32;la.ULS.sendTraceTag(7176728,353,50,"Customer is trying to trigger the Zoom dialog");this.showDialog();return 32}showDialog(){const Q=this.Kol();this.jg=new gk.a(this.m1h(),this.n1h(),Object(a.a)(this,this.lVl,"handleZoomDialogResult"),sd.FocusManager.instance(),!0);this.jg.afc(CommonUIStrings.l_ZoomDialogTitle,Q)}Dbm(Q){return Q.toLowerCase()===yi.M3e.toLowerCase()}Ebm(Q){return Q.toLowerCase()===yi.uzd.toLowerCase()}lVl(Q){if(Q){if(this.Dbm(Q)){this.xka=
1;var ya=32}else if(this.Ebm(Q))this.xka=2,ya=this.zoomToPageWidth(0,null,2,null,null);else if(ya=Number.parseInvariant(Q)){this.xka=0;let gb=ya;this.K&&this.K.$("DoNotAutoScrollAfterPinchIsEnabled")&&(gb=new Fg(ya,!0));ya=this.DYi(gb)}else ya=8;32===ya?la.ULS.sendTraceTag(7176729,353,50,"Succeeded to Zoom: {0}",{["DialogResult"]:Q}):la.ULS.sendTraceTag(7156360,353,10,"Failed to Zoom: {0}",{["DialogResult"]:Q})}else la.ULS.sendTraceTag(529290753,353,10,"Failed to Zoom: {0}",{["DialogResult"]:Q})}jfn(){this.me.raiseEvent("ZoomChanged",
null)}rJi(){}LPf(){}Lmj(Q){if(!this.jg)return 2;var ya=this.jg.Ci.Gs().Vj.N1;if(ya===this.jg.hz&&Q===Ra.a.g5c||ya===this.jg.kG&&Q===Ra.a.f5c)this.jg.Pub||this.jg.UDn(),this.jg.Ci.Gs().Vj.oy(this.jg.Pub);else if(ya.id.startsWith(this.jg.MWc)||ya.className.startsWith(this.jg.XIi))ya=null,Q===Ra.a.g5c?ya=this.jg.kG:Q===Ra.a.f5c&&(ya=this.jg.hz),this.jg.Ci.Gs().Vj.oy(ya),Sys.UI.DomElement.removeCssClass(this.jg.Pub.parentNode,this.jg.CPf);else if(Q===Ra.a.g5c)this.jg.Ci.Gs().P9b();else if(Q===Ra.a.f5c)this.jg.Ci.Gs().N9b();
else return 2;return 32}}yi.M3e="FullPage";yi.uzd="PageWidth";Object(e.a)(yi,"ZoomManager",null,[825]);var hk;(function(Q){Q[Q.manual=0]="manual";Q[Q.fitToFullPage=1]="fitToFullPage";Q[Q.fitWidth=2]="fitWidth";Q[Q.onBoot=3]="onBoot"})(hk||(hk={}));Object(e.b)("ZoomStatus",hk);d(1027);var Vj;(function(Q){Q[Q.normal=0]="normal";Q[Q.quiet=1]="quiet";Q[Q.disableScrollUpdate=2]="disableScrollUpdate";Q[Q.disableUiControlUpdate=4]="disableUiControlUpdate"})(Vj||(Vj={}));Object(e.b)("ZoomUpdateFlags",Vj);
var pk=d(257),vq=d(354),io=d(1184);class ru extends yi{constructor(Q,ya,gb,Ob,mc,dd,Md){super(Q,ya);this.nso=[CommonUIStrings.l_PageWidth,"200%","150%","125%","100%","75%","50%"];this.oso=[yi.uzd,"200","150","125","100","75","50"];this.MLe=this.SRi=!1;this.Cvg="AutoFitForAdaptiveLayout";this.ODj="FitPageWidthFailure";this.dZj="UpdateZoomFailure";this.B_j="wwf";this.bNe=null;this.$2d=()=>{this.xka===hk.fitWidth&&this.N9e()};this.nPk=He=>{if(He.ctrlKey&&(H.AFrameworkApplication.ya.processAction(Xg.a.jwh,
2),this.z_j)){He=He.sro;if(!He)return!1;this.vha(this.vj-(0<He?.1:-.1));this.rRc(6,"CtrlScroll");return!0}return!1};this.kZm=()=>{la.ULS.sendTraceTag(42341578,353,50,"Click event detected on Zoom Label. IsSLR: {0}",!0);return!0};this.RV=gb;this.Kj=Ob;this.Wb=mc;this.ig=dd;this.$nc=Md;this.fNg=Q.$("KeepViewAfterZoomIsEnabled");this.C_j=Q.$("ZoomShortCutIsEnabled");this.z_j=Q.getBooleanFeatureGate("Microsoft.Office.WordOnline.EnableZoomScroll",!1);this.rZj=Q.$("DoNotAutoScrollAfterPinchIsEnabled");
this.pIj=(this.yte=Q.$("AdaptiveLayoutForSmallScreenModeIsEnabled"))&&Q.$("AutoFitForSmallScreenModeIsEnabled");this.PBj=Q.$("DoNotProcessUpdateZoomActionIsEnabled");this.D_j=Q.$("ZoomSliderIsEnabled");this.Xy()}get appName(){return"WordEditor"}get RRc(){return 4}get hSc(){return.1}get oPk(){return wacBoot.CtrlWheelMetrics}H8j(Q){this.me.addHandler("PinchStart",Q)}isn(Q){this.me.removeHandler("PinchStart",Q)}G8j(Q){this.me.addHandler("PinchEnd",Q)}hsn(Q){this.me.removeHandler("PinchEnd",Q)}get $I(){return null!=
this.xqg?this.xqg:this.xqg=qa.a.instance.Pa("WordEditor.IStatusBarUser")}ajj(Q){Q=!(Q&Vj.disableUiControlUpdate);const ya=eb.a.get_instance().isCompleted(7);return Q&&ya?(Q={SelectZoomOption:"ComboBoxModel"},Ae.App.xa&&Ae.App.xa.hG(Q),this.eno(),!0):!1}vha(Q,ya=Vj.normal){let gb=!0;this.PBj||H.AFrameworkApplication.ya.processAction(Rf.a.vha,2);if(this.vj===Q)return this.MLe||(this.MLe=this.ajj(ya)),gb;Q>this.RRc?Q=this.RRc:Q<this.hSc&&(Q=this.hSc);var Ob=!!(ya&Vj.quiet);1===Q||Ob||H.AFrameworkApplication.ya.processAction(Rf.a.Nag,
2);try{Ob=null;Ae.App.xa&&Object(mn.a)(io.PageView,Ae.App.xa.jb.Ic)&&(Ob=Ae.App.xa.jb.Ic);let mc=-1,dd=-1,Md=-1;const He=!(ya&Vj.disableScrollUpdate);this.fNg&&He&&(mc=bh.SelectionEditor.ROl(mf.a.instance.hb.kb,Ob),dd=Ob.wK.scrollLeft,Md=Ob.wK.scrollTop);const Ue=this.vj;this.c1i(Q);this.jfn();this.MLe=this.ajj(ya);He&&this.Dlo(Ob,mc,dd,Md,Ue)}catch(mc){gb=!1,la.ULS.sendTraceTag(7185431,353,10,"UpdateZoom error:{0}",mc)}return gb}Dlo(Q,ya,gb,Ob,mc){Q&&Q.isActive?this.fNg?0<=ya&&100>=ya?Q.kw.Waa(100-
ya,!0,!0):Q.kw.Eom(gb,Ob,mc,this.vj):Q.kw.Waa():la.ULS.sendTraceTag(7185430,353,10,"UpdateZoom: Failed to get PageView to scroll content")}Gvo(Q,ya,gb){2===gb&&(this.rRc(this.zc?this.zc.IG:0,"ZoomTo100"),this.xka=hk.manual,this.vha(1));return 32}DYi(Q){this.xka=hk.manual;let ya,gb=!0;if(this.rZj){if(!Object(mn.a)(Fg,Q))return la.ULS.sendTraceTag(51644238,353,10,"actiondata is not a SetCustomZoomArgs"),8;ya=Q.zoom/100;gb=Q.rak}else ya=Number.parseInvariant(String.format("{0}",Q))/100;la.ULS.sendTraceTag(7410915,
353,50,"Word Editor - Zoom to custom value: {0}",ya);Q=Vj.normal;gb||(Q=Vj.disableScrollUpdate);this.vha(ya,Q);return 32}zoomToPageWidth(Q,ya,gb){if(1===gb)return 32;la.ULS.sendTraceTag(7410944,353,50,"Word Editor - Zoom to fit page width");Object(Ie.a)("ZoomToPageWidth",!0);this.xka=hk.fitWidth;this.p3k();return this.N9e()}NVm(Q,ya,gb,Ob,mc){if(1===gb)return 32;Q=Tb.a.NAa(this.kDc,6,H.AFrameworkApplication.numberFormat);mc[pk.a.labelText]=Q;return 32}m1h(){return this.nso}n1h(){return this.oso}p3k(){this.SRi||
(Ae.App.xa?(Ae.App.xa.o1(this.$2d),this.SRi=!0):la.ULS.sendTraceTag(7185432,353,10,"EnsureResizeEventRegistered: Failed to get PageManager to register event"))}N9e(){var Q=Ae.App.xa?Ae.App.xa.jb.Ic:null;if(Q&&Ae.App.xa.lC){var ya=null;(Q=this.Hol(Q))&&(ya=this.RV.$L(Q));ya||(ya=this.RV.Zdf());if(null!==ya)return ya=zo.a.instance.Jv(ya),ya=wn.a.Pi(ya,0),Q=this.$nc(),ya+=Q&&Q.Z7d()?wacBoot.ShiftUtils.getFloatingObjectsContainerWidth():0,ya+=2*vq.a.nag,this.vha(Ae.App.xa.lC.offsetWidth/ya),32;la.ULS.sendTraceTag(7185433,
353,10,"Zoom to page width: cannot find word section node.")}else la.ULS.sendTraceTag(7185434,353,10,"Zoom to page width: cannot find editing view node.");return 8}Hol(Q){return Q&&Q.Cb&&Q.Cb.hb.kb&&Q.Cb.hb.kb.Qa&&Q.Cb.hb.kb.Qa.node?Q.Cb.hb.kb.Qa.node:null}eno(){this.$I&&(this.D_j?(this.$I.MQ(wp.a.Cvo),this.$I.MQ(wp.a.Dvo)):this.$I.MQ(wp.a.Evo))}R2n(Q){Q||(Q=window.self.CtrlWheelMetrics);if(Q){var ya=Q.ctrlWheelOccurred;if("boolean"!==typeof ya)la.ULS.sendTraceTag(594346948,353,15,"ctrlWheelMetrics module not found");
else{la.ULS.sendTraceTag(594346947,353,50,"ctrlWheelOccurred: {0}",ya);try{Q.stop()}catch(gb){la.ULS.sendTraceTag(594346946,326,15,"Exception: {0}",gb)}}}else la.ULS.sendTraceTag(594346949,353,15,"ctrlWheelMetrics module not found")}Xy(){this.R2n(this.oPk);if(this.Kj){var Q=document.getElementById(qm.AppFrame.Yzd);Q&&this.Kj.mb(B.a.Bhb,Q,this.nPk)}this.Wb&&(Q=this.Wb.re(qm.AppFrame.pF),this.C_j&&(Q.bindAction(Jf.KeyInputManager.lc(cg.a.Lhc,Jf.KeyInputManager.Mh),Ra.a.gfb),Q.bindAction(Jf.KeyInputManager.lc(cg.a.t4c,
Jf.KeyInputManager.Mh),Ra.a.gfb),Q.bindAction(Jf.KeyInputManager.lc(cg.a.Mhc,Jf.KeyInputManager.Mh),Ra.a.Kbb),Q.bindAction(Jf.KeyInputManager.lc(cg.a.Nhc,Jf.KeyInputManager.Mh),Ra.a.Kbb),Q.bindAction(Jf.KeyInputManager.lc(cg.a.Y5c,Jf.KeyInputManager.Mh),Rf.a.Iee)));this.ig&&(this.bNe=document.getElementById("LabelShowZoomValue-MediumCompact"))&&this.ig.mb(B.a.click,this.bNe,this.kZm);this.pIj&&(Ae.App.xa.wu.registerLayoutBreakpointChanged("canvas",ya=>{this.xSe(ya)}),Ae.App.xa.wu.registerBoundingWindowRectsChanged("canvas",
()=>{this.xSe(Ae.App.xa.wu.getLayoutBreakpoint())}))}xSe(Q){let ya=!0,gb="";if(this.xka!==hk.onBoot)return ya;Ha.Health.instance.recordKpiUsage(this.Cvg,0,this.B_j,null);switch(Q){case "Small":8===this.N9e()&&(gb=this.ODj,ya=!1);break;default:1===this.vj||this.vha(1)||(gb=this.dZj,ya=!1)}ya||Ha.Health.instance.recordKpiFailure(this.Cvg,gb,!0,!0,null);return ya}qMi(Q){this.H8j(Q)}gOi(Q){this.isn(Q)}pMi(Q){this.G8j(Q)}fOi(Q){this.hsn(Q)}rJi(){this.me.raiseEvent("PinchStart",null)}LPf(){this.me.raiseEvent("PinchEnd",
null)}}Object(e.a)(ru,"WordEditorZoomManager",yi,[1719,825]);class zp{constructor(){this.W=null}get name(){return"WordEditor.Zoom"}init(){if(H.AFrameworkApplication.K.$("ZoomPopupDialogIsEnabled")){const Q=this.W.resolve("WordEditor.Zoom.WordEditorZoomActor"),ya=this.W.resolve("WordEditor.Zoom.WordEditorZoomManager");Q.Vb();Sys.UI.DomElement.overrideGetBounds=!0;H.AFrameworkApplication.K.$("AdaptiveLayoutForSmallScreenModeIsEnabled")&&H.AFrameworkApplication.K.$("AutoFitForSmallScreenModeIsEnabled")&&
ya&&eb.a.get_instance().tl(4,()=>{ya.xSe(Ae.App.xa.wu.getLayoutBreakpoint())||la.ULS.sendTraceTag(578326819,353,15,"Auto fit for adaptive layout failed during boot.")})}}dispose(){}yc(Q){this.W=Q;H.AFrameworkApplication.K.$("ZoomPopupDialogIsEnabled")&&(this.W.ha("WordEditor.Zoom.WordEditorZoomManager",()=>new ru(H.AFrameworkApplication.K,H.AFrameworkApplication.ya,Ii.WordSectionNavigator.instance,Pj.a.instance,sd.FocusManager.instance(),ql.a.instance,()=>Q.Pa("Box4.IFloatingObjectUpdater"))).singleInstance().as("Common.IZoomManager").as("WordEditor.IWordEditorZoomManager"),
this.W.ha("WordEditor.Zoom.WordEditorZoomActor",()=>new Nf(H.AFrameworkApplication.ya,this.W.resolve("WordEditor.Zoom.WordEditorZoomManager"),H.AFrameworkApplication.K)).singleInstance())}static main(){ca.a.instance.Oc(new zp)}}Object(e.a)(zp,"ZoomPackage",null,[1,2]);var Il=window.FormatPictureTaskPaneData={name:"CommandUI",attrs:{xmlns:"http://schemas.microsoft.com/sharepoint/"},children:[{name:"TaskPane",attrs:{Id:"FormatPictureTaskPane",Title:"STR@L_FormatPicture",Width:"300",ImageCollapsedArrow:"IMGMAP@we@ArrowCollapsedRest_16x16x32",
ImageExpandedArrow:"IMGMAP@we@ArrowExpandedRest_16x16x32",ImageDownArrow:"IMGMAP@we@SplitButtonArrow_5x3x32",ImageDownArrow8by8:"IMGMAP@we@SplitButtonArrow_8x8x32",ImageUpArrow:"IMGMAP@we@RibbonUpArrow_5x3x32",ImageUpArrow8by8:"IMGMAP@we@RibbonUpArrow_8x8x32",ImageCheckMark:"IMGMAP@we@CheckboxChecked_16x16x32",ImageUncheckMark:"IMGMAP@we@CheckboxUnchecked_16x16x32"},children:[{name:"Groups",attrs:{},children:[{name:"Group",attrs:{Id:"GroupFormatPictureControls",IsStretched:"false"},children:[{name:"Section",
attrs:{Id:"GroupFormatPictureControlsSection"},children:[{name:"Row",attrs:{Id:"NavControls",DisplayMode:"Large30",TextAlign:"Left"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"btnProperties",Command:"0x62A2D4C0",Image30by30:"IMGMAP@we@FormatObjectProperties_30x30x32",LabelText:"STR@L_Properties"}},{name:"Button",attrs:{Id:"btnPicture",Command:"0x7136810D",Image30by30:"IMGMAP@we@FormatObjectPictureOptions_30x30x32",LabelText:"STR@L_Picture"}}]}]}]}]},{name:"Group",attrs:{Id:"GroupAllInOne",
IsStretched:"true",TextAlign:"Right"},children:[{name:"CollapsibleSection",attrs:{Id:"AltTextCollapsibleSection",Title:"STR@l_AlternativeTextDialogTitle"},children:[{name:"Section",attrs:{Id:"altTextSection"},children:[{name:"Row",attrs:{DisplayMode:"Medium"},children:[{name:"Controls",attrs:{},children:[{name:"TextBox",attrs:{Id:"txtBoxAltTextTitle",Alt:"STR@l_AlternativeTextTitleCaption",LabelText:"STR@l_AlternativeTextTitleCaption",Command:"0x3507A2B1",QueryCommand:"0x36DB7495",DisplayMode:"Medium",
MaxLength:"65536",AdditionalLabelBy:"AltTextCollapsibleSection-Title",Height:"30px",IsStretchedHorizontally:"true"}}]}]},{name:"Row",attrs:{DisplayMode:"Medium"},children:[{name:"Controls",attrs:{},children:[{name:"TextBox",attrs:{Id:"txtBoxAltTextDescription",Alt:"STR@l_AlternativeTextDescriptionCaption",LabelText:"STR@l_AlternativeTextDescriptionCaption",Command:"0x61FE1E53",QueryCommand:"0x416A13E3",DisplayMode:"Medium",MaxLength:"65536",AdditionalLabelBy:"AltTextCollapsibleSection-Title",Height:"180px",
IsStretchedHorizontally:"true",IsMultiline:"true"}}]}]}]}]},{name:"CollapsibleSection",attrs:{Id:"CropCollapsibleSection",Title:"STR@L_Crop"},children:[{name:"Section",attrs:{Id:"leftCropSection"},children:[{name:"Row",attrs:{DisplayMode:"Medium",Height:"29px"},children:[{name:"Controls",attrs:{},children:[{name:"Label",attrs:{Id:"lblCropTop",LabelText:"STR@L_Top",For:"spnCropTop"}}]}]},{name:"Row",attrs:{DisplayMode:"Medium",Height:"29px"},children:[{name:"Controls",attrs:{},children:[{name:"Label",
attrs:{Id:"lblCropBottom",LabelText:"STR@L_Bottom",For:"spnCropBottom"}}]}]},{name:"Row",attrs:{DisplayMode:"Medium",Height:"29px"},children:[{name:"Controls",attrs:{},children:[{name:"Label",attrs:{Id:"lblCropLeft",LabelText:"STR@L_Left",For:"spnCropLeft"}}]}]},{name:"Row",attrs:{DisplayMode:"Medium",Height:"29px"},children:[{name:"Controls",attrs:{},children:[{name:"Label",attrs:{Id:"lblCropRight",LabelText:"STR@L_Right",For:"spnCropRight"}}]}]}]},{name:"Section",attrs:{Id:"rightCropSection",HorizontalAlignment:"Right"},
children:[{name:"Row",attrs:{DisplayMode:"Medium",Height:"29px"},children:[{name:"Controls",attrs:{},children:[{name:"Spinner",attrs:{Id:"spnCropTop",Alt:"STR@L_CropTopTooltip",Command:"0xDF8DEBBA",QueryCommand:"0xB9089B94",LabelledBy:"CropCollapsibleSection-Title lblCropTop-Medium"},children:[{name:"Unit",attrs:{UnitType:"pixels",MinimumValue:"0",MaximumValue:"1920",Step:"1"}}]}]}]},{name:"Row",attrs:{DisplayMode:"Medium",Height:"29px"},children:[{name:"Controls",attrs:{},children:[{name:"Spinner",
attrs:{Id:"spnCropBottom",Alt:"STR@L_CropBottomTooltip",Command:"0x091D0734",QueryCommand:"0xA3D9079E",LabelledBy:"CropCollapsibleSection-Title lblCropBottom-Medium"},children:[{name:"Unit",attrs:{UnitType:"pixels",MinimumValue:"0",MaximumValue:"1920",Step:"1"}}]}]}]},{name:"Row",attrs:{DisplayMode:"Medium",Height:"29px"},children:[{name:"Controls",attrs:{},children:[{name:"Spinner",attrs:{Id:"spnCropLeft",Alt:"STR@L_CropLeftTooltip",Command:"0x2F92B28A",QueryCommand:"0x037C5130",LabelledBy:"CropCollapsibleSection-Title lblCropLeft-Medium"},
children:[{name:"Unit",attrs:{UnitType:"pixels",MinimumValue:"0",MaximumValue:"1920",Step:"1"}}]}]}]},{name:"Row",attrs:{DisplayMode:"Medium",Height:"29px"},children:[{name:"Controls",attrs:{},children:[{name:"Spinner",attrs:{Id:"spnCropRight",Alt:"STR@L_CropRightTooltip",Command:"0x52A3310D",QueryCommand:"0x2AA307AB",LabelledBy:"CropCollapsibleSection-Title lblCropRight-Medium"},children:[{name:"Unit",attrs:{UnitType:"pixels",MinimumValue:"0",MaximumValue:"1920",Step:"1"}}]}]}]}]}]},{name:"CollapsibleSection",
attrs:{Id:"RotateCollapsibleSection",Title:"STR@L_Rotation"},children:[{name:"Section",attrs:{Id:"leftRotateSection"},children:[{name:"Row",attrs:{DisplayMode:"Medium",Height:"29px"},children:[{name:"Controls",attrs:{},children:[{name:"Label",attrs:{Id:"lblRotationAngle",LabelText:"STR@L_RotationAngle",For:"spnRotateAngle"}}]}]}]},{name:"Section",attrs:{Id:"rightRotateSection",HorizontalAlignment:"Right"},children:[{name:"Row",attrs:{DisplayMode:"Medium",Height:"29px"},children:[{name:"Controls",
attrs:{},children:[{name:"Spinner",attrs:{Id:"spnRotateAngle",Alt:"STR@L_RotationSpinnerTooltip",Command:"0x97B9E874",QueryCommand:"0xD63D3722",LabelledBy:"RotateCollapsibleSection-Title lblRotationAngle-Medium"},children:[{name:"Unit",attrs:{UnitType:"degree",MinimumValue:"0",MaximumValue:"360",Step:"1"}}]}]}]}]}]}]}]}]}]},jp=window.InteractivePerfTaskPaneData={name:"CommandUI",attrs:{xmlns:"http://schemas.microsoft.com/sharepoint/"},children:[{name:"TaskPane",attrs:{Id:"InteractivePerfTaskPane",
Title:"Interactive Perf TaskPane",Width:"400"},children:[{name:"Groups",attrs:{},children:[{name:"Group",attrs:{Id:"TypingSpeedMeterGroup"}},{name:"Group",attrs:{Id:"CpuMeterGroup"}},{name:"Group",attrs:{Id:"RenderGroup"}}]}]}]};class ys extends sc.a{constructor(Q){super(!1,!1,!0);this.m6c=Q}start(){const Q={["id"]:"AccessibilitySettingsDialog",["bodyControls"]:{["tooltipPersistenceEnabled"]:this.m6c.Slf}};this.Wh("",Object(a.a)(this,this.nyn,"resultHandler"),Q)}nyn(Q,ya){1===Q&&(this.m6c.Slf=ya.tooltipPersistenceEnabled)}}
Object(e.a)(ys,"AccessibilitySettingsDialog",sc.a,[]);class Ir{constructor(Q,ya){this.ga=Q;this.m6c=ya}Vb(){this.ga.pa(Ra.a.kWn,uc.a.frame,Object(a.a)(this,this.lWn,"showAccessibilitySettingsDialogHandler"))}lWn(){(new ys(this.m6c)).start();return 32}}Object(e.a)(Ir,"AccessibilitySettingsDialogActor",null,[1787]);const Wt=Q=>{const ya=new t.a;H.AFrameworkApplication.Xe.Lj(Kq(Q),1,null,null,!0,2,gb=>{200===gb.data.wf?ya.Gg("true"===gb.data.Ge.toLowerCase()):ya.Gg(!1)},()=>{ya.Gg(!1)},null,void 0,void 0,
void 0,void 0,"7");return ya.task},Kq=Q=>String.format("{0}RoamingServiceHandler.ashx?action={1}&{2}",H.AFrameworkApplication.K.appSettings.RoamingServiceHandlerWebServiceBase||"",Q,H.AFrameworkApplication.xm);class Dn{constructor(){this.XQb=null}get Slf(){return!!this.XQb}set Slf(Q){Q!==this.XQb&&(this.XQb=Q,Jg.a("setHoverableTooltipsPreference")&&appChrome.api.setHoverableTooltipsPreference(Q),this.Fgi()&&H.AFrameworkApplication.Xe.Lj(Kq("saveHoverableRibbonTooltipIsEnabled"),2,Q.toString().toLowerCase(),
null,!0,2,null,null,null,void 0,void 0,void 0,void 0,"8"))}Osm(){const Q=new t.a;if(this.XQb)Q.Gg(this.XQb);else if(this.Fgi()){const ya=Wt("getHoverableRibbonTooltipIsEnabled");ya.continueWith(()=>{this.XQb=ya.result;Jg.a("setHoverableTooltipsPreference")&&appChrome.api.setHoverableTooltipsPreference(ya.result);Q.Gg(ya.result)},8)}else Q.Gg(!1)}Fgi(){const Q=H.AFrameworkApplication.K.$("IsRoamingServiceEnabled"),ya=H.AFrameworkApplication.K.$("IsAnonymousUser");return Q&&!ya}}Object(e.a)(Dn,"AccessibilitySettingsInfo",
null,[1742]);class Ml{constructor(){this.W=null}get name(){return"Common.App.AccessibilitySettings"}yc(Q){this.W=Q;this.W.register(Dn,"Common.App.AccessibilitySettings.AccessibilitySettingsInfo").as("Common.App.AccessibilitySettings.IAccessibilitySettingsInfo").Yd(()=>new Dn).singleInstance();this.W.register(Ir,"Common.App.AccessibilitySettings.AccessibilitySettingsDialogActor").as("Common.App.AccessibilitySettings.IAccessibilitySettingsDialogActor").Yd(()=>new Ir(H.AFrameworkApplication.ya,this.W.Pa("Common.App.AccessibilitySettings.IAccessibilitySettingsInfo"))).singleInstance()}init(){const Q=
this.W.Pa("Common.App.AccessibilitySettings.IAccessibilitySettingsInfo"),ya=this.W.Pa("Common.App.AccessibilitySettings.IAccessibilitySettingsDialogActor");Q&&ya?(ya.Vb(),Q.Osm()):v.b(539637639,200,15,"Failed to resolve IAccessibilitySettingsDialogActor or IAccessibilitySettingsInfo. A11y dialog feature is not enabled.")}dispose(){}static main(){ca.a.instance.Oc(new Ml)}}Object(e.a)(Ml,"AccessibilitySettingsPackage",null,[1,2]);class kp{constructor(){this.events=[];this.OTf=!1}static gvf(Q){return Q.ctrlKey&&
"Control"!==Q.key||Q.altKey&&"Alt"!==Q.key||!!kp.Lom[Q.key]}static imk(Q,ya){let gb;gb=kp.gvf(Q)?Q.key:" "===Q.key?"Space":"CharacterKey";return null!=ya?(ya.altPressed=(!!Q.altKey).toString(),ya.ctrlPressed=(!!Q.ctrlKey).toString(),ya.key=gb,ya.repeat=(!!Q.repeat).toString(),ya.shiftPressed=(!!Q.shiftKey).toString(),ya):{["altPressed"]:(!!Q.altKey).toString(),["ctrlPressed"]:(!!Q.ctrlKey).toString(),["key"]:gb,["repeat"]:(!!Q.repeat).toString(),["shiftPressed"]:(!!Q.shiftKey).toString()}}static Pfi(Q){return window.performance&&
window.performance.now&&Q.timeStamp<performance.now()}static gFh(Q){return!!Q&&kp.Pfi(Q)&&kp.gvf(Q)}static hFh(Q){return!!Q&&kp.Pfi(Q)&&!kp.gvf(Q)}keyPressedEventHandlerStart(Q,ya){kp.hFh(Q)&&this.Y7i(Q,ya)}keyPressedEventHandlerEnd(Q){kp.hFh(Q)&&this.B8i(Q)}keyDownEventHandlerStart(Q,ya){kp.gFh(Q)&&this.Y7i(Q,ya)}keyDownEventHandlerEnd(Q){kp.gFh(Q)&&this.B8i(Q)}Y7i(Q,ya){Q={["metadata"]:kp.imk(Q,ya),["timeStamp"]:this.Tgc(Q.timeStamp),["timeToHandlerFinishMs"]:0,["timeToHandlerStartMs"]:this.Tgc(performance.now()-
Q.timeStamp),["eventDurationMs"]:0,["timeToRequestAnimationFrameMs"]:0};this.events.push(Q);this.Ymn()}B8i(Q){if(0!==this.events.length){var ya=this.Tgc(Q.timeStamp);for(let gb=this.events.length-1;0<=gb;--gb){const Ob=this.events[gb];if(Ob.timeStamp===ya){Ob.timeToHandlerFinishMs=this.Tgc(performance.now()-Q.timeStamp);Ob.eventDurationMs=this.Tgc(Ob.timeToHandlerFinishMs-Ob.timeToHandlerStartMs);break}}}}Tgc(Q){return Number(Q.toFixed(2))}Ymn(){if(!this.OTf){const Q=document.createEvent("CustomEvent");
Q.initCustomEvent("aggregateeventtimingstart",!1,!1,null);dispatchEvent(Q);requestAnimationFrame(()=>{this.OTf=!1;const ya=performance.now();this.events.forEach(Ob=>{Ob.timeToRequestAnimationFrameMs=this.Tgc(ya-Ob.timeStamp)});var gb=document.createEvent("CustomEvent");gb.initCustomEvent("aggregateeventtiming",!1,!1,this.events.slice(0));dispatchEvent(gb);this.events=[];gb=document.createEvent("CustomEvent");gb.initCustomEvent("aggregateeventtimingstop",!1,!1,null);dispatchEvent(gb)});this.OTf=!0}}}
kp.Lom={["ArrowDown"]:!0,["ArrowLeft"]:!0,["ArrowRight"]:!0,["ArrowUp"]:!0,["Backspace"]:!0,["Delete"]:!0,["End"]:!0,["Enter"]:!0,["Escape"]:!0,["Home"]:!0,["PageDown"]:!0,["PageUp"]:!0,["Tab"]:!0};class $p{constructor(){this.q4d=this.x0a=this.cNa=this.t9b=null;this.J7b=!1;this.scc=null;this.MGc=[];this.J3c=()=>{$p.Bhm()&&null==this.x0a?(this.cNa=null,this.x0a=requestAnimationFrame(this.TRc)):null!=this.x0a&&(cancelAnimationFrame(this.x0a),this.x0a=null)};this.TRc=Q=>{if(null!=this.cNa){const ya=
Q-this.cNa;if(null==this.t9b||this.t9b<ya)this.t9b=ya;for(let gb=0;gb<$p.ranges.length;++gb)if(ya<$p.ranges[gb]){++this.MGc[gb];break}}this.cNa=Q;this.x0a=requestAnimationFrame(this.TRc)};this.CQi=()=>{if(null!=this.t9b){var Q={};for(var ya=0;ya<$p.ranges.length;++ya)Q[$p.ranges[ya]]=this.MGc[ya],this.MGc[ya]=0;ya=performance.now();Q={["intervalStart"]:this.scc,["intervalEnd"]:ya,["maxFrameLengthMs"]:this.t9b,["frameData"]:Q};var gb=document.createEvent("CustomEvent");gb.initCustomEvent("reportframetiming",
!1,!1,Q);dispatchEvent(gb);this.t9b=null;this.scc=ya}}}static Esf(){return!!window.performance&&!!window.performance.now}start(Q){!this.J7b&&$p.Esf()&&(this.OQn(),this.q4d=setInterval(this.CQi,1E3*Q),this.scc=performance.now(),this.J3c(),document.addEventListener("visibilitychange",this.J3c),this.J7b=!0)}stop(){this.J7b&&(document.removeEventListener("visibilitychange",this.J3c),null!=this.q4d&&(clearInterval(this.q4d),this.q4d=null),null!=this.x0a&&(cancelAnimationFrame(this.x0a),this.x0a=null),
this.CQi(),this.J7b=!1)}get ePc(){return this.J7b}OQn(){this.MGc=[];for(let Q=0;Q<$p.ranges.length;++Q)this.MGc.push(0)}}$p.Bhm=()=>"visible"===document.visibilityState;$p.ranges=[17,34,42,67,100,200,400,800,1E3,1500,2E3,3E3,Number.POSITIVE_INFINITY];Type.registerNamespace("B4RT");Type.registerNamespace("Box4.AccessibilityChecker");Type.registerNamespace("Box4.Symbols");Type.registerNamespace("WEDSM");Type.registerNamespace("WEFP");Type.registerNamespace("WETF");Type.registerNamespace("WEUCH");Type.registerNamespace("WordEditor.AccessibilityChecker");
Type.registerNamespace("WordEditor.CoauthSurveys");Type.registerNamespace("WordEditor.ComponentStateLogging");Type.registerNamespace("WordEditor.FirstRunExperience");Type.registerNamespace("WordEditor.FrameTiming");Type.registerNamespace("WordEditor.GraphMerge");Type.registerNamespace("WordEditor.InteractivePerfTaskPane");Type.registerNamespace("WordEditor.ModernFontPicker");Type.registerNamespace("WordEditor.PageBreak");Type.registerNamespace("WordEditor.Pagination");Type.registerNamespace("WordEditor.TellMe");
Type.registerNamespace("WordEditor.TrackChange");Type.registerNamespace("WordEditor.Zoom");Type.registerNamespace("Common.App.VersionHistory");Type.registerNamespace("WordEditor.VersionHistory");ca.a.instance.Oc(new ef);Pg.main();Type.registerNamespace("Common.App.AccessibilityChecker");Type.registerNamespace("Common.App.Assistance");l;Type.registerNamespace("CACPU");ka.main();Type.registerNamespace("CAEventTimingMeter");ha.main();Type.registerNamespace("Common.App.FirstRunExperienceLauncher");Na.main();
Type.registerNamespace("Common.App.GestureInput");Ua.main();Type.registerNamespace("Common.App.GestureManager");wb.main();Type.registerNamespace("Common.ModernFontPicker");Type.registerNamespace("Common.App.OfflineLogger");ca.a.instance.Oc(new md);Type.registerNamespace("Common.App.O365Shell");lc.main();Type.registerNamespace("Common.App.PhoneLink");ke.main();Type.registerNamespace("Common.App.SensitiveLogging");Hn.main();Type.registerNamespace("Common.App.Rename");ca.a.instance.Oc(new fh,7);Type.registerNamespace("Common.App.Rename.RenameExecutor");
ca.a.instance.Oc(new Rc);Type.registerNamespace("Common.App.SaveAsToHost");gm.main();Type.registerNamespace("Common.App.SaveToCloudStorage");wg.main();Type.registerNamespace("Common.App.SaveACopy");Kl.main();Type.registerNamespace("Common.App.SaveToSharePoint");dj.main();Type.registerNamespace("Common.App.SharedFilePicker");Ll.main();Type.registerNamespace("Common.App.TellMe");Type.registerNamespace("Common.App.TellMe.CommandRanker.NaiveBayesModel");Type.registerNamespace("Common.App.TellMe.Suggestions.LRModel");
Type.registerNamespace("CATypingSpeedMeter");Gk.main();Qe;Pk.main();ca.a.instance.Oc(new zd);Gd.main();Il;Vf.main();ca.a.instance.Oc(new hf);Hr.main();Fb.a.prototype.toString=af.a.prototype.toString;Ih.a.h2h=new Yh.a;ca.a.instance.Oc(new tj);zp.main();ca.a.instance.Oc(new Rn);ca.a.instance.Oc(new fr);ca.a.instance.Oc(new ho);Xn.main();zk.main();Ym.main();Jq.main();Type.registerNamespace("NLRT");ca.a.instance.Oc(new cl);Type.registerNamespace("Common.App.AccessibilitySettings");Ml.main();jp;Bm.main();
ca.a.instance.Oc(new to);window.EventTiming={EventTimingMeter:kp,FrameTimingMeter:$p}}}]);

//# sourceMappingURL=https://res-dev.cdn.officeppe.net/1js/build/16477519/wdjs/WordEditorDS.box4.dll2.js.map